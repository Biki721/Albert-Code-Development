var TypeScriptModule;({919:function(){var e,t,o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},n=this&&this.__generator||function(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},r=this,i=!1;!function(e){e[e.GetTokens=0]="GetTokens",e[e.CopyToClipboard=1]="CopyToClipboard",e[e.FrameError=2]="FrameError"}(t||(t={})),window.onerror=function(){console.log("Window error")};var a=function(){var e=document.getElementById("loading");if(null!=e){e.style.visibility="hidden",e.style.display="none";var t=document.getElementById("spinnerContainer");null!=t?(t.style.visibility="hidden",t.style.display="none"):console.log("Failed to find spinnerContainer div.")}else console.log("Failed to find loading span.")},s=function(e,t){var o=document.getElementById("error");null!=o?(o.style.visibility="visible",o.style.display="block",o.style.padding="5px",o.textContent=e,o.style.left="6%",o.style.right="6%",t&&(o.style.color="#f3f2f1")):console.log("Failed to find error span.")},l=function(){return Office.context.hostSettings.get("Parameters").IsCopyToClipboardResultEnabled},c=function(){return Office.context.hostSettings.get("Parameters").IsLogShareReadyTimestampEnabled},u=function(){return Office.context.hostSettings.get("Parameters").GetTokensAsyncEnabled},d=function(){return Office.context.hostSettings.get("Parameters").IsSdxSingleCallbackEnabled},f=function(){Office.context.hostSettings.get("Parameters").IsResetSdxCallbackEnabled&&void 0!==e&&(console.log("Reset SDX callback"),e(),e=void 0)},g=function(t){return o(r,void 0,void 0,(function(){var o,r,s,u,d;return n(this,(function(n){switch(n.label){case 0:console.log(t.data),console.log("Clear timer for connectivity error message since we connected with sharedialog.aspx"),clearTimeout(void 0);try{o=JSON.parse(t.data)}catch(e){return console.log("Failed to parse postMessage event."),[2]}return"share_resize"!==(r=o.name)?[3,1]:null==(s=document.getElementById("shareFrame"))?(console.log("Failed to find shareFrame."),[2]):(s.style.height=o.height+"px",s.style.width=o.width+"px",Office.ExtensionLifeCycle.resize(o.width+20,o.height+45),[3,8]);case 1:return"share_started"!==r||i?[3,2]:(a(),null==(s=document.getElementById("shareFrame"))?(console.log("Failed to find shareFrame."),[2]):(s.style.visibility="visible",i=!0,[3,8]));case 2:if("share_copyToClipboard"!==r||!l())return[3,7];n.label=3;case 3:return n.trys.push([3,5,,6]),f(),console.log("register private event: onCopyToClipboardResult"),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){return h(e)})).then((function(t){return e=t}))];case 4:return n.sent(),[3,6];case 5:return u=n.sent(),console.log("Failed to call PrivateApi.onPrivateEvent(): "+u),[2];case 6:return[3,8];case 7:"share_ready"===r&&(o.timestamp=(new Date).toISOString()),n.label=8;case 8:try{c()?(d=JSON.stringify(o),OfficeFirstParty.PrivateApi.execute(d).then((function(e){return console.log(e)}))):OfficeFirstParty.PrivateApi.execute(t.data).then((function(e){return console.log(e)}))}catch(e){return console.log("Failed to call PrivateApi.execute(): "+e),[2]}return[2]}}))}))},p=function(e){var t;console.log(e.data),console.log("Clear timer for connectivity error message since we connected with sharedialog.aspx"),clearTimeout(void 0);try{t=JSON.parse(e.data)}catch(e){return void console.log("Failed to parse postMessage event.")}var o=t.name;if("share_resize"===o){if(null==(n=document.getElementById("shareFrame")))return void console.log("Failed to find shareFrame.");n.style.height=t.height+"px",n.style.width=t.width+"px",Office.ExtensionLifeCycle.resize(t.width+20,t.height+45)}else if("share_started"!==o||i)"share_ready"===o&&(t.timestamp=(new Date).toISOString());else{var n;if(a(),null==(n=document.getElementById("shareFrame")))return void console.log("Failed to find shareFrame.");n.style.visibility="visible",i=!0}try{if(c()){var r=JSON.stringify(t);OfficeFirstParty.PrivateApi.execute(r).then((function(e){return console.log(e)}))}else OfficeFirstParty.PrivateApi.execute(e.data).then((function(e){return console.log(e)}))}catch(e){return void console.log("Failed to call PrivateApi.execute(): "+e)}},h=function(e){var t;if(e)if("share_copyToClipboardResult"===(t=d()?e:JSON.parse(e)).name){var o=JSON.stringify({name:"share_copyToClipboardResult",success:!!t.success});try{var n=document.getElementById("shareFrame");if(null==n)return void console.log("Failed to find shareFrame.");if(null==n.contentWindow)return void console.log("Null iframe contentWindow.");console.log("Sanitized copy result: "+o),n.contentWindow.postMessage(o,"*")}catch(e){return void console.log("Failed to send postMessage to shareDialog.aspx.")}}else console.log("Invalid name attribute for copyResult.");else console.log("Failed to get copy-to-clipboard result.")},y=function(e){try{console.log(e+" failure"),OfficeFirstParty.PrivateApi.execute(JSON.stringify({name:"share_sdxLaunchError",errorMessage:e})).then((function(e){return console.log(e)}))}catch(t){console.log("Failed to call PrivateApi.execute() with error "+e+" : "+t)}},m=function(e,t,o){return void 0===o&&(o=null),{authToken:t.replace(/^(Bearer )/,""),webAbsoluteUrl:e.WebAbsoluteUrl,clientId:e.ClientId,mode:e.Mode,isFolder:!1,itemName:e.ItemName,itemUrl:e.ItemUrl,organizationName:e.OrganizationName,emailAddress:e.EmailAddress,correlationId:e.CorrelationId,scenarioId:e.ScenarioId+"-WV2",smkt:e.Smkt,disableLinkedInFeatures:!1,errorMessageNonConnectivity:e.ErrorMessageNonConnectivity,errorMessageConnectivity:e.ErrorMessageConnectivity,navId:e.NavId,hostOptions:{showCloseButton:!1,outlookAvailability:e.OutlookAvailability,isDarkMode:e.IsDarkMode,isSendCopyEnabled:e.IsSendCopyEnabled,isSendPdfEnabled:e.IsSendPdfEnabled,bypassBrowserCopyToClipboard:l()},additionalTokens:o,hostSessionId:e.HostSessionId,defaultRecipients:e.DefaultRecipients,customMessage:e.CustomMessage}},v=function(t,i,c){return o(r,void 0,void 0,(function(){var o,r,u,d,g,p,h;return n(this,(function(n){switch(n.label){case 0:if((o=document.createElement("input")).type="text",o.name="context",o.value=JSON.stringify(i),t.appendChild(o),i.hostOptions.isDarkMode){if(null==(r=document.getElementById("body")))return console.log("Failed to find html body."),y("NullBody"),[2];r.style.backgroundColor="#252423"}if(!i.webAbsoluteUrl)return console.log("Empty webAbsoluteUrl"),a(),s(i.errorMessageNonConnectivity,i.hostOptions.isDarkMode),y("EmptyWebAbsoluteUrl"),[2];if((u=document.createElement("input")).type="text",u.name="access_token",u.value=i.authToken,t.appendChild(u),d=i.webAbsoluteUrl+"/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true&clientId="+i.clientId+"&clickTime="+Date.now(),t.action=d,null==(g=document.getElementById("shareFrame")))return console.log("Failed to find shareFrame."),y("NullIFrame"),[2];c||(p="clipboard-read self "+i.webAbsoluteUrl+"; clipboard-write self "+i.webAbsoluteUrl,g.allow=p),n.label=1;case 1:return n.trys.push([1,5,,6]),f(),console.log("register private event: onFrameError"),l()?[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){return w(e,i.hostOptions.isDarkMode)})).then((function(t){return e=t}))]:[3,3];case 2:return n.sent(),[3,4];case 3:OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){return w(e,i.hostOptions.isDarkMode)})).then((function(t){return e=t})),n.label=4;case 4:return[3,6];case 5:return h=n.sent(),console.log("Failed to call PrivateApi.onPrivateEvent(): "+h),y("OnPrivateEventError"),[2];case 6:return OfficeFirstParty.PrivateApi.execute(JSON.stringify({name:"share_sdxNavigatingToSharePage"})).then((function(e){return console.log(e)})),t.submit(),[2]}}))}))},b=function(e,t,o){var n=document.createElement("input");if(n.type="text",n.name="context",n.value=JSON.stringify(t),e.appendChild(n),t.hostOptions.isDarkMode){var r=document.getElementById("body");if(null==r)return console.log("Failed to find html body."),void y("NullBody");r.style.backgroundColor="#252423"}if(!t.webAbsoluteUrl)return console.log("Empty webAbsoluteUrl"),a(),s(t.errorMessageNonConnectivity,t.hostOptions.isDarkMode),void y("EmptyWebAbsoluteUrl");var i=document.createElement("input");i.type="text",i.name="access_token",i.value=t.authToken,e.appendChild(i);var l=t.webAbsoluteUrl+"/_layouts/15/sharedialog.aspx?crossdomain=true&migratedhosting=true&clientId="+t.clientId+"&clickTime="+Date.now();e.action=l;var c=document.getElementById("shareFrame");if(null==c)return console.log("Failed to find shareFrame."),void y("NullIFrame");if(!o){var u="clipboard-read self "+t.webAbsoluteUrl+"; clipboard-write self "+t.webAbsoluteUrl;c.allow=u}if(Office.context.hostSettings.get("Parameters").IsFormSubmissionTimeDiffEnabled){var d=(new Date).toISOString();OfficeFirstParty.PrivateApi.execute(JSON.stringify({name:"share_sdxNavigatingToSharePage",formSubmitTimestamp:d})).then((function(e){return console.log(e)}))}else OfficeFirstParty.PrivateApi.execute(JSON.stringify({name:"share_sdxNavigatingToSharePage"})).then((function(e){return console.log(e)}));e.submit()},k=function(o,n,r){try{f(),console.log("register private events"),OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){clearTimeout(r);var i=JSON.parse(e);switch(console.log(i),i.event){case t.GetTokens:u()&&(console.log("call onGetTokens"),function(e,t,o,n){if(clearTimeout(n),e)try{var r=m(o,e.AuthToken,{lokiToken:e.LokiToken,graphToken:e.GraphToken,substrateToken:e.SubstrateToken});b(t,r,o.IsBrowserClipboardCopyDisabled)}catch(e){return void y("TokenParseError")}else y("NullTokenData")}(i.payload,n,o,r));break;case t.CopyToClipboard:l()&&(console.log("call onCopyToClipboardResult"),h(i.payload));break;case t.FrameError:console.log("call onFrameError"),w(i.payload,o.isDarkMode);break;default:console.log("Tried to invoke undefined private event callback.")}})).then((function(t){return e=t}))}catch(e){clearTimeout(r),"Timeout"!==e.message&&y("OnPrivateEventError")}},T=function(){var t=Office.context.hostSettings.get("Parameters");if(t.ShowWebView2Indicator){var i=document.getElementById("wv2Indicator");i&&(i.style.display="inline")}var a=document.getElementById("shareForm");if(null==a)return console.log("Failed to find shareForm."),void y("NullForm");var s=setTimeout((function(){y("TimeoutError")}),6e4);if(d()&&k(t,a,s),u()&&!d())!function(t,i){o(r,void 0,void 0,(function(){var o,r;return n(this,(function(n){switch(n.label){case 0:o=setTimeout((function(){y("TimeoutError")}),6e4),n.label=1;case 1:return n.trys.push([1,3,,4]),f(),console.log("register private event: fetch token"),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(e){if(clearTimeout(o),e)try{var n=JSON.parse(e),r=m(t,n.AuthToken,{lokiToken:n.LokiToken,graphToken:n.GraphToken,substrateToken:n.SubstrateToken});v(i,r,t.IsBrowserClipboardCopyDisabled)}catch(e){return void y("TokenParseError")}else y("NullTokenData")})).then((function(t){return e=t}))];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),clearTimeout(o),"Timeout"!==r.message&&y("OnPrivateEventError"),[2];case 4:return[2]}}))}))}(t,a);else if(!u()){var l=m(t,t.AuthToken,{substrateToken:t.SubstrateToken,graphToken:t.GraphToken,lokiToken:t.LokiToken});d()?b(a,l,t.IsBrowserClipboardCopyDisabled):v(a,l,t.IsBrowserClipboardCopyDisabled)}},w=function(e,t){console.log("on frame error"),s(e,t),a()};window.addEventListener("load",(function(e){OfficeFirstParty.PrivateApi.execute(JSON.stringify({name:"share_sdxDialogLoaded"})).then((function(e){return console.log(e)})),d()?window.addEventListener("message",p,!1):window.addEventListener("message",g,!1),Office.onReady(T)}))}})[919](),TypeScriptModule={};