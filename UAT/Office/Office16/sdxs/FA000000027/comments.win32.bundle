"use strict";(()=>{var cve=Object.create;var zT=Object.defineProperty;var uve=Object.getOwnPropertyDescriptor;var lve=Object.getOwnPropertyNames;var fve=Object.getPrototypeOf,pve=Object.prototype.hasOwnProperty;var f=(e,t)=>()=>(e&&(t=e(e=0)),t);var be=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ey=(e,t)=>{for(var r in t)zT(e,r,{get:t[r],enumerable:!0})},a4=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(var o=lve(t),a=0,d=o.length,c;a<d;a++)c=o[a],!pve.call(e,c)&&c!==r&&zT(e,c,{get:(u=>t[u]).bind(null,c),enumerable:!(n=uve(t,c))||n.enumerable});return e};var S=(e,t,r)=>(r=e!=null?cve(fve(e)):{},a4(t||!e||!e.__esModule?zT(r,"default",{value:e,enumerable:!0}):r,e)),Vk=e=>a4(zT({},"__esModule",{value:!0}),e);var s4=be((exports,module)=>{s();if(exports.__platformBundles!==void 0)for(platformBundles=exports.__platformBundles.concat(),Reflect.deleteProperty(exports,"__platformBundles"),i=0;i<platformBundles.length;++i)console.log("PB start "+(i+1)+"/"+platformBundles.length),eval(platformBundles[i]),console.log("PB done  "+(i+1)+"/"+platformBundles.length);var platformBundles,i});var global,s=f(()=>{global=new Function("return this;")();s4()});var d4=f(()=>{"use strict";s()});var Nn,Py=f(()=>{"use strict";s();Nn=!1});var It,_y,$l,jk=f(()=>{"use strict";s();Py();It=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Nn&&console.log.apply(console,t)},_y=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Nn&&console.error.apply(console,t)},$l=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Nn&&console.warn.apply(console,t)}});var c4=f(()=>{"use strict";s();jk()});function Ry(e,t){return e.length===t.length&&e.every(function(r,n){return r===t[n]})}var u4=f(()=>{"use strict";s()});function Z(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Wk(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Ke(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}function Wt(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})}function pt(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function $e(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function V(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,a=[],d;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)a.push(o.value)}catch(c){d={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(d)throw d.error}}return a}function w(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function zt(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Wk,m,k=f(()=>{"use strict";s();Wk=function(t,r){return Wk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])},Wk(t,r)};m=function(){return m=Object.assign||function(r){for(var n,o=1,a=arguments.length;o<a;o++){n=arguments[o];for(var d in n)Object.prototype.hasOwnProperty.call(n,d)&&(r[d]=n[d])}return r},m.apply(this,arguments)}});var l4=f(()=>{"use strict";s();u4()});var GT,f4=f(()=>{"use strict";s();GT=function(){function e(){this.valueStruct={hasValue:!1},this.callbacks=[]}return e.prototype.set=function(t){this.valueStruct={value:t,hasValue:!0},this.callbacks.forEach(function(r){r(t)}),this.callbacks=[]},e.prototype.getValue=function(t){var r=this;if(this.valueStruct.hasValue)try{return Promise.resolve(t(this.valueStruct.value))}catch(n){return Promise.reject(n)}return new Promise(function(n,o){r.callbacks.push(function(a){try{n(t(a))}catch(d){o(d)}})})},e}()});function gu(e,t,r,n,o){var a=r(),d,c=function l(){var p=t(a);p?(a=p,d=setTimeout(l,n)):(a=r(),d=void 0)},u=function(p){a=e(a,p),!d&&!o&&(d=setTimeout(c,0)),d||(d=setTimeout(c,o||n))};return u.reset=function(){d!==void 0&&(clearTimeout(d),a=r(),d=void 0)},u}var p4=f(()=>{"use strict";s()});var qT,m4=f(()=>{"use strict";s();qT=function(){function e(){var t=this;this.promise=new Promise(function(r,n){t.onResolve=r,t.onReject=n})}return Object.defineProperty(e.prototype,"resolve",{get:function(){return this.onResolve},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reject",{get:function(){return this.onReject},enumerable:!1,configurable:!0}),e}()});var g4=f(()=>{"use strict";s();f4();p4();m4()});var sm,h4=f(()=>{"use strict";s();k();sm=function(){function e(t){var r=this;this.internalHandler=t,this.eventQueue=[],this._isProcessingEvents=!1,this.handler=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(!r._isProcessingEvents){r.eventQueue.push(n);return}r.internalHandler.apply(r,w([],V(n),!1))}}return Object.defineProperty(e.prototype,"isProcessingEvents",{get:function(){return this._isProcessingEvents},enumerable:!1,configurable:!0}),e.prototype.pauseProcessing=function(){this._isProcessingEvents=!1},e.prototype.startProcessing=function(){var t,r;if(!this._isProcessingEvents){this._isProcessingEvents=!0;try{for(var n=$e(this.eventQueue),o=n.next();!o.done;o=n.next()){var a=o.value;this.handler.apply(this,w([],V(a),!1))}}catch(d){t={error:d}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.eventQueue=[]}},e}()});var y4=f(()=>{"use strict";s();h4()});function Ay(e,t){var r=e.filter(t);return r.length===e.length?e:r}var C4=f(()=>{"use strict";s()});function ky(e){return e.reduce(function(t,r){return Array.isArray(r)?t.push.apply(t,w([],V(ky(r)),!1)):t.push(r),t},[])}var v4=f(()=>{"use strict";s();k()});var KT,x4=f(()=>{"use strict";s();k();KT=function(t){var r,n,o={};try{for(var a=$e(t),d=a.next();!d.done;d=a.next()){var c=V(d.value,2),u=c[0],l=c[1];o[u]=l}}catch(p){r={error:p}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}});var YT,T4=f(()=>{"use strict";s();YT=Boolean});var b4=f(()=>{"use strict";s();C4();v4();x4();T4()});var $T,S4=f(()=>{"use strict";s();$T=function(){var t=[],r={},n=[];return function(o,a,d){if(d===void 0&&(d=function(l,p,g){return g[p]}),o===t&&a===r)return n;var c=o.map(function(u,l){return u===t[l]&&u.every(function(p){return d(u[0],p,a)===d(u[0],p,r)})?n[l]:u.map(function(p){return d(u[0],p,a)})});return t=o,r=a,n=c,c}}});function I4(e){return e??gve}function hu(e,t,r){t===void 0&&(t=100);var n=new Map,o=0;return function(){for(var a,d,c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];if(c.length===0){var l=e.apply(void 0,w([],V(c),!1));return l}o>t&&(n.clear(),o=0,r==null||r());var p=I4(c[0]),g=(a=n.get(p))!==null&&a!==void 0?a:{nextArgMap:new Map};n.has(p)||n.set(p,g);for(var h=1;h<c.length;h++){var v=I4(c[h]),y=(d=g.nextArgMap.get(v))!==null&&d!==void 0?d:{nextArgMap:new Map};g.nextArgMap.has(y)||g.nextArgMap.set(v,y),g=y}return g.value!==void 0||(o++,g.value={storedResult:e.apply(void 0,w([],V(c),!1))}),g.value.storedResult}}var gve,E4=f(()=>{"use strict";s();k();gve="9FA40DC1-775B-46F7-B124-3E10E131B835"});function Qe(e){var t,r=[{}];return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return r.every(function(a,d){return a===n[d]})||(r=n,t=e.apply(void 0,w([],V(n),!1))),t}}function vn(e,t){var r=Qe(e);return function(){return r.apply(void 0,w([],V(t()),!1))}}function QT(e,t,r){var n=Qe(t);return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return n.apply(void 0,w(w([],V(o),!1),V(r()),!1))}}var P4=f(()=>{"use strict";s();k()});function Mn(e){var t=e;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t&&t.apply(void 0,w([],V(r),!1)),t=void 0}}var _4=f(()=>{"use strict";s();k()});var R4=f(()=>{"use strict";s();S4();E4();P4();_4()});var k4=be((OBe,qk)=>{s();var A4=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);A4?(zk=new Uint8Array(16),qk.exports=function(){return A4(zk),zk}):(Gk=new Array(16),qk.exports=function(){for(var t=0,r;t<16;t++)t&3||(r=Math.random()*4294967296),Gk[t]=r>>>((t&3)<<3)&255;return Gk});var zk,Gk});var F4=be((MBe,w4)=>{s();var D4=[];for(Dy=0;Dy<256;++Dy)D4[Dy]=(Dy+256).toString(16).substr(1);var Dy;function hve(e,t){var r=t||0,n=D4;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}w4.exports=hve});var N4=be((HBe,O4)=>{s();var yve=k4(),Cve=F4();function vve(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var o=e.random||(e.rng||yve)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t)for(var a=0;a<16;++a)t[n+a]=o[a];return t||Cve(o)}O4.exports=vve});var M4,Zn,XT,L4=f(()=>{"use strict";s();M4=S(N4()),Zn=M4.default,XT="00000000-0000-0000-0000-000000000000"});var H4=f(()=>{"use strict";s();L4()});function JT(e){return e}var B4=f(()=>{"use strict";s()});function Ot(e){var t=V(e,1),r=t[0];return r}var U4=f(()=>{"use strict";s();k()});var V4=f(()=>{"use strict";s();B4();U4()});var rt=f(()=>{"use strict";s();l4();g4();y4();b4();R4();H4();V4()});function wy(e,t){if(j4){var r=window==null?void 0:window.performance;if(!(!r||typeof r.measure!="function"||typeof r.mark!="function"))return new j4(e,t,r)}}var Ql,j4,W4=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"})(Ql||(Ql={}))});function ZT(e,t){return t===void 0&&(t=0),e?e.split("\n").slice(1+t,Nn?void 0:2+t).join("\n"):"<unable to get stack>"}function Xl(){try{throw new Error}catch(e){return e instanceof Error?ZT(e.stack,1):""}}var Kk=f(()=>{"use strict";s();Py()});function yu(e,t,r,n){return[Re.enableMessageLogging&&r?r:void 0,"Tag: ".concat(e),Re.enableStackLogging?t:void 0,n?"----------\nInner exception: ".concat(So(n)):void 0].filter(YT).join("\n")}var eb=f(()=>{"use strict";s();rt();Yk()});function z4(e,t,r){return new Error(yu(t,new Error().stack,e,r))}var G4=f(()=>{"use strict";s();eb()});function Fy(e,t){return!!(e&&(e instanceof Re||e.isStructuredError!==void 0)&&(!t||e.name===t))}function So(e){if(Fy(e))return e.stringify();if(e instanceof Error){var t=Re.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(Re.enableStackLogging?ZT(e.stack):"")}return Re.enableUnknownMessageLogging&&typeof e=="string"?e:"Unknown error"}var Re,Yk=f(()=>{"use strict";s();Py();Kk();eb();G4();Re=function e(t,r,n){var o=z4(t,r,n);return o.name="StructuredError",o.innerException=n,o.tag=r,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};Re.enableStackLogging=Nn;Re.enableMessageLogging=Nn;Re.enableUnknownMessageLogging=Nn;Re.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return yu(this.tag,this.stack,void 0,this.innerException)},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}});Object.setPrototypeOf?Object.setPrototypeOf(Re,Error):Re.__proto__=Error});var $k=f(()=>{"use strict";s();Yk();eb()});var Qk,C,q4=f(()=>{"use strict";s();rt();Qk=0,C={reserve:function(){return Qk},reserveTag:JT}});function Me(e){throw new Error("Unreachable throw hit! Passed in value is ".concat(e,"."))}var K4=f(()=>{"use strict";s()});function Ln(e,t,r){if(!e)throw new Re(t,r)}var Y4=f(()=>{"use strict";s();$k()});var ne=f(()=>{"use strict";s();d4();c4();jk();W4();Py();Kk();$k();q4();K4();Y4()});var Jl,$4=f(()=>{"use strict";s();k();ne();Jl=function(){function e(t,r){var n=this;this.apiName=t,this.DefaultCtor=r,this.reset=function(){n.instance=void 0,n.ctorStack=void 0,n.injectionStack=void 0}}return e.prototype.getAndInitialize=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(this.instance)throw new Re("'".concat(this.apiName,"' singleton is already initialized"),C.reserveTag(538035215));if(!this.DefaultCtor)throw new Re("'".concat(this.apiName,"' not initialized but no default constructor exists"),C.reserveTag(538035216));return this.ctorStack=Xl(),this.instance=new((t=this.DefaultCtor).bind.apply(t,w([void 0],r,!1)))},e.prototype.getInstanceOrThrow=function(){var t=this.instance;if(!t)throw new Re("'".concat(this.apiName,"' singleton has not been initialized"),C.reserveTag(538035217));return t},e.prototype.getInstance=function(){return this.instance},e.prototype.injectImplementation=function(t){if(this.getInstance())throw new Re("API has already been initialized.\nFirst initialization: ".concat(this.ctorStack),C.reserveTag(538035218));this.DefaultCtor=t},e.prototype.injectInstance=function(t){if(this.getInstance())throw new Re("API has already been initialized or injected.\nInitialize or Inject Callstack: ".concat(this.getInjectOrInitializeStack()),C.reserveTag(538035219));this.injectionStack=Xl(),this.instance=t},e.prototype.getInjectOrInitializeStack=function(){var t,r;return(r=(t=this.ctorStack)!==null&&t!==void 0?t:this.injectionStack)!==null&&r!==void 0?r:"Callstack Not Retrieved"},e}()});var tb=f(()=>{"use strict";s();$4()});var Et=be((g4e,Q4)=>{s();Q4.exports=OfficePlatformGlobal.Reka});var rb,xve,X4,J4=f(()=>{"use strict";s();rb=S(Et());rb.CustomTypeRegistry.registerTypeInfos({"SDX::Docs::FeatureGate::JS::GateValue":{gate:"$string",value:"$boolean"}});xve={FeatureGateModule:["SDX::Docs::FeatureGate::JS::FeatureGateModule",{Values:["Constant",["$array","SDX::Docs::FeatureGate::JS::GateValue"]]}]},X4={FeatureGateModule:rb.RekaServiceRegistry.getNativeService(xve.FeatureGateModule)}});var Z4,eU=f(()=>{"use strict";s();J4();Z4=function(){function e(){this.gateValues=new Map((X4.FeatureGateModule.Values||[]).map(function(t){return[t.gate,t.value]}))}return e.prototype.isGateEnabled=function(t,r){var n=this.gateValues.get(t);return n??r},e.prototype.isFeatureEnabled=function(t){return this.isGateEnabled(t,!1)},e.prototype.isChangeGateEnabled=function(t,r){return this.isGateEnabled(t,!0)},e}()});var Oy,tU=f(()=>{"use strict";s();tb();eU();Oy=new Jl("FeatureGate",Z4)});var Xk=f(()=>{"use strict";s();tU()});var rU=f(()=>{"use strict";s()});var nU=f(()=>{"use strict";s()});var oU=f(()=>{"use strict";s();rU();nU()});function Jk(e){return Oy.getAndInitialize(e)}function Ny(){return Oy.getInstanceOrThrow()}var iU=f(()=>{"use strict";s();Xk()});var Zl=f(()=>{"use strict";s();Xk();oU();iU()});var aU=f(()=>{"use strict";s()});var eo,Zk=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Always=1]="Always",e[e.OnSuccess=2]="OnSuccess",e[e.AggregateSubtree=3]="AggregateSubtree",e[e.NotSet=999]="NotSet"})(eo||(eo={}))});var Hn,eD=f(()=>{"use strict";s();(function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent"})(Hn||(Hn={}))});var ef,tD=f(()=>{"use strict";s();(function(e){e[e.EventExportability_NotSet=0]="EventExportability_NotSet",e[e.EventExportability_NotExported=1]="EventExportability_NotExported"})(ef||(ef={}))});var tf,rD=f(()=>{"use strict";s();(function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact"})(tf||(tf={}))});var mt,nD=f(()=>{"use strict";s();(function(e){e[e.NotSet=0]="NotSet",e[e.ProductServiceUsage=2]="ProductServiceUsage"})(mt||(mt={}))});var _i,oD=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Required=1]="Required",e[e.Basic=2]="Basic",e[e.All=3]="All"})(_i||(_i={}))});var xt,sU=f(()=>{"use strict";s();(function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Info=3]="Info",e[e.Verbose=4]="Verbose",e[e.Spam=5]="Spam"})(xt||(xt={}))});var N,iD=f(()=>{"use strict";s();(function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"})(N||(N={}))});var dU=f(()=>{"use strict";s();Zk();eD();tD();rD();nD();oD();sU();iD()});function ht(e,t){return{visit:function(){}}}var ut,aD=f(()=>{"use strict";s();(function(e){e[e.GlobalAPI=1]="GlobalAPI",e[e.ReviewedAsNotNecessary=2]="ReviewedAsNotNecessary",e[e.Test=3]="Test",e[e.Todo=4]="Todo"})(ut||(ut={}))});function Vr(e,t,r){return{key:e,value:t,dataClassification:r}}var cU=f(()=>{"use strict";s()});var Io,uU=f(()=>{"use strict";s();(function(e){e[e.Normal=0]="Normal",e[e.Critical=1]="Critical"})(Io||(Io={}))});var lU=f(()=>{"use strict";s();cU();uU()});var wUe,FUe,fU,OUe,NUe,pU,My,mU,MUe,gU,hU,LUe,HUe,BUe,UUe,sD=f(()=>{"use strict";s();ne();wUe=C.reserveTag(590899029),FUe=C.reserveTag(590899030),fU=C.reserveTag(590899031),OUe=C.reserveTag(590899032),NUe=C.reserveTag(590899033),pU=C.reserveTag(578937436),My=C.reserveTag(578937437),mU=C.reserveTag(578937438),MUe=C.reserveTag(576717443),gU=C.reserveTag(576717444),hU=C.reserveTag(576717445),LUe=C.reserveTag(523891986),HUe=C.reserveTag(523891987),BUe=C.reserveTag(523629772),UUe=C.reserveTag(523629773)});function Ee(){return{aggregationMode:eo.None,diagnosticLevel:Hn.NecessaryServiceDataEvent,dataCategories:mt.ProductServiceUsage,samplingPolicy:tf.NotSet,exportability:ef.EventExportability_NotExported}}var ob=f(()=>{"use strict";s();Zk();eD();tD();rD();nD()});function ab(e){var t,r,n;return m(m({},ib),{aggregationMode:(t=e.aggregationMode)!==null&&t!==void 0?t:ib.aggregationMode,diagnosticLevel:(r=e.diagnosticLevel)!==null&&r!==void 0?r:ib.diagnosticLevel,dataCategories:(n=e.dataCategories)!==null&&n!==void 0?n:ib.dataCategories})}var ib,dD=f(()=>{"use strict";s();k();ob();ib=Ee()});var Sve,yU,CU=f(()=>{"use strict";s();ne();sD();dD();Sve=function(){function e(){this.isInitialized=!1,this.deferredInitializationCallbacks=[]}return e.prototype.init=function(t){var r=this,n;this.isInitialized?this.assertConditionTag(!1,"ClientTelemetryAPI init called twice!",595644941):(this.hostAPI=t,this.isInitialized=!0,this.deferredInitializationCallbacks.map(function(o){return o(r)}),this.deferredInitializationCallbacks=[],this.logDiagnosticTrace=(n=this.hostAPI.logDiagnosticTrace)===null||n===void 0?void 0:n.bind(this.hostAPI))},e.prototype.hasBeenInitialized=function(){return this.isInitialized},e.prototype.onInitialized=function(t){this.isInitialized?t(this):this.deferredInitializationCallbacks.push(t)},e.prototype.createActivityObject=function(t,r,n,o){this.checkIsInitialized(),Ln(t[0]>="A"&&t[0]<="Z","Activity name should start with a capital letter.",pU),Ln(this.hostAPI,"Host API must be defined",My);var a=ab(n);return this.hostAPI.createActivityObject(t,r,a,o)},e.prototype.assertCondition=function(t,r){this.checkIsInitialized(),this.assertConditionTag(t,r,fU)},e.prototype.assertConditionTag=function(t,r,n){this.checkIsInitialized(),t||($l("*ASSERT* 0x".concat(n.toString(16)," : ").concat(r)),Ln(this.hostAPI,"Host API must be defined",My),this.hostAPI.logErrorData(n,r))},e.prototype.getMetadata=function(){return Ln(this.hostAPI,"Host API must be defined",My),this.hostAPI.getMetadata()},e.prototype.checkIsInitialized=function(){if(!this.isInitialized||!this.hostAPI)throw new Re("ClientTelemetryAPI is not initialized",mU)},e.prototype.logFloodgateActivity=function(t){this.checkIsInitialized(),Ln(this.hostAPI,"Host API must be defined",My),this.hostAPI.logFloodgateActivity&&this.hostAPI.logFloodgateActivity(t)},e}(),yU=Sve});function vU(e){return e.testOnly===!0}function xU(e){if(dm){if(vU(dm)){vU(e)&&(dm=e);return}throw sb?new Re(["'getTelemetryAPI' was called before a stub API was injected.","First call to getTelemetryAPI originated from:",sb].join("\n"),gU):new Re("ClientTelemetryAPI cannot be re-initialized.\nFirst initialized from ".concat(cD),hU)}cD||(cD=Xl()),dm=e}function x(){if(sb||(sb=Xl()),!dm){var e=new yU;return xU(e),e}return dm}var dm,sb,cD,db=f(()=>{"use strict";s();ne();sD();CU();dm=void 0});function TU(){return Ive}var Ive,bU=f(()=>{"use strict";s();Ive={appName:"TestHost",appVersion:"1.0",releaseAudience:"Internal",releaseChannel:"Insiders",sessionId:"D9430514-C886-445F-891C-6C0E7F774EF7"}});var SU,IU=f(()=>{"use strict";s();bU();SU=function(){function e(t,r){r===void 0&&(r=TU()),this.sdxMetadata=t,this.hostTelemetrySupport=r,this.logDiagnosticTrace=void 0}return e.prototype.getMetadata=function(){var t=this.hostTelemetrySupport,r=t.appName,n=t.appVersion,o=t.dataCenter,a=t.releaseAudience,d=t.releaseAudienceGroup,c=t.releaseChannel,u=t.ring,l=t.sessionId,p=t.sovereignEnvironmentName;return{appName:r,appVersion:n,dataCenter:o,releaseAudience:a,releaseAudienceGroup:d,releaseChannel:c,ring:u,sessionId:l,sovereignEnvironmentName:p}},e}()});var EU,PU=f(()=>{"use strict";s();ne();EU=function(){function e(t){this._visitor=t,this._ended=!1}return e.prototype.finalize=function(){return this._ended?(_y("ActivityObject has already been ended"),!1):(this._visitor&&this._visitor.visit(this),this._ended=!0,!0)},e.prototype.success=function(){this.successTag(0)},e.prototype.fail=function(t){this.failTag(0,t)},e.prototype.isEnded=function(){return this._ended},e}()});var cb,Eve,cm,uD=f(()=>{"use strict";s();cb=S(Et());cb.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::TelemetryMetadata":{appName:"$string",appVersion:"$string",releaseAudience:"$string",releaseChannel:"$string",releaseAudienceGroup:["opt-field","$string"],sessionId:"$string"}});Eve={TelemetryModule:["Mso::Document::Comments::JS::TelemetryModule",{logActivity:["FireAndForgetMethod",["Mso::Document::Comments::JS::ActivityData","Mso::Document::Comments::JS::ActivityDataFields"]],logErrorData:["FireAndForgetMethod",["$number","$string"]],logDiagnosticTrace:["FireAndForgetMethod",["$number","$number","$number","$string",["$array","Mso::Document::Comments::JS::HostClassifiedDataField"]]],telemetryMetadata:["Constant","Mso::Document::Comments::JS::TelemetryMetadata"]}]},cm={TelemetryModule:cb.RekaServiceRegistry.getNativeService(Eve.TelemetryModule)}});function _U(e,t,r){return new Pve(e,t,r)}var Pve,RU=f(()=>{"use strict";s();k();iD();oD();db();PU();uD();Pve=function(e){Z(t,e);function t(r,n,o,a){var d=e.call(this,n)||this;return d._startTime=0,d._activityData={name:r,timeElapsed:0,result:0,endTag:0,aggregationMode:o.aggregationMode,diagnosticLevel:o.diagnosticLevel,dataCategories:o.dataCategories,samplingPolicy:o.samplingPolicy,activityExportability:o.exportability,apiContext:void 0,documentMetadata:_i.None},d._dataFields={},d._startTime=t.now(),d}return t.prototype.successTag=function(r){this.finalize()&&(this._activityData.result=0,this._activityData.endTag=r,this._activityData.timeElapsed=t.now()-this._startTime,t.logActivity(this._activityData,this._dataFields))},t.prototype.failTag=function(r,n){this.finalize()&&(this._activityData.result=n,this._activityData.endTag=r,this._activityData.timeElapsed=t.now()-this._startTime,t.logActivity(this._activityData,this._dataFields))},t.prototype.addDataField=function(r,n,o,a){if(this.isEnded()){x().assertConditionTag(!1,"Activity object has already been ended. Field: '".concat(r,"'"),595644948);return}if(this._dataFields[r]!==void 0){x().assertConditionTag(!1,"ActivityObject already contains data for given field: '".concat(r,"'"),595644949);return}if(o&&o!==N.SystemMetadata){x().assertConditionTag(!1,"PII data fields are not yet supported. Field: '".concat(r,"'"),595644950);return}this._dataFields[r]=n},t.prototype.addDocumentMetadata=function(r){this._activityData.documentMetadata=r},t.prototype.attachContext=function(r){this._activityData.apiContext=r},t.logActivity=function(r,n){var o={string:[],number:[],boolean:[]};Object.keys(n).forEach(function(a){var d=n[a];typeof d=="boolean"?o.boolean.push({key:a,value:d}):typeof d=="number"?o.number.push({key:a,value:d}):o.string.push({key:a,value:d})}),cm.TelemetryModule.logActivity(r,o)},t.now=function(){var r=1e3;if(typeof performance<"u"&&performance.now){var n=performance.now();return Math.floor(n*r)}return Date.now()*r},t}(EU)});function _ve(e){switch(typeof e){case"boolean":return{type:"boolean",boolVal:e};case"string":return{type:"string",strVal:e};case"number":return{type:"number",numVal:e};default:Me(e)}}function AU(e){return{key:e.key,dataClassification:e.dataClassification,value:_ve(e.value)}}var kU=f(()=>{"use strict";s();ne()});var Ly,DU=f(()=>{"use strict";s();k();aD();ob();IU();RU();kU();uD();Ly=function(e){Z(t,e);function t(r,n){n===void 0&&(n=cm.TelemetryModule.telemetryMetadata);var o=e.call(this,r,n)||this;return o.sdxMetadata=r,o.logDiagnosticTrace=function(a,d,c,u,l){for(var p=[],g=5;g<arguments.length;g++)p[g-5]=arguments[g];var h=w([],p,!0);l.visit({addDataField:function(y,T,b,I){h.push({key:y,value:T,dataClassification:b})},addDocumentMetadata:function(y){},attachContext:function(y){}}),cm.TelemetryModule.logDiagnosticTrace(d,c,u,a,h.map(AU))},o}return t.prototype.createActivityObject=function(r,n,o){return _U(r,n,o)},t.prototype.logErrorData=function(r,n){var o=this.createActivityObject("LogError",ht(ut.ReviewedAsNotNecessary),Ee());o.failTag(r,-2130957533),cm.TelemetryModule.logErrorData(r,n)},t}(SU)});var wU=f(()=>{"use strict";s();DU()});var FU=f(()=>{"use strict";s();wU()});var OU=f(()=>{"use strict";s();FU()});function Hy(e,t){x().init(new Ly(e,t))}var NU=f(()=>{"use strict";s();OU();db()});var LU=f(()=>{"use strict";s();db();NU()});var HU=f(()=>{"use strict";s()});var BU=f(()=>{"use strict";s();aU();dU();aD();lU();LU();ob();dD();HU()});var te=f(()=>{"use strict";s();BU()});function Cu(e){return!!e&&e.focus!==void 0&&e.blur!==void 0}var lD=f(()=>{"use strict";s()});var UU=f(()=>{"use strict";s()});var L=be((xVe,VU)=>{s();VU.exports=OfficePlatformGlobal.React});function ub(e){return!!e&&e.getFocusState&&e.getId&&e.getData&&e.getNextTabTarget&&e.isTabbable&&e.getChildNodes&&e.addChildNode&&e.getDescendantById&&Cu(e)}var jU,um,Da,lb=f(()=>{"use strict";s();jU=S(L());lD();um=jU.createContext(void 0);(function(e){e[e.Forward=0]="Forward",e[e.Reverse=1]="Reverse"})(Da||(Da={}))});var WU=f(()=>{"use strict";s();lD();UU();lb()});var De,zU=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Capturing=1]="Capturing",e[e.AtTarget=2]="AtTarget",e[e.Bubbling=3]="Bubbling"})(De||(De={}))});var ce,By=f(()=>{"use strict";s();(function(e){e[e.Unfocused=0]="Unfocused",e[e.FocusOn=1]="FocusOn",e[e.FocusWithin=2]="FocusWithin"})(ce||(ce={}))});var J,GU=f(()=>{"use strict";s();(function(e){e.A="a",e.C="c",e.V="v",e.X="x",e.Alt="Alt",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.ArrowUp="ArrowUp",e.Backspace="Backspace",e.Control="Control",e.Delete="Delete",e.End="End",e.Enter="Enter",e.Escape="Escape",e.Home="Home",e.Meta="Meta",e.Shift="Shift",e.Space=" ",e.Tab="Tab",e.F6="F6",e.F12="F12"})(J||(J={}))});var fb,qU=f(()=>{"use strict";s();(function(e){e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.Delete=46]="Delete",e[e.a=65]="a",e[e.b=66]="b",e[e.c=67]="c",e[e.d=68]="d",e[e.e=69]="e",e[e.f=70]="f",e[e.g=71]="g",e[e.h=72]="h",e[e.i=73]="i",e[e.j=74]="j",e[e.k=75]="k",e[e.l=76]="l",e[e.m=77]="m",e[e.n=78]="n",e[e.o=79]="o",e[e.p=80]="p",e[e.q=81]="q",e[e.r=82]="r",e[e.s=83]="s",e[e.t=84]="t",e[e.u=85]="u",e[e.v=86]="v",e[e.w=87]="w",e[e.x=88]="x",e[e.y=89]="y",e[e.z=90]="z",e[e.F6=117]="F6"})(fb||(fb={}))});var lm=f(()=>{"use strict";s();zU();By();GU();qU()});function vu(e,t){if(!t)return e;switch(e){case J.ArrowLeft:return J.ArrowRight;case J.ArrowRight:return J.ArrowLeft;default:return e}}function mc(e){switch(e){case"Down":return J.ArrowDown;case"Up":return J.ArrowUp;case"Left":return J.ArrowLeft;case"Right":return J.ArrowRight;case"OS":return J.Meta;case"Del":return J.Delete;case"Spacebar":return" ";case"Esc":return J.Escape;case"Ctrl":case"Ctl":return J.Control;case"F6":return J.F6;case"F12":return J.F12;default:return e}}var KU=f(()=>{"use strict";s();lm()});function pm(e){return e.useJSTabLoop?e.handleKeysDuringBubbling?[{key:J.Tab,eventPhase:De.Bubbling},{key:J.Tab,shiftKey:!0,eventPhase:De.Bubbling}]:[{key:J.Tab,eventPhase:De.Capturing},{key:J.Tab,shiftKey:!0,eventPhase:De.Capturing}]:[]}var Uy,Cs,fm,YU=f(()=>{"use strict";s();k();lm();Uy=[{key:J.Tab,eventPhase:De.AtTarget},{key:J.Tab,eventPhase:De.AtTarget,shiftKey:!0}],Cs=function(t,r){return t&&t.map(function(n){return m(m({},n),{eventPhase:r})})},fm=function(t,r){var n=t.filter(function(o){return o.eventPhase!==De.None});return r&&(n=n.concat(Uy)),Cs(n,De.AtTarget)}});function to(e){return e.isFocusOn?ce.FocusOn:e.isFocusWithin?ce.FocusWithin:ce.Unfocused}var fD=f(()=>{"use strict";s();By()});function kve(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!cd)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return cd(function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return e.apply(void 0,w(w([],n,!1),t,!1))},t)}function Dve(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!cd)throw new Error("[internal error] useHook used outside of makeReactHookGuard!");return cd(function(){return e.apply(void 0,t)},t)}function $U(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(cd)throw new Error("Recursive calls of hooks is not supported!");cd=e;var n=kve.apply(void 0,t);return cd=void 0,n}}function pb(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(cd)throw new Error("Recursive calls of hooks is not supported!");cd=e;var n=Dve.apply(void 0,t);return cd=void 0,n}}var cd,QU=f(()=>{"use strict";s();k()});var xu,wve,pD,mD,gD,XU=f(()=>{"use strict";s();xu=S(L());QU();wve=pb(xu.useMemo),pD=pb(xu.useEffect),mD=pb(xu.useLayoutEffect),gD=$U(xu.useCallback)});var mb=f(()=>{"use strict";s();XU()});function gb(e,t,r,n,o,a){var d=Vy.useRef(new Fve(e,t,r,n,{isFocusOn:o,isFocusWithin:a}));return pD(function(c,u,l,p,g,h){h.current.onEffect(c,u,l,{isFocusOn:p,isFocusWithin:g})},t,r,n,o,a,d),d}var Vy,Fve,JU=f(()=>{"use strict";s();k();mb();Vy=S(L());By();fD();Fve=function(){function e(t,r,n,o,a){this.nodeId=t,this.nodeData=r,this.tabbable=n,this.onFocusStateChange=o,this.focusState=a,this.registrationRef=Vy.createRef(),this.innerComponentRef=Vy.createRef()}return e.prototype.onEffect=function(t,r,n,o){this.nodeData=t,this.tabbable=r,this.onFocusStateChange=n;var a=this.focusState;this.focusState=o,to(a)!==to(this.focusState)&&(this.onFocusStateChange&&this.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},e.prototype.getIterator=function(){return pt(this,function(t){switch(t.label){case 0:return[4,this];case 1:return t.sent(),[2]}})},e.prototype.getId=function(){return this.nodeId||""},e.prototype.getData=function(){return this.nodeData?this.nodeData():this},e.prototype.getFocusState=function(){return to(this.focusState)},e.prototype.getNextTabTarget=function(){return this.getFocusState()===ce.Unfocused&&this.isTabbable()?this:void 0},e.prototype.isTabbable=function(){return!!this.tabbable},e.prototype.getChildNodes=function(){return[]},e.prototype.addChildNode=function(){throw new Error("Method not implemented.")},e.prototype.getDescendantById=function(){},e.prototype.focus=function(){var t;(t=this.innerComponentRef.current)===null||t===void 0||t.focus()},e.prototype.blur=function(){var t;(t=this.innerComponentRef.current)===null||t===void 0||t.blur()},e}()});var ZU=f(()=>{"use strict";s();KU();YU();fD();JU()});function yD(e){e5=e}function jy(){return e5}var e5,CD=f(()=>{"use strict";s();e5={logFocusDebugInfo:function(){}}});function t5(e,t){if(e){var r=e.getNextTabTarget(t,!1);return r||(jy().logFocusDebugInfo("No next focus found - restarting loop"),r=e.getNextTabTarget(t,!0)),r?(jy().logFocusDebugInfo("Next focus target: ".concat(r.getId())),r.focus()):jy().logFocusDebugInfo("No next focus found"),r}}function vD(e,t,r){var n=e.getFocusState();if(!(n===ce.FocusOn&&!r&&t===Da.Reverse)){if((n===ce.Unfocused||r)&&t===Da.Forward&&e.isTabbable())return e;var o=e.getChildNodes();t===Da.Reverse&&o.reverse();for(var a=t===Da.Forward&&n===ce.FocusOn||r?0:o.findIndex(function(u){return u.getFocusState()!==ce.Unfocused}),d=a>=0?a:0;d<o.length;++d){var c=o[d].getNextTabTarget(t,r);if(c)return c}if(t===Da.Reverse&&e.isTabbable())return e}}function xD(e,t){if(t.nativeEvent.key!==J.Tab)return{wasHandled:!1};var r=t.nativeEvent.shiftKey?Da.Reverse:Da.Forward;return{wasHandled:!0,newTabTarget:t5(e.getRoot(),r)}}var r5=f(()=>{"use strict";s();lm();lb();CD()});var TD,bD=f(()=>{"use strict";s();TD=function(){function e(){var t=this;this.root=null,this.getRoot=function(){return t.root},this.setRoot=function(r){t.root=r}}return e}()});var hb,n5=f(()=>{"use strict";s();k();bD();hb=function(){function e(t){var r=this;this.viewTreeMap=new Map,t&&t.viewTreeMap.forEach(function(n,o){return r.viewTreeMap.set(o,n)})}return e.prototype.updateIdForViewTree=function(t,r){var n=this.viewTreeMap.get(t);return n?(this.viewTreeMap.set(r,n),this.viewTreeMap.delete(t),!0):!1},e.prototype.getOrCreateViewTreeById=function(t){var r=this.viewTreeMap.get(t);return r||(r=new TD,this.viewTreeMap.set(t,r)),r},e.prototype.getViewTrees=function(){return this.viewTreeMap.values()},e.prototype.getDescendantById=function(t){var r,n,o;try{for(var a=$e(this.viewTreeMap.values()),d=a.next();!d.done;d=a.next()){var c=d.value,u=(o=c.getRoot())===null||o===void 0?void 0:o.getDescendantById(t);if(u)return u}}catch(l){r={error:l}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},e}()});function SD(e){function t(){var r,n,o,a,d,c,u,l;return pt(this,function(p){switch(p.label){case 0:return[4,e];case 1:p.sent(),p.label=2;case 2:p.trys.push([2,8,9,10]),r=$e(e.getChildNodes()),n=r.next(),p.label=3;case 3:if(n.done)return[3,7];o=n.value,a=o.getIterator(),d=void 0,p.label=4;case 4:return(d=a.next()).done?[3,6]:[4,d.value];case 5:return p.sent(),[3,4];case 6:return n=r.next(),[3,3];case 7:return[3,10];case 8:return c=p.sent(),u={error:c},[3,10];case 9:try{n&&!n.done&&(l=r.return)&&l.call(r)}finally{if(u)throw u.error}return[7];case 10:return[2]}})}return t()}var o5=f(()=>{"use strict";s();k()});var i5,nf,a5=f(()=>{"use strict";s();i5=S(L());lm();nf=function(){function e(){var t=this;this.ref=i5.createRef(),this.focus=function(){t.ref&&t.ref.current&&t.ref.current.focus()},this.blur=function(){t.ref&&t.ref.current&&t.ref.current.blur()},this.getFocusState=function(){return t.ref&&t.ref.current?t.ref.current.getFocusState():ce.Unfocused},this.getNextTabTarget=function(r,n){if(t.ref&&t.ref.current)return t.ref.current.getNextTabTarget(r,n)},this.isTabbable=function(){return t.ref&&t.ref.current?t.ref.current.isTabbable():!1},this.getChildNodes=function(){return t.ref&&t.ref.current?t.ref.current.getChildNodes():[]},this.addChildNode=function(r,n){if(t.ref&&t.ref.current)return t.ref.current.addChildNode(r,n)},this.getId=function(){return t.ref&&t.ref.current?t.ref.current.getId():""},this.getData=function(){if(t.ref&&t.ref.current)return t.ref.current.getData()},this.getDescendantById=function(r){if(t.ref&&t.ref.current)return t.ref.current.getDescendantById(r)},this.getIterator=function(){return t.ref&&t.ref.current?t.ref.current.getIterator():{next:function(){return{done:!0,value:t}}}}}return Object.defineProperty(e.prototype,"disabled",{get:function(){return!!(this.ref.current&&this.ref.current.disabled)},enumerable:!1,configurable:!0}),e}()});var ud,Ove,gc,s5=f(()=>{"use strict";s();k();ud=S(L());lb();Ove=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.registrationToken=void 0,r.onFocusStateChange=function(n){r.registrationToken&&r.registrationToken.onFocusStateChange(n)},r}return t.prototype.componentDidMount=function(){var r=this;this.props.parentNode&&(this.registrationToken=this.props.parentNode.addChildNode(this.props.node,function(){return r.props.position}))},t.prototype.componentWillUnmount=function(){this.registrationToken&&(this.registrationToken.unregister(),this.registrationToken=void 0)},t.prototype.render=function(){return ud.Children.only(this.props.children)},t}(ud.PureComponent),gc=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.registrationHelperRef=ud.createRef(),r.onFocusStateChange=function(n){r.registrationHelperRef.current&&r.registrationHelperRef.current.onFocusStateChange(n)},r}return t.prototype.render=function(){var r=this;return ud.createElement(um.Consumer,null,function(n){return ud.createElement(Ove,{parentNode:n,node:r.props.node,ref:r.registrationHelperRef,position:r.props.position},r.props.children)})},t}(ud.PureComponent)});var Pt=f(()=>{"use strict";s();WU();lm();ZU();r5();n5();bD();o5();a5();s5();CD()});var Kr=be((tje,d5)=>{s();d5.exports=OfficePlatformGlobal.Polyester.Components});var u5=be((nje,c5)=>{s();c5.exports=OfficePlatformGlobal.ReactNativeReka});var re=be((ije,l5)=>{s();l5.exports=OfficePlatformGlobal.ReactNative.Components});function Ri(e){return Fy(e,f5)}var f5,Nve,ge,Jt=f(()=>{"use strict";s();k();ne();f5="CommentError",Nve=function(t){var r=4294967295;if(t>r||t<-4294967296)return"dword_out_of_range(".concat(t,")");var n=t<0?r+t+1:t;return"0x".concat(n.toString(16))},ge=function(e){Z(t,e);function t(r,n,o){var a=e.call(this,r,n)||this;return a.tag=n,a.errorCode=o,a.name=f5,a}return t.prototype.stringify=function(){return yu(this.tag,this.stack,"Error ".concat(Nve(this.errorCode)),this.innerException)},t}(Re)});var p5,m5,g5,h5,y5,C5,v5,x5,T5,ld,mm,b5,S5,vs=f(()=>{"use strict";s();p5="Duplicate instance registration",m5="Selected comment not found",g5="Selected thread index out of bounds",h5="Invalid number of posts for display more replies string",y5="Method not implemented",C5="Not enough replacement strings given",v5="LocalizationModule NativeModule not valid",x5="Maximum of 100 replacements",T5="Store state unexpected",ld="Invalid arguments",mm="Comment ID value is invalid in the current operation",b5="Attempting to perform an operation on an inactive draft",S5="CommentModel not found in a thread of RenderableItems"});var He,fd=f(()=>{"use strict";s();(function(e){e[e.Unhandled=0]="Unhandled",e[e.Handled=1]="Handled",e[e.Canceled=2]="Canceled",e[e.Failed=3]="Failed"})(He||(He={}))});function Mve(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(t.length>100)throw new ge(x5,C.reserveTag(589103707),-2130957555);if(typeof e!="string")throw new ge("Expected string but got ".concat(typeof e),C.reserveTag(589103708),-2130957537);return e.replace(_5(),function(n,o){if(o==="|")return"|";var a=parseInt(o,10);if(a>=t.length)throw new ge(C5,C.reserveTag(589103709),-2130957553);return t[a]})}function yb(e){return e.replace(_5(),function(t,r){return r==="|"?"|":"{".concat(r,"}")})}var _5,R5,ID=f(()=>{"use strict";s();k();ne();te();Jt();vs();_5=function(){return/\|(\||\d+)/g};R5=function(){function e(t){if(this.constants=t,!t)throw new ge("LocalizationConstants unavailable",C.reserveTag(589103710),-2130957557);this.localizedStrings=new Map(t.localizedStrings.map(function(r){var n=r.id,o=r.str;return[n,o]}))}return e.prototype.getLocaleInfo=function(){return this.constants.localeInfo},e.prototype.getString=function(t){var r=this.localizedStrings.get(t);return x().assertConditionTag(r!==void 0,"Missing string ".concat(t),589103711),r||""},e.prototype.getStringOrUndefined=function(t){return this.localizedStrings.get(t)},e.prototype.getStringWithStandardPlaceholders=function(t){return yb(this.getString(t))},e.prototype.getStringWithStandardPlaceholdersOrUndefined=function(t){var r=this.getStringOrUndefined(t);if(r!==void 0)return yb(r)},e.prototype.formatString=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.getString(t);try{return Mve.apply(void 0,w([o],V(r),!1))}catch(a){return Ri(a)?x().assertConditionTag(!1,"Comment error in format string with stringId ".concat(t,": ").concat(a.message),589103712):x().assertConditionTag(!1,"Unknown Error in formatString with stringId ".concat(t),589103713),""}},e}()});var Cb,Lve,A5,k5=f(()=>{"use strict";s();Cb=S(Et());Cb.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::Localization::LocalizedString":{id:"$number",str:"$string"}});Lve={LocalizationConstants:["Mso::Document::Comments::Localization::LocalizationConstants",{localizedStrings:["Constant",["$array","Mso::Document::Comments::Localization::LocalizedString"]],localeInfo:["Constant","Mso::Document::Comments::Localization::LocalizationDetails"]}]},A5={LocalizationConstants:Cb.RekaServiceRegistry.getNativeService(Lve.LocalizationConstants)}});function vb(){if(!gm)throw new ge(v5,C.reserveTag(589103745),-2130957552);return gm}function D5(){if(x().assertConditionTag(gm===void 0,"LocalizationAPI has already been initialized",589103746),gm===void 0){var e=A5.LocalizationConstants;gm=new R5(e)}return gm}var gm,xb=f(()=>{"use strict";s();ne();te();Jt();vs();ID();k5();gm=void 0});function Q(){return Hve[w5.Platform.OS]}var w5,Hve,Pr=f(()=>{"use strict";s();w5=S(re()),Hve={android:"android",web:"web",windows:"win32",win32:"win32",macos:"macos",ios:"ios"}});var Tb,Bve,ke,hm=f(()=>{"use strict";s();k();Tb={WHITE:"#FFFFFF",BLACK:"#000000",GRAY_A:"#F3F3F3",GRAY_B:"#E6E6E6",GRAY_C:"#D2D2D2",GRAY_C2:"#C6C6C6",GRAY_C3:"#B1B1B1",GRAY_D:"#969696",GRAY_E:"#666666",GRAY_F:"#505050",GRAY_H:"#363636",GRAY_H2:"#333333",GRAY_I:"#262626",GRAY_J:"#0A0A0A",Gray26:"#424242",Gray90:"#E5E5E5",GRAY_20:"#F3F2F1",GRAY_30:"#EDEBE9",GRAY_40:"#E1DFDD",GRAY_50:"#D2D0CE",GRAY_60:"#C8C6C4",GRAY_70:"#BEBBB8",GRAY_100:"#979593",GRAY_110:"#8A8886",GRAY_130:"#605E5C",GRAY_140:"#484644",GRAY_150:"#3B3A39",GRAY_160:"#323130",GRAY_180:"#252423",GRAY_200:"#1B1A19"},Bve={FIRST_RUN_GRAY:"#f7f7f7",COMMENTS_PURPLE:"#9C44A6",COMMENTS_GRAY:"#EAEAEA",FLUENT_RESOLVED:"#B3B0AD",FOCUS_BOX:"#797775",DOT_BLUE:"#006BFF",REST_RESOLVED_BODY:Tb.GRAY_20,RESOLVED_CARD_TEXT:Tb.GRAY_130,ACTIVE_COMMENT_TEXT:Tb.GRAY_H2,SUGGESTED_PICKER_ITEM:"#DEECF9",SUGGESTED_PICKER_ITEM_HOVER:"#C7E0F4"},ke=m(m({},Tb),Bve)});function Ib(e){PD=e}function oi(e,t){if(!PD){x().assertConditionTag(!1,"announceToScreenReader not registered",595632534);return}PD.announceToScreenReader(e,t)}var PD,jve,_D,RD=f(()=>{"use strict";s();te();jve=function(){function e(){}return e.prototype.setScreenReaderNotifier=function(t){t&&Ib(t)},e}(),_D=function(){function e(){this.screenReaderNotifierManagerInstance=void 0}return e.prototype.getScreenReaderNotifierManagerInstance=function(){return this.screenReaderNotifierManagerInstance||(this.screenReaderNotifierManagerInstance=new jve),this.screenReaderNotifierManagerInstance},e}()});var H5,B5=f(()=>{"use strict";s();RD();H5=new _D});var U5=f(()=>{"use strict";s();B5()});var ym=f(()=>{"use strict";s();U5();RD()});var of=be((E8e,V5)=>{s();V5.exports=OfficePlatformGlobal.RNWin32.Components});var k8e,cn,W5,D8e,yc=f(()=>{"use strict";s();k8e=process.env.TEST_PAGE==="sharedcommentsdemo",cn=!1,W5=process.env.JEST_WORKER_ID!==void 0,D8e=process.env.JEST_WORKER_ID!==void 0?"JEST_TEST_ID":void 0});var DD=be((O8e,Cc)=>{s();function kD(e){"@babel/helpers - typeof";return Cc.exports=kD=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc.exports.__esModule=!0,Cc.exports.default=Cc.exports,kD(e)}Cc.exports=kD,Cc.exports.__esModule=!0,Cc.exports.default=Cc.exports});var G5=be((M8e,zy)=>{s();var z5=DD().default;function Wve(e,t){if(z5(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(z5(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}zy.exports=Wve,zy.exports.__esModule=!0,zy.exports.default=zy.exports});var wD=be((H8e,Gy)=>{s();var zve=DD().default,Gve=G5();function qve(e){var t=Gve(e,"string");return zve(t)=="symbol"?t:t+""}Gy.exports=qve,Gy.exports.__esModule=!0,Gy.exports.default=Gy.exports});var FD=be((U8e,qy)=>{s();var Kve=wD();function Yve(e,t,r){return t=Kve(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}qy.exports=Yve,qy.exports.__esModule=!0,qy.exports.default=qy.exports});var q5=be((j8e,vc)=>{s();function OD(e,t){return vc.exports=OD=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},vc.exports.__esModule=!0,vc.exports.default=vc.exports,OD(e,t)}vc.exports=OD,vc.exports.__esModule=!0,vc.exports.default=vc.exports});var Tu=be((z8e,Ky)=>{s();var $ve=q5();function Qve(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,$ve(e,t)}Ky.exports=Qve,Ky.exports.__esModule=!0,Ky.exports.default=Ky.exports});var Yr,ND=f(()=>{"use strict";s();(function(e){e[e.Modify=1]="Modify",e[e.Remove=2]="Remove",e[e.Add=3]="Add",e[e.ReQuery=4]="ReQuery"})(Yr||(Yr={}))});var Eb=f(()=>{"use strict";s();ND()});var K5=f(()=>{"use strict";s()});var un,MD=f(()=>{"use strict";s();(function(e){e[e.Invalid=0]="Invalid",e[e.Disabled=1]="Disabled",e[e.Enabled_Default=2]="Enabled_Default",e[e.Enabled_ForcePrimary=3]="Enabled_ForcePrimary"})(un||(un={}))});var Bt,LD=f(()=>{"use strict";s();(function(e){e[e.Empty=0]="Empty",e[e.CommentThread=1]="CommentThread",e[e.TrackedChange=2]="TrackedChange",e[e.AICursor=4]="AICursor"})(Bt||(Bt={}))});var Nt,Y5=f(()=>{"use strict";s();(function(e){e[e.Disabled=0]="Disabled",e[e.Primary=1]="Primary",e[e.Secondary=2]="Secondary"})(Nt||(Nt={}))});var de,HD=f(()=>{"use strict";s();(function(e){e[e.Integrated=0]="Integrated",e[e.Isolated=1]="Isolated",e[e.TaskPane=2]="TaskPane",e[e.TaskPaneItem=3]="TaskPaneItem"})(de||(de={}))});var $5=f(()=>{"use strict";s();HD()});function Yy(e){return e===un.Enabled_Default||e===un.Enabled_ForcePrimary}var Q5=f(()=>{"use strict";s();MD()});var X5=f(()=>{"use strict";s();Q5()});var xs=f(()=>{"use strict";s();K5();MD();LD();Y5();HD();$5();X5()});var J5,Z5=f(()=>{"use strict";s();ne();J5=function(){function e(){this.store=new Map}var t=e.prototype;return t.getInstanceIdForExtensionKey=function(n){var o;return this.store.forEach(function(a,d){if(a.has(n)){if(o)throw new Re("Double registration across instances for an extension key.",C.reserveTag(589103766));o=d}}),o},t.insertExtension=function(n,o){var a=o.instanceId;this.store.has(a)||this.store.set(a,new Map);var d=this.store.get(a);if(d.has(n.extensionKey))throw new Re("Duplicate Registration in same instance.",C.reserveTag(589103767));this.store.forEach(function(c,u){if(u!==a&&c.has(n.extensionKey))throw new Re("Duplicate Registration in different instance.",C.reserveTag(589103768))}),d.set(n.extensionKey,o)},t.updateExtension=function(n,o){var a=this.getInstanceIdForExtensionKey(n);if(a){var d=this.store.get(a);if(d){var c=d.get(n);if(c)return c=Object.assign(Object.assign({},c),o),d.set(n,c),c}}},t.removeExtension=function(n){var o=this.getInstanceIdForExtensionKey(n);if(o){var a=this.store.get(o);if(a){var d=a.get(n);return a.delete(n),d}}},t.getExtension=function(n){var o=this.getInstanceIdForExtensionKey(n);if(o){var a=this.store.get(o);if(a)return a.get(n)}},t.getExtensionsByInstance=function(n){return this.store.get(n)},e}()});var eV,tV,rV=f(()=>{"use strict";s();rt();eV=S(Et());xs();Eb();Z5();tV=function(){function e(){this.onExtensionUpdated=new eV.EventImpl(function(){}),this.extensionStore=new J5}var t=e.prototype;return t.triggerExtensionUpdated=function(n,o){this.onExtensionUpdated.trigger({extension:n,updateType:o})},t.registerExtension=function(n,o,a){var d,c=Zn(),u=(d=a.priority)!==null&&d!==void 0?d:Nt.Primary,l={extensionKey:c},p=a.renderMode===de.Isolated?{componentKey:o,contentType:n,priority:u,isContentAvailable:a.isContentAvailable,renderMode:a.renderMode,instanceId:a.instanceId,componentDimensions:a.componentDimensions}:{componentKey:o,contentType:n,priority:u,renderMode:a.renderMode,instanceId:a.instanceId,componentDimensions:a.componentDimensions};this.extensionStore.insertExtension(l,p);var g={id:c,state:p};return this.triggerExtensionUpdated(g,Yr.Add),g},t.unregisterExtension=function(n){var o=this.extensionStore.removeExtension(n);o&&this.triggerExtensionUpdated({id:n,state:o},Yr.Remove)},t.updateExtension=function(n,o){var a=this,d=function(u,l){u&&a.triggerExtensionUpdated({id:n,state:u},l)};if(!o){d(this.extensionStore.getExtension(n),Yr.ReQuery);return}d(this.extensionStore.updateExtension(n,o),Yr.Modify)},t.getExtensions=function(n,o){var a=this.extensionStore.getExtensionsByInstance(o);if(!a)return[];var d=[];return a.forEach(function(c,u){c.contentType===n&&d.push({state:c,id:u})}),d},t.getExtension=function(n){var o=this.extensionStore.getExtension(n);if(o!==void 0)return{id:n,state:o}},e}()});var nV,BD,Pb,UD=f(()=>{"use strict";s();nV=S(Et()),BD={ContentExtensionHostModule:["SDX::ContentExtension::ContentExtensionHostModule",{initializeExtensionModule:["FireAndForgetMethod",[]],onExtensionUpdate:["FireAndForgetMethod",[["$union",["SDX::ContentExtension::ExtensionRemovedEventArgs","SDX::ContentExtension::ExtensionModifiedEventArgs","SDX::ContentExtension::ExtensionAddedEventArgs"]]]]}]},Pb={ContentExtensionHostModule:nV.RekaServiceRegistry.getNativeService(BD.ContentExtensionHostModule)}});var _b,VD=f(()=>{"use strict";s();UD();_b=function(){function e(){if(!Pb.ContentExtensionHostModule)throw new Error("NativeService not available for ContentExtensionHostModule")}var t=e.prototype;return t.initializeExtensionModule=function(){Pb.ContentExtensionHostModule.initializeExtensionModule()},t.onExtensionUpdate=function(n){Pb.ContentExtensionHostModule.onExtensionUpdate(n)},e}()});function rxe(e,t){switch(e){case Nt.Primary:case Nt.Secondary:switch(t){case un.Invalid:case un.Disabled:return Nt.Disabled;case un.Enabled_Default:return e;case un.Enabled_ForcePrimary:return Nt.Primary}case Nt.Disabled:return e}}function Cm(e,t){var r=e.isContentAvailable(t),n=rxe(e.priority,r),o=r!==un.Invalid;return{contentType:e.contentType,renderMode:e.renderMode,instanceId:e.instanceId,componentKey:e.componentKey,componentDimensions:e.componentDimensions,priority:n,contentId:t,isContentIdValid:o,type:"Isolated"}}var jD=f(()=>{"use strict";s();xs()});var oV,iV=f(()=>{"use strict";s();oV={ContentExtensionHostService:["SDX::ContentExtension::ContentExtensionHostService",{getExtensions:["ReturnsPromiseMethod",["$array","SDX::ContentExtension::ExtensionDescriptor"],["$number","$string"]],getExtensionState:["ReturnsPromiseMethod",["$optional",["$union",["SDX::ContentExtension::IntegratedExtensionSimple","SDX::ContentExtension::IsolatedExtensionSimple","SDX::ContentExtension::TaskPaneExtensionSimple","SDX::ContentExtension::TaskPaneItemExtensionSimple"]]],["SDX::ContentExtension::ExtensionDescriptor","$string"]],unregisterExtensionEventsForContentId:["FireAndForgetMethod",["$string","$string"]]}]}});var aV,WD,sV=f(()=>{"use strict";s();ne();te();aV=S(Et());xs();Rb();Eb();jD();VD();iV();WD=function(){e.getInstance=function(){return this.instance},e.register=function(n){var o=this;this.instance||(this.instance=new e(n),aV.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return o.instance}}))};function e(r){var n=this;this.contentExtensionHostNativeModule=new _b,this.trackedIsolatedExtensions=new Map,this.triggerIsolatedContentEnablementUpdate=function(o,a){var d=n.trackedIsolatedExtensions.get(o);d&&d.forEach(function(c,u){var l=Cm(a,u),p=l.priority!==c.priority||l.isContentIdValid!==c.isContentIdValid;p&&(n.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionModified",extensionKey:o,extension:l}),l.isContentIdValid||d.delete(u))})},this.onExtensionUpdate=this.onExtensionUpdate.bind(this),r.onExtensionUpdated.subscribe(this.onExtensionUpdate)}var t=e.prototype;return t.onExtensionUpdate=function(n){switch(n.updateType){case Yr.Add:{var o={contentType:n.extension.state.contentType,extensionKey:n.extension.id,instanceId:n.extension.state.instanceId,renderMode:n.extension.state.renderMode};this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionAdded",descriptor:o});break}case Yr.Modify:switch(n.extension.state.renderMode){case de.Integrated:{var a={contentType:n.extension.state.contentType,renderMode:n.extension.state.renderMode,instanceId:n.extension.state.instanceId,componentKey:n.extension.state.componentKey,priority:n.extension.state.priority,componentDimensions:n.extension.state.componentDimensions,type:"Integrated"};this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionModified",extensionKey:n.extension.id,extension:a})}break;case de.Isolated:this.triggerIsolatedContentEnablementUpdate(n.extension.id,n.extension.state);break;case de.TaskPane:throw new Re("Taskpane extension is not supported on this platform",C.reserveTag(573384474))}break;case Yr.ReQuery:{n.extension.state.renderMode===de.Isolated&&this.triggerIsolatedContentEnablementUpdate(n.extension.id,n.extension.state);break}case Yr.Remove:{this.contentExtensionHostNativeModule.onExtensionUpdate({type:"ExtensionRemoved",extensionKey:n.extension.id,instanceId:n.extension.state.instanceId});break}default:Me(n.updateType)}},t.getExtensions=function(n,o){var a=hr().getExtensions(n,o);return Promise.resolve(a.map(function(d){return{instanceId:o,contentType:d.state.contentType,extensionKey:d.id,renderMode:d.state.renderMode}}))},t.getExtensionState=function(n,o){var a,d=hr().getExtension(n.extensionKey);if(d===void 0)return Promise.resolve(void 0);var c;switch(d.state.renderMode){case de.Integrated:{var u={type:"Integrated",componentKey:d.state.componentKey,priority:d.state.priority,contentType:d.state.contentType,renderMode:d.state.renderMode,instanceId:d.state.instanceId,componentDimensions:d.state.componentDimensions};c=u;break}case de.Isolated:{if(o===void 0)return x().assertConditionTag(!1,"No content ID provided for isolated extension state.",593081312),Promise.resolve(void 0);var l=Cm(d.state,o);this.trackedIsolatedExtensions.has(d.id)||this.trackedIsolatedExtensions.set(d.id,new Map),(a=this.trackedIsolatedExtensions.get(d.id))===null||a===void 0||a.set(o,l),c=l;break}case de.TaskPane:return Promise.reject(new Error("Taskpane RenderMode is not supported on this platform, for descriptor with extensionKey ".concat(n.extensionKey)));default:return Promise.reject(new Error("Unexpected RenderMode on ExtensionData for descriptor with extensionKey ".concat(n.extensionKey)))}return Promise.resolve(c)},t.unregisterExtensionEventsForContentId=function(n,o){var a,d;x().assertConditionTag(!!(!((a=this.trackedIsolatedExtensions.get(n))===null||a===void 0)&&a.get(o)),"Unregistering for events for a content ID that is not cached.",593081313),(d=this.trackedIsolatedExtensions.get(n))===null||d===void 0||d.delete(o)},e}();WD.ServiceInfo=oV.ContentExtensionHostService});var dV,cV,uV=f(()=>{"use strict";s();dV=S(Tu());rV();VD();sV();cV=function(e){(0,dV.default)(t,e);function t(){var n;return n=e.call(this)||this,n.contentExtensionHostModule=new _b,n.contentExtensionHostModule.initializeExtensionModule(),n}var r=t.prototype;return r.initialize=function(){WD.register(this)},t}(tV)});function hr(){if(zD===void 0){var e=new cV;e.initialize(),zD=e}return zD}var zD,Rb=f(()=>{"use strict";s();uV()});var GD,lV=f(()=>{"use strict";s();UD();GD=function(){function e(){}var t=e.prototype;return t.initializeExtensionModule=function(){},t.onExtensionUpdate=function(n){},e}();GD.ServiceInfo=BD.ContentExtensionHostModule});var fV=f(()=>{"use strict";s();lV()});var bu=f(()=>{"use strict";s();Eb();Rb();fV()});var Ab=be((x7e,$y)=>{s();var oxe=wD();function pV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oxe(n.key),n)}}function ixe(e,t,r){return t&&pV(e.prototype,t),r&&pV(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}$y.exports=ixe,$y.exports.__esModule=!0,$y.exports.default=$y.exports});var mV,gV=f(()=>{"use strict";s();te();bu();xs();mV=function(){function e(r,n){this.extensionKey=r,this.scope=n}var t=e.prototype;return t.getExtension=function(){var n=hr().getExtension(this.extensionKey);if(!n||n.state.renderMode!==de.Integrated)throw x().assertConditionTag(!!n,"No extension data in provider. Querying a removed extension.",592316051),x().assertConditionTag((n==null?void 0:n.state.renderMode)===de.Integrated,"Extension data is not for the Integrated Render Mode.",592316052),new Error("Unable to query extension data within provider.");return{contentType:n.state.contentType,renderMode:n.state.renderMode,instanceId:n.state.instanceId,componentKey:n.state.componentKey,priority:n.state.priority,componentDimensions:n.state.componentDimensions,type:"Integrated"}},e}()});var hV,yV,CV=f(()=>{"use strict";s();te();hV=S(Et());bu();jD();xs();yV=function(){function e(r,n){var o=this;this.extensionKey=r,this.scope=n,this.cachedExtensions={},this.onExtensionUpdate=function(a){if(a.updateType===Yr.Remove){o.teardown();return}a.extension.id===o.extensionKey&&o.updateCachedExtensions()},this.teardown=function(){o.cachedExtensions={},o.subscription.unsubscribe()},this.subscription=hr().onExtensionUpdated.subscribe(this.onExtensionUpdate)}var t=e.prototype;return t.getExtension=function(n){var o=this,a=this.cachedExtensions[n];if(a)return a.extension;var d=hr().getExtension(this.extensionKey);if(!d||d.state.renderMode!==de.Isolated)throw x().assertConditionTag(!!d,"No extension data in provider. Querying a removed extension.",592316053),x().assertConditionTag((d==null?void 0:d.state.renderMode)===de.Isolated,"Extension data is not for the Isolated Render Mode.",592316054),new Error("Unable to query extension data within provider.");var c=Cm(d.state,n),u=Object.assign(Object.assign({},c),{onUpdated:new hV.EventImpl(function(l){var p=o.cachedExtensions[n];p&&(l?p.hasListener=!0:delete o.cachedExtensions[n])})});return this.cachedExtensions[n]={extension:u,hasListener:!1},u},t.updateCachedExtensions=function(){var n=this,o=hr().getExtension(this.extensionKey);if(!o||o.state.renderMode!==de.Isolated){x().assertConditionTag(!!o,"No extension data in provider. Querying a removed extension.",592314635),x().assertConditionTag((o==null?void 0:o.state.renderMode)===de.Isolated,"Extension data is not for the Isolated Render Mode.",592314636);return}var a=o.state;Object.keys(this.cachedExtensions).forEach(function(d){var c=n.cachedExtensions[d],u=c==null?void 0:c.extension;if(!u||!c){x().assertConditionTag(!1,"Trying to access extension before it has been cached.",591152983);return}var l=Cm(a,d),p=u.priority!==l.priority||u.isContentIdValid!==l.isContentIdValid;p&&(u.priority=l.priority,u.isContentIdValid=l.isContentIdValid,u.onUpdated.trigger({})),!c.hasListener&&!l.isContentIdValid&&delete n.cachedExtensions[d]})},e}()});var vV,xV=f(()=>{"use strict";s();ne();te();bu();xs();vV=function(){function e(r,n){this.extensionKey=r,this.scope=n}var t=e.prototype;return t.getExtension=function(){var n=hr().getExtension(this.extensionKey);if(!n||n.state.renderMode!==de.TaskPane)throw x().assertConditionTag(!!n,"No extension data in provider. Querying a removed extension.",573384475),x().assertConditionTag(!n||n.state.renderMode===de.TaskPane,"Extension data is not for the TaskPane Render Mode.",573384476),new Re("Unable to query extension data within provider.",C.reserveTag(573384477));return Object.assign(Object.assign({},n.state),{type:"TaskPane"})},e}()});var TV,bV=f(()=>{"use strict";s();ne();te();bu();xs();TV=function(){function e(r,n){this.extensionKey=r,this.scope=n}var t=e.prototype;return t.getExtension=function(){var n=hr().getExtension(this.extensionKey);if(!n||n.state.renderMode!==de.TaskPaneItem)throw x().assertConditionTag(!!n,"No extension data in provider. Querying a removed extension.",546174347),x().assertConditionTag(!n||n.state.renderMode===de.TaskPaneItem,"Extension data is not for the TaskPaneItem Render Mode.",546174348),new Re("Unable to query extension data within provider.",C.reserveTag(546174349));return Object.assign(Object.assign({},n.state),{type:"TaskPaneItem"})},e}()});var SV,IV,EV=f(()=>{"use strict";s();SV=S(Ab());ne();te();bu();xs();gV();CV();xV();bV();IV=function(){function e(r){this._detached=!1,this._id=r.id;var n={contentType:r.state.contentType,renderMode:r.state.renderMode,instanceId:r.state.instanceId};switch(r.state.renderMode){case de.TaskPane:this._extensionProvider=new vV(this._id,n);break;case de.TaskPaneItem:this._extensionProvider=new TV(this._id,n);break;case de.Isolated:this._extensionProvider=new yV(this._id,n);break;case de.Integrated:this._extensionProvider=new mV(this._id,n);break}}var t=e.prototype;return t.triggerUpdate=function(){hr().updateExtension(this._id,void 0)},t.unregisterExtension=function(){this._detached=!0,hr().unregisterExtension(this._id)},t.updateState=function(n){var o=hr().getExtension(this._id);if(o===void 0)throw x().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005410),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));var a=Object.keys(n).length===1&&n.priority!==void 0;if(a&&o.state.priority===n.priority){this.triggerUpdate();return}hr().updateExtension(this._id,n)},(0,SV.default)(e,[{key:"priority",get:function(){var n=hr().getExtension(this._id);if(n===void 0)throw x().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",595620259),new Re("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"),C.reserveTag(589103770));return n.state.priority},set:function(n){this._detached||this.updateState({priority:n})}},{key:"componentDimensions",get:function(){var n=hr().getExtension(this._id);if(n===void 0)throw x().assertConditionTag(!1,"ExtensionController is asking about an extension with no ExtensionData.",591005411),new Error("ExtensionController with id ".concat(this._id," does not correspond to a cached ExtensionState"));return n.state.componentDimensions},set:function(n){this._detached||this.updateState({componentDimensions:n})}},{key:"detached",get:function(){return this._detached}},{key:"provider",get:function(){return this._extensionProvider}}]),e}()});var PV,_V,RV,AV=f(()=>{"use strict";s();PV=S(Ab()),_V=S(Et());bu();xs();RV=function(){function e(t,r){var n=this;this.contentTypes=t,this.host=r,this.onUpdated=new _V.EventImpl(function(){}),hr().onExtensionUpdated.subscribe(function(o){t.find(function(a){return a===o.extension.state.contentType})&&o.updateType!==Yr.ReQuery&&n.onUpdated.trigger({})})}return(0,PV.default)(e,[{key:"providers",get:function(){var r=this,n=[],o=function(){var c=r.host.extensions[a];c.priority!==Nt.Disabled&&r.contentTypes.find(function(u){return u===c.provider.scope.contentType})&&n.push(c.provider)};for(var a in this.host.extensions)o();return n}}]),e}()});var kV,DV,wV,axe,FV,OV=f(()=>{"use strict";s();kV=S(FD()),DV=S(Tu());ne();wV=S(Et());bu();ND();LD();EV();AV();axe=function(e){(0,DV.default)(t,e);function t(n,o){var a;return a=e.call(this,n)||this,a.onAfterSubscribe=o,a}var r=t.prototype;return r.subscribe=function(o){var a=e.prototype.subscribe.call(this,o);return this.onAfterSubscribe(o,a),a},t}(wV.EventImpl),FV=function(){function e(){var r=this;this.contentTypeRegistrationInfo=new Map,this.extensions={},this.onAfterSubscribe=function(n,o){r.contentTypeRegistrationInfo.forEach(function(a,d){d!==Bt.Empty&&Object.keys(a).forEach(function(c){a[c]&&n({instanceId:c,contentType:d},o)})})},this.onExtensionFirstRequested=new axe(function(){},this.onAfterSubscribe),hr().onExtensionUpdated.subscribe(function(n){switch(n.updateType){case Yr.ReQuery:break;case Yr.Remove:{delete r.extensions[n.extension.id];break}case Yr.Add:case Yr.Modify:{r.ensureExtensionCached(n.extension.id,n.extension.state);break}default:Me(n.updateType)}})}var t=e.prototype;return t.registerExtension=function(n,o,a){var d=hr().registerExtension(n,o,a);return this.ensureExtensionCached(d.id,d.state),Promise.resolve(this.extensions[d.id])},t.getExtensions=function(n,o){var a=this,d=new RV(n,this);return n.forEach(function(c){var u=hr().getExtensions(c,o);u.forEach(function(p){a.ensureExtensionCached(p.id,p.state)});var l=a.contentTypeRegistrationInfo.get(c);if(l!==void 0){if(l[o])return;l[o]=!0}else a.contentTypeRegistrationInfo.set(c,(0,kV.default)({},o,!0));a.onExtensionFirstRequested.trigger({contentType:c,instanceId:o})}),d},t.ensureExtensionCached=function(n,o){this.extensions[n]===void 0&&(this.extensions[n]=new IV({id:n,state:o}))},e}()});function kb(){return qD===void 0&&(qD=new FV),qD}var qD,KD=f(()=>{"use strict";s();OV()});var NV=f(()=>{"use strict";s();KD()});var Eo=f(()=>{"use strict";s();KD();Rb();NV();xs()});var LV=be((Pze,MV)=>{"use strict";s();var sxe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";MV.exports=sxe});var VV=be((Rze,UV)=>{"use strict";s();var dxe=LV();function HV(){}function BV(){}BV.resetWarningCache=HV;UV.exports=function(){function e(n,o,a,d,c,u){if(u!==dxe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:BV,resetWarningCache:HV};return r.PropTypes=r,r}});var WV=be((kze,jV)=>{s();jV.exports=VV()()});var zV,wa,Su=f(()=>{"use strict";s();zV=S(L()),wa=zV.default.createContext(null)});function cxe(e){e()}var GV,qV,KV,YD=f(()=>{"use strict";s();GV=cxe,qV=function(t){return GV=t},KV=function(){return GV}});function uxe(){var e=KV(),t=null,r=null;return{clear:function(){t=null,r=null},notify:function(){e(function(){for(var o=t;o;)o.callback(),o=o.next})},get:function(){for(var o=[],a=t;a;)o.push(a),a=a.next;return o},subscribe:function(o){var a=!0,d=r={callback:o,next:null,prev:r};return d.prev?d.prev.next=d:t=d,function(){!a||t===null||(a=!1,d.next?d.next.prev=d.prev:r=d.prev,d.prev?d.prev.next=d.next:t=d.next)}}}}function vm(e,t){var r,n=YV;function o(g){return u(),n.subscribe(g)}function a(){n.notify()}function d(){p.onStateChange&&p.onStateChange()}function c(){return!!r}function u(){r||(r=t?t.addNestedSub(d):e.subscribe(d),n=uxe())}function l(){r&&(r(),r=void 0,n.clear(),n=YV)}var p={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:d,isSubscribed:c,trySubscribe:u,tryUnsubscribe:l,getListeners:function(){return n}};return p}var YV,Db=f(()=>{"use strict";s();YD();YV={notify:function(){},get:function(){return[]}}});var $V,af,wb=f(()=>{"use strict";s();$V=S(L()),af=$V.useLayoutEffect});function lxe(e){var t=e.store,r=e.context,n=e.children,o=(0,Qy.useMemo)(function(){var c=vm(t);return{store:t,subscription:c}},[t]),a=(0,Qy.useMemo)(function(){return t.getState()},[t]);af(function(){var c=o.subscription;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),a!==t.getState()&&c.notifyNestedSubs(),function(){c.tryUnsubscribe(),c.onStateChange=null}},[o,a]);var d=r||wa;return Qy.default.createElement(d.Provider,{value:o},n)}var Qy,sf,QV=f(()=>{"use strict";s();Qy=S(L());Su();Db();wb();sf=lxe});function Fa(){return Fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fa.apply(this,arguments)}var Fb=f(()=>{"use strict";s()});function Iu(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,a;for(a=0;a<n.length;a++)o=n[a],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}var Ob=f(()=>{"use strict";s()});var JV=be(Zt=>{"use strict";s();var $D=Symbol.for("react.element"),QD=Symbol.for("react.portal"),Nb=Symbol.for("react.fragment"),Mb=Symbol.for("react.strict_mode"),Lb=Symbol.for("react.profiler"),Hb=Symbol.for("react.provider"),Bb=Symbol.for("react.context"),fxe=Symbol.for("react.server_context"),Ub=Symbol.for("react.forward_ref"),Vb=Symbol.for("react.suspense"),jb=Symbol.for("react.suspense_list"),Wb=Symbol.for("react.memo"),zb=Symbol.for("react.lazy"),pxe=Symbol.for("react.offscreen"),XV;XV=Symbol.for("react.module.reference");function Oa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case $D:switch(e=e.type,e){case Nb:case Lb:case Mb:case Vb:case jb:return e;default:switch(e=e&&e.$$typeof,e){case fxe:case Bb:case Ub:case zb:case Wb:case Hb:return e;default:return t}}case QD:return t}}}Zt.ContextConsumer=Bb;Zt.ContextProvider=Hb;Zt.Element=$D;Zt.ForwardRef=Ub;Zt.Fragment=Nb;Zt.Lazy=zb;Zt.Memo=Wb;Zt.Portal=QD;Zt.Profiler=Lb;Zt.StrictMode=Mb;Zt.Suspense=Vb;Zt.SuspenseList=jb;Zt.isAsyncMode=function(){return!1};Zt.isConcurrentMode=function(){return!1};Zt.isContextConsumer=function(e){return Oa(e)===Bb};Zt.isContextProvider=function(e){return Oa(e)===Hb};Zt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===$D};Zt.isForwardRef=function(e){return Oa(e)===Ub};Zt.isFragment=function(e){return Oa(e)===Nb};Zt.isLazy=function(e){return Oa(e)===zb};Zt.isMemo=function(e){return Oa(e)===Wb};Zt.isPortal=function(e){return Oa(e)===QD};Zt.isProfiler=function(e){return Oa(e)===Lb};Zt.isStrictMode=function(e){return Oa(e)===Mb};Zt.isSuspense=function(e){return Oa(e)===Vb};Zt.isSuspenseList=function(e){return Oa(e)===jb};Zt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Nb||e===Lb||e===Mb||e===Vb||e===jb||e===pxe||typeof e=="object"&&e!==null&&(e.$$typeof===zb||e.$$typeof===Wb||e.$$typeof===Hb||e.$$typeof===Bb||e.$$typeof===Ub||e.$$typeof===XV||e.getModuleId!==void 0)};Zt.typeOf=Oa});var Gb=be((Jze,ZV)=>{"use strict";s();ZV.exports=JV()});var a6=be((e9e,i6)=>{"use strict";s();var XD=Gb(),mxe={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},gxe={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},hxe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},n6={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},JD={};JD[XD.ForwardRef]=hxe;JD[XD.Memo]=n6;function e6(e){return XD.isMemo(e)?n6:JD[e.$$typeof]||mxe}var yxe=Object.defineProperty,Cxe=Object.getOwnPropertyNames,t6=Object.getOwnPropertySymbols,vxe=Object.getOwnPropertyDescriptor,xxe=Object.getPrototypeOf,r6=Object.prototype;function o6(e,t,r){if(typeof t!="string"){if(r6){var n=xxe(t);n&&n!==r6&&o6(e,n,r)}var o=Cxe(t);t6&&(o=o.concat(t6(t)));for(var a=e6(e),d=e6(t),c=0;c<o.length;++c){var u=o[c];if(!gxe[u]&&!(r&&r[u])&&!(d&&d[u])&&!(a&&a[u])){var l=vxe(t,u);try{yxe(e,u,l)}catch(p){}}}}return e}i6.exports=o6});function Exe(e,t){var r=e[1];return[t.payload,r+1]}function s6(e,t,r){af(function(){return e.apply(void 0,t)},r)}function Pxe(e,t,r,n,o,a,d){e.current=n,t.current=o,r.current=!1,a.current&&(a.current=null,d())}function _xe(e,t,r,n,o,a,d,c,u,l){if(e){var p=!1,g=null,h=function(){if(!p){var T=t.getState(),b,I;try{b=n(T,o.current)}catch(E){I=E,g=E}I||(g=null),b===a.current?d.current||u():(a.current=b,c.current=b,d.current=!0,l({type:"STORE_UPDATED",payload:{error:I}}))}};r.onStateChange=h,r.trySubscribe(),h();var v=function(){if(p=!0,r.tryUnsubscribe(),r.onStateChange=null,g)throw g};return v}}function qb(e,t){t===void 0&&(t={});var r=t,n=r.getDisplayName,o=n===void 0?function(D){return"ConnectAdvanced("+D+")"}:n,a=r.methodName,d=a===void 0?"connectAdvanced":a,c=r.renderCountProp,u=c===void 0?void 0:c,l=r.shouldHandleStateChanges,p=l===void 0?!0:l,g=r.storeKey,h=g===void 0?"store":g,v=r.withRef,y=v===void 0?!1:v,T=r.forwardRef,b=T===void 0?!1:T,I=r.context,E=I===void 0?wa:I,P=Iu(r,Txe),_=E;return function(M){var H=M.displayName||M.name||"Component",U=o(H),F=Fa({},P,{getDisplayName:o,methodName:d,renderCountProp:u,shouldHandleStateChanges:p,storeKey:h,displayName:U,wrappedComponentName:H,WrappedComponent:M}),z=P.pure;function Y(oe){return e(oe.dispatch,F)}var B=z?wr.useMemo:function(oe){return oe()};function q(oe){var ie=(0,wr.useMemo)(function(){var pc=oe.reactReduxForwardedRef,am=Iu(oe,bxe);return[oe.context,pc,am]},[oe]),Ce=ie[0],se=ie[1],he=ie[2],Be=(0,wr.useMemo)(function(){return Ce&&Ce.Consumer&&(0,d6.isContextConsumer)(wr.default.createElement(Ce.Consumer,null))?Ce:_},[Ce,_]),_e=(0,wr.useContext)(Be),ot=!!oe.store&&!!oe.store.getState&&!!oe.store.dispatch,Ue=!!_e&&!!_e.store,or=ot?oe.store:_e.store,ir=(0,wr.useMemo)(function(){return Y(or)},[or]),ri=(0,wr.useMemo)(function(){if(!p)return Ixe;var pc=vm(or,ot?null:_e.subscription),am=pc.notifyNestedSubs.bind(pc);return[pc,am]},[or,ot,_e]),ni=ri[0],Ra=ri[1],Aa=(0,wr.useMemo)(function(){return ot?_e:Fa({},_e,{subscription:ni})},[ot,_e,ni]),ka=(0,wr.useReducer)(Exe,Sxe,Rxe),sd=ka[0],vt=sd[0],fc=ka[1];if(vt&&vt.error)throw vt.error;var Yl=(0,wr.useRef)(),Er=(0,wr.useRef)(he),qr=(0,wr.useRef)(),ys=(0,wr.useRef)(!1),dd=B(function(){return qr.current&&he===Er.current?qr.current:ir(or.getState(),he)},[or,vt,he]);s6(Pxe,[Er,Yl,ys,he,dd,qr,Ra]),s6(_xe,[p,or,ni,ir,Er,Yl,ys,qr,Ra,fc],[or,ni,ir]);var im=(0,wr.useMemo)(function(){return wr.default.createElement(M,Fa({},dd,{ref:se}))},[se,M,dd]),Bk=(0,wr.useMemo)(function(){return p?wr.default.createElement(Be.Provider,{value:Aa},im):im},[Be,im,Aa]);return Bk}var K=z?wr.default.memo(q):q;if(K.WrappedComponent=M,K.displayName=q.displayName=U,b){var $=wr.default.forwardRef(function(ie,Ce){return wr.default.createElement(K,Fa({},ie,{reactReduxForwardedRef:Ce}))});return $.displayName=U,$.WrappedComponent=M,(0,ZD.default)($,M)}return(0,ZD.default)(K,M)}}var ZD,wr,d6,Txe,bxe,Sxe,Ixe,Rxe,ew=f(()=>{"use strict";s();Fb();Ob();ZD=S(a6()),wr=S(L()),d6=S(Gb());Db();wb();Su();Txe=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],bxe=["reactReduxForwardedRef"],Sxe=[],Ixe=[null,null];Rxe=function(){return[null,0]}});function c6(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function xm(e,t){if(c6(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!Object.prototype.hasOwnProperty.call(t,r[o])||!c6(e[r[o]],t[r[o]]))return!1;return!0}var tw=f(()=>{"use strict";s()});function rw(e,t){var r={},n=function(d){var c=e[d];typeof c=="function"&&(r[d]=function(){return t(c.apply(void 0,arguments))})};for(var o in e)n(o);return r}var u6=f(()=>{"use strict";s()});var l6=f(()=>{"use strict";s()});var nw=f(()=>{"use strict";s()});var ow=f(()=>{"use strict";s();l6();nw()});function Xy(e){return function(r,n){var o=e(r,n);function a(){return o}return a.dependsOnOwnProps=!1,a}}function f6(e){return e.dependsOnOwnProps!==null&&e.dependsOnOwnProps!==void 0?!!e.dependsOnOwnProps:e.length!==1}function Kb(e,t){return function(n,o){var a=o.displayName,d=function(u,l){return d.dependsOnOwnProps?d.mapToProps(u,l):d.mapToProps(u)};return d.dependsOnOwnProps=!0,d.mapToProps=function(u,l){d.mapToProps=e,d.dependsOnOwnProps=f6(e);var p=d(u,l);return typeof p=="function"&&(d.mapToProps=p,d.dependsOnOwnProps=f6(p),p=d(u,l)),p},d}}var iw=f(()=>{"use strict";s();ow()});function kxe(e){return typeof e=="function"?Kb(e,"mapDispatchToProps"):void 0}function Dxe(e){return e?void 0:Xy(function(t){return{dispatch:t}})}function wxe(e){return e&&typeof e=="object"?Xy(function(t){return rw(e,t)}):void 0}var p6,m6=f(()=>{"use strict";s();u6();iw();p6=[kxe,Dxe,wxe]});function Fxe(e){return typeof e=="function"?Kb(e,"mapStateToProps"):void 0}function Oxe(e){return e?void 0:Xy(function(){return{}})}var g6,h6=f(()=>{"use strict";s();iw();g6=[Fxe,Oxe]});function Nxe(e,t,r){return Fa({},r,e,t)}function Mxe(e){return function(r,n){var o=n.displayName,a=n.pure,d=n.areMergedPropsEqual,c=!1,u;return function(p,g,h){var v=e(p,g,h);return c?(!a||!d(v,u))&&(u=v):(c=!0,u=v),u}}}function Lxe(e){return typeof e=="function"?Mxe(e):void 0}function Hxe(e){return e?void 0:function(){return Nxe}}var y6,C6=f(()=>{"use strict";s();Fb();ow();y6=[Lxe,Hxe]});var v6=f(()=>{"use strict";s();nw()});function Uxe(e,t,r,n){return function(a,d){return r(e(a,d),t(n,d),d)}}function Vxe(e,t,r,n,o){var a=o.areStatesEqual,d=o.areOwnPropsEqual,c=o.areStatePropsEqual,u=!1,l,p,g,h,v;function y(P,_){return l=P,p=_,g=e(l,p),h=t(n,p),v=r(g,h,p),u=!0,v}function T(){return g=e(l,p),t.dependsOnOwnProps&&(h=t(n,p)),v=r(g,h,p),v}function b(){return e.dependsOnOwnProps&&(g=e(l,p)),t.dependsOnOwnProps&&(h=t(n,p)),v=r(g,h,p),v}function I(){var P=e(l,p),_=!c(P,g);return g=P,_&&(v=r(g,h,p)),v}function E(P,_){var D=!d(_,p),M=!a(P,l,_,p);return l=P,p=_,D&&M?T():D?b():M?I():v}return function(_,D){return u?E(_,D):y(_,D)}}function aw(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,a=Iu(t,Bxe),d=r(e,a),c=n(e,a),u=o(e,a),l=a.pure?Vxe:Uxe;return l(d,c,u,e,a)}var Bxe,x6=f(()=>{"use strict";s();Ob();v6();Bxe=["initMapStateToProps","initMapDispatchToProps","initMergeProps"]});function sw(e,t,r){for(var n=t.length-1;n>=0;n--){var o=t[n](e);if(o)return o}return function(a,d){throw new Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+d.wrappedComponentName+".")}}function Wxe(e,t){return e===t}function zxe(e){var t=e===void 0?{}:e,r=t.connectHOC,n=r===void 0?qb:r,o=t.mapStateToPropsFactories,a=o===void 0?g6:o,d=t.mapDispatchToPropsFactories,c=d===void 0?p6:d,u=t.mergePropsFactories,l=u===void 0?y6:u,p=t.selectorFactory,g=p===void 0?aw:p;return function(v,y,T,b){b===void 0&&(b={});var I=b,E=I.pure,P=E===void 0?!0:E,_=I.areStatesEqual,D=_===void 0?Wxe:_,M=I.areOwnPropsEqual,H=M===void 0?xm:M,U=I.areStatePropsEqual,F=U===void 0?xm:U,z=I.areMergedPropsEqual,Y=z===void 0?xm:z,B=Iu(I,jxe),q=sw(v,a,"mapStateToProps"),K=sw(y,c,"mapDispatchToProps"),$=sw(T,l,"mergeProps");return n(g,Fa({methodName:"connect",getDisplayName:function(ie){return"Connect("+ie+")"},shouldHandleStateChanges:!!v,initMapStateToProps:q,initMapDispatchToProps:K,initMergeProps:$,pure:P,areStatesEqual:D,areOwnPropsEqual:H,areStatePropsEqual:F,areMergedPropsEqual:Y},B))}}var jxe,ea,T6=f(()=>{"use strict";s();Fb();Ob();ew();tw();m6();h6();C6();x6();jxe=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];ea=zxe()});function dw(){var e=(0,b6.useContext)(wa);return e}var b6,cw=f(()=>{"use strict";s();b6=S(L());Su()});var Gxe,uw=f(()=>{"use strict";s();Gxe=S(L());Su();cw()});var S6=f(()=>{"use strict";s();Su();uw()});function $xe(e,t,r,n){var o=(0,ta.useReducer)(function(y){return y+1},0),a=o[1],d=(0,ta.useMemo)(function(){return vm(r,n)},[r,n]),c=(0,ta.useRef)(),u=(0,ta.useRef)(),l=(0,ta.useRef)(),p=(0,ta.useRef)(),g=r.getState(),h;try{if(e!==u.current||g!==l.current||c.current){var v=e(g);p.current===void 0||!t(v,p.current)?h=v:h=p.current}else h=p.current}catch(y){throw c.current&&(y.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),y}return af(function(){u.current=e,l.current=g,p.current=h,c.current=void 0}),af(function(){function y(){try{var T=r.getState();if(T===l.current)return;var b=u.current(T);if(t(b,p.current))return;p.current=b,l.current=T}catch(I){c.current=I}a()}return d.onStateChange=y,d.trySubscribe(),y(),function(){return d.tryUnsubscribe()}},[r,d]),h}function I6(e){e===void 0&&(e=wa);var t=e===wa?dw:function(){return(0,ta.useContext)(e)};return function(n,o){o===void 0&&(o=Yxe);var a=t(),d=a.store,c=a.subscription,u=$xe(n,o,d,c);return(0,ta.useDebugValue)(u),u}}var ta,Yxe,lw,E6=f(()=>{"use strict";s();ta=S(L());cw();Db();wb();Su();Yxe=function(t,r){return t===r};lw=I6()});var P6=f(()=>{"use strict";s();QV();ew();Su();T6();S6();E6();uw();tw()});var fw,_6=f(()=>{"use strict";s();fw=S(re())});var Ts=f(()=>{"use strict";s();P6();_6();YD();qV(fw.unstable_batchedUpdates)});var pd,pw=f(()=>{"use strict";s();pd="Default_7210d794-9f0f-4d0a-805c-964303b2676b"});function mw(e,t){return e===t}function md(e,t){return function(r){if(mw(r.apiContext||pd,e)){var n=r;t(n)}}}var R6=f(()=>{"use strict";s();pw()});var A6=f(()=>{"use strict";s();R6()});var k6=f(()=>{"use strict";s();pw()});var Eu=f(()=>{"use strict";s();A6();k6()});var xc,on,Na=f(()=>{"use strict";s();(function(e){e.HalfPane="half-pane",e.FullPane="full-pane"})(xc||(xc={}));on=xc});function yr(e){return e.parentId===""?e:void 0}function Ze(e){return e.parentId||e.commentId}var ii=f(()=>{"use strict";s()});function Zxe(e){var t;return{get:function(n){return t&&e(t.key,n)?t.value:cS},put:function(n,o){t={key:n,value:o}},getEntries:function(){return t?[t]:[]},clear:function(){t=void 0}}}function eTe(e,t){var r=[];function n(c){var u=r.findIndex(function(p){return t(c,p.key)});if(u>-1){var l=r[u];return u>0&&(r.splice(u,1),r.unshift(l)),l.value}return cS}function o(c,u){n(c)===cS&&(r.unshift({key:c,value:u}),r.length>e&&r.pop())}function a(){return r}function d(){r=[]}return{get:n,put:o,getEntries:a,clear:d}}function tTe(e){return function(r,n){if(r===null||n===null||r.length!==n.length)return!1;for(var o=r.length,a=0;a<o;a++)if(!e(r[a],n[a]))return!1;return!0}}function uS(e,t){var r=typeof t=="object"?t:{equalityCheck:t},n=r.equalityCheck,o=n===void 0?M6:n,a=r.maxSize,d=a===void 0?1:a,c=r.resultEqualityCheck,u=tTe(o),l=d===1?Zxe(u):eTe(d,u);function p(){var g=l.get(arguments);if(g===cS){if(g=e.apply(null,arguments),c){var h=l.getEntries(),v=h.find(function(y){return c(y.value,g)});v&&(g=v.value)}l.put(arguments,g)}return g}return p.clearCache=function(){return l.clear()},p}var cS,M6,L6=f(()=>{"use strict";s();cS="NOT_FOUND";M6=function(t,r){return t===r}});function rTe(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(n){return typeof n=="function"})){var r=t.map(function(n){return typeof n=="function"?"function "+(n.name||"unnamed")+"()":typeof n}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+r+"]")}return t}function gw(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=function(){for(var d=arguments.length,c=new Array(d),u=0;u<d;u++)c[u]=arguments[u];var l=0,p,g={memoizeOptions:void 0},h=c.pop();if(typeof h=="object"&&(g=h,h=c.pop()),typeof h!="function")throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof h+"]");var v=g,y=v.memoizeOptions,T=y===void 0?r:y,b=Array.isArray(T)?T:[T],I=rTe(c),E=e.apply(void 0,[function(){return l++,h.apply(null,arguments)}].concat(b)),P=e(function(){for(var D=[],M=I.length,H=0;H<M;H++)D.push(I[H].apply(null,arguments));return p=E.apply(null,D),p});return Object.assign(P,{resultFunc:h,memoizedResultFunc:E,dependencies:I,lastResult:function(){return p},recomputations:function(){return l},resetRecomputations:function(){return l=0}}),P};return o}var xn,Tm=f(()=>{"use strict";s();L6();xn=gw(uS)});var ai,Zy=f(()=>{"use strict";s();(function(e){e[e.Execute=0]="Execute",e[e.CheckEnabled=1]="CheckEnabled",e[e.CheckToggled=2]="CheckToggled"})(ai||(ai={}))});var _t,hw=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"})(_t||(_t={}))});function eC(e){switch(e){case"ins":return nt.Insert;case"mod":return nt.Modify;case"del":return nt.Delete;case"load":return nt.Load;default:return nt.Unknown}}var nt,ra,df=f(()=>{"use strict";s();(function(e){e.Unknown="unk",e.Insert="ins",e.Modify="mod",e.Delete="del",e.Load="load"})(nt||(nt={}));ra=nt});var tC,H6=f(()=>{"use strict";s();(function(e){e[e.FailedToCommit=1]="FailedToCommit"})(tC||(tC={}))});var Fe,si=f(()=>{"use strict";s();(function(e){e[e.CommentContextChanged=0]="CommentContextChanged",e[e.LoadComments=1]="LoadComments",e[e.CommentContextReload=2]="CommentContextReload",e[e.CommentsInserted=3]="CommentsInserted",e[e.CommentsDeleted=4]="CommentsDeleted",e[e.CommentsUpdated=5]="CommentsUpdated",e[e.CommentSelected=6]="CommentSelected",e[e.CommentHighlighted=7]="CommentHighlighted",e[e.NextPopulatedContextDetailsUpdated=8]="NextPopulatedContextDetailsUpdated",e[e.CommentError=9]="CommentError",e[e.CommentsChanged=10]="CommentsChanged",e[e.CommentHostCapabilitiesChanged=11]="CommentHostCapabilitiesChanged",e[e.ModelCapabilitiesChanged=12]="ModelCapabilitiesChanged",e[e.UpdateDraftThread=13]="UpdateDraftThread",e[e.ReturnToDraftRequested=14]="ReturnToDraftRequested",e[e.SmartReplyPopulated=15]="SmartReplyPopulated"})(Fe||(Fe={}))});var Ne,Tc=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.ReadOnly=1]="ReadOnly",e[e.LowFidelity=2]="LowFidelity",e[e.Locked=4]="Locked",e[e.Resolved=8]="Resolved",e[e.EditRestricted=16]="EditRestricted",e[e.IsNew=32]="IsNew",e[e.DeleteRestricted=64]="DeleteRestricted",e[e.ReactionRestricted=128]="ReactionRestricted"})(Ne||(Ne={}))});var ro,na,Bo,bc,gd=f(()=>{"use strict";s();ro="CREATE",na="EDIT",Bo="REPLY",bc="METADATA"});var Gt,bm=f(()=>{"use strict";s();(function(e){e[e.AddComment=0]="AddComment",e[e.NextThread=1]="NextThread",e[e.PreviousThread=2]="PreviousThread",e[e.DeleteThread=3]="DeleteThread",e[e.BackKeyPressed=4]="BackKeyPressed",e[e.ShowHideCommentPane=6]="ShowHideCommentPane"})(Gt||(Gt={}))});var Ut,Sc=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.NoComments=1]="NoComments",e[e.AtStartNextCommentIsFirst=2]="AtStartNextCommentIsFirst",e[e.MoreCommentsUpcoming=3]="MoreCommentsUpcoming",e[e.AtFinishNextCommentIsFirst=4]="AtFinishNextCommentIsFirst",e[e.OnlyCommentsInCurrent=5]="OnlyCommentsInCurrent",e[e.DocumentHasComments=6]="DocumentHasComments"})(Ut||(Ut={}))});var Ai,lS=f(()=>{"use strict";s();(function(e){e[e.Like=1]="Like"})(Ai||(Ai={}))});var Pu=f(()=>{"use strict";s();Zy();hw();df();H6();si();Tc();gd();bm();fd();Sc();lS()});var ar,yw=f(()=>{"use strict";s();(function(e){e[e.Undo=-1]="Undo",e[e.Unknown=0]="Unknown",e[e.Create=1]="Create",e[e.Assign=2]="Assign",e[e.Unassign=3]="Unassign",e[e.UnassignAll=4]="UnassignAll",e[e.Schedule=5]="Schedule",e[e.Progress=6]="Progress",e[e.Delete=7]="Delete",e[e.Restore=8]="Restore",e[e.SetTitle=9]="SetTitle",e[e.Priority=10]="Priority"})(ar||(ar={}))});var hd,B6=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.MSGraph=1]="MSGraph",e[e.Loki=2]="Loki"})(hd||(hd={}))});var Ma,U6=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.GetContactsForMentions=2]="GetContactsForMentions",e[e.GetAuthToken=4]="GetAuthToken",e[e.GetSuggestionsDetails=8]="GetSuggestionsDetails"})(Ma||(Ma={}))});var V6=f(()=>{"use strict";s();U6()});function rC(e){return!!e&&e.Id!==void 0&&e.Name!==void 0&&e.UserPrincipalName!==void 0&&e.EmailAddresses!==void 0&&e.SuggestionType!==void 0&&e.SuggestionSubtype!==void 0&&e.HostAppSuggestion!==void 0&&e.Source!==void 0&&e.SuggestionOrigin!==void 0}function _u(e){return!!e&&e.UserId!==void 0&&e.Provider!==void 0}var j6=f(()=>{"use strict";s()});var W6=f(()=>{"use strict";s();j6()});var cf,z6=f(()=>{"use strict";s();(function(e){e[e.Success=0]="Success",e[e.UnknownError=1]="UnknownError",e[e.FailedSilently=2]="FailedSilently",e[e.DialogCanceled=3]="DialogCanceled"})(cf||(cf={}))});var G6=f(()=>{"use strict";s();z6()});var yd=f(()=>{"use strict";s();B6();V6();W6();G6()});function Ru(){if(!Cw)try{Cw=Ny()}catch(e){throw new ge("FeatureGateAPI not initialized",C.reserveTag(589103629),-2130957531)}return Cw}var Cw,vw=f(()=>{"use strict";s();ne();Zl();Jt()});var xw,q6=f(()=>{"use strict";s();xw={LivePersonaPicker:{webSettingName:"LivePersonaPicker",hardcodedPlatforms:{enabled:["win32","android"]}},PersonaFeature:{webSettingName:"PersonaColor"},NewCommentButton:{webSettingName:"NewCommentButton",hardcodedPlatforms:{enabled:["win32"]}},DiscreteHostedComments:{hardcodedPlatforms:{enabled:["web"],disabled:["android"]}},RenderDHCInPane:{},CommentTasks:{webSettingName:"CommentTasks",hardcodedPlatforms:{disabled:["android"]}},TaskPaneWithNewInfrastructure:{webSettingName:"TaskPaneWithNewInfrastructure"},CommentTasksFromReply:{webSettingName:"CommentTasksFromReply",dependencies:["CommentTasks"]},HeadlessBoot:{},HyperlinksInComments:{webSettingName:"HyperlinksInComments"},HyperlinksWithDisplayText:{webSettingName:"HyperlinksWithDisplayText"},ContentNavigation:{webSettingName:"ContentNavigation"},AtMentionFloodgateSurvey:{webSettingName:"AtMentionFloodgateSurvey"},ExtendedDrafting:{webSettingName:"ExtendedDrafting",hardcodedPlatforms:{disabled:["android"]}},RichTextFormattingInWeb:{webSettingName:"RichTextFormattingInWeb"},SmartReplies:{webSettingName:"SmartReplies"},LogDraftCommentIdPair:{webSettingName:"LogDraftCommentIdPair",hardcodedPlatforms:{enabled:["win32","android"]}},RichContentEditIntegrationInWeb:{webSettingName:"RichContentEditIntegration"},NewSelectionInteractions:{webSettingName:"NewSelectionInteractions"},CommentReactions:{webSettingName:"CommentReactions"},LinkToComment:{webSettingName:"LinkToComment"},TruncationUIWithReadMoreText:{webSettingName:"TruncationUIWithReadMoreText"},CtrlEnterTip:{webSettingName:"CtrlEnterTip",hardcodedPlatforms:{enabled:["win32"],disabled:["android"]}},FluentSVRefreshWin32:{},HighlightsAndFontColorInWebComments:{webSettingName:"HighlightsAndFontColorInWebComments",dependencies:["RichContentEditIntegrationInWeb"]},AtMentionHintMessage:{webSettingName:"AtMentionHintMessage"},LivePersonaCardForWeb:{webSettingName:"LivePersonaCardForWeb"},MapBasedStore:{webSettingName:"MapBasedStore"},ContentFiltering:{},CommentTasksMultiAssignCreation:{webSettingName:"CommentTasksMultiAssignCreation",dependencies:["CommentTasks","CommentTasksFromReply"]},DraftSessionRehydration:{webSettingName:"DraftSessionRehydration"},ConsumerEmailLPPEnabled:{webSettingName:"ConsumerEmailLPPEnabled"},ListsInWebComments:{webSettingName:"ListsInWebComments",dependencies:["RichContentEditIntegrationInWeb"]}}});function $r(e,t){var r,n,o;t===void 0&&(t=new Set);var a=xw[e].hardcodedPlatforms;if(a){var d=Q();if(!((r=a.enabled)===null||r===void 0)&&r.includes(d))return!0;if(!((n=a.disabled)===null||n===void 0)&&n.includes(d))return!1}if(!Ru().isFeatureEnabled(e))return!1;t.add(e);var c=(o=xw[e].dependencies)!==null&&o!==void 0?o:[];return c.every(function(u){var l=t.has(u)||$r(u,t);return x().assertConditionTag(l,"Gate ".concat(e," enabled without dependency gate ").concat(u),544482649),l})}var K6=f(()=>{"use strict";s();te();Pr();vw();q6()});function fe(){return Q()!=="android"}function Tn(){return Q()!=="android"}function uf(){return Q()==="win32"}function La(){return $r("LivePersonaPicker")}function Ha(){return $r("PersonaFeature")}function Au(){return $r("NewCommentButton")}function qt(){return $r("DiscreteHostedComments")}function Y6(){return $r("RenderDHCInPane")}function at(){return $r("CommentTasks")}function Sm(){return $r("TaskPaneWithNewInfrastructure")}function Cd(){return $r("CommentTasksFromReply")}function ki(){return $r("HeadlessBoot")}function $6(){return $r("AtMentionFloodgateSurvey")}function Q6(){return $r("ExtendedDrafting")}function X6(){return $r("LogDraftCommentIdPair")}function it(){return $r("NewSelectionInteractions")}function no(){return $r("CommentReactions")}function nC(){return $r("LinkToComment")}function fS(){return $r("CtrlEnterTip")}function Uo(){return $r("FluentSVRefreshWin32")}function sr(){return $r("MapBasedStore")}function Im(){return $r("CommentTasksMultiAssignCreation")}function lf(){return $r("DraftSessionRehydration")}function ku(){return $r("ConsumerEmailLPPEnabled")}function vd(){return!1}function J6(){return Ru().isChangeGateEnabled("LikeHighContrastFix",9121535)}function Z6(){return Ru().isChangeGateEnabled("ThreadActionsFix",9122208)}function ej(){return Ru().isChangeGateEnabled("FilterByTextAnnouncement",9060613)}function tj(){return Ru().isChangeGateEnabled("ResetAllPersistOnClick",9115584)}function rj(){return Ru().isChangeGateEnabled("EnableRibbonCommandingProp",9196520)}var ye=f(()=>{"use strict";s();Zl();Pr();vw();K6()});function nj(e,t){return!e||!t?!1:e.UserId===t.UserId&&e.Provider===t.Provider}function Du(e){return e?rC(e)?e.Name:e.DisplayName:""}function bs(e){if(!e)return"";if(!rC(e))return x().assertConditionTag(!La()||Q()==="android","LPP feature gate should not be enabled",594392914),e.Email;if(e.UserPrincipalName.length>0)return e.UserPrincipalName;if(e.EmailAddresses.length>0&&e.EmailAddresses[0].length>0)return x().assertConditionTag(Q()==="win32","UserPrincipalName is not available, fallback to EmailAddresses",594401410),e.EmailAddresses[0];throw new ge("UserPrincipalName and EmailAddresses, both not available",C.reserveTag(589103706),-2130957499)}function pS(e){if(!e)return"";if(_u(e)){var t=e.Email||e.UserId;return x().assertConditionTag(!!t,"Email and UserId are both not available on IUser object",529024399),t}return bs(e)}function Tw(e){return e.UserId?e.UserId:Fr(e)}function Fr(e){return e.DisplayName!==void 0?e.DisplayName:(x().assertConditionTag(!1,"user.DisplayName is undefined",595133131),e.Email?e.Email:"")}function oj(e){return e.author?e.author:{UserId:e.authorIdentity,Provider:"",DisplayName:e.authorName,Email:e.authorEmail,IsCurrentUser:!0,appAuthorId:e.appAuthorId,authorContextId:e.authorContextId}}function bw(e){return Object.keys(e).length===0&&x().assertConditionTag(!1,"MentioneeMap should not be empty",594641282),e[Object.keys(e)[0]].mentionee}function mS(e,t){t.forEach(function(r){if(r.UserId&&e[r.UserId]){delete e[r.UserId];return}r.Email&&e[r.Email]&&delete e[r.Email]})}function ij(e,t){return t.forEach(function(r){e[pS(r)]={assignee:r}}),e}function Sw(e,t){Object.keys(t).forEach(function(r){e[r]={assignee:t[r].mentionee}})}function aj(e,t){var r=pS(t);e[r]?delete e[r]:e[r]={assignee:t}}function sj(e){var t={};for(var r in e)e[r].stillInDraft&&(t[r]=e[r]);return t}function gS(e){return e.some(function(t){return t.IsCurrentUser})}var ln=f(()=>{"use strict";s();ne();yd();te();Pr();Jt();ye()});function wu(e){return e===ai.CheckEnabled}function Fu(e){return e===ai.CheckToggled}function Ba(e){return e===ai.Execute}var dr,oC=f(()=>{"use strict";s();Zy();(function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.NotHandled=2]="NotHandled"})(dr||(dr={}))});function iC(e){switch(e){case"load":case"ins":case"mod":case"del":return!0;default:return!1}}var Iw=f(()=>{"use strict";s()});function Ss(e){return e.numberOfComments!==void 0&&e.numberOfThreads!==void 0}function Ic(e){return e.comments!==void 0||e.threads!==void 0}function aC(e){return e.threads!==void 0&&e.comments===void 0}function Ec(e){return e.comments!==void 0||e.commentIds!==void 0}function Pc(e){return e.commentIds!==void 0}function _c(e){return e.changes!==void 0}function sC(e){return e.commentId!==void 0}function dC(e){return e.commentId!==void 0}function cC(e){return e.contextDetails!==void 0}function uC(e){return e.modelCapabilityFlags!==void 0}function lC(e){return e.errorType!==void 0}function fC(e){return e.draftId!==void 0}function pf(e){return e.draftId!==void 0}function pC(e){return e.commentId!==void 0&&e.smartReplies!==void 0}var ff,Is=f(()=>{"use strict";s();(function(e){e[e.Thread=0]="Thread",e[e.Reply=1]="Reply"})(ff||(ff={}))});var cj=f(()=>{"use strict";s()});function mC(e){return e.sessionType===ro}function mf(e){return e.sessionType===Bo&&e.threadId!==void 0}function Ua(e){return e.sessionType===na&&e.commentId!==void 0}var hS=f(()=>{"use strict";s();gd()});var Ew,gC,hC,yC,uj=f(()=>{"use strict";s();Ew=function(){function e(){}return e.none="none",e.disc="disc",e.decimalParenthesis="decimal-parenthesis",e.decimalPeriod="decimal-period",e.lowerAlphaParenthesis="lower-alpha-parenthesis",e.lowerAlphaPeriod="lower-alpha-period",e.upperAlphaParenthesis="upper-alpha-parenthesis",e.upperAlphaPeriod="upper-alpha-period",e.lowerRomanParenthesis="lower-roman-parenthesis",e.lowerRomanPeriod="lower-roman-period",e.upperRomanParenthesis="upper-roman-parenthesis",e.upperRomanPeriod="upper-roman-period",e}();(function(e){e[e.None=0]="None",e[e.Bullet=1]="Bullet",e[e.NumberArabic=2]="NumberArabic",e[e.AlphabetLowerCase=3]="AlphabetLowerCase",e[e.AlphabetUpperCase=4]="AlphabetUpperCase",e[e.NumberRomanLowerCase=5]="NumberRomanLowerCase",e[e.NumberRomanUpperCase=6]="NumberRomanUpperCase"})(gC||(gC={}));(function(e){e[e.Parenthesis=0]="Parenthesis",e[e.Period=1]="Period",e[e.Plain=2]="Plain",e[e.Minus=3]="Minus"})(hC||(hC={}));(function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Justify=3]="Justify"})(yC||(yC={}))});var Pw=f(()=>{"use strict";s();yw()});var _w=f(()=>{"use strict";s();oC();Iw();Is();ii();cj();hS();uj();Pw()});var Es=f(()=>{"use strict";s();_w();Pu()});var xd,Rw=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"})(xd||(xd={}))});var mj=f(()=>{"use strict";s()});var Ps,Aw=f(()=>{"use strict";s();(function(e){e[e.Indeterminate=1]="Indeterminate",e[e.SinglePortrait=2]="SinglePortrait",e[e.DoublePortrait=3]="DoublePortrait",e[e.SingleLandscape=4]="SingleLandscape",e[e.DoubleLandscape=5]="DoubleLandscape"})(Ps||(Ps={}))});var gj=f(()=>{"use strict";s();Aw()});function Ou(e){return e.containerType===on.HalfPane}var yS=f(()=>{"use strict";s();Na()});var hj=f(()=>{"use strict";s()});function Nu(e){if(!e)return!1;var t=e;return t.displayMode!==void 0&&typeof t.displayMode=="string"}function gf(e,t){return e.displayMode!==t.displayMode?!1:e.displayMode===oo.Variable?e.desiredHeight===t.desiredHeight:!0}var oo,Mu=f(()=>{"use strict";s();(function(e){e.Normal="Normal",e.FullScreen="FullScreen",e.Variable="Variable"})(oo||(oo={}))});var di,CS=f(()=>{"use strict";s();(function(e){e[e.ViewContainerChanged=0]="ViewContainerChanged",e[e.FocusTriggered=2]="FocusTriggered",e[e.VisibilityChanged=3]="VisibilityChanged",e[e.FoldableLayoutStateChanged=4]="FoldableLayoutStateChanged"})(di||(di={}))});var yj=f(()=>{"use strict";s();Mu();CS();Na()});var Cj=f(()=>{"use strict";s();gj();yS();hj();yj()});var Rc=f(()=>{"use strict";s();Es();mj();Cj()});function Tt(e,t){return m(m({},e),{trackback:t})}function j(e,t,r){return{type:e,payload:t,actionDetail:r}}var ue=f(()=>{"use strict";s();k()});function vS(e,t){return j("ACTIVE_FILTER_UPDATED",t,e)}var vj=f(()=>{"use strict";s();ue()});function xS(e,t){return j("ADD_CONTENT_EXTENSION",{extension:t},e)}var kw=f(()=>{"use strict";s();ue()});function TS(e,t){return j("ADD_TO_CURRENT_MENTIONEES",{mentionee:t},e)}var xj=f(()=>{"use strict";s();ue()});function Pm(e,t){return j("APPLY_COMMENT_CHANGES",{changes:t},e)}var Tj=f(()=>{"use strict";s();ue()});function bS(e,t,r){return j("BEGIN_DRAFTING_FAILURE",{beginDraftingParams:t,errorInfo:r},e)}var Dw=f(()=>{"use strict";s();ue()});function SS(e,t,r,n){return j("BEGIN_DRAFTING_SUCCESS",{draftDetails:t,draftRenderContextType:r,rehydratedDraftParams:n},e)}var ww=f(()=>{"use strict";s();ue()});function IS(e){return j("BEGIN_PROCESSING_COMMIT",{},e)}var Fw=f(()=>{"use strict";s();ue()});function ES(e){return j("BEGIN_PROCESSING_DISCARD",{},e)}var Ow=f(()=>{"use strict";s();ue()});function PS(e){return j("BEGIN_VIEW_INIT",{},e)}var Nw=f(()=>{"use strict";s();ue()});function _S(e,t){return j("CANCEL_COMMENT_CREATE_THREAD",{closeOnDiscard:t},e)}var bj=f(()=>{"use strict";s();ue()});function CC(e,t,r){return j("CANCEL_COMMENT_POST_EDIT",{commentId:t,closeOnDiscard:r},e)}var Sj=f(()=>{"use strict";s();ue()});function RS(e,t,r){return j("CANCEL_COMMENT_REPLY",{commentId:t,closeOnDiscard:r},e)}var Ij=f(()=>{"use strict";s();ue()});function AS(e){return j("CANCEL_DISCARD",{},e)}var Mw=f(()=>{"use strict";s();ue()});function Lu(e,t,r){return j("CLEAR_COMMENT_HIGHLIGHT",{actionSource:t,commentId:r},e)}var Lw=f(()=>{"use strict";s();ue()});function _m(e){return j("CLEAR_COMMENT_SELECTION",{},e)}var Hw=f(()=>{"use strict";s();ue()});function kS(e){return j("CLEAR_LOW_FIDELITY_WARNING",void 0,e)}var Ej=f(()=>{"use strict";s();ue()});function DS(e,t){return j("CLEAR_POST_ERROR_STATE",{commentId:t},e)}var Pj=f(()=>{"use strict";s();ue()});function Rm(e,t){return j("COLLAPSE_CARD",{cardId:t},e)}var _j=f(()=>{"use strict";s();ue()});function wS(e,t){return j("COMMENT_CONTEXT_CHANGED",t,e)}var Rj=f(()=>{"use strict";s();ue()});function Am(e,t){return j("COMMIT_DRAFT",t,e)}function FS(e){switch(e.sessionType){case"CREATE":return"Create";case"REPLY":return"Reply";case"EDIT":return"Edit"}}var Bw=f(()=>{"use strict";s();ue()});function hf(e,t){return j("COMMIT_FAILURE",{commitText:t},e)}var Uw=f(()=>{"use strict";s();ue()});function OS(e,t){return j("DISPATCH_LOAD_THREADS",t,e)}var Aj=f(()=>{"use strict";s();ue()});function Va(e,t){return j("DISPLAY_DRAFT_WARNING",e,t)}var NS=f(()=>{"use strict";s();ue()});function MS(e,t,r){return j("DRAFT_EMPTINESS_CHANGED",{isEmpty:t,draftId:r},e)}var kj=f(()=>{"use strict";s();ue()});var Vw,A,Ve=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.FullPane=1]="FullPane",e[e.HalfPane=2]="HalfPane",e[e.DiscreteIntegrated=4]="DiscreteIntegrated",e[e.DiscreteIsolated=5]="DiscreteIsolated"})(Vw||(Vw={}));A=Vw});function jw(e){return j("",{},e)}var Bn,km=f(()=>{"use strict";s();ne();te();Ve();ue();Bn=jw({renderContextType:A.None,telemetryVisitor:ht(ut.ReviewedAsNotNecessary),trackback:C.reserveTag(595735680)})});function vC(e){return j("END_VIEW_INIT",{},e)}var Ww=f(()=>{"use strict";s();ue()});function Ac(e,t,r){return j("HIGHLIGHT_COMMENT",{commentId:t,actionSource:r},e)}var zw=f(()=>{"use strict";s();ue()});function LS(e,t,r){return j("LOAD_COMMENT",{commentData:t,tasks:r},e)}var Gw=f(()=>{"use strict";s();ue()});function yf(e,t){return j("LOAD_FILTER",t,e)}var Dj=f(()=>{"use strict";s();ue()});function xC(e,t){return j("LOAD_PERSONA_ICON_PROPERTIES",{personaIconPropertiesMap:t},e)}var qw=f(()=>{"use strict";s();ue()});function HS(e,t){return j("VIRTUALIZE_COMMENTS",{threadInfo:t},e)}var Kw=f(()=>{"use strict";s();ue()});function BS(e,t){return j("MOVE_FOCUS_TO_CANVAS",{resource:t},e)}var wj=f(()=>{"use strict";s();ue()});function US(e,t){return j("NEXT_POPULATED_CONTEXT_DETAILS_UPDATED",{nextPopulatedContextDetails:t},e)}var Fj=f(()=>{"use strict";s();ue()});function VS(e,t){return j("ON_INITIAL_RENDER",t,e)}var Oj=f(()=>{"use strict";s();ue()});function jS(e,t){return j("POPULATE_SMART_REPLY",t,e)}var Nj=f(()=>{"use strict";s();ue()});function WS(e,t){return j("PRESENT_LINK_TO_COMMENT",{commentId:t},e)}var Mj=f(()=>{"use strict";s();ue()});function TC(e,t){return j("QUEUE_LOAD_THREADS",t,e)}var Lj=f(()=>{"use strict";s();ue()});function zS(e){return j("READY_TO_RENDER",{},e)}var Hj=f(()=>{"use strict";s();ue()});function Dm(e,t){return j("RELOAD_COMMENTS",t,e)}var Yw=f(()=>{"use strict";s();ue()});function GS(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return j("REMOVE_CONTENT_EXTENSION",{renderModes:t},e)}var Bj=f(()=>{"use strict";s();ue()});function Hu(e){return j("REQUEST_CLOSE_PANE",{},e)}var Uj=f(()=>{"use strict";s();ue()});function qS(e,t){return j("REQUEST_DELETE_POST",{commentId:t},e)}var Vj=f(()=>{"use strict";s();ue()});function wm(e,t,r){return j("REQUEST_DELETE_THREAD",{commentId:t,isTask:r},e)}var jj=f(()=>{"use strict";s();ue()});function KS(e,t,r,n){return j("REQUEST_MODAL_CONFIRMATION",{onConfirm:t,onCancel:r,displayStrings:n},e)}var Wj=f(()=>{"use strict";s();ue()});function YS(e,t,r){return j("REQUEST_REOPEN_THREAD",{commentId:t,isTask:r},e)}var zj=f(()=>{"use strict";s();ue()});function $S(e){return j("REQUEST_SHOW_PANE",{},e)}var Gj=f(()=>{"use strict";s();ue()});function QS(e,t,r){return j("REQUEST_THREAD_RESOLVE",{commentId:t,isTask:r},e)}var qj=f(()=>{"use strict";s();ue()});function bC(e,t){return j("RESOLVE_ATMENTION_CAPABILITY",{capability:t},e)}var $w=f(()=>{"use strict";s();ue()});function Fm(e,t){return j("SAVE_DRAFT",t,e)}var Qw=f(()=>{"use strict";s();ue()});function Om(e){switch(e){case Ae.SelectCard:case Ae.Polite:return!1;case Ae.ExpandCard:case Ae.SelectPost:return!0}}function fn(e,t,r,n,o){return j("SELECT_COMMENT",{selectedCard:t,selectedPost:r,selectType:n,source:o},e)}var Ae,kc=f(()=>{"use strict";s();ue();(function(e){e[e.ExpandCard=0]="ExpandCard",e[e.SelectCard=1]="SelectCard",e[e.SelectPost=2]="SelectPost",e[e.Polite=3]="Polite"})(Ae||(Ae={}))});function XS(e,t,r,n,o,a,d){return j("SELECT_CONTENT",{selectDirection:t,from:a,reason:d,iterableContentTypes:r,restrictToCurrentContext:n,preventLooping:o},e)}var Kj=f(()=>{"use strict";s();ue()});function JS(e){return j("SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT",{},e)}var Yj=f(()=>{"use strict";s();ue()});function ZS(e){return j("SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT",{},e)}var $j=f(()=>{"use strict";s();ue()});function eI(e,t,r){return j("SESSION_REQUEST_STARTED",{params:t,captureSelectedThreadIdBeforeSession:r},e)}var Xw=f(()=>{"use strict";s();ue()});function tI(e,t){return j("SET_COLLABORATORS",t,e)}var Qj=f(()=>{"use strict";s();ue()});function rI(e,t){return j("SET_CONTENT_NAVIGATION_ENABLEMENT",{isEnabled:t},e)}var Xj=f(()=>{"use strict";s();ue()});function nI(e,t){return j("SET_FILTERING_CAPABILITIES",t,e)}var Jj=f(()=>{"use strict";s();ue()});function Bu(e,t,r){return j("SHOW_LOW_FIDELITY_WARNING",{commentId:t,lowFidelityWarningType:r},e)}var Jw=f(()=>{"use strict";s();ue()});function oI(e,t){return j("SHOW_POST_ERROR_STATE",{commentId:t},e)}var Zj=f(()=>{"use strict";s();ue()});function iI(e){return j("TOGGLE_TASK_ASSIGNER_TYPE",{},e)}var e8=f(()=>{"use strict";s();ue()});function aI(e,t){return j("TOP_VISIBLE_THREAD_CHANGED",{threadId:t},e)}var Zw=f(()=>{"use strict";s();ue()});function sI(e,t){return j("UPDATE_COLLABORATORS",t,e)}var t8=f(()=>{"use strict";s();ue()});function dI(e,t){return j("UPDATE_CONTEXT_DETAILS",{contextState:t},e)}var eF=f(()=>{"use strict";s();ue()});function SC(e,t,r){return j("UPDATE_DRAFT_RENDER_CONTEXT",{isClaimingLock:t,draftId:r},e)}var r8=f(()=>{"use strict";s();ue()});function cI(e,t){return j("UPDATE_DRAFT_THREAD",t,e)}var n8=f(()=>{"use strict";s();ue()});function uI(e,t){return j("UPDATE_EXTENSION_PRIORITY",{updates:t},e)}var o8=f(()=>{"use strict";s();ue()});function Cf(e,t){return j("UPDATE_FILTER_RANGE",t,e)}var i8=f(()=>{"use strict";s();ue()});function lI(e,t){return j("UPDATE_MENTIONEES_STILL_IN_DRAFT",{emailsStillInDraft:t},e)}var a8=f(()=>{"use strict";s();ue()});function fI(e,t,r){return j("UPDATE_MODEL_STATE",{modelCapabilityFlags:t,richTextCapabilityFlags:r},e)}var s8=f(()=>{"use strict";s();ue()});function pI(e,t){return j("UPDATE_SELECTED_TASK_ASSIGNEE",{selectedAssignee:t},e)}var d8=f(()=>{"use strict";s();ue()});function mI(e,t){return j("UPDATE_SELECTED_TASK_ASSIGNEES",{selectedAssignee:t},e)}var c8=f(()=>{"use strict";s();ue()});function Nm(e,t){return j("UPDATE_SUGGESTIONS_DETAILS",{details:t},e)}var tF=f(()=>{"use strict";s();ue()});function gI(e,t){return j("VIEW_CONTAINER_CHANGED",{viewContainer:t},e)}var u8=f(()=>{"use strict";s();ue()});function hI(e,t){return j("VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED",{foldableLayoutState:t},e)}var l8=f(()=>{"use strict";s();ue()});function yI(e,t){return j("VIEW_CONTAINER_VISIBILITY_CHANGED",{visibilityState:t},e)}var f8=f(()=>{"use strict";s();ue()});var Td={};Ey(Td,{EMPTY_ACTION:()=>Bn,SelectActionType:()=>Ae,activeFilterUpdated:()=>vS,addContentExtension:()=>xS,addToCurrentMentionees:()=>TS,applyCommentChanges:()=>Pm,beginDraftingFailure:()=>bS,beginDraftingSuccess:()=>SS,beginProcessingCommit:()=>IS,beginProcessingDiscard:()=>ES,beginViewInitialization:()=>PS,cancelCommentCreateThread:()=>_S,cancelCommentPostEdit:()=>CC,cancelCommentReply:()=>RS,cancelDiscard:()=>AS,chainActionDetails:()=>Tt,clearCommentHighlight:()=>Lu,clearCommentSelection:()=>_m,clearLowFidelityWarning:()=>kS,clearPostErrorUI:()=>DS,collapseCard:()=>Rm,commentContextChanged:()=>wS,commitDraft:()=>Am,commitFailure:()=>hf,createAction:()=>j,dispatchLoadThreads:()=>OS,displayDraftWarning:()=>Va,draftEmptinessChanged:()=>MS,emptyAction:()=>jw,endViewInitialization:()=>vC,getCommitDraftSessionType:()=>FS,highlightComment:()=>Ac,loadComment:()=>LS,loadFilter:()=>yf,loadPersonaIconProperties:()=>xC,loadVirtualizedComments:()=>HS,moveFocusToCanvas:()=>BS,nextPopulatedContextDetailsUpdated:()=>US,onInitialRender:()=>VS,populateSmartReply:()=>jS,queueLoadThreads:()=>TC,readyToRender:()=>zS,reloadComments:()=>Dm,removeContentExtensions:()=>GS,requestClosePane:()=>Hu,requestDeletePost:()=>qS,requestDeleteThread:()=>wm,requestModalConfirmation:()=>KS,requestPresentLinkToComment:()=>WS,requestReopenThread:()=>YS,requestShowPane:()=>$S,requestThreadResolve:()=>QS,resolveAtMentionCapability:()=>bC,saveDraft:()=>Fm,selectComment:()=>fn,selectContent:()=>XS,selectFirstThreadInNextCommentContext:()=>JS,selectLastThreadInPreviousCommentContext:()=>ZS,sessionRequestStartedAndLockSelection:()=>eI,setCollaborators:()=>tI,setContentNavigationEnablement:()=>rI,setFilteringCapabilities:()=>nI,shouldSelectActionExpandCard:()=>Om,showLowFidelityWarning:()=>Bu,showPostErrorUI:()=>oI,toggleTaskAssigner:()=>iI,topVisibleThreadChanged:()=>aI,updateCollaborators:()=>sI,updateContextState:()=>dI,updateDraftRenderContext:()=>SC,updateDraftThread:()=>cI,updateExtensionPriority:()=>uI,updateFilterRange:()=>Cf,updateMentioneesStillInDraft:()=>lI,updateModelCapabilities:()=>fI,updateSelectedTaskAssignee:()=>pI,updateSelectedTaskAssignees:()=>mI,updateSuggestionsDetails:()=>Nm,viewContainerChanged:()=>gI,viewContainerFoldableLayoutStateChanged:()=>hI,viewContainerVisibilityChanged:()=>yI});var Cr=f(()=>{"use strict";s();ue();vj();kw();xj();Tj();Dw();ww();Fw();Ow();Nw();bj();Sj();Ij();Mw();Lw();Hw();Ej();Pj();_j();Rj();Bw();Uw();Aj();NS();kj();km();Ww();zw();Gw();Dj();qw();Kw();wj();Fj();Oj();Nj();Mj();Lj();Hj();Yw();Bj();Uj();Vj();jj();Wj();zj();Gj();qj();$w();Qw();kc();Kj();Yj();$j();Xw();Qj();Xj();Jj();Jw();Zj();e8();Zw();t8();eF();r8();n8();o8();i8();a8();s8();d8();c8();tF();u8();l8();f8()});var rF,le,an=f(()=>{"use strict";s();(function(e){e[e.SharedComments=0]="SharedComments",e[e.Canvas=1]="Canvas"})(rF||(rF={}));le=rF});function vf(e){return e!==void 0&&(e.commentFlags&Ne.Resolved)!==0}function p8(e){return e!==le.Canvas}function m8(e){return Om(e)}function CI(e,t){e.addDataField("IsCommentResolved",t,N.SystemMetadata)}var nF=f(()=>{"use strict";s();te();Rc();Cr();an()});function vI(e){return sr()}function ci(e){return sr()}function er(e){return sr()||e.length===0||typeof e[0]=="string"}function Qr(e){return sr()}function Dc(e){return Qr(e)?e.postData:e.commentData}function Or(e,t){return ci(e)?e[t]:e.find(function(r){return r.commentId===t})}var io=f(()=>{"use strict";s();ye()});var xI,Uu,TI=f(()=>{"use strict";s();nF();io();Pu();xI=function(){function e(t,r,n){this.threadIds=t,this.commentData=r,this.pointer=0,this.pointer=Math.max(-1,Math.min(n,t.length))}return e.prototype.next=function(){var t=this.pointer,r=this.threadIds.length-1;if(this.pointer<r)do++this.pointer;while(this.pointer<=r&&vf(Or(this.commentData,this.threadIds[this.pointer])));return this.pointer<r||this.pointer===r&&t<r?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.previous=function(){var t=this.pointer;if(this.pointer>0)do--this.pointer;while(this.pointer>=0&&vf(Or(this.commentData,this.threadIds[this.pointer])));return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.threadIds[this.pointer]}:{done:!0,value:void 0}},e.prototype.currentIndex=function(){return this.pointer},e}(),Uu=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1),this.model=t,this.startThreadIndex=r,this.pointer=0,this.ignoreResolvedThreads=!1,r>t.length?this.pointer=t.length:r<0?this.pointer=-1:this.pointer=r,this.ignoreResolvedThreads=n}return e.prototype.next=function(){var t=this.pointer;if(this.pointer<this.model.length-1)do++this.pointer;while(this.pointer<this.model.length&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&Ne.Resolved));return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var t=this.pointer;if(this.pointer>0)do--this.pointer;while(this.pointer>=0&&(this.model[this.pointer].parentId||this.ignoreResolvedThreads&&this.model[this.pointer].commentFlags&Ne.Resolved));return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}()});var ao,IC=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.GrantUsersAccessFailure=1]="GrantUsersAccessFailure",e[e.InitCreateCommentSession=2]="InitCreateCommentSession",e[e.InitEditCommentSession=3]="InitEditCommentSession",e[e.InitReplyCommentSession=4]="InitReplyCommentSession",e[e.NextThread=5]="NextThread",e[e.PreviousThread=6]="PreviousThread",e[e.DeleteThread=8]="DeleteThread",e[e.CommitFailure=9]="CommitFailure",e[e.HostRequest=10]="HostRequest",e[e.GhostCard=11]="GhostCard"})(ao||(ao={}))});function bI(e){return e.sessionType===ro}function wc(e){return e.sessionType===Bo&&e.threadId!==void 0}function ja(e){return e.sessionType===na&&e.commentId!==void 0}function h8(e){return bI(e)?ao.InitCreateCommentSession:wc(e)?ao.InitReplyCommentSession:ja(e)?ao.InitEditCommentSession:ao.Unknown}var Mm,g8,xf=f(()=>{"use strict";s();IC();df();gd();Mm={CREATE:0,REPLY:1,EDIT:2,METADATA:3},g8={CREATE:nt.Insert,REPLY:nt.Insert,EDIT:nt.Modify,METADATA:nt.Modify}});function Tf(){return SI||(SI=new oTe,SI)}var SI,oTe,II=f(()=>{"use strict";s();oTe=function(){function e(){}return e.prototype.getItem=function(t){return null},e.prototype.setItem=function(t,r){},e.prototype.removeItem=function(t){},e.prototype.storeEditorContentFromDraftSave=function(t,r){},e}()});var bt,Di=f(()=>{"use strict";s();(function(e){e[e.Closed=1]="Closed",e[e.Hidden=2]="Hidden",e[e.Visible=3]="Visible"})(bt||(bt={}))});var Nr,Vu=f(()=>{"use strict";s();(function(e){e[e.NoDraft=1]="NoDraft",e[e.CanAutoDiscard=2]="CanAutoDiscard",e[e.CannotAutoDiscard=3]="CannotAutoDiscard"})(Nr||(Nr={}))});var ju,C8=f(()=>{"use strict";s();(function(e){e[e.HostDefaultOrder=0]="HostDefaultOrder",e[e.NewestFirst=1]="NewestFirst"})(ju||(ju={}))});var bf,bd,v8=f(()=>{"use strict";s();(function(e){e[e.Unknown=0]="Unknown",e[e.UnableToReconcile=1]="UnableToReconcile",e[e.DivergentChange=2]="DivergentChange"})(bf||(bf={}));(function(e){e[e.Unknown=0]="Unknown",e[e.RuntimeTeardown=1]="RuntimeTeardown",e[e.RangeObsolete=2]="RangeObsolete"})(bd||(bd={}))});var Vt,x8=f(()=>{"use strict";s();(function(e){e[e.All=0]="All",e[e.ResolvedOnly=1]="ResolvedOnly",e[e.ActiveOnly=2]="ActiveOnly"})(Vt||(Vt={}))});var T8=f(()=>{"use strict";s();x8()});var oF=f(()=>{"use strict";s();C8();v8();T8()});var b8,iTe,wi,S8=f(()=>{"use strict";s();b8=S(Et()),iTe={ContentFilteredRangeModule:["SDX::ContentFilteredRange::ContentFilteredRangeModule",{getFilteredRange:["ReturnsPromiseMethod","SDX::ContentFilteredRange::GetFilteredRangeResult",["$string","SDX::ContentFilteredRange::GetFilteredRangeArgs"]],teardownFilteredRange:["FireAndForgetMethod",["$string","$string"]],updateFilterForFilteredRangeId:["ReturnsPromiseMethod","$any",["$string","$string","SDX::ContentFilteredRange::HostFilter"]],getExistingFilteredRange:["ReturnsPromiseMethod",["$optional","SDX::ContentFilteredRange::GetFilteredRangeResult"],["$string","$string"]],setActiveFilteredRange:["ReturnsPromiseMethod","$any",["$string",["$optional","$string"]]],getActiveFilteredRangeId:["ReturnsPromiseMethod",["$optional","$string"],["$string"]],getFilterUsers:["ReturnsPromiseMethod",["$array","Mso::Document::Comments::JS::IUser"],["$string"]],getCapabilities:["ReturnsPromiseMethod",["$optional","SDX::ContentFilteredRange::CapabilitiesResult"],["$string"]],getHostSpecificLabels:["ReturnsPromiseMethod","SDX::ContentFilteredRange::HostLabelsResult",["$string"]],onFilteredRangeUpdated:["Event","SDX::ContentFilteredRange::ModuleFilteredRangeUpdatedArgs"],onUserFilterManagerEvent:["Event","SDX::ContentFilteredRange::ModuleUserFilterManagerEventArgs"],onActiveFilterUpdated:["Event","SDX::ContentFilteredRange::ModuleActiveFilterUpdatedEventArgs"]}]},wi={ContentFilteredRangeModule:b8.RekaServiceRegistry.getNativeService(iTe.ContentFilteredRangeModule)}});var EI,EC,I8=f(()=>{"use strict";s();ne();te();EI=S(Et());S8();EC=function(){function e(t){var r=this;if(this.apiContext=t,this.onFilteredRangeUpdated=new EI.EventImpl(function(){}),this.onActiveFilterUpdated=new EI.EventImpl(function(){}),this.onUserFilterManagerEvent=new EI.EventImpl(function(){}),this.onModuleFilteredRangeEventReceived=function(n){n.apiContext===r.apiContext&&r.onFilteredRangeUpdated.trigger(n)},this.onModuleUserFilterManagerEventReceived=function(n){n.apiContext===r.apiContext&&r.onUserFilterManagerEvent.trigger(n.payload)},this.onModuleActiveFilterUpdatedReceived=function(n){n.apiContext===r.apiContext&&r.onActiveFilterUpdated.trigger(n.payload)},!wi.ContentFilteredRangeModule)throw new Error("NativeService not available for ContentFilteredRangeHostAPI");wi.ContentFilteredRangeModule.onFilteredRangeUpdated.subscribe(this.onModuleFilteredRangeEventReceived),wi.ContentFilteredRangeModule.onActiveFilterUpdated.subscribe(this.onModuleActiveFilterUpdatedReceived),wi.ContentFilteredRangeModule.onUserFilterManagerEvent.subscribe(this.onModuleUserFilterManagerEventReceived)}return e.prototype.getFilteredRange=function(t){return wi.ContentFilteredRangeModule.getFilteredRange(this.apiContext,t)},e.prototype.teardownFilteredRange=function(t){wi.ContentFilteredRangeModule.teardownFilteredRange(this.apiContext,t)},e.prototype.getExistingFilteredRange=function(t){return wi.ContentFilteredRangeModule.getExistingFilteredRange(this.apiContext,t)},e.prototype.updateFilterForFilteredRangeId=function(t,r){wi.ContentFilteredRangeModule.updateFilterForFilteredRangeId(this.apiContext,t,r).catch(function(n){return x().assertConditionTag(!1,"Native module call failed with error ".concat(So(n)),537743712)})},e.prototype.setActiveFilteredRange=function(t){wi.ContentFilteredRangeModule.setActiveFilteredRange(this.apiContext,t).catch(function(r){return x().assertConditionTag(!1,"Native module call failed with error ".concat(So(r)),537743713)})},e.prototype.getActiveFilteredRangeId=function(){return wi.ContentFilteredRangeModule.getActiveFilteredRangeId(this.apiContext)},e.prototype.getCapabilities=function(){return wi.ContentFilteredRangeModule.getCapabilities(this.apiContext)},e.prototype.getHostSpecificLabels=function(){return wi.ContentFilteredRangeModule.getHostSpecificLabels(this.apiContext)},e.prototype.getFilterUsers=function(){return wi.ContentFilteredRangeModule.getFilterUsers(this.apiContext)},e}()});var E8=f(()=>{"use strict";s();I8()});var P8=f(()=>{"use strict";s();oF();E8()});var _8,iF,R8=f(()=>{"use strict";s();k();te();_8=S(Et());oF();iF=function(){function e(t,r,n,o,a,d){this.id=t,this.filter=r,this.order=n,this.hostAPI=o,this.supportsUpdates=a,this.onTeardown=d,this.active=!0,this.onRangeUpdated=new _8.EventImpl(function(){})}return e.prototype.getFilter=function(){return this.filter},e.prototype.getOrder=function(){return this.order},e.prototype.isActive=function(){return this.active},e.prototype.teardown=function(){this.active=!1,this.hostAPI.teardownFilteredRange(this.id),this.onTeardown()},e.prototype.canBeUpdated=function(){return this.supportsUpdates},e.prototype.updateFilter=function(t){return this.supportsUpdates?(this.filter=t,this.hostAPI.updateFilterForFilteredRangeId(this.id,m({},t)),!0):!1},e.prototype.onChangeEventReceived=function(t){if(this.active){for(var r=0,n=t.changes;r<n.length;r++){var o=n[r];if(this.active)switch(o.type){case"FilterUpdate":{this.filter=o.updatedFilter;break}case"Insert":this.order=w(w(w([],this.order.slice(0,o.index),!0),[o.content],!1),this.order.slice(o.index),!0);break;case"Remove":this.order=w(w([],this.order.slice(0,o.index),!0),this.order.slice(o.index+1),!0);break;case"Reload":{this.order=o.fullContent,x().assertConditionTag(o.reason===bf.DivergentChange,"Received a full reload for an error reason.",537743690);break}case"Teardown":{this.active=!1;break}}}this.onRangeUpdated.trigger(t)}},e}()});var A8,k8=f(()=>{"use strict";s();k();ne();A8=function(){function e(t){var r=this;this.hostApi=t,this.getFilterUsers=function(){return r.cachedUsers!==void 0?Promise.resolve(r.cachedUsers):r.hostApi.getFilterUsers().then(function(n){return r.cachedUsers=n,n})},this.onUserFilterManagerEventReceived=function(n){if(r.cachedUsers){var o=n.payload.type;switch(o){case"UserAdded":r.cachedUsers=w(w([],r.cachedUsers,!0),[n.payload.user],!1);break;case"UserRemoved":r.cachedUsers=r.cachedUsers.filter(function(a){return a.Provider!==n.payload.user.Provider||a.UserId!==n.payload.user.UserId});break;default:Me(o)}}},this.onUserFilterManagerEvent=this.hostApi.onUserFilterManagerEvent,this.hostApi.onUserFilterManagerEvent.subscribe(this.onUserFilterManagerEventReceived)}return e}()});var D8,w8=f(()=>{"use strict";s();R8();k8();D8=function(){function e(t){var r=this;this.contentFilteredRangeHostAPI=t,this.filteredRanges=new Map,this.createFilteredRange=function(n){return r.contentFilteredRangeHostAPI.getFilteredRange({contentTypes:n.contentTypes,hostFilter:n.filters,supportsFilterUpdates:n.supportsFilterUpdates}).then(function(o){var a=o.filterId,d=new iF(a,o.filter,o.content,r.contentFilteredRangeHostAPI,o.supportsFilterUpdates,function(){return r.onFilterTearDown(a)});return r.filteredRanges.set(a,d),d})},this.getFilteredRange=function(n){return r.filteredRanges.has(n)?Promise.resolve(r.filteredRanges.get(n)):r.contentFilteredRangeHostAPI.getExistingFilteredRange(n).then(function(o){if(o){var a=new iF(o.filterId,o.filter,o.content,r.contentFilteredRangeHostAPI,o.supportsFilterUpdates,function(){return r.onFilterTearDown(n)});return r.filteredRanges.has(n)||r.filteredRanges.set(n,a),a}})},this.setActiveFilteredRange=function(n){r.contentFilteredRangeHostAPI.setActiveFilteredRange(n)},this.getActiveFilteredRangeId=function(){return r.contentFilteredRangeHostAPI.getActiveFilteredRangeId()},this.onEventReceived=function(n){var o=r.filteredRanges.get(n.filterId);o&&o.onChangeEventReceived(n.payload)},this.onFilterTearDown=function(n){r.filteredRanges.delete(n)},this.getCapabilities=function(){return r.contentFilteredRangeHostAPI.getCapabilities()},this.getHostSpecificLabels=function(){return r.contentFilteredRangeHostAPI.getHostSpecificLabels()},this.getUserFilterManager=function(){return r.userFilterManager},this.onActiveFilterUpdated=this.contentFilteredRangeHostAPI.onActiveFilterUpdated,this.contentFilteredRangeHostAPI.onFilteredRangeUpdated.subscribe(this.onEventReceived),this.userFilterManager=new A8(t)}return e}()});function F8(){return!1}var O8=f(()=>{"use strict";s()});function PC(e,t){x().assertConditionTag(!F8()||e===pd,"Received unexpected API Context for Web. This is not fully supported for all APIs.",538035220);var r=PI.get(e);r||(r=new Jl("ContentFilteredRange"),PI.set(e,r)),r.injectInstance(new D8(t))}function _I(e){var t=PI.get(e);if(!t)throw new Re("ContentFilteredRangeAPI not initialized for current apiContenxt ".concat(e,"."),C.reserveTag(538035221));return t.getInstanceOrThrow()}function Lm(e){var t;return((t=PI.get(e))===null||t===void 0?void 0:t.getInstance())!==void 0}var PI,N8=f(()=>{"use strict";s();Eu();ne();tb();te();w8();O8();PI=new Map});var M8=f(()=>{"use strict";s();N8()});var RI,L8,H8=f(()=>{"use strict";s();ne();RI=S(Et()),L8=function(){function e(){this.getCapabilities=function(){return Promise.resolve(void 0)},this.getHostSpecificLabels=function(){throw new Re("Method not implemented.",C.reserveTag(537421141))},this.getExistingFilteredRange=function(t){throw new Re("Method not implemented.",C.reserveTag(537421142))},this.updateFilterForFilteredRangeId=function(t,r){throw new Re("Method not implemented.",C.reserveTag(537421143))},this.setActiveFilteredRange=function(t){throw new Re("Method not implemented.",C.reserveTag(537421144))},this.getActiveFilteredRangeId=function(){throw new Re("Method not implemented.",C.reserveTag(537421145))},this.onFilteredRangeUpdated=new RI.EventImpl(function(){}),this.onUserFilterManagerEvent=new RI.EventImpl(function(){}),this.onActiveFilterUpdated=new RI.EventImpl(function(){})}return e.prototype.getFilteredRange=function(t){throw new Re("Method not implemented.",C.reserveTag(537421138))},e.prototype.teardownFilteredRange=function(t){throw new Re("Method not implemented.",C.reserveTag(537421139))},e.prototype.getOrder=function(t){throw new Re("Method not implemented.",C.reserveTag(537421140))},e.prototype.getFilterUsers=function(){throw new Re("Method not implemented.",C.reserveTag(537421146))},e}()});var B8=f(()=>{"use strict";s();H8()});var Sd=f(()=>{"use strict";s();P8();M8();B8()});var Mr,Sf=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.ReturnToDraft=1]="ReturnToDraft",e[e.GrantAccessFailedSilently=2]="GrantAccessFailedSilently",e[e.CommitFailed=3]="CommitFailed",e[e.GrantAccessCanceled=4]="GrantAccessCanceled"})(Mr||(Mr={}))});function If(e){return e.selectionDetails.lowFidelityWarningType===Mt.Edit}function Hm(e){return e.selectionDetails.lowFidelityWarningType===Mt.DeleteReply}function _C(e){return e.selectionDetails.lowFidelityWarningType===Mt.DeleteThread}function aF(e){return Hm(e)||_C(e)}function Bm(e){return!!e&&(If(e)||Hm(e))}function _s(e){return!!e&&(aF(e)||If(e))}function et(e){return e.selectedPostId!==void 0}function ui(e){return et(e.selectionDetails)?e.selectionDetails.selectedPostId:e.selectedCardId}function sF(e,t){return!!t&&et(t.selectionDetails)&&t.selectionDetails.selectedPostId===e.commentId&&_s(t)}var Mt,so=f(()=>{"use strict";s();(function(e){e[e.Edit=1]="Edit",e[e.DeleteReply=2]="DeleteReply",e[e.DeleteThread=3]="DeleteThread"})(Mt||(Mt={}))});var dF,Se,Ef=f(()=>{"use strict";s();(function(e){e[e.Draft=0]="Draft",e[e.Normal=1]="Normal",e[e.Reply=2]="Reply",e[e.ReplyPostCommitPending=4]="ReplyPostCommitPending",e[e.ReplySessionRequestPending=5]="ReplySessionRequestPending",e[e.CardPostCommitPending=6]="CardPostCommitPending",e[e.DraftPreCommitPending=7]="DraftPreCommitPending",e[e.ReplyPreCommitPending=8]="ReplyPreCommitPending",e[e.Resolved=9]="Resolved",e[e.Loading=10]="Loading",e[e.LowFidelityWarningOnDeleteThread=11]="LowFidelityWarningOnDeleteThread"})(dF||(dF={}));Se=dF});var cr,Id=f(()=>{"use strict";s();(function(e){e[e.InCard=1]="InCard",e[e.InChildPost=2]="InChildPost",e[e.InOtherCard=3]="InOtherCard",e[e.InOtherContextOfThisCard=4]="InOtherContextOfThisCard"})(cr||(cr={}))});var cF,ur,Um=f(()=>{"use strict";s();(function(e){e[e.CancelNewDraft=0]="CancelNewDraft",e[e.CancelReplyDraft=1]="CancelReplyDraft",e[e.CancelPostEdit=2]="CancelPostEdit",e[e.DeleteThread=3]="DeleteThread",e[e.ClosePaneDraft=4]="ClosePaneDraft"})(cF||(cF={}));ur=cF});var U8=f(()=>{"use strict";s()});function V8(e,t,r){var n=fe(),o=r&&n?t-1:t-2;if(o<1)throw new ge(h5,C.reserveTag(589103692),-2130957559);return o===1?n?e.getString(106):e.getString(9):n?e.formatString(107,String(o)):e.formatString(10,String(o))}function j8(e,t){switch(t){case Ut.AtFinishNextCommentIsFirst:return e.getString(8);case Ut.AtStartNextCommentIsFirst:return e.getString(6);case Ut.MoreCommentsUpcoming:case Ut.DocumentHasComments:return e.getString(7);case Ut.OnlyCommentsInCurrent:case Ut.NoComments:case Ut.Unknown:return"";default:Me(t)}}function W8(e,t,r){if(t===Ut.NoComments)return e.getString(13);if(r===A.HalfPane)return e.getString(228)}function z8(e,t,r,n){return r?t?e.getString(16):e.getString(17):Tn()&&n!==void 0&&n!==cr.InCard?e.getString(108):t?e.getString(11):e.getString(12)}function AI(e,t){switch(t){case Mr.ReturnToDraft:return e.getString(110);case Mr.GrantAccessFailedSilently:return e.getString(134);case Mr.GrantAccessCanceled:return e.getString(234);case Mr.CommitFailed:return e.getString(135);case Mr.None:return x().assertConditionTag(!1,"Invalid DraftWarningType: ".concat(t),595686755),""}}function G8(e,t){return t===void 0&&(t=!0),t?e.getStringWithStandardPlaceholders(112):e.getStringWithStandardPlaceholders(113)}function q8(e,t){return t?If(t)?e.getString(35):Hm(t)?e.getString(36):"":""}function K8(e,t){var r=!!t&&uF();try{if(r){var n={hour:"numeric",minute:"2-digit",day:"numeric",month:"long",year:"numeric",timeZone:void 0};return e.toLocaleDateString(t,n)}return x().assertConditionTag(!1,"The locale and/or options arguments are not supported, doesToLocaleDateStringSupportsLocales: ".concat(uF(),", locale Exists: ").concat(!!t),595882385),e.toLocaleDateString()}catch(o){return x().assertConditionTag(!1,"LocaleDateString conversion failed: ".concat(o instanceof Error?o.name:"",", locale Exists: ").concat(!!t,", doesToLocaleDateStringSupportsLocales: ").concat(uF(),", Date: ").concat(e.toString()),595953050),""}}function Y8(e,t){switch(t){case ur.DeleteThread:return sTe(e);case ur.CancelNewDraft:case ur.CancelReplyDraft:case ur.CancelPostEdit:case ur.ClosePaneDraft:return dTe(e)}}function sTe(e){return{title:e.getString(75),confirmButton:e.getString(77),cancelButton:e.getString(78)}}function dTe(e){return{body:e.getString(69),title:e.getString(68),confirmButton:e.getString(70),cancelButton:e.getString(71)}}function $8(e,t){var r={loading:t.loading||e.getString(94),error:t.error||e.getString(95),limitedResults:t.limitedResults||e.getString(96),emptyResults:t.emptyResults||e.getString(93),allResults:t.allResults||e.getString(253),atMentionsModePlaceholderText:t.atMentionsModePlaceholderText||"",pickerModePlaceholderText:t.pickerModePlaceholderText||"",suggestionsAnnouncement:t.suggestionsAnnouncement||e.getString(97),useThisAddress:t.useThisAddress||"",selectedSuggestionAccessibilityLabel:t.selectedSuggestionAccessibilityLabel||e.getStringOrUndefined(198)||"",selectedSuggestionNumberAccessibilityLabel:t.selectedSuggestionNumberAccessibilityLabel||e.getStringOrUndefined(199)||"",suggestionsAvailableAnnouncement:t.suggestionsAvailableAnnouncement||""};return r}function Q8(e){return e.getString(122)}function cTe(e,t){return e.IsCurrentUser?t.getString(127):t.formatString(111,Fr(e))}function X8(e,t){return e.length===0?lF(t):e.length===1?cTe(e[0],t):gS(e)?t.getString(250):t.getString(251)}function J8(e,t,r){if(e.length===0)return fF(t,r);var n=e.map(function(o){return Fr(o)}).join(", ");return t?r.formatString(130,n):r.formatString(129,n)}function lF(e){return e.formatString(111,e.getString(133))}function fF(e,t){return e?t.formatString(130,t.getString(133)):t.formatString(129,t.getString(133))}function Z8(e,t,r,n){var o,a=t===Se.Draft||t===Se.DraftPreCommitPending;return(o=DI(e,r,n))!==null&&o!==void 0?o:a?e.getString(173):e.getString(174)}function kI(e,t,r){var n="";switch(r.length){case 0:{n=e.getString(133);break}case 1:{n=r[0];break}case 2:{n=e.formatString(242,r[0],r[1]);break}case 3:{n=e.formatString(243,r[0],r[1],r[2]);break}default:{n=e.formatString(244,r[0],(r.length-1).toString());break}}var o=t?114:252;return e.formatString(o,n)}function DI(e,t,r){var n=Du(r);if(n)return e.formatString(t?179:178,n)}function eW(e,t){return e?t.getString(176):t.getString(126)}function tW(e,t){return e.length===0?t.getString(181):t.formatString(114,e.map(function(r){return Fr(r)}).join(", "))}function rW(e,t){switch(t){case Vt.ActiveOnly:return e.getString(247);case Vt.ResolvedOnly:return e.getString(246);case Vt.All:return e.getString(245);default:Me(t)}}function wI(e,t){switch(t){case void 0:return;case 1:return e.getString(256);default:return e.formatString(257,t.toString())}}function nW(e,t){switch(t){case 0:return e.getString(254);default:return e.formatString(267,t.toString())}}function oW(e){return e>0?"".concat(e):void 0}function FI(e,t){switch(t){case 0:return e.getString(268);default:return e.formatString(269,t.toString())}}var uF,Vo=f(()=>{"use strict";s();Sd();ne();rt();te();Sc();ln();Jt();vs();ye();Sf();so();Ef();Id();Um();Ve();U8();uF=Qe(function(){try{new Date().toLocaleDateString("i")}catch(e){return e instanceof Error&&e.name==="RangeError"}return!1})});var iW,aW,sW,dW,cW,uW,lW,OI,fW=f(()=>{"use strict";s();iW="SharedComments_Pane_ThreadAnnotation_Id:(.*)_Context:(.*)",aW="SharedComments_Pane_DraftThreadAnnotation_Id:(.*)_Context:(.*)",sW="SharedComments_DHCIsolated_ThreadAnnotation_Id:(.*)_Context:(.*)",dW="SharedComments_DHCIsolated_DraftThreadAnnotation_Id:(.*)_Context:(.*)",cW="SharedComments_DHCIntegrated_ThreadAnnotation_Id:(.*)_Context:(.*)",uW="SharedComments_DHCIntegrated_DraftThreadAnnotation_Id:(.*)_Context:(.*)",lW="unk://SharedCommentsCanvas/(.*)",OI="(.*)"});function Xr(e){return"_".concat(e.renderContextType,"_").concat(e.id)}function NI(e){return"cardEditor".concat(Xr(e))}function MI(e){return"postEditor".concat(Xr(e))}function LI(e){return"postRoot".concat(Xr(e))}function _f(e,t){return t?"draftCardRoot".concat(Xr(e)):"cardRoot".concat(Xr(e))}function RC(){return"GhostCard"}function pW(e){return"sendReplyButton".concat(Xr(e))}function mW(e){return"cancelReplyButton".concat(Xr(e))}function gW(e){return"cardContextMenu".concat(Xr(e))}function hW(e){return"cardRootEditButton".concat(Xr(e))}function pF(e){return"postContextMenu".concat(Xr(e))}function mF(e){return"postEditButton".concat(Xr(e))}function yW(e){return"renderableItemList".concat(Xr(e))}function CW(e,t){return"actionBarButton_".concat(t).concat(Xr(e))}function AC(e){return"editorFocusContainer_".concat(e)}function HI(e){return"draftCancelButton".concat(Xr(e))}function vW(){return"firstPaneElement5F6E8B9B-F2EF-4238-B749-89D6F5F132DD"}function xW(){return"closePaneButton2F313A40-4603-41E4-90DD-12E000896375"}function TW(e){return"viewMoreReply".concat(Xr(e))}function BI(e){return"postTimeStamp".concat(Xr(e))}function UI(e,t){return"".concat(t.replace(/\s/g,"")).concat(Xr(e))}function kC(){return"CommentsListScrollView"}function bW(){return"CommentsList"}function SW(){return"CardListWrapper"}function IW(){return"CardList"}function Vm(){return"EmptyCreatedCommentLie"}function EW(){return"NewCommentButton"}function jm(e){return"draftWarning".concat(Xr(e))}function Wm(e){return"postingTip".concat(Xr(e),";")}function PW(){return"confirm-low-fidelity"}function _W(){return"cancel-low-fidelity"}function RW(){return"next-thread-button"}function AW(){return"previous-thread-button"}function kW(e){return"loadingPlaceholder".concat(Xr(e))}function zm(e){return"persona".concat(Xr(e))}function DW(e){return"DiscreteHostedCommentRoot".concat(Xr(e))}function wW(){return"CommentPaneE026E6C3-C737-4F07-86EA-711651051DBC"}function FW(e,t,r,n){var o;switch(e){case A.DiscreteIntegrated:o=n?uW:cW;break;case A.DiscreteIsolated:o=n?dW:sW;break;case A.FullPane:case A.HalfPane:o=n?aW:iW;break;case A.None:return x().assertConditionTag(!1,"Unexpected render context type: ".concat(e),590995920),"";default:Me(e)}return o.replace(OI,r).replace(OI,t)}function OW(e){return lW.replace(OI,e)}function VI(){return"ReopenThread"}function NW(){return"8342575e-c7c7-4a18-825e-c7ab2c78a0c3"}function MW(){return"lppSuggestionListId"}function LW(e){return"reactionButtonUserList_".concat(e)}function HW(e,t){return"".concat(e,"_").concat(t)}function BW(e){return"commentReactionButton".concat(Xr(e))}function DC(){return"AtMentionMeFilter"}function UW(){return"ActiveStatusFilter"}function VW(){return"ResolvedStatusFilter"}function jW(){return"commentPaneFilterButtonId"}function jI(){return"commentPaneFilterCountId"}function WW(){return"CollabFilterMenu"}function zW(){return"CollabClearFilter"}function WI(e){return"CollabFilterItem_".concat(e)}function GW(e){return"CollabFilterCheckbox_".concat(e)}function qW(e){return"CollabFilterPersona_".concat(e)}var lr=f(()=>{"use strict";s();ne();te();fW();Ve()});function Wu(e){var t=JSON.parse(e);return uTe(t)}function uTe(e){return e.ops?e.ops.map(function(t){return t.insert}).join(""):""}var gF,KW,FC=f(()=>{"use strict";s();ne();Jt();gF=function(){function e(){this.ops=[]}return e.prototype.insert=function(t,r,n){return this.ops.push({insert:t,attributes:r,optional:n}),this},e.prototype.toDelta=function(){return{ops:this.ops}},e.prototype.toJSON=function(){return JSON.stringify(this.toDelta())},e}();(function(e){e[e.Unresolved=0]="Unresolved",e[e.Resolved=1]="Resolved"})(KW||(KW={}))});function YW(e){return e===lTe||e===Ed}var Ed,lTe,OC=f(()=>{"use strict";s();FC();Ed=new gF().insert("").toJSON(),lTe=new gF().toJSON()});function Kt(e){return e===A.FullPane||e===A.HalfPane}function zI(e){return e===A.DiscreteIntegrated||e===A.DiscreteIsolated}function $W(e,t){return e===t?!1:Kt(e)&&Kt(t)}var li=f(()=>{"use strict";s();Ve()});var lt,zu=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Editor=1]="Editor",e[e.Card=2]="Card",e[e.Delete=3]="Delete"})(lt||(lt={}))});function hF(e){return{isDraftEmpty:e.isDraftEmpty,savedDraftContent:e.savedDraftContent,draftWarningState:e.draftWarningState,currentMentionees:e.currentMentionees,selectedTaskAssignee:e.selectedTaskAssignee,selectedTaskAssignees:e.selectedTaskAssignees,smartReplies:e.smartReplies}}function NC(e){return Object.keys(e.drafts)}function Gu(e){var t=0;for(var r in e.drafts)e.drafts.hasOwnProperty(r)&&++t;return t}function Gm(){return{drafts:{},cardIdToDraftIdMap:{},postIdToDraftIdMap:{},pendingDraft:void 0,committedLieId:void 0}}function jo(e){return Gu(e)>0}function fr(e){return jo(e)||yF(e)}function Rs(e){return it()?!1:fr(e)}function yF(e){return e.pendingDraft!==void 0}function CF(e,t){var r,n;try{for(var o=$e(NC(e)),a=o.next();!a.done;a=o.next()){var d=a.value;if(e.drafts[d].pendingState===t)return!0}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}function Wo(e){return CF(e,Fi.None)}function fi(e){return CF(e,Fi.Commit)}function MC(e){return CF(e,Fi.Discard)}function GI(e,t){return MC(e)&&Wo(t)}var Fi,bn=f(()=>{"use strict";s();k();ye();(function(e){e[e.None=0]="None",e[e.Discard=1]="Discard",e[e.Commit=2]="Commit"})(Fi||(Fi={}))});var st,Rf=f(()=>{"use strict";s();(function(e){e[e.Placeholder=0]="Placeholder",e[e.Loaded=1]="Loaded",e[e.Loading=2]="Loading",e[e.NeedsReload=3]="NeedsReload"})(st||(st={}))});function QW(e){return e.pending!==void 0||e.displayingErrorUI!==void 0}var jr,qm=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Post=1]="Post",e[e.Delete=2]="Delete"})(jr||(jr={}))});function Wa(e,t,r,n,o){if(r!==-1&&Gu(t)<Gu(e)){var a=x().createActivityObject("SilentDraftDiscard",ht(ut.GlobalAPI),Ee());a.addDataField("DiscardReason",r??0,N.SystemMetadata),a.addDataField("Source",n,N.SystemMetadata),a.successTag(o)}}function XW(e){if(X6()){var t=x().createActivityObject("MarkCommentCreation",e,Ee());t.addDocumentMetadata(_i.Basic),t.successTag(591152859)}}var LC=f(()=>{"use strict";s();te();ye();bn()});function qu(e,t,r){return e?!t||r||e.numberOfLoadedComments===0?!1:e.selectedThreadIndex===void 0?!0:e.selectedThreadIndex<e.numberOfLoadedThreads:!0}var HC=f(()=>{"use strict";s()});function vF(e){return e===""||e===null?void 0:e}function za(e,t){if(!e[t])return e;var r=m({},e);return delete r[t],r}function xF(e,t,r){var n=r!==void 0&&e[r]===t?r:-1;if(n<0&&(n=e.findIndex(function(a){return a===t})),n<0)return e;var o=w([],V(e),!1);return o.splice(n,1),o}function Ku(e){return e.state===st.Placeholder||e.state===st.Loading}function Km(e,t,r){var n,o;return ci(e)?(o=(n=t[r])===null||n===void 0?void 0:n.map(function(a){return e[a]}))!==null&&o!==void 0?o:[]:e.filter(function(a){return Ze(a)===r})}function qI(e){return{commentId:e,commentBody:Ed,author:{UserId:"",Provider:"",DisplayName:""},parentId:"",commentFlags:0}}function Ym(e,t,r,n){if(r<0)return-1;for(var o=0,a=-1,d=0;d<e.length;d++){if(e[d]===n){a=d;continue}if(o===r)return d;if(o>r)return a===d-1?d-2:d-1;o+=t[e[d]].length}return o===r?e.length:-1}function pTe(e,t){var r=t?Qr(t)?{commentThreadIds:w([],V(t.commentThreadIds),!1),cardPostIds:m({},t.cardPostIds),postData:m({},t.postData)}:{commentData:w(w([],V(t.commentData),!1),V(e),!1)}:sr()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:e};if(!vI(r))return r;var n=void 0;return e.forEach(function(o){if(yr(o))r.commentThreadIds.push(o.commentId),r.cardPostIds[o.commentId]=[o.commentId],n=o.commentId;else if(n===o.parentId)r.cardPostIds[o.parentId].push(o.commentId);else if(r.cardPostIds[o.parentId])r.cardPostIds[o.parentId]=w(w([],V(r.cardPostIds[o.parentId]),!1),[o.commentId],!1),n=o.parentId;else{x().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",528773920);return}r.postData[o.commentId]=o}),r}function BC(e,t,r){for(var n={},o=0;o<e.length;++o)n[e[o].commentId]=Ga(!sr()&&t.includes(Ze(e[o]))?As(e[o].date,e[o].displayDate,r.dataCulture):e[o].displayDate);return n}function Ga(e){return{displayDate:e,displayingErrorUI:!1,pending:jr.None}}function JW(e){return{displayDate:e}}function As(e,t,r){return t||(!e||isNaN(e.getDate())?"":K8(e,r))}function TF(e,t,r,n){for(var o,a=void 0,d=!1,c=0;c<r.length;c++){if(Ze(r[c])!==e){if(d)break;continue}d=!0,x().assertConditionTag(!!t[r[c].commentId],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",540112392);var u=(o=t[r[c].commentId])!==null&&o!==void 0?o:Ga(void 0);u.displayDate||(a||(a=m({},t)),a[r[c].commentId]=m(m({},u),{displayDate:As(r[c].date,r[c].displayDate,n.dataCulture)}))}return a}function ZW(e,t,r,n){var o=void 0;return e.forEach(function(a){var d;if(r[a]){x().assertConditionTag(!!t[a],"PostState unexpectedly missing from PostViewState on ensuring its displayDate - creating with defaults",538035351);var c=(d=t[a])!==null&&d!==void 0?d:Ga(void 0);c.displayDate||(o||(o=m({},t)),o[a]=m(m({},c),{displayDate:As(r[a].date,r[a].displayDate,n.dataCulture)}))}}),o}function e7(e,t){for(var r={},n=0;n<e.length;++n)e[n].parentId===""&&(r[e[n].commentId]=ks(void 0,t));return r}function ks(e,t){var r=t===st.Loading||t===st.Placeholder?{state:t,initialItemCount:1}:{state:t??st.Loaded};return UC(e,r)}function t7(e){var t,r,n={};try{for(var o=$e(e),a=o.next();!a.done;a=o.next()){var d=a.value;n[d.threadId]=UC(void 0,{state:st.Placeholder,initialItemCount:d.itemCount})}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}function UC(e,t){return{loadState:t??{state:st.Loaded},pending:lt.None,alternateId:e}}function bF(e){var t={};return t[e]={pending:jr.Post,displayDate:void 0,displayingErrorUI:!1},t}function SF(e){var t={};return t[e]={pending:lt.Card,loadState:{state:st.Loaded},alternateId:e},t}function qa(e,t,r){var n=oa(e,t,r),o=Ye(r);if(lf()){var a=o==null?void 0:o.commentDraft.sessionConfiguration;(a==null?void 0:a.sessionType)==="EDIT"&&o&&!n.some(function(d){return d===o.threadId})&&n.push(o.threadId)}return!t||n.includes(t.selectedCardId)?n:o&&o.threadId===t.selectedCardId?[o.threadId]:o&&n.includes(o.threadId)?[t.selectedCardId,o.threadId]:[t.selectedCardId]}function Yu(e,t,r,n){if(!t.includes(e))return t;var o=Ye(r);return o&&o.threadId===e?t:n&&et(n.selectionDetails)?(x().assertConditionTag(!1,"Trying to collapse a card while it has a selected post",570529298),t):o&&t.includes(o.threadId)?[o.threadId]:[]}function oa(e,t,r){var n=Ye(r);return Ay(e,function(o){return o===(t==null?void 0:t.selectedCardId)||o===(n==null?void 0:n.threadId)})}function VC(e,t,r){var n=Ye(r);return Ay(e,function(o){return t[o]||o===(n==null?void 0:n.threadId)})}function Sn(e){return{selectedCardId:e,selectionDetails:jC()}}function jC(){return{lowFidelityWarningType:void 0}}function IF(e,t){var r,n=e.draftState.postIdToDraftIdMap[t];if(!n)return e.selectedComment;var o=e.draftState.drafts[n];if(!o.isInCurrentContext)return((r=e.selectedComment)===null||r===void 0?void 0:r.selectedCardId)===o.threadId?void 0:e.selectedComment;var a=Or(Dc(e),t);if(!a)throw new ge(m5,C.reserveTag(589103587),-2130957563);return Sn(Ze(a))}function mTe(e,t){var r=Or(e,t);if(r)return r7(Ze(r),t);throw new ge(mm,C.reserveTag(589103616),-2130957556)}function r7(e,t){var r={selectedPostId:t,lowFidelityWarningType:void 0};return{selectedCardId:e,selectionDetails:r}}function gTe(e,t){var r=Or(e,t);if(r&&r.parentId==="")return Sn(t);throw new ge(mm,C.reserveTag(589103617),-2130957556)}function EF(e,t){switch(t.sessionConfiguration.sessionType){case"CREATE":return Sn(t.sessionConfiguration.draftId);case"EDIT":return mTe(e,t.sessionConfiguration.commentId);case"REPLY":return gTe(e,t.sessionConfiguration.threadId);default:throw new ge(ld,C.reserveTag(589103618),-2130957532)}}function n7(e){switch(e.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":return Sn(e.threadId);case"EDIT":return r7(e.threadId,e.commentDraft.sessionConfiguration.commentId);default:throw new ge(ld,C.reserveTag(577610274),-2130957532)}}function o7(e,t,r){return(t==null?void 0:t.selectedCardId)===e&&et(t.selectionDetails)&&!Rs(r)?Sn(e):t}function i7(e,t){var r=t.payload;return{selectedCardId:r.selectedCard,selectionDetails:hTe(e,r)}}function hTe(e,t){if(t.selectType===Ae.SelectPost)return e&&et(e.selectionDetails)&&t.selectedPost===e.selectionDetails.selectedPostId?e.selectionDetails:{selectedPostId:t.selectedPost,lowFidelityWarningType:void 0};var r=e&&!et(e.selectionDetails)&&t.selectedCard===e.selectedCardId?e.selectionDetails.lowFidelityWarningType:void 0;return{lowFidelityWarningType:r}}function a7(e,t,r){var n,o=t.payload.params;return wc(o)?Sn(r):ja(o)?{selectedCardId:r,selectionDetails:{lowFidelityWarningType:void 0,selectedPostId:o.commentId}}:Sn((n=e==null?void 0:e.selectedCardId)!==null&&n!==void 0?n:r)}function PF(e,t,r){if(r.type==="CLEAR_COMMENT_SELECTION")return!!t&&!Rs(e);if(!t)return!0;if(Rs(e))return r.payload.selectedCard===t.selectedCardId&&!et(t.selectionDetails)&&r.payload.selectType===Ae.ExpandCard;if(r.payload.selectedCard===t.selectedCardId)switch(r.payload.selectType){case Ae.SelectCard:return et(t.selectionDetails);case Ae.Polite:return!1;case Ae.SelectPost:case Ae.ExpandCard:return!0;default:Me(r.payload)}return!0}function s7(e){var t={};return e.commentId&&(t[e.commentId]={pending:lt.None,loadState:{state:st.Loaded},alternateId:e.commentId}),t}function d7(e){var t={};return e.commentId&&(t[e.commentId]={pending:jr.None,displayDate:void 0,displayingErrorUI:!1}),t}function c7(e,t){return e&&e.selectedCardId===t.payload.commentId?Sn(t.payload.commentId):e}function tt(e,t,r){if(e.pendingDraft&&e.pendingDraft.sessionType==="CREATE")return Vm();if(e.committedLieId)return e.committedLieId;var n=Ye(e);if(!(!n||n.commentDraft.sessionConfiguration.sessionType!=="CREATE")&&!(t&&!n.isInCurrentContext)&&!(r&&n.renderContextType!==r&&n.renderContextType!==A.None))return n.commentDraft.sessionConfiguration.draftId}function u7(e,t,r,n){var o=xF(e,r);if(o.length<e.length){var a=Ym(o,t,n.flatIndex);a>=0&&o.splice(a,0,r)}return o}function l7(e,t,r,n){if(!tt(n,!0))return e;var o=tt(n);if(!(!e||!o||!r[o]||r[o].pending!==lt.None)){var a=m({},e),d=t.length;if(a.flatIndex>=d)a.flatIndex=d;else if(a.flatIndex>=0&&t[a.flatIndex].parentId){var c=new Uu(t,a.flatIndex),u=c.next();u.done?a.flatIndex=d:a.flatIndex=c.currentIndex()}return a}}function f7(e,t,r){if(!t)return-1;var n=r?t.selectedCardId:ui(t);return e.findIndex(function(o){return o.commentId===n})}function p7(e,t){return er(e)?t?e.findIndex(function(r){return r===t.selectedCardId}):-1:f7(e,t,!0)}function m7(e,t,r){if(ci(e)){if(!r||!t[r.selectedCardId])return-1;var n=ui(r);return t[r.selectedCardId].findIndex(function(o){return o===n})}return f7(e,r,!1)}function Pd(e){if(!jo(e))return Nr.NoDraft;if(!yTe(e))return Nr.CannotAutoDiscard;var t=Ye(e);return t&&mC(t.commentDraft.sessionConfiguration)?Nr.CannotAutoDiscard:Nr.CanAutoDiscard}function yTe(e){var t=Ka(e),r=t?e.drafts[e.cardIdToDraftIdMap[t]]:void 0;return!!(r!=null&&r.isDraftEmpty)}function g7(e,t){if(t===void 0)return x().assertConditionTag(Object.keys(e).length===0,"Invalid number of drafts.",593762516),e;var r=t.sessionConfiguration.draftId;return x().assertConditionTag(Object.keys(e).length===1,"Invalid number of drafts.",593762517),x().assertConditionTag(!!e[r],"Draft is not in map",593762518),lf()&&r&&Tf().removeItem(r),za(e,r)}function _F(e){return Pd(e)===Nr.CanAutoDiscard?Gm():e}function RF(e,t,r,n,o,a){var d,c;if(e.pendingDraft)switch(e.pendingDraft.sessionType){case"REPLY":if(d=e.pendingDraft.threadId,!t[d])return e;break;case"EDIT":if(c=e.pendingDraft.commentId,!n[c])return e;break;default:return e}else{var u=Ye(e);if(!u||!u.isInCurrentContext)return e;switch(u.commentDraft.sessionConfiguration.sessionType){case"REPLY":d=u.threadId;break;case"EDIT":c=u.commentDraft.sessionConfiguration.commentId;break;default:return e}}if(d&&!r[d]){var l=$u(e,d);return Wa(e,l,3,a,C.reserveTag(539297118)),l}if(c&&!o[c]){var l=$m(e,c);return Wa(e,l,2,a,C.reserveTag(539297119)),l}return e}function KI(e,t){var r=m({},e.drafts),n=!1;return Object.keys(r).forEach(function(o){var a=t(o);a!==r[o].renderContextType&&(r[o]=m(m({},r[o]),{renderContextType:a}),n=!0)}),n?m(m({},e),{drafts:r}):e}function h7(e,t){if(t===bt.Closed){if(Kt(e))return A.None}else if(e===A.DiscreteIntegrated)return A.FullPane;return e}function _d(e){var t=Ye(e);return t?t.commentDraft:void 0}function AF(e){var t=Object.keys(e);if(t.length>1)throw x().assertConditionTag(!1,"Invalid number of drafts.",593762519),new ge("Only a single draft is supported at this time.",C.reserveTag(589103619),-2130957551);if(t.length!==0)return t[0]}function Ka(e){return AF(e.cardIdToDraftIdMap)}function Ds(e){return AF(e.postIdToDraftIdMap)}function Ye(e){var t=e.drafts,r=AF(t);return r?t[r]:void 0}function kF(e){var t,r,n=e.drafts,o=Object.keys(n).filter(function(l){var p;return(p=n[l])===null||p===void 0?void 0:p.isInCurrentContext}).map(function(l){return n[l]});if(o.length===0)return e;var a=m({},e);try{for(var d=$e(o),c=d.next();!c.done;c=d.next()){var u=c.value;switch(u.commentDraft.sessionConfiguration.sessionType){case"CREATE":case"REPLY":case"METADATA":x().assertConditionTag(u.commentDraft.sessionConfiguration.sessionType!=="METADATA","Metadata session removed on context change, but metadata sessions should not be long lived.",545630307),a=$u(a,u.threadId);break;case"EDIT":a=$m(a,u.commentDraft.sessionConfiguration.commentId);break;default:Me(u.commentDraft.sessionConfiguration)}}}catch(l){t={error:l}}finally{try{c&&!c.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}return a}function $u(e,t){var r,n=e.pendingDraft&&wc(e.pendingDraft)&&e.pendingDraft.threadId===t,o=e.cardIdToDraftIdMap[t];return o?m(m({},e),{drafts:g7(e.drafts,(r=e.drafts[o])===null||r===void 0?void 0:r.commentDraft),cardIdToDraftIdMap:za(e.cardIdToDraftIdMap,t),pendingDraft:n?void 0:e.pendingDraft}):n?m(m({},e),{pendingDraft:void 0}):e}function $m(e,t){var r,n=e.pendingDraft&&ja(e.pendingDraft)&&e.pendingDraft.commentId===t,o=e.postIdToDraftIdMap[t];return o?m(m({},e),{drafts:g7(e.drafts,(r=e.drafts[o])===null||r===void 0?void 0:r.commentDraft),postIdToDraftIdMap:za(e.postIdToDraftIdMap,t),pendingDraft:n?void 0:e.pendingDraft}):n?m(m({},e),{pendingDraft:void 0}):e}function DF(e,t,r){var n=$u(e,t),o=Ds(n);if(o){var a=n.postIdToDraftIdMap[o],d=n.drafts[a];d&&d.threadId===t&&(n=$m(n,o))}if(n.pendingDraft&&ja(n.pendingDraft)){var c=n.pendingDraft.commentId,u=r.find(function(l){return l.commentId===c});u&&Ze(u)===t&&(n=m(m({},n),{pendingDraft:void 0}))}return n}function Qm(e){if(Q()==="web"||Q()==="win32"){if(e.tasks===xd.Unknown){if(Q()==="win32")return at();x().assertConditionTag(!1,"Tasks Model Capability state has not been sent by the app.",590144153)}return e.tasks===xd.Enabled&&at()}return at()}function CTe(e,t){return!!(t&&t.draftWarningState&&(!e||!e.draftWarningState||t.commentDraft.sessionConfiguration.draftId!==e.commentDraft.sessionConfiguration.draftId||t.draftWarningState.warningCounter!==e.draftWarningState.warningCounter))}function y7(e,t){return CTe(Ye(e),Ye(t))}function wF(e,t,r,n){var o,a=e.pendingCommentLoad,d=void 0,c=e.expandedComments,u=pTe(t,e);if(a){var l=a.numberOfLoadedComments+t.length,p=a.numberOfLoadedThreads+t.filter(yr).length;l>=a.numberOfTotalComments?(x().assertConditionTag(l===a.numberOfTotalComments,"Loaded more comments than expected",525693528),a=void 0):a=m(m({},a),{numberOfLoadedComments:l,numberOfLoadedThreads:p})}if(e.pendingCommentLoad){var g=e.pendingCommentLoad.selectedThreadIndex,h=g!==void 0&&qu(a,r,n);if(vI(u)&&e.createdCommentLie){var v=tt(e.draftState,!0);if(v&&(!u.cardPostIds[v]||h)){var y=Ym(u.commentThreadIds,u.cardPostIds,e.createdCommentLie.flatIndex);u.cardPostIds[v]||(y<0&&!a&&(x().assertConditionTag(!1,"Draft thread index too large after loading all data, inserting at end",526262789),y=u.commentThreadIds.length),y>=0&&(u.commentThreadIds.splice(y,0,v),u.cardPostIds[v]=[v])),y>=0&&g!==void 0&&y<=g&&(g+=1)}}if(g!==void 0&&h){var T=vI(u)?u.commentThreadIds:u.commentData.filter(yr);if(g>=0&&g<T.length){var b=er(T)?T[g]:T[g].commentId;d=Sn(b),c=qa(c,d,e.draftState)}else throw It("selectedThreadIndex out of bounds"),new ge(g5,C.reserveTag(589103620),-2130957565)}}if(e.selectedComment)if(it()){var I=Ye(e.draftState),E=(o=I==null?void 0:I.threadId)!==null&&o!==void 0?o:tt(e.draftState);E===e.selectedComment.selectedCardId&&(d=e.selectedComment,c=e.expandedComments)}else fr(e.draftState)&&(d=e.selectedComment,c=e.expandedComments);return m(m({},u),{pendingCommentLoad:a,selectedComment:d,expandedComments:c})}function Xm(e,t){var r=Or(e,t);return r!=null&&r.author.DisplayName&&(r!=null&&r.date)?{valid:!0,matchesCurrentUser:!!(r!=null&&r.author.IsCurrentUser),timeElapsed:r!=null&&r.date?Date.now()-r.date.getTime():0}:{valid:!1}}function WC(e,t,r){return er(e)?r?ci(t)?e.some(function(n){return!(t[n].commentFlags&Ne.Resolved)}):t.some(function(n){return n.parentId===""&&!(n.commentFlags&Ne.Resolved)&&e.find(function(o){return o===n.parentId})}):e.length>0:ci(t)?(Ln(!1,"ThreadData and CommentData must align if Map-Based",C.reserveTag(526402327)),!1):r?t.filter(function(n){return n.parentId===""&&!(n.commentFlags&Ne.Resolved)}).length>0:t.length>0}function C7(){var e={atMention:_t.Unknown,newThread:!1,resolve:!1,richTextCapabilities:vTe,tasks:xd.Unknown,virtualized:!1,presentLinkToComment:!1,atMentionEmailAddresses:!1,UIAAnnotationPattern:!1,ContentExtensionHostingDisabled:!1};return e}function v7(e,t){var r,n=e.cardIdToDraftIdMap[t.commentId],o=n?e.drafts[n].commentDraft:void 0;if(o===void 0)return x().assertConditionTag(Object.keys(e.drafts).length===0,"Could not find draft for adding smart replies",590202465),e;var a=t.smartReplies,d=o.sessionConfiguration.sessionType,c=a.length,u=c<=fTe&&c>0;return d==="REPLY"&&u?m(m({},e),{drafts:m(m({},e.drafts),(r={},r[n]=m(m({},e.drafts[n]),{smartReplies:a}),r))}):e}var fTe,vTe,yt=f(()=>{"use strict";s();k();ne();rt();te();Es();Tc();Rw();TI();xf();ii();II();Di();Vu();Ve();Vo();lr();OC();Pr();li();Jt();vs();ye();kc();zu();bn();Rf();qm();so();io();LC();HC();fTe=3;vTe=0});function _r(e){return!!e&&!!e.commentModel}function x7(e){return!!e&&!!e.historyItem}var Af=f(()=>{"use strict";s()});function xTe(e,t,r){for(var n=t;n<e.length;++n)if(e[n].commentId===r.commentId)return n;return-1}function T7(e,t,r,n,o,a){for(var d=[],c=t,u=o;c<=r&&u<=a;){var l=e[c].date;x().assertConditionTag(!!l,"commentDate should not be undefined",595719177),!l||l<=n.history[u].records[0].time?(x().assertConditionTag(e[c].parentId===n.commentId,"comments must belong to the same thread",595719173),d.push({commentModel:e[c]}),++c):(x().assertConditionTag(!n.history[u].commentId,"Unanchored history item should not have commentId",595719178),d.push({historyItem:n.history[u],parentThreadId:n.commentId}),++u)}for(;c<=r;++c)d.push({commentModel:e[c]});for(;u<=a;++u)x().assertConditionTag(!n.history[u].commentId,"Unanchored history item should not have commentId",595719179),d.push({historyItem:n.history[u],parentThreadId:n.commentId});return d}function Qu(e,t){if(!at()||!t||t.history.length===0)return e.map(function(u){return{commentModel:u}});var r=!0;if(!Cd()&&t.commentId!==t.history[0].commentId&&(x().assertConditionTag(!1,"taskItem.commentId must match the first history item",595719174),r=!1),e[0].commentId!==t.commentId&&(x().assertConditionTag(!1,"TaskItem must be paired with the root comment",595719303),r=!1),!r)return e.map(function(u){return{commentModel:u}});var n=[];Cd()||n.push({commentModel:e[0],historyItem:t.history[0]});for(var o=Cd()?0:1,a=Cd()?0:1,d=Cd()?0:1;o<e.length&&d<t.history.length;){var c=xTe(e,o,t.history[d]);c>=0&&(n.push.apply(n,w([],V(T7(e,o,c-1,t,a,d-1)),!1)),x().assertConditionTag(c===0||e[c].parentId===t.commentId,"comments must belong to the same thread",595719175),n.push({commentModel:e[c],historyItem:t.history[d]}),o=c+1,a=d+1),++d}return n.push.apply(n,w([],V(T7(e,o,e.length-1,t,a,t.history.length-1)),!1)),n}function b7(e,t,r,n){var o=[];if(ci(r))er(e)?e.forEach(function(c){o.push.apply(o,w([],V(Qu(Km(r,t,c),n[c])),!1))}):x().assertConditionTag(!1,"Map-Based Data w/o Map-Based Thread Data is unsupported",537515151);else for(var a=0,d=1;d<=r.length;d++)(d===r.length||yr(r[d]))&&(o.push.apply(o,w([],V(Qu(r.slice(a,d),n[r[a].commentId])),!1)),a=d);return o}function S7(e,t,r,n,o,a){var d=[];if(e.length===0)return d;if(ci(r))e.forEach(function(h){d.push.apply(d,w([],V(Qu(Km(r,t,h.contentId),n[h.contentId])),!1))});else for(var c=0,u=0,l=function(v,y,T,b){return v<y.length&&!!yr(y[v])&&T===-1&&y[v].commentId===b};c<e.length&&!(o!=null&&o.newComment_deprecated&&e[c].contentId===tt(a,!0)&&(d.push({commentModel:o.newComment_deprecated}),c++,c>=e.length));){for(var p=-1,g=0;g<=r.length;g++){if(l(g,r,p,e[c].contentId)){p=g;continue}if(p!==-1&&(g===r.length||yr(r[g]))){if(d.push.apply(d,w([],V(Qu(r.slice(p,g),n[r[p].commentId])),!1)),c++,c>=e.length)break;p=-1,l(g,r,p,e[c].contentId)&&(p=g)}}u===c&&c++,u=c}return d}function Ya(e,t){var r=e.find(function(n){return _r(n)&&n.commentModel.commentId===t});if(_r(r))return r.commentModel}function Po(e){var t=e[0];if(_r(t))return t.commentModel;throw new ge(S5,C.reserveTag(589103627),2130957505)}function zC(e){return _r(e)?e.commentModel.parentId:e.parentThreadId}function Xu(e,t){return"".concat(e,"__").concat(t)}function co(e){return _r(e)?e.commentModel.commentId:Xu(e.historyItem.taskId,e.historyItem.records[0].recordId)}function _o(e){return _r(e)?Ze(e.commentModel):e.parentThreadId}function FF(e,t){var r=[],n=e.records[0];switch(n.type){case ar.Create:case ar.UnassignAll:{for(var o=[],a=1;a<e.records.length;a++){var d=e.records[a];d.type===ar.Assign&&o.push(Fr(d.assignee))}r.push({icon:13,description:kI(t,!0,o)});break}case ar.Assign:case ar.Unassign:{for(var o=[],c=[],a=0;a<e.records.length;a++){var d=e.records[a];if(d.type!==ar.Assign&&d.type!==ar.Unassign)return x().assertConditionTag(!1,"Unexpected HistoryRecordType.",528064847),[{icon:0,description:t.getString(119)}];d.type===ar.Assign?o.push(Fr(d.assignee)):c.push(Fr(d.assignee))}o.length>0&&r.push({icon:13,description:kI(t,!0,o)}),c.length>0&&r.push({icon:13,description:kI(t,!1,c)});break}case ar.Progress:return n.completion===100?[{icon:15,description:t.getString(116)}]:[{icon:21,description:t.getString(117)}];case ar.Schedule:return[{icon:17,description:t.getString(118)}];default:return x().assertConditionTag(!1,"Unexpected HistoryRecordType",527759317),[{icon:0,description:t.getString(119)}]}return r.length===0&&r.push({icon:0,description:t.getString(119)}),r}function kf(e,t){return e.findIndex(function(r){return r.length>0&&_o(r[0])===t})}function GC(e,t){return e.some(function(r){return _r(r)&&!!(r.commentModel.commentFlags&Ne.LowFidelity)&&(t===void 0||t===Ze(r.commentModel))})}function qC(e,t,r,n,o){for(var a=[],d=!sr()&&!o&&r!==void 0,c=-1,u=-1,l=0;l<e.length;l+=1){var p=e[l],g=_r(p)?p:void 0;if(!g||t[g.commentModel.commentId]===void 0){for(x().assertConditionTag(!1,"CommentData corruption detected with orphaned reply. Skipping to allow render. commentDataLength: ".concat(e.length," | cardViewStateLength: ").concat(Object.keys(t).length," | insertingThreadLie: ").concat(d),593085888),_r(p)&&++u;!(l+1>=e.length||zC(e[l+1])==="");)++l,_r(e[l])&&++u;continue}if(t[g.commentModel.commentId].pending===lt.Delete&&n){for(_r(p)&&++u;!(l+1>=e.length||zC(e[l+1])==="");)++l,_r(e[l])&&++u;continue}++u,a.push([g]),d&&u===(r==null?void 0:r.flatIndex)&&(c=a.length-1);for(var h=l+1;h<e.length;h+=1){if(p=e[h],_r(p)){var v=zC(p);if(v!==g.commentModel.commentId){x().assertConditionTag(!v,"Orphaned reply",593085889);break}a[a.length-1].push(p),++u}else a[a.length-1].push(p);++l}}return d&&r&&(c!==-1?a.splice(c,0,[{commentModel:r.newComment_deprecated}]):(x().assertConditionTag(r.flatIndex>u,"Failed to find insertion point for lie in getAllRenderableItemThreads",529094429),r.flatIndex===u+1&&a.push([{commentModel:r.newComment_deprecated}]))),a}var zo=f(()=>{"use strict";s();k();ne();te();Pu();ii();yw();ln();Jt();vs();ye();yt();zu();io();Af();Vo()});var Oi,E7,Ju,I7,Df,P7,tr,$I,_7,Ni=f(()=>{"use strict";s();Oi=function(t){return t.filterState.activeFilterId},E7=function(t){var r,n=t.filterState.activeFilterId;if(n)return(r=t.filterState.filteredRanges[n])===null||r===void 0?void 0:r.filter},Ju=function(t,r){return t.filterState.filteredRanges[r]},I7=[],Df=function(t){var r,n,o=t.filterState.activeFilterId;return o&&(n=(r=t.filterState.filteredRanges[o])===null||r===void 0?void 0:r.order)!==null&&n!==void 0?n:I7},P7=function(t){return Df(t).length},tr=function(t){return t.filterState.filteringCapabilities},$I=function(t){return t.filterState.ensureActiveFilter},_7=function(t){return t.filterState.collaborators}});var TTe,Go,QI,el=f(()=>{"use strict";s();ye();TTe={},Go=function(t){return at()?t.commentState.tasks:TTe},QI=function(t){return t.commentState.historyRecordViewState}});var XI,R7,Jm,Mi,JI,wt,In,pi,bTe,Un,A7,k7,ZI,pe,En,Ie,ia,Li,tl,Rd,KC,uo,eE,Lr,tE,rE,nE,St=f(()=>{"use strict";s();Eo();Tm();zo();yt();io();Ni();el();XI=function(t){return t.commentState.contextState.isReadOnly},R7=function(t){return t.commentState.topVisibleThreadId},Jm=function(t){return t.commentState.personaIconPropertiesMap},Mi=function(t){return t.commentState.cardViewState},JI=function(t){return t.commentState.highlightedCommentId},wt=function(t){return Qr(t.commentState)?t.commentState.postData:t.commentState.commentData},In=function(t){return Qr(t.commentState)?t.commentState.commentThreadIds:t.commentState.commentData},pi=function(t){var r=tr(t);if(r){if(Oi(t)){var n=Df(t);return r.supportedContentTypes!==Bt.CommentThread&&(n=n.filter(function(o){return o.contentType===Bt.CommentThread})),n.map(function(o){return o.contentId})}return[]}return In(t)},bTe={},Un=function(t){return Qr(t.commentState)?t.commentState.cardPostIds:bTe},A7=function(t){return In(t).length>0},k7=function(t){return pi(t).length>0},ZI=function(t){return t.commentState.postViewState},pe=function(t){return t.commentState.draftState},En=function(t){return Ye(pe(t))},Ie=function(t){return t.commentState.selectedComment},ia=function(t){return t.commentState.expandedComments},Li=function(t){return t.commentState.pendingCommentLoad},tl=function(t){return t.commentState.selectedThreadIdBeforeCommentSession},Rd=function(t){return t.commentState.contextState},KC=function(t,r,n){return tt(pe(t),r,n)},uo=function(t,r,n){return t.commentState.createdCommentLie&&KC(t,r,n)?t.commentState.createdCommentLie:void 0},eE=function(){return xn([In,Df,Un,wt,uo,pe,Go,tr],function(t,r,n,o,a,d,c,u){return u?S7(r,n,o,c,a,d):b7(t,n,o,c)})},Lr=function(t){return t.commentState.modelCapabilities},tE=function(t){return t.commentState.suggestionsDetails},rE=function(t,r){return r?Or(wt(t),r):void 0},nE=function(){return xn([Df,Ie,tr],function(t,r,n){return!n||!r||t.some(function(o){return o.contentType===Bt.CommentThread&&r.selectedCardId===o.contentId})?r:void 0})}});var mi,Ro,aa,ws,Vn,oE,lo=f(()=>{"use strict";s();Tm();Di();li();yt();St();Ni();mi=function(t){return t.paneState.visibilityState===bt.Visible},Ro=function(t){return t.paneState.visibilityState!==bt.Closed},aa=function(t){return t.paneState.visibilityState},ws=function(t){return t.paneState.componentTree},Vn=function(t){return t.paneState.viewContainer},oE=function(t){return xn([t,tr,pe],function(r,n,o){var a;if(!n&&r&&tt(o)===r.selectedCardId){var d=(a=o.drafts[r.selectedCardId])===null||a===void 0?void 0:a.renderContextType;if(d!==void 0&&!Kt(d))return}return r})}});var me,pn=f(()=>{"use strict";s();ne();te();Jt();me=function(t){return function(r){Ri(r)?x().assertConditionTag(!1,r.message,t):x().assertConditionTag(!1,"Unknown error ".concat(So(r)),t)}}});function Fs(e){switch(e){case on.HalfPane:return A.HalfPane;case on.FullPane:return A.FullPane;default:Me(e)}}var Zm=f(()=>{"use strict";s();ne();Na();Ve()});function D7(){return Promise.resolve(void 0)}var w7=f(()=>{"use strict";s()});function eg(e){return typeof e=="object"&&typeof e.message<"u"&&typeof e.SDXHostAPIErrorCode<"u"}var iE=f(()=>{"use strict";s()});function sn(e,t){return Ri(e)?e.errorCode:eg(e)?e.SDXHostAPIErrorCode:t===void 0?-2147467259:t}var Fc=f(()=>{"use strict";s();Jt();iE()});function STe(e,t,r){var n=En(e),o=Ie(e);if(!n)return o&&et(o.selectionDetails)&&_s(o)?{cancelAction:CC(Tt(r,C.reserveTag(593278744)),o.selectionDetails.selectedPostId,t),sessionType:na}:-2130957522;var a=n.commentDraft.sessionConfiguration.sessionType;switch(n.commentDraft.sessionConfiguration.sessionType){case"CREATE":return{cancelAction:_S(Tt(r,C.reserveTag(593278745)),t),sessionType:a};case"REPLY":return{cancelAction:RS(Tt(r,C.reserveTag(593278746)),n.commentDraft.sessionConfiguration.threadId,t),sessionType:a};case"EDIT":return{cancelAction:CC(Tt(r,C.reserveTag(593278747)),n.commentDraft.sessionConfiguration.commentId,t),sessionType:a};default:return x().assertConditionTag(!1,"Unexpected draft type",593278748),-2130957551}}function tg(e,t,r,n){return function(o,a){var d=a(),c=x().createActivityObject("DiscardDraftAsync",e.telemetryVisitor,Ee()),u=pe(d),l=Ie(d),p=fi(u);c.addDataField("Trackback",e.trackback,N.SystemMetadata),c.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),c.addDataField("CommitPendingAttemptedCancel",p,N.SystemMetadata),c.addDataField("ActionSource",t,N.SystemMetadata);var g=STe(d,r,e);if(typeof g=="number")return c.failTag(C.reserveTag(593278749),g),Promise.resolve(He.Handled);var h=g.sessionType,v=g.cancelAction;return c.addDataField("ActiveSessionType",h,N.SystemMetadata),!p&&(Wo(u)||Bm(l))?(c.addDataField("DiscardUnnecessary",!1,N.SystemMetadata),o(ES(Tt(e,C.reserveTag(593278750)))),n?n(function(){return o(v),c.addDataField("CancelledByUser",!1,N.SystemMetadata),c.successTag(593278751),He.Handled},function(){return c.addDataField("CancelledByUser",!0,N.SystemMetadata),c.successTag(593278752),o(AS(Tt(e,C.reserveTag(593278753)))),He.Canceled}):(o(v),c.successTag(593278754),Promise.resolve(He.Handled))):(c.addDataField("DiscardUnnecessary",!0,N.SystemMetadata),c.successTag(593278755),Promise.resolve(He.Unhandled))}}var aE=f(()=>{"use strict";s();ne();te();Cr();gd();fd();bn();so();St();ue();Ow();Mw()});function Ff(e,t,r){return function(n,o){var a=o(),d=pe(a),c=x().createActivityObject("DiscardDraftIfEmpty",e.telemetryVisitor,Ee()),u=fi(d);c.addDataField("Trackback",e.trackback,N.SystemMetadata),c.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),c.addDataField("CommitPendingAttemptedCancel",u,N.SystemMetadata),c.addDataField("ActionSource",t,N.SystemMetadata);var l=Pd(d);return c.addDataField("DraftDiscardBehavior",l,N.SystemMetadata),l===Nr.CanAutoDiscard?n(tg(e,t,!1)).then(function(p){return c.successTag(539754957),{draftDiscardResult:p,draftDiscardBehavior:l}}):(r!==void 0&&l===Nr.CannotAutoDiscard&&(c.addDataField("DraftWarningReason",r,N.SystemMetadata),n(Va({draftWarningType:Mr.ReturnToDraft,draftWarningReason:r},Tt(e,C.reserveTag(591728722))))),c.successTag(539754958),Promise.resolve({draftDiscardResult:He.Canceled,draftDiscardBehavior:l}))}}var sE=f(()=>{"use strict";s();ne();te();fd();Vu();yt();bn();Sf();St();ue();NS();aE()});function F7(e,t,r,n){var o,a=e.map(function(u){return u.author}),d=(o=t==null?void 0:t.map(function(u){return u.history.map(function(l){return l.records[0].user})}))!==null&&o!==void 0?o:[],c=ky([a,d,n??[]]);return ITe(c,r)}function ITe(e,t){var r={};return e.filter(function(n){var o=Tw(n);return!o||r[o]||YC(t,n)?!1:r[o]=!0})}function OF(e){return e.reduce(function(t,r){var n=ETe(r);return n&&(t[n]=r),t},{})}function O7(e){var t=[];return e.forEach(function(r){t.push({authorName:r.DisplayName||"",authorID:r.UserId,authorColor:ke.COMMENTS_PURPLE,authorImageURL:""})}),t}function ETe(e){if(!(!e.authorID&&!e.authorName))return e.authorID||e.authorName}function YC(e,t){var r=Tw(t);if(r){var n=e[r];if(n!==void 0)return n;if(t.DisplayName&&e[t.DisplayName])return e[t.DisplayName]}}var NF=f(()=>{"use strict";s();rt();ln();hm()});function rl(e,t,r,n,o){return function(a,d){var c=F7(t,r,Jm(d()),o);if(c.length===0)return Promise.resolve();if(n.getPersonaIconPropertiesArray)n.getPersonaIconPropertiesArray(c).then(function(l){a(xC(e,OF(l)))}).catch(me(C.reserveTag(595645964)));else{var u=O7(c);a(xC(e,OF(u)))}return Promise.resolve()}}var $C=f(()=>{"use strict";s();ne();pn();NF();St();qw()});function Os(e,t,r,n,o,a){return function(d,c){var u=c(),l=x().createActivityObject("RequestInitCommentSession",e.telemetryVisitor,Ee()),p=Mm[r.sessionType];return l.addDataField("SessionType",p,N.SystemMetadata),l.addDataField("Trackback",e.trackback,N.SystemMetadata),l.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),l.addDataField("PaneVisibilityState",aa(u),N.SystemMetadata),!at()&&r.sessionType===bc?(l.failTag(591397599,-2130957513),Promise.resolve(d(Bn))):(Lr(u).atMention===_t.Enabled&&D7().catch(me(C.reserveTag(591397600))),d(Ff(e,le.SharedComments,h8(r))).catch(function(g){return me(C.reserveTag(591397602))(g),{draftDiscardResult:He.Unhandled,draftDiscardBehavior:Nr.CannotAutoDiscard}}).then(function(g){var h,v;l.addDataField("DraftDiscardBehavior",g.draftDiscardBehavior,N.SystemMetadata);var y=c(),T=pe(y);if(fr(T)||!sr()&&uo(y)&&bI(r))return l.addDataField("SessionAlreadyRequested",!0,N.SystemMetadata),l.addDataField("DraftRenderContextType",(v=(h=Ye(T))===null||h===void 0?void 0:h.renderContextType)!==null&&v!==void 0?v:A.None,N.SystemMetadata),l.successTag(591397633),Promise.resolve(d(Bn));l.addDataField("SessionAlreadyRequested",!1,N.SystemMetadata),a||d(eI(Tt(e,C.reserveTag(591397634)),r,n));var b=t.beginDraftingAsync(r);return b.then(function(I){if(I.sessionConfiguration===void 0)throw new ge(ld,C.reserveTag(589103630),-2130957532);bI(r)&&Ha()&&d(rl(Tt(e,C.reserveTag(591397635)),[],[],o,I.author));var E=c(),P=PTe(e.renderContextType,aa(E),Vn(E).containerType);return l.addDataField("DraftRenderContextType",P,N.SystemMetadata),x().assertConditionTag(P===e.renderContextType||e.renderContextType===A.None,"Requested starting a draft in RenderContextType:".concat(e.renderContextType," but had to lock to RenderContextType:").concat(P," based on pane state"),554714642),l.successTag(591397640),d(SS(Tt(e,C.reserveTag(591397641)),I,P,a))}).catch(function(I){var E=I.message||I;return E.includes("LegacyConvertDialog")?l.successTag(591397643):l.failTag(591397642,sn(I)),d(bS(Tt(e,C.reserveTag(591397644)),r,I))})}))}}function PTe(e,t,r){return t!==bt.Closed&&e!==A.DiscreteIsolated?Fs(r):Kt(e)?t===bt.Closed?A.None:Fs(r):e}var QC=f(()=>{"use strict";s();ne();te();Es();gd();xf();Di();Vu();Ve();Zm();li();w7();pn();Jt();Fc();vs();ye();yt();bn();St();lo();ue();an();Dw();ww();km();Xw();sE();$C()});var sa,XC=f(()=>{"use strict";s();Sd();sa={mentionsToCurrentUser:!1,AICursor:{stubField:""},CommentThread:{resolutionStatus:Vt.All},TrackedChange:{stubField:""},contentOrder:ju.HostDefaultOrder,includeAllDocumentContexts:!1,userFilter:void 0}});function _Te(e){var t=Oi(e);if(!t)return!1;var r=Ju(e,t);return!!r&&r.canUpdateFilter}function N7(e){if(_Te(e))return Oi(e)}function Of(e,t){if(!tr(e))return!0;var r=Df(e);return r.find(function(n){return n.contentId===t})!==void 0}function MF(e,t){var r;return(!t.supportsMentionToMeFilter||e.mentionsToCurrentUser===sa.mentionsToCurrentUser)&&((r=e.CommentThread)===null||r===void 0?void 0:r.resolutionStatus)===sa.CommentThread.resolutionStatus&&(!t.supportsFilterByUser||e.userFilter===void 0||e.userFilter.length===0)}function rg(e,t){t.addDataField("HasFiltereringCapabilities",!!e.filterState.filteringCapabilities,N.SystemMetadata);var r=!1,n=Oi(e);if(n){var o=e.filterState.filteredRanges[n],a=e.filterState.filteringCapabilities;o&&a&&(r=!MF(o.filter,a))}t.addDataField("IsFilterApplied",r,N.SystemMetadata)}var LF,Ad=f(()=>{"use strict";s();Sd();te();XC();Ni();LF=[Vt.ActiveOnly,Vt.ResolvedOnly]});function M7(e,t,r,n,o){return function(a,d){var c=x().createActivityObject("CommentReaction",e.telemetryVisitor,Ee());c.addDataField("UserReactionAction",o,N.SystemMetadata);var u=d();if(r.sessionType===bc){var l=Xm(wt(u),r.threadId);l.valid&&(c.addDataField("MatchesCommentAuthor",l.matchesCurrentUser,N.SystemMetadata),c.addDataField("ThreadCreationDeltaMs",l.timeElapsed,N.SystemMetadata))}rg(u,c);var p=t.beginDraftingAsync(r);p.then(function(g){g.updateProperties("Reaction",{type:"Reaction",reactionType:n,isActive:o}),g.commit(),g.endDrafting(),c.successTag(587317280)}).catch(function(g){c.failTag(587317281,sn(g))})}}var L7=f(()=>{"use strict";s();te();gd();Fc();Ad();yt();St()});var HF,Rt,kd=f(()=>{"use strict";s();(function(e){e[e.Collapsed=0]="Collapsed",e[e.Expanded=1]="Expanded"})(HF||(HF={}));Rt=HF});function da(e,t,r){return r===A.HalfPane||t.includes(e)?Rt.Expanded:Rt.Collapsed}var Nf=f(()=>{"use strict";s();kd();Ve()});function cE(e){return e===dE}function H7(e,t){var r=m({},t);mS(r,e);var n=[];Object.keys(r).forEach(function(a){var d=r[a].assignee;_u(d)||n.push(d)});var o=t?e.filter(function(a){return t[pS(a)]===void 0}):w([],V(e),!1);if(!(n.length===0&&o.length===0))return{assigneesToAdd:n,assigneesToRemove:o}}var dE,JC=f(()=>{"use strict";s();k();yd();ln();dE=100});var uE,BF=f(()=>{"use strict";s();uE="O365"});var U7,V7=f(()=>{"use strict";s();BF();U7=function(){function e(t,r){r===void 0&&(r=!0),this.rawDelta=t,this.onlyNewMentions=r,this._deserializedDelta=void 0,this._NumHyperlinks=0,this._hasRichTextFormatting=!1,this._users=[]}return Object.defineProperty(e.prototype,"NumHyperlinks",{get:function(){return this._deserializedDelta===void 0&&this.parseDelta(),this._NumHyperlinks},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Mentions",{get:function(){return this._deserializedDelta===void 0&&this.parseDelta(),this._users},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HasRichTextFormatting",{get:function(){return this._deserializedDelta===void 0&&this.parseDelta(),this._hasRichTextFormatting},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.rawDelta},e.prototype.parseDelta=function(){var t=this,r,n;this._deserializedDelta=JSON.parse(this.rawDelta),(n=(r=this._deserializedDelta)===null||r===void 0?void 0:r.ops)===null||n===void 0||n.forEach(function(o){var a,d;if(o!=null&&o.attributes){o.attributes.link&&(t._NumHyperlinks+=1);var c=o.attributes.atmention,u=o.optional;c&&(!t.onlyNewMentions||((a=u==null?void 0:u.atmention)===null||a===void 0?void 0:a.contentId)===void 0)&&((d=t._users)===null||d===void 0||d.push({UserId:c.email,Provider:uE})),(o.attributes.weight||o.attributes.italic||o.attributes.underline)&&(t._hasRichTextFormatting=!0)}})},e}()});var UF,hi,lE=f(()=>{"use strict";s();(function(e){e[e.Success=0]="Success",e[e.CommitPending=1]="CommitPending",e[e.ShareFailed=2]="ShareFailed",e[e.CommitFailed=3]="CommitFailed"})(UF||(UF={}));hi=UF});function W7(e,t,r,n,o,a){return function(d,c){var u,l,p=x().createActivityObject("CommitComment",e.telemetryVisitor,Ee());p.addDocumentMetadata(_i.Basic);var g=Mm[o.type],h=c(),v=Go(h),y=En(h);if(y===void 0||y.commentDraft.sessionConfiguration.sessionType!==o.type)return p.failTag(593278784,-2130957522),Promise.resolve(hi.CommitFailed);var T="",b=!1;switch(o.type){case na:T=o.commentId;break;case Bo:T=o.parentId,b=!0;break;case ro:y&&(T=y.commentDraft.sessionConfiguration.draftId||"");break}var I=ia(h),E=!b||da(T,I,e.renderContextType)===Rt.Expanded;p.addDataField("IsCardExpanded",E,N.SystemMetadata);var P=RTe(v[T],y);if(P!=null&&P.Task&&!Qm(h.commentState.modelCapabilities)&&(x().assertConditionTag(!1,"Unexpected task assignment when Task Capability is disabled'",590435658),P.Task=void 0),(at()&&o.type===ro||Cd()&&o.type===Bo)&&(p.addDataField("IsPreExistingTask",!!v[T],N.SystemMetadata,Io.Critical),p.addDataField("AffectingTaskMetadata",!!(P!=null&&P.Task),N.SystemMetadata,Io.Critical)),p.addDataField("SessionType",g,N.SystemMetadata),o.type!==ro){var _=Xm(wt(h),T);_.valid&&(p.addDataField("MatchesCommentAuthor",_.matchesCurrentUser,N.SystemMetadata),p.addDataField("ThreadCreationDeltaMs",_.timeElapsed,N.SystemMetadata))}p.addDataField("AtMentionsEnabled",r,N.SystemMetadata),p.addDataField("Trackback",e.trackback,N.SystemMetadata),p.addDataField("RenderContextType",e.renderContextType,N.SystemMetadata),p.addDataField("CommitSource",a,N.SystemMetadata);var D=pe(h);return fi(D)?((l=(u=x()).logDiagnosticTrace)===null||l===void 0||l.call(u,Ot(j7||(j7=zt(["NoCommitDueToCommitPending"],["NoCommitDueToCommitPending"]))),C.reserveTag(556827598),xt.Info,mt.ProductServiceUsage,e.telemetryVisitor),Promise.resolve(hi.CommitPending)):(d(IS(Tt(e,C.reserveTag(593278785)))),n().then(function(M){if(!r){var H=VF(d,o,M,0,p,C.reserveTag(593278786),C.reserveTag(593278787),e,P);return Promise.resolve(H)}var U=new U7(M),F=U.Mentions,z=x();if($6()&&F.length>0&&z.logFloodgateActivity&&z.logFloodgateActivity("Office_Docs_SharedComments_CommitComment"),p.addDataField("CreateCommentWithRichFormatting",U.HasRichTextFormatting,N.SystemMetadata),!F.length){var H=VF(d,o,M,0,p,C.reserveTag(593278788),C.reserveTag(593278789),e,P);return Promise.resolve(H)}return t.grantUsersAccess(F).then(function(Y){var B=ATe(Y),q=kTe(Y);if(p.addDataField("AllUsersGrantedAccess",B,N.SystemMetadata),p.addDataField("ShareDialogCanceled",q,N.SystemMetadata),Y.OperationResult===cf.FailedSilently)return It("Check Access Phase failed - share dialog not shown"),p.failTag(593278790,-2130957561),fE(d,M,Mr.GrantAccessFailedSilently,C.reserveTag(593278791),C.reserveTag(593278792),e),Promise.resolve(hi.ShareFailed);if(q)return It("Share dialog was canceled by user"),p.successTag(593278793),fE(d,M,Mr.GrantAccessCanceled,C.reserveTag(593278794),C.reserveTag(554801174),e),Promise.resolve(hi.ShareFailed);if(!B)return It("Not all users have been granted access - going back to initial state"),p.successTag(593278795),fE(d,M,Mr.GrantAccessCanceled,C.reserveTag(593278796),C.reserveTag(554784648),e),Promise.resolve(hi.ShareFailed);var K=VF(d,o,M,F.length,p,C.reserveTag(593278797),C.reserveTag(593278798),e,P);return Promise.resolve(K)},function(Y){return p.failTag(593278799,-2130957561),It("Grant Users Access has failed",So(Y)),fE(d,M,Mr.GrantAccessFailedSilently,C.reserveTag(593278800),C.reserveTag(554784393),e),Promise.resolve(hi.ShareFailed)})},function(M){return p.failTag(593278801,-2130957539),d(hf(Tt(e,C.reserveTag(593278802)),void 0)),It("getCommentBody failed",So(M)),Tn()&&d(Va({draftWarningReason:ao.CommitFailure,draftWarningType:Mr.CommitFailed},Tt(e,C.reserveTag(593278803)))),Promise.resolve(hi.CommitFailed)}))}}function RTe(e,t){var r;if(!(!t||Ua(t.commentDraft.sessionConfiguration)||!at())){var n=void 0,o=Im()?H7((r=e==null?void 0:e.currentState.assignees)!==null&&r!==void 0?r:[],t.selectedTaskAssignees):void 0;if(o)n={Task:{type:"Task",assigneeUpdate:o}};else{var a=t.selectedTaskAssignee;n=a?{Task:{type:"Task",assignee:a}}:void 0}return n}}function ATe(e){var t=e.OperationResult;return typeof t=="boolean"?t:t===cf.Success}function kTe(e){return!!e.Details&&e.Details.Canceled}function fE(e,t,r,n,o,a){e(hf(Tt(a,n),t)),e(Va({draftWarningType:r,draftWarningReason:ao.GrantUsersAccessFailure},Tt(a,o)))}function VF(e,t,r,n,o,a,d,c,u){var l=DTe(e,t,r,c,u);return l?(o.failTag(d,l),hi.CommitFailed):n?(t.type===ro?(o.addDataField("CreateThreadWithMentions",!0,N.SystemMetadata,Io.Critical),u&&u.Task&&o.addDataField("CreateThreadWithTaskAssigned",!0,N.SystemMetadata,Io.Critical)):t.type===Bo&&(o.addDataField("CreateReplyWithMentions",!0,N.SystemMetadata,Io.Critical),u&&u.Task&&o.addDataField("CreateReplyWithTaskAssigned",!0,N.SystemMetadata,Io.Critical)),o.successTag(a),hi.Success):(o.successTag(a),hi.Success)}function DTe(e,t,r,n,o){try{switch(t.type){case"CREATE":e(Am(Tt(n,C.reserveTag(593278804)),{sessionType:t.type,data:{commentBody:r},metadataUpdates:o}));break;case"EDIT":e(Am(Tt(n,C.reserveTag(593278805)),{sessionType:t.type,data:{commentBody:r,commentId:t.commentId}}));break;case"REPLY":e(Am(Tt(n,C.reserveTag(593278806)),{sessionType:t.type,data:{commentBody:r,parentId:t.parentId},metadataUpdates:o}));break;default:return x().assertConditionTag(!1,"Unexpected session type '".concat(t.type,"'"),593278807),e(hf(Tt(n,C.reserveTag(593278808)),r)),-2130957532}}catch(a){if(!Ri(a)&&!eg(a))throw a;return e(hf(Tt(n,C.reserveTag(593278809)),r)),Tn()&&e(Va({draftWarningReason:ao.CommitFailure,draftWarningType:Mr.CommitFailed},Tt(n,C.reserveTag(593278810)))),sn(a)}}var j7,z7=f(()=>{"use strict";s();k();ne();rt();yd();te();Cr();gd();xf();hS();kd();Nf();JC();V7();Jt();Fc();iE();ye();lE();yt();bn();IC();Sf();St();el();Fw();Uw();NS()});var jF,Ns,ng=f(()=>{"use strict";s();(function(e){e.PaneOpen="Read",e.NewThread="NewThread",e.InitRuntime="InitRuntime"})(jF||(jF={}));Ns=jF});function G7(e,t){return j("VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED",{displayConfiguration:t},e)}var q7=f(()=>{"use strict";s();ue()});function Mf(e,t){return function(r,n){var o=Vn(n());return Ou(o)&&Nu(t)?o.setDisplayConfiguration(t).then(function(a){return r(G7(e,a)),Promise.resolve(a)}).catch(function(a){return wTe(a)}):Promise.reject(new ge("Not half pane or half pane configuration",C.reserveTag(577610273),-2130957557))}}function wTe(e){return me(C.reserveTag(578426816))(e),Promise.resolve(void 0)}var pE=f(()=>{"use strict";s();ne();Mu();yS();pn();Jt();lo();q7()});function K7(e,t,r,n,o){return function(a){return a(PS({renderContextType:e,trackback:C.reserveTag(595899542),telemetryVisitor:o})),t===Ns.NewThread?(e===A.HalfPane&&a(Mf({renderContextType:e,trackback:C.reserveTag(595899543),telemetryVisitor:o},{displayMode:oo.Variable,desiredHeight:0})).catch(me(C.reserveTag(595645966))),a(Os({renderContextType:e,trackback:C.reserveTag(595898586),telemetryVisitor:o},r,{sessionType:"CREATE"},!1,n)).then(function(){a(vC({renderContextType:e,trackback:C.reserveTag(595899545),telemetryVisitor:o}))})):a(vC({renderContextType:e,trackback:C.reserveTag(595899546),telemetryVisitor:o}))}}var Y7=f(()=>{"use strict";s();ne();Mu();ng();Ve();pn();Nw();Ww();QC();pE()});function $7(e,t,r){return function(n,o){var a,d=o();((a=Ie(d))===null||a===void 0?void 0:a.selectedCardId)!==t&&n(fn(e,t,void 0,Ae.ExpandCard,le.SharedComments)),n(Bu(e,t,r))}}var Q7=f(()=>{"use strict";s();St();an();kc();Jw()});function FTe(e){return e===X.CardEditor||e===X.PostEditor||e===X.Card||e===X.Post||e===X.DraftCard||e===X.DiscreteHostedCommentRoot||e===X.ReopenThreadButton}function X7(e){return e===X.ClosePaneButton||e===X.NextCommentButton||e===X.PreviousCommentButton||e===X.GhostCard||e===X.NewCommentButton||e===X.PaneRoot||e===X.CommentsList||e===X.FilterButton}function Dd(e){return FTe(e.componentType)}function J7(e){switch(e){case X.CardEditor:case X.Card:case X.DraftCard:case X.DiscreteHostedCommentRoot:case X.ReopenThreadButton:return!0;case X.PostEditor:case X.Post:return!1}}function Z7(e,t){return Dd(e)&&Dd(t)?e.componentType===t.componentType&&e.id===t.id&&e.renderContextType===t.renderContextType:e.componentType===t.componentType}var X,yi=f(()=>{"use strict";s();(function(e){e[e.ClosePaneButton=1]="ClosePaneButton",e[e.CardEditor=2]="CardEditor",e[e.PostEditor=3]="PostEditor",e[e.Card=4]="Card",e[e.Post=5]="Post",e[e.NextCommentButton=6]="NextCommentButton",e[e.PreviousCommentButton=7]="PreviousCommentButton",e[e.GhostCard=8]="GhostCard",e[e.NewCommentButton=9]="NewCommentButton",e[e.PaneRoot=10]="PaneRoot",e[e.DraftCard=11]="DraftCard",e[e.DiscreteHostedCommentRoot=12]="DiscreteHostedCommentRoot",e[e.ReopenThreadButton=13]="ReopenThreadButton",e[e.CommentsList=14]="CommentsList",e[e.FilterButton=15]="FilterButton"})(X||(X={}))});function nl(e){var t="";return X7(e.componentType)?t=jn(e.componentType):Dd(e)&&(t=Qa(e)),t}function jn(e){switch(e){case X.ClosePaneButton:return xW();case X.NextCommentButton:return RW();case X.PreviousCommentButton:return AW();case X.GhostCard:return RC();case X.NewCommentButton:return EW();case X.PaneRoot:return vW();case X.CommentsList:return bW();case X.FilterButton:return jW()}}function Qa(e){switch(e.componentType){case X.Card:return _f(e,!1);case X.DraftCard:return _f(e,!0);case X.PostEditor:return AC(MI(e));case X.CardEditor:return AC(NI(e));case X.Post:return LI(e);case X.DiscreteHostedCommentRoot:return DW(e);case X.ReopenThreadButton:return UI(e,VI())}}function Lf(e){return e?X.DraftCard:X.Card}function Oc(e,t){return Lf(tt(t)===e)}function WF(e){var t,r;if(ub(e)&&e.getId())return e.getId();var n=e.props?(r=(t=e.props.testId)!==null&&t!==void 0?t:e.props.nodeId)!==null&&r!==void 0?r:e.props.accessibilityLabel:void 0;return e.constructor.name+(n?"#".concat(n):"")}var Xa=f(()=>{"use strict";s();Pt();yt();lr();yi()});function mE(e,t,r,n){return function(o,a){o(j("SELECT_COMMENT",r,t));var d=a(),c=Ie(d);return n&&c&&c.selectedCardId===r.selectedCard&&(r.selectType!==Ae.SelectPost||et(c.selectionDetails)&&c.selectionDetails.selectedPostId===r.selectedPost)?e?new Promise(function(u){return setTimeout(function(){var l;if(et(c.selectionDetails))l={componentType:X.Post,id:c.selectionDetails.selectedPostId,renderContextType:t.renderContextType};else{var p=pe(d).drafts[c.selectedCardId],g=!!p&&p.commentDraft.sessionConfiguration.sessionType==="CREATE";l={componentType:Lf(g),id:c.selectedCardId,renderContextType:t.renderContextType}}var h=e.getComponentById(l);h?(cn&&It("Focusing comment ".concat(l.id," with render context type ").concat(l.renderContextType," after selection.")),h.focus()):x().assertConditionTag(!1,"Couldn't find focus target after select: ".concat(JSON.stringify(l)),590104655),u()})}):(x().assertConditionTag(!1,"Expected componentTree to be set",579744148),Promise.resolve()):Promise.resolve()}}function og(e,t,r){return m({selectedCard:e,source:t},r)}var gE=f(()=>{"use strict";s();k();ne();te();Xa();yi();yc();so();St();ue();kc()});function ez(e,t){return{requestDeleteComment:function(n,o){e(qS(n,o))},requestDeleteThread:function(n,o,a){e(wm(n,o,a))},requestReopenThread:function(n,o,a){e(YS(n,o,a))},requestResolveThread:function(n,o,a){e(QS(n,o,a))},requestEditCommentSession:function(n,o,a){e(Os(n,t.commentAPI,{sessionType:"EDIT",commentId:o,rootCommentId:lf()?a:void 0},!1,t.peopleAPI)).catch(me(C.reserveTag(574362624)))},requestReplyCommentSession:function(n,o){e(Os(n,t.commentAPI,{sessionType:"REPLY",threadId:o},!1,t.peopleAPI)).catch(me(C.reserveTag(574362625)))},commitCommentAndFocus:function(n,o,a,d,c,u,l){return e(W7(n,t.peopleAPI,d,o,a,l)).then(function(p){return p===hi.Success&&t.focusManager.focusCommentCardCommand(c,u),p})},discardDraftAsync:function(n,o,a,d){return e(tg(n,o,a,d))},discardDraftIfEmpty:function(n,o,a){return e(Ff(n,o,a))},showLowFidelityWarning:function(n,o,a){e(Bu(n,o,a))},clearLowFidelityWarning:function(n){e(kS(n))},saveDraft:function(n,o,a){e(Fm(n,{draftId:o,draftContent:a}))},clearCommentHighlight:function(n,o){e(Lu(n,le.SharedComments,o))},checkUserAccess:function(n){return t.peopleAPI.checkUserAccess(n)},updateMentioneesStillInDraft:function(n,o){e(lI(n,o))},addToCurrentMentionees:function(n,o){e(TS(n,o))},updateSelectedTaskAssignee:function(n,o){e(pI(n,o))},updateSelectedTaskAssignees:function(n,o){e(mI(n,o))},toggleTaskAssigner:function(n){e(iI(n))},displayDraftWarning:function(n,o,a){e(Va({draftWarningType:o,draftWarningReason:a},n))},showPostErrorUI:function(n,o){e(oI(n,o))},clearPostErrorUI:function(n,o){e(DS(n,o))},selectCommentCardAndShowLowFidelityWarning:function(n,o,a){e($7(n,o,a))},draftEmptinessChanged:function(n,o,a){e(MS(n,a,o))},selectComment:function(n,o,a,d){return e(mE(n,o,a,d))},collapseCard:function(n,o){e(Rm(n,o))},requestUpdateCommentReactions:function(n,o,a,d){e(M7(n,t.commentAPI,{sessionType:"METADATA",threadId:o},a,d))},requestPresentLinkToComment:function(n,o){e(WS(n,o))},onClickableTextClicked:function(n){var o,a;(a=(o=t.commentAPI).onClickableTextClicked)===null||a===void 0||a.call(o,n)}}}function ol(e,t){return m(m({},ez(e,t)),{highlightComment:function(n,o){e(Ac(n,o,le.SharedComments))},discardDraftAndStartNewCommentSession:function(n){e(Os(n,t.commentAPI,{sessionType:"CREATE"},!1,t.peopleAPI)).catch(me(C.reserveTag(592314377)))},queueLoadThreads:function(n,o){e(TC(n,{threadIds:o}))},requestClosePane:function(n){e(Hu(n))},requestDisplayConfiguration:function(n,o){return e(Mf(n,o))},readyToRender:function(n){e(zS(n))},requestModalConfirmation:function(n,o,a,d){e(KS(n,o,a,d))},initializeView:function(n){e(K7(n,t.initializationReason,t.commentAPI,t.peopleAPI,t.telemetryVisitor))},updateRenderLocksForAllDrafts:function(n,o){e(SC(n,o))}})}function hE(e,t){return m(m({},ez(e,t)),{updateRenderLockForDraft:function(n,o,a){e(SC(n,o,a))},highlightComment:function(n){e(Ac(n,t.resource.id,le.SharedComments))},requestDisplayConfiguration:function(n,o){return t.componentTree.componentTreeId.renderContextType!==A.HalfPane?Promise.resolve(void 0):e(Mf(n,o))},queueLoadThread:function(n){return e(TC(n,{threadIds:[t.resource.id]}))}})}var ZC=f(()=>{"use strict";s();k();ne();pn();ye();Cr();an();QC();L7();z7();sE();aE();Y7();pE();Q7();gE();lE();Ve()});var il,tz=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Canvas=1]="Canvas"})(il||(il={}))});var ca,rz=f(()=>{"use strict";s();(function(e){e[e.Keyboarding=1]="Keyboarding",e[e.HostAction=2]="HostAction"})(ca||(ca={}))});var Yt,nz=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Next=1]="Next",e[e.Previous=2]="Previous"})(Yt||(Yt={}))});var oz=f(()=>{"use strict";s();tz();rz();nz()});var iz,OTe,az,sz=f(()=>{"use strict";s();iz=S(Et()),OTe={ContentNavigationModule:["SDX::ContentExtension::Navigation::ContentNavigationModule",{selectNextOrPreviousContent:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::SelectNextOrPreviousContentArgs"]],moveFocus:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::MoveFocusArgs"]],bringContentIntoView:["FireAndForgetMethod",["$string","SDX::ContentExtension::Navigation::BringContentIntoViewArgs"]]}]},az={ContentNavigationModule:iz.RekaServiceRegistry.getNativeService(OTe.ContentNavigationModule)}});var dz,MTe,cz,uz=f(()=>{"use strict";s();dz=S(Et()),MTe={ContentNavigationModuleConstants:["SDX::ContentExtension::Navigation::ContentNavigationModuleConstants",{isHostImplementationEnabled:["Constant","$boolean"]}]},cz={ContentNavigationModuleConstants:dz.RekaServiceRegistry.getNativeService(MTe.ContentNavigationModuleConstants)}});var ig,lz=f(()=>{"use strict";s();sz();uz();ig=function(){function e(t){this.apiContext=t}return e.prototype.selectNextOrPreviousContent=function(t){this.getModule().selectNextOrPreviousContent(this.apiContext,t)},e.prototype.moveFocus=function(t){this.getModule().moveFocus(this.apiContext,t)},e.prototype.bringContentIntoView=function(t){this.getModule().bringContentIntoView(this.apiContext,t)},e.prototype.getModule=function(){return az.ContentNavigationModule},e.prototype.isAPIEnabled=function(){return cz.ContentNavigationModuleConstants.isHostImplementationEnabled},e}()});function fz(){return yE||(yE=Ny(),yE)}var yE,pz=f(()=>{"use strict";s();Zl()});function ev(){return fz().isChangeGateEnabled("SingletonAPISupport",8522442)}var mz=f(()=>{"use strict";s();Zl();pz()});function Hf(e,t){if(!ev()){CE.set(t,e);return}var r=tv.get(t);r||(r=new Jl("ContentNavigation"),tv.set(t,r)),r.injectInstance(e)}function ag(e){if(!ev()){var t=CE.get(e);if(!t)throw new Re("ContentNavigationAPI not set for this APIContext",C.reserveTag(589103765));return t}var r=tv.get(e);if(!r)throw new Re("ContentNavigationAPI not initialized for current apiContext ".concat(e,"."),C.reserveTag(507773646));return r.getInstanceOrThrow()}function al(e){var t;return ev()?((t=tv.get(e))===null||t===void 0?void 0:t.getInstance())!==void 0:CE.has(e)}function Bf(e){var t;if(!ev()){CE.delete(e);return}(t=tv.get(e))===null||t===void 0||t.reset()}var CE,tv,gz=f(()=>{"use strict";s();ne();tb();mz();CE=new Map,tv=new Map});var hz=f(()=>{"use strict";s();lz();gz()});var yz=f(()=>{"use strict";s();oz();hz()});var Cz=f(()=>{"use strict";s();yz()});var vz,xz=f(()=>{"use strict";s();vz=function(){function e(){}return e.prototype.selectNextOrPreviousContent=function(t){},e.prototype.moveFocus=function(t){},e.prototype.bringContentIntoView=function(t){},e}()});var Tz=f(()=>{"use strict";s();xz()});var wd=f(()=>{"use strict";s();Cz();Tz()});var zF,Wn,Uf=f(()=>{"use strict";s();(function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(zF||(zF={}));Wn=zF});function BTe(e){return Object.values($t).includes(e)}function bz(e){return BTe(e)?e:$t.None}var $t,Fd=f(()=>{"use strict";s();(function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"})($t||($t={}))});var GF,mn,sg=f(()=>{"use strict";s();(function(e){e[e.Editing=0]="Editing",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"})(GF||(GF={}));mn=GF});var vE,UTe,Sz,Iz=f(()=>{"use strict";s();k();rt();te();vE=S(L()),UTe=function(t,r,n){if(n.details.componentInstanceId===t){if(n.details.componentKey!==r){x().assertConditionTag(!1,"componentInstanceId and componentName are out of sync",589951873);return}switch(n.command){case"UpdateComponentDataProps":return{resource:n.updatedComponentDataProps.resource?m({},n.updatedComponentDataProps.resource):void 0,maximumDimensions:m({},n.updatedComponentDataProps.maximumDimensions),isVirtualized:n.updatedComponentDataProps.isVirtualized,accessibilityMetadata:n.updatedComponentDataProps.accessibilityMetadata};case"Focus":return}}},Sz=function(e){Z(t,e);function t(r){var n,o=e.call(this,r)||this;return o.handleComponentCommand=function(a){var d=UTe(o.componentInstanceId,o.props.componentName,a);d&&o.setState(d)},o.componentInstanceId=(n=o.props.componentInstanceId)!==null&&n!==void 0?n:Zn(),o.state={resource:o.props.resource,maximumDimensions:o.props.maximumDimensions,isVirtualized:o.props.isVirtualized,accessibilityMetadata:o.props.accessibilityMetadata},o}return t.prototype.componentDidMount=function(){var r=this;this.registrationToken=this.props.onComponentCommand.subscribe(function(n){r.handleComponentCommand(n)})},t.prototype.componentWillUnmount=function(){var r;(r=this.registrationToken)===null||r===void 0||r.unsubscribe()},t.prototype.render=function(){var r=this.props.InnerHostableComponent;return vE.createElement(r,m({},this.state,{componentRef:this.props.componentRef,componentInstanceId:this.componentInstanceId}))},t}(vE.PureComponent)});var qF,Ez,Pz=f(()=>{"use strict";s();qF=S(Kr()),Ez=qF.AppRegistry.registerComponent.bind(qF.AppRegistry)});var Vf,KF=f(()=>{"use strict";s();(function(e){e[e.Unregistered=0]="Unregistered",e[e.Registered=1]="Registered"})(Vf||(Vf={}))});var _z,Rz,Az=f(()=>{"use strict";s();_z=S(Et()),Rz=function(){function e(t,r){var n=this;this.componentName=t,this._registryInstance=r,this.onComponentCommand=new _z.EventImpl(function(){}),this._registryInstance.onComponentCommand.subscribe(function(o){o.details.componentKey===n.componentName&&n.onComponentCommand.trigger(o)})}return e.prototype.unregister=function(){this.onComponentCommand.unsubscribeAll(),this._registryInstance.unregisterComponent(this.componentName)},e}()});var kz,Dz,wz=f(()=>{"use strict";s();kz=S(Et()),Dz=function(){function e(t,r){var n=this;this._componentName=t,this._registryInstance=r,this.onStateChanged=new kz.EventImpl(function(){}),this._registryInstance.onComponentStateChanged.subscribe(function(o){o.componentName===n._componentName&&n.onStateChanged.trigger(o.state)})}return Object.defineProperty(e.prototype,"component",{get:function(){return this._registryInstance.componentMap[this._componentName]},enumerable:!1,configurable:!0}),e}()});var YF,Fz,Oz=f(()=>{"use strict";s();k();YF=S(Et());KF();Az();wz();Fz=function(){function e(){this.componentMap={},this.onComponentStateChanged=new YF.EventImpl(function(){}),this.onComponentCommand=new YF.EventImpl(function(){})}return e.prototype.initialize=function(){},e.prototype.registerComponent=function(t,r){return this.componentMap[t]=r,this.onComponentStateChanged.trigger({componentName:t,state:Vf.Registered}),new Rz(t,this)},e.prototype.unregisterComponent=function(t){delete this.componentMap[t],this.onComponentStateChanged.trigger({componentName:t,state:Vf.Unregistered})},e.prototype.getComponent=function(t){return Wt(this,void 0,void 0,function(){return pt(this,function(r){return[2,new Dz(t,this)]})})},e}()});var Nz,Mz=f(()=>{"use strict";s();Nz={ComponentRegistryHostService:["SDX::ComponentRegistry::ComponentRegistryHostService",{dispatchComponentCommand:["FireAndForgetMethod",[["$union",["SDX::ComponentRegistry::FocusCommandArgs","SDX::ComponentRegistry::UpdateComponentDataPropsCommandArgs"]]]]}]}});var Lz,Hz=f(()=>{"use strict";s();Lz=S(Et());Lz.CustomTypeRegistry.registerTypeInfos({"SDX::ComponentRegistry::SharedComponentCommandDetails":{componentKey:"$string",componentInstanceId:"$string"},"SDX::ComponentRegistry::FocusCommandArgs":{command:"$string",details:"SDX::ComponentRegistry::SharedComponentCommandDetails"},"SDX::ComponentRegistry::UpdateComponentDataPropsCommandArgs":{command:"$string",details:"SDX::ComponentRegistry::SharedComponentCommandDetails",updatedComponentDataProps:"SDX::ComponentRegistry::HostableComponentDataProps"}})});var Bz,Uz,Vz=f(()=>{"use strict";s();Bz=S(Et());Mz();Hz();Uz=function(){function e(t){this._parentServiceProvider=t}return e.getInstance=function(){return this.instance},e.register=function(t){var r=this;this.instance||(this.instance=new e(t),Bz.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return r.instance}}))},e.prototype.dispatchComponentCommand=function(t){this._parentServiceProvider.onComponentCommand.trigger(t)},e.ServiceInfo=Nz.ComponentRegistryHostService,e}()});var xE,jz,Wz=f(()=>{"use strict";s();k();xE=S(L());Iz();Pz();Oz();Vz();jz=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.initialize=function(){Uz.register(this)},t.prototype.registerComponent=function(r,n){var o=this,a=xE.forwardRef(function(d,c){return xE.createElement(Sz,m({},d,{componentRef:d.componentRef||c,InnerHostableComponent:n,componentName:r,onComponentCommand:o.onComponentCommand}))});return Ez(r,function(){return a}),e.prototype.registerComponent.call(this,r,a)},t}(Fz)});function rv(){if($F===void 0){var e=new jz;e.initialize(),$F=e}return $F}var $F,zz=f(()=>{"use strict";s();Wz()});var Gz=f(()=>{"use strict";s();zz()});var dg,qz=f(()=>{"use strict";s();(function(e){e[e.Unspecified=0]="Unspecified",e[e.Trap=1]="Trap",e[e.DoNotTrap=2]="DoNotTrap"})(dg||(dg={}))});var Kz=f(()=>{"use strict";s();qz();KF()});var QF=f(()=>{"use strict";s();Gz();Kz()});var jf,XF=f(()=>{"use strict";s();(function(e){e[e.Dialog=1]="Dialog",e[e.ForceDiscard=2]="ForceDiscard",e[e.TryAutoDiscard=3]="TryAutoDiscard"})(jf||(jf={}))});var $z=be((hut,Yz)=>{s();Yz.exports={SharedCommentsVersion:"3.77.8"}});var jTe,WTe,TE,JF=f(()=>{"use strict";s();jTe=$z(),WTe=jTe.SharedCommentsVersion,TE=WTe});function zTe(){this.__data__=[],this.size=0}var Qz,Xz=f(()=>{"use strict";s();Qz=zTe});function GTe(e,t){return e===t||e!==e&&t!==t}var cg,bE=f(()=>{"use strict";s();cg=GTe});function qTe(e,t){for(var r=e.length;r--;)if(cg(e[r][0],t))return r;return-1}var sl,nv=f(()=>{"use strict";s();bE();sl=qTe});function $Te(e){var t=this.__data__,r=sl(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():YTe.call(t,r,1),--this.size,!0}var KTe,YTe,Jz,Zz=f(()=>{"use strict";s();nv();KTe=Array.prototype,YTe=KTe.splice;Jz=$Te});function QTe(e){var t=this.__data__,r=sl(t,e);return r<0?void 0:t[r][1]}var e9,t9=f(()=>{"use strict";s();nv();e9=QTe});function XTe(e){return sl(this.__data__,e)>-1}var r9,n9=f(()=>{"use strict";s();nv();r9=XTe});function JTe(e,t){var r=this.__data__,n=sl(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var o9,i9=f(()=>{"use strict";s();nv();o9=JTe});function ug(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var dl,ov=f(()=>{"use strict";s();Xz();Zz();t9();n9();i9();ug.prototype.clear=Qz;ug.prototype.delete=Jz;ug.prototype.get=e9;ug.prototype.has=r9;ug.prototype.set=o9;dl=ug});function ZTe(){this.__data__=new dl,this.size=0}var a9,s9=f(()=>{"use strict";s();ov();a9=ZTe});function ebe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var d9,c9=f(()=>{"use strict";s();d9=ebe});function tbe(e){return this.__data__.get(e)}var u9,l9=f(()=>{"use strict";s();u9=tbe});function rbe(e){return this.__data__.has(e)}var f9,p9=f(()=>{"use strict";s();f9=rbe});var nbe,SE,ZF=f(()=>{"use strict";s();nbe=typeof global=="object"&&global&&global.Object===Object&&global,SE=nbe});var obe,ibe,fo,Od=f(()=>{"use strict";s();ZF();obe=typeof self=="object"&&self&&self.Object===Object&&self,ibe=SE||obe||Function("return this")(),fo=ibe});var abe,Ci,lg=f(()=>{"use strict";s();Od();abe=fo.Symbol,Ci=abe});function cbe(e){var t=sbe.call(e,iv),r=e[iv];try{e[iv]=void 0;var n=!0}catch(a){}var o=dbe.call(e);return t?e[iv]=r:delete e[iv],o}var m9,sbe,dbe,iv,g9,h9=f(()=>{"use strict";s();lg();m9=Object.prototype,sbe=m9.hasOwnProperty,dbe=m9.toString,iv=Ci?Ci.toStringTag:void 0;g9=cbe});function fbe(e){return lbe.call(e)}var ube,lbe,y9,C9=f(()=>{"use strict";s();ube=Object.prototype,lbe=ube.toString;y9=fbe});function gbe(e){return e==null?e===void 0?mbe:pbe:v9&&v9 in Object(e)?g9(e):y9(e)}var pbe,mbe,v9,Ms,fg=f(()=>{"use strict";s();lg();h9();C9();pbe="[object Null]",mbe="[object Undefined]",v9=Ci?Ci.toStringTag:void 0;Ms=gbe});function hbe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ls,pg=f(()=>{"use strict";s();Ls=hbe});function Tbe(e){if(!Ls(e))return!1;var t=Ms(e);return t==Cbe||t==vbe||t==ybe||t==xbe}var ybe,Cbe,vbe,xbe,IE,e1=f(()=>{"use strict";s();fg();pg();ybe="[object AsyncFunction]",Cbe="[object Function]",vbe="[object GeneratorFunction]",xbe="[object Proxy]";IE=Tbe});var bbe,EE,x9=f(()=>{"use strict";s();Od();bbe=fo["__core-js_shared__"],EE=bbe});function Sbe(e){return!!T9&&T9 in e}var T9,b9,S9=f(()=>{"use strict";s();x9();T9=function(){var e=/[^.]+$/.exec(EE&&EE.keys&&EE.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();b9=Sbe});function Pbe(e){if(e!=null){try{return Ebe.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var Ibe,Ebe,Nc,t1=f(()=>{"use strict";s();Ibe=Function.prototype,Ebe=Ibe.toString;Nc=Pbe});function Obe(e){if(!Ls(e)||b9(e))return!1;var t=IE(e)?Fbe:Rbe;return t.test(Nc(e))}var _be,Rbe,Abe,kbe,Dbe,wbe,Fbe,I9,E9=f(()=>{"use strict";s();e1();S9();pg();t1();_be=/[\\^$.*+?()[\]{}|]/g,Rbe=/^\[object .+?Constructor\]$/,Abe=Function.prototype,kbe=Object.prototype,Dbe=Abe.toString,wbe=kbe.hasOwnProperty,Fbe=RegExp("^"+Dbe.call(wbe).replace(_be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");I9=Obe});function Nbe(e,t){return e==null?void 0:e[t]}var P9,_9=f(()=>{"use strict";s();P9=Nbe});function Mbe(e,t){var r=P9(e,t);return I9(r)?r:void 0}var Hi,cl=f(()=>{"use strict";s();E9();_9();Hi=Mbe});var Lbe,ul,PE=f(()=>{"use strict";s();cl();Od();Lbe=Hi(fo,"Map"),ul=Lbe});var Hbe,Mc,av=f(()=>{"use strict";s();cl();Hbe=Hi(Object,"create"),Mc=Hbe});function Bbe(){this.__data__=Mc?Mc(null):{},this.size=0}var R9,A9=f(()=>{"use strict";s();av();R9=Bbe});function Ube(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var k9,D9=f(()=>{"use strict";s();k9=Ube});function zbe(e){var t=this.__data__;if(Mc){var r=t[e];return r===Vbe?void 0:r}return Wbe.call(t,e)?t[e]:void 0}var Vbe,jbe,Wbe,w9,F9=f(()=>{"use strict";s();av();Vbe="__lodash_hash_undefined__",jbe=Object.prototype,Wbe=jbe.hasOwnProperty;w9=zbe});function Kbe(e){var t=this.__data__;return Mc?t[e]!==void 0:qbe.call(t,e)}var Gbe,qbe,O9,N9=f(()=>{"use strict";s();av();Gbe=Object.prototype,qbe=Gbe.hasOwnProperty;O9=Kbe});function $be(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Mc&&t===void 0?Ybe:t,this}var Ybe,M9,L9=f(()=>{"use strict";s();av();Ybe="__lodash_hash_undefined__";M9=$be});function mg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var r1,H9=f(()=>{"use strict";s();A9();D9();F9();N9();L9();mg.prototype.clear=R9;mg.prototype.delete=k9;mg.prototype.get=w9;mg.prototype.has=O9;mg.prototype.set=M9;r1=mg});function Qbe(){this.size=0,this.__data__={hash:new r1,map:new(ul||dl),string:new r1}}var B9,U9=f(()=>{"use strict";s();H9();ov();PE();B9=Qbe});function Xbe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var V9,j9=f(()=>{"use strict";s();V9=Xbe});function Jbe(e,t){var r=e.__data__;return V9(t)?r[typeof t=="string"?"string":"hash"]:r.map}var ll,sv=f(()=>{"use strict";s();j9();ll=Jbe});function Zbe(e){var t=ll(this,e).delete(e);return this.size-=t?1:0,t}var W9,z9=f(()=>{"use strict";s();sv();W9=Zbe});function eSe(e){return ll(this,e).get(e)}var G9,q9=f(()=>{"use strict";s();sv();G9=eSe});function tSe(e){return ll(this,e).has(e)}var K9,Y9=f(()=>{"use strict";s();sv();K9=tSe});function rSe(e,t){var r=ll(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var $9,Q9=f(()=>{"use strict";s();sv();$9=rSe});function gg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var Wf,_E=f(()=>{"use strict";s();U9();z9();q9();Y9();Q9();gg.prototype.clear=B9;gg.prototype.delete=W9;gg.prototype.get=G9;gg.prototype.has=K9;gg.prototype.set=$9;Wf=gg});function nSe(e,t){var r=this.__data__;if(r instanceof dl){var n=r.__data__;if(!ul||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Wf(n)}return r.set(e,t),this.size=r.size,this}var X9,J9=f(()=>{"use strict";s();ov();PE();_E();X9=nSe});function hg(e){var t=this.__data__=new dl(e);this.size=t.size}var yg,n1=f(()=>{"use strict";s();ov();s9();c9();l9();p9();J9();hg.prototype.clear=a9;hg.prototype.delete=d9;hg.prototype.get=u9;hg.prototype.has=f9;hg.prototype.set=X9;yg=hg});function iSe(e){return this.__data__.set(e,oSe),this}var oSe,Z9,eG=f(()=>{"use strict";s();oSe="__lodash_hash_undefined__";Z9=iSe});function aSe(e){return this.__data__.has(e)}var tG,rG=f(()=>{"use strict";s();tG=aSe});function RE(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Wf;++t<r;)this.add(e[t])}var AE,o1=f(()=>{"use strict";s();_E();eG();rG();RE.prototype.add=RE.prototype.push=Z9;RE.prototype.has=tG;AE=RE});function sSe(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var nG,oG=f(()=>{"use strict";s();nG=sSe});function dSe(e,t){return e.has(t)}var kE,i1=f(()=>{"use strict";s();kE=dSe});function lSe(e,t,r,n,o,a){var d=r&cSe,c=e.length,u=t.length;if(c!=u&&!(d&&u>c))return!1;var l=a.get(e),p=a.get(t);if(l&&p)return l==t&&p==e;var g=-1,h=!0,v=r&uSe?new AE:void 0;for(a.set(e,t),a.set(t,e);++g<c;){var y=e[g],T=t[g];if(n)var b=d?n(T,y,g,t,e,a):n(y,T,g,e,t,a);if(b!==void 0){if(b)continue;h=!1;break}if(v){if(!nG(t,function(I,E){if(!kE(v,E)&&(y===I||o(y,I,r,n,a)))return v.push(E)})){h=!1;break}}else if(!(y===T||o(y,T,r,n,a))){h=!1;break}}return a.delete(e),a.delete(t),h}var cSe,uSe,DE,a1=f(()=>{"use strict";s();o1();oG();i1();cSe=1,uSe=2;DE=lSe});var fSe,s1,iG=f(()=>{"use strict";s();Od();fSe=fo.Uint8Array,s1=fSe});function pSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n,o){r[++t]=[o,n]}),r}var aG,sG=f(()=>{"use strict";s();aG=pSe});function mSe(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var Cg,wE=f(()=>{"use strict";s();Cg=mSe});function RSe(e,t,r,n,o,a,d){switch(r){case _Se:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case PSe:return!(e.byteLength!=t.byteLength||!a(new s1(e),new s1(t)));case ySe:case CSe:case TSe:return cg(+e,+t);case vSe:return e.name==t.name&&e.message==t.message;case bSe:case ISe:return e==t+"";case xSe:var c=aG;case SSe:var u=n&gSe;if(c||(c=Cg),e.size!=t.size&&!u)return!1;var l=d.get(e);if(l)return l==t;n|=hSe,d.set(e,t);var p=DE(c(e),c(t),n,o,a,d);return d.delete(e),p;case ESe:if(d1)return d1.call(e)==d1.call(t)}return!1}var gSe,hSe,ySe,CSe,vSe,xSe,TSe,bSe,SSe,ISe,ESe,PSe,_Se,dG,d1,cG,uG=f(()=>{"use strict";s();lg();iG();bE();a1();sG();wE();gSe=1,hSe=2,ySe="[object Boolean]",CSe="[object Date]",vSe="[object Error]",xSe="[object Map]",TSe="[object Number]",bSe="[object RegExp]",SSe="[object Set]",ISe="[object String]",ESe="[object Symbol]",PSe="[object ArrayBuffer]",_Se="[object DataView]",dG=Ci?Ci.prototype:void 0,d1=dG?dG.valueOf:void 0;cG=RSe});function ASe(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}var vg,FE=f(()=>{"use strict";s();vg=ASe});var kSe,Jr,Ja=f(()=>{"use strict";s();kSe=Array.isArray,Jr=kSe});function DSe(e,t,r){var n=t(e);return Jr(e)?n:vg(n,r(e))}var OE,c1=f(()=>{"use strict";s();FE();Ja();OE=DSe});function wSe(e,t){for(var r=-1,n=e==null?0:e.length,o=0,a=[];++r<n;){var d=e[r];t(d,r,e)&&(a[o++]=d)}return a}var lG,fG=f(()=>{"use strict";s();lG=wSe});function FSe(){return[]}var NE,u1=f(()=>{"use strict";s();NE=FSe});var OSe,NSe,pG,MSe,ME,l1=f(()=>{"use strict";s();fG();u1();OSe=Object.prototype,NSe=OSe.propertyIsEnumerable,pG=Object.getOwnPropertySymbols,MSe=pG?function(e){return e==null?[]:(e=Object(e),lG(pG(e),function(t){return NSe.call(e,t)}))}:NE,ME=MSe});function LSe(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var mG,gG=f(()=>{"use strict";s();mG=LSe});function HSe(e){return e!=null&&typeof e=="object"}var Hs,xg=f(()=>{"use strict";s();Hs=HSe});function USe(e){return Hs(e)&&Ms(e)==BSe}var BSe,f1,hG=f(()=>{"use strict";s();fg();xg();BSe="[object Arguments]";f1=USe});var yG,VSe,jSe,WSe,Tg,LE=f(()=>{"use strict";s();hG();xg();yG=Object.prototype,VSe=yG.hasOwnProperty,jSe=yG.propertyIsEnumerable,WSe=f1(function(){return arguments}())?f1:function(e){return Hs(e)&&VSe.call(e,"callee")&&!jSe.call(e,"callee")},Tg=WSe});function zSe(){return!1}var CG,vG=f(()=>{"use strict";s();CG=zSe});var bG,xG,GSe,TG,qSe,KSe,dv,p1=f(()=>{"use strict";s();Od();vG();bG=typeof exports=="object"&&exports&&!exports.nodeType&&exports,xG=bG&&typeof module=="object"&&module&&!module.nodeType&&module,GSe=xG&&xG.exports===bG,TG=GSe?fo.Buffer:void 0,qSe=TG?TG.isBuffer:void 0,KSe=qSe||CG,dv=KSe});function QSe(e,t){var r=typeof e;return t=t??YSe,!!t&&(r=="number"||r!="symbol"&&$Se.test(e))&&e>-1&&e%1==0&&e<t}var YSe,$Se,bg,HE=f(()=>{"use strict";s();YSe=9007199254740991,$Se=/^(?:0|[1-9]\d*)$/;bg=QSe});function JSe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=XSe}var XSe,Sg,BE=f(()=>{"use strict";s();XSe=9007199254740991;Sg=JSe});function SIe(e){return Hs(e)&&Sg(e.length)&&!!Hr[Ms(e)]}var ZSe,eIe,tIe,rIe,nIe,oIe,iIe,aIe,sIe,dIe,cIe,uIe,lIe,fIe,pIe,mIe,gIe,hIe,yIe,CIe,vIe,xIe,TIe,bIe,Hr,SG,IG=f(()=>{"use strict";s();fg();BE();xg();ZSe="[object Arguments]",eIe="[object Array]",tIe="[object Boolean]",rIe="[object Date]",nIe="[object Error]",oIe="[object Function]",iIe="[object Map]",aIe="[object Number]",sIe="[object Object]",dIe="[object RegExp]",cIe="[object Set]",uIe="[object String]",lIe="[object WeakMap]",fIe="[object ArrayBuffer]",pIe="[object DataView]",mIe="[object Float32Array]",gIe="[object Float64Array]",hIe="[object Int8Array]",yIe="[object Int16Array]",CIe="[object Int32Array]",vIe="[object Uint8Array]",xIe="[object Uint8ClampedArray]",TIe="[object Uint16Array]",bIe="[object Uint32Array]",Hr={};Hr[mIe]=Hr[gIe]=Hr[hIe]=Hr[yIe]=Hr[CIe]=Hr[vIe]=Hr[xIe]=Hr[TIe]=Hr[bIe]=!0;Hr[ZSe]=Hr[eIe]=Hr[fIe]=Hr[tIe]=Hr[pIe]=Hr[rIe]=Hr[nIe]=Hr[oIe]=Hr[iIe]=Hr[aIe]=Hr[sIe]=Hr[dIe]=Hr[cIe]=Hr[uIe]=Hr[lIe]=!1;SG=SIe});function IIe(e){return function(t){return e(t)}}var EG,PG=f(()=>{"use strict";s();EG=IIe});var _G,cv,EIe,m1,PIe,g1,RG=f(()=>{"use strict";s();ZF();_G=typeof exports=="object"&&exports&&!exports.nodeType&&exports,cv=_G&&typeof module=="object"&&module&&!module.nodeType&&module,EIe=cv&&cv.exports===_G,m1=EIe&&SE.process,PIe=function(){try{var e=cv&&cv.require&&cv.require("util").types;return e||m1&&m1.binding&&m1.binding("util")}catch(t){}}(),g1=PIe});var AG,_Ie,UE,h1=f(()=>{"use strict";s();IG();PG();RG();AG=g1&&g1.isTypedArray,_Ie=AG?EG(AG):SG,UE=_Ie});function kIe(e,t){var r=Jr(e),n=!r&&Tg(e),o=!r&&!n&&dv(e),a=!r&&!n&&!o&&UE(e),d=r||n||o||a,c=d?mG(e.length,String):[],u=c.length;for(var l in e)(t||AIe.call(e,l))&&!(d&&(l=="length"||o&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||bg(l,u)))&&c.push(l);return c}var RIe,AIe,VE,y1=f(()=>{"use strict";s();gG();LE();Ja();p1();HE();h1();RIe=Object.prototype,AIe=RIe.hasOwnProperty;VE=kIe});function wIe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||DIe;return e===r}var DIe,jE,C1=f(()=>{"use strict";s();DIe=Object.prototype;jE=wIe});function FIe(e,t){return function(r){return e(t(r))}}var WE,v1=f(()=>{"use strict";s();WE=FIe});var OIe,kG,DG=f(()=>{"use strict";s();v1();OIe=WE(Object.keys,Object),kG=OIe});function LIe(e){if(!jE(e))return kG(e);var t=[];for(var r in Object(e))MIe.call(e,r)&&r!="constructor"&&t.push(r);return t}var NIe,MIe,wG,FG=f(()=>{"use strict";s();C1();DG();NIe=Object.prototype,MIe=NIe.hasOwnProperty;wG=LIe});function HIe(e){return e!=null&&Sg(e.length)&&!IE(e)}var fl,uv=f(()=>{"use strict";s();e1();BE();fl=HIe});function BIe(e){return fl(e)?VE(e):wG(e)}var Lc,lv=f(()=>{"use strict";s();y1();FG();uv();Lc=BIe});function UIe(e){return OE(e,Lc,ME)}var x1,OG=f(()=>{"use strict";s();c1();l1();lv();x1=UIe});function zIe(e,t,r,n,o,a){var d=r&VIe,c=x1(e),u=c.length,l=x1(t),p=l.length;if(u!=p&&!d)return!1;for(var g=u;g--;){var h=c[g];if(!(d?h in t:WIe.call(t,h)))return!1}var v=a.get(e),y=a.get(t);if(v&&y)return v==t&&y==e;var T=!0;a.set(e,t),a.set(t,e);for(var b=d;++g<u;){h=c[g];var I=e[h],E=t[h];if(n)var P=d?n(E,I,h,t,e,a):n(I,E,h,e,t,a);if(!(P===void 0?I===E||o(I,E,r,n,a):P)){T=!1;break}b||(b=h=="constructor")}if(T&&!b){var _=e.constructor,D=t.constructor;_!=D&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof D=="function"&&D instanceof D)&&(T=!1)}return a.delete(e),a.delete(t),T}var VIe,jIe,WIe,NG,MG=f(()=>{"use strict";s();OG();VIe=1,jIe=Object.prototype,WIe=jIe.hasOwnProperty;NG=zIe});var GIe,zE,LG=f(()=>{"use strict";s();cl();Od();GIe=Hi(fo,"DataView"),zE=GIe});var qIe,GE,HG=f(()=>{"use strict";s();cl();Od();qIe=Hi(fo,"Promise"),GE=qIe});var KIe,pl,T1=f(()=>{"use strict";s();cl();Od();KIe=Hi(fo,"Set"),pl=KIe});var YIe,qE,BG=f(()=>{"use strict";s();cl();Od();YIe=Hi(fo,"WeakMap"),qE=YIe});var UG,$Ie,VG,jG,WG,zG,QIe,XIe,JIe,ZIe,eEe,zf,b1,GG=f(()=>{"use strict";s();LG();PE();HG();T1();BG();fg();t1();UG="[object Map]",$Ie="[object Object]",VG="[object Promise]",jG="[object Set]",WG="[object WeakMap]",zG="[object DataView]",QIe=Nc(zE),XIe=Nc(ul),JIe=Nc(GE),ZIe=Nc(pl),eEe=Nc(qE),zf=Ms;(zE&&zf(new zE(new ArrayBuffer(1)))!=zG||ul&&zf(new ul)!=UG||GE&&zf(GE.resolve())!=VG||pl&&zf(new pl)!=jG||qE&&zf(new qE)!=WG)&&(zf=function(t){var r=Ms(t),n=r==$Ie?t.constructor:void 0,o=n?Nc(n):"";if(o)switch(o){case QIe:return zG;case XIe:return UG;case JIe:return VG;case ZIe:return jG;case eEe:return WG}return r});b1=zf});function nEe(e,t,r,n,o,a){var d=Jr(e),c=Jr(t),u=d?KG:b1(e),l=c?KG:b1(t);u=u==qG?KE:u,l=l==qG?KE:l;var p=u==KE,g=l==KE,h=u==l;if(h&&dv(e)){if(!dv(t))return!1;d=!0,p=!1}if(h&&!p)return a||(a=new yg),d||UE(e)?DE(e,t,r,n,o,a):cG(e,t,u,r,n,o,a);if(!(r&tEe)){var v=p&&YG.call(e,"__wrapped__"),y=g&&YG.call(t,"__wrapped__");if(v||y){var T=v?e.value():e,b=y?t.value():t;return a||(a=new yg),o(T,b,r,n,a)}}return h?(a||(a=new yg),NG(e,t,r,n,o,a)):!1}var tEe,qG,KG,KE,rEe,YG,$G,QG=f(()=>{"use strict";s();n1();a1();uG();MG();GG();Ja();p1();h1();tEe=1,qG="[object Arguments]",KG="[object Array]",KE="[object Object]",rEe=Object.prototype,YG=rEe.hasOwnProperty;$G=nEe});function XG(e,t,r,n,o){return e===t?!0:e==null||t==null||!Hs(e)&&!Hs(t)?e!==e&&t!==t:$G(e,t,r,n,XG,o)}var Ig,YE=f(()=>{"use strict";s();QG();xg();Ig=XG});function oEe(e,t){return Ig(e,t)}var Hc,S1=f(()=>{"use strict";s();YE();Hc=oEe});function Gf(e,t,r){var n=Ye(r);if(n)return n.threadId!==e?cr.InOtherCard:qt()&&n.renderContextType!==t?cr.InOtherContextOfThisCard:n.commentDraft.sessionConfiguration.sessionType==="EDIT"?cr.InChildPost:cr.InCard}var $E=f(()=>{"use strict";s();ye();yt();Id()});function QE(e,t,r){var n;if(er(t))return t.find(function(u){var l;return u===e||((l=r[u])===null||l===void 0?void 0:l.alternateId)===e});for(var o=new Uu(t,-1),a;!(a=o.next()).done;){var d=a.value.commentId,c=r[d];if((c==null?void 0:c.alternateId)===e||d===e)break}return(n=a.value)===null||n===void 0?void 0:n.commentId}function ZG(e,t,r){var n=Or(t,e);return n?Km(t,r,Ze(n)):[]}function XE(e,t,r,n,o,a,d){var c,u;if(!sr()){if(o&&d===e)return{thread:[o.newComment_deprecated],isDraftThread:!0,draftThreadState:a};x().assertConditionTag(!a||!a.isInCurrentContext||a.commentDraft.sessionConfiguration.sessionType!=="CREATE","Bad Store State, missing lie for new draft requested.",579372370)}var l=n||e,p=Km(t,r,l);p.length>0&&yr(p[0])===void 0&&((u=(c=x()).logDiagnosticTrace)===null||u===void 0||u.call(c,Ot(JG||(JG=zt(["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."],["Possible comment corruption. Could indicate comment persistence issue or intermediate change state."]))),C.reserveTag(540575834),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary)),p=[]);var g=sr()&&d===l;return{thread:p,isDraftThread:g,draftThreadState:g?a:void 0}}function JE(e,t,r,n,o){if(t.draftThreadState)return t.draftThreadState.renderContextType===A.None||t.draftThreadState.renderContextType===n?un.Enabled_ForcePrimary:un.Disabled;if(t.isDraftThread||t.thread.length>0)return o===cr.InCard||o===cr.InChildPost?un.Enabled_ForcePrimary:un.Enabled_Default;if(yF(r))return un.Disabled;var a=Ye(r);return a&&a.threadId===e?un.Disabled:un.Invalid}var JG,ZE=f(()=>{"use strict";s();k();ne();rt();te();Eo();TI();ii();ye();yt();bn();io();Id();Ve()});function e0(){return I1||(I1=gw(uS,Hc)),I1}var I1,Nd,eq,tq,rq,nq,t0,r0,n0,o0,oq,iq,aq,sq,dq,cq,uq,E1=f(()=>{"use strict";s();Eo();S1();Tm();$E();ZE();zo();zo();St();el();I1=void 0,Nd=function(t,r){var n,o;return(o=(n=r.resource)===null||n===void 0?void 0:n.id)!==null&&o!==void 0?o:""},eq=function(t,r){return r.componentTree.componentTreeId.renderContextType},tq=function(){return xn([Nd,Mi],function(t,r){return r[t]})},rq=function(){return xn([Nd,JI],function(t,r){return r===t})},nq=function(){return e0()([Nd,Ie],function(t,r){return(r==null?void 0:r.selectedCardId)===t?r:void 0})},t0=function(){return xn([Nd,eq,pe],function(t,r,n){return Gf(t,r,n)})},r0=function(){return xn([Nd,In,Mi],function(t,r,n){return QE(t,r,n)})},n0=function(){return xn([Nd,pe],function(t,r){return r.drafts[t]})},o0=function(t,r,n,o){return xn([Nd,wt,Un,o,t,n,r],function(a,d,c,u,l,p,g){return XE(a,d,c,u,l,p,g)})},oq=function(t){return e0()([t,ZI],function(r,n){return r.thread.reduce(function(o,a){return o[a.commentId]=n[a.commentId],o},{})})},iq=function(t){return e0()([t,QI],function(r,n){var o={};return r&&r.history.forEach(function(a){a.records.forEach(function(d){var c=Xu(r.id,d.recordId);o[c]=n[c]})}),o})},aq=function(t,r){return xn([Nd,t,pe,eq,r],function(n,o,a,d,c){return JE(n,o,a,d,c)})},sq=function(t){return xn([t],function(r){return Yy(r)})},dq=function(){return xn([Nd,Go],function(t,r){return r[t]})},cq=function(t,r){return e0()([t,r],function(n,o){return Qu(n.thread,o)})},uq=function(){return xn([Nd,pe],function(t,r){return r.cardIdToDraftIdMap[t]===t})}});var zn,fv=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.MetadataOnly=1]="MetadataOnly",e[e.Any=2]="Any"})(zn||(zn={}))});var Bi,Ui,pv=f(()=>{"use strict";s();(function(e){e[e.AllCardsTabbable=0]="AllCardsTabbable",e[e.ExpandedCardTabbable=1]="ExpandedCardTabbable",e[e.ExpandedCardOrFirstCardTabbable=2]="ExpandedCardOrFirstCardTabbable",e[e.SelectedCardTabbable=3]="SelectedCardTabbable"})(Bi||(Bi={}));(function(e){e[e.AllPostsTabbable=0]="AllPostsTabbable",e[e.ExpandedCardPostsTabbable=1]="ExpandedCardPostsTabbable",e[e.ExpandedCardRootPostTabbable=2]="ExpandedCardRootPostTabbable",e[e.SelectedPostTabbable=3]="SelectedPostTabbable"})(Ui||(Ui={}))});function P1(e,t,r,n,o){if(!it()){var a=x().createActivityObject("SelectionAttemptWhileDrafting",r,Ee());a.addDataField("Trackback",n,N.SystemMetadata),a.addDataField("RenderContextType",o,N.SystemMetadata),a.addDataField("SelectionAttemptType",e,N.SystemMetadata),a.addDataField("IsDraftInCurrentContext",t.isInCurrentContext,N.SystemMetadata),a.successTag(590206682)}}var fq=f(()=>{"use strict";s();te();ye()});var _1,pq,mq=f(()=>{"use strict";s();(function(e){e[e.NoDialog=0]="NoDialog",e[e.AbandonDraft=1]="AbandonDraft",e[e.ResumeDrafting=2]="ResumeDrafting"})(_1||(_1={}));pq=_1});var Pn,i0=f(()=>{"use strict";s();(function(e){e[e.CancelNewThreadDraft=1]="CancelNewThreadDraft",e[e.DeleteThread=2]="DeleteThread",e[e.RequestNewCommentFromHost=3]="RequestNewCommentFromHost",e[e.CancelReplyDraft=4]="CancelReplyDraft",e[e.ResolveThread=5]="ResolveThread"})(Pn||(Pn={}))});function mv(e,t){var r=Ye(e);if(!r)return x().assertConditionTag(!1,"Attempting to discard a draft when no draft is active within card.",593085890),Kt(t)?ur.ClosePaneDraft:ur.CancelNewDraft;switch(r.commentDraft.sessionConfiguration.sessionType){case"CREATE":return ur.CancelNewDraft;case"EDIT":return ur.CancelPostEdit;case"REPLY":return ur.CancelReplyDraft;case"METADATA":return x().assertConditionTag(!1,"Metadata session should not be canceled with modal dialog.",593085891),ur.CancelNewDraft}}var R1=f(()=>{"use strict";s();te();yt();Um();li()});var Bs,A1,gv=f(()=>{"use strict";s();yt();Vu();Ve();R1();Bs=function(t,r,n,o,a){return t&&r===A.HalfPane&&a===void 0&&(!o||o.selectedCardId===tt(n,!0,r))},A1=function(t,r,n,o){if(n&&Pd(t)===Nr.CannotAutoDiscard){var a=o??mv(t,r.componentTreeId.renderContextType);return function(d,c){return n(a,d,c)}}}});var gq=f(()=>{"use strict";s()});function hv(e){var t=e.comment,r=e.threads,n=e.selectedComment,o=e.warningType,a=!t.parentId,d=!!(t.commentFlags&Ne.LowFidelity);if(!n)return a&&o===Mt.DeleteThread&&(d||GC(r,t.commentId))?!0:fe()&&d&&a;var c=d||a&&(o===Mt.DeleteReply||o===Mt.DeleteThread)&&GC(r,t.commentId),u=et(n.selectionDetails)?n.selectionDetails.selectedPostId:n.selectedCardId;return!!(c&&(u!==t.commentId||n.selectionDetails.lowFidelityWarningType!==o))}function hq(e){var t=e.result,r=e.localizationAPI;t===hi.Success&&oi(r.getString(67))}function iEe(e){var t=e.componentTree,r=e.focusManager,n=e.lieIndex,o=e.cardId,a=e.isReplyDraft,d=e.discardCallback,c=function(l,p){if(d){var g=function(){return r.onUserAction(t,{userAction:Pn.CancelNewThreadDraft,threadIndex:n}),l?l():He.Unhandled};return d(g,p)}return l?(a?r.onUserAction(t,{userAction:Pn.CancelReplyDraft,cardId:o}):r.onUserAction(t,{userAction:Pn.CancelNewThreadDraft,threadIndex:n}),Promise.resolve(l())):Promise.resolve(He.Unhandled)};return c}function Eg(e){var t=e.trackback,r=e.id,n=e.data,o=e.selectedComment,a=e.renderContextType,d=e.actionDispatchers,c=e.telemetryVisitor,u=e.localizationAPI,l=Ya(n,r);if(!l){x().assertConditionTag(!1,"Comment not found",593826117);return}if(hv({comment:l,threads:n,selectedComment:o,warningType:Mt.DeleteReply})){d.showLowFidelityWarning({renderContextType:a,telemetryVisitor:c,trackback:C.reserveTag(593826118)},r,Mt.DeleteReply);return}oi(u.getString(65)),d.requestDeleteComment({renderContextType:a,telemetryVisitor:c,trackback:t},r)}function a0(e){var t=e.trackback,r=e.id,n=e.data,o=e.renderContextType,a=e.actionDispatchers,d=e.telemetryVisitor,c=Ya(n,r);if(!c){x().assertConditionTag(!1,"Comment not found",593875075);return}a.showPostErrorUI({renderContextType:o,telemetryVisitor:d,trackback:t},c.commentId)}function s0(e){var t=e.trackback,r=e.id,n=e.data,o=e.renderContextType,a=e.actionDispatchers,d=e.telemetryVisitor,c=Ya(n,r);if(!c){x().assertConditionTag(!1,"Comment not found",593875076);return}a.clearPostErrorUI({renderContextType:o,telemetryVisitor:d,trackback:t},c.commentId)}function Pg(e){var t=e.trackback,r=e.id,n=e.data,o=e.selectedComment,a=e.renderContextType,d=e.actionDispatchers,c=e.telemetryVisitor,u=Ya(n,r);if(!u){x().assertConditionTag(!1,"Comment not found",593826119);return}if(hv({comment:u,threads:n,selectedComment:o,warningType:Mt.Edit})){d.showLowFidelityWarning({renderContextType:a,telemetryVisitor:c,trackback:C.reserveTag(593826120)},r,Mt.Edit);return}d.requestEditCommentSession({renderContextType:a,telemetryVisitor:c,trackback:t},r,u.parentId||u.commentId)}function _g(e){var t=e.trackback,r=e.id,n=e.data,o=e.draftState,a=e.contentPromise,d=e.atMentionsEnabled,c=e.componentTree,u=e.actionDispatchers,l=e.telemetryVisitor,p=e.localizationAPI,g=e.commitSource;if(fi(o))return Promise.resolve();if(!o.postIdToDraftIdMap[r])return x().assertConditionTag(!1,"Post draft to commit not found",588853381),Promise.reject(new ge("Post draft to commit not found",C.reserveTag(587850403),-2130957492));var h=Ya(n,r);return h?u.commitCommentAndFocus({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:l,trackback:t},function(){return a},{commentId:r,type:"EDIT",previousCommentBody:h.commentBody},d,c,Ze(h),g).then(function(v){hq({result:v,localizationAPI:p})}).catch(me(C.reserveTag(593826122))):(x().assertConditionTag(!1,"Comment not found in model",593826121),Promise.reject(new ge("Comment not found in model",C.reserveTag(587850432),2130957505)))}function Rg(e){var t=e.trackback,r=e.renderableItem,n=e.selectedComment,o=e.cardCollapsedState,a=e.dispatchProps,d=e.telemetryVisitor,c=e.componentTree,u=e.draftState_deprecated,l=e.shouldFocusAfter,p=_o(r),g=co(r);return a.discardDraftIfEmpty({renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:d,trackback:C.reserveTag(593237586)},le.SharedComments,void 0).then(function(h){if(!it()&&h.draftDiscardBehavior===Nr.CannotAutoDiscard&&(!n||!et(n.selectionDetails)||n.selectionDetails.selectedPostId!==g)){var v=Ye(u);v&&P1(2,v,d,C.reserveTag(590206683),c.componentTreeId.renderContextType)}else{var y=o===Rt.Collapsed;a.selectComment(c,{renderContextType:c.componentTreeId.renderContextType,telemetryVisitor:d,trackback:t},og(p,le.SharedComments,y?{selectType:Ae.ExpandCard}:{selectType:Ae.SelectPost,selectedPost:g}),l||y).catch(me(C.reserveTag(590104649)))}},me(C.reserveTag(593032901)))}function qf(e){var t=e.trackback,r=e.commentId,n=e.setContents,o=e.data,a=e.draftState,d=e.shouldClosePaneAfterDiscardDraft,c=e.onWillDiscardCallback,u=e.renderContextType,l=e.dispatchProps,p=e.telemetryVisitor,g=e.localizationAPI,h=Ya(o,r);if(!a.postIdToDraftIdMap[r]||!h){x().assertConditionTag(!1,"Cannot find comment post to cancel",593826126);return}oi(g.getString(66)),l.discardDraftAsync({renderContextType:u,telemetryVisitor:p,trackback:t},le.SharedComments,d,c).then(function(v){v===He.Handled&&h&&n&&n(h.commentBody)}).catch(me(C.reserveTag(593826127)))}function d0(e){var t=e.cardProps,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentCardMounted(r,t)})}function c0(e){var t=e.cardId,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentCardEditorMounted(r,t)})}function u0(e){var t=e.postId,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentPostMounted(r,t)})}function l0(e){var t=e.postId,r=e.componentTree,n=e.focusManager;setTimeout(function(){return n.commentPostEditorMounted(r,t)})}function Ag(e){var t=e.trackback,r=e.threadId,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.requestReplyCommentSession({renderContextType:n,telemetryVisitor:a,trackback:t},r)}function f0(e){var t=e.trackback,r=e.commentCardRef,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.collapseCard({renderContextType:n,telemetryVisitor:a,trackback:t},r.getId())}function p0(e){var t=e.trackback,r=e.commentCardRef,n=e.dispatchProps,o=e.telemetryVisitor,a=e.componentTree,d=e.options,c=e.focusManager,u=e.isDraftThread,l={componentType:Lf(u),id:r.getId(),renderContextType:a.componentTreeId.renderContextType},p=function(){cn&&It("Handling card focus with polite selection on ".concat(r.getId())),a.isFocusOnOrWithin(l)&&Kf({trackback:t,commentCardRef:r,dispatchProps:n,telemetryVisitor:o,componentTree:a,options:d})};c.postOnComponentFocusedRequest(l,p)}function Kf(e){var t=e.trackback,r=e.commentCardRef,n=e.dispatchProps,o=e.telemetryVisitor,a=e.componentTree,d=e.options,c=!1,u,l=d.selectActionType;switch(l){case Ae.ExpandCard:var p=d,g=p.selectRootPost&&(it()||!p.relativeDraftingState);c=p.shouldFocusAfter,u=g?{selectType:Ae.SelectPost,selectedPost:r.getId()}:{selectType:Ae.ExpandCard};break;case Ae.SelectCard:case Ae.Polite:u={selectType:l};break;default:Me(l)}var h=og(r.getId(),le.SharedComments,u);d.selectActionType===Ae.ExpandCard&&n.discardDraftIfEmpty({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:o,trackback:C.reserveTag(571281760)},le.SharedComments,void 0).then(function(v){if(!it()&&v.draftDiscardBehavior===Nr.CannotAutoDiscard&&d.relativeDraftingState===cr.InOtherCard){var y=Ye(d.draftState);y&&P1(1,y,o,C.reserveTag(571281761),a.componentTreeId.renderContextType)}}).catch(me(C.reserveTag(571281762))),n.selectComment(a,{renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:o,trackback:t},h,c).catch(me(C.reserveTag(571340118)))}function m0(e){var t=e.trackback,r=e.commentCardRef,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor,d=e.shouldHighlightCard;d?o.highlightComment({renderContextType:n,telemetryVisitor:a,trackback:t},r.getId()):o.clearCommentHighlight({renderContextType:n,telemetryVisitor:a,trackback:t},r.getId())}function g0(e){var t=e.trackback,r=e.focusManager,n=e.componentTree,o=e.cardId,a=e.isCardLie,d=e.newHeight,c=e.renderContextType,u=e.selectedComment,l=e.dispatchProps,p=e.telemetryVisitor;if(c===A.HalfPane){if(typeof d>"u")return x().assertConditionTag(!1,"Height should not be undefined in half-pane mode",593826129);var g=a&&u&&u.selectedCardId===o;g&&l.requestDisplayConfiguration({renderContextType:c,telemetryVisitor:p,trackback:t},{displayMode:oo.Variable,desiredHeight:d}).then(function(){r.focusCommentPaneCommand(n)}).catch(me(C.reserveTag(593826130)))}}function h0(e){var t=e.trackback,r=e.id,n=e.draftState,o=e.renderContextType,a=e.dispatchProps,d=e.telemetryVisitor;if(Q()==="android"){var c=n.drafts[n.cardIdToDraftIdMap[r]];c&&c.isDraftEmpty&&c.commentDraft.sessionConfiguration.sessionType===Bo&&a.discardDraftAsync({renderContextType:o,telemetryVisitor:d,trackback:t},le.SharedComments,!1)}}function ml(e){var t,r=e.trackback,n=e.showDiscardDialog,o=e.invokeModalDialog,a=e.componentTree,d=e.dispatchProps,c=e.closeOnDiscard,u=e.cardId,l=e.draftState,p=e.telemetryVisitor,g=e.localizationAPI,h=e.focusManager,v=e.lieIndex,y=l.cardIdToDraftIdMap[u];if(!y){x().assertConditionTag(!1,"Card draft to cancel not found",588853382);return}var T=void 0;n&&(T=A1(l,a,o));var b=((t=l.drafts[y])===null||t===void 0?void 0:t.commentDraft.sessionConfiguration.sessionType)===Bo,I=iEe({componentTree:a,focusManager:h,lieIndex:v,cardId:u,isReplyDraft:b,discardCallback:T});oi(g.getString(b?64:103)),d.discardDraftAsync({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:p,trackback:r},le.SharedComments,c,I).then(function(E){E===He.Handled&&(b?h.onUserAction(a,{userAction:Pn.CancelReplyDraft,cardId:u}):h.onUserAction(a,{userAction:Pn.CancelNewThreadDraft,threadIndex:v}))},me(C.reserveTag(592840735)))}function kg(e){var t=e.trackback,r=e.commentCardRef,n=e.draftState,o=e.areMentionsEnabled,a=e.session,d=e.componentTree,c=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,p=e.commitSource;if(fi(n))return Promise.resolve();var g=r.getId();return n.cardIdToDraftIdMap[g]?c.commitCommentAndFocus({trackback:t,telemetryVisitor:u,renderContextType:d.componentTreeId.renderContextType},r.getContentsAsync,a,o,d,g,p).then(function(h){hq({result:h,localizationAPI:l})}).catch(me(C.reserveTag(593826134))):(x().assertConditionTag(!1,"Card draft to commit not found",588853383),Promise.reject(new ge("Card draft to commit not found",C.reserveTag(587850433),-2130957492)))}function Dg(e){var t=e.trackback,r=e.id,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor,d=e.localizationAPI,c=e.isTask;oi(d.getString(125)),o.requestReopenThread({renderContextType:n,telemetryVisitor:a,trackback:t},r,c)}function Yf(e){var t=e.componentTree,r=e.focusManager,n=e.trackback,o=e.id,a=e.renderContextType,d=e.dispatchProps,c=e.telemetryVisitor,u=e.localizationAPI,l=e.isTask;oi(u.getString(124)),r.onUserAction(t,{userAction:Pn.ResolveThread,cardId:o}),d.requestResolveThread({renderContextType:a,telemetryVisitor:c,trackback:n},o,l)}function wg(e){var t=e.trackback,r=e.id,n=e.data,o=e.selectedComment,a=e.componentTree,d=e.invokeModalDialog,c=e.dispatchProps,u=e.telemetryVisitor,l=e.localizationAPI,p=e.focusManager,g=e.isTask,h=e.threadIndex,v=e.shouldCheckForLowFidelity;if(v){var y=Ya(n,r);if(!y){x().assertConditionTag(!1,"Comment not found",593605342);return}if(hv({comment:y,threads:n,selectedComment:o,warningType:Mt.DeleteThread})){c.selectCommentCardAndShowLowFidelityWarning({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:u,trackback:C.reserveTag(593605343)},y.commentId,Mt.DeleteThread);return}}if(a.componentTreeId.renderContextType===A.HalfPane&&d){var T=function(){return sEe({dispatchProps:c,componentTree:a,selectedComment:o,telemetryVisitor:u})};d(ur.DeleteThread,T,function(){return He.Canceled}).then(function(b){b===He.Handled&&p.onUserAction(a,{userAction:Pn.DeleteThread,threadIndex:h})}).catch(me(C.reserveTag(595632546)));return}oi(l.getString(63)),p.onUserAction(a,{userAction:Pn.DeleteThread,threadIndex:h}),zI(a.componentTreeId.renderContextType)?setTimeout(function(){c.requestDeleteThread({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:u,trackback:t},r,g)},100):c.requestDeleteThread({renderContextType:a.componentTreeId.renderContextType,telemetryVisitor:u,trackback:t},r,g)}function y0(e){var t=e.componentTree,r=e.focusManager,n=e.trackback,o=e.id,a=e.renderContextType,d=e.dispatchProps,c=e.telemetryVisitor,u=e.localizationAPI;Yf({componentTree:t,focusManager:r,trackback:n,id:o,renderContextType:a,dispatchProps:d,telemetryVisitor:c,localizationAPI:u,isTask:!0})}function C0(e){var t=e.failTag,r=e.successTag,n=e.person,o=e.dispatchProps,a=e.telemetryVisitor,d=e.renderContextType,c=e.trackback,u=x().createActivityObject("CheckUserAccess",a,Ee()),l={UserId:bs(n),Provider:uE,DisplayName:Du(n),Email:bs(n)};o.checkUserAccess(l).then(function(p){var g;u.addDataField("UserCanWrite",p.UserCanWrite,N.SystemMetadata),u.addDataField("UserCanReview",(g=p==null?void 0:p.UserCanReview)!==null&&g!==void 0?g:!1,N.SystemMetadata),u.successTag(r)},function(p){u.failTag(t,-2130957562)}),o.addToCurrentMentionees({telemetryVisitor:a,trackback:c,renderContextType:d},n)}function Fg(e){var t=e.trackback,r=e.contentId,n=e.isEmpty,o=e.renderContextType,a=e.draftIdMap,d=e.actionDispatchers,c=e.telemetryVisitor,u=a[r];u&&d.draftEmptinessChanged({renderContextType:o,telemetryVisitor:c,trackback:t},u,n)}function Og(e){var t=e.trackback,r=e.id,n=e.editor,o=e.renderContextType,a=e.draftIdMap,d=e.draftMap,c=e.actionDispatchers,u=e.telemetryVisitor,l=a[r];if(l){var p=d[l];Ln(p,"Draft should be defined if draftId exists!",C.reserveTag(587850434)),p.pendingState===Fi.None&&c.saveDraft({renderContextType:o,telemetryVisitor:u,trackback:t},l,{editorContent:n.getContentsAsync(),editorCursorPosition:n.getCursorPositionAsync()})}}function v0(e){var t=e.trackback,r=e.emailsStillInDraft,n=e.renderContextType,o=e.dispatchProps,a=e.telemetryVisitor;o.updateMentioneesStillInDraft({renderContextType:n,telemetryVisitor:a,trackback:t},r)}function x0(e){var t=e.trackback,r=e.renderContextType,n=e.dispatchProps,o=e.telemetryVisitor,a=e.selectedAssignee;n.updateSelectedTaskAssignee({renderContextType:r,telemetryVisitor:o,trackback:t},a)}function T0(e){var t=e.selectedState,r=e.renderContextType,n=e.dispatchProps,o=e.telemetryVisitor;if(!t||!_s(t)){x().assertConditionTag(!1,"onLowFidelityWarningCancel called unexpectedly",593846658);return}n.clearLowFidelityWarning({renderContextType:r,telemetryVisitor:o,trackback:C.reserveTag(573612046)})}function b0(e){var t=e.selectedState,r=e.onCardDelete,n=e.onPostDelete,o=e.onPostEdit;if(!t){x().assertConditionTag(!1,"onLowFidelityWarningConfirm called unexpectedly",593846661);return}if(!et(t.selectionDetails)||_C(t)){if(aF(t)){var a=t.selectedCardId;r(a);return}if(If(t)){x().assertConditionTag(!1,"Unexpected LowFidelityWarningOnEdit with card selection",593846662);return}}else{var a=t.selectionDetails.selectedPostId;if(Hm(t)){n(a);return}if(If(t)){o(a);return}}}function yv(e){var t=e.ownProps,r=e.dispatchProps,n=e.componentTree,o=e.draftState,a=e.invokeModalDialog;if(n.componentTreeId.renderContextType!==A.HalfPane&&Wo(o)&&!qt()){var d=function(u){u===He.Canceled?void 0:u===He.Unhandled&&x().assertConditionTag(u!==He.Unhandled,"Unhandled request to discard on close pane",592840769)};r.discardDraftAsync({renderContextType:n.componentTreeId.renderContextType,telemetryVisitor:t.telemetryVisitor,trackback:C.reserveTag(592840770)},le.SharedComments,!0,A1(o,n,a,ur.ClosePaneDraft)).then(d).catch(me(C.reserveTag(592840771)))}else aEe({dispatchProps:r,componentTree:n,telemetryVisitor:t.telemetryVisitor})}function aEe(e){var t=e.dispatchProps,r=e.componentTree,n=e.telemetryVisitor,o=x().createActivityObject("ClosePane",n,Ee());o.addDataField("PaneCloseResult",pq.NoDialog,N.SystemMetadata),o.successTag(592840773),t.requestClosePane({renderContextType:r.componentTreeId.renderContextType,telemetryVisitor:n,trackback:C.reserveTag(592840774)})}function sEe(e){var t=e.dispatchProps,r=e.componentTree,n=e.selectedComment,o=e.telemetryVisitor;return n?(t.requestDeleteThread({renderContextType:r.componentTreeId.renderContextType,telemetryVisitor:o,trackback:C.reserveTag(592840775)},n.selectedCardId),He.Handled):(x().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",592840776),He.Unhandled)}function S0(e,t,r,n,o){r.collapseCard({renderContextType:o.componentTreeId.renderContextType,telemetryVisitor:n,trackback:e},_o(t))}function I0(e,t,r,n){if(!(fr(n)&&!it()&&Q()!=="win32")){var o=_o(e);r.focusCommentCardCommand(t,o)}}function E0(e,t,r,n,o,a,d){o.requestUpdateCommentReactions({renderContextType:n,telemetryVisitor:a,trackback:e},t,d,r)}function P0(e,t,r,n,o){n.requestPresentLinkToComment({renderContextType:r,telemetryVisitor:o,trackback:e},t)}var Cv=f(()=>{"use strict";s();ne();te();ym();Rc();Tc();fd();ii();ln();Mu();yc();pn();Jt();ye();fq();Cr();an();gE();lE();yt();bn();so();kd();Id();mq();Vu();Um();Ve();Xa();i0();BF();gv();gq();Pr();li();zo()});var D1,ze,gl=f(()=>{"use strict";s();(function(e){e[e.New_nonFluent=0]="New_nonFluent",e[e.Normal=1]="Normal",e[e.Editing=2]="Editing",e[e.PendingDraft=3]="PendingDraft",e[e.PendingEdit=4]="PendingEdit",e[e.EditPreCommitPending=5]="EditPreCommitPending",e[e.Resolved=6]="Resolved",e[e.LowFidelityWarningEdit=7]="LowFidelityWarningEdit",e[e.LowFidelityWarningDelete=8]="LowFidelityWarningDelete",e[e.Error=9]="Error"})(D1||(D1={}));ze=D1});var w1,$f,F1=f(()=>{"use strict";s();(function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"})(w1||(w1={}));$f=w1});function O1(e,t){return e[t]=e[t]||{}}function dEe(e,t){if(t==null)return O1(e,"empty");if(typeof t=="object"||typeof t=="function"){var r=e.obj=e.obj||new WeakMap;return r.get(t)||r.set(t,{}).get(t)}var n=t+"",o=O1(e,"str");return o[n]=o[n]||{}}function N1(e,t){return t&&t.length>0?t.reduce(function(r,n){return dEe(r,n)},e):O1(e,"noargs")}var yq=f(()=>{"use strict";s()});function Cq(e,t,r){var n=N1(e,r);return n.hasOwnProperty("value")||(n.value=typeof t=="function"?t():t),[n.value,function(o,a){return Cq(n,o,a)}]}function Ao(e){var t=e?N1(cEe,[e]):{};return function(r,n){return Cq(t,r,n)}}var cEe,M1=f(()=>{"use strict";s();yq();cEe={}});function Qt(e){var t=Ao(),r=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return t(function(){return e.apply(void 0,o)},o)[0]};return r}var vq=f(()=>{"use strict";s();M1()});var Bc=f(()=>{"use strict";s();M1();vq()});function lEe(e){return typeof e=="boolean"?[{object:e},e]:typeof e=="number"?[{object:e>=0?e:!0},e!==0]:[e,!0]}function xq(e){return typeof e=="object"?Array.isArray(e)?"array":"object":typeof e}function fEe(e){return typeof e=="function"?e:typeof e=="string"?uEe[e]:void 0}function pEe(e){return e.array?{array:e.array}:{}}function mEe(e,t){return typeof e=="boolean"?e?m({object:e},t):t:typeof e=="number"?e===0?t:m({object:e-1},t):e}function gEe(e,t,r){var n=void 0,o=e[t]!==void 0?e[t]:e[r]!==void 0?e[r]:void 0;return o!==void 0&&(n=fEe(o),n===void 0&&r==="object"&&(n=mEe(o,pEe(e)))),n}function L1(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=r.filter(function(v){return v&&xq(v)==="object"&&Object.getOwnPropertyNames(v).length>0}),a=lEe(e),d=a[0],c=a[1],u=t&&o.length===1;if(o.length>1||u&&o.length===1){var l=u?void 0:Object.assign.apply(Object,w([{}],o,!1)),p=l||o[0],g=function(y){if(p.hasOwnProperty(y)){if(c){var T=p[y],b=xq(T),I=gEe(d,y,b);if(I!==void 0){var E=o.map(function(_){return _[y]}).filter(function(_){return _!==void 0}),P=typeof I=="function"?I.apply(void 0,E):L1.apply(void 0,w([I,t],E,!1));P!==T&&(l=l||Object.assign.apply(Object,w([{}],o,!1)),l[y]=P)}}!u&&l[y]===void 0&&delete l[y]}};for(var h in p)g(h);return l||p}return o.length>0?o[0]:void 0}function ua(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return L1.apply(void 0,w([!0,!1],e,!1))}function Us(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return L1.apply(void 0,w([e,!1],t,!1))}var uEe,Tq=f(()=>{"use strict";s();k();uEe={appendArray:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return[].concat.apply([],t)}}});var Vs=f(()=>{"use strict";s();Tq()});function bq(e){return Array.isArray(e)?ua.apply(void 0,e.map(function(t){return bq(t)})):e||{}}function yEe(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ua.apply(void 0,e.map(function(r){return bq(r)}))}function vi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.filter(function(n){return typeof n=="object"});return r.length>1||r.length===1&&Array.isArray(r[0])?CEe(function(){return yEe.apply(void 0,w([void 0],r,!1))},r)[0]:r[0]||{}}var CEe,H1=f(()=>{"use strict";s();k();Vs();Bc();CEe=Ao()});function xEe(e){return e.filter(function(t){return typeof t=="object"})}function dt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Us.apply(void 0,w([vEe],xEe(e),!1))}var vEe,Sq=f(()=>{"use strict";s();k();Vs();H1();vEe={className:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.filter(function(n){return n&&typeof n=="string"}).join(" ")},style:vi}});var Ng=f(()=>{"use strict";s();H1();Sq()});var qo,po,mo,Iq,B1=f(()=>{"use strict";s();k();qo=function(t){return t.colors},po=[{source:"color",lookup:qo}],mo=[{source:"backgroundColor",lookup:qo}],Iq=w(w([],po,!0),mo,!0)});function hl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=function(o){var a={};return e.filter(function(d){return o[d]!==void 0}).forEach(function(d){a[d]=o[d]}),a};return{from:r,keys:e}}var vv=f(()=>{"use strict";s()});var Gn,Ko,Eq=f(()=>{"use strict";s();B1();vv();Gn=[{source:"borderColor",lookup:qo},{source:"borderWidth"},{source:"borderRadius"},{source:"borderStyle"}],Ko=hl("borderColor","borderRadius","borderStyle","borderWidth")});function pr(e,t){return e._keys=t,e}var U1=f(()=>{"use strict";s()});function TEe(e,t){return{style:Zr.from(e,t)}}var Zr,Za,Pq=f(()=>{"use strict";s();U1();Zr={from:function(t,r){var n,o,a,d,c,u,l,p,g,h,v,y,T,b,I,E,P,_,D=t.fontDynamicTypeRamp,M=t.fontFamily,H=t.fontLetterSpacing,U=t.fontLineHeight,F=t.fontMaximumSize,z=t.fontSize,Y=t.fontStyle,B=t.fontWeight,q=t.textDecorationLine,K=t.variant,$=r.typography,oe=$.families,ie=$.sizes,Ce=$.weights,se=$.variants;return D!==void 0||M!==void 0||H!==void 0||U!==void 0||F!==void 0||z!==void 0||B!==void 0||K!==void 0?{fontFamily:(d=(o=(n=oe[M])!==null&&n!==void 0?n:M)!==null&&o!==void 0?o:oe[(a=se[K])===null||a===void 0?void 0:a.face])!==null&&d!==void 0?d:(c=se[K])===null||c===void 0?void 0:c.face,fontSize:(g=(l=(u=ie[z])!==null&&u!==void 0?u:z)!==null&&l!==void 0?l:ie[(p=se[K])===null||p===void 0?void 0:p.size])!==null&&g!==void 0?g:(h=se[K])===null||h===void 0?void 0:h.size,fontStyle:Y,fontWeight:(b=(y=(v=Ce[B])!==null&&v!==void 0?v:B)!==null&&y!==void 0?y:Ce[(T=se[K])===null||T===void 0?void 0:T.weight])!==null&&b!==void 0?b:(I=se[K])===null||I===void 0?void 0:I.weight,lineHeight:U??((E=se[K])===null||E===void 0?void 0:E.lineHeight),letterSpacing:H??((P=se[K])===null||P===void 0?void 0:P.letterSpacing),dynamicTypeRamp:D??((_=se[K])===null||_===void 0?void 0:_.dynamicTypeRamp),maximumFontSize:F,textDecorationLine:q}:{}},keys:["fontDynamicTypeRamp","fontFamily","fontLineHeight","fontLetterSpacing","fontMaximumSize","fontSize","fontStyle","fontWeight","variant","textDecorationLine"]};Za=pr(TEe,Zr.keys)});var ko,_q=f(()=>{"use strict";s();vv();ko=hl("width","height","minWidth","maxWidth","minHeight","maxHeight","padding","paddingHorizontal","paddingVertical","paddingStart","paddingEnd")});var Rq,Aq=f(()=>{"use strict";s();vv();Rq=hl("shadowColor","shadowOffset","shadowOpacity","shadowRadius")});var _n=f(()=>{"use strict";s();Eq();B1();Pq();_q();Aq();vv();U1()});function _0(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return typeof e=="function"&&e._canCompose?e.apply(void 0,w([t],r,!1)):V1.createElement.apply(V1,w([e,t],r,!1))}var V1,j1=f(()=>{"use strict";s();k();V1=S(L())});function IEe(e){return Array.isArray(e)?e:[e]}function Rn(e,t){var r=function(a){var d=a.children,c=Ke(a,["children"]);return e(c)({},IEe(d))},n=t?kq.memo(r):r;return Object.assign(n,{_staged:e}),n}var kq,Dq=f(()=>{"use strict";s();k();kq=S(L())});function EEe(e){return typeof e=="function"&&e._staged||void 0}function es(e,t,r){var n=EEe(e),o=xv.useMemo(function(){var c={},u=function(p){for(var g=[],h=1;h<arguments.length;h++)g[h-1]=arguments[h];var v=c.result,y=typeof v=="function"?p:dt(v,p),T=r?Object.keys(y).filter(function(b){return!r(b)}):void 0;return(T==null?void 0:T.length)>0&&(y=dt(y,Object.assign.apply(Object,w([{}],T.map(function(b){var I;return I={},I[b]=void 0,I}),!1)))),typeof v=="function"?v.apply(void 0,w([y],g,!1)):xv.createElement.apply(xv,w([e,y],g,!1))};return u._canCompose=!0,[u,c]},[e,r]),a=o[0],d=o[1];return d.result=n?n(t):t,a}var xv,wq=f(()=>{"use strict";s();k();xv=S(L());Ng()});function we(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return _0.apply(void 0,w([e,t],r,!1))}var Fq=f(()=>{"use strict";s();k();j1()});var Tv=f(()=>{"use strict";s();j1();Dq();wq();Fq()});function R0(e){var t=e.slots,r=e.filters,n=r===void 0?{}:r,o=e.useStyling;return function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];var c=typeof o=="function"?o.apply(void 0,a):o||{},u={};return Object.keys(t).forEach(function(l){u[l]=es(t[l],c[l],n[l])}),u}}var Oq=f(()=>{"use strict";s();Tv()});var W1=f(()=>{"use strict";s();Oq()});var A0,At,Uc,Nq=f(()=>{"use strict";s();A0=S(L()),At=A0.createContext(void 0),Uc=function(){return A0.useContext(At)}});var Qf=f(()=>{"use strict";s();Nq()});function bv(e,t,r,n){for(var o=function(l){var p,g=e[l],h=g===t[l]?void 0:g;p=r(function(){var v;return h===void 0?t:m(m({},t),(v={},v[l]=h,v))},[h]),t=p[0],r=p[1]},a=0,d=n;a<d.length;a++){var c=d[a];o(c)}return[t,r]}var Mq=f(()=>{"use strict";s();k()});function yl(e,t,r,n){var o={tokens:e,subCache:r};return t&&t.length>0&&(o=t.filter(function(a){return n(a)}).reduce(function(a,d){var c=a.tokens[d],u=a.subCache(function(){return c&&typeof c=="object"?ua(a.tokens,c):a.tokens},[c]),l=u[0],p=u[1];return{tokens:l,subCache:p}},o)),[o.tokens,o.subCache]}var Lq=f(()=>{"use strict";s();Vs()});function PEe(e,t,r){return typeof e=="string"&&(e=r&&r(t,e)||{}),typeof e=="function"&&(e=e(t)),e}function Mg(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=Ao(),o=function(d){return n(function(){return ua.apply(void 0,t.map(function(c){return PEe(c,d,e)}))},[d])};return o.customize=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];var c=w(w([],t,!0),a,!0);return Mg.apply(void 0,w([e],c,!1))},o}var Hq=f(()=>{"use strict";s();k();Vs();Bc()});var Bq=f(()=>{"use strict";s()});function Xf(e,t,r){for(var n=Object.keys(r).filter(function(u){return r[u]!==void 0}).sort(),o=function(l){var p;p=t(function(){var g;return m(m({},e),(g={},g[l]=r[l],g))},[l,r[l]]),e=p[0],t=p[1]},a=0,d=n;a<d.length;a++){var c=d[a];o(c)}return[e,t]}var Uq=f(()=>{"use strict";s();k()});var Sv=f(()=>{"use strict";s();Mq();Lq();Hq();Bq();Uq()});function jq(e,t){return function(r,n,o){return o(function(){return e(r,n)},(t||[]).map(function(a){return r[a]}))[0]}}function _Ee(e,t){return typeof t=="object"&&Array.isArray(t)?e.filter(function(r){return t.findIndex(function(n){return n===r})!==-1}):t?e:[]}function z1(e,t){var r=jq(e,t);return r.refine=t&&t.length>0?function(n){return jq(e,_Ee(t,n))}:void 0,r}function G1(e,t){var r={};return Object.keys(e).forEach(function(n){var o=typeof e[n]=="function"&&e[n].refine;r[n]=o?o(t):e[n]}),r}var q1=f(()=>{"use strict";s()});function REe(e,t,r,n){var o={};return Object.keys(e).forEach(function(a){var d=e[a];o[a]=typeof d=="function"?d(t,r,n(null,[a])[1]):d}),o}function k0(e,t){var r=t.useTheme,n=t.getComponentInfo,o=e.tokens,a=e.tokensThatAreAlsoProps,d=G1(e.slotProps||{},a),c=Mg.apply(void 0,w([n],o,!1));return function(u,l){var p,g,h=r(),v=c(h),y=v[0],T=v[1];return e.states&&(p=yl(y,e.states,T,l||function(b){return u[b]}),y=p[0],T=p[1]),typeof a=="object"&&Array.isArray(a)?(g=bv(u,y,T,a),y=g[0],T=g[1]):a==="all"&&(y=m(m({},y),u)),REe(d,y,h,T)}}var Wq=f(()=>{"use strict";s();k();Sv();q1()});var K1=f(()=>{"use strict";s();Wq();q1();Sv()});function Iv(e,t,r){var n=r==null?void 0:r.__options;e=n?Us(Y1,n,e):$1({},e),e.useStyling=e.slotProps||e.tokens?k0(e,t):function(){return{}};var o=R0(e),a=Rn(function(d){return e.useRender(d,o)});return a.displayName=e.displayName,a.__options=e,a.customize=function(){for(var d=[],c=0;c<arguments.length;c++)d[c]=arguments[c];return Iv(Us(Y1,e,{tokens:d}),t)},a.compose=function(d){return Iv(Us(Y1,e,d),t)},e.statics&&Object.assign(a,e.statics),a}var $1,Y1,zq=f(()=>{"use strict";s();Vs();Tv();W1();K1();$1=function(){return $1=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$1.apply(this,arguments)},Y1={tokens:"appendArray",object:!0}});var Gq=f(()=>{"use strict";s();zq()});var Kq=be((Cxt,qq)=>{s();qq.exports={color:{anchor:{primary:"#394146",shade10:"#333a3f",shade20:"#2b3135",shade30:"#202427",shade40:"#111315",shade50:"#090a0b",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"},beige:{primary:"#7a7574",shade10:"#6e6968",shade20:"#5d5958",shade30:"#444241",shade40:"#252323",shade50:"#141313",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},berry:{primary:"#c239b3",shade10:"#af33a1",shade20:"#932b88",shade30:"#6d2064",shade40:"#3a1136",shade50:"#1f091d",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},black:"#000000",blackAlpha10:"#0000001a",blackAlpha20:"#00000033",blackAlpha30:"#0000004d",blackAlpha40:"#00000066",blackAlpha5:"#0000000d",blackAlpha50:"#00000080",blackAlpha60:"#00000099",blackAlpha70:"#000000b3",blackAlpha80:"#000000cc",blackAlpha90:"#000000e6",blue:{primary:"#0078d4",shade10:"#006cbf",shade20:"#005ba1",shade30:"#004377",shade40:"#002440",shade50:"#001322",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},brand:{10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc",primary:"#185abd",shade10:"#1651aa",shade20:"#13458f",shade30:"#0e336a",shade40:"#004578",shade50:"#043862",shade60:"#092c47",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4",tint50:"#deecf9",tint60:"#eff6fc"},brandShadowAmbient:"#0000004d",brandShadowKey:"#00000040",brass:{primary:"#986f0b",shade10:"#89640a",shade20:"#745408",shade30:"#553e06",shade40:"#2e2103",shade50:"#181202",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},bronze:{primary:"#a74109",shade10:"#963a08",shade20:"#7f3107",shade30:"#5e2405",shade40:"#321303",shade50:"#1b0a01",tint10:"#b2521e",tint20:"#bc6535",tint30:"#ca8057",tint40:"#e5bba4",tint50:"#f1d9cc",tint60:"#fbf5f2"},brown:{primary:"#8e562e",shade10:"#804d29",shade20:"#6c4123",shade30:"#50301a",shade40:"#2b1a0e",shade50:"#170e07",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},burgundy:{primary:"#a4262c",shade10:"#942228",shade20:"#7d1d21",shade30:"#5c1519",shade40:"#310b0d",shade50:"#1a0607",tint10:"#af393e",tint20:"#ba4d52",tint30:"#c86c70",tint40:"#e4afb2",tint50:"#f0d3d4",tint60:"#fbf4f4"},charcoal:{primary:"#393939",shade10:"#333333",shade20:"#2b2b2b",shade30:"#202020",shade40:"#111111",shade50:"#090909",tint10:"#515151",tint20:"#686868",tint30:"#888888",tint40:"#c4c4c4",tint50:"#dfdfdf",tint60:"#f7f7f7"},cornflower:{primary:"#4f6bed",shade10:"#4760d5",shade20:"#3c51b4",shade30:"#2c3c85",shade40:"#182047",shade50:"#0d1126",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},cranberry:{primary:"#c50f1f",shade10:"#b10e1c",shade20:"#960b18",shade30:"#6e0811",shade40:"#3b0509",shade50:"#200205",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},cyan:{primary:"#0099bc",shade10:"#008aa9",shade20:"#00748f",shade30:"#005669",shade40:"#002e38",shade50:"#00181e",tint10:"#18a4c4",tint20:"#31afcc",tint30:"#56bfd7",tint40:"#a4deeb",tint50:"#cdedf4",tint60:"#f2fafc"},darkBlue:{primary:"#003966",shade10:"#00335c",shade20:"#002b4e",shade30:"#002039",shade40:"#00111f",shade50:"#000910",tint10:"#0e4a78",tint20:"#215c8b",tint30:"#4178a3",tint40:"#92b5d1",tint50:"#c2d6e7",tint60:"#eff4f9"},darkBrown:{primary:"#4d291c",shade10:"#452519",shade20:"#3a1f15",shade30:"#2b1710",shade40:"#170c08",shade50:"#0c0704",tint10:"#623a2b",tint20:"#784d3e",tint30:"#946b5c",tint40:"#caada3",tint50:"#e3d2cb",tint60:"#f8f3f2"},darkGreen:{primary:"#0b6a0b",shade10:"#0a5f0a",shade20:"#085108",shade30:"#063b06",shade40:"#032003",shade50:"#021102",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},darkOrange:{primary:"#da3b01",shade10:"#c43501",shade20:"#a62d01",shade30:"#7a2101",shade40:"#411200",shade50:"#230900",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},darkPurple:{primary:"#401b6c",shade10:"#3a1861",shade20:"#311552",shade30:"#240f3c",shade40:"#130820",shade50:"#0a0411",tint10:"#512b7e",tint20:"#633e8f",tint30:"#7e5ca7",tint40:"#b9a3d3",tint50:"#d8cce7",tint60:"#f5f2f9"},darkRed:{primary:"#750b1c",shade10:"#690a19",shade20:"#590815",shade30:"#420610",shade40:"#230308",shade50:"#130204",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},darkTeal:{primary:"#006666",shade10:"#005c5c",shade20:"#004e4e",shade30:"#003939",shade40:"#001f1f",shade50:"#001010",tint10:"#0e7878",tint20:"#218b8b",tint30:"#41a3a3",tint40:"#92d1d1",tint50:"#c2e7e7",tint60:"#eff9f9"},excel:{primary:"#107c41",shade10:"#0f703b",shade20:"#0c5f32",shade30:"#094624",shade40:"#094624",shade50:"#052912",shade60:"#03160a",tint10:"#218d51",tint20:"#55b17e",tint30:"#a0d8b9",tint40:"#caead8",tint50:"#a0d8b9",tint60:"#caead8"},forest:{primary:"#498205",shade10:"#427505",shade20:"#376304",shade30:"#294903",shade40:"#162702",shade50:"#0c1501",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},gold:{primary:"#c19c00",shade10:"#ae8c00",shade20:"#937700",shade30:"#6c5700",shade40:"#3a2f00",shade50:"#1f1900",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},grape:{primary:"#881798",shade10:"#7a1589",shade20:"#671174",shade30:"#4c0d55",shade40:"#29072e",shade50:"#160418",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},green:{primary:"#107c10",shade10:"#0e700e",shade20:"#0c5e0c",shade30:"#094509",shade40:"#052505",shade50:"#031403",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},grey10:"#1a1a1a",grey10Alpha10:"#1a1a1a1a",grey10Alpha20:"#1a1a1a33",grey10Alpha30:"#1a1a1a4d",grey10Alpha40:"#1a1a1a66",grey10Alpha5:"#1a1a1a0d",grey10Alpha50:"#1a1a1a80",grey10Alpha60:"#1a1a1a99",grey10Alpha70:"#1a1a1ab3",grey10Alpha80:"#1a1a1acc",grey10Alpha90:"#1a1a1ae6",grey12:"#1f1f1f",grey12Alpha10:"#1f1f1f1a",grey12Alpha20:"#1f1f1f33",grey12Alpha30:"#1f1f1f4d",grey12Alpha40:"#1f1f1f66",grey12Alpha5:"#1f1f1f0d",grey12Alpha50:"#1f1f1f80",grey12Alpha60:"#1f1f1f99",grey12Alpha70:"#1f1f1fb3",grey12Alpha80:"#1f1f1fcc",grey12Alpha90:"#1f1f1fe6",grey14:"#242424",grey14Alpha10:"#2424241a",grey14Alpha20:"#24242433",grey14Alpha30:"#2424244d",grey14Alpha40:"#24242466",grey14Alpha5:"#2424240d",grey14Alpha50:"#24242480",grey14Alpha60:"#24242499",grey14Alpha70:"#242424b3",grey14Alpha80:"#242424cc",grey14Alpha90:"#242424e6",grey16:"#292929",grey18:"#2e2e2e",grey2:"#050505",grey20:"#333333",grey22:"#383838",grey24:"#3d3d3d",grey26:"#424242",grey28:"#474747",grey30:"#4d4d4d",grey32:"#525252",grey34:"#575757",grey36:"#5c5c5c",grey38:"#616161",grey4:"#0a0a0a",grey40:"#666666",grey42:"#6b6b6b",grey44:"#707070",grey46:"#757575",grey48:"#7a7a7a",grey50:"#808080",grey52:"#858585",grey54:"#8a8a8a",grey56:"#8f8f8f",grey58:"#949494",grey6:"#0f0f0f",grey60:"#999999",grey62:"#9e9e9e",grey64:"#a3a3a3",grey66:"#a8a8a8",grey68:"#adadad",grey70:"#b3b3b3",grey72:"#b8b8b8",grey74:"#bdbdbd",grey76:"#c2c2c2",grey78:"#c7c7c7",grey8:"#141414",grey80:"#cccccc",grey82:"#d1d1d1",grey84:"#d6d6d6",grey86:"#dbdbdb",grey88:"#e0e0e0",grey90:"#e6e6e6",grey92:"#ebebeb",grey94:"#f0f0f0",grey96:"#f5f5f5",grey98:"#fafafa",hotPink:{primary:"#e3008c",shade10:"#cc007e",shade20:"#ad006a",shade30:"#7f004e",shade40:"#44002a",shade50:"#240016",tint10:"#e61c99",tint20:"#ea38a6",tint30:"#ee5fb7",tint40:"#f7adda",tint50:"#fbd2eb",tint60:"#fef4fa"},lavender:{primary:"#7160e8",shade10:"#6656d1",shade20:"#5649b0",shade30:"#3f3682",shade40:"#221d46",shade50:"#120f25",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},lightBlue:{primary:"#3a96dd",shade10:"#3487c7",shade20:"#2c72a8",shade30:"#20547c",shade40:"#112d42",shade50:"#091823",tint10:"#4fa1e1",tint20:"#65ade5",tint30:"#83bdeb",tint40:"#bfddf5",tint50:"#dcedfa",tint60:"#f6fafe"},lightGreen:{primary:"#13a10e",shade10:"#11910d",shade20:"#0e7a0b",shade30:"#0b5a08",shade40:"#063004",shade50:"#031a02",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},lightTeal:{primary:"#00b7c3",shade10:"#00a5af",shade20:"#008b94",shade30:"#00666d",shade40:"#00373a",shade50:"#001d1f",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},lilac:{primary:"#b146c2",shade10:"#9f3faf",shade20:"#863593",shade30:"#63276d",shade40:"#35153a",shade50:"#1c0b1f",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},lime:{primary:"#73aa24",shade10:"#689920",shade20:"#57811b",shade30:"#405f14",shade40:"#23330b",shade50:"#121b06",tint10:"#81b437",tint20:"#90be4c",tint30:"#a4cc6c",tint40:"#cfe5af",tint50:"#e5f1d3",tint60:"#f8fcf4"},magenta:{primary:"#bf0077",shade10:"#ac006b",shade20:"#91005a",shade30:"#6b0043",shade40:"#390024",shade50:"#1f0013",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},marigold:{primary:"#eaa300",shade10:"#d39300",shade20:"#b27c00",shade30:"#835b00",shade40:"#463100",shade50:"#251a00",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},mink:{primary:"#5d5a58",shade10:"#54514f",shade20:"#474443",shade30:"#343231",shade40:"#1c1b1a",shade50:"#0f0e0e",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},navy:{primary:"#0027b4",shade10:"#0023a2",shade20:"#001e89",shade30:"#001665",shade40:"#000c36",shade50:"#00061d",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},neutralShadowAmbient:"#0000001f",neutralShadowAmbientDarker:"#00000033",neutralShadowAmbientLighter:"#0000000f",neutralShadowKey:"#00000024",neutralShadowKeyDarker:"#0000003d",neutralShadowKeyLighter:"#00000012",office:{primary:"#d83b01",shade10:"#c33400",shade20:"#a52c00",shade30:"#792000",shade40:"#792000",shade50:"#4d2415",shade60:"#29130b",tint10:"#dd4f1b",tint20:"#e8825d",tint30:"#f4beaa",tint40:"#f9dcd1",tint50:"#f4beaa",tint60:"#f9dcd1"},oneNote:{primary:"#80397b",shade10:"#6c2f68",shade20:"#52254f",shade30:"#3c1a3a",shade40:"#430e60",shade50:"#430e60",shade60:"#430e60",tint10:"#9e5499",tint20:"#d4a9d1",tint30:"#e0bfde",tint40:"#f0daee",tint50:"#e6d1f2",tint60:"#e6d1f2"},orange:{primary:"#f7630c",shade10:"#de590b",shade20:"#bc4b09",shade30:"#8a3707",shade40:"#4a1e04",shade50:"#271002",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},orchid:{primary:"#8764b8",shade10:"#795aa6",shade20:"#674c8c",shade30:"#4c3867",shade40:"#281e37",shade50:"#16101d",tint10:"#9373c0",tint20:"#a083c9",tint30:"#b29ad4",tint40:"#d7caea",tint50:"#e9e2f4",tint60:"#f9f8fc"},outlook:{primary:"#0078d4",shade10:"#106ebe",shade20:"#1664a7",shade30:"#135995",shade40:"#004578",shade50:"#043862",shade60:"#092c47",tint10:"#2488d8",tint20:"#69afe5",tint30:"#b3d6f2",tint40:"#cce3f5",tint50:"#deecf9",tint60:"#eff6fc"},peach:{primary:"#ff8c00",shade10:"#e67e00",shade20:"#c26a00",shade30:"#8f4e00",shade40:"#4d2a00",shade50:"#291600",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},pink:{primary:"#e43ba6",shade10:"#cd3595",shade20:"#ad2d7e",shade30:"#80215d",shade40:"#441232",shade50:"#24091b",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},platinum:{primary:"#69797e",shade10:"#5f6d71",shade20:"#505c60",shade30:"#3b4447",shade40:"#1f2426",shade50:"#111314",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},plum:{primary:"#77004d",shade10:"#6b0045",shade20:"#5a003b",shade30:"#43002b",shade40:"#240017",shade50:"#13000c",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},powerPoint:{primary:"#c43e1c",shade10:"#b13719",shade20:"#952f15",shade30:"#6e220f",shade40:"#6e220f",shade50:"#3c1805",shade60:"#200d03",tint10:"#cb5031",tint20:"#dc816a",tint30:"#edbcb0",tint40:"#f6dbd4",tint50:"#edbcb0",tint60:"#f6dbd4"},pumpkin:{primary:"#ca5010",shade10:"#b6480e",shade20:"#9a3d0c",shade30:"#712d09",shade40:"#3d1805",shade50:"#200d03",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},purple:{primary:"#5c2e91",shade10:"#532982",shade20:"#46236e",shade30:"#341a51",shade40:"#1c0e2b",shade50:"#0f0717",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},red:{primary:"#d13438",shade10:"#bc2f32",shade20:"#9f282b",shade30:"#751d1f",shade40:"#3f1011",shade50:"#210809",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},royalBlue:{primary:"#004e8c",shade10:"#00467e",shade20:"#003b6a",shade30:"#002c4e",shade40:"#00172a",shade50:"#000c16",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},seafoam:{primary:"#00cc6a",shade10:"#00b85f",shade20:"#009b51",shade30:"#00723b",shade40:"#003d20",shade50:"#002111",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},silver:{primary:"#859599",shade10:"#78868a",shade20:"#657174",shade30:"#4a5356",shade40:"#282d2e",shade50:"#151818",tint10:"#92a1a5",tint20:"#a0aeb1",tint30:"#b3bfc2",tint40:"#d8dfe0",tint50:"#eaeeef",tint60:"#fafbfb"},steel:{primary:"#005b70",shade10:"#005265",shade20:"#004555",shade30:"#00333f",shade40:"#001b22",shade50:"#000f12",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},teal:{primary:"#038387",shade10:"#037679",shade20:"#026467",shade30:"#02494c",shade40:"#012728",shade50:"#001516",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},white:"#ffffff",whiteAlpha10:"#ffffff1a",whiteAlpha20:"#ffffff33",whiteAlpha30:"#ffffff4d",whiteAlpha40:"#ffffff66",whiteAlpha5:"#ffffff0d",whiteAlpha50:"#ffffff80",whiteAlpha60:"#ffffff99",whiteAlpha70:"#ffffffb3",whiteAlpha80:"#ffffffcc",whiteAlpha90:"#ffffffe6",word:{primary:"#185abd",shade10:"#1651aa",shade20:"#13458f",shade30:"#0e336a",shade40:"#0e336a",shade50:"#0c2145",shade60:"#071225",tint10:"#2e6ac5",tint20:"#6794d7",tint30:"#aec6eb",tint40:"#d2e0f4",tint50:"#aec6eb",tint60:"#d2e0f4"},yellow:{primary:"#fde300",shade10:"#e4cc00",shade20:"#c0ad00",shade30:"#817400",shade40:"#4c4400",shade50:"#282400",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},hcButtonFace:"PlatformColor(ButtonFace)",hcButtonText:"PlatformColor(ButtonText)",hcCanvas:"PlatformColor(Window)",hcCanvasText:"PlatformColor(WindowText)",hcDisabled:"PlatformColor(GrayText)",hcHighlight:"PlatformColor(Highlight)",hcHighlightText:"PlatformColor(HighlightText)",hcHyperlink:"PlatformColor(Hotlight)"},corner:{radius120:12,radius20:2,radius40:4,radius60:6,radius80:8,radiusCircular:9999,radiusNone:0},font:{family:{base:"Segoe UI",monospace:"Consolas",numeric:"Bahnschrift"},lineHeight100:14,lineHeight1000:92,lineHeight200:16,lineHeight300:20,lineHeight400:22,lineHeight500:26,lineHeight600:32,lineHeight700:36,lineHeight800:40,lineHeight900:52,size100:10,size1000:68,size200:12,size300:14,size400:16,size500:20,size600:24,size700:28,size800:32,size900:40,weight:{bold:"700",medium:"500",regular:"400",semibold:"600"}},size100:10,size120:12,size1200:120,size160:16,size20:2,size200:20,size240:24,size280:28,size320:32,size360:36,size40:4,size400:40,size480:48,size560:56,size60:6,size640:64,size720:72,size80:8,size800:80,sizeNone:0,stroke:{width05:.5,width10:1,width15:1.5,width20:2,width30:3,width40:4,width60:6,widthNone:0}}});var Yq,O,$q=f(()=>{"use strict";s();Yq=S(Kq()),O=Yq.default});var Q1=be((bxt,Qq)=>{s();Qq.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var Jq=be((Ixt,Xq)=>{s();Xq.exports={brandBackground:{rest:"#1651aa",hover:"#185abd",pressed:"#004578",selected:"#13458f"},brandBackground2:{rest:"#004578"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#6794d7"},brandForeground2:{rest:"#aec6eb"},brandForegroundLink:{rest:"#2e6ac5",hover:"#aec6eb",pressed:"#6794d7",selected:"#2e6ac5"},brandStroke1:{rest:"#2e6ac5"},brandStroke2:{rest:"#0e336a"},compoundBrandBackground1:{rest:"#2e6ac5",hover:"#6794d7",pressed:"#185abd"},compoundBrandForeground1:{rest:"#2e6ac5",hover:"#6794d7",pressed:"#185abd"},compoundBrandStroke1:{rest:"#2e6ac5",hover:"#6794d7",pressed:"#185abd"},dangerBackground1:{rest:"#3f1011"},dangerBackground2:{rest:"#751d1f"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#d13438"},dangerBorder2:{rest:"#dc5e62"},dangerBorderActive:{rest:"#e37d80"},dangerForeground1:{rest:"#e37d80"},dangerForeground2:{rest:"#f1bbbc"},dangerForeground3:{rest:"#e37d80"},dangerForegroundInverted:{rest:"#d13438"},neutralBackground1:{rest:"#292929",hover:"#3d3d3d",pressed:"#1f1f1f",selected:"#383838"},neutralBackground2:{rest:"#1f1f1f",hover:"#333333",pressed:"#141414",selected:"#2e2e2e"},neutralBackground3:{rest:"#141414",hover:"#292929",pressed:"#0a0a0a",selected:"#242424"},neutralBackground4:{rest:"#0a0a0a",hover:"#1f1f1f",pressed:"#000000",selected:"#1a1a1a"},neutralBackground5:{rest:"#000000",hover:"#141414",pressed:"#050505",selected:"#0f0f0f"},neutralBackground6:{rest:"#333333"},neutralBackgroundDisabled:{rest:"#141414"},neutralBackgroundInverted:{rest:"#ffffff"},neutralForeground1:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForeground2:{rest:"#d6d6d6",hover:"#ffffff",pressed:"#ffffff",brandHover:"#6794d7",brandPressed:"#2e6ac5",brandSelected:"#6794d7",selected:"#ffffff"},neutralForeground3:{rest:"#adadad",hover:"#d6d6d6",pressed:"#d6d6d6",brandHover:"#6794d7",brandPressed:"#2e6ac5",brandSelected:"#6794d7",selected:"#d6d6d6"},neutralForeground4:{rest:"#999999"},neutralForegroundDisabled:{rest:"#5c5c5c"},neutralForegroundInverted:{rest:"#242424"},neutralForegroundInvertedLink:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#333333"},neutralStencil2:{rest:"#575757"},neutralStroke1:{rest:"#666666",hover:"#757575",pressed:"#6b6b6b",selected:"#707070"},neutralStroke2:{rest:"#525252"},neutralStroke3:{rest:"#3d3d3d"},neutralStrokeAccessible:{rest:"#adadad",hover:"#bdbdbd",pressed:"#b3b3b3",selected:"#6794d7"},neutralStrokeDisabled:{rest:"#424242"},outofofficeBackground1:{rest:"#3a1136"},outofofficeBackground2:{rest:"#6d2064"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#c239b3"},outofofficeBorder2:{rest:"#d161c4"},outofofficeBorderActive:{rest:"#da7ed0"},outofofficeForeground1:{rest:"#da7ed0"},outofofficeForeground2:{rest:"#edbbe7"},outofofficeForeground3:{rest:"#d161c4"},severeBackground1:{rest:"#411200"},severeBackground2:{rest:"#7a2101"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#da3b01"},severeBorder2:{rest:"#e9835e"},severeBorderActive:{rest:"#e9835e"},severeForeground1:{rest:"#e9835e"},severeForeground2:{rest:"#f4bfab"},severeForeground3:{rest:"#e9835e"},strokeFocus1:{rest:"#000000"},strokeFocus2:{rest:"#ffffff"},subtleBackground:{rest:"#00000000",hover:"#383838",pressed:"#2e2e2e",selected:"#333333"},successBackground1:{rest:"#052505"},successBackground2:{rest:"#094509"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#107c10"},successBorder2:{rest:"#9fd89f"},successBorderActive:{rest:"#54b054"},successForeground1:{rest:"#54b054"},successForeground2:{rest:"#9fd89f"},successForeground3:{rest:"#9fd89f"},successForegroundInverted:{rest:"#107c10"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#4c4400"},warningBackground2:{rest:"#817400"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fde300"},warningBorder2:{rest:"#fdea3d"},warningBorderActive:{rest:"#feee66"},warningForeground1:{rest:"#feee66"},warningForeground2:{rest:"#fef7b2"},warningForeground3:{rest:"#fdea3d"},warningForegroundInverted:{rest:"#817400"}}});var eK=be((Pxt,Zq)=>{s();Zq.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var rK=be((Rxt,tK)=>{s();tK.exports={brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#004578",selected:"#13458f"},brandBackground2:{rest:"#eff6fc"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#185abd"},brandForeground2:{rest:"#1651aa"},brandForegroundLink:{rest:"#1651aa",hover:"#13458f",pressed:"#004578",selected:"#1651aa"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#d2e0f4"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#13458f"},compoundBrandForeground1:{rest:"#185abd",hover:"#1651aa",pressed:"#13458f"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#13458f"},dangerBackground1:{rest:"#fdf6f6"},dangerBackground2:{rest:"#f1bbbc"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#f1bbbc"},dangerBorder2:{rest:"#d13438"},dangerBorderActive:{rest:"#d13438"},dangerForeground1:{rest:"#bc2f32"},dangerForeground2:{rest:"#751d1f"},dangerForeground3:{rest:"#d13438"},dangerForegroundInverted:{rest:"#dc5e62"},neutralBackground1:{rest:"#ffffff",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},neutralBackground2:{rest:"#fafafa",hover:"#f0f0f0",pressed:"#dbdbdb",selected:"#e6e6e6"},neutralBackground3:{rest:"#f5f5f5",hover:"#ebebeb",pressed:"#d6d6d6",selected:"#e0e0e0"},neutralBackground4:{rest:"#f0f0f0",hover:"#fafafa",pressed:"#f5f5f5",selected:"#ffffff"},neutralBackground5:{rest:"#ebebeb",hover:"#f5f5f5",pressed:"#f0f0f0",selected:"#fafafa"},neutralBackground6:{rest:"#e6e6e6"},neutralBackgroundDisabled:{rest:"#f0f0f0"},neutralBackgroundInverted:{rest:"#616161"},neutralForeground1:{rest:"#242424",hover:"#242424",pressed:"#242424",selected:"#242424"},neutralForeground2:{rest:"#424242",hover:"#242424",pressed:"#242424",brandHover:"#185abd",brandPressed:"#1651aa",brandSelected:"#185abd",selected:"#242424"},neutralForeground3:{rest:"#616161",hover:"#424242",pressed:"#424242",brandHover:"#185abd",brandPressed:"#1651aa",brandSelected:"#185abd",selected:"#424242"},neutralForeground4:{rest:"#707070"},neutralForegroundDisabled:{rest:"#bdbdbd"},neutralForegroundInverted:{rest:"#ffffff"},neutralForegroundInvertedLink:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#e6e6e6"},neutralStencil2:{rest:"#fafafa"},neutralStroke1:{rest:"#d1d1d1",hover:"#c7c7c7",pressed:"#b3b3b3",selected:"#bdbdbd"},neutralStroke2:{rest:"#e0e0e0"},neutralStroke3:{rest:"#f0f0f0"},neutralStrokeAccessible:{rest:"#616161",hover:"#575757",pressed:"#4d4d4d",selected:"#185abd"},neutralStrokeDisabled:{rest:"#e0e0e0"},outofofficeBackground1:{rest:"#fdf5fc"},outofofficeBackground2:{rest:"#edbbe7"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#edbbe7"},outofofficeBorder2:{rest:"#c239b3"},outofofficeBorderActive:{rest:"#c239b3"},outofofficeForeground1:{rest:"#af33a1"},outofofficeForeground2:{rest:"#6d2064"},outofofficeForeground3:{rest:"#c239b3"},severeBackground1:{rest:"#fdf6f3"},severeBackground2:{rest:"#f4bfab"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#f4bfab"},severeBorder2:{rest:"#da3b01"},severeBorderActive:{rest:"#da3b01"},severeForeground1:{rest:"#c43501"},severeForeground2:{rest:"#7a2101"},severeForeground3:{rest:"#da3b01"},strokeFocus1:{rest:"#ffffff"},strokeFocus2:{rest:"#000000"},subtleBackground:{rest:"#00000000",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},successBackground1:{rest:"#f1faf1"},successBackground2:{rest:"#9fd89f"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#9fd89f"},successBorder2:{rest:"#107c10"},successBorderActive:{rest:"#107c10"},successForeground1:{rest:"#0e700e"},successForeground2:{rest:"#094509"},successForeground3:{rest:"#107c10"},successForegroundInverted:{rest:"#359b35"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#fffef5"},warningBackground2:{rest:"#fef7b2"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fef7b2"},warningBorder2:{rest:"#fde300"},warningBorderActive:{rest:"#fde300"},warningForeground1:{rest:"#817400"},warningForeground2:{rest:"#817400"},warningForeground3:{rest:"#fde300"},warningForegroundInverted:{rest:"#fef7b2"}}});var oK=be((kxt,nK)=>{s();nK.exports={shadow16:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:8,blur:16}],shadow2:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:1,blur:2}],shadow28:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:14,blur:28}],shadow4:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:2,blur:4}],shadow64:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:32,blur:64}],shadow8:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var w0=be(D0=>{"use strict";s();Object.defineProperty(D0,"__esModule",{value:!0});function iK(e,t){if(t)return e;throw new Error("Unhandled discriminated union member: "+JSON.stringify(e))}D0.assertNever=iK;D0.default=iK});var X1=be((Oxt,aK)=>{s();aK.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"PlatformColor(ButtonFace)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},brandBackground2:{rest:"PlatformColor(ButtonFace)"},brandBackgroundStatic:{rest:"PlatformColor(Window)"},brandForeground1:{rest:"PlatformColor(WindowText)"},brandForeground2:{rest:"PlatformColor(ButtonText)"},brandForegroundLink:{rest:"PlatformColor(Hotlight)",hover:"PlatformColor(Hotlight)",pressed:"PlatformColor(Hotlight)",selected:"PlatformColor(Hotlight)"},brandStroke1:{rest:"PlatformColor(WindowText)"},brandStroke2:{rest:"PlatformColor(Window)"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"PlatformColor(Highlight)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)"},compoundBrandForeground1:{rest:"PlatformColor(Highlight)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)"},compoundBrandStroke1:{rest:"PlatformColor(Highlight)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)"},dangerBackground1:{rest:"PlatformColor(Window)"},dangerBackground2:{rest:"PlatformColor(Window)"},dangerBackground3:{rest:"PlatformColor(WindowText)"},dangerBorder1:{rest:"PlatformColor(WindowText)"},dangerBorder2:{rest:"PlatformColor(WindowText)"},dangerBorderActive:{rest:"PlatformColor(Highlight)"},dangerForeground1:{rest:"PlatformColor(WindowText)"},dangerForeground2:{rest:"PlatformColor(WindowText)"},dangerForeground3:{rest:"PlatformColor(WindowText)"},dangerForegroundInverted:{rest:"PlatformColor(WindowText)"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground2:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground3:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground4:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground5:{rest:"PlatformColor(Window)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralBackground6:{rest:"PlatformColor(Window)"},neutralBackgroundDisabled:{rest:"PlatformColor(Window)"},neutralBackgroundInverted:{rest:"PlatformColor(WindowText)"},neutralForeground1:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralForeground2:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",brandHover:"PlatformColor(HighlightText)",brandPressed:"PlatformColor(HighlightText)",brandSelected:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralForeground3:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",brandHover:"PlatformColor(HighlightText)",brandPressed:"PlatformColor(HighlightText)",brandSelected:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralForeground4:{rest:"PlatformColor(WindowText)"},neutralForegroundDisabled:{rest:"PlatformColor(GrayText)"},neutralForegroundInverted:{rest:"PlatformColor(Window)"},neutralForegroundInvertedLink:{rest:"PlatformColor(Hotlight)",hover:"PlatformColor(Hotlight)",pressed:"PlatformColor(Hotlight)",selected:"PlatformColor(Hotlight)"},neutralForegroundOnBrand:{rest:"PlatformColor(ButtonText)",hover:"PlatformColor(HighlightText)",pressed:"PlatformColor(HighlightText)",selected:"PlatformColor(HighlightText)"},neutralStencil1:{rest:"#141414"},neutralStencil2:{rest:"#858585"},neutralStroke1:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralStroke2:{rest:"PlatformColor(WindowText)"},neutralStroke3:{rest:"PlatformColor(WindowText)"},neutralStrokeAccessible:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},neutralStrokeDisabled:{rest:"PlatformColor(GrayText)"},outofofficeBackground1:{rest:"PlatformColor(Window)"},outofofficeBackground2:{rest:"PlatformColor(Window)"},outofofficeBackground3:{rest:"PlatformColor(WindowText)"},outofofficeBorder1:{rest:"PlatformColor(WindowText)"},outofofficeBorder2:{rest:"PlatformColor(WindowText)"},outofofficeBorderActive:{rest:"PlatformColor(Highlight)"},outofofficeForeground1:{rest:"PlatformColor(WindowText)"},outofofficeForeground2:{rest:"PlatformColor(WindowText)"},outofofficeForeground3:{rest:"PlatformColor(WindowText)"},severeBackground1:{rest:"PlatformColor(Window)"},severeBackground2:{rest:"PlatformColor(Window)"},severeBackground3:{rest:"PlatformColor(WindowText)"},severeBorder1:{rest:"PlatformColor(WindowText)"},severeBorder2:{rest:"PlatformColor(WindowText)"},severeBorderActive:{rest:"PlatformColor(Highlight)"},severeForeground1:{rest:"PlatformColor(WindowText)"},severeForeground2:{rest:"PlatformColor(WindowText)"},severeForeground3:{rest:"PlatformColor(WindowText)"},strokeFocus1:{rest:"PlatformColor(Window)"},strokeFocus2:{rest:"PlatformColor(Highlight)"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",selected:"PlatformColor(Highlight)"},successBackground1:{rest:"PlatformColor(Window)"},successBackground2:{rest:"PlatformColor(Window)"},successBackground3:{rest:"PlatformColor(WindowText)"},successBorder1:{rest:"PlatformColor(WindowText)"},successBorder2:{rest:"PlatformColor(WindowText)"},successBorderActive:{rest:"PlatformColor(Highlight)"},successForeground1:{rest:"PlatformColor(WindowText)"},successForeground2:{rest:"PlatformColor(WindowText)"},successForeground3:{rest:"PlatformColor(WindowText)"},successForegroundInverted:{rest:"PlatformColor(WindowText)"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"PlatformColor(WindowText)",hover:"PlatformColor(Highlight)",pressed:"PlatformColor(Highlight)",disabled:"PlatformColor(GrayText)"},warningBackground1:{rest:"PlatformColor(Window)"},warningBackground2:{rest:"PlatformColor(Window)"},warningBackground3:{rest:"PlatformColor(WindowText)"},warningBorder1:{rest:"PlatformColor(WindowText)"},warningBorder2:{rest:"PlatformColor(WindowText)"},warningBorderActive:{rest:"PlatformColor(Highlight)"},warningForeground1:{rest:"PlatformColor(WindowText)"},warningForeground2:{rest:"PlatformColor(WindowText)"},warningForeground3:{rest:"PlatformColor(WindowText)"},warningForegroundInverted:{rest:"PlatformColor(WindowText)"}}});function AEe(e){for(var t in e)for(var r in e[t]){var n=e[t][r];if(typeof n=="string"&&n.includes("PlatformColor")){var o=n.substring(14,n.length-1);e[t][r]=(0,sK.PlatformColor)(o)}}return e}var sK,dK,cK,uK=f(()=>{"use strict";s();sK=S(re()),dK=S(X1()),cK=AEe(dK.default)});function Z1(e){return e==="light"?J1.default:e==="dark"||e==="darkElevated"?fK.default:e==="highContrast"?cK:((0,gK.assertNever)(e),J1.default)}function eO(e){return e==="light"?mK.default:e==="dark"?pK.default:lK.default}var lK,fK,pK,J1,mK,gK,hK=f(()=>{"use strict";s();lK=S(Q1()),fK=S(Jq()),pK=S(eK()),J1=S(rK()),mK=S(oK()),gK=S(w0());uK()});var xi=f(()=>{"use strict";s();$q();hK()});function rO(e,t){return e===void 0?t:e==="dynamic"?tO.Appearance&&tO.Appearance.getColorScheme()||t:e}var tO,yK=f(()=>{"use strict";s();tO=S(re())});function jt(e){return e?e.name==="HighContrast":!1}var CK=f(()=>{"use strict";s()});function Ev(e){return{neutralForeground1:e.neutralForeground1.rest,neutralForeground1Hover:e.neutralForeground1.hover,neutralForeground1Pressed:e.neutralForeground1.pressed,neutralForeground1Selected:e.neutralForeground1.selected,neutralForeground2:e.neutralForeground2.rest,neutralForeground2Hover:e.neutralForeground2.hover,neutralForeground2Pressed:e.neutralForeground2.pressed,neutralForeground2Selected:e.neutralForeground2.selected,neutralForeground2BrandHover:e.neutralForeground2.brandHover,neutralForeground2BrandPressed:e.neutralForeground2.brandPressed,neutralForeground2BrandSelected:e.neutralForeground2.brandSelected,neutralForeground3:e.neutralForeground3.rest,neutralForeground3Hover:e.neutralForeground3.hover,neutralForeground3Pressed:e.neutralForeground3.pressed,neutralForeground3Selected:e.neutralForeground3.selected,neutralForeground3BrandHover:e.neutralForeground3.brandHover,neutralForeground3BrandPressed:e.neutralForeground3.brandPressed,neutralForeground3BrandSelected:e.neutralForeground3.brandSelected,neutralForeground4:e.neutralForeground4.rest,neutralForegroundDisabled:e.neutralForegroundDisabled.rest,brandForegroundLink:e.brandForegroundLink.rest,brandForegroundLinkHover:e.brandForegroundLink.hover,brandForegroundLinkPressed:e.brandForegroundLink.pressed,brandForegroundLinkSelected:e.brandForegroundLink.selected,compoundBrandForeground1:e.compoundBrandForeground1.rest,compoundBrandForeground1Hover:e.compoundBrandForeground1.hover,compoundBrandForeground1Pressed:e.compoundBrandForeground1.pressed,brandForeground1:e.brandForeground1.rest,brandForeground1Disabled:e.brandForeground1.disabled,brandForeground1Pressed:e.brandForeground1.pressed,brandForeground2:e.brandForeground2.rest,neutralForegroundInverted:e.neutralForegroundInverted.rest,neutralForegroundOnBrand:e.neutralForegroundOnBrand.rest,neutralForegroundOnBrandHover:e.neutralForegroundOnBrand.hover,neutralForegroundOnBrandPressed:e.neutralForegroundOnBrand.pressed,neutralForegroundOnBrandSelected:e.neutralForegroundOnBrand.selected,neutralForegroundInvertedLink:e.neutralForegroundInvertedLink.rest,neutralForegroundInvertedLinkHover:e.neutralForegroundInvertedLink.hover,neutralForegroundInvertedLinkPressed:e.neutralForegroundInvertedLink.pressed,neutralForegroundInvertedLinkSelected:e.neutralForegroundInvertedLink.selected,neutralBackground1:e.neutralBackground1.rest,neutralBackground1Hover:e.neutralBackground1.hover,neutralBackground1Pressed:e.neutralBackground1.pressed,neutralBackground1Selected:e.neutralBackground1.selected,neutralBackground2:e.neutralBackground2.rest,neutralBackground2Hover:e.neutralBackground2.hover,neutralBackground2Pressed:e.neutralBackground2.pressed,neutralBackground2Selected:e.neutralBackground2.selected,neutralBackground3:e.neutralBackground3.rest,neutralBackground3Hover:e.neutralBackground3.hover,neutralBackground3Pressed:e.neutralBackground3.pressed,neutralBackground3Selected:e.neutralBackground3.selected,neutralBackground4:e.neutralBackground4.rest,neutralBackground4Hover:e.neutralBackground4.hover,neutralBackground4Pressed:e.neutralBackground4.pressed,neutralBackground4Selected:e.neutralBackground4.selected,neutralBackground5:e.neutralBackground5.rest,neutralBackground5Hover:e.neutralBackground5.hover,neutralBackground5Pressed:e.neutralBackground5.pressed,neutralBackground5Selected:e.neutralBackground5.selected,neutralBackground6:e.neutralBackground6.rest,neutralBackgroundInverted:e.neutralBackgroundInverted.rest,subtleBackground:e.subtleBackground.rest,subtleBackgroundHover:e.subtleBackground.hover,subtleBackgroundPressed:e.subtleBackground.pressed,subtleBackgroundSelected:e.subtleBackground.selected,transparentBackground:e.transparentBackground.rest,transparentBackgroundHover:e.transparentBackground.hover,transparentBackgroundPressed:e.transparentBackground.pressed,transparentBackgroundSelected:e.transparentBackground.selected,neutralBackgroundDisabled:e.neutralBackgroundDisabled.rest,neutralStencil1:e.neutralStencil1.rest,neutralStencil2:e.neutralStencil2.rest,brandBackground:e.brandBackground.rest,brandBackgroundHover:e.brandBackground.hover,brandBackgroundPressed:e.brandBackground.pressed,brandBackgroundDisabled:e.brandBackground.disabled,brandBackgroundSelected:e.brandBackground.selected,compoundBrandBackground1:e.compoundBrandBackground1.rest,compoundBrandBackground1Hover:e.compoundBrandBackground1.hover,compoundBrandBackground1Pressed:e.compoundBrandBackground1.pressed,brandBackgroundStatic:e.brandBackgroundStatic.rest,brandBackground2:e.brandBackground2.rest,neutralStrokeAccessible:e.neutralStrokeAccessible.rest,neutralStrokeAccessibleHover:e.neutralStrokeAccessible.hover,neutralStrokeAccessiblePressed:e.neutralStrokeAccessible.pressed,neutralStrokeAccessibleSelected:e.neutralStrokeAccessible.selected,neutralStroke1:e.neutralStroke1.rest,neutralStroke1Hover:e.neutralStroke1.hover,neutralStroke1Pressed:e.neutralStroke1.pressed,neutralStroke1Selected:e.neutralStroke1.selected,neutralStroke2:e.neutralStroke2.rest,neutralStroke3:e.neutralStroke3.rest,brandStroke1:e.brandStroke1.rest,brandStroke2:e.brandStroke2.rest,compoundBrandStroke1:e.compoundBrandStroke1.rest,compoundBrandStroke1Hover:e.compoundBrandStroke1.hover,compoundBrandStroke1Pressed:e.compoundBrandStroke1.pressed,neutralStrokeDisabled:e.neutralStrokeDisabled.rest,transparentStroke:e.transparentStroke.rest,transparentStrokeInteractive:e.transparentStroke.hover,transparentStrokeDisabled:e.transparentStroke.disabled,strokeFocus1:e.strokeFocus1.rest,strokeFocus2:e.strokeFocus2.rest,dangerBackground1:e.dangerBackground1.rest,dangerBackground2:e.dangerBackground2.rest,dangerBackground3:e.dangerBackground3.rest,dangerForeground1:e.dangerForeground1.rest,dangerForeground2:e.dangerForeground2.rest,dangerForeground3:e.dangerForeground3.rest,dangerForegroundInverted:e.dangerForegroundInverted.rest,dangerBorderActive:e.dangerBorderActive.rest,dangerBorder1:e.dangerBorder1.rest,dangerBorder2:e.dangerBorder2.rest,successBackground1:e.successBackground1.rest,successBackground2:e.successBackground2.rest,successBackground3:e.successBackground3.rest,successForeground1:e.successForeground1.rest,successForeground2:e.successForeground2.rest,successForeground3:e.successForeground3.rest,successForegroundInverted:e.successForegroundInverted.rest,successBorderActive:e.successBorderActive.rest,successBorder1:e.successBorder1.rest,successBorder2:e.successBorder2.rest,warningBackground1:e.warningBackground1.rest,warningBackground2:e.warningBackground2.rest,warningBackground3:e.warningBackground3.rest,warningForeground1:e.warningForeground1.rest,warningForeground2:e.warningForeground2.rest,warningForeground3:e.warningForeground3.rest,warningForegroundInverted:e.warningForegroundInverted.rest,warningBorderActive:e.warningBorderActive.rest,warningBorder1:e.warningBorder1.rest,warningBorder2:e.warningBorder2.rest,severeBackground1:e.severeBackground1.rest,severeBackground2:e.severeBackground2.rest,severeBackground3:e.severeBackground3.rest,severeForeground1:e.severeForeground1.rest,severeForeground2:e.severeForeground2.rest,severeForeground3:e.severeForeground3.rest,severeBorderActive:e.severeBorderActive.rest,severeBorder1:e.severeBorder1.rest,severeBorder2:e.severeBorder2.rest,outofofficeBackground1:e.outofofficeBackground1.rest,outofofficeBackground2:e.outofofficeBackground2.rest,outofofficeBackground3:e.outofofficeBackground3.rest,outofofficeForeground1:e.outofofficeForeground1.rest,outofofficeForeground2:e.outofofficeForeground2.rest,outofofficeForeground3:e.outofofficeForeground3.rest,outofofficeBorderActive:e.outofofficeBorderActive.rest,outofofficeBorder1:e.outofofficeBorder1.rest,outofofficeBorder2:e.outofofficeBorder2.rest}}function nO(e){return{caption1:la(e.caption1),body1:la(e.body1),body1Strong:la(e.body1Strong),body2:la(e.body2),body2Strong:la(e.body2Strong),subtitle1:la(e.subtitle1),subtitle1Strong:la(e.subtitle1Strong),subtitle2:la(e.subtitle2),subtitle2Strong:la(e.subtitle2Strong),title1:la(e.title1),title1Strong:la(e.title1Strong),largeTitle:la(e.largeTitle),display:la(e.display)}}function la(e){return{face:"primary",size:e.fontSize,weight:e.fontWeight}}var vK=f(()=>{"use strict";s()});function Pv(e){return{shadow2:{ambient:e.shadow2[0],key:e.shadow2[1]},shadow4:{ambient:e.shadow4[0],key:e.shadow4[1]},shadow8:{ambient:e.shadow8[0],key:e.shadow8[1]},shadow16:{ambient:e.shadow16[0],key:e.shadow16[1]},shadow28:{ambient:e.shadow28[0],key:e.shadow28[1]},shadow64:{ambient:e.shadow64[0],key:e.shadow64[1]},shadow2brand:{ambient:e.shadowBrand2[0],key:e.shadowBrand2[1]},shadow4brand:{ambient:e.shadowBrand4[0],key:e.shadowBrand4[1]},shadow8brand:{ambient:e.shadowBrand8[0],key:e.shadowBrand8[1]},shadow16brand:{ambient:e.shadowBrand16[0],key:e.shadowBrand16[1]},shadow28brand:{ambient:e.shadowBrand28[0],key:e.shadowBrand28[1]},shadow64brand:{ambient:e.shadowBrand64[0],key:e.shadowBrand64[1]}}}var xK=f(()=>{"use strict";s()});var Vc=f(()=>{"use strict";s();yK();CK();vK();xK()});function kEe(e){var t=Z1(e);return Ev(t)}function DEe(e){var t=eO(e);return Pv(t)}var Lg,F0,_v=f(()=>{"use strict";s();Bc();xi();Vc();Lg=Qt(kEe);F0=Qt(DEe)});function iO(e,t){return{background:e.white,bodyStandoutBackground:e.neutralLighterAlt,bodyFrameBackground:e.white,bodyFrameDivider:e.neutralLight,bodyText:e.neutralPrimary,bodyTextChecked:e.black,subText:e.neutralSecondary,bodyDivider:e.neutralLight,disabledBackground:t?e.neutralQuaternaryAlt:e.neutralLighter,disabledText:e.neutralTertiary,disabledBodyText:e.neutralTertiary,focusBorder:e.neutralSecondary,variantBorder:e.neutralLight,errorText:t?"#ff5f5f":e.redDark,inputBorder:e.neutralTertiary,inputBackground:e.white,inputFocusBorderAlt:e.themePrimary,inputText:e.neutralPrimary,inputPlaceholderText:e.neutralSecondary,buttonBackground:e.neutralLighter,buttonBackgroundChecked:e.neutralTertiaryAlt,buttonBackgroundHovered:e.neutralLight,buttonBackgroundPressed:e.neutralLight,buttonBackgroundDisabled:e.neutralLighter,buttonBorder:e.neutralSecondaryAlt,buttonText:t?e.black:e.neutralPrimary,buttonTextHovered:t?e.neutralPrimary:e.neutralDark,buttonTextChecked:e.neutralDark,buttonTextPressed:e.neutralDark,buttonTextDisabled:e.neutralTertiary,buttonBorderDisabled:e.neutralLighter,buttonBorderFocused:e.neutralSecondaryAlt,primaryButtonBackground:e.themePrimary,primaryButtonBackgroundHovered:e.themeDarkAlt,primaryButtonBackgroundPressed:e.themeDark,primaryButtonBackgroundDisabled:e.neutralLighter,primaryButtonBorder:"transparent",primaryButtonBorderFocused:"transparent",primaryButtonText:e.white,primaryButtonTextHovered:e.white,primaryButtonTextPressed:e.white,primaryButtonTextDisabled:e.neutralQuaternary,accentButtonBackground:e.accent,menuBackground:t?e.neutralLighter:e.white,menuDivider:e.neutralTertiaryAlt,menuIcon:t?e.themeDarkAlt:e.themePrimary,menuItemBackgroundHovered:t?e.neutralQuaternaryAlt:e.neutralLighter,menuItemBackgroundPressed:t?e.neutralQuaternary:e.neutralLight,menuItemText:e.neutralPrimary,menuItemTextHovered:e.neutralDark,listHeaderBackgroundHovered:e.neutralLighter,listHeaderBackgroundPressed:e.neutralLight,actionLink:e.neutralPrimary,link:e.themePrimary,linkHovered:e.themeDarker,linkPressed:e.themeDark,defaultBackground:e.neutralLighter,defaultBorder:e.neutralSecondaryAlt,defaultContent:t?e.black:e.neutralPrimary,defaultIcon:t?e.black:e.neutralPrimary,defaultHoveredBackground:e.neutralLight,defaultHoveredBorder:e.neutralSecondaryAlt,defaultHoveredContent:t?e.neutralPrimary:e.neutralDark,defaultHoveredIcon:t?e.neutralPrimary:e.neutralDark,defaultFocusedBackground:e.neutralLight,defaultFocusedBorder:e.neutralSecondaryAlt,defaultFocusedContent:t?e.neutralPrimary:e.neutralDark,defaultFocusedIcon:t?e.neutralPrimary:e.neutralDark,defaultPressedBackground:e.neutralLight,defaultPressedBorder:e.neutralSecondaryAlt,defaultPressedContent:e.neutralDark,defaultPressedIcon:e.neutralDark,defaultDisabledBackground:e.neutralLighter,defaultDisabledBorder:e.neutralLighter,defaultDisabledContent:e.neutralTertiary,defaultDisabledIcon:e.neutralTertiary,ghostBackground:e.white,ghostBorder:e.white,ghostContent:e.neutralPrimary,ghostIcon:e.neutralPrimary,ghostHoveredBackground:e.neutralLighter,ghostHoveredBorder:e.neutralLighter,ghostHoveredContent:e.neutralDark,ghostHoveredIcon:e.neutralDark,ghostFocusedBackground:e.neutralLighter,ghostFocusedBorder:e.neutralSecondaryAlt,ghostFocusedContent:e.neutralDark,ghostFocusedIcon:e.neutralDark,ghostPressedBackground:e.neutralLight,ghostPressedBorder:e.neutralLight,ghostPressedContent:e.neutralDark,ghostPressedIcon:e.neutralDark,ghostDisabledBackground:e.white,ghostDisabledBorder:e.white,ghostDisabledContent:e.neutralTertiary,ghostDisabledIcon:e.neutralTertiary,brandedBackground:e.themePrimary,brandedDisabledBorder:e.neutralLighter,defaultCheckedBackground:e.neutralTertiaryAlt,defaultCheckedContent:e.neutralDark,defaultCheckedHoveredBackground:e.neutralLight,defaultCheckedHoveredContent:t?e.neutralPrimary:e.neutralDark,ghostCheckedBackground:e.neutralLight,ghostCheckedContent:e.black,ghostCheckedHoveredBackground:e.neutralLighter,ghostCheckedHoveredContent:e.neutralDark,ghostCheckedHoveredBorder:e.neutralDark,ghostSecondaryContent:e.neutralSecondary,ghostFocusedSecondaryContent:e.neutralSecondary,ghostHoveredSecondaryContent:e.neutralSecondary,ghostPressedSecondaryContent:e.neutralSecondary,brandedSecondaryContent:e.neutralLighterAlt,brandedFocusedSecondaryContent:e.neutralLighterAlt,brandedHoveredSecondaryContent:e.neutralLighterAlt,brandedPressedSecondaryContent:e.neutralLighterAlt,defaultHoveredSecondaryContent:e.neutralTertiary,defaultPressedSecondaryContent:e.neutralTertiary,checkmarkColor:e.white,checkboxBackground:e.themePrimary,checkboxBackgroundDisabled:e.neutralLighter,checkboxBorderColor:e.neutralSecondaryAlt,personaActivityRing:e.white,personaActivityGlow:e.themePrimary}}function TK(){return oO({background:"#000000",bodyStandoutBackground:"#000000",bodyFrameBackground:"#000000",bodyFrameDivider:"#000000",bodyText:"#ffffff",bodyTextChecked:"#000000",subText:"#ffffff",bodyDivider:"#ffffff",disabledBackground:"#000000",disabledText:"#3ff23f",disabledBodyText:"#3ff23f",focusBorder:"#ffffff",variantBorder:"#ffffff",errorText:"#ffffff",inputBorder:"#ffffff",inputBackground:"#000000",inputFocusBorderAlt:"#ffffff",inputText:"#ffffff",inputPlaceholderText:"#ffffff",buttonBackground:"#000000",buttonBackgroundChecked:"#1aebff",buttonBackgroundHovered:"#1aebff",buttonBackgroundPressed:"#1aebff",buttonBackgroundDisabled:"#000000",buttonBorder:"#ffffff",buttonText:"#ffffff",buttonTextHovered:"#000000",buttonTextChecked:"#000000",buttonTextPressed:"#000000",buttonTextDisabled:"#3ff23f",buttonBorderDisabled:"#3ff23f",buttonBorderFocused:"#ffffff",primaryButtonBackground:"#000000",primaryButtonBackgroundHovered:"#1aebff",primaryButtonBackgroundPressed:"#1aebff",primaryButtonBackgroundDisabled:"#000000",primaryButtonBorder:"#ffffff",primaryButtonBorderFocused:"#ffffff",primaryButtonText:"#ffffff",primaryButtonTextHovered:"#000000",primaryButtonTextPressed:"#000000",primaryButtonTextDisabled:"#3ff23f",accentButtonBackground:"#000000",menuBackground:"#000000",menuDivider:"#ffffff",menuIcon:"#ffffff",menuItemBackgroundHovered:"#1aebff",menuItemBackgroundPressed:"#1aebff",menuItemText:"#ffffff",menuItemTextHovered:"#000000",listHeaderBackgroundHovered:"#1aebff",listHeaderBackgroundPressed:"#1aebff",actionLink:"#ffff00",link:"#ffff00",linkHovered:"#ffffff",linkPressed:"#ffffff",defaultBackground:"#000000",defaultBorder:"#ffffff",defaultContent:"#ffffff",defaultIcon:"#ffffff",defaultHoveredBackground:"#1aebff",defaultHoveredBorder:"#1aebff",defaultHoveredContent:"#000000",defaultHoveredIcon:"#000000",defaultFocusedBackground:"#000000",defaultFocusedBorder:"#ffffff",defaultFocusedContent:"#ffffff",defaultFocusedIcon:"#ffffff",defaultPressedBackground:"#1aebff",defaultPressedBorder:"#1aebff",defaultPressedContent:"#000000",defaultPressedIcon:"#000000",defaultDisabledBackground:"#000000",defaultDisabledBorder:"#3ff23f",defaultDisabledContent:"#3ff23f",defaultDisabledIcon:"#3ff23f",ghostBackground:"#000000",ghostBorder:"#000000",ghostContent:"#ffffff",ghostIcon:"#ffffff",ghostHoveredBackground:"#1aebff",ghostHoveredBorder:"#1aebff",ghostHoveredContent:"#000000",ghostHoveredIcon:"#000000",ghostFocusedBackground:"#000000",ghostFocusedBorder:"#ffffff",ghostFocusedContent:"#ffffff",ghostFocusedIcon:"#ffffff",ghostPressedBackground:"#1aebff",ghostPressedBorder:"#1aebff",ghostPressedContent:"#000000",ghostPressedIcon:"#000000",ghostDisabledBackground:"#000000",ghostDisabledBorder:"#000000",ghostDisabledContent:"#3ff23f",ghostDisabledIcon:"#3ff23f",brandedBackground:"#000000",brandedDisabledBorder:"#3ff23f",defaultCheckedBackground:"#1aebff",defaultCheckedContent:"#000000",defaultCheckedHoveredBackground:"#1aebff",defaultCheckedHoveredContent:"#000000",ghostCheckedBackground:"#1aebff",ghostCheckedContent:"#000000",ghostCheckedHoveredBackground:"#1aebff",ghostCheckedHoveredContent:"#000000",ghostCheckedHoveredBorder:"#000000",ghostSecondaryContent:"#ffffff",ghostFocusedSecondaryContent:"#ffffff",ghostHoveredSecondaryContent:"#000000",ghostPressedSecondaryContent:"#000000",brandedSecondaryContent:"#ffffff",brandedFocusedSecondaryContent:"#ffffff",brandedHoveredSecondaryContent:"#000000",brandedPressedSecondaryContent:"#000000",defaultHoveredSecondaryContent:"#000000",defaultPressedSecondaryContent:"#000000",checkmarkColor:"#ffffff",checkboxBackground:"#000000",checkboxBackgroundDisabled:"#000000",checkboxBorderColor:"#ffffff",personaActivityRing:"#ffffff",personaActivityGlow:"transparent"},Lg("highContrast"))}var oO,aO=f(()=>{"use strict";s();_v();oO=function(){return oO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},oO.apply(this,arguments)}});function bK(){return Hg(Hg({},iO({black:O.color.black,neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",white:O.color.white,red:O.color.red.primary,redDark:O.color.burgundy.primary,themeDarker:O.color.brand.shade40,themeDark:O.color.brand.shade20,themeDarkAlt:O.color.brand.shade10,themePrimary:O.color.brand.primary,themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:O.color.brand.tint40,themeLighter:O.color.brand.tint50,themeLighterAlt:O.color.brand.tint60,accent:O.color.brand.primary,blackTranslucent40:"rgba(0,0,0,.4)"})),Lg("light"))}function SK(){return Hg(Hg({},iO({themeDarker:"#82c7ff",themeDark:O.color.brand.tint30,themeDarkAlt:O.color.brand.tint20,themePrimary:O.color.brand.tint10,themeSecondary:O.color.brand.primary,themeTertiary:"#235a85",themeLight:O.color.brand.shade30,themeLighter:O.color.brand.shade50,themeLighterAlt:O.color.brand.shade60,black:O.color.white,neutralDark:"#faf9f8",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralSecondary:"#a19f9d",neutralSecondaryAlt:"#979693",neutralTertiary:"#797775",neutralTertiaryAlt:"#484644",neutralQuaternary:"#3b3a39",neutralQuaternaryAlt:"#323130",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",white:"#1b1a19",red:O.color.red.primary,accent:O.color.brand.primary,redDark:"#f1707b",blackTranslucent40:"rgba(0,0,0,.4)"},!0)),Lg("dark"))}var Hg,IK=f(()=>{"use strict";s();xi();_v();aO();Hg=function(){return Hg=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Hg.apply(this,arguments)}});function wEe(){var e={sizes:{caption:O.font.size100,secondary:O.font.size200,body:O.font.size300,subheader:O.font.size400,header:O.font.size500,hero:O.font.size700,heroLarge:O.font.size900},weights:{regular:O.font.weight.regular,semiBold:O.font.weight.semibold},families:{primary:"Segoe UI",secondary:"Segoe UI",cursive:"System",monospace:"System",numeric:"System",sansSerif:"System",serif:"System"},variants:{captionStandard:{face:"primary",size:"caption",weight:"regular"},secondaryStandard:{face:"primary",size:"secondary",weight:"regular"},secondarySemibold:{face:"primary",size:"secondary",weight:"semiBold"},bodyStandard:{face:"primary",size:"body",weight:"regular"},bodySemibold:{face:"primary",size:"body",weight:"semiBold"},subheaderStandard:{face:"primary",size:"subheader",weight:"regular"},subheaderSemibold:{face:"primary",size:"subheader",weight:"semiBold"},headerStandard:{face:"primary",size:"header",weight:"regular"},headerSemibold:{face:"primary",size:"header",weight:"semiBold"},heroStandard:{face:"primary",size:"hero",weight:"regular"},heroSemibold:{face:"primary",size:"hero",weight:"semiBold"},heroLargeStandard:{face:"primary",size:"heroLarge",weight:"regular"},heroLargeSemibold:{face:"primary",size:"heroLarge",weight:"semiBold"},caption1:{face:"primary",size:"caption",weight:"regular"},caption1Strong:{face:"primary",size:"caption",weight:"semiBold"},body1:{face:"primary",size:"secondary",weight:"regular"},body1Strong:{face:"primary",size:"secondary",weight:"semiBold"},body2:{face:"primary",size:"body",weight:"regular"},body2Strong:{face:"primary",size:"body",weight:"semiBold"},subtitle1:{face:"primary",size:"header",weight:"regular"},subtitle1Strong:{face:"primary",size:"header",weight:"semiBold"},subtitle2:{face:"primary",size:"subheader",weight:"regular"},subtitle2Strong:{face:"primary",size:"subheader",weight:"semiBold"},title1:{face:"primary",size:"hero",weight:"regular"},title1Strong:{face:"primary",size:"hero",weight:"semiBold"},largeTitle:{face:"primary",size:"heroLarge",weight:"regular"},display:{face:"primary",size:"heroLarge",weight:"semiBold"}}};return e}function FEe(){return{s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"}}var vTt,Yo,Bg,EK,sO=f(()=>{"use strict";s();vTt=S(re());xi();_v();aO();IK();Yo={colors:bK(),typography:wEe(),spacing:FEe(),shadows:F0("light"),components:{},host:{appearance:"light"}},Bg={colors:SK(),typography:Yo.typography,shadows:F0("dark"),spacing:Yo.spacing,components:{},host:{appearance:"dark"}},EK={colors:TK(),typography:Yo.typography,shadows:F0("highContrast"),spacing:Yo.spacing,components:{},host:{appearance:"highContrast"}}});var Ug,dO,PK=f(()=>{"use strict";s();Ug=S(L());Qf();dO=function(t){var r=t.theme,n=t.children,o=Ug.useState(function(){return r.theme}),a=o[0],d=o[1];return Ug.useEffect(function(){d(r.theme);var c=function(){d(r.theme)};return r.addOnThemeChanged(c),function(){r.removeOnThemeChanged(c)}},[r,d]),Ug.createElement(At.Provider,{value:a},n)}});function _K(e,t){return ua(e,t)}var RK=f(()=>{"use strict";s();Vs()});var Jf,AK=f(()=>{"use strict";s();RK();Jf=function(){function e(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this;if(this.themeData=void 0,this.listeners=[],this.parentRef=void 0,this.listeners=[],this.recipes=r,this.parentRef=t instanceof e?t:void 0,this.parentRef){var a=function(){o.invalidate()};this.parentRef.addOnThemeChanged(a)}this.getParent=function(){return o.parentRef?o.parentRef.theme:t}}return Object.defineProperty(e.prototype,"theme",{get:function(){if(!this.themeData){for(var r=this.getParent(),n=0,o=this.recipes;n<o.length;n++){var a=o[n];r=_K(r,typeof a=="function"?a(r):a)}this.themeData=r}return this.themeData},enumerable:!1,configurable:!0}),e.prototype.addOnThemeChanged=function(t){this.listeners.push(t)},e.prototype.removeOnThemeChanged=function(t){this.listeners=this.listeners.filter(function(r){return r!==t})},e.prototype.invalidate=function(){this.themeData=void 0;for(var t=0,r=this.listeners;t<r.length;t++){var n=r[t];n()}},e.prototype.update=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.recipes=t,this.invalidate()},e}()});var Rv=f(()=>{"use strict";s();PK();AK()});function uO(e){e===void 0&&(e={});var t=new Jf({},function(){var r=rO(e.appearance,e.defaultAppearance||"light");switch(r){case"light":return Yo;case"dark":return Bg;case"darkElevated":return Bg;case"highContrast":return EK;default:(0,kK.default)(r)}});return cO.Appearance&&e.appearance==="dynamic"&&cO.Appearance.addChangeListener(function(){t.invalidate()}),t}var cO,kK,DK=f(()=>{"use strict";s();cO=S(re());Rv();Vc();kK=S(w0());sO()});var Vg=f(()=>{"use strict";s();sO();DK();_v()});function fa(){return Uc()||Yo}var lO=f(()=>{"use strict";s();Vg();Qf()});var Av,O0=f(()=>{"use strict";s();lO();Av={useTheme:function(){return fa()},getComponentInfo:function(t,r){var n=t.components||{};return n[r]}}});function en(e,t){return Iv(e,Av,t)}var wK=f(()=>{"use strict";s();Gq();O0()});function Cl(e,t){var r=function(a){return e(a,t)},n=Rn(r);return n.customize=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var d=t.customize.apply(t,o);return Cl(e,d)},n}var FK=f(()=>{"use strict";s();Tv()});function ct(e,t){return z1(e,t)}var OK=f(()=>{"use strict";s();K1();O0()});function Zf(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Mg.apply(void 0,w([Av.getComponentInfo],e,!1))}var NK=f(()=>{"use strict";s();k();Sv();O0();Sv()});var Oe=f(()=>{"use strict";s();Bc();Ng();_n();Tv();W1();Vs();Qf();wK();FK();lO();OK();NK()});var fO,qn,vl=f(()=>{"use strict";s();(function(e){e[e.KeyboardShortcut=1]="KeyboardShortcut",e[e.CommitButton=2]="CommitButton",e[e.Programmatic=3]="Programmatic"})(fO||(fO={}));qn=fO});var $o,N0=f(()=>{"use strict";s();(function(e){e[e.None=0]="None",e[e.Editing=1]="Editing",e[e.Pending=2]="Pending"})($o||($o={}))});var Md,kv=f(()=>{"use strict";s();(function(e){e[e.Post=0]="Post",e[e.Card=1]="Card"})(Md||(Md={}))});function MK(e){pO=e}function xl(){return pO}function LK(){return pO===$t.LargeDisplay}function Wr(e){return{renderContextType:e,displayClass:xl(),platform:Q(),isFluentEnabled:fe()}}function Ld(e){return e===A.FullPane||zI(e)}function HK(e,t,r){return e&&(!r||t)}var pO,dn=f(()=>{"use strict";s();ye();Fd();Ve();Pr();li();pO=$t.None});function ve(e){return mO.StyleSheet.create({style:e}).style}function jg(e,t,r,n,o){t===void 0&&(t=0),r===void 0&&(r=0),n===void 0&&(n=0),o===void 0&&(o=0);var a=mO.StyleSheet.flatten(e),d={padding:a.padding,paddingTop:a.paddingTop,paddingRight:a.paddingRight,paddingBottom:a.paddingBottom,paddingLeft:a.paddingLeft,paddingHorizontal:a.paddingHorizontal,paddingVertical:a.paddingVertical},c={};Object.keys(d).forEach(function(p){return c[p]=typeof d[p]=="string"?0:d[p]});var u=function(){for(var g=[],h=0;h<arguments.length;h++)g[h]=arguments[h];return g.find(function(v){return v!==void 0},g)},l={};return t&&(l.paddingTop=(u(c.paddingTop,c.paddingVertical,c.padding)||0)+t),r&&(l.paddingRight=(u(c.paddingRight,c.paddingHorizontal,c.padding)||0)+r),n&&(l.paddingBottom=(u(c.paddingBottom,c.paddingVertical,c.padding)||0)+n),o&&(l.paddingLeft=(u(c.paddingLeft,c.paddingVertical,c.padding)||0)+o),[e,l]}function ep(e,t){return t.length!==2?(x().assertConditionTag(!1,"Invalid alpha value provided",578348938),e):!e.startsWith("#")||!(e.length===7||e.length===9)?(x().assertConditionTag(!1,"setAlpha only supports colors in #RRGGBB or #RRGGBBAA format",578348939),e):e.length===7?e+t:e.substr(0,7)+t}function BK(e,t){return e.renderWithSettings(Wr(t),{})}function Je(e,t,r){return e.renderWithSettings(Wr(r),t)}function ts(e,t,r){return e.renderWithSettings(Wr(r),t)}var mO,vr,M0,L0,Hd,je=f(()=>{"use strict";s();te();mO=S(re());dn();vr=ve({flex:1}),M0=ve({flex:0}),L0=ve({overflow:"hidden"}),Hd=1e3});var UK,VK,R,kt,xr=f(()=>{"use strict";s();k();UK=S(Kr());je();VK=function(){function e(t){this.rules=[],this.storedStyles=new Map,this.rules=t}return e.prototype.render=function(t){return this.renderInternal(t,e.DEFAULT_SETTINGS)},e.prototype.renderWithSettings=function(t,r){return this.renderInternal(t,r)},e.prototype.renderInternal=function(t,r){var n=this.serializeRulesResults(t),o=this.storedStyles.get(r);o||(o=new Map,this.storedStyles.set(r,o));var a=o.get(n);if(a===void 0){var d=this.computeStyle(t,r);return a=this.registerStyle(d),o.set(n,a),a}return a},e.prototype.computeStyle=function(t,r){var n=this;return this.flattenStyle(this.rules.filter(function(o){return n.testCondition(o.condition,t)}).map(function(o){var a=o.style;if(typeof a=="function"){if(r===R.DEFAULT_SETTINGS)throw new Error("Functional rule def encountered with unset settings object");return a(r)}return a}))},e.prototype.testCondition=function(t,r){return typeof t=="function"?t(r):Object.keys(t).every(function(n){return t[n]===r[n]})},e.prototype.serializeRulesResults=function(t){var r=this;return this.rules.map(function(n){return r.testCondition(n.condition,t)?"1":"0"}).join("")},e.prototype.flattenStyle=function(t){return Object.assign.apply(Object,w([{}],V(t),!1))},e.DEFAULT_SETTINGS=Symbol(),e}(),R=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.registerStyle=function(r){return ve(r)},t.rule=function(r,n){return{condition:r,style:n}},t.always=function(r){return{condition:{},style:r}},t}(VK),kt=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.registerStyle=function(r){return UK.StyleSheet.createViewStyle(r)},t.rule=function(r,n){return{condition:r,style:n}},t.always=function(r){return{condition:{},style:r}},t}(VK)});var Wg,Rr,Bd,zg,B0,OEe,jK,WK,U0,Gg,NEe,V0,MEe,j0,Dv,W0,qg,z0,G0,q0,Kg,K0,Y0,$0,go=f(()=>{"use strict";s();Ve();xr();Wg=8,Rr=12,Bd=36,zg=32,B0=19,OEe=1,jK=10,WK=4,U0=2,Gg=8,NEe=1,V0=1,MEe=4,j0=[R.rule({isFluentEnabled:!0},{paddingLeft:MEe,paddingBottom:3,borderColor:"transparent",borderWidth:NEe,marginLeft:5,marginRight:5,marginBottom:V0,borderRadius:2}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{paddingLeft:24})],Dv=[R.rule({isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardReplyBackground}}),R.rule({renderContextType:A.HalfPane,isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardReplyBackground_HalfPane}})],W0=new R([R.always({flex:1,flexDirection:"row",alignItems:"center",paddingBottom:2})]),qg=new kt([kt.always(function(e){return{opacity:e.themeId!==7?.65:1}})]),z0=new R([R.always(function(e){return{borderWidth:OEe,paddingLeft:jK,paddingRight:jK,paddingTop:WK,paddingBottom:WK,borderColor:e.palette.CardDraftBoxBorder,borderRadius:2,backgroundColor:e.palette.CardDraftBoxBackground}})]),G0=new R([R.always({borderWidth:2,paddingLeft:9,paddingRight:9,paddingTop:3,paddingBottom:3})]),q0=new R([R.rule({platform:"win32"},{flexShrink:0}),R.rule({platform:"android"},{marginLeft:2,marginRight:-10,width:40,height:40})]),Kg=new R([R.always({flex:0,borderWidth:0,minHeight:24,minWidth:28})]),K0=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground}})]),Y0=new R([R.always(function(e){return{backgroundColor:e.palette.ResolvedCardBackground}})]),$0=new R([R.always(function(e){return{backgroundColor:e.palette.CardHoveredBackground}})])});function wv(e,t){return e===ce.FocusOn?gO:t?GK:rs}function lY(e){return{marginRight:e,marginLeft:e,marginBottom:e}}function fY(e){return new R([R.always(function(t){return{flex:0,flexDirection:"row",padding:12-e,paddingTop:11,borderTopWidth:1,borderColor:t.palette.CardBorder}})])}var rs,LEe,Wc,zK,gO,GK,qK,KK,YK,hO,$K,QK,XK,JK,ZK,eY,tY,rY,nY,oY,iY,aY,sY,dY,cY,uY,pY,mY,zc=f(()=>{"use strict";s();Pt();ye();Ve();go();dn();xr();je();rs=1,LEe=2,Wc=12,zK=4,gO=3,GK=2,qK=22,KK=10,YK=300,hO=40,$K=[R.rule({isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardHeroBarBackground}}),R.rule({renderContextType:A.HalfPane,isFluentEnabled:!1},function(e){return{backgroundColor:e.palette.CardHeroBarBackground_HalfPane}})],QK=new R([R.always({flex:1,overflow:"hidden"}),R.rule({platform:"win32",isFluentEnabled:!0},{flexDirection:"column",alignItems:"stretch",justifyContent:"flex-start"})]),XK=new R([R.always({flex:1,flexDirection:"column"}),R.rule(function(e){var t=e.renderContextType,r=e.isFluentEnabled;return Ld(t)&&!r},function(e){return{borderWidth:rs,borderColor:e.palette.CardAccent}}),R.rule({isFluentEnabled:!0},{paddingLeft:Wc}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{paddingLeft:0}),R.rule({renderContextType:A.HalfPane},{alignItems:"stretch"}),R.rule({renderContextType:A.HalfPane},function(e){return{backgroundColor:e.palette.CardBackground}})]),JK=ve({flex:1,flexDirection:"column"}),ZK=ve({justifyContent:"flex-end"}),eY=new R([R.always({position:"absolute",backgroundColor:"transparent",flex:1,flexDirection:"column",justifyContent:"center",width:"100%",height:"100%",left:Wc,paddingBottom:rs,paddingRight:rs,paddingLeft:rs}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{left:0})]),tY=new R([R.always({position:"relative",borderRadius:2,flex:1,flexDirection:"column",justifyContent:"center",width:"100%",height:"100%"}),R.rule({isFluentEnabled:!0},{borderRadius:zK,borderWidth:gO,borderColor:"transparent"})]),rY=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground,borderRadius:zK,flex:1,borderWidth:rs,borderColor:e.palette.CardBorder,borderStyle:e.themeId===7?"dashed":void 0,position:"absolute",left:Rr,justifyContent:"center",right:0,height:"100%"}}),R.rule(function(e){var t=e.renderContextType;return t===A.DiscreteIsolated},{left:0})]),nY=new R([R.always(function(e){return{backgroundColor:e.palette.ResolvedCardBackground}})]),oY=new R([R.always(function(e){return{borderColor:e.palette.CardBorderEmphasis,borderStyle:e.themeId===7?"solid":void 0}}),R.rule(function(){return!Uo()},function(e){return{backgroundColor:e.palette.CardHoveredBackground}})]),iY=new R([R.always({borderWidth:gO})]),aY=new R([R.always(function(e){return{borderColor:e.palette.CardBorderEmphasis,borderWidth:GK,borderStyle:e.themeId===7?"solid":void 0}})]),sY=new R([R.always({position:"absolute",height:"100%",width:LEe}),R.rule({isFluentEnabled:!0},{marginLeft:Wc})]),dY=new R([R.always(function(e){return{backgroundColor:e.palette.CardSelectionColor}})]),cY=ve({flex:1,justifyContent:"center"}),uY=ve({paddingBottom:Wg});pY=ve({height:16,width:16,marginTop:1,marginRight:8}),mY=ve({flexDirection:"column",flex:1})});var hY,ee,Tl=f(()=>{"use strict";s();hY=S(of()),ee=hY.ViewWin32});var mr=f(()=>{"use strict";s();Tl()});function Yg(e){if(!W5){var t=(0,Fv.findNodeHandle)(e);typeof t=="number"?(cn&&It("Comments programmatic keyboard focus set via UIManager: ".concat(WF(e))),Fv.UIManager.dispatchViewManagerCommand(t,Fv.UIManager.getViewManagerConfig("RCTView").Commands.focus,[])):Cu(e)?(cn&&It("Comments programmatic keyboard focus set: ".concat(WF(e))),e.focus()):cn&&$l("Comments programmatic keyboard focus skipped - ref not focusable")}}function CY(e){var t;(t=e.current)!==null&&t!==void 0||yY.FocusManager.focus(e.current,!1)}var yY,Fv,Ov=f(()=>{"use strict";s();ne();Pt();yY=S(of()),Fv=S(re());yc();Xa()});function js(e){var t;return t=function(r){Z(n,r);function n(o){var a,d=r.call(this,o)||this;return d.nodes=[],d.registrationRef=ho.createRef(),d.innerRef=(a=d.getComponentRef())!==null&&a!==void 0?a:ho.createRef(),d.onFocusWithinChange=function(){var c=d.nodes.some(function(u){return u.node.getFocusState()!==ce.Unfocused});d.setState({isFocusWithin:c})},d.onFocus=d.onFocus.bind(d),d.onBlur=d.onBlur.bind(d),d.state={isFocusWithin:!1,isFocusOn:!1},d}return n.prototype.componentDidUpdate=function(o,a){var d=to(this.state),c=to(a);d!==c&&(cn&&It("".concat(this.getId(),": ").concat(ce[d])),this.props.onFocusStateChange&&this.props.onFocusStateChange(d),(c===ce.Unfocused||d===ce.Unfocused)&&this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(d))},n.prototype.getInnerRef=function(){return this.innerRef},n.prototype.focus=function(){this.innerRef&&this.innerRef.current&&Yg(this.innerRef.current)},n.prototype.blur=function(){var o;Q()!=="win32"&&this.innerRef&&Cu(this.innerRef.current)&&((o=this.innerRef.current)===null||o===void 0||o.blur())},n.prototype.getFocusState=function(){return to(this.state)},n.prototype.getNextTabTarget=function(o,a){return vD(this,o,a)},n.prototype.isTabbable=function(){return!!this.props.isTabbable},n.prototype.getChildNodes=function(){return this.nodes.slice().sort(function(o,a){return o.getSortKey()-a.getSortKey()}).map(function(o){return o.node})},n.prototype.getComponentRef=function(){return this.props.componentRef},n.prototype.getIterator=function(){return SD(this)},n.prototype.addChildNode=function(o,a){var d=this,c={unregister:function(){return d.unregister(o)},onFocusStateChange:this.onFocusWithinChange};return this.nodes.push({node:o,getSortKey:a}),c},n.prototype.getData=function(){return this.props.nodeData?this.props.nodeData():this},n.prototype.getId=function(){return this.props.nodeId||""},n.prototype.getDescendantById=function(o){for(var a=this.getIterator(),d;!(d=a.next()).done;)if(d.value.getId()===o)return d.value},n.prototype.unregister=function(o){var a=this.nodes.findIndex(function(d){return d.node===o});a>=0&&(this.nodes.splice(a,1),this.state.isFocusWithin&&this.onFocusWithinChange())},n.prototype.onFocus=function(o){Q()!=="android"&&Q()!=="win32"||((!o||o.target===o.currentTarget)&&this.setState({isFocusOn:!0}),this.props.onFocus&&this.props.onFocus(o))},n.prototype.onBlur=function(o){Q()!=="android"&&Q()!=="win32"||((!o||o.target===o.currentTarget)&&this.setState({isFocusOn:!1}),this.props.onBlur&&this.props.onBlur(o))},n.prototype.renderInnerComponent=function(){var o=this,a=this.props,d=a.onFocusStateChange,c=a.onFocus,u=a.onBlur,l=a.keyDownEvents,p=a.preventDefaultKeyDownBehavior,g=Ke(a,["onFocusStateChange","onFocus","onBlur","keyDownEvents","preventDefaultKeyDownBehavior"]),h;if(ho.Children.count(this.props.children)===1){var v=ho.Children.toArray(this.props.children);typeof v[0]=="string"&&(h=v[0])}return h||(h=ho.createElement(um.Provider,{value:this},ho.Children.map(this.props.children,function(y,T){return ho.createElement(bl.Provider,{value:T},y)}))),ho.createElement(bl.Consumer,null,function(y){return ho.createElement(gc,{node:o,ref:o.registrationRef,position:y},ho.createElement(e,m({testID:o.props.nodeId,focusable:!0},g,o.state,{ref:o.getComponentRef()?void 0:o.innerRef,componentRef:o.getComponentRef(),onFocus:o.onFocus,onBlur:o.onBlur,keyDownEvents:yO(l,p)}),h))})},n.prototype.renderInnerComponentDebug=function(){var o={};return this.state.isFocusOn?o={borderColor:"red",borderWidth:3}:this.state.isFocusWithin&&(o={borderColor:"yellow",borderWidth:3}),ho.createElement(ee,{style:[o,vr]},this.renderInnerComponent())},n.prototype.render=function(){return this.renderInnerComponent()},n}(ho.PureComponent),t.displayName="FocusAware".concat(e.displayName),t}var ho,bl,yO,Gc=f(()=>{"use strict";s();k();ne();Pt();ho=S(L());yc();mr();Pr();je();Ov();bl=ho.createContext(0),yO=function(t,r){var n=[];return t&&n.push.apply(n,w([],V(t),!1)),r&&n.push.apply(n,w([],V(r),!1)),n}});var vY,zr,FSt,Ws=f(()=>{"use strict";s();vY=S(re());mr();Gc();zr=js(ee),FSt=js(vY.TouchableOpacity)});function We(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[];if(!t.length)return e();var o=t.reduceRight(function(a,d,c){return function(){return xY.createElement(d.Consumer,null,function(u){return n[c]=u,a===null?e.apply(void 0,w([],V(n),!1)):a()})}},null);return o?o():(x().assertConditionTag(!1,"Contexts failed to wrap, default to raw render.",575479898),e())}var xY,Tr=f(()=>{"use strict";s();k();te();xY=S(L())});function Vi(){return Q0.useContext(tn)}var Q0,HEe,tn,Kn=f(()=>{"use strict";s();Q0=S(L()),HEe="ComponentTreeIdContext undefined. Did you forget to render a ComponentTreeIdContext context provider?",tn=Q0.createContext(new Proxy({},{get:function(){throw new Error(HEe)}}))});function $g(){return X0.useContext(Ge)}var X0,Ge,rr=f(()=>{"use strict";s();X0=S(L()),Ge=X0.createContext(new Proxy({},{get:function(){throw new Error("Theme undefined. Did you forget to render a theme context provider?")}}))});var TY,bY,SY=f(()=>{"use strict";s();Ve();zc();xr();TY=new R([R.always({flexDirection:"row",justifyContent:"flex-start",alignItems:"center",paddingTop:2,marginLeft:Wc,paddingLeft:6,paddingRight:3,minHeight:31}),R.rule({renderContextType:A.DiscreteIsolated},{marginLeft:0})]),bY=new R([R.always(function(e){return{borderBottomWidth:1,borderColor:e.palette.CardBorder}})])});var zs,IY,EY=f(()=>{"use strict";s();k();zs=S(L());Ve();zc();Ws();Tr();Kn();je();rr();mr();SY();IY=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.renderWithContexts=function(n,o){var a=o.renderContextType,d=r.props.margin?r.props.margin:1,c=a!==A.DiscreteIsolated,u=[r.renderStyle(bY,n,a),{marginRight:d,marginLeft:d+(c?Wc:0)}];return zs.createElement(zr,{isTabbable:!1,preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior},zs.createElement(ee,{style:r.renderStyle(TY,n,a),animationClass:r.props.animationClass},zs.createElement(zs.Fragment,{key:"left"},r.props.leftElement),zs.createElement(zs.Fragment,{key:"right"},r.props.rightElement)),zs.createElement(ee,{style:u}))},r.render=function(){return We(r.renderWithContexts,Ge,tn)},r}return t.prototype.renderStyle=function(r,n,o){return Je(r,n,o)},t}(zs.PureComponent)});function PY(e){var t,r,n,o,a,d,c,u,l,p,g,h,v,y;return{buttonBackground:"transparent",buttonHoveredBackground:"transparent",disabledText:(r=(t=e.host.palette)===null||t===void 0?void 0:t.TextDisabled)!==null&&r!==void 0?r:"bodyText",expandButtonTextColor:(o=(n=e.host.palette)===null||n===void 0?void 0:n.TextEmphasis)!==null&&o!==void 0?o:"bodyText",selectedText:(d=(a=e.host.palette)===null||a===void 0?void 0:a.Text)!==null&&d!==void 0?d:"bodyText",subTextColor:(u=(c=e.host.palette)===null||c===void 0?void 0:c.TextSecondary)!==null&&u!==void 0?u:"subText",text:(p=(l=e.host.palette)===null||l===void 0?void 0:l.Text)!==null&&p!==void 0?p:"bodyText",warningTextColor:(h=(g=e.host.palette)===null||g===void 0?void 0:g.TextError)!==null&&h!==void 0?h:"bodyText",warningDraftboxColor:(y=(v=e.host.palette)===null||v===void 0?void 0:v.TextError)!==null&&y!==void 0?y:"bodyText"}}function CO(e){var t,r,n,o,a,d,c;return m(m({},PY(e)),{assignedToYouBackground:(r=(t=e.host.colors)===null||t===void 0?void 0:t.App1)!==null&&r!==void 0?r:"background",assignedToYouText:(o=(n=e.host.colors)===null||n===void 0?void 0:n.App6)!==null&&o!==void 0?o:"bodyText",completedCheckColor:ke.WHITE,completedSquareCheckboxColor:ke.GRAY_140,expandButtonTextHoverColor:(c=Uo()?(a=e.host.colors)===null||a===void 0?void 0:a.AppShade10:(d=e.host.colors)===null||d===void 0?void 0:d.App8)!==null&&c!==void 0?c:"bodyText",roundCheckboxBorderColor:ke.BLACK,squareCheckboxBorderColor:ke.BLACK})}function vO(e){var t,r,n,o,a,d,c;return m(m({},PY(e)),{assignedToYouBackground:(r=(t=e.host.colors)===null||t===void 0?void 0:t.App2)!==null&&r!==void 0?r:"background",assignedToYouText:(o=(n=e.host.colors)===null||n===void 0?void 0:n.App7)!==null&&o!==void 0?o:"bodyText",checkHoverColor:ke.GRAY_70,completedCheckColor:ke.GRAY_180,completedSquareCheckboxColor:ke.GRAY_30,expandButtonTextHoverColor:(c=Uo()?(a=e.host.colors)===null||a===void 0?void 0:a.AppTint40:(d=e.host.colors)===null||d===void 0?void 0:d.App1)!==null&&c!==void 0?c:"bodyText",menuFocus:ke.GRAY_130,roundCheckboxBorderColor:ke.WHITE,squareCheckboxBorderColor:ke.GRAY_100})}var _Y=f(()=>{"use strict";s();k();ye();hm()});function RY(e){return e.assignedToYouBackground!==void 0&&e.assignedToYouText!==void 0&&e.buttonBackground!==void 0&&e.buttonHoveredBackground!==void 0&&e.checkHoverColor!==void 0&&e.completedCheckColor!==void 0&&e.completedSquareCheckboxColor!==void 0&&e.disabledText!==void 0&&e.expandButtonTextColor!==void 0&&e.expandButtonTextHoverColor!==void 0&&e.menuFocus!==void 0&&e.roundCheckboxBorderColor!==void 0&&e.selectedText!==void 0&&e.squareCheckboxBorderColor!==void 0&&e.subTextColor!==void 0&&e.text!==void 0&&e.warningDraftboxColor!==void 0&&e.warningTextColor!==void 0}var AY=f(()=>{"use strict";s()});function Ht(e){var t=e.colors;return RY(t)?t:(x().assertConditionTag(!1,"Comments fluent theme is not being provided",588910614),DY(e).colors)}function DY(e){return{colors:m(m({},CO(e)),{checkHoverColor:ke.GRAY_130,menuFocus:ke.GRAY_40})}}function UEe(e){return{colors:m(m({},CO(e)),{checkHoverColor:ke.GRAY_140,menuFocus:ke.GRAY_50})}}function VEe(e){return{colors:vO(e)}}function jEe(e){return{colors:vO(e)}}function WEe(){return{colors:{assignedToYouBackground:(0,Yn.PlatformColor)("Highlight"),assignedToYouText:(0,Yn.PlatformColor)("HighlightText"),buttonBackground:(0,Yn.PlatformColor)("ButtonFace"),buttonHoveredBackground:(0,Yn.PlatformColor)("Highlight"),checkHoverColor:(0,Yn.PlatformColor)("Highlight"),completedCheckColor:(0,Yn.PlatformColor)("ButtonText"),completedSquareCheckboxColor:(0,Yn.PlatformColor)("ButtonFace"),disabledText:(0,Yn.PlatformColor)("GrayText"),expandButtonTextColor:(0,Yn.PlatformColor)("ButtonText"),expandButtonTextHoverColor:(0,Yn.PlatformColor)("HighlightText"),menuFocus:(0,Yn.PlatformColor)("Highlight"),roundCheckboxBorderColor:(0,Yn.PlatformColor)("ButtonText"),selectedText:(0,Yn.PlatformColor)("HighlightText"),squareCheckboxBorderColor:(0,Yn.PlatformColor)("ButtonText"),subTextColor:(0,Yn.PlatformColor)("WindowText"),text:(0,Yn.PlatformColor)("WindowText"),warningDraftboxColor:(0,Yn.PlatformColor)("ButtonText"),warningTextColor:(0,Yn.PlatformColor)("WindowText")}}}var Yn,kY,yo=f(()=>{"use strict";s();k();te();Yn=S(re());hm();_Y();AY();kY=function(t){switch(t.name){case"Colorful":return DY(t);case"White":return UEe(t);case"Black":return VEe(t);case"DarkGray":return jEe(t);case"HighContrast":return WEe();default:return{}}}});function wY(e,t,r){var n=function(d,c){var u=e+o.length,l;return c!==void 0?l=t(c,u):l=r?r(d,u):d,l&&o.push(l),""},o=[];return e.replace(zEe,n),o}function FY(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=function(a,d){try{return t[+d]}catch(c){return""}};return e.replace(GEe,n)}var zEe,GEe,xO=f(()=>{"use strict";s();zEe=/{([^{}]+)}|[^{}]+/g,GEe=/{([^{}]+)}/g});function Ud(e){return qEe[e]}function TO(e){return KEe[e]}function J0(e){return YEe[e]}var qEe,KEe,YEe,OY=f(()=>{"use strict";s();qEe={children:!0,accessibilityAccessKey:!0,accessibilityActions:!0,accessibilityAnnotation:!0,accessibilityControls:!0,accessibilityDescribedBy:!0,accessibilityDescription:!0,accessibilityElementsHidden:!0,accessibilityHint:!0,accessibilityIgnoresInvertColors:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabelledBy:!0,accessibilityLanguage:!0,accessibilityLevel:!0,accessibilityLiveRegion:!0,accessibilityPositionInSet:!0,accessibilityRole:!0,accessibilitySetSize:!0,accessibilityState:!0,accessibilityValue:!0,accessibilityViewIsModal:!0,accessible:!0,animationClass:!0,collapsable:!0,cursor:!0,enableFocusRing:!0,focusable:!0,hasTVPreferredFocus:!1,hitSlop:!0,id:!0,importantForAccessibility:!0,isTVSelectable:!1,keyDownEvents:!0,keyUpEvents:!0,nativeID:!0,needsOffscreenAlphaCompositing:!0,onAccessibilityAction:!0,onAccessibilityEscape:!0,onAccessibilityTap:!0,onBlur:!0,onBlurCapture:!0,onFocus:!0,onFocusCapture:!0,onKeyDown:!0,onKeyDownCapture:!0,onKeyUp:!0,onKeyUpCapture:!0,onLayout:!0,onMagicTap:!1,onMouseEnter:!0,onMouseLeave:!0,onMoveShouldSetResponder:!0,onMoveShouldSetResponderCapture:!0,onPointerCancel:!0,onPointerCancelCapture:!0,onPointerDown:!0,onPointerDownCapture:!0,onPointerEnter:!0,onPointerEnterCapture:!0,onPointerLeave:!0,onPointerLeaveCapture:!0,onPointerMove:!0,onPointerMoveCapture:!0,onPointerUp:!0,onPointerUpCapture:!0,onResponderEnd:!0,onResponderGrant:!0,onResponderMove:!0,onResponderReject:!0,onResponderRelease:!0,onResponderStart:!0,onResponderTerminate:!0,onResponderTerminationRequest:!0,onStartShouldSetResponder:!0,onStartShouldSetResponderCapture:!0,onTouchCancel:!0,onTouchEnd:!0,onTouchEndCapture:!0,onTouchMove:!0,onTouchStart:!0,pointerEvents:!0,removeClippedSubviews:!0,renderToHardwareTextureAndroid:!0,role:!0,shouldRasterizeIOS:!0,style:!0,tabIndex:!0,testID:!0,tooltip:!0,tvParallaxMagnification:!1,tvParallaxProperties:!1,tvParallaxShiftDistanceX:!1,tvParallaxShiftDistanceY:!1,tvParallaxTiltAngle:!1,"aria-busy":!0,"aria-checked":!0,"aria-controls":!0,"aria-describedby":!0,"aria-description":!0,"aria-disabled":!0,"aria-expanded":!0,"aria-hidden":!0,"aria-label":!0,"aria-labelledby":!0,"aria-level":!0,"aria-live":!0,"aria-modal":!0,"aria-multiselectable":!0,"aria-posinset":!0,"aria-required":!0,"aria-selected":!0,"aria-setsize":!0,"aria-valuemax":!0,"aria-valuemin":!0,"aria-valuenow":!0,"aria-valuetext":!0},KEe={children:!0,accessibilityAccessKey:!0,accessibilityActions:!0,accessibilityAnnotation:!0,accessibilityControls:!0,accessibilityDescribedBy:!0,accessibilityDescription:!0,accessibilityElementsHidden:!0,accessibilityHint:!0,accessibilityIgnoresInvertColors:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabelledBy:!0,accessibilityLanguage:!0,accessibilityLevel:!0,accessibilityLiveRegion:!0,accessibilityPositionInSet:!0,accessibilityRole:!0,accessibilitySetSize:!0,accessibilityState:!0,accessibilityValue:!0,accessibilityViewIsModal:!0,accessible:!0,adjustsFontSizeToFit:!1,allowFontScaling:!0,android_hyphenationFrequency:!1,dataDetectorType:!1,disabled:!0,dynamicTypeRamp:!1,ellipsizeMode:!0,focusable:!0,id:!0,importantForAccessibility:!0,keyDownEvents:!0,keyUpEvents:!0,lineBreakMode:!0,lineBreakStrategyIOS:!0,maxFontSizeMultiplier:!0,minimumFontScale:!0,nativeID:!0,numberOfLines:!0,onAccessibilityAction:!0,onAccessibilityEscape:!0,onAccessibilityTap:!0,onBlur:!0,onBlurCapture:!0,onFocus:!0,onFocusCapture:!0,onKeyDown:!0,onKeyDownCapture:!0,onKeyUp:!0,onKeyUpCapture:!0,onLayout:!0,onLongPress:!0,onMagicTap:!1,onPress:!0,onPressIn:!0,onPressOut:!0,onTextLayout:!0,role:!0,selectable:!0,selectionColor:!0,style:!0,suppressHighlighting:!0,testID:!0,textBreakStrategy:!0,textStyle:!0,tooltip:!0,"aria-busy":!0,"aria-checked":!0,"aria-controls":!0,"aria-describedby":!0,"aria-description":!0,"aria-disabled":!0,"aria-expanded":!0,"aria-hidden":!0,"aria-label":!0,"aria-labelledby":!0,"aria-level":!0,"aria-live":!0,"aria-modal":!0,"aria-multiselectable":!0,"aria-posinset":!0,"aria-required":!0,"aria-selected":!0,"aria-setsize":!0,"aria-valuemax":!0,"aria-valuemin":!0,"aria-valuenow":!0,"aria-valuetext":!0},YEe={children:!0,accessibilityAccessKey:!0,accessibilityActions:!0,accessibilityAnnotation:!0,accessibilityControls:!0,accessibilityDescribedBy:!0,accessibilityDescription:!0,accessibilityElementsHidden:!0,accessibilityHint:!0,accessibilityIgnoresInvertColors:!0,accessibilityItemType:!0,accessibilityLabel:!0,accessibilityLabelledBy:!0,accessibilityLanguage:!0,accessibilityLevel:!0,accessibilityLiveRegion:!0,accessibilityPositionInSet:!0,accessibilityRole:!0,accessibilitySetSize:!0,accessibilityState:!0,accessibilityValue:!0,accessibilityViewIsModal:!0,accessible:!0,alt:!0,blurRadius:!0,borderBottomLeftRadius:!0,borderBottomRightRadius:!0,borderRadius:!0,borderTopLeftRadius:!0,borderTopRightRadius:!0,capInsets:!0,crossOrigin:!0,defaultSource:!0,fadeDuration:!0,height:!0,id:!0,importantForAccessibility:!0,loadingIndicatorSource:!0,nativeID:!0,onAccessibilityAction:!0,onAccessibilityEscape:!0,onAccessibilityTap:!0,onError:!0,onLayout:!0,onLoad:!0,onLoadEnd:!0,onLoadStart:!0,onMagicTap:!0,onPartialLoad:!0,onProgress:!0,progressiveRenderingEnabled:!0,referrerPolicy:!0,resizeMethod:!0,resizeMode:!0,role:!0,source:!0,src:!0,srcSet:!0,style:!0,testID:!0,tintColor:!0,width:!0,"aria-busy":!0,"aria-checked":!0,"aria-controls":!0,"aria-describedby":!0,"aria-description":!0,"aria-disabled":!0,"aria-expanded":!0,"aria-hidden":!0,"aria-label":!0,"aria-labelledby":!0,"aria-level":!0,"aria-live":!0,"aria-modal":!0,"aria-multiselectable":!0,"aria-posinset":!0,"aria-required":!0,"aria-selected":!0,"aria-setsize":!0,"aria-valuemax":!0,"aria-valuemin":!0,"aria-valuenow":!0,"aria-valuetext":!0}});var Nv=f(()=>{"use strict";s();OY()});var Z0,Qg,NY=f(()=>{"use strict";s();Z0=function(t){return"pageX"in t.nativeEvent},Qg=function(t){return"key"in t.nativeEvent}});var bO=be((_It,MY)=>{"use strict";s();var $Ee=function(t,r,n,o,a,d,c,u){if(!t){var l;if(r===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var p=[n,o,a,d,c,u],g=0;l=new Error(r.replace(/%s/g,function(){return p[g++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}};MY.exports=$Ee});function HY(){return LY}var AIt,LY,BY=f(()=>{"use strict";s();AIt=S(re()),LY=!1;LY=!0});function Mv(e){return typeof e=="number"?{bottom:e,left:e,right:e,top:e}:e}var SO=f(()=>{"use strict";s()});function Lv(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=0),Math.max(t,e??r)}var zY,GY,QEe,UY,VY,jY,XEe,JEe,ZEe,eP,WY,qY,KY=f(()=>{"use strict";s();k();zY=S(re()),GY=S(bO());BY();SO();QEe={NOT_RESPONDER:{DELAY:"ERROR",RESPONDER_GRANT:"RESPONDER_INACTIVE_PRESS_IN",RESPONDER_RELEASE:"ERROR",RESPONDER_TERMINATED:"ERROR",ENTER_PRESS_RECT:"ERROR",LEAVE_PRESS_RECT:"ERROR",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_INACTIVE_PRESS_IN:{DELAY:"RESPONDER_ACTIVE_PRESS_IN",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_INACTIVE_PRESS_OUT:{DELAY:"RESPONDER_ACTIVE_PRESS_OUT",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_INACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_ACTIVE_PRESS_IN:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"RESPONDER_ACTIVE_LONG_PRESS_IN"},RESPONDER_ACTIVE_PRESS_OUT:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},RESPONDER_ACTIVE_LONG_PRESS_IN:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_OUT",LONG_PRESS_DETECTED:"RESPONDER_ACTIVE_LONG_PRESS_IN"},RESPONDER_ACTIVE_LONG_PRESS_OUT:{DELAY:"ERROR",RESPONDER_GRANT:"ERROR",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_IN",LEAVE_PRESS_RECT:"RESPONDER_ACTIVE_LONG_PRESS_OUT",LONG_PRESS_DETECTED:"ERROR"},ERROR:{DELAY:"NOT_RESPONDER",RESPONDER_GRANT:"RESPONDER_INACTIVE_PRESS_IN",RESPONDER_RELEASE:"NOT_RESPONDER",RESPONDER_TERMINATED:"NOT_RESPONDER",ENTER_PRESS_RECT:"NOT_RESPONDER",LEAVE_PRESS_RECT:"NOT_RESPONDER",LONG_PRESS_DETECTED:"NOT_RESPONDER"}},UY=function(t){return t==="RESPONDER_ACTIVE_PRESS_IN"||t==="RESPONDER_ACTIVE_LONG_PRESS_IN"},VY=function(t){return t==="RESPONDER_ACTIVE_PRESS_OUT"||t==="RESPONDER_ACTIVE_PRESS_IN"},jY=function(t){return t==="RESPONDER_INACTIVE_PRESS_IN"||t==="RESPONDER_ACTIVE_PRESS_IN"||t==="RESPONDER_ACTIVE_LONG_PRESS_IN"},XEe=function(t){return t==="RESPONDER_TERMINATED"||t==="RESPONDER_RELEASE"},JEe=370,ZEe=130,eP={bottom:30,left:20,right:20,top:20};WY=function(t){var r=t.nativeEvent,n=r.changedTouches,o=r.touches;return o!=null&&o.length>0?o[0]:n!=null&&n.length>0?n[0]:t.nativeEvent},qY=function(){function e(t){var r=this;this._eventHandlers=null,this._hoverInDelayTimeout=null,this._hoverOutDelayTimeout=null,this._isHovered=!1,this._longPressDelayTimeout=null,this._pressDelayTimeout=null,this._pressOutDelayTimeout=null,this._responderID=null,this._responderRegion=null,this._touchState="NOT_RESPONDER",this._measureCallback=function(n,o,a,d,c,u){!n&&!o&&!a&&!d&&!c&&!u||(r._responderRegion={bottom:u+d,left:c,right:c+a,top:u})},this.configure(t)}return e.prototype.configure=function(t){this._config=t},e.prototype.reset=function(){this._cancelHoverInDelayTimeout(),this._cancelHoverOutDelayTimeout(),this._cancelLongPressDelayTimeout(),this._cancelPressDelayTimeout(),this._cancelPressOutDelayTimeout()},e.prototype.getEventHandlers=function(){return this._eventHandlers==null&&(this._eventHandlers=this._createEventHandlers()),this._eventHandlers},e.prototype._createEventHandlers=function(){var t=this,r={onBlur:function(d){var c=t._config.onBlur;c!=null&&c(d)},onFocus:function(d){var c=t._config.onFocus;c!=null&&c(d)}},n={onStartShouldSetResponder:function(){var d=t._config.disabled;return d==null?!0:!d},onResponderGrant:function(d){d.persist(),t._cancelPressOutDelayTimeout(),t._responderID=d.currentTarget,t._touchState="NOT_RESPONDER",t._receiveSignal("RESPONDER_GRANT",d);var c=Lv(t._config.delayPressIn,0,ZEe);c>0?t._pressDelayTimeout=setTimeout(function(){t._receiveSignal("DELAY",d)},c):t._receiveSignal("DELAY",d);var u=Lv(t._config.delayLongPress,10,JEe);t._longPressDelayTimeout=setTimeout(function(){t._handleLongPress(d)},u+c)},onResponderMove:function(d){t._config.onPressMove!=null&&t._config.onPressMove(d);var c=t._responderRegion;if(c!=null){var u=WY(d);if(u==null){t._cancelLongPressDelayTimeout(),t._receiveSignal("LEAVE_PRESS_RECT",d);return}if(t._touchActivatePosition!=null){var l=t._touchActivatePosition.pageX-u.pageX,p=t._touchActivatePosition.pageY-u.pageY;Math.hypot(l,p)>10&&t._cancelLongPressDelayTimeout()}t._isTouchWithinResponderRegion(u,c)?t._receiveSignal("ENTER_PRESS_RECT",d):(t._cancelLongPressDelayTimeout(),t._receiveSignal("LEAVE_PRESS_RECT",d))}},onResponderRelease:function(d){t._receiveSignal("RESPONDER_RELEASE",d)},onResponderTerminate:function(d){t._receiveSignal("RESPONDER_TERMINATED",d)},onResponderTerminationRequest:function(){var d=t._config.cancelable;return d||!0},onClick:function(d){var c=t._config.onPress;c!=null&&c(d)}},o={onMouseEnter:function(d){if(HY()){t._isHovered=!0,t._cancelHoverOutDelayTimeout();var c=t._config.onHoverIn;if(c!=null){var u=Lv(t._config.delayHoverIn);u>0?t._hoverInDelayTimeout=setTimeout(function(){c(d)},u):c(d)}}},onMouseLeave:function(d){if(t._isHovered){t._isHovered=!1,t._cancelHoverInDelayTimeout();var c=t._config.onHoverOut;if(c!=null){var u=Lv(t._config.delayHoverOut);u>0?t._hoverInDelayTimeout=setTimeout(function(){c(d)},u):c(d)}}}};return m(m(m({},r),n),o)},e.prototype._receiveSignal=function(t,r){var n=this._touchState,o=QEe[n][t];this._responderID==null&&t==="RESPONDER_RELEASE"||((0,GY.default)(o!=null&&o!=="ERROR","Pressability: Invalid signal `%s` for state `%s` on responder: %s",t,n,typeof this._responderID=="number"?this._responderID:"<<host component>>"),n!==o&&(this._performTransitionSideEffects(n,o,t,r),this._touchState=o))},e.prototype._performTransitionSideEffects=function(t,r,n,o){XEe(n)&&(this._touchActivatePosition=null,this._cancelLongPressDelayTimeout());var a=t==="NOT_RESPONDER"&&r==="RESPONDER_INACTIVE_PRESS_IN",d=!VY(t)&&VY(r);if((a||d)&&this._measureResponderRegion(),jY(t)&&n==="LONG_PRESS_DETECTED"){var c=this._config.onLongPress;c!=null&&c(o)}var u=UY(t),l=UY(r);if(!u&&l?this._activate(o):u&&!l&&this._deactivate(o),jY(t)&&n==="RESPONDER_RELEASE"){var p=this._config,c=p.onLongPress,g=p.onPress;if(g!=null){var h=c!=null&&t==="RESPONDER_ACTIVE_LONG_PRESS_IN"&&this._shouldLongPressCancelPress();h||(!l&&!u&&(this._activate(o),this._deactivate(o)),g(o))}}this._cancelPressDelayTimeout()},e.prototype._activate=function(t){var r=this._config.onPressIn,n=WY(t);this._touchActivatePosition={pageX:n.pageX,pageY:n.pageY},r!=null&&r(t)},e.prototype._deactivate=function(t){var r=this._config.onPressOut;if(r!=null){var n=Lv(this._config.delayPressOut);n>0?this._pressOutDelayTimeout=setTimeout(function(){r(t)},n):r(t)}},e.prototype._measureResponderRegion=function(){var t,r;if(this._responderID!=null)if(typeof this._responderID=="number")zY.UIManager.measure(this._responderID,this._measureCallback);else{var n=(t=this===null||this===void 0?void 0:this._responderID)===null||t===void 0?void 0:t.measure;typeof n=="function"&&this._measureCallback&&((r=this===null||this===void 0?void 0:this._responderID)===null||r===void 0||r.measure(this._measureCallback))}},e.prototype._isTouchWithinResponderRegion=function(t,r){var n,o,a,d,c=Mv(this._config.hitSlop),u=Mv(this._config.pressRectOffset),l=r.bottom,p=r.left,g=r.right,h=r.top;return c!=null&&(c.bottom!=null&&(l+=c.bottom),c.left!=null&&(p-=c.left),c.right!=null&&(g+=c.right),c.top!=null&&(h-=c.top)),l+=(n=u==null?void 0:u.bottom)!==null&&n!==void 0?n:eP.bottom,p-=(o=u==null?void 0:u.left)!==null&&o!==void 0?o:eP.left,g+=(a=u==null?void 0:u.right)!==null&&a!==void 0?a:eP.right,h-=(d=u==null?void 0:u.top)!==null&&d!==void 0?d:eP.top,t.pageX>p&&t.pageX<g&&t.pageY>h&&t.pageY<l},e.prototype._handleLongPress=function(t){(this._touchState==="RESPONDER_ACTIVE_PRESS_IN"||this._touchState==="RESPONDER_ACTIVE_LONG_PRESS_IN")&&this._receiveSignal("LONG_PRESS_DETECTED",t)},e.prototype._shouldLongPressCancelPress=function(){return!0},e.prototype._cancelHoverInDelayTimeout=function(){this._hoverInDelayTimeout!=null&&(clearTimeout(this._hoverInDelayTimeout),this._hoverInDelayTimeout=null)},e.prototype._cancelHoverOutDelayTimeout=function(){this._hoverOutDelayTimeout!=null&&(clearTimeout(this._hoverOutDelayTimeout),this._hoverOutDelayTimeout=null)},e.prototype._cancelLongPressDelayTimeout=function(){this._longPressDelayTimeout!=null&&(clearTimeout(this._longPressDelayTimeout),this._longPressDelayTimeout=null)},e.prototype._cancelPressDelayTimeout=function(){this._pressDelayTimeout!=null&&(clearTimeout(this._pressDelayTimeout),this._pressDelayTimeout=null)},e.prototype._cancelPressOutDelayTimeout=function(){this._pressOutDelayTimeout!=null&&(clearTimeout(this._pressOutDelayTimeout),this._pressOutDelayTimeout=null)},e}()});function tP(e){var t=(0,Hv.useRef)(null);t.current==null&&(t.current=new qY(e));var r=t.current;return(0,Hv.useEffect)(function(){r.configure(e)},[e,r]),(0,Hv.useEffect)(function(){return function(){r.reset()}},[r]),r.getEventHandlers()}var Hv,IO=f(()=>{"use strict";s();Hv=S(L());KY()});function e0e(e){var t=Gs.useState({hovered:!1}),r=t[0],n=t[1],o=Gs.useCallback(function(d){n({hovered:!0}),e.onHoverIn&&e.onHoverIn(d)},[n,e.onHoverIn]),a=Gs.useCallback(function(d){n({hovered:!1}),e.onHoverOut&&e.onHoverOut(d)},[n,e.onHoverOut]);return[{onHoverIn:o,onHoverOut:a},r]}function t0e(e){var t=Gs.useState({focused:!1}),r=t[0],n=t[1],o=Gs.useCallback(function(d){n({focused:!0}),e.onFocus&&e.onFocus(d)},[n,e.onFocus]),a=Gs.useCallback(function(d){n({focused:!1}),e.onBlur&&e.onBlur(d)},[n,e.onBlur]);return[{onFocus:o,onBlur:a},r]}function r0e(e){var t=Gs.useState({pressed:!1}),r=t[0],n=t[1],o=Gs.useCallback(function(d){n({pressed:!0}),e.onPressIn&&e.onPressIn(d)},[n,e.onPressIn]),a=Gs.useCallback(function(d){n({pressed:!1}),e.onPressOut&&e.onPressOut(d)},[n,e.onPressOut]);return[{onPressIn:o,onPressOut:a},r]}function ji(e){var t=e0e(e),r=t[0],n=t[1],o=t0e(e),a=o[0],d=o[1],c=r0e(e),u=c[0],l=c[1],p=tP(m(m(m(m({},e),r),a),u));return{props:m(m({},e),p),state:m(m(m({},n),d),l)}}var Gs,YY=f(()=>{"use strict";s();k();Gs=S(L());IO()});function n0e(e){var t=qs.useState({hovered:!1}),r=t[0],n=t[1],o=e.onHoverIn,a=e.onHoverOut,d=qs.useCallback(function(u){n({hovered:!0}),o==null||o(u)},[n,o]),c=qs.useCallback(function(u){n({hovered:!1}),a==null||a(u)},[n,a]);return[{onHoverIn:d,onHoverOut:c},r]}function o0e(e){var t=qs.useState({focused:!1}),r=t[0],n=t[1],o=e.onFocus,a=e.onBlur,d=qs.useCallback(function(u){n({focused:!0}),o==null||o(u)},[n,o]),c=qs.useCallback(function(u){n({focused:!1}),a==null||a(u)},[n,a]);return[{onFocus:d,onBlur:c},r]}function i0e(e){var t=qs.useState({pressed:!1}),r=t[0],n=t[1],o=e.onPressIn,a=e.onPressOut,d=qs.useCallback(function(u){n({pressed:!0}),o==null||o(u)},[n,o]),c=qs.useCallback(function(u){n({pressed:!1}),a==null||a(u)},[n,a]);return[{onPressIn:d,onPressOut:c},r]}function Vd(e){var t=e.onPressIn,r=e.onPressOut,n=e.onHoverIn,o=e.onHoverOut,a=e.onFocus,d=e.onBlur,c=Ke(e,["onPressIn","onPressOut","onHoverIn","onHoverOut","onFocus","onBlur"]),u=n0e({onHoverIn:n,onHoverOut:o}),l=u[0],p=u[1],g=o0e({onFocus:a,onBlur:d}),h=g[0],v=g[1],y=i0e({onPressIn:t,onPressOut:r}),T=y[0],b=y[1];return{props:m(m(m(m({},l),h),T),c),state:m(m(m({},p),v),b)}}var qs,$Y=f(()=>{"use strict";s();k();qs=S(L())});function QY(e){var t=e.getForwardedRef,r=e.setLocalRef;return function(o){var a=t();r(o),typeof a=="function"?a(o):typeof a=="object"&&a!=null&&(a.current=o)}}var XY=f(()=>{"use strict";s()});function Ar(e){var t=JY.useRef(),r=QY({getForwardedRef:function(){return e},setLocalRef:function(o){t.current=o}});return r}var JY,ZY=f(()=>{"use strict";s();JY=S(L());XY()});function Sl(e,t){var r=rP.useState(e),n=r[0],o=r[1],a=rP.useCallback(function(d){o(d),t&&t(d)},[o,t]);return{onKeySelect:a,selectedKey:n}}var rP,e$=f(()=>{"use strict";s();rP=S(L())});function oP(e,t,r){var n=nP.useState(e??t),o=n[0],a=n[1],d=nP.useCallback(function(){r&&r(!o),a(!o)},[o,a]);return[t??o,d]}var nP,t$=f(()=>{"use strict";s();nP=S(L())});var r$,n$=f(()=>{"use strict";s();r$=S(L())});var a0e,o$=f(()=>{"use strict";s();a0e=S(L())});var EO,i$=f(()=>{"use strict";s();EO=S(L());o$()});function a$(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=function(a){e!==void 0&&!d0e(a.nativeEvent)&&t.includes(a.nativeEvent.key)&&(e(a),a.stopPropagation())};return n}function c0e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={onKeyUp:a$.apply(void 0,w([e],t,!1)),keyUpEvents:t.map(function(o){return{key:o}})};return n}function u0e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n={onKeyDown:a$.apply(void 0,w([e],t,!1)),keyDownEvents:t.map(function(o){return{key:o}})};return n}var s0e,gEt,d0e,PO,jd,Qo,s$=f(()=>{"use strict";s();k();s0e=S(L()),gEt=S(re());Bc();d0e=function(t){return t&&(t.alt||t.altKey||t.meta||t.metaKey)};PO=Qt(c0e),jd=Qt(u0e),Qo=PO});function ns(e,t){var r=d$.useCallback(function(n){var o,a=["windows","win32","macos"].includes("win32"),d=["windows","win32"].includes("win32");a&&d&&((o=e==null?void 0:e.current)===null||o===void 0||o.focus()),t==null||t(n)},[t,e]);return r}var d$,xEt,c$=f(()=>{"use strict";s();d$=S(L()),xEt=S(re())});function l0e(e,t){return t?m({disabled:e},t):{disabled:e}}var iP,u$=f(()=>{"use strict";s();k();Oe();iP=Qt(l0e)});var An=f(()=>{"use strict";s();NY();YY();$Y();IO();ZY();e$();t$();n$();i$();SO();s$();c$();u$()});var Xg,aP=f(()=>{"use strict";s();Xg="Text"});var l$,f$=f(()=>{"use strict";s();Oe();aP();l$=Zf(function(e){return{variant:"secondaryStandard",color:e.colors.bodyText}},Xg)});var _O,sP,Wd,C0e,v0e,p$,br,RO=f(()=>{"use strict";s();_O=S(L()),sP=S(re());Oe();An();xi();aP();f$();Wd=function(){return Wd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Wd.apply(this,arguments)},C0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},v0e=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},p$={},br=Cl(function(e,t){var r;e===void 0&&(e=p$);var n=e.align,o=n===void 0?void 0:n,a=e.block,d=e.color,c=e.font,u=e.italic,l=e.numberOfLines,p=e.onAccessibilityTap,g=e.onKeyUp,h=e.onKeyDown,v=e.keyUpEvents,y=e.keyDownEvents,T=e.onPress,b=e.size,I=e.strikethrough,E=e.style,P=e.truncate,_=P===void 0?!1:P,D=e.underline,M=e.variant,H=e.weight,U=e.wrap,F=U===void 0?!0:U,z=C0e(e,["align","block","color","font","italic","numberOfLines","onAccessibilityTap","onKeyUp","onKeyDown","keyUpEvents","keyDownEvents","onPress","size","strikethrough","style","truncate","underline","variant","weight","wrap"]),Y=fa(),B=t(Y),q=B[0],K=B[1],$=sP.I18nManager.isRTL?o==="start"?"right":o==="end"?"left":o:o==="start"?"left":o==="end"?"right":o,oe=_O.default.useCallback(function(Ue){T&&T(Ue),Ue.stopPropagation()},[T]),ie=Qo(oe," ","Enter"),Ce=_O.default.useCallback(function(Ue){p?p():T(Ue)},[T,p]);r=Xf(q,K,{color:d,variant:M,fontFamily:c=="base"?"primary":c,fontMaximumSize:q.maximumFontSize,fontSize:O.font["size"+b],fontWeight:O.font.weight[H],fontStyle:u?"italic":void 0,textAlign:$,textDecorationLine:D&&I?"underline line-through":D?"underline":I?"line-through":void 0}),q=r[0],K=r[1];var se=K(function(){return Wd({margin:0,color:q.color,fontStyle:q.fontStyle,textAlign:q.textAlign,textDecorationLine:q.textDecorationLine},Zr.from(q,Y))},v0e(["color","fontStyle","textAlign","textDecorationLine"],Zr.keys,!0))[0],he=void 0,Be=p$,_e=!0,ot={onKeyUp:g,keyUpEvents:v,validKeysUp:void 0,onKeyDown:h,keyDownEvents:y,validKeysDown:void 0,onAccessibilityTap:Ce};return function(Ue,or){var ir=Wd(Wd(Wd(Wd(Wd(Wd({},z),ie),ot),Ue),Be),{onPress:T,numberOfLines:l??(_||!F)?1:0,style:vi(se,e.style,Ue==null?void 0:Ue.style)});return delete ir.style.dynamicTypeRamp,delete ir.style.maximumFontSize,we(sP.Text,Wd({ellipsizeMode:!F&&!_?"clip":"tail"},ir),or)}},l$);br.displayName=Xg});var x0e,T0e,b0e,S0e,I0e,E0e,P0e,_0e,R0e,A0e,k0e,D0e,w0e,m$=f(()=>{"use strict";s();RO();x0e=br.customize({variant:"caption1"}),T0e=br.customize({variant:"body1"}),b0e=br.customize({variant:"body1Strong"}),S0e=br.customize({variant:"body2"}),I0e=br.customize({variant:"body2Strong"}),E0e=br.customize({variant:"subtitle1"}),P0e=br.customize({variant:"subtitle1Strong"}),_0e=br.customize({variant:"subtitle2"}),R0e=br.customize({variant:"subtitle2Strong"}),A0e=br.customize({variant:"title1"}),k0e=br.customize({variant:"title1Strong"}),D0e=br.customize({variant:"largeTitle"}),w0e=br.customize({variant:"display"})});var Jg,dP=f(()=>{"use strict";s();Jg="RNFText"});function Dt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Us.apply(void 0,F0e([O0e],e,!1))}function cP(e,t){var r=typeof t=="function"?t:function(n){return t[n]};return e&&e._precedence&&e._precedence.filter(function(n){return r(n)})||[]}function AO(e,t){var r=e,n=e._overrides,o=e._precedence;if(t&&n&&o)for(var a=cP(e,t),d=0,c=a;d<c.length;d++){var u=c[d];r=Dt(r,r._overrides[u])}return r}var F0e,O0e,g$=f(()=>{"use strict";s();Vs();Ng();F0e=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},O0e={tokens:0,object:dt,get _overrides(){return{object:this}}}});var Co=f(()=>{"use strict";s();g$()});function y$(e,t,r){var n=dt(e,t);if(r&&n){var o={};Object.getOwnPropertyNames(n).forEach(function(a){r(a)||(o[a]=void 0)}),n=dt(n,o)}return n}function C$(e){return e._canCompose=!0,e}function v$(e,t){var r={composable:e,slotInfo:t},n=e&&e.slots;if(n){var o=r.Slots={},a=r.childInfo={};Object.getOwnPropertyNames(n).forEach(function(d){var c=n[d],u=c.slotType,l=c.filter,p=typeof u!="string"&&u.__composable||void 0,g=a[d]=v$(p,n[d]);p?o[d]=C$(function(h){for(var v=[],y=1;y<arguments.length;y++)v[y-1]=arguments[y];var T=g.renderData,b=g.Slots;if(l||h){var I={root:y$(T.slotProps.root,h,l)};T.slotProps=Dt(T.slotProps,I)}return p.render.apply(p,h$([b,T],v,!1))}):o[d]=C$(function(h){for(var v=[],y=1;y<arguments.length;y++)v[y-1]=arguments[y];var T=y$(g.renderData.slotProps.root,h,l);return Bv.createElement.apply(Bv,h$([u,T],v,!1))})})}return r}function x$(e,t){if(t.composable){var r=t.composable,n=r.usePrepareProps,o=r.useStyling;t.renderData=n(e,o)||{}}else t.renderData={slotProps:{root:e}};var a=t.childInfo;if(a){var d=t.renderData.slotProps||{};Object.getOwnPropertyNames(a).forEach(function(c){x$(d[c],a[c])})}return{renderData:t.renderData,Slots:t.Slots}}function T$(e,t){var r=Bv.useMemo(function(){return v$(t)},[]);return x$(e,r)}var Bv,h$,b$=f(()=>{"use strict";s();Bv=S(L());Co();Ng();h$=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});function uP(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return typeof e=="function"&&e._canCompose?e.apply(void 0,kO([t],r,!1)):DO.createElement.apply(DO,kO([e,t],r,!1))}function Pe(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return uP.apply(void 0,kO([e,t],r,!1))}var DO,kO,wO=f(()=>{"use strict";s();DO=S(L()),kO=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});function S$(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return uP.apply(void 0,L0e([e.root,void 0],r,!1))}function I$(e,t){var r=Dt(t(e),{root:e});return{slotProps:r}}function H0e(e){var t=e.slots&&Object.getOwnPropertyNames(e.slots).length||0;if(t){if(t>1&&!e.render)throw"A composable component with multiple slots cannot use the default render implementation"}else throw"A composable component must have at least one slot specified";for(var r in e.slots){var n=e.slots[r];n&&(typeof n!="object"||!n.slotType)&&(e.slots[r]={slotType:n})}return e.useStyling||(e.useStyling=function(){return{}}),e.render=e.render||S$,e.usePrepareProps=e.usePrepareProps||I$,e}function qc(e){var t=H0e(e),r=function(o){var a=o,d=a.children,c=M0e(a,["children"]),u=T$(c,t),l=u.renderData,p=u.Slots;return t.render(p,l,d)};return r.displayName=t.displayName,r.__composable=t,r}var M0e,L0e,E$=f(()=>{"use strict";s();b$();wO();Co();M0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},L0e=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});var Wi=f(()=>{"use strict";s();E$();wO()});function P$(e,t,r){return e?Dt.apply(void 0,e.map(function(n){return typeof n=="string"?r&&r(t,n)||void 0:typeof n=="function"?n(t):n})):void 0}function FO(e,t,r,n,o){var a,d=r(function(){return P$(e,t,o)},[t]),c=d[0],u=d[1],l=cP(c,n);return l.length>0&&(a=u(function(){return AO(c,n)},l),c=a[0],u=a[1]),{settings:c,getMemoValue:u}}var _$=f(()=>{"use strict";s();Co()});var R$=f(()=>{"use strict";s();_$()});function OO(e){if(e){var t=e._overrides,r=e._precedence,n=B0e(e,["_overrides","_precedence"]);return n}return e}function NO(e,t){return e.components&&e.components[t]||void 0}var B0e,A$=f(()=>{"use strict";s();B0e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r}});var k$=f(()=>{"use strict";s();Co();Vs()});var D$=f(()=>{"use strict";s();A$();k$();Qf()});function U0e(e,t,r){var n=MO({},t),o={};for(var a in r)e[a]!==void 0&&e[a]!==n[a]&&(o[a]=n[a]=e[a]);return{tokens:n,deltas:o,tokenKeys:r}}function LO(e,t,r,n,o){r=r||{};var a=r.tokens||{},d=n.handlers,c=n.tokenKeys,u=U0e(e,a,c),l={tokens:u.tokens||{}};return Object.getOwnPropertyNames(d).forEach(function(p){var g=d[p];l[p]=g(r[p]||{},u,t,p,o)}),l}var MO,w$=f(()=>{"use strict";s();MO=function(){return MO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},MO.apply(this,arguments)}});function j0e(e,t,r,n){e[t]!==void 0&&(n[r||t]=e[t])}function W0e(e,t,r,n){var o=r.source,a=r.lookup;if(e[o]!==void 0){var d=a&&a(t),c=e[o];typeof c=="string"&&d&&d[c]!==void 0&&(c=d[c]),n[r.target||o]=c}}function z0e(e,t,r){var n={};if(r.toStyle.length>0){for(var o={},a=0,d=r.toStyle;a<d.length;a++){var c=d[a];W0e(e,t,c,o)}Object.keys(o).length>0&&(n.style=o)}for(var u=0,l=r.toTokens;u<l.length;u++){var c=l[u];j0e(e,c.source,c.target,n)}return n}function G0e(e,t,r){if(e&&e.length>0)return dt.apply(void 0,e.map(function(n){return n(t,r)}))}function q0e(e,t,r,n,o,a,d,c){var u=t.tokens,l=t.tokenKeys,p=t.deltas;return o(function(){var g=dt(e,n==="root"?l:void 0,z0e(u,r,d),G0e(d.functions,u,r));return c&&(g=c(g,n)),g},V0e([n],a.map(function(g){return p[g]!==void 0?p[g]:""}),!0))[0]}function HO(e,t){var r={},n={};return Object.getOwnPropertyNames(e).forEach(function(o){var a=e[o],d={toStyle:[],toTokens:[],functions:[]},c=d.toStyle,u=d.toTokens,l=d.functions,p={};if(a)for(var g=Array.isArray(a)?a:[a],h=0,v=g;h<v.length;h++){var y=v[h];if(typeof y=="function")l.push(y),y._keys.forEach(function(_){p[_]=void 0});else for(var T=Array.isArray(y)?y:[y],b=0,I=T;b<I.length;b++){var E=I[b];p[E.source]=void 0;var P=E.target||E.source;t&&t(o,P)?u.push(E):c.push(E)}}Object.assign(r,p),n[o]=function(_,D,M,H,U){var F=Object.getOwnPropertyNames(p);return q0e(_,D,M,H,U,F,d)}}),{tokenKeys:r,handlers:n}}var V0e,F$=f(()=>{"use strict";s();Ng();V0e=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}});var os=f(()=>{"use strict";s();w$();F$();_n()});function BO(e){var t=e&&typeof e;return(t==="object"||t==="function")&&e.__composable||void 0}function K0e(e,t){return NO(e,t)}function Y0e(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r],o=typeof n!="object"?n:n.slotType,a=BO(o);t[r]=a&&a.resolvedTokens&&a.resolvedTokens.tokenKeys||void 0}),function(r,n){return t[r]&&t[r].hasOwnProperty(n)}}function $0e(e,t,r,n){var o=Uc()||Yo;n=n||e;var a=FO(t.settings,o,r,n,K0e),d=a.settings,c=a.getMemoValue;return OO(LO(e,o,d,t.resolvedTokens,c))}function UO(e){var t=e.styles,r=e.slots;e.resolvedTokens=HO(t,Y0e(r));var n=Ao(e);return function(o,a){return $0e(o,e,n,a)}}var VO=f(()=>{"use strict";s();R$();D$();os();Qf();Vg();Bc()});function Q0e(e,t){if(t){var r={settings:[].concat(t.settings||[],e.settings||[]).filter(function(n){return n})};return ua(t,e,r)}return e}function Br(e,t){var r=Q0e(e,t&&BO(t));r.useStyling=UO(r);var n=qc(r);return n.displayName=r.displayName,Object.assign(n,r.statics),n.customize=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];return Br({settings:o},n)},n.compose=function(o){return Br(o,n)},n}var O$=f(()=>{"use strict";s();Wi();VO();Vs()});var is=f(()=>{"use strict";s();O$();VO()});var N$,M$=f(()=>{"use strict";s();dP();N$=[{tokens:{variant:"secondaryStandard",color:"bodyText"},root:{style:{margin:0}},_overrides:{disabled:{tokens:{color:"disabledText"}}},_precedence:["disabled"]},Jg]});var L$,Sr,H$=f(()=>{"use strict";s();L$=S(re());Nv();_n();is();M$();dP();Sr=Br({displayName:Jg,settings:N$,slots:{root:{slotType:L$.Text,filter:TO}},styles:{root:[Za,po]}})});var pa=f(()=>{"use strict";s();RO();aP();m$();dP();H$()});var tp=be((KPt,B$)=>{s();B$.exports=OfficePlatformGlobal.SVG});function X0e(e){var t=e.width,r=e.height,n=e.color,o=vi(e.style,V$({width:t,height:r,tintColor:n},[t,r,n])[0]);return rp.createElement(Uv.Image,{source:e.rasterImageSource.src,style:o,accessible:e.accessible,accessibilityRole:"image",accessibilityLabel:e.accessibilityLabel})}function J0e(e,t){return t}function ePe(e){var t=e.fontSource,r=Z0e({fontSrcFile:t.fontSrcFile,fontFamily:t.fontSrcFile!=null?J0e(t.fontSrcFile,t.fontFamily):t.fontFamily,fontSize:t.fontSize,color:e.color},[e.color,t.fontSrcFile,t.fontFamily,t.fontSize])[0],n=String.fromCharCode(t.codepoint);return rp.createElement(Sr,{accessible:e.accessible,style:r},n)}function tPe(e){var t=e.svgSource,r=e.accessible,n=e.accessibilityLabel,o=e.width,a=e.height,d=e.color,c=vi(e.style,V$({width:o,height:a},[o,a])[0]),u={width:o,height:a,color:d};return t.viewBox&&(u.viewBox=t.viewBox),t.src?rp.createElement(Uv.View,{style:c,accessible:r,accessibilityRole:"image",accessibilityLabel:n},rp.createElement(t.src,lP({},u))):t.uri?rp.createElement(Uv.View,{style:c,accessible:r,accessibilityRole:"image",accessibilityLabel:n},rp.createElement(U$.SvgUri,lP({uri:t.uri},u))):null}var rp,Uv,U$,lP,V$,Z0e,Il,j$=f(()=>{"use strict";s();rp=S(L()),Uv=S(re());Oe();Oe();pa();U$=S(tp()),lP=function(){return lP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},lP.apply(this,arguments)},V$=Ao();Z0e=Ao();Il=Rn(function(e){var t=fa();return function(r){var n,o=e.color||t.colors.buttonText,a=(n=e.accessible)!==null&&n!==void 0?n:!0,d={color:o,accessible:a},c=dt(d,e,r);return c.svgSource?tPe(c):c.fontSource?ePe(c):c.rasterImageSource?X0e(c):null}})});function El(e){if(e===void 0)return null;if(typeof e=="number"){var t={src:e},r=W$.Image.resolveAssetSource(+e);return{rasterImageSource:t,width:r.width,height:r.height}}else if(typeof e=="string"){var t={src:{uri:e}};return{rasterImageSource:t}}else return e}var W$,z$=f(()=>{"use strict";s();W$=S(re())});var jO,WO=f(()=>{"use strict";s();jO="FontIcon"});var zO,GO=f(()=>{"use strict";s();zO="SvgIcon"});function nPe(e,t){return t}var s_t,qO,rPe,G$,oPe,q$=f(()=>{"use strict";s();s_t=S(re());Oe();qO=function(){return qO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},qO.apply(this,arguments)},rPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},G$=function(t){var r=t.accessible,n=t.color,o=t.fontSrcFile,a=t.fontFamily,d=t.fontSize,c=t.style,u=rPe(t,["accessible","color","fontSrcFile","fontFamily","fontSize","style"]),l=oPe({fontFamily:o!=null?nPe(o,a):a,fontSize:d,color:n},[n,d,a])[0],p=vi(l,c);return qO({accessible:r??!0,style:p},u)};oPe=Ao()});var K$,Y$,KO,iPe,fP,YO=f(()=>{"use strict";s();K$=S(L()),Y$=S(re());Oe();WO();q$();KO=function(){return KO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},KO.apply(this,arguments)},iPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},fP=Rn(function(e){var t=G$(e);return function(r){var n=dt(t,r),o=n.codepoint,a=iPe(n,["codepoint"]),d=String.fromCharCode(o);return K$.createElement(Y$.Text,KO({},a),d)}});fP.displayName=jO});var $O,aPe,sPe,$$,Q$=f(()=>{"use strict";s();Oe();$O=function(){return $O=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},$O.apply(this,arguments)},aPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},sPe=Ao(),$$=function(t){var r=t.accessible,n=t.style,o=t.height,a=t.width,d=aPe(t,["accessible","style","height","width"]);return $O({accessible:r??!0,height:o,style:vi(n,sPe({width:a,height:o},[a,o])[0]),width:a},d)}});var pP,X$,J$,QO,dPe,mP,XO=f(()=>{"use strict";s();pP=S(L()),X$=S(re());Oe();J$=S(tp());GO();Q$();QO=function(){return QO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},QO.apply(this,arguments)},dPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},mP=Rn(function(e){var t=$$(e);return function(r){var n=dt(t,r),o=n.style,a=n.height,d=n.width,c=n.src,u=n.uri,l=n.viewBox,p=n.color,g=dPe(n,["style","height","width","src","uri","viewBox","color"]),h=!0;return c||u?pP.createElement(X$.View,QO({style:o,accessibilityRole:"image"},g),c?pP.createElement(t.src,{viewBox:l,width:d,height:a,color:p}):pP.createElement(J$.SvgUri,{uri:u,viewBox:l,width:d,height:a,color:p})):null}});mP.displayName=zO});var JO,gP,np,Z$=f(()=>{"use strict";s();JO=S(L());YO();XO();gP=function(){return gP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},gP.apply(this,arguments)},np=function(t){return t.svgSource?JO.createElement(mP,gP({color:t.color,height:t.size,width:t.size},t.svgSource)):t.fontSource?JO.createElement(fP,gP({color:t.color,fontSize:t.size},t.fontSource)):null}});var op=f(()=>{"use strict";s();j$();z$();WO();GO();Z$();YO();XO()});var Vv,ZO=f(()=>{"use strict";s();Vv="Button"});var jv,eN=f(()=>{"use strict";s();jv="ActivityIndicator"});function cPe(e){if(typeof e>"u")return e;switch(e){case"xSmall":return"small";case"small":return"small";case"medium":return"small";case"large":return"large";case"xLarge":return"large";default:(0,tQ.default)(e)}}var eQ,tQ,tN,hP,q_t,rQ,nQ=f(()=>{"use strict";s();eQ=S(re());Oe();tQ=S(w0());eN();tN=function(){return tN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},tN.apply(this,arguments)},hP={xSmall:12,small:16,medium:24,large:32,xLarge:36};q_t={tokens:[function(){return{activityIndicatorColor:eQ.Appearance.getColorScheme()==="light"?"#BDBDBD":"#666666",lineThickness:"medium",size:"medium"}},jv],tokensThatAreAlsoProps:"all",slotProps:{root:ct(function(e){return{activityIndicatorColor:e.activityIndicatorColor,size:e.size,lineThickness:e.lineThickness!="medium"?e.lineThickness:e.size,accessibilityLabel:"progressbar",accessible:!0,style:{width:hP[e.size],height:hP[e.size]}}},["activityIndicatorColor","lineThickness","size"]),svg:ct(function(e){return{width:hP[e.size],height:hP[e.size]}},["size"])}},rQ={tokens:[function(){return{size:"small"}},jv],tokensThatAreAlsoProps:"all",slotProps:{root:ct(function(e){return tN({color:e.activityIndicatorColor},e.size&&{size:cPe(e.size)})},["activityIndicatorColor","size"])}}});var oQ,yP,Wv,rN=f(()=>{"use strict";s();oQ=S(re());Oe();nQ();eN();yP=function(){return yP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yP.apply(this,arguments)},Wv=en(yP(yP({displayName:jv},rQ),{slots:{root:oQ.ActivityIndicator},useRender:function(t,r){var n=r(t);return function(){return we(n.root,null)}}}))});var iQ=f(()=>{"use strict";s();rN();rN()});var aQ=f(()=>{"use strict";s();iQ()});function CP(){return uPe}var uPe,sQ=f(()=>{"use strict";s();uPe={marginTop:-1,marginBottom:1,marginStart:0,marginEnd:-2}});var dQ=f(()=>{"use strict";s();sQ()});var vo,cQ,lPe,uQ=f(()=>{"use strict";s();vo=S(re());Vc();cQ=function(t){return jt(t)?lPe:{backgroundColor:t.colors.neutralBackground1,color:t.colors.neutralForeground1,borderColor:t.colors.neutralStroke1,iconColor:t.colors.neutralForeground1,disabled:{backgroundColor:t.colors.neutralBackgroundDisabled,color:t.colors.neutralForegroundDisabled,borderColor:t.colors.neutralStrokeDisabled,iconColor:t.colors.neutralForegroundDisabled},hovered:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.neutralStroke1,iconColor:t.colors.neutralForeground1Hover},pressed:{backgroundColor:t.colors.neutralBackground1Pressed,color:t.colors.neutralForeground1Pressed,borderColor:t.colors.neutralStroke1,iconColor:t.colors.neutralForeground1Pressed},focused:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForeground1Hover},primary:{backgroundColor:t.colors.brandBackground,color:t.colors.neutralForegroundOnBrand,borderColor:t.colors.brandStroke1,iconColor:t.colors.neutralForegroundOnBrand,disabled:{backgroundColor:t.colors.neutralBackgroundDisabled,color:t.colors.neutralForegroundDisabled,borderColor:t.colors.neutralStrokeDisabled,iconColor:t.colors.neutralForegroundDisabled},hovered:{backgroundColor:t.colors.brandBackgroundHover,color:t.colors.neutralForegroundOnBrandHover,borderColor:t.colors.brandBackgroundHover,iconColor:t.colors.neutralForegroundOnBrandHover},pressed:{backgroundColor:t.colors.brandBackgroundPressed,color:t.colors.neutralForegroundOnBrandPressed,borderColor:t.colors.brandBackgroundPressed,iconColor:t.colors.neutralForegroundOnBrandPressed},focused:{backgroundColor:t.colors.brandBackgroundHover,color:t.colors.neutralForegroundOnBrandHover,borderColor:t.colors.strokeFocus2,borderInnerColor:t.colors.strokeFocus1,iconColor:t.colors.neutralForegroundOnBrandHover}},subtle:{backgroundColor:t.colors.subtleBackground,color:t.colors.neutralForeground1,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForeground1,disabled:{backgroundColor:t.colors.subtleBackground,color:t.colors.neutralForegroundDisabled,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForegroundDisabled},hovered:{backgroundColor:t.colors.subtleBackgroundHover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.subtleBackgroundHover,iconColor:t.colors.neutralForeground1Hover},pressed:{backgroundColor:t.colors.subtleBackgroundPressed,color:t.colors.neutralForeground1Pressed,borderColor:t.colors.subtleBackgroundPressed,iconColor:t.colors.neutralForeground1Pressed},focused:{backgroundColor:t.colors.subtleBackgroundHover,color:t.colors.neutralForeground1Hover,borderColor:t.colors.transparentStroke,iconColor:t.colors.neutralForeground1Hover}}}},lPe={backgroundColor:(0,vo.PlatformColor)("ButtonFace"),borderColor:(0,vo.PlatformColor)("ButtonText"),color:(0,vo.PlatformColor)("ButtonText"),iconColor:(0,vo.PlatformColor)("ButtonText"),disabled:{backgroundColor:(0,vo.PlatformColor)("ButtonFace"),borderColor:(0,vo.PlatformColor)("GrayText"),color:(0,vo.PlatformColor)("GrayText"),iconColor:(0,vo.PlatformColor)("GrayText")},hovered:{backgroundColor:(0,vo.PlatformColor)("Highlight"),color:(0,vo.PlatformColor)("HighlightText"),iconColor:(0,vo.PlatformColor)("HighlightText")},pressed:{backgroundColor:(0,vo.PlatformColor)("Highlight"),color:(0,vo.PlatformColor)("HighlightText"),iconColor:(0,vo.PlatformColor)("HighlightText")},focused:{backgroundColor:(0,vo.PlatformColor)("Highlight"),color:(0,vo.PlatformColor)("HighlightText"),iconColor:(0,vo.PlatformColor)("HighlightText")}}});var lQ,fQ=f(()=>{"use strict";s();xi();lQ=function(t){return{medium:{hasContent:{fontFamily:t.typography.families.secondary,fontSize:O.font.size300,fontWeight:O.font.weight.semibold}},small:{hasContent:{fontFamily:t.typography.families.primary,fontSize:O.font.size200,fontWeight:O.font.weight.regular}},large:{hasContent:{fontFamily:t.typography.families.secondary,fontSize:O.font.size400,fontWeight:O.font.weight.semibold}}}}});var pQ,mQ=f(()=>{"use strict";s();xi();Vc();pQ=function(t){return{borderWidth:O.stroke.width10,borderInnerWidth:O.stroke.width10,block:{width:"100%"},medium:{padding:O.size80-O.stroke.width10,iconSize:16,focused:{borderWidth:0,padding:O.size80},primary:!jt(t)&&{focused:{borderWidth:O.stroke.width20,padding:O.size80-O.stroke.width20},square:{focused:{borderWidth:O.stroke.width10,padding:O.size80-O.stroke.width10}}},hasContent:{minWidth:96,padding:O.size60-O.stroke.width10,paddingHorizontal:O.size120-O.stroke.width10,hasIconAfter:{spacingIconContentAfter:O.size80},hasIconBefore:{spacingIconContentBefore:O.size80},focused:{padding:O.size60,paddingHorizontal:O.size120},primary:!jt(t)&&{focused:{padding:O.size60-O.stroke.width20,paddingHorizontal:O.size120-O.stroke.width20},square:{focused:{padding:O.size60-O.stroke.width10,paddingHorizontal:O.size120-O.stroke.width10}}}}},small:{padding:O.size40-O.stroke.width10,iconSize:16,focused:{borderWidth:0,padding:O.size40},primary:!jt(t)&&{focused:{borderWidth:O.stroke.width20,padding:O.size40-O.stroke.width20},square:{focused:{borderWidth:O.stroke.width10,padding:O.size40-O.stroke.width10}}},hasContent:{minWidth:64,minHeight:24,paddingHorizontal:O.size80-O.stroke.width10,hasIconAfter:{spacingIconContentAfter:O.size40},hasIconBefore:{spacingIconContentBefore:O.size40},focused:{paddingHorizontal:O.size80},primary:!jt(t)&&{focused:{paddingHorizontal:O.size80-O.stroke.width20},square:{focused:{paddingHorizontal:O.size80-O.stroke.width10}}}}},large:{padding:O.size100-O.stroke.width10,iconSize:20,focused:{borderWidth:0,padding:O.size100},primary:!jt(t)&&{focused:{borderWidth:O.stroke.width20,padding:O.size100-O.stroke.width20},square:{focused:{borderWidth:O.stroke.width10,padding:O.size100-O.stroke.width10}}},hasContent:{minWidth:96,minHeight:40,padding:O.size80-O.stroke.width10,paddingHorizontal:O.size160-O.stroke.width10,hasIconAfter:{spacingIconContentAfter:O.size60},hasIconBefore:{spacingIconContentBefore:O.size60},focused:{padding:O.size80,paddingHorizontal:O.size160},primary:!jt(t)&&{focused:{padding:O.size80-O.stroke.width20,paddingHorizontal:O.size160-O.stroke.width20},square:{focused:{padding:O.size80-O.stroke.width10,paddingHorizontal:O.size160-O.stroke.width10}}}}},rounded:{borderRadius:O.corner.radius40,borderInnerRadius:O.corner.radius40-1},circular:{borderRadius:O.corner.radiusCircular,borderInnerRadius:O.corner.radiusCircular-1},square:{borderRadius:O.corner.radiusNone,borderInnerRadius:O.corner.radiusNone}}}});var bRt,Ks,nN,fPe,gQ,hQ,yQ,pPe,CQ=f(()=>{"use strict";s();bRt=S(re());Oe();dQ();_n();ZO();uQ();fQ();mQ();Ks=function(){return Ks=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ks.apply(this,arguments)},nN=function(e,t,r){if(r||arguments.length===2)for(var n=0,o=t.length,a;n<o;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},fPe=["block","small","medium","large","hasContent","hasIconAfter","hasIconBefore","primary","subtle","outline","rounded","circular","square","hovered","focused","pressed","disabled"],gQ={tokens:[pQ,lQ,cQ,Vv],states:fPe,slotProps:Ks(Ks({},!1),{root:ct(function(e,t){return{style:Ks(Ks({display:"flex",alignItems:"center",flexDirection:"row",alignSelf:"flex-start",justifyContent:"center",width:e.width,backgroundColor:e.backgroundColor},Ko.from(e,t)),ko.from(e,t)),android_ripple:{color:e.rippleColor}}},nN(nN(["backgroundColor","width","rippleColor"],Ko.keys,!0),ko.keys,!0)),content:ct(function(e,t){return{style:Ks({},pPe(e,t,e.color,e))}},nN(["color","spacingIconContentAfter","spacingIconContentBefore"],Zr.keys,!0)),icon:ct(function(e){return{color:e.iconColor,height:e.iconSize,width:e.iconSize}},["iconColor","iconSize"]),focusInnerBorder:ct(function(e){return{style:{position:"absolute",borderWidth:e.borderInnerWidth,borderColor:e.borderInnerColor,borderRadius:e.borderInnerRadius}}},["borderInnerWidth","borderInnerColor","borderInnerRadius"])})},hQ=function(){return"small"},yQ=function(t){var r=!0;switch(t){case"accent":return"primary";case"primary":case"subtle":case"outline":return t;default:return null}},pPe=function(t,r,n,o){var a=CP(),d=t.spacingIconContentBefore?{marginStart:a.marginStart+t.spacingIconContentBefore}:{},c=t.spacingIconContentAfter?{marginEnd:a.marginEnd+t.spacingIconContentAfter}:{};return Ks(Ks(Ks(Ks({color:n},CP()),d),c),Zr.from(o,r))}});var zd,FRt,Ys,mPe,vP,oN,vQ=f(()=>{"use strict";s();zd=S(L()),FRt=S(re());Oe();An();Vc();Ys=function(){return Ys=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ys.apply(this,arguments)},mPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},vP=!1,oN=function(t){var r=zd.useRef(null),n=t.accessible,o=t.accessibilityRole,a=t.componentRef,d=a===void 0?r:a,c=t.disabled,u=t.onBlur,l=t.onClick,p=t.onLayout,g=t.loading,h=t.enableFocusRing,v=t.focusable,y=mPe(t,["accessible","accessibilityRole","componentRef","disabled","onBlur","onClick","onLayout","loading","enableFocusRing","focusable"]),T=!!c||!!g,b=T?null:d,I=ns(b,l),E=zd.useCallback(function(ie){vP=!1,u==null||u(ie)},[u]),P=Vd(Ys(Ys({},y),{onPress:I,onBlur:E})),_=zd.useCallback(function(ie){!c&&(ie.nativeEvent.key==="Enter"||ie.nativeEvent.key===" ")&&(vP=!0)},[c]),D=zd.useCallback(function(ie){vP&&(l==null||l(ie),vP=!1)},[l]),M=Qo(D," ","Enter"),H=t.accessibilityActions&&!!t.accessibilityActions.find(function(ie){return ie.name==="Toggle"}),U=fa(),F=t.appearance==="primary"&&!jt(U),z=zd.useState(void 0),Y=z[0],B=z[1],q=zd.useState(void 0),K=q[0],$=q[1],oe=zd.useCallback(function(ie){F&&(B(ie.nativeEvent.layout.height),$(ie.nativeEvent.layout.width)),p&&p(ie)},[p,B,$,F]);return{props:Ys(Ys(Ys(Ys(Ys({},M),{onKeyDown:_}),P.props),T!==void 0&&{disabled:T}),{accessible:n??!0,accessibilityRole:o||"button",onAccessibilityTap:t.onAccessibilityTap||(H?void 0:t.onClick),accessibilityLabel:t.accessibilityLabel,enableFocusRing:h??!F,focusable:v??!T,ref:Ar(d),iconPosition:t.iconPosition||"before",loading:g,onLayout:oe}),state:Ys(Ys({},P.state),{pressed:P.state.pressed,measuredWidth:K,measuredHeight:Y,shouldUseTwoToneFocusBorder:F})}}});var zv,xP,ip,gPe,hPe,ap,yPe,CPe,xQ=f(()=>{"use strict";s();zv=S(L()),xP=S(re());aQ();Oe();op();pa();CQ();ZO();vQ();ip=function(){return ip=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ip.apply(this,arguments)},gPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},hPe=function(t,r,n){return r[t]||n[t]||t===yQ(n.appearance)||t===n.size||!n.size&&t===hQ()||t===n.shape||!n.shape&&t==="rounded"||t==="hovered"&&r[t]&&!n.loading||t==="hasContent"&&!n.iconOnly||t==="hasIconAfter"&&(n.icon||n.loading)&&n.iconPosition==="after"||t==="hasIconBefore"&&(n.icon||n.loading)&&(!n.iconPosition||n.iconPosition==="before")},ap=en(ip(ip({displayName:Vv},gQ),{slots:{root:xP.Pressable,rippleContainer:!1,focusInnerBorder:xP.View,icon:Il,content:br},useRender:function(t,r){var n=oN(t),o=El(t.icon),a=r(t,function(d){return hPe(d,n.state,t)});return function(d){for(var c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var l=dt(n.props,d),p=l.icon,g=l.iconOnly,h=l.iconPosition,v=l.loading,y=l.accessibilityLabel,T=gPe(l,["icon","iconOnly","iconPosition","loading","accessibilityLabel"]),b=!v&&p,I="";y===void 0&&zv.Children.forEach(c,function(D){typeof D=="string"&&(I=D)});var E=y??I,P=we(zv.Fragment,null,v&&we(Wv,null),b&&h==="before"&&we(a.icon,ip({},o,{accessible:!1})),zv.Children.map(c,function(D){return typeof D=="string"?we(a.content,{accessible:!1,key:"content"},D):D}),b&&h==="after"&&we(a.icon,ip({},o,{accessible:!1}))),_=!1;return we(a.root,ip({},T,{accessibilityLabel:E}),P,n.state.focused&&!!n.state.measuredHeight&&!!n.state.measuredWidth&&n.state.shouldUseTwoToneFocusBorder&&we(a.focusInnerBorder,{style:CPe(n.state.measuredHeight,n.state.measuredWidth),accessible:!1,focusable:!1}))}}})),yPe=function(t,r){var n=2;return{height:t-n,width:r-n}},CPe=Qt(yPe)});var iN=f(()=>{"use strict";s();xQ()});var Zg,TP=f(()=>{"use strict";s();Zg="Callout"});var TQ,bQ=f(()=>{"use strict";s();TP();TQ=[{tokens:{backgroundColor:"bodyStandoutBackground",beakWidth:20,borderColor:"bodyFrameBackground",borderWidth:1,directionalHint:"bottonLeftEdge",gapSpace:0,minPadding:0}},Zg]});var qv=be((oAt,Gv)=>{s();function vPe(e){return e&&e.__esModule?e:{default:e}}Gv.exports=vPe,Gv.exports.__esModule=!0,Gv.exports.default=Gv.exports});var Kv=be((aAt,SQ)=>{s();SQ.exports=OfficePlatformGlobal.ReactNative.codegenNativeComponent});var Yv=be((dAt,IQ)=>{s();IQ.exports=OfficePlatformGlobal.ReactNative.NativeComponentRegistry});var aN=be((uAt,EQ)=>{s();EQ.exports=OfficePlatformGlobal.ReactNative.ViewConfigIgnore});var PQ=be(eh=>{s();var xPe=qv();Object.defineProperty(eh,"__esModule",{value:!0});eh.default=eh.__INTERNAL_VIEW_CONFIG=void 0;var fAt=xPe(Kv()),TPe=Yv(),bPe=aN(),SPe=bPe.ConditionallyIgnoredEventHandlers,IPe="RCTCallout",EPe=eh.__INTERNAL_VIEW_CONFIG={uiViewClassName:"RCTCallout",directEventTypes:{topRestoreFocus:{registrationName:"onRestoreFocus"},topDismiss:{registrationName:"onDismiss"},topShow:{registrationName:"onShow"}},validAttributes:Object.assign({accessibilityLabel:!0,accessibilityOnShowAnnouncement:!0,anchorRect:!0,directionalHint:!0,dismissBehaviors:!0,doNotTakePointerCapture:!0,focusable:!0,isBeakVisible:!0,maxHeight:!0,maxWidth:!0,setInitialFocus:!0,target:!0,testID:!0},SPe({onRestoreFocus:!0,onDismiss:!0,onShow:!0}))},pAt=eh.default=TPe.get(IPe,function(){return EPe})});var _Q=be(th=>{s();var PPe=qv();Object.defineProperty(th,"__esModule",{value:!0});th.default=th.__INTERNAL_VIEW_CONFIG=void 0;var hAt=PPe(Kv()),_Pe=Yv(),RPe=aN(),APe=RPe.ConditionallyIgnoredEventHandlers,kPe="FRNCallout",DPe=th.__INTERNAL_VIEW_CONFIG={uiViewClassName:"FRNCallout",directEventTypes:{topRestoreFocus:{registrationName:"onRestoreFocus"},topDismiss:{registrationName:"onDismiss"},topShow:{registrationName:"onShow"}},validAttributes:Object.assign({accessibilityLabel:!0,accessibilityOnShowAnnouncement:!0,anchorRect:!0,directionalHint:!0,dismissBehaviors:!0,doNotTakePointerCapture:!0,focusable:!0,isBeakVisible:!0,maxHeight:!0,maxWidth:!0,setInitialFocus:!0,target:!0,testID:!0},APe({onRestoreFocus:!0,onDismiss:!0,onShow:!0}))},yAt=th.default=_Pe.get(kPe,function(){return DPe})});var SP,RQ,AQ,_At,bP,wPe,FPe,zi,kQ=f(()=>{"use strict";s();SP=S(L()),RQ=S(re());An();_n();is();Co();bQ();TP();AQ=S(PQ()),_At=S(_Q()),bP=function(){return bP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bP.apply(this,arguments)},wPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},FPe=AQ.default,zi=Br({displayName:Zg,usePrepareProps:function(t,r){var n=t.componentRef,o=t.target,a=wPe(t,["componentRef","target"]),d=Ar(n),c=SP.useState(null),u=c[0],l=c[1];SP.useLayoutEffect(function(){typeof o=="string"?l(o):o!=null&&o.current?l((0,RQ.findNodeHandle)(o.current)):l(null)},[o]);var p=Dt(r(t),{root:bP(bP({ref:d},u&&{target:u}),a)});return{slotProps:p}},settings:TQ,slots:{root:FPe},styles:{root:[mo,Gn]}})});var $v=f(()=>{"use strict";s();TP();kQ()});var Qv,sN=f(()=>{"use strict";s();Qv="Checkbox"});var DQ,wQ,FQ=f(()=>{"use strict";s();sN();DQ="Toggle the Checkbox",wQ=[{tokens:{borderColor:"menuItemText",color:"menuItemText",backgroundColor:"menuBackground",textBorderColor:"transparent"},root:{style:{display:"flex",alignItems:"center",flexDirection:"row",minHeight:14,marginTop:0,position:"relative"}},checkbox:{style:{borderStyle:"solid",borderWidth:1,minHeight:14,minWidth:14,marginEnd:4}},checkmark:{style:{aspectRatio:1,position:"relative",opacity:0,fontSize:10,textAlign:"center",textAlignVertical:"center",top:-1}},content:{variant:"bodyStandard",style:{borderStyle:"solid",borderWidth:2,marginTop:3}},_precedence:["disabled","boxAtEnd","hovered","focused","pressed","checked"],_overrides:{focused:{tokens:{backgroundColor:"menuItemBackgroundHovered",textBorderColor:"focusBorder",checkmarkColor:"menuItemTextHovered"}},checked:{checkmark:{style:{opacity:1}}},hovered:{tokens:{backgroundColor:"menuItemBackgroundHovered",checkmarkColor:"menuItemTextHovered"}},disabled:{tokens:{borderColor:"buttonBorderDisabled",color:"disabledBodyText",backgroundColor:"background"}},boxAtEnd:{checkbox:{style:{marginStart:4,marginEnd:0}}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed"}}}},Qv]});var IP,dN,Pl,OPe,rh,OQ=f(()=>{"use strict";s();IP=S(L()),dN=S(re());Nv();An();pa();_n();_n();Wi();is();Co();FQ();sN();Pl=function(){return Pl=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Pl.apply(this,arguments)},OPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},rh=Br({displayName:Qv,usePrepareProps:function(t,r){var n=IP.useRef(null),o=t.accessible,a=t.accessibilityLabel,d=t.accessibilityRole,c=t.ariaLabel,u=t.checked,l=t.defaultChecked,p=t.boxSide,g=t.label,h=t.onChange,v=t.componentRef,y=v===void 0?n:v,T=t.focusable,b=OPe(t,["accessible","accessibilityLabel","accessibilityRole","ariaLabel","checked","defaultChecked","boxSide","label","onChange","componentRef","focusable"]);l!=null&&u!=null&&console.warn("defaultChecked and checked are mutually exclusive to one another. Use one or the other.");var I=oP(l,u,h),E=I[0],P=I[1],_=ns(y,P),D=ji(Pl({onPress:_},b)),M=Ar(y),H=Qo(P," "),U=Pl(Pl({},D.state),{disabled:!!t.disabled,checked:E,boxAtEnd:!(p==null||p=="start")}),F=r(t,function(B){return U[B]||t[B]}),z=IP.useCallback(function(B){switch(B.nativeEvent.actionName){case"Toggle":P();break}},[P,t,U,D.props]),Y=Dt(F,{root:Pl(Pl(Pl({rest:b,ref:M},D.props),{accessible:o??!0,accessibilityRole:d??"checkbox",accessibilityLabel:a??g,accessibilityState:{disabled:U.disabled,checked:U.checked},accessibilityActions:[{name:"Toggle",label:DQ}],focusable:T??!U.disabled,onAccessibilityAction:z,enableFocusRing:!1}),H),checkmark:{children:"\u2713"},content:{children:g}});return{slotProps:Y,state:U}},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Pe(t.root,null,(r==null?void 0:r.state.boxAtEnd)&&Pe(t.content,null),Pe(t.checkbox,null,Pe(t.checkmark,null)),!(r!=null&&r.state.boxAtEnd)&&Pe(t.content,null),n)},settings:wQ,slots:{root:dN.View,checkbox:{slotType:dN.View,filter:Ud},checkmark:Sr,content:Sr},styles:{root:[],checkbox:[mo,Gn,[{source:"checkboxBackgroundColor",lookup:qo,target:"backgroundColor"},{source:"checkboxBorderColor",lookup:qo,target:"borderColor"}]],checkmark:[po,[{source:"checkmarkColor",lookup:qo,target:"color"},{source:"checkmarkVisibility",target:"opacity"}]],content:[po,Za,[{source:"textBorderColor",lookup:qo,target:"borderColor"}]]}})});var NQ=f(()=>{"use strict";s();OQ()});var nh,EP=f(()=>{"use strict";s();nh="ContextualMenu"});var MQ=f(()=>{"use strict";s()});var LQ=be(oh=>{s();var NPe=qv();Object.defineProperty(oh,"__esModule",{value:!0});oh.default=oh.__INTERNAL_VIEW_CONFIG=void 0;var ikt=NPe(Kv()),MPe=Yv(),LPe="RCTFocusZone",HPe=oh.__INTERNAL_VIEW_CONFIG={uiViewClassName:"RCTFocusZone",validAttributes:{navigateAtEnd:!0,defaultTabbableElement:!0,focusZoneDirection:!0,use2DNavigation:!0,tabKeyNavigation:!0,disabled:!0,isTabNavigation:!0}},akt=oh.default=MPe.get(LPe,function(){return HPe})});var _P,HQ,BQ,PP,BPe,UPe,as,UQ=f(()=>{"use strict";s();_P=S(L()),HQ=S(re());An();Wi();Co();BQ=S(LQ()),PP=function(){return PP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},PP.apply(this,arguments)},BPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},UPe=function(t){return t!=="componentRef"},as=qc({usePrepareProps:function(t,r){var n=t.componentRef,o=t.defaultTabbableElement,a=t.isCircularNavigation,d=BPe(t,["componentRef","defaultTabbableElement","isCircularNavigation"]),c=Ar(n),u=_P.useState(void 0),l=u[0],p=u[1];return _P.useLayoutEffect(function(){o!=null&&o.current?p((0,HQ.findNodeHandle)(o.current)):p(void 0)},[o]),{slotProps:Dt(r(t),{root:PP(PP({navigateAtEnd:a?"NavigateWrap":"NavigateStopAtEnds"},d),{defaultTabbableElement:l,ref:c})})}},slots:{root:{slotType:BQ.default,filter:UPe}}})});var sp=f(()=>{"use strict";s();MQ();UQ()});var VQ,jQ=f(()=>{"use strict";s();EP();VQ=[{tokens:{backgroundColor:"menuBackground",beakWidth:20,borderColor:"buttonBorder",borderWidth:1,directionalHint:"bottonLeftEdge",gapSpace:0,minPadding:0},container:{style:{padding:1,minWidth:180,flex:1}}},nh]});var $s,RP,cN,jPe,Gd,AP,Xv=f(()=>{"use strict";s();$s=S(L()),RP=S(re());$v();sp();An();_n();Wi();is();Co();jQ();EP();cN=function(){return cN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},cN.apply(this,arguments)},jPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},Gd=$s.createContext({selectedKey:null,onItemClick:function(){},onDismissMenu:function(){}}),AP=Br({displayName:nh,usePrepareProps:function(t,r){var n=t.setShowMenu,o=t.maxHeight,a=t.maxWidth,d=t.shouldFocusOnMount,c=d===void 0?!0:d,u=t.shouldFocusOnContainer,l=u===void 0?!1:u,p=jPe(t,["setShowMenu","maxHeight","maxWidth","shouldFocusOnMount","shouldFocusOnContainer"]),g=$s.useRef(null);$s.useLayoutEffect(function(){},[c]);var h=Sl(null,t.onItemClick),v=$s.useCallback(function(){t.onDismiss(),n==null||n(!1)},[n,t.onDismiss]),y=$s.useState(!0),T=y[0],b=y[1],I=$s.useCallback(function(){b(!1)},[b]),E={context:{selectedKey:h.selectedKey,onItemClick:h.onKeySelect,onDismissMenu:v}},P=r(t,function(D){return E[D]||t[D]}),_=Dt(P,{root:cN({accessibilityRole:"menu",setInitialFocus:c},p),container:{accessible:l,focusable:l&&T,onBlur:I,style:{maxHeight:o,maxWidth:a}},scrollView:{contentContainerStyle:{flexDirection:"column",flexGrow:1},showsVerticalScrollIndicator:o!=null,showsHorizontalScrollIndicator:a!=null},focusZone:{enableFocusRing:!1,componentRef:g,defaultTabbableElement:g,focusZoneDirection:"vertical"}});return{slotProps:_,state:E}},settings:VQ,slots:{root:zi,container:RP.View,scrollView:RP.ScrollView,focusZone:as},styles:{root:[mo,Gn],container:[]},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return r.state==null?null:Pe(Gd.Provider,{value:r.state.context},Pe(t.root,null,Pe(t.container,null,Pe(t.scrollView,null,n))))}})});var ih,kP=f(()=>{"use strict";s();ih="ContextualMenuItem"});var WQ,zQ=f(()=>{"use strict";s();kP();WQ=[{tokens:{backgroundColor:"menuBackground",color:"menuItemText",borderColor:"transparent",borderWidth:2},root:{style:{display:"flex",alignItems:"flex-start",flexDirection:"row",alignSelf:"flex-start",width:"100%"}},icon:{style:{marginEnd:5}},stack:{style:{display:"flex",paddingStart:7,paddingEnd:7,alignItems:"center",flexDirection:"row",alignSelf:"flex-start",minHeight:32,minWidth:80,justifyContent:"flex-start"}},_precedence:["focused","hovered","pressed","disabled"],_overrides:{disabled:{tokens:{backgroundColor:"menuBackground",color:"disabledText"}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed",color:"menuItemTextHovered"}},hovered:{tokens:{color:"menuItemTextHovered",backgroundColor:"menuItemBackgroundHovered"}},focused:{tokens:{color:"menuItemTextHovered",backgroundColor:"menuItemBackgroundHovered",borderColor:"focusBorder"},_overrides:{hovered:{tokens:{borderColor:"transparent"}}}}}},ih]});var _l,uN,ma,GQ,Jv,qQ=f(()=>{"use strict";s();_l=S(L()),uN=S(re());op();An();pa();_n();Wi();is();Co();Xv();zQ();kP();ma=function(){return ma=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ma.apply(this,arguments)},GQ=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},Jv=Br({displayName:ih,usePrepareProps:function(t,r){var n,o=_l.useRef(null),a=t.disabled,d=t.itemKey,c=t.icon,u=t.text,l=t.accessibilityLabel,p=l===void 0?t.text:l,g=t.onAccessibilityTap,h=t.onClick,v=t.testID,y=t.componentRef,T=y===void 0?o:y,b=GQ(t,["disabled","itemKey","icon","text","accessibilityLabel","onAccessibilityTap","onClick","testID","componentRef"]),I=_l.useContext(Gd),E=_l.useCallback(function(ie){a||(I==null||I.onDismissMenu(),h&&h(),I!=null&&I.onItemClick&&I.onItemClick(d),ie.stopPropagation())},[I,a,d,h]),P=Ar(T),_=_l.useCallback(function(){a||(T.current.focus(),I!=null&&I.isSubmenuOpen&&I!=null&&I.dismissSubmenu&&I.dismissSubmenu())},[T,a,I]),D=ji(ma(ma({},b),{onPress:E,onHoverIn:_})),M=Qo(E," ","Enter"),H=ma(ma({},D.state),{selected:I.selectedKey===t.itemKey,disabled:t.disabled,content:!!u,icon:!!c}),U=D.props,F=U.onBlur,z=U.onMouseLeave,Y=GQ(U,["onBlur","onMouseLeave"]),B=_l.useCallback(function(ie){F(ie),z&&z(ie)},[F,z]),q=ma({onBlur:F,onMouseLeave:B},Y),K=g??E,$=r(t,function(ie){return H[ie]||t[ie]}),oe=Dt($,{root:ma(ma(ma(ma({ref:P},q),M),{accessible:!0,accessibilityLabel:p,accessibilityRole:"menuitem",accessibilityState:{disabled:(n=H.disabled)!==null&&n!==void 0?n:!1,selected:H.selected},accessibilityValue:{text:d},onAccessibilityTap:K,disabled:a,focusable:!a,testID:v}),b),content:{accessible:!1,children:u},icon:ma(ma({},El(c)),{accessible:!1})});return{slotProps:oe,state:H}},settings:WQ,render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Pe(t.root,null,Pe(t.stack,null,r.state.icon&&Pe(t.icon,null),r.state.content&&Pe(t.content,null),n))},slots:{root:uN.View,stack:{slotType:uN.View},icon:{slotType:Il},content:Sr},styles:{root:[mo,Gn],stack:[],icon:[{source:"iconColor",lookup:qo,target:"color"}],content:[Za,po]}})});var ah,DP=f(()=>{"use strict";s();ah="Submenu"});var KQ,YQ=f(()=>{"use strict";s();DP();KQ=[{tokens:{backgroundColor:"menuBackground",beakWidth:20,borderColor:"buttonBorder",borderWidth:1,gapSpace:0,minPadding:0},root:{accessibilityRole:"menu",directionalHint:"rightTopEdge"},container:{style:{padding:1,minWidth:180,flex:1}}},ah]});var Gi,dh,sh,WPe,wP,$Q=f(()=>{"use strict";s();Gi=S(L()),dh=S(re());$v();sp();An();_n();Wi();is();Co();Xv();YQ();DP();sh=function(){return sh=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},sh.apply(this,arguments)},WPe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},wP=Br({displayName:ah,usePrepareProps:function(t,r){var n=t.setShowMenu,o=t.maxWidth,a=t.maxHeight,d=t.shouldFocusOnMount,c=d===void 0?!0:d,u=t.shouldFocusOnContainer,l=u===void 0?!0:u,p=WPe(t,["setShowMenu","maxWidth","maxHeight","shouldFocusOnMount","shouldFocusOnContainer"]),g=Gi.useRef(null);Gi.useLayoutEffect(function(){},[]);var h=Gi.useContext(Gd),v=Sl(null,t.onItemClick),y=Gi.useCallback(function(){t!=null&&t.onShow&&t.onShow(),h.isSubmenuOpen=!0},[h]),T=Gi.useCallback(function(){t==null||t.onDismiss(),n(!1),h.isSubmenuOpen=!1},[h,n]),b=Gi.useCallback(function(){T(),h==null||h.onDismissMenu()},[T,h]);h.dismissSubmenu=T;var I=Gi.useState(!0),E=I[0],P=I[1],_=Gi.useCallback(function(){P(!1)},[P]),D={context:{selectedKey:v.selectedKey,onItemClick:v.onKeySelect,onDismissMenu:b}},M=r(t,function(z){return D[z]||t[z]}),H=Gi.useCallback(function(z){var Y=dh.I18nManager.isRTL?"ArrowRight":"ArrowLeft";z.nativeEvent.key===Y&&T()},[T]),U=jd(H,"ArrowLeft","ArrowRight"),F=Dt(M,{root:sh(sh({},p),{onShow:y,onDismiss:T,setInitialFocus:c}),container:sh(sh({},U),{accessible:l,focusable:l&&E,onBlur:_,style:{maxHeight:a,maxWidth:o}}),scrollView:{contentContainerStyle:{flexDirection:"column",flexGrow:1},showsVerticalScrollIndicator:a!=null,showsHorizontalScrollIndicator:o!=null},focusZone:{componentRef:g,focusZoneDirection:"vertical"}});return{slotProps:F,state:D}},settings:KQ,slots:{root:zi,container:dh.View,scrollView:dh.ScrollView,focusZone:as},styles:{root:[mo,Gn],container:[]},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return r.state==null?null:Pe(Gd.Provider,{value:r.state.context},Pe(t.root,null,Pe(t.container,null,Pe(t.scrollView,null,n))))}})});var ch,FP=f(()=>{"use strict";s();ch="SubmenuItem"});var QQ,XQ=f(()=>{"use strict";s();FP();QQ=[{tokens:{backgroundColor:"menuBackground",color:"menuItemText",borderColor:"transparent",borderWidth:2},root:{style:{display:"flex",flex:1,flexDirection:"row",alignSelf:"flex-start",width:"100%",justifyContent:"space-between"}},icon:{style:{marginEnd:5,color:"menuIcon"}},startstack:{style:{display:"flex",flexGrow:1,paddingStart:5,alignItems:"center",flexDirection:"row",alignSelf:"flex-start",minHeight:32,justifyContent:"flex-start"}},endstack:{style:{display:"flex",paddingEnd:5,alignItems:"center",flexDirection:"row",minHeight:32,width:12,justifyContent:"flex-end"}},_precedence:["focused","hovered","pressed","disabled"],_overrides:{disabled:{tokens:{backgroundColor:"menuBackground",color:"disabledText"}},pressed:{tokens:{backgroundColor:"menuItemBackgroundPressed",color:"menuItemTextHovered"}},focused:{tokens:{color:"menuItemTextHovered",backgroundColor:"menuItemBackgroundHovered",borderColor:"focusBorder"},_overrides:{hovered:{tokens:{borderColor:"transparent"}}}}}},ch]});var Qs,dp,uh,Ti,JQ,OP,ZQ=f(()=>{"use strict";s();Qs=S(L()),dp=S(re());op();An();pa();_n();Wi();is();Co();uh=S(tp());Xv();XQ();FP();Ti=function(){return Ti=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ti.apply(this,arguments)},JQ=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},OP=Br({displayName:ch,usePrepareProps:function(t,r){var n,o=Qs.useRef(null),a=t.disabled,d=t.itemKey,c=t.icon,u=t.text,l=t.accessibilityLabel,p=l===void 0?t.text:l,g=t.onAccessibilityTap,h=t.onClick,v=t.componentRef,y=v===void 0?o:v,T=JQ(t,["disabled","itemKey","icon","text","accessibilityLabel","onAccessibilityTap","onClick","componentRef"]),b=Qs.useContext(Gd),I=Ar(y),E=Qs.useCallback(function(ot){y.current.focus(),t.onHoverIn&&t.onHoverIn(ot)},[]),P=500,_=Qs.useCallback(function(ot){b!=null&&b.dismissSubmenu&&b.dismissSubmenu(),t.onHoverOut&&t.onHoverOut(ot)},[]),D=Qs.useCallback(function(){a||(h&&h(),b!=null&&b.onItemClick&&b.onItemClick(d))},[b,a,d,h]),M=ji(Ti(Ti({},T),{onPress:D,onHoverIn:E,delayHoverIn:P,onHoverOut:_})),H=M.props,U=H.onBlur,F=H.onMouseEnter,z=H.onMouseLeave,Y=JQ(H,["onBlur","onMouseEnter","onMouseLeave"]),B=Qs.useCallback(function(ot){y.current.focus(),F&&F(ot)},[y,F]),q=Qs.useCallback(function(ot){U(ot),z&&z(ot)},[U,z]),K=Ti({onBlur:U,onMouseEnter:B,onMouseLeave:q},Y),$=Ti(Ti({},M.state),{selected:b.selectedKey===t.itemKey,disabled:t.disabled,content:!!u,icon:!!c}),oe=Qs.useCallback(function(ot){var Ue=dp.I18nManager.isRTL?"ArrowLeft":"ArrowRight";(ot.nativeEvent.key===Ue||ot.nativeEvent.key===" "||ot.nativeEvent.key==="Enter")&&E(ot)},[E]),ie=function(Ue){return Pe(uh.Svg,{width:Ue.width,height:Ue.height,viewBox:"0 0 2048 2048",color:Ue.color},Pe(uh.G,{transform:dp.I18nManager.isRTL?"translate(2048, 0) scale(-1, 1)":""},Pe(uh.Path,{fill:"currentColor",d:"M 743 1767 l -121 -121 l 708 -707 l -708 -708 l 121 -121 l 828 829 z"})))},Ce={src:ie},se=jd(oe," ","Enter","ArrowLeft","ArrowRight"),he=g??D,Be=r(t,function(ot){return $[ot]||t[ot]}),_e=Dt(Be,{root:Ti(Ti(Ti(Ti({ref:I},K),se),{accessible:!0,accessibilityLabel:p,accessibilityRole:"menuitem",accessibilityState:{disabled:(n=$.disabled)!==null&&n!==void 0?n:!1,selected:$.selected},accessibilityValue:{text:d},disabled:a,focusable:!a,onAccessibilityTap:he}),T),content:{accessible:!1,children:u},icon:Ti(Ti({},El(c)),{accessible:!1}),chevron:Ti(Ti({},El({svgSource:Ce,width:12,height:12})),{accessible:!1})});return{slotProps:_e,state:$}},settings:QQ,render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return Pe(t.root,null,Pe(t.startstack,null,r.state.icon&&Pe(t.icon,null),r.state.content&&Pe(t.content,null),n),Pe(t.endstack,null,Pe(t.chevron,null)))},slots:{root:dp.View,startstack:dp.View,icon:Il,content:Sr,endstack:dp.View,chevron:Il},styles:{root:[mo,Gn],startstack:[],icon:[{source:"iconColor",lookup:qo,target:"color"}],content:[Za,po],endstack:[],chevron:[{source:"chevronColor",lookup:qo,target:"color"}]}})});var lN=f(()=>{"use strict";s();EP();Xv();kP();qQ();DP();$Q();FP();ZQ()});var eX=be(lh=>{s();var zPe=qv();Object.defineProperty(lh,"__esModule",{value:!0});lh.default=lh.__INTERNAL_VIEW_CONFIG=void 0;var jDt=zPe(Kv()),GPe=Yv(),qPe="RCTFocusTrapZone",KPe=lh.__INTERNAL_VIEW_CONFIG={uiViewClassName:"RCTFocusTrapZone",validAttributes:{disabled:!0,disableFirstFocus:!0,focusPreviouslyFocusedInnerElement:!0,ignoreExternalFocusing:!0,forceFocusInsideTrap:!0}},WDt=lh.default=GPe.get(qPe,function(){return KPe})});function fN(e){return e!=="componentRef"}var tX,NP,rX,nX=f(()=>{"use strict";s();An();Wi();Co();tX=S(eX()),NP=function(){return NP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},NP.apply(this,arguments)};rX=qc({usePrepareProps:function(t,r){var n=Ar(t.componentRef);return{slotProps:Dt(r(t),{root:NP(NP({},t),{ref:n})})}},slots:{root:{slotType:tX.default,filter:fN}}})});var oX=f(()=>{"use strict";s();nX()});var fh,MP=f(()=>{"use strict";s();fh="Link"});var LP,pN=f(()=>{"use strict";s();LP=function(t){return{color:t.colors.brandForegroundLink,alignSelf:"flex-start",variant:"body1",textDecorationLine:"underline",disabled:{color:t.colors.neutralForegroundDisabled,textDecorationLine:"none",focused:{borderColor:t.colors.strokeFocus2}},hovered:{color:t.colors.brandForegroundLinkHover},pressed:{color:t.colors.brandForegroundLinkPressed},visited:{color:t.colors.brandForegroundLink},focused:{color:t.colors.brandForegroundLink,borderColor:t.colors.strokeFocus2},subtle:{color:t.colors.neutralForeground2,hovered:{color:t.colors.neutralForeground2Hover},pressed:{color:t.colors.neutralForeground2Pressed},visited:{color:t.colors.neutralForeground2},focused:{color:t.colors.neutralForeground2,borderColor:t.colors.strokeFocus2}},brand:{color:t.colors.neutralForegroundInvertedLink,hovered:{color:t.colors.neutralForegroundInvertedLinkHover},pressed:{color:t.colors.neutralForegroundInvertedLinkPressed},visited:{color:t.colors.neutralForegroundInvertedLink},focused:{color:t.colors.neutralForegroundInvertedLink,borderColor:t.colors.strokeFocus2}}}}});var mN,HP,gN=f(()=>{"use strict";s();k();Oe();_n();MP();pN();mN=["inline","subtle","hovered","focused","pressed","disabled"],HP={tokens:[LP,fh],states:mN,slotProps:{root:ct(function(e){return{style:{alignSelf:e.alignSelf}}},["alignSelf"]),content:ct(function(e,t){return{style:m(m({alignSelf:e.alignSelf,textDecorationLine:e.textDecorationLine,color:e.color,fontStyle:e.fontStyle,textAlign:e.textAlign,variant:e.variant},Zr.from(e,t)),Ko.from(e,t))}},w(w(["alignSelf","color","textDecorationLine","textAlign"],Zr.keys,!0),Ko.keys,!0))}}});var cp,iX,YPe,BP,hN=f(()=>{"use strict";s();k();cp=S(L()),iX=S(re());An();YPe={},BP=function(t){var r,n=cp.useRef(null),o=t.accessible,a=o===void 0?!0:o,d=t.accessibilityRole,c=t.onKeyUp,u=t.onKeyDown,l=t.keyUpEvents,p=t.keyDownEvents,g=t.onPress,h=t.onAccessibilityTap,v=t.tooltip,y=t.url,T=t.accessibilityState,b=t.componentRef,I=b===void 0?n:b,E=t.disabled,P=t.enableFocusRing,_=t.focusable,D=_===void 0?!0:_,M=Ke(t,["accessible","accessibilityRole","onKeyUp","onKeyDown","keyUpEvents","keyDownEvents","onPress","onAccessibilityTap","tooltip","url","accessibilityState","componentRef","disabled","enableFocusRing","focusable"]),H=!!E,U=cp.useState(!1),F=U[0],z=U[1],Y=cp.useCallback(function(Be){z(!0),y?iX.Linking.openURL(y):g&&g(Be),Be.stopPropagation()},[z,y,g]),B=H||!D?null:I,q=ns(B,Y),K=ji(m(m({},M),{disabled:H,onPress:q})),$=Qo(Y," ","Enter"),oe=m(m({},K.state),{visited:F}),ie=cp.useCallback(function(Be){h?h():Y(Be)},[Y,h]),Ce=(r=v??y)!==null&&r!==void 0?r:void 0,se=t.inline,he=!1;return se&&(se=!1),{props:m(m(m(m(m(m({},M),$),K.props),{onAccessibilityTap:ie}),YPe),{accessible:a,accessibilityRole:"link",accessibilityState:iP(H,T),enableFocusRing:P??!0,focusable:D&&!H,cursor:H?"not-allowed":"pointer",ref:Ar(I),tooltip:Ce,inline:se}),state:oe}}});var aX,yN,sX,dX=f(()=>{"use strict";s();k();aX=S(re());Oe();pa();gN();MP();hN();yN=function(t,r,n){return r[t]||n[t]||t===n.appearance},sX=en(m(m({displayName:fh},HP),{slots:{root:aX.View,content:br},useRender:function(t,r){var n=BP(t),o=r(t,function(a){return yN(a,n.state,t)});return function(a){for(var d=[],c=1;c<arguments.length;c++)d[c-1]=arguments[c];var u=dt(n.props,a),l=u.inline,p=Ke(u,["inline"]),g=!0;return l||p.selectable?we(o.content,m({},p),d):we(o.root,m({},p),we(o.content,{focusable:!1},d))}}}))});var ph,UP=f(()=>{"use strict";s();ph="RNFLink"});var cX,uX=f(()=>{"use strict";s();k();UP();cX=[{tokens:{variant:"secondaryStandard",color:"link",borderColor:"transparent",borderStyle:"solid",borderWidth:2,borderRadius:4,textDecorationLine:"underline"},root:m(m({accessible:!0,focusable:!0},{cursor:"pointer"}),{accessibilityRole:"link",style:{display:"flex",alignItems:"flex-start"}}),content:{style:{textDecorationLine:"underline",textAlign:"center"}},_precedence:["visited","hovered","focused","pressed","disabled"],_overrides:{disabled:{tokens:{color:"link"}},hovered:{tokens:{color:"linkHovered"}},pressed:{tokens:{color:"linkPressed"}},visited:{tokens:{color:"link"}},focused:{tokens:{borderColor:"focusBorder"}}}},ph]});function CN(e,t){var r=e.url,n=e.onPress,o=Ke(e,["url","onPress"]),a=mh.useState({visited:!1}),d=a[0],c=a[1],u=mh.useCallback(function(y){c({visited:!0}),r?VP.Linking.openURL(r):n&&n(y)},[c,r,n]),l=ns(t,u),p=ji(m({onPress:l},o)),g=Qo(u," ","Enter"),h=m(m({},p.state),d),v=m(m(m({},e),p.props),g);return[v,h]}var mh,VP,lX,fX=f(()=>{"use strict";s();k();mh=S(L()),VP=S(re());An();pa();_n();Wi();is();Co();uX();UP();lX=Br({displayName:ph,settings:cX,usePrepareProps:function(t,r){var n=mh.useRef(null),o=t.content,a=t.onAccessibilityTap,d=t.componentRef,c=d===void 0?n:d,u=Ke(t,["content","onAccessibilityTap","componentRef"]),l=CN(u,c),p=l[0],g=l[1],h=a||p.onPress,v={content:!!o},y=Ar(c),T=r(t,function(I){return g[I]||t[I]}),b=Dt(T,{root:m(m({},p),{ref:y,onAccessibilityTap:h}),content:{children:o}});return{slotProps:b,state:m(m({},g),v)}},render:function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=r.state&&r.state.content;return n.length&&n.length===1&&n[0]!==void 0?Pe(t.root,null,a&&Pe(t.content,null),n):Pe(t.root,null,a&&Pe(t.content,null))},slots:{root:VP.View,content:Sr},styles:{root:[],content:[po,Za,Gn]}})});var pX=f(()=>{"use strict";s();MP();pN();gN();hN();dX();UP();fX()});function hX(e,t){return t?$Pe[e]:gX[e]}function yX(e){return QPe[e]}function jP(e){return XPe[e]}function ga(e){var t=e.size,r=e.coinSize,n=e.iconSize,o=e.iconStrokeWidth,a=e.initialsSize;if(t)return mX[t];var d=mX.size40,c=d.physicalSize,u=d.iconSize,l=d.iconStrokeWidth,p=d.initialsSize;return{physicalSize:r||c,iconSize:n||u,iconStrokeWidth:o||l,initialsSize:a||p}}function up(e){switch(e){case"xSmall":return 1;case"small":return 1;case"medium":return 2;case"large":return 2;case"xlarge":return 2;case"xxlarge":return 4;default:return e<0?4:e}}var gX,$Pe,mX,QPe,XPe,Kc=f(()=>{"use strict";s();xi();gX={none:{uri:""},offline:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAANlBMVEUAAACoxM+oxM+oxM+oxM+oxM+oxM+oxM+oxM////+oxM/W5OmzzNX5+/z3+vvu9Pbt8/Xj7PAAKKEtAAAACXRSTlMA6bWcZQpiXgXWfJCWAAAAeElEQVQoz52RSQ7EIAwEx0AWymT7/2dHYpgoPvQldeySsGl/XjOVZGCpTDFfjIEtj3jN0Pzc99Mb5PUWGbwOHPI/n+GqNxfMY67h9YFjvw0KrQYapYuER+GkLowjigPrArYoNpBCPiWHy3XlB1UlqkRZuziUPO1bvszLC8V87ko/AAAAAElFTkSuQmCC"},online:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAWlBMVEUAAABusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAVusAX////N4bi61517tivn8d3e7NL3+vTE3Kux0o6nzH6GvEWFZ26xAAAAEnRSTlMA8eNrEQj6syHTeXrKshzZ19JHa6QpAAAApUlEQVQoz4WS6w7CIAyFBwwGbE5th87b+7+mCDXcIp4/NN9J2tJ2+KdRTFyx0yTGAkvLgMRmmbg2kMnoL185FOIr5Vmg0hKzWWhkQz+sNdinN1Eg9wyP8MYh5xvewjt5gxcct9iYN1SIXvsj46C8EWvfEZ0jTsYxRJcrYuLAqTg5xKm4AHL2xEH8/GBvJIM819xIWkc9dt1ZFEnO+WrbY1CcjqGnN0xiGcyuKFtcAAAAAElFTkSuQmCC"},away:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAP1BMVEUAAAD6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT6yRT////6zCP95pH95Yv++OL84Hn822T72FT71EUen9LHAAAAC3RSTlMA6rVlCuWgmGJeBd4LCPMAAAB8SURBVCjPnZFLDoAgDERtQUUH/97/rCYNJUITTXjLeYu2064Z75gAYufLfOqR6KdXPI94Mc5ZDCgYNA8piHGBENJcqgV5EQ61gBPBVrAIsoJEwArUYi0EIbFlQ+VwHGpY11XOGDdZVw/MXPstB2olFeGnRFv796Psa1t5ANwFDZEW8B8sAAAAAElFTkSuQmCC"},dnd:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAQlBMVEUAAADpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABv////wfYT86errJjiR9OLxAAAAEXRSTlMA4/CzeQj602seEhEk89jKakfnNfsAAACKSURBVCjPhZFbDoQgDEWBQkHBR2d0/1udEppR0cbzeU9SSq95I69gcZphzZc4eEeC8+HIh0gn4vDPLV2wYsJCHUub5umGr/no7sKNLBI9kFjAkwAWbaX9K+xtMRZIle0jbFRBFpMmZmWU8ri+rv5B/SQmxD6PUknpz16MUJSi9GqZnMAiWkjZvPADxcoYalVfnOMAAAAASUVORK5CYII="},blocked:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAe1BMVEUAAADpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABv////pABv83uHqCiTsJz7rGjP7zNHvRVj/+vv+8vP6x83sIzv2mqXsKD/7zNL5v8b3oqz2maTuP1P82Nz819vtKUDrGjLrGTK2dyGvAAAAEXRSTlMA8dSzeQj64mseEhHkJMpq5T3coEAAAADSSURBVCjPhdHZFoIgFAVQGQRLGzhQiaLNw/9/YZRk4IvncZ+17uJys7mUGyYFoWxTJpxzghDC878vKFBftLX6UgN0MXqF/qRCTg5VaPI1ro36Re+MWQ/TOPrEXw7840uCNvb9oQVZ+qJAnbpSNQpfMHQTVx2YLyT0xJWG9IWAnbiyEL4gaCKPCopb7P9RDOeJqzNYeG7i3+eGBVMPC2Yczpn9cfTmAT58IoV5Rn4FDSdZbY1rxzk9qpXHofkcqtO2uXfhUHOn9SkLJoWQrCizmbwBa5IbuX8ugpIAAAAASUVORK5CYII="},busy:{uri:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAANlBMVEUAAADpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvpABvsgIdoAAAAEXRSTlMA8eLUEQj6s2sheXrlyrJqHBqb3nMAAAB/SURBVCjPhZFRDsQgCEQFEdS223L/yy7JummtGN/nvASUCSvoFGSIclIXpwragC3deYn6IJZ/fqF24NXmHPri+E2rOlCDQTAKIBNZHbKJjyfEBHoCTbAn2ATMRPRHzZfPn+t/cH4SIw3rY2p17H2+l0VRRtr8ag3KgswomcKCL1NmGBp9lqsZAAAAAElFTkSuQmCC"}},$Pe=gX;mX={size8:{physicalSize:8,iconSize:0,iconStrokeWidth:0,initialsSize:4},size24:{physicalSize:24,iconSize:8,iconStrokeWidth:2,initialsSize:10},size32:{physicalSize:32,iconSize:8,iconStrokeWidth:2,initialsSize:12},size40:{physicalSize:40,iconSize:12,iconStrokeWidth:2,initialsSize:14},size48:{physicalSize:48,iconSize:12,iconStrokeWidth:2,initialsSize:16},size56:{physicalSize:56,iconSize:16,iconStrokeWidth:3,initialsSize:18},size72:{physicalSize:72,iconSize:20,iconStrokeWidth:3,initialsSize:20},size100:{physicalSize:100,iconSize:28,iconStrokeWidth:4,initialsSize:36},size120:{physicalSize:120,iconSize:32,iconStrokeWidth:4,initialsSize:40}},QPe={lightBlue:O.color.cornflower.primary,blue:O.color.blue.primary,darkBlue:O.color.royalBlue.primary,teal:O.color.teal.primary,green:O.color.forest.primary,darkGreen:O.color.darkGreen.primary,lightPink:O.color.berry.primary,pink:O.color.hotPink.primary,magenta:O.color.grape.primary,purple:O.color.purple.primary,orange:O.color.pumpkin.primary,lightRed:O.color.red.primary,darkRed:O.color.burgundy.primary,violet:O.color.orchid.primary,gold:O.color.brass.primary,burgundy:O.color.darkRed.primary,warmGray:O.color.beige.primary,cyan:O.color.steel.primary,rust:O.color.brown.primary,coolGray:O.color.platinum.primary};XPe={cornflower:O.color.cornflower.primary,blue:O.color.blue.primary,royalBlue:O.color.royalBlue.primary,teal:O.color.teal.primary,forest:O.color.forest.primary,darkGreen:O.color.darkGreen.primary,berry:O.color.berry.primary,hotPink:O.color.hotPink.primary,grape:O.color.grape.primary,purple:O.color.purple.primary,pumpkin:O.color.pumpkin.primary,red:O.color.red.primary,burgundy:O.color.burgundy.primary,orchid:O.color.orchid.primary,brass:O.color.brass.primary,darkRed:O.color.darkRed.primary,beige:O.color.beige.primary,platinum:O.color.platinum.primary,steel:O.color.steel.primary,brown:O.color.brown.primary}});var gh,WP=f(()=>{"use strict";s();gh="RNFPersonaCoin"});var CX,vX=f(()=>{"use strict";s();Kc();WP();CX=[{tokens:{horizontalIconAlignment:"end",verticalIconAlignment:"end",color:"white",iconStrokeColor:"white",backgroundColor:jP("cornflower")}},gh]});function ZPe(e,t){var r=ga(e),n=r.iconSize,o=r.iconStrokeWidth,a=n+o*2,d=e.iconStrokeColor||t.colors.background;return{source:{},style:{position:"absolute",width:a,height:a,bottom:-o,end:-o,borderRadius:a/2,borderWidth:o,borderColor:d}}}var JPe,xX,TX=f(()=>{"use strict";s();os();Kc();JPe=["iconSize","size","coinSize"];xX=pr(ZPe,JPe)});function t_e(e){var t=ga(e).initialsSize;return{style:{fontSize:t}}}var e_e,bX,SX=f(()=>{"use strict";s();os();Kc();e_e=["coinSize","initialsSize","size"];bX=pr(t_e,e_e)});function n_e(e){var t=ga(e).physicalSize,r=e.backgroundColor,n=e.coinColor,o=e.coinColorFluent,a=r;return o?a=jP(o):n&&(a=yX(n)),{style:{borderRadius:t/2,width:t,height:t,flexGrow:1,alignSelf:"stretch",justifyContent:"center",alignItems:"center",backgroundColor:a}}}var r_e,IX,EX=f(()=>{"use strict";s();os();Kc();r_e=["coinSize","size","coinColor","coinColorFluent","backgroundColor"];IX=pr(n_e,r_e)});function i_e(e){var t=ga(e).physicalSize;return{source:{},style:{borderRadius:t/2,width:t,height:t},resizeMode:"cover"}}var o_e,PX,_X=f(()=>{"use strict";s();os();Kc();o_e=["coinSize","size"];PX=pr(i_e,o_e)});function a_e(e,t){var r=ga(e).physicalSize,n=e.ring;if(!n)return{};var o=n.innerGap!=null?up(n.innerGap):up(n.ringThickness||"xxlarge"),a=2*up(n.ringThickness||"xxlarge")+o,d=r+2*a,c=n.ringBackgroundColor||t.colors.personaActivityRing;return{style:{borderStyle:"solid",borderColor:c,borderWidth:a,borderRadius:d/2,width:d,height:d,position:"absolute",top:-a,left:-a}}}function s_e(e,t){var r=ga(e).physicalSize,n=e.ring;if(!n)return{};var o=n.innerGap!=null?up(n.innerGap):up(n.ringThickness||"xxlarge"),a=up(n.ringThickness||"xxlarge")+o,d=r+2*a,c=n.accent?t.colors.accentButtonBackground:n.ringColor||t.colors.personaActivityGlow;return{style:{borderStyle:"solid",borderColor:c,borderWidth:a-o,borderRadius:d/2,width:d,height:d,position:"absolute",top:-a,left:-a}}}var RX,AX,kX,DX=f(()=>{"use strict";s();os();Kc();RX=["coinSize","size","ring"];AX=pr(a_e,RX),kX=pr(s_e,RX)});function c_e(e){var t={flexDirection:"row"},r=ga(e).physicalSize;t.width=r,t.height=r;var n=e.horizontalIconAlignment,o=e.verticalIconAlignment;return t.justifyContent=wX[n||"end"],t.alignItems=wX[o||"end"],{style:t}}var wX,d_e,hh,vN=f(()=>{"use strict";s();os();Kc();wX={start:"flex-start",center:"center",end:"flex-end"},d_e=["coinSize","size","horizontalIconAlignment","verticalIconAlignment"];hh=pr(c_e,d_e)});function l_e(e,t){var r=e.imageUrl,n=e.imageDescription,o=e.initials,a=e.presence,d=e.isOutOfOffice,c=e.ring,u=u_e(e,["imageUrl","imageDescription","initials","presence","isOutOfOffice","ring"]),l=r===void 0?void 0:{uri:r},p=a===void 0?void 0:hX(a,d||!1),g=!!c,h=!!(c!=null&&c.transparent);return{slotProps:Dt(t(e),{root:xN({},u),initials:{children:o},photo:{accessibilityLabel:n}}),state:{iconSource:p,personaPhotoSource:l,showRing:g,transparentRing:h}}}var qd,xN,u_e,f_e,zP,FX=f(()=>{"use strict";s();qd=S(re());Nv();_n();Wi();is();Co();Kc();vX();TX();SX();EX();_X();DX();vN();WP();xN=function(){return xN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},xN.apply(this,arguments)},u_e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};f_e=function(t,r){if(!r.state)return null;var n=r.state,o=n.personaPhotoSource,a=n.iconSource,d=n.showRing,c=n.transparentRing;return Pe(t.root,null,o?Pe(t.photo,{source:o}):Pe(t.initialsBackground,null,Pe(t.initials,null)),d&&!c&&Pe(t.ring,null),d&&Pe(t.glow,null),!!a&&!!a.uri&&Pe(t.icon,{source:a}))},zP=Br({displayName:gh,usePrepareProps:l_e,settings:CX,slots:{root:{slotType:qd.View,filter:Ud},photo:{slotType:qd.Image,filter:J0},initials:qd.Text,initialsBackground:{slotType:qd.View,filter:Ud},icon:{slotType:qd.Image,filter:J0},ring:{slotType:qd.View,filter:Ud},glow:{slotType:qd.View,filter:Ud}},render:f_e,styles:{root:[hh],initials:[po,bX],initialsBackground:[IX],photo:[PX],icon:[xX],ring:[AX],glow:[kX]}})});var GP=f(()=>{"use strict";s();FX();WP();vN()});var yh,qP=f(()=>{"use strict";s();yh="RNFPersona"});var OX,NX=f(()=>{"use strict";s();qP();OX=[{tokens:{verticalGap:4}},yh]});function g_e(e,t){var r=e.coinBackgroundColor,n=p_e(e,["coinBackgroundColor"]),o=KP(KP({},n),{backgroundColor:r});return hh(o,t)}var KP,p_e,m_e,MX,LX=f(()=>{"use strict";s();GP();os();KP=function(){return KP=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},KP.apply(this,arguments)},p_e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},m_e=["coinSize","size","horizontalIconAlignment","verticalIconAlignment","coinBackgroundColor"];MX=pr(g_e,m_e)});function y_e(e){var t={flexDirection:"row",alignItems:"center"},r=e.coinSize;return r&&r>0&&(t.height=r,t.minWidth=r),{style:t}}var h_e,HX,BX=f(()=>{"use strict";s();os();h_e=["coinSize","size"];HX=pr(y_e,h_e)});function UX(e){return C_e[e]}function VX(e){return v_e[e]}function jX(e){return x_e[e]}function WX(e){return T_e[e]}function zX(e){return b_e[e||"size40"]}var C_e,v_e,x_e,T_e,b_e,TN=f(()=>{"use strict";s();C_e={size8:{fontSize:"caption"},size24:{fontSize:"secondary"},size32:{fontSize:"secondary"},size40:{fontSize:"secondary"},size48:{fontSize:"secondary"},size56:{fontSize:"subheader"},size72:{fontSize:"subheader"},size100:{fontSize:"subheader"},size120:{fontSize:"subheader"}},v_e={size8:{fontSize:0},size24:{fontSize:0},size32:{fontSize:0},size40:{fontSize:"caption"},size48:{fontSize:"caption"},size56:{fontSize:"secondary"},size72:{fontSize:"secondary"},size100:{fontSize:"secondary"},size120:{fontSize:"secondary"}},x_e={size8:{fontSize:0},size24:{fontSize:0},size32:{fontSize:0},size40:{fontSize:0},size48:{fontSize:0},size56:{fontSize:0},size72:{fontSize:"secondary"},size100:{fontSize:"secondary"},size120:{fontSize:"secondary"}},T_e={size8:{fontSize:0},size24:{fontSize:0},size32:{fontSize:0},size40:{fontSize:0},size48:{fontSize:0},size56:{fontSize:0},size72:{fontSize:0},size100:{fontSize:"secondary"},size120:{fontSize:"secondary"}};b_e={size8:17,size24:8,size32:8,size40:12,size48:12,size56:16,size72:16,size100:16,size120:16}});function I_e(e){var t=e.size,r=e.horizontalGap,n={flexDirection:"column",justifyContent:"space-around",paddingLeft:r||zX(t)};return{style:n}}var S_e,GX,qX=f(()=>{"use strict";s();os();TN();S_e=["size","horizontalGap"];GX=pr(I_e,S_e)});function YP(e,t,r,n,o){var a={};e!==void 0&&(a.marginBottom=e);var d=n||r(t||"size40"),c=d.fontFamily,u=d.fontSize,l=d.fontWeight;return a.fontFamily=c&&(o.typography.families[c]||c),a.fontSize=u&&(typeof u=="string"?o.typography.sizes[u]:u),a.fontWeight=l&&(o.typography.weights[l]||l),a.fontSize===0&&(a.display="none",a.fontSize=void 0),a}function E_e(e,t){var r=e.verticalGap,n=e.textFont,o=e.size;return{style:YP(r,o,UX,n,t)}}function P_e(e,t){var r=e.verticalGap,n=e.secondaryFont,o=e.size;return{style:YP(r,o,VX,n,t)}}function __e(e,t){var r=e.verticalGap,n=e.tertiaryFont,o=e.size;return{style:YP(r,o,jX,n,t)}}function R_e(e,t){var r=e.optionalFont,n=e.size;return{style:YP(void 0,n,WX,r,t)}}var KX,YX,$X,QX,XX=f(()=>{"use strict";s();os();TN();KX=pr(E_e,["size","textFont","verticalGap"]),YX=pr(P_e,["size","secondaryFont","verticalGap"]),$X=pr(__e,["size","tertiaryFont","verticalGap"]),QX=pr(R_e,["size","optionalFont"])});function k_e(e,t){var r=e.text,n=e.secondaryText,o=e.tertiaryText,a=e.optionalText,d=e.size,c=e.coinColor,u=e.imageUrl,l=e.imageDescription,p=e.initials,g=e.presence,h=e.isOutOfOffice,v=A_e(e,["text","secondaryText","tertiaryText","optionalText","size","coinColor","imageUrl","imageDescription","initials","presence","isOutOfOffice"]),y=Dt(t(e),{root:bN({},v),coin:{size:d,coinColor:c,imageUrl:u,imageDescription:l,initials:p,presence:g,isOutOfOffice:h}});return{slotProps:y,state:{text:r,secondaryText:n,tertiaryText:o,optionalText:a}}}var Rl,bN,A_e,D_e,JX,ZX=f(()=>{"use strict";s();Rl=S(re());Nv();GP();_n();Wi();is();Co();NX();LX();BX();qX();XX();qP();bN=function(){return bN=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},bN.apply(this,arguments)},A_e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};D_e=function(t,r){if(!r.state)return null;var n=r.state,o=n.text,a=n.secondaryText,d=n.tertiaryText,c=n.optionalText;return Pe(t.root,null,Pe(t.coin,null),Pe(t.stack,null,!!o&&Pe(t.text,null,o),!!a&&Pe(t.secondary,null,a),!!d&&Pe(t.tertiary,null,d),!!c&&Pe(t.optional,null,c)))},JX=Br({displayName:yh,settings:OX,render:D_e,usePrepareProps:k_e,slots:{root:{slotType:Rl.View,filter:Ud},coin:zP,stack:Rl.View,text:Rl.Text,secondary:Rl.Text,tertiary:Rl.Text,optional:Rl.Text},styles:{root:[HX],coin:[po,{source:"coinBackgroundColor",target:"backgroundColor"},MX],text:[KX],secondary:[YX],tertiary:[$X],optional:[QX],stack:[GX]}})});var eJ=f(()=>{"use strict";s();ZX();qP()});var tJ,w_e,rJ,nJ=f(()=>{"use strict";s();tJ=S(re());An();Wi();Co();w_e=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},rJ=qc({slots:{root:tJ.View},usePrepareProps:function(t,r){var n=t.renderStyle,o=w_e(t,["renderStyle"]),a=ji(o),d=a.props,c=a.state,u=r(d);return n&&(d.style=n(c)),{slotProps:Dt(u,{root:d}),state:{state:c}}}})});var oJ=f(()=>{"use strict";s();nJ()});var Ch,$P=f(()=>{"use strict";s();Ch="Separator"});var iJ,aJ=f(()=>{"use strict";s();xi();iJ=function(){return{separatorWidth:O.stroke.width10}}});var Q1t,Zv,F_e,O_e,sJ,dJ=f(()=>{"use strict";s();Q1t=S(re());Oe();$P();aJ();Zv=function(){return Zv=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Zv.apply(this,arguments)},F_e=!1,O_e=["vertical","insetSpacing"],sJ={tokens:[iJ,Ch],tokensThatAreAlsoProps:O_e,slotProps:{root:ct(function(e){return{style:Zv(Zv(Zv({},e.vertical?{borderLeftWidth:e.separatorWidth}:{borderTopWidth:e.separatorWidth}),e.color&&{borderColor:e.color}),F_e)}},["color","vertical","separatorWidth","insetSpacing"])}}});var cJ,ex,N_e,uJ,lJ=f(()=>{"use strict";s();cJ=S(re());Oe();dJ();$P();ex=function(){return ex=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ex.apply(this,arguments)},N_e={vertical:void 0},uJ=en(ex(ex({displayName:Ch},sJ),{slots:{root:cJ.View},useRender:function(t,r){var n=r(t).root;return function(o,a){return we(n,ex({},dt(t,o,N_e)),a)}}}))});var fJ=f(()=>{"use strict";s();$P();lJ()});var QP,SN=f(()=>{"use strict";s();QP="MenuButton"});var pJ,mJ,gJ=f(()=>{"use strict";s();pJ="#616161",mJ="#ffffff"});var qi,hJ,Kd,IN,yJ,M_e,CJ=f(()=>{"use strict";s();qi=S(L());iN();lN();_n();Wi();is();Co();hJ=S(tp());gJ();SN();Kd=function(){return Kd=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Kd.apply(this,arguments)},IN=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},yJ=Br({displayName:QP,usePrepareProps:function(t,r){var n=t.menuItems,o=t.content,a=t.startIcon,d=t.endIcon,c=t.disabled,u=t.onItemClick,l=t.contextualMenu,p=t.primary,g=IN(t,["menuItems","content","startIcon","endIcon","disabled","onItemClick","contextualMenu","primary"]),h=(0,qi.useRef)(null),v=(0,qi.useState)(!1),y=v[0],T=v[1],b=(0,qi.useCallback)(function(){T(!1)},[T]),I=(0,qi.useCallback)(function(){T(!y)},[y,T]),E={context:{showContextualMenu:!!y,primary:!!p}},P=r(t,function(M){return E[M]||t[M]}),_=Kd({disabled:c,content:o,icon:a??d,iconPosition:a!=null?"before":"after",componentRef:h,onClick:I,iconOnly:o==null},g),D=Dt(P,{root:{},button:_,primaryButton:Kd({appearance:"primary"},_),contextualMenu:Kd({onItemClick:u,target:h,onDismiss:b,setShowMenu:I},l),contextualMenuItems:{menuItems:n}});return{slotProps:D,state:E}},slots:{root:qi.default.Fragment,button:{slotType:ap},primaryButton:{slotType:ap},contextualMenu:{slotType:AP},contextualMenuItems:qi.default.Fragment,chevronSvg:hJ.SvgXml},styles:{contextualMenu:[mo,Gn],button:[mo,Gn]},render:function(t,r){if(!(r.state&&r.slotProps))return null;var n=r.state.context,o=r.slotProps.contextualMenuItems?r.slotProps.contextualMenuItems.menuItems:[],a=n.primary?mJ:pJ,d='\n    <svg width="12" height="16" viewBox="0 0 11 6" color='.concat(a,">\n      <path fill='currentColor' d='M0.646447 0.646447C0.841709 0.451184 1.15829 0.451184 1.35355 0.646447L5.5 4.79289L9.64645 0.646447C9.84171 0.451185 10.1583 0.451185 10.3536 0.646447C10.5488 0.841709 10.5488 1.15829 10.3536 1.35355L5.85355 5.85355C5.65829 6.04882 5.34171 6.04882 5.14645 5.85355L0.646447 1.35355C0.451184 1.15829 0.451184 0.841709 0.646447 0.646447Z' />\n    </svg>");return Pe(t.root,null,n.primary?Pe(t.primaryButton,null,r.slotProps.primaryButton.content,Pe(t.chevronSvg,{xml:d})):Pe(t.button,null,r.slotProps.button.content,Pe(t.chevronSvg,{xml:d})),n.showContextualMenu&&Pe(t.contextualMenu,null,o.map(function(c){return c.hasSubmenu&&c.submenuItems?Pe(t.contextualMenuItems,null,Pe(M_e,Kd({},c))):Pe(Jv,Kd({key:c.itemKey},c))})))}}),M_e=function(t){var r=qi.default.useState(!1),n=r[0],o=r[1],a=qi.default.useCallback(function(){o(!n)},[n,o]),d=qi.default.useCallback(function(){o(!1)},[o]),c=t.showSubmenu,u=c===void 0?n:c,l=t.submenuProps,p=t.componentRef,g=t.submenuItems,h=t.onHoverIn,v=h===void 0?a:h,y=IN(t,["showSubmenu","submenuProps","componentRef","submenuItems","onHoverIn"]),T=l.onDismiss,b=T===void 0?d:T,I=l.setShowMenu,E=I===void 0?a:I,P=IN(l,["onDismiss","setShowMenu"]);return Pe(qi.default.Fragment,null,Pe(OP,Kd({componentRef:p,onHoverIn:v},y)),u&&Pe(wP,Kd({target:p,onDismiss:b,setShowMenu:E},P),g==null?void 0:g.map(function(_){return Pe(Jv,Kd({key:_.itemKey},_))})))}});var vJ=f(()=>{"use strict";s();SN();CJ()});var vh,XP=f(()=>{"use strict";s();vh="Tab"});var Al,FOt,xJ,TJ=f(()=>{"use strict";s();k();Al=S(L()),FOt=S(re());Oe();xJ=function(t,r,n,o){var a=o.canShowAnimatedIndicator,d=o.selectedKey,c=o.vertical,u=Al.default.useMemo(function(){return{style:m(m({display:"flex",alignItems:"center",flexDirection:r.flexDirection,alignSelf:"flex-start",justifyContent:"center",padding:1,backgroundColor:r.backgroundColor},c?{}:{height:"100%"}),Ko.from(r,n))}},[r,n,c]),l=Al.default.useMemo(function(){return{style:{flexDirection:"row",paddingStart:r.contentMarginStart,paddingEnd:r.contentMarginEnd}}},[r.contentMarginStart,r.contentMarginEnd]),p=Al.default.useMemo(function(){return{numberOfLines:r.numberOfLines,style:m({color:r.color},Zr.from(r,n))}},[r,n]),g=Al.default.useMemo(function(){return t.icon?m(m({},t.icon),{color:r.iconColor,size:r.iconSize}):{}},[t.icon,r.iconColor,r.iconSize]),h=Al.default.useMemo(function(){return{style:{display:"flex",alignItems:"center",flexDirection:"row",flex:0,alignSelf:"flex-start",justifyContent:"center",marginHorizontal:r.stackMarginHorizontal,marginVertical:r.stackMarginVertical}}},[r.stackMarginHorizontal,r.stackMarginVertical]),v=Al.default.useMemo(function(){return{style:m({backgroundColor:n.colors.transparentBackground},c?{height:"100%",width:r.indicatorThickness,paddingVertical:r.indicatorMargin}:{width:"100%",height:r.indicatorThickness,paddingHorizontal:r.indicatorMargin})}},[c,r.indicatorThickness,r.indicatorMargin,n]),y=Al.default.useMemo(function(){var T=t.tabKey===d&&a;return{style:{flex:1,borderRadius:r.indicatorRadius,backgroundColor:T?n.colors.transparentBackground:r.indicatorColor}}},[a,t.tabKey,d,r.indicatorColor,r.indicatorRadius,n]);return{root:u,contentContainer:l,content:p,icon:g,stack:h,indicatorContainer:v,indicator:y}}});var bJ,SJ=f(()=>{"use strict";s();Vc();bJ=function(t){return{borderColor:t.colors.transparentBackground,color:t.colors.neutralForeground2,iconColor:t.colors.neutralForeground2,indicatorColor:t.colors.transparentBackground,transparent:{backgroundColor:t.colors.transparentBackground},subtle:{backgroundColor:t.colors.subtleBackground},selected:{color:t.colors.neutralForeground1,iconColor:t.colors.compoundBrandForeground1,indicatorColor:t.colors.compoundBrandStroke1,pressed:{color:jt(t)?t.colors.neutralForeground2:t.colors.neutralForeground1Pressed,iconColor:jt(t)?t.colors.neutralForeground2:t.colors.compoundBrandForeground1Pressed,indicatorColor:t.colors.compoundBrandStroke1Pressed}},disabled:{color:jt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,iconColor:jt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,selected:{color:jt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,iconColor:jt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled,indicatorColor:jt(t)?t.colors.neutralStrokeDisabled:t.colors.neutralForegroundDisabled}},hovered:{color:jt(t)?t.colors.neutralForeground2:t.colors.neutralForeground2Hover,iconColor:jt(t)?t.colors.compoundBrandForeground1Hover:t.colors.neutralForeground2Hover,indicatorColor:jt(t)?t.colors.compoundBrandStroke1Hover:t.colors.neutralStroke1Hover,selected:{color:jt(t)?t.colors.neutralForeground2:t.colors.neutralForeground1Hover,iconColor:jt(t)?t.colors.neutralForeground2:t.colors.compoundBrandForeground1Hover,indicatorColor:t.colors.compoundBrandStroke1Hover,subtle:{indicatorColor:jt(t)?t.colors.neutralStroke1:t.colors.compoundBrandStroke1Hover}},disabled:{indicatorColor:t.colors.transparentBackground},transparent:{backgroundColor:t.colors.transparentBackgroundHover},subtle:{backgroundColor:t.colors.subtleBackgroundHover,indicatorColor:jt(t)?t.colors.neutralStroke1:t.colors.neutralStroke1Hover}},pressed:{color:jt(t)?t.colors.neutralForeground2:t.colors.neutralForeground2Pressed,iconColor:jt(t)?t.colors.neutralForeground2:t.colors.neutralForeground2Pressed,indicatorColor:jt(t)?t.colors.compoundBrandBackground1Pressed:t.colors.neutralStroke1Pressed,transparent:{backgroundColor:t.colors.transparentBackgroundPressed},subtle:{backgroundColor:t.colors.subtleBackgroundPressed}},focused:{borderColor:jt(t)?t.colors.compoundBrandStroke1:t.colors.neutralForeground1}}}});var IJ,L_e,EJ,PJ=f(()=>{"use strict";s();Oe();XP();SJ();IJ=["small","medium","large","vertical","hovered","disabled","selected","focused","pressed","transparent","subtle","hasIcon"],L_e={indicatorOrientation:"horizontal",indicatorThickness:2,borderWidth:2,borderRadius:4,contentMarginStart:2,contentMarginEnd:2,flexDirection:"column",indicatorRadius:99,numberOfLines:1,small:{iconSize:20,iconMargin:2,indicatorMargin:8,stackMarginHorizontal:6,stackMarginVertical:8,variant:"body1",selected:{variant:"body1Strong"}},medium:{iconSize:20,iconMargin:6,indicatorMargin:12,stackMarginHorizontal:10,stackMarginVertical:12,variant:"body1",selected:{variant:"body1Strong"}},large:{iconSize:24,iconMargin:6,indicatorMargin:12,stackMarginHorizontal:10,stackMarginVertical:16,variant:"body2",selected:{variant:"subtitle2"}},vertical:{flexDirection:"row-reverse",indicatorOrientation:"vertical",small:{indicatorMargin:4,stackMarginHorizontal:6,stackMarginVertical:2},medium:{indicatorMargin:8,stackMarginHorizontal:10,stackMarginVertical:6},large:{indicatorMargin:10,stackMarginHorizontal:10,stackMarginVertical:8}},hasIcon:{contentMarginStart:8}},EJ=Zf(L_e,bJ,vh)});var _J,xh,lp,tx=f(()=>{"use strict";s();_J=S(L()),xh=function(){return null},lp=_J.createContext({addTabKey:xh,appearance:"transparent",canShowAnimatedIndicator:!1,disabled:!1,onTabSelect:xh,removeTabKey:xh,selectedKey:"",setFocusedTabRef:xh,size:"small",tabKeys:[],vertical:!1,updateDisabledTabs:xh,updateTabRef:xh})});function B_e(e,t,r){return r?m({disabled:e,selected:t},r):{disabled:e,selected:t}}var bi,RJ,AJ,H_e,kJ=f(()=>{"use strict";s();k();bi=S(L());Oe();An();tx();RJ=[{name:"Select"}],AJ=function(t){var r,n=bi.useRef(null),o=t.accessibilityActions,a=t.accessibilityPositionInSet,d=t.accessibilitySetSize,c=t.accessibilityState,u=t.accessible,l=t.componentRef,p=l===void 0?n:l,g=t.disabled,h=t.icon,v=t.onAccessibilityAction,y=t.tabKey,T=Ke(t,["accessibilityActions","accessibilityPositionInSet","accessibilitySetSize","accessibilityState","accessible","componentRef","disabled","icon","onAccessibilityAction","tabKey"]),b=bi.useContext(lp),I=b.addTabKey,E=b.invoked,P=b.onTabSelect,_=b.removeTabKey,D=b.setInvoked,M=b.setFocusedTabRef,H=b.selectedKey,U=b.tabKeys,F=b.vertical,z=b.updateDisabledTabs,Y=b.updateTabRef,B=Ke(b,["addTabKey","invoked","onTabSelect","removeTabKey","setInvoked","setFocusedTabRef","selectedKey","tabKeys","vertical","updateDisabledTabs","updateTabRef"]),q=g||B.disabled,K=bi.useCallback(function(){P(y),p&&M(p)},[p,M,P,y]),$=bi.useCallback(function(){K(),D(!0)},[K,D]),oe=Vd(m(m({},T),{onPress:$})),ie=Qo(K," ","Enter");bi.useEffect(function(){return I(y),H===y&&p&&M(p),function(){return _(y)}},[]),bi.useEffect(function(){Y(y,p)},[y,p]),bi.useEffect(function(){z(y,g)},[y,g]),bi.useEffect(function(){var he;E&&D&&y===H&&!q&&(p&&M(p),(he=p==null?void 0:p.current)===null||he===void 0||he.focus(),D(!1))},[E,D]);var Ce=bi.useCallback(function(he){if(!q){switch(he.nativeEvent.actionName){case"Select":K();break}v&&v(he)}},[K,q,v]),se=bi.useMemo(function(){return o?w(w([],RJ,!0),o,!0):RJ},[o]);return{props:m(m(m(m({},t),oe.props),{accessible:u??!0,accessibilityRole:"tab",accessibilityActions:se,accessibilityPositionInSet:a??U.findIndex(function(he){return he===y})+1,accessibilityState:H_e(q,H===y,c),accessibilitySetSize:d??U.length,disabled:q,focusable:(r=!q)!==null&&r!==void 0?r:!0,icon:h,onAccessibilityAction:Ce,ref:Ar(p),tabKey:y}),ie),state:m(m({},oe.state),{selected:y===H})}},H_e=Qt(B_e)});function wJ(e,t,r,n){var o=t.addTabLayout,a=t.selectedKey,d=t.layout,c=t.updateAnimatedIndicatorStyles,u=t.vertical,l=e.tabKey,p=e.onLayout;JP.default.useEffect(function(){l===a&&c&&c({backgroundColor:r.indicatorColor,borderRadius:r.indicatorRadius})},[l,a,r.indicatorColor,r.indicatorRadius]);var g=JP.default.useCallback(function(h){if(h.nativeEvent.layout&&!1||d!=null&&d.tablist&&d.tablist.width>0&&h.nativeEvent.layout.height<=d.tablist.height&&h.nativeEvent.layout.height<U_e){var v=h.nativeEvent.layout,y=v.width,T=v.height,b=v.x,I=v.y,E=void 0,P=void 0,_=void 0,D=void 0,M=1,H=r.indicatorMargin+r.borderWidth+M;u?(E=r.indicatorThickness,P=T-H*2,D=I+H,DJ.I18nManager.isRTL?_=b+y-(r.borderWidth+M+E):_=b+r.borderWidth+M):(E=y-H*2,P=r.indicatorThickness,_=b+H,D=T+I-P-r.borderWidth-M),o(l,{x:_,y:D,width:E,height:P})}p&&p(h)},[o,d,p,l,r.borderWidth,r.indicatorMargin,r.indicatorThickness,u]);return JP.default.useMemo(function(){return m(m({},n),{onLayout:g})},[n,g])}var JP,DJ,U_e,FJ=f(()=>{"use strict";s();k();JP=S(L()),DJ=S(re()),U_e=2e4});var ZP,fp,V_e,EN,OJ=f(()=>{"use strict";s();k();ZP=S(L()),fp=S(re());Oe();op();pa();TJ();XP();PJ();kJ();FJ();tx();V_e=function(t,r,n,o){return r[t]||n[t]||o[t]||t===o.appearance||t===o.size||t==="hasIcon"&&n.icon},EN=Cl(function(e,t){var r,n=ZP.default.useContext(lp),o=AJ(e),a=fa(),d=t(a),c=d[0],u=d[1];r=yl(c,IJ,u,function(E){return V_e(E,o.state,o.props,n)}),c=r[0],u=r[1];var l=xJ(o.props,c,a,n),p=wJ(e,n,c,l.root),g=es(fp.Pressable,p),h=es(fp.View,l.stack),v=es(fp.View,l.indicatorContainer),y=es(fp.View,l.indicator),T=es(fp.View,l.contentContainer),b=es(Sr,l.content),I=es(np,l.icon);return function(E){for(var P=[],_=1;_<arguments.length;_++)P[_-1]=arguments[_];if(!o.state)return null;var D="",M=!1;ZP.default.Children.forEach(P,function(B){B!==null&&(M=!0,typeof B=="string"&&(D=B))});var H=dt(o.props,E,{accessibilityLabel:o.props.accessibilityLabel||E.accessibilityLabel||D}),U=H.icon,F=H.tabKey,z=H.onLayout,Y=Ke(H,["icon","tabKey","onLayout"]);return we(g,m({},Y),we(h,null,U&&we(I,m({},U)),M&&we(T,null,ZP.default.Children.map(P,function(B,q){return typeof B=="string"?we(b,{accessible:!1,key:q},B):B}))),we(v,null,we(y,null)))}},EJ);EN.displayName=vh});var Th,e_=f(()=>{"use strict";s();Th="TabList"});var NJ,MJ=f(()=>{"use strict";s();NJ=function(){return{direction:"row",vertical:{direction:"column"}}}});var LJ,HJ=f(()=>{"use strict";s();k();Oe();e_();MJ();LJ={tokens:[NJ,Th],states:["vertical"],slotProps:{stack:ct(function(e){return{style:{display:"flex",flexDirection:e.direction,flex:0}}},["direction"]),root:ct(function(e,t){return{style:m({display:"flex",alignItems:"flex-start"},ko.from(e,t))}},ko.keys)}}});function W_e(e,t){return t?m({disabled:e},t):{disabled:e}}var rn,BJ,j_e,UJ=f(()=>{"use strict";s();k();rn=S(L());Oe();An();BJ=function(t){var r=rn.useRef(null),n=t.accessible,o=t.appearance,a=o===void 0?"transparent":o,d=t.accessibilityState,c=t.componentRef,u=c===void 0?r:c,l=t.defaultSelectedKey,p=t.disabled,g=p===void 0?!1:p,h=t.isCircularNavigation,v=t.onTabSelect,y=t.selectedKey,T=t.size,b=T===void 0?"medium":T,I=t.vertical,E=I===void 0?!1:I,P=Sl(y||l||null,v),_=y??P.selectedKey,D=rn.useState(rn.useRef(null)),M=D[0],H=D[1],U=rn.useState(!1),F=U[0],z=U[1],Y=rn.useState([]),B=Y[0],q=Y[1],K=rn.useState(!1),$=K[0],oe=K[1],ie=rn.useRef({}).current,Ce=rn.useRef({}).current,se=rn.useCallback(function(Er,qr){return ie[Er]=qr},[ie]),he=rn.useCallback(function(Er,qr){Ce[Er]=qr,$&&!qr&&oe(!1)},[$,Ce]),Be=rn.useCallback(function(Er){q(function(qr){return w(w([],qr,!0),[Er],!1)})},[B,q]),_e=rn.useCallback(function(Er){q(function(qr){return qr.filter(function(ys){return ys!==Er})})},[q]),ot=rn.useState({}),Ue=ot[0],or=ot[1],ir=rn.useState(),ri=ir[0],ni=ir[1],Ra=rn.useState({}),Aa=Ra[0],ka=Ra[1],sd=rn.useCallback(function(Er,qr){or(function(ys){var dd;return m(m({},ys),(dd={},dd[Er]=qr,dd))})},[or]),vt=rn.useCallback(function(Er){ka(function(qr){return vi(qr,Er)})},[ka]),fc=rn.useCallback(function(Er){Er.nativeEvent.layout&&ni(Er.nativeEvent.layout)},[ni]),Yl=Ce[_];return rn.useEffect(function(){if(Yl){for(var Er=B.indexOf(_),qr=0;qr<B.length&&(Er=(Er+1)%B.length,!!Ce[B[Er]]);qr++);if(B[Er]===_)oe(!0);else{var ys=ie[B[Er]];H(ys)}}},[Yl]),{props:m(m({},t),{accessible:n??!0,accessibilityState:j_e(g||$,d),accessibilityRole:"tablist",appearance:a,componentRef:u,defaultTabbableElement:M,isCircularNavigation:h??!1,onLayout:fc,size:b,vertical:E}),state:{addTabKey:Be,addTabLayout:sd,animatedIndicatorStyles:Aa,appearance:a,canShowAnimatedIndicator:!!(Aa&&Ue&&Ue[_]),disabled:g||$,invoked:F,layout:{tablist:ri,tabs:Ue},onTabSelect:P.onKeySelect,removeTabKey:_e,selectedKey:_,setFocusedTabRef:H,setInvoked:z,size:b,tabKeys:B,vertical:E,updateAnimatedIndicatorStyles:vt,updateDisabledTabs:he,updateTabRef:se}}},j_e=Qt(W_e)});var VJ,jJ=f(()=>{"use strict";s();VJ="TabListAnimatedIndicator"});function WJ(e){var t=e.animatedIndicatorStyles,r=e.selectedKey,n=e.tabLayout,o=PN.default.useMemo(function(){return r?n[r]:null},[r,n]),a=PN.default.useMemo(function(){if(!o)return null;var d=o.x,c=o.y,u=o.width,l=o.height,p=m(m({},t),{position:"absolute",width:u,height:l,left:d,top:c});return p},[o,t]);return a}var PN,zJ=f(()=>{"use strict";s();k();PN=S(L())});function G_e(e,t){return{animationClass:e,style:t}}var GJ,qJ,z_e,KJ,YJ,$J=f(()=>{"use strict";s();k();GJ=S(L()),qJ=S(re());Oe();jJ();zJ();z_e=Qt(G_e);KJ=Rn(function(e){var t=WJ(e);return function(){var r=z_e("Ribbon_TabUnderline",t);return GJ.default.createElement(qJ.View,m({},r))}});KJ.displayName=VJ;YJ=KJ});var _N,QJ,XJ=f(()=>{"use strict";s();k();_N=S(re());sp();Oe();HJ();e_();tx();UJ();$J();QJ=en(m(m({displayName:Th},LJ),{slots:{container:as,stack:_N.View,root:_N.View},useRender:function(t,r){var n=BJ(t),o=r(t);return function(a){for(var d=[],c=1;c<arguments.length;c++)d[c-1]=arguments[c];if(!n.state)return null;var u=dt(n.props,a),l=u.disabled,p=u.defaultTabbableElement,g=u.isCircularNavigation,h=u.vertical,v=Ke(u,["disabled","defaultTabbableElement","isCircularNavigation","vertical"]),y=n.state,T=y.animatedIndicatorStyles,b=y.canShowAnimatedIndicator,I=y.disabled,E=y.layout,P=y.selectedKey;return we(lp.Provider,{value:n.state},we(o.root,m({},v),we(o.container,{disabled:l||I,defaultTabbableElement:p,focusZoneDirection:h?"vertical":"horizontal",isCircularNavigation:g},we(o.stack,null,d),b&&we(YJ,{animatedIndicatorStyles:T,selectedKey:P,tabLayout:E.tabs,vertical:h}))))}}}))});var JJ=f(()=>{"use strict";s();XP();OJ();e_();XJ();tx()});var ha=f(()=>{"use strict";s();iN();$v();NQ();lN();oX();sp();pX();eJ();GP();oJ();fJ();pa();An();vJ();JJ()});function q_e(e,t,r){e.target===e.currentTarget&&(t(!0),r==null||r(e))}function K_e(e,t,r){e.target===e.currentTarget&&(t(!1),r==null||r(e))}function t_(e){return function(t){var r=t.nodeId,n=t.isTabbable,o=t.onFocusStateChange,a=t.onFocus,d=t.onBlur,c=t.nodeData,u=t.keyDownEvents,l=t.preventDefaultKeyDownBehavior,p=t.focusable,g=t.children,h=Ke(t,["nodeId","isTabbable","onFocusStateChange","onFocus","onBlur","nodeData","keyDownEvents","preventDefaultKeyDownBehavior","focusable","children"]),v=V(Yc.useState(!1),2),y=v[0],T=v[1],b=gb(r,c,n,o,y,!1),I=Yc.useCallback(function(D){return q_e(D,T,a)},[T,a]),E=Yc.useCallback(function(D){return K_e(D,T,d)},[T,d]),P=e,_=h;return Yc.createElement(bl.Consumer,null,function(D){return Yc.createElement(gc,{node:b.current,position:D,ref:b.current.registrationRef},Yc.createElement(P,m({},_,{componentRef:b.current.innerComponentRef,onFocus:I,onBlur:E,keyDownEvents:yO(u,l)})))})}}var Yc,RN=f(()=>{"use strict";s();k();Pt();Yc=S(L());Gc()});var ZJ,eZ=f(()=>{"use strict";s();ha();RN();yo();ZJ=function(t,r){var n=Ht(r),o=t_(rh.customize({root:{style:{flex:0,borderRadius:4,borderWidth:1,padding:1,justifyContent:"center",alignItems:"center",paddingRight:4,paddingLeft:4,paddingTop:4,paddingBottom:4,borderColor:"transparent"}},checkbox:{style:{flex:0,marginEnd:0,marginTop:0,height:16,width:16,alignItems:"center",alignContent:"center"}},checkmark:{accessible:!1,style:{top:void 0}},content:{style:{display:"none"}},tokens:{borderRadius:8,checkboxBackgroundColor:n.buttonBackground,checkboxBorderColor:n.roundCheckboxBorderColor},_overrides:{pressed:{checkmark:{style:{fontWeight:"bold"}},tokens:{checkboxBackgroundColor:n.expandButtonTextColor,checkboxBorderColor:n.expandButtonTextColor,checkmarkColor:n.completedCheckColor}},hovered:{checkmark:{style:{opacity:1}},tokens:{checkmarkColor:n.checkHoverColor,checkboxBackgroundColor:n.buttonHoveredBackground}},focused:{root:{style:{borderColor:t.palette.FocusBorderColor,borderStyle:"solid",padding:0}}}}}));return o.displayName="RoundCheckbox",o}});var tZ,qe,gn=f(()=>{"use strict";s();k();ha();tZ=S(L()),qe=function(t){var r=t.textStylePolyester,n=t.variantFluent,o=t.colorFluent,a=Ke(t,["textStylePolyester","variantFluent","colorFluent"]);return tZ.createElement(Sr,m({variant:n,color:o},a))};qe.displayName="TextWrapper"});var rZ,nZ,oZ=f(()=>{"use strict";s();je();rZ=ve({paddingTop:1,paddingLeft:3,flex:1}),nZ=ve({paddingBottom:2,paddingRight:3,paddingLeft:5,borderRadius:2,flex:0})});function iZ(e){return typeof e=="string"?Xo.createElement(qe,{variantFluent:"secondaryStandard",key:"text",accessible:!1},e):e}var Xo,$_e,aZ,sZ=f(()=>{"use strict";s();rt();mb();Oe();Xo=S(L());ID();ln();F1();Vo();Tr();Kn();yo();xO();go();dn();rr();JC();eZ();Tl();gn();oZ();$_e=Xo.memo(function(t){var r=t.assignees.length>1?iZ(t.localizationAPI.getString(251)):wY(yb(t.text),function(){return Xo.createElement(qe,{variantFluent:"secondarySemibold",key:"name",accessible:!1},Fr(t.assignees[0]))}).map(iZ);return Xo.createElement(Xo.Fragment,null,r)}),aZ=Xo.memo(function(t){var r=t.localizationAPI.getString(111),n=gS(t.assignees),o=cE(t.completion),a,d;t.assignees.length>0?(a=X8(t.assignees,t.localizationAPI),d=J8(t.assignees,o,t.localizationAPI)):(a=lF(t.localizationAPI),d=fF(o,t.localizationAPI));var c=t.id,u=t.onResolveTaskCheckboxPressed,l=Xo.useCallback(function(){u&&u(c)},[u,c]),p=gD(Qe(ZJ)),g=function(v,y,T){var b=p(v,y),I=Ht(y),E=[rZ],P=I.text;return n&&(E.push(nZ,{backgroundColor:I.assignedToYouBackground}),P=I.assignedToYouText),Xo.createElement(ee,{key:"tasktopper",style:W0.render(Wr(T.renderContextType))},Xo.createElement(b,{isTabbable:t.isTabbable,disabled:t.displayMode===$f.ReadOnly||t.displayMode===$f.Disabled,preventDefaultKeyDownBehavior:t.preventDefaultKeyDownBehavior,checked:o,onChange:l,accessibilityLabel:d,nodeId:"card-task-header",tooltip:eW(!1,t.localizationAPI)}),Xo.createElement(ee,{style:E,tooltip:tW(t.assignees,t.localizationAPI)},Xo.createElement(qe,{numberOfLines:1,variantFluent:"secondarySemibold",colorFluent:P,accessible:!1},t.assignees.length>0&&!n?Xo.createElement($_e,{text:r,assignees:t.assignees,localizationAPI:t.localizationAPI}):a)))};return We(g,Ge,At,tn)})});var AN,dZ=f(()=>{"use strict";s();je();AN=ve({marginLeft:5,marginBottom:3})});var rx,pp,cZ=f(()=>{"use strict";s();Oe();rx=S(L());ye();kv();Vo();Tr();yo();gn();dZ();pp=rx.memo(function(t){var r=function(o){if(t.draftWarningState){var a=Ht(o),d=AI(t.localizationAPI,t.draftWarningState.type);return rx.createElement(qe,{style:t.target===Md.Card?AN:void 0,textStylePolyester:"Error",variantFluent:"secondaryStandard",colorFluent:a.warningTextColor,testID:t.id},d)}return fS()&&t.defaultToPostingTip?rx.createElement(qe,{variantFluent:"secondaryStandard",colorFluent:"subText",key:"posting-tip",accessible:!0,style:AN},t.localizationAPI.getString(233)):null};return We(r,At)})});var r_=f(()=>{"use strict";s();cZ()});var kN,ss,n_=f(()=>{"use strict";s();(function(e){e[e.RootPost=1]="RootPost",e[e.ReplyPost=2]="ReplyPost",e[e.ViewMoreRepliesButton=3]="ViewMoreRepliesButton"})(kN||(kN={}));ss=kN});function J_e(e,t){switch(e){case ss.RootPost:return 4+t*lZ;case ss.ReplyPost:return 30+t*lZ;case ss.ViewMoreRepliesButton:return 6;default:Me(e)}}function Z_e(e){switch(e){case ss.RootPost:return 0;case ss.ReplyPost:return-4;case ss.ViewMoreRepliesButton:return 4;default:Me(e)}}var uZ,X_e,lZ,fZ,pZ=f(()=>{"use strict";s();ne();rt();n_();xr();uZ=8,X_e=1,lZ=20;fZ=Qe(function(e,t){return new R([R.always(function(r){return{backgroundColor:r.palette.UnreadDotColor,borderColor:r.palette.UnreadDotBorderColor,borderRadius:4,borderStyle:"solid",borderWidth:X_e,height:uZ,width:uZ,position:"absolute",top:J_e(e,t),left:Z_e(e)}})])})});var nx,mZ,ox,gZ=f(()=>{"use strict";s();nx=S(L()),mZ=S(re());je();rr();pZ();ox=nx.memo(function(t){var r=fZ(t.dotType,t.historyItemCount);return nx.createElement(Ge.Consumer,null,function(n){return nx.createElement(mZ.View,{style:Je(r,n,t.renderContextType)})})})});var DN=f(()=>{"use strict";s();gZ()});var hZ,yZ=f(()=>{"use strict";s();Pt();hZ=function(){function e(t){var r=t.nativeEvent,n=r.eventPhase,o=r.altKey,a=r.shiftKey,d=r.ctrlKey,c=r.metaKey;this.eventPhase=n,this.altKey=o,this.shiftKey=a,this.ctrlKey=d,this.metaKey=c,this.key=mc(t.nativeEvent.key),this.target=t.target}return e.prototype.isEventTarget=function(t){return t===this.target},e.prototype.preventDefault=function(){},e.prototype.stopPropagation=function(){},e}()});function CZ(e){return new hZ(e)}function vZ(){return{nativeEvent:void 0,currentTarget:void 0,target:void 0,bubbles:!1,cancelable:!1,defaultPrevented:!1,eventPhase:0,isTrusted:!1,preventDefault:function(){},isDefaultPrevented:function(){return!1},stopPropagation:function(){},isPropagationStopped:function(){return!1},persist:function(){},timeStamp:Date.now(),type:""}}var wN=f(()=>{"use strict";s();yZ()});function o_(e){return e.map(function(t){return{name:t}})}var i_,ix=f(()=>{"use strict";s();i_=function(t,r){return t}});var xZ,a_,tRe,nr,FN=f(()=>{"use strict";s();k();rt();Pt();xZ=S(of()),a_=S(L());wN();Gc();ix();tRe=js(xZ.TouchableWin32),nr=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.refManager=new nf,n.focus=n.refManager.focus,n.blur=n.refManager.blur,n.getFocusState=n.refManager.getFocusState,n.getChildNodes=n.refManager.getChildNodes,n.addChildNode=n.refManager.addChildNode,n.getDescendantById=n.refManager.getDescendantById,n.getId=n.refManager.getId,n.getData=n.refManager.getData,n.isTabbable=n.refManager.isTabbable,n.getNextTabTarget=n.refManager.getNextTabTarget,n.getIterator=n.refManager.getIterator,n.onFocusStateChange=function(o){n.setState({hasFocus:o!==ce.Unfocused}),n.props.onFocusStateChange&&n.props.onFocusStateChange(o)},n.getOnAccessibilityOrKeyPress=vn(function(o,a){return o||a?function(d){if(!(d&&d.target!==d.currentTarget)){if(o){o();return}a&&a(d??vZ())}}:void 0},function(){return[n.props.onAccessibilityOrKeyPress,n.props.onPress]}),n.renderStyle=function(o){return o.isFocused?[n.props.style,n.props.focusedStyle]:o.isHovered?[n.props.style,n.props.hoveredStyle]:o.isPressed?[n.props.style,n.props.pressedStyle]:n.props.style},n.state={hasFocus:!1},n}return t.prototype.render=function(){var r=this.props,n=r.focusedStyle,o=r.hoveredStyle,a=r.pressedStyle,d=r.style,c=r.onAccessibilityOrKeyPress,u=r.onFocusStateChange,l=r.onPress,p=r.pointerEvents,g=r.accessibilityRole,h=Ke(r,["focusedStyle","hoveredStyle","pressedStyle","style","onAccessibilityOrKeyPress","onFocusStateChange","onPress","pointerEvents","accessibilityRole"]);return a_.createElement(tRe,m({},h,{renderStyle:this.renderStyle,touchableHandlePress:this.props.onPress,touchableHandleKeyPressDown:this.getOnAccessibilityOrKeyPress(),focusable:!this.props.disabled,ref:this.refManager.ref,accessibilityRole:i_(g)||"button",onFocusStateChange:this.onFocusStateChange,onAccessibilityTap:this.getOnAccessibilityOrKeyPress()}))},t}(a_.PureComponent)});var Ki=f(()=>{"use strict";s();FN()});var s_,d_,ON,NN,TZ,bZ,SZ,IZ=f(()=>{"use strict";s();Ve();zc();go();xr();s_=5,d_=17,ON=16,NN=d_+Rr+Gg,TZ=new R([R.always(function(e){return{justifyContent:"center",paddingRight:ON,paddingLeft:d_,paddingBottom:1,marginRight:s_,marginLeft:s_,minHeight:qK,borderWidth:1,borderColor:e.palette.ExpandButtonBackground,backgroundColor:e.palette.ExpandButtonBackground}}),R.rule({renderContextType:A.DiscreteIsolated},{paddingLeft:NN})]),bZ=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}})]),SZ=new R([R.always(function(e){return{backgroundColor:e.palette.ExpandButtonHoverBackground,borderColor:e.palette.ExpandButtonHoverBackground}})])});function nRe(e){e(!0)}function oRe(e){e(!1)}function iRe(e,t,r,n){return e&&t!==7?n.text:r?n.expandButtonTextHoverColor:n.expandButtonTextColor}function aRe(e,t){var r=e===A.DiscreteIsolated?NN:d_,n=s_-t;return{marginLeft:t,marginRight:t,paddingLeft:r+n,paddingRight:ON+n}}var ya,c_,EZ=f(()=>{"use strict";s();k();te();Oe();By();ya=S(L());n_();Ve();Tr();yo();go();je();rr();DN();Ki();mr();gn();IZ();c_=ya.memo(function(e){var t=V(ya.useState(!1),2),r=t[0],n=t[1],o=V(ya.useState(ce.Unfocused),2),a=o[0],d=o[1],c=ya.useCallback(function(){return nRe(n)},[n]),u=ya.useCallback(function(){return oRe(n)},[n]);return We(function(l,p){var g=Ht(p),h=[Je(TZ,l,e.renderContextType)];return r&&h.push(Je(SZ,l,e.renderContextType)),a===ce.FocusOn&&h.push(Je(bZ,l,e.renderContextType)),l.themeId===7&&(e.minimumMarginLeftRight?h.push(aRe(e.renderContextType,e.minimumMarginLeftRight)):x().assertConditionTag(!1,"minimumMarginLeftRight should be defined.",557949464)),ya.createElement(nr,{animationClass:e.animationClass,onPress:e.onPress,accessibilityLabel:e.innerText,nodeId:e.id,testID:e.id,isTabbable:!!e.isTabbable,accessible:!0,onMouseEnter:c,onMouseLeave:u,onFocusStateChange:d,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior},ya.createElement(ee,{style:h},e.unreadPostHidden?ya.createElement(ox,{dotType:ss.ViewMoreRepliesButton,historyItemCount:0,renderContextType:e.renderContextType}):null,ya.createElement(qe,{textStylePolyester:"MediumApp",variantFluent:"secondarySemibold",colorFluent:iRe(e.isCardResolved,l.themeId,r,g),style:e.isCardResolved?Je(qg,l,e.renderContextType):void 0,accessible:!1},e.innerText)))},Ge,At)});c_.displayName="ExpandCardButton"});var PZ=f(()=>{"use strict";s();EZ()});function u_(e){return e.tooltipText||e.text}var MN=f(()=>{"use strict";s()});var l_,LN,HN,Si,kl=f(()=>{"use strict";s();l_=S(L()),LN=l_.createContext({isControlled:!1,checked:[],defaultChecked:[],hasCheckmarks:!1,hasIcons:!1,hasTooltips:!1,isSubmenu:!1,open:!1,onCheckedChange:function(){return!1},setOpen:function(){return!1},shouldFocusOnContainer:void 0,triggerRef:null,hasMaxHeight:!1,hasMaxWidth:!1}),HN=LN.Provider,Si=function(){return l_.useContext(LN)}});var f_,_Z,RZ,mp,ax=f(()=>{"use strict";s();f_=S(L()),_Z=f_.createContext({isCheckedControlled:!1,checked:{},hasCheckmarks:!1,hasIcons:!1,hasTooltips:!1,onCheckedChange:function(){return!1},onArrowClose:function(){return!1},addRadioItem:function(){return!1},removeRadioItem:function(){return!1},trackMenuItem:function(){return!1},untrackMenuItem:function(){return!1}}),RZ=_Z.Provider,mp=function(){return f_.useContext(_Z)}});var BN,AZ,kZ,DZ,UN=f(()=>{"use strict";s();BN=S(L()),AZ=BN.default.createContext(!1),kZ=AZ.Provider,DZ=function(){return BN.default.useContext(AZ)}});var VN=f(()=>{"use strict";s();kl()});var jN,wZ,FZ=f(()=>{"use strict";s();jN="Menu";(function(e){e[e.Hidden=0]="Hidden",e[e.Animating=1]="Animating",e[e.Shown=2]="Shown"})(wZ||(wZ={}))});var OZ,NZ,MZ=f(()=>{"use strict";s();OZ=S(L());VN();NZ=function(t,r,n){var o=t[0],a=t[1];return OZ.default.createElement(HN,{value:r},o,n.open&&n.shouldFocusOnContainer!==void 0&&a)}});var Dl,KLt,sRe,WN,dRe,cRe,LZ=f(()=>{"use strict";s();k();Dl=S(L()),KLt=S(re());An();kl();sRe=150,WN=function(t){var r=Dl.default.useRef(),n=Si(),o=n.triggerRef!==null,a=typeof t.open<"u",d=dRe(a,t,n.setOpen),c=d[0],u=d[1],l=d[2],p=cRe(t),g=p[0],h=p[1],v=o,y=o?n.popoverHoverOutTimer:void 0;return m(m({openOnHover:v},t),{open:c,setOpen:l,shouldFocusOnContainer:u,checked:g,onCheckedChange:h,triggerRef:r,isSubmenu:o,isControlled:a,parentPopoverHoverOutTimer:y})},dRe=function(t,r,n){var o=r.defaultOpen,a=r.onOpenChange,d=r.open,c=typeof o<"u"?o:!!d,u=Dl.default.useState(c),l=u[0],p=u[1],g=Dl.default.useState(void 0),h=g[0],v=g[1],y=t?d:l,T=Dl.default.useRef(-1),b=Dl.default.useCallback(function(I,E,P){var _=y;!t&&(!E||T.current+sRe<=Date.now())&&p(E),E&&(Z0(I)?v(!0):v(!1)),E||(v(void 0),T.current=Date.now()),a&&_!==E&&a(I,E),P&&n&&n(I,E,P)},[t,y,a,p,n]);return[y,h,b]},cRe=function(t){var r,n=t.checked,o=t.defaultChecked,a=t.onCheckedChange,d=Dl.default.useState((r=o??n)!==null&&r!==void 0?r:[]),c=d[0],u=d[1],l=typeof n<"u",p=l?n:c,g=Dl.default.useCallback(function(h,v){l||u(v),a==null||a(h,v)},[l,u,a]);return[p,g]}});var zN,GN,HZ=f(()=>{"use strict";s();k();zN=S(L()),GN=function(t){var r=zN.default.useState(),n=r[0],o=r[1],a=zN.default.useState(),d=a[0],c=a[1];return m(m({},t),{popoverHoverOutTimer:d,triggerHoverOutTimer:n,setPopoverHoverOutTimer:c,setTriggerHoverOutTimer:o})}});var BZ,gp,UZ=f(()=>{"use strict";s();BZ=S(L());Oe();FZ();MZ();LZ();HZ();gp=Rn(function(e){var t=WN(e),r=GN(t);return function(n,o){var a=BZ.default.Children.toArray(o);return NZ(a,r,t)}});gp.displayName=jN});var VZ=f(()=>{"use strict";s();UZ()});var qN,jZ=f(()=>{"use strict";s();qN="MenuTrigger"});function zZ(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=WZ.useCallback(function(n){r.current=n;for(var o=0,a=e;o<a.length;o++){var d=a[o];typeof d=="function"?d(n):d&&(d.current=n)}},w([],e,!0));return r}var WZ,GZ=f(()=>{"use strict";s();k();WZ=S(L())});var yHt,qZ,KZ=f(()=>{"use strict";s();yHt=S(re()),qZ=500});var hp,bHt,YZ,uRe,lRe,KN,$Z=f(()=>{"use strict";s();k();hp=S(L()),bHt=S(re());GZ();KZ();kl();YZ=[{name:"Expand"},{name:"Collapse"}],uRe={expanded:!0},lRe={expanded:!1},KN=function(t){var r=Si(),n=r.hoverDelay,o=n===void 0?qZ:n,a=r.open,d=r.openOnHover,c=r.popoverHoverOutTimer,u=r.setOpen,l=r.setTriggerHoverOutTimer,p=r.triggerHoverOutTimer,g=r.triggerRef,h=t.accessibilityActions,v=t.accessibilityState,y=t.onAccessibilityAction,T=t.accessibilityPositionInSet,b=t.accessibilitySetSize,I=t.onClick,E=t.onHoverIn,P=t.onHoverOut,_=t.componentRef,D=hp.default.useMemo(function(){return h?w(w([],YZ,!0),h,!0):YZ},[h]),M=hp.default.useMemo(function(){var B=a?uRe:lRe;return v?m(m({},B),v):B},[v,a]),H=hp.default.useCallback(function(B){switch(B.nativeEvent.actionName){case"Expand":u(B,!0);break;case"Collapse":u(B,!1);break}y&&y(B)},[y,u]),U=hp.default.useCallback(function(B){d&&(clearTimeout(c),clearTimeout(p),B.persist(),setTimeout(function(){u(B,!0)},o)),E&&E(B)},[E,o,d,u,p,c]),F=hp.default.useCallback(function(B){if(d){B.persist();var q=setTimeout(function(){u(B,!1)},o);l(q)}P&&P(B)},[P,o,d,u,l]),z=hp.default.useCallback(function(B){u(B,!a),I&&I(B)},[I,a,u]),Y=zZ(g,_);return{props:{onClick:z,onHoverIn:U,onHoverOut:F,componentRef:Y,accessibilityState:M,accessibilityActions:D,onAccessibilityAction:H,accessibilityPositionInSet:T??r.accessibilityPositionInSet,accessibilitySetSize:b??r.accessibilitySetSize},hasSubmenu:r.isSubmenu}}});var p_,yp,QZ=f(()=>{"use strict";s();k();p_=S(L());jZ();$Z();UN();yp=function(t){var r=KN(t.children.props),n=p_.cloneElement(t.children,m(m({},t.children.props.tooltip&&{alwaysShowToolTip:!0}),r.props));return p_.createElement(kZ,{value:r.hasSubmenu},n)};yp.displayName=qN});var XZ=f(()=>{"use strict";s();QZ()});var sx,YN=f(()=>{"use strict";s();sx="MenuPopover"});var JZ,ZZ=f(()=>{"use strict";s();Oe();YN();JZ=Zf(function(e){return{borderWidth:1,borderColor:e.colors.neutralStrokeAccessible}},sx)});var $c,tee,fRe,eee,$N,pRe,ree=f(()=>{"use strict";s();$c=S(L()),tee=S(re());kl();fRe=["preventDismissOnKeyDown","preventDismissOnClickOutside"],eee=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Tab","Home","End","Escape"],$N=function(t){var r,n,o=Si(),a=o.setOpen,d=o.triggerRef,c=o.isControlled,u=o.isSubmenu,l=o.openOnHover,p=o.parentPopoverHoverOutTimer,g=o.popoverHoverOutTimer,h=o.setPopoverHoverOutTimer,v=o.shouldFocusOnContainer,y=o.triggerHoverOutTimer,T=t.onKeyDown,b=t.onKeyUp,I=$c.default.useCallback(function(){var $;($=t.onDismiss)===null||$===void 0||$.call(t),a(void 0,!1)},[t.onDismiss,a]),E=c?fRe:void 0,P=(r=t.directionalHint)!==null&&r!==void 0?r:pRe(u,tee.I18nManager.isRTL),_=!0,D=(n=t.doNotTakePointerCapture)!==null&&n!==void 0?n:l,M="menu",H=$c.default.useCallback(function(){clearTimeout(y),clearTimeout(g),clearTimeout(p)},[p,g,y]),U=$c.default.useCallback(function(){if(l){var $=setTimeout(function(){a(void 0,!1)},500);h($)}},[l,a,h]),F=$c.default.useCallback(function($){T&&T($),eee.includes($.nativeEvent.key)&&$.stopPropagation()},[T]),z=$c.default.useCallback(function($){b&&b($),eee.includes($.nativeEvent.key)&&$.stopPropagation()},[b]),Y=$c.default.useState(v),B=Y[0],q=Y[1],K=$c.default.useCallback(function(){q(!1)},[q]);return $c.default.useEffect(function(){return function(){clearTimeout(g)}}),{props:{accessibilityRole:M,target:d,onDismiss:I,onShow:t.onShow,directionalHint:P,dismissBehaviors:E,doNotTakePointerCapture:D,setInitialFocus:_},innerView:{onMouseEnter:H,onMouseLeave:U,onKeyDown:F,onKeyUp:z,accessible:v,focusable:B,onBlur:K}}},pRe=function(t,r){if(t)return r?"leftTopEdge":"rightTopEdge"}});var nee,oee=f(()=>{"use strict";s();nee="MenuCallout"});var iee,m_,aee=f(()=>{"use strict";s();k();iee=S(L());$v();Oe();Oe();oee();m_=Rn(function(e){return function(t,r){var n=dt(e,t);return iee.default.createElement(zi,m({},n),r)}});m_.displayName=nee});var see=f(()=>{"use strict";s();aee()});var QN,dee,wl,cee=f(()=>{"use strict";s();k();QN=S(L()),dee=S(re());Oe();YN();ZZ();ree();VN();see();wl=Cl(function(e,t){var r,n=e.directionalHint,o=e.gapSpace,a=e.maxHeight,d=e.maxWidth,c=e.minWidth,u=e.minPadding,l=e.borderWidth,p=e.borderColor,g=e.backgroundColor,h=$N(e),v=fa(),y=Si(),T=t(v),b=T[0],I=T[1];return y.hasMaxHeight=a!=null,y.minWidth=c??y.minWidth,r=Xf(b,I,{directionalHint:n,gapSpace:o,maxHeight:a,maxWidth:d,minWidth:c,minPadding:u,borderWidth:l,borderColor:p,backgroundColor:g}),b=r[0],I=r[1],function(E,P){var _=dt(b,h.props,E),D=m(m({},h.innerView),{style:{maxHeight:_.maxHeight}}),M=QN.default.createElement(dee.View,D,P);return QN.default.createElement(m_,m({tokens:b},_),M)}},JZ);wl.displayName=sx});var uee=f(()=>{"use strict";s();cee()});var dx,XN=f(()=>{"use strict";s();dx="MenuItem"});var lee,fee=f(()=>{"use strict";s();xi();lee=function(t){return{backgroundColor:t.colors.neutralBackground1,borderRadius:O.corner.radiusNone,checkmarkSize:16,color:t.colors.neutralForeground1,fontFamily:t.typography.families.primary,fontSize:O.font.size200,fontWeight:O.font.weight.regular,gap:O.size40,iconColor:t.colors.neutralForeground1,iconSize:16,minHeight:24,minWidth:128,maxWidth:300,padding:O.size40,paddingHorizontal:O.size80,submenuIndicatorColor:t.colors.neutralForeground1,submenuIndicatorPadding:O.size20,submenuIndicatorSize:16,pressed:{backgroundColor:t.colors.neutralBackground1Pressed,color:t.colors.neutralForeground1Pressed,iconColor:t.colors.neutralForeground1Pressed,submenuIndicatorColor:t.colors.neutralForeground1Pressed},disabled:{backgroundColor:t.colors.neutralBackground1,color:t.colors.neutralForegroundDisabled,iconColor:t.colors.neutralForegroundDisabled,submenuIndicatorColor:t.colors.neutralForegroundDisabled},focused:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,iconColor:t.colors.neutralForeground1Hover,submenuIndicatorColor:t.colors.neutralForeground1Hover}}}});var IBt,mRe,pee,mee=f(()=>{"use strict";s();k();IBt=S(re());Oe();_n();XN();fee();mRe=["hovered","focused","pressed","disabled"],pee={tokens:[lee,dx],states:mRe,slotProps:{root:ct(function(e,t){return{style:m(m({alignItems:"center",backgroundColor:e.backgroundColor,display:"flex",flexDirection:"row"},ko.from(e,t)),Ko.from(e,t))}},w(w(["backgroundColor"],Ko.keys,!0),ko.keys,!0)),checkmark:ct(function(e){return{style:{height:e.checkmarkSize,width:e.checkmarkSize,marginEnd:e.gap}}},["checkmarkSize","gap"]),content:ct(function(e,t){return{color:e.color,style:m({flexGrow:1},Zr.from(e,t))}},w(["color"],Zr.keys,!0)),iconPlaceholder:ct(function(e){return{style:{minHeight:e.iconSize,minWidth:e.iconSize,alignItems:"center",justifyContent:"center",marginEnd:e.gap}}},["checkmarkSize","gap"]),imgIcon:ct(function(e){return{style:{tintColor:e.iconColor,height:e.iconSize,width:e.iconSize}}},["gap","iconColor","iconSize"]),fontOrSvgIcon:ct(function(e){return{color:e.iconColor,size:e.iconSize}},["gap","iconColor","iconSize"]),submenuIndicator:ct(function(e){return{color:e.submenuIndicatorColor,height:e.submenuIndicatorSize,width:e.submenuIndicatorSize,viewBox:"0 0 ".concat(e.submenuIndicatorSize," ").concat(e.submenuIndicatorSize)}},["submenuIndicatorColor","submenuIndicatorPadding","submenuIndicatorSize"])}}});var Yi,FBt,JN,gRe,hRe,yRe,CRe,ZN,g_,h_=f(()=>{"use strict";s();k();Yi=S(L()),FBt=S(re());kl();ax();JN=[],gRe=function(t){JN.push(t)},hRe=function(t){JN.filter(function(r){return r!==t})},yRe=["ios","macos"],CRe=["Home","End"],ZN=function(t){var r,n,o=Si(),a=o.defaultChecked,d=o.onCheckedChange,c=o.checked,u=o.isSubmenu,l=o.setOpen,p=o.triggerRef,g=Yi.default.useMemo(function(){var z={};if(!c)return z;for(var Y=0,B=c;Y<B.length;Y++){var q=B[Y];z[q]=!0}return z},[c]),h=Yi.default.useState(function(){if(g)return g;for(var z=a??[],Y={},B=0,q=z;B<q.length;B++){var K=q[B];Y[K]=!0}return Y}),v=h[0],y=h[1],T=typeof c<"u",b=T?g:v,I=Yi.default.useCallback(function(z,Y,B){var q=m({},b);B?q[Y]=!0:delete q[Y],T||y(q),d&&d(z,Object.keys(q))},[T,b,d,y]),E=Yi.default.useCallback(function(z,Y){for(var B={},q=0,K=Object.keys(b);q<K.length;q++){var $=K[q];JN.includes($)||(B[$]=b[$])}B[Y]=!0,T||y(B),d&&d(z,Object.keys(B))},[T,d,y,b]),P=Yi.default.useCallback(function(z){var Y;u&&(l(z,!1,!1),(Y=p==null?void 0:p.current)===null||Y===void 0||Y.focus())},[u,l,p]),_=Yi.default.useMemo(function(){return[]},[]),D=Yi.default.useCallback(function(z){return _.push(z)},[_]),M=Yi.default.useCallback(function(z){return _.splice(_.findIndex(function(Y){return Y.ref===z.ref}),1)},[_]),H=function(Y){var B,q=Y.nativeEvent.key;if(CRe.includes(q)){var K=void 0,$=void 0;for(q==="Home"?(K=1,$=0):q==="End"&&(K=-1,$=_.length-1);yRe.includes("win32")&&_[$].disabled;)$+=K;(B=_[$].ref.current)===null||B===void 0||B.focus()}};Yi.default.useEffect(function(){return function(){clearTimeout(o.triggerHoverOutTimer)}});var U=Yi.default.useRef(),F=function(){var Y;(Y=U==null?void 0:U.current)===null||Y===void 0||Y.focus()};return Yi.default.useEffect(function(){F()},[]),{props:m(m({},o),{onMouseLeave:o.onMouseLeave,onKeyDown:H}),isCheckedControlled:T,checked:b,onArrowClose:P,onCheckedChange:I,selectRadio:E,addRadioItem:gRe,removeRadioItem:hRe,trackMenuItem:D,untrackMenuItem:M,hasMaxHeight:(r=o.hasMaxHeight)!==null&&r!==void 0?r:!1,hasMaxWidth:(n=o.hasMaxWidth)!==null&&n!==void 0?n:!1,focusZoneRef:U}},g_=function(t,r){var n=mp(),o=n.trackMenuItem,a=n.untrackMenuItem,d=Yi.default.useMemo(function(){return{ref:t,disabled:r}},[t,r]);Yi.default.useEffect(function(){return o(d),function(){return a(d)}},[])}});function xRe(e,t){return t?m({disabled:e},t):{disabled:e}}var Yd,gee,y_,eM,tM,vRe,rM,nM=f(()=>{"use strict";s();k();Yd=S(L()),gee=S(re());Oe();An();kl();ax();UN();h_();y_=[" ","Enter"],eM=w(["ArrowLeft","ArrowRight"],y_,!0),tM=function(t){var r=Yd.useRef(null),n=t.accessible,o=t.onClick,a=t.accessibilityState,d=t.componentRef,c=d===void 0?r:d,u=t.disabled,l=u===void 0?!1:u,p=t.persistOnClick,g=Ke(t,["accessible","onClick","accessibilityState","componentRef","disabled","persistOnClick"]),h=Si(),v=h.isSubmenu,y=h.persistOnItemClick,T=h.setOpen,b=mp(),I=b.hasCheckmarks,E=b.hasIcons,P=b.hasTooltips,_=b.onArrowClose,D=DZ(),M=p??y,H=v&&D,U=Yd.useCallback(function(Ce){var se,he=gee.I18nManager.isRTL,Be=Qg(Ce)&&(Ce.nativeEvent.key==="ArrowLeft"||Ce.nativeEvent.key==="ArrowRight"),_e=H&&Qg(Ce)&&(he&&Ce.nativeEvent.key==="ArrowLeft"||!he&&Ce.nativeEvent.key==="ArrowRight");!l&&(!Be||_e)&&((se=c==null?void 0:c.current)===null||se===void 0||se.blur(),o==null||o(Ce)),!H&&!Be&&!M&&T(Ce,!1,!0);var ot=Qg(Ce)&&(he&&Ce.nativeEvent.key==="ArrowRight"||!he&&Ce.nativeEvent.key==="ArrowLeft");ot&&(_==null||_(Ce))},[c,l,H,_,o,T,M]),F=Vd(m(m({},g),{onPress:U})),z=Ar(c),Y=l?[]:v?eM:y_,B=jd.apply(void 0,w([U],Y,!1));rM(F.state.hovered,c);var q=Yd.useState(!F.state.hovered),K=q[0],$=q[1],oe=Yd.useCallback(function(Ce){F.props.onHoverIn(Ce),F.state.focused||$(!1)},[F]),ie=Yd.useCallback(function(Ce){F.props.onFocus(Ce),F.state.focused||$(!0)},[F]);return g_(c,l),{props:m(m(m({},F.props),{onHoverIn:oe,onFocus:ie,accessible:n??!0,accessibilityRole:"menuitem",onAccessibilityTap:t.onAccessibilityTap||U,accessibilityState:vRe(l,a),disabled:l,enableFocusRing:K,focusable:!0,ref:z}),B),state:m(m({},F.state),{hasSubmenu:H,hasIcons:E,hasCheckmarks:I,hasTooltips:P})}},vRe=Qt(xRe);rM=function(t,r){Yd.useLayoutEffect(function(){var n,o;t?(n=r==null?void 0:r.current)===null||n===void 0||n.focus():(o=r==null?void 0:r.current)===null||o===void 0||o.blur()},[t,r])}});var Qc,hee,Cp,TRe,oM,bRe,iM,aM=f(()=>{"use strict";s();k();Qc=S(re());Oe();op();pa();hee=S(tp());mee();XN();nM();Cp=en(m(m({displayName:dx},pee),{slots:{root:Qc.Pressable,checkmark:Qc.View,content:br,iconPlaceholder:Qc.View,imgIcon:Qc.Image,fontOrSvgIcon:np,submenuIndicator:hee.SvgXml},useRender:function(t,r){var n=tM(t),o=r(t,function(a){return n.state[a]||t[a]});return function(a,d){var c=dt(n.props,a),u=c.accessibilityLabel,l=c.icon,p=c.tooltip,g=Ke(c,["accessibilityLabel","icon","tooltip"]),h=Qc.I18nManager.isRTL?"\n          <svg>\n          <path fill='currentColor' d=\"M10.2603 3.20041C10.5639 3.48226 10.5814 3.95681 10.2996 4.26034L6.77348 8L10.2996 11.7397C10.5814 12.0432 10.5639 12.5177 10.2603 12.7996C9.9568 13.0815 9.48226 13.0639 9.2004 12.7603L5.2004 8.51034C4.9332 8.22258 4.9332 7.77743 5.2004 7.48966L9.20041 3.23966C9.48226 2.93613 9.95681 2.91856 10.2603 3.20041Z\"/>\n          </svg>":"\n          <svg>\n          <path fill='currentColor' d=\"M5.73966 3.20041C5.43613 3.48226 5.41856 3.95681 5.70041 4.26034L9.22652 8L5.70041 11.7397C5.41856 12.0432 5.43613 12.5177 5.73967 12.7996C6.0432 13.0815 6.51775 13.0639 6.7996 12.7603L10.7996 8.51034C11.0668 8.22258 11.0668 7.77743 10.7996 7.48966L6.7996 3.23966C6.51775 2.93613 6.0432 2.91856 5.73966 3.20041Z\"/>\n          </svg>",v=oM(u,d[0]),y=iM(p,n.state.hasTooltips,d[0]);return we(o.root,m({},g,{accessibilityLabel:v}),n.state.hasCheckmarks&&we(o.checkmark,{accessible:!1}),(l||n.state.hasIcons)&&we(o.iconPlaceholder,{accessible:!1},l&&l.source&&we(o.imgIcon,m({accessible:!1},l)),l&&(l.svgSource||l.fontSource)&&we(o.fontOrSvgIcon,m({accessible:!1},l))),d&&we(o.content,m({accessible:!1,tooltip:y},y&&{alwaysShowToolTip:!0}),d),n.state.hasSubmenu&&we(o.submenuIndicator,{accessible:!1,xml:h}))}}})),TRe=function(t,r){if(t!==void 0)return t;if(typeof r=="string")return r},oM=Qt(TRe),bRe=function(t,r,n){if(t!==void 0)return t;if(r&&typeof n=="string")return n},iM=Qt(bRe)});var yee=f(()=>{"use strict";s();aM()});var cx,sM=f(()=>{"use strict";s();cx="MenuItemCheckbox"});var Cee,vee=f(()=>{"use strict";s();xi();Cee=function(t){return{backgroundColor:t.colors.neutralBackground1,borderRadius:O.corner.radiusNone,checkmarkPadding:O.size20,checkmarkSize:16,checkmarkVisibility:0,color:t.colors.neutralForeground1,fontFamily:t.typography.families.primary,fontSize:O.font.size200,fontWeight:O.font.weight.regular,gap:O.size40,iconColor:t.colors.neutralForeground1,iconSize:16,minHeight:24,minWidth:160,maxWidth:300,padding:O.size40,paddingHorizontal:O.size80,pressed:{backgroundColor:t.colors.neutralBackground1Pressed,color:t.colors.neutralForeground1Pressed,iconColor:t.colors.neutralForeground1Pressed,checked:{checkmarkColor:t.colors.neutralForeground1Pressed,checkmarkVisibility:1}},disabled:{backgroundColor:t.colors.neutralBackground1,color:t.colors.neutralForegroundDisabled,iconColor:t.colors.neutralForegroundDisabled,checked:{checkmarkColor:t.colors.neutralForegroundDisabled,checkmarkVisibility:1}},focused:{backgroundColor:t.colors.neutralBackground1Hover,color:t.colors.neutralForeground1Hover,iconColor:t.colors.neutralForeground1Hover,checked:{checkmarkColor:t.colors.neutralForeground1Hover,checkmarkVisibility:1}},checked:{checkmarkColor:t.colors.neutralForeground1,checkmarkVisibility:1}}}});var p3t,SRe,xee,Tee=f(()=>{"use strict";s();k();p3t=S(re());Oe();_n();sM();vee();SRe=["hovered","focused","pressed","disabled","checked"],xee={tokens:[Cee,cx],states:SRe,slotProps:m(m({root:ct(function(e,t){return{style:m(m({alignItems:"center",backgroundColor:e.backgroundColor,display:"flex",flexDirection:"row"},ko.from(e,t)),Ko.from(e,t))}},w(w(["backgroundColor"],Ko.keys,!0),ko.keys,!0))},!1),{checkmark:ct(function(e){var t;return m({opacity:e.checkmarkVisibility,color:(t=e.checkmarkColor)!==null&&t!==void 0?t:e.color,height:e.checkmarkSize,width:e.checkmarkSize,viewBox:"0 0 "+(e.checkmarkSize-e.checkmarkPadding*2)+" "+(e.checkmarkSize-e.checkmarkPadding*2)},{style:{marginEnd:e.gap}})},["checkmarkPadding","checkmarkSize","checkmarkVisibility","color","gap"]),content:ct(function(e,t){return{style:m(m({flexGrow:1,color:e.color},!1),Zr.from(e,t))}},w(["color"],Zr.keys,!0)),iconPlaceholder:ct(function(e){return{style:{minHeight:e.iconSize,minWidth:e.iconSize,alignItems:"center",justifyContent:"center",marginEnd:e.gap}}},["checkmarkSize","gap"]),imgIcon:ct(function(e){return{style:{tintColor:e.iconColor,height:e.iconSize,width:e.iconSize}}},["gap","iconColor","iconSize"]),fontOrSvgIcon:ct(function(e){return{color:e.iconColor,size:e.iconSize}},["gap","iconColor","iconSize"])})}});function ERe(e,t,r){return r?m({disabled:e,checked:t},r):{disabled:e,checked:t}}var $d,See,bee,dM,IRe,Iee,Eee=f(()=>{"use strict";s();k();$d=S(L()),See=S(re());Oe();An();kl();ax();nM();h_();bee=[{name:"Toggle"}],dM=function(t){var r,n=t.disabled,o=n===void 0?!1:n,a=t.name,d=mp(),c=(r=d.checked)===null||r===void 0?void 0:r[a],u=d.onCheckedChange,l=$d.useCallback(function(p){o||u(p,a,!c)},[c,o,a,u]);return Iee(t,l)},IRe=Qt(ERe);Iee=function(t,r){var n=$d.useRef(null),o=t.accessibilityActions,a=t.accessibilityLabel,d=t.accessibilityState,c=t.accessible,u=t.componentRef,l=u===void 0?n:u,p=t.disabled,g=p===void 0?!1:p,h=t.name,v=t.onAccessibilityAction,y=Ke(t,["accessibilityActions","accessibilityLabel","accessibilityState","accessible","componentRef","disabled","name","onAccessibilityAction"]),T=Si().isSubmenu,b=mp(),I=b.checked,E=b.hasIcons,P=b.hasTooltips,_=b.onArrowClose,D=I==null?void 0:I[h],M=ns(l,r),H=Vd(m(m({},y),{onPress:M})),U=Ar(l),F=$d.useCallback(function(he){var Be=he.nativeEvent.key===" "||he.nativeEvent.key==="Enter";if(!g&&Be){r(he);return}var _e=See.I18nManager.isRTL,ot=T&&(_e&&he.nativeEvent.key==="ArrowRight"||!_e&&he.nativeEvent.key==="ArrowLeft");ot&&(_==null||_(he))},[g,T,_,r]),z=g?[]:T?eM:y_,Y=jd.apply(void 0,w([F],z,!1)),B=o?w(w([],bee,!0),o,!0):bee,q=$d.useCallback(function(he){g||(he.nativeEvent.actionName==="Toggle"&&r(he),v&&v(he))},[g,r,v]);rM(H.state.hovered,l);var K=$d.useState(!H.state.hovered),$=K[0],oe=K[1],ie=$d.useCallback(function(he){H.props.onHoverIn(he),H.state.focused||oe(!1)},[H]),Ce=$d.useCallback(function(he){H.props.onFocus(he),H.state.focused||oe(!0)},[H]);g_(l,g);var se=m(m({},H.state),{checked:D,disabled:g,hasIcons:E,hasTooltips:P});return{props:m(m(m({},H.props),{onHoverIn:ie,onFocus:Ce,accessible:c??!0,accessibilityActions:B,accessibilityLabel:a,accessibilityRole:"menuitem",accessibilityState:IRe(g,se.checked,d),disabled:g,enableFocusRing:$,focusable:!0,onAccessibilityAction:q,ref:U}),Y),state:se}}});var bh,Pee,C_,PRe,_ee=f(()=>{"use strict";s();k();bh=S(re());Oe();op();pa();Pee=S(tp());Tee();sM();Eee();aM();C_=en(m(m({displayName:cx},xee),{slots:m(m({root:bh.Pressable},!1),{checkmark:Pee.SvgXml,content:br,iconPlaceholder:bh.View,imgIcon:bh.Image,fontOrSvgIcon:np}),useRender:function(t,r){var n=dM(t),o=r(t,function(a){return n.state[a]||t[a]});return PRe(n,o)}})),PRe=function(t,r){return function(n,o){var a=dt(t.props,n),d=a.accessibilityLabel,c=a.icon,u=a.tooltip,l=Ke(a,["accessibilityLabel","icon","tooltip"]),p="\n    <svg>\n      <path fill='currentColor' d='M9.85355 3.14645C10.0488 3.34171 10.0488 3.65829 9.85355 3.85355L5.35355 8.35355C5.15829 8.54882 4.84171 8.54882 4.64645 8.35355L2.64645 6.35355C2.45118 6.15829 2.45118 5.84171 2.64645 5.64645C2.84171 5.45118 3.15829 5.45118 3.35355 5.64645L5 7.29289L9.14645 3.14645C9.34171 2.95118 9.65829 2.95118 9.85355 3.14645Z' />\n    </svg>",g="\n    <svg>\n      <path fill='currentColor' d='M9.76497 3.20474C10.0661 3.48915 10.0797 3.96383 9.79526 4.26497L5.54526 8.76497C5.40613 8.91228 5.21332 8.99703 5.01071 8.99993C4.8081 9.00282 4.61295 8.92361 4.46967 8.78033L2.21967 6.53033C1.92678 6.23744 1.92678 5.76257 2.21967 5.46967C2.51256 5.17678 2.98744 5.17678 3.28033 5.46967L4.98463 7.17397L8.70474 3.23503C8.98915 2.9339 9.46383 2.92033 9.76497 3.20474Z' />\n    </svg>",h=oM(d,o[0]),v=iM(u,t.state.hasTooltips,o[0]);return we(r.root,m({},l,{accessibilityLabel:h}),we(r.checkmark,{accessible:!1,xml:p}),(c||t.state.hasIcons)&&we(r.iconPlaceholder,{accessible:!1},c&&c.source&&we(r.imgIcon,m({accessible:!1},c)),c&&(c.svgSource||c.fontSource)&&we(r.fontOrSvgIcon,m({accessible:!1},c))),o&&we(r.content,m({accessible:!1,tooltip:v},v&&{alwaysShowToolTip:!0}),o))}}});var Ree=f(()=>{"use strict";s();_ee()});var ux,cM=f(()=>{"use strict";s();ux="MenuList"});var Aee,kee=f(()=>{"use strict";s();xi();Aee=function(t){return{paddingVertical:O.size40,minWidth:128,maxWidth:300,backgroundColor:t.colors.neutralBackground1,hasMaxHeight:{minWidth:140}}}});var X3t,_Re,Dee,wee=f(()=>{"use strict";s();k();X3t=S(re());Oe();_n();cM();kee();_Re=["hasMaxHeight"],Dee={tokens:[Aee,ux],states:_Re,slotProps:{root:ct(function(e,t){return{style:m(m({backgroundColor:e.backgroundColor,display:"flex"},ko.from(e,t)),!1),gap:e.gap}},w(["backgroundColor","gap"],ko.keys,!0))}}});var uM,Fee=f(()=>{"use strict";s();k();uM=function(t){return m({hasCheckmarks:t.props.hasCheckmarks,hasIcons:t.props.hasIcons,hasTooltips:t.props.hasTooltips},t)}});var Xs,v_,Mee,Oee,Nee,RRe,ARe,vp,Lee=f(()=>{"use strict";s();k();Xs=S(L()),v_=S(re());sp();Oe();wee();cM();h_();Fee();ax();Mee=Rn(function(e){var t=e.gap,r=Ke(e,["gap"]);return function(n,o){return t&&t>0&&o&&(o=Xs.default.Children.map(o,function(a,d){return Xs.default.isValidElement(a)&&d>0?Xs.default.cloneElement(a,dt(a.props,{style:{marginTop:t}})):a})),we(v_.View,m({},dt(r,n)),o)}});Mee.displayName="MenuStack";Oee=["macos","win32"].includes("win32"),Nee=!1,RRe=!0,ARe=function(t,r,n){return r[t]||n[t]||t==="hasMaxHeight"},vp=en(m(m({displayName:ux},Dee),{slots:{root:Mee,scrollView:v_.ScrollView,focusZone:Oee?as:Xs.default.Fragment},useRender:function(t,r){var n=ZN(t),o=uM(n),a=r(n.props,function(d){return ARe(d,n,t)});return function(d,c){var u=Xs.default.Children.toArray(c).filter(function(y){return Xs.default.isValidElement(y)&&y.type.displayName!=="MenuDivider"}).length,l=0,p=Xs.default.Children.toArray(c).map(function(y){var T,b;return Xs.default.isValidElement(y)?(y.type.displayName!=="MenuDivider"&&l++,Xs.default.cloneElement(y,m({accessibilityPositionInSet:(T=y.props.accessibilityPositionInSet)!==null&&T!==void 0?T:l,accessibilitySetSize:(b=y.props.accessibilitySetSize)!==null&&b!==void 0?b:u},y.props.tooltip&&{alwaysShowToolTip:!0}))):y}),g=n.hasMaxHeight||n.hasMaxWidth,h=g?a.scrollView:Xs.default.Fragment,v=we(a.root,null,we(h,m({},g&&{showsVerticalScrollIndicator:n.hasMaxHeight,showsHorizontalScrollIndicator:n.hasMaxWidth}),we(a.focusZone,m({},Oee&&{componentRef:Nee,focusZoneDirection:"vertical",defaultTabbableElement:Nee,enableFocusRing:!1,isCircularNavigation:RRe,tabKeyNavigation:"Normal"}),p)));return we(RZ,{value:o},v)}}}))});var Hee=f(()=>{"use strict";s();Lee()});var lx,lM=f(()=>{"use strict";s();lx="MenuDivider"});var Bee,Uee=f(()=>{"use strict";s();xi();Bee=function(t){return{backgroundColor:t.colors.neutralStroke1,height:O.stroke.width10,margin:O.size20}}});var R4t,Vee,jee=f(()=>{"use strict";s();k();R4t=S(re());Oe();lM();Uee();Vee={tokens:[Bee,lx],tokensThatAreAlsoProps:["insetSize"],slotProps:{root:ct(function(e){return{style:m({height:e.height,width:e.width,backgroundColor:e.backgroundColor,margin:e.margin,marginVertical:e.marginVertical,display:"flex"},!1)}},["backgroundColor","height","margin","marginVertical","width"])}}});var Wee,Sh,zee=f(()=>{"use strict";s();k();Wee=S(re());Oe();jee();lM();Sh=en(m(m({displayName:lx},Vee),{slots:{root:Wee.View},useRender:function(t,r){var n=r(t);return function(o){return we(n.root,m({},o))}}}))});var Gee=f(()=>{"use strict";s();zee()});var fM,qee=f(()=>{"use strict";s();fM="MenuGroup"});var Xc,Yee,Kee,x_,$ee=f(()=>{"use strict";s();k();Xc=S(L()),Yee=S(re());sp();Oe();qee();Kee=["win32"].includes("win32"),x_=en({displayName:fM,slots:{root:Yee.View,contentWrapper:Kee?as:Xc.default.Fragment},useRender:function(t,r){var n=r(t);return function(o,a){var d,c=Ke(dt(t,o),[]),u=0,l=Xc.default.Children.toArray(a).map(function(h){var v,y;if(Xc.default.isValidElement(h)){var T=Xc.default.Children.toArray(a).filter(function(b){return Xc.default.isValidElement(b)&&b.type.displayName!=="MenuGroupHeader"&&b.type.displayName!=="MenuDivider"}).length;return h.type.displayName!=="MenuGroupHeader"&&h.type.displayName!=="MenuDivider"&&u++,Xc.default.cloneElement(h,{accessibilityPositionInSet:(v=h.props.accessibilityPositionInSet)!==null&&v!==void 0?v:u,accessibilitySetSize:(y=h.props.accessibilitySetSize)!==null&&y!==void 0?y:T})}return h}),p=Xc.default.Children.toArray(a).find(function(h){return Xc.default.isValidElement(h)&&h.type.displayName==="MenuGroupHeader"}),g=" ";return p&&typeof p.props.children=="string"&&(g=p.props.children),we(n.root,m({},c,{accessible:!0,accessibilityRole:"group",accessibilityLabel:(d=c.accessibilityLabel)!==null&&d!==void 0?d:g}),we(n.contentWrapper,m({},Kee&&{focusZoneDirection:"vertical",enableFocusRing:!1,navigateAtEnd:"NavigateContinue"}),l))}}})});var Qee=f(()=>{"use strict";s();$ee()});var fx,pM=f(()=>{"use strict";s();fx="MenuGroupHeader"});var Xee,Jee=f(()=>{"use strict";s();xi();Xee=function(t){return{color:t.colors.neutralForeground2,fontFamily:t.typography.families.primary,fontSize:O.font.size300,fontWeight:O.font.weight.regular,gap:O.size40,padding:O.size60}}});var Zee,ete=f(()=>{"use strict";s();k();Oe();Oe();pM();Jee();Zee={tokens:[Xee,fx],slotProps:{root:ct(function(e,t){return{color:e.color,style:m({marginStart:e.gap},Zr.from(e,t))}},["color"])}}});var T_,tte=f(()=>{"use strict";s();k();Oe();pa();ete();pM();T_=en(m(m({displayName:fx},Zee),{slots:{root:br},useRender:function(t,r){var n=r(t);return function(o,a){var d=Ke(dt(t,o),[]);return we(n.root,m({accessible:t.accessible},d),a)}}}))});var rte=f(()=>{"use strict";s();tte()});var b_=f(()=>{"use strict";s();VZ();XZ();uee();yee();Ree();Hee();Gee();Qee();rte()});var Fl,px=f(()=>{"use strict";s();Fl=function(){return!0}});var Gr,nte=f(()=>{"use strict";s();rt();te();Gr=function(){function e(t){var r=this;this.compile=Qe(function(){var n={};r.color&&(n.color="0xff".concat(r.color.substr(1))),r.isColorEnabled!==void 0&&(n.isColorEnabled=String(r.isColorEnabled));var o=Object.entries(n).map(function(a){return a.join("=")}).join("&");return{uri:"ms-namex-icon:".concat(r.namex).concat(o?"?".concat(o):""),width:r.width,height:r.height}}),typeof t=="string"?this.namex=t:(this.namex=t.namex,this.isColorEnabled=t.isColorEnabled,this.color=t.color,this.width=t.width,this.height=t.height)}return e.prototype.withSize=function(t,r){var n=new e(this);return n.width=t,n.height=r??t,n},e.prototype.withColorEnabled=function(t){var r=new e(this);return r.isColorEnabled=t,r},e.prototype.withColor=function(t){if(!/^#[0-9a-f]{6}$/i.test(t))return x().assertConditionTag(!1,"Invalid icon color provided: ".concat(t),579606091),this;var r=new e(this);return r.color=t,r},e}()});var ote,ite=f(()=>{"use strict";s();rt();nte();hm();ote=Qe(function(){var e=new Gr("Send").withSize(16),t=new Gr("CancelCommentSession").withSize(16),r=new Gr("MoreCommentThreadActions").withSize(16),n=new Gr("TrashCan").withSize(16),o=new Gr("EditGeneric").withSize(16),a=new Gr("ReopenComment").withSize(16),d=new Gr("Checkmark").withSize(10),c=d.withColor(ke.WHITE),u=d.withSize(14),l=d.withSize(16),p=new Gr("NewComment").withSize(16).withColorEnabled(!0),g=new Gr("NewCommentRTL").withSize(16).withColorEnabled(!0),h=new Gr("NewComment").withSize(16),v=new Gr("NewCommentRTL").withSize(16),y=new Gr("TaskAssign").withSize(16),T=y.withColor(ke.WHITE),b=new Gr("TaskReopen").withSize(16),I=b.withColor(ke.WHITE),E=l.withColor(ke.WHITE),P=new Gr("CommentError").withSize(16),_=P.withColor(ke.WHITE),D=new Gr("CommentInfo").withSize(16),M=D.withColor(ke.WHITE),H=new Gr("TaskEdit").withSize(16),U=H.withColor(ke.WHITE),F=new Gr("TaskAssignDropdown").withSize(16),z=F.withColor(ke.WHITE),Y=new Gr("CopyLinkToClipboard").withSize(16),B=new Gr("CommentLikeSolid").withSize(16).withColorEnabled(!0),q=B.withColor(ke.WHITE),K=new Gr("CommentLikeEmpty").withSize(16),$=K.withColor(ke.WHITE),oe=new Gr("CommentFilter").withSize(16),ie=oe.withColor(ke.WHITE),Ce=new Gr("CommentDeleteFilter").withSize(16).withColorEnabled(!0),se=Ce.withColor(ke.WHITE),he=new Gr("CommentDeleteFilter").withSize(16).withColor(ke.GRAY_100),Be=he.withColor(ke.GRAY_100);return{send:{standard:e.compile(),directional:!0},cancel:{standard:t.compile(),directional:!1},ellipses:{standard:r.compile(),directional:!1},leftChevron:{standard:0,directional:!0},rightChevron:{standard:0,directional:!0},closePaneLargeDisplay:{standard:t.compile(),directional:!1},closePaneSmallDisplay:{standard:t.compile(),directional:!1},deleteCommandBar:{standard:n.compile(),directional:!1},delete:{standard:n.compile(),directional:!1},edit:{standard:o.compile(),directional:!0},unlock:{standard:a.compile(),directional:!0},checkmarkTopper:{standard:d.compile(),dark:c.compile(),directional:!0},checkmark:{standard:d.compile(),directional:!0},cancelFluent:{standard:t.compile(),directional:!1},sendFluentForAppColor:{standard:e.compile(),directional:!0},sendFluentDisabledForAppColor:{standard:e.compile(),directional:!0},newComment:{standard:p.compile(),directional:!1},newCommentDisabled:{standard:h.compile(),directional:!1},newCommentRTL:{standard:g.compile(),directional:!1},newCommentRTLDisabled:{standard:v.compile(),directional:!1},taskAssign:{standard:y.compile(),dark:T.compile(),directional:!0},reopenThread:{standard:b.compile(),directional:!0},taskReopen:{standard:b.compile(),dark:I.compile(),directional:!0},taskComplete:{standard:l.compile(),dark:E.compile(),directional:!0},error:{standard:P.compile(),dark:_.compile(),directional:!1},taskEdit:{standard:H.compile(),dark:U.compile(),directional:!0},assignerDropdown:{standard:F.compile(),dark:z.compile(),directional:!1},save:{standard:u.compile(),directional:!0},info:{standard:D.compile(),dark:M.compile(),directional:!1},linkToComment:{standard:Y.compile(),directional:!1},likeSolid:{standard:B.compile(),dark:q.compile(),directional:!1},likeEmpty:{standard:K.compile(),dark:$.compile(),directional:!1},filter:{standard:oe.compile(),dark:ie.compile(),directional:!1},deleteFilter:{standard:Ce.compile(),dark:se.compile(),directional:!1},deleteFilterDefault:{standard:he.compile(),dark:Be.compile(),directional:!1}}})});function ate(e,t){var r=ote()[e],n=r[t],o;return n?o=n:r.dark&&kRe(t)?o=r.dark:o=r.standard,{source:o,directional:r.directional}}function kRe(e){return e===5||e===4}function DRe(e){return ate("cancel",e)}function Ol(e){var t=Ca(e);return t||(x().assertConditionTag(!1,"Missing icon ".concat(e.icon),595646157),DRe(e.themeId))}function Ca(e){if(e.icon!==0){var t=FRe(e);if(t!==void 0)return ate(t,e.themeId)}}function FRe(e){var t=fe()?wRe:ste,r=t[e.icon];if(r!==void 0)return typeof r=="function"?r(e):r}function ORe(e){return e.disabled?"sendFluentDisabledForAppColor":"sendFluentForAppColor"}function NRe(e){return e.renderTarget==="Pane"?"deleteCommandBar":"delete"}function MRe(e){return e.disabled?mM.I18nManager.isRTL?"newCommentRTLDisabled":"newCommentDisabled":mM.I18nManager.isRTL?"newCommentRTL":"newComment"}var mM,Qd,Ur,ste,wRe,Js=f(()=>{"use strict";s();k();te();mM=S(re());ye();Fd();ite();dn();ste=(Qd={},Qd[1]="cancel",Qd[2]="send",Qd[7]="ellipses",Qd[10]="leftChevron",Qd[11]="rightChevron",Qd[9]=function(){return xl()===$t.LargeDisplay?"closePaneLargeDisplay":"closePaneSmallDisplay"},Qd[12]=MRe,Qd[24]="send",Qd),wRe=m(m({},ste),(Ur={},Ur[1]="cancelFluent",Ur[2]=ORe,Ur[3]=NRe,Ur[4]="unlock",Ur[5]="checkmark",Ur[20]="checkmarkTopper",Ur[6]="edit",Ur[13]="taskAssign",Ur[14]="taskAssign",Ur[16]="reopenThread",Ur[21]="taskReopen",Ur[15]="taskComplete",Ur[19]="error",Ur[17]="taskEdit",Ur[8]="assignerDropdown",Ur[24]="save",Ur[26]="info",Ur[25]="linkToComment",Ur[23]="likeSolid",Ur[22]="likeEmpty",Ur[27]="filter",Ur[28]="deleteFilter",Ur[29]="deleteFilterDefault",Ur))});var t5t,dte,cte,r5t,n5t,ute,lte=f(()=>{"use strict";s();xr();je();t5t=ve({alignItems:"center",justifyContent:"center"}),dte=ve({alignItems:"stretch"}),cte=ve({transform:[{scaleX:-1}]}),r5t=new R([R.always(function(e){return{tintColor:e.palette.IconButtonDisabledTint}})]),n5t=new R([R.always(function(e){return{tintColor:e.palette.IconButtonFocusedTint}})]),ute=ve({opacity:0})});var xp,fte,hn,HRe,BRe,S_=f(()=>{"use strict";s();k();ha();b_();Pt();xp=S(L()),fte=S(re());Gc();px();Tr();Js();je();rr();mr();lte();hn=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.refManager=new nf,r.focus=r.refManager.focus,r.blur=r.refManager.blur,r.getFocusState=r.refManager.getFocusState,r.getChildNodes=r.refManager.getChildNodes,r.addChildNode=r.refManager.addChildNode,r.getDescendantById=r.refManager.getDescendantById,r.getId=r.refManager.getId,r.getData=r.refManager.getData,r.isTabbable=r.refManager.isTabbable,r.getNextTabTarget=r.refManager.getNextTabTarget,r.getIterator=r.refManager.getIterator,r.renderWithTheme=function(n){var o=Ol({icon:r.props.icon,disabled:r.disabled,renderTarget:"Pane",themeId:n.themeId}),a=o.directional&&fte.I18nManager.isRTL?cte:void 0,d=r.props.onClick,c=Cs(r.props.preventDefaultKeyDownBehavior,De.Capturing),u=r.props.visibility!=="hidden",l=!r.disabled&&u,p=xp.createElement(BRe,{accessibilityLabel:r.props.accessibilityLabel,accessibilityHint:r.props.accessibilityHint,accessibilityActions:r.props.accessibilityActions,onAccessibilityAction:r.props.onAccessibilityAction,accessibilityState:r.props.accessibilityState,iconOnly:!r.props.text,icon:{rasterImageSource:{src:o.source}},disabled:r.disabled,tooltip:u?r.props.tooltipText:void 0,focusable:l,testID:r.props.testID,style:[r.props.text?M0:vr],onClick:typeof d=="function"&&u?d:void 0,onFocus:r.props.onFocus,onBlur:r.props.onBlur,onFocusStateChange:r.props.onFocusStateChange,nodeId:r.props.nodeId,nodeData:r.props.nodeData,isTabbable:r.props.isTabbable&&l,accessible:u,preventDefaultKeyDownBehavior:void 0,appearance:r.props.appearance,block:!0,componentRef:r.refManager.ref},r.props.text||null),g=r.props.menuProps&&u?xp.createElement(gp,m({},r.props.menuProps.props),xp.createElement(yp,null,p),r.props.menuProps.menu):p;return xp.createElement(ee,{style:[dte,r.props.style,a,r.props.visibility==="hidden"?ute:void 0],accessible:!1,focusable:!1,onMouseEnter:r.props.onMouseEnter,onMouseLeave:r.props.onMouseLeave,keyDownEvents:c,onStartShouldSetResponder:Fl},g)},r.render=function(){return We(r.renderWithTheme,Ge)},r}return Object.defineProperty(t.prototype,"disabled",{get:function(){return!!this.props.disabled},enumerable:!1,configurable:!0}),t}(xp.PureComponent),HRe=ap.customize({small:{hasContent:{minHeight:void 0,minWidth:void 0,variant:"secondaryStandard"}}}),BRe=js(HRe)});var Ih=f(()=>{"use strict";s();S_()});var pte,mte=f(()=>{"use strict";s();xr();pte=new R([R.always({flex:0,borderWidth:0,marginTop:1,height:28,width:28})])});var mx,gM,gte=f(()=>{"use strict";s();mx=S(L());MN();dn();Ih();mte();gM=mx.default.memo(function(t){var r=t.actions.map(function(n,o){return mx.default.createElement(hn,{key:o,icon:n.icon,onClick:n.onClick,accessibilityLabel:n.accessibilityLabel,tooltipText:u_(n),disabled:n.disabled,testID:n.id,nodeId:n.id||"",isTabbable:n.isTabbable,text:"",appearance:"subtle",style:pte.render(Wr(t.renderContextType)),preventDefaultKeyDownBehavior:t.preventDefaultKeyDownBehavior})});return mx.default.createElement(mx.default.Fragment,null,r)});gM.displayName="ResolvedCardButtons"});var hte,yte,Cte,vte=f(()=>{"use strict";s();hte=S(Kr());je();yte=hte.StyleSheet.createViewStyle({marginLeft:10}),Cte=ve({paddingLeft:9})});var Eh,I_,hM,xte=f(()=>{"use strict";s();Eh=S(L()),I_=S(re());Js();go();dn();rr();gn();vte();hM=Eh.default.memo(function(t){return Eh.default.createElement(Ge.Consumer,null,function(r){var n=Ca({icon:20,themeId:r.themeId,renderTarget:"Pane"});return Eh.default.createElement(I_.View,{key:"text",style:[W0.render(Wr(t.renderContextType)),Cte]},n&&Eh.default.createElement(I_.Image,{source:n.source}),Eh.default.createElement(qe,{style:yte,numberOfLines:1,variantFluent:"secondarySemibold",accessible:!1},t.taskCompleter?t.localizationAPI.getStringOrUndefined(202):t.localizationAPI.getStringOrUndefined(197)))})});hM.displayName="ResolvedCardLabel"});function E_(e){return fe()&&(e.postDisplayMode===ze.Normal||e.postDisplayMode===ze.Resolved)&&e.isNew}var yM=f(()=>{"use strict";s();ye();gl()});var Zs,CM,Tte,bte,Ste,Ite=f(()=>{"use strict";s();k();ne();rt();te();Zs=S(L());ln();ye();kd();Ef();kv();EY();sZ();r_();PZ();gte();xte();yM();Vo();lr();CM=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.getNewCandidateTaskAssignees=Qe(function(a,d){var c=sj(a);return d&&mS(c,d),c}),o.onEditorFocus=function(){(o.isActiveDraft()||o.isActiveReply())&&!o.isSelectionWithinCard()&&(x().assertConditionTag(it(),"Should have selection in card with draft if NewSelectionInteractions off",572844239),o.props.onCardSelect(o))},o.notifyRenderedOnce=Mn(function(){o.props.onCardRendered&&o.props.onCardRendered(o.props)}),o.toggleExpansion=function(){o.props.cardCollapsedState===Rt.Collapsed?o.props.onCardSelectExpand(o,!0,!1):o.props.onCardCollapse(o)},o.renderExpandButton=function(a){var d=Zs.Children.count(o.props.children),c=o.props.displayMode===Se.Resolved;if(!(o.props.cardCollapsedState===Rt.Expanded||d<=1||(!c||!fe())&&d<=2)){var u=!1;if(fe()&&o.props.children)for(var l=1;l<d;++l){var p=o.props.children[l];if(u||l===d-1&&!c)break;var g=p.props;u=!!p.props.postDisplayMode&&E_(g)}var h=o.props.componentTreeId.renderContextType;return Zs.createElement(c_,m({id:TW({id:o.props.id,renderContextType:h}),innerText:V8(o.props.localizationAPI,d,c)||"",isCardResolved:c,isTabbable:o.props.isTabbable,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,renderContextType:h,restrictControl_deprecated:!!o.props.restrictActionControls_deprecated,key:"expandButton",unreadPostHidden:u},a))}},o.logCardRenderedOnce=Mn(function(){var a,d;(d=(a=x()).logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(Tte||(Tte=zt(["CommentCardRendered"],["CommentCardRendered"]))),C.reserveTag(524100999),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary),Vr("RenderContextType",o.props.componentTreeId.renderContextType,N.SystemMetadata),Vr("CardDisplayMode",o.props.displayMode,N.SystemMetadata))}),o.getId=o.getId.bind(o),o.onTaskAssigneeUpdated=o.onTaskAssigneeUpdated.bind(o),o.onCardFocus=o.onCardFocus.bind(o),o}return t.prototype.componentDidMount=function(){var r,n;this.props.onCardMounted(this.props),this.isActiveDraft()&&((n=(r=x()).logDiagnosticTrace)===null||n===void 0||n.call(r,Ot(bte||(bte=zt(["DraftCardMount"],["DraftCardMount"]))),C.reserveTag(556827602),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary),Vr("RenderContextType",this.props.componentTreeId.renderContextType,N.SystemMetadata),Vr("CardDisplayMode",this.props.displayMode,N.SystemMetadata)))},t.prototype.componentWillUnmount=function(){var r,n;this.isActiveDraft()&&((n=(r=x()).logDiagnosticTrace)===null||n===void 0||n.call(r,Ot(Ste||(Ste=zt(["DraftCardUnmount"],["DraftCardUnmount"]))),C.reserveTag(556827603),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary),Vr("RenderContextType",this.props.componentTreeId.renderContextType,N.SystemMetadata),Vr("CardDisplayMode",this.props.displayMode,N.SystemMetadata)))},t.prototype.getId=function(){return this.props.id},t.prototype.isActiveReply=function(){return this.props.displayMode===Se.Reply||this.props.displayMode===Se.ReplyPreCommitPending},t.prototype.isActiveDraft=function(){return this.props.displayMode===Se.Draft||this.props.displayMode===Se.DraftPreCommitPending},t.prototype.onTaskAssigneeUpdated=function(r){this.props.onSelectedTaskAssigneeUpdated(r)},t.prototype.getTaskAssignerProps=function(){var r;if(this.props.supportsTaskCreation){var n=this.isActiveReply()&&!this.props.taskTopperProps;if(!(n&&!Cd())&&this.props.currentMentionees){var o=n||this.isActiveDraft(),a=G8(this.props.localizationAPI,o),d=this.getNewCandidateTaskAssignees(this.props.currentMentionees,(r=this.props.taskTopperProps)===null||r===void 0?void 0:r.assignees),c=this.props.localizationAPI.getString(128);if(d&&Object.keys(d).length!==0)return{renderContextType:this.props.componentTreeId.renderContextType,id:this.props.id,label:a,candidateAssignees:d,isNewThread:this.isActiveDraft(),selectedAssignee:this.props.selectedTaskAssignee,onSelectedTaskAssigneeUpdated:this.onTaskAssigneeUpdated,pickerAriaLabel:c,assignerTooltip:this.props.localizationAPI.getString(182),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,isTaskThread:!!this.props.taskTopperProps}}}},t.prototype.isSelectionWithinCard=function(){return this.props.selected||this.props.hasSelectedChild},t.prototype.renderDraftBoxMessage=function(r){if(!Tn())return null;var n=this.props.draftWarningState;return!n&&!r?null:Zs.createElement(pp,{key:"draftBoxMessage",draftWarningState:n,localizationAPI:this.props.localizationAPI,target:Md.Card,id:n?jm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Wm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:r})},t.prototype.onCardSaveDraft=function(r){r&&this.props.draftId&&this.props.onSaveDraft(this.getId(),r)},t.prototype.renderResolvedOrTaskTopperHelper=function(r){var n=this.props.taskTopperProps,o=r.resolvedButtonsProps,a=r.preventDefaultKeyDownBehavior;if(!(!o&&!n)){var d=this.props.componentTreeId.renderContextType,c=o&&o.length>0?Zs.createElement(gM,{actions:o,renderContextType:d,preventDefaultKeyDownBehavior:a}):void 0,u=n&&this.props.displayMode!==Se.Resolved?Zs.createElement(aZ,m({},n,{taskTopperCheckboxRef:r.taskTopperCheckboxRef})):Zs.createElement(hM,{localizationAPI:this.props.localizationAPI,renderContextType:d,taskCompleter:n!=null&&n.assignees&&n.assignees.length>0?n.assignees[0]:void 0});return Zs.createElement(IY,m({leftElement:u,rightElement:c,preventDefaultKeyDownBehavior:r.preventDefaultKeyDownBehavior},r.cardTopperContainerProps))}},t.prototype.onCardFocus=function(r){this.props.onCardFocus(this)},t.prototype.logCardRendered=function(){this.props.displayMode!==Se.Loading&&this.logCardRenderedOnce()},t.DisplayName="CommentCard",t}(Zs.PureComponent)});var Ete,Pte,_te,Rte,Ate,kte,Dte,wte,Fte,Ote=f(()=>{"use strict";s();Fd();Ve();go();xr();je();Ete=1,Pte=new R([R.rule({isFluentEnabled:!0},{paddingTop:7,flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start",paddingRight:Rr}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{marginLeft:Gg}),R.rule({platform:"android"},{top:-16,zIndex:99}),R.rule({displayClass:$t.LargeDisplay,renderContextType:A.HalfPane},{paddingTop:zg,paddingBottom:zg,paddingLeft:Bd,paddingRight:Bd}),R.rule({isFluentEnabled:!1},{padding:Rr,position:"absolute",right:0,flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-start"})]),_te=new R([R.rule({platform:"android"},{marginTop:16,marginLeft:4}),R.rule({platform:"win32"},{alignSelf:"flex-start",marginTop:6,marginRight:4})]),Rte=new R([R.rule({platform:"android"},{marginTop:16,marginLeft:8})]),Ate=new kt([kt.always({marginLeft:2})]),kte=new kt([kt.rule({isFluentEnabled:!0},{marginTop:4,marginLeft:Rr-4})]),Dte=ve({paddingTop:4}),wte=new R([R.always(function(e){return{borderBottomWidth:1,borderColor:e.palette.CardBorder}})]),Fte=new R([R.rule({isFluentEnabled:!0},{flexDirection:"row",flex:1,justifyContent:"flex-start",alignItems:"flex-start"})])});var WRe,zRe,GRe,qRe,vM,P_,xM,Ph,Nte,Mte,Lte,Hte,Bte,Ute,Vte,jte,__,R_,A_,Wte,k_,zte,Gte,qte,gx=f(()=>{"use strict";s();k();Fd();Ve();go();xr();je();WRe=56,zRe="rgba(0,0,0,0.1)",GRe=36,qRe=3,vM=64,P_=new R(w([R.always({alignItems:"flex-start",flex:-1,flexDirection:"row"}),R.rule({isFluentEnabled:!1},function(e){return{paddingLeft:Rr,paddingTop:Rr,paddingBottom:Rr,backgroundColor:e.palette.CardBackground}}),R.rule({displayClass:$t.LargeDisplay,renderContextType:A.HalfPane},{paddingLeft:Bd,paddingTop:zg,paddingBottom:zg})],V(j0),!1)),xM=new R([R.always({flexDirection:"row",alignItems:"flex-start",alignSelf:"stretch",paddingRight:Rr-6,paddingBottom:1})]),Ph=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}})]),Nte=new R([R.rule({isFluentEnabled:!1},{marginRight:Rr,minHeight:B0,marginTop:U0}),R.rule({displayClass:$t.LargeDisplay,renderContextType:A.HalfPane},{marginRight:Bd}),R.rule({isFluentEnabled:!0},{marginRight:Rr})]),Mte=new R([R.always({marginRight:3,marginBottom:3})]),Lte=ve({overflow:"hidden"}),Hte=new R([R.always(function(e){return{position:"absolute",width:"100%",backgroundColor:e.palette.CardBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.CardBackground,height:e.themeId===7?11.5:17}}),R.rule({platform:"win32"},function(e){return e.themeId===7?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:ep(e.palette.CardBackground,"CC"),offset:0},{color:ep(e.palette.CardBackground,"00"),offset:1}]}}})]),Bte=new R([R.always(function(e){return{position:"absolute",width:"100%",backgroundColor:e.palette.CardHoveredBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.CardHoveredBackground,height:e.themeId===7?11.5:17}}),R.rule({platform:"win32"},function(e){return e.themeId===7?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:ep(e.palette.CardHoveredBackground,"CC"),offset:0},{color:ep(e.palette.CardHoveredBackground,"00"),offset:1}]}}})]),Ute=new R([R.always(function(e){return{position:"absolute",width:"100%",backgroundColor:e.palette.ResolvedCardBackground,bottom:0,borderBottomWidth:6,borderColor:e.palette.ResolvedCardBackground,height:e.themeId===7?11.5:17}}),R.rule({platform:"win32"},function(e){return e.themeId===7?{}:{backgroundColor:{gradientDirection:"ToTop",colorStops:[{color:ep(e.palette.ResolvedCardBackground,"CC"),offset:0},{color:ep(e.palette.ResolvedCardBackground,"00"),offset:1}]}}})]),Vte=new R([R.rule({displayClass:$t.LargeDisplay,renderContextType:A.HalfPane},{marginTop:32,marginBottom:32}),R.rule({platform:"win32"},{minHeight:GRe,alignItems:"flex-end"}),R.rule({platform:"android"},{flexWrap:"wrap"})]),jte=new R([R.rule({displayClass:$t.LargeDisplay,renderContextType:A.HalfPane},{paddingLeft:32,paddingRight:32})]),__=new kt([kt.rule({isFluentEnabled:!0},{flex:1,marginTop:3,marginRight:4}),kt.rule({isFluentEnabled:!1},{marginRight:Rr+WRe,alignSelf:"flex-start"})]),R_=new R(w(w([R.rule({isFluentEnabled:!1},function(e){return{borderTopWidth:1,borderColor:e.palette.CardReplyTopBorder}})],V(Dv),!1),[R.rule({isFluentEnabled:!0},{marginTop:V0,marginBottom:V0+qRe,paddingTop:1})],!1)),A_=new R([R.always({flexDirection:"column",alignItems:"stretch",flex:1})]),Wte=ve({paddingBottom:0}),k_=new R([R.always({flex:1,flexDirection:"column",alignItems:"stretch"}),R.rule({isFluentEnabled:!1},{marginLeft:Wg}),R.rule({isFluentEnabled:!0},{paddingLeft:9})]),zte=ve({paddingRight:10}),Gte=ve({paddingLeft:13}),qte=new R([R.always({flex:1,alignItems:"center",justifyContent:"center",position:"absolute",backgroundColor:zRe,width:"100%",height:"100%"}),R.rule({platform:"android"},{zIndex:100})])});function Kte(e,t){switch(e){case Ai.Like:return t?23:22}}function Yte(e,t,r){switch(e){case Ai.Like:return t===1?r.getString(263):t>1?r.formatString(264,t.toString()):(x().assertConditionTag(t===0,"Negative reaction count recevied.",509747411),r.getString(231))}}function $te(e,t){var r;switch(e){case Ai.Like:return!!(!((r=t.Like)===null||r===void 0)&&r.currentUserReacted)}}function Qte(e,t){var r,n;switch(e){case Ai.Like:return(n=(r=t.Like)===null||r===void 0?void 0:r.count)!==null&&n!==void 0?n:0}}var Xte=f(()=>{"use strict";s();te();Rc();ln()});function Jte(){return D_.useContext(hx)}var D_,hx,w_=f(()=>{"use strict";s();D_=S(L()),hx=D_.createContext(new Proxy({},{get:function(){throw new Error("BaseCommentAPI undefined. Did you forget to configure comment api context?")}}))});var Zte,ere=f(()=>{"use strict";s();xr();Zte=new R([R.always(function(e){return{borderWidth:1,borderColor:e.palette.CardBorder}})])});var bM=be((EVt,tre)=>{s();tre.exports=OfficePlatformGlobal.Polyester.Components});var rre,Jc,va,F_=f(()=>{"use strict";s();k();Pt();rre=S(bM()),Jc=S(L());ln();Ov();px();mr();va=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.personaRef=Jc.createRef(),n.registrationRef=Jc.createRef(),n.onFocus=function(){n.setState({isFocusOn:!0})},n.onBlur=function(){n.setState({isFocusOn:!1})},n.state={isFocusOn:!1,isFocusWithin:!1},n}return t.prototype.getIterator=function(){return pt(this,function(r){switch(r.label){case 0:return[4,this];case 1:return r.sent(),[2]}})},t.prototype.getId=function(){return this.props.nodeId||""},t.prototype.getData=function(){return this.props.nodeData},t.prototype.getFocusState=function(){return to(this.state)},t.prototype.getNextTabTarget=function(){return this.getFocusState()===ce.Unfocused&&this.isTabbable()?this:void 0},t.prototype.isTabbable=function(){return!!this.props.isTabbable},t.prototype.getChildNodes=function(){return[]},t.prototype.addChildNode=function(){throw new Error("Method not implemented.")},t.prototype.getDescendantById=function(){},t.prototype.focus=function(){this.personaRef.current&&Yg(this.personaRef.current)},t.prototype.blur=function(){},t.prototype.componentDidUpdate=function(r,n){to(this.state)!==to(n)&&(this.props.onFocusStateChange&&this.props.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},t.prototype.render=function(){var r=Jc.createElement(rre.PersonaProfile,{accessible:this.props.accessible,size:this.props.size,displayName:Fr(this.props.author),authorId:this.props.author.appAuthorId,emailAddress:this.props.author.Email,contextId:this.props.author.authorContextId,resolutionId:this.props.author.UserId,testID:this.props.nodeId,ref:this.personaRef,onFocus:this.onFocus,onBlur:this.onBlur});return Jc.createElement(gc,{node:this,position:0,ref:this.registrationRef},Jc.createElement(ee,{style:this.props.style,keyDownEvents:Cs(this.props.preventDefaultKeyDownBehavior,De.Capturing),onStartShouldSetResponder:Fl},r))},t}(Jc.Component)});function N_(e){return{marginTop:5,marginLeft:5,width:$Re*e}}var YRe,$Re,QRe,O_,nre,ore,ire,are,SM=f(()=>{"use strict";s();rt();xr();je();YRe=44,$Re=125,QRe=180,O_={borderColor:"transparent",borderWidth:2,flexDirection:"row",padding:5},nre=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor}})]),ore=new R([R.always(function(e){return{backgroundColor:e.menuFocus}})]),ire=ve({margin:5});are=Qe(function(e,t){return{width:QRe*t,maxHeight:YRe*(Math.min(e,5)+1)*t}})});var dre,xa,cre,XRe,JRe,ure,lre=f(()=>{"use strict";s();k();ha();Oe();Pt();dre=S(Kr()),xa=S(L()),cre=S(re());ye();Tr();Kn();yo();je();rr();F_();Ki();SM();XRe=[{key:J.ArrowRight,eventPhase:De.Capturing},{key:J.ArrowLeft,eventPhase:De.Capturing}],JRe=xa.default.memo(function(e){var t=e.focusRef,r=e.fontScale,n=e.isSelected,o=e.index,a=e.onClick,d=e.user,c=Vi(),u=xa.default.useRef(null),l=xa.default.useRef(null),p=V(xa.default.useState(ce.Unfocused),2),g=p[0],h=p[1],v=xa.default.useCallback(function(I){h(I)},[]);xa.default.useEffect(function(){t==null||t(u)},[t]),xa.default.useEffect(function(){var I;n&&((I=u.current)===null||I===void 0||I.focus())},[n]);var y=xa.default.useCallback(function(I){a(o)},[a,o]),T=xa.default.useCallback(function(I){var E,P;if(g!==ce.Unfocused){var _=vu(I.nativeEvent.key,cre.I18nManager.isRTL);_===J.ArrowRight?((E=l.current)===null||E===void 0||E.focus(),I.stopPropagation()):_===J.ArrowLeft&&((P=u.current)===null||P===void 0||P.focus(),I.stopPropagation())}},[g]),b=function(E,P){var _=Ht(P),D=[O_];return g===ce.FocusOn&&D.push(Je(nre,E,c.renderContextType)),n&&D.push(ts(ore,_,c.renderContextType)),xa.default.createElement(nr,{style:[D],ref:u,onPress:y,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,tooltip:d.DisplayName,accessible:!0,accessibilityLabel:d.DisplayName,accessibilityPositionInSet:e.index+1,accessibilitySetSize:e.userSetSize,accessibilityRole:"listitem",focusable:!0,onFocusStateChange:v,onKeyDown:T,keyDownEvents:XRe},xa.default.createElement(va,{ref:l,author:d,accessible:!1,focusable:!0,size:dre.PersonaImageSize.small,preventDefaultKeyDownBehavior:void 0}),xa.default.createElement(Sr,{numberOfLines:1,color:J6()&&n?_.selectedText:_.text,variant:"secondaryStandard",style:[N_(r)],accessible:!1,focusable:!1},d.DisplayName))};return We(b,Ge,At)}),ure=JRe});var fre,Do,_h,ZRe,eAe,pre,mre=f(()=>{"use strict";s();k();ha();Oe();Pt();fre=S(of()),Do=S(L()),_h=S(re());lr();Tr();yo();Js();rr();Ki();lre();SM();ZRe=[{key:J.ArrowDown,eventPhase:De.Capturing},{key:J.ArrowUp,eventPhase:De.Capturing},{key:J.ArrowLeft,eventPhase:De.Capturing},{key:J.ArrowRight,eventPhase:De.Capturing},{key:J.Tab,eventPhase:De.Capturing},{key:J.Home,eventPhase:De.Capturing},{key:J.End,eventPhase:De.Capturing}],eAe=Do.default.memo(function(e){var t=e.focusRef,r=e.onCalloutFocusChange,n=V(Do.default.useState(void 0),2),o=n[0],a=n[1],d=LW(e.reactionButtonId),c=Do.default.useRef(null),u=V(Do.default.useState(-1),2),l=u[0],p=u[1],g=(0,_h.useWindowDimensions)().fontScale;Do.default.useEffect(function(){t==null||t(c)},[t]);var h=Do.default.useCallback(function(E){var P=E!==ce.Unfocused;r==null||r(P),P&&(l===-1?p(0):o&&o.current&&o.current.getFocusState()===ce.Unfocused&&o.current.focus())},[l,r,o]),v=Do.default.useCallback(function(E){var P;E===l?(P=o==null?void 0:o.current)===null||P===void 0||P.focus():p(E)},[l,o]),y=Do.default.useCallback(function(E){var P;l===-1?p(0):o&&((P=o.current)===null||P===void 0||P.focus())},[l,o]),T=Do.default.useCallback(function(E){var P;if(E.nativeEvent.key===J.ArrowDown)l===e.userList.length-1?p(0):p(l+1),E.stopPropagation();else if(E.nativeEvent.key===J.ArrowUp){p(l===0?e.userList.length-1:l-1),E.stopPropagation();return}else if(E.nativeEvent.key===J.ArrowRight||E.nativeEvent.key===J.ArrowLeft){l>=0&&E.stopPropagation();return}else E.nativeEvent.key===J.Tab?(P=e.dismiss)===null||P===void 0||P.call(e):E.nativeEvent.key===J.Home?(p(0),E.stopPropagation()):E.nativeEvent.key===J.End&&(p(e.userList.length-1),E.stopPropagation())},[l,e]),b=Do.default.useCallback(function(E){a(E)},[]),I=function(P,_){var D=Ol({icon:23,disabled:!1,renderTarget:"Pane",themeId:P.themeId}),M=Ht(_);return Do.default.createElement(nr,{ref:c,onPress:y,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,focusable:!0,accessible:!0,accessibilityLabel:e.reactionLabel,accessibilityRole:"list",onFocusStateChange:h,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,style:[are(e.userList.length,g)],onKeyDown:T,keyDownEvents:ZRe,testID:d,nodeId:d},Do.default.createElement(fre.ViewWin32,{style:[O_],accessible:!1,focusable:!1},Do.default.createElement(_h.Image,{source:D.source,style:[ire]}),Do.default.createElement(Sr,{numberOfLines:1,color:M.text,variant:"secondaryStandard",style:[N_(g)]},e.reactionLabel)),Do.default.createElement(_h.ScrollView,null,e.userList.map(function(H,U){return Do.default.createElement(ure,{fontScale:g,key:HW(d,U),index:U,isSelected:l===U,onClick:v,focusRef:l===U?b:void 0,user:H,userSetSize:e.userList.length})})))};return We(I,Ge,At)}),pre=eAe});function tAe(e,t,r,n){r.getCommentReactionData?r.getCommentReactionData(e,t).then(function(o){return n(o.map(function(a){return a.user}))}).catch(function(o){x().assertConditionTag(!1,"getCommentReactionData failure",523647194)}):x().assertConditionTag(!1,"getCommentReactionData should not be undefined when gate is enabled",523647195)}var Xt,rAe,gre,nAe,Ii,M_,IM=f(()=>{"use strict";s();k();te();ha();Pt();Xt=S(L());Xte();lr();Tr();w_();go();je();rr();S_();mr();ix();ere();mre();rAe=250,gre=600,nAe=[{key:J.ArrowDown,altKey:!0,eventPhase:De.Capturing},{key:J.Escape,eventPhase:De.Capturing}];(function(e){e[e.Hidden=0]="Hidden",e[e.Mouse=1]="Mouse",e[e.Keyboard=2]="Keyboard",e[e.AccessibilityAction=3]="AccessibilityAction"})(Ii||(Ii={}));M_=Xt.memo(function(e){var t=e.commentId,r=e.isTabbable,n=e.localizationAPI,o=e.onReactionPressed,a=e.preventDefaultKeyDownBehavior,d=e.preventReacting,c=e.reactionType,u=e.renderContextType,l=e.renderHiddenIfNoReactions,p=e.userReactionSummary,g=Xt.useRef(null),h=V(Xt.useState(void 0),2),v=h[0],y=h[1],T=V(Xt.useState(void 0),2),b=T[0],I=T[1],E=V(Xt.useState(Ii.Hidden),2),P=E[0],_=E[1],D=V(Xt.useState(void 0),2),M=D[0],H=D[1],U=V(Xt.useState(!1),2),F=U[0],z=U[1],Y=Jte(),B=Xt.useRef(BW({id:t,renderContextType:u})),q=Qte(c,p),K=q>0||!l&&!d,$=P!==Ii.Hidden,oe=K&&q>0,ie=Xt.useCallback(function(){F||(z(!0),tAe(t,c,Y,function(vt){I({reactionCount:q,users:vt}),z(!1)}))},[Y,t,F,q,c,I]);$&&(oe?b&&q!==b.reactionCount&&ie():_(Ii.Hidden));var Ce=Xt.useCallback(function(vt){vt.nativeEvent.key===J.Escape&&$?(_(Ii.Hidden),vt.stopPropagation()):vt.nativeEvent.key===J.ArrowDown&&vt.nativeEvent.altKey&&($&&(v!=null&&v.current)?v.current.focus():(ie(),_(Ii.Keyboard)),vt.stopPropagation())},[v,ie,$]),se=Xt.useCallback(function(){M!==void 0&&(clearTimeout(M),H(void 0))},[M]),he=Xt.useCallback(function(){se(),!(!oe||$)&&(ie(),H(setTimeout(function(){return _(Ii.Mouse)},rAe)))},[oe,ie,se,$]),Be=Xt.useCallback(function(){se(),!(!oe||!$)&&H(setTimeout(function(){return _(Ii.Hidden)},gre))},[oe,se,$]),_e=Xt.useCallback(function(){se(),!(!oe||!$)&&_(Ii.Hidden)},[oe,se,$]),ot=Xt.useCallback(function(vt){se(),vt===ce.Unfocused&&H(setTimeout(function(){return _(Ii.Hidden)},gre))},[se]),Ue=Xt.useMemo(function(){return Yte(c,q,n)},[n,q,c]),or=$te(c,p),ir=Xt.useCallback(function(){K&&!d&&o(t,!or,c)},[t,or,o,d,c,K]),ri=Xt.useCallback(function(vt){y(vt)},[]),ni=Xt.useCallback(function(vt){vt.nativeEvent.actionName==="Toggle"?ir():oe&&vt.nativeEvent.actionName==="Expand"?_(Ii.AccessibilityAction):vt.nativeEvent.actionName==="Collapse"&&_(Ii.Hidden)},[oe,ir]),Ra=Xt.useCallback(function(vt){vt?se():Be()},[Be,se]);if(!q&&d)return null;var Aa=function(fc){return b===void 0||b.users.length===0?null:Xt.createElement(zi,{target:g,setInitialFocus:P===Ii.Keyboard||P===Ii.AccessibilityAction,doNotTakePointerCapture:!0,onDismiss:_e,style:Je(Zte,fc,u)},Xt.createElement(pre,{reactionButtonId:B.current,userList:b.users,reactionLabel:Ue,onMouseEnter:he,onMouseLeave:Be,focusRef:ri,dismiss:_e,onCalloutFocusChange:Ra}))},ka=function(){return We(Aa,Ge)},sd=q>0?q.toString():"";return Xt.createElement(ee,{onKeyDown:Ce,keyDownEvents:nAe},Xt.createElement(hn,{ref:g,accessibilityActions:o_(oe?["Expand","Collapse","Toggle"]:["Toggle"]),onAccessibilityAction:ni,accessibilityHint:n.getString(240),accessibilityLabel:Ue,accessibilityState:{checked:or,disabled:d,expanded:oe?$:void 0},isTabbable:r&&K,onClick:ir,icon:Kte(c,or),style:BK(Kg,u),visibility:K?"visible":"hidden",text:sd,appearance:"subtle",tooltipText:K&&!$?Ue:void 0,onMouseEnter:he,onMouseLeave:Be,onFocusStateChange:ot,testID:B.current,nodeId:B.current,preventDefaultKeyDownBehavior:a}),$&&ka())})});function Rh(e,t,r){var n=void 0,o=void 0,a=t.map(function(d,c){d.isDestructive&&(x().assertConditionTag(n===void 0,'There should only ever be a single "destructive" action at once',595137034),n=c),d.isCancelItem&&(x().assertConditionTag(o===void 0,'There should only ever be a single "cancel" action at once',595137035),o=c);var u=Ca({icon:d.icon,themeId:e,disabled:d.disabled,renderTarget:"ContextualMenu"});return{name:d.text,key:"ContextMenuItem-".concat(c),onClick:function(){return d.onClick(r)},icon:u?u.source:void 0}});return{items:a,destructiveButtonIndex:n,cancelButtonIndex:o}}var EM=f(()=>{"use strict";s();te();Js()});function H_(e){return L_.default.createElement(wl,{doNotTakePointerCapture:Z6()?!0:void 0},L_.default.createElement(vp,null,e.map(function(t){return L_.default.createElement(Cp,{key:t.key,onClick:t.onClick,icon:typeof t.icon=="object"?{source:t.icon}:void 0},t.name)})))}var L_,PM=f(()=>{"use strict";s();b_();L_=S(L());ye()});var yx=f(()=>{"use strict";s();F_()});var hre,wo,oAe,yre,Cre=f(()=>{"use strict";s();k();rt();hre=S(Kr()),wo=S(L());ln();ye();kd();Ef();Ve();zc();Ote();gx();S_();IM();EM();PM();yx();mr();gn();Ws();lr();Tr();Kn();Pr();go();je();rr();oAe=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.getContextMenuItems=Qe(Rh),r.getMenuPopover=Qe(H_),r.onEdit=function(){r.props.onEditRootPost(r.props.id)},r.renderWithContexts=function(n,o){var a,d=o.renderContextType,c=[],u=[r.renderStyle(Pte,n,d)];fe()&&r.props.isResolvedCard&&u.push(Dte);var l=jg(u,0,r.props.extraPaddingRight,0,r.props.extraPaddingLeft);if(fe()){var p=[r.renderStyle(Fte,n,d),{opacity:r.props.rootAuthorOpacity}];c.push(wo.createElement(ee,{animationClass:"CommentCard_CommentCardHeader",style:p,key:"rootAuthor"},wo.createElement(va,{accessible:Q()==="win32",isTabbable:r.props.isTabbable&&Q()==="win32"&&r.props.rootAuthorOpacity>0,size:hre.PersonaImageSize.extraSmall,author:r.props.author,style:r.renderStyle(Ate,n,d),preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior,nodeId:zm({id:r.props.id,renderContextType:d})}),r.renderRootLabel(n,d)))}if(r.props.anchorText&&c.push(wo.createElement(ee,{key:"hint",style:r.renderStyle(_te,n,d),accessible:!1},wo.createElement(qe,{textStylePolyester:"SmallStandard",variantFluent:"captionStandard"},r.props.anchorText))),r.addButtonsToHeaderContents(c,n,d),!fe())return c.length?wo.createElement(zr,{key:"header",style:l},c):void 0;var g=(a=r.props.cardBorderWeight)!==null&&a!==void 0?a:Ete,h=d!==A.DiscreteIsolated||Q()!=="win32",v=[r.renderStyle(wte,n,d),{marginRight:g,marginLeft:g+(h?Wc:0),opacity:1-r.props.rootAuthorOpacity}];return c.length?wo.createElement(ee,null,wo.createElement(zr,{isTabbable:!1,preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior,style:l},c),wo.createElement(ee,{animationClass:"CommentCard_CommentCardHeader",style:v})):void 0},r.render=function(){return We(r.renderWithContexts,Ge,tn)},r}return t.prototype.renderStyle=function(r,n,o){return Je(r,n,o)},t.prototype.isExpanded=function(r){return r===A.HalfPane||this.props.cardCollapsedState===Rt.Expanded},t.prototype.renderRootLabel=function(r,n){var o=Fr(this.props.author),a=[this.renderStyle(__,r,n),this.renderStyle(kte,r,n)];return fe()&&this.props.isResolvedCard&&!this.isExpanded(n)&&a.push(this.renderStyle(qg,r,n)),wo.createElement(qe,{textStylePolyester:"MediumBold",variantFluent:"bodySemibold",style:a,disabled:Q()!=="win32"&&this.props.isResolvedCard,numberOfLines:fe()?void 0:1,key:"name",accessible:Q()==="win32"?!1:void 0},o)},t.prototype.addButtonsToHeaderContents=function(r,n,o){if((this.props.displayMode===Se.Draft||this.props.displayMode===Se.DraftPreCommitPending)&&o!==A.HalfPane){if(fe())return;var a=HI({id:this.props.id,renderContextType:o}),d=this.props.localizationAPI.getStringOrUndefined(15);r.push(wo.createElement(hn,{onClick:this.props.onCancelDraft,accessibilityLabel:d,isTabbable:this.props.isTabbable,key:"cancel",tooltipText:d,style:[this.renderStyle(Rte,n,o)],icon:1,testID:a,nodeId:a,disabled:this.props.displayMode===Se.DraftPreCommitPending,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:""}));return}var c=this.props.rootAuthorOpacity>0;if(!no()&&!this.props.hideActions&&c&&r.push(this.renderEditButton(n,o)),!this.props.hideActions&&this.props.menuItems.length>0){var u=gW({id:this.props.id,renderContextType:o}),l=this.getContextMenuItems(n.themeId,this.props.menuItems,this.props.id);r.push(wo.createElement(hn,{onClick:Q()==="win32"?void 0:l,accessibilityLabel:this.props.localizationAPI.getStringOrUndefined(45),isTabbable:this.props.isTabbable,key:"threadAnchorMenu",icon:7,style:this.renderStyle(q0,n,o),tooltipText:this.props.localizationAPI.getStringOrUndefined(45),testID:u,nodeId:u,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:"",appearance:"subtle",menuProps:Q()==="win32"?{menu:this.getMenuPopover(l.items)}:void 0}))}no()&&!this.props.hideActions&&c&&r.push(this.renderEditButton(n,o)),c&&r.push(this.renderReactionButton(n,o))},t.prototype.renderEditButton=function(r,n){if(!uf()||!this.props.allowRootEditButton)return null;var o=hW({id:this.props.id,renderContextType:n});return wo.createElement(hn,{onClick:this.onEdit,accessibilityLabel:this.props.localizationAPI.getString(120),isTabbable:this.props.isTabbable,key:"cardEditButton",icon:6,style:this.renderStyle(Kg,r,n),tooltipText:this.props.localizationAPI.getString(120),nodeId:o,testID:o,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,text:"",appearance:"subtle"})},t.prototype.getReactionButtonContainerStyle=function(r,n){return fe()&&this.props.isResolvedCard&&this.props.cardCollapsedState===Rt.Collapsed?this.renderStyle(Y0,r,n):fe()&&!Uo()&&this.props.isCardHovered?this.renderStyle($0,r,n):this.renderStyle(K0,r,n)},t.prototype.renderReactionButton=function(r,n){return!no()||this.props.reactionButtonProps===void 0||this.props.reactionButtonProps.reactionType===void 0||this.props.reactionButtonProps.userReactionSummary===void 0||this.props.reactionButtonProps.onReactionPressed===void 0?null:wo.createElement(ee,{style:this.getReactionButtonContainerStyle(r,n),key:"reaction-background"},wo.createElement(M_,{commentId:this.props.id,isTabbable:!!this.props.isTabbable,onReactionPressed:this.props.reactionButtonProps.onReactionPressed,reactionType:this.props.reactionButtonProps.reactionType,localizationAPI:this.props.localizationAPI,userReactionSummary:this.props.reactionButtonProps.userReactionSummary,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,preventReacting:this.props.preventReacting,renderHiddenIfNoReactions:!1,renderContextType:n,key:"cardReactionButton"}))},t}(wo.PureComponent),yre=oAe});var xre=be((ijt,vre)=>{s();vre.exports=OfficePlatformGlobal.RNWin32.UIAnchor});var Tre,Ah,B_=f(()=>{"use strict";s();Tre=S(Et());Pr();Ah=function(){function e(){var t=this;this._event=new Tre.EventImpl(function(){}),this.isHovered=!1,this.hoverChangeEvent=this._event,this.onMouseEnter=function(){return t.debounce(function(){t.onHoverChange(!0)})},this.onMouseLeave=function(){return t.debounce(function(){t.onHoverChange(!1)})},this.viewProps=Q()==="win32"?{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave}:{}}return e.prototype.debounce=function(t){var r=this;this.action?this.action=t:(this.action=t,setTimeout(function(){r.action&&r.action(),r.action=void 0},e.DebounceDelay))},e.prototype.onHoverChange=function(t){t!==this.isHovered&&(this.isHovered=t,this._event.trigger(t))},e.DebounceDelay=50,e}()});function Xd(e,t,r){var n=function(a){Z(d,a);function d(){var c=a.apply(this,w([],V(arguments),!1))||this;return c.allContextContents={},c.keys=Object.keys(t),c.renderFunction=c.keys.reduceRight(function(u,l){return function(p,g){var h=t[l];return Zc.createElement(h.Consumer,null,function(v){return c.allContextContents[l]=v,u===null?Zc.createElement(e,m({ref:p},g,c.allContextContents)):u(p,g)})}},null),c.render=function(){var u=c.props,l=u.forwardedRef,p=Ke(u,["forwardedRef"]),g=p;return c.renderFunction?c.renderFunction(l,g):(x().assertConditionTag(!1,"Contexts failed to wrap, default to null.",558724946),Zc.createElement(e,m({},g,{ref:l},c.allContextContents)))},c}return d}(Zc.Component),o=Zc.forwardRef(function(a,d){return Zc.createElement(n,m({key:iAe,forwardedRef:d},a))});return o.displayName=r,o}var Zc,iAe,kh=f(()=>{"use strict";s();k();te();Zc=S(L()),iAe="ContextualizedWrapperComponent"});var U_,_M,bre=f(()=>{"use strict";s();k();U_=S(L()),_M=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.state={showLoadingUI:!1},n}return t.prototype.setTimer=function(){var r=this;this.timeout||(this.timeout=setTimeout(function(){r.setState({showLoadingUI:!0}),r.timeout=void 0},this.props.delay))},t.prototype.clearTimer=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)},t.prototype.componentDidMount=function(){this.props.isLoading&&this.setTimer()},t.prototype.componentWillUnmount=function(){this.clearTimer()},t.prototype.componentDidUpdate=function(r){!r.isLoading&&this.props.isLoading?this.setTimer():r.isLoading&&!this.props.isLoading&&(this.clearTimer(),this.setState({showLoadingUI:!1}))},t.prototype.render=function(){return this.state.showLoadingUI?this.props.loadingUI:U_.Children.only(this.props.children)},t}(U_.Component)});var Sre=f(()=>{"use strict";s();bre()});var V_,RM=f(()=>{"use strict";s();ha();RN();yo();V_=function(t,r){var n=Ht(r),o=t_(rh.customize({tokens:{borderRadius:2,checkboxBackgroundColor:n.buttonBackground,checkboxBorderColor:n.squareCheckboxBorderColor},root:{style:{alignItems:"center",marginRight:0,height:26,width:26,paddingRight:3,paddingLeft:3,paddingTop:3,paddingBottom:3,borderRadius:4,borderWidth:1,borderColor:"transparent",marginBottom:2}},checkbox:{style:{marginTop:0,width:18,height:18,paddingLeft:1,justifyContent:"center",alignItems:"center"}},checkmark:{accessible:!1,style:{fontSize:12,fontWeight:"bold"}},content:{style:{display:"none"}},_overrides:{checked:{tokens:{checkboxBackgroundColor:n.completedSquareCheckboxColor,checkboxBorderColor:n.squareCheckboxBorderColor,checkmarkColor:n.completedCheckColor}},pressed:{tokens:{checkboxBackgroundColor:n.completedSquareCheckboxColor,checkboxBorderColor:n.completedSquareCheckboxColor,checkmarkColor:n.completedCheckColor}},hovered:{checkmark:{style:{opacity:1}},tokens:{checkmarkColor:n.checkHoverColor,checkboxBackgroundColor:n.buttonHoveredBackground}},focused:{root:{style:{borderColor:t.palette.FocusBorderColor,borderStyle:"solid",padding:0}}}}}));return o.displayName="SquareCheckbox",o}});var Ire,Ere,Pre,_re,Rre=f(()=>{"use strict";s();xr();Ire=new R([R.always(function(e){return{width:200,flex:1,borderRadius:2,borderWidth:1,flexDirection:"column",backgroundColor:e.palette.CardBorder,borderColor:e.palette.CardBorder,padding:1}})]),Ere=new R([R.always(function(e){return{flex:1,flexDirection:"row",paddingLeft:9,paddingBottom:8,paddingTop:8,backgroundColor:e.palette.CardBackground}})]),Pre=new kt([kt.always({marginLeft:9,marginRight:15,flex:1,alignSelf:"center"})]),_re=new R([R.always(function(e){return{backgroundColor:e.menuFocus}})])});function sAe(e,t,r,n){var o=t;switch(e.nativeEvent.key){case J.ArrowUp:o--;break;case J.ArrowDown:o++;break;case J.Home:o=0;break;case J.End:o=n-1;break;default:return}o<0?o=n-1:o>=n&&(o=0),r(o),e.stopPropagation()}function cAe(e,t,r){var n;t.current!==r&&r&&((n=e.current)===null||n===void 0||n.focus()),t.current=r}function lAe(e,t,r){switch(e.nativeEvent.key){case J.Tab:e.stopPropagation(),t(r);break}}var Are,yn,dAe,kre,uAe,Dre,wre=f(()=>{"use strict";s();k();yd();ha();Oe();Pt();Are=S(Kr()),yn=S(L());ln();Tr();yo();dn();je();rr();yx();Ki();mr();gn();Rre();dAe=[{key:J.ArrowUp,eventPhase:De.Capturing},{key:J.ArrowLeft,eventPhase:De.Capturing},{key:J.ArrowDown,eventPhase:De.Capturing},{key:J.ArrowRight,eventPhase:De.Capturing},{key:J.Home,eventPhase:De.Capturing},{key:J.End,eventPhase:De.Capturing}],kre=yn.memo(function(e){var t=V(yn.useState(0),2),r=t[0],n=t[1],o={};Object.keys(e.candidates).forEach(function(u){e.candidates[u].stillInDraft&&(o[u]=e.candidates[u])});var a=Object.keys(o).length,d=yn.useCallback(function(u){return sAe(u,r,n,a)},[r,n,a]),c=function(l){return yn.createElement(zi,{target:e.anchorRef,onDismiss:e.onHide,setInitialFocus:!0},yn.createElement(ee,{style:Je(Ire,l,e.renderContextType),onKeyDown:d,keyDownEvents:dAe},Object.keys(o).map(function(p,g){var h=o[p];return yn.createElement(Dre,{key:_u(h.mentionee)?h.mentionee.UserId:h.mentionee.Id,candidate:h.mentionee,onClick:e.onCandidateChosen,renderContextType:e.renderContextType,selected:r===g,index:g,totalSuggestions:a})})))};return We(c,Ge)});uAe=[{key:J.Tab,eventPhase:De.Capturing},{key:J.Tab,eventPhase:De.Capturing,shiftKey:!0}];Dre=yn.memo(function(e){var t=e.onClick,r=e.candidate,n=yn.useCallback(function(l){t(r)},[t,r]),o=Du(e.candidate),a=yn.useRef(null),d=yn.useRef(!1);yn.useEffect(function(){return cAe(a,d,e.selected)},[a,d,e.selected]);var c=yn.useCallback(function(l){return lAe(l,e.onClick,e.candidate)},[e.onClick,e.candidate]),u=function(p,g){var h=Ht(g);return yn.createElement(nr,{style:Je(Ere,p,e.renderContextType),onPress:n,keyDownEvents:uAe,onKeyDown:c,preventDefaultKeyDownBehavior:void 0,isTabbable:!1,ref:a,accessible:!0,tooltip:o,accessibilityPositionInSet:e.index+1,accessibilitySetSize:e.totalSuggestions,accessibilityLabel:o,focusedStyle:ts(_re,h,e.renderContextType),accessibilityRole:"listitem"},yn.createElement(va,{author:{DisplayName:o,Provider:"",Email:e.candidate.EmailAddresses[0],UserId:e.candidate.Id,IsCurrentUser:!1},accessible:!1,size:Are.PersonaImageSize.extraSmall,preventDefaultKeyDownBehavior:void 0}),yn.createElement(qe,{numberOfLines:1,colorFluent:e.selected?h.selectedText:h.text,variantFluent:"secondaryStandard",style:Pre.render(Wr(e.renderContextType)),accessible:!1},e.candidate.Name))};return We(u,Ge,At)});Dre.displayName="Suggestion"});var Fre,Ore,Nre,Mre,Lre,Hre,Bre,Ure,Vre=f(()=>{"use strict";s();xr();je();Fre=5,Ore=new R([R.always({flexDirection:"row",justifyContent:"flex-start",alignItems:"center",flex:1,borderWidth:0})]),Nre=new R([R.always({borderWidth:1,paddingRight:Fre,paddingLeft:Fre,alignSelf:"stretch",flexDirection:"row",borderColor:"transparent",borderRadius:2,flexGrow:0,flexShrink:1})]),Mre=new R([R.always(function(e){return{borderStyle:"dashed",borderColor:e.palette.FocusBorderColor}})]),Lre=new R([R.always({marginBottom:2,borderBottomWidth:1,flexDirection:"row",borderColor:"transparent",flexShrink:1})]),Hre=new kt([kt.always({textAlignVertical:"center",paddingBottom:1,flexGrow:0,flexShrink:1})]),Bre=new kt([kt.always({marginLeft:6})]),Ure=ve({flexShrink:1,alignSelf:"stretch"})});var $i,jre,Wre,zre=f(()=>{"use strict";s();k();rt();Oe();$i=S(L()),jre=S(re());ln();Vo();Tr();Kn();yo();xO();Js();je();rr();RM();Ki();Tl();wre();gn();Vre();Wre=function(e){Z(t,e);function t(r){var n,o=e.call(this,r)||this;return o.makeSquareCheckbox=Qe(function(a,d){return V_(a,d)}),o.getCheckboxAccessibilityLabel=Qe(function(a){return FY(o.props.label,Du(a))}),o.onChange=function(){o.setState({isChecked:!o.state.isChecked})},o.onCalloutAnchorClick=function(){o.state.isPickerOpen||o.setState({isPickerOpen:!0})},o.onPickerHide=function(){o.setState({isPickerOpen:!1})},o.onCandidateChosen=function(a){o.setState({displayedAssignee:a,isPickerOpen:!1,isChecked:!0})},o.renderWithContexts=function(a,d,c){var u=c.renderContextType,l=o.makeSquareCheckbox(a,d);return $i.createElement(ee,{key:"task assigner",style:o.renderStyle(Ore,a,u)},$i.createElement(l,{checked:o.state.isChecked,onChange:o.onChange,accessibilityLabel:o.getCheckboxAccessibilityLabel(o.state.displayedAssignee),preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,isTabbable:o.props.isTabbable,nodeId:"task-assigner-checkbox",tooltip:o.state.isChecked?void 0:DI(o.props.localizationAPI,o.props.isTaskThread,o.state.displayedAssignee)}),o.renderAssignerText(a,d,u))},o.render=function(){return We(o.renderWithContexts,Ge,At,tn)},o.state={displayedAssignee:(n=r.selectedAssignee)!==null&&n!==void 0?n:bw(r.candidateAssignees),isPickerOpen:!1,isChecked:!!r.selectedAssignee},o.anchorRef=$i.createRef(),o}return t.prototype.componentDidUpdate=function(r,n){n.isChecked!==this.state.isChecked?this.props.onSelectedTaskAssigneeUpdated(this.state.isChecked?this.state.displayedAssignee:void 0):this.state.isChecked&&this.state.displayedAssignee.AadObjectId!==n.displayedAssignee.AadObjectId&&this.props.onSelectedTaskAssigneeUpdated(this.state.displayedAssignee)},t.getDerivedStateFromProps=function(r,n){var o=n.displayedAssignee&&r.candidateAssignees[bs(n.displayedAssignee)];return o?{}:{displayedAssignee:bw(r.candidateAssignees),isChecked:!1}},t.prototype.renderStyle=function(r,n,o){return Je(r,n,o)},t.prototype.renderAssignString=function(r,n){return $i.createElement(qe,{numberOfLines:1,variantFluent:"secondaryStandard",key:"task-assignment-string",accessible:!1,style:this.renderStyle(Bre,r,n)},this.props.label)},t.prototype.renderAssigneeName=function(r,n){return $i.createElement(qe,{numberOfLines:1,variantFluent:"secondarySemibold",key:"name",accessible:!1,style:this.renderStyle(Hre,r,n)},this.state.displayedAssignee.Name)},t.prototype.renderAssignerText=function(r,n,o){var a=void 0,d=Ht(n);Object.keys(this.props.candidateAssignees).length>1&&(a=Ol({icon:8,renderTarget:"Pane",themeId:r.themeId}));var c=!!a,u=[this.renderStyle(Lre,r,o)];c&&u.push({borderColor:d.squareCheckboxBorderColor});var l=DI(this.props.localizationAPI,this.props.isTaskThread,this.state.displayedAssignee);return $i.createElement(ee,{style:Ure},this.renderAssignString(r,o),$i.createElement(nr,{style:this.renderStyle(Nre,r,o),focusedStyle:c?this.renderStyle(Mre,r,o):void 0,onPress:c?this.onCalloutAnchorClick:void 0,isTabbable:this.props.isTabbable&&c?this.props.isTabbable:!1,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,nodeId:"task-assigner-anchor",accessibilityLabel:l,accessibilityRole:c?"combobox":void 0,accessible:c,tooltip:l,ref:this.anchorRef},$i.createElement(ee,{style:u},this.renderAssigneeName(r,o),a&&$i.createElement(jre.Image,{source:a.source,style:M0}))),this.state.isPickerOpen&&$i.createElement(kre,{onHide:this.onPickerHide,candidates:this.props.candidateAssignees,onCandidateChosen:this.onCandidateChosen,anchorRef:this.anchorRef,renderContextType:o}))},t}($i.PureComponent)});var AM,Gre,qre,kM,Kre,Yre=f(()=>{"use strict";s();AM=S(Kr());xr();Gre=new R([R.always({flexDirection:"row",justifyContent:"flex-end",padding:0,paddingTop:6,paddingBottom:1}),R.rule({isFluentEnabled:!0},{alignItems:"center",paddingRight:3,paddingTop:3})]),qre=AM.StyleSheet.createViewStyle({paddingBottom:3}),kM=new R([R.always({flex:0,marginLeft:7,height:26,width:39})]),Kre=AM.StyleSheet.createViewStyle({justifyContent:"center"})});function mAe(e,t,r,n){return t.map(function(o,a){return Jd.createElement(_M,{key:a,delay:Hd,isLoading:!!o.showDelayedSpinner,loadingUI:Jd.createElement(ee,{style:[Je(kM,e,n),Kre]},Jd.createElement($re.Spinner,{size:"small"}))},Jd.createElement(hn,{onClick:o.onClick,accessibilityLabel:o.accessibilityLabel,isTabbable:!!o.isTabbable,style:Je(kM,e,n),tooltipText:u_(o),testID:o.id,nodeId:o.id||"",disabled:o.disabled,icon:o.icon,appearance:o.usePrimaryButtonStyling?"primary":void 0,preventDefaultKeyDownBehavior:r,text:""}))})}var $re,Jd,Cx,Qre=f(()=>{"use strict";s();k();$re=S(Kr()),Jd=S(L());Ws();MN();Kn();dn();je();rr();Ih();Sre();mr();zre();Yre();Cx=Jd.memo(function(t){var r=Vi().renderContextType;return Jd.createElement(Ge.Consumer,null,function(n){return Jd.createElement(zr,{key:"draft-button-container",style:[Gre.render(Wr(r)),t.taskAssigner?qre:void 0],animationClass:t.animationClass,focusable:!1},t.taskAssigner&&Jd.createElement(Wre,m({},t.taskAssigner)),mAe(n,t.buttons,t.preventDefaultKeyDownBehavior,r))})})});var DM=f(()=>{"use strict";s();Qre()});function j_(e){var t=e;return t.onMentionCreated!==void 0&&t.onMentioneesStillInDraftUpdated!==void 0&&t.correlationId!==void 0}var wM=f(()=>{"use strict";s()});function Jre(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return W_.Children.toArray(t).reduce(function(n,o){if(!o)return n;if(Xre.isElement(o))return o.props.children&&$l("Warning: wrapper elements should not contain children"),W_.cloneElement(o,void 0,n);throw new Error("Expected element but got ".concat(o))},e)}var W_,Xre,Zre=f(()=>{"use strict";s();ne();W_=S(L()),Xre=S(Gb())});var ene,gAe,Dh,z_=f(()=>{"use strict";s();ene=S(L()),gAe="LPPManagerContext undefined. Did you forget to render a LPPManagerContext context provider?",Dh=ene.createContext(new Proxy({},{get:function(){throw new Error(gAe)}}))});function Nl(e){"@babel/helpers - typeof";return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(e)}var FM=f(()=>{"use strict";s()});function OM(e,t){if(Nl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(Nl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tne=f(()=>{"use strict";s();FM()});function NM(e){var t=OM(e,"string");return Nl(t)=="symbol"?t:t+""}var rne=f(()=>{"use strict";s();FM();tne()});function MM(e,t,r){return t=NM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var nne=f(()=>{"use strict";s();rne()});function one(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function G_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?one(Object(r),!0).forEach(function(n){MM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):one(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var ine=f(()=>{"use strict";s();nne()});var dne={};Ey(dne,{__DO_NOT_USE__ActionTypes:()=>vx,applyMiddleware:()=>xx,bindActionCreators:()=>vAe,combineReducers:()=>wh,compose:()=>bp,createStore:()=>Tp,legacy_createStore:()=>yAe});function Fo(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}function hAe(e){if(typeof e!="object"||e===null)return!1;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Tp(e,t,r){var n;if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Fo(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Fo(1));return r(Tp)(e,t)}if(typeof e!="function")throw new Error(Fo(2));var o=e,a=t,d=[],c=d,u=!1;function l(){c===d&&(c=d.slice())}function p(){if(u)throw new Error(Fo(3));return a}function g(T){if(typeof T!="function")throw new Error(Fo(4));if(u)throw new Error(Fo(5));var b=!0;return l(),c.push(T),function(){if(b){if(u)throw new Error(Fo(6));b=!1,l();var E=c.indexOf(T);c.splice(E,1),d=null}}}function h(T){if(!hAe(T))throw new Error(Fo(7));if(typeof T.type>"u")throw new Error(Fo(8));if(u)throw new Error(Fo(9));try{u=!0,a=o(a,T)}finally{u=!1}for(var b=d=c,I=0;I<b.length;I++){var E=b[I];E()}return T}function v(T){if(typeof T!="function")throw new Error(Fo(10));o=T,h({type:vx.REPLACE})}function y(){var T,b=g;return T={subscribe:function(E){if(typeof E!="object"||E===null)throw new Error(Fo(11));function P(){E.next&&E.next(p())}P();var _=b(P);return{unsubscribe:_}}},T[ane]=function(){return this},T}return h({type:vx.INIT}),n={dispatch:h,subscribe:g,getState:p,replaceReducer:v},n[ane]=y,n}function CAe(e){Object.keys(e).forEach(function(t){var r=e[t],n=r(void 0,{type:vx.INIT});if(typeof n>"u")throw new Error(Fo(12));if(typeof r(void 0,{type:vx.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Fo(13))})}function wh(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];typeof e[o]=="function"&&(r[o]=e[o])}var a=Object.keys(r),d,c;try{CAe(r)}catch(u){c=u}return function(l,p){if(l===void 0&&(l={}),c)throw c;for(var g=!1,h={},v=0;v<a.length;v++){var y=a[v],T=r[y],b=l[y],I=T(b,p);if(typeof I>"u"){var E=p&&p.type;throw new Error(Fo(14))}h[y]=I,g=g||I!==b}return g=g||a.length!==Object.keys(l).length,g?h:l}}function sne(e,t){return function(){return t(e.apply(this,arguments))}}function vAe(e,t){if(typeof e=="function")return sne(e,t);if(typeof e!="object"||e===null)throw new Error(Fo(16));var r={};for(var n in e){var o=e[n];typeof o=="function"&&(r[n]=sne(o,t))}return r}function bp(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.length===0?function(n){return n}:t.length===1?t[0]:t.reduce(function(n,o){return function(){return n(o.apply(void 0,arguments))}})}function xx(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(n){return function(){var o=n.apply(void 0,arguments),a=function(){throw new Error(Fo(15))},d={getState:o.getState,dispatch:function(){return a.apply(void 0,arguments)}},c=t.map(function(u){return u(d)});return a=bp.apply(void 0,c)(o.dispatch),G_(G_({},o),{},{dispatch:a})}}}var ane,LM,vx,yAe,Ml=f(()=>{"use strict";s();ine();ane=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),LM=function(){return Math.random().toString(36).substring(7).split("").join(".")},vx={INIT:"@@redux/INIT"+LM(),REPLACE:"@@redux/REPLACE"+LM(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+LM()}};yAe=Tp});var cne,une=f(()=>{"use strict";s();cne={exportCss:function(){}}});function lne(e,t){console.error("Exception in ".concat(e)),console.error(t)}function HM(e){if(!e||!e.handleException)return{handleException:lne};var t=!1;return{handleException:function(n,o){if(t)lne(n,o);else{t=!0;try{e.handleException(n,o)}finally{t=!1}}}}}var fne,pne=f(()=>{"use strict";s();fne=HM(void 0)});function xAe(e){return typeof e._singleton_index!="number"&&(e._singleton_index=mne,mne+=1),e._singleton_index}function gne(e){return e._Name||e.name||"Unknown"}var hne,mne,q_,BM,UM=f(()=>{"use strict";s();hne=S(WV());une();pne();mne=1;q_=function(){function e(t){this.singletonsByIndex={},this._exceptionHandler=fne,this._cssExtractor=cne,this.reduxStore=t&&t.reduxStore}return Object.defineProperty(e.prototype,"exceptionHandler",{get:function(){return this._exceptionHandler},set:function(r){this._exceptionHandler=HM(r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cssExtractor",{get:function(){return this._cssExtractor},set:function(r){this._cssExtractor=r},enumerable:!1,configurable:!0}),e.prototype.addSingleton=function(t){if(this.findSingleton(t.constructor))throw new Error("Singleton ".concat(gne(t.constructor)," already exists."));var r=xAe(t.constructor);if(this.singletonsByIndex[r]!==void 0)throw new Error("Singleton with index ".concat(r," already exists."));this.singletonsByIndex[r]=t},e.prototype.getSingleton=function(t){var r=this.findSingleton(t);if(r===void 0)throw new Error("Singleton ".concat(gne(t)," not found."));return r},e.prototype.findSingleton=function(t){if(typeof t._singleton_index=="number"){var r=this.singletonsByIndex[t._singleton_index];if(r&&r.constructor===t)return r}},e}(),BM={appContext:hne.instanceOf(q_).isRequired}});var Sp,VM,yne=f(()=>{"use strict";s();k();Sp=S(L());Ts();UM();VM=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getChildContext=function(){return{appContext:this.props.context}},t.prototype.componentDidCatch=function(r,n){this.props.context.exceptionHandler.handleException("App.componentDidCatch:".concat(n.componentStack),r)},t.prototype.render=function(){return this.props.context.reduxStore?Sp.createElement(sf,{store:this.props.context.reduxStore},this.props.children):Sp.createElement(Sp.Fragment,null,this.props.children)},t.childContextTypes=m({},BM),t}(Sp.Component)});function bAe(e,t){if(!e)return e;var r={},n=!1;return Object.keys(e).forEach(function(o){var a=e[o],d=t(o,a,e);r[o]=d,n=n||d!==a}),n?r:e}function SAe(e,t){if(!e)return e;var r={},n=!1;return Object.keys(e).forEach(function(o){var a=e[o];t(o,a,e)?r[o]=a:n=!0}),n?r:e}function IAe(e,t){if(e)return e[t]}function EAe(e,t,r){if(e&&e[t]===r)return e;var n=m({},e);return n[t]=r,n}function PAe(e,t,r){return Cne(e,t,r,function(n){return n})}function Cne(e,t,r,n){if(!t.length)return e;var o=m({},e),a=!1;return t.forEach(function(d,c){var u=n(d,c),l=r(d,c,u);o[l]!==u&&(o[l]=u,a=!0)}),a?o:e}function _Ae(e,t){if(!e||!(t in e))return e;var r=m({},e);return delete r[t],r}function RAe(e,t,r){var n=e?m({},e):{};return n[t]=r(n[t]),n}function AAe(e,t,r){if(t.length){var n=m({},e);return t.forEach(function(o){n[o]=r(n[o],o)}),n}else return e}function kAe(e){return e?Object.keys(e):[]}function DAe(e){var t=[];return e&&Object.keys(e).forEach(function(r){var n=e[r];t.push(n)}),t}function wAe(e){var t=[];return e&&Object.keys(e).forEach(function(r){var n=e[r];t.push([r,n])}),t}var TAe,Zd,jM=f(()=>{"use strict";s();k();TAe=function(t){var r={};if(t==null)return r;if(t instanceof Array)for(var n=0;n<t.length;n++){var o=t[n];r[o[0]]=o[1]}else Object.keys(t).forEach(function(a){r[a]=t[a]});return r};Zd={create:TAe,map:bAe,filter:SAe,get:IAe,insert:EAe,insertArray:PAe,insertArrayWith:Cne,remove:_Ae,replace:RAe,replaceMany:AAe,keys:kAe,values:DAe,entries:wAe}});function WM(e,t){return m({isLoading:function(n){var o=t(n);return!!o&&o.isLoading&&(!o.hasLoadedPreviously||o.hasError)},isCallInProgress:function(n){var o=t(n);return!!o&&o.isLoading},hasError:function(n){var o=t(n);return!!o&&o.hasError},hasLoaded:function(n){var o=t(n);return!!o&&(o.hasLoadedPreviously||o.hasError)},hasLoadedPreviously:function(n){var o=t(n);return!!o&&o.hasLoadedPreviously},hasStartedPreviously:function(n){var o=t(n);return!!o&&(o.isLoading||o.hasLoadedPreviously||o.hasError)}},e)}var vne=f(()=>{"use strict";s();k()});var zM,GM,qM,KM,ds,Ip,xne=f(()=>{"use strict";s();KM=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r]},ds=typeof console<"u"?console:void 0,Ip={trace:((zM=ds==null?void 0:ds.trace)!==null&&zM!==void 0?zM:KM).bind(ds),warn:((GM=ds==null?void 0:ds.warn)!==null&&GM!==void 0?GM:KM).bind(ds),table:((qM=ds==null?void 0:ds.table)!==null&&qM!==void 0?qM:KM).bind(ds)}});var Tne=f(()=>{"use strict";s();xne()});function OAe(e){return typeof e=="symbol"||Hs(e)&&Ms(e)==FAe}var FAe,Fh,K_=f(()=>{"use strict";s();fg();xg();FAe="[object Symbol]";Fh=OAe});function NAe(e,t){for(var r=-1,n=e==null?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}var Oh,Y_=f(()=>{"use strict";s();Oh=NAe});function Ine(e){if(typeof e=="string")return e;if(Jr(e))return Oh(e,Ine)+"";if(Fh(e))return Sne?Sne.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var bne,Sne,Ene,Pne=f(()=>{"use strict";s();lg();Y_();Ja();K_();bne=Ci?Ci.prototype:void 0,Sne=bne?bne.toString:void 0;Ene=Ine});function MAe(e){return e}var _ne,Rne=f(()=>{"use strict";s();_ne=MAe});function LAe(){}var Ane,kne=f(()=>{"use strict";s();Ane=LAe});var HAe,YM,Dne=f(()=>{"use strict";s();cl();HAe=function(){try{var e=Hi(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),YM=HAe});function BAe(e,t,r,n){for(var o=e.length,a=r+(n?1:-1);n?a--:++a<o;)if(t(e[a],a,e))return a;return-1}var wne,Fne=f(()=>{"use strict";s();wne=BAe});function UAe(e){return e!==e}var One,Nne=f(()=>{"use strict";s();One=UAe});function VAe(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var Mne,Lne=f(()=>{"use strict";s();Mne=VAe});function jAe(e,t,r){return t===t?Mne(e,t,r):wne(e,One,r)}var Hne,Bne=f(()=>{"use strict";s();Fne();Nne();Lne();Hne=jAe});function WAe(e,t){var r=e==null?0:e.length;return!!r&&Hne(e,t,0)>-1}var Une,Vne=f(()=>{"use strict";s();Bne();Une=WAe});function zAe(e,t,r){t=="__proto__"&&YM?YM(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Ll,Tx=f(()=>{"use strict";s();Dne();Ll=zAe});function KAe(e,t,r){var n=e[t];(!(qAe.call(e,t)&&cg(n,r))||r===void 0&&!(t in e))&&Ll(e,t,r)}var GAe,qAe,jne,Wne=f(()=>{"use strict";s();Tx();bE();GAe=Object.prototype,qAe=GAe.hasOwnProperty;jne=KAe});function YAe(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var zne,Gne=f(()=>{"use strict";s();zne=YAe});function XAe(e){if(!Ls(e))return zne(e);var t=jE(e),r=[];for(var n in e)n=="constructor"&&(t||!QAe.call(e,n))||r.push(n);return r}var $Ae,QAe,qne,Kne=f(()=>{"use strict";s();pg();C1();Gne();$Ae=Object.prototype,QAe=$Ae.hasOwnProperty;qne=XAe});function JAe(e){return fl(e)?VE(e,!0):qne(e)}var Yne,$ne=f(()=>{"use strict";s();y1();Kne();uv();Yne=JAe});function tke(e,t){if(Jr(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Fh(e)?!0:eke.test(e)||!ZAe.test(e)||t!=null&&e in Object(t)}var ZAe,eke,Nh,$_=f(()=>{"use strict";s();Ja();K_();ZAe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eke=/^\w*$/;Nh=tke});function $M(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(rke);var r=function n(){var o=arguments,a=t?t.apply(this,o):o[0],d=n.cache;if(d.has(a))return d.get(a);var c=e.apply(this,o);return n.cache=d.set(a,c)||d,c};return r.cache=new($M.Cache||Wf),r}var rke,Qne,Xne=f(()=>{"use strict";s();_E();rke="Expected a function";$M.Cache=Wf;Qne=$M});function oke(e){var t=Qne(e,function(n){return r.size===nke&&r.clear(),n}),r=t.cache;return t}var nke,Jne,Zne=f(()=>{"use strict";s();Xne();nke=500;Jne=oke});var ike,ake,ske,eoe,toe=f(()=>{"use strict";s();Zne();ike=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ake=/\\(\\)?/g,ske=Jne(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ike,function(r,n,o,a){t.push(o?a.replace(ake,"$1"):n||r)}),t}),eoe=ske});function dke(e){return e==null?"":Ene(e)}var Q_,QM=f(()=>{"use strict";s();Pne();Q_=dke});function cke(e,t){return Jr(e)?e:Nh(e,t)?[e]:eoe(Q_(e))}var Hl,bx=f(()=>{"use strict";s();Ja();$_();toe();QM();Hl=cke});function uke(e){if(typeof e=="string"||Fh(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var ec,Mh=f(()=>{"use strict";s();K_();ec=uke});function lke(e,t){t=Hl(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[ec(t[r++])];return r&&r==n?e:void 0}var Lh,X_=f(()=>{"use strict";s();bx();Mh();Lh=lke});function fke(e,t,r){var n=e==null?void 0:Lh(e,t);return n===void 0?r:n}var roe,noe=f(()=>{"use strict";s();X_();roe=fke});function pke(e){return Jr(e)||Tg(e)||!!(ooe&&e&&e[ooe])}var ooe,ioe,aoe=f(()=>{"use strict";s();lg();LE();Ja();ooe=Ci?Ci.isConcatSpreadable:void 0;ioe=pke});function soe(e,t,r,n,o){var a=-1,d=e.length;for(r||(r=ioe),o||(o=[]);++a<d;){var c=e[a];t>0&&r(c)?t>1?soe(c,t-1,r,n,o):vg(o,c):n||(o[o.length]=c)}return o}var J_,XM=f(()=>{"use strict";s();FE();aoe();J_=soe});function mke(e){var t=e==null?0:e.length;return t?J_(e,1):[]}var JM,doe=f(()=>{"use strict";s();XM();JM=mke});var gke,coe,uoe=f(()=>{"use strict";s();v1();gke=WE(Object.getPrototypeOf,Object),coe=gke});function hke(e){return function(t){return e==null?void 0:e[t]}}var loe,foe=f(()=>{"use strict";s();loe=hke});var yke,Cke,poe,moe=f(()=>{"use strict";s();foe();yke={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Cke=loe(yke),poe=Cke});function bke(e){return e=Q_(e),e&&e.replace(vke,poe).replace(Tke,"")}var vke,xke,Tke,Z_,goe=f(()=>{"use strict";s();moe();QM();vke=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,xke="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Tke=RegExp(xke,"g");Z_=bke});var Ske,Ike,hoe,yoe=f(()=>{"use strict";s();FE();uoe();l1();u1();Ske=Object.getOwnPropertySymbols,Ike=Ske?function(e){for(var t=[];e;)vg(t,ME(e)),e=coe(e);return t}:NE,hoe=Ike});function Eke(e){return OE(e,Yne,hoe)}var Coe,voe=f(()=>{"use strict";s();c1();yoe();$ne();Coe=Eke});function Pke(e,t,r,n){var o=r.length,a=o,d=!n;if(e==null)return!a;for(e=Object(e);o--;){var c=r[o];if(d&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++o<a;){c=r[o];var u=c[0],l=e[u],p=c[1];if(d&&c[2]){if(l===void 0&&!(u in e))return!1}else{var g=new yg;if(n)var h=n(l,p,u,e,t,g);if(!(h===void 0?Ig(p,l,3,n,g):h))return!1}}return!0}var xoe,Toe=f(()=>{"use strict";s();n1();YE();xoe=Pke});function _ke(e){return e===e&&!Ls(e)}var eR,ZM=f(()=>{"use strict";s();pg();eR=_ke});function Rke(e){for(var t=Lc(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,eR(o)]}return t}var boe,Soe=f(()=>{"use strict";s();ZM();lv();boe=Rke});function Ake(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var tR,e2=f(()=>{"use strict";s();tR=Ake});function kke(e){var t=boe(e);return t.length==1&&t[0][2]?tR(t[0][0],t[0][1]):function(r){return r===e||xoe(r,e,t)}}var Ioe,Eoe=f(()=>{"use strict";s();Toe();Soe();e2();Ioe=kke});function Dke(e,t){return e!=null&&t in Object(e)}var Poe,_oe=f(()=>{"use strict";s();Poe=Dke});function wke(e,t,r){t=Hl(t,e);for(var n=-1,o=t.length,a=!1;++n<o;){var d=ec(t[n]);if(!(a=e!=null&&r(e,d)))break;e=e[d]}return a||++n!=o?a:(o=e==null?0:e.length,!!o&&Sg(o)&&bg(d,o)&&(Jr(e)||Tg(e)))}var Roe,Aoe=f(()=>{"use strict";s();bx();LE();Ja();HE();BE();Mh();Roe=wke});function Fke(e,t){return e!=null&&Roe(e,t,Poe)}var koe,Doe=f(()=>{"use strict";s();_oe();Aoe();koe=Fke});function Oke(e,t){return Nh(e)&&eR(t)?tR(ec(e),t):function(r){var n=roe(r,e);return n===void 0&&n===t?koe(r,e):Ig(t,n,3)}}var woe,Foe=f(()=>{"use strict";s();YE();noe();Doe();$_();ZM();e2();Mh();woe=Oke});function Nke(e){return function(t){return t==null?void 0:t[e]}}var Ooe,Noe=f(()=>{"use strict";s();Ooe=Nke});function Mke(e){return function(t){return Lh(t,e)}}var Moe,Loe=f(()=>{"use strict";s();X_();Moe=Mke});function Lke(e){return Nh(e)?Ooe(ec(e)):Moe(e)}var Hoe,Boe=f(()=>{"use strict";s();Noe();Loe();$_();Mh();Hoe=Lke});function Hke(e){return typeof e=="function"?e:e==null?_ne:typeof e=="object"?Jr(e)?woe(e[0],e[1]):Ioe(e):Hoe(e)}var cs,Ep=f(()=>{"use strict";s();Eoe();Foe();Rne();Ja();Boe();cs=Hke});function Bke(e,t,r,n){for(var o=-1,a=e==null?0:e.length;++o<a;){var d=e[o];t(n,d,r(d),e)}return n}var Uoe,Voe=f(()=>{"use strict";s();Uoe=Bke});function Uke(e){return function(t,r,n){for(var o=-1,a=Object(t),d=n(t),c=d.length;c--;){var u=d[e?c:++o];if(r(a[u],u,a)===!1)break}return t}}var joe,Woe=f(()=>{"use strict";s();joe=Uke});var Vke,zoe,Goe=f(()=>{"use strict";s();Woe();Vke=joe(),zoe=Vke});function jke(e,t){return e&&zoe(e,t,Lc)}var rR,t2=f(()=>{"use strict";s();Goe();lv();rR=jke});function Wke(e,t){return function(r,n){if(r==null)return r;if(!fl(r))return e(r,n);for(var o=r.length,a=t?o:-1,d=Object(r);(t?a--:++a<o)&&n(d[a],a,d)!==!1;);return r}}var qoe,Koe=f(()=>{"use strict";s();uv();qoe=Wke});var zke,nR,r2=f(()=>{"use strict";s();t2();Koe();zke=qoe(rR),nR=zke});function Gke(e,t,r,n){return nR(e,function(o,a,d){t(n,o,r(o),d)}),n}var Yoe,$oe=f(()=>{"use strict";s();r2();Yoe=Gke});function qke(e,t){return function(r,n){var o=Jr(r)?Uoe:Yoe,a=t?t():{};return o(r,e,cs(n,2),a)}}var oR,n2=f(()=>{"use strict";s();Voe();$oe();Ep();Ja();oR=qke});function Kke(e,t,r){for(var n=-1,o=e==null?0:e.length;++n<o;)if(r(t,e[n]))return!0;return!1}var Qoe,Xoe=f(()=>{"use strict";s();Qoe=Kke});function Yke(e,t){var r=-1,n=fl(e)?Array(e.length):[];return nR(e,function(o,a,d){n[++r]=t(o,a,d)}),n}var Joe,Zoe=f(()=>{"use strict";s();r2();uv();Joe=Yke});function $ke(e,t){var r=Jr(e)?Oh:Joe;return r(e,cs(t,3))}var eie,tie=f(()=>{"use strict";s();Y_();Ep();Zoe();Ja();eie=$ke});function Qke(e,t){return J_(eie(e,t),1)}var o2,rie=f(()=>{"use strict";s();XM();tie();o2=Qke});var Xke,Jke,Zke,i2,nie=f(()=>{"use strict";s();Tx();n2();Xke=Object.prototype,Jke=Xke.hasOwnProperty,Zke=oR(function(e,t,r){Jke.call(e,r)?e[r].push(t):Ll(e,r,[t])}),i2=Zke});var eDe,Sx,oie=f(()=>{"use strict";s();Tx();n2();eDe=oR(function(e,t,r){Ll(e,r,t)}),Sx=eDe});function tDe(e,t){var r={};return t=cs(t,3),rR(e,function(n,o,a){Ll(r,o,t(n,o,a))}),r}var a2,iie=f(()=>{"use strict";s();Tx();t2();Ep();a2=tDe});function nDe(e){if(typeof e!="function")throw new TypeError(rDe);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var rDe,aie,sie=f(()=>{"use strict";s();rDe="Expected a function";aie=nDe});function oDe(e,t,r,n){if(!Ls(e))return e;t=Hl(t,e);for(var o=-1,a=t.length,d=a-1,c=e;c!=null&&++o<a;){var u=ec(t[o]),l=r;if(u==="__proto__"||u==="constructor"||u==="prototype")return e;if(o!=d){var p=c[u];l=n?n(p,u,c):void 0,l===void 0&&(l=Ls(p)?p:bg(t[o+1])?[]:{})}jne(c,u,l),c=c[u]}return e}var die,cie=f(()=>{"use strict";s();Wne();bx();HE();pg();Mh();die=oDe});function iDe(e,t,r){for(var n=-1,o=t.length,a={};++n<o;){var d=t[n],c=Lh(e,d);r(c,d)&&die(a,Hl(d,e),c)}return a}var uie,lie=f(()=>{"use strict";s();X_();cie();bx();uie=iDe});function aDe(e,t){if(e==null)return{};var r=Oh(Coe(e),function(n){return[n]});return t=cs(t),uie(e,r,function(n,o){return t(n,o[0])})}var Ix,s2=f(()=>{"use strict";s();Y_();Ep();lie();voe();Ix=aDe});function sDe(e,t){return Ix(e,aie(cs(t)))}var d2,fie=f(()=>{"use strict";s();Ep();sie();s2();d2=sDe});var dDe,cDe,pie,mie=f(()=>{"use strict";s();T1();kne();wE();dDe=1/0,cDe=pl&&1/Cg(new pl([,-0]))[1]==dDe?function(e){return new pl(e)}:Ane,pie=cDe});function lDe(e,t,r){var n=-1,o=Une,a=e.length,d=!0,c=[],u=c;if(r)d=!1,o=Qoe;else if(a>=uDe){var l=t?null:pie(e);if(l)return Cg(l);d=!1,o=kE,u=new AE}else u=t?[]:c;e:for(;++n<a;){var p=e[n],g=t?t(p):p;if(p=r||p!==0?p:0,d&&g===g){for(var h=u.length;h--;)if(u[h]===g)continue e;t&&u.push(g),c.push(p)}else o(u,g,r)||(u!==c&&u.push(g),c.push(p))}return c}var uDe,gie,hie=f(()=>{"use strict";s();o1();Vne();Xoe();i1();mie();wE();uDe=200;gie=lDe});function fDe(e,t){return e&&e.length?gie(e,cs(t,2)):[]}var iR,yie=f(()=>{"use strict";s();Ep();hie();iR=fDe});var tc=f(()=>{"use strict";s();goe();rie();doe();nie();S1();oie();lv();iie();fie();s2();yie();});function mDe(e){if(e){if(typeof e=="object"||typeof e=="function")return e;l2[e]||(l2[e]={val:e})}else return pDe;return l2[e]}function f2(){return{map:p2?new p2:null}}var c2,u2,pDe,l2,p2,$n,m2=f(()=>{"use strict";s();k();Tne();tc();c2=typeof __WHY_DID_YOU_RECOMPUTE__<"u"&&__WHY_DID_YOU_RECOMPUTE__||typeof globalThis<"u"&&globalThis.__WHY_DID_YOU_RECOMPUTE__,u2=0,pDe={empty:!0},l2={},p2=typeof WeakMap>"u"?null:WeakMap,$n=function(t,r){if(r===void 0&&(r=100),!p2)return t;var n=f2(),o=0,a=u2,d=c2?new Map:void 0,c=c2?new Error("Memoized function defined").stack:"";return function(){for(var l,p,g,h,v=[],y=0;y<arguments.length;y++)v[y]=arguments[y];var T=n;(a!==u2||r>0&&o>r)&&(n=f2(),o=0,a=u2,d==null||d.clear()),T=n;for(var b=function(P){var _=mDe(v[P]);if(!(!((l=T.map)===null||l===void 0)&&l.has(_))&&((p=T.map)===null||p===void 0||p.set(_,f2()),c2&&d)){var D=(g=d.get(T))!==null&&g!==void 0?g:[],M=D.filter(function(z){return z!==_&&Hc(z,_)}),H=M[0];if(H){Ip.warn("Why-did-you-recompute: Identical (deep-comparison) past arguments to memoizeFunction found with differing instance equality: ");var U=new Error("Indentical argument passed").stack,F=function z(Y,B){Ip.table(Y),Object.keys(Y).forEach(function(q){var K=Y[q],$=B[q];K!==$&&Hc(K,$)&&(Ip.warn("Duplication present in child prop '".concat(q,"'")),z(K,$))})};F(H,_),Ip.warn(U),Ip.warn(c)}d.set(T,w(w([],V(D),!1),[_],!1))}T=(h=T.map)===null||h===void 0?void 0:h.get(_)},I=0;I<v.length;I++)b(I);return T.hasOwnProperty("value")||(T.value=t.apply(void 0,w([],V(v),!1)),o++),T.value}}});function aR(e){var t,r,n={};try{for(var o=$e(gDe(e)),a=o.next();!a.done;a=o.next()){var d=a.value,c=e[d];if(typeof c=="function"){var u=c;n[d]=$n(u.bind(n))}else n[d]=c}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}var gDe,Cie=f(()=>{"use strict";s();k();m2();gDe=Object.keys});var vie=f(()=>{"use strict";s();m2()});function Ex(e){return typeof e=="string"?Object.keys(e.split("")):typeof e=="number"||typeof e=="boolean"?[]:Object.keys(e)}var g2=f(()=>{"use strict";s()});function rc(e,t){return t}var xie=f(()=>{"use strict";s()});function y2(e){return hDe(e,function(t){return t!=null&&t!==""&&(!(t instanceof Array)||t.length>0)})}function hDe(e,t){if(e==null)return e;for(var r={},n=0,o=Ex(e);n<o.length;n++){var a=o[n];t(e[a])&&(r[a]=e[a])}return r}function ed(e,t){return Object.assign({},e,t)}function eu(e,t){return e.hasOwnProperty(t)}var Tie=f(()=>{"use strict";s();g2();xie()});var bie=f(()=>{"use strict";s();Cie()});function sR(e,t){var r=Ex(e),n=r.sort(function(a,d){return t(a.toString()).localeCompare(t(d.toString()))}),o={};return n.forEach(function(a){o[a]=e[a]}),o}var Sie=f(()=>{"use strict";s();g2()});var Ta=f(()=>{"use strict";s();vie();Tie();bie();Sie()});var C2,Iie=f(()=>{"use strict";s();C2=function(e){return typeof e=="function"}});var dR,Eie=f(()=>{"use strict";s();dR=function(e){return e}});var v2,Pie=f(()=>{"use strict";s();v2=function(e){return e===null}});function cR(e,t,r){t===void 0&&(t=dR),(0,_ie.default)(C2(t)||v2(t),"Expected payloadCreator to be a function, undefined or null");var n=v2(t)||t===dR?dR:function(c){for(var u=arguments.length,l=new Array(u>1?u-1:0),p=1;p<u;p++)l[p-1]=arguments[p];return c instanceof Error?c:t.apply(void 0,[c].concat(l))},o=C2(r),a=e.toString(),d=function(){var u=n.apply(void 0,arguments),l={type:e};return u instanceof Error&&(l.error=!0),u!==void 0&&(l.payload=u),o&&(l.meta=r.apply(void 0,arguments)),l};return d.toString=function(){return a},d}var _ie,Rie=f(()=>{"use strict";s();_ie=S(bO());Iie();Eie();Pie()});var Aie=f(()=>{"use strict";s();Rie()});function xDe(e){if(!e)return[void 0,void 0];var t=e.logger,r=Ke(e,["logger"]);return[r,t]}function wie(e,t){Die[e]=t}function x2(e,t){return function(r){return function(n){return function(o){var a=o,d=Die[a.type],c=vDe[a.type],u=t.eventNames&&t.eventNames[a.type],l=!!(d!==void 0||u);if(l){var p=d&&a.payload!==void 0?d(a.payload,t):void 0;if(p!==null){var g=xDe(p),h=g[0],v=g[1],y=c&&a.meta&&a.meta.metaPayload?c(a.meta.metaPayload,t):{},T=m(m({},h),y);kie&&kie(T);var b=a.meta&&a.meta.featureName||"None",I=a.meta&&a.meta.exportOptions||void 0;(v||e).logTrace({eventId:u||a.type,featureName:b,exportOptions:I,properties:T})}}return n(o)}}}}var Die,vDe,kie,T2=f(()=>{"use strict";s();k();Die={},vDe={};kie=void 0});function Qn(e,t){wie(e,t.getLogProperties||null);var r=cR(e,function(n){return n},function(){return{featureName:t.featureName,exportOptions:t.exportOptions||null}});return r}var uR=f(()=>{"use strict";s();Aie();T2()});var b2,Px,Fie,Oie=f(()=>{"use strict";s();uR();b2="selectors",Px="stores",Fie=Qn("LOAD_STATE",{featureName:"NoLogging"})});function S2(e,t){var r,n;if(t&&t[Px])throw new Error("The '".concat(Px,"' key of the state tree is reserved for functional stores."));if(t&&t[b2])throw new Error("The '".concat(b2,"' key of the state tree is reserved for debug output from selectors."));var o=a2(i2(e,function(u){return u.name}),function(u){return u[0].reducer}),a=wh(sR(o,function(u){return u})),d=wh(m((r={},r[Px]=a,r),t||{})),c=(n={},n[Px]={},n);return function(u,l){return l.type===Fie.toString()?l.payload:d(u||c,l)}}var Nie=f(()=>{"use strict";s();k();Ta();tc();Ml();Oie()});var I2,oYt,Mie=f(()=>{"use strict";s();uR();I2="ReduxStateJanitorStartedAction",oYt=Qn(I2,{featureName:"NoLogging"})});function tu(){var e={},t={};return{handlePayload:function(n,o){var a=n.toString();if(e[a]||t[a])throw new Error("Already handling an action type named ".concat(a));return e[a]=o,this},handleAction:function(n,o){var a=n.toString();if(e[a]||t[a])throw new Error("Already handling an action type named ".concat(a));return t[a]=o,this},done:function(n,o){var a=m({},e),d=m({},t);return function(c,u){if(c===void 0&&(c=n),u.type===I2)return o?o(c):n;var l=a[u.type];if(l)c=l(c,u.payload);else{var p=d[u.type];p&&(c=p(c,u))}return c}}}}var Lie=f(()=>{"use strict";s();k();Mie()});function Hh(e,t){if(e===t||Hie(e)&&Hie(t))return!0;if(!e||!t)return!1;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Hh(e[r],t[r]))return!1;return!0}else if(Array.isArray(e)||Array.isArray(t))return!1;if(Object.prototype.toString.call(e)==="[object Date]"&&Object.prototype.toString.call(t)==="[object Date]")return e.getTime()===t.getTime();if(typeof e=="object"&&typeof t=="object"){for(var n=0,o=Object.keys(e);n<o.length;n++){var a=o[n];if(!Hh(e[a],t[a]))return!1}for(var d=0,c=Object.keys(t);d<c.length;d++){var a=c[d];if(!(a in e))return!1}return!0}return!1}var Hie,Bie=f(()=>{"use strict";s();Hie=function(t){return t!==t}});function Uie(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function E2(e,t){if(Uie(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var o=0;o<r.length;o++)if(!TDe.call(t,r[o])||!Uie(e[r[o]],t[r[o]]))return!1;return!0}var TDe,Vie=f(()=>{"use strict";s();TDe=Object.prototype.hasOwnProperty});function jie(e,t){var r=e.name;return xn(function(n){return Zd.get(n.stores,r)||e.initialState},function(n){return aR(t(n))})}var Wie=f(()=>{"use strict";s();Ta();Tm();jM()});function ru(e,t,r){var n=t(void 0,{type:void 0}),o=jie({name:e,initialState:n},r);return{name:e,initialState:n,reducer:t,getSelectors:o}}var zie=f(()=>{"use strict";s();Wie()});var us=f(()=>{"use strict";s();yne();UM();jM();vne();Lie();Bie();Vie();uR();T2();zie();Nie()});var Gie,lR,fR,pR,mR=f(()=>{"use strict";s();us();Gie=Qn("AdditionalSuggestionsRequestedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"AdditionalSuggestionsRequested"}}),lR=Qn("QueryChangedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"QueryChange"},getLogProperties:function(t){return{queryLength:t.query.length.toString()}}}),fR=Qn("QueryFinishedAction",{featureName:"NoLogging"}),pR=Qn("PickerDismissedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"DismissPicker"},getLogProperties:function(t){return{dismissalReason:t.dismissalReason,queryLength:t.queryLength.toString(),suggestionsShown:t.suggestionsShown.toString()}}})});var bDe,gR,P2=f(()=>{"use strict";s();us();bDe=Qn("SuggestionListShownAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"SuggestionListShown"}}),gR=Qn("SuggestionPressedAction",{featureName:"LivePersonaPicker",exportOptions:{exportType:"UserInteraction",exportName:"PressPerson"},getLogProperties:function(t){return{suggestionSource:t.suggestionSource,suggestionOrigin:t.suggestionOrigin,queryLength:t.queryLength.toString(),suggestionsShown:t.suggestionsShown.toString(),pickedSuggestionIndex:t.pickedSuggestionIndex.toString()}}})});var _2=be((GYt,_x)=>{s();function SDe(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}_x.exports=SDe,_x.exports.__esModule=!0,_x.exports.default=_x.exports});var qie=be((KYt,Rx)=>{s();var IDe=_2();function EDe(e){if(Array.isArray(e))return IDe(e)}Rx.exports=EDe,Rx.exports.__esModule=!0,Rx.exports.default=Rx.exports});var Kie=be(($Yt,Ax)=>{s();function PDe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}Ax.exports=PDe,Ax.exports.__esModule=!0,Ax.exports.default=Ax.exports});var R2=be((XYt,kx)=>{s();var Yie=_2();function _De(e,t){if(e){if(typeof e=="string")return Yie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yie(e,t)}}kx.exports=_De,kx.exports.__esModule=!0,kx.exports.default=kx.exports});var $ie=be((ZYt,Dx)=>{s();function RDe(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Dx.exports=RDe,Dx.exports.__esModule=!0,Dx.exports.default=Dx.exports});var A2=be((t$t,wx)=>{s();var ADe=qie(),kDe=Kie(),DDe=R2(),wDe=$ie();function FDe(e){return ADe(e)||kDe(e)||DDe(e)||wDe()}wx.exports=FDe,wx.exports.__esModule=!0,wx.exports.default=wx.exports});function ODe(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(Math.random()*16);return e}function NDe(){var e=new Uint8Array(31);return window.crypto.getRandomValues(e),e}function k2(){return typeof window=="object"&&window.crypto&&NDe()||ODe()}var Qie=f(()=>{"use strict";s()});function Oo(){for(var e=k2(),t=0,r="",n=0;n<36;n++)switch(n){case 8:case 13:case 18:case 23:{t+=1,r+="-";break}case 14:{t+=1,r+="4";break}case 19:{r+=(e[n-t]%4+8).toString(16);break}default:{r+=(e[n-t]%16).toString(16);break}}return r}var Fx=f(()=>{"use strict";s();Qie()});var Xie=f(()=>{"use strict";s()});var Jie=f(()=>{"use strict";s()});var MDe,l$t,Zie=f(()=>{"use strict";s();MDe=function(){function e(){}return e.prototype.flush=function(){return Promise.resolve()},e.prototype.success=function(t,r){},e.prototype.expectedFailure=function(t,r){},e.prototype.unexpectedFailure=function(t,r){},e}(),l$t=function(){function e(){}return e.prototype.startMonitor=function(t,r,n){return new MDe},e.prototype.logEvent=function(){},e.prototype.logUserInteractionEvent=function(){},e.prototype.logError=function(){},e.prototype.logTrace=function(){},e.prototype.logEUPL=function(){},e.prototype.flush=function(){return Promise.resolve()},e.prototype.setEventHub=function(){},e.prototype.getStaticProperties=function(){return function(){return{}}},e.prototype.setStaticProperties=function(){},e.prototype.registerErrors=function(){},e}()});var eae=f(()=>{"use strict";s()});var Qi,D2=f(()=>{"use strict";s();Qi={clientScenario:"ClientScenario",feature:"Feature",dataLayerErrorPropName:"DataLayerError",statusCode:"StatusCode",requestId:"RequestId",retryAttemptedAfterAuthFailure:"RetryAttemptedAfterAuthFailure",retryLimitExceeded:"RetryLimitExceeded",personaType:"personaType",hintedPersonaType:"hintedPersonaType",personaId:"personaId",midgardError:"midgardError"}});function kr(e){return typeof e=="object"&&!!e&&eu(e,"family")&&eu(e,"code")&&typeof e.family=="string"&&typeof e.code=="number"}var tae=f(()=>{"use strict";s();Ta()});var nc=f(()=>{"use strict";s();tae()});function w2(e){var t=hR();return{stop:function(){try{Bh&&Bh.measure&&Bh.measure(e,t)}catch(n){}}}}function hR(){if(!Bh||!Bh.mark||!Math||!Math.random)return"";var e="Midgard Mark ".concat(Math.random());return Bh.mark(e),e}var Bh,F2=f(()=>{"use strict";s();Bh=typeof window<"u"&&window.performance});var yR,Ox,O2,LDe,N2=f(()=>{"use strict";s();F2();yR=function(){function e(t,r){this.timestamp=t,this.markName=r,this.privateFieldToPreventCastFromJsPlainObjects=42,this.privateFieldToPreventCastFromJsPlainObjects}return e.create=function(){return new e(Date.now(),hR())},e.createStart=function(t){return new e(t,"start")},e.NullInstance=new e(-1,""),e}(),Ox=yR.NullInstance,O2=yR.create,LDe=yR.createStart});var M2=f(()=>{"use strict";s();N2();F2()});function Pp(e){var t,r,n=e.scenarioName,o=e.featureName,a=e.operation,d=e.monitorStarter,c=e.requestId,u=e.extraProps,l=e.extraLogPropsOnFinish,p=e.successAction,g=e.errorAction,h=e.treatAsSuccessCondition,v=e.treatAsExpectedError,y=e.skipTrace,T=m(m(m({},u),(t={},t[Qi.feature]=o,t)),c?(r={},r[Qi.requestId]=c,r):{}),b=y?void 0:w2("\u{1F680} data call : ".concat(n)),I=d.startMonitor(n,o,T),E=typeof l=="function"?{success:l,failure:l}:l,P=a();return P.then(function(_){return b==null||b.stop(),_}).then(function(_){return rae({monitor:I,result:_,extraProps:m(m({},T),E==null?void 0:E.success(_)),successAction:p})},function(_){return HDe({monitor:I,failure:_,extraProps:m(m({},T),E==null?void 0:E.failure(_)),successAction:p,errorAction:g,treatAsSuccessCondition:h,treatAsExpectedError:v})}).catch(function(_){I.unexpectedFailure("FailedDispatch",{Error:_.toString(),featureName:o})}),P}function rae(e){var t=e.monitor,r=e.result,n=e.extraProps,o=e.successAction;t.success(void 0,n),o&&o(r,n)}function HDe(e){var t,r,n,o,a=e.monitor,d=e.failure,c=e.extraProps,u=e.successAction,l=e.errorAction,p=e.treatAsSuccessCondition,g=e.treatAsExpectedError,h=m(m(m(m(m({},c),d&&d.statusCode?(t={},t[Qi.statusCode]=d.statusCode.toString(),t):{}),d&&kr(d.midgardError)?(r={},r[Qi.midgardError]=d.midgardError,r):{}),d&&d.retryAttemptedAfterAuthFailure?(n={},n[Qi.retryAttemptedAfterAuthFailure]=d.retryAttemptedAfterAuthFailure.toString(),n):{}),d&&d.retryLimitExceeded?(o={},o[Qi.retryLimitExceeded]=d.retryLimitExceeded.toString(),o):{});if(p&&p(d)){rae({monitor:a,result:void 0,extraProps:h,successAction:u});return}else d&&d.isExpected||g&&g(d)?a.expectedFailure(d.qosTagId,h):a.unexpectedFailure(d?d.qosTagId:"Unknown",h);l&&l(d)}var nae=f(()=>{"use strict";s();k();nc();M2();D2()});var Uh=f(()=>{"use strict";s();Xie();Jie();Zie();eae();D2();nae()});function CR(e,t){return Qn(e,{featureName:t,getLogProperties:function(n,o){return o.logDataScenarioActions?{}:null}})}function vR(e,t,r){return{success:function(o){return m(m(m({},e.success&&e.success(o)),e.fromParameters&&e.fromParameters(r)),e.fromOptions&&e.fromOptions(t))},failure:function(o){return m(m(m({},e.failure&&e.failure(o)),e.fromParameters&&e.fromParameters(r)),e.fromOptions&&e.fromOptions(t))}}}function L2(e,t,r,n){var o=this,a=function(c,u,l){return Wt(o,void 0,void 0,function(){var p,g,h,v,y,T,b,I;return pt(this,function(E){return p=c.monitorStarter,g=c.treatAsExpectedError,h=c.clientScenario,v=c.hostAppApp,y=u.requestId,T=u.storeKey,b=function(){return r(c,{requestId:y,storeKey:T,clientScenario:h,hostAppApp:v},l)},[2,Pp({scenarioName:t,featureName:e,requestId:y,monitorStarter:p,extraProps:h?(I={},I[Qi.clientScenario]=h,I):void 0,treatAsExpectedError:g,extraLogPropsOnFinish:n&&vR(n,c,l),operation:b})]})})};return xR(e,t,a)}function xR(e,t,r){var n=this,o=CR("".concat(t,"StartedAction"),"DataLoadStartAction"),a=CR("".concat(t,"SucceededAction"),e),d=CR("".concat(t,"FailedAction"),e),c=CR("".concat(t,"ResetAction"),e),u=function(p,g,h){return Wt(n,void 0,void 0,function(){var v,y,T,b,I,E,P,_,D;return pt(this,function(M){switch(M.label){case 0:v=p.dispatch,y=p.clientScenario,T=p.processResponse,b=p.hostAppApp,I=Oo(),v(o({storeKey:g,requestId:I,parameters:h,timestamp:Date.now()})),M.label=1;case 1:return M.trys.push([1,5,,6]),P=function(U){var F=function(Y){var B={storeKey:g,requestId:I,parameters:h,response:Y,timestamp:Date.now()};return v(a(B)),E={resolved:!0,value:B},E};return T?(E={resolved:!1,promise:T(U).then(function(z){return F(z).value})},E):F(U)},[4,r(p,{requestId:I,storeKey:g,clientScenario:y,hostAppApp:b},h,P)];case 2:return _=M.sent(),E||(E=P(_)),E.resolved?[3,4]:[4,E.promise];case 3:return[2,M.sent()];case 4:return[2,E.value];case 5:throw D=M.sent(),v(d({storeKey:g,requestId:I,parameters:h,error:BDe(D),timestamp:Date.now()})),D;case 6:return[2]}})})};return{fetch:u,startAction:o,successAction:a,errorAction:d,resetAction:c,scenarioName:t}}function BDe(e){var t,r,n,o,a;return e?typeof e=="string"?n=e:(typeof e.isExpected=="boolean"&&(t=e.isExpected),typeof e.qosTagId=="string"&&(r=e.qosTagId),typeof e.message=="string"&&(n=e.message),typeof e.statusCode=="number"&&(o=e.statusCode),typeof e.responseText=="string"&&(a=e.responseText)):n=e+"",{qosTagId:r,isExpected:t,message:n,statusCode:o,responseText:a}}function H2(e){var t=this,r=[],n=function(a,d,c){var u=JSON.stringify({storeKey:d,parameters:c}),l=r.find(function(v){return u===v.key&&E2(a,v.options)});if(l&&l.promise)return l.promise;var p=function(){return Wt(t,void 0,void 0,function(){var y;return pt(this,function(T){switch(T.label){case 0:return T.trys.push([0,,2,3]),[4,e.fetch(a,d,c)];case 1:return[2,T.sent()];case 2:return y=r.indexOf(h),r.splice(y,1),[7];case 3:return[2]}})})},g=p(),h={options:a,promise:g,key:u};return r.push(h),g};return m(m({},e),{fetch:n})}var oae=f(()=>{"use strict";s();k();Fx();us();Uh()});function UDe(e,t){return Hh(e.response,t.response)?e.response:t.response}function Vh(e,t,r){r===void 0&&(r=UDe);var n=function(p){return function(g,h){var v=h.payload.storeKey.key,y=Zd.get(g,v)||aae,T=p(y,h.payload);return(y.isCallInProgress!==T.isCallInProgress||y.response!==T.response||!Hh(y.error,T.error))&&(g=Zd.insert(g,v,T)),g}},o=n(function(l,p){return m(m({},l),{isCallInProgress:!0,hasStarted:!0})}),a=n(function(l,p){return m(m({},l),{isCallInProgress:!1,error:m(m({},p.error),{requestId:p.requestId})})}),d=n(function(l,p){return m(m({},l),{isCallInProgress:!1,response:r(l,p),error:null,successTimestamp:p.timestamp})}),c=n(function(l,p){return m(m({},l),{isCallInProgress:!1,response:null,error:null})}),u=tu().handleAction(t.startAction,o).handleAction(t.errorAction,a).handleAction(t.successAction,d).handleAction(t.resetAction,c).done(null);return ru(e,u,iae)}var iae,aae,sae=f(()=>{"use strict";s();k();us();iae=function(t){return WM({getLatestSuccess:function(n){var o=Zd.get(t,n.key);return o&&o.response||void 0},getLatestSuccessWithTimestamp:function(n){var o=Zd.get(t,n.key);return{response:o&&o.response||void 0,timestamp:o&&o.successTimestamp||0}},getLatestError:function(n){var o=Zd.get(t,n.key);return o&&o.error||void 0}},function(r){var n=Zd.get(t,r.key);return{isLoading:!!(n!=null&&n.isCallInProgress),hasError:!!(n!=null&&n.error),hasLoadedPreviously:!!(n!=null&&n.response)}})},aae={hasStarted:!1,response:null,error:null,isCallInProgress:!1,successTimestamp:0}});var TR=f(()=>{"use strict";s();oae();sae()});var VDe,jDe,B2,Nx,bR=f(()=>{"use strict";s();TR();VDe=function(t,r,n){return n.getHostAppSuggestions(n.query,n.options)},jDe={success:function(t){return{responseLength:t?t.length.toString():"0"}},fromParameters:function(t){var r,n;return{queryLength:((r=t.query)===null||r===void 0?void 0:r.length.toString())||"0",didSearchDirectory:((n=t.options)===null||n===void 0?void 0:n.searchDirectory)||"false"}}},B2=L2("PickerHostAppSuggestions","GetHostAppSuggestions",VDe,jDe),Nx=Vh("HostAppSuggestionsStore",B2)});function IR(e){return dae(e).then(cae)}function dae(e){var t=e.scenarioName,r=e.featureName,n=e.operation,o=e.monitorStarter,a=e.requestId,d=e.extraProps,c=e.extraLogPropsOnFinish,u=e.successAction,l=u===void 0?function(){}:u,p=e.errorAction,g=e.treatAsSuccessCondition,h=e.treatAsExpectedError,v=e.wrapWithLogging,y=typeof c=="function"?{success:c,failure:c}:c,T=function(){return n().then(WDe)},b=v?function(){return v(T)}:T;return Pp({operation:b,scenarioName:t,featureName:r,extraProps:d,monitorStarter:o,requestId:a,extraLogPropsOnFinish:{success:function(E){return m(m({},y&&y.success(E)),GDe(E))},failure:function(E){return m(m({},y&&y.failure(E)),uae(E.headers))}},successAction:function(E,P){return l(E&&cae(E),P)},errorAction:p,treatAsSuccessCondition:g,treatAsExpectedError:h})}function WDe(e){return zDe(e,e.Headers)}function cae(e){return e.parsedResponse}function zDe(e,t){var r=t==null?void 0:t[SR];return m(m({},e),r?{debug:{traceId:r}}:{})}function GDe(e){var t=e.additionalRequestInformation?e.additionalRequestInformation.didMakeAuthTokenRequest:!1,r=e.additionalRequestInformation?e.additionalRequestInformation.durationWaitingOnAuthToken.toString():"0",n=e.additionalRequestInformation?e.additionalRequestInformation.didMakeConfigRequest:!1,o=e.RequestDurationFromEvents?"".concat(e.RequestDurationFromEvents):void 0;return m(m({},uae(e.Headers)),{didMakeAuthTokenRequest:t,durationWaitingOnAuthToken:r,didMakeConfigRequest:n,eventDuration:o})}function uae(e){if(!e)return{};var t="x-inboundduration",r="x-beserver",n="x-serverversion",o="x-datacenter",a="x-websocketcorrelationid",d="iswebsocketrequest",c="x-azure-ref",u={};if(e[t]&&(u[t]=e[t]),e[r]&&(u[r]=e[r]),e[n]&&(u[n]=e[n]),e[SR]&&(u[SR]=e[SR]),e[o]&&(u[o]=e[o]),u[d]=e[a]?"1":"0",e[c]){var l=qDe(e[c]);l&&(u[c]=e[c],u["".concat(c,"-EdgeLocation")]=l[0],u["".concat(c,"-EdgeRequestId")]=l[1])}return u}function qDe(e){if(!e||!e.trim())return null;try{var t=atob(e.substring(1)).substring(24);return/^([\dA-Za-z]+)\0([\d-A-Za-z]{36})$/.test(t)?t.split("\0"):null}catch(r){return null}}var SR,U2=f(()=>{"use strict";s();k();Uh();SR="x-correlationid"});function KDe(e,t,r){var n=vR(e,t,r);return{success:function(a){return n.success(a.parsedResponse)},failure:n.failure}}function V2(e,t,r){return YDe(e,t,IR,r)}function YDe(e,t,r,n){var o=this,a=n&&n.debounce||!1,d=n&&n.httpMethod||"Get",c=n&&n.logPropertyExtractors,u="".concat(d).concat(e),l=function(h,v,y){return Wt(o,void 0,void 0,function(){var T,b,I,E,P,_,D,M,H;return pt(this,function(U){return T=h.monitorStarter,b=h.lokiRestProvider,I=h.treatAsExpectedError,E=h.clientScenario,P=h.wrapWithLogging,_=v.requestId,D=v.hostAppApp,M=function(){return t(b,{requestId:_,clientScenario:E,hostAppApp:D},y)},[2,r({scenarioName:u,featureName:e,requestId:_,monitorStarter:T,treatAsExpectedError:I,extraProps:E?(H={},H[Qi.clientScenario]=E,H):void 0,extraLogPropsOnFinish:c&&KDe(c,v,y),operation:M,wrapWithLogging:P})]})})},p=xR(e,u,l);return a?H2(p):p}var lae=f(()=>{"use strict";s();k();TR();Uh();U2()});var j2=be((TQt,Mx)=>{s();function fae(e,t,r,n,o,a,d){try{var c=e[a](d),u=c.value}catch(l){r(l);return}c.done?t(u):Promise.resolve(u).then(n,o)}function $De(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var a=e.apply(t,r);function d(u){fae(a,n,o,d,c,"next",u)}function c(u){fae(a,n,o,d,c,"throw",u)}d(void 0)})}}Mx.exports=$De,Mx.exports.__esModule=!0,Mx.exports.default=Mx.exports});var W2=f(()=>{"use strict";s()});var mae=f(()=>{"use strict";s();W2()});function _p(e){return{family:QDe,code:e}}var QDe,nu,z2=f(()=>{"use strict";s();QDe="caching-request";(function(e){e[e.CACHE_MISS=0]="CACHE_MISS",e[e.EXPIRED=1]="EXPIRED",e[e.VERSION_MISMATCH=2]="VERSION_MISMATCH",e[e.UNKNOWN_ERROR=3]="UNKNOWN_ERROR"})(nu||(nu={}))});var gae=be((kQt,Lx)=>{s();function XDe(e){if(Array.isArray(e))return e}Lx.exports=XDe,Lx.exports.__esModule=!0,Lx.exports.default=Lx.exports});var hae=be((wQt,Hx)=>{s();function JDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,o,a,d,c=[],u=!0,l=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(p){l=!0,o=p}finally{try{if(!u&&r.return!=null&&(d=r.return(),Object(d)!==d))return}finally{if(l)throw o}}return c}}Hx.exports=JDe,Hx.exports.__esModule=!0,Hx.exports.default=Hx.exports});var yae=be((OQt,Bx)=>{s();function ZDe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Bx.exports=ZDe,Bx.exports.__esModule=!0,Bx.exports.default=Bx.exports});var ER=be((MQt,Ux)=>{s();var ewe=gae(),twe=hae(),rwe=R2(),nwe=yae();function owe(e,t){return ewe(e)||twe(e,t)||rwe(e,t)||nwe()}Ux.exports=owe,Ux.exports.__esModule=!0,Ux.exports.default=Ux.exports});var iwe,G2,awe,ba,Cae=f(()=>{"use strict";s();iwe=re(),G2=iwe.NativeModules,awe=G2.PlatformLocalStorage||G2.RNC_AsyncSQLiteDBStorage||G2.RNCAsyncStorage,ba=awe});function jh(e,t){var r=arguments.length>1;if(typeof e!="string"&&console.warn("[AsyncStorage] Using ".concat(typeof e," type for key is not supported. This can lead to unexpected behavior/errors. Use string instead.\nKey passed: ").concat(e,"\n")),r&&typeof t!="string"){if(t==null)throw new Error("[AsyncStorage] Passing null/undefined as value is not supported. If you want to remove value, Use .remove method instead.\nPassed value: ".concat(t,"\nPassed key: ").concat(e,"\n"));console.warn('[AsyncStorage] The value for key "'.concat(e,'" is not a string. This can lead to unexpected behavior/errors. Consider stringifying it.\nPassed value: ').concat(t,"\nPassed key: ").concat(e,"\n"))}}function Rp(e){return!e||Array.isArray(e)&&e.length===0?null:(Array.isArray(e)?e:[e]).map(function(t){return Y2(t)})}function Y2(e){if(!e)return null;var t=new Error(e.message);return t.key=e.key,t}var q2,K2,$2,Q2=f(()=>{"use strict";s();q2=S(ER());Cae();if(!ba)throw new Error("[@RNC/AsyncStorage]: NativeModule: AsyncStorage is null.\n\nTo fix this issue try these steps:\n\n  \u2022 Run `react-native link @react-native-community/async-storage` in the project root.\n\n  \u2022 Rebuild and restart the app.\n\n  \u2022 Run the packager with `--reset-cache` flag.\n\n  \u2022 If you are using CocoaPods on iOS, run `pod install` in the `ios` directory and then rebuild and re-run the app.\n\n  \u2022 If this happens while testing with Jest, check out docs how to integrate AsyncStorage with it: https://react-native-community.github.io/async-storage/docs/advanced/jest\n\nIf none of these fix the issue, please open an issue on the Github repository: https://github.com/react-native-community/react-native-async-storage/issues \n");K2={_getRequests:[],_getKeys:[],_immediate:null,getItem:function(t,r){return new Promise(function(n,o){jh(t),ba.multiGet([t],function(a,d){var c=d&&d[0]&&d[0][1]?d[0][1]:null,u=Rp(a);r&&r(u&&u[0],c),u?o(u[0]):n(c)})})},setItem:function(t,r,n){return new Promise(function(o,a){jh(t,r),ba.multiSet([[t,r]],function(d){var c=Rp(d);n&&n(c&&c[0]),c?a(c[0]):o(null)})})},removeItem:function(t,r){return new Promise(function(n,o){jh(t),ba.multiRemove([t],function(a){var d=Rp(a);r&&r(d&&d[0]),d?o(d[0]):n(null)})})},mergeItem:function(t,r,n){return new Promise(function(o,a){jh(t,r),ba.multiMerge([[t,r]],function(d){var c=Rp(d);n&&n(c&&c[0]),c?a(c[0]):o(null)})})},clear:function(t){return new Promise(function(r,n){ba.clear(function(o){var a=Y2(o);t&&t(a),a?n(a):r(null)})})},getAllKeys:function(t){return new Promise(function(r,n){ba.getAllKeys(function(o,a){var d=Y2(o);t&&t(d,a),d?n(d):r(a)})})},flushGetRequests:function(){var t=this._getRequests,r=this._getKeys;this._getRequests=[],this._getKeys=[],ba.multiGet(r,function(n,o){var a={};o&&o.forEach(function(g){var h=(0,q2.default)(g,2),v=h[0],y=h[1];return a[v]=y,y});for(var d=t.length,c=0;c<d;c++){var u=t[c],l=u.keys,p=l.map(function(g){return[g,a[g]]});u.callback&&u.callback(null,p),u.resolve&&u.resolve(p)}})},multiGet:function(t,r){var n=this;this._immediate||(this._immediate=setImmediate(function(){n._immediate=null,n.flushGetRequests()}));var o={keys:t,callback:r,keyIndex:this._getKeys.length,resolve:null,reject:null},a=new Promise(function(d,c){o.resolve=d,o.reject=c});return this._getRequests.push(o),t.forEach(function(d){n._getKeys.indexOf(d)===-1&&n._getKeys.push(d)}),a},multiSet:function(t,r){return new Promise(function(n,o){t.forEach(function(a){var d=(0,q2.default)(a,2),c=d[0],u=d[1];jh(c,u)}),ba.multiSet(t,function(a){var d=Rp(a);r&&r(d),d?o(d):n(null)})})},multiRemove:function(t,r){return new Promise(function(n,o){t.forEach(function(a){return jh(a)}),ba.multiRemove(t,function(a){var d=Rp(a);r&&r(d),d?o(d):n(null)})})},multiMerge:function(t,r){return new Promise(function(n,o){ba.multiMerge(t,function(a){var d=Rp(a);r&&r(d),d?o(d):n(null)})})}};ba.multiMerge||(delete K2.mergeItem,delete K2.multiMerge);$2=K2});var vae=f(()=>{"use strict";s();Q2()});var X2,xae=f(()=>{"use strict";s();Q2();vae();X2=$2});function Sae(e,t,r){return Tae(this,void 0,void 0,function(){var n;return bae(this,function(o){return n=Eae(e,r),[2,X2.setItem(n,t)]})})}function Iae(e,t){return Tae(this,void 0,void 0,function(){var r,n;return bae(this,function(o){switch(o.label){case 0:return r=Eae(e,t),[4,X2.getItem(r)];case 1:return n=o.sent(),[2,swe(n)]}})})}function swe(e){return e===null?void 0:e}function Eae(e,t){return"".concat(t,"_").concat(e)}var Tae,bae,Pae=f(()=>{"use strict";s();xae();Tae=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},bae=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});function _R(e,t,r){var n=PR.get(r)||new Map;n.set(e,t),PR.set(r,n)}function RR(e,t){var r=PR.get(t);return r?r.get(e):void 0}function J2(e,t){var r=PR.get(t);r&&r.delete(e)}var PR,Z2=f(()=>{"use strict";s();PR=new Map});function Rae(e,t){try{window.sessionStorage&&window.sessionStorage.setItem(e,t)}catch(r){}}function Aae(e){try{if(window.sessionStorage){var t=window.sessionStorage.getItem(e);return t===null?void 0:t}return}catch(r){return}}function kae(e){try{window.sessionStorage&&window.sessionStorage.removeItem(e)}catch(t){}}var Dae=f(()=>{"use strict";s()});function AR(e,t,r){_R(e,t,r),Rae(e,t)}function kR(e,t){var r=Aae(e);return r!==void 0?r:RR(e,t)}function DR(e,t){J2(e,t),kae(e)}var wae=f(()=>{"use strict";s();Z2();Dae()});function Fae(e,t){return fwe(this,void 0,void 0,function(){var r,n,o;return pwe(this,function(a){switch(a.label){case 0:return r=RR(t,e),r?[2,JSON.parse(r)]:[3,1];case 1:return a.trys.push([1,3,,4]),[4,Iae(t,e)];case 2:return n=a.sent(),n?[2,JSON.parse(n)]:[3,4];case 3:throw o=a.sent(),kr(o)?o:gwe;case 4:throw mwe}})})}function Oae(e,t,r,n){var o={version:r,data:n,dateAdded:Date.now()},a=JSON.stringify(o);_R(t,a,e),Sae(t,a,e)}var fwe,pwe,Wh,mwe,gwe,Nae=f(()=>{"use strict";s();nc();Pae();z2();Z2();fwe=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},pwe=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Wh="TTLCacheUtils",mwe={isExpected:!0,qosTagId:Wh,midgardError:_p(nu.CACHE_MISS)},gwe={isExpected:!1,qosTagId:Wh,midgardError:_p(nu.UNKNOWN_ERROR)}});function Mae(e,t,r,n){var o="pending_".concat(r,"_").concat(e,"_").concat(t),a=wR.get(o);return a||new Promise(function(d,c){var u=n();wR.set(o,u),u.then(function(l){wR.delete(o),d(l)}).catch(function(l){wR.delete(o),c(l)})})}function hwe(e,t){return eL(this,void 0,void 0,function(){var r;return tL(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e];case 1:return n.sent(),t.logEvent({eventId:"Cache TTR updated successfully"}),[3,3];case 2:return r=n.sent(),[3,3];case 3:return[2]}})})}function rL(e){return eL(this,void 0,void 0,function(){var t,r,n,o,a,d,c,u,l,p,g,h,v,y,T,b,I,E,P=this;return tL(this,function(_){switch(_.label){case 0:t=e.id,r=e.logger,n=e.cacheKey,o=e.version,a=e.ttlMs,d=e.fallbackCallback,c=e.rateLimiter,u=e.ttrMs,l=function(){return Mae(t,n,"getItem",function(){return Fae(t,n)})},p=function(){return Mae(t,n,"fallback",function(){return eL(P,void 0,void 0,function(){var M,H;return tL(this,function(U){switch(U.label){case 0:return U.trys.push([0,5,,6]),M=void 0,c?[4,c.executeWithThrottling(d,"".concat(t,"_").concat(n))]:[3,2];case 1:return M=U.sent(),[3,4];case 2:return[4,d()];case 3:M=U.sent(),U.label=4;case 4:return Oae(t,n,o,M),r.logEvent({eventId:"Fallback success and setting value"}),[2,M];case 5:throw H=U.sent(),r.logError({eventId:"Fallback failure, skipping cache update."}),H;case 6:return[2]}})})})},g=void 0,h=!1,_.label=1;case 1:return _.trys.push([1,3,,4]),r.logEvent({eventId:"Cache access start"}),[4,l()];case 2:return v=_.sent(),v.version===o?(y=Date.now(),y<=v.dateAdded+a?(u!==void 0&&y>=v.dateAdded+u&&hwe(p(),r),r.logEvent({eventId:"Obtained from cache"}),g=v.data):(h=!0,r.logEvent({eventId:"Cache has expired"}))):r.logEvent({eventId:"Cache has mismatching version"}),[3,4];case 3:return T=_.sent(),r.logEvent({eventId:"Cache miss or failure"}),[3,4];case 4:if(g)return[3,9];_.label=5;case 5:return _.trys.push([5,7,,8]),[4,p()];case 6:return b=_.sent(),[2,{value:b,fetchedFromCache:!1,fetchedFromFallback:!0}];case 7:throw I=_.sent(),kr(I==null?void 0:I.midgardError)?I:(E={isExpected:!1,qosTagId:Wh,midgardError:_p(nu.UNKNOWN_ERROR),cacheExpired:h,innerException:I},E);case 8:return[3,10];case 9:return[2,{value:g,fetchedFromCache:!0,fetchedFromFallback:!1}];case 10:return[2]}})})}var eL,tL,hXt,yXt,wR,Lae=f(()=>{"use strict";s();nc();z2();Nae();eL=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},tL=function(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,o,a,d;return d={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function c(l){return function(p){return u([l,p])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;d&&(d=0,l[0]&&(r=0)),r;)try{if(n=1,o&&(a=l[0]&2?o.return:l[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,l[1])).done)return a;switch(o=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){r.label=l[1];break}if(l[0]===6&&r.label<a[1]){r.label=a[1],a=l;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(l);break}a[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(p){l=[6,p],o=0}finally{n=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},hXt={isExpected:!0,qosTagId:Wh,midgardError:_p(nu.VERSION_MISMATCH)},yXt={isExpected:!0,qosTagId:Wh,midgardError:_p(nu.EXPIRED)},wR=new Map});var nL=f(()=>{"use strict";s();Lae();wae()});function Hae(e,t){window.setTimeout(function(){return e()},t)}var Bae=f(()=>{"use strict";s()});var Vx,jx,Uae=f(()=>{"use strict";s();Bae();Vx="Rate limit reached",jx=function(){function e(t,r){this.rateLimit=t,this.slidingWindowDuration=r,this.currentRate=0,this.throttledRetryAfter=new Map}return e.prototype.updateRateLimit=function(){var t=this;this.currentRate++,Hae(function(){return t.currentRate=Math.max(t.currentRate-1,0)},this.slidingWindowDuration)},e.prototype.execute=function(t){if(this.currentRate>=this.rateLimit)throw new Error(Vx);this.updateRateLimit(),t()},e.prototype.executeWithThrottling=function(t,r){var n=this,o=this.currentRate>=this.rateLimit,a;if(!o&&r&&(a=this.throttledRetryAfter.get(r),o=a&&a>Date.now()||!1),o)throw new Error(Vx);return this.updateRateLimit(),r?new Promise(function(d,c){var u=t();u.then(function(l){a!==void 0&&r&&n.throttledRetryAfter.delete(r),d(l)}).catch(function(l){var p,g="Retry-After";if(l.statusCode===429&&(!((p=l.headers)===null||p===void 0)&&p[g])){var h=Number(l.headers[g]);if(!Object.is(h,NaN)&&h>0){var v=Date.now()+h*1e3;n.throttledRetryAfter.set(r,v)}}c(l)})}):t()},e}()});var oc=f(()=>{"use strict";s();Ta();Fx();Uae()});function ywe(e){return function(t){return t in e}}function oL(e){return e.family===Wx&&e.code in G?e.code:void 0}function ae(e){return{family:Wx,code:e}}function iL(e){e(Wx,G)}var Wx,G,Vae,FR=f(()=>{"use strict";s();Wx="auth-token";(function(e){e[e.AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE=0]="AUTH_INTERNET_CONNECTION_IS_NOT_AVAILABLE",e[e.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS=1]="AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS",e[e.EXPECTED_ERROR=2]="EXPECTED_ERROR",e[e.EXPECTED_TOKEN_INVALIDATED_ERROR=3]="EXPECTED_TOKEN_INVALIDATED_ERROR",e[e.GET_AUTH_TOKEN_TIMEOUT=4]="GET_AUTH_TOKEN_TIMEOUT",e[e.INVALID_AUTH_TOKEN=5]="INVALID_AUTH_TOKEN",e[e.GENERIC_TOKEN_ERROR=6]="GENERIC_TOKEN_ERROR",e[e.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED=7]="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED",e[e.BAD_REFRESH_TOKEN=8]="BAD_REFRESH_TOKEN",e[e.CONDITIONAL_ACCESS_BLOCKED=9]="CONDITIONAL_ACCESS_BLOCKED",e[e.PRECONDITION_VIOLATED=10]="PRECONDITION_VIOLATED",e[e.POLICY_REQUIRED_ERROR=11]="POLICY_REQUIRED_ERROR",e[e.DEVICE_CONNECTION_IS_NOT_AVAILABLE=12]="DEVICE_CONNECTION_IS_NOT_AVAILABLE",e[e.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN=13]="BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN",e[e.TIMEOUT_FETCHING_TOKEN=14]="TIMEOUT_FETCHING_TOKEN",e[e.NO_RESPONSE_FROM_SERVICE=15]="NO_RESPONSE_FROM_SERVICE",e[e.TIMEOUT_ERROR=16]="TIMEOUT_ERROR",e[e.NO_NETWORK_AVAILABLE=17]="NO_NETWORK_AVAILABLE",e[e.AD_ERROR_CACHE_BAD_FORMAT=18]="AD_ERROR_CACHE_BAD_FORMAT",e[e.AD_ERROR_CACHE_MULTIPLE_USERS=19]="AD_ERROR_CACHE_MULTIPLE_USERS",e[e.AD_ERROR_CACHE_NO_REFRESH_TOKEN=20]="AD_ERROR_CACHE_NO_REFRESH_TOKEN",e[e.AD_ERROR_CACHE_VERSION_MISMATCH=21]="AD_ERROR_CACHE_VERSION_MISMATCH",e[e.AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT=22]="AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT",e[e.AD_ERROR_SERVER_AUTHORIZATION_CODE=23]="AD_ERROR_SERVER_AUTHORIZATION_CODE",e[e.AD_ERROR_SERVER_INVALID_ID_TOKEN=24]="AD_ERROR_SERVER_INVALID_ID_TOKEN",e[e.AD_ERROR_SERVER_INVALID_RESPONSE=25]="AD_ERROR_SERVER_INVALID_RESPONSE",e[e.AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER=26]="AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER",e[e.AD_ERROR_SERVER_NON_HTTPS_REDIRECT=27]="AD_ERROR_SERVER_NON_HTTPS_REDIRECT",e[e.AD_ERROR_SERVER_OAUTH=28]="AD_ERROR_SERVER_OAUTH",e[e.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED=29]="AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED",e[e.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED=30]="AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED",e[e.AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED=31]="AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED",e[e.AD_ERROR_SERVER_UNSUPPORTED_REQUEST=32]="AD_ERROR_SERVER_UNSUPPORTED_REQUEST",e[e.AD_ERROR_SERVER_USER_INPUT_NEEDED=33]="AD_ERROR_SERVER_USER_INPUT_NEEDED",e[e.AD_ERROR_SERVER_WPJ_REQUIRED=34]="AD_ERROR_SERVER_WPJ_REQUIRED",e[e.AD_ERROR_SERVER_WRONG_USER=35]="AD_ERROR_SERVER_WRONG_USER",e[e.AD_ERROR_TOKENBROKER_BAD_RESUME_STATE=36]="AD_ERROR_TOKENBROKER_BAD_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_DECRYPTION_FAILED=37]="AD_ERROR_TOKENBROKER_DECRYPTION_FAILED",e[e.AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY=38]="AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY",e[e.AD_ERROR_TOKENBROKER_HASH_MISSING=39]="AD_ERROR_TOKENBROKER_HASH_MISSING",e[e.AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI=40]="AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI",e[e.AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE=41]="AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_NO_RESUME_STATE=42]="AD_ERROR_TOKENBROKER_NO_RESUME_STATE",e[e.AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE=43]="AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE",e[e.AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION=44]="AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION",e[e.AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH=45]="AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH",e[e.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED=46]="AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED",e[e.AD_ERROR_TOKENBROKER_UNKNOWN=47]="AD_ERROR_TOKENBROKER_UNKNOWN",e[e.AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER=48]="AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER",e[e.AD_ERROR_UI_NOT_ON_MAIN_THREAD=49]="AD_ERROR_UI_NOT_ON_MAIN_THREAD",e[e.AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION=50]="AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION",e[e.AD_ERROR_UI_USER_CANCEL=51]="AD_ERROR_UI_USER_CANCEL",e[e.AD_ERROR_UNEXPECTED=52]="AD_ERROR_UNEXPECTED",e[e.AD_ERROR_DEVELOPER_INVALID_ARGUMENT=53]="AD_ERROR_DEVELOPER_INVALID_ARGUMENT",e[e.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION=54]="AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION",e[e.kCFURLErrorTimedOut=55]="kCFURLErrorTimedOut",e[e.kCFURLErrorCannotFindHost=56]="kCFURLErrorCannotFindHost",e[e.kCFURLErrorCannotConnectToHost=57]="kCFURLErrorCannotConnectToHost",e[e.kCFURLErrorNetworkConnectionLost=58]="kCFURLErrorNetworkConnectionLost",e[e.kCFURLErrorNotConnectedToInternet=59]="kCFURLErrorNotConnectedToInternet",e[e.kCFURLErrorInternationalRoamingOff=60]="kCFURLErrorInternationalRoamingOff",e[e.kCFURLErrorCallIsActive=61]="kCFURLErrorCallIsActive",e[e.kCFURLErrorDataNotAllowed=62]="kCFURLErrorDataNotAllowed",e[e.kCFURLErrorSecureConnectionFailed=63]="kCFURLErrorSecureConnectionFailed",e[e.UNKNOWN_ERROR=64]="UNKNOWN_ERROR",e[e.UNKNOWN_200_ERROR=65]="UNKNOWN_200_ERROR",e[e.UNKNOWN_203_ERROR=66]="UNKNOWN_203_ERROR",e[e.UNKNOWN_STRING_ERROR=67]="UNKNOWN_STRING_ERROR",e[e.UNKNOWN_ERROR_CAUGHT_IN_PROMISE=68]="UNKNOWN_ERROR_CAUGHT_IN_PROMISE",e[e.BROKER_AUTHENTICATOR_NOT_RESPONDING=69]="BROKER_AUTHENTICATOR_NOT_RESPONDING",e[e.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION=70]="NO_NETWORK_CONNECTION_POWER_OPTIMIZATION",e[e.BROKER_AUTHENTICATOR_IO_EXCEPTION=71]="BROKER_AUTHENTICATOR_IO_EXCEPTION",e[e.IO_EXCEPTION=72]="IO_EXCEPTION",e[e.NO_ACCOUNTS_FOUND=73]="NO_ACCOUNTS_FOUND",e[e.DISALLOWED_MSA_ACCOUNT=74]="DISALLOWED_MSA_ACCOUNT",e[e.NO_M365_ACCOUNT=75]="NO_M365_ACCOUNT",e[e.NO_CREDENTIALS_FOUND=76]="NO_CREDENTIALS_FOUND",e[e.WIN32_UNKNOWN_ERROR=77]="WIN32_UNKNOWN_ERROR",e[e.WIN32_PERSONAJS_ERROR=78]="WIN32_PERSONAJS_ERROR",e[e.AUTH_RATE_LIMIT_EXCEEDED=79]="AUTH_RATE_LIMIT_EXCEEDED",e[e.INTERACTION_REQUIRED=80]="INTERACTION_REQUIRED",e[e.SERVER_DECLINED_SCOPES=81]="SERVER_DECLINED_SCOPES",e[e.USER_CANCELED=82]="USER_CANCELED",e[e.WORKPLACE_JOIN_REQUIRED=83]="WORKPLACE_JOIN_REQUIRED"})(G||(G={}));Vae=ywe(G)});function sL(e,t){var r,n=kR(OR(t??""),e||"")||"",o=(r=kR(aL(t??""),e||""))!==null&&r!==void 0?r:"",a=parseInt(o,10),d=isFinite(a)?a:void 0;return{value:n,expiration:d}}function dL(e,t,r,n){t&&(AR(OR(n??""),t,e||""),r&&AR(aL(n??""),r.toString(),e||""))}function cL(e,t){DR(OR(t??""),e||""),DR(aL(t??""),e||"")}function Yae(e){return!!(e&&(typeof e=="string"||Object.keys(y2(e)).length))}function Ap(e){return!!(kr(e)&&oL(e)&&Twe[e.code])}function zx(e){return!!(kr(e)&&oL(e)&&(Ap(e)||bwe[e.code]||Swe[e.code]))}function $ae(e,t,r){var n=void 0;if(t&&(t!=null&&t.userInfo.correlationId)?n={authRequestCorrelationId:t==null?void 0:t.userInfo.correlationId}:r&&(n={authRequestCorrelationId:r}),e&&typeof e=="object"){var o=parseInt(e.statusCode||"",10),a=parseInt(e.statusCode||"",10),d=parseInt(e.statusCode||"",10);n=m(m(m(m(m({},n),!isNaN(o)&&{statusCode:e.statusCode}||{}),!isNaN(a)&&{errorCode:e.errorCode}||{}),!isNaN(d)&&{protocolCode:e.protocolCode}||{}),e.headers&&e.headers["x-msedge-ref"]&&{traceId:Iwe(e)}||{})}else t&&typeof t=="object"&&(n=m(m({},n),{errorCode:t.code}));return n}function Iwe(e){var t,r=(t=e.headers)===null||t===void 0?void 0:t["x-msedge-ref"];return r&&r.substring(7,r.indexOf(" Ref B:"))}function jae(e,t,r){if(e)switch(e){case"100":return ae(G.AD_ERROR_DEVELOPER_INVALID_ARGUMENT);case"101":return ae(G.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION);case"203":return r==="interaction_required"&&t==="200"?ae(G.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED):ae(G.UNKNOWN_203_ERROR);case"200":return t==="200"?ae(G.AD_ERROR_SERVER_USER_INPUT_NEEDED):ae(G.UNKNOWN_200_ERROR);case"201":return ae(G.AD_ERROR_SERVER_WPJ_REQUIRED);case"202":return ae(G.AD_ERROR_SERVER_OAUTH);case"204":return ae(G.AD_ERROR_SERVER_WRONG_USER);case"205":return ae(G.AD_ERROR_SERVER_NON_HTTPS_REDIRECT);case"206":return ae(G.AD_ERROR_SERVER_INVALID_ID_TOKEN);case"207":return ae(G.AD_ERROR_SERVER_MISSING_AUTHENTICATE_HEADER);case"208":return ae(G.AD_ERROR_SERVER_AUTHENTICATE_HEADER_BAD_FORMAT);case"209":return ae(G.AD_ERROR_SERVER_UNAUTHORIZED_CODE_EXPECTED);case"210":return ae(G.AD_ERROR_SERVER_UNSUPPORTED_REQUEST);case"211":return ae(G.AD_ERROR_SERVER_AUTHORIZATION_CODE);case"212":return ae(G.AD_ERROR_SERVER_INVALID_RESPONSE);case"213":return ae(G.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED);case"300":return ae(G.AD_ERROR_CACHE_MULTIPLE_USERS);case"301":return ae(G.AD_ERROR_CACHE_VERSION_MISMATCH);case"302":return ae(G.AD_ERROR_CACHE_BAD_FORMAT);case"303":case"400":return ae(G.AD_ERROR_CACHE_NO_REFRESH_TOKEN);case"401":return ae(G.AD_ERROR_UI_NO_MAIN_VIEW_CONTROLLER);case"402":return ae(G.AD_ERROR_UI_NOT_SUPPORTED_IN_APP_EXTENSION);case"403":return ae(G.AD_ERROR_UI_USER_CANCEL);case"404":return ae(G.AD_ERROR_UI_NOT_ON_MAIN_THREAD);case"500":return ae(G.AD_ERROR_TOKENBROKER_UNKNOWN);case"501":return ae(G.AD_ERROR_TOKENBROKER_INVALID_REDIRECT_URI);case"502":return ae(G.AD_ERROR_TOKENBROKER_RESPONSE_HASH_MISMATCH);case"503":return ae(G.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED);case"504":return ae(G.AD_ERROR_TOKENBROKER_FAILED_TO_CREATE_KEY);case"505":return ae(G.AD_ERROR_TOKENBROKER_DECRYPTION_FAILED);case"507":return ae(G.AD_ERROR_TOKENBROKER_NO_RESUME_STATE);case"508":return ae(G.AD_ERROR_TOKENBROKER_BAD_RESUME_STATE);case"509":return ae(G.AD_ERROR_TOKENBROKER_MISMATCHED_RESUME_STATE);case"510":return ae(G.AD_ERROR_TOKENBROKER_HASH_MISSING);case"511":return ae(G.AD_ERROR_TOKENBROKER_NOT_SUPPORTED_IN_EXTENSION);case"PersonaJsError":case"RichApi.Error":return t==="InstanceNotFound"?ae(G.EXPECTED_ERROR):ae(G.WIN32_PERSONAJS_ERROR);case"SafePersonaJsError":return ae(G.WIN32_PERSONAJS_ERROR);case"UnknownWin32Error":return ae(G.WIN32_UNKNOWN_ERROR);case"Timeout: getting the token timed out":return ae(G.TIMEOUT_FETCHING_TOKEN);case"10001":return ae(G.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED);case"10013":return ae(G.AD_ERROR_SERVER_USER_INPUT_NEEDED);case"-1":return ae(G.AD_ERROR_UNEXPECTED);case"-1001":return ae(G.kCFURLErrorTimedOut);case"-1003":return ae(G.kCFURLErrorCannotFindHost);case"-1004":return ae(G.kCFURLErrorCannotConnectToHost);case"-1005":return ae(G.kCFURLErrorNetworkConnectionLost);case"-1009":return ae(G.kCFURLErrorNotConnectedToInternet);case"-1018":return ae(G.kCFURLErrorInternationalRoamingOff);case"-1019":return ae(G.kCFURLErrorCallIsActive);case"-1020":return ae(G.kCFURLErrorDataNotAllowed);case"-1200":return ae(G.kCFURLErrorSecureConnectionFailed);default:if(Vae(e))return ae(G[e]);var n=parseInt(e,10);return!isNaN(n)&&{family:Wx,code:1e4+n}||void 0}}function Qae(e){var t,r;return typeof e=="string"?e.indexOf("AuthTokenInternetConnectionNotAvailable")>=0?ae(G.DEVICE_CONNECTION_IS_NOT_AVAILABLE):e.indexOf("AuthTokenDisabledConditionalAccess")>=0?ae(G.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS):e==="AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED"?ae(G.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED):e==="BAD_REFRESH_TOKEN"?ae(G.BAD_REFRESH_TOKEN):e==="CONDITIONAL_ACCESS_BLOCKED"?ae(G.CONDITIONAL_ACCESS_BLOCKED):e==="NO_RESPONSE_FROM_SERVICE"?ae(G.NO_RESPONSE_FROM_SERVICE):e==="PRECONDITION_VIOLATED"?ae(G.PRECONDITION_VIOLATED):ae(G.UNKNOWN_STRING_ERROR):(r=(t=jae(e.errorCode,e.statusCode,e.protocolCode))!==null&&t!==void 0?t:jae(e.protocolCode,e.statusCode,e.errorCode))!==null&&r!==void 0?r:ae(G.UNKNOWN_ERROR)}function Xae(e){switch(e.code){case"Unknown":return ae(G.UNKNOWN_ERROR);case"BadRefreshToken":return ae(G.BAD_REFRESH_TOKEN);case"ConditionalAccessBlocked":return ae(G.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS);case"InteractionRequired":return ae(G.INTERACTION_REQUIRED);case"NoResponse":return ae(G.NO_RESPONSE_FROM_SERVICE);case"PreconditionViolated":return ae(G.PRECONDITION_VIOLATED);case"ServerDeclinedScopes":return ae(G.SERVER_DECLINED_SCOPES);case"ServerProtectionPoliciesRequired":return ae(G.POLICY_REQUIRED_ERROR);case"Timeout":return ae(G.TIMEOUT_FETCHING_TOKEN);case"UserCanceled":return ae(G.USER_CANCELED);case"WorkplaceJoinRequired":return ae(G.WORKPLACE_JOIN_REQUIRED);default:return ae(G.UNKNOWN_ERROR)}}function uL(){return new jx(Cwe,vwe)}var td,gr,xo,Wae,zae,Gae,Cwe,vwe,qae,Kae,xwe,OR,aL,Twe,bwe,Swe,zh=f(()=>{"use strict";s();k();nL();Ta();oc();nc();FR();Wae=12e4,zae=24e4,Gae=3e4,Cwe=10,vwe=3e5,qae="relatedRootCorrelationId",Kae="isForced",xwe="LokiAuthToken",OR=function(t){return"".concat(xwe).concat(t)},aL=function(t){return"EXP".concat(OR(t))};Twe=(td={},td[G.AD_ERROR_SERVER_PROTECTION_POLICY_REQUIRED]=1,td[G.AD_ERROR_SERVER_REFRESH_TOKEN_REJECTED]=1,td[G.AD_ERROR_SERVER_USER_INPUT_NEEDED]=1,td[G.AUTH_REFRESH_FAILED_PROMPT_NOT_ALLOWED]=1,td[G.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS]=1,td[G.CONDITIONAL_ACCESS_BLOCKED]=1,td[G.BAD_REFRESH_TOKEN]=1,td[G.POLICY_REQUIRED_ERROR]=1,td[G.PRECONDITION_VIOLATED]=1,td),bwe=(gr={},gr[G.AD_ERROR_SERVER_INVALID_RESPONSE]=1,gr[G.AD_ERROR_TOKENBROKER_NOT_A_BROKER_RESPONSE]=1,gr[G.BROKER_AUTHENTICATOR_ERROR_GETAUTHTOKEN]=1,gr[G.BROKER_AUTHENTICATOR_IO_EXCEPTION]=1,gr[G.BROKER_AUTHENTICATOR_NOT_RESPONDING]=1,gr[G.DEVICE_CONNECTION_IS_NOT_AVAILABLE]=1,gr[G.GENERIC_TOKEN_ERROR]=1,gr[G.INTERACTION_REQUIRED]=1,gr[G.IO_EXCEPTION]=1,gr[G.kCFURLErrorCallIsActive]=1,gr[G.kCFURLErrorCannotConnectToHost]=1,gr[G.kCFURLErrorCannotFindHost]=1,gr[G.kCFURLErrorDataNotAllowed]=1,gr[G.kCFURLErrorInternationalRoamingOff]=1,gr[G.kCFURLErrorNetworkConnectionLost]=1,gr[G.kCFURLErrorNotConnectedToInternet]=1,gr[G.kCFURLErrorSecureConnectionFailed]=1,gr[G.kCFURLErrorTimedOut]=1,gr[G.NO_NETWORK_AVAILABLE]=1,gr[G.NO_NETWORK_CONNECTION_POWER_OPTIMIZATION]=1,gr[G.NO_RESPONSE_FROM_SERVICE]=1,gr[G.SERVER_DECLINED_SCOPES]=1,gr[G.TIMEOUT_ERROR]=1,gr[G.TIMEOUT_FETCHING_TOKEN]=1,gr[G.USER_CANCELED]=1,gr[G.WORKPLACE_JOIN_REQUIRED]=1,gr),Swe=(xo={},xo[G.AD_ERROR_CACHE_NO_REFRESH_TOKEN]=1,xo[G.AD_ERROR_SERVER_AUTHORIZATION_CODE]=1,xo[G.AD_ERROR_SERVER_OAUTH]=1,xo[G.AD_ERROR_SERVER_WPJ_REQUIRED]=1,xo[G.AD_ERROR_SERVER_WRONG_USER]=1,xo[G.AD_ERROR_TOKENBROKER_RESPONSE_NOT_RECEIVED]=1,xo[G.AD_ERROR_TOKENBROKER_UNKNOWN]=1,xo[G.AD_ERROR_UI_USER_CANCEL]=1,xo[G.AD_ERROR_UNEXPECTED]=1,xo[G.EXPECTED_ERROR]=1,xo[G.EXPECTED_TOKEN_INVALIDATED_ERROR]=1,xo[G.GET_AUTH_TOKEN_TIMEOUT]=1,xo[G.AD_ERROR_CACHE_VERSION_MISMATCH]=1,xo[G.AD_ERROR_CACHE_BAD_FORMAT]=1,xo[G.AD_ERROR_DEVELOPER_INVALID_ARGUMENT]=1,xo[G.AD_ERROR_DEVELOPER_AUTHORITY_VALIDATION]=1,xo)});var Jae,Zae=f(()=>{"use strict";s();Jae=function(t){return!1}});var ls,ese,tse=f(()=>{"use strict";s();ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ese={encode:function(t){var r=[],n,o,a="",d,c,u,l="",p=0;do n=t.charCodeAt(p++),o=t.charCodeAt(p++),a=t.charCodeAt(p++),d=n>>2,c=(n&3)<<4|o>>4,u=(o&15)<<2|a>>6,l=a&63,isNaN(o)?u=l=64:isNaN(a)&&(l=64),r.push(ls.charAt(d)+ls.charAt(c)+ls.charAt(u)+ls.charAt(l)),n=o=a="",d=c=u=l="";while(p<t.length);return r.join("")},encodeFromByteArray:function(t){var r=[],n,o,a="",d,c,u,l="",p=0;do n=t[p++],o=t[p++],a=t[p++],d=n>>2,c=(n&3)<<4|o>>4,u=(o&15)<<2|a>>6,l=a&63,isNaN(o)?u=l=64:isNaN(a)&&(l=64),r.push(ls.charAt(d)+ls.charAt(c)+ls.charAt(u)+ls.charAt(l)),n=o=a="",d=c=u=l="";while(p<t.length);return r.join("")},decode:function(t){var r="",n,o,a="",d,c,u,l="",p=0,g=/[^A-Za-z0-9\+\/\=]/g;if(g.exec(t))throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.");t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=ls.indexOf(t.charAt(p++)),c=ls.indexOf(t.charAt(p++)),u=ls.indexOf(t.charAt(p++)),l=ls.indexOf(t.charAt(p++)),n=d<<2|c>>4,o=(c&15)<<4|u>>2,a=(u&3)<<6|l,r=r+String.fromCharCode(n),u!=64&&(r=r+String.fromCharCode(o)),l!=64&&(r=r+String.fromCharCode(a)),n=o=a="",d=c=u=l="";while(p<t.length);return r}}});function lL(e){var t=e.length%4;return ese.decode(t===3?e+"=":t===2?e+"==":e)}var rse=f(()=>{"use strict";s();tse()});var nse=f(()=>{"use strict";s();rse()});function ose(e){if(e)try{var t=e.split("."),r=t[1],n=lL(r),o=JSON.parse(n).exp;return o?o*1e3:void 0}catch(a){return}}var ise=f(()=>{"use strict";s();nse()});var Ewe,Gx,fL=f(()=>{"use strict";s();zh();Zae();ise();Ewe=Number.MAX_SAFE_INTEGER-1,Gx=function(){function e(t,r,n,o,a){this.value=t,this.featureName=r,this.logger=n;var d=function(){var l;return(l=ose(t))!==null&&l!==void 0?l:Ewe},c=a?this.getExperimentalDefaultExpiryTimeEpoch():d();this.expirationTimeEpoch=o??c}return e.prototype.getExperimentalDefaultExpiryTimeEpoch=function(){return Date.now()+36e5},e.prototype.isApproachingExpiration=function(){return this.isValid()?Date.now()>this.expirationTimeEpoch-zae:!1},e.prototype.isValid=function(){return this.value?Jae(this.expirationTimeEpoch)?(this.logger&&this.logger.logError({eventId:"InvalidTokenExpirationValue",featureName:this.featureName,properties:{expiryTime:this.expirationTimeEpoch}}),!1):!(Date.now()>this.expirationTimeEpoch-Wae):!1},e.prototype.getValue=function(){return this.value},e.prototype.getExpirationTimeEpoch=function(){return this.expirationTimeEpoch},e}()});var ase,sse,dse=f(()=>{"use strict";s();k();ase=function(t){return clearTimeout(t)},sse=function(t,r){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return setTimeout.apply(void 0,w([t,r],n,!1))}});function cse(e){return e==="Df"?"Df":e==="Msit"?"Msit":e==="Prod"?"Prod":e==="Blackforest"?"Blackforest":e==="GccModerate"?"GccModerate":e==="GccHigh"?"GccHigh":e==="DoD"?"DoD":e==="Gallatin"?"Gallatin":e==="AG08"?"AG08":e==="AG09"?"AG09":"Unknown"}var use,lse,fse,pL=f(()=>{"use strict";s();use="LokiGetAuthToken",lse="LokiGetAuthTokenFailed",fse="LokiAuthTokenReceivedAfterTimeout"});var mL,pse=f(()=>{"use strict";s();k();Ta();oc();dse();nc();pL();fL();zh();FR();mL=function(){function e(t){this.authTokenProviderState="Initial";var r=t.getAppId,n=t.refreshAuthToken,o=t.logger,a=t.runWithLogMonitor,d=t.authTokenType,c=t.featureName,u=t.storageKeySuffix,l=t.rateLimiter,p=l===void 0?uL():l,g=t.logUnknownErrorsForDogfoodUserOnlyFlightEnabled,h=t.dontStoreTokenInSessionStorage,v=t.isUseForceRefreshLokiTokenEnabled,y=t.retryConditionalAccessThresholdSeconds,T=t.onError;o&&iL(o.registerErrors),this.getAppId=r,this.refreshAuthToken=n,this.logger=o,this.runWithLogMonitor=a,this.authTokenType=d||Gx,this.featureName=c||"RESTAuthToken",this.storageKeySuffix=u,this.rateLimiter=p,this.logUnknownErrorsForDogfoodUserOnlyFlightEnabled=g,this.dontStoreTokenInSessionStorage=h,this.isUseForceRefreshLokiTokenEnabled=v,this.retryConditionalAccessThresholdSeconds=y,this.onError=T;var b=sL(this.getAppId(),this.storageKeySuffix);b!=null&&b.value&&(b!=null&&b.expiration)&&(this.authToken=new this.authTokenType(b.value,this.featureName,this.logger,b.expiration,this.isUseForceRefreshLokiTokenEnabled)),this.getAuthToken(void 0).catch(function(I){})}return e.prototype.getAuthToken=function(t){return Wt(this,void 0,void 0,function(){var r,n,o;return pt(this,function(a){switch(a.label){case 0:return this.isUseForceRefreshLokiTokenEnabled?this.authToken&&this.authToken.isValid()?this.authToken.isApproachingExpiration()?[4,this.forceRefreshAuthToken(t)]:[3,2]:[3,3]:[3,4];case 1:a.sent(),a.label=2;case 2:return[2,{token:this.authToken,request:{fromCache:!0,duration:0}}];case 3:return[3,5];case 4:if(r=this.checkAndGetAuthTokenIfValid(),r)return[2,{token:r,request:{fromCache:!0,duration:0}}];a.label=5;case 5:if(this.authTokenProviderState==="DisabledConditionalAccess"&&(n=!1,this.timestampOfLastConditionalAccessError&&this.retryConditionalAccessThresholdSeconds&&this.retryConditionalAccessThresholdSeconds>0&&(o=(Date.now()-this.timestampOfLastConditionalAccessError)/1e3,o>=this.retryConditionalAccessThresholdSeconds&&(this.invalidateAuthToken(),n=!0)),!n))throw{midgardError:ae(G.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return[4,this.getAuthTokenPromise({relatedRootCorrelationId:t,isForced:!1})];case 6:return[2,a.sent()]}})})},e.prototype.invalidateAuthToken=function(){this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=void 0,this.timestampOfLastConditionalAccessError=void 0,cL(this.getAppId(),this.storageKeySuffix)},e.prototype.hasAuthToken=function(){return!!this.authToken},e.prototype.isTokenInvalidated=function(t){return t!==this.authPromise},e.prototype.forceRefreshAuthToken=function(t){return Wt(this,void 0,void 0,function(){var r,n;return pt(this,function(o){switch(o.label){case 0:if(this.authTokenProviderState==="DisabledConditionalAccess")throw{midgardError:ae(G.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};o.label=1;case 1:return o.trys.push([1,4,,5]),this.authTokenProviderState==="RequestPending"?[3,3]:(r=this.authToken&&ed(this.authToken,{}),this.authToken=void 0,[4,this.getAuthTokenPromise({relatedRootCorrelationId:t,isForced:!0,existingToken:r})]);case 2:o.sent(),o.label=3;case 3:return[3,5];case 4:return n=o.sent(),[3,5];case 5:return[2]}})})},e.prototype.updateAuthTokenTtl=function(t){this.authToken&&(this.authToken=new this.authTokenType(this.authToken.getValue(),this.featureName,this.logger,Date.now()+t*1e3,this.isUseForceRefreshLokiTokenEnabled),this.updateTokenCacheWithCurrentToken())},e.prototype.checkAndGetAuthTokenIfValid=function(){var t=this.authToken;if(t&&t.isValid())return t.isApproachingExpiration()&&this.getAuthTokenPromise({relatedRootCorrelationId:void 0,isForced:!1}).catch(function(){}),t},e.prototype.requestNewAuthToken=function(t){var r=this;return new Promise(function(n,o){var a=void 0,d=sse(function(){a=Date.now(),o({midgardError:ae(G.GET_AUTH_TOKEN_TIMEOUT)})},Gae);r.refreshAuthToken(function(c,u,l,p,g,h){var v,y,T,b,I=$ae(u,h,l);u?(v=r.onError)===null||v===void 0||v.call(r,u):h&&((y=r.onError)===null||y===void 0||y.call(r,h));var E=h?Xae(h):u&&Yae(u)?Qae(u):void 0;if(a){(T=r.logger)===null||T===void 0||T.logTrace({eventId:fse,featureName:r.featureName,properties:m({hasToken:!!(c||g!=null&&g.accessToken),msAfterTimeout:Date.now()-a,midgardError:E},E?{error:JSON.stringify(m({midgardError:E,authTokenDisabled:r.authTokenProviderState==="DisabledConditionalAccess"},I))}:{})});return}if(ase(d),E)Ap(E)?o({midgardError:E,extraLogProps:m(m({},I),{authTokenDisabledForThisSession:"true"})}):o({midgardError:E,extraLogProps:I});else if(!c&&!(g!=null&&g.accessToken))o({midgardError:ae(G.EXPECTED_ERROR),extraLogProps:I});else{var P=(g==null?void 0:g.expirationTime)&&(g==null?void 0:g.expirationTime)>0&&g.expirationTime*1e3||void 0,_=p&&Date.now()+p*1e3||P;_===void 0&&t&&((b=t.getValue)===null||b===void 0?void 0:b.call(t))===c&&(_=t.getExpirationTimeEpoch());var D=new r.authTokenType(g?g.accessToken:c,r.featureName,r.logger,_,r.isUseForceRefreshLokiTokenEnabled);n(D)}})})},e.prototype.getAuthTokenPromise=function(t){return Wt(this,void 0,void 0,function(){var r,n,o,a,d,c,u,l=this;return pt(this,function(p){switch(p.label){case 0:if(r=t.existingToken,n=t.isForced,o=t.relatedRootCorrelationId,this.authTokenProviderState==="DisabledConditionalAccess")throw{midgardError:ae(G.AUTH_TOKEN_DISABLED_CONDITIONAL_ACCESS)};return a=new Date().valueOf(),(!this.authPromise||this.authTokenProviderState!=="RequestPending")&&(this.authTokenProviderState="RequestPending",d=new Promise(function(g,h){var v=function(){var T;if(l.runWithLogMonitor){var b=void 0;o&&(b=(T={},T[qae]=o,T[Kae]=n.toString(),T)),l.runWithLogMonitor({scenarioName:use,featureName:l.featureName,operation:function(){return l.requestNewAuthToken(r)},extraLogPropsOnFinish:{success:function(){return{}},failure:function(E){var P=E.extraLogProps;return P||{}}},successAction:function(E){l.isTokenInvalidated(d)&&h({midgardError:ae(G.EXPECTED_TOKEN_INVALIDATED_ERROR)}),E?g({token:E,request:{fromCache:!1,duration:0}}):h({midgardError:ae(G.INVALID_AUTH_TOKEN)})},errorAction:function(E){return h(E)},treatAsExpectedError:function(E){var P=E.midgardError;return zx(P)||!!navigator&&navigator.onLine===!1},extraProps:b})}else l.requestNewAuthToken(r).then(function(I){l.isTokenInvalidated(d)&&h({midgardError:ae(G.EXPECTED_TOKEN_INVALIDATED_ERROR)}),g({token:I,request:{fromCache:!1,duration:0}})}).catch(function(I){return h(I)})};try{l.rateLimiter.execute(v)}catch(y){y instanceof Error&&y.message===Vx?h({midgardError:ae(G.AUTH_RATE_LIMIT_EXCEEDED)}):h(y)}}).then(function(g){return l.onRefreshAuthTokenSuccess(g),g}).catch(function(g){if(l.logUnknownErrorsForDogfoodUserOnlyFlightEnabled&&typeof g=="object"&&g){var h=void 0,v=JSON.stringify(g,function(y,T){if(T instanceof Error){var b={};return Object.getOwnPropertyNames(T).forEach(function(I){b[I]=T[I]}),b}return T}).substring(0,50);eu(g,"extraLogProps")?h=m(m({},g.extraLogProps),{unknownErrorForDogfoodUserOnly:v}):h={unknownErrorForDogfoodUserOnly:v},g.extraLogProps=h}throw l.onRefreshAuthTokenError(typeof g=="object"&&g&&eu(g,"midgardError")&&kr(g.midgardError)?g.midgardError:ae(G.UNKNOWN_ERROR_CAUGHT_IN_PROMISE),typeof g=="object"&&g&&eu(g,"extraLogProps")?g.extraLogProps:void 0),g}),this.authPromise=d),[4,this.authPromise];case 1:return c=p.sent(),u=Date.now(),[2,ed(c,{request:ed(c.request,{duration:u-a})})]}})})},e.prototype.updateTokenCacheWithCurrentToken=function(){this.authToken&&!this.dontStoreTokenInSessionStorage&&dL(this.getAppId(),this.authToken.getValue()||"",this.authToken.getExpirationTimeEpoch(),this.storageKeySuffix)},e.prototype.onRefreshAuthTokenSuccess=function(t){this.authTokenProviderState="Initial",this.authPromise=void 0,this.authToken=t.token,this.updateTokenCacheWithCurrentToken()},e.prototype.onRefreshAuthTokenError=function(t,r){var n;this.authTokenProviderState=Ap(t)?"DisabledConditionalAccess":"Initial",this.authPromise=void 0,this.retryConditionalAccessThresholdSeconds&&this.retryConditionalAccessThresholdSeconds>0&&(this.timestampOfLastConditionalAccessError=Date.now());var o=JSON.stringify(m({midgardError:t,authTokenDisabled:this.authTokenProviderState==="DisabledConditionalAccess"},r)).replace(/\\n/g,"(LF)").replace(/\\r/g,"(CR)");(n=this.logger)===null||n===void 0||n.logError({eventId:lse,featureName:this.featureName,properties:{midgardError:t,error:o}})},e}()});var gL=f(()=>{"use strict";s();mae();W2();fL();pse();zh();FR()});var mse=f(()=>{"use strict";s();gL()});var hL,gse=f(()=>{"use strict";s();hL=!0});var hse=f(()=>{"use strict";s()});function NR(e){return{family:Pwe,code:e}}var Gh,Pwe,yse=f(()=>{"use strict";s();(function(e){e[e.TIMEOUT=0]="TIMEOUT",e[e.CANCELLED=1]="CANCELLED",e[e.FAILED=2]="FAILED"})(Gh||(Gh={}));Pwe="xml-http-request-executor"});function Cse(e,t){if(!(!e||!t||t===0))return Math.ceil(t-e)}var vse=f(()=>{"use strict";s()});function xse(){try{if(typeof CustomEvent=="function")return new CustomEvent("Event").timeStamp;if(typeof document<"u")return document.createEvent("Event").timeStamp}catch(e){}}var Tse=f(()=>{"use strict";s()});function bse(e,t){return{message:e.status?"":"UndefinedOrAbortedRequestStatus_".concat(t),statusCode:e.status,responseText:e.responseType!=="blob"?e.responseText:void 0,isExpected:!1,shouldRetryAsXhrRequest:!1,headers:Sse(e.getAllResponseHeaders()),midgardError:NR(Gh.FAILED)}}function Sse(e){if(e){var t={},r=e.split("\r\n");return r.forEach(function(n){var o=n.indexOf(": ");t[n.substr(0,o).toLowerCase()]=n.substr(o+2)}),t}else return{}}var _we,Rwe,yL,Ise=f(()=>{"use strict";s();yse();vse();Tse();_we=/\?/,Rwe="ConvertGetPost";yL=function(){function e(t,r,n,o,a,d,c){if(c===void 0&&(c="text"),this.url=t,this.verb=r,this.timeout=n,this.body=a,this.withCredentials=d,this.responseType=c,this.isConvertGetPostRequest=!1,this.headers={},o&&this.verb==="GET"){this.isConvertGetPostRequest=!0,this.verb="POST";var u=_we.test(this.url);this.url="".concat(this.url).concat(u?"&":"?").concat(Rwe,"=true")}}return e.prototype.setHeader=function(t,r){this.headers[t]=r},e.prototype.setTimeout=function(t){this.timeout=t},e.prototype.go=function(t){var r=this;t===void 0&&(t="REST");var n;return new Promise(function(o,a){var d=new XMLHttpRequest;if(d.open(r.verb,r.url),d.timeout=r.timeout,d.withCredentials=r.withCredentials||!1,r.responseType&&(d.responseType=r.responseType),r.isConvertGetPostRequest)r.body=JSON.stringify(r.headers);else for(var c in r.headers)r.headers.hasOwnProperty(c)&&d.setRequestHeader(c,r.headers[c]);d.onload=function(u){if(d.status>=200&&d.status<300){var l=Cse(n,u.timeStamp);o(r.getResponseObjectFromRequest(d,l))}else a(bse(d,t))},d.onerror=function(){a(bse(d,t))},d.ontimeout=function(){a({statusCode:d.status,message:"RequestTimeout",isExpected:!0,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:NR(Gh.TIMEOUT)})},d.onabort=function(){a({statusCode:d.status,message:"Cancelled",isExpected:!1,shouldRetryAsXhrRequest:!1,headers:void 0,midgardError:NR(Gh.CANCELLED)})},n=xse(),d.send(r.body)})},e.prototype.getResponseObjectFromRequest=function(t,r){var n=t.responseType==="blob"?t.response:t.responseText;return{Body:n,StatusCode:t.status,Headers:Sse(t.getAllResponseHeaders()),ResponseUrl:t.responseURL,RequestDurationFromEvents:r}},e}()});var Ese=f(()=>{"use strict";s();hse();Ise()});function Pse(e){var t={isLinkedInEnabledInHostApp:e.hostAppConfiguration.options.isLinkedInEnabledInHostApp,isLokiContactDataDisabled:e.hostAppConfiguration.options.isLokiContactDataDisabled};return t}function _se(e,t){var r=Object.keys(t);if(r.length<=0)return e;var n=r.filter(function(o){return t[o]!==void 0&&t[o]!==null}).map(function(o){if(Array.isArray(t[o])){var a=t[o];return a.map(function(d){return"".concat(o,"=").concat(d)}).join("&")}return"".concat(o,"=").concat(encodeURIComponent(t[o]))}).join("&");return"".concat(e,"?").concat(n)}function MR(e){return e===null?null:e===void 0?void 0:typeof e=="number"||typeof e=="string"||typeof e=="boolean"?e:Array.isArray(e)?e.map(MR):Object.keys(e).reduce(function(t,r){var n="".concat(r[0].toUpperCase()).concat(r.slice(1));return typeof e[r]=="object"?t[n]=MR(e[r]):t[n]=e[r],t},{})}function Rse(e){return e.statusCode===403&&CL(e)}function CL(e){var t=["get_configuration","get_livepersonacardconfiguration","get_livepersonapickerconfiguration","get_officefeedconfiguration","get_searchconfiguration","get_groupsmanagementconfiguration"];return!!(e&&e.qosTagId&&t.indexOf(e.qosTagId)>-1)}var qx,Ase,vL=f(()=>{"use strict";s();k();qx=function(t){return t},Ase=function(t){return m(m({},t),{retryAttemptedAfterAuthFailure:!0})}});function kp(e){return{family:kse,code:e}}function Dse(e){e(kse,fs)}var kse,fs,wse=f(()=>{"use strict";s();kse="loki-rest-utils";(function(e){e[e.UNKNOWN_ERROR=0]="UNKNOWN_ERROR",e[e.INVALID_RESPONSE=1]="INVALID_RESPONSE",e[e.REQUEST_FAILED=2]="REQUEST_FAILED",e[e.CONFIG_FAILED=3]="CONFIG_FAILED",e[e.AUTH_TOKEN_FAILED=4]="AUTH_TOKEN_FAILED",e[e.GCC_USER=5]="GCC_USER",e[e.REQUEST_FACTORY_UNDEFINED=6]="REQUEST_FACTORY_UNDEFINED",e[e.MISSING_REQUIRED_PARAMETER=7]="MISSING_REQUIRED_PARAMETER",e[e.FEATURE_DISABLED=8]="FEATURE_DISABLED"})(fs||(fs={}))});var Awe,LR,xL=f(()=>{"use strict";s();k();zh();gse();nc();Ese();vL();wse();Awe=4e4,LR=function(){function e(t,r){this.config=t,this.getDomain=r,this.isFeatureDisabledError=function(n){var o;if(!n||typeof n!="object"||!("responseText"in n)||typeof n.responseText!="string")return!1;try{var a=JSON.parse(n.responseText);if(((o=a==null?void 0:a.Error)===null||o===void 0?void 0:o.Code)==="FeatureDisabled")return!0}catch(d){return!1}return!1},this.initialize(),Dse(this.config.logger.registerErrors)}return e.prototype.initialize=function(){return Wt(this,void 0,void 0,function(){return pt(this,function(t){return[2]})})},e.prototype.request=function(t,r,n,o,a,d,c,u,l){return l===void 0&&(l={convertPropertiesToPascalCase:!0,defaultResponseObject:!0}),Wt(this,void 0,void 0,function(){var p,g,h,v,y,T,b,I,E,P,_=this;return pt(this,function(D){switch(D.label){case 0:return this.config.settings.isOfflineMode?[2,Promise.reject({message:"OFFLINE_MODE",isExpected:!0})]:[4,this.getDomainOrLogErrorAndThrow(t)];case 1:p=D.sent(),g=c.requestId,h=c.timeoutOverride,v=c.clientScenario,y=c.hostAppApp,T=function(){return Wt(_,void 0,void 0,function(){var H,U,F,z,Y;return pt(this,function(B){switch(B.label){case 0:return[4,this.doRequest({method:r,domain:p.domain,path:n,body:o,headers:a,queryParameters:d,requestId:g,timeoutOverride:h,clientScenario:v,hostAppApp:y,domainRequiredRequest:p.domainRequiredRequest})];case 1:return H=B.sent(),U=H.Headers?Number(H.Headers["x-tokenttl"]):NaN,!isNaN(U)&&this.config.updateAuthTokenTtl(U),F=H.Body===""||H.Body.toLowerCase()==="null",H.Body=F&&l.defaultResponseObject?"{}":H.Body,z=l.convertPropertiesToPascalCase?MR:function(q){return q},Y=u(!F||l.defaultResponseObject?z(JSON.parse(H.Body)):H.Body),[2,m({parsedResponse:Y},H)]}})})},D.label=2;case 2:return D.trys.push([2,4,,11]),[4,T()];case 3:return[2,D.sent()];case 4:if(b=D.sent(),I=b,!(I&&I.statusCode===401))return[3,9];this.config.forceRefreshAuthToken(c.requestId),D.label=5;case 5:return D.trys.push([5,7,,8]),[4,T()];case 6:return[2,D.sent()];case 7:throw E=D.sent(),P=E,Ase({qosTagId:t,statusCode:P==null?void 0:P.statusCode,isExpected:(P==null?void 0:P.isExpected)||!1,headers:P==null?void 0:P.headers,midgardError:P&&kr(P.midgardError)?P.midgardError:kp(fs.REQUEST_FAILED)});case 8:return[3,10];case 9:throw I&&I.statusCode===403&&this.isFeatureDisabledError(I)?qx({qosTagId:t,statusCode:I==null?void 0:I.statusCode,isExpected:(I==null?void 0:I.isExpected)||!1,headers:I==null?void 0:I.headers,midgardError:kp(fs.FEATURE_DISABLED)}):qx({qosTagId:t,statusCode:I==null?void 0:I.statusCode,isExpected:(I==null?void 0:I.isExpected)||!1,headers:I==null?void 0:I.headers,midgardError:I&&kr(I.midgardError)?I.midgardError:kp(fs.REQUEST_FAILED)});case 10:return[3,11];case 11:return[2]}})})},e.prototype.configuration=function(){return this.config},e.prototype.getDomainOrLogErrorAndThrow=function(t){return Wt(this,void 0,void 0,function(){var r,n,o,a,d,c;return pt(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,this.getDomain()];case 1:return[2,u.sent()];case 2:throw r=u.sent(),n=r,o=n&&Rse(n),a=CL(n),d=a?fs.CONFIG_FAILED:o?fs.GCC_USER:fs.UNKNOWN_ERROR,c=void 0,a?c=kp(d):n&&kr(n.midgardError)?c=n.midgardError:c=kp(d),d===fs.UNKNOWN_ERROR&&this.config.logger.logError({eventId:"GetDomainFailure",featureName:"LokiRestProvider"}),qx({qosTagId:t,statusCode:n==null?void 0:n.statusCode,isExpected:a,headers:void 0,midgardError:c});case 3:return[2]}})})},e.prototype.doRequest=function(t){var r=t.method,n=t.domain,o=t.path,a=t.body,d=t.headers,c=t.queryParameters,u=t.requestId,l=t.timeoutOverride,p=t.clientScenario,g=t.hostAppApp,h=t.domainRequiredRequest;return Wt(this,void 0,void 0,function(){var v,y,T,b,I,E,P,_,D,M,H;return pt(this,function(U){switch(U.label){case 0:return[4,this.initialize()];case 1:return U.sent(),[4,this.getAuthTokenWithRequestInformation(u)];case 2:return v=U.sent(),y=hL||this.config.settings.isGetPostConversionDisabled,T=m(m(m({},y?{"X-RootCorrelationId":u,"X-CorrelationId":u,"X-ClientCorrelationId":this.config.hostAppConfiguration.consumerCorrelationId}:{}),{"X-ClientType":this.config.hostAppConfiguration.source,"X-ClientFeature":this.config.clientFeature,"X-ClientArchitectureVersion":this.config.clientArchitectureVersion,"X-ClientScenario":p,"X-HostAppApp":g,"X-HostAppPlatform":this.config.hostAppConfiguration.platform,"X-LPCVersion":this.config.BUILD_VERSION,authorization:"Bearer ".concat(v.token.getValue()),"X-HostAppRing":this.config.hostAppConfiguration.options.hostAppRing,"X-HostAppVersion":this.config.hostAppConfiguration.options.hostAppVersion,"X-MailboxContextAadObjectId":this.config.settings.isSharedMailboxEnabled?this.config.hostAppConfiguration.options.sharedMailboxAadObjectId:void 0,"X-HostAppCapabilities":JSON.stringify(Pse(this.config))}),this.config.msSearchComponent&&p==="getSearchConfiguration"&&{"X-MSSearchComponent":this.config.msSearchComponent}),b=m({},y?{}:{RootCorrelationId:u,CorrelationId:u,ClientCorrelationId:this.config.hostAppConfiguration.consumerCorrelationId}),I=n.substring(n.length-1)==="/"&&o.substring(0,1)==="/"?"".concat(n).concat(o.substring(1)):"".concat(n).concat(o),E=_se(I,m(m({},c),b)),P=!hL&&!this.config.settings.isGetPostConversionDisabled,_=l||Awe,D=a instanceof Blob,M=this.getRequestExecutor(E,r,a&&!D?JSON.stringify(a):a,_,P,D),Object.keys(d).forEach(function(F){var z=d[F];z!==void 0&&M.setHeader(F,z)}),Object.keys(T).forEach(function(F){var z=T[F];z!==void 0&&M.setHeader(F,z)}),H=[{additionalRequestInformation:{didMakeAuthTokenRequest:!v.request.fromCache,durationWaitingOnAuthToken:v.request.duration,didMakeConfigRequest:!!h}}],[4,M.go()];case 3:return[2,m.apply(void 0,H.concat([U.sent()]))]}})})},e.prototype.getAuthTokenWithRequestInformation=function(t){return Wt(this,void 0,void 0,function(){var r,n;return pt(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.config.getAuthToken(t)];case 1:return[2,o.sent()];case 2:throw r=o.sent(),n=r,qx({qosTagId:"getAuthTokenPromise",statusCode:void 0,isExpected:n&&kr(n.midgardError)?zx(n.midgardError):!1,headers:void 0,midgardError:n&&kr(n.midgardError)?n.midgardError:kp(fs.AUTH_TOKEN_FAILED)});case 3:return[2]}})})},e.prototype.getRequestExecutor=function(t,r,n,o,a,d){return new yL(t,r,o,a,n)},e}()});function Fse(e,t,r,n,o){var a;return IR({monitorStarter:e.providerConfig.logger,scenarioName:r,featureName:"RestActionCreators",requestId:t,operation:n,extraProps:o?(a={},a[Qi.clientScenario]=o,a):void 0,treatAsExpectedError:function(c){return c&&kr(c.midgardError)?Ap(c.midgardError):!1}})}function Ose(e,t){return Wt(this,void 0,void 0,function(){var r,n,o=this;return pt(this,function(a){return r="".concat(wwe).concat(e.providerConfig.clientFeature).concat(e.providerConfig.hostAppConfiguration.source),n={logEvent:function(c){return e.providerConfig.logger.logEvent({featureName:"TTLCacheUtils",eventId:c.eventId})},logError:function(c){return e.providerConfig.logger.logError({featureName:"TTLCacheUtils",eventId:c.eventId})}},[2,rL({id:e.id,logger:n,cacheKey:r,version:e.version,ttlMs:Mwe(e.bypassCache,e.bypassTTL),fallbackCallback:e.bypassFallback?function(){return Promise.reject("fallback failing because bypassFallback is true")}:function(){var d=new LR(e.providerConfig,function(){return Wt(o,void 0,void 0,function(){var u,l;return pt(this,function(p){switch(p.label){case 0:return l={},u=e.lokiUrlOverride,u?[3,2]:[4,e.getLokiDomain()];case 1:u=p.sent(),p.label=2;case 2:return[2,(l.domain=u,l.domainRequiredRequest=!1,l)]}})})}),c=Oo();return t(e,c,d)},ttrMs:e.bypassCache?void 0:Dwe,rateLimiter:Nwe})]})})}function Mwe(e,t){if(e&&t)throw new Error("bypassCache and bypassTTL must not both be true at the same time");return e?0:t?Number.MAX_VALUE:kwe}var kwe,Dwe,wwe,Fwe,Owe,Nwe,Nse=f(()=>{"use strict";s();k();zh();nL();oc();nc();Uh();xL();U2();kwe=6048e5,Dwe=9e7,wwe="LokiConfig_",Fwe=20,Owe=1e4,Nwe=new jx(Fwe,Owe)});var Mse=f(()=>{"use strict";s()});var TL=f(()=>{"use strict";s();mse();Nse();xL();Mse();vL()});function Lwe(e){return e.UserAadObjectId!==void 0&&e.UserAadObjectId!==null&&e.UserAadObjectId,e.TenantAadObjectId!==void 0&&e.TenantAadObjectId!==null&&e.TenantAadObjectId,e.ClientTelemetryCollectorUrls!==void 0&&e.ClientTelemetryCollectorUrls!==null&&e.ClientTelemetryCollectorUrls,e}function Hwe(e){return e}function Bwe(e){return e.Value!==void 0&&e.Value!==null&&e.Value.forEach(Hwe),e}function Uwe(e,t,r){return bL.apply(this,arguments)}function bL(){return bL=(0,IL.default)(function*(e,t,r){var n="/api/v1/personasuggestions",o,a={},d={};return d.Accept="text/plain, application/json, text/json",r.scenarioName!==void 0&&(a.scenarioName=r.scenarioName),r.query!==void 0&&(a.query=r.query),r.top!==void 0&&(a.top=r.top),r.searchDirectory!==void 0&&(a.searchDirectory=r.searchDirectory),r.informationBarrierSegments!==void 0&&(a.informationBarrierSegments=r.informationBarrierSegments),e.request("get_personasuggestions","GET",n,o,d,a,t,Bwe)}),bL.apply(this,arguments)}function Vwe(e,t,r){return SL.apply(this,arguments)}function SL(){return SL=(0,IL.default)(function*(e,t,r){var n="/api/v1/livepersonapicker/configuration",o,a={},d={};return d.Accept="text/plain, application/json, text/json",e.request("get_livepersonapickerconfiguration","GET",n,o,d,a,t,Lwe)}),SL.apply(this,arguments)}var IL,Lse,HR,EL=f(()=>{"use strict";s();IL=S(j2());Lse=Uwe;HR=Vwe});function Bse(e){return PL.apply(this,arguments)}function PL(){return PL=(0,Hse.default)(function*(e){return Ose(e,Wwe)}),PL.apply(this,arguments)}var Hse,jwe,Wwe,Use=f(()=>{"use strict";s();Hse=S(j2());TL();EL();jwe="getLPPConfiguration",Wwe=function(t,r,n){return Fse(t,r,"GetLivePersonaPickerConfiguration",function(){return HR(n,{requestId:r,clientScenario:jwe},{})})}});var _L=f(()=>{"use strict";s();EL();Use()});var zwe,Vse,Gwe,RL,Kx,BR=f(()=>{"use strict";s();TR();lae();_L();zwe=V2("PickerConfiguration",HR),Vse=Vh("ConfigurationStore",zwe),Gwe={success:function(t){return{responseLength:t.Value?t.Value.length.toString():"0"}},fromParameters:function(t){return{queryLength:t.query?t.query.length.toString():"0",didSearchDirectory:t.searchDirectory}}},RL=V2("PickerSuggestions",Lse,{logPropertyExtractors:Gwe}),Kx=Vh("SuggestionsStore",RL)});var qwe,jse,Wse,zse,AL=f(()=>{"use strict";s();qwe=/<([^>]*)>/,jse=function(t){var r=t.indexOf("@");return r>0&&r<t.length-1},Wse=function(t){return t.startsWith("@")?t.slice(1):t},zse=function(t){var r=t.split(";"),n=r.map(function(o){var a=qwe.exec(o);return a&&a.length>1&&a[1]&&(o=a[1]),o.trim()}).filter(function(o){return o});return n}});var Yx,Gse,UR=f(()=>{"use strict";s();Yx=30,Gse=3});function VR(e,t){var r=e.EmailAddresses,n=e.Id,o=e.Name,a=e.UserPrincipalName,d=e.PersonaType,c=e.PersonaSubtype,u=e.AadObjectId;return{Id:n||"",Name:o||"",UserPrincipalName:a||"",EmailAddresses:r||[],SuggestionType:d||"",SuggestionSubtype:c||"",HostAppSuggestion:{},Source:"Loki",SuggestionOrigin:t?"ZeroTerm":"Search",AadObjectId:u||void 0}}function jR(e){return e.UserPrincipalName||(e.EmailAddresses&&e.EmailAddresses.length?e.EmailAddresses[0]:"")}function qse(e){return{Id:e,Name:e,UserPrincipalName:"",HostAppSuggestion:{},SuggestionType:"",SuggestionSubtype:"",EmailAddresses:[e],Source:"UserTypedSuggestion",SuggestionOrigin:"UserTyped"}}var qh=f(()=>{"use strict";s()});function Kse(e,t){var r=function(u){return!(!u.Id||!u.EmailAddresses||u.EmailAddresses.length===0)},n=Sx(t,function(c){return c.Id}),o={};t&&(o=Sx(t.filter(function(c){return c.AadObjectId}),function(c){return c.AadObjectId}));var a=Sx(t,function(c){return c.UserPrincipalName}),d=e.filter(r).filter(function(c){return kL(n,c.Id)}).filter(function(c){return kL(o,c.AadObjectId)}).filter(function(c){return kL(a,c.UserPrincipalName)});return d}function Yse(e,t){var r=Z_(e).toLowerCase(),n=t.filter(function(o){return o.Name&&Z_(o.Name.toLowerCase()).indexOf(r)===0});return n}function $se(e){var t=zse(e),r=t&&t[0],n=[qse(r)];return n}function Qse(e){return e.length===0?"Empty":e.length%Yx===0?"Limited":"Full"}var kL,Xse=f(()=>{"use strict";s();tc();UR();AL();qh();kL=function(t,r){return!r||!t||t[r]===void 0}});function Jse(e,t){var r=new Set;t.forEach(function(o){o.EmailAddresses.forEach(function(a){return r.add(a.toLowerCase())})});var n=e.filter(function(o){var a=!0;return o.EmailAddresses.forEach(function(d){r.has(d.toLowerCase())&&(a=!1)}),a});return n}var Zse=f(()=>{"use strict";s()});var $x,DL=f(()=>{"use strict";s();us();$x=Qn("PhotoUrisProvidedAction",{featureName:"NoLogging"})});function Qwe(e,t){return{photoUris:Object.assign(Object.assign({},e.photoUris),t.photoUris)}}var Kwe,Ywe,$we,WR,wL=f(()=>{"use strict";s();us();DL();Kwe="PhotoUriStore",Ywe={photoUris:{}},$we=tu().handlePayload($x,Qwe).done(Ywe),WR=ru(Kwe,$we,function(e){return{get photoUris(){return e.photoUris}}})});function ede(e){var t=WR.getSelectors(e);return t.photoUris}var tde=f(()=>{"use strict";s();wL()});function eFe(e,t){var r=t.payload;return{queryStatuses:Object.assign(Object.assign({},e.queryStatuses),(0,Kh.default)({},r.query,"InProgress")),currentQueries:Object.assign(Object.assign({},e.currentQueries),(0,Kh.default)({},r.inputId,r.query))}}function tFe(e,t){var r=t.payload;return Object.assign(Object.assign({},e),{queryStatuses:Object.assign(Object.assign({},e.queryStatuses),(0,Kh.default)({},r.query,"Finished"))})}function rFe(e,t){var r=t.payload;return Object.assign(Object.assign({},e),{currentQueries:Object.assign(Object.assign({},e.currentQueries),(0,Kh.default)({},r.inputId,void 0))})}function nFe(e,t){var r=t.payload;return Object.assign(Object.assign({},e),{currentQueries:Object.assign(Object.assign({},e.currentQueries),(0,Kh.default)({},r.inputId,void 0))})}var Kh,Xwe,Jwe,Zwe,Qx,FL=f(()=>{"use strict";s();Kh=S(FD());us();mR();P2();Xwe="QueryStore",Jwe={queryStatuses:{},currentQueries:{}},Zwe=tu().handleAction(lR,eFe).handleAction(fR,tFe).handleAction(gR,rFe).handleAction(pR,nFe).done(Jwe);Qx=ru(Xwe,Zwe,function(e){return{getCurrentQuery:function(r){return e.currentQueries[r]||""},getQueryStatus:function(r){return e.queryStatuses[r]||"Finished"}}})});function zR(e,t){var r=Qx.getSelectors(e);return r.getCurrentQuery(t)}function OL(e,t){var r=Qx.getSelectors(e);return r.getQueryStatus(t)}var GR=f(()=>{"use strict";s();FL()});var qR,NL=f(()=>{"use strict";s();us();qR=Qn("LivePersonaPickerInitializedAction",{featureName:"AppLoadedAction",getLogProperties:function(t){var r,n;return{infoBarrierSegmentsCount:(n=(r=t.informationBarrierSegments)===null||r===void 0?void 0:r.length)===null||n===void 0?void 0:n.toString(),offline:t.offline.toString()}}})});var ML,nde,Yh,rde,KR,YR,ode,ide,ade=f(()=>{"use strict";s();UR();ML={queryType:"loki",top:Yx,searchDirectory:!0},nde=Object.assign(Object.assign({},ML),{searchDirectory:!1}),Yh={queryType:"host",top:Yx,searchDirectory:!0},rde=Object.assign(Object.assign({},Yh),{searchDirectory:!1}),KR={startupQueries:new Set([nde,Yh]),queries:new Set([ML,Yh])},YR={startupQueries:new Set,queries:new Set([Yh])},ode={startupQueries:new Set([rde]),queries:new Set([Yh,rde])},ide={startupQueries:new Set([nde]),queries:new Set([ML]),fallbackQueries:new Set([Yh])}});function sFe(e,t){var r=t.informationBarrierSegments,n=t.offline,o=t.clientType,a=Object.assign(Object.assign({},e.settings),{informationBarrierSegments:r});if(t.settings){var d=t.settings;a=Object.assign(Object.assign({},e.settings),d)}switch(o){case"ShareDialog":a=Object.assign(Object.assign({},a),{clearInputOnSuggestionPressed:!0,detectEmailAddresses:!0,dismissPickerAfterWordBreakLimitIsReached:!1,queryConfig:n?YR:ide});break;case"UWPStellarCalendar":a=Object.assign(Object.assign({},a),{loadMoreSuggestionsOnScroll:!0,queryConfig:ode,suggestUseEmailAddress:!0,triggerStringMode:"ZeroTerm"});break;case"OneNoteUWP":a=Object.assign(Object.assign({},a),{triggerStringMode:"ZeroTerm"});break;case"OfficeAndroid":case"OfficeiOS":case"MobileTestApp":case"OfficeWin32":a=Object.assign(Object.assign({},a),{triggerStringMode:"AtMention",queryConfig:n?YR:KR});break;case"OfficeWebApps":case"Outlook_Monarch_HUB":case"Outlook_Web_HUB":case"Outlook_Win32_HUB":case"Teams_HUB":case"OrgExplorerTestpage_Web":case"ToDo_UWP":case"ToDo_Android":case"ToDo_iOS":case"MetaOSFeed":case"MetaOSFeed_Edge":case"MetaOSFeed_OfficeCom":case"VivaOnboarding":case"VivaPulse":case"Neon":case"Neon_Windows":a=Object.assign(Object.assign({},a),{queryConfig:n?YR:KR});break;default:}return{settings:a}}var oFe,iFe,aFe,Xx,LL=f(()=>{"use strict";s();us();NL();ade();oFe="SettingStore",iFe={settings:{clearInputOnSuggestionPressed:!1,detectEmailAddresses:!1,dismissPickerAfterWordBreakLimitIsReached:!0,informationBarrierSegments:void 0,loadMoreSuggestionsOnScroll:!1,queryConfig:KR,suggestUseEmailAddress:!1,triggerStringMode:"OneLetter"}},aFe=tu().handlePayload(qR,sFe).done(iFe),Xx=ru(oFe,aFe,function(e){return{get settings(){return e.settings}}})});function sde(e){var t=Xx.getSelectors(e);return t.settings}var dde=f(()=>{"use strict";s();LL()});function dFe(e){return e||[]}function cFe(e){return dFe(e==null?void 0:e.Value)}function BL(e,t){var r=e.length===0?$R:{key:e},n=Kx.getSelectors(t);return cFe(n.getLatestSuccess(r)).map(function(o){return VR(o,e.length===0)})}function UL(e,t){var r=e.length===0?$R:{key:e},n=Nx.getSelectors(t);return n.getLatestSuccess(r)||[]}function uFe(e,t){var r=e.length===0?$R:{key:e},n=Kx.getSelectors(t);return n.hasError(r)}function lFe(e,t){var r=e.length===0?$R:{key:e},n=Nx.getSelectors(t);return n.hasError(r)}function QR(e,t,r){var n="",o=cde(n,e,r);if(t===n){var a=ude(e,o),d=iR(a,function(h){return h.Id});return d.length!==a.length&&console.error("Suggestions coming from the host app do not have unique IDs!"),lde(t,e,d)}var c=Yse(t,o),u=cde(t,e,r),l=iR([].concat((0,HL.default)(c),(0,HL.default)(u)),function(h){return h.Id}),p=fFe(t,e,l),g=ude(e,p);return lde(t,e,g)}function cde(e,t,r){var n=BL(e,t),o=UL(e,t),a=Jse(o,n),d=(n||[]).concat(a),c=Kse(d,r);return c}function fFe(e,t,r){var n=sde(t),o=OL(t,e),a=Wse(e);if(n.suggestUseEmailAddress&&o==="Finished"&&r.length===0&&jse(a)){var d=$se(a);return d}return r}function ude(e,t){var r=ede(e);return t.map(function(n){return n.ImageSource=n.ImageSource||r[n.Id],n})}function lde(e,t,r){var n=OL(t,e),o=uFe(e,t)||lFe(e,t),a=Qse(r);return{query:e,queryStatus:n,suggestions:r,completeness:a,hasErrors:o}}var HL,$R,Jx=f(()=>{"use strict";s();HL=S(A2());tc();BR();bR();AL();Xse();Zse();qh();tde();GR();dde();$R={key:""}});function fde(e,t,r){if(!e.getHostAppSuggestions)return Promise.resolve([]);var n={key:t},o=e.getStoreState();if(o){var a=UL(t,o);if(a.length>0)return Promise.resolve(a)}return B2.fetch({monitorStarter:e.logger,dispatch:e.dispatch,timeoutOverride:pFe},n,{getHostAppSuggestions:e.getHostAppSuggestions,query:t,options:r}).then(function(d){return d.response.map(function(c){return c.Source="HostApp"}),d.response}).catch(function(){return[]})}var pFe,pde=f(()=>{"use strict";s();bR();Jx();pFe=1e4});function mde(e,t,r){var n={key:t},o=e.getStoreState();if(o){var a=BL(t,o);if(a.length>0)return Promise.resolve(a)}var d=e.settings.informationBarrierSegments;return RL.fetch({monitorStarter:e.logger,lokiRestProvider:e.getLokiRestProvider(),dispatch:e.dispatch,timeoutOverride:mFe,clientScenario:gFe,hostAppApp:e.hostAppName},n,{scenarioName:"people",query:t||void 0,top:r.top,searchDirectory:r.searchDirectory,informationBarrierSegments:d}).then(function(c){var u=c.response.Value;return(u||[]).map(function(l){return VR(l,t.length===0)})}).catch(function(){return[]})}var mFe,gFe,gde=f(()=>{"use strict";s();BR();Jx();qh();mFe=1e4,gFe="getPersonaSuggestions"});function VL(e,t){return yFe(e,t.getPhotoUri).then(function(r){t.dispatch($x({photoUris:r}))}).catch(function(){t.dispatch($x({photoUris:{}}))}),Promise.resolve(e)}function yFe(e,t){return Promise.all(e.map(function(r){return CFe(r,t)})).then(function(r){var n=function(a,d,c){return a[e[c].Id]=d,a};return r.reduce(n,{})})}function CFe(e,t){return t?t(hFe,jR(e),e.AadObjectId):Promise.resolve(void 0)}var hFe,hde=f(()=>{"use strict";s();DL();qh();hFe="api/v2/personaphoto?smtp="});function WL(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=e.settings.queryConfig,o=n.queries||yde,a=n.fallbackQueries||yde;return jL(e,t,o,r).then(function(d){return d.length>0?Promise.resolve(d):jL(e,t,a,r)}).then(function(d){return e.dispatch(fR({query:t})),Promise.resolve(d)}).then(function(d){return VL(d,e)})}function vde(e){var t=e.settings.queryConfig,r=t.startupQueries;return jL(e,"",r).then(function(n){return VL(n,e)})}function jL(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;return Promise.all((0,Cde.default)(r).map(function(o){return vFe(e,t,Object.assign(Object.assign({},o),{top:o.top*n}))})).then(JM)}function vFe(e,t,r){var n=r.queryType;switch(n){case"loki":return mde(e,t,r);case"host":return fde(e,t,r);default:return n}}var Cde,yde,zL=f(()=>{"use strict";s();Cde=S(A2());tc();mR();pde();gde();hde();yde=new Set});function xde(e,t,r){t.length>=200||(e.dispatch(lR({query:t,inputId:r})),WL(e,t))}function Tde(e,t,r,n){WL(e,t,n),e.dispatch(Gie({query:t,inputId:r}))}function bde(e,t,r,n,o,a){e.dispatch(gR({suggestionSource:t.Source,suggestionOrigin:t.SuggestionOrigin,inputId:r,queryLength:n,suggestionsShown:o,pickedSuggestionIndex:a}))}function XR(e,t,r,n,o){e.dispatch(pR({dismissalReason:t,inputId:r,queryLength:n,suggestionsShown:o}))}var GL=f(()=>{"use strict";s();mR();P2();zL()});var W,Sde=f(()=>{"use strict";s();W="#ff00ff"});var JR,qL=f(()=>{"use strict";s();Sde();JR={labelColor:W,labelColorPressed:W,labelColorHover:W,secondaryLabelColor:W,tertiaryLabelColor:W,quaternaryLabelColor:W,linkColor:W,linkColorPressed:W,linkColorHover:W,placeholderTextColor:W,windowFrameTextColor:W,selectedMenuItemTextColor:W,headerTextColor:W,gridColor:W,selectedGridColor:W,secondaryGridColor:W,refreshSpinnerColor:W,refreshSpinnerBackgroundColor:W,windowBackgroundColor:W,underPageBackgroundColor:W,controlBackgroundColor:W,controlHoveredBackgroundColor:W,controlPressedBackgroundColor:W,cardBackgroundColor:W,cardBackgroundSelectedColor:W,cardHeaderColor:W,cardBorderColor:W,cardHeaderIconBackgroundColor:W,cardSecondaryBackgroundColor:W,windowBackgroundLightColor:W,titleColor:W,textColor:W,textBackgroundColor:W,textSecondaryBackgroundColor:W,selectedTextColor:W,selectedTextBackgroundColor:W,textErrorColor:W,background1:W,background2:W,background3:W,background4:W,background5:W,backgroundCanvas:W,backgroundDarkStatic:W,backgroundStencil1:W,controlsSegmentBackground2:W,controlsSegmentForeground2:W,foreground1:W,foreground2:W,foreground3:W,foregroundLightStatic:W,foregroundOnColor:W,stroke1:W,stroke2:W,brandStrokeAccessible:W,brandStrokeTint:W,brandStrokeTintPressed:W,brandBackgroundTint:W,brandBackground1:W,brandForeground1:W,statusPresenceAvailable:W,statusPresenceDnD:W,controlColor:W,controlTextColor:W,controlHoveredTextColor:W,controlPressedTextColor:W,controlSecondaryTextColor:W,controlSecondaryHoveredTextColor:W,controlSecondaryPressedTextColor:W,selectedControlColor:W,selectedControlTextColor:W,hoveredControlColor:W,hoveredSelectedControlColor:W,secondaryHoveredControlColor:W,pressedControlColor:W,secondaryPressedControlColor:W,controlBorderColor:W,controlFocusedBorderColor:W,controlButtonBorderColor:W,controlBorderLightColor:W,controlPillBackgroundColor:W,controlPillHoverTextColor:W,controlPillSecondaryHoverTextColor:W,controlPillHoverBackgroundColor:W,controlPillSecondaryHoverBackgroundColor:W,controlPillTertiaryHoverBackgroundColor:W,controlPillPressedBackgroundColor:W,controlPillColor:W,controlPillSecondaryTextColor:W,controlPillPressedTextColor:W,controlPillBorderColor:W,controlPillHoverBorderColor:W,controlPillSecondaryHoverBorderColor:W,controlPillPressedBorderColor:W,calloutSecondaryBackgroundColor:W,disabledControlTextColor:W,keyboardFocusIndicatorColor:W,listViewBackgroundColor:W,listViewItemBackgroundColor:W,sectionListViewBackgroundColor:W,sectionListViewItemBackgroundColor:W,badgePrimaryBackgroundColor:W,badgePrimaryBorderColor:W,badgePrimaryTextColor:W,badgeSecondaryBackgroundColor:W,badgeSecondaryBorderColor:W,badgeSecondaryTextColor:W,folderBadgePrimaryBorderColor:W,primaryButtonBackground:W,primaryButtonBackgroundHovered:W,primaryButtonBackgroundPressed:W,primaryButtonBackgroundDisabled:W,primaryButtonBorder:W,primaryButtonBorderFocused:W,primaryButtonText:W,primaryButtonTextHovered:W,primaryButtonTextPressed:W,primaryButtonTextDisabled:W,buttonBackground:W,buttonBackgroundHovered:W,buttonBackgroundPressed:W,buttonBackgroundDisabled:W,buttonBorder:W,buttonBorderFocused:W,buttonBorderDisabled:W,systemRedColor:"#e63237",systemGreenColor:"#107c10",systemBlueColor:"#0078d7",systemOrangeColor:"#d83b01",systemYellowColor:"#ffb900",systemBrownColor:"#a2845e",systemPinkColor:"#ff2d55",systemPurpleColor:"#5c2d91",systemGrayColor:"#999999",highlightColor:W,shadowColor:W,outlookAlabaster:"#f8f8f8",outlookBlack:"#212121",outlookBlueHighlighted:"#cbe3f5",outlookBlueSelected:"#005b9e",outlookGray:"#8e8e93",outlookLightGray:"#a8a8ac",outlookMercury:"#e1e1e1",outlookRed:"#e63237",outlookSeashell:"#f1f1f1",flaggedNormalBackgroundColor:"rgba(253, 247, 232, 1.0)",flaggedSelectedBackgroundColor:"rgba(253, 245, 224, 1.0)",iconTintColor:W,feedMenuTintColor:W,notificationBackgroundColor:"#c7e0f4",notificationTextColor:"#0078d7",activityIndicatorColor:"#0078d7",dividerColor:W,dividerColorBottomSheet:"#e0e0e0",secondaryDividerColor:W,accentColor:W,secondaryBackgroundColor:W,tertiaryBackgroundColor:W,quaternaryBackgroundColor:W,placeholderBackgroundColor:W,menuBackground:W,menuItemBackgroundHovered:W,menuItemBackgroundChecked:W,menuItemBackgroundPressed:W,menuItemTextHovered:W,buttonTextHovered:W,buttonText:W,buttonTextPressed:W,buttonTextDisabled:W,menuItemText:W,menuItemTextChecked:W,buttonTextChecked:W,menuDivider:W,superAnnotation:W,teamsColor:W,teamsOofMessageColor:W,buttonIconTintColor:W,buttonIconDisableColor:W}});function ou(){var e=Uc(),t={alternateHero:24};return Ide.useMemo(function(){var r=e.name,n=e.host,o=e.colors,a=n.palette,d=n.colors;if(!n||!a||!d)throw new Error("Host theme is not fully defined.");return{themeName:r,semanticColors:m(m(m(m({},JR),{controlHoveredBackgroundColor:o.menuItemBackgroundHovered,controlPressedBackgroundColor:o.menuItemBackgroundPressed,controlBackgroundColor:"#00000000",controlBorderColor:o.buttonBorder,controlBorderLightColor:a.AccentLight,controlFocusedBorderColor:o.focusBorder,keyboardFocusIndicatorColor:a.AccentOutline,highlightColor:d.App6,controlTextColor:o.buttonText,controlHoveredTextColor:o.buttonTextHovered,controlPressedTextColor:o.buttonTextPressed,titleColor:o.bodyText,textColor:o.bodyText,textSecondaryBackgroundColor:a.Text,labelColor:o.subText,secondaryLabelColor:a.TextSecondary,controlSecondaryTextColor:a.TextSecondary,tertiaryLabelColor:a.TextCtlEmphasis,controlSecondaryHoveredTextColor:a.TextSecondaryHover,controlSecondaryPressedTextColor:a.TextSecondaryPressed,controlButtonBorderColor:a.TextSecondaryHover,windowBackgroundColor:a.Bkg,windowBackgroundLightColor:a.BkgCtlSubtleDisabled,linkColor:a.TextHyperlink,linkColorHover:a.BkgCtlEmphasisHover,hoveredControlColor:a.BkgCtlEmphasisHover,calloutSecondaryBackgroundColor:a.BkgCtlEmphasis,textErrorColor:a.TextError,controlPillColor:a.TextEmphasisHover,controlPillSecondaryTextColor:a.TextEmphasisHover,controlPillBorderColor:a.BkgCtlSubtleHover,controlPillBackgroundColor:a.BkgCtlSubtleHover,controlPillHoverTextColor:a.TextEmphasisHover,controlPillHoverBorderColor:a.BkgCtlSubtlePressed,controlPillHoverBackgroundColor:a.BkgCtlSubtlePressed,controlPillSecondaryHoverTextColor:a.TextEmphasisHover,controlPillSecondaryHoverBorderColor:a.BkgCtlSubtlePressed,controlPillSecondaryHoverBackgroundColor:a.BkgCtlSubtlePressed,controlPillTertiaryHoverBackgroundColor:a.BkgCtlPressed,controlPillPressedTextColor:a.TextCtlEmphasis,controlPillPressedBorderColor:a.BkgCtlEmphasis,controlPillPressedBackgroundColor:a.BkgCtlEmphasis,menuBackground:o.menuBackground,menuItemBackgroundHovered:o.menuItemBackgroundHovered,menuItemBackgroundChecked:o.menuItemBackgroundChecked,menuItemTextHovered:o.menuItemTextHovered,buttonTextHovered:o.buttonTextHovered,buttonText:o.buttonText,buttonTextPressed:o.buttonTextPressed,buttonTextDisabled:o.buttonTextDisabled,menuItemText:o.menuItemText,menuItemTextChecked:o.menuItemTextChecked,buttonTextChecked:o.buttonTextChecked,menuItemBackgroundPressed:o.menuItemBackgroundPressed,menuDivider:o.menuDivider,teamsColor:o.subText,teamsOofMessageColor:o.subText,primaryButtonBackground:o.primaryButtonBackground,primaryButtonBackgroundHovered:o.primaryButtonBackgroundHovered,primaryButtonBackgroundPressed:o.primaryButtonBackgroundPressed,primaryButtonBackgroundDisabled:o.primaryButtonBackgroundDisabled,primaryButtonBorder:o.primaryButtonBorder,primaryButtonBorderFocused:o.primaryButtonBorderFocused,primaryButtonText:o.primaryButtonText,primaryButtonTextHovered:o.primaryButtonTextHovered,primaryButtonTextPressed:o.primaryButtonTextPressed,primaryButtonTextDisabled:o.primaryButtonTextDisabled,buttonBackground:o.buttonBackground,buttonBackgroundHovered:o.buttonBackgroundHovered,buttonBackgroundPressed:o.buttonBackgroundPressed,buttonBackgroundDisabled:o.buttonBackgroundDisabled,buttonBorder:o.buttonBorder,buttonBorderFocused:o.buttonBorderFocused,buttonBorderDisabled:o.buttonBorderDisabled}),xFe(r,a)),TFe(r)),typography:{sizes:{xxxSmall:e.typography.sizes.secondary,xxSmall:e.typography.sizes.secondary,xSmall:e.typography.sizes.secondary,small:e.typography.sizes.secondary,medium:e.typography.sizes.secondary,large:e.typography.sizes.body,xLarge:e.typography.sizes.subheader,xxLarge:e.typography.sizes.subheader,xxxLarge:t.alternateHero},families:e.typography.families,weights:{light:e.typography.weights.regular,semiLight:e.typography.weights.regular,medium:e.typography.weights.regular,semiBold:e.typography.weights.semiBold,bold:e.typography.weights.semiBold}},icons:{},brandIcons:{},illustrations:{}}},[e])}function xFe(e,t){switch(e){case"Colorful":case"DarkGray":case"Black":case"White":return{};case"HighContrast":return{controlPillColor:t.TextCtlSubtle,controlPillSecondaryTextColor:t.TextHyperlink,controlPillBorderColor:t.TextCtlSubtle,controlPillBackgroundColor:t.BkgCtl,controlPillHoverTextColor:t.TextCtlSubtleHover,controlPillHoverBorderColor:t.BkgCtlHover,controlPillHoverBackgroundColor:t.BkgCtlHover,controlPillSecondaryHoverTextColor:t.TextCtlSubtle,controlPillSecondaryHoverBorderColor:t.BkgCtlHover,controlPillSecondaryHoverBackgroundColor:t.BkgCtl,controlPillTertiaryHoverBackgroundColor:t.BkgCtlHover,controlPillPressedTextColor:t.TextCtlSubtleHover,controlPillPressedBorderColor:t.BkgCtlHover,controlPillPressedBackgroundColor:t.BkgCtlHover,textErrorColor:t.TextHyperlink,hoveredControlColor:t.StrokeCtlPressed,tertiaryLabelColor:t.BkgCtl,calloutSecondaryBackgroundColor:t.BkgCtlHover};default:return rc(e,{})}}function TFe(e){switch(e){case"DarkGray":return{textSecondaryBackgroundColor:"#ffffff"};case"HighContrast":return{};case"Colorful":case"White":return bFe();case"Black":return SFe();default:return rc(e,{})}}function bFe(){var e=Yo.colors;return m({controlPillColor:e.primaryButtonBackgroundPressed,controlPillSecondaryTextColor:e.primaryButtonBackgroundPressed,controlPillHoverTextColor:e.primaryButtonBackgroundPressed,controlPillSecondaryHoverTextColor:e.primaryButtonBackgroundPressed,controlButtonBorderColor:e.primaryButtonTextDisabled,controlPillBorderColor:"#eff6fc",controlPillBackgroundColor:"#eff6fc",controlPillHoverBorderColor:"#deecf9",controlPillHoverBackgroundColor:"#deecf9",controlPillSecondaryHoverBorderColor:"#deecf9",controlPillSecondaryHoverBackgroundColor:"#deecf9",controlPillTertiaryHoverBackgroundColor:"#c7e0f4",teamsColor:"#6264a7",teamsOofMessageColor:"#b4009e"},Ede(e))}function SFe(){var e=Bg.colors;return m({controlButtonBorderColor:e.bodyDivider,teamsColor:"#7a7fea",teamsOofMessageColor:"#e959d9"},Ede(e))}function Ede(e){return{textColor:e.bodyText,labelColor:e.subText,secondaryLabelColor:e.buttonTextHovered,controlTextColor:e.buttonText,controlHoveredTextColor:e.buttonTextHovered,controlPressedTextColor:e.buttonTextPressed,controlSecondaryTextColor:e.subText,controlSecondaryHoveredTextColor:e.subText,controlSecondaryPressedTextColor:e.subText,controlBorderColor:e.bodyDivider,controlBorderLightColor:e.bodyDivider,controlFocusedBorderColor:e.focusBorder,controlButtonBorderColor:e.primaryButtonTextDisabled,controlHoveredBackgroundColor:e.buttonBackgroundHovered,controlPressedBackgroundColor:e.buttonBackgroundPressed,hoveredControlColor:e.themePrimary,linkColor:e.link,linkColorHover:e.linkHovered,calloutSecondaryBackgroundColor:e.primaryButtonBackgroundHovered,keyboardFocusIndicatorColor:e.bodyText,textErrorColor:e.errorText,notificationTextColor:e.neutralPrimaryAlt,textSecondaryBackgroundColor:"#ffffff"}}var Ide,Zx=f(()=>{"use strict";s();k();Ta();Vg();Qf();Ide=S(L());qL()});var Pde,_de=f(()=>{"use strict";s();qL();Pde=Object.assign({},JR)});var $h,iu,eT,Rde,Ade=f(()=>{"use strict";s();$h="Times New Roman",iu=0,eT="900",Rde={families:{primary:$h,secondary:$h,cursive:$h,monospace:$h,sansSerif:$h,serif:$h},sizes:{xxxSmall:iu,xxSmall:iu,xSmall:iu,small:iu,medium:iu,large:iu,xLarge:iu,xxLarge:iu,xxxLarge:iu},weights:{light:eT,semiLight:eT,medium:eT,semiBold:eT,bold:eT}}});var kde,Dde=f(()=>{"use strict";s();_de();Ade();kde={semanticColors:Pde,typography:Rde,icons:{},brandIcons:{},illustrations:{}}});var wde,IFe,Fde,Ode=f(()=>{"use strict";s();wde=S(L());Dde();IFe=kde,Fde=(0,wde.createContext)(IFe)});function KL(){return(0,Nde.useContext)(Fde)}var Nde,Mde=f(()=>{"use strict";s();Nde=S(L());Ode()});var Lde=f(()=>{"use strict";s();Mde()});var Hde,Bde,Ude=f(()=>{"use strict";s();Hde=S(re()),Bde=Hde.Image});var YL,Vde,jde=f(()=>{"use strict";s();k();Ta();YL=S(re()),Vde=$n(function(e,t){var r=e.semanticColors;return YL.StyleSheet.create({container:m({alignItems:"center",flexDirection:"row",overflow:"hidden"},t.specifyContainerBorder?{borderWidth:YL.StyleSheet.hairlineWidth,borderColor:"transparent"}:{}),textBoy:{flex:1,color:t.useWhiteTextBoy?"#ffffff":r.sectionListViewItemBackgroundColor,textAlign:"center",textAlignVertical:"center"},userPhoto:{position:"absolute",left:0,top:0,overflow:"hidden",justifyContent:"center"},presenceIcon:{position:"absolute",right:0,bottom:0,overflow:"hidden",width:24,height:24,justifyContent:"center"}})})});function $L(e){var t=0;if(e.length===0)return t;for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t=(t<<5)-t+n,t&=t}return t}var Wde=f(()=>{"use strict";s()});var zde=f(()=>{"use strict";s();Wde()});var Gde=f(()=>{"use strict";s();zde()});var qde,EFe,PFe,_Fe,RFe,AFe,Kde,QL,vrr,xrr,ZR,Trr,brr,Srr,XL=f(()=>{"use strict";s();qde="#eaeaea",EFe=100,PFe=400,_Fe=300,RFe=500,AFe=600,Kde=14,QL=12,vrr=EFe.toString(),xrr=_Fe.toString(),ZR="normal",Trr=PFe.toString(),brr=RFe.toString(),Srr=AFe.toString()});function JL(e,t,r){if(!e&&!t&&!r)return qde;var n=(e||"")+(t||"")+(r||""),o=Math.abs($L(n));return $de[o%$de.length]}var $de,Qde=f(()=>{"use strict";s();Gde();XL();$de=["#3298db","#50bbc4","#32c270","#f07e21","#e6463c","#f0ce0e","#f069b1","#9e75db","#ac735f","#a5a5ab"]});function ZL(e){var t="";if(!e)return t;e=e.replace(kFe,""),e=e.replace(DFe,""),e=e.replace(wFe," "),e=e.trim();var r=e.split(" ");return r.length>=2?(t+=r[0].charAt(0).toUpperCase(),t+=r[r.length-1].charAt(0).toUpperCase()):r.length!==0&&(t+=r[0].charAt(0).toUpperCase()),t}var kFe,DFe,wFe,Xde=f(()=>{"use strict";s();kFe=/\(([^)]*)\)/gi,DFe=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,wFe=/\s+/gi});var Jde,Zde=f(()=>{"use strict";s();Jde=/\([^)]*\)|[\0-\u001F\!-\"$-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g});function eH(e,t){var r="";if(e&&e.length>0){var n=e.split(" ");n.forEach(function(o){var a=o.trim();if(!(a.length<1)){var d=a.substr(0,1),c=d.length>0&&d.search(Jde)===-1;c&&r.length<2&&(r+=d)}})}else t&&t.length>0&&(r=t.substr(0,1));return r.length===0&&(r="#"),r.toUpperCase()}var ece=f(()=>{"use strict";s();Zde()});function tce(e){var t,r=e.accessibilityLabel,n=e.accessible,o=e.email,a=e.aadObjectId,d=e.imageSource,c=e.name,u=e.onError,l=e.onLoad,p=e.overrideUserColor,g=e.overrideUserInitials,h=e.placeholderImageSource,v=e.showPlaceholderImage,y=e.showTextBoy,T=e.size,b=e.style,I=e.focusable,E=e.imageOverflowWorkaround,P=e.textOverflowWorkaround,_=e.specifyContainerBorder,D=e.useWhiteTextBoy,M=e.forceImageComponent,H=e.useOutlookMobileInitials,U=e.presenceIcon,F=e.presenceIconToolTip,z=e.profilePhotoTooltip,Y=KL(),B=ps.useMemo(function(){return{specifyContainerBorder:_,useWhiteTextBoy:D}},[_,D]),q=Vde(Y,B),K=y?p||JL(c,o,a):"transparent",$=T/2,oe={width:T,height:T},ie=v&&h,Ce={resizeMode:"cover",style:[q.userPhoto,oe,E]},se=(t=d==null?void 0:d.uri)===null||t===void 0?void 0:t.startsWith("https://"),he=M||se?rd.Image:Bde,Be=ps.useMemo(function(){return g||(H?eH(c,o):ZL(c,o))},[g,H,c,o,a]),_e=rd.StyleSheet.flatten(q.presenceIcon);return ps.createElement(rd.View,null,ps.createElement(rd.View,{style:[q.container,oe,{borderRadius:$},{backgroundColor:K},b],accessible:n,accessibilityLabel:r,focusable:I,tooltip:z},y&&ps.createElement(rd.Text,{style:[q.textBoy,{fontSize:Math.round(T*.4)},P],allowFontScaling:!1},Be),ie&&ps.createElement(rd.Image,m({},Ce,{source:ie,accessibilityIgnoresInvertColors:!0})),d&&ps.createElement(he,m({},Ce,{key:d.uri,source:d,onLoad:l,onError:u,accessibilityIgnoresInvertColors:!0}))),U&&ps.createElement(rd.View,m({tooltip:F},{style:[q.presenceIcon,E],accessibilityIgnoresInvertColors:!0,testID:"persona_image_presence_coin"}),ps.cloneElement(U,{width:_e.width,height:_e.height})))}var ps,rd,rce=f(()=>{"use strict";s();k();ps=S(L()),rd=S(re());Lde();Ude();jde();Qde();Xde();ece()});function oce(e){var t=e.accessible&&void 0;e.hasOwnProperty("acceptsKeyboardFocus")&&(t=e.acceptsKeyboardFocus);var r=e.size/2,n={borderRadius:r},o=void 0,a=!0,d=void 0;return nce.createElement(tce,m({},e,{focusable:t,imageOverflowWorkaround:n,textOverflowWorkaround:o,useWhiteTextBoy:a,specifyContainerBorder:d}))}var nce,ice=f(()=>{"use strict";s();k();nce=S(L());rce()});function OFe(e){switch(e){default:case"SmallStandard":return{fontFamily:tH,fontSize:QL,fontWeight:ZR};case"SmallSecondary":return{fontFamily:tH,fontSize:QL,fontWeight:ZR};case"MediumBold":return{fontFamily:tH,fontSize:Kde,fontWeight:ZR}}}var ace,tH,sce,dce=f(()=>{"use strict";s();oc();XL();ace=S(re()),tH="SegoeUI",sce=$n(function(e){return ace.StyleSheet.create({text:OFe(e)})})});var NFe,cce=f(()=>{"use strict";s();NFe=S(re())});function Dp(e){var t=e.children,r=e.style,n=e.textStyle,o=MFe(e,["children","style","textStyle"]),a=sce(n);return tT.createElement(rT.Text,Object.assign({},o,{style:[a.text,r]}),t)}function uce(){var e=ou();return tT.createElement(rT.ActivityIndicator,{color:e.semanticColors.activityIndicatorColor})}function lce(e){return tT.createElement(zi,Object.assign({},e,{dismissBehaviors:["preventDismissOnKeyDown"]}))}var tT,rT,Bl,MFe,fce,pce,Ul=f(()=>{"use strict";s();ice();Zx();ha();tT=S(L()),rT=S(re());dce();Bl=S(re());cce();MFe=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r};fce={small:40},pce=function(t){return tT.createElement(oce,{accessibilityLabel:"",accessible:!1,acceptsKeyboardFocus:void 0,email:t.email,imageSource:t.source,name:t.displayName,showTextBoy:!0,size:t.size})}});var mce,gce,hce=f(()=>{"use strict";s();Zx();mce=S(L());Ul();gce=function(t){var r=t.onDismiss,n=t.children,o=t.calloutPositioningTarget,a=t.maxHeight,d=ou();return o?mce.createElement(lce,{onDismiss:r,target:o,maxHeight:a,borderColor:d==null?void 0:d.semanticColors.menuDivider,borderWidth:1,backgroundColor:d==null?void 0:d.semanticColors.menuBackground},n):null}});var au,yce,Cce=f(()=>{"use strict";s();k();Ta();M2();au=S(L()),yce=function(e){Z(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.stats=void 0,r}return t.prototype.componentDidMount=function(){this.addRenderToStats()},t.prototype.componentDidUpdate=function(){this.addRenderToStats()},t.prototype.componentWillUnmount=function(){this.logStats()},t.prototype.render=function(){switch(au.Children.count(this.props.children)){case 0:return null;case 1:return au.Children.only(this.props.children);default:return au.createElement(au.Fragment,null,this.props.children)}},t.prototype.shouldAddMeasure=function(){var r=!!this.stats&&this.stats.finishedLoading,n=!r&&!!this.props.finishedLoading;return n&&!!this.props.navigationStartCheckpoint.markName},t.prototype.addRenderToStats=function(){var r=Date.now(),n=this.props.navigationStartCheckpoint;if(this.stats&&this.stats.navigationStartCheckpoint!==n&&this.logStats(),this.shouldAddMeasure())try{performance.measure("\u23F3 EUPL : ".concat(this.props.componentName),this.props.navigationStartCheckpoint.markName)}catch(o){}this.stats?this.stats.finishedLoading?this.stats=ed(this.stats,{extraRenderCount:this.stats.extraRenderCount+1}):this.stats=ed(this.stats,{lastRenderTime:r,renderCount:this.stats.renderCount+1,finishedLoading:!!this.props.finishedLoading}):this.stats={navigationStartCheckpoint:n,firstRenderTime:r,lastRenderTime:r,renderCount:1,finishedLoading:!!this.props.finishedLoading,extraRenderCount:0}},t.prototype.logStats=function(){if(this.stats){var r=this.stats.navigationStartCheckpoint!==Ox,n=r?this.stats.lastRenderTime-this.stats.navigationStartCheckpoint.timestamp:0,o=r?m(m({},this.props.logProperties||{}),{componentName:this.props.componentName,navigationStartTime:this.stats.navigationStartCheckpoint.timestamp.toString(),firstRenderTime:this.stats.firstRenderTime.toString(),lastRenderTime:this.stats.lastRenderTime.toString(),renderCount:this.stats.renderCount.toString(),finishedLoading:this.stats.finishedLoading?"true":"false",extraRenderCount:this.stats.extraRenderCount.toString()}):m(m({},this.props.logProperties||{}),{componentName:this.props.componentName});this.props.logResult("EUPL_".concat(this.props.componentName),this.props.featureName,n,o),this.stats=void 0}},t}(au.Component)});var No,rH=f(()=>{"use strict";s();(function(e){e[e.ESCAPE=0]="ESCAPE",e[e.ENTER=1]="ENTER",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN",e[e.TAB=4]="TAB"})(No||(No={}))});var vce,nT,eA,nH=f(()=>{"use strict";s();vce=S(Tu());N2();Cce();tc();nT=S(L());GL();UR();rH();eA=function(t){return function(r){(0,vce.default)(n,r);function n(a){var d;return d=r.call(this,a)||this,d.onQueryChanged=function(c){var u=d.props,l=u.inputId,p=u.lppAppContext,g=u.shouldSkipFirstSuggestionFocus;xde(p,c,l);var h=g?-1:0;d.resetSelectedSuggestionIndex(h);var v=O2();d.setState({navigationStartCheckpoint:v,loadSuggestionsAmountMultiplier:1})},d.onCustomKeyPressed=function(c){var u=d.props.isOpen;if(u)switch(c){case No.DOWN:case No.UP:d.onSelectedSuggestionIndexChanged(c);break;case No.ESCAPE:d.onDismissed("userDismissed");break;case No.TAB:case No.ENTER:d.onSelectSuggestionKeyPressed();break;default:break}},d.onSelectSuggestionKeyPressed=function(){var c=d.props.suggestionsSet.suggestions,u=d.state.selectedSuggestionIndex;if(!(c.length===0||u<0||u>=c.length)){var l=c[u];d.onSuggestionSelected(l)}},d.onSuggestionSelected=function(c){var u=d.props,l=u.currentQuery,p=u.inputId,g=u.lppAppContext,h=u.onSuggestionSelected,v=u.suggestionsSet,y=v.suggestions.map(function(T){return c.Id===T.Id}).indexOf(!0);bde(g,c,p,l.length,v.suggestions.length,y),h&&h(c),d.onDismissed("suggestionSelected"),d.resetSelectedSuggestionIndex()},d.onDismissed=function(c){var u=d.props,l=u.currentQuery,p=u.inputId,g=u.lppAppContext,h=u.onDismiss,v=u.suggestionsSet;h&&h(),XR(g,c,p,l.length,v.suggestions.length),d.resetSelectedSuggestionIndex()},d.onScrollEndApproaching=function(){var c=d.props,u=c.currentQuery,l=c.lppAppContext,p=d.state.loadSuggestionsAmountMultiplier;if(l.settings.loadMoreSuggestionsOnScroll&&p<Gse){var g=p+1,h=d.props.inputId;Tde(l,u,h,g),d.setState(Object.assign(Object.assign({},d.state),{loadSuggestionsAmountMultiplier:g}))}},d.onSelectedSuggestionIndexChanged=function(c){var u=d.props.suggestionsSet.suggestions,l=d.state.selectedSuggestionIndex,p=-1;c===No.DOWN?p=Math.min(l+1,u.length-1):p=Math.max(l-1,0),d.resetSelectedSuggestionIndex(p)},d.resetSelectedSuggestionIndex=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1;d.setState({selectedSuggestionIndex:c})},d.state={loadSuggestionsAmountMultiplier:1,navigationStartCheckpoint:Ox,selectedSuggestionIndex:-1},d}var o=n.prototype;return o.shouldComponentUpdate=function(d,c){var u=this.props.lppAppContext;return this.props.isOpen&&!d.isOpen&&u.generateNewSuggestionListCorrelationId(),!Hc(this.props,d)||!Hc(this.state,c)},o.componentDidMount=function(){var d=this.props.componentRef;d&&d(this)},o.componentWillUnmount=function(){var d=this.props.componentRef;d&&d(null)},o.render=function(){var d=this.props,c=d.suggestionsSet,u=d.lppAppContext,l=this.state,p=l.navigationStartCheckpoint,g=l.selectedSuggestionIndex,h=Object.assign(Object.assign({},this.props),{selectedSuggestionIndex:g}),v=h;return nT.createElement(yce,{componentName:"SuggestionListCallout",featureName:"Performance",navigationStartCheckpoint:p,finishedLoading:c.suggestions.length>0||c.queryStatus==="Finished",logResult:u.createEUPLLogFunction()},nT.createElement(t,Object.assign({},v,{onSuggestionSelected:this.onSuggestionSelected,onScrollEndApproaching:this.onScrollEndApproaching})))},n}(nT.Component)}});var su,tA,xce,oT=f(()=>{"use strict";s();su=52,tA=208,xce=300});function Tce(){return LFe(this,void 0,void 0,function*(){return Promise.resolve(!1)})}var LFe,bce=f(()=>{"use strict";s();LFe=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})}});var rA,Sce,Ice,Ece=f(()=>{"use strict";s();rA=S(L()),Sce=S(re());Ul();Ice=function(t){return rA.createElement(Bl.View,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:10}},rA.createElement(uce,null),rA.createElement(Dp,{style:Sce.StyleSheet.flatten([{paddingLeft:6},t.textStyle]),textStyle:"SmallSecondary"},t.text))}});var Pce,_ce=f(()=>{"use strict";s();Ta();Pce=function(t){var r=t.strings;if(t.suggestionsSetHasErrors)return r.error;switch(t.suggestionsSetCompleteness){case"Empty":return r.emptyResults;case"Limited":return r.limitedResults;case"Full":return r.allResults;default:return rc(t.suggestionsSetCompleteness,"")}}});var Rce,Ace=f(()=>{"use strict";s();Rce={centeredText:{flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:10}}});var kce,Dce,wce=f(()=>{"use strict";s();oc();kce=S(re());Ace();Dce=$n(function(e){return kce.StyleSheet.create({centeredText:Rce.centeredText,secondaryLabelColor:{color:e==null?void 0:e.semanticColors.labelColor}})})});var nA,Fce,Oce,HFe,Nce=f(()=>{"use strict";s();nA=S(L()),Fce=S(re());Ul();Ece();_ce();wce();Oce=function(t){var r=Dce(t.theme);switch(t.queryStatus){case"InProgress":return nA.createElement(Ice,{text:t.strings.loading,textStyle:r.secondaryLabelColor});case"Finished":return HFe(t,r);default:return null}},HFe=function(t,r){var n=Pce(t);return nA.createElement(Fce.View,{style:r.centeredText},nA.createElement(Dp,{style:r.secondaryLabelColor,textStyle:"SmallSecondary"},n))}});function Mce(e){return e.source==="UserTypedSuggestion"}var Lce=f(()=>{"use strict";s()});var oA,Hce=f(()=>{"use strict";s();oA={suggestionInfoContainer:{flexDirection:"row",alignItems:"center"},contentContainer:{overflow:"hidden",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},image:{alignSelf:"center",marginVertical:12},descriptionContainer:{alignItems:"center",flex:1,flexDirection:"row",justifyContent:"space-between",paddingRight:12,paddingVertical:12}}});var Bce,Uce,Vce,jce,oH,Wce=f(()=>{"use strict";s();oc();Bce=S(re());oT();Hce();Uce=$n(function(e,t,r){var n=e.semanticColors;return t?{backgroundColor:r?n.menuItemBackgroundHovered:n.menuItemBackgroundPressed,borderWidth:1,borderColor:n.controlFocusedBorderColor,borderStyle:"solid"}:{backgroundColor:r?n.menuItemBackgroundHovered:n.menuBackground,borderWidth:1,borderColor:"transparent",borderStyle:"solid"}}),Vce=$n(function(e,t,r){var n=e.semanticColors;return t?{color:r?n.menuItemTextHovered:n.buttonTextPressed}:{color:r?n.menuItemTextHovered:n.buttonText}}),jce=$n(function(e,t,r){var n=e.semanticColors;return t?{color:r?n.menuItemTextHovered:n.buttonTextPressed}:{color:r?n.menuItemTextHovered:n.menuItemText}}),oH=$n(function(e){var t=e.semanticColors;return Bce.StyleSheet.create({contentContainer:Object.assign(Object.assign({},oA.contentContainer),{backgroundColor:t.menuBackground,paddingHorizontal:16,minHeight:su}),image:oA.image,descriptionContainer:Object.assign(Object.assign({},oA.descriptionContainer),{marginLeft:16})})})});function qce(e){var t=Jo.useState(!1),r=(0,zce.default)(t,2),n=r[0],o=r[1],a=ou(),d=e.onSuggestionPressed,c=e.isSelected;return Jo.createElement(Gce.TouchableHighlight,{onPress:d,accessibilityLabel:"".concat(e.name," ").concat(e.email),accessibilityActions:[{name:"Select"}],accessibilityState:{selected:c},accessibilityRole:"listitem"},Jo.createElement(Bl.View,{style:[oH(a).contentContainer,Uce(a,c,n)],onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},accessibilityState:{selected:c},accessibilityActions:[{name:"Select"}]},Jo.createElement(BFe,Object.assign({},e,{isHovered:n,isSelected:c}))))}function BFe(e){var t=e.email,r=e.name,n=e.imageSource,o=e.isSelected,a=e.onSuggestionInFocus,d=e.itemPosition,c=e.totalCount,u=e.strings,l=e.isHovered,p=l===void 0?!1:l,g=ou(),h=oH(g),v=Mce(e)?u.useThisAddress:t;return Jo.useEffect(function(){o&&a&&a("".concat(r," ").concat(t," ")+"".concat(u.selectedSuggestionAccessibilityLabel," ")+"".concat(d," ")+"".concat(u.selectedSuggestionNumberAccessibilityLabel," ")+"".concat(c,"."))},[o]),Jo.createElement(Jo.Fragment,null,Jo.createElement(pce,{accessibilityLabel:t,displayName:r,email:t,size:fce.small,source:n}),Jo.createElement(Bl.View,{style:h.descriptionContainer},Jo.createElement(Bl.View,null,Jo.createElement(Dp,{style:jce(g,o,p),textStyle:"MediumBold",numberOfLines:1},r),Jo.createElement(Dp,{style:Vce(g,o,p),textStyle:"SmallStandard",numberOfLines:1},v))))}var zce,Jo,Gce,Kce=f(()=>{"use strict";s();zce=S(ER());Zx();Jo=S(L()),Gce=S(re());Ul();Lce();Wce()});var Yce,$ce,Qce,iH,Xce=f(()=>{"use strict";s();Yce=S(Tu()),$ce=S(L()),Qce=S(re()),iH=function(e){(0,Yce.default)(t,e);function t(){return e.apply(this,arguments)||this}var r=t.prototype;return r.componentDidMount=function(){this.props.suggestionCount!=null&&this.accessAnnouncement()},r.componentDidUpdate=function(o){this.props.suggestionCount!=null&&this.props.queryStatus==="Finished"&&o.queryStatus!=="Finished"&&this.accessAnnouncement()},r.accessAnnouncement=function(){Qce.AccessibilityInfo.announceForAccessibility(this.props.suggestionCount===0?this.props.strings.emptyResults:this.props.strings.suggestionsAnnouncement+String(this.props.suggestionCount))},r.render=function(){return null},t}($ce.Component)});var Jce=f(()=>{"use strict";s();Xce()});function eue(e){var t=e.data,r=e.renderItem,n=e.onEndReached,o=e.onEndReachedThreshold,a=e.ListFooterComponent,d=e.listItemHeight,c=e.listRef,u=e.keyboardShouldPersistTaps,l=e.scrollListStyle,p=e.onContentSizeChange,g=48,h=function(y){var T=y.nativeEvent.contentSize.height,b=y.nativeEvent.contentOffset.y;b>=T-d*o-y.nativeEvent.layoutMeasurement.height&&n()};return aH.createElement(Zce.ScrollView,{scrollEventThrottle:g,ref:c,style:l,onScroll:h,keyboardShouldPersistTaps:u,onContentSizeChange:p,accessibilityRole:"list"},t.map(r),aH.createElement(a,null))}var aH,Zce,tue=f(()=>{"use strict";s();aH=S(L()),Zce=S(re());Ul()});var rue,nue,oue,iue=f(()=>{"use strict";s();oc();rue=S(re());oT();Ul();nue=$n(function(e,t,r){return Object.assign({width:e},{height:Math.min(t,tA)})}),oue=$n(function(e){return rue.StyleSheet.create({container:{flex:0,alignItems:"stretch",flexDirection:"column",minHeight:su},informationMessage:{paddingVertical:12,height:su},content:{backgroundColor:e==null?void 0:e.semanticColors.menuBackground}})})});var aue,sH,sue=f(()=>{"use strict";s();aue=S(re());oT();sH=function(t,r,n,o){if(t&&t.current)try{var a=n*o,d=a+n,c=d-Math.min(r,tA);aue.InteractionManager.runAfterInteractions(function(){var u;(u=t==null?void 0:t.current)===null||u===void 0||u.scrollTo({x:0,y:c,animated:!0})})}catch(u){}}});function due(e){var t=Xn.useRef(null),r=Xn.useRef(null),n=e.maxHeight,o=e.maxWidth,a=e.onSuggestionInFocus,d=e.onSuggestionPressed,c=e.suggestionsSet,u=e.selectedSuggestionIndex,l=e.strings,p=e.theme,g=function(){return{width:o||xce}},h=Xn.useState(g()),v=(0,dH.default)(h,2),y=v[0],T=v[1],b=Xn.useState(su),I=(0,dH.default)(b,2),E=I[0],P=I[1],_=y.width,D=Math.min(o||_,_),M=c.completeness,H=c.hasErrors,U=c.queryStatus,F=c.suggestions,z=F.length,Y=ou(),B=oue(Y),q=function(){var oe=e.onScrollEndApproaching;oe&&oe()};Xn.useEffect(function(){},[]);var K=function(oe,ie){var Ce=(ie-su)/z;P(Ce)};return Xn.useEffect(function(){var $;F&&F.length&&sH(t,n,E,Math.max(0,u)),($=e.accessibilityRef)===null||$===void 0||$.call(e,t)},[]),Xn.useEffect(function(){F&&u>-1&&u<F.length&&sH(t,n,E,u)},[u]),Xn.useEffect(function(){F&&F.length===0&&a&&a("")},[F&&F.length>0]),Xn.useEffect(function(){Tce().then(function($){$&&(r.current,void 0)})}),Xn.createElement(iA.SafeAreaView,{style:[nue(D,n,z),B.container]},Xn.createElement(iH,{queryStatus:c.queryStatus,suggestionCount:z,strings:l}),Xn.createElement(eue,{listRef:t,scrollListStyle:B.content,listItemHeight:Math.max(su,E),keyboardShouldPersistTaps:"always",onEndReached:q,onEndReachedThreshold:.5,onContentSizeChange:K,ListFooterComponent:function(){return Xn.createElement(iA.View,{style:B.informationMessage},Xn.createElement(Oce,{key:"information",queryStatus:U,suggestionsSetHasErrors:H,suggestionsSetCompleteness:M,strings:l,theme:p}))},data:F,renderItem:function(oe,ie){return Xn.createElement(qce,{id:"SuggestionInfo_"+oe.Id,suggestionRef:ie===u?r:void 0,key:oe.Id,theme:Y,email:jR(oe),isSelected:ie===u,name:oe.Name,onSuggestionInFocus:a,onSuggestionPressed:function(){return d(oe)},imageSource:oe.ImageSource,source:oe.Source,itemPosition:ie+1,totalCount:z,strings:l})}}))}var dH,Xn,iA,cue=f(()=>{"use strict";s();dH=S(ER());Zx();Xn=S(L()),iA=S(re());oT();bce();qh();Nce();Ul();Kce();Jce();tue();iue();sue()});var uue,aA,sA,UFe,VFe,cH=f(()=>{"use strict";s();uue=S(Tu()),aA=S(L());Ts();GR();Jx();cue();nH();sA=function(e){(0,uue.default)(t,e);function t(){var n;return n=e.apply(this,arguments)||this,n.id=void 0,n}var r=t.prototype;return r.componentDidMount=function(){var o=this.props,a=o.isOpen,d=o.onShow;a&&d&&d();var c=this.props.lppAppContext,u=c.clientType;(u==="OfficeiOS"||u==="OfficeAndroid"||u==="OfficeWin32")&&(this.id=setInterval(function(){return null},500))},r.componentWillUnmount=function(){this.id&&clearInterval(this.id)},r.render=function(){var o=this.props.isOpen;if(!o)return null;var a=this.props,d=a.maxHeight,c=a.maxWidth,u=a.suggestionHeight,l=a.selectedSuggestionIndex,p=a.onSuggestionInFocus,g=a.strings,h=a.suggestionsSet,v=a.onSuggestionSelected,y=a.onScrollEndApproaching,T=a.theme,b=a.onSuggestionHighlighted,I=a.suggestionListId,E=a.accessibilitySelectionRef;return aA.createElement(due,{maxHeight:d,maxWidth:c,suggestionHeight:u,selectedSuggestionIndex:l,onSuggestionPressed:v,onSuggestionInFocus:p,suggestionsSet:h,strings:g,onScrollEndApproaching:y,theme:T,suggestionListId:I,onSuggestionHighlighted:b,accessibilityRef:E})},t}(aA.Component),UFe=function(t,r){var n=r.selectedSuggestions,o=r.inputId,a=zR(t,o),d=QR(t,a,n);return Object.assign(Object.assign({},r),{currentQuery:a,suggestionsSet:d})},VFe=ea(UFe)(eA(sA))});var lue,iT,jFe,WFe,fue,pue=f(()=>{"use strict";s();lue=S(Tu()),iT=S(L());Ts();GL();GR();Jx();hce();nH();cH();jFe=function(e){(0,lue.default)(t,e);function t(){var n;return n=e.apply(this,arguments)||this,n.onCalloutDismissed=function(){var o=n.props,a=o.currentQuery,d=o.inputId,c=o.lppAppContext,u=o.onDismiss,l=o.suggestionsSet;u&&u(),XR(c,"userDismissed",d,a.length,l.suggestions.length)},n}var r=t.prototype;return r.render=function(){var o=this.props.isOpen;if(!o)return null;var a=this.props,d=a.currentQuery,c=a.maxHeight,u=a.maxWidth,l=a.suggestionHeight,p=a.strings,g=a.calloutPositioningTarget,h=a.inputId,v=a.onShow,y=a.onDismiss,T=a.calloutAnchorRectangle,b=a.onSuggestionInFocus,I=a.onSuggestionSelected,E=a.selectedSuggestions,P=a.lppAppContext,_=a.suggestionsSet,D=a.selectedSuggestionIndex,M=a.onScrollEndApproaching,H=a.theme,U=a.onSuggestionHighlighted,F=a.suggestionListId,z=a.preventDismissOnScroll,Y=a.accessibilitySelectionRef;return iT.createElement(gce,{maxHeight:c,maxWidth:u,suggestionHeight:l,onDismiss:this.onCalloutDismissed,calloutAnchorRectangle:T,calloutPositioningTarget:g,inputId:h,preventDismissOnScroll:z},iT.createElement(sA,{currentQuery:d,isOpen:o,inputId:h,maxHeight:c,maxWidth:u,suggestionHeight:l,onScrollEndApproaching:M,onSuggestionInFocus:b,onSuggestionSelected:I,onShow:v,onDismiss:y,selectedSuggestions:E,strings:p,lppAppContext:P,suggestionsSet:_,selectedSuggestionIndex:D,theme:H,suggestionListId:F,onSuggestionHighlighted:U,accessibilitySelectionRef:Y}))},t}(iT.Component),WFe=function(t,r){var n=r.selectedSuggestions,o=r.inputId,a=zR(t,o),d=QR(t,a,n);return Object.assign(Object.assign({},r),{currentQuery:a,suggestionsSet:d})},fue=ea(WFe)(eA(jFe))});var ic,kn,Sa,uH=f(()=>{"use strict";s();(function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"})(ic||(ic={}));(function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.RequiredDiagnosticData=10]="RequiredDiagnosticData",e[e.OptionalDiagnosticData=100]="OptionalDiagnosticData",e[e.RequiredServiceData=110]="RequiredServiceData",e[e.AlwaysOnRequiredServiceData=120]="AlwaysOnRequiredServiceData"})(kn||(kn={}));(function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"})(Sa||(Sa={}))});function mue(e,t){return t===void 0&&(t=[]),function(r){var n=e(r.event,r.additionalProperties,r.eventNameOverride);if(n){var o;Array.isArray(n)?o=n.map(function(d){return{awtEventData:d,dataCategories:ic.NotSet,diagnosticLevel:kn.OptionalDiagnosticData}}):o=[{awtEventData:n,dataCategories:ic.NotSet,diagnosticLevel:kn.OptionalDiagnosticData}];var a=o;return t.forEach(function(d){a=o2(a,function(c){return d(r.event,c)})}),a}}}var aT=f(()=>{"use strict";s();tc();uH()});function sT(e){return"exportOptions"in e&&!!(e.exportOptions&&e.exportOptions.exportType==="UserInteraction")}var lH=f(()=>{"use strict";s()});var zFe,GFe,fH,gue=f(()=>{"use strict";s();aT();lH();zFe=console.log,GFe=function(){function e(t,r,n,o,a,d){r===void 0&&(r="NO_USER"),n===void 0&&(n="NO_USER"),o===void 0&&(o="NO_TENANT"),a===void 0&&(a="NO_REGION"),d===void 0&&(d=zFe),this.eventMapper=t,this._userAadObjectId=r,this._userPuid=n,this._tenantAadObjectId=o,this._lokiRegion=a,this.consoleLog=d}return e.prototype.getCommonProperties=function(t){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:sT(t),isConsoleLogger:!0}},e.prototype.canConsumeEvent=function(t){return!0},e.prototype.consume=function(t){var r=this;if(t){var n=this.getCommonProperties(t),o=this.eventMapper({event:t,additionalProperties:n});if(!o){this.consoleLog(JSON.parse(JSON.stringify(t)));return}Array.isArray(o)||(o=[o]),o.forEach(function(a){var d,c=(d=a.awtEventData.properties)===null||d===void 0?void 0:d.eventId;try{var u=a.awtEventData.properties.properties&&JSON.parse(a.awtEventData.properties.properties);u&&(a.awtEventData.properties.properties=u)}catch(l){}r.consoleLog("%cLog: ".concat(a.awtEventData.name||a.awtEventData.Name," ").concat(c?"| ".concat(c):""," | Level: ").concat(kn[a.diagnosticLevel]," | Category: ").concat(ic[a.dataCategories]||a.dataCategories,"\n"),"font-weight: bold",a)})}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){},e}(),fH=GFe});var wp,dA=f(()=>{"use strict";s();wp={CLIENT_TIMESTAMP:"ClientTimeStamp",TRANSACTION_ID:"QoSTransactionId",SOURCE_CORRELATION_ID:"SourceCorrelationId"}});var qFe,KFe,YFe,dT,hue=f(()=>{"use strict";s();Fx();dA();qFe=32,KFe=100,YFe=function(){function e(t,r,n,o){this._source=t,this._version=r,this._properties=o||{},this._clientCorrelationId=n&&n.trim()||"",(this._clientCorrelationId.length<qFe||this._clientCorrelationId.length>KFe)&&(this._clientCorrelationId=Oo(),n&&(this._properties[wp.SOURCE_CORRELATION_ID]=n))}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clientCorrelationId",{get:function(){return this._clientCorrelationId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._properties},enumerable:!1,configurable:!0}),e}(),dT=YFe});var $Fe,cT,yue=f(()=>{"use strict";s();$Fe=function(){function e(t){this.consumers=t||[]}return e.prototype.broadcastEvent=function(t){t&&this.consumers.forEach(function(r){r.canConsumeEvent(t)&&r.consume(t)})},e.prototype.broadcastFlush=function(){return Promise.all(this.consumers.map(function(t){return t.flush()})).then()},e.prototype.broadcastDestroy=function(){this.consumers.forEach(function(t){t.destroy()})},e.prototype.registerConsumer=function(t){this.consumers.push(t)},e}(),cT=$Fe});var Qh,pH=f(()=>{"use strict";s();Qh="Unknown"});var du,mH=f(()=>{"use strict";s();du={START:"Start",SUCCESS:"Success",EXPECTED_FAILURE:"ExpectedFailure",UNEXPECTED_FAILURE:"UnexpectedFailure",MONITOR_IN_INVALID_STATE:"MonitorInInvalidState"}});function uT(e){return QFe.indexOf(e)>-1}function lT(e){return XFe.indexOf(e)===-1}var QFe,XFe,gH=f(()=>{"use strict";s();QFe=["Network","RESTAuthToken","TTLCacheUtils","BundleDownload","OfficeFeedIsReadyStatus","OfficeFeedVerbose"],XFe=["Stikkontakt","DataLoadStartAction","NoLogging","None"]});var JFe,Cue,vue=f(()=>{"use strict";s();k();Fx();nc();pH();dA();mH();gH();JFe=function(){function e(t,r,n,o,a,d,c){this.eventHubPromise=t,this.monitoringData=r,this.scenarioName=n,this.featureName=o,this.staticProperties=a,this.lookupError=d,this.isVerboseLoggingEnabled=c,this.isFinished=!1,this.isInvalid=!1,this.lastScenarioState=du.MONITOR_IN_INVALID_STATE,this.transactionId=Oo(),this.start()}return e.prototype.flush=function(){return this.eventHubPromise.then(function(t){return t.broadcastFlush()})},e.prototype.success=function(t,r){this.endEvent(t,du.SUCCESS,r)},e.prototype.expectedFailure=function(t,r){this.endEvent(t,du.EXPECTED_FAILURE,r)},e.prototype.unexpectedFailure=function(t,r){this.endEvent(t,du.UNEXPECTED_FAILURE,r)},e.prototype.dispose=function(){this.isInvalid||!this.isFinished?this.broadcastEvent(void 0,du.MONITOR_IN_INVALID_STATE):this.broadcastEvent(this.lastTag,this.lastScenarioState,this.lastProperties)},e.prototype.start=function(){this.startTime=new Date().getTime()},e.prototype.endEvent=function(t,r,n){this.isFinished&&(this.isInvalid=!0),this.startTime?(this.duration=new Date().getTime()-this.startTime,this.lastScenarioState=r):this.lastScenarioState=du.MONITOR_IN_INVALID_STATE,this.lastTag=t,this.lastProperties=n,this.isFinished=!0,this.dispose()},e.prototype.broadcastEvent=function(t,r,n){return Wt(this,void 0,void 0,function(){var o,a,d,c,u,l;return pt(this,function(p){switch(p.label){case 0:return!lT(this.featureName)||uT(this.featureName)&&!this.isVerboseLoggingEnabled?[2]:this.scenarioName&&this.monitoringData.source&&this.monitoringData.clientCorrelationId?(o=t?"".concat(this.scenarioName,"_").concat(r,"_").concat(t):"".concat(this.scenarioName,"_").concat(r),[4,this.eventHubPromise]):[3,5];case 1:return a=p.sent(),c=(d=a).broadcastEvent,l={eventId:o,version:this.monitoringData.version?this.monitoringData.version:Qh,type:"QoS"},n&&kr(n.midgardError)?[4,this.lookupError(n.midgardError)]:[3,3];case 2:return u=p.sent(),[3,4];case 3:u=void 0,p.label=4;case 4:c.apply(d,[(l.midgardError=u,l.source=this.monitoringData.source,l.featureName=this.featureName,l.clientCorrelationid=this.monitoringData.clientCorrelationId,l.qosScenarioName=this.scenarioName,l.qosEventType=r,l.qosTagId=t===null?void 0:t,l.duration=this.duration,l.properties=this.getProperties(n),l)]),p.label=5;case 5:return[2]}})})},e.prototype.getProperties=function(t){var r;return m(m(m(m({},t),(r={},r[wp.CLIENT_TIMESTAMP]=new Date().getTime().toString(),r[wp.TRANSACTION_ID]=this.transactionId,r)),this.monitoringData.properties),this.staticProperties())},e}(),Cue=JFe});var ZFe,fT,xue=f(()=>{"use strict";s();k();nc();pH();dA();mH();vue();gH();ZFe=function(){function e(t,r,n,o){var a=this;this.eventHubPromise=t,this.monitoringData=r,this.logVerbose=n,this.staticProperties=o,this.errorMap={},this.registerErrors=function(d,c){a.errorMap[d]=m({},c)},this.logEUPL=function(d,c,u,l){var p=du.SUCCESS,g="".concat(d,"_").concat(p);a.eventHubPromise.then(function(h){return h.broadcastEvent({eventId:g,version:a.monitoringData.version?a.monitoringData.version:Qh,type:"EUPL",source:a.monitoringData.source,featureName:c,clientCorrelationid:a.monitoringData.clientCorrelationId,qosScenarioName:d,qosEventType:p,qosTagId:void 0,duration:u,properties:a.getProperties(l)})})},this.logQoS=function(d,c,u,l,p,g,h,v){if(!(!lT(l)||uT(l)&&!a.logVerbose())){var y=g?"".concat(d,"_").concat(c,"_").concat(g):"".concat(d,"_").concat(c);a.eventHubPromise.then(function(T){return T.broadcastEvent({eventId:y,version:a.monitoringData.version?a.monitoringData.version:Qh,type:"QoS",midgardError:v&&kr(v.midgardError)?a.lookupError(v.midgardError):void 0,source:a.monitoringData.source,featureName:l,clientCorrelationid:a.monitoringData.clientCorrelationId,qosScenarioName:d,qosEventType:c,qosTagId:g===null?void 0:g,duration:p,properties:a.getProperties(m(m({},v),{result:u,RequestId:h}))})})}}}return e.prototype.startMonitor=function(t,r){var n=this;return new Cue(this.eventHubPromise,this.monitoringData,t,r,function(){return n.staticProperties()},function(o){return Promise.resolve(n.lookupError(o))},this.logVerbose())},e.prototype.logEvent=function(t){this.log(t,"Event")},e.prototype.logUserInteractionEvent=function(t){var r={exportType:"UserInteraction",exportName:t.eventId};t=m(m({},t),{exportOptions:r}),this.log(t,"Event")},e.prototype.logError=function(t){this.log(t,"Error")},e.prototype.logTrace=function(t){this.log(t,"Trace")},e.prototype.flush=function(){return this.eventHubPromise.then(function(t){return t.broadcastFlush()})},e.prototype.destroy=function(){return this.eventHubPromise.then(function(t){return t.broadcastDestroy()})},e.prototype.setEventHub=function(t){this.eventHubPromise=Promise.resolve(t)},e.prototype.getEventHub=function(){return this.eventHubPromise},e.prototype.getStaticProperties=function(){return this.staticProperties},e.prototype.setStaticProperties=function(t){this.staticProperties=t},e.prototype.lookupError=function(t){if(!kr(t))return"Invalid midgardError";var r=this.errorMap[t.family];if(!r)return"Unknown family ".concat(t.family,": ").concat(t.code);var n=r[t.code];return n?"".concat(t.family,": ").concat(n):"Unknown code: ".concat(t.family,": ").concat(t.code)},e.prototype.log=function(t,r){lT(t.featureName)&&(!uT(t.featureName)||this.logVerbose())&&this.broadcastEvent(t.eventId,t.featureName,r,t.exportOptions,t.properties,t.diagnosticLevel)},e.prototype.broadcastEvent=function(t,r,n,o,a,d){if(t&&this.monitoringData.source&&this.monitoringData.clientCorrelationId){var c={eventId:t,version:this.monitoringData.version?this.monitoringData.version:Qh,type:n,midgardError:a&&kr(a.midgardError)?this.lookupError(a.midgardError):void 0,source:this.monitoringData.source,featureName:r,clientCorrelationid:this.monitoringData.clientCorrelationId,qosScenarioName:void 0,qosEventType:void 0,qosTagId:void 0,duration:void 0,exportOptions:o,properties:this.getProperties(a)},u=d?m(m({},c),{diagnosticLevel:d}):c;this.eventHubPromise.then(function(l){return l.broadcastEvent(u)})}},e.prototype.getProperties=function(t){var r;return m(m(m((r={},r[wp.CLIENT_TIMESTAMP]=new Date().getTime().toString(),r),this.monitoringData.properties),this.staticProperties()),t)},e}(),fT=ZFe});function Tue(){return new e1e}var e1e,bue=f(()=>{"use strict";s();e1e=function(){function e(){}return e.prototype.flush=function(){return Promise.resolve()},e.prototype.success=function(t,r){},e.prototype.expectedFailure=function(t,r){},e.prototype.unexpectedFailure=function(t,r){},e}()});var Xir,Sue=f(()=>{"use strict";s();bue();Xir=function(){function e(){}return e.prototype.startMonitor=function(t,r,n){return Tue()},e.prototype.logEvent=function(){},e.prototype.logUserInteractionEvent=function(){},e.prototype.logError=function(){},e.prototype.logQoS=function(){},e.prototype.logTrace=function(){},e.prototype.logEUPL=function(){},e.prototype.log=function(){},e.prototype.flush=function(){return Promise.resolve()},e.prototype.setEventHub=function(){},e.prototype.getStaticProperties=function(){return function(){return{}}},e.prototype.setStaticProperties=function(){},e.prototype.registerErrors=function(){},e}()});var Iue=be(Xh=>{"use strict";s();Object.defineProperty(Xh,"__esModule",{value:!0});var t1e;(function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"})(t1e=Xh.AWTUserIdType||(Xh.AWTUserIdType={}));var r1e;(function(e){e[e.Started=0]="Started",e[e.Ended=1]="Ended"})(r1e=Xh.AWTSessionState||(Xh.AWTSessionState={}))});var cA,Eue=f(()=>{"use strict";s();cA=S(Iue())});var pT=f(()=>{"use strict";s();gue();hue();yue();xue();Uh();Sue()});var Ia,Pue=f(()=>{"use strict";s();(function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"})(Ia||(Ia={}))});function hH(e){switch(e){case"Df":return Ia.Dogfood;case"Msit":return Ia.MSIT;case"Blackforest":return Ia.Blackforest;case"GccModerate":return Ia.GccModerate;case"GccHigh":return Ia.GccHigh;case"DoD":return Ia.DOD;case"Gallatin":return Ia.Gallatin;case"Prod":return Ia.TopLevel;case"AG08":return Ia.AG08;case"AG09":return Ia.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}var _ue=f(()=>{"use strict";s();Pue()});var Rue=f(()=>{"use strict";s();_ue()});var kue=be(uA=>{"use strict";s();var Aue=(Ml(),Vk(dne)).compose;uA.__esModule=!0;uA.composeWithDevTools=function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Aue:Aue.apply(null,arguments)};uA.devToolsEnhancer=function(){return function(e){return e}}});var xe,Due,yH,wue=f(()=>{"use strict";s();xe={Generic:"",GDPR:""},Due={Prod:{Generic:"33d70a864599496b982a39f036f71122-2064703e-3a9d-4d90-8362-eec08dffe8e8-7176",GDPR:""},Dev:{Generic:"ceb930c7c5d041e899b6de945bc4c6ee-e9ee0db4-0fa5-437b-966d-e8b2950f8d7d-7290",GDPR:""},Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},yH={LivePeopleCards:{Prod:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-9277d376-40b1-48ec-92f5-b2ee3f44345b-7212",GDPR:"f615f561ec88437db01f752caf151695-7cf4617b-dcbd-4b5b-a5eb-0079c1ba008a-6975"},Dev:xe,Blackforest:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-eb71f759-e748-47d9-922a-96d2522430e4-7094",GDPR:"f615f561ec88437db01f752caf151695-18332f16-126d-42b9-a2f4-2dd55a1ec030-6918"},GccHigh:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-5bace7e6-5357-46f3-88e0-449f4eaacb40-7215",GDPR:"f615f561ec88437db01f752caf151695-d48bf8b4-e399-433b-bb04-f0d344722fe4-7383"},DoD:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-7e485978-0dca-4684-abdd-5bcebedd8f2f-7631",GDPR:"f615f561ec88437db01f752caf151695-e653e3c7-d1be-444c-832d-d3707d03bbcd-6862"},Gallatin:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-99d02291-5114-42b3-aa94-ddd964108c06-7145",GDPR:"f615f561ec88437db01f752caf151695-9728472d-c6e2-4067-a597-f0a9e261a858-6852"},AG08:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-e74e132e-f357-44eb-a0b7-941458772fc3-6908",GDPR:"f615f561ec88437db01f752caf151695-c0a58d75-92c7-4136-ac9f-a689166bf700-6735"},AG09:{Generic:"a1bde8e78ab14b6198caa18be9d3126e-17844c21-72d2-418f-b188-8088d55ab78e-7408",GDPR:"f615f561ec88437db01f752caf151695-2bb48ba5-f1c5-459d-978e-4cc61a974ec3-6762"},EU:xe},LivePersonaPicker:{Prod:{Generic:"67199ce661b3472494bbec0bf2e06c27-c34071ab-96bc-40d9-9162-7a83b521b4dd-7282",GDPR:"30b97846c6c640ed90e3b4e06d98a986-b6251ed6-9d7f-4e24-8ace-044e9613d08b-7662"},Dev:xe,Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},OfficeFeed:{Prod:{Generic:"60dd0301e6c846e9b0699cbbe259efb6-c35f87eb-1000-4625-8cab-d2dd316a0ea6-7539",GDPR:"dc2f4eb67f454d4187656e6aa9063e83-ed148abb-5cbb-42bd-9cfc-298b1dd8c444-7942"},Dev:xe,Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},LivePersonaEditor:{Prod:{Generic:"77af0c0ae9af49e684693d42352c0cf7-9d604ea0-ea41-4c75-8897-d7dbb0c7f7e9-7006",GDPR:"d2aac9418005423daf110f7008485383-d48b2953-983d-4b8b-857a-9f724d685b97-7218"},Dev:xe,Blackforest:{Generic:"77af0c0ae9af49e684693d42352c0cf7-2c4a13e2-2fef-4ba6-a12a-a369ed907ff9-7140",GDPR:"d2aac9418005423daf110f7008485383-b85d1253-d229-42c8-9cf6-b8ae20c4b61b-7439"},GccHigh:{Generic:"77af0c0ae9af49e684693d42352c0cf7-8b12b5b0-234b-4f96-a57b-dcf09a10401e-7221",GDPR:"d2aac9418005423daf110f7008485383-ee34f80b-d66c-4c0a-9a75-bd32d151a28d-7184"},DoD:{Generic:"77af0c0ae9af49e684693d42352c0cf7-48932264-dbbc-45fe-9173-0ace4b216b7a-7229",GDPR:"d2aac9418005423daf110f7008485383-5cb0db99-dc8f-4b1e-9076-43821ee4622f-7316"},Gallatin:{Generic:"77af0c0ae9af49e684693d42352c0cf7-531738b2-25b2-424a-b4a8-20fbdae1eed8-7390",GDPR:"d2aac9418005423daf110f7008485383-583a5fc4-1880-4f24-afe4-96ebcba895d1-7235"},AG08:xe,AG09:xe,EU:xe},MicrosoftSearch:Due,MicrosoftSearch3S:Due,OrgExplorer:{Prod:{Generic:"4ed6dab22bbc45efbd6427253faa4673-1052ea5c-f672-4ea9-a7c9-da17fc53f249-7272",GDPR:""},Dev:xe,Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:{Generic:"4ed6dab22bbc45efbd6427253faa4673-1052ea5c-f672-4ea9-a7c9-da17fc53f249-7272",GDPR:""}},NamePronunciation:{Prod:{Generic:"cdba0d01d3c24f188e55845778e5505d-a9c8b79c-ea70-49e9-9352-507b2a8df76f-6790",GDPR:""},Dev:{Generic:"c47a2f5cb4e24f409e35cef5e23ac962-73b83934-404c-41d4-b3f1-2296bb746aa1-7252",GDPR:""},Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},CortexTopics:{Prod:{Generic:"8f7cccc3c534426e8894f45b76e666b9-b80f2549-ddb1-4588-8602-f54037a070e7-7552",GDPR:""},Dev:xe,Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},EmbeddedOrgChart:{Prod:{Generic:"c1ad6239a4cd4efbb5427a8c14cc89fc-cf33fa48-963e-411b-b007-829fc329adea-7223",GDPR:"6ba9d88a8df4434c89bac4e8f9e31e7e-ca849317-67e5-434a-a207-2b270c0715e6-7054"},Dev:xe,Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},GraphLoop:{Prod:{Generic:"0b9ecc7b7e834bf187902769b46094a5-91edd6e2-c1c7-4a32-970b-ee3285ab394c-6877",GDPR:""},Dev:{Generic:"4a67ed1bd82e40c9af5fed95d457c2b7-d0bad78c-babb-44d1-9b31-5e32c2cc3d98-7303",GDPR:""},Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe},CardLoop:{Prod:{Generic:"78a9315a99bf4c5285101c1864da2e87-546eda6a-798d-4dd6-bea4-ca5713e12d63-6907",GDPR:""},Dev:{Generic:"4176a80892374dd0acaa8eb943c5dd33-6b278dd4-fa10-4100-a804-9dfc2322f668-7573",GDPR:""},Blackforest:xe,GccHigh:xe,DoD:xe,Gallatin:xe,AG08:xe,AG09:xe,EU:xe}}});var n1e,Fue,Oue=f(()=>{"use strict";s();k();lH();n1e=function(){function e(t,r,n,o,a,d){var c=this;this.sendTelemetryEvent=t,this.eventMapper=r,this.getEventName=n,this.makeDoubleDataField=o,this.makeStringDataField=a,this.makeBooleanDataField=d,this._userAadObjectId="NO_USER",this._userPuid="NO_USER",this._tenantAadObjectId="NO_TENANT",this._lokiRegion="NO_REGION",this.getEventDataFields=function(u){for(var l=[],p=u.properties||{},g=0,h=Object.keys(p);g<h.length;g++){var v=h[g];if(v){var y=p[v];switch(typeof y){case"number":l.push(c.makeDoubleDataField(v,y));break;case"string":l.push(c.makeStringDataField(v,y));break;case"boolean":l.push(c.makeBooleanDataField(v,y));break;case"function":case"object":case"symbol":case"undefined":case"bigint":break;default:""+typeof y}}}return l}}return e.prototype.canConsumeEvent=function(t){return!!t},e.prototype.consume=function(t){var r,n=this.getCommonProperties(t),o=sT(t);if(o){var a=this.eventMapper({event:t,additionalProperties:n,eventNameOverride:(r=t.exportOptions)===null||r===void 0?void 0:r.exportName});this.log(a,!0)}var d=this.eventMapper({event:t,additionalProperties:n});this.log(d,!1)},e.prototype.log=function(t,r){var n=this;if(t)if(Array.isArray(t))t.forEach(function(d){var c=d.awtEventData,u=Ke(d,["awtEventData"]);n.sendTelemetryEvent(n.getEventName(c,r),n.getEventDataFields(c),u)});else{var o=t.awtEventData,a=Ke(t,["awtEventData"]);this.sendTelemetryEvent(this.getEventName(o,r),this.getEventDataFields(o),a)}},e.prototype.flush=function(){return Promise.resolve()},e.prototype.destroy=function(){},Object.defineProperty(e.prototype,"userAadObjectId",{set:function(r){r&&(this._userAadObjectId=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userPuid",{set:function(r){r&&(this._userPuid=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenantAadObjectId",{set:function(r){r&&(this._tenantAadObjectId=r)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lokiRegion",{set:function(r){r&&(this._lokiRegion=r)},enumerable:!1,configurable:!0}),e.prototype.getCommonProperties=function(t){return{userAadObjectId:this._userAadObjectId,userPuid:this._userPuid,tenantAadObjectId:this._tenantAadObjectId,lokiRegion:this._lokiRegion,isGDPREvent:sT(t)}},e}(),Fue=n1e});function i1e(e,t,r){return!!t&&!!e&&!!r}function Nue(e,t,r){return i1e(e,t,r)?{userAadObjectId:e||"",tenantAadObjectId:t||"",userPuid:r||""}:o1e}function Mue(e){switch(e){case"https://df.loki.delve.office.com/":return"df";case"https://msit.loki.delve.office.com/":return"msit";case"NO_REGION":return"NO_RING";default:return"prod"}}var o1e,CH=f(()=>{"use strict";s();o1e={userAadObjectId:"",tenantAadObjectId:"",userPuid:""}});var vH=be((Dar,Lue)=>{s();Lue.exports=OfficePlatformGlobal.Telemetry.OTel});function Hue(e){switch(e){case kn.RequiredDiagnosticData:return Ei.DiagnosticLevel.BasicEvent;case kn.OptionalDiagnosticData:return Ei.DiagnosticLevel.FullEvent;case kn.RequiredServiceData:return Ei.DiagnosticLevel.NecessaryServiceDataEvent;case kn.AlwaysOnRequiredServiceData:return Ei.DiagnosticLevel.AlwaysOnNecessaryServiceDataEvent;case kn.ReservedDoNotUse:throw new Error("Reserved Diagnostic Level not expected. Please change level immediately.");default:return rc(e,Ei.DiagnosticLevel.FullEvent)}}function Bue(e){switch(e){case Sa.NotSet:return Ei.SamplingPolicy.NotSet;case Sa.Measure:return Ei.SamplingPolicy.Measure;case Sa.Diagnostics:return Ei.SamplingPolicy.Diagnostics;case Sa.CriticalBusinessImpact:return Ei.SamplingPolicy.CriticalBusinessImpact;case Sa.CriticalCensus:return Ei.SamplingPolicy.CriticalCensus;case Sa.CriticalExperimentation:return Ei.SamplingPolicy.CriticalExperimentation;case Sa.CriticalUsage:return Ei.SamplingPolicy.CriticalUsage;default:return rc(e,Ei.SamplingPolicy.NotSet)}}var Ei,Uue=f(()=>{"use strict";s();Ta();uH();Ei=S(vH())});var jue=be((Lar,Vue)=>{s();Vue.exports=OfficePlatformGlobal.Telemetry.OTelSDX});function Wue(e){return e===a1e}function zue(e){var t=e.appName,r=e.tenantAadObjectId,n=e.userPuid,o=e.userAadObjectId;return{"UserInfo.Id":Wue(r)?n:o,"UserInfo.MsaId":n,"UserInfo.IdType":Wue(r)?cA.AWTUserIdType.MSAPUID:cA.AWTUserIdType.UserObjectId,"UserInfo.OMSTenantId":r,"AppInfo.Name":t}}function Dr(e,t){var r=e[t];return Array.isArray(r)||typeof r=="object"?JSON.stringify(r):r===!1||r===0?r:r||""}function Gue(e){e.properties=d2(e.properties,function(t){return t==null||t===""})}var a1e,xH=f(()=>{"use strict";s();tc();Eue();a1e="84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"});function que(e){var t={name:"Event"};return e&&(t.properties={eventId:e}),t}function Kue(e){var t=e.event,r=e.properties;return{name:"QoSEvent",properties:{rootCorrelationId:Dr(r,"RequestId"),qosScenarioName:t.qosScenarioName||"",qosEventType:t.qosEventType||"",qosTagId:t.qosTagId||"",duration:t.duration!==void 0&&t.duration!==null?t.duration.toString():"",statusCode:Dr(r,"StatusCode"),midgardError:t.midgardError||"",retryAttemptedAfterAuthFailure:Dr(r,"RetryAttemptedAfterAuthFailure"),lokiVersion:Dr(r,"x-serverversion"),serverInboundDuration:Dr(r,"x-inboundduration"),serverCorrelationId:Dr(r,"x-correlationid"),serverDatacenter:Dr(r,"x-datacenter"),hostAppRing:Dr(r,"hostAppRing"),isWebSocketRequest:Dr(r,"iswebsocketrequest")}}}var Yue=f(()=>{"use strict";s();xH()});function $ue(e){var t={};return Lc(e.requiredEvents).forEach(function(r){var n=e.requiredEvents[r];t[r]=new Set(e.requiredEvents[r].properties||[])}),function(r,n){var o=n.awtEventData.name;if(!o)return[n];if(n.diagnosticLevel!==kn.RequiredDiagnosticData||!n.awtEventData.properties)return[n];var a=Ix(n.awtEventData.properties,function(d,c){var u=t[o].has(c);return u});return[m(m({},n),{awtEventData:m(m({},n.awtEventData),{properties:a})})]}}var Que=f(()=>{"use strict";s();k();tc();aT()});function Xue(e){return function(t,r){var n=r.awtEventData.name;return n?e.requiredEvents[n]?[m(m({},r),{diagnosticLevel:kn.RequiredDiagnosticData})]:e.rsdEvents[n]?[m(m({},r),{diagnosticLevel:kn.RequiredServiceData})]:[m(m({},r),{diagnosticLevel:kn.OptionalDiagnosticData})]:[m(m({},r),{diagnosticLevel:kn.OptionalDiagnosticData})]}}var Jue=f(()=>{"use strict";s();k();aT()});var lA={};Ey(lA,{requiredEvents:()=>l1e,rsdEvents:()=>f1e});var cu,s1e,d1e,c1e,u1e,l1e,f1e,Zue=f(()=>{"use strict";s();cu=["AppInfo.Name","clientCorrelationId","ClientTimeStamp","clientType","eventId","eventType","exportName","exportType","hostAppName","hostAppPlatform","region","ring","suggestionListCorrelationId","UserInfo.Id","UserInfo.IdType","UserInfo.MsaId","UserInfo.OMSTenantId","version"],s1e=["Feature","QoSTransactionId","RequestId","duration","qosEventType","qosScenarioName","rootCorrelationId"],d1e=["duration","componentName"],c1e=["didSearchDirectory","queryLength","responseLength"],u1e=["RequestId","didMakeAuthTokenRequest","didMakeConfigRequest","durationWaitingOnAuthToken","isWebSocketRequest","iswebsocketrequest","lokiVersion","rootCorrelationId:","serverCorrelationId:","serverDatacenter:","serverInboundDuration:","x-beserver","x-correlationid","x-datacenter","x-inboundduration","x-serverversion"],l1e={ConfigurationSetAction:{properties:cu},QueryChangedAction:{properties:cu},PickerDismissedAction:{properties:cu},SuggestionPressedAction:{properties:cu},InitializationSuccessful:{properties:cu},InitializationFailed:{properties:cu},AdditionalSuggestionsRequestedAction:{properties:cu}},f1e={QoSEvent:{properties:Object.assign(Object.assign(Object.assign(Object.assign({},cu),s1e),c1e),u1e)},EUPLEvent:{properties:Object.assign(Object.assign({},cu),d1e)}}});function m1e(e){Object.keys(e).forEach(function(t){p1e.test(t)||delete e[t]})}function g1e(e,t,r){var n=t.userAadObjectId,o=t.userPuid,a=t.tenantAadObjectId,d=t.lokiRegion,c=Object.assign({},e.properties),u="",l="";if(e.exportOptions&&(u=e.exportOptions.exportType,l=e.exportOptions.exportName),e.featureName!=="TTLCacheUtils"){var p={event:e,exportType:u,exportName:l,lokiRegion:d},g,h=v1e(e);switch(h){case"QoSEvent":g=Kue(Object.assign(Object.assign({},p),{properties:c}));break;case"PerceivedLatency":g=T1e(p.event,c);break;case"Generic":g=que(e.eventId);break;default:}r&&(g.name=r);var v=Object.assign(Object.assign({},x1e(p)),zue({appName:"Live Persona Picker",tenantAadObjectId:a,userAadObjectId:n,userPuid:o})),y=JSON.parse(JSON.stringify(e.properties));return h==="QoSEvent"&&m1e(y),g.properties=ed(g.properties||{},y),g.properties=ed(g.properties||{},Object.assign({},v)),Gue(g),g}}function C1e(e){return ic.ProductServiceUsage|ic.ProductServicePerformance}function v1e(e){return e.type==="EUPL"?"PerceivedLatency":e.type==="QoS"?"QoSEvent":"Generic"}function x1e(e){var t=e.event,r=e.exportType,n=e.exportName,o=e.lokiRegion,a=t.properties;return{clientCorrelationId:t.clientCorrelationid,suggestionListCorrelationId:a&&Dr(a,"suggestionListCorrelationId").toString()||"",clientType:t.source,version:t.version,eventId:t.eventId,hostAppVersion:a&&Dr(a,"hostAppVersion").toString()||"",hostAppRing:a&&Dr(a,"hostAppRing").toString()||"",hostAppName:a&&Dr(a,"hostAppName").toString()||"",hostAppPlatform:a&&Dr(a,"hostAppPlatform").toString()||"",complianceEnvironment:a&&Dr(a,"complianceEnvironment").toString()||"",hostAppCorrelationId:a&&Dr(a,"SourceCorrelationId").toString()||"",queryLength:a&&Dr(a,"queryLength").toString()||"",responseLength:a&&Dr(a,"responseLength").toString()||"",didSearchDirectory:a&&Dr(a,"didSearchDirectory").toString()||"",infoBarrierSegmentsCount:a&&Dr(a,"infoBarrierSegmentsCount").toString()||"",exportType:r,exportName:n,eventType:t.type,region:o,ring:Mue(o),clientTelemetryCollectorUrl:""}}function T1e(e,t){return{name:"PerceivedLatency",properties:{componentName:Dr(t,"componentName"),duration:e.duration!==void 0?e.duration.toString():"",renderCount:Dr(t,"renderCount"),finishedLoading:Dr(t,"finishedLoading"),sourceCorrelationId:Dr(t,"SourceCorrelationId")}}}var p1e,h1e,y1e,TH,ele=f(()=>{"use strict";s();Ta();Yue();aT();Que();Jue();xH();CH();Zue();p1e=/^[a-zA-Z0-9_\.]*$/;h1e=function(t,r){return[Object.assign(Object.assign({},r),{dataCategories:C1e(t)})]},y1e=function(t,r){return[Object.assign(Object.assign({},r),{samplingPolicy:Sa.Measure})]};TH=mue(g1e,[Xue(lA),h1e,y1e,$ue(lA)])});function rle(){var e=new Ea.TelemetryLogger;return e.addSink((0,tle.createOTelSink)()),e.setTenantTokens({Office:{LivePersonaPicker:{ariaTenantToken:yH.LivePersonaPicker.Prod.Generic,nexusTenantToken:b1e,UserActions:{ariaTenantToken:yH.LivePersonaPicker.Prod.GDPR,nexusTenantToken:S1e}}}}),e}var Ea,tle,mT,b1e,S1e,fA,gT,I1e,E1e,nle=f(()=>{"use strict";s();pT();wue();Oue();CH();Uue();Ea=S(vH()),tle=S(jue());ele();mT=void 0,b1e=1791,S1e=1792,fA=function(){mT=mT||rle()},gT=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(r)return new fH(TH);var n=new Fue(I1e,TH,E1e,Ea.makeDoubleDataField,Ea.makeStringDataField,Ea.makeBooleanDataField);if(t){var o=t.UserAadObjectId,a=t.TenantAadObjectId,d=t.UserPuid,c=t.LokiUrl,u=Nue(o==null?void 0:o.Value,a==null?void 0:a.Value,d);n.userAadObjectId=u.userAadObjectId,n.userPuid=u.userPuid,n.tenantAadObjectId=u.tenantAadObjectId,c&&(n.lokiRegion=c)}return n};I1e=function e(t,r,n){mT||(mT=rle(),console.error("".concat(fA.name," call required before ").concat(e.name," calls"))),mT.sendTelemetryEvent({eventName:t,dataFields:r,eventFlags:{diagnosticLevel:Hue(n.diagnosticLevel),samplingPolicy:n.samplingPolicy?Bue(n.samplingPolicy):Ea.SamplingPolicy.NotSet,dataCategories:Ea.DataCategories.ProductServiceUsage|Ea.DataCategories.ProductServicePerformance}})},E1e=function(t,r){var n;return r?"Office.LivePersonaPicker.UserActions.".concat(((n=t.properties)===null||n===void 0?void 0:n.exportName)||"UserActionsExported"):t.name?"Office.LivePersonaPicker.".concat(t.name.replace(/_/g,".")):"Office.LivePersonaPicker.Events"}});var bH=f(()=>{"use strict";s();nle()});function ole(e){return"".concat(Mo,"-").concat(e)}var Mo,pA=f(()=>{"use strict";s();Mo="LivePersonaPicker"});var Fp,mA=f(()=>{"use strict";s();Fp="1.20240227.9.0"});function ile(){return!0}var ale=f(()=>{"use strict";s()});function SH(e,t,r){return gA(this,void 0,void 0,function*(){return yield Bse({providerConfig:t,id:ole(e),version:Fp,getLokiDomain:r})})}function sle(e,t,r,n,o,a){return{logger:t,getAuthToken:function(){return e.getAuthToken(r)},forceRefreshAuthToken:function(){return e.forceRefreshAuthToken(r)},updateAuthTokenTtl:function(c){return e.updateAuthTokenTtl(c)},settings:{isSharedMailboxEnabled:!1,useLocalLokiOnCloudService:!1,isOfflineMode:!1,isGetPostConversionDisabled:ile()},clientFeature:Mo,hostAppConfiguration:{consumerCorrelationId:r,contextType:"",source:n,options:{hostAppRing:o,hostAppVersion:a}},BUILD_VERSION:Fp}}function IH(e,t,r){return gA(this,void 0,void 0,function*(){var n=yield SH(e,t,r),o=n.fetchedFromFallback,a=n.value;return{domain:a.LokiUrl||"",domainRequiredRequest:o}})}function dle(e,t,r,n,o){var a=this,d=function(p){return Pp(Object.assign(Object.assign({},p),{monitorStarter:t,requestId:Oo()}))},c=function(p){return gA(a,void 0,void 0,function*(){try{return r(p)}catch(g){throw t.logError({eventId:"HostAppTokenCallbackFailure",featureName:Mo}),g}})},u=function(p){return gA(a,void 0,void 0,function*(){try{var g=yield c(e);p(g,void 0,void 0,void 0)}catch(h){p(void 0,h,void 0,void 0)}})};return new mL({getAppId:function(){return n},refreshAuthToken:u,logger:t,authTokenType:Gx,runWithLogMonitor:d,storageKeySuffix:"LivePeoplePicker",dontStoreTokenInSessionStorage:o})}var gA,cle=f(()=>{"use strict";s();gL();pT();oc();_L();mA();pA();ale();gA=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})}});var hA,EH,ule,P1e,lle,fle=f(()=>{"use strict";s();hA=S(re()),ule=function(t){return new Promise(function(r,n){var o;return(o=hA.NativeModules.LPPHostAppData)===null||o===void 0?void 0:o.refreshAuthToken(t,function(a,d,c,u){return d?r(d):n(c)})})},P1e=function(t,r){return new Promise(function(n){var o;return(o=hA.NativeModules.LPPHostAppData)===null||o===void 0?void 0:o.getHostAppSuggestions(t,r==null?void 0:r.searchDirectory,r==null?void 0:r.top,function(a){return n(a)})})},lle=!((EH=hA.NativeModules.LPPHostAppData)===null||EH===void 0)&&EH.getHostAppSuggestions?P1e:void 0});var mle=be((Bsr,ple)=>{"use strict";s();ple.exports=function(t,r){if(r=r.split(":")[0],t=+t,!t)return!1;switch(r){case"http":case"ws":return t!==80;case"https":case"wss":return t!==443;case"ftp":return t!==21;case"gopher":return t!==70;case"file":return!1}return t!==0}});var yle=be(PH=>{"use strict";s();var _1e=Object.prototype.hasOwnProperty,R1e;function gle(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return null}}function hle(e){try{return encodeURIComponent(e)}catch(t){return null}}function A1e(e){for(var t=/([^=?#&]+)=?([^&]*)/g,r={},n;n=t.exec(e);){var o=gle(n[1]),a=gle(n[2]);o===null||a===null||o in r||(r[o]=a)}return r}function k1e(e,t){t=t||"";var r=[],n,o;typeof t!="string"&&(t="?");for(o in e)if(_1e.call(e,o)){if(n=e[o],!n&&(n===null||n===R1e||isNaN(n))&&(n=""),o=hle(o),n=hle(n),o===null||n===null)continue;r.push(o+"="+n)}return r.length?t+r.join("&"):""}PH.stringify=k1e;PH.parse=A1e});var Ele=be((Wsr,Ile)=>{"use strict";s();var vle=mle(),yA=yle(),D1e=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,xle=/[\n\r\t]/g,w1e=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,Tle=/:\d+$/,F1e=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,O1e=/^[a-zA-Z]:/;function RH(e){return(e||"").toString().replace(D1e,"")}var _H=[["#","hash"],["?","query"],function(t,r){return ac(r.protocol)?t.replace(/\\/g,"/"):t},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],Cle={hash:1,query:1};function ble(e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={};var r=t.location||{};e=e||r;var n={},o=typeof e,a;if(e.protocol==="blob:")n=new sc(unescape(e.pathname),{});else if(o==="string"){n=new sc(e,{});for(a in Cle)delete n[a]}else if(o==="object"){for(a in e)a in Cle||(n[a]=e[a]);n.slashes===void 0&&(n.slashes=w1e.test(e.href))}return n}function ac(e){return e==="file:"||e==="ftp:"||e==="http:"||e==="https:"||e==="ws:"||e==="wss:"}function Sle(e,t){e=RH(e),e=e.replace(xle,""),t=t||{};var r=F1e.exec(e),n=r[1]?r[1].toLowerCase():"",o=!!r[2],a=!!r[3],d=0,c;return o?a?(c=r[2]+r[3]+r[4],d=r[2].length+r[3].length):(c=r[2]+r[4],d=r[2].length):a?(c=r[3]+r[4],d=r[3].length):c=r[4],n==="file:"?d>=2&&(c=c.slice(2)):ac(n)?c=r[4]:n?o&&(c=c.slice(2)):d>=2&&ac(t.protocol)&&(c=r[4]),{protocol:n,slashes:o||ac(n),slashesCount:d,rest:c}}function N1e(e,t){if(e==="")return t;for(var r=(t||"/").split("/").slice(0,-1).concat(e.split("/")),n=r.length,o=r[n-1],a=!1,d=0;n--;)r[n]==="."?r.splice(n,1):r[n]===".."?(r.splice(n,1),d++):d&&(n===0&&(a=!0),r.splice(n,1),d--);return a&&r.unshift(""),(o==="."||o==="..")&&r.push(""),r.join("/")}function sc(e,t,r){if(e=RH(e),e=e.replace(xle,""),!(this instanceof sc))return new sc(e,t,r);var n,o,a,d,c,u,l=_H.slice(),p=typeof t,g=this,h=0;for(p!=="object"&&p!=="string"&&(r=t,t=null),r&&typeof r!="function"&&(r=yA.parse),t=ble(t),o=Sle(e||"",t),n=!o.protocol&&!o.slashes,g.slashes=o.slashes||n&&t.slashes,g.protocol=o.protocol||t.protocol||"",e=o.rest,(o.protocol==="file:"&&(o.slashesCount!==2||O1e.test(e))||!o.slashes&&(o.protocol||o.slashesCount<2||!ac(g.protocol)))&&(l[3]=[/(.*)/,"pathname"]);h<l.length;h++){if(d=l[h],typeof d=="function"){e=d(e,g);continue}a=d[0],u=d[1],a!==a?g[u]=e:typeof a=="string"?(c=a==="@"?e.lastIndexOf(a):e.indexOf(a),~c&&(typeof d[2]=="number"?(g[u]=e.slice(0,c),e=e.slice(c+d[2])):(g[u]=e.slice(c),e=e.slice(0,c)))):(c=a.exec(e))&&(g[u]=c[1],e=e.slice(0,c.index)),g[u]=g[u]||n&&d[3]&&t[u]||"",d[4]&&(g[u]=g[u].toLowerCase())}r&&(g.query=r(g.query)),n&&t.slashes&&g.pathname.charAt(0)!=="/"&&(g.pathname!==""||t.pathname!=="")&&(g.pathname=N1e(g.pathname,t.pathname)),g.pathname.charAt(0)!=="/"&&ac(g.protocol)&&(g.pathname="/"+g.pathname),vle(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(c=g.auth.indexOf(":"),~c?(g.username=g.auth.slice(0,c),g.username=encodeURIComponent(decodeURIComponent(g.username)),g.password=g.auth.slice(c+1),g.password=encodeURIComponent(decodeURIComponent(g.password))):g.username=encodeURIComponent(decodeURIComponent(g.auth)),g.auth=g.password?g.username+":"+g.password:g.username),g.origin=g.protocol!=="file:"&&ac(g.protocol)&&g.host?g.protocol+"//"+g.host:"null",g.href=g.toString()}function M1e(e,t,r){var n=this;switch(e){case"query":typeof t=="string"&&t.length&&(t=(r||yA.parse)(t)),n[e]=t;break;case"port":n[e]=t,vle(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[e]=t,Tle.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!r;break;case"pathname":case"hash":if(t){var o=e==="pathname"?"/":"#";n[e]=t.charAt(0)!==o?o+t:t}else n[e]=t;break;case"username":case"password":n[e]=encodeURIComponent(t);break;case"auth":var a=t.indexOf(":");~a?(n.username=t.slice(0,a),n.username=encodeURIComponent(decodeURIComponent(n.username)),n.password=t.slice(a+1),n.password=encodeURIComponent(decodeURIComponent(n.password))):n.username=encodeURIComponent(decodeURIComponent(t))}for(var d=0;d<_H.length;d++){var c=_H[d];c[4]&&(n[c[1]]=n[c[1]].toLowerCase())}return n.auth=n.password?n.username+":"+n.password:n.username,n.origin=n.protocol!=="file:"&&ac(n.protocol)&&n.host?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function L1e(e){(!e||typeof e!="function")&&(e=yA.stringify);var t,r=this,n=r.host,o=r.protocol;o&&o.charAt(o.length-1)!==":"&&(o+=":");var a=o+(r.protocol&&r.slashes||ac(r.protocol)?"//":"");return r.username?(a+=r.username,r.password&&(a+=":"+r.password),a+="@"):r.password?(a+=":"+r.password,a+="@"):r.protocol!=="file:"&&ac(r.protocol)&&!n&&r.pathname!=="/"&&(a+="@"),(n[n.length-1]===":"||Tle.test(r.hostname)&&!r.port)&&(n+=":"),a+=n+r.pathname,t=typeof r.query=="object"?e(r.query):r.query,t&&(a+=t.charAt(0)!=="?"?"?"+t:t),r.hash&&(a+=r.hash),a}sc.prototype={set:M1e,toString:L1e};sc.extractProtocol=Sle;sc.location=ble;sc.trimLeft=RH;sc.qs=yA;Ile.exports=sc});function AH(e){return(0,Ple.default)(e)}var Ple,_le=f(()=>{"use strict";s();Ple=S(Ele())});function Rle(e){var t=AH(e),r=t==null?void 0:t.protocol;return r}function Ale(e){var t=AH(e),r=t==null?void 0:t.hostname;return r}var kle=f(()=>{"use strict";s();_le()});function Fle(e,t,r){var n,o=t.clientCorrelationId,a=t.clientType,d=t.hostAppName,c=t.hostAppPlatform,u=t.hostAppRing,l=t.hostAppSupportsLogging,p=t.hostAppVersion,g=t.complianceEnvironment,h=t.clientTelemetryCollectorUrl,v=o||Oo();l&&fA();var y=new fT(Promise.resolve(Ole()),new dT(a||"",Fp,v,{hostAppVersion:p||"",hostAppRing:u||"",hostAppName:d||"",hostAppPlatform:c||"",complianceEnvironment:g||"",clientTelemetryCollectorUrl:(h==null?void 0:h.Aria)||""}),function(){return!0},function(){return(n==null?void 0:n.getLoggableProps())||{}}),T=(0,wle.composeWithDevTools)(xx(x2(y,{logDataScenarioActions:!1}))),b=T(Tp),I=S2(H1e),E=b(I),P=new q_({reduxStore:E}),_=function(){return setTimeout(r,0)};return n=new vA(P,E.dispatch,e,y,t.refreshAuthToken||ule,t,_),P.addSingleton(n),P}function CA(e){return e.getSingleton(vA)}function Ole(e){var t=new cT;return t.registerConsumer(gT(e,!1)),t}function B1e(e,t,r){return kH(this,void 0,void 0,function*(){if(t!==void 0){var n=yield U1e(t);return Promise.resolve(n)}else if(e!==void 0){var o=hH(e||"Unknown");return Promise.resolve(o)}return r.logEvent({eventId:"Neither GetLokiEndpoint callback nor Compliance environment passed from the hostapp",featureName:"LivePersonaPicker"}),Promise.reject("Neither compliance environment nor Loki URL from the hostapp is set")})}function U1e(e){return kH(this,void 0,void 0,function*(){var t="",r=yield e(),n=Rle(r),o=Ale(r);return n!==void 0&&o!==void 0?t="".concat(n,"//").concat(o):t="",t})}var Dle,wle,kH,H1e,vA,DH=f(()=>{"use strict";s();Dle=S(Ab());pT();Rue();TL();oc();us();Ml();wle=S(kue());NL();BR();bR();bH();wL();FL();LL();pA();cle();fle();kle();mA();kH=function(e,t,r,n){function o(a){return a instanceof r?a:new r(function(d){d(a)})}return new(r||(r=Promise))(function(a,d){function c(p){try{l(n.next(p))}catch(g){d(g)}}function u(p){try{l(n.throw(p))}catch(g){d(g)}}function l(p){p.done?a(p.value):o(p.value).then(c,u)}l((n=n.apply(e,t||[])).next())})},H1e=[Vse,Kx,Nx,Qx,Xx,WR];vA=function(){function e(r,n,o,a,d,c,u){var l=this;this.appContext=r,this.dispatch=n,this.accountUpn=o,this.logger=a,this.refreshLokiToken=d,this.options=c,this.onInit=u,this.initializedInOnlineMode=!1,this.createEUPLLogFunction=function(){var I=l.suggestionListCorrelationId;return function(E,P,_,D){var M=Object.assign(Object.assign({},D),{suggestionListCorrelationId:I});l.logger.logEUPL(E,P,_,M)}},this.reInitializeWithOnlineMode=function(){l.initializeContextWithLoki(l.refreshLokiToken,l.options)},this.debugReInitializeWithOfflineMode=function(){l.initializedInOnlineMode=!1,l.initializeContextWithoutLoki()};var p=c.clientType,g=c.hostAppName,h=c.hostAppPlatform,v=c.settings,y=c.informationBarrierSegments,T=c.offline,b=c.enableVerboseLogging;if(!p)throw a.logEvent({eventId:"ClientTypeUndefined",featureName:Mo}),console.error("LivePersonaPicker client type not defined"),"Client type not defined";this.hostAppName=g,this.clientType=p,this.correlationId=Oo(),this.getHostAppSuggestions=c.getHostAppSuggestions||lle,this.hostAppPlatform=h,this.settingsOverride=v,this.informationBarrierSegments=y,this.offline=!!T,this.suggestionListCorrelationId=Oo(),this.getLokiRestProvider=function(){throw a.logEvent({eventId:"LokiRestProviderUnavailableWhenOffline",featureName:Mo}),new Error("LokiRestProvider not available in offline mode")},T?this.initializeContextWithoutLoki():this.initializeContextWithLoki(d,c),this.enableVerboseLogging=b}var t=e.prototype;return t.generateNewSuggestionListCorrelationId=function(){this.suggestionListCorrelationId=Oo()},t.getLoggableProps=function(){return{suggestionListCorrelationId:this.suggestionListCorrelationId||""}},t.getStoreState=function(){if(this.appContext.reduxStore)return this.appContext.reduxStore.getState();throw this.logger.logEvent({eventId:"Cannot get store state, Redux Store undefined",featureName:Mo}),new Error("Redux store is not defined.")},t.initializeContextWithLoki=function(n,o){var a=this,d=o.getPhotoUri,c=o.hostAppRing,u=o.hostAppVersion,l=o.complianceEnvironment,p=o.getLokiEndpoint;this.offline=!1;var g=function(){return B1e(l,p,a.logger)},h=dle(this.accountUpn,this.logger,n,this.id,o.dontStoreTokenInSessionStorage),v=sle(h,this.logger,Oo(),this.clientType,c,u);this.getPhotoUri=d||function(T,b){return a.getPhotoUriInternal(v,T,b,g)};var y;this.getLokiRestProvider=function(){return y||(y=new LR(v,function(){return IH(a.accountUpn,v,g)})),y},SH(this.accountUpn,v,g).then(function(T){return a.onInitialized("OnlineInitializationSuccessful",T.value)}).catch(function(){return a.onInitialized("OnlineInitializationFailed")})},t.initializeContextWithoutLoki=function(){var n=this;this.offline=!0,this.getLokiRestProvider=function(){throw n.logger.logEvent({eventId:"LokiRestProviderUnavailableWhenOffline",featureName:Mo}),new Error("LokiRestProvider not available in offline mode")},this.onInitialized("OfflineInitializationSuccessful")},t.getPhotoUriInternal=function(n,o,a,d){return kH(this,void 0,void 0,function*(){var c=(yield n.getAuthToken(this.correlationId)).token.getValue(),u="".concat(o).concat(a),l=function(h){return"".concat(h,"/").concat(u)},p=u.lastIndexOf("https:",0)===0?u:l((yield IH(this.accountUpn,n,d)).domain);return{uri:p,headers:{"X-ClientType":this.clientType,Authorization:"Bearer ".concat(c)}}})},t.onInitialized=function(n,o){this.initializedInOnlineMode||(this.logger.setEventHub(Ole(o)),this.logger.logEvent({eventId:n,featureName:Mo}),this.dispatch(qR({clientType:this.clientType,offline:this.offline,informationBarrierSegments:this.informationBarrierSegments,settings:this.settingsOverride})),this.offline||(this.initializedInOnlineMode=!0),this.onInit())},(0,Dle.default)(e,[{key:"settings",get:function(){if(!this.appContext.reduxStore)throw this.logger.logEvent({eventId:"Cannot get settings,Redux Store undefined",featureName:Mo}),new Error("Can't get settings: Redux store is not defined.");return Xx.getSelectors(this.appContext.reduxStore.getState()).settings}},{key:"id",get:function(){return this.accountUpn?"".concat(Mo,"_").concat(this.accountUpn):this.correlationId?this.correlationId:(this.logger.logEvent({eventId:"LivePersonaPickerContext.id is null",featureName:Mo}),"_")}}]),e}()});function Nle(e){return function(t){return function(r){(0,wH.default)(n,r);function n(){return r.apply(this,arguments)||this}var o=n.prototype;return o.render=function(){return Op.createElement(VM,{context:e(this.props)},Op.createElement(t,Object.assign({},this.props)))},n}(Op.Component)}}function Mle(e){return function(t){return function(r){(0,wH.default)(n,r);function n(){return r.apply(this,arguments)||this}var o=n.prototype;return o.render=function(){return Op.createElement(t,Object.assign({},e(this.props)))},n}(Op.Component)}}var wH,Op,Lle=f(()=>{"use strict";s();wH=S(Tu());us();Op=S(L())});function V1e(){return!1}function j1e(){var e=new cT;return e.registerConsumer(gT(void 0,V1e())),e}var xA,Hle=f(()=>{"use strict";s();pT();bH();mA();xA=new fT(Promise.resolve(j1e()),new dT("",Fp),function(){return!0},function(){return{}})});var FH,OH=f(()=>{"use strict";s();zL();DH();pA();Hle();FH=function(){function e(){this._applicationContextMap={}}var t=e.prototype;return t.getApplicationContext=function(n){var o=this._applicationContextMap[n];if(!o)throw xA.logEvent({eventId:"Undefined AppContext",featureName:Mo}),"Undefined app context, should call start for ".concat(n);return o},t.start=function(n,o){if(n in this._applicationContextMap){xA.logEvent({eventId:"UPN already in applicationContextMap",featureName:Mo});return}var a=Fle(n,o,function(){var d=CA(a);vde(d)});this._applicationContextMap[n]=a},t.switchToOnlineMode=function(n){var o=this._applicationContextMap[n];if(!o)throw xA.logEvent({eventId:"Uninitialized AppContext for the UPN",featureName:Mo}),"App context not initialized for ".concat(n);o.getSingleton(vA).reInitializeWithOnlineMode()},e}()});var Np,W1e,NH,Ble=f(()=>{"use strict";s();Ml();pue();cH();DH();Lle();OH();rH();Np=new FH,W1e=function(t,r){return bp(Mle(function(n){var o=t.getApplicationContext(r),a=CA(o);return Object.assign(Object.assign({},n),{lppAppContext:a})}),Nle(function(n){return t.getApplicationContext(r)}))(fue)},NH=function(t,r){return W1e(t,r)}});var MH=f(()=>{"use strict";s();Ble();OH()});var hT,LH,HH=f(()=>{"use strict";s();k();Pt();hT=S(L());lr();Tl();MH();LH=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.lppRef=null,n.lppContainer=void 0,n.setLPPRef=function(o){n.lppRef=o},n.state={calloutAnchor:void 0},n}return t.prototype.handleKeyDown=function(r){var n,o,a,d,c,u,l;switch(r){case J.ArrowDown:return(n=this.lppRef)===null||n===void 0||n.onCustomKeyPressed(No.DOWN),!0;case J.ArrowUp:return(o=this.lppRef)===null||o===void 0||o.onCustomKeyPressed(No.UP),!0;case J.Enter:return(a=this.lppRef)===null||a===void 0||a.onCustomKeyPressed(No.ENTER),!0;case J.Escape:return(d=this.lppRef)===null||d===void 0||d.onCustomKeyPressed(No.ESCAPE),(u=(c=this.props).onDismiss)===null||u===void 0||u.call(c),!0;case J.Tab:return(l=this.lppRef)===null||l===void 0||l.onCustomKeyPressed(No.TAB),!0}return!1},t.prototype.hidePicker=function(){this.setState({calloutAnchor:void 0})},t.prototype.showPicker=function(r,n){r&&(this.setState({calloutAnchor:r}),this.updatePicker(n??""))},t.prototype.updatePicker=function(r){var n;r!==void 0&&((n=this.lppRef)===null||n===void 0||n.onQueryChanged(r))},t.prototype.getLPPContainer=function(){if(this.state.calloutAnchor&&!this.lppContainer){this.props.lppManager.refreshLPPController();var r=this.props.lppManager.getLPPController();this.lppContainer=r&&NH(r,this.props.lppManager.getAccountID())}return this.lppContainer},t.prototype.render=function(){var r=this.getLPPContainer();return hT.createElement(ee,null,r?hT.createElement(r,{calloutPositioningTarget:this.state.calloutAnchor,maxHeight:this.props.maxHeight,maxWidth:this.props.maxWidth,strings:this.props.strings,inputId:this.props.inputId,componentRef:this.setLPPRef,isOpen:!!this.state.calloutAnchor,onDismiss:this.props.onDismiss,onSuggestionSelected:this.props.onSuggestionSelected,selectedSuggestions:this.props.selectedSuggestions,suggestionListId:MW(),accessibilitySelectionRef:this.props.accessibilitySelectionRef}):null)},t}(hT.PureComponent)});var Jh,TA,uu,z1e,G1e,q1e,K1e,BH,Ule=f(()=>{"use strict";s();k();ne();rt();te();ym();Pt();Jh=S(Kr()),TA=S(bM()),uu=S(L());ln();ye();sg();wM();Ov();Vo();Zre();Tr();z_();OC();HH();Tl();z1e=400,G1e=300,q1e=[{key:J.ArrowDown,eventPhase:Jh.EventPhase.Capturing},{key:J.ArrowUp,eventPhase:Jh.EventPhase.Capturing},{key:J.Enter,eventPhase:Jh.EventPhase.Capturing},{key:J.Escape,eventPhase:Jh.EventPhase.Capturing},{key:J.Tab,eventPhase:Jh.EventPhase.Capturing}],K1e=function(){function e(){var t=this;this.hasBeenFulfilled=!1,this.promise=new Promise(function(r){t.resolve=r})}return e.prototype.fulfill=function(t){!this.hasBeenFulfilled&&this.resolve&&(this.resolve(t),this.hasBeenFulfilled=!0)},e}(),BH=function(e){Z(t,e);function t(r){var n,o=e.call(this,r)||this;return o.rteRef=null,o.lppRef=null,o.isFocused=!1,o.haveChangedText=!1,o.receivedFinalContentForUnmount=!1,o.supportsDeferredPromises=!0,o.lastKnownCursorPosition=void 0,o.tryFulfillDeferredContentsPromise=function(){o.deferredContentsPromise&&(o.deferredContentsPromise.fulfill(o.lastKnownContentsDelta),o.deferredContentsPromise=void 0)},o.setLPPRef=function(a){o.lppRef=a},o.setAccessibilitySelectionRef=function(a){o.setState({accessibilitySelectionRef:a})},o.onFocus=function(){var a=o.isFocused;o.isFocused=!0,a||o.props.onFocus()},o.onBlur=function(){var a=o.isFocused;o.isFocused=!1,a&&o.props.onBlur()},o.onKeyDown=function(a){var d;o.state.caretAnchorUID&&!((d=o.lppRef)===null||d===void 0)&&d.handleKeyDown(a.nativeEvent.key)&&a.stopPropagation()},o.previousMentions=[],o.onMentioneesChanged=function(a){if(!(!o.props.onMentionCreated||!o.props.onMentioneesStillInDraftUpdated||!a)){var d=a.nativeEvent.atMentions,c=o.props.onMentionCreated;d.forEach(function(u){if(o.previousMentions.find(function(p){return p.id===u.id})===void 0){x().assertConditionTag(!at()||u.directoryId!==void 0,"Mentionees should have directoryId when tasks is enabled",591155840);var l=o.getLPPSuggestion(u);c(l)}}),o.previousMentions=d,o.props.onMentioneesStillInDraftUpdated(new Set(d.map(function(u){return u.email})))}},o.emptyLPPStringOverride={},o.getMemoizedLPPStrings=vn($8,function(){return[o.props.localizationAPI,o.emptyLPPStringOverride]}),o.getLPPSuggestion=function(a){return{Id:a.id,Name:a.fullName,EmailAddresses:[a.email],UserPrincipalName:"",SuggestionType:"Person",SuggestionOrigin:"UserTyped",SuggestionSubtype:"OrganizationUser",HostAppSuggestion:{},Source:"HostApp",AadObjectId:a.directoryId}},o.onEditorWillUnmount=function(a){o.lastKnownContentsDelta=t.sanitizeAndStringifyDelta(a==null?void 0:a.nativeEvent.formattedText,C.reserveTag(574980951)),o.receivedFinalContentForUnmount=!0,o.tryFulfillDeferredContentsPromise()},o.onPickerVisibilityChanged=function(a){var d,c;a&&((c=(d=o.props).onPickerVisibilityChanged)===null||c===void 0||c.call(d,a.nativeEvent.isVisible))},o.onPickerTelemetryEvent=function(a){var d,c;a&&((c=(d=o.props).onPickerTelemetryEvent)===null||c===void 0||c.call(d,a.nativeEvent))},o.onSelectionChange=function(a){a&&(o.lastKnownCursorPosition=a.nativeEvent.selection.start)},o.hidePicker=function(){var a;o.setState({accessibilitySelectionRef:void 0,caretAnchorUID:void 0}),(a=o.lppRef)===null||a===void 0||a.hidePicker()},o.onCustomPickerEvent=function(a){if(o.lppRef&&a)switch(a.nativeEvent.PickerEvent){case"StartPicker":o.setState({caretAnchorUID:a.nativeEvent.caretAnchorUID}),o.lppRef.showPicker(a.nativeEvent.caretAnchorUID,a.nativeEvent.searchString);return;case"StopPicker":o.hidePicker();return;case"UpdatePicker":o.lppRef.updatePicker(a.nativeEvent.searchString);return}},o.onDismissPicker=function(){var a;o.hidePicker(),(a=o.rteRef)===null||a===void 0||a.endCustomPickerExperience(null)},o.onSuggestionSelected=function(a){var d,c,u=o.getAtMentionSuggestion(a);(d=o.rteRef)===null||d===void 0||d.endCustomPickerExperience(u),o.setState({caretAnchorUID:void 0}),(c=o.lppRef)===null||c===void 0||c.hidePicker(),oi(u.fullName)},o.renderWithContexts=function(a){var d,c=o.props.defaultValue?JSON.parse(o.props.defaultValue):void 0,u=o.props.displayMode===mn.ReadOnly;return Jre(uu.createElement(uu.Fragment,null,uu.createElement(TA.AtMentionTextInput,{ref:o.setRTERef,initialFormattedText:c,editable:!u,onFocus:o.onFocus,onBlur:o.onBlur,onContentSizeChange:o.props.onContentSizeChange,style:o.props.style,onPress:o.props.onPress,onChangeText:o.onChangeText,onIsEmpty:o.onIsEmpty,placeholderTextColor:o.props.placeholderTextColor,placeholder:o.props.placeholder,scrollEnabled:!u,onMentioneesChanged:o.onMentioneesChanged,isAtMentionsEnabled:j_(o.props),acceptsKeyboardFocus:o.props.acceptsKeyboardFocus,hyperlinksOpenBrowser:!0,hyperlinksRequireControlKey:!0,testID:o.props.testID,maximumNumberOfLines:o.props.maxLines,supportedFormatting:o.props.richTextCapabilities,accessibilityLabel:o.props.accessibilityLabel,accessible:o.props.accessible,onComponentWillUnmount:o.onEditorWillUnmount,onPickerVisibilityChanged:o.onPickerVisibilityChanged,documentUrl:(d=o.props.suggestionsDetails)===null||d===void 0?void 0:d.hostResourceUrl,onPickerTelemetryEvent:o.onPickerTelemetryEvent,onSelectionChange:o.onSelectionChange,onCustomPickerEvent:La()?o.onCustomPickerEvent:void 0,accessibilityControls:o.state.accessibilitySelectionRef,isPickerEmailAtMentionsEnabled:ku(),enableRibbonCommanding:rj()}),La()&&uu.createElement(LH,{ref:o.setLPPRef,lppManager:a,calloutPositioningTarget:o.state.caretAnchorUID,maxHeight:z1e,maxWidth:G1e,strings:o.getMemoizedLPPStrings(),inputId:o.props.correlationId||"LPP_INPUT_ID",isOpen:!!o.state.caretAnchorUID,onDismiss:o.onDismissPicker,onSuggestionSelected:o.onSuggestionSelected,accessibilitySelectionRef:o.setAccessibilitySelectionRef})),La()&&uu.createElement(ee,{keyDownEvents:o.state.caretAnchorUID?q1e:void 0,onKeyDown:o.onKeyDown}))},o.setRTERef=o.setRTERef.bind(o),o.onChangeText=o.onChangeText.bind(o),o.onIsEmpty=o.onIsEmpty.bind(o),o.onMentionCreated=o.onMentionCreated.bind(o),o.lastKnownContentsDelta=(n=r.defaultValue)!==null&&n!==void 0?n:Ed,o.state={caretAnchorUID:void 0,accessibilitySelectionRef:void 0},o}return t.prototype.clear=function(){this.rteRef&&this.rteRef.clear()},t.prototype.isEmpty=function(){return!0},t.prototype.getCaretRect=function(){return this.rteRef?this.rteRef.getCaretRect():Promise.reject()},t.prototype.getFormattedText=function(){return Wt(this,void 0,void 0,function(){var r,n,o,a;return pt(this,function(d){switch(d.label){case 0:if(!this.rteRef||this.receivedFinalContentForUnmount)return x().assertConditionTag(this.receivedFinalContentForUnmount,"RichTextEdit ref not set, but no contents persisted from unmount",574984778),[2,Promise.resolve(this.lastKnownContentsDelta)];d.label=1;case 1:return d.trys.push([1,3,,4]),o=(n=t).sanitizeAndStringifyDelta,[4,this.rteRef.getFormattedText()];case 2:return r=o.apply(n,[d.sent(),C.reserveTag(574984779)]),[3,4];case 3:return a=d.sent(),this.supportsDeferredPromises?(x().assertConditionTag(!1,"RichTextEditWrapper failed to get editor content beginning to unmount",527558788),this.deferredContentsPromise=new K1e,[2,this.deferredContentsPromise.promise]):[2,Promise.resolve(this.lastKnownContentsDelta)];case 4:return!this.haveChangedText&&YW(r)?[2,Promise.resolve(this.lastKnownContentsDelta)]:(this.lastKnownContentsDelta=r,[2,Promise.resolve(r)])}})})},t.prototype.componentDidUpdate=function(r){this.props.displayMode!==mn.Editing&&r.displayMode===mn.Editing&&(this.previousMentions=[])},t.prototype.componentWillUnmount=function(){this.tryFulfillDeferredContentsPromise(),this.supportsDeferredPromises=!1},t.prototype.setFormattedText=function(r){this.rteRef&&(this.lastKnownContentsDelta=r,this.rteRef.setFormattedText(JSON.parse(r)))},t.prototype.setCursorPosition=function(r){this.rteRef&&(this.lastKnownCursorPosition=r,this.rteRef.setTextSelection(r,r))},t.prototype.getCursorPositionAsync=function(){return this.lastKnownCursorPosition!==void 0?Promise.resolve(this.lastKnownCursorPosition):this.rteRef?this.rteRef.getSelectionStart():Promise.resolve(void 0)},t.prototype.setRTERef=function(r){this.rteRef=r},t.prototype.focus=function(){this.rteRef&&Yg(this.rteRef)},t.prototype.blur=function(){this.rteRef&&this.rteRef.blur()},t.prototype.onChangeText=function(r){this.props.onChangeText(r.nativeEvent.text),this.haveChangedText=!0,this.receivedFinalContentForUnmount=!1,this.deferredContentsPromise=void 0},t.prototype.onIsEmpty=function(r){r&&this.props.onIsEmpty(r.nativeEvent.isEmpty)},t.prototype.onMentionCreated=function(r){this.props.onMentionCreated&&this.props.onMentionCreated({Email:r.email,DisplayName:r.fullName,Id:r.id,AadObjectId:r.directoryId})},t.prototype.getAtMentionSuggestion=function(r){var n;return{email:bs(r),fullName:r.Name,directoryId:(n=r.AadObjectId)!==null&&n!==void 0?n:"",resolveState:TA.AtMentionResolvedState.Resolved}},t.prototype.render=function(){return We(this.renderWithContexts,Dh)},t.sanitizeAndStringifyDelta=function(r,n){if((r==null?void 0:r.ops)===void 0)return x().assertConditionTag(!1,"Delta ops not set",n),Ed;var o={ops:r.ops.filter(function(a){return a.insert!==void 0})};return JSON.stringify(o)},t}(uu.PureComponent)});var Vle=f(()=>{"use strict";s();Ule()});var UH,Y1e,bA,VH=f(()=>{"use strict";s();UH=S(L()),Y1e="ScrollListenerContext undefined. Did you forget to render a ScrollListenerContext context provider?",bA=UH.createContext(new Proxy({},{get:function(){throw new Error(Y1e)}}))});var Mp,jH=f(()=>{"use strict";s();Mp={get:function(t){return{width:100,height:100,scale:1,fontScale:1}}}});function Zh(e,t){t.addDataField("PickerSession",e.pickerSessionId,N.SystemMetadata)}function jle(e,t){var r=x().createActivityObject("PickerInvoked",e,Ee());Zh(t,r),r.successTag(590443476)}function $1e(e,t){var r=x().createActivityObject("PickerDisplayed",e,Ee());Zh(t,r),r.successTag(590443477)}function Q1e(e,t,r,n,o){var a=x().createActivityObject("ResultsDisplayed",e,Ee());Zh(t,a),a.addDataField("SearchDurationMS",r,N.SystemMetadata),a.addDataField("QueryLength",o,N.SystemMetadata),a.addDataField("NumberOfResults",n,N.SystemMetadata),a.successTag(590443478)}function X1e(e,t,r){var n=x().createActivityObject("SearchStart",e,Ee());Zh(t,n),n.addDataField("QueryLength",r,N.SystemMetadata),n.successTag(590443479)}function J1e(e,t,r,n,o,a){var d=n===0,c=x().createActivityObject("SearchEnd",e,Ee());Zh(t,c),c.addDataField("SearchDurationMS",r,N.SystemMetadata),c.addDataField("Succeeded",d,N.SystemMetadata),c.addDataField("StatusCode",n,N.SystemMetadata),c.addDataField("NumberOfResults",o,N.SystemMetadata),c.addDataField("QueryLength",a,N.SystemMetadata),d?c.successTag(590443480):c.failTag(590443481,-2147467259)}function Z1e(e,t,r,n,o){var a=x().createActivityObject("SessionEnded",e,Ee());Zh(t,a),a.addDataField("WasSelectionMade",r,N.SystemMetadata),a.addDataField("SelectedIndex",n,N.SystemMetadata),a.addDataField("QueryLength",o,N.SystemMetadata),a.successTag(590443482)}function eOe(e,t,r,n){switch(n.type){case"SearchStart":if(n.isNewSession||!r){var o=Wle(t);return jle(e,o),$1e(e,o),o}break;case"SearchComplete":if(!r){var o=Wle(t);return jle(e,o),o}break}return r}function Wle(e){return{draftTelemetryId:e||XT,pickerSessionId:Zn()}}var zle,Gle=f(()=>{"use strict";s();rt();te();zle=function(){function e(){}return e.prototype.onPickerTelemetryEvent=function(t,r,n){if(!this.pickerSession&&(n.type==="SearchStart"||n.type==="SearchComplete")&&(this.pickerSession=eOe(t,r,this.pickerSession,n)),!this.pickerSession){x().assertConditionTag(!1,"Never started picker session",589615891);return}switch(n.type){case"SearchStart":X1e(t,this.pickerSession,n.searchStringLength);break;case"SearchComplete":J1e(t,this.pickerSession,n.sinceSearchStartMs,n.resultCode,n.totalResults,n.searchStringLength);break;case"ResultsDisplayed":Q1e(t,this.pickerSession,n.sinceSearchStartMs,n.numResults,n.searchStringLength);break;case"SessionEnded":Z1e(t,this.pickerSession,n.wasSelectionMade,n.selectedIndex,n.searchStringLength),this.pickerSession=void 0;break}},e}()});function SA(e){return{dataFieldVisitor:e}}var qle,tOe,ey,IA=f(()=>{"use strict";s();te();qle=S(L()),tOe={dataFieldVisitor:ht(ut.GlobalAPI)};ey=qle.createContext(tOe)});var Kle,Yle,$le,Qle=f(()=>{"use strict";s();Kle=S(Kr());dn();xr();Yle=Kle.StyleSheet.createViewStyle({margin:0}),$le=new R([R.rule(function(e){var t=e.renderContextType,r=e.platform;return Ld(t)&&r!=="win32"},{flex:1})])});var lu,nOe,oOe,iOe,aOe,EA,Xle,Jle,WH=f(()=>{"use strict";s();k();ne();rt();te();Pt();lu=S(L());pn();vl();sg();Ve();wM();mr();Vle();px();Tr();Kn();VH();OC();jH();Pr();li();go();dn();je();Gle();IA();kh();Qle();nOe={key:J.Enter,ctrlKey:!0,eventPhase:De.Capturing},oOe={key:J.Escape,eventPhase:De.Capturing},iOe=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.viewRef=lu.createRef(),o.rteRef=null,o.isRestoringDraftToRte=!1,o.registrationRef=lu.createRef(),o.mentionsTelemetry=new zle,o.onKeyDown=function(a){var d,c;if(a.nativeEvent.key===J.ArrowLeft||a.nativeEvent.key===J.ArrowRight||a.nativeEvent.key===J.ArrowDown||a.nativeEvent.key===J.ArrowUp){a.stopPropagation();return}if(o.props.displayMode===mn.Editing){if(a.nativeEvent.key===J.Tab&&!a.nativeEvent.shiftKey){a.stopPropagation();return}if(a.nativeEvent.key===J.Enter&&a.nativeEvent.ctrlKey){o.props.onCommitRequested&&o.props.onCommitRequested(qn.KeyboardShortcut);return}if(a.nativeEvent.key===J.Escape&&!o.state.isPickerVisible){o.props.onEscapeRequested&&o.props.onEscapeRequested();return}(c=(d=o.props).focusManagerKeyDownHandler)===null||c===void 0||c.call(d,a)}},o.onPickerVisibilityChanged=function(a){o.setState({isPickerVisible:a})},o.createOnPickerTelemetryEventHandler=Qe(function(a,d){return function(c){var u;o.mentionsTelemetry.onPickerTelemetryEvent((u=a==null?void 0:a.dataFieldVisitor)!==null&&u!==void 0?u:ht(ut.GlobalAPI),d,c)}}),o.renderWithContext=function(a){var d=o.props,c=d.paddingTop,u=c===void 0?0:c,l=d.paddingBottom,p=l===void 0?0:l,g=d.maxHeight,h=d.minHeight,v={paddingTop:u,paddingBottom:p,paddingLeft:0,paddingRight:0},y=[Yle,{maxHeight:o.scaleFontAccordingToSystemFontSettings(g),minHeight:o.scaleFontAccordingToSystemFontSettings(h)||o.getDefaultEditorMinHeight()},v];Q()==="win32"&&y.push(vr);var T=void 0;j_(o.props)&&(T={onMentionCreated:o.props.onMentionCreated,correlationId:o.props.correlationId,peoplePickerPosition:o.props.peoplePickerPosition,onMentioneesStillInDraftUpdated:o.props.onMentioneesStillInDraftUpdated,emailAddressesEnabled:o.props.emailAddressesEnabled});var b=[nOe];return o.state.isPickerVisible||b.push(oOe),o.props.displayMode===mn.Editing?b.push({key:J.Tab,shiftKey:!0,eventPhase:De.Capturing}):b.push.apply(b,w([],V(Cs(Uy,De.Capturing)||[]),!1)),lu.createElement(gc,{node:o,position:0,ref:o.registrationRef},lu.createElement(ee,{ref:o.viewRef,testID:Q()!=="win32"?o.props.id:void 0,style:[o.renderStyle($le),o.props.containerStyle],keyDownEvents:b,onKeyDown:o.onKeyDown,onStartShouldSetResponder:Fl},lu.createElement(BH,m({},T||{},{localizationAPI:o.props.localizationAPI,ref:o.setRTERef,placeholder:o.props.placeholder,defaultValue:o.props.defaultValue,displayMode:o.props.displayMode,onFocus:o.onFocus,onBlur:o.onBlur,onContentSizeChange:o.onContentSizeChange,style:y,onPress:o.props.onPress,onChangeText:o.onChangeText,onIsEmpty:o.onIsEmpty,placeholderTextColor:o.props.placeholderTextColor,acceptsKeyboardFocus:o.props.focusable,testID:Q()==="win32"?o.props.id:void 0,maxLines:o.props.maxLines,richTextCapabilities:o.props.richTextCapabilities,accessibilityLabel:o.props.accessibilityLabel,accessible:o.props.accessible===void 0?!0:o.props.accessible,onPickerVisibilityChanged:o.onPickerVisibilityChanged,suggestionsDetails:o.props.suggestionsDetails,scrollEnabled:o.shouldEnableRichTextScroll(),onPickerTelemetryEvent:o.createOnPickerTelemetryEventHandler(a,o.props.telemetryId)}))))},o.onContentSizeChange=o.onContentSizeChange.bind(o),o.onChangeText=o.onChangeText.bind(o),o.onIsEmpty=o.onIsEmpty.bind(o),o.setRTERef=o.setRTERef.bind(o),o.onBlur=o.onBlur.bind(o),o.onFocus=o.onFocus.bind(o),o.state={isFocusOn:!1,isFocusWithin:!1,isPickerVisible:!1},o}return t.prototype.componentWillUnmount=function(){var r,n;(n=(r=this.props).onUnmount)===null||n===void 0||n.call(r,this)},t.prototype.componentDidMount=function(){var r,n;(n=(r=this.props).onMount)===null||n===void 0||n.call(r),this.restoreDraftIfExists()},t.prototype.restoreDraftIfExists=function(){var r=this,n=this.props.savedDraftContent;n&&(this.isRestoringDraftToRte=!0,n.editorContent.then(function(o){var a;r.isRestoringDraftToRte=!1,o&&(r.setContents(o),(a=n.editorCursorPosition)===null||a===void 0||a.then(function(d){return r.setCursorPosition(d??-1)}).catch(function(d){r.setCursorPosition(-1)}))}).catch(function(o){r.isRestoringDraftToRte=!1,me(C.reserveTag(588805470))(o)}))},t.prototype.clear=function(){this.rteRef&&this.rteRef.clear()},t.prototype.isEditorEmpty=function(){return x().assertConditionTag(this.props.isDraftEmpty!==void 0,"Called isEditorEmpty on an editor without a draft",588805472),this.props.isDraftEmpty!==!1},t.prototype.getContentsAsync=function(){var r,n,o,a,d,c;return Wt(this,void 0,void 0,function(){return pt(this,function(u){return this.isRestoringDraftToRte&&((n=(r=x()).logDiagnosticTrace)===null||n===void 0||n.call(r,Ot(Xle||(Xle=zt(["GetEditorContentsMidRestore"],["GetEditorContentsMidRestore"]))),C.reserveTag(540021260),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary),Vr("RichTextEditorExists",!!this.rteRef,N.SystemMetadata)),this.props.savedDraftContent)?[2,this.props.savedDraftContent.editorContent]:this.rteRef?[2,this.rteRef.getFormattedText()]:((a=(o=x()).logDiagnosticTrace)===null||a===void 0||a.call(o,Ot(Jle||(Jle=zt(["GetEditorContentsFallback"],["GetEditorContentsFallback"]))),C.reserveTag(540018914),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary)),[2,(c=(d=this.props.savedDraftContent)===null||d===void 0?void 0:d.editorContent)!==null&&c!==void 0?c:Ed])})})},t.prototype.getCursorPositionAsync=function(){return this.rteRef?this.rteRef.getCursorPositionAsync():Promise.resolve(void 0)},t.prototype.setCursorPosition=function(r){var n=this;this.rteRef&&r!==void 0&&setTimeout(function(){var o;(o=n.rteRef)===null||o===void 0||o.setCursorPosition(r)})},t.prototype.setContents=function(r){this.rteRef&&this.rteRef.setFormattedText(r)},t.prototype.getDisplayMode=function(){return this.props.displayMode},t.prototype.componentDidUpdate=function(r,n){this.props.displayMode===mn.ReadOnly&&r.displayMode!==mn.ReadOnly&&this.blur(),(Q()==="win32"?!r.savedDraftContent&&(!this.rteRef||this.rteRef.isEmpty()):this.props.savedDraftContent!==r.savedDraftContent)&&this.restoreDraftIfExists(),to(this.state)!==to(n)&&(this.props.onFocusStateChange&&this.props.onFocusStateChange(this.getFocusState()),this.registrationRef.current&&this.registrationRef.current.onFocusStateChange(this.getFocusState()))},t.prototype.setSelection=function(r){},t.prototype.getScrollListener=function(){return Kt(this.props.componentTreeId.renderContextType)?this.props.scrollListener:null},t.prototype.onContentSizeChange=function(r){if(r){var n=Math.max(B0,r.nativeEvent.contentSize.height);this.props.onContentSizeChange&&this.props.onContentSizeChange(n)}},t.prototype.setRTERef=function(r){this.rteRef=r},t.prototype.onChangeText=function(r){if(this.props.displayMode===mn.Editing){var n=this.getScrollListener();n&&n.clearStickyScrollState&&n.clearStickyScrollState()}},t.prototype.onIsEmpty=function(r){var n,o;this.props.isDraftEmpty===r||this.props.displayMode!==mn.Editing||(o=(n=this.props).onDraftEmptinessChanged)===null||o===void 0||o.call(n,r)},t.prototype.onFocus=function(){if(this.setState({isFocusOn:!0}),this.props.onFocus&&this.props.onFocus(),Q()==="win32"){var r=this.getScrollListener();r&&r.clearStickyScrollState&&r.clearStickyScrollState()}},t.prototype.onBlur=function(){if(this.setState({isFocusOn:!1}),this.props.isDraftEmpty===void 0){x().assertConditionTag(this.props.displayMode!==mn.Editing,"isEditorEmpty undefined when in Editing mode in onBlur",588805475);return}this.props.onEditorBlur&&this.props.onEditorBlur()},t.prototype.focus=function(){this.rteRef&&this.rteRef.focus()},t.prototype.blur=function(){this.rteRef&&this.rteRef.blur()},t.prototype.getFocusState=function(){return to(this.state)},t.prototype.getId=function(){return this.props.nodeId||""},t.prototype.getData=function(){return this},t.prototype.getChildNodes=function(){return[]},t.prototype.addChildNode=function(r){throw new Error("Method not implemented.")},t.prototype.getDescendantById=function(r){},t.prototype.isTabbable=function(){return!!this.props.isTabbable},t.prototype.getNextTabTarget=function(){return this.getFocusState()===ce.Unfocused&&this.isTabbable()?this:void 0},t.prototype.getIterator=function(){return pt(this,function(r){switch(r.label){case 0:return[4,this];case 1:return r.sent(),[2]}})},t.prototype.renderStyle=function(r){return r.render(Wr(this.props.componentTreeId.renderContextType))},t.prototype.getDefaultEditorMinHeight=function(){if(Q()==="android")return 1},t.prototype.scaleFontAccordingToSystemFontSettings=function(r){if(r!==void 0)return Math.round(r*Mp.get("window").fontScale)},t.prototype.shouldEnableRichTextScroll=function(){return this.props.componentTreeId.renderContextType===A.HalfPane&&this.props.maxHeight===void 0?!1:this.props.displayMode!==mn.ReadOnly},t.prototype.render=function(){return We(this.renderWithContext,ey)},t}(lu.PureComponent),aOe=Xd(iOe,{componentTreeId:tn,scrollListener:bA},"CommentEditor"),EA=aOe});function Lp(e){return!!e&&e.setContents!==void 0&&e.getContentsAsync!==void 0&&e.isEditorEmpty!==void 0&&e.clear!==void 0&&e.blur!==void 0&&e.focus!==void 0&&e.setSelection!==void 0&&e.getDisplayMode!==void 0}var PA=f(()=>{"use strict";s()});var Hp,tfe,Zle,efe,rfe=f(()=>{"use strict";s();k();ne();rt();te();Pt();Hp=S(L());Jt();ye();vl();sg();Ve();N0();WH();lr();je();PA();tfe=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.editorRef=Hp.createRef(),o.onDraftEmptinessChanged=function(a){o.props.isDraftEmpty!==a&&o.props.onDraftEmptinessChanged(a)},o.onEditorCommitRequested=function(){var a,d;o.props.isDraftEmpty===!1&&((d=(a=x()).logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(Zle||(Zle=zt(["EditorCommitRequested"],["EditorCommitRequested"]))),C.reserveTag(556827600),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary)),o.props.onPost(qn.KeyboardShortcut))},o.onCommitButtonClick=function(){var a,d;(d=(a=x()).logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(efe||(efe=zt(["SendButtonClicked"],["SendButtonClicked"]))),C.reserveTag(556827601),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary)),o.props.onPost(qn.CommitButton)},o.onEditorUnmount=function(a){o.props.onUnmount(a)},o.onInputSizeChange=o.onInputSizeChange.bind(o),o.onLayout=o.onLayout.bind(o),o.onFocusStateChange=o.onFocusStateChange.bind(o),o.state={focusState:ce.Unfocused,draftBoxHeight:0,viewRef:Hp.createRef()},o}return t.prototype.componentDidUpdate=function(r){this.props.editMode===$o.None&&r.editMode!==$o.None&&this.onInputSizeChange(this.getMinimumInputHeight())},t.prototype.renderStyle=function(r,n){return Je(r,n,this.props.componentTreeId.renderContextType)},t.prototype.onInputSizeChange=function(r){var n=Math.max(r,this.getMinimumInputHeight());this.props.maxDraftHeight&&(n=Math.min(n,this.props.maxDraftHeight)),this.props.componentTreeId.renderContextType===A.HalfPane?this.props.onInputSizeChange(this.getHeight(n)):this.props.onInputSizeChange(void 0)},t.prototype.getPickerPosition=function(){if(!(!this.state.viewRef.current||!this.props.peoplePickerWidth)){var r=this.props.availableScreenHeight||0;return this.props.componentTreeId.renderContextType===A.HalfPane&&(r=Math.max(r-this.state.draftBoxHeight,0)),{target:this.state.viewRef.current,left:0,top:0,width:this.props.peoplePickerWidth,height:r}}},t.prototype.clear=function(){if(this.editorRef&&this.editorRef.current){var r=this.editorRef.current.getData();Lp(r)&&r.clear(),this.onDraftEmptinessChanged(!0)}},t.prototype.focus=function(){this.editorRef&&this.editorRef.current&&this.editorRef.current.focus()},t.prototype.blur=function(){this.editorRef&&this.editorRef.current&&this.editorRef.current.blur()},t.prototype.getContentsAsync=function(){if(this.editorRef&&this.editorRef.current){var r=this.editorRef.current.getData();if(Lp(r))return r.getContentsAsync()}return Promise.reject(new ge("Editor ref unset",C.reserveTag(589103714),-2130957550))},t.prototype.renderCommentEditor=function(r,n){var o=this.props.editMode===$o.Editing?mn.Editing:mn.ReadOnly,a=r.palette.CardPlaceholderColor;return Hp.createElement(EA,m({nodeId:AC(this.props.id),id:this.props.id,onPress:this.props.onPress,onFocus:this.props.onFocus,placeholder:this.props.placeholder,ref:this.editorRef,displayMode:o,onContentSizeChange:this.onInputSizeChange,onMount:this.props.onEditorMount,onUnmount:this.onEditorUnmount,onDraftEmptinessChanged:this.onDraftEmptinessChanged,accessibilityLabel:this.props.placeholder,savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,shouldRestoreContentOnMount:this.props.shouldRestoreDraftOnMount},this.props.mentionEditorProps,{peoplePickerPosition:this.getPickerPosition(),placeholderTextColor:a,focusable:this.props.isEditorFocusable,isTabbable:this.props.isEditorFocusable&&this.props.editMode===$o.Editing&&(!it()||this.props.isTabbable),onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.props.onEscapePressed,key:"editor",preventDefaultKeyDownBehavior:void 0,focusManagerKeyDownHandler:this.props.focusManagerKeyDownHandler,telemetryId:this.props.telemetryId,localizationAPI:this.props.localizationAPI},this.getExtraCommentEditorProps(r,n)))},t.prototype.onLayout=function(r){this.setState({draftBoxHeight:r.nativeEvent.layout.height})},t.prototype.onFocusStateChange=function(r){this.setState({focusState:r})},t.prototype.isEditingOrPending=function(){return this.props.editMode===$o.Editing||this.props.editMode===$o.Pending},t}(Hp.Component)});var nfe,ofe,ife,afe,sfe,dfe,_A,zH=f(()=>{"use strict";s();xr();je();nfe=new kt([kt.always({flexDirection:"column",alignItems:"stretch",borderWidth:0,paddingTop:4,paddingLeft:8,paddingRight:9,paddingBottom:9})]),ofe=ve({paddingBottom:4}),ife=new R([R.always({paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderColor:"transparent",borderWidth:1,marginLeft:1})]),afe=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor,borderRadius:2,borderStyle:"dashed"}})]),sfe=new R([R.always(function(e){return{backgroundColor:e.palette.CardDraftBoxBackgroundHovered}})]),dfe=new R([R.always(function(e){return{borderColor:e.palette.CardDraftBoxBorderHovered}})]),_A=new R([R.always(function(e){return{borderColor:e.warningDraftboxColor}})])});var ty,cfe,GH,ufe,dOe,lfe,qH=f(()=>{"use strict";s();k();Oe();Pt();ty=S(L()),cfe=S(xre());ye();N0();kv();B_();lr();Tr();Kn();yo();go();je();rr();kh();DM();r_();Ki();mr();rfe();zH();GH=55,ufe=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.hoverManager=new Ah,o.onHoverChange=function(a){o.setState({isDraftBoxHovered:a})},o.renderWithTheme=function(a,d){var c=jg(o.renderStyle(nfe,a),0,o.props.extraPaddingRight,0,o.props.extraPaddingLeft),u=c;o.props.taskAssigner&&(u=[c,ofe]);var l=o.renderCommentEditor(a,d),p=o.isEditingOrPending()&&o.renderButtons(),g=[],h=o.getStyles(a);return g.push(ty.createElement(nr,m({accessible:!o.isEditingOrPending(),accessibilityLabel:o.props.placeholder,isTabbable:o.props.isTabbable&&!o.isEditingOrPending(),onPress:o.props.onPress,key:"editor",style:h,pointerEvents:o.isEditingOrPending()?"box-none":"auto",ref:o.state.viewRef,nodeId:"card-draft-box",preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,testID:o.props.id,onFocusStateChange:o.onFocusStateChange},o.hoverManager.viewProps),l)),g.push(o.renderDraftBoxMessage()),g.push(p),ty.createElement(ee,{style:u,animationClass:o.props.animationClass},ty.createElement(cfe.UIAnchor,{uid:o.isEditingOrPending()?NW():""},g))},o.render=function(){return We(o.renderWithTheme,Ge,At)},o.hoverChangeEventSubscription=o.hoverManager.hoverChangeEvent.subscribe(o.onHoverChange),o}return t.prototype.componentWillUnmount=function(){var r;this.hoverChangeEventSubscription&&((r=this.hoverChangeEventSubscription)===null||r===void 0||r.unsubscribe())},t.prototype.getHeight=function(r){return 0},t.prototype.getMinimumInputHeight=function(){return 0},t.prototype.getExtraCommentEditorProps=function(r,n){var o,a=480,d=64;return{onEditorBlur:this.props.onBlur,maxHeight:Math.max((o=this.props.maxDraftHeight)!==null&&o!==void 0?o:a,d),accessibilityLabel:this.props.placeholder,accessible:this.isEditingOrPending(),containerStyle:this.getContainerStyle(r,n)}},t.prototype.getContainerStyle=function(r,n){var o=[this.renderStyle(z0,r)];if(!Uo()&&this.props.isCardHovered&&o.push(this.renderStyle(sfe,r)),this.state.isDraftBoxHovered&&o.push(this.renderStyle(dfe,r)),this.isEditingOrPending()&&this.state.focusState!==ce.Unfocused&&o.push(this.renderStyle(G0,r)),this.props.draftWarningState){var a=Ht(n);o.push(ts(_A,a,this.props.componentTreeId.renderContextType))}return o},t.prototype.getStyles=function(r){var n=[this.renderStyle(ife,r)];return this.state.focusState===ce.FocusOn&&n.push(this.renderStyle(afe,r)),n},t.prototype.renderButtons=function(){var r={onClick:this.onCommitButtonClick,accessibilityLabel:this.props.sendLabel,isTabbable:this.props.isTabbable,icon:2,text:this.props.sendLabel,disabled:this.props.isDraftEmpty!==!1,showDelayedSpinner:this.props.editMode===$o.Pending,id:this.props.sendTestID,usePrimaryButtonStyling:!0},n=this.props.showCancel?{onClick:this.props.onCancel,accessibilityLabel:this.props.cancelLabel,isTabbable:this.props.isTabbable,icon:1,text:this.props.cancelLabel||"",disabled:this.props.editMode===$o.Pending,id:this.props.cancelTestID,usePrimaryButtonStyling:!1}:void 0,o=[r];return n&&o.push(n),ty.createElement(Cx,{key:"commitbar",buttons:o,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,taskAssigner:this.props.taskAssigner})},t.prototype.renderDraftBoxMessage=function(){var r=this.props.draftWarningState,n=fS()&&this.isEditingOrPending();if(!(!r&&!n))return ty.createElement(pp,{key:"draftBoxMessage",draftWarningState:r,localizationAPI:this.props.localizationAPI,target:Md.Card,id:r?jm({id:this.props.parentId,renderContextType:this.props.componentTreeId.renderContextType}):Wm({id:this.props.parentId,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:n})},t.prototype.getEditorWrapperRefHandle=function(){},t}(tfe),dOe=Xd(ufe,{componentTreeId:tn},"CardDraftBox"),lfe=dOe});function YH(){return cOe}var Bp,KH,cOe,$H=f(()=>{"use strict";s();Bp=1,KH=void 0,cOe={PostHeight:50,ExpandButtonHeight:22,ReplyDraftHeight:44,TaskTopper:0}});function Vl(e){var t=e.itemCount,r=e.readOnly,n=e.isTask,o=YH(),a=o.PostHeight;return t>1&&(a+=o.PostHeight+Bp),t>2&&(a+=o.ExpandButtonHeight+Bp),r||(a+=o.ReplyDraftHeight+Bp),n&&(a+=o.TaskTopper),a}var ffe=f(()=>{"use strict";s();$H()});var yT=f(()=>{"use strict";s();$H();ffe()});var pfe,mfe,gfe,hfe,yfe,Cfe,vfe=f(()=>{"use strict";s();k();pfe=S(Kr());zc();yT();xr();je();mfe=new R([R.rule({isFluentEnabled:!1},function(e){return{flex:1,borderColor:e.palette.ButtonBorder,borderLeftWidth:1,alignItems:"stretch"}})]),gfe=ve({borderLeftWidth:0}),hfe=new R([R.rule({isFluentEnabled:!1},{justifyContent:"center",height:48})]),yfe=pfe.StyleSheet.createViewStyle({textAlign:"center"}),Cfe=new R(w([R.always({flex:0,flexDirection:"row"}),R.rule({isFluentEnabled:!1},function(e){return{borderColor:e.palette.CommandBarBorder,borderTopWidth:Bp}}),R.rule({isFluentEnabled:!0},{justifyContent:"flex-end",paddingBottom:10,paddingRight:10})],V($K),!1))});var Up,xfe,lOe,QH,Tfe=f(()=>{"use strict";s();k();te();Up=S(L()),xfe=S(re());ye();Tr();Kn();je();rr();kh();Ki();mr();gn();vfe();lOe=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o.renderWithTheme=function(a){var d=o.props.actions.map(function(c,u){return Up.createElement(ee,{style:[o.renderStyle(mfe,a),u?void 0:gfe],key:u},Up.createElement(nr,{style:o.renderStyle(hfe,a),accessibilityLabel:c.accessibilityLabel,onPress:c.onClick,disabled:c.disabled,accessibilityRole:"button",isTabbable:!0,testID:c.id,nodeId:c.id||"",preventDefaultKeyDownBehavior:void 0},Up.createElement(qe,{style:yfe,textStylePolyester:"MediumSecondary"},c.text)))});return Up.createElement(xfe.SafeAreaView,{style:o.renderStyle(Cfe,a)},d)},o.render=function(){return We(o.renderWithTheme,Ge)},x().assertConditionTag(!fe(),"CommandBar is not supported in the Fluent UI",544875781),o}return t.prototype.renderStyle=function(r,n){return Je(r,n,this.props.componentTreeId.renderContextType)},t}(Up.PureComponent),QH=Xd(lOe,{componentTreeId:tn},"CommandBar")});var bfe=f(()=>{"use strict";s();Tfe()});var RA,XH,Sfe=f(()=>{"use strict";s();k();RA=S(L());Ws();XH=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return RA.createElement(zr,m({},this.props,{nodeId:"safe-area-observer",isTabbable:!1,focusable:!1}))},t}(RA.Component)});var Ife=f(()=>{"use strict";s();Sfe()});function Efe(e){var t=function(n){return n.shouldRenderView?AA.createElement(e,m({},n)):AA.Children.only(n.children)};return t.displayName="Conditional".concat(e.displayName||e.name),t}var AA,kA,Pfe,DA=f(()=>{"use strict";s();k();AA=S(L());Tl();Ife();kA=Efe(ee),Pfe=Efe(XH)});var fOe,_fe,Rfe,Afe,kfe,Dfe,wfe,Ffe=f(()=>{"use strict";s();xr();je();fOe=50,_fe=16,Rfe=ve({elevation:2}),Afe=new R([R.always(function(e){return{alignItems:"stretch",backgroundColor:e.palette.NavigationBarBackground,borderColor:e.palette.NavigationBarBorder,borderBottomWidth:1,borderTopWidth:1,flexDirection:"row",height:fOe,justifyContent:"space-between",paddingLeft:_fe,paddingRight:_fe}})]),kfe=ve({width:"25%",flexDirection:"row",justifyContent:"flex-start"}),Dfe=ve({width:"50%",flexDirection:"row",justifyContent:"center"}),wfe=ve({width:"25%",flexDirection:"row",justifyContent:"flex-end"})});var Vp,JH,ry,Ofe=f(()=>{"use strict";s();k();Vp=S(L()),JH=S(re());Ve();Tr();je();rr();mr();Ffe();ry=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.renderWithTheme=function(n){var o=[r.renderStyle(Afe,n),r.props.backgroundColor&&{backgroundColor:r.props.backgroundColor},r.props.showShadow&&Rfe,typeof r.props.outerSpacing=="number"&&{paddingLeft:r.props.outerSpacing,paddingRight:r.props.outerSpacing}];return Vp.createElement(ee,{style:o,accessibilityRole:"header"},Vp.createElement(JH.SafeAreaView,{style:kfe},r.props.leftChild),Vp.createElement(ee,{style:Dfe},r.props.centerChild),Vp.createElement(JH.SafeAreaView,{style:wfe},r.props.rightChild))},r.render=function(){return We(r.renderWithTheme,Ge)},r}return t.prototype.renderStyle=function(r,n){return Je(r,n,A.HalfPane)},t}(Vp.PureComponent)});var Nfe,ny,ZH=f(()=>{"use strict";s();je();Nfe=17,ny=ve({alignSelf:"stretch",justifyContent:"center",marginLeft:-17,paddingLeft:Nfe,marginRight:-17,paddingRight:Nfe,zIndex:1})});var CT,wA,eB=f(()=>{"use strict";s();k();CT=S(L());Ki();gn();ZH();wA=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r;return this.props.accessibilityLabel?r=this.props.accessibilityLabel:r=this.props.text,CT.createElement(nr,{onPress:this.props.onClick,accessibilityLabel:r,accessibilityRole:"button",style:ny,tooltip:this.props.tooltipText,isTabbable:!0,preventDefaultKeyDownBehavior:void 0,nextFocusLeft:this.props.nextFocusLeft,nextFocusRight:this.props.nextFocusRight},CT.createElement(qe,{textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},this.props.text))},t}(CT.PureComponent)});var tB=f(()=>{"use strict";s();Ofe();eB()});var jp,vT,Lfe=f(()=>{"use strict";s();k();jp=S(L());Fd();go();dn();je();tB();eB();mr();vT=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){var r=xl()===$t.LargeDisplay?Bd:Rr;return jp.createElement(ee,{style:vr},jp.createElement(ry,{leftChild:this.props.leftButton?jp.createElement(wA,{text:this.props.leftButton.buttonTitle,onClick:this.props.leftButton.buttonPress,icon:0,nextFocusLeft:this.props.leftButton.nextFocusLeft,nextFocusRight:this.props.leftButton.nextFocusRight}):void 0,rightChild:this.props.rightButton?jp.createElement(wA,{text:this.props.rightButton.buttonTitle,onClick:this.props.rightButton.buttonPress,icon:0,nextFocusLeft:this.props.rightButton.nextFocusLeft,nextFocusRight:this.props.rightButton.nextFocusRight}):void 0,showShadow:!!this.props.showShadow,outerSpacing:r}),this.props.children)},t}(jp.PureComponent)});var rB=f(()=>{"use strict";s();Lfe()});function FA(e,t,r,n){return e?{typeID:"Comment",author:Fr(t),dateTime:r,target:OW(n)}:void 0}var nB=f(()=>{"use strict";s();ln();lr()});var nd,Xi,Hfe,xT,Bfe,Ufe,OA=f(()=>{"use strict";s();k();rt();nd=S(L());ye();mr();Af();Tr();je();(function(e){e[e.None=0]="None",e[e.CardExpanding=1]="CardExpanding",e[e.CardCollapsing=2]="CardCollapsing"})(Xi||(Xi={}));Hfe=nd.createContext({collapsingCards:[],expandingCards:[]}),xT=nd.createContext(Xi.None),Bfe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.timeoutCookie=void 0,n.state={previousExpandedComments:r.expandedComments,collapsingCards:[],expandingCards:[]},n}return t.getDerivedStateFromProps=function(r,n){if(!fe())return{};var o=r.expandedComments.filter(function(d){return!n.previousExpandedComments.includes(d)}),a=n.previousExpandedComments.filter(function(d){return!r.expandedComments.includes(d)});return{previousExpandedComments:r.expandedComments,collapsingCards:a,expandingCards:o}},t.prototype.componentDidUpdate=function(r,n){var o=this,a=!Ry(this.state.expandingCards,n.expandingCards)||!Ry(this.state.collapsingCards,n.collapsingCards);a&&(this.timeoutCookie!==void 0&&cancelAnimationFrame(this.timeoutCookie),this.timeoutCookie=requestAnimationFrame(function(){return o.setState({expandingCards:[],collapsingCards:[]})}))},t.prototype.componentWillUnmount=function(){this.timeoutCookie!==void 0&&(cancelAnimationFrame(this.timeoutCookie),this.timeoutCookie=void 0)},t.prototype.render=function(){return nd.createElement(Hfe.Provider,{value:this.state},nd.Children.only(this.props.children))},t}(nd.PureComponent),Ufe=function(t){var r=function(o){var a,d,c=o.collapsingCards||o.expandingCards?"CommentCard_Container":void 0,u=Xi.None;if(t.item.length>0){var l=t.item[0],p=_r(l)&&l.commentModel.commentId;p&&(!((a=o.expandingCards)===null||a===void 0)&&a.includes(p))?u=Xi.CardExpanding:p&&(!((d=o.collapsingCards)===null||d===void 0)&&d.includes(p))&&(u=Xi.CardCollapsing)}var g={onFocusCapture:t.onFocusCapture,onLayout:t.onLayout};return nd.createElement(ee,m({style:vr,animationClass:c},g),nd.createElement(xT.Provider,{value:u},t.children))};return We(r,Hfe)}});var oy,mOe,Wp,NA=f(()=>{"use strict";s();k();oy=S(L()),mOe=function(t){var r=t.delay,n=V(oy.useState(!1),2),o=n[0],a=n[1];return oy.useEffect(function(){var d=setTimeout(function(){a(!0)},r);return function(){clearTimeout(d)}},[r]),o?oy.Children.only(t.children):null},Wp=mOe});function MA(e,t,r,n,o){for(var a=[],d=5;d<arguments.length;d++)a[d-5]=arguments[d];var c=a.reduce(function(l,p){return p>l.max?{min:l.min,max:Math.min(l.min+t,p)}:p<l.min?{min:Math.max(l.max-t,p),max:l.max}:l},{min:o,max:o}),u;return e?c.max>=n+t?u=c.max-t:c.min<n?u=c.min:u=n:u=c.min,oB(u,t,r)}function oB(e,t,r){var n=Math.max(r-t,0);return Math.min(n,Math.max(e,0))}function iB(e,t){var r=void 0;return e&&(r=t.findIndex(function(n){return Po(n).commentId===e.selectedCardId}),r===-1&&(r=void 0)),r}var LA=f(()=>{"use strict";s();zo()});function TT(e){if(e!==Xi.None)return"CommentCard"}function yOe(e){if(e!==Xi.None)return"CommentCard_OverflowRepliesContainer"}function HA(e){if(e!==Xi.None)return"CommentCard_Reply"}function COe(e){if(e!==Xi.None)return"CommentCard_ExpandButton"}function vOe(e){if(e!==Xi.None)return"CommentCard_AllRepliesContainer"}var jfe,Ct,bT,gOe,hOe,xOe,Wfe,Vfe,zfe=f(()=>{"use strict";s();k();ne();rt();te();Oe();Pt();jfe=S(Kr()),Ct=S(L()),bT=S(re());Rc();lS();ye();vl();kd();Ef();Id();Ve();N0();Ite();zc();Cre();qH();bfe();DA();rB();Ki();mr();ix();gn();Ws();B_();nB();OA();Vo();lr();Tr();Kn();NA();OC();yo();Pr();LA();yT();Js();dn();je();rr();kh();gOe=2,hOe=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o._postScrollView=null,o.cardDraftBoxRef=Ct.createRef(),o.cardRootRef=Ct.createRef(),o.hoverManager=new Ah,o.cardHeight=0,o.cardLayoutInProgress=!1,o.scrollableContentLayoutInProgress=!1,o.onHoverChange=function(a){o.props.onCardHighlightChange(o,a)},o.onFocusStateChange=function(a){o.setState({focusState:a})},o.onExpandButtonPress=function(){o.onExpand(!0)},o.resizeAfterCardSizeChanges=function(a){if(o.scrollableContentLayoutInProgress||o.props.displayMode===Se.ReplyPreCommitPending||o.props.displayMode===Se.ReplyPostCommitPending||a!==o.cardHeight)return o.cardHeight;o.cardLayoutInProgress=!1,o.updateScrollViewBoundHeight()},o.resizeAfterPostDataChanges=function(a){if(!o._postScrollView){o.scrollableContentLayoutInProgress=!1;return}if(a.postContentHeight!==o._postListSizes.postContentHeight)return o._postListSizes;o.scrollableContentLayoutInProgress=!1,o.updateScrollViewBoundHeight()},o.onEditorMount=function(){o.props.onCardEditorMounted(o.props.id)},o.onDraftEmptinessChanged=function(a){o.props.onDraftEmptinessChanged(o,a)},o.createMemoizedReactionButtonProps=Qe(function(a,d,c,u,l,p,g,h,v){if(no())return{commentId:a,renderContextType:d,isTabbable:c,onReactionPressed:u,reactionType:l,localizationAPI:p,preventDefaultKeyDownBehavior:g,preventReacting:h,userReactionSummary:v}}),o.onLayout=function(a){o.setState({cardWidth:a.nativeEvent.layout.width})},o.onScroll=function(a){var d=a.nativeEvent.contentOffset.y>KK;o.setState({isInnerContentSufficientlyScrolled:d})},o.renderCardBackground=function(a,d){if(fe()){var c=[o.renderStyle(rY,a),o.isSelectionWithinCard()&&o.renderStyle(aY,a),o.state.focusState===ce.FocusOn&&o.renderStyle(iY,a),o.props.highlightCard&&o.renderStyle(oY,a),o.props.displayMode===Se.Resolved&&o.props.cardCollapsedState===Rt.Collapsed&&o.renderStyle(nY,a)];return Ct.createElement(ee,{style:c,animationClass:TT(d)})}},o.logDraftCardRendered=Mn(function(){var a,d;o.isActiveDraft()&&((d=(a=x()).logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(Vfe||(Vfe=zt(["DraftCardRendered"],["DraftCardRendered"]))),C.reserveTag(556827599),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary),Vr("RenderContextType",o.props.componentTreeId.renderContextType,N.SystemMetadata),Vr("CardDisplayMode",o.props.displayMode,N.SystemMetadata)))}),o.onCardLayout=function(a){var d,c;o.logDraftCardRendered(),o.cardHeight=a.nativeEvent.layout.height,!o.cardLayoutInProgress&&o.isMaxHeightDefined()&&(o.cardLayoutInProgress=!0,o._resizeAfterCardSizeChangesDebouncer(o.cardHeight)),(c=(d=o.props).onCardLayout)===null||c===void 0||c.call(d,o.props.id,a)},o.getCardAnnotationId=Qe(function(a,d,c,u){return FW(a,d,c,u)}),o.onPress=function(){o.onExpand(!1)},o.onKeyDown=function(a){a.nativeEvent.key===J.Enter&&a.nativeEvent.ctrlKey&&!o.props.isDraftEmpty&&(o.isActiveReply()||o.isActiveDraft())&&(o.props.onPost(o,qn.KeyboardShortcut),a.stopPropagation(),a.preventDefault())},o.renderWithContexts=function(a,d,c){var u,l,p,g,h=o.renderStyle(QK,d);o.props.displayMode===Se.Loading?(g=[JK],g.push({height:Vl({itemCount:(u=o.props.itemCount)!==null&&u!==void 0?u:1,readOnly:!1,isTask:!!o.props.taskTopperProps})})):g=[o.renderStyle(XK,d)],!fe()&&o.props.contentBackgroundColor&&g.push({backgroundColor:d.palette[o.props.contentBackgroundColor]}),o.props.isNewThread&&o.props.foldableLayoutState===Ps.DoublePortrait&&g.push(ZK);var v=o.props.componentTreeId.renderContextType,y=o.props.componentTreeId.contextIdentifier,T=v===A.HalfPane&&o.isActiveReply(),b=o.props.displayMode===Se.CardPostCommitPending||o.props.displayMode===Se.ReplyPostCommitPending,I=_f({id:o.props.id,renderContextType:v},o.props.isNewThread);return o.logCardRendered(),Ct.createElement(nr,m({onFocus:o.onCardFocus,style:[h,o.props.style],accessibilityElementsHidden:!o.isSelectionWithinCard()&&v===A.HalfPane,nodeId:I,nodeData:o.getComponentDelegate,ref:o.cardRootRef,accessible:!0,accessibilityLabel:o.props.accessibilityLabel,accessibilityDescription:o.props.accessibilityDescription,accessibilityRole:Q()==="win32"?"treeitem":void 0,accessibilityPositionInSet:o.props.accessibilityPositionInSet,accessibilitySetSize:o.props.accessibilitySetSize,accessibilityLevel:(l=o.props.accessibilityLevel)!==null&&l!==void 0?l:1,accessibilityState:{expanded:o.props.cardCollapsedState===Rt.Expanded,selected:o.props.selected},accessibilityActions:o_(["Expand","Collapse"]),onAccessibilityAction:o.onAccessibilityAction,testID:I,onFocusStateChange:o.onFocusStateChange,onPress:o.onPress,onKeyDown:Q()==="win32"?o.onKeyDown:void 0,isTabbable:o.props.isTabbable,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,animationClass:TT(a),onLayout:o.onCardLayout,accessibilityAnnotation:FA(!!o.props.isUIAAnnotationPatternEnabled,o.props.author,o.props.timestamp,y),nativeID:o.getCardAnnotationId(v,y,o.props.id,o.props.isNewThread),onAccessibilityOrKeyPress:o.toggleExpansion},o.hoverManager.viewProps),o.renderCardBackground(d,a),o.renderResolvedOrTaskTopper(a),fe()&&o.renderCardHeader(),Ct.createElement(zr,{style:g,onLayout:o.onLayout,animationClass:TT(a)},T?Ct.createElement(vT,{leftButton:{buttonTitle:o.props.localizationAPI.getString(15),buttonPress:o.onAttemptDiscardDraft,nextFocusRight:(p=o.cardDraftBoxRef.current)===null||p===void 0?void 0:p.getEditorWrapperRefHandle()}},Ct.createElement(ee,{style:vr},o.getCommentCardInnerContent(a,d,c))):o.props.displayMode===Se.Loading?o.renderLoadingUI(Hd):[o.getCommentCardInnerContent(a,d,c),b&&o.renderPendingUI(d)]),o.renderFocusBar(d,a))},o.render=function(){return We(o.renderWithContexts,xT,Ge,At)},o.state={cardWidth:0,focusState:ce.Unfocused,innerContentBoundHeight:o.isMaxHeightDefined()?hO:void 0,isInnerContentSufficientlyScrolled:!1},o._postListSizes={postListHeight:0,postContentHeight:0},o.onAttemptDiscardDraft=o.onAttemptDiscardDraft.bind(o),o.onExpand=o.onExpand.bind(o),o.onPost=o.onPost.bind(o),o.onEditorPress=o.onEditorPress.bind(o),o.onDraftingInputSizeChange=o.onDraftingInputSizeChange.bind(o),o.setPostScrollView=o.setPostScrollView.bind(o),o.onLayout=o.onLayout.bind(o),o.onPostScrollViewLayout=o.onPostScrollViewLayout.bind(o),o.onPostScrollViewContentSizeChange=o.onPostScrollViewContentSizeChange.bind(o),o.getContentsAsync=o.getContentsAsync.bind(o),o.getCursorPositionAsync=o.getCursorPositionAsync.bind(o),o.getComponentDelegate=o.getComponentDelegate.bind(o),o.onEditorBlur=o.onEditorBlur.bind(o),o.onEditorEscapeRequested=o.onEditorEscapeRequested.bind(o),o.onAccessibilityAction=o.onAccessibilityAction.bind(o),o.onCardSaveDraft=o.onCardSaveDraft.bind(o),o.focus=o.focus.bind(o),o.blur=o.blur.bind(o),o._scrollAfterNewPostDebouncer=gu(function(a,d){return d},o.scrollToEndAfterNewPost.bind(o),function(){return o._postListSizes},250,1e3),o._resizeAfterPostDataChangesDebouncer=gu(function(a,d){return d},o.resizeAfterPostDataChanges,function(){return o._postListSizes},Nn?75:10),o._resizeAfterCardSizeChangesDebouncer=gu(function(a,d){return d},o.resizeAfterCardSizeChanges,function(){return o.cardHeight},Nn?75:10,Nn?250:50),o.hoverChangeEventSubscription=o.hoverManager.hoverChangeEvent.subscribe(o.onHoverChange),o}return t.prototype.isSessionActiveOrPending=function(r){return r===Se.Draft||r===Se.Reply||r===Se.DraftPreCommitPending||r===Se.ReplyPreCommitPending},t.prototype.componentDidUpdate=function(r){var n;this.isSessionActiveOrPending(r.displayMode)&&!this.isSessionActiveOrPending(this.props.displayMode)&&((n=this.cardDraftBoxRef.current)===null||n===void 0||n.clear());var o=this.props.componentTreeId.renderContextType;o===A.HalfPane&&(this.props.displayMode===Se.Reply||this.props.displayMode===Se.ReplyPreCommitPending)&&!(r.displayMode===Se.Reply||r.displayMode===Se.ReplyPreCommitPending)&&this._postScrollView&&this._postScrollView.scrollTo({x:0,y:0,animated:!1}),o===A.HalfPane&&this.props.displayMode===Se.Normal&&r.displayMode===Se.ReplyPostCommitPending&&this._scrollAfterNewPostDebouncer(this._postListSizes)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.hoverChangeEventSubscription&&this.hoverChangeEventSubscription.unsubscribe()},t.prototype.focus=function(){this.cardRootRef&&this.cardRootRef.current&&this.cardRootRef.current.focus()},t.prototype.blur=function(){this.cardRootRef&&this.cardRootRef.current&&this.cardRootRef.current.blur()},t.prototype.onEditorBlur=function(){this.props.onEditorBlur&&this.props.onEditorBlur(this)},t.prototype.onEditorEscapeRequested=function(){(it()||Q()==="win32")&&this.focus()},t.prototype.getContentsAsync=function(){return this.cardDraftBoxRef.current?this.cardDraftBoxRef.current.getContentsAsync():(x().assertConditionTag(!1,"Draft input box not set",593799008),Promise.resolve(Ed))},t.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},t.prototype.setPostScrollView=function(r){this._postScrollView=r},t.prototype.onPostScrollViewLayout=function(r){this._postListSizes.postListHeight=r.nativeEvent.layout.height},t.prototype.onPostScrollViewContentSizeChange=function(r,n){this._postListSizes.postContentHeight=n,this.isMaxHeightDefined()&&(this.scrollableContentLayoutInProgress||(this.scrollableContentLayoutInProgress=!0,this._resizeAfterPostDataChangesDebouncer(this._postListSizes)))},t.prototype.getCardHeightExcludingInnerContent=function(){if(!(!this.isMaxHeightDefined()||this.state.innerContentBoundHeight===void 0))return this.cardHeight-this.state.innerContentBoundHeight},t.prototype.getCardMaxHeight=function(){var r;return((r=this.props.maximumDimensions)===null||r===void 0?void 0:r.height)!==void 0?Math.max(this.props.maximumDimensions.height,YK):void 0},t.prototype.isMaxHeightDefined=function(){var r;return((r=this.props.maximumDimensions)===null||r===void 0?void 0:r.height)!==void 0},t.prototype.calculateInnerContentBoundHeight=function(){var r=this.getCardMaxHeight(),n=this.getCardHeightExcludingInnerContent();if(!(r===void 0||n===void 0)){var o;o=Math.max(Math.min(r-n,this._postListSizes.postContentHeight+gOe),hO);var a=4-o%4;return a<4&&(o+=a),o}},t.prototype.updateScrollViewBoundHeight=function(){this.scrollableContentLayoutInProgress||this.cardLayoutInProgress||this.setState({innerContentBoundHeight:this.calculateInnerContentBoundHeight()})},t.prototype.onPost=function(r){this.props.onPost(this,r)},t.prototype.onExpand=function(r){this.props.onCardSelectExpand(this,r,Q()==="win32"&&(this.state.focusState===ce.Unfocused||!r&&this.props.selected&&this.state.focusState===ce.FocusWithin))},t.prototype.scrollToEndAfterNewPost=function(r){if(!(this.props.displayMode!==Se.Normal||this.props.componentTreeId.renderContextType!==A.HalfPane||!this.isSelectionWithinCard())){if(r.postContentHeight!==this._postListSizes.postContentHeight||r.postListHeight!==this._postListSizes.postListHeight)return this._postListSizes;this._postScrollView&&this._postScrollView.scrollTo({x:0,y:MA(!0,r.postListHeight,r.postContentHeight,0,r.postContentHeight),animated:!1})}},t.prototype.renderRootPost=function(r){if(r.length!==0)return r[0]},t.prototype.renderFooterReply=function(r){var n=r.length-1;if(!(n<=1))return r[n]},t.prototype.renderOverflowReplies=function(r,n){if(!(n.length<=1)){var o=n.length>2;if(!(o&&this.props.cardCollapsedState===Rt.Collapsed)){var a=1,d;return n.length===2?d=n.length:d=n.length-1,Ct.createElement(kA,{style:[vr,L0],key:"overflow-posts",animationClass:yOe(r),shouldRenderView:n.length>2},Ct.createElement(Ct.Fragment,null,n.slice(a,d)))}}},t.prototype.getWrappedContent=function(r,n){var o=Ct.Children.toArray(this.props.children),a=this.renderRootPost(o);if(!a)return null;var d=[a];if(this.props.cardCollapsedState===Rt.Collapsed){var c=this.renderExpandButton({animationClass:COe(n),minimumMarginLeftRight:wv(this.state.focusState,this.isSelectionWithinCard()),onPress:this.onExpandButtonPress});d.push(c)}if(!fe()||this.props.displayMode!==Se.Resolved||this.props.cardCollapsedState===Rt.Expanded){var u=this.renderOverflowReplies(n,o),l=this.renderFooterReply(o),p=u||l?Ct.createElement(ee,{style:[vr,L0],key:"all-replies",animationClass:vOe(n)},u,l):void 0;d.push(p)}if(fe()||d.push(this.renderCardHeader()),this.props.componentTreeId.renderContextType===A.HalfPane&&!this.props.disableScroll)return Ct.createElement(ee,{style:vr,key:"content",testID:SW()},Ct.createElement(bT.ScrollView,{keyboardShouldPersistTaps:"always",ref:this.setPostScrollView,scrollEnabled:this.props.isTabbable,onLayout:this.onPostScrollViewLayout,onContentSizeChange:this.onPostScrollViewContentSizeChange,testID:IW()},d));var g=[vr,L0];fe()&&r&&g.push(uY);var h=this.isMaxHeightDefined(),v=d;return h&&(v=Ct.createElement(bT.ScrollView,{ref:this.setPostScrollView,onContentSizeChange:this.onPostScrollViewContentSizeChange,onScroll:this.onScroll,style:{height:this.state.innerContentBoundHeight}},d)),Ct.createElement(zr,{style:g,key:"content",animationClass:TT(n)},v)},t.prototype.getCommentCardInnerContent=function(r,n,o){this.notifyRenderedOnce();var a=this.props.hideDraftBox||this.props.isReadOnly||this.props.displayMode===Se.Resolved,d=this.getWrappedContent(a,r),c;!fe()&&this.props.displayMode===Se.Resolved?c=this.renderCommandBar(r):a||(c=this.renderCardDraftBox(r));var u=!fe()&&this.renderDraftBoxMessage(!1),l=this.props.hasLowFidelityChild&&this.renderLowFidelityFooter(r,n,o);return[d,c,u,l]},t.prototype.onEditorPress=function(){this.isActiveReply()||this.isActiveDraft()||this.props.onEditorPress(this)},t.prototype.onAttemptDiscardDraft=function(){this.props.onCancel(this)},t.prototype.renderStyle=function(r,n){return Je(r,n,this.props.componentTreeId.renderContextType)},t.prototype.getCommandBarItems=function(){var r=this;return this.props.menuItems.map(function(n){var o;return{id:UI({id:r.props.id,renderContextType:r.props.componentTreeId.renderContextType},(o=n.id)!==null&&o!==void 0?o:n.text),text:n.text,onClick:function(){n.onClick(r.props.id)},accessibilityLabel:Q()==="win32"?n.text:void 0,icon:n.icon,isTabbable:r.props.isTabbable}})},t.prototype.renderCommandBar=function(r){var n=this.getCommandBarItems();if(n.length!==0)return Ct.createElement(QH,{actions:n,key:"heroBar",preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:HA(r)})},t.prototype.getDraftBoxMaxHeight=function(){var r=this.getCardMaxHeight();if(r){var n=Math.round(r/4);return this.props.maxDraftHeight===void 0?n:Math.min(n,this.props.maxDraftHeight)}return this.props.maxDraftHeight},t.prototype.renderCardDraftBox=function(r){var n=this.isActiveDraft(),o=this.isActiveReply(),a=this.props.componentTreeId.renderContextType,d;fe()?d=o||n:d=Ld(a)&&o||a===A.HalfPane&&n;var c=this.props.displayMode===Se.Reply||this.props.displayMode===Se.Draft,u=this.props.displayMode===Se.ReplyPreCommitPending||this.props.displayMode===Se.DraftPreCommitPending,l=z8(this.props.localizationAPI,this.props.supportsAtMentions,n,this.props.cardRelativeDraftingState),p=$o.None;c?p=$o.Editing:u&&(p=$o.Pending);var g=Z8(this.props.localizationAPI,this.props.displayMode,!!this.props.taskTopperProps,this.props.selectedTaskAssignee);return Ct.createElement(lfe,{draftWarningState:this.props.draftWarningState,availableScreenHeight:this.props.availableScreenHeight,cancelLabel:n||o?this.props.localizationAPI.getStringOrUndefined(15):void 0,sendLabel:g,id:NI({id:this.props.id,renderContextType:a}),parentId:this.props.id,editMode:p,isNewComment:n,isTabbable:this.props.isTabbable,maxDraftHeight:this.getDraftBoxMaxHeight(),richTextCapabilities:this.props.richTextCapabilities,mentionEditorProps:this.props.mentionEditorProps,onCancel:this.onAttemptDiscardDraft,onInputSizeChange:this.onDraftingInputSizeChange,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onEditorMount:this.onEditorMount,onUnmount:this.onCardSaveDraft,onPost:this.onPost,onPress:this.onEditorPress,onFocus:this.onEditorFocus,onBlur:this.onEditorBlur,onEscapePressed:this.onEditorEscapeRequested,placeholder:l,shouldRestoreDraftOnMount:this.isSessionActiveOrPending(this.props.displayMode),showCancel:d,peoplePickerWidth:this.state.cardWidth,extraPaddingLeft:this.props.extraPaddingLeft,extraPaddingRight:this.props.extraPaddingRight,sendTestID:pW({id:this.props.id,renderContextType:a}),cancelTestID:n&&fe()?HI({id:this.props.id,renderContextType:a}):mW({id:this.props.id,renderContextType:a}),savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,ref:this.cardDraftBoxRef,key:"draftBox",isEditorFocusable:!this.props.cardRelativeDraftingState||this.props.cardRelativeDraftingState===cr.InCard,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,animationClass:HA(r),taskAssigner:this.getTaskAssignerProps(),isCardHovered:this.props.highlightCard,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,telemetryId:this.props.draftId,localizationAPI:this.props.localizationAPI})},t.prototype.shouldHideActions=function(){return this.props.displayMode===Se.Resolved||this.props.displayMode===Se.CardPostCommitPending},t.prototype.renderResolvedOrTaskTopper=function(r){if(fe()){var n={cardTopperContainerProps:{animationClass:HA(r),margin:wv(this.state.focusState,this.isSelectionWithinCard())},preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,resolvedButtonsProps:this.props.displayMode===Se.Resolved?this.getCommandBarItems():void 0};return this.renderResolvedOrTaskTopperHelper(n)}},t.prototype.renderCardHeader=function(){if(!this.props.hideHeader&&!(fe()&&this.props.displayMode===Se.Loading))return Ct.createElement(yre,{key:"header",id:this.props.id,author:this.props.author,isResolvedCard:this.props.displayMode===Se.Resolved,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,cardCollapsedState:this.props.cardCollapsedState,onCancelDraft:this.onAttemptDiscardDraft,menuItems:this.props.menuItems,extraPaddingLeft:this.props.extraPaddingLeft,extraPaddingRight:this.props.extraPaddingRight,rootAuthorOpacity:this.state.isInnerContentSufficientlyScrolled?0:1,hideActions:this.shouldHideActions(),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,preventReacting:this.props.preventReacting,anchorText:this.props.anchorText,isTabbable:this.props.isTabbable,cardBorderWeight:wv(this.state.focusState,this.isSelectionWithinCard()),allowRootEditButton:this.props.allowRootEditButton,onEditRootPost:this.props.onEditRootPost,isCardHovered:this.props.highlightCard,reactionButtonProps:this.props.userReactionSummary?this.createMemoizedReactionButtonProps(this.props.id,this.props.componentTreeId.renderContextType,this.props.isTabbable,this.props.onReactionUpdated,Ai.Like,this.props.localizationAPI,this.props.preventDefaultKeyDownBehavior,this.props.preventReacting,this.props.userReactionSummary):void 0})},t.prototype.renderFocusBar=function(r,n){if(Ld(this.props.componentTreeId.renderContextType)&&!fe()){var o=[this.renderStyle(sY,r)];return(this.isSelectionWithinCard()||this.props.highlightCard||this.state.focusState===ce.FocusOn)&&o.push(this.renderStyle(dY,r)),Ct.createElement(ee,{style:o,key:"focusBar",animationClass:TT(n)})}},t.prototype.onDraftingInputSizeChange=function(r){this.props.onDraftingInputSizeChange(this,r)},t.prototype.renderLoadingUI=function(r){var n={id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType};return Ct.createElement(ee,{testID:kW(n),style:cY},Ct.createElement(Wp,{delay:r},Ct.createElement(jfe.Spinner,{size:"large"})))},t.prototype.renderPendingUI=function(r){var n=fe()?Hd:void 0,o=fe()?void 0:Hd,a;fe()?r.themeId===7?a=r.palette.CardReplyBackground:a=!Uo()&&this.props.highlightCard?"".concat(r.palette.CardHoveredBackground,"7F"):"".concat(r.palette.CardReplyBackground,"7F"):a=r.themeId===7?r.palette.CardReplyBackground:"".concat(r.palette.CardReplyBackground,"7F");var d=[this.renderStyle(tY,r),{backgroundColor:a}];return Ct.createElement(Wp,{delay:n,key:"spinner"},Ct.createElement(ee,{style:this.renderStyle(eY,r)},Ct.createElement(ee,{style:d},this.renderLoadingUI(o))))},t.prototype.renderLowFidelityFooter=function(r,n,o){if(Q()==="win32"){var a=Ht(o),d=Ca({icon:26,themeId:n.themeId,renderTarget:"Pane"}),c=this.props.localizationAPI.getString(237),u=this.props.localizationAPI.getString(238),l=wv(this.state.focusState,this.isSelectionWithinCard());return Ct.createElement(ee,{style:lY(l),animationClass:HA(r)},Ct.createElement(ee,{style:this.renderStyle(fY(l),n)},d&&Ct.createElement(bT.Image,{source:d.source,style:pY}),Ct.createElement(ee,{style:mY},Ct.createElement(qe,{textStylePolyester:"MediumBold",variantFluent:"secondarySemibold",colorFluent:a.subTextColor},c),Ct.createElement(qe,{textStylePolyester:"MediumSecondary",variantFluent:"secondaryStandard",colorFluent:a.subTextColor},u))))}},t.prototype.getComponentDelegate=function(){return this},t.prototype.onAccessibilityAction=function(r){if(r)switch(r.nativeEvent.actionName){case"Expand":this.props.cardCollapsedState!==Rt.Expanded&&this.onExpand(!1);return;case"Collapse":this.props.cardCollapsedState!==Rt.Collapsed&&this.props.onCardCollapse(this)}},t}(CM);xOe=Xd(hOe,{componentTreeId:tn},CM.DisplayName),Wfe=xOe});var Gfe,qfe,Kfe,Yfe,$fe=f(()=>{"use strict";s();Gfe=S(Kr());xr();je();qfe=new kt([kt.always({flexDirection:"row",marginBottom:4,alignItems:"center"})]),Kfe=Gfe.StyleSheet.createViewStyle({marginLeft:5,flex:1}),Yfe=ve({height:12,width:12,flex:0,marginTop:2})});var zp,Qfe,bOe,BA,aB=f(()=>{"use strict";s();zp=S(L()),Qfe=S(re());Kn();Js();dn();je();rr();mr();gn();$fe();bOe=zp.memo(function(t){var r=$g(),n=Vi().renderContextType,o=Ca({icon:t.icon,themeId:r.themeId,renderTarget:"Pane"});return zp.createElement(ee,{style:qfe.render(Wr(n))},o&&zp.createElement(ee,{style:Yfe},zp.createElement(Qfe.Image,{source:o.source,style:vr})),zp.createElement(qe,{numberOfLines:1,style:Kfe,accessible:!1,tooltip:t.description},t.description))}),BA=bOe});var Xfe,Jfe=f(()=>{"use strict";s();go();xr();Xfe=new kt([kt.rule({isFluentEnabled:!1},{marginTop:U0}),kt.rule({isFluentEnabled:!0},{marginTop:3})])});var UA,iy,Zfe=f(()=>{"use strict";s();Oe();UA=S(L());ye();Tr();yo();Pr();dn();gn();Jfe();iy=UA.memo(function(t){var r=function(o){var a=Ht(o);return UA.createElement(qe,{style:Xfe.render(Wr(t.renderContextType)),textStylePolyester:fe()?"SmallSecondary":"SmallStandard",colorFluent:a.subTextColor,variantFluent:"captionStandard",accessible:Q()==="win32"?!1:void 0},t.timestamp)};return We(r,At)});iy.displayName="RenderableItemTimestamp"});var sB=f(()=>{"use strict";s();Zfe()});var ay,IOe,dB,epe=f(()=>{"use strict";s();k();ay=S(L());ye();gl();kv();r_();aB();sB();lr();IOe=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.onFocusParent=function(){return r.props.onFocusParent(r)},r.saveDraftIfEditing=function(n){var o=r.isEditingOrPending(r.props.postDisplayMode);o&&r.props.onSaveDraft(r.getId(),n)},r}return Object.defineProperty(t.prototype,"textEditorRef",{get:function(){return this._textEditorRef},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.props.onPostMounted(this.props.id)},t.prototype.componentWillUnmount=function(){this.textEditorRef&&this.saveDraftIfEditing(this.textEditorRef)},t.prototype.setContents=function(r){this.textEditorRef&&this.textEditorRef.setContents(r)},t.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():Promise.resolve("")},t.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():Promise.resolve(void 0)},t.prototype.getId=function(){return this.props.id},t.prototype.isEditingOrPending=function(r){return r===ze.Editing||r===ze.EditPreCommitPending},t.prototype.renderTimestamp=function(){if(!(this.props.collapsed||this.props.postDisplayMode===ze.New_nonFluent||this.isEditingOrPending(this.props.postDisplayMode))){var r=this.props.componentTreeId.renderContextType;return ay.createElement(iy,{timestamp:this.props.timestamp,id:BI({id:this.props.id,renderContextType:r}),renderContextType:r,resolved:this.props.postDisplayMode===ze.Resolved})}},t.prototype.getActionBarItemsAsButtonProps=function(r){var n=this;return r.actionBarItems.map(function(o,a){var d=o.id,c=o.onClick,u=Ke(o,["id","onClick"]);return m(m({},u),{id:CW({id:r.id,renderContextType:n.props.componentTreeId.renderContextType},a),onClick:function(){return o.onClick(n)},onKeyDown:function(p){var g;return(g=o.onKeyDown)===null||g===void 0?void 0:g.call(o,p,n)},isTabbable:r.isTabbable})})},t.prototype.getNumberOfHistoryItemsToRender=function(){return!at()||this.props.collapsed?0:this.props.taskHistoryProps.length},t.prototype.renderHistoryItemContent=function(){if(this.props.taskHistoryProps.length!==0&&this.getNumberOfHistoryItemsToRender()!==0)return this.props.taskHistoryProps.map(function(r,n){return ay.createElement(BA,m({},r,{key:r.description}))})},t.prototype.renderDraftBoxMessage=function(r){if(!Tn())return null;var n=this.props.draftWarningState;return!n&&!r?null:ay.createElement(pp,{key:"draftBoxMessage",draftWarningState:n,localizationAPI:this.props.localizationAPI,target:Md.Post,id:n?jm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Wm({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:r})},t.DisplayName="CommentPost",t}(ay.PureComponent),dB=IOe});var VA,cB,tpe=f(()=>{"use strict";s();k();VA=S(L());DM();cB=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return VA.createElement(Cx,{buttons:this.props.actions,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior})},t}(VA.PureComponent)});var rpe=f(()=>{"use strict";s();tpe()});function npe(e){var t=e;return typeof t.renderContextType<"u"&&typeof t.warningLabel=="string"&&typeof t.confirmLabel=="string"}var ope=f(()=>{"use strict";s()});var ipe,ST,EOe,uB,ape=f(()=>{"use strict";s();k();Pt();ipe=S(Kr()),ST=S(L());Gc();mr();EOe=js(ipe.HyperlinkButton),uB=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.refManager=new nf,r.focus=r.refManager.focus,r.blur=r.refManager.blur,r.getFocusState=r.refManager.getFocusState,r.getChildNodes=r.refManager.getChildNodes,r.addChildNode=r.refManager.addChildNode,r.getDescendantById=r.refManager.getDescendantById,r.getId=r.refManager.getId,r.getData=r.refManager.getData,r.isTabbable=r.refManager.isTabbable,r.getNextTabTarget=r.refManager.getNextTabTarget,r.getIterator=r.refManager.getIterator,r}return t.prototype.render=function(){var r=this.props,n=r.preventDefaultKeyDownBehavior,o=r.onMouseEnter,a=r.onMouseLeave,d=Ke(r,["preventDefaultKeyDownBehavior","onMouseEnter","onMouseLeave"]),c=Cs(this.props.preventDefaultKeyDownBehavior,De.Capturing);return ST.createElement(ee,{accessible:!1,focusable:!1,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,keyDownEvents:c},ST.createElement(EOe,m({},d,{ref:this.refManager.ref,isTabbable:this.props.isTabbable&&!this.props.disabled,preventDefaultKeyDownBehavior:void 0})))},t}(ST.Component)});var spe,POe,bmr,Smr,Imr,dpe,Emr,Pmr,_mr,Rmr,cpe,upe=f(()=>{"use strict";s();k();spe=S(Kr());Fd();Ve();zc();go();xr();je();POe="rgba(255,255,255,0.65)",bmr=ve({flex:1}),Smr=new R([R.always(function(e){return{backgroundColor:e.palette.CardBackground}}),R.rule({displayClass:$t.LargeDisplay,renderContextType:A.HalfPane},{maxWidth:278}),R.rule({displayClass:$t.LargeDisplay},function(e){return{borderWidth:rs,borderColor:e.palette.CardAccent}}),R.rule({displayClass:$t.SmallPhone},{flex:1})]),Imr=new R([R.always({position:"absolute",alignItems:"center",justifyContent:"center",paddingLeft:16,paddingRight:16,backgroundColor:POe,height:"100%",width:"100%"}),R.rule({platform:"android"},{zIndex:100})]),dpe=new R(w(w([R.always({flex:0,padding:16,justifyContent:"center"}),R.rule({renderContextType:A.HalfPane,displayClass:$t.SmallPhone},{flex:1})],V(j0),!1),[R.rule({platform:"win32"},{flexDirection:"row",paddingLeft:16,paddingBottom:16}),R.rule({platform:"win32",renderContextType:A.DiscreteIsolated},{paddingLeft:16+Rr+Gg})],!1)),Emr=new R([R.always(function(e){return{flexDirection:"row",flex:0,borderTopColor:e.palette.CardAccent,borderTopWidth:1,alignItems:"stretch"}})]),Pmr=new R([R.always({flex:1,alignContent:"center",justifyContent:"center",height:48}),R.rule({renderContextType:A.FullPane},{height:32}),R.rule({displayClass:$t.LargeDisplay},function(e){return{backgroundColor:e.palette.CardReplyBackground}})]),_mr=new R([R.always(function(e){return{borderLeftColor:e.palette.ButtonBorder,borderLeftWidth:1}})]),Rmr=spe.StyleSheet.createViewStyle({textAlign:"center"}),cpe=ve({flexDirection:"column",flex:1})});var lpe,fpe,ppe,mpe,lB,gpe=f(()=>{"use strict";s();je();lpe=ve({width:32,paddingTop:4}),fpe=ve({paddingRight:16,height:16,width:16}),ppe=ve({marginRight:14}),mpe=ve({flexDirection:"row",paddingTop:10}),lB=ve({marginRight:10})});var Zo,hpe,IT,ype=f(()=>{"use strict";s();k();Oe();Pt();Zo=S(L()),hpe=S(re());ope();gx();Ws();px();lr();Tr();yo();Js();je();rr();ape();mr();gn();upe();gpe();IT=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.setFocusState=function(o){return n.setState({focusState:o})},n.renderWithTheme=function(o,a){if(!npe(n.props))return Zo.createElement(Zo.Fragment,null,Zo.Children.only(n.props.children));var d=Ht(a),c=n.state.focusState,u=Ca({icon:19,themeId:o.themeId,renderTarget:"Pane"});return Zo.createElement(zr,{style:[n.renderStyle(dpe,n.props,o),c===ce.FocusOn&&n.renderStyle(Ph,n.props,o)],accessibilityLabel:n.props.warningLabel,isTabbable:!0,accessible:!0,focusable:!0,onFocusStateChange:n.setFocusState,onStartShouldSetResponder:Fl,preventDefaultKeyDownBehavior:n.props.preventDefaultKeyDownBehavior,nodeId:n.props.nodeId},u&&Zo.createElement(ee,{style:lpe},Zo.createElement(hpe.Image,{source:u.source,style:fpe})),Zo.createElement(ee,{style:cpe},Zo.createElement(qe,{textStylePolyester:"MediumSecondary",variantFluent:"secondaryStandard",colorFluent:d.subTextColor,style:ppe},n.props.warningLabel),Zo.createElement(ee,{style:mpe},Zo.createElement(uB,{onClick:n.props.onConfirm,isTabbable:!0,text:n.props.confirmLabel,style:lB,preventDefaultKeyDownBehavior:n.props.preventDefaultKeyDownBehavior,nodeId:PW()}),Zo.createElement(uB,{onClick:n.props.onCancel,isTabbable:!0,text:n.props.cancelLabel,style:lB,preventDefaultKeyDownBehavior:n.props.preventDefaultKeyDownBehavior,nodeId:_W()}))))},n.render=function(){return We(n.renderWithTheme,Ge,At)},n.state={focusState:ce.Unfocused},n}return t.prototype.renderStyle=function(r,n,o){return Je(r,o,n.renderContextType)},t}(Zo.PureComponent)});var fB=f(()=>{"use strict";s();ype()});function jA(e,t,r,n){var o,a;return e===Mt.Edit?(o=37,a=35):(o=2,a=36),{renderContextType:r,cancelLabel:n.getString(15),confirmLabel:n.getString(o),warningLabel:n.getString(a),onCancel:t.onCancel,onConfirm:t.onConfirm}}var pB=f(()=>{"use strict";s();so()});var AOe,Cpe,vpe=f(()=>{"use strict";s();k();Ws();AOe=zr,Cpe=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.getNextTabTarget=function(n,o){var a=e.prototype.getNextTabTarget.call(r,n,o);return a||r.props.disabled?a:e.prototype.getNextTabTarget.call(r,n,!0)},r}return t}(AOe)});function ET(e){return e===ze.LowFidelityWarningDelete||e===ze.LowFidelityWarningEdit}var mB=f(()=>{"use strict";s();gl()});function DOe(e,t,r){return!!(Q()!=="win32"&&e!==ze.Editing&&e!==ze.EditPreCommitPending&&!t&&r.items.length)}function wOe(e,t,r,n,o,a,d,c,u){var l=o!==ze.New_nonFluent;if(l){if(e&&DOe(o,a,e))return function(){return Gp.ContextualMenu.showContextualMenu(e,u.current)};var p=a||!d&&Q()==="win32",g=!t&&Q()==="win32"&&r===ce.Unfocused;if(g||p)return function(){return n(c,g)}}}var Gp,Ft,xpe,kOe,FOe,Tpe,bpe=f(()=>{"use strict";s();k();rt();te();Oe();Pt();Gp=S(Kr()),Ft=S(L()),xpe=S(re());lS();ln();ye();vl();so();n_();sg();gl();Ve();epe();gx();DN();zH();rpe();Ih();IM();DA();EM();PM();WH();fB();pB();rB();yx();FN();mr();gn();Xa();Ws();vpe();B_();yi();nB();OA();yM();Vo();lr();Tr();Kn();NA();yo();Pr();mB();go();dn();je();rr();kh();PA();FC();kOe=function(e){Z(t,e);function t(r,n){var o=e.call(this,r,n)||this;return o._postContainerRef=Ft.createRef(),o.hoverManager=new Ah,o.fullPanePickerTarget=Ft.createRef(),o.rteRef=Ft.createRef(),o.getMenuPopover=Qe(H_),o.onHoverChange=function(a){o.setState({isHovered:a})},o.onFocusStateChange=function(a){o.setState({focusState:a})},o.onDraftEmptinessChanged=function(a){o.props.onDraftEmptinessChanged(o,a)},o.onEditorHeightChange=function(a){o.setState({editorHeight:a})},o.onEditorMount=function(){o.props.onPostEditorMounted(o.props.id)},o.onEditorFocusChange=function(a){o.setState({editorFocusState:a})},o.onEdit=function(){o.props.onEdit(o.props.id)},o.createOnPressHandler=QT({},wOe,function(){return[o.state.focusState,o.props.onSelect,o.props.postDisplayMode,o.props.collapsed,!!o.props.selected,o,o._postContainerRef]}),o.createMemoizedContextualMenuProps=Qe(function(a,d,c){if(Q()!=="win32")return Rh(a,d,c)}),o.getFullDescriptionForBody=vn(function(a,d,c){if(a===0)return Wu(c);var u=d.reduce(function(l,p){return"".concat(l).concat(p.description," ")},"");return"".concat(u).concat(Wu(c))},function(){return[o.getNumberOfHistoryItemsToRender(),o.props.taskHistoryProps,o.props.commentBody]}),o.setEditorWrapperRef=function(a){o.setState({editorWrapperRef:a})},o.onActionMenuOpened=function(){!o.props.selected&&Q()==="win32"&&o.props.onSelect(o,!1)},o.renderPostHeader=function(a,d){if(!(o.props.parent&&fe())){var c=Ft.createElement(qe,{style:o.renderStyle(__,a),variantFluent:"bodySemibold",textStylePolyester:"MediumBold",disabled:Q()!=="win32"&&d.isResolved,numberOfLines:fe()?void 0:1,accessible:Q()==="win32"?!1:void 0},Fr(o.props.author));if(!fe())return c;var u=d.shouldShowUpperRightActions?"visible":"hidden",l=o.renderEditButton(a,u),p=o.renderActionMenu(a,u),g=o.renderReactionButton(d.shouldShowUpperRightActions);return no()?Ft.createElement(zr,{style:o.renderStyle(xM,a)},c,p,l,g):Ft.createElement(zr,{style:o.renderStyle(xM,a)},c,l,p)}},o.onCollapseParent=function(){return o.props.onCollapseParent(o)},o.renderWithContexts=function(a,d,c){var u=fe()&&ET(o.props.postDisplayMode),l=o.props.postDisplayMode===ze.Resolved,p=o.props.componentTreeId.renderContextType,g,h;fe()?(g=!u&&o.isInEdit()&&Ld(p),h=!o.props.collapsed&&(o.props.selected||o.state.isHovered)&&!o.isInEdit()):(g=!u&&o.isInEdit()&&Ld(p),h=!1);var v=[o.renderStyle(P_,d)],y=p===A.HalfPane&&o.isEditingOrPending(o.props.postDisplayMode);!y&&o.isReply()&&v.push(o.renderStyle(R_,d)),g&&v.push(Wte),Q()==="win32"&&o.state.focusState===ce.FocusOn&&v.push(o.renderStyle(Ph,d)),fe()&&o.props.collapsed&&o.props.postDisplayMode===ze.Resolved?v.push(o.renderStyle(Y0,d)):fe()&&!Uo()&&o.props.isCardHovered?v.push(o.renderStyle($0,d)):v.push(o.renderStyle(K0,d));var T=jg(v,0,o.props.extraPaddingRight,0,o.props.extraPaddingLeft),b=[o.renderStyle(k_,d)];fe()&&o.isInEdit()&&b.push(zte);var I=o.props.parent&&fe();I&&b.push(Gte);var E=[];if(u)E=[o.renderLowFidelityWarning()];else{var P=o.createMemoizedContextualMenuProps(d.themeId,o.props.actionBarItems,o.props.id);E=[Ft.createElement(nr,{key:"contents",ref:o._postContainerRef,accessibilityLabel:o.props.accessibilityLabel,accessibilityRole:Q()==="win32"?"treeitem":"button",isTabbable:o.props.isTabbable&&(!o.isInEdit()||Q()==="win32"),nodeId:Qa({componentType:X.Post,id:o.props.id,renderContextType:p}),accessibilityState:o.props.selected?t.selectedAccessibilityState:void 0,testID:LI({id:o.props.id,renderContextType:p}),onFocusStateChange:o.onFocusStateChange,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior,onPress:o.createOnPressHandler(P,!1),accessibilityPositionInSet:o.props.accessibilityPositionInSet,accessibilitySetSize:o.props.accessibilitySetSize,accessibilityLevel:o.props.accessibilityLevel,accessible:!0,onAccessibilityOrKeyPress:!o.props.collapsed&&o.props.parent?o.onCollapseParent:void 0,accessibilityDescription:Q()==="win32"?o.getFullDescriptionForBody():void 0,accessibilityAnnotation:o.isReply()?FA(!!o.props.isUIAAnnotationPatternEnabled,o.props.author,o.props.timestamp,o.props.componentTreeId.contextIdentifier):void 0},Ft.createElement(ee,{style:T},Ft.createElement(Ft.Fragment,null,!I&&Ft.createElement(va,{accessible:Q()==="win32",isTabbable:o.props.isTabbable&&Q()==="win32",disabled:!fe()&&l,nodeId:zm({id:o.props.id,renderContextType:p}),size:fe()?Gp.PersonaImageSize.extraSmall:Gp.PersonaImageSize.small,author:o.props.author,preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior}),Ft.createElement(Cpe,{nodeId:"post-ftz",style:Q()==="win32"?b:vr,focusable:Q()==="win32"?!1:void 0,pointerEvents:Q()==="win32"?"box-none":void 0,disabled:!o.isInEdit()||it()},Ft.createElement(kA,{shouldRenderView:Q()!=="win32",style:b},Ft.createElement(Ft.Fragment,null,o.renderPostHeader(d,{isResolved:l,shouldShowUpperRightActions:h}),E_(o.props)&&Ft.createElement(ox,{dotType:o.props.parent?ss.RootPost:ss.ReplyPost,historyItemCount:o.getNumberOfHistoryItemsToRender(),renderContextType:p}),o.renderHistoryItemContent(),o.props.postDisplayMode!==ze.New_nonFluent&&o.renderTextViewOrEditor(d,c,P),o.renderTimestamp(),fe()&&o.renderDraftBoxMessage(!1),g&&Ft.createElement(cB,{actions:o.getActionBarItemsAsButtonProps(o.props),barContainerStyle:o.renderStyle(Vte,d),buttonStyle:o.renderStyle(jte,d),preventDefaultKeyDownBehavior:o.props.preventDefaultKeyDownBehavior}),!fe()&&o.renderDraftBoxMessage(!1))))))),!fe()&&o.props.postDisplayMode===ze.EditPreCommitPending&&Ft.createElement(ee,{style:o.renderStyle(qte,d),key:"Spinner"},Ft.createElement(Wp,{delay:Hd},Ft.createElement(Gp.Spinner,{size:"large"})))]}return Ft.createElement(ee,m({style:o.renderStyle(A_,d),onLayout:o.onLayout,animationClass:a!==Xi.None?"CommentCard_Reply":void 0,ref:o.fullPanePickerTarget},o.hoverManager.viewProps),o.isInEdit()&&p===A.HalfPane?Ft.createElement(vT,{leftButton:{buttonTitle:o.props.localizationAPI.getString(15),buttonPress:o.onCancel},rightButton:{buttonTitle:o.props.localizationAPI.getString(14),buttonPress:o.onCommitButtonClick},showShadow:!0},Ft.createElement(xpe.ScrollView,{keyboardShouldPersistTaps:"always"},E)):E)},o.render=function(){return We(o.renderWithContexts,xT,Ge,At)},o.onCommit=o.onCommit.bind(o),o.onCommitButtonClick=o.onCommitButtonClick.bind(o),o.onCancel=o.onCancel.bind(o),o.onLayout=o.onLayout.bind(o),o.state={postWidth:void 0,isHovered:!1,focusState:ce.Unfocused,editorFocusState:ce.Unfocused,editorHeight:void 0,editorWrapperRef:null,preEditText:r.commentBody,isTransitioningToEdit:!1},o.hoverChangeEventSubscription=o.hoverManager.hoverChangeEvent.subscribe(o.onHoverChange),o}return Object.defineProperty(t.prototype,"textEditorRef",{get:function(){if(this.rteRef.current){var n=this.rteRef.current.getData();return Lp(n)?n:void 0}},enumerable:!1,configurable:!0}),t.getDerivedStateFromProps=function(r,n){return r.postDisplayMode===ze.Editing&&!n.isTransitioningToEdit?{isTransitioningToEdit:!0,preEditText:r.commentBody}:r.postDisplayMode!==ze.Editing&&n.isTransitioningToEdit?{isTransitioningToEdit:!1}:{}},t.prototype.componentDidUpdate=function(r){this.props.commentBody!==r.commentBody&&this.textEditorRef&&!this.isEditingOrPending(this.props.postDisplayMode)&&this.textEditorRef.setContents(this.props.commentBody),!this.isEditingOrPending(this.props.postDisplayMode)&&this.isEditingOrPending(r.postDisplayMode)&&this.props.postDisplayMode!==ze.PendingEdit&&this.textEditorRef&&this.textEditorRef.setContents(this.props.commentBody),x().assertConditionTag(this.props.draftId===void 0||this.isEditingOrPending(this.props.postDisplayMode),"post has draft state and is not in editing mode",593802706)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.hoverChangeEventSubscription&&this.hoverChangeEventSubscription.unsubscribe()},t.prototype.isInEdit=function(){return this.isEditingOrPending(this.props.postDisplayMode)},t.prototype.isReply=function(){return!this.props.parent},t.prototype.onCommit=function(r){this.props.onCommit(this,r)},t.prototype.onCommitButtonClick=function(){this.onCommit(qn.CommitButton)},t.prototype.onCancel=function(){this.props.onCancel(this)},t.prototype.renderStyle=function(r,n){return Je(r,n,this.props.componentTreeId.renderContextType)},t.prototype.onLayout=function(r){this.setState({postWidth:r.nativeEvent.layout.width})},t.prototype.getPickerPosition=function(){var r=this.props.componentTreeId.renderContextType===A.FullPane?this.fullPanePickerTarget.current:this.state.editorWrapperRef;if(!(!r||!this.state.postWidth))return{target:r,left:0,top:0,width:this.state.postWidth,height:this.props.availableScreenHeight||0}},t.prototype.renderLowFidelityWarning=function(){var r=this.props.componentTreeId.renderContextType;return Ft.createElement(IT,m({},jA(this.props.postDisplayMode===ze.LowFidelityWarningEdit?Mt.Edit:Mt.DeleteReply,{onCancel:this.props.onLowFidelityWarningCancel,onConfirm:this.props.onLowFidelityWarningConfirm},r,this.props.localizationAPI),{preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,key:"lowFidelityWarning",nodeId:Qa({componentType:X.Post,id:this.props.id,renderContextType:r})}))},t.prototype.renderTextViewOrEditor=function(r,n,o){var a=this.props.postDisplayMode===ze.Editing,d=a?mn.Editing:mn.ReadOnly,c=a?this.props.savedDraftContent:void 0,u=[this.renderStyle(Nte,r)],l=this.props.postDisplayMode===ze.Resolved,p=this.props.componentTreeId.renderContextType,g=!1,h=void 0;if(fe()){if(l&&this.props.collapsed&&u.push(this.renderStyle(qg,r)),this.isEditingOrPending(this.props.postDisplayMode)){if(u.push(this.renderStyle(z0,r),this.renderStyle(Mte,r)),this.state.editorFocusState!==ce.Unfocused&&u.push(this.renderStyle(G0,r)),Tn()&&this.props.draftWarningState){var v=Ht(n);u.push(ts(_A,v,p))}}else this.props.collapsed&&(u.push(Lte),g=!!(this.state.editorHeight&&this.state.editorHeight>=vM));g&&(h=this.renderStyle(this.props.collapsed&&l?Ute:!Uo()&&this.props.isCardHovered?Bte:Hte,r))}var y=this.props.isTabbable&&!g;return Ft.createElement(ee,{style:u,ref:this.setEditorWrapperRef,collapsable:!1},Ft.createElement(EA,m({nodeId:Qa({id:this.props.id,renderContextType:p,componentType:X.PostEditor}),id:MI({id:this.props.id,renderContextType:p}),ref:this.rteRef,defaultValue:this.isEditingOrPending(this.props.postDisplayMode)?this.state.preEditText:this.props.commentBody,displayMode:d,savedDraftContent:c,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,shouldRestoreContentOnMount:this.isEditingOrPending(this.props.postDisplayMode),onPress:this.createOnPressHandler(o,!0),peoplePickerPosition:this.getPickerPosition(),isTabbable:y,focusable:!this.props.collapsed||y,onContentSizeChange:this.onEditorHeightChange,onCommitRequested:this.onCommit,onEscapeRequested:this.onFocusParent,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onMount:this.onEditorMount,onUnmount:this.saveDraftIfEditing,onFocusStateChange:Q()==="win32"?this.onEditorFocusChange:void 0,maxHeight:this.props.collapsed?vM:void 0,accessibilityLabel:Q()==="win32"?Q8(this.props.localizationAPI):void 0,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,localizationAPI:this.props.localizationAPI},this.props.mentionableEditorProps)),g&&Ft.createElement(ee,{style:h}))},t.prototype.renderActionMenu=function(r,n){if(this.props.actionBarItems.length===0)return null;var o=this.props.componentTreeId.renderContextType;return this.isReply()&&Ft.createElement(hn,{onClick:Q()==="win32"?void 0:Rh(r.themeId,this.props.actionBarItems,this.props.id),accessibilityLabel:this.props.localizationAPI.getString(123),style:this.renderStyle(q0,r),text:"",appearance:"subtle",isTabbable:this.props.isTabbable,key:"threadAnchorMenu",icon:7,tooltipText:this.props.localizationAPI.getString(123),nodeId:pF({id:this.props.id,renderContextType:o}),testID:pF({id:this.props.id,renderContextType:o}),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,visibility:n,menuProps:Q()==="win32"?{menu:this.getMenuPopover(Rh(r.themeId,this.props.actionBarItems,this.props.id).items),props:{onOpenChange:this.onActionMenuOpened}}:void 0})},t.prototype.renderEditButton=function(r,n){if(!uf()||!this.props.isEditable)return null;var o=this.props.componentTreeId.renderContextType;return Ft.createElement(hn,{icon:6,onClick:this.onEdit,accessibilityLabel:this.props.localizationAPI.getString(120),text:"",appearance:"subtle",isTabbable:this.props.isTabbable,key:"postEditButton",tooltipText:this.props.localizationAPI.getString(120),nodeId:mF({id:this.props.id,renderContextType:o}),testID:mF({id:this.props.id,renderContextType:o}),visibility:n,style:this.renderStyle(Kg,r),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior})},t.prototype.renderReactionButton=function(r){return!no()||this.props.userReactionSummary===void 0?null:Ft.createElement(M_,{commentId:this.props.id,isTabbable:this.props.isTabbable,onReactionPressed:this.props.onReactionUpdated,reactionType:Ai.Like,localizationAPI:this.props.localizationAPI,userReactionSummary:this.props.userReactionSummary,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,preventReacting:this.props.preventReacting,renderHiddenIfNoReactions:!r,renderContextType:this.props.componentTreeId.renderContextType,key:"cardReactionButton"})},t.selectedAccessibilityState={selected:!0},t}(dB);FOe=Xd(kOe,{componentTreeId:tn},dB.DisplayName),Tpe=FOe});function Spe(e,t,r,n,o,a,d,c,u,l,p){if(t===Se.Draft||t===Se.DraftPreCommitPending)return n?e.formatString(224,n):e.getString(223);if(t===Se.Loading)return e.getString(225);var g=[],h=a?cE(a.completion):t===Se.Resolved;if(a){var v=a==null?void 0:a.assignees[0];v?g.push(e.formatString(h?215:214,Fr(v))):g.push(e.getString(h?217:216)),g.push(e.formatString(p?266:212,r))}else g.push(e.formatString(h?213:p?265:211,r));return n&&g.push(e.formatString(218,n)),(t===Se.Reply||d===cr.InChildPost)&&g.push(e.getString(222)),o===1?g.push(e.getString(219)):o>1&&g.push(e.formatString(220,String(o))),(t===Se.CardPostCommitPending||t===Se.ReplyPostCommitPending)&&g.push(e.getString(221)),c&&(g.push(e.getString(237)),g.push(e.getString(238))),g.join(e.getString(226))}var Ipe=f(()=>{"use strict";s();ln();Ef();Id();JC()});var sy,gB=f(()=>{"use strict";s();te();gl();Ipe();sy={getCardA11yLabel:Spe,getPostA11yLabel:function(t,r,n,o,a){var d=a.isUnread,c=a.author,u=a.timestamp;return o.formatString(r===ze.PendingDraft||r===ze.PendingEdit?210:d?209:208,c,u)},getTaskHistoryItemA11yLabel:function(t,r,n){return r&&n?t.formatString(232,r,n):(x().assertConditionTag(!1,"Task History Item accessibility label not resolving properly",557352448),t.getString(119))},getTaskHistoryA11yDescription:function(t){if(t.length>0)return t.map(function(r){return r.description}).join(", ");x().assertConditionTag(!1,"Task History Item accessibility description not resolving properly",527765771)}}});function Ppe(e,t){var r=e.id,n=e.timestamp,o=e.historyItemContent,a=Vi(),d=fu.useCallback(function(){return r},[r]),c=fu.useCallback(function(){return fu.createElement(iy,{timestamp:n,id:BI({id:r,renderContextType:a.renderContextType}),renderContextType:a.renderContextType})},[r,n,a]),u=fu.useCallback(function(){return o.map(function(p){return fu.createElement(BA,{icon:p.icon,description:p.description,key:p.description})})},[o]),l=fu.useMemo(function(){return{getId:d}},[d]);return(0,Epe.useImperativeHandle)(t,function(){return l},[l]),{getId:d,renderTimestamp:c,renderHistoryItemContent:u,componentTreeId:a,imperativeHandle:l}}var fu,Epe,_pe=f(()=>{"use strict";s();fu=S(L()),Epe=S(L());lr();Kn();aB();sB()});var Rpe,Ape=f(()=>{"use strict";s();je();Rpe=ve({minHeight:24,flexDirection:"row",alignItems:"center"})});function WA(e,t,r){return Je(e,t,r)}var kpe,Dn,OOe,Dpe,wpe=f(()=>{"use strict";s();k();Pt();kpe=S(Kr()),Dn=S(L());gx();Xa();yi();gB();lr();dn();je();rr();yx();Ki();mr();gn();_pe();Ape();OOe={selected:!0};Dpe=Dn.memo(Dn.forwardRef(function(e,t){var r=e.id,n=e.collapsed,o=e.onSelect,a=e.author,d=e.preventDefaultKeyDownBehavior,c=$g(),u=Ppe(e,t),l=u.componentTreeId,p=u.renderHistoryItemContent,g=u.renderTimestamp,h=u.imperativeHandle,v=l.renderContextType,y=V(Dn.useState(ce.Unfocused),2),T=y[0],b=y[1],I=Dn.useMemo(function(){var M=[WA(P_,c,v),WA(R_,c,v)];return T===ce.FocusOn&&M.push(WA(Ph,c,v)),M},[c,v,T]),E=Dn.useCallback(function(M){b(M)},[b]),P=Dn.useCallback(function(){var M=T===ce.Unfocused;o(h,M)},[o,T,h]),_=Dn.useCallback(function(){return Dn.createElement(va,{nodeId:zm({id:r,renderContextType:v}),size:kpe.PersonaImageSize.extraSmall,author:a,preventDefaultKeyDownBehavior:d})},[r,a,d,v]),D=Dn.useCallback(function(){return Dn.createElement(ee,{style:Rpe},Dn.createElement(qe,{textStylePolyester:"MediumBold",variantFluent:"bodySemibold",key:"name",accessible:!1},a.DisplayName||""))},[a]);return Dn.createElement(nr,{isTabbable:e.selected&&!e.collapsed,preventDefaultKeyDownBehavior:d,style:WA(A_,c,v),key:r,focusable:!0,nodeId:Qa({componentType:X.Post,id:r,renderContextType:v}),onPress:P,accessible:!0,accessibilityLabel:e.accessibilityLabel,accessibilityState:e.selected?OOe:void 0,accessibilityRole:"treeitem",accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityDescription:sy.getTaskHistoryA11yDescription(e.historyItemContent),onFocusStateChange:E},Dn.createElement(ee,{style:I},_(),Dn.createElement(ee,{style:k_.render(Wr(v))},D(),p(),!n&&g())))}))});function Fpe(e,t){return e===t?!0:e.length!==t.length?!1:e.every(function(r,n){return co(r[0])===co(t[n][0])})}function yB(e,t){return!!t&&t.selectedCardId===e&&!et(t.selectionDetails)}function Ope(e,t){return!!t&&t.selectedCardId===e&&et(t.selectionDetails)}function hB(e,t){return!!t&&et(t.selectionDetails)&&t.selectionDetails.selectedPostId===e}function zA(e,t,r,n,o){switch(e){case Bi.AllCardsTabbable:return!0;case Bi.ExpandedCardOrFirstCardTabbable:{if(o){var a=yB(t,o),d=Ope(t,o);return a||n===Rt.Expanded&&d}return r}case Bi.ExpandedCardTabbable:return o?n===Rt.Expanded:!1;case Bi.SelectedCardTabbable:return!!o&&o.selectedCardId===t}}function NOe(e,t,r,n,o,a){if(n===ze.PendingEdit||n===ze.PendingDraft)return hB(t,a);switch(e){case Ui.AllPostsTabbable:return!0;case Ui.ExpandedCardPostsTabbable:return o===Rt.Expanded;case Ui.ExpandedCardRootPostTabbable:{var d=hB(t,a),c=yB(r||t,a);return n!==ze.New_nonFluent&&(d||c&&o===Rt.Expanded&&!r)}case Ui.SelectedPostTabbable:return hB(t,a)}}function MOe(e,t,r){return Rt.Collapsed===e?!0:!(r===void 0||r===cr.InChildPost&&t)}function LOe(e,t,r,n,o,a,d,c,u,l,p,g,h,v,y,T,b){var I=e.localizationAPI,E=e.selectedState,P=e.isDraftThread,_=e.isCommentsContextReadOnly,D=e.draftState,M=e.cardCollapsedState,H=!1;E&&et(E.selectionDetails)&&(H=E.selectionDetails.selectedPostId===t.commentId);var U=jOe(t,r,D,E,n,u,P),F=!!(t.commentFlags&Ne.ReadOnly||_),z=r.displayDate||"",Y=D.postIdToDraftIdMap[t.commentId],B=Y?D.drafts[Y]:void 0,q=!!B&&B.renderContextType!==e.renderContextType,K=u&&B?m({draftId:Y},hF(B)):{};return qp.createElement(Tpe,m({},e.postCallbacks,K,{postDisplayMode:U,isReadOnly:F,id:t.commentId,author:t.author,authorColor:a==null?void 0:a.authorColor,authorImageURL:a==null?void 0:a.authorImageURL,timestamp:z,commentBody:t.commentBody,parent:t.parentId==="",lowFidelityWarningString:H?q8(I,E):"",selected:H,isTabbable:NOe(o,t.commentId,t.parentId,U,M,E),supportsAtMentions:e.isAtMentionEnabled,localizationAPI:I,actionBarItems:e.getActionBarItems(U,E==null?void 0:E.selectionDetails.lowFidelityWarningType,y,t.parentId==="",F,t.commentFlags,nC()),accessibilityLabel:sy.getPostA11yLabel(t.parentId.length===0,U,F,I,{author:Fr(t.author),timestamp:z,repliesCount:d,commentBody:t.commentBody,isReplyPending:c,isUnread:fe()&&!!(t.commentFlags&Ne.IsNew),anchorHintText:t.anchorHintText}),key:t.commentId,mentionableEditorProps:e.mentionableEditorProps,taskHistoryProps:p,accessibilityPositionInSet:l.accessibilityPositionInSet,accessibilitySetSize:l.accessibilitySetSize,accessibilityLevel:l.accessibilityLevel,isNew:!!(t.commentFlags&Ne.IsNew),scrollingContainerId:g,isCardHovered:e.isCardHighlighted,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,collapsed:h,restrictActionControls_deprecated:v,preventReacting:F||y===zn.None||!!(t.commentFlags&Ne.ReactionRestricted)||U===ze.Resolved,richTextCapabilities:e.richTextCapabilities,usersByReactionType:no()?t.usersByReactionType:void 0,userReactionSummary:no()?t.userReactionSummary:void 0,dulledAtMentions:T,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,isEditable:!(t.commentFlags&Ne.EditRestricted)&&!(t.commentFlags&Ne.ReadOnly)&&U!==ze.Resolved&&y===zn.Any,cardSelected:b,hasDraftInOtherRenderContext:q}))}function HOe(e,t,r,n,o,a,d,c,u,l,p){var g=FF(t,e),h=Xu(t.taskId,t.records[0].recordId),v=!1;a&&et(a.selectionDetails)&&(v=a.selectionDetails.selectedPostId===h);var y=p.displayDate;return qp.createElement(Dpe,{historyItemContent:g,onSelect:r.onSelect,id:h,key:h,author:t.records[0].user,timestamp:y,selected:v,authorColor:n==null?void 0:n.authorColor,authorImageURL:n==null?void 0:n.authorImageURL,resolved:o,collapsed:d,restrictActionControls_deprecated:c,accessibilitySetSize:u.accessibilitySetSize,accessibilityPositionInSet:u.accessibilityPositionInSet,accessibilityLabel:sy.getTaskHistoryItemA11yLabel(e,t.records[0].user.DisplayName,y),preventDefaultKeyDownBehavior:l})}function BOe(e,t,r,n,o,a,d,c,u,l,p,g,h,v){var y=e.cardState,T=e.cardCallbacks,b=e.localizationAPI,I=e.selectedState,E=e.isAtMentionEnabled,P=e.isTaskCreationEnabled,_=e.draftState,D=e.cardCollapsedState,M=e.cardRelativeDraftingState,H=e.maximumDimensions,U=e.isolationEdit,F=e.richTextCapabilities,z=e.thread,Y=Ku(y.loadState)?y.loadState.initialItemCount:n.length,B=_.cardIdToDraftIdMap[t.commentId],q=B?_.drafts[B]:void 0,K=M===cr.InCard,$=K&&q?m({draftId:B},hF(q)):{};return qp.createElement(Wfe,m({},T,$,{cardCollapsedState:D,selected:u,isReadOnly:g,hasSelectedChild:l,hasLowFidelityChild:p,displayMode:o,id:t.commentId,supportsAtMentions:E,isTabbable:e.isCardTabbable,localizationAPI:b,accessibilityLabel:sy.getCardA11yLabel(b,o,Fr(t.author),t.anchorHintText,Y-1,r,M,p&&Q()==="win32",c,t.commentBody,v),accessibilityDescription:Q()==="win32"?Wu(Po(z).commentBody):void 0,anchorText:t.anchorHintText,author:t.author,authorColor:a?a.authorColor:"",authorImageURL:a?a.authorImageURL:"",cardRelativeDraftingState:M,supportsTaskCreation:P,taskTopperProps:r,isNewThread:e.isDraftThread,foldableLayoutState:e.foldableLayoutState,accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityLevel:e.accessibilityLevel,maximumDimensions:H,scrollingContainerId:d,itemCount:Y,menuItems:e.getCardContextualMenuItems(t.commentFlags,e.allowedDraftingSession,e.isResolveSupported,sF(t,I),!!e.taskState,nC()),allowRootEditButton:!(t.commentFlags&Ne.EditRestricted||t.commentFlags&Ne.ReadOnly||sF(t,I))&&e.allowedDraftingSession===zn.Any,mentionEditorProps:e.mentionEditorProps,onCardLayout:e.onCardLayout,timestamp:c,restrictActionControls_deprecated:e.restrictActionControls_deprecated,preventReacting:g||e.allowedDraftingSession===zn.None||!!(t.commentFlags&Ne.ReactionRestricted)||o===Se.Resolved,contentBackgroundColor:e.contentBackgroundColor,maxDraftHeight:e.maxDraftHeight,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,highlightCard:e.isCardHighlighted,hideDraftBox:U||e.isCommentsContextReadOnly,hideHeader:U,disableScroll:U,style:e.cardStyle,richTextCapabilities:F,usersByReactionType:no()?t.usersByReactionType:void 0,userReactionSummary:no()?t.userReactionSummary:void 0,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,tabFocusTrapBehavior:h}),n)}function UOe(e){var t,r=e.thread,n=e.renderContextType,o=e.cardState,a=e.postOrHistoryRecordStates,d=e.postCallbacks,c=e.cardCallbacks,u=e.localizationAPI,l=e.selectedState,p=e.isolationEdit,g=e.isDraftThread,h=e.isCommentsContextReadOnly,v=e.keyboardingOptions,y=e.personaIconPropertiesMap,T=e.draftState,b=e.cardCollapsedState,I=e.cardRelativeDraftingState,E=e.maximumDimensions,P=e.preventDefaultKeyDownBehavior,_=e.restrictActionControls_deprecated,D=e.allowedDraftingSession,M=e.taskState,H=e.isCardTabbable,U=e.tabFocusTrapBehavior,F=Po(r),z=F.commentId,Y=I===cr.InChildPost,B=!!(F.commentFlags&Ne.Resolved),q=a[0].displayDate||"",K=[],$=WOe(F,o,T,l,I===cr.InCard,g),oe=yB(F.commentId,l),ie=h||!!(F.commentFlags&Ne.ReadOnly),Ce=Ope(F.commentId,l),se=HK($===Se.Resolved,b===Rt.Collapsed,oe||Ce),he=r.length-1,Be=!1,_e=!Ku(o.loadState),ot=n!==A.HalfPane&&!fe(),Ue=!1;if(_e&&(!g||ot))for(var or=0;or<r.length;or++){var ir=r[or],ri=a[or];if(_r(ir)){ir.commentModel.commentFlags&Ne.LowFidelity&&(Be=!0);var ni=ir.commentModel.commentId,Ra=Ds(T)===ni,Aa=!!T.postIdToDraftIdMap[ni];if(Ue=Ue||!!(ir.commentModel.commentFlags&Ne.IsNew),!ri)throw new ge("Post Or History Record state undefined for comment ".concat(ni),C.reserveTag(589103624),-2130957493);if((!p||!Y||Aa)&&QW(ri)&&ri.pending!==jr.Delete){var ka=x7(ir)?FF(ir.historyItem,u):[],sd=MOe(b,Ra,I);K.push(LOe(e,ir.commentModel,ri,B,v.postTabbingMode,Ha()?YC(y,ir.commentModel.author):void 0,he,o.pending===lt.Editor,Y||g,{accessibilitySetSize:r.length,accessibilityPositionInSet:or+1,accessibilityLevel:((t=e.accessibilityLevel)!==null&&t!==void 0?t:1)+1},ka,E&&E.height?yW({id:z,renderContextType:n}):Kt(n)?kC():void 0,b===Rt.Collapsed,sd,D,se,oe))}}else at()&&K.push(HOe(u,ir.historyItem,d,Ha()?YC(y,ir.historyItem.records[0].user):void 0,B,l,b===Rt.Collapsed,_,{accessibilitySetSize:r.length,accessibilityPositionInSet:or+1},P,ri))}var vt=D===zn.None||!e.isResolveSupported,fc=M?zOe(z,M,u,!!(F.commentFlags&Ne.Resolved),ie?$f.ReadOnly:vt?$f.Disabled:$f.Default,c.onTaskTopperCheckboxPressed,P,H&&!vt):void 0;return BOe(e,F,fc,K,$,Ha()?YC(y,F.author):void 0,Kt(n)?kC():void 0,q,oe,Ce,Be,ie,U,Ue)}function GA(e){return qp.createElement(VOe,m({},e))}function jOe(e,t,r,n,o,a,d){if(t.pending!==jr.None)return x().assertConditionTag(t.pending!==jr.Delete,"Post with PostPendingType.Delete should not attempt to be rendered. Falling back to PendingEdit display mode.",595153811),d?ze.PendingDraft:ze.PendingEdit;if(a){if(d)return x().assertConditionTag(!fe(),"New post should not be rendered while drafting in fluent.",574755652),ze.New_nonFluent;if(r.postIdToDraftIdMap[e.commentId])return fi(r)?ze.EditPreCommitPending:ze.Editing}if(n&&ui(n)===e.commentId)switch(n.selectionDetails.lowFidelityWarningType){case void 0:break;case Mt.DeleteReply:return ze.LowFidelityWarningDelete;case Mt.Edit:return ze.LowFidelityWarningEdit;case Mt.DeleteThread:return fe()?ze.LowFidelityWarningDelete:ze.Normal;default:Me(n.selectionDetails)}return t.displayingErrorUI?ze.Error:o?ze.Resolved:ze.Normal}function WOe(e,t,r,n,o,a){if(Ku(t.loadState))return Se.Loading;switch(t.pending){case lt.Card:case lt.Delete:return Se.CardPostCommitPending;case lt.Editor:return Se.ReplyPostCommitPending;case lt.None:break;default:Me(t.pending)}if(a)return fi(r)?Se.DraftPreCommitPending:Se.Draft;if(n&&n.selectedCardId===e.commentId&&_C(n)&&!fe())return Se.LowFidelityWarningOnDeleteThread;if(o){if(r.cardIdToDraftIdMap[e.commentId])return fi(r)?Se.ReplyPreCommitPending:Se.Reply;if(r.pendingDraft&&r.pendingDraft.sessionType==="REPLY"&&r.pendingDraft.threadId===e.commentId)return Se.ReplySessionRequestPending}return e.commentFlags&Ne.Resolved?Se.Resolved:Se.Normal}function CB(e,t,r,n){if(e&&!(!r[e.selectedCardId]||r[e.selectedCardId].pending===lt.Delete)){var o=tt(t);return o!==e.selectedCardId||!t.pendingDraft&&(!t.drafts[o]||t.drafts[o].isInCurrentContext&&t.drafts[o].renderContextType===n)?e.selectedCardId:void 0}}function zOe(e,t,r,n,o,a,d,c){if(at()){var u=t.completion,l=u===dE;return n!==l&&(x().assertConditionTag(!1,"Comment and task resolve state don't match",570826896),u=n?dE:0),{id:e,title:t.title,assignees:t.assignees,completion:u,onResolveTaskCheckboxPressed:a,localizationAPI:r,displayMode:o,preventDefaultKeyDownBehavior:d,isTabbable:c}}}function Npe(e,t,r){return e.map(function(n){var o=co(n);return t[o]||r&&r[o]})}var qp,VOe,qA=f(()=>{"use strict";s();k();ne();te();qp=S(L());Tc();ln();Jt();ye();NF();yt();zu();bn();qm();so();fv();kd();Ef();Id();gl();Ve();F1();zfe();bpe();wpe();pv();Af();FC();gB();Vo();lr();Pr();li();zo();dn();JC();VOe=qp.memo(UOe)});function Lpe(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;var r=Object.keys(e),n=Object.keys(t);return r.length!==n.length?!1:r.every(function(o){return e[o]===t[o]})}var Hpe=f(()=>{"use strict";s()});function YA(e,t,r,n,o,a,d){var c=[];if(d&&c.push(e.linkToComment),r===zn.None||t&Ne.ReadOnly)return c;var u=(t&Ne.Resolved)>0,l=a?e.resolveTask:e.resolveThread,p=a?e.deleteTask:e.deleteThread;return x().assertConditionTag(n||!u,"Card cannot be resolved when resolved is not supported",593764383),u&&n?(c.push(e.reopenThread),t&Ne.DeleteRestricted||c.push(p),c):(r===zn.Any&&fe()&&!uf()&&!(t&Ne.EditRestricted)&&!o&&c.push(e.editRootPost),d&&n&&c.push(l),t&Ne.DeleteRestricted||c.push(p),!d&&n&&c.push(l),c)}function $A(e,t){var r={text:e.getString(5),icon:3,onClick:t.onDeleteThread,isDestructive:!0,tooltipText:e.getString(5)},n={text:e.getString(3),icon:5,onClick:t.onResolveThread},o=e.getString(4),a={id:VI(),text:o,icon:fe()?16:4,onClick:t.onReopenThread,tooltipText:o},d={text:e.getString(120),onClick:t.onEditRootPost,icon:6,accessibilityLabel:e.getString(120)},c={text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25,tooltipText:e.getString(207)},u=m(m({},r),{text:e.getString(206),tooltipText:e.getString(206)}),l={text:e.getString(126),icon:5,onClick:t.onResolveThread};return{deleteThread:r,resolveThread:n,reopenThread:a,editRootPost:d,linkToComment:c,deleteTask:u,resolveTask:l}}function QA(e,t){var r=fe(),n=e.getString(15),o=e.getString(121),a={text:e.getString(184),onClick:t.onClearError,icon:19,accessibilityLabel:e.getStringOrUndefined(184)},d={text:e.getString(5),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(5),isDestructive:!0},c=r?o:e.getString(2),u={text:c,onClick:t.onDelete,icon:3,accessibilityLabel:c,isDestructive:!0},l=r?e.getString(120):e.getString(1),p={text:l,onClick:t.onEdit,icon:6,accessibilityLabel:l},g={text:n,icon:1,onClick:t.onCancel,onKeyDown:function(D,M){if(!M){x().assertConditionTag(!1,"CommentPostInterface ref is undefined for cancelEditItem.",544477844);return}mc(D.key)===J.Enter&&t.onCancel(M)},accessibilityLabel:n,isCancelItem:!0,usePrimaryButtonStyling:!1,tooltipText:n},h={text:e.getString(14),icon:24,onClick:function(D){return t.onCommit(D,qn.CommitButton)},onKeyDown:function(D,M){if(!M){x().assertConditionTag(!1,"CommentPostInterface ref is undefined for saveItem.",544477845);return}mc(D.key)===J.Enter&&t.onCommit(M,qn.CommitButton)},accessibilityLabel:e.getString(173),usePrimaryButtonStyling:!0,tooltipText:e.getString(173)},v=m(m({},h),{showDelayedSpinner:!0}),y=r?o:e.getString(2),T={text:y,onClick:t.onLowFidelityWarningConfirm,icon:3,accessibilityLabel:y,isDestructive:!0},b={text:n,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:n,icon:0,isCancelItem:!0},I={text:e.getString(37),onClick:t.onLowFidelityWarningConfirm,accessibilityLabel:e.getStringOrUndefined(42),icon:0},E={text:n,icon:1,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:n,isCancelItem:!0,tooltipText:n},P={text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25};return{retry:a,deleteRootItem:d,cancelEditItem:g,cancelLowFidelityWarningDeleteItem:b,cancelLowFidelityWarningEditItem:E,deleteItem:u,deleteItemForLowFidelityWarningDelete:T,editItem:p,proceedItemForLowFidelityWarningEdit:I,saveItem:h,saveItemPending:v,linkToCommentMenuItem:P}}var KA,vB=f(()=>{"use strict";s();k();te();Pt();Tc();ye();vl();so();fv();gl();lr();mB();KA=function(t,r,n,o,a,d,c,u){if(ET(r)&&n===Mt.Edit)return[t.proceedItemForLowFidelityWarningEdit,t.cancelLowFidelityWarningEditItem];if(ET(r)&&n===Mt.DeleteReply)return[t.deleteItemForLowFidelityWarningDelete,t.cancelLowFidelityWarningDeleteItem];if(r===ze.Error)return[t.retry,a?t.deleteRootItem:t.deleteItem];if(r===ze.Resolved)return[];if(fe()&&r===ze.EditPreCommitPending)return d?[]:[t.saveItemPending,t.cancelEditItem];if(r===ze.Editing||r===ze.EditPreCommitPending)return d?[]:[t.saveItem,t.cancelEditItem];var l=[];return u&&l.push(t.linkToCommentMenuItem),d||o===zn.None||(o===zn.Any&&!uf()&&!(c&Ne.EditRestricted)&&l.push(t.editItem),!(c&Ne.DeleteRestricted)&&!a&&l.push(t.deleteItem)),l}});var dy,Upe,Vpe,jpe=f(()=>{"use strict";s();k();ne();rt();yd();te();dy=S(L());Es();pn();ye();Cr();an();yt();fv();Id();Ve();pv();Cv();qA();w_();Kn();z_();Hpe();zo();vB();Af();Upe=20,Vpe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.memoGetActionBarItems=hu(KA,Upe,function(){x().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875360)}),n.memoGetCardContextualMenuItems=hu(YA,Upe,function(){x().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875361)}),n.getMentionableCommentEditorProps=Qe(function(o,a,d){if(o===_t.Enabled)return{onMentionCreated:n.onMentionCreated,onMentioneesStillInDraftUpdated:n.onMentioneesStillInDraftUpdated,getAuthToken:n.getAuthToken,correlationId:n.props.correlationId,suggestionsDetails:d,emailAddressesEnabled:a}}),n.getRenderableItemActionBarItems=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];if(!n.renderableItemActionBarItems||n.memoGetActionBarItems===void 0)throw new Re("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601689));return n.memoGetActionBarItems.apply(n,w([n.renderableItemActionBarItems],V(o),!1))},n.getCardContextualMenuItems=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];if(!n.cardContextMenuItems||n.memoGetCardContextualMenuItems===void 0)throw new Re("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601690));return n.memoGetCardContextualMenuItems.apply(n,w([n.cardContextMenuItems],V(o),!1))},n.onPostDelete=function(o){Eg({trackback:C.reserveTag(593826139),id:o,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostEdit=function(o){Pg({trackback:C.reserveTag(593801875),id:o,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCommit=function(o,a){_g({trackback:C.reserveTag(593826141),id:o.getId(),data:n.props.dataItems,draftState:n.props.draftState,contentPromise:o.getContentsAsync(),atMentionsEnabled:n.props.modelCapabilities.atMention===_t.Enabled,componentTree:n.props.componentTree,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,commitSource:a,localizationAPI:n.props.localizationAPI}).catch(me(C.reserveTag(593826142)))},n.onPostDraftEmptinessChanged=function(o,a){Fg({trackback:C.reserveTag(592041679),contentId:o.getId(),isEmpty:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostSaveDraft=function(o,a){Og({trackback:C.reserveTag(592720402),id:o,editor:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCancel=function(o){qf({trackback:C.reserveTag(593826145),commentId:o.getId(),setContents:o.setContents.bind(o),data:n.props.dataItems,draftState:n.props.draftState,shouldClosePaneAfterDiscardDraft:!1,onWillDiscardCallback:void 0,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onLowFidelityWarningCancel=function(){T0({selectedState:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningConfirm=function(){b0({selectedState:n.props.selectedState,onCardDelete:n.cardOnDelete,onPostDelete:n.onPostDelete,onPostEdit:n.onPostEdit})},n.onPostReactionUpdated=function(o,a,d){E0(C.reserveTag(587994052),o,a,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor,d)},n.onPresentLinkToComment=function(o){P0(C.reserveTag(578852485),o,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor)},n.onRenderableItemSelect=function(o,a){var d=n.getRenderableItemFromRef(o);if(!d){x().assertConditionTag(!1,"Comment not rendered within Card. Is something incorrect in the tree?",593826146);return}Rg({trackback:C.reserveTag(593826147),renderableItem:d,selectedComment:n.props.selectedState,cardCollapsedState:n.props.cardCollapsedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,shouldFocusAfter:a,draftState_deprecated:n.props.draftState}).catch(me(C.reserveTag(590123736)))},n.onPostCollapse=function(o){var a=n.getRenderableItemFromRef(o);if(!a){x().assertConditionTag(!1,"Collapse from an unknown post?",589940441);return}S0(C.reserveTag(589940442),a,n.props,n.props.telemetryVisitor,n.props.componentTree)},n.onPostFocusParent=function(o){var a=n.getRenderableItemFromRef(o);if(!a){x().assertConditionTag(!1,"Focus parent from unknown post?",545867680);return}I0(a,n.props.componentTree,n.props.focusManager,n.props.draftState)},n.cardOnResolveThread=function(o){Yf({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826176),id:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnReopenThread=function(o){Dg({trackback:C.reserveTag(593826177),id:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnDelete=function(o){x().assertConditionTag(n.props.componentTree.componentTreeId.renderContextType!==A.HalfPane,"Discard not yet fully supported for HalfPane in DHC",593826178),wg({trackback:C.reserveTag(592840777),id:o,data:n.props.dataItems,selectedComment:n.props.selectedState,componentTree:n.props.componentTree,invokeModalDialog:void 0,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,isTask:!!n.props.threadTaskState,threadIndex:0,shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},n.cardOnPost=function(o,a){var d=n.props.isDraftThread?{type:"CREATE"}:{type:"REPLY",parentId:o.getId()};kg({trackback:C.reserveTag(593622431),commentCardRef:o,draftState:n.props.draftState,areMentionsEnabled:n.props.modelCapabilities.atMention===_t.Enabled,session:d,componentTree:n.props.componentTree,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:a}).catch(me(C.reserveTag(593622432)))},n.cardOnCollapseCallback=function(o){f0({trackback:C.reserveTag(562918285),commentCardRef:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSelectCallback=function(o){Kf({trackback:C.reserveTag(571281792),commentCardRef:o,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ae.SelectCard}})},n.cardOnSelectExpandCallback=function(o,a,d){Kf({trackback:C.reserveTag(571281763),commentCardRef:o,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ae.ExpandCard,relativeDraftingState:n.props.cardRelativeDraftingState,draftState:n.props.draftState,shouldFocusAfter:d,selectRootPost:a}})},n.cardOnFocusCallback=function(o){p0({trackback:C.reserveTag(571340120),commentCardRef:o,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ae.Polite},focusManager:n.props.focusManager,isDraftThread:n.props.isDraftThread})},n.cardOnBeginReplyCallback=function(o){Ag({trackback:C.reserveTag(593826189),threadId:o.getId(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnHighlight=function(o,a){m0({trackback:C.reserveTag(593826190),commentCardRef:o,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,shouldHighlightCard:a})},n.cardOnDraftingInputSizeChange=function(o,a){g0({trackback:C.reserveTag(593826191),focusManager:n.props.focusManager,componentTree:n.props.componentTree,cardId:o.getId(),isCardLie:n.props.isDraftThread,newHeight:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnDraftEmptinessChanged=function(o,a){Fg({trackback:C.reserveTag(592213847),contentId:o.getId(),isEmpty:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnEditorFocusLost=function(o){h0({trackback:C.reserveTag(592065734),id:o.getId(),draftState:n.props.draftState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnTaskTopperCheckboxPressed=function(){if(!n.props.threadTaskState){x().assertConditionTag(!1,"props.threadTaskState is undefined",593826193);return}y0({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826194),id:n.props.threadId,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.cardOnSaveDraft=function(o,a){Og({trackback:C.reserveTag(592720403),id:o,editor:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnCancel=function(o){x().assertConditionTag(n.props.isDraftThread||n.props.cardRelativeDraftingState===cr.InCard,"Mismatch between selectedComment state and cancel reply callback.",593826196),ml({trackback:C.reserveTag(592840778),showDiscardDialog:!1,invokeModalDialog:void 0,componentTree:n.props.componentTree,dispatchProps:n.props,closeOnDiscard:!1,cardId:n.props.threadId,draftState:n.props.draftState,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,lieIndex:0})},n.commentEditorOnKeyDown=function(o){n.commentEditorKeyDownHandler.onKeyDown(o)},n.onPostError=function(o){a0({trackback:C.reserveTag(593764370),id:o.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onClearPostError=function(o){s0({trackback:C.reserveTag(593764371),id:o.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onCardMounted=function(o){d0({cardProps:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardEditorMounted=function(o){c0({cardId:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostMounted=function(o){u0({postId:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostEditorMounted=function(o){l0({postId:o,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardRendered=Mn(function(o){n.props.onInitialRender({commentId:o.id,renderContextType:n.props.componentTree.componentTreeId.renderContextType})}),n.onSelectedTaskAssigneeUpdated=function(o){x0({trackback:C.reserveTag(593826204),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,selectedAssignee:o})},n.getPostOrHistoryRecordStates=vn(Npe,function(){return[n.props.dataItems,n.props.threadPostStates,n.props.historyRecordViewStates]}),n.onMentionCreated=n.onMentionCreated.bind(n),n.onMentioneesStillInDraftUpdated=n.onMentioneesStillInDraftUpdated.bind(n),n.getAuthToken=n.getAuthToken.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onDraftEmptinessChanged:n.onPostDraftEmptinessChanged,onSaveDraft:n.onPostSaveDraft,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onPostMounted:n.onPostMounted,onPostEditorMounted:n.onPostEditorMounted,onError:n.onPostError,onClearError:n.onClearPostError,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onCollapseParent:n.onPostCollapse,onFocusParent:n.onPostFocusParent,onReactionUpdated:n.onPostReactionUpdated,onPresentLinkToComment:n.onPresentLinkToComment,onClickableTextClicked:n.props.onClickableTextClicked},n.commentCardCallbackProps={onEditorPress:n.cardOnBeginReplyCallback,onCardCollapse:n.cardOnCollapseCallback,onCardSelect:n.cardOnSelectCallback,onCardSelectExpand:n.cardOnSelectExpandCallback,onCardFocus:n.cardOnFocusCallback,onCardHighlightChange:n.cardOnHighlight,onDraftingInputSizeChange:n.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:n.cardOnDraftEmptinessChanged,onEditorBlur:n.cardOnEditorFocusLost,onCancel:n.cardOnCancel,onPost:n.cardOnPost,onSaveDraft:n.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:n.onSelectedTaskAssigneeUpdated,onCardMounted:n.onCardMounted,onCardEditorMounted:n.onCardEditorMounted,onCardRendered:n.onCardRendered,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onTaskTopperCheckboxPressed:n.cardOnTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onReactionUpdated:n.onPostReactionUpdated,onEditRootPost:n.onPostEdit},n.contextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onPostEdit,onPresentLinkToComment:n.onPresentLinkToComment},n.renderableItemActionBarItems=QA(n.props.localizationAPI,n.commentPostCallbackProps),n.cardContextMenuItems=$A(n.props.localizationAPI,n.contextualMenuCallbackProps),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown(function(){return n.props.componentTree},at()?function(){return n.props.dataItems}:void 0),n.commentEditorKeyDownHandler=n.props.focusManager.commentEditorKeyDown(function(){return n.props.componentTree}),n}return t.prototype.focus=function(){this.props.focusManager.focusCommentCardCommand(this.props.componentTree,this.props.threadId),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(590205772),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:this.props.threadId,selectType:Ae.ExpandCard,source:le.Canvas},!1).catch(me(C.reserveTag(590104656)))},t.prototype.getInstanceId=function(){return this.props.componentInstanceId},t.prototype.shouldComponentUpdate=function(r,n){return t.havePropsMeaningfullyChanged(r,this.props)},t.prototype.updateDraftRenderLockIfApplicable=function(r){var n=Ye(this.props.draftState);!n||n.threadId!==this.props.threadId||this.props.updateRenderLockForDraft({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826137),telemetryVisitor:this.props.telemetryVisitor},r,n.commentDraft.sessionConfiguration.draftId)},t.prototype.componentDidMount=function(){var r,n,o,a;(n=(r=this.props).componentRef)===null||n===void 0||n.call(r,this),(a=(o=this.props).setComponentRef)===null||a===void 0||a.call(o,this.props.componentInstanceId,this),this.updateDraftRenderLockIfApplicable(!0)},t.prototype.componentWillUnmount=function(){var r,n;(n=(r=this.props).setComponentRef)===null||n===void 0||n.call(r,this.props.componentInstanceId,null)},t.prototype.componentDidUpdate=function(r,n){if(this.props.draftState!==r.draftState){var o=Ye(r.draftState),a=Ye(this.props.draftState);a&&a.renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(o===void 0||o.renderContextType!==a.renderContextType)&&this.updateDraftRenderLockIfApplicable(!0)}this.props.focusManager.discreteCommentCardPropsUpdated(this.props.componentTree,r,this.props)},t.havePropsMeaningfullyChanged=function(r,n){var o=Object.keys(r),a=Object.keys(n);return o.length!==a.length?!0:o.some(function(d){if(n[d]===r[d])return!1;if(d==="dataItems"){if(n.dataItems.length!==r.dataItems.length)return!0;for(var c=0;c<n.dataItems.length;c++){var u=n.dataItems[c],l=r.dataItems[c];if(_r(u)&&_r(l)&&u.commentModel!==l.commentModel||!!u.historyItem!=!!l.historyItem)return!0}return!1}return typeof n[d]=="object"?!Lpe(n[d],r[d]):!0})},t.prototype.getAuthToken=function(){return this.props.peopleAPI.getAuthToken(hd.Loki)},t.prototype.getRenderableItemFromRef=function(r){var n=r.getId();return this.props.dataItems.find(function(o){return co(o)===n})},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:Bi.ExpandedCardOrFirstCardTabbable,postTabbingMode:Ui.ExpandedCardRootPostTabbable}},t.prototype.onMentionCreated=function(r){C0({failTag:C.reserveTag(593826199),successTag:C.reserveTag(593826200),person:r,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826201)})},t.prototype.onMentioneesStillInDraftUpdated=function(r){v0({trackback:C.reserveTag(593826203),emailsStillInDraft:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.renderThread=function(r){return r},t.prototype.onQueueLoadThread=function(){this.props.modelCapabilities.virtualized&&!this.props.isDraftThread&&this.props.queueLoadThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(573145492)})},t.prototype.render=function(){var r,n;this.onQueueLoadThread();var o=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.modelCapabilities.atMentionEmailAddresses,this.props.suggestionsDetails),a=this.props.cardRelativeDraftingState!==void 0,d=a||this.props.readOnly?zn.None:zn.Any,c=this.props.dataItems.length>1,u=GA({thread:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardState,postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:o,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:this.props.selectedState,isolationEdit:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,isAtMentionEnabled:this.props.modelCapabilities.atMention===_t.Enabled,isTaskCreationEnabled:Qm(this.props.modelCapabilities),isDraftThread:this.props.isDraftThread,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:this.props.cardCollapsedState,cardRelativeDraftingState:this.props.cardRelativeDraftingState,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilityLevel:this.props.accessibilityLevel,maximumDimensions:this.props.maximumDimensions,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:o,restrictActionControls_deprecated:a,allowedDraftingSession:d,availableScreenHeight:void 0,contentBackgroundColor:c?"CardReplyBackground":"CardBackground",extraPaddingLeft:void 0,extraPaddingRight:void 0,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:this.props.isHighlighted,maxDraftHeight:void 0,taskState:this.props.threadTaskState,cardStyle:void 0,onCardLayout:void 0,isCardTabbable:zA(this.getKeyboardingOptions().cardTabbingMode,this.props.threadId,!1,this.props.cardCollapsedState,this.props.selectedState),postOrHistoryRecordStates:this.getPostOrHistoryRecordStates(),richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:(n=(r=this.props)===null||r===void 0?void 0:r.accessibilityMetadata)===null||n===void 0?void 0:n.tabFocusTrapBehavior});return dy.createElement(Dh.Provider,{value:this.props.lppManager},dy.createElement(tn.Provider,{value:this.props.componentTree.componentTreeId},dy.createElement(hx.Provider,{value:this.props.commentAPI},this.renderThread(u))))},t}(dy.Component)});var Wpe,zpe=f(()=>{"use strict";s();je();Wpe=function(t){return ve({width:t==null?void 0:t.width})}});var Gpe,GOe,qpe,Kpe=f(()=>{"use strict";s();k();rt();Pt();Gpe=S(L());jpe();zpe();Xa();Ws();yi();Pr();GOe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.setViewTreeRoot=function(o){if(n.props.componentTree.setViewTreeRootHelper(o,n.props.resource.id),o){var a=o.getInnerRef();a.current&&n.props.focusManager.discreteCommentCardRootRefMounted(a)}},n.onRootViewKeyDown=function(o){Q()==="win32"&&(n.props.componentTree.onKeyDownTabHandlerHelper(n.props.resource.id,o).wasHandled||n.commentContentsKeyDownHandler.onKeyDown(o))},n.getContentsPreventDefaultKeyDownBehavior=vn(fm,function(){return[n.commentContentsKeyDownHandler.getKeyDownEvents(),!0]}),n.getRootViewKeyDownEvents=Qe(function(){return pm({useJSTabLoop:!0,handleKeysDuringBubbling:!0})}),n.getMemoizedDiscreteCommentCardStyle=vn(Wpe,function(){return[n.props.maximumDimensions]}),n.componentTree=n.props.componentTree,n}return t.prototype.componentDidUpdate=function(r,n){this.props.resource.id!==r.resource.id&&this.props.componentTree.updateIdForViewTree(r.resource.id,this.props.resource.id),e.prototype.componentDidUpdate.call(this,r,n)},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!0},t.prototype.renderThread=function(r){return Gpe.createElement(zr,{nodeId:Qa({componentType:X.DiscreteHostedCommentRoot,id:this.props.resource.id,renderContextType:this.props.componentTree.componentTreeId.renderContextType}),style:this.getMemoizedDiscreteCommentCardStyle(),ref:this.setViewTreeRoot,onKeyDown:this.onRootViewKeyDown,keyDownEvents:this.getRootViewKeyDownEvents()},r)},t}(Vpe),qpe=GOe});var qOe,XA,xB=f(()=>{"use strict";s();Ts();St();E1();Kpe();Nf();ZC();qOe=function(){var t,r=n0(),n=r0(),o=o0(function(y){return uo(y,!0)},function(y){return KC(y,!0)},r,n),a=oq(o),d=nq(),c=rq(),u=tq(),l=t0(),p=dq(),g=cq(o,p),h=iq(p),v=function(T,b){if(b.isVirtualized&&t)return t;var I=o(T,b),E=p(T,b),P=I.thread[0].commentId;return t={threadId:P,dataItems:g(T,b),threadTaskState:E&&E.currentState,threadPostStates:a(T,b),historyRecordViewStates:h(T,b),selectedState:d(T,b),cardCollapsedState:da(P,ia(T),b.componentTree.componentTreeId.renderContextType),readOnly:XI(T),cardState:u(T,b),isHighlighted:c(T,b),personaIconPropertiesMap:Jm(T),isDraftThread:I.isDraftThread,draftState:pe(T),cardRelativeDraftingState:l(T,b),modelCapabilities:Lr(T),suggestionsDetails:tE(T)},t};return v},XA=ea(qOe,hE)(qpe)});function cy(e,t){var r=Ye(e);return r!==void 0&&r.renderContextType!==t&&r.commentDraft.sessionConfiguration.sessionType===ro}var TB=f(()=>{"use strict";s();gd();yt()});function JA(e){if(!(!e.topVisibleThread||e.componentTree.componentTreeId.renderContextType===A.HalfPane||e.selectedComment))return e.topVisibleThread.cardId}var uy,Ype,KOe,Kp,bB=f(()=>{"use strict";s();k();ne();rt();te();QF();wd();uy=S(L());Es();bm();XF();fd();Sc();oC();pn();ye();JF();Cr();an();HC();yt();XC();bn();IC();xB();fv();Uf();Vu();Ve();Nf();$E();Cv();R1();TB();qA();lr();gv();Kn();z_();Pr();zo();vB();Ype=20,KOe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;n.memoGetActionBarItems=hu(KA,Ype,function(){x().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875362)}),n.memoGetCardContextualMenuItems=hu(YA,Ype,function(){x().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875363)}),n.initialAtMentionCapability=new GT,n.onCommentInterruptableCommand=function(a){switch(a.type){case"DiscardDraft":{var d=void 0;if(a.mode===jf.Dialog){var c=mv(n.props.draftState,n.props.componentTree.componentTreeId.renderContextType);d=n.getOnWillDiscardCallback(c);var u=Bs(!0,n.props.componentTree.componentTreeId.renderContextType,n.props.draftState,n.props.selectedComment,n.props.selectedThreadIdBeforeCommentSession);return n.props.discardDraftAsync({renderContextType:n.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:n.props.telemetryVisitor,trackback:C.reserveTag(587605836)},le.Canvas,u,d)}return Promise.resolve(He.Unhandled)}case"BringThreadIntoView":return n.props.componentTree.componentTreeId.renderContextType!==A.FullPane?Promise.resolve(He.Unhandled):n.scrollToThreadById(a.threadId)?Promise.resolve(He.Handled):Promise.resolve(He.Failed);default:return x().assertConditionTag(!1,"Unknown type of CommentInterruptableCommand",593826210),Promise.resolve(He.Unhandled)}},n.onCardPost=function(a,d){var c=a.getId(),u=t.getPaneSingleCreateDraftId(n.props)===a.getId()?{type:"CREATE"}:{type:"REPLY",parentId:c};kg({trackback:C.reserveTag(593622435),commentCardRef:a,draftState:n.props.draftState,areMentionsEnabled:n.props.modelCapabilities.atMention===_t.Enabled,session:u,componentTree:n.props.componentTree,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:d}).catch(me(C.reserveTag(593622464)))},n.cardOnCollapseCallback=function(a){f0({trackback:C.reserveTag(562918286),commentCardRef:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSelectCallback=function(a){Kf({trackback:C.reserveTag(571281794),commentCardRef:a,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ae.SelectCard}})},n.cardOnSelectExpandCallback=function(a,d,c){var u=Gf(a.getId(),n.props.componentTree.componentTreeId.renderContextType,n.props.draftState);Kf({trackback:C.reserveTag(571281793),commentCardRef:a,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ae.ExpandCard,relativeDraftingState:u,draftState:n.props.draftState,shouldFocusAfter:c,selectRootPost:d}})},n.cardOnFocusCallback=function(a){p0({trackback:C.reserveTag(571340119),commentCardRef:a,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:Ae.Polite},focusManager:n.props.focusManager,isDraftThread:t.getPaneSingleCreateDraftId(n.props)===a.getId()})},n.cardOnBeginReplyCallback=function(a){Ag({trackback:C.reserveTag(593826249),threadId:a.getId(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnResolveThread=function(a){Yf({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826250),id:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.tasks[a]})},n.cardOnReopenThread=function(a){Dg({trackback:C.reserveTag(593826251),id:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.tasks[a]})},n.cardOnDelete=function(a){wg({trackback:C.reserveTag(593826252),id:a,data:n.props.dataItems,selectedComment:n.props.selectedComment,componentTree:n.props.componentTree,invokeModalDialog:n.invokeModalDialog,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,isTask:!!n.props.tasks[a],threadIndex:kf(n.state.allRenderableItemThreads,a),shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},n.cardOnDraftingInputSizeChange=function(a,d){var c=t.getPaneSingleCreateDraftId(n.props);g0({trackback:C.reserveTag(593826253),focusManager:n.props.focusManager,componentTree:n.props.componentTree,cardId:a.getId(),isCardLie:a.getId()===c,newHeight:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedComment,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnDraftEmptinessChanged=function(a,d){Fg({trackback:C.reserveTag(592213848),contentId:a.getId(),isEmpty:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnEditorFocusLost=function(a){h0({trackback:C.reserveTag(592065735),id:a.getId(),draftState:n.props.draftState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSaveDraft=function(a,d){Og({trackback:C.reserveTag(593826255),id:a,editor:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onCardCancel=function(a){var d=Bs(!0,n.props.componentTree.componentTreeId.renderContextType,n.props.draftState,n.props.selectedComment,n.props.selectedThreadIdBeforeCommentSession);ml({trackback:C.reserveTag(592840780),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.props.componentTree,dispatchProps:n.props,closeOnDiscard:d,cardId:a.getId(),draftState:n.props.draftState,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,lieIndex:kf(n.state.allRenderableItemThreads,a.getId())})},n.onTaskTopperCheckboxPressed=function(a){var d=n.props.tasks[a];d&&y0({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:C.reserveTag(593826258),id:d.commentId,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.cardOnHighlight=function(a,d){m0({trackback:C.reserveTag(593826259),commentCardRef:a,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,shouldHighlightCard:d})},n.onPostDelete=function(a){Eg({trackback:C.reserveTag(593826312),id:a,data:n.props.dataItems,selectedComment:n.props.selectedComment,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostEdit=function(a){Pg({trackback:C.reserveTag(593826316),id:a,data:n.props.dataItems,selectedComment:n.props.selectedComment,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostReactionUpdated=function(a,d,c){E0(C.reserveTag(587994051),a,d,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor,c)},n.onPostCommit=function(a,d){_g({trackback:C.reserveTag(593826260),id:a.getId(),data:n.props.dataItems,draftState:n.props.draftState,contentPromise:a.getContentsAsync(),atMentionsEnabled:n.props.modelCapabilities.atMention===_t.Enabled,componentTree:n.props.componentTree,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:d}).catch(me(C.reserveTag(593826261)))},n.onPostCancel=function(a){var d=Bs(!0,n.props.componentTree.componentTreeId.renderContextType,n.props.draftState,n.props.selectedComment,n.props.selectedThreadIdBeforeCommentSession);qf({trackback:C.reserveTag(593826263),commentId:a.getId(),setContents:a.setContents.bind(a),data:n.props.dataItems,draftState:n.props.draftState,shouldClosePaneAfterDiscardDraft:d,onWillDiscardCallback:void 0,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostDraftEmptinessChanged=function(a,d){Fg({trackback:C.reserveTag(592041678),contentId:a.getId(),isEmpty:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostSaveDraft=function(a,d){Og({trackback:C.reserveTag(592720405),id:a,editor:d,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPresentLinkToComment=function(a){P0(C.reserveTag(578852484),a,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor)},n.onRenderableItemSelect=function(a,d){var c=n.getRenderableItemFromRef(a);if(!c){x().assertConditionTag(!1,"Selection coming from an unknown post?",593826265);return}Rg({trackback:C.reserveTag(593826266),renderableItem:c,selectedComment:n.props.selectedComment,cardCollapsedState:da(_o(c),n.props.expandedComments,n.props.componentTree.componentTreeId.renderContextType),dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,shouldFocusAfter:d,draftState_deprecated:n.props.draftState}).catch(me(C.reserveTag(590123737)))},n.onPostCollapseParent=function(a){var d=n.getRenderableItemFromRef(a);if(!d){x().assertConditionTag(!1,"Collapse from an unknown post?",589940444);return}S0(C.reserveTag(589940445),d,n.props,n.props.telemetryVisitor,n.props.componentTree)},n.onPostFocusParent=function(a){var d=n.getRenderableItemFromRef(a);if(!d){x().assertConditionTag(!1,"Focus parent from unknown post?",545867681);return}I0(d,n.props.componentTree,n.props.focusManager,n.props.draftState)},n.getContentFilterProps=function(){var a;return{currentFilter:(a=n.props.currentFilter)!==null&&a!==void 0?a:sa,createOrUpdateFilter:n.props.createOrUpdateFilter,preventDefaultKeyDownBehavior:n.getContentsPreventDefaultKeyDownBehavior(),personaIconPropertiesMap:n.props.personaIconPropertiesMap,localizationAPI:n.props.localizationAPI,filterItemCount:n.props.filterItemCount,collaborators:n.props.collaborators}},n.getThreadedRenderableIds=vn(function(a){return a.map(function(d){return d.map(co)})},function(){return[n.state.allRenderableItemThreads]}),n.getThreadPostOrHistoryRecordStates=function(){var a=$T();return function(){return a(n.getThreadedRenderableIds(),m(m({},n.props.postViewStates),n.props.historyRecordViewStates))}}(),n.getListItemKey=function(a){var d=Po(a).commentId,c=n.props.cardViewStates[d];return c&&c.alternateId||d},n.getHostableComponentInstanceId=function(a,d,c){return"cardInPane_".concat(_f({id:a,renderContextType:d},c))},n.onSelectedTaskAssigneeUpdated=function(a){x0({trackback:C.reserveTag(593826304),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,selectedAssignee:a})},n.getRenderableItemActionBarItems=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];if(!n.renderableItemActionBarItems||n.memoGetActionBarItems===void 0)throw new Re("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601691));return n.memoGetActionBarItems.apply(n,w([n.renderableItemActionBarItems],V(a),!1))},n.getCardContextualMenuItems=function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];if(!n.cardContextMenuItems||n.memoGetCardContextualMenuItems===void 0)throw new Re("Function should not be called when DeleteRestricted gate is off.",C.reserveTag(557601692));return n.memoGetCardContextualMenuItems.apply(n,w([n.cardContextMenuItems],V(a),!1))},n.onCardMounted=function(a){d0({cardProps:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardEditorMounted=function(a){c0({cardId:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostMounted=function(a){u0({postId:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostEditorMounted=function(a){l0({postId:a,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.notifyRenderedOnce=Mn(function(){n.props.onInitialRender({renderContextType:n.props.componentTree.componentTreeId.renderContextType})}),n.onPostError=function(a){a0({trackback:C.reserveTag(593764372),id:a.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onClearPostError=function(a){s0({trackback:C.reserveTag(593764373),id:a.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningCancel=function(){T0({selectedState:n.props.selectedComment,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningConfirm=function(){b0({selectedState:n.props.selectedComment,onCardDelete:n.cardOnDelete,onPostDelete:n.onPostDelete,onPostEdit:n.onPostEdit})},n.commentEditorOnKeyDown=function(a){n.commentEditorKeyDownHandler.onKeyDown(a)},n.startNewCommentSession=function(){n.props.discardDraftAndStartNewCommentSession({renderContextType:n.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826323),telemetryVisitor:n.props.telemetryVisitor})},n.closePane=n.closePane.bind(n),n.onCommentUIAction=n.onCommentUIAction.bind(n),n.onMentionCreated=n.onMentionCreated.bind(n),n.onMentioneesStillInDraftUpdated=n.onMentioneesStillInDraftUpdated.bind(n),n.renderCommentThread=n.renderCommentThread.bind(n),n.onGhostCommentClicked=n.onGhostCommentClicked.bind(n),n.invokeModalDialog=n.invokeModalDialog.bind(n),n.deleteThreadConfirmCallback=n.deleteThreadConfirmCallback.bind(n),n.getOnWillDiscardCallback=n.getOnWillDiscardCallback.bind(n),n.isReadyToRender=n.isReadyToRender.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onDraftEmptinessChanged:n.onPostDraftEmptinessChanged,onSaveDraft:n.onPostSaveDraft,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onPostMounted:n.onPostMounted,onPostEditorMounted:n.onPostEditorMounted,onError:n.onPostError,onClearError:n.onClearPostError,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onCollapseParent:n.onPostCollapseParent,onFocusParent:n.onPostFocusParent,onReactionUpdated:n.onPostReactionUpdated,onPresentLinkToComment:n.onPresentLinkToComment,onClickableTextClicked:n.props.onClickableTextClicked},n.commentCardCallbackProps={onEditorPress:n.cardOnBeginReplyCallback,onCardCollapse:n.cardOnCollapseCallback,onCardSelect:n.cardOnSelectCallback,onCardSelectExpand:n.cardOnSelectExpandCallback,onCardFocus:n.cardOnFocusCallback,onCardHighlightChange:n.cardOnHighlight,onDraftingInputSizeChange:n.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:n.cardOnDraftEmptinessChanged,onEditorBlur:n.cardOnEditorFocusLost,onCancel:n.onCardCancel,onPost:n.onCardPost,onSaveDraft:n.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:n.onSelectedTaskAssigneeUpdated,onCardMounted:n.onCardMounted,onCardEditorMounted:n.onCardEditorMounted,onCardRendered:n.notifyRenderedOnce,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onTaskTopperCheckboxPressed:n.onTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onReactionUpdated:n.onPostReactionUpdated,onEditRootPost:n.onPostEdit},n.cardContextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onPostEdit,onPresentLinkToComment:n.onPresentLinkToComment},n.renderableItemActionBarItems=QA(n.props.localizationAPI,n.commentPostCallbackProps),n.cardContextMenuItems=$A(n.props.localizationAPI,n.cardContextualMenuCallbackProps),n.paneContainerKeyDownHandler=n.props.focusManager.paneContainerKeyDown(function(){return n.props.componentTree}),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown(function(){return n.props.componentTree},function(){return n.props.dataItems}),n.commentEditorKeyDownHandler=n.props.focusManager.commentEditorKeyDown(function(){return n.props.componentTree});var o=x().createActivityObject("BaseCommentPaneConstruction",n.props.telemetryVisitor,Ee());return o.addDataField("PaneCorrelationId",n.props.correlationId,N.SystemMetadata),Nn||o.addDataField("SharedCommentsVersion",TE,N.SystemMetadata),o.addDataField("RenderContextType",n.props.componentTree.componentTreeId.renderContextType,N.SystemMetadata),o.successTag(593826206),n}return t.prototype.onCommentUIAction=function(r){return r.actionType===Gt.BackKeyPressed?(x().assertConditionTag(Ba(r.actionBehavior),"This action type does not support toggled/enabled status",593826207),Ba(r.actionBehavior)&&this.onBackKeyPressed(),dr.Success):dr.NotHandled},t.prototype.getOnWillDiscardCallback=function(r){var n=this;return Pd(this.props.draftState)===Nr.CannotAutoDiscard?function(o,a){return n.invokeModalDialog(r,o,a)}:void 0},t.prototype.updateDraftRenderLocks=function(r){Gu(this.props.draftState)!==0&&this.props.updateRenderLocksForAllDrafts({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826211),telemetryVisitor:this.props.telemetryVisitor},r)},t.prototype.componentDidMount=function(){var r,n;(n=(r=this.props).componentRef)===null||n===void 0||n.call(r,this),this.props.registerComponentUIActionListener(this.onCommentUIAction),this.props.registerComponentInterruptableCommandListener(this.onCommentInterruptableCommand),this.props.modelCapabilities.atMention!==_t.Unknown&&this.processAtMentionCapabilityState(),this.updateDraftRenderLocks(!0),ki()&&this.props.lastContextChangeIncrement>0&&this.onContextChanged()},t.prototype.componentWillUnmount=function(){this.props.unregisterComponentUIActionListener(this.onCommentUIAction),this.props.unregisterComponentInterruptableCommandListener(this.onCommentInterruptableCommand)},t.prototype.componentDidUpdate=function(r,n){var o,a;if(this.props.lastContextChangeIncrement!==r.lastContextChangeIncrement&&this.onContextChanged(),this.props.modelCapabilities.atMention!==r.modelCapabilities.atMention&&this.processAtMentionCapabilityState(),this.sendReadyToRenderNotification(r),this.props.draftState!==r.draftState)try{for(var d=$e(NC(this.props.draftState)),c=d.next();!c.done;c=d.next()){var u=c.value;if(this.props.draftState.drafts[u].renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(r.draftState.drafts[u]===void 0||r.draftState.drafts[u].renderContextType!==this.props.draftState.drafts[u].renderContextType)){this.updateDraftRenderLocks(!0);break}}}catch(l){o={error:l}}finally{try{c&&!c.done&&(a=d.return)&&a.call(d)}finally{if(o)throw o.error}}this.props.focusManager.commentPanePropsUpdated(this.props.componentTree,r,this.props)},t.prototype.focus=function(){this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},t.prototype.getInstanceId=function(){var r;return(r=this.props.componentInstanceId)!==null&&r!==void 0?r:"CommentPane"},t.prototype.getRenderableItemFromRef=function(r){var n=r.getId();return sr()?this.props.dataItems.find(function(o){return co(o)===n}):n===t.getPaneSingleCreateDraftId(this.props)?this.props.createdCommentLie&&{commentModel:this.props.createdCommentLie.newComment_deprecated}:this.props.dataItems.find(function(o){return co(o)===n})},t.prototype.closePane=function(){yv({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.renderCommentThread=function(r,n,o){var a,d;o===void 0&&(o=GA);var c=Po(n),u=c.commentId===t.getPaneSingleCreateDraftId(this.props);if(Y6())return uy.createElement(XA,{commentAPI:this.props.commentAPI,componentTree:this.props.componentTree,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:{id:c.commentId},getDiscardDraftCallback:this.getOnWillDiscardCallback,telemetryVisitor:this.props.telemetryVisitor,accessibilityPositionInSet:r+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,onInitialRender:this.props.onInitialRender,correlationId:this.props.correlationId,lppManager:this.props.lppManager,componentInstanceId:this.getHostableComponentInstanceId(c.commentId,this.props.componentTree.componentTreeId.renderContextType,u)});var l=it()?this.state.allRenderableItemThreads.length>0&&Po(this.state.allRenderableItemThreads[0]).commentId===c.commentId:this.props.dataItems.length===0||Po(this.props.dataItems).commentId===c.commentId,p=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.modelCapabilities.atMentionEmailAddresses,this.props.suggestionsDetails),g=c.commentId,h=fr(this.props.draftState),v=h||this.props.readOnly?zn.None:zn.Any,y=(a=this.props.tasks[g])===null||a===void 0?void 0:a.currentState,T=this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&!!Ds(this.props.draftState),b=this.props.highlightedCommentId||JA(this.props),I=this.getPinnedCardIndex_deprecated(),E=this.getThreadPostOrHistoryRecordStates()[I&&!vd()?I:r],P=((d=this.props.selectedComment)===null||d===void 0?void 0:d.selectedCardId)===g?this.props.selectedComment:void 0,_=da(c.commentId,this.props.expandedComments,this.props.componentTree.componentTreeId.renderContextType);return o({thread:n,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardViewStates[g],postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:p,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:P,isolationEdit:T,isAtMentionEnabled:!!p,isTaskCreationEnabled:Qm(this.props.modelCapabilities),isDraftThread:u,foldableLayoutState:this.props.foldableLayoutState,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:_,cardRelativeDraftingState:Gf(c.commentId,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState),accessibilityPositionInSet:r+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,maximumDimensions:void 0,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:p,availableScreenHeight:this.getAvailableScreenHeight(),extraPaddingLeft:this.getContentExtraPaddingLeft(),extraPaddingRight:this.getContentExtraPaddingRight(),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:b===g,contentBackgroundColor:this.getContentBackgroundColor(n.length>1,T),maxDraftHeight:this.getMaxDraftHeight(),restrictActionControls_deprecated:h,allowedDraftingSession:v,taskState:y,cardStyle:this.getCommentCardStyle(),onCardLayout:this.onCardLayout,isCardTabbable:zA(this.getKeyboardingOptions().cardTabbingMode,g,l,_,this.props.renderableSelectedComment),postOrHistoryRecordStates:E,richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:dg.Unspecified})},t.prototype.onMentionCreated=function(r){C0({failTag:C.reserveTag(593826271),successTag:C.reserveTag(593826272),person:r,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(593826273)})},t.prototype.onMentioneesStillInDraftUpdated=function(r){v0({trackback:C.reserveTag(593826275),emailsStillInDraft:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.onBackKeyPressed=function(){if(jo(this.props.draftState)){var r=mv(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),n=Bs(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession),o=Ka(this.props.draftState),a=Ds(this.props.draftState);if(o){var d=Pd(this.props.draftState),c=d===Nr.CannotAutoDiscard;ml({trackback:C.reserveTag(592840781),showDiscardDialog:c,invokeModalDialog:this.invokeModalDialog,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:n,cardId:o,draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:kf(this.state.allRenderableItemThreads,o)})}else a&&qf({trackback:C.reserveTag(592487364),commentId:a,setContents:void 0,data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:n,onWillDiscardCallback:this.getOnWillDiscardCallback(r),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})}else this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&yv({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.sendReadyToRenderNotification=function(r){this.props.initializationStatus===Wn.Initialized&&(this.props.componentTree.componentTreeId.renderContextType===r.componentTree.componentTreeId.renderContextType&&this.props.initializationStatus===r.initializationStatus||this.props.readyToRender({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(593826313)}))},t.prototype.deleteThreadConfirmCallback=function(){return this.props.selectedComment?(this.props.requestDeleteThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(593826314)},this.props.selectedComment.selectedCardId),He.Handled):(x().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",593826315),He.Unhandled)},t.prototype.processAtMentionCapabilityState=function(){var r=this.props.modelCapabilities.atMention;r!==_t.Unknown&&this.initialAtMentionCapability.set(r)},t.getPaneSingleCreateDraftId=function(r){return tt(r.draftState,!0,r.componentTree.componentTreeId.renderContextType)},t.prototype.getUpdatedItemThreads=function(r){if(!this.isReadyToRenderWithProps(r))return[];var n=!!this.props.currentFilter||cy(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),o=!!r.currentFilter||cy(r.draftState,r.componentTree.componentTreeId.renderContextType);return this.props.dataItems!==r.dataItems||this.props.cardViewStates!==r.cardViewStates||this.props.componentTree.componentTreeId.renderContextType!==r.componentTree.componentTreeId.renderContextType||this.props.personaIconPropertiesMap!==r.personaIconPropertiesMap||!sr()&&(this.props.createdCommentLie!==r.createdCommentLie||n!==o)?qC(r.dataItems,r.cardViewStates,r.createdCommentLie,r.componentTree.componentTreeId.renderContextType!==A.HalfPane,o):this.state.allRenderableItemThreads},t.prototype.getInitialState=function(r){var n=!!r.currentFilter||cy(r.draftState,r.componentTree.componentTreeId.renderContextType);return{allRenderableItemThreads:this.isReadyToRenderWithProps(r)?qC(r.dataItems,r.cardViewStates,r.createdCommentLie,r.componentTree.componentTreeId.renderContextType!==A.HalfPane,n):[],atMentionState:void 0}},t.prototype.onRequestLoadThreads=function(r){this.props.modelCapabilities.virtualized?this.props.queueLoadThreads({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(593826320)},r):x().assertConditionTag(!1,"onRequestLoadThreads called for non-virtualized store",593826321)},t.prototype.shouldShowGhostComment=function(){return this.props.componentTree.componentTreeId.renderContextType===A.FullPane&&this.props.nextPopulatedContextDetails!==Ut.Unknown&&this.props.nextPopulatedContextDetails!==Ut.NoComments&&this.props.nextPopulatedContextDetails!==Ut.OnlyCommentsInCurrent},t.prototype.onGhostCommentClicked=function(){var r=this,n=Q6(),o=n&&!it()||!n&&Q()!=="web";this.props.discardDraftIfEmpty({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:C.reserveTag(590955266)},le.SharedComments,o?ao.GhostCard:void 0).then(function(a){(!o||a.draftDiscardBehavior===Nr.NoDraft||a.draftDiscardResult===He.Handled)&&r.props.selectionManager.selectAcrossContexts(Yt.Next,r.props.componentTree.componentTreeId.renderContextType)}).catch(me(C.reserveTag(590955267)))},t.prototype.isReadyToRender=function(){return this.isReadyToRenderWithProps(this.props)},t.prototype.isReadyToRenderWithProps=function(r){return qu(r.pendingCommentLoad,r.modelCapabilities.virtualized,r.DoNotUse_isFilteringEnabled)},t.prototype.canCardDelete=function(r){return!0},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.render=function(){return uy.createElement(Dh.Provider,{value:this.props.lppManager},uy.createElement(tn.Provider,{value:this.props.componentTree.componentTreeId},this.renderInner()))},t}(uy.Component),Kp=KOe});var $pe,SB,IB,YOe,PT,ZA,$Oe,Qpe,Xpe,Jpe,Zpe,eme,tme,rme,EB,PB,nme,ly,QOe,ome,ime,ame,sme,dme,cme,ume,fy=f(()=>{"use strict";s();k();$pe=S(re());Fd();Ve();xr();je();SB=16,IB=16,YOe=12,PT=12,ZA=$pe.StyleSheet.hairlineWidth,$Oe=function(t){return{shadowColor:t.palette.CardShadowColor,shadowOffset:{height:1,width:0},shadowRadius:2,shadowOpacity:.1}},Qpe=new R([R.always({minWidth:64}),R.rule({displayClass:$t.LargeDisplay},{width:100})]),Xpe=new kt([kt.always({minWidth:96,textAlign:"center"}),kt.rule({displayClass:$t.LargeDisplay},{width:120})]),Jpe=new R([R.always(function(e){return{flex:1,flexDirection:"column",justifyContent:"flex-start",alignItems:"stretch",backgroundColor:e.palette.PaneBackground}}),R.rule({renderContextType:A.HalfPane},function(e){return{backgroundColor:e.palette.PaneBackground_HalfPane}})]),Zpe=new R([R.always({position:"absolute",bottom:0,left:0,right:0}),R.rule({platform:"android"},{zIndex:100})]),eme=ve({marginBottom:PT}),tme=new R([R.always(function(e){return m({marginBottom:PT},$Oe(e))}),R.rule({platform:"android"},function(e){return{marginLeft:SB,marginRight:IB,elevation:2,backgroundColor:e.palette.CardBackground}})]),rme=new R([R.always(function(e){return{flex:1,flexDirection:"column",borderRightWidth:ZA,borderRightColor:e.palette.CardAccent,borderLeftWidth:ZA,borderLeftColor:e.palette.CardAccent}})]),EB=new R([R.always(function(e){return{flex:1,alignSelf:"stretch",borderRightWidth:ZA,borderRightColor:e.palette.CardAccent,borderLeftWidth:ZA,borderLeftColor:e.palette.CardAccent}})]),PB=ve({flexDirection:"row",alignItems:"center"}),nme=ve({flex:1,justifyContent:"center"}),ly=24,QOe=67,ome=new R([R.always({minHeight:ly,minWidth:QOe,marginBottom:12,alignSelf:"flex-end"})]),ime=new R([R.rule({platform:"win32"},{marginRight:28})]),ame=new R([R.rule({platform:"win32"},{paddingRight:YOe})]),sme=ve({borderWidth:0}),dme=new R([R.rule({platform:"win32"},{borderColor:"transparent",borderWidth:2})]),cme=new R([R.rule({platform:"win32"},function(e){return{borderColor:e.palette.FocusBorderColor}})]),ume=function(t){return new R([R.always({flexDirection:"row"}),R.rule(function(){return t},{justifyContent:"space-between"})])}});var lme=f(()=>{"use strict";s();qH()});function pme(e,t,r,n,o,a){if(e&&e.selectedCardId===a.threadId&&e.selectionDetails.lowFidelityWarningType){var d=e.selectionDetails.lowFidelityWarningType,c=jA(d,o,a.renderContextType,n),u=2;return(a.renderContextType===A.HalfPane&&LK()||a.renderContextType!==A.HalfPane&&r)&&(u=1),m(m(m({},a),c),{renderMode:u,hasLowFidelityContent:!0})}return m(m({},a),{renderMode:0,hasLowFidelityContent:GC(t,void 0)})}function XOe(e,t,r,n){t(e,r,n)}function JOe(e,t){return function(){return e(t)}}function mme(e){mD(JOe,e.onWillUnmount,e.threadId);var t=py.useCallback(function(n){return XOe(n,e.onLayout,e.index,e.threadId)},[e.onLayout,e.index,e.threadId]),r=function(o){if(fe())return e.children;var a;return e.renderContextType===A.HalfPane?a=[fme(rme,e.renderContextType,o),{width:e.halfPaneWidth}]:a=[fme(tme,e.renderContextType,o)],py.createElement(ee,{style:a,onLayout:t},py.createElement(IT,m({},ZOe(e),{preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior})))};return py.createElement(bl.Provider,{value:e.index},We(r,Ge))}function fme(e,t,r){return Je(e,r,t)}function ZOe(e){return e.renderMode===0?{children:e.children,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior}:{renderContextType:e.renderContextType,cancelLabel:e.cancelLabel,confirmLabel:e.confirmLabel,warningLabel:e.warningLabel,onCancel:e.onCancel,onConfirm:e.onConfirm,children:e.renderMode===2?void 0:e.children,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior}}var py,gme=f(()=>{"use strict";s();k();mb();py=S(L());ye();Ve();fy();Gc();Tr();zo();dn();je();rr();fB();pB();Tl()});function nk(e){return{marginTop:0,marginLeft:5,width:eNe*e}}var RB,eNe,AB,ek,hme,tk,rk,yme,Cme,ok=f(()=>{"use strict";s();rt();xr();je();RB=32,eNe=125,AB=200,ek={borderColor:"transparent",borderWidth:2,alignItems:"center",flexDirection:"row",height:RB},hme={borderColor:"transparent",borderWidth:2,justifyContent:"flex-start",alignItems:"center",flexDirection:"row",height:RB},tk=new R([R.always(function(e){return{borderColor:e.palette.FocusBorderColor}})]),rk=new R([R.always(function(e){return{backgroundColor:e.menuFocus}})]),yme=ve({margin:5});Cme=Qe(function(e,t){return{width:AB*t,maxHeight:RB*(Math.min(e,10)+1)*t}})});var xme,ei,Tme,tNe,bme,Sme=f(()=>{"use strict";s();k();ha();Oe();Pt();xme=S(Kr()),ei=S(L()),Tme=S(re());lr();Tr();Kn();yo();je();rr();RM();F_();Ki();ok();tNe=ei.default.memo(function(e){var t=e.checked,r=e.collaborator,n=e.collaboratorMenuSetSize,o=e.focusRef,a=e.fontScale,d=e.isSelected,c=e.index,u=e.positionInSet,l=e.toggle,p=Vi(),g=GW(c),h=WI(c),v=qW(c),y=ei.default.useRef(null),T=ei.default.useRef(null),b=V(ei.default.useState(ce.Unfocused),2),I=b[0],E=b[1],P=ei.default.useRef(h),_=ei.default.useCallback(function(F){E(F)},[]);ei.default.useEffect(function(){o==null||o(y)},[o]),ei.default.useEffect(function(){var F;d&&((F=y.current)===null||F===void 0||F.focus())},[d]);var D=ei.default.useCallback(function(F){l(c,r)},[r,c,l]),M=ei.default.useCallback(function(){l(c,r)},[r,c,l]),H=ei.default.useCallback(function(F){var z,Y;if(I!==ce.Unfocused){var B=vu(F.nativeEvent.key,Tme.I18nManager.isRTL);B===J.ArrowRight?P.current===h&&(P.current=v,(z=T.current)===null||z===void 0||z.focus(),F.stopPropagation()):B===J.ArrowLeft?P.current===v&&(P.current=h,(Y=y.current)===null||Y===void 0||Y.focus(),F.stopPropagation()):(B===J.Enter||B===J.Space)&&P.current===h&&(l(c,r),F.stopPropagation())}},[r,I,c,l,v,h]),U=function(z,Y){var B=V_(z,Y),q=Ht(Y),K=[ek];return I===ce.FocusOn&&K.push(Je(tk,z,p.renderContextType)),d&&K.push(ts(rk,q,p.renderContextType)),ei.default.createElement(nr,{style:[K],ref:y,onPress:D,preventDefaultKeyDownBehavior:void 0,isTabbable:!0,tooltip:r.DisplayName,accessible:!0,accessibilityLabel:r.DisplayName,accessibilityPositionInSet:u,accessibilitySetSize:n,accessibilityRole:"menuitem",focusable:!0,onFocusStateChange:_,onKeyDown:H,keyDownEvents:[]},ei.default.createElement(B,{checked:t,onChange:M,preventDefaultKeyDownBehavior:void 0,isTabbable:!0,nodeId:g,testID:g}),ei.default.createElement(va,{ref:T,author:r,accessible:!1,focusable:!0,size:xme.PersonaImageSize.small,preventDefaultKeyDownBehavior:void 0}),ei.default.createElement(Sr,{numberOfLines:1,color:q.text,variant:"secondaryStandard",style:[nk(a)],accessible:!1,focusable:!1},r.DisplayName))};return We(U,Ge,At)}),bme=tNe});var kB,To,my,Ime,rNe,Eme,nNe,Pme,_me=f(()=>{"use strict";s();k();ha();Oe();Pt();kB=S(of()),To=S(L()),my=S(re());Vo();lr();Tr();Kn();yo();Js();je();rr();Ki();Sme();ok();Ime=[{key:J.ArrowDown,eventPhase:De.Capturing},{key:J.ArrowUp,eventPhase:De.Capturing},{key:J.Home,eventPhase:De.Capturing},{key:J.End,eventPhase:De.Capturing}],rNe=WW(),Eme=zW(),nNe=To.default.memo(function(e){var t,r=e.addCollaboratorToFilter,n=e.collaborators,o=e.currentFilter,a=e.localizationAPI,d=e.removeCollaboratorFromFilter,c=e.resetCollaboratorFilter,u=V(To.default.useState(void 0),2),l=u[0],p=u[1],g=To.default.useRef(null),h=Vi(),v=V(To.default.useState(-1),2),y=v[0],T=v[1],b=V(To.default.useState(ce.Unfocused),2),I=b[0],E=b[1],P=(0,my.useWindowDimensions)().fontScale,_=n.length,D=n.length+1;y===0&&((t=g==null?void 0:g.current)===null||t===void 0||t.focus());var M=To.default.useCallback(function(q){y===-1&&T(0),E(q)},[y]),H=To.default.useCallback(function(q,K){var $,oe;q===y?($=l==null?void 0:l.current)===null||$===void 0||$.focus():T(q),((oe=o.userFilter)===null||oe===void 0?void 0:oe.findIndex(function(ie){return ie.UserId===K.UserId}))!==-1?d(K):r(K)},[r,o.userFilter,y,d,l]),U=To.default.useCallback(function(q){T(0),c()},[c]),F=To.default.useCallback(function(q){q.nativeEvent.key===J.ArrowDown?T(y===_?0:y+1):q.nativeEvent.key===J.ArrowUp?T(y===0?_:y-1):q.nativeEvent.key===J.Home?(T(0),q.stopPropagation()):q.nativeEvent.key===J.End&&(T(_),q.stopPropagation())},[y,_]),z=To.default.useCallback(function(q){p(q)},[]),Y=function(K,$){var oe=o.userFilter&&o.userFilter.length>0,ie=Ol({icon:oe?28:29,renderTarget:"Pane",themeId:K.themeId}),Ce=Ht($),se=[ek];return I===ce.FocusOn&&se.push(Je(tk,K,h.renderContextType)),y===0&&oe&&se.push(ts(rk,Ce,h.renderContextType)),To.default.createElement(nr,{ref:g,style:[se],onPress:U,preventDefaultKeyDownBehavior:void 0,isTabbable:!0,focusable:!0,accessible:!0,accessibilityLabel:a.getString(270),accessibilityRole:"menuitem",onKeyDown:F,keyDownEvents:Ime,onFocusStateChange:M,testID:Eme,nodeId:Eme},To.default.createElement(kB.ViewWin32,{style:[hme],accessible:!0,focusable:!0},To.default.createElement(my.Image,{source:ie.source,style:[yme]}),To.default.createElement(Sr,{numberOfLines:1,color:oe?Ce.text:Ce.disabledText,variant:"secondaryStandard",style:[nk(P)]},a.getString(270))))},B=function(K,$){var oe,ie;return To.default.createElement(kB.ViewWin32,{focusable:!1,accessible:!1,accessibilityLabel:FI(a,(ie=(oe=o.userFilter)===null||oe===void 0?void 0:oe.length)!==null&&ie!==void 0?ie:0),accessibilityRole:"menu",style:[Cme(D,P)],onKeyDown:F,keyDownEvents:Ime,testID:rNe},To.default.createElement(my.ScrollView,null,Y(K,$),n.map(function(Ce,se){var he,Be=se+1,_e=y===Be;return To.default.createElement(bme,{fontScale:P,key:WI(Be),index:Be,isSelected:_e,toggle:H,focusRef:_e?z:void 0,collaborator:Ce,positionInSet:Be+1,collaboratorMenuSetSize:D,checked:!!(!((he=o.userFilter)===null||he===void 0)&&he.find(function(ot){return ot.UserId===Ce.UserId}))})})))};return We(B,Ge,At)}),Pme=nNe});function Rme(){return ik.useContext(_T)}var ik,_T,ak=f(()=>{"use strict";s();ik=S(L()),_T=ik.createContext(void 0)});function kme(e){var t,r,n=e.currentFilter,o=e.createOrUpdateFilter,a=e.collaborators,d=Rme();x().assertConditionTag(!!d,"FilterCapabilities should be defined in order for ContentFilter to render. Falling back to default.",507258371);var c=Ame.useMemo(function(){return d??{supportedContentTypes:Bt.CommentThread}},[d]),u=c.supportsMentionToMeFilter?n.mentionsToCurrentUser:void 0,l=(r=(t=n.CommentThread)===null||t===void 0?void 0:t.resolutionStatus)!==null&&r!==void 0?r:Vt.All,p=MF(n,c),g=function(P){o(m(m({},n),{CommentThread:{resolutionStatus:P}}))},h=function(P){o(m(m({},n),{mentionsToCurrentUser:P}))},v=function(){o(m(m({},n),{userFilter:[]}))},y=function(P){n.userFilter!==void 0&&!n.userFilter.includes(P)&&o(m(m({},n),{userFilter:w(w([],V(n.userFilter),!1),[P],!1)}))},T=function(P){if(n.userFilter!==void 0&&n.userFilter.includes(P)){var _=n.userFilter.filter(function(D){return D.UserId!==P.UserId});o(m(m({},n),{userFilter:_}))}},b=function(){o({mentionsToCurrentUser:sa.mentionsToCurrentUser,CommentThread:{resolutionStatus:sa.CommentThread.resolutionStatus},userFilter:c.supportsFilterByUser?[]:void 0})},I=function(){var P;if(p)return 0;var _=0;return n.mentionsToCurrentUser!==sa.mentionsToCurrentUser&&_++,((P=n.CommentThread)===null||P===void 0?void 0:P.resolutionStatus)!==void 0&&n.CommentThread.resolutionStatus!==sa.CommentThread.resolutionStatus&&_++,a!==void 0&&n.userFilter!==void 0&&n.userFilter.length&&_++,_};return{filterCapabilities:c,atMentionToMe:u,setAtMentionToMe:h,resolutionStatus:l,setResolutionStatus:g,resetCollaboratorFilter:v,collaboratorFilter:n.userFilter,addCollaboratorToFilter:y,removeCollaboratorFromFilter:T,areAllFiltersReset:p,resetAll:b,getNumberOfFiltersApplied:I}}var Ame,Dme=f(()=>{"use strict";s();k();Sd();te();Eo();Ame=S(L());Ad();XC();ak()});var wme,Fme,Ome,Nme=f(()=>{"use strict";s();fy();xr();wme=new R([R.always({minHeight:ly,minWidth:ly,marginBottom:12,alignSelf:"flex-start",marginLeft:0,marginRight:2})]),Fme={height:24,justifyContent:"center"},Ome={height:20,justifyContent:"center"}});function Mme(){var e=x().createActivityObject("ContentFilterMenuDisplayed",ht(ut.ReviewedAsNotNecessary),Ee());e.addDataField("ContentFilterMenuDisplayed",!0,N.SystemMetadata),e.successTag(C.reserveTag(508061576))}function DB(e,t){var r=x().createActivityObject("ContentFilterChanged",ht(ut.Todo,8268978),Ee());e!==void 0&&r.addDataField("ResolutionState",e,N.SystemMetadata),t!==void 0&&r.addDataField("AtMentionsMe",t,N.SystemMetadata),r.successTag(C.reserveTag(508151255))}var Lme=f(()=>{"use strict";s();ne();te()});var gt,oNe,Hme,Bme,iNe,wB,aNe,FB,Ume=f(()=>{"use strict";s();Sd();ne();b_();ym();gt=S(L());ye();Ad();Xa();yi();Vo();lr();Kn();Js();je();rr();_me();ok();Ih();mr();Dme();Nme();Lme();oNe=Cp.customize({paddingVertical:8}),Hme=T_.customize({fontSize:12,fontWeight:"semiBold",gap:5}),Bme=C_.customize({paddingVertical:8}),iNe=2,wB=iNe+LF.length,aNe=function(t){switch(t){case Vt.ActiveOnly:return UW();case Vt.ResolvedOnly:return VW();case Vt.All:throw new Error("Unexpected: No corresponding UI component for CommentResolutionStatus.All");default:Me(t)}},FB=gt.memo(function(e){var t=e.collaborators,r=e.currentFilter,n=e.filterItemCount,o=e.localizationAPI,a=e.preventDefaultKeyDownBehavior,d=kme(e),c=d.filterCapabilities,u=d.atMentionToMe,l=d.setAtMentionToMe,p=d.resolutionStatus,g=d.setResolutionStatus,h=d.areAllFiltersReset,v=d.resetAll,y=d.getNumberOfFiltersApplied,T=d.resetCollaboratorFilter,b=d.addCollaboratorToFilter,I=d.removeCollaboratorFromFilter,E=c.supportsFilterByUser&&!!t,P=$g(),_=Vi(),D=gt.useRef(!1);gt.useEffect(function(){if(D.current){var se=wI(o,n);se&&(oi(se,{nativeId:jI()}),D.current=!1)}},[n,o]);var M=gt.useRef(null),H=Ca({icon:h?29:28,themeId:P.themeId,renderTarget:"Pane"}),U=gt.useMemo(function(){var se=gt.createElement(oNe,{key:"resetAllKey",disabled:h,icon:H,accessibilityLabel:o.getString(262),onClick:v,accessibilitySetSize:wB,accessibilityPositionInSet:1,persistOnClick:tj()?!0:void 0},o.getString(262));return[se]},[h,o,v,H]),F=gt.useMemo(function(){if(u===void 0)return[];var se=[],he=o.getString(249);return se.push(gt.createElement(Bme,{key:DC(),name:DC(),accessibilitySetSize:wB,accessibilityPositionInSet:2},he)),se},[u,o]),z=gt.useMemo(function(){return LF.map(function(se,he){var Be=3+he;return gt.createElement(Bme,{key:aNe(se),name:se.toString(),accessibilitySetSize:wB,accessibilityPositionInSet:Be},rW(o,se))})},[o]),Y=gt.useMemo(function(){var se,he;if(!E)return[];var Be=[];return Be.push(gt.createElement(gp,null,gt.createElement(yp,null,gt.createElement(Cp,null,FI(o,(he=(se=r.userFilter)===null||se===void 0?void 0:se.length)!==null&&he!==void 0?he:0))),gt.createElement(wl,{minWidth:AB},gt.createElement(vp,null,gt.createElement(Pme,{collaborators:t,currentFilter:r,addCollaboratorToFilter:b,removeCollaboratorFromFilter:I,resetCollaboratorFilter:T,localizationAPI:o}))))),Be},[b,t,E,r,o,I,T]),B=gt.useCallback(function(se,he){D.current=!0;var Be=he.includes(Vt.ActiveOnly.toString()),_e=he.includes(Vt.ResolvedOnly.toString()),ot=he.includes(DC());u!==ot&&(l(ot),DB(void 0,ot));var Ue=Vt.All;Be&&_e?p===Vt.ActiveOnly?Ue=Vt.ResolvedOnly:p===Vt.ResolvedOnly&&(Ue=Vt.ActiveOnly):Be?Ue=Vt.ActiveOnly:_e&&(Ue=Vt.ResolvedOnly),p!==Ue&&(g(Ue),DB(Ue,void 0))},[u,p,l,g]),q=gt.useMemo(function(){var se=o.getString(261);return gt.createElement(wl,null,gt.createElement(vp,null,U,gt.createElement(Sh,{key:"divider1"}),gt.createElement(x_,null,ej()?gt.createElement(Hme,{key:se,align:"center",style:Ome},se):gt.createElement(ee,{style:Fme},gt.createElement(Hme,{key:se,align:"center"},se)),F,gt.createElement(Sh,{key:"divider2"}),z,E&&gt.createElement(Sh,{key:"divider3"}),Y)))},[F,Y,E,o,U,z]),K=gt.useCallback(function(se,he){he&&Mme()},[]),$=gt.useMemo(function(){return function(se){return{menu:q,props:{onCheckedChange:B,checked:se,onOpenChange:K}}}},[q,B,K]),oe=y(),ie=oW(oe),Ce=p!==Vt.All?[p.toString()]:[];return u&&Ce.push(DC()),gt.createElement(hn,{onClick:void 0,accessibilityLabel:nW(o,oe),isTabbable:!0,key:"filterMenu",icon:27,text:ie??"",ref:M,style:Je(wme,P,_.renderContextType),preventDefaultKeyDownBehavior:a,menuProps:$(Ce),testID:jn(X.FilterButton),nodeId:jn(X.FilterButton)})})});var Vme=f(()=>{"use strict";s();Ume()});var jme,Wme=f(()=>{"use strict";s();fy();jme={marginTop:4,height:ly}});var OB,NB,zme=f(()=>{"use strict";s();ha();OB=S(L());xb();Vo();lr();Wme();NB=OB.default.memo(function(e){var t=vb();return OB.default.createElement(Sr,{nativeID:jI(),style:jme},wI(t,e.itemCount))})});var Gme=f(()=>{"use strict";s();zme()});var qme,dNe,cNe,sk,Kme,Yme,$me,Qme,Xme,Jme,Zme,ege,MB,LB=f(()=>{"use strict";s();k();qme=S(Kr());zc();fy();go();xr();je();dNe=86,cNe=15,sk=new R([R.always({justifyContent:"flex-end",height:dNe,paddingLeft:SB,paddingRight:IB,borderWidth:1,borderColor:"transparent"}),R.rule({platform:"win32"},{marginLeft:13,marginRight:1,marginBottom:1,paddingLeft:0,paddingRight:0})]),Kme=new R([R.rule({platform:"win32"},function(e){return{borderColor:e.palette.FocusBorderColor,borderStyle:"dashed"}})]),Yme=qme.StyleSheet.createViewStyle({marginBottom:Rr,flex:0,textAlign:"center"}),$me=new R([R.always(function(e){return{height:52,backgroundColor:e.palette.CardBackground,flexDirection:"row",alignItems:"stretch",elevation:2,flex:0,borderLeftWidth:rs,borderTopWidth:rs,borderRightWidth:rs,borderColor:e.palette.CardAccent}})]),Qme=ve({width:Rr+30+Wg,flex:0}),Xme=new R(w(w([R.always({width:30,height:30,borderRadius:cNe,position:"absolute",left:Rr,marginTop:12})],V(Dv),!1),[R.rule({platform:"win32"},function(e){return{backgroundColor:e.palette.CardAccent}})],!1)),Jme=ve({flex:1,alignItems:"stretch"}),Zme=ve({paddingRight:70,marginTop:12,alignItems:"stretch"}),ege=ve({paddingRight:12,marginTop:6,alignItems:"stretch"}),MB=new R(w(w([R.always({height:11,borderRadius:5.5})],V(Dv),!1),[R.rule({platform:"win32"},function(e){return{backgroundColor:e.palette.CardAccent}})],!1))});var Pa,HB,rge=f(()=>{"use strict";s();k();Pt();Pa=S(L());Ve();lr();Tr();je();rr();Ki();mr();gn();LB();HB=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.onFocusStateChange=function(n){var o,a;n===ce.FocusOn&&((a=(o=r.props).onFocus)===null||a===void 0||a.call(o))},r.renderWithTheme=function(n){return Pa.createElement(nr,{onPress:r.props.onClick,accessibilityRole:"button",accessibilityLabel:r.props.accessibilityLabel,accessible:!0,style:r.renderStyle(sk,n),isTabbable:!0,nodeId:RC(),testID:RC(),onFocusStateChange:r.onFocusStateChange,focusedStyle:r.renderStyle(Kme,n),preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior},Pa.createElement(qe,{style:Yme,textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},r.props.ghostCommentString),Pa.createElement(ee,{style:r.renderStyle($me,n)},Pa.createElement(ee,{style:Qme},Pa.createElement(ee,{style:r.renderStyle(Xme,n)})),Pa.createElement(ee,{style:Jme},Pa.createElement(ee,{style:Zme},Pa.createElement(ee,{style:r.renderStyle(MB,n)})),Pa.createElement(ee,{style:ege},Pa.createElement(ee,{style:r.renderStyle(MB,n)})))))},r.render=function(){return We(r.renderWithTheme,Ge)},r}return t.prototype.renderStyle=function(r,n){return Je(r,n,A.FullPane)},t}(Pa.PureComponent)});var nge=f(()=>{"use strict";s();rge()});var oge,BB,ige=f(()=>{"use strict";s();k();oge=S(L()),BB=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return null},t}(oge.Component)});var age=f(()=>{"use strict";s();ige()});var sge,dge,cge,uge=f(()=>{"use strict";s();sge=S(Kr());Ve();xr();dge=new R([R.rule({renderContextType:A.HalfPane},{flex:1,alignSelf:"stretch",justifyContent:"center"}),R.rule({renderContextType:A.FullPane},{margin:12})]),cge=sge.StyleSheet.createViewStyle({textAlign:"center"})});var RT,lge,fge=f(()=>{"use strict";s();RT=S(L());mr();gn();uge();dn();lge=RT.memo(function(t){var r=[dge.render(Wr(t.renderContextType)),t.containerWidth?{width:t.containerWidth}:void 0];return RT.createElement(ee,{style:r},RT.createElement(qe,{textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard",style:cge},t.message))})});var gy,lNe,pge,mge=f(()=>{"use strict";s();k();gy=S(L());Gc();lNe=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(){return gy.createElement(gy.Fragment,null,this.props.children)},t.displayName="Fragment",t}(gy.PureComponent),pge=js(lNe)});var gge,fNe,UB,hge=f(()=>{"use strict";s();te();gge=function(t){return t&-t},fNe=function(){function e(t,r){var n=this,o=r??t.length;this.tree=[];for(var a=0;a<o;a++)this.tree.push(0);t.forEach(function(d,c){return c<n.tree.length&&n.add(d,c)})}return e.prototype.getSum=function(t){if(t<0||t>=this.tree.length){var r="getSum index out of bounds: ".concat(t,", length ").concat(this.tree.length);throw x().assertConditionTag(!1,r,595857548),new Error(r)}for(var n=0,o=t+1;o>0;o-=gge(o))n+=this.tree[o-1];return n},e.prototype.add=function(t,r){if(r<0||r>=this.tree.length){var n="getSum index out of bounds: ".concat(r,", length ").concat(this.tree.length);throw x().assertConditionTag(!1,n,595857549),new Error(n)}for(var o=r+1;o<=this.tree.length;o+=gge(o))this.tree[o-1]+=t},e.prototype.set=function(t,r){this.add(t-this.getValue(r),r)},e.prototype.getValue=function(t){return this.getSum(t)-(t&&this.getSum(t-1))},e.prototype.getCapacity=function(){return this.tree.length},e}(),UB=fNe});var Lo,pNe,mNe,yge,VB=f(()=>{"use strict";s();ne();te();(function(e){e[e.None=0]="None",e[e.NewScroll=1]="NewScroll",e[e.ReasonUnknown=2]="ReasonUnknown",e[e.CoauthChange=3]="CoauthChange",e[e.UserInteraction=4]="UserInteraction",e[e.UserScroll=5]="UserScroll",e[e.DirectionChange=6]="DirectionChange"})(Lo||(Lo={}));pNe=-1,mNe=function(){function e(t){this.dataFieldVisitor=t}return e.prototype.startStickyScroll=function(t){var r;this.session&&this.end(Lo.NewScroll,C.reserveTag(595138519));var n=x().createActivityObject("StickyScrollPerf",this.dataFieldVisitor,Ee());this.session={activity:n,activityStart:e.now(),numRescrolls:0},n.addDataField("ScrollOffset",t.scrollOffset,N.SystemMetadata),n.addDataField("ContentHeight",(r=t.contentHeight)!==null&&r!==void 0?r:pNe,N.SystemMetadata),n.addDataField("IsHorizontal",t.isHorizontal,N.SystemMetadata)},e.prototype.end=function(t,r){var n;this.session&&(this.session.activity.addDataField("Duration",((n=this.session.lastRescrollTime)!==null&&n!==void 0?n:this.session.activityStart)-this.session.activityStart,N.SystemMetadata),this.session.activity.addDataField("NumberOfRescrolls",this.session.numRescrolls,N.SystemMetadata),this.session.activity.addDataField("EndReason",t,N.SystemMetadata),this.session.activity.successTag(r),this.session=void 0)},e.prototype.onRescroll=function(){this.session&&(this.session.lastRescrollTime=e.now(),this.session.numRescrolls++)},e.now=function(){var t=1e3;if(typeof performance<"u"&&performance.now){var r=performance.now();return Math.floor(r*t)}return Date.now()*t},e}(),yge=mNe});var wn,Jn,gNe,Cge,vge=f(()=>{"use strict";s();k();ne();te();pn();Pr();LA();VB();(function(e){e[e.None=0]="None",e[e.ScrollOffset=1]="ScrollOffset",e[e.ContentHeight=2]="ContentHeight",e[e.ContentWidth=4]="ContentWidth",e[e.OuterHeight=8]="OuterHeight",e[e.OuterWidth=16]="OuterWidth",e[e.ProgrammaticScrollEnd=32]="ProgrammaticScrollEnd"})(wn||(wn={}));(function(e){e[e.Refresh=0]="Refresh",e[e.Start=1]="Start",e[e.End=2]="End",e[e.Index=3]="Index",e[e.Offset=4]="Offset"})(Jn||(Jn={}));gNe=function(){function e(){this.isCurrentlyAnimating=!1}return e.prototype.setTargetOffset=function(t,r,n){this.targetScrollToOffset=t,this.prevScrollToOffset=r,this.isCurrentlyAnimating=n},e.prototype.getTargetOffset=function(){return this.targetScrollToOffset},e.prototype.getPreviousScrollToOffset=function(){return this.prevScrollToOffset},e.prototype.isAnimating=function(){return this.isCurrentlyAnimating},e}(),Cge=function(){function e(t,r,n){var o=this;this.scrollOffset=0,this.contentHeight=void 0,this.contentWidth=void 0,this.outerHeight=0,this.outerWidth=0,this.listRef=null,this.userIsScrolling=!1,this.targetScrollToOffset=new gNe,this.changeListeners=[],this.onUserScrollEndListeners=[],this.PROGRAMMATIC_END_OFFSET_THRESHOLD=3,this.shouldFireProgrammaticEndOnScroll=function(){if(o.userIsScrolling)return!1;var a=o.targetScrollToOffset.getTargetOffset();if(a===void 0){var d=o.getOuterLength(),c=o.targetScrollToOffset.getPreviousScrollToOffset();return c||(c=0),d===void 0?(x().assertConditionTag(!o.isHorizontal,"Half pane needs better info since it can't handle multiple end events for the same position",590717702),Math.floor(o.scrollOffset)!==Math.floor(c)):Math.abs(o.scrollOffset-c)>d-o.PROGRAMMATIC_END_OFFSET_THRESHOLD}return Math.floor(a)===Math.floor(o.scrollOffset)},this.onContentSizeChange=this.onContentSizeChange.bind(this),this.onListLayout=this.onListLayout.bind(this),this.onMomentumScrollBegin=this.onMomentumScrollBegin.bind(this),this.onMomentumScrollEnd=this.onMomentumScrollEnd.bind(this),this.onScroll=this.onScroll.bind(this),this.onScrollBeginDrag=this.onScrollBeginDrag.bind(this),this.onScrollEndDrag=this.onScrollEndDrag.bind(this),this.scrollToQueuedTarget=this.scrollToQueuedTarget.bind(this),this.setListRef=this.setListRef.bind(this),this.getItemLayout=t,this.isHorizontal=r,this.stickyScrollTracker=new yge(n)}return e.prototype.getOuterViewProps=function(){return{onLayout:this.onListLayout}},e.prototype.getScrollProps=function(){return{onContentSizeChange:this.onContentSizeChange,onMomentumScrollBegin:this.onMomentumScrollBegin,onMomentumScrollEnd:this.onMomentumScrollEnd,onScroll:this.onScroll,onScrollBeginDrag:this.onScrollBeginDrag,onScrollEndDrag:this.onScrollEndDrag,ref:this.setListRef}},e.prototype.getScrollOffset=function(){return this.scrollOffset},e.prototype.getContentHeight=function(){return this.contentHeight},e.prototype.getContentWidth=function(){return this.contentWidth},e.prototype.getOuterHeight=function(){return this.outerHeight},e.prototype.getOuterWidth=function(){return this.outerWidth},e.prototype.getListRef=function(){return this.listRef},e.prototype.onContentSizeChange=function(t,r){this.onContentSizeChangeImpl(t,r)},e.prototype.onContentSizeChangeImpl=function(t,r){var n=wn.None;t!==this.contentWidth&&(n|=wn.ContentWidth),r!==this.contentHeight&&(n|=wn.ContentHeight);var o=this.scrollOffset,a=this.getContentLength(),d=this.isHorizontal?t:r;a!==void 0&&d<a&&(o=oB(this.scrollOffset,this.getOuterLength(),d)),o!==this.scrollOffset&&(n|=wn.ScrollOffset,this.scrollOffset=o),this.contentHeight=r,this.contentWidth=t,this.fireChangeListenerNotification(n),this.scrollToStickyTarget(C.reserveTag(595940952))},e.prototype.onScroll=function(t){t&&(t.nativeEvent.isUserTriggered&&this.clearStickyState(Lo.UserScroll,C.reserveTag(595138520)),this.scrollOffset=this.isHorizontal?t.nativeEvent.contentOffset.x:t.nativeEvent.contentOffset.y,this.shouldFireProgrammaticEndOnScroll()?(this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1),this.fireChangeListenerNotification(wn.ScrollOffset|wn.ProgrammaticScrollEnd)):this.fireChangeListenerNotification(wn.ScrollOffset))},e.prototype.onScrollBeginDrag=function(t){this.clearStickyState(Lo.UserScroll,C.reserveTag(595138521)),this.userIsScrolling=!0},e.prototype.onScrollEndDrag=function(t){},e.prototype.onMomentumScrollBegin=function(t){this.userIsScrolling=!0},e.prototype.onMomentumScrollEnd=function(t){this.userIsScrolling&&this.onUserScrollEndListeners.forEach(function(r){return r()}),this.userIsScrolling=!1,this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1)},e.prototype.setListRef=function(t){this.listRef=t},e.prototype.onListLayout=function(t){var r=t.nativeEvent.layout.height,n=t.nativeEvent.layout.width,o=wn.None;this.outerHeight!==r&&(o|=wn.OuterHeight,this.outerHeight=r),this.outerWidth!==n&&(o|=wn.OuterWidth,this.outerWidth=n),this.fireChangeListenerNotification(o)},e.prototype.scrollToIndex=function(t,r,n,o){n===void 0&&(n=!1),o===void 0&&(o=!1),this.clearStickyState(Lo.NewScroll,C.reserveTag(595138522)),n&&(this.stickyState={type:Jn.Index,index:t,lazy:o},this.stickyScrollTracker.startStickyScroll({contentHeight:this.contentHeight,isHorizontal:this.isHorizontal,scrollOffset:this.scrollOffset})),this.queueScrollTarget({type:Jn.Index,lazy:o,animate:r,index:t,origin:C.reserveTag(595940959),isStickyRescroll:!1})},e.prototype.scrollToOffsets=function(t,r,n){for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];this.clearStickyState(Lo.NewScroll,C.reserveTag(595138523)),this.queueScrollTarget({type:Jn.Offset,lazy:r,animate:t,offset:n,additionalOffsets:o,origin:C.reserveTag(595940960)})},e.prototype.scrollToStart=function(t){this.clearStickyState(Lo.NewScroll,C.reserveTag(595138524)),this.queueScrollTarget({type:Jn.Start,animate:t,origin:C.reserveTag(595940961)})},e.prototype.scrollToEnd=function(t,r){r===void 0&&(r=!1),this.clearStickyState(Lo.NewScroll,C.reserveTag(595138525)),r&&(this.stickyState={type:Jn.End},this.stickyScrollTracker.startStickyScroll({contentHeight:this.contentHeight,isHorizontal:this.isHorizontal,scrollOffset:this.scrollOffset})),this.queueScrollTarget({type:Jn.End,animate:t,origin:C.reserveTag(595940962),isStickyRescroll:!1})},e.prototype.registerChangeListener=function(t){this.changeListeners.push(t)},e.prototype.unregisterChangeListener=function(t){var r=this.changeListeners.indexOf(t);return r<0?!1:(this.changeListeners.splice(r,1),!0)},e.prototype.registerUserScrollEndListener=function(t){this.onUserScrollEndListeners.push(t)},e.prototype.unregisterUserScrollEndListener=function(t){var r=this.onUserScrollEndListeners.indexOf(t);return r<0?!1:(this.onUserScrollEndListeners.splice(r,1),!0)},e.prototype.clearStickyState=function(t,r){this.stickyState=void 0,this.queuedScrollTarget&&this.queuedScrollTarget.type===Jn.Index&&this.queuedScrollTarget.isStickyRescroll&&(this.queuedScrollTarget=void 0),this.stickyScrollTracker.end(t,r)},e.prototype.onItemLayoutChange=function(){this.scrollToStickyTarget(C.reserveTag(595940963))},e.prototype.setIsHorizontal=function(t){var r=this.isHorizontal;this.isHorizontal=t,this.isHorizontal!==r&&(this.scrollOffset=0,this.clearStickyState(Lo.DirectionChange,C.reserveTag(595138526)))},e.prototype.currentOffsetInvalidated=function(){this.scrollOffset=0,this.clearStickyState(Lo.NewScroll,C.reserveTag(556323672))},e.prototype.getIsHorizontal=function(){return this.isHorizontal},e.prototype.fireChangeListenerNotification=function(t){t!==wn.None&&this.changeListeners.forEach(function(r){return r(t)})},e.prototype.queueScrollTarget=function(t){var r=this.queuedScrollTarget;if(r){if(t.type===Jn.Refresh)return;this.queuedScrollTarget=t}else this.queuedScrollTarget=t,setTimeout(this.scrollToQueuedTarget,this.getScrollTimeout())},e.prototype.getScrollTimeout=function(){return Q()==="win32"?250:0},e.prototype.scrollToStickyTarget=function(t){this.stickyState&&this.queueScrollTarget(m(m({},this.stickyState),{animate:!1,isStickyRescroll:!0,origin:t}))},e.prototype.scrollToQueuedTarget=function(){try{var t=this.queuedScrollTarget;if(this.listRef&&t){var r=void 0,n=!0,o=[],a=t.type;switch(t.type){case Jn.Start:r=0;break;case Jn.End:r=this.getContentLength()||0;break;case Jn.Index:t.isStickyRescroll&&this.stickyScrollTracker.onRescroll();var d=this.getItemLayout(t.index);d?(r=d.offset,o=[d.offset+d.length],n=t.lazy):(r=this.scrollOffset,a=Jn.Refresh);break;case Jn.Offset:r=t.offset,n=t.lazy,o=t.additionalOffsets;break;case Jn.Refresh:r=this.scrollOffset,a=Jn.Refresh;break;default:Me(t)}var c=t.type===Jn.Refresh?!1:t.animate,u=MA.apply(void 0,w([n,this.getOuterLength(),this.getContentLength()||0,this.scrollOffset,r],V(o),!1)),l=void 0;(u!==this.scrollOffset||a===Jn.Refresh||Q()!=="win32")&&(this.listRef.scrollToOffset({animated:c,offset:u}),u!==this.scrollOffset?this.targetScrollToOffset.setTargetOffset(u,this.targetScrollToOffset.getTargetOffset()?this.targetScrollToOffset.getTargetOffset():0,c):this.targetScrollToOffset.setTargetOffset(void 0,this.scrollOffset,!1))}}catch(p){me(C.reserveTag(574433048))(p)}finally{this.queuedScrollTarget=void 0}},e.prototype.getContentLength=function(){return this.isHorizontal?this.contentWidth:this.contentHeight},e.prototype.getOuterLength=function(){return this.isHorizontal?this.outerWidth:this.outerHeight},e}()});var Yp,ft,od,pu,Ji,jl,hNe,yNe,CNe,vNe,xNe,TNe,bNe,xge,Tge=f(()=>{"use strict";s();k();ne();rt();te();wd();Pt();Yp=S(Kr()),ft=S(L()),od=S(re());Rc();Es();Sc();pn();ye();Cr();an();yt();bn();so();ng();Uf();Fd();sg();Ve();bB();fy();lme();Ih();gme();DA();Vme();Gme();nge();LB();tB();ZH();age();mr();ix();gn();fge();Xa();mge();Gc();Ws();yi();pv();OA();Vo();qA();lr();Tr();w_();ak();VH();NA();jH();hge();vge();Pr();zo();LA();yT();VB();go();dn();je();rr();PA();(function(e){e[e.None=0]="None",e[e.HalfPaneContextChangePlaceholder=1]="HalfPaneContextChangePlaceholder"})(pu||(pu={}));(function(e){e[e.None=0]="None",e[e.FullPaneGhostCard=1]="FullPaneGhostCard",e[e.FullPaneGhostCardPlaceholder=2]="FullPaneGhostCardPlaceholder",e[e.HalfPaneContextChangePlaceholder=3]="HalfPaneContextChangePlaceholder"})(Ji||(Ji={}));(function(e){e[e.InList=0]="InList",e[e.BelowList=1]="BelowList"})(jl||(jl={}));hNe=.54,yNe=.4,CNe=.4,vNe=235,xNe={cardTabbingMode:Bi.ExpandedCardOrFirstCardTabbable,postTabbingMode:Ui.ExpandedCardRootPostTabbable},TNe={cardTabbingMode:Bi.AllCardsTabbable,postTabbingMode:Ui.AllPostsTabbable},bNe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;n.forceScroll=!1,n.forceScrollAfterReadyToRender=!1,n.onListItemWillUnmount=function(d){if(n.props.componentTree.isFocusOnOrWithin({renderContextType:n.props.componentTree.componentTreeId.renderContextType,componentType:X.Card,id:d})){var c=n.props.componentTree.getComponent(X.CommentsList);c&&c.focus()}},n.onListItemLayout=function(d,c,u){n.setFullPaneListItemHeight(c,u,d.nativeEvent.layout.height)},n.onGhostCommentFocused=function(){n.state.ghostCommentLocation===jl.InList&&setTimeout(function(){return n.scrollManager.scrollToEnd(!1,!0)})},n.updateContentSizeState=function(){var d=n.scrollManager.getContentHeight();d!==void 0&&n.setState({isContentLargerThanList:d>n.scrollManager.getOuterHeight()})},n.getMentionableCommentEditorProps=Qe(function(d,c,u){if(d===_t.Enabled)return{onMentionCreated:n.onMentionCreated,onMentioneesStillInDraftUpdated:n.onMentioneesStillInDraftUpdated,correlationId:n.props.correlationId,suggestionsDetails:u,emailAddressesEnabled:c}}),n.clearStickyScrollStateFromChild=function(){n.scrollManager.clearStickyState(Lo.ReasonUnknown,C.reserveTag(595138528))},n.assertStaleHeightData=Mn(function(){x().assertConditionTag(!1,"commentThreadHeights size: ".concat(n.commentThreadHeights.size,", num threads: ").concat(n.state.allRenderableItemThreads.length),595961856)}),n.getItemLayoutForFlatlist=function(d,c){return n.getItemLayout(d,c,!0)},n.ViewabilityConfig={minimumViewTime:150,viewAreaCoveragePercentThreshold:0,waitForInteraction:!1},n.onSafeAreaInsetsChange=function(d){n.setState({paneContentSafeAreaInsets:d})},n.onFocusedNodeChanged=function(){n.props.componentTree.componentTreeId.renderContextType===A.FullPane&&Q()!=="win32"&&n.scrollManager.clearStickyState(Lo.UserInteraction,C.reserveTag(595138529))},n.onRootViewKeyDown=function(d){Q()==="win32"&&(n.scrollManager.clearStickyState(Lo.UserInteraction,C.reserveTag(595138530)),n.props.selectedComment&&n.isTabIntoCard(d)&&!n.props.componentTree.getComponentById({componentType:Oc(n.props.selectedComment.selectedCardId,n.props.draftState),id:n.props.selectedComment.selectedCardId,renderContextType:n.props.componentTree.componentTreeId.renderContextType})?(n.scrollToCurrentIndex(!1,!1,!1),d.persist(),setTimeout(function(){return n.props.componentTree.onKeyDownTabHandlerHelper(n.getResourceId(),d)},300)):n.props.componentTree.onKeyDownTabHandlerHelper(n.getResourceId(),d))},n.onListViewKeyDown=function(d){Q()==="win32"&&n.commentContentsKeyDownHandler.onKeyDown(d)},n.getRootViewKeyDownEvents=Qe(function(){return pm({useJSTabLoop:!0,handleKeysDuringBubbling:!0})}),n.setViewTreeRoot=function(d){n.props.componentTree.setViewTreeRootHelper(d,n.getResourceId())},n.getContentsPreventDefaultKeyDownBehavior=vn(fm,function(){return[n.commentContentsKeyDownHandler.getKeyDownEvents(),!0]}),n.getThreadIdToListIndexMap=vn(function(d){return new Map(d.map(function(c,u){return[Po(c).commentId,u]}))},function(){return[n.state.allRenderableItemThreads]}),n.onCardLayout=function(d,c){var u=n.getThreadIdToListIndexMap().get(d);if(u===void 0){x().assertConditionTag(!1,"Unexpected threadId",592570563);return}n.setFullPaneListItemHeight(u,d,c.nativeEvent.layout.height)},n.onListFocusStateChange=function(d){n.setState({listFocusState:d})},n.memoGetHeaderButtonStyles=Qe(ume),n.renderWithTheme=function(d,c){if(n.props.initializationStatus!==Wn.Initialized&&n.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&n.props.initializationReason===Ns.NewThread)return ft.createElement(ee,null);var u=[n.renderStyle(Jpe,d)],l=jo(n.props.draftState),p=n.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&!l,g=!p&&n.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&l&&!!Kp.getPaneSingleCreateDraftId(n.props)&&n.props.foldableLayoutState===Ps.DoublePortrait,h=Au()&&n.props.componentTree.componentTreeId.renderContextType===A.FullPane,v=t.shouldShowLoadingUI({length:n.state.allRenderableItemThreads.length,isReadyToRender:n.isReadyToRender(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedComment,listViewWidthForHalfPane:n.state.listViewWidthForHalfPane,initializationStatus:n.props.initializationStatus,createdCommentLie_deprecated:n.props.createdCommentLie});!v&&n.props.dataItems.length===0&&n.notifyRenderedOnce();var y=n.scrollManager.getOuterViewProps(),T=n.memoGetHeaderButtonStyles(!!c),b=ft.createElement(zr,{style:u,onLayout:n.onPaneViewLayout,focusable:!1,nodeId:jn(X.PaneRoot),nativeID:jn(X.PaneRoot),accessibilityLabel:n.props.localizationAPI.getString(31),accessible:!0,ref:n.setViewTreeRoot,preventDefaultKeyDownBehavior:n.getContentsPreventDefaultKeyDownBehavior(),onFocus:n.onFocusedNodeChanged,onKeyDown:n.onRootViewKeyDown,keyDownEvents:n.getRootViewKeyDownEvents()},p&&n.renderNavigationBarForExistingComments(d),g&&n.renderNavigationBarForNewComment(d),n.renderPaneHeader(),ft.createElement(ee,{style:n.renderStyle(T,d)},h&&n.renderNewCommentButton(d,n.isNewCommentButtonDisabled()),c?ft.createElement(ft.Fragment,null,ft.createElement(NB,{itemCount:n.props.filterItemCount}),ft.createElement(FB,m({},n.getContentFilterProps()))):void 0),ft.createElement(Pfe,{shouldRenderView:Q()!=="win32",onLayout:y.onLayout,style:vr,onSafeAreaInsetsChange:n.onSafeAreaInsetsChange},ft.createElement(pge,{preventDefaultKeyDownBehavior:void 0},v?ft.createElement(ee,{style:nme},ft.createElement(Wp,{delay:Hd},ft.createElement(Yp.Spinner,{size:"large"}))):[ft.createElement(zr,{key:"list",onFocusStateChange:n.onListFocusStateChange,accessible:!0,accessibilityLabel:n.props.localizationAPI.getString(32),focusable:!0,onKeyDown:n.onListViewKeyDown,style:[vr,n.renderStyle(dme,d),n.state.listFocusState===ce.FocusOn&&n.renderStyle(cme,d)],nodeId:jn(X.CommentsList),accessibilityRole:i_("tree",void 0),preventDefaultKeyDownBehavior:n.getContentsPreventDefaultKeyDownBehavior()},ft.createElement(od.FlatList,m({onLayout:Q()==="win32"?y.onLayout:void 0},n.getListProps(d)))),n.shouldShowGhostComment()&&n.state.ghostCommentLocation===jl.BelowList&&n.renderGhostCardOverlay(d)]))),I=b;return fe()&&(I=ft.createElement(Bfe,{expandedComments:n.props.expandedComments},b)),I},n.keyboardDidHide=n.keyboardDidHide.bind(n),n.keyboardDidShow=n.keyboardDidShow.bind(n),n.onUserScrollEnd=n.onUserScrollEnd.bind(n),n.onNextThread=n.onNextThread.bind(n),n.onPaneViewLayout=n.onPaneViewLayout.bind(n),n.onPreviousThread=n.onPreviousThread.bind(n),n.renderListItem=n.renderListItem.bind(n),n.invokeModalDialog=n.invokeModalDialog.bind(n),n.handleScrollToCommand=n.handleScrollToCommand.bind(n),n.onSafeAreaInsetsChange=n.onSafeAreaInsetsChange.bind(n),n.onScrollManagerChange=n.onScrollManagerChange.bind(n),n.getItemLayoutForScrollManager=n.getItemLayoutForScrollManager.bind(n);var o=n.getInitialState(r);n.commentThreadHeights=new Map;var a={listViewWidthForHalfPane:0,currThreadIndex:iB(n.props.selectedComment,o.allRenderableItemThreads),ghostCommentLocation:jl.InList,maxDraftHeight:n.calculateMaxDraftHeight(0),displayLossyWarningAsOverlay:!1,availableScreenHeight:Mp.get("window").height,paneContentSafeAreaInsets:{top:0,right:0,bottom:0,left:0},commentThreadHeightSums:n.getRenderableItemThreadHeightSums(r,o.allRenderableItemThreads),isContentLargerThanList:!1,listFocusState:ce.Unfocused};return n.state=m(m({},o),a),n.scrollListener={invokeScrollToCommand:n.handleScrollToCommand,clearStickyScrollState:n.clearStickyScrollStateFromChild},n.scrollManager=new Cge(n.getItemLayoutForScrollManager,n.props.componentTree.componentTreeId.renderContextType===A.HalfPane,n.props.telemetryVisitor),n.scrollManager.registerChangeListener(n.onScrollManagerChange),n.scrollManager.registerUserScrollEndListener(n.onUserScrollEnd),n}return t.prototype.UNSAFE_componentWillMount=function(){this.keyboardDidHideListener=od.Keyboard.addListener("keyboardDidHide",this.keyboardDidHide),this.keyboardDidShowListener=od.Keyboard.addListener("keyboardDidShow",this.keyboardDidShow)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.keyboardDidHideListener&&this.keyboardDidHideListener.remove(),this.keyboardDidHideListener=void 0,this.keyboardDidShowListener&&this.keyboardDidShowListener.remove(),this.keyboardDidShowListener=void 0},t.prototype.UNSAFE_componentWillReceiveProps=function(r){var n,o=this.getUpdatedItemThreads(r),a=this.state.displayLossyWarningAsOverlay;if((this.props.dataItems!==r.dataItems||this.props.selectedComment!==r.selectedComment)&&r.selectedComment){var d=((n=this.props.selectedComment)===null||n===void 0?void 0:n.selectionDetails.lowFidelityWarningType)!==r.selectedComment.selectionDetails.lowFidelityWarningType;if(r.componentTree.componentTreeId.renderContextType===A.FullPane&&d&&_s(r.selectedComment)){var c=this.commentThreadHeights.get(r.selectedComment.selectedCardId);a=!!c&&c>=vNe}}if(this.props.lastContextChangeIncrement!==r.lastContextChangeIncrement&&this.commentThreadHeights.clear(),this.props.componentTree.componentTreeId.renderContextType===A.HalfPane){var u=this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset());this.forceScroll=u===-1||u===this.state.allRenderableItemThreads.length}this.setState({allRenderableItemThreads:o,currThreadIndex:iB(r.selectedComment,o),displayLossyWarningAsOverlay:a,commentThreadHeightSums:this.getRenderableItemThreadHeightSums(r,o)})},t.prototype.getRenderableItemThreadHeightSums=function(r,n){var o=this,a;return r.componentTree.componentTreeId.renderContextType===A.FullPane&&(!this.state||!Fpe(n,this.state.allRenderableItemThreads)||this.props.componentTree.componentTreeId.renderContextType===A.HalfPane)?new UB(n.map(function(d,c){return o.getFullPaneListItemHeight(n[c],r,!1)})):((a=this.state)===null||a===void 0?void 0:a.commentThreadHeightSums)||new UB([])},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.selectedComment&&(this.forceScrollAfterReadyToRender=!0)},t.prototype.componentDidUpdate=function(r,n){var o,a=!Kp.getPaneSingleCreateDraftId(r)&&!!Kp.getPaneSingleCreateDraftId(this.props),d=JA(this.props),c=d!==JA(r),u=c&&d,l=r.componentTree.componentTreeId.renderContextType!==A.HalfPane&&this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,p=CB(r.selectedComment,r.draftState,r.cardViewStates,r.componentTree.componentTreeId.renderContextType),g=CB(this.props.selectedComment,this.props.draftState,this.props.cardViewStates,this.props.componentTree.componentTreeId.renderContextType),h=fr(r.draftState),v=fr(this.props.draftState),y=p!==g;this.scrollManager.setIsHorizontal(vd()?this.props.componentTree.componentTreeId.renderContextType===A.HalfPane:r.componentTree.componentTreeId.renderContextType===A.HalfPane);var T=!!(!((o=Ye(this.props.draftState))===null||o===void 0)&&o.isInCurrentContext),b=T&&y7(r.draftState,this.props.draftState),I=GI(r.draftState,this.props.draftState);if(r.lastContextChangeIncrement!==this.props.lastContextChangeIncrement&&(this.forceScrollAfterReadyToRender=T),this.isReadyToRender()&&(this.props.componentTree.componentTreeId.renderContextType===A.HalfPane||a||u||y||b||I||this.forceScroll||this.forceScrollAfterReadyToRender)){var E=!this.state.allRenderableItemThreads.length,P=r.dataItems!==this.props.dataItems,_=v!==h,D=this.state.listViewWidthForHalfPane!==n.listViewWidthForHalfPane;if((y||c)&&this.scrollManager.clearStickyState(Lo.UserInteraction,C.reserveTag(595138527)),E)this.scrollToEmptyView();else if((P||y||_||l||D||c||b||I||this.forceScroll||this.forceScrollAfterReadyToRender)&&(g||c)){var M=r.componentTree.componentTreeId.renderContextType===A.HalfPane,H=this.isSelectedCardPinned(r),U=this.state.currThreadIndex!==void 0&&Math.abs(this.state.currThreadIndex-this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset()))<=1,F=y&&M&&!P&&!_&&!l&&!D&&!H&&!!p&&U||c&&!a,z=!u&&!M&&(!vd()||!l),Y=!!(a||u||v||y||b||this.forceScroll||this.forceScrollAfterReadyToRender)||this.props.componentTree.componentTreeId.renderContextType===A.HalfPane;this.scrollToCurrentIndex(F,Y,z)}this.forceScrollAfterReadyToRender=!1}this.forceScroll=!1,l&&!g&&this.props.dataItems.length&&this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(590206685),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:Po(this.props.dataItems).commentId,selectType:Ae.ExpandCard,source:le.SharedComments},!1).catch(me(C.reserveTag(590104653))),r.initializationStatus!==Wn.Initialized&&this.props.initializationStatus===Wn.Initialized&&Q()!=="win32"&&this.props.focusManager.focusCommentPaneCommand(this.props.componentTree),e.prototype.componentDidUpdate.call(this,r,n)},t.prototype.onContextChanged=function(){this.props.initializationStatus===Wn.NotInitialized&&this.props.initializeView(this.props.componentTree.componentTreeId.renderContextType)},t.prototype.getCreateCommentInitialHeight=function(){return GH},t.prototype.getKeyboardingOptions=function(){return Q()==="win32"?xNe:TNe},t.prototype.renderStyle=function(r,n){return Je(r,n,this.props.componentTree.componentTreeId.renderContextType)},t.prototype.calculateMaxDraftHeight=function(r){var n=Mp.get("window"),o=n.width,a=n.height,d=o>a,c;return d?c=hNe:xl()===$t.LargeDisplay?c=CNe:c=yNe,(a-r)*c},t.prototype.keyboardDidShow=function(r){this.setState({maxDraftHeight:this.calculateMaxDraftHeight(r.endCoordinates.height),availableScreenHeight:Mp.get("window").height-r.endCoordinates.height})},t.prototype.keyboardDidHide=function(r){this.setState({maxDraftHeight:this.calculateMaxDraftHeight(0),availableScreenHeight:Mp.get("window").height})},t.prototype.renderListItem=function(r){var n=Po(r.item);if(this.props.modelCapabilities.virtualized){var o=[n.commentId];this.onRequestLoadThreads(o)}var a=r.item,d=r.index,c=n.commentId,u=this.renderCommentThread(d,a);return ft.createElement(mme,m({},pme(this.props.selectedComment,a,this.state.displayLossyWarningAsOverlay,this.props.localizationAPI,{onConfirm:this.onLowFidelityWarningConfirm,onCancel:this.onLowFidelityWarningCancel},{halfPaneWidth:this.state.listViewWidthForHalfPane,index:d,renderContextType:this.props.componentTree.componentTreeId.renderContextType,threadId:c,onWillUnmount:this.onListItemWillUnmount,onLayout:this.onListItemLayout,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()})),u)},t.prototype.getListHeaderMode=function(){return!this.isSelectedCardPinned()&&this.shouldShowHalfPaneContextChangePlaceholder()?pu.HalfPaneContextChangePlaceholder:pu.None},t.prototype.renderListHeader=function(r){switch(this.getListHeaderMode()){case pu.HalfPaneContextChangePlaceholder:return ft.createElement(ee,{style:[this.renderStyle(EB,r),{width:this.state.listViewWidthForHalfPane}]});case pu.None:return}},t.prototype.getListFooterMode=function(){return this.isSelectedCardPinned()?Ji.None:this.shouldShowHalfPaneContextChangePlaceholder()?Ji.HalfPaneContextChangePlaceholder:this.shouldShowGhostComment()?this.state.ghostCommentLocation===jl.InList?Ji.FullPaneGhostCard:Ji.FullPaneGhostCardPlaceholder:Ji.None},t.prototype.shouldShowHalfPaneContextChangePlaceholder=function(){return this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&!(this.props.nextPopulatedContextDetails===Ut.OnlyCommentsInCurrent&&this.state.allRenderableItemThreads.length===1)&&this.props.nextPopulatedContextDetails!==Ut.NoComments},t.prototype.renderListFooter=function(r){var n=this.getListFooterMode();switch(n){case Ji.HalfPaneContextChangePlaceholder:return ft.createElement(ee,{style:[this.renderStyle(EB,r),{width:this.state.listViewWidthForHalfPane}]});case Ji.FullPaneGhostCard:return ft.createElement(bl.Provider,{value:this.state.allRenderableItemThreads.length},this.renderGhostCard());case Ji.FullPaneGhostCardPlaceholder:return this.renderGhostPlaceholder(r);case Ji.None:return;default:Me(n)}},t.prototype.renderGhostCardOverlay=function(r){return ft.createElement(ee,{style:this.renderStyle(Zpe,r),key:"ghostOverlay"},this.renderGhostCard())},t.prototype.renderGhostPlaceholder=function(r){return ft.createElement(ee,{style:this.renderStyle(sk,r),key:"ghostPlaceholder"})},t.prototype.renderGhostCard=function(){var r=j8(this.props.localizationAPI,this.props.nextPopulatedContextDetails);return ft.createElement(HB,{onClick:this.onGhostCommentClicked,onFocus:this.onGhostCommentFocused,ghostCommentString:r,accessibilityLabel:r,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),key:"ghost"})},t.prototype.onScrollManagerChange=function(r){this.props.componentTree.componentTreeId.renderContextType!==A.HalfPane&&r&(wn.ContentHeight|wn.OuterHeight)&&(this.updateGhostCommentLocation(),setTimeout(this.updateContentSizeState));var n=this.scrollManager.getScrollOffset();vd()&&this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&r&wn.ContentWidth&&this.getThreadIndexFromScrollPosition(n)!==this.state.currThreadIndex&&this.scrollToCurrentIndex(!1,!1,!1),r&wn.ScrollOffset&&((!vd()||r&wn.ProgrammaticScrollEnd)&&this.clearReadOnlyEditorFocusOnScroll_android(),this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&r&wn.ProgrammaticScrollEnd&&(!vd()||n>0)&&this.updateCurrentThreadIndex(this.getThreadIndexFromScrollPosition(n)))},t.prototype.clearReadOnlyEditorFocusOnScroll_android=function(){if(Q()==="android"){var r=this.props.componentTree.getCurrentlyFocused();r.forEach(function(n){Lp(n)&&n.getDisplayMode()!==mn.Editing&&n.blur()})}},t.prototype.updateGhostCommentLocation=function(){var r=this.scrollManager.getContentHeight();if(r!==void 0){var n=r<this.scrollManager.getOuterHeight()?jl.BelowList:jl.InList;n!==this.state.ghostCommentLocation&&this.setState({ghostCommentLocation:n})}},t.prototype.renderEmptyListContent=function(){if(!this.state.allRenderableItemThreads.length&&!(!sr()&&this.props.createdCommentLie)){var r=W8(this.props.localizationAPI,this.props.nextPopulatedContextDetails,this.props.componentTree.componentTreeId.renderContextType);if(r)return ft.createElement(lge,{message:r,renderContextType:this.props.componentTree.componentTreeId.renderContextType,containerWidth:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane?this.state.listViewWidthForHalfPane:void 0})}},t.prototype.onPaneViewLayout=function(r){this.setState({listViewWidthForHalfPane:r.nativeEvent.layout.width})},t.prototype.getThreadPositionText=function(){var r,n;if(this.props.commentThreadCountsContextDetails){var o=void 0,a=void 0,d=(r=this.state.currThreadIndex)!==null&&r!==void 0?r:0;if(this.props.pendingCommentLoad)o=this.isReadyToRender()?d:(n=this.props.pendingCommentLoad.selectedThreadIndex)!==null&&n!==void 0?n:0,a=this.props.pendingCommentLoad.numberOfTotalThreads;else if(this.state.allRenderableItemThreads.length)o=d,a=this.state.allRenderableItemThreads.length;else return;var c=this.props.commentThreadCountsContextDetails.numInPrevious+o+1,u=this.props.commentThreadCountsContextDetails.numInPrevious+a+this.props.commentThreadCountsContextDetails.numInNext;return this.props.localizationAPI.formatString(53,c.toString(),u.toString())}},t.prototype.getOuterSpacingForNavigationBar=function(){return xl()===$t.LargeDisplay?Bd:Rr},t.prototype.renderNavigationBarTextWrapper=function(r,n){return r?ft.createElement(qe,{style:this.renderStyle(Xpe,n),textStylePolyester:"MediumStandard",variantFluent:"secondaryStandard"},r):ft.createElement(ee,{style:this.renderStyle(Qpe,n)})},t.prototype.renderNavigationBarForExistingComments=function(r){var n=this.getOuterSpacingForNavigationBar();return ft.createElement(ry,{leftChild:void 0,centerChild:ft.createElement(ee,{style:PB},ft.createElement(hn,{onClick:this.onPreviousThread,text:"",accessibilityLabel:this.props.localizationAPI.getString(52),isTabbable:!0,icon:10,style:ny,tooltipText:this.props.localizationAPI.getString(52),testID:jn(X.PreviousCommentButton),nodeId:jn(X.PreviousCommentButton),preventDefaultKeyDownBehavior:void 0}),this.renderNavigationBarTextWrapper(this.getThreadPositionText(),r),ft.createElement(hn,{onClick:this.onNextThread,accessibilityLabel:this.props.localizationAPI.getString(51),isTabbable:!0,icon:11,style:ny,tooltipText:this.props.localizationAPI.getString(51),testID:jn(X.NextCommentButton),nodeId:jn(X.NextCommentButton),text:"",preventDefaultKeyDownBehavior:void 0})),rightChild:ft.createElement(hn,{text:"",tooltipText:this.props.localizationAPI.getString(20),onClick:this.closePane,accessibilityLabel:this.props.localizationAPI.getString(20),isTabbable:!0,icon:9,style:[ny],nodeId:jn(X.ClosePaneButton),preventDefaultKeyDownBehavior:void 0}),showShadow:!1,outerSpacing:n})},t.prototype.renderNavigationBarForNewComment=function(r){var n=this.props.localizationAPI.getString(205),o=this.getOuterSpacingForNavigationBar();return ft.createElement(ry,{leftChild:void 0,centerChild:ft.createElement(ee,{style:PB},this.renderNavigationBarTextWrapper(n,r)),rightChild:void 0,showShadow:!1,outerSpacing:o})},t.prototype.getThreadIndexFromScrollPosition=function(r){var n=this.state.allRenderableItemThreads.length;return od.I18nManager.isRTL&&Q()==="android"?n-1-(Math.round(r/this.state.listViewWidthForHalfPane)-(this.getListFooterMode()===Ji.HalfPaneContextChangePlaceholder?1:0)):Math.round(r/this.state.listViewWidthForHalfPane)-(this.getListHeaderMode()===pu.HalfPaneContextChangePlaceholder?1:0)},t.prototype.onUserScrollEnd=function(){this.props.componentTree.componentTreeId.renderContextType===A.HalfPane&&this.updateCurrentThreadIndex(this.getThreadIndexFromScrollPosition(this.scrollManager.getScrollOffset()))},t.prototype.updateCurrentThreadIndex=function(r){var n=this.state.allRenderableItemThreads.length,o=n===0?1:n,a=-1,d=x().createActivityObject("CommentSwipe",this.props.telemetryVisitor,Ee());if(r===a)return d.addDataField("SwipeDirection",Yt.Previous,N.SystemMetadata),d.addDataField("SwipeAcrossContext",!0,N.SystemMetadata),this.props.selectionManager.selectAcrossContexts(Yt.Previous,this.props.componentTree.componentTreeId.renderContextType);if(r===o)return d.addDataField("SwipeDirection",Yt.Next,N.SystemMetadata),d.addDataField("SwipeAcrossContext",!0,N.SystemMetadata),this.props.selectionManager.selectAcrossContexts(Yt.Next,this.props.componentTree.componentTreeId.renderContextType);r!==this.state.currThreadIndex&&r<n&&(this.state.currThreadIndex!==void 0&&(r<this.state.currThreadIndex?d.addDataField("SwipeDirection",Yt.Previous,N.SystemMetadata):d.addDataField("SwipeDirection",Yt.Next,N.SystemMetadata),d.addDataField("SwipeAcrossContext",!1,N.SystemMetadata)),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:C.reserveTag(590206686),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:Po(this.state.allRenderableItemThreads[r]).commentId,selectType:Ae.ExpandCard,source:le.SharedComments},!1).catch(me(C.reserveTag(590104654)))),d.successTag(595944269)},t.prototype.onNextThread=function(){var r=x().createActivityObject("NextButtonPressed",this.props.telemetryVisitor,{aggregationMode:eo.OnSuccess});r.successTag(595944270),this.props.selectionManager.selectNextOrPreviousThread({direction:Yt.Next,source:le.SharedComments,expandCard:!0,iterableContentTypes:void 0},void 0,this.props.componentTree.componentTreeId.renderContextType)},t.prototype.onPreviousThread=function(){var r=x().createActivityObject("PreviousButtonPressed",this.props.telemetryVisitor,{aggregationMode:eo.OnSuccess});r.successTag(595944271),this.props.selectionManager.selectNextOrPreviousThread({direction:Yt.Previous,source:le.SharedComments,expandCard:!0,iterableContentTypes:void 0},void 0,this.props.componentTree.componentTreeId.renderContextType)},t.prototype.scrollToCurrentIndex=function(r,n,o){var a;if(!vd()&&this.isSelectedCardPinned())a=0;else if(this.state.currThreadIndex!==void 0)a=this.state.currThreadIndex;else if(this.props.topVisibleThread)a=this.props.topVisibleThread.index;else return;if(a>=this.state.allRenderableItemThreads.length){x().assertConditionTag(!1,"Current index out of bounds",595961817);return}this.scrollManager.scrollToIndex(a,r,n,o)},t.prototype.scrollToEmptyView=function(){this.scrollManager.scrollToIndex(0,!1,!0,!1)},t.prototype.handleScrollToCommand=function(r){var n=this,o=this.scrollManager.getListRef();if(!(!o||this.props.componentTree.componentTreeId.renderContextType===A.HalfPane)){var a=(0,od.findNodeHandle)(o);typeof a=="number"&&r.target.measureLayout(a,function(d,c,u,l){n.scrollManager.scrollToOffsets(!1,!0,c+r.offsetY,c+r.offsetY+r.height)},function(){})}},t.prototype.getFullPaneListItemOffset=function(r){this.commentThreadHeights.size>=this.state.allRenderableItemThreads.length+100&&this.assertStaleHeightData();var n=PT;return r<=0?0:this.state.commentThreadHeightSums.getSum(r-1)+r*n},t.prototype.getFullPaneListItemHeight=function(r,n,o){var a=o?PT:0,d=Po(r).commentId,c=this.commentThreadHeights.get(d);if(c!==void 0)return c+a;var u=n.cardViewStates[d],l=u&&Ku(u.loadState)?u.loadState.initialItemCount:r.length;return c=Vl({itemCount:l,readOnly:n.readOnly,isTask:!!this.props.tasks[d]}),c+a},t.prototype.setFullPaneListItemHeight=function(r,n,o){this.commentThreadHeights.set(n,o),this.props.componentTree.componentTreeId.renderContextType!==A.HalfPane&&(this.state.commentThreadHeightSums.set(o,r),this.scrollManager.onItemLayoutChange())},t.prototype.getItemLayout=function(r,n,o){if(!r)return x().assertConditionTag(!1,"Trying to get layout of non-existent element.",577066526),{index:n,length:0,offset:this.getFullPaneListItemOffset(n)};if(this.props.componentTree.componentTreeId.renderContextType===A.HalfPane){var a=void 0;if(od.I18nManager.isRTL&&Q()==="android"){var d=this.getListFooterMode()===Ji.HalfPaneContextChangePlaceholder;a=(this.state.allRenderableItemThreads.length-1-n+(d?1:0))*this.state.listViewWidthForHalfPane}else{var c=this.getListHeaderMode()===pu.HalfPaneContextChangePlaceholder;a=(n+(c?1:0))*this.state.listViewWidthForHalfPane}return{length:this.state.listViewWidthForHalfPane,offset:a,index:n}}return{length:this.getFullPaneListItemHeight(r[n],this.props,o),offset:this.getFullPaneListItemOffset(n),index:n}},t.prototype.getItemLayoutForScrollManager=function(r){if(r===this.state.allRenderableItemThreads.length&&this.state.allRenderableItemThreads.length===0&&this.props.componentTree.componentTreeId.renderContextType===A.HalfPane){var n=0,o=od.I18nManager.isRTL&&Q()==="android";return(o&&this.getListFooterMode()===Ji.HalfPaneContextChangePlaceholder||!o&&this.getListHeaderMode()===pu.HalfPaneContextChangePlaceholder)&&(n=this.state.listViewWidthForHalfPane),{length:this.state.listViewWidthForHalfPane,offset:n,index:r}}if(!(r>=this.state.allRenderableItemThreads.length))return this.getItemLayout(this.state.allRenderableItemThreads,r,!1)},t.prototype.isSelectedCardPinned=function(r){return r===void 0&&(r=this.props),r.componentTree.componentTreeId.renderContextType===A.HalfPane&&r.selectedComment&&Rs(r.draftState)},t.prototype.renderPaneHeader=function(){return ft.createElement(BB,{closeLabel:this.props.localizationAPI.getString(20),onClose:this.closePane,paneTitle:this.props.localizationAPI.getString(18)})},t.prototype.isNewCommentButtonDisabled=function(){return!this.props.modelCapabilities.newThread},t.prototype.renderNewCommentButton=function(r,n){var o=[this.renderStyle(ome,r)];return this.state.isContentLargerThanList&&o.push(this.renderStyle(ime,r)),ft.createElement(hn,{onClick:this.startNewCommentSession,accessibilityLabel:this.props.localizationAPI.getString(92),tooltipText:this.props.localizationAPI.getString(92),disabled:n,isTabbable:!0,icon:12,text:this.props.localizationAPI.getString(91),style:o,testID:jn(X.NewCommentButton),nodeId:jn(X.NewCommentButton),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior()})},t.prototype.getVirtualizationParameters=function(){var r=4,n=Vl({itemCount:1,readOnly:this.props.readOnly,isTask:!1}),o=this.scrollManager.getOuterHeight(),a=o&&Math.ceil(o/n)||r,d=Q()==="android"?a*2+1:3,c=Q()==="android"?a+1:void 0;return{maxToRenderPerBatch:a,windowSize:d,updateCellsBatchingPeriod:150,viewabilityConfig:this.ViewabilityConfig,initialNumToRender:c}},t.prototype.getPinnedCardIndex_deprecated=function(){return this.isSelectedCardPinned()?this.state.currThreadIndex:void 0},t.prototype.getListProps=function(r){var n=this.getPinnedCardIndex_deprecated(),o=n!==void 0&&!vd()?[this.state.allRenderableItemThreads[n]]:this.state.allRenderableItemThreads,a=fe()?{CellRendererComponent:Ufe}:{};return m(m(m({data:o,directionalLockEnabled:!0,extraData:[this.props.cardViewStates,this.props.postViewStates,this.props.selectedComment],getItemLayout:this.getItemLayoutForFlatlist,horizontal:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,keyboardShouldPersistTaps:"always",keyExtractor:this.getListItemKey,ListEmptyComponent:this.renderEmptyListContent(),ListFooterComponent:this.renderListFooter(r),ListHeaderComponent:this.renderListHeader(r),pagingEnabled:this.props.componentTree.componentTreeId.renderContextType===A.HalfPane,renderItem:this.renderListItem,removeClippedSubviews:this.shouldRemoveClippedSubviews(),contentContainerStyle:this.state.isContentLargerThanList?this.renderStyle(ame,r):void 0,scrollEnabled:!this.isSelectedCardPinned()&&(this.props.componentTree.componentTreeId.renderContextType===A.HalfPane||this.state.allRenderableItemThreads.length>0),showsHorizontalScrollIndicator:!1,testID:kC(),accessible:!1,style:sme},this.scrollManager.getScrollProps()),this.getVirtualizationParameters()),a)},t.prototype.scrollToThreadById=function(r){var n=this.state.allRenderableItemThreads.findIndex(function(o){return Po(o).commentId===r});return n<0?(x().assertConditionTag(!1,"Thread not found",589054428),!1):(this.scrollManager.scrollToIndex(n,!1,!0,!0),!0)},t.prototype.canCardDelete=function(r){var n=Ya(this.props.dataItems,r);return n?!0:(x().assertConditionTag(!1,"Comment not found",595961857),!1)},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!0},t.prototype.shouldRemoveClippedSubviews=function(){if(Q()==="android"&&fr(this.props.draftState))return!1},t.prototype.invokeModalDialog=function(r,n,o){var a=this,d=new Promise(function(c){var u=Y8(a.props.localizationAPI,r),l={title:u.confirmButton,style:Yp.AlertButtonStyle.destructive,onClick:function(){return c(n())}},p={title:u.cancelButton,style:Yp.AlertButtonStyle.cancel,onClick:function(){return c(o())}};Yp.Alert.alert(u.title,u.body,l,p)});return d},t.prototype.isTabIntoCard=function(r){return r.nativeEvent.key!==J.Tab||this.props.dataItems.length===0?!1:this.props.componentTree.isFocusOn({componentType:X.NewCommentButton})?!r.nativeEvent.shiftKey||!this.shouldShowGhostComment():r.nativeEvent.shiftKey&&this.props.componentTree.isFocusOn({componentType:X.GhostCard})},t.shouldShowLoadingUI=function(r){var n=!r.length;return!r.isReadyToRender||r.renderContextType===A.HalfPane&&(!r.selectedComment&&!n||!r.listViewWidthForHalfPane)||r.initializationStatus!==Wn.Initialized||!sr()&&!!r.createdCommentLie_deprecated&&n},t.prototype.getResourceId=function(){var r,n;return(n=(r=this.props.resource)===null||r===void 0?void 0:r.id)!==null&&n!==void 0?n:wW()},t.prototype.getContentExtraPaddingLeft=function(){return this.state.paneContentSafeAreaInsets.left},t.prototype.getContentExtraPaddingRight=function(){return this.state.paneContentSafeAreaInsets.right},t.prototype.getAvailableScreenHeight=function(){return this.state.availableScreenHeight},t.prototype.getMaxDraftHeight=function(){return this.props.componentTree.componentTreeId.renderContextType===A.HalfPane?this.state.maxDraftHeight:void 0},t.prototype.getCommentCardStyle=function(){return Q()==="win32"?eme:void 0},t.prototype.getContentBackgroundColor=function(r,n){return fe()?void 0:r&&!n?"CardReplyBackground":"CardBackground"},t.prototype.renderInner=function(){return ft.createElement(bA.Provider,{value:this.scrollListener},ft.createElement(hx.Provider,{value:this.props.commentAPI},We(this.renderWithTheme,Ge,_T)))},t}(Kp),xge=bNe});function jB(){var e=eE(),t=nE(),r=oE(t);return function(n){var o=Rd(n),a=ws(n),d={cardViewStates:Mi(n),dataItems:e(n),tasks:Go(n),personaIconPropertiesMap:Jm(n),createdCommentLie:uo(n,!0,a.componentTreeId.renderContextType),nextPopulatedContextDetails:o.nextPopulatedContextDetails,pendingCommentLoad:Li(n),postViewStates:ZI(n),historyRecordViewStates:QI(n),componentTree:a,commentThreadCountsContextDetails:o.commentThreadCounts,selectedThreadIdBeforeCommentSession:tl(n),readOnly:XI(n),highlightedCommentId:JI(n),lastContextChangeIncrement:o.lastContextChangeIncrement,initializationStatus:n.paneState.initializationStatus,draftState:pe(n),modelCapabilities:Lr(n),selectedComment:Ie(n),expandedComments:ia(n),suggestionsDetails:tE(n),foldableLayoutState:Vn(n).foldableLayoutState,displayConfigurationState:n.paneState.viewContainerDisplayConfiguration,currentFilter:E7(n),filterItemCount:P7(n),collaborators:_7(n),DoNotUse_isFilteringEnabled:!!tr(n),renderableSelectedComment:r(n)},c=R7(n);if(c){var u=pi(n),l=er(u)?u.findIndex(function(p){return p===c}):u.filter(yr).findIndex(function(p){return p.commentId===c});l>-1&&(d.topVisibleThread={cardId:c,index:l})}return d}}var SNe,WB,bge,dk=f(()=>{"use strict";s();Ts();ii();St();Ni();lo();el();io();ZC();Tge();SNe=ea(jB,ol,void 0,{forwardRef:!0}),WB=SNe(xge),bge=WB});var ck,Sge=f(()=>{"use strict";s();Ts();ck=lw});var $p,Ige,Ege,hy,Qp=f(()=>{"use strict";s();ne();Eo();$p=function(t){return t.contentExtensions.extensions},Ige=function(t,r){var n=$p(t)[r];return n!==void 0&&n.priority!==Nt.Disabled},Ege=function(t,r){if(!r)return!1;switch(r.renderMode){case de.Integrated:case de.TaskPaneItem:{var n=$p(t)[r.renderMode];return n!==void 0&&n.priority!==Nt.Disabled}case de.Isolated:{var n=$p(t)[r.renderMode];return n!==void 0&&n.controller.provider.getExtension(r.threadId).priority!==Nt.Disabled}default:Me(r)}},hy=function(t){return t.contentExtensions.contentNavigationSupported}});function Pge(e,t){return t?{}:{neutralForeground1:e.Text,neutralForeground1Hover:e.TextHover,neutralForeground1Pressed:e.TextPressed,neutralForeground1Selected:e.TextSelected,neutralForeground2:e.TextSecondary,neutralForeground2Hover:e.TextSecondaryHover,neutralForeground2Pressed:e.TextSecondaryPressed,neutralForeground2Selected:e.TextSecondarySelected,neutralForeground4:e.TextCtlSubtlePlaceholder,neutralForegroundDisabled:e.TextDisabled,compoundBrandForeground1:e.TextEmphasis,compoundBrandForeground1Hover:e.TextEmphasisHover,compoundBrandForeground1Pressed:e.TextEmphasisPressed,neutralForegroundInverted:e.TextCtlSubtleSelectionHighlight,neutralForegroundOnBrand:e.TextCtlEmphasis,neutralForegroundOnBrandHover:e.TextCtlEmphasisHover,neutralForegroundOnBrandPressed:e.TextCtlEmphasisPressed,neutralForegroundInvertedLink:e.BkgToggleSwitchOff,neutralForegroundInvertedLinkHover:e.BkgToggleSwitchOffHover,neutralForegroundInvertedLinkPressed:e.BkgToggleSwitchOffPressed,neutralBackground1:e.Bkg,neutralBackground1Hover:e.BkgHover,neutralBackground1Pressed:e.BkgPressed,neutralBackground1Selected:e.BkgSelected,neutralBackground2:e.BkgHeader,neutralBackground2Hover:e.BkgSubtle,neutralBackground3:e.BkgSubtle,neutralBackgroundInverted:e.BkgSelectionHighlight,neutralBackgroundDisabled:e.BkgCtlDisabled,neutralStencil1:e.SliderBuffer,brandBackground:e.BkgCtlEmphasis,brandBackgroundHover:e.BkgCtlEmphasisHover,brandBackgroundPressed:e.BkgCtlEmphasisPressed,compoundBrandBackground1:e.BkgToggleSwitchOn,compoundBrandBackground1Hover:e.BkgToggleSwitchOnHover,compoundBrandBackground1Pressed:e.BkgToggleSwitchOnPressed,neutralStrokeAccessible:e.StrokeOnlySelected,neutralStrokeAccessibleHover:e.StrokeOnlyHover,neutralStrokeAccessiblePressed:e.StrokeOnlyPressed,neutralStroke1:e.StrokeCtl,neutralStroke1Hover:e.StrokeSelectedHover,neutralStroke1Pressed:e.StrokeOverPressed,neutralStroke2:e.SliderBuffer,brandStroke1:e.AccentEmphasis,compoundBrandStroke1:e.StrokeToggleSwitchOn,compoundBrandStroke1Hover:e.StrokeToggleSwitchOnHover,compoundBrandStroke1Pressed:e.StrokeToggleSwitchOnPressed,neutralStrokeDisabled:e.StrokeCtlDisabled,strokeFocus2:e.StrokeKeyboard}}var _ge=f(()=>{"use strict";s()});function zB(e,t){return e==="HighContrast"||!t.host.colors?{}:{colors:Rge(e,t.host.colors.AppPrimary)}}function Rge(e,t){var r=INe(t),n=e==="White"||e==="Colorful";return{neutralForeground2BrandHover:n?r.shade10:r.tint40,neutralForeground2BrandPressed:n?r.shade30:r.tint10,neutralForeground2BrandSelected:n?r.shade20:r.tint40,neutralForeground3BrandHover:n?r.shade10:r.tint40,neutralForeground3BrandPressed:n?r.shade30:r.tint10,neutralForeground3BrandSelected:n?r.shade20:r.tint40,brandForegroundLink:n?r.primary:r.tint30,brandForegroundLinkHover:n?r.shade10:r.tint40,brandForegroundLinkPressed:n?r.shade30:r.tint10,brandForegroundLinkSelected:n?r.shade20:r.tint40,compoundBrandForeground1:n?r.primary:r.tint30,compoundBrandForeground1Hover:n?r.shade10:r.tint40,compoundBrandForeground1Pressed:n?r.shade30:r.tint10,brandForeground1:n?r.primary:r.tint30,brandForeground2:n?r.shade10:r.tint40,brandBackground:r.primary,brandBackgroundHover:r.shade10,brandBackgroundPressed:r.shade30,brandBackgroundSelected:r.shade20,compoundBrandBackground1:r.primary,compoundBrandBackground1Hover:r.shade10,compoundBrandBackground1Pressed:r.shade20,brandBackgroundStatic:r.primary,brandBackground2:r.tint40,neutralStrokeAccessibleSelected:r.primary,brandStroke1:r.primary,brandStroke2:r.tint40,compoundBrandStroke1:r.primary,compoundBrandStroke1Hover:r.shade10,compoundBrandStroke1Pressed:r.shade20}}function INe(e){if(typeof e=="string"){if(e.toLowerCase()==="#185abd")return O.color.word;if(e.toLowerCase()==="#107c41")return O.color.excel;if(e.toLowerCase()==="#d83b01")return O.color.office;if(e.toLowerCase()==="#80397b"||e.toLowerCase()==="#7719aa")return O.color.oneNote;if(e.toLowerCase()==="#0078d4")return O.color.outlook;if(e.toLowerCase()==="#c43e1c")return O.color.powerPoint}return O.color.brand}var GB=f(()=>{"use strict";s();xi()});var kge=be((LSr,Age)=>{s();Age.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandBackground2:{rest:"#d2e0f4"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#aec6eb"},brandForeground2:{rest:"#d2e0f4"},brandForegroundLink:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5",selected:"#d2e0f4"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#6794d7"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandForeground1:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},dangerBackground1:{rest:"#3f1011"},dangerBackground2:{rest:"#751d1f"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#d13438"},dangerBorder2:{rest:"#dc5e62"},dangerBorderActive:{rest:"#e37d80"},dangerForeground1:{rest:"#e37d80"},dangerForeground2:{rest:"#f1bbbc"},dangerForeground3:{rest:"#e37d80"},dangerForegroundInverted:{rest:"#d13438"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"#292929",hover:"#3d3d3d",pressed:"#1f1f1f",selected:"#383838"},neutralBackground2:{rest:"#1f1f1f",hover:"#333333",pressed:"#141414",selected:"#2e2e2e"},neutralBackground3:{rest:"#141414",hover:"#292929",pressed:"#0a0a0a",selected:"#242424"},neutralBackground4:{rest:"#0a0a0a",hover:"#1f1f1f",pressed:"#000000",selected:"#1a1a1a"},neutralBackground5:{rest:"#000000",hover:"#141414",pressed:"#050505",selected:"#0f0f0f"},neutralBackground6:{rest:"#333333"},neutralBackgroundDisabled:{rest:"#141414"},neutralBackgroundInverted:{rest:"#ffffff"},neutralForeground1:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForeground2:{rest:"#d6d6d6",hover:"#ffffff",pressed:"#ffffff",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#ffffff"},neutralForeground3:{rest:"#adadad",hover:"#d6d6d6",pressed:"#d6d6d6",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#d6d6d6"},neutralForeground4:{rest:"#999999"},neutralForegroundDisabled:{rest:"#5c5c5c"},neutralForegroundInverted:{rest:"#000000"},neutralForegroundInvertedLink:{rest:"#292929",hover:"#292929",pressed:"#292929",selected:"#292929"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#333333"},neutralStencil2:{rest:"#575757"},neutralStroke1:{rest:"#666666",hover:"#757575",pressed:"#6b6b6b",selected:"#707070"},neutralStroke2:{rest:"#525252"},neutralStroke3:{rest:"#3d3d3d"},neutralStrokeAccessible:{rest:"#adadad",hover:"#bdbdbd",pressed:"#b3b3b3",selected:"#185abd"},neutralStrokeDisabled:{rest:"#424242"},outofofficeBackground1:{rest:"#3a1136"},outofofficeBackground2:{rest:"#6d2064"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#c239b3"},outofofficeBorder2:{rest:"#d161c4"},outofofficeBorderActive:{rest:"#da7ed0"},outofofficeForeground1:{rest:"#da7ed0"},outofofficeForeground2:{rest:"#edbbe7"},outofofficeForeground3:{rest:"#d161c4"},severeBackground1:{rest:"#411200"},severeBackground2:{rest:"#7a2101"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#da3b01"},severeBorder2:{rest:"#e9835e"},severeBorderActive:{rest:"#e9835e"},severeForeground1:{rest:"#e9835e"},severeForeground2:{rest:"#f4bfab"},severeForeground3:{rest:"#e9835e"},strokeFocus1:{rest:"#000000"},strokeFocus2:{rest:"#ffffff"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"#3d3d3d",pressed:"#1f1f1f",selected:"#383838"},successBackground1:{rest:"#052505"},successBackground2:{rest:"#094509"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#107c10"},successBorder2:{rest:"#9fd89f"},successBorderActive:{rest:"#54b054"},successForeground1:{rest:"#54b054"},successForeground2:{rest:"#9fd89f"},successForeground3:{rest:"#9fd89f"},successForegroundInverted:{rest:"#107c10"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#4c4400"},warningBackground2:{rest:"#817400"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fde300"},warningBorder2:{rest:"#fdea3d"},warningBorderActive:{rest:"#feee66"},warningForeground1:{rest:"#feee66"},warningForeground2:{rest:"#fef7b2"},warningForeground3:{rest:"#fdea3d"},warningForegroundInverted:{rest:"#817400"}}});var wge=be((BSr,Dge)=>{s();Dge.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var Oge=be((VSr,Fge)=>{s();Fge.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandBackground2:{rest:"#d2e0f4"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#185abd"},brandForeground2:{rest:"#1651aa"},brandForegroundLink:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#6794d7"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandForeground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},dangerBackground1:{rest:"#fdf6f6"},dangerBackground2:{rest:"#f1bbbc"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#f1bbbc"},dangerBorder2:{rest:"#d13438"},dangerBorderActive:{rest:"#d13438"},dangerForeground1:{rest:"#bc2f32"},dangerForeground2:{rest:"#751d1f"},dangerForeground3:{rest:"#d13438"},dangerForegroundInverted:{rest:"#dc5e62"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"#ffffff",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},neutralBackground2:{rest:"#fafafa",hover:"#f0f0f0",pressed:"#dbdbdb",selected:"#e6e6e6"},neutralBackground3:{rest:"#f5f5f5",hover:"#ebebeb",pressed:"#d6d6d6",selected:"#e0e0e0"},neutralBackground4:{rest:"#f0f0f0",hover:"#fafafa",pressed:"#f5f5f5",selected:"#ffffff"},neutralBackground5:{rest:"#ebebeb",hover:"#f5f5f5",pressed:"#f0f0f0",selected:"#fafafa"},neutralBackground6:{rest:"#e6e6e6"},neutralBackgroundDisabled:{rest:"#f0f0f0"},neutralBackgroundInverted:{rest:"#616161"},neutralForeground1:{rest:"#242424",hover:"#242424",pressed:"#242424",selected:"#242424"},neutralForeground2:{rest:"#424242",hover:"#242424",pressed:"#242424",brandHover:"#1651aa",brandPressed:"#0e336a",brandSelected:"#13458f",selected:"#242424"},neutralForeground3:{rest:"#616161",hover:"#424242",pressed:"#424242",brandHover:"#1651aa",brandPressed:"#0e336a",brandSelected:"#13458f",selected:"#424242"},neutralForeground4:{rest:"#707070"},neutralForegroundDisabled:{rest:"#bdbdbd"},neutralForegroundInverted:{rest:"#ffffff"},neutralForegroundInvertedLink:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#e6e6e6"},neutralStencil2:{rest:"#fafafa"},neutralStroke1:{rest:"#d1d1d1",hover:"#c7c7c7",pressed:"#b3b3b3",selected:"#bdbdbd"},neutralStroke2:{rest:"#e0e0e0"},neutralStroke3:{rest:"#f0f0f0"},neutralStrokeAccessible:{rest:"#616161",hover:"#575757",pressed:"#4d4d4d",selected:"#185abd"},neutralStrokeDisabled:{rest:"#e0e0e0"},outofofficeBackground1:{rest:"#fdf5fc"},outofofficeBackground2:{rest:"#edbbe7"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#edbbe7"},outofofficeBorder2:{rest:"#c239b3"},outofofficeBorderActive:{rest:"#c239b3"},outofofficeForeground1:{rest:"#af33a1"},outofofficeForeground2:{rest:"#6d2064"},outofofficeForeground3:{rest:"#c239b3"},severeBackground1:{rest:"#fdf6f3"},severeBackground2:{rest:"#f4bfab"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#f4bfab"},severeBorder2:{rest:"#da3b01"},severeBorderActive:{rest:"#da3b01"},severeForeground1:{rest:"#c43501"},severeForeground2:{rest:"#7a2101"},severeForeground3:{rest:"#da3b01"},strokeFocus1:{rest:"#ffffff"},strokeFocus2:{rest:"#000000"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"#f5f5f5",pressed:"#e0e0e0",selected:"#ebebeb"},successBackground1:{rest:"#f1faf1"},successBackground2:{rest:"#9fd89f"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#9fd89f"},successBorder2:{rest:"#107c10"},successBorderActive:{rest:"#107c10"},successForeground1:{rest:"#0e700e"},successForeground2:{rest:"#094509"},successForeground3:{rest:"#107c10"},successForegroundInverted:{rest:"#359b35"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#fffef5"},warningBackground2:{rest:"#fef7b2"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fef7b2"},warningBorder2:{rest:"#fde300"},warningBorderActive:{rest:"#fde300"},warningForeground1:{rest:"#817400"},warningForeground2:{rest:"#817400"},warningForeground3:{rest:"#fde300"},warningForegroundInverted:{rest:"#fef7b2"}}});var Mge=be((WSr,Nge)=>{s();Nge.exports={shadow16:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:8,blur:16}],shadow2:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:1,blur:2}],shadow28:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:14,blur:28}],shadow4:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:2,blur:4}],shadow64:[{color:"#00000033",x:0,y:0,blur:8},{color:"#0000003d",x:0,y:32,blur:64}],shadow8:[{color:"#0000001f",x:0,y:0,blur:2},{color:"#00000024",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});var Hge=be((GSr,Lge)=>{s();Lge.exports={body1:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"400"},body1Strong:{fontFamily:"Segoe UI",fontLineHeight:16,fontSize:12,fontWeight:"600"},body2:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"400"},body2Strong:{fontFamily:"Segoe UI",fontLineHeight:20,fontSize:14,fontWeight:"600"},brandBackground:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a",selected:"#13458f"},brandBackground2:{rest:"#d2e0f4"},brandBackgroundStatic:{rest:"#185abd"},brandForeground1:{rest:"#aec6eb"},brandForeground2:{rest:"#d2e0f4"},brandForegroundLink:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5",selected:"#d2e0f4"},brandStroke1:{rest:"#185abd"},brandStroke2:{rest:"#6794d7"},caption1:{fontFamily:"Segoe UI",fontLineHeight:14,fontSize:10,fontWeight:"400"},compoundBrandBackground1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},compoundBrandForeground1:{rest:"#aec6eb",hover:"#d2e0f4",pressed:"#2e6ac5"},compoundBrandStroke1:{rest:"#185abd",hover:"#1651aa",pressed:"#0e336a"},dangerBackground1:{rest:"#3f1011"},dangerBackground2:{rest:"#751d1f"},dangerBackground3:{rest:"#d13438"},dangerBorder1:{rest:"#d13438"},dangerBorder2:{rest:"#dc5e62"},dangerBorderActive:{rest:"#e37d80"},dangerForeground1:{rest:"#e37d80"},dangerForeground2:{rest:"#f1bbbc"},dangerForeground3:{rest:"#e37d80"},dangerForegroundInverted:{rest:"#d13438"},display:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"600"},largeTitle:{fontFamily:"Segoe UI",fontLineHeight:52,fontSize:40,fontWeight:"400"},neutralBackground1:{rest:"#4d4d4d",hover:"#5c5c5c",pressed:"#424242",selected:"#575757"},neutralBackground2:{rest:"#424242",hover:"#525252",pressed:"#383838",selected:"#4d4d4d"},neutralBackground3:{rest:"#383838",hover:"#474747",pressed:"#2e2e2e",selected:"#424242"},neutralBackground4:{rest:"#2e2e2e",hover:"#3d3d3d",pressed:"#242424",selected:"#383838"},neutralBackground5:{rest:"#242424",hover:"#333333",pressed:"#1a1a1a",selected:"#2e2e2e"},neutralBackground6:{rest:"#1a1a1a"},neutralBackgroundDisabled:{rest:"#383838"},neutralBackgroundInverted:{rest:"#ffffff"},neutralForeground1:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralForeground2:{rest:"#e6e6e6",hover:"#ffffff",pressed:"#ffffff",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#ffffff"},neutralForeground3:{rest:"#cccccc",hover:"#e6e6e6",pressed:"#e6e6e6",brandHover:"#d2e0f4",brandPressed:"#2e6ac5",brandSelected:"#d2e0f4",selected:"#e6e6e6"},neutralForeground4:{rest:"#c2c2c2"},neutralForegroundDisabled:{rest:"#666666"},neutralForegroundInverted:{rest:"#000000"},neutralForegroundInvertedLink:{rest:"#4d4d4d",hover:"#4d4d4d",pressed:"#4d4d4d",selected:"#4d4d4d"},neutralForegroundOnBrand:{rest:"#ffffff",hover:"#ffffff",pressed:"#ffffff",selected:"#ffffff"},neutralStencil1:{rest:"#1a1a1a"},neutralStencil2:{rest:"#424242"},neutralStroke1:{rest:"#8a8a8a",hover:"#999999",pressed:"#8f8f8f",selected:"#949494"},neutralStroke2:{rest:"#757575"},neutralStroke3:{rest:"#616161"},neutralStrokeAccessible:{rest:"#a8a8a8",hover:"#b8b8b8",pressed:"#adadad",selected:"#185abd"},neutralStrokeDisabled:{rest:"#474747"},outofofficeBackground1:{rest:"#3a1136"},outofofficeBackground2:{rest:"#6d2064"},outofofficeBackground3:{rest:"#c239b3"},outofofficeBorder1:{rest:"#c239b3"},outofofficeBorder2:{rest:"#d161c4"},outofofficeBorderActive:{rest:"#da7ed0"},outofofficeForeground1:{rest:"#da7ed0"},outofofficeForeground2:{rest:"#edbbe7"},outofofficeForeground3:{rest:"#d161c4"},severeBackground1:{rest:"#411200"},severeBackground2:{rest:"#7a2101"},severeBackground3:{rest:"#da3b01"},severeBorder1:{rest:"#da3b01"},severeBorder2:{rest:"#e9835e"},severeBorderActive:{rest:"#e9835e"},severeForeground1:{rest:"#e9835e"},severeForeground2:{rest:"#f4bfab"},severeForeground3:{rest:"#e9835e"},strokeFocus1:{rest:"#000000"},strokeFocus2:{rest:"#ffffff"},subtitle1:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"400"},subtitle1Strong:{fontFamily:"Segoe UI",fontLineHeight:26,fontSize:20,fontWeight:"600"},subtitle2:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"400"},subtitle2Strong:{fontFamily:"Segoe UI",fontLineHeight:22,fontSize:16,fontWeight:"600"},subtleBackground:{rest:"#00000000",hover:"#5c5c5c",pressed:"#424242",selected:"#575757"},successBackground1:{rest:"#052505"},successBackground2:{rest:"#094509"},successBackground3:{rest:"#107c10"},successBorder1:{rest:"#107c10"},successBorder2:{rest:"#9fd89f"},successBorderActive:{rest:"#54b054"},successForeground1:{rest:"#54b054"},successForeground2:{rest:"#9fd89f"},successForeground3:{rest:"#9fd89f"},successForegroundInverted:{rest:"#107c10"},title1:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"400"},title1Strong:{fontFamily:"Segoe UI",fontLineHeight:36,fontSize:28,fontWeight:"600"},transparentBackground:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",selected:"#00000000"},transparentStroke:{rest:"#00000000",hover:"#00000000",pressed:"#00000000",disabled:"#00000000"},warningBackground1:{rest:"#4c4400"},warningBackground2:{rest:"#817400"},warningBackground3:{rest:"#fde300"},warningBorder1:{rest:"#fde300"},warningBorder2:{rest:"#fdea3d"},warningBorderActive:{rest:"#feee66"},warningForeground1:{rest:"#feee66"},warningForeground2:{rest:"#fef7b2"},warningForeground3:{rest:"#fdea3d"},warningForegroundInverted:{rest:"#817400"}}});var Uge=be((KSr,Bge)=>{s();Bge.exports={shadow16:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:8,blur:16}],shadow2:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:1,blur:2}],shadow28:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:14,blur:28}],shadow4:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:2,blur:4}],shadow64:[{color:"#00000066",x:0,y:0,blur:8},{color:"#0000007a",x:0,y:32,blur:64}],shadow8:[{color:"#0000003d",x:0,y:0,blur:2},{color:"#00000047",x:0,y:4,blur:8}],shadowBrand16:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:8,blur:16}],shadowBrand2:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:1,blur:2}],shadowBrand28:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:14,blur:28}],shadowBrand4:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:2,blur:4}],shadowBrand64:[{color:"#0000004d",x:0,y:0,blur:8},{color:"#00000040",x:0,y:32,blur:64}],shadowBrand8:[{color:"#0000004d",x:0,y:0,blur:2},{color:"#00000040",x:0,y:4,blur:8}]}});function ENe(e){for(var t in e)for(var r in e[t]){var n=e[t][r];if(typeof n=="string"&&n.includes("PlatformColor")){var o=n.substring(14,n.length-1);e[t][r]=(0,Vge.PlatformColor)(o)}}return e}var Vge,jge,Wge,zge=f(()=>{"use strict";s();Vge=S(re()),jge=S(X1()),Wge=ENe(jge.default)});function lk(e){return e==="White"||e==="Colorful"?uk.default:e==="DarkGray"?Yge.default:e==="Black"?Gge.default:e==="HighContrast"?Wge:uk.default}function Xge(e){return e==="White"||e==="Colorful"?Kge.default:e==="DarkGray"?$ge.default:e==="Black"?qge.default:e==="HighContrast"?Qge.default:uk.default}var Gge,qge,uk,Kge,Yge,$ge,Qge,qB=f(()=>{"use strict";s();Gge=S(kge()),qge=S(wge()),uk=S(Oge()),Kge=S(Mge()),Yge=S(Hge()),$ge=S(Uge()),Qge=S(Q1());zge()});function PNe(e){var t=lk(e);return Ev(t)}function _Ne(e){var t=Xge(e);return Pv(t)}var KB,Jge,YB=f(()=>{"use strict";s();Bc();Vc();qB();KB=Qt(PNe);Jge=Qt(_Ne)});function $B(e){return{background:e.Bkg,bodyStandoutBackground:e.Bkg,bodyFrameBackground:e.Bkg,bodyFrameDivider:e.AccentLight,bodyText:e.Text,bodyTextChecked:e.TextSelected,subText:e.TextSecondary,bodyDivider:e.AccentLight,disabledBackground:e.BkgCtlSubtleDisabled,disabledText:e.TextCtlSubtleDisabled,disabledBodyText:e.TextDisabled,focusBorder:e.StrokeKeyboard,variantBorder:e.AccentOutline,errorText:e.TextError,inputBorder:e.StrokeCtlSubtle,inputBackground:e.BkgCtlSubtle,inputFocusBorderAlt:e.StrokeCtlSubtleKeyboard,inputText:e.TextCtlSubtle,inputPlaceholderText:e.TextCtlSubtlePlaceholder,buttonBackground:e.BkgCtl,buttonBackgroundChecked:e.BkgCtlSelected,buttonBackgroundHovered:e.BkgCtlHover,buttonBackgroundPressed:e.BkgCtlPressed,buttonBackgroundDisabled:e.BkgCtlDisabled,buttonBorder:e.StrokeCtl,buttonText:e.TextCtl,buttonTextHovered:e.TextCtlHover,buttonTextChecked:e.TextCtlSelected,buttonTextPressed:e.TextCtlPressed,buttonTextDisabled:e.TextCtlDisabled,buttonBorderDisabled:e.StrokeCtlDisabled,buttonBorderFocused:e.StrokeCtlKeyboard,primaryButtonBackground:e.BkgCtlEmphasis,primaryButtonBackgroundHovered:e.BkgCtlEmphasisHover,primaryButtonBackgroundPressed:e.BkgCtlEmphasisPressed,primaryButtonBackgroundDisabled:e.BkgCtlEmphasisDisabled,primaryButtonBorder:e.StrokeCtlEmphasis,primaryButtonBorderFocused:e.StrokeCtlEmphasisKeyboard,primaryButtonText:e.TextCtlEmphasis,primaryButtonTextHovered:e.TextCtlEmphasisHover,primaryButtonTextPressed:e.TextCtlEmphasisPressed,primaryButtonTextDisabled:e.TextCtlEmphasisDisabled,accentButtonBackground:e.BkgCtlEmphasis,menuBackground:e.Bkg,menuDivider:e.AccentLight,menuIcon:e.Text,menuItemBackgroundHovered:e.BkgHover,menuItemBackgroundPressed:e.BkgPressed,menuItemText:e.Text,menuItemTextHovered:e.TextHover,listHeaderBackgroundHovered:e.BkgHover,listHeaderBackgroundPressed:e.BkgPressed,actionLink:e.TextActive,link:e.TextHyperlink,linkHovered:e.TextHyperlinkHover,linkPressed:e.TextHyperlinkPressed,defaultBackground:e.BkgCtl,defaultBorder:e.StrokeCtl,defaultContent:e.TextCtl,defaultIcon:e.TextCtl,defaultHoveredBackground:e.BkgCtlHover,defaultHoveredBorder:e.StrokeCtlHover,defaultHoveredContent:e.TextCtlHover,defaultHoveredIcon:e.TextCtlHover,defaultFocusedBackground:e.BkgCtlHover,defaultFocusedBorder:e.StrokeCtlKeyboard,defaultFocusedContent:e.TextCtlHover,defaultFocusedIcon:e.TextCtlHover,defaultPressedBackground:e.BkgCtlPressed,defaultPressedBorder:e.StrokeCtlPressed,defaultPressedContent:e.TextCtlPressed,defaultPressedIcon:e.TextCtlPressed,defaultDisabledBackground:e.BkgCtlDisabled,defaultDisabledBorder:e.StrokeCtlDisabled,defaultDisabledContent:e.TextCtlDisabled,defaultDisabledIcon:e.TextCtlDisabled,ghostBackground:e.Bkg,ghostBorder:e.Bkg,ghostContent:e.Text,ghostIcon:e.Text,ghostHoveredBackground:e.BkgHover,ghostHoveredBorder:e.BkgHover,ghostHoveredContent:e.TextHover,ghostHoveredIcon:e.TextHover,ghostFocusedBackground:e.BkgHover,ghostFocusedBorder:e.StrokeKeyboard,ghostFocusedContent:e.TextHover,ghostFocusedIcon:e.TextHover,ghostPressedBackground:e.BkgPressed,ghostPressedBorder:e.BkgPressed,ghostPressedContent:e.TextPressed,ghostPressedIcon:e.TextPressed,ghostDisabledBackground:e.Bkg,ghostDisabledBorder:e.Bkg,ghostDisabledContent:e.TextDisabled,ghostDisabledIcon:e.TextDisabled,brandedBackground:e.BkgCtlEmphasis,brandedDisabledBorder:e.StrokeCtlEmphasisDisabled,defaultCheckedBackground:e.BkgCtlSelected,defaultCheckedContent:e.TextCtlSelected,defaultCheckedHoveredBackground:e.BkgCtlHover,defaultCheckedHoveredContent:e.TextCtlHover,ghostCheckedBackground:e.BkgSelected,ghostCheckedContent:e.TextSelected,ghostCheckedHoveredBackground:e.BkgHover,ghostCheckedHoveredContent:e.TextHover,ghostCheckedHoveredBorder:e.StrokeSelectedHover,ghostSecondaryContent:e.TextSecondary,ghostFocusedSecondaryContent:e.TextSecondaryHover,ghostHoveredSecondaryContent:e.TextSecondaryHover,ghostPressedSecondaryContent:e.TextSecondaryPressed}}var QB=f(()=>{"use strict";s()});function XB(e,t,r){return m({colors:m({},r&&$B(r)),typography:e.getConstants().fluentTypography,host:{palette:r||{},colors:RNe(e)}},t?{name:t}:void 0)}var RNe,JB=f(()=>{"use strict";s();k();QB();RNe=function(t){return Object.keys(t.getConstants().ramps).reduce(function(r,n){return Object.assign.apply(Object,w([r],t.getConstants().rampNames[n].map(function(o,a){var d;return d={},d[o]=t.getConstants().ramps[n][a],d}),!1))},{})}});function ANe(){var e=lk("Colorful");return nO(e)}var ZB,e3=f(()=>{"use strict";s();Bc();Vc();qB();ZB=Qt(ANe)});function kT(){var e={sizes:Yo.typography.sizes,weights:Yo.typography.weights,families:{primary:"Segoe UI",secondary:"Segoe UI Semibold",cursive:"System",monospace:"Consolas",sansSerif:"System",serif:"System",numeric:"Bahnschrift"},variants:m({captionStandard:{face:"primary",size:"caption",weight:"regular"},secondaryStandard:{face:"primary",size:"secondary",weight:"regular"},secondarySemibold:{face:"primary",size:"secondary",weight:"semiBold"},bodyStandard:{face:"primary",size:"body",weight:"regular"},bodySemibold:{face:"primary",size:"body",weight:"semiBold"},subheaderStandard:{face:"primary",size:"subheader",weight:"regular"},subheaderSemibold:{face:"primary",size:"subheader",weight:"semiBold"},headerStandard:{face:"primary",size:"header",weight:"regular"},headerSemibold:{face:"primary",size:"header",weight:"semiBold"},heroStandard:{face:"primary",size:"hero",weight:"regular"},heroSemibold:{face:"primary",size:"hero",weight:"semiBold"},heroLargeStandard:{face:"primary",size:"heroLarge",weight:"regular"},heroLargeSemibold:{face:"primary",size:"heroLarge",weight:"semiBold"}},ZB())};return e}var t3=f(()=>{"use strict";s();k();Vg();e3()});function fk(e){return e==="TaskPane"?m(m({},Zge),{Bkg:"antiquewhite"}):Zge}var Zge,r3,n3=f(()=>{"use strict";s();k();Zge={Bkg:"#FFFFFF",BkgHover:"#D2D2D2",BkgPressed:"#B1B1B1",BkgSelected:"#C6C6C6",BkgSubtle:"#F3F3F3",BkgSelectionHighlight:"#737373",Text:"#262626",TextRest:"#262626",TextHover:"#262626",TextPressed:"#262626",TextSelected:"#262626",TextDisabled:"#B1B1B1",TextSelectionHighlight:"#FFFFFF",TextSecondary:"#666666",TextSecondaryRest:"#666666",TextSecondaryHover:"#505050",TextSecondaryPressed:"#666666",TextSecondarySelected:"#666666",TextEmphasis:"#D83B01",TextEmphasisRest:"#D83B01",TextEmphasisHover:"#EA6115",TextEmphasisPressed:"#A22C01",TextEmphasisSelected:"#D83B01",StrokeSelectedHover:"#969696",StrokeKeyboard:"#969696",StrokeOverRest:"#00000000",StrokeOverHover:"#00000000",StrokeOverPressed:"#00000000",StrokeOverSelectedRest:"#00000000",StrokeOverSelectedHover:"#969696",StrokeOverSelectedPressed:"#00000000",BkgCtl:"#E6E6E6",BkgCtlHover:"#FFF7F0",BkgCtlPressed:"#FBDFD0",BkgCtlSelected:"#E6E6E6",BkgCtlDisabled:"#E6E6E6",TextCtl:"#262626",TextCtlHover:"#262626",TextCtlPressed:"#262626",TextCtlSelected:"#262626",TextCtlDisabled:"#B1B1B1",StrokeCtl:"#969696",StrokeCtlHover:"#FBDFD0",StrokeCtlPressed:"#EA6115",StrokeCtlSelected:"#969696",StrokeCtlDisabled:"#D2D2D2",StrokeCtlKeyboard:"#FBDFD0",BkgCtlEmphasis:"#D83B01",BkgCtlEmphasisHover:"#F29F71",BkgCtlEmphasisPressed:"#A22C01",BkgCtlEmphasisDisabled:"#E6E6E6",TextCtlEmphasis:"#FFFFFF",TextCtlEmphasisHover:"#FFFFFF",TextCtlEmphasisPressed:"#FFFFFF",TextCtlEmphasisDisabled:"#B1B1B1",StrokeCtlEmphasis:"#A22C01",StrokeCtlEmphasisHover:"#D83B01",StrokeCtlEmphasisPressed:"#A22C01",StrokeCtlEmphasisDisabled:"#D2D2D2",StrokeCtlEmphasisKeyboard:"#A22C01",BkgCtlSubtle:"#FFFFFF",BkgCtlSubtleHover:"#FFFFFF",BkgCtlSubtlePressed:"#FFFFFF",BkgCtlSubtleDisabled:"#F3F3F3",BkgCtlSubtleSelectionHighlight:"#7DA3C6",TextCtlSubtle:"#262626",TextCtlSubtlePlaceholder:"#666666",TextCtlSubtleHover:"#262626",TextCtlSubtlePressed:"#262626",TextCtlSubtleDisabled:"#B1B1B1",TextCtlSubtleSelectionHighlight:"#262626",StrokeCtlSubtle:"#C6C6C6",StrokeCtlSubtleHover:"#969696",StrokeCtlSubtlePressed:"#969696",StrokeCtlSubtleDisabled:"#C6C6C6",StrokeCtlSubtleKeyboard:"#969696",TextHyperlink:"#D83B01",TextHyperlinkHover:"#A22C01",TextHyperlinkPressed:"#6C1E01",TextActive:"#262626",TextActiveHover:"#EA6115",TextActivePressed:"#A22C01",TextActiveSelected:"#D83B01",StrokeOnlyHover:"#B1B1B1",StrokeOnlyPressed:"#737373",StrokeOnlySelected:"#969696",TextError:"#A50000",TextErrorHover:"#A50000",TextErrorPressed:"#A50000",TextErrorSelected:"#A50000",ThumbToggleSwitchOff:"#505050",ThumbToggleSwitchOffHover:"#505050",ThumbToggleSwitchOffPressed:"#505050",ThumbToggleSwitchOffDisabled:"#D2D2D2",ThumbToggleSwitchOn:"#FFFFFF",ThumbToggleSwitchOnHover:"#FFFFFF",ThumbToggleSwitchOnPressed:"#FFFFFF",ThumbToggleSwitchOnDisabled:"#FFFFFF",BkgToggleSwitchOff:"#FFFFFF",BkgToggleSwitchOffHover:"#D2D2D2",BkgToggleSwitchOffPressed:"#B1B1B1",BkgToggleSwitchOffDisabled:"#FFFFFF",BkgToggleSwitchOn:"#D83B01",BkgToggleSwitchOnHover:"#EA6115",BkgToggleSwitchOnPressed:"#A22C01",BkgToggleSwitchOnDisabled:"#D2D2D2",StrokeToggleSwitchOff:"#505050",StrokeToggleSwitchOffHover:"#505050",StrokeToggleSwitchOffPressed:"#505050",StrokeToggleSwitchOffDisabled:"#D2D2D2",StrokeToggleSwitchOn:"#D83B01",StrokeToggleSwitchOnHover:"#EA6115",StrokeToggleSwitchOnPressed:"#A22C01",StrokeToggleSwitchOnDisabled:"#D2D2D2",SliderPrimary:"#444444",SliderPrimaryHover:"#D2D2D2",SliderPrimaryPressed:"#262626",SliderPrimaryDisabled:"#969696",SliderSecondary:"#D2D2D2",SliderBuffer:"#262626",SliderKeyboard:"#444444",SliderToolTipBorder:"#C6C6C6",SliderToolTipLabel:"#262626",SliderToolTipBkg:"#FFFFFF",AccentDark:"#C6C6C6",AccentLight:"#E6E6E6",AccentEmphasis:"#D83B01",AccentOutline:"#000000",TextEmphasis2:"#D83B01",BkgCtlSubtleSelected:"#F3F3F3",TextCtlSubtleSelected:"#262626",BkgCtlEmphasisFocus:"#F3F3F3",BkgCtlSubtleFocus:"#F3F3F3",BkgCtlSubtleHoverDisabled:"#F3F3F3",BkgCtlSubtleSelectedDisabled:"#F3F3F3",BkgHeader:"#E6E6E6",TextHeader:"#262626"};r3={getPalette:fk,getConstants:function(){return{ramps:{App:["#F8F8F8","#EFF6FC","#BBDAF3","#55A4E2","#359EDD","#0078d7","#283E4A","#030C13"],FluentGrays:["#FAF9F8","#797775","#11100F"],ClassicGrays:["#FFFFFF","#737373","#000000"],Sepias:["#ECE6DE"]},typography:{},fluentTypography:{},rampNames:{App:["FakeApp1","App2","App3","App4","App5","App6","App7","App8"],FluentGrays:["FakeGray1","Gray2","Gray3"],ClassicGrays:["FakeGray4","Gray5","Gray6"],Sepias:["FakeSepia"]}}}}});var ehe,the,pk,o3=f(()=>{"use strict";s();ehe="",the=function(){return ehe},pk=function(t){ehe=t}});function kNe(){var e=!1;return e}function i3(){var e=mk.TurboModuleRegistry.get("Theming");return e?(rhe||(pk(e.getConstants().initialHostThemeSetting),rhe=!0),[kNe()?m(m({},e),{getPalette:fk}):e,new mk.NativeEventEmitter(e)]):[r3,void 0]}var mk,rhe,a3=f(()=>{"use strict";s();k();mk=S(re());n3();o3();rhe=!1});function DNe(e){var t=e;return t&&t.message!==void 0?void 0:e}function s3(e){e===void 0&&(e={});var t=i3(),r=t[0],n=t[1],o={module:r,emitter:n,themeName:the()||""},a=e.paletteName,d=new Jf(uO(e),function(){var u=a||"WhiteColors",l=DNe(o.module.getPalette(u));return XB(r,o.themeName,l)},function(){return!o.themeName||o.themeName===""?{}:{shadows:m({},Jge(o.themeName)),typography:kT()}},function(){return!o.themeName||o.themeName===""?{}:{colors:m({},KB(o.themeName)),typography:kT()}},function(u){return zB(o.themeName,u)},function(u){return u.host.palette?m(m({},a!==void 0&&{colors:Pge(u.host.palette,o.themeName==="HighContrast")}),{typography:kT()}):{}}),c=function(l){o.themeName=l&&l.hostThemeSetting||o.themeName,pk(o.themeName),d.invalidate()};return n&&n.addListener("onPlatformDefaultsChanged",c),d}var nhe=f(()=>{"use strict";s();k();Vg();Rv();_ge();GB();YB();JB();t3();a3();o3()});var ohe=f(()=>{"use strict";s()});var ihe=f(()=>{"use strict";s();n3();a3();ohe()});var ahe=f(()=>{"use strict";s();nhe();JB();ihe();QB();YB();e3();GB();t3()});var she,dhe=f(()=>{"use strict";s();rt();Rv();ahe();ye();yo();she=Qe(function(){var e=s3({paletteName:Uo()?"TaskPaneCard_FluentSV":"TaskPaneCard_VisualRefresh"});return new Jf(e,kY)})});var DT,yy,gk=f(()=>{"use strict";s();k();Rv();DT=S(L());dhe();rr();yy=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.updateState=n.updateState.bind(n),r.api.registerForThemeChange(n.updateState),n.state=r.api.getTheme(),n}return t.prototype.componentWillUnmount=function(){this.props.api.unregisterForThemeChange(this.updateState)},t.prototype.updateState=function(){this.setState(this.props.api.getTheme())},t.prototype.render=function(){return DT.createElement(dO,{theme:she()},DT.createElement(Ge.Provider,{value:this.state},this.props.children))},t}(DT.Component)});var che={};Ey(che,{ExtensionAwareCommentPane:()=>d3});var Cy,d3,c3=f(()=>{"use strict";s();Cy=S(L());Di();Sge();Qp();Ni();lo();dk();ak();gk();d3=Cy.memo(function(e){var t=ck(function(a){return Ige(a,e.extensionRenderMode)}),r=ck(aa)!==bt.Visible,n=ck(tr);if(t||r)return null;var o=Cy.createElement(yy,{api:e.themeAPI},Cy.createElement(bge,{commentAPI:e.commentAPI,peopleAPI:e.peopleAPI,localizationAPI:e.localizationAPI,focusManager:e.focusManager,selectionManager:e.selectionManager,initializationReason:e.initializationReason,registerComponentUIActionListener:e.registerComponentUIActionListener,unregisterComponentUIActionListener:e.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:e.registerComponentInterruptableCommandListener,unregisterComponentInterruptableCommandListener:e.unregisterComponentInterruptableCommandListener,resource:e.resource,telemetryVisitor:e.telemetryVisitor,correlationId:e.correlationId,onInitialRender:e.onInitialRender,lppManager:e.lppManager,createOrUpdateFilter:e.createOrUpdateFilter,componentRef:e.componentRef,componentInstanceId:e.componentInstanceId}));return n&&(o=Cy.createElement(_T.Provider,{value:n},o)),o})});var Khe=be(OT=>{"use strict";s();Object.defineProperty(OT,"__esModule",{value:!0});OT.CustomLinkAction=void 0;var TMe;(function(e){e[e.ACCOUNTDETAILS=0]="ACCOUNTDETAILS"})(TMe=OT.CustomLinkAction||(OT.CustomLinkAction={}))});var Yhe=be(Ir=>{"use strict";s();Object.defineProperty(Ir,"__esModule",{value:!0});Ir.CustomLinkAction=Ir.NativeServices=Ir.ServiceInfos=void 0;var Fn=Et();Fn.CustomTypeRegistry.registerTypeInfos({"Identity::MeControlProfileData":{CompanyName:"$string",Email:"$string",FirstName:"$string",FriendlyName:"$string",HostResolutionId:"$string",IsOrgId:"$boolean",IsMsaId:"$boolean",IsAdId:"$boolean",LastName:"$string",ProfileId:"$string",ProfilePicBase64:"$string",IsAccountInBadState:["opt-field","$boolean"],PhoneNumber:["opt-field","$string"]},"Identity::MeControlProfiles":{Profiles:["$array","Identity::MeControlProfileData"]},"Identity::MeControlSignInResult":{UserCanceled:"$boolean",ErrorCode:"$number"},"Identity::MeControlSignOutResult":{UserCanceled:"$boolean",IsProfileSignedOut:"$boolean"},"Identity::MeControlSwitchProfileResult":{IsProfileSwitched:"$boolean",IdentityErrorState:"$string"},"Identity::MeControlProfileEmailToSwitchTo":{ProfileEmailToSwitchTo:"$string"},"Identity::MeControlAddMailAccountResult":{UserCanceled:"$boolean",ErrorCode:"$number"},"Identity::MeControlSwitchMailAccountResult":{IsAccountSwitched:"$boolean",AccountErrorState:"$string"},"Identity::MeControlMailAccountEmailToSwitchTo":{AccountEmailToSwitchTo:"$string"},"Identity::MeControlProfileEmailToSignOut":{ProfileEmailToSignOut:"$string"},"Identity::MeControlCustomLinkId":{CustomLinkId:"$number"},"Identity::MeControlViewId":{ViewId:"$number"},"Identity::MeControlAccountImageSize":{ActiveAccountImageSize:"$number",SecondaryAccountImageSize:"$number"},"Identity::MeControlPrideColorGradientImages":{IsShowPridePreferenceEnabled:"$boolean",ActiveAccountGradientImage:"$string",SecondaryAccountGradientImage:"$string"},"Identity::UserInfo":{UserName:"$string",CorrelationId:"$string"},"Identity::ServiceInfo":{ServiceName:"$string"},"Identity::AuthData":{AuthToken:"$string",ErrorMessage:"$string",CorrelationId:"$string",OperationResult:"$boolean"},"Identity::AuthServerURLData":{ServiceName:"$string",AuthServerURL:"$string",ErrorMessage:"$string",OperationResult:"$boolean"},"Identity::MeControlFixAccountErrorResult":{DidShowFixAccountDialog:"$boolean"}});Ir.ServiceInfos={NativeGetMSGraphToken:["Identity::NativeGetMSGraphToken",{QueryToken:["ReturnsPromiseMethod","Identity::AuthData",["Identity::UserInfo"]]}],NativeGetLokiToken:["Identity::NativeGetLokiToken",{QueryToken:["ReturnsPromiseMethod","Identity::AuthData",["Identity::UserInfo"]]}],NativeGetLokiUrl:["Identity::NativeGetLokiUrl",{QueryLokiUrl:["ReturnsPromiseMethod","$string",["Identity::UserInfo"]]}],NativeGetTenantId:["Identity::NativeGetTenantId",{QueryTenantId:["ReturnsPromiseMethod","$string",["Identity::UserInfo"]]}],NativeGetServiceURL:["Identity::NativeGetServiceURL",{QueryAuthServerUrl:["ReturnsPromiseMethod","Identity::AuthServerURLData",["Identity::ServiceInfo"]]}],NativeGetMeControlProfiles:["Identity::NativeGetMeControlProfiles",{GetMeControlProfiles:["ReturnsPromiseMethod","Identity::MeControlProfiles",[]]}],NativeMeControlSignIn:["Identity::NativeMeControlSignIn",{MeControlSignIn:["ReturnsPromiseMethod","Identity::MeControlSignInResult",[]]}],NativeMeControlSignInWithViewId:["Identity::NativeMeControlSignInWithViewId",{MeControlSignIn:["ReturnsPromiseMethod","Identity::MeControlSignInResult",["Identity::MeControlViewId"]]}],NativeMeControlSwitchProfile:["Identity::NativeMeControlSwitchProfile",{MeControlSwitchProfile:["ReturnsPromiseMethod","Identity::MeControlSwitchProfileResult",["Identity::MeControlProfileEmailToSwitchTo"]]}],NativeMeControlSignOutProfile:["Identity::NativeMeControlSignOutProfile",{MeControlSignOutProfile:["ReturnsPromiseMethod","Identity::MeControlSignOutResult",["Identity::MeControlProfileEmailToSignOut"]]}],NativeMeControlSignOutProfileWithViewId:["Identity::NativeMeControlSignOutProfileWithViewId",{MeControlSignOutProfile:["ReturnsPromiseMethod","Identity::MeControlSignOutResult",["Identity::MeControlProfileEmailToSignOut","Identity::MeControlViewId"]]}],NativeMeControlAddMailAccount:["Identity::NativeMeControlAddMailAccount",{MeControlAddMailAccount:["ReturnsPromiseMethod","Identity::MeControlAddMailAccountResult",[]]}],NativeMeControlSwitchMailAccount:["Identity::NativeMeControlSwitchMailAccount",{MeControlSwitchMailAccount:["ReturnsPromiseMethod","Identity::MeControlSwitchMailAccountResult",["Identity::MeControlMailAccountEmailToSwitchTo"]]}],NativeMeControlCloseFlyout:["Identity::NativeMeControlCloseFlyout",{CloseFlyout:["ReturnsPromiseMethod","$boolean",[]]}],NativeMeControlCloseFlyoutWithViewId:["Identity::NativeMeControlCloseFlyoutWithViewId",{CloseFlyout:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId"]]}],NativeMeControlCustomLinkClickedWithViewId:["Identity::NativeMeControlCustomLinkClickedWithViewId",{CustomLinkClicked:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId"]]}],NativeMeControlCustomLinkClickedWithAction:["Identity::NativeMeControlCustomLinkClickedWithAction",{CustomLinkClicked:["ReturnsPromiseMethod","$boolean",["Identity::MeControlViewId","$number"]]}],NativeMeControlGetPrideColorGradientImages:["Identity::NativeMeControlGetPrideColorGradientImages",{GetPrideColorGradientImages:["ReturnsPromiseMethod","Identity::MeControlPrideColorGradientImages",["Identity::MeControlAccountImageSize","Identity::MeControlViewId"]]}],NativeMeControlFixAccountError:["Identity::NativeMeControlFixAccountError",{MeControlFixAccountError:["ReturnsPromiseMethod","Identity::MeControlFixAccountErrorResult",[]]}]};Ir.NativeServices={NativeGetMSGraphToken:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeGetMSGraphToken),NativeGetLokiToken:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeGetLokiToken),NativeGetLokiUrl:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeGetLokiUrl),NativeGetTenantId:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeGetTenantId),NativeGetServiceURL:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeGetServiceURL),NativeGetMeControlProfiles:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeGetMeControlProfiles),NativeMeControlSignIn:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlSignIn),NativeMeControlSignInWithViewId:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlSignInWithViewId),NativeMeControlSwitchProfile:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlSwitchProfile),NativeMeControlSignOutProfile:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlSignOutProfile),NativeMeControlSignOutProfileWithViewId:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlSignOutProfileWithViewId),NativeMeControlAddMailAccount:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlAddMailAccount),NativeMeControlSwitchMailAccount:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlSwitchMailAccount),NativeMeControlCloseFlyout:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlCloseFlyout),NativeMeControlCloseFlyoutWithViewId:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlCloseFlyoutWithViewId),NativeMeControlCustomLinkClickedWithViewId:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlCustomLinkClickedWithViewId),NativeMeControlCustomLinkClickedWithAction:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlCustomLinkClickedWithAction),NativeMeControlGetPrideColorGradientImages:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlGetPrideColorGradientImages),NativeMeControlFixAccountError:Fn.RekaServiceRegistry.getNativeService(Ir.ServiceInfos.NativeMeControlFixAccountError)};var bMe=Khe();Object.defineProperty(Ir,"CustomLinkAction",{enumerable:!0,get:function(){return bMe.CustomLinkAction}})});var $he=be(zl=>{"use strict";s();Object.defineProperty(zl,"__esModule",{value:!0});zl.ServiceInfos=zl.NativeServices=zl.CustomLinkAction=void 0;var f3=Yhe();Object.defineProperty(zl,"CustomLinkAction",{enumerable:!0,get:function(){return f3.CustomLinkAction}});Object.defineProperty(zl,"NativeServices",{enumerable:!0,get:function(){return f3.NativeServices}});Object.defineProperty(zl,"ServiceInfos",{enumerable:!0,get:function(){return f3.ServiceInfos}})});var rm,kCe,ECe,PCe,_Ce,RCe,ACe,DCe=f(()=>{"use strict";s();k();ne();rt();te();rm=S(L());xB();gn();gk();IA();kCe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.getDiagnosticDataFields=function(){return[Vr("IsResourceAvailable",n.props.isResourceAvailable,N.SystemMetadata),Vr("IsContentExtensionEnabled",n.props.isExtensionEnabled,N.SystemMetadata),Vr("RenderContextType",n.props.componentTree.componentTreeId.renderContextType,N.SystemMetadata)]},n.getUpdatedResource=Qe(function(o,a){return m(m({},o),{id:a})}),n.createTelemetryContext=Qe(SA),n.getAccessibilitySetProperties=vn(function(o){var a,d,c;return{accessibilityPositionInSet:(a=o==null?void 0:o.setItem)===null||a===void 0?void 0:a.positionInSet,accessibilitySetSize:(d=o==null?void 0:o.setItem)===null||d===void 0?void 0:d.setSize,accessibilityLevel:(c=o==null?void 0:o.setItem)===null||c===void 0?void 0:c.level}},function(){return[n.props.accessibilityMetadata]}),n.state={keyIter_deprecated:0},n}return t.prototype.componentDidUpdate=function(r){var n,o;r.isResourceAvailable!==this.props.isResourceAvailable&&((o=(n=x()).logDiagnosticTrace)===null||o===void 0||o.call.apply(o,w([n,Ot(ECe||(ECe=zt(["HostableComponentResourceAvailabilityUpdated"],["HostableComponentResourceAvailabilityUpdated"]))),C.reserveTag(554717322),xt.Info,mt.ProductServiceUsage,this.props.telemetryVisitor],V(this.getDiagnosticDataFields()),!1)))},t.prototype.componentDidMount=function(){var r,n;(n=(r=x()).logDiagnosticTrace)===null||n===void 0||n.call.apply(n,w([r,Ot(PCe||(PCe=zt(["HostableComponentMount"],["HostableComponentMount"]))),C.reserveTag(554717323),xt.Info,mt.ProductServiceUsage,this.props.telemetryVisitor],V(this.getDiagnosticDataFields()),!1))},t.prototype.componentWillUnmount=function(){var r,n;(n=(r=x()).logDiagnosticTrace)===null||n===void 0||n.call.apply(n,w([r,Ot(_Ce||(_Ce=zt(["HostableComponentUnmount"],["HostableComponentUnmount"]))),C.reserveTag(554717324),xt.Info,mt.ProductServiceUsage,this.props.telemetryVisitor],V(this.getDiagnosticDataFields()),!1))},t.prototype.render=function(){var r,n,o,a;if(!this.props.isResourceAvailable||!this.props.resource||!this.props.threadId)return(n=(r=x()).logDiagnosticTrace)===null||n===void 0||n.call.apply(n,w([r,Ot(RCe||(RCe=zt(["HostableComponentRenderFailed"],["HostableComponentRenderFailed"]))),C.reserveTag(524100997),xt.Info,mt.ProductServiceUsage,this.props.telemetryVisitor],V(this.getDiagnosticDataFields()),!1)),null;if(!this.props.isExtensionEnabled)return Nn?rm.createElement(qe,{textStylePolyester:"MediumBold"},"Debug Error: This comment card's extension is disabled."):((a=(o=x()).logDiagnosticTrace)===null||a===void 0||a.call.apply(a,w([o,Ot(ACe||(ACe=zt(["HostableComponentRenderFailedExtensionDisabled"],["HostableComponentRenderFailedExtensionDisabled"]))),C.reserveTag(524100998),xt.Info,mt.ProductServiceUsage,this.props.telemetryVisitor],V(this.getDiagnosticDataFields()),!1)),null);var d=this.getUpdatedResource(this.props.resource,this.props.threadId),c=this.getAccessibilitySetProperties(),u=rm.createElement(yy,{api:this.props.themeAPI},rm.createElement(XA,m({commentAPI:this.props.commentAPI,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:d,telemetryVisitor:this.props.telemetryVisitor,componentRef:this.props.componentRef,componentTree:this.props.componentTree,maximumDimensions:this.props.maximumDimensions,onInitialRender:this.props.onInitialRender,setComponentRef:this.props.setComponentRef,isVirtualized:this.props.isVirtualized,componentInstanceId:this.props.componentInstanceId,correlationId:this.props.correlationId,lppManager:this.props.lppManager,accessibilityMetadata:this.props.accessibilityMetadata},c)));return rm.createElement(ey.Provider,{value:this.createTelemetryContext(this.props.telemetryVisitor)},u)},t}(rm.PureComponent)});var FCe={};Ey(FCe,{HostableCommentCardRendererContainer:()=>pHe,makeMapStateToProps:()=>wCe});var wCe,pHe,OCe=f(()=>{"use strict";s();ne();te();Eo();Ts();St();Qp();E1();Ve();DCe();wCe=function(){var t=n0(),r=r0(),n=o0(function(l){return uo(l,!0)},function(l){return KC(l,!0)},t,r),o=t0(),a=uq(),d=aq(n,o),c=sq(d),u=function(p,g){var h,v=n(p,g),y=v.thread.length?v.thread[0].commentId:(h=g.resource)===null||h===void 0?void 0:h.id,T=g.componentTree.componentTreeId.renderContextType,b=void 0;switch(T){case A.FullPane:b={renderMode:de.TaskPaneItem};break;case A.DiscreteIntegrated:b={renderMode:de.Integrated};break;case A.DiscreteIsolated:y&&(b={renderMode:de.Isolated,threadId:y});break;case A.HalfPane:case A.None:x().assertConditionTag(!1,"Invalid RenderContextType for HostableComponent received.",593822914);break;default:Me(T)}var I=Ege(p,b);return{isResourceAvailable:c(p,g),modelCapabilities:Lr(p),isDraftThread:a(p,g),isExtensionEnabled:I,threadId:y}};return u},pHe=ea(wCe)(kCe)});s();ne();Zl();te();Pt();var ave=S(Kr()),sve=S(u5()),o4=S(re());s();ne();rt();te();var P5=S(Et());Jt();vs();fd();s();var I5={CommentAPIServiceModule:["Mso::Document::Comments::JS::CommentAPIServiceModule",{dispatchInterruptableCommand:["ReturnsPromiseMethod","$number",["$string",["$union",["Mso::Document::Comments::JS::DiscardDraftCommand","Mso::Document::Comments::JS::CreateCommentCommand","Mso::Document::Comments::JS::EditCommentCommand","Mso::Document::Comments::JS::ReplyCommentCommand","Mso::Document::Comments::JS::BringThreadIntoViewCommand"]]]]}]};s();var E5=S(Et());E5.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::DiscardDraftCommand":{type:"$string",mode:"$number"},"Mso::Document::Comments::JS::CreateCommentCommand":{type:"$string"},"Mso::Document::Comments::JS::EditCommentCommand":{type:"$string",commentId:"$string"},"Mso::Document::Comments::JS::ReplyCommentCommand":{type:"$string",threadId:"$string"},"Mso::Document::Comments::JS::BringThreadIntoViewCommand":{type:"$string",threadId:"$string"}});var Wy=function(){function e(){this.commandCallbacks={},this.queuedInterruptableCommands={}}return e.getInstance=function(){return this.instance},e.register=function(){var t=this;if(this.instance)throw x().assertConditionTag(!1,"Already registered an instance of CommentAPIServiceModule",593000201),new ge(p5,C.reserveTag(589103751),-2130957534);this.instance=new e,P5.RekaServiceRegistry.registerService({serviceInfo:this.ServiceInfo,factory:function(){return t.instance}})},e.prototype.registerForInterruptableCommands=function(t,r){this.commandCallbacks[t]&&x().assertConditionTag(!1,"DuplicateHandlerRegistration for InterruptableCommands",593000202),this.commandCallbacks[t]=r;var n=this.queuedInterruptableCommands[t];n&&n.forEach(function(o){r(o.command).then(function(a){return o.promiseValue.resolve(a)},function(){x().assertConditionTag(!1,"Failed to run queued interruptable command",570991756),o.promiseValue.resolve(He.Failed)})}),delete this.queuedInterruptableCommands[t]},e.prototype.unregisterForInterruptableCommands=function(t,r){this.commandCallbacks[t]&&this.commandCallbacks[t]===r?delete this.commandCallbacks[t]:x().assertConditionTag(!1,"Cannot unregister for a command callback that wasn't already registered",593000203)},e.prototype.dispatchInterruptableCommand=function(t,r){var n=this.commandCallbacks[t];if(n)return n(r);this.queuedInterruptableCommands[t]||(this.queuedInterruptableCommands[t]=[]);var o=new qT;return this.queuedInterruptableCommands[t].push({command:r,promiseValue:o}),o.promise},e.ServiceInfo=I5.CommentAPIServiceModule,e}();xb();s();s();k();rt();s();te();Pr();s();hm();var F5={themeId:1,palette:{ButtonBorder:ke.GRAY_D,CardAccent:ke.GRAY_B,CardBackground:ke.WHITE,CardHoveredBackground:ke.GRAY_20,CardDraftBoxBackgroundHovered:ke.WHITE,CardDraftBoxBorderHovered:ke.GRAY_160,CardDraftBoxBorder:ke.GRAY_110,CardDraftBoxBackground_HalfPane:ke.WHITE,CardDraftBoxBackground:ke.WHITE,CardExpandButtonBorder:ke.GRAY_B,CardHeroBarBackground_HalfPane:ke.WHITE,CardHeroBarBackground:ke.GRAY_A,CardReplyBackground_HalfPane:ke.GRAY_A,CardReplyBackground:ke.GRAY_A,CardReplyTopBorder:ke.GRAY_B,CardSelectionColor:ke.COMMENTS_PURPLE,CardShadowColor:ke.BLACK,CardBorder:ke.GRAY_B,CardBorderEmphasis:ke.COMMENTS_PURPLE,CommandBarBorder:ke.GRAY_B,CommandBarTopBorder:ke.GRAY_B,IconButtonDisabledTint:ke.GRAY_C,IconButtonFocusedTint:ke.GRAY_I,NavigationBarBackground:ke.WHITE,NavigationBarBorder:ke.GRAY_B,PaneBackground_HalfPane:ke.WHITE,PaneBackground:"transparent",UnreadDotColor:ke.DOT_BLUE,UnreadDotBorderColor:ke.WHITE,ExpandButtonHoverBackground:"transparent",ExpandButtonBackground:"transparent",FocusBorderColor:ke.GRAY_150,CardPlaceholderColor:ke.GRAY_130,ResolvedCardBackground:ke.GRAY_20}};function O5(e){return{themeId:e.themeId,palette:new Proxy(F5.palette,{get:function(r,n){return e.palette[n]?e.palette[n]:(x().assertConditionTag(Q()==="android","Theme-aware platform using unthemed color ".concat(String(n)),595338514),r[n])}})}}s();var bb=S(Et());bb.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::Swatch":{color:"$string",value:"$string"},"Mso::Document::Comments::JS::Palette":{values:["$array","Mso::Document::Comments::JS::Swatch"]},"Mso::Document::Comments::JS::ThemeInformation":{themeId:"$number",palette:"Mso::Document::Comments::JS::Palette"}});var Uve={ThemeModule:["Mso::Document::Comments::JS::ThemeModule",{onThemeChange:["Event","Mso::Document::Comments::JS::ThemeInformation"],initialThemeInformation:["Constant","Mso::Document::Comments::JS::ThemeInformation"]}]},N5={ThemeModule:bb.RekaServiceRegistry.getNativeService(Uve.ThemeModule)};var Vve=function(t){return KT(t.values.map(function(r){return[r.color,r.value]}))},M5=function(t){return O5({themeId:t.themeId,palette:Vve(t.palette)})},L5=function(){function e(t){t===void 0&&(t=N5.ThemeModule),this.themeModule=t,this.listeners=new Set,this.onThemeChange=this.onThemeChange.bind(this),this.currentTheme=M5(this.themeModule.initialThemeInformation),this.themeModule.onThemeChange.subscribe(this.onThemeChange)}return e.prototype.getTheme=function(){return this.currentTheme},e.prototype.registerForThemeChange=function(t){this.listeners.add(t)},e.prototype.unregisterForThemeChange=function(t){this.listeners.delete(t)},e.prototype.onThemeChange=function(t){var r,n;this.currentTheme=M5(t);try{for(var o=$e(this.listeners),a=o.next();!a.done;a=o.next()){var d=a.value;d()}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},e}();var ED;function Sb(){return ED||(ED=new L5),ED}s();ym();var AD=S(of());function j5(){Ib({announceToScreenReader:function(t,r){var n;t&&(r&&r.nativeId?AD.AccessibilityInfo.announceForAccessibilityWithOptions(t,{queue:(n=r.queue)!==null&&n!==void 0?n:void 0,nativeID:r.nativeId}):AD.AccessibilityInfo.announceForAccessibility(t))}})}Pr();yc();s();k();rt();Eo();var mu=S(L());Ts();s();Eu();te();var N6=S(Et());s();var Xe;(function(e){e.CreateThread="CreateThread",e.CancelCreateThread="CancelCreateThread",e.StartReplySession="StartReplySession",e.CancelReplySession="CancelReplySession",e.PostReply="PostReply",e.DeleteComment="DeleteComment",e.DeleteThread="DeleteThread",e.ResolveThread="ResolveThread",e.ReopenThread="ReopenThread",e.StartEditSession="StartEditSession",e.CancelEditSession="CancelEditSession",e.PostEdit="PostEdit",e.SelectComment="SelectComment",e.ClosePane="ClosePane",e.ClickGhostCard="ClickGhostCard"})(Xe||(Xe={}));function D6(e){return e.actionType!==void 0}function Yb(e){return e.actionType===Xe.CreateThread&&e.content!==void 0}function $b(e){return e.actionType===Xe.CancelCreateThread}function Qb(e){return e.actionType===Xe.StartReplySession&&e.threadId!==void 0}function Xb(e){return e.actionType===Xe.CancelReplySession&&e.threadId!==void 0}function Jb(e){return e.actionType===Xe.PostReply&&e.threadId!==void 0&&e.content!==void 0}function Zb(e){return e.actionType===Xe.DeleteComment&&e.commentId!==void 0}function eS(e){return e.actionType===Xe.DeleteThread&&e.threadId!==void 0}function tS(e){return e.actionType===Xe.ResolveThread&&e.threadId!==void 0}function rS(e){return e.actionType===Xe.ReopenThread&&e.threadId!==void 0}function nS(e){return e.actionType===Xe.StartEditSession&&e.commentId!==void 0}function oS(e){return e.actionType===Xe.CancelEditSession&&e.commentId!==void 0}function iS(e){return e.actionType===Xe.PostEdit&&e.commentId!==void 0&&e.content!==void 0}function aS(e){return e.actionType===Xe.SelectComment&&e.commentId!==void 0}function w6(e){return e.actionType===Xe.ClosePane}function sS(e){return e.actionType===Xe.ClickGhostCard}s();var dS=S(Et());dS.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::MockUIDriverEventPayload":{apiContext:"$string",payload:"$string"}});var Xxe={MockUIDriverModule:["Mso::Document::Comments::JS::MockUIDriverModule",{sendTrace:["FireAndForgetMethod",["$string","$string"]],onMockUIEvent:["Event","Mso::Document::Comments::JS::MockUIDriverEventPayload"]}]},O6={MockUIDriverModule:dS.RekaServiceRegistry.getNativeService(Xxe.MockUIDriverModule)};var Jxe=function(){function e(t){this.onMockUIAction=new N6.EventImpl(function(){}),this.onMockUIEvent=this.onMockUIEvent.bind(this),O6.MockUIDriverModule.onMockUIEvent.subscribe(md(t,this.onMockUIEvent))}return e.prototype.onMockUIEvent=function(t){var r=JSON.parse(t.payload).payload;D6(r)?this.onMockUIAction.trigger(r):x().assertConditionTag(!1,"Malformed event: ".concat(t.payload),593376714)},e}(),Jy=Jxe;Na();dk();ng();Fd();c3();dn();gk();IA();s();k();var dc=S(L()),fhe=S(re());mr();gn();je();s();k();Eu();ne();rt();te();Ts();fd();ZC();dk();Uf();Um();bB();pv();Jt();ye();an();vl();yt();bn();s();var ms=function(){function e(t,r){this.mockId="",this.mockContents="",this.getContentsAsync=this.getContentsAsync.bind(this),this.getId=this.getId.bind(this),this.getCursorPositionAsync=this.getCursorPositionAsync.bind(this),t&&(this.mockId=t),r&&(this.mockContents=r)}return e.prototype.getId=function(){return this.mockId},e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e}();s();var Xp=function(){function e(t){this.mockContents="",this.mockId="",t&&(this.mockId=t)}return e.prototype.getContentsAsync=function(){return Promise.resolve(this.mockContents)},e.prototype.getCursorPositionAsync=function(){return Promise.resolve(void 0)},e.prototype.setContents=function(t){this.mockContents=t},e.prototype.getId=function(){return this.mockId},e}();s();var Le;(function(e){e[e.None=0]="None",e[e.NeedDrafting=1]="NeedDrafting",e[e.NeedNotDrafting=2]="NeedNotDrafting"})(Le||(Le={}));var wNe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return n.pendingActionReason=Le.None,n.pendingAction=void 0,n.onMockUIAction=new sm(function(o){if(!qt()){if(n.pendingAction){x().assertConditionTag(!1,"Action is already pending",592229779);return}switch(o.actionType){case Xe.CancelCreateThread:$b(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onCancel(new ms(n.getDraftCardId()))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229780);break;case Xe.CancelEditSession:oS(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentPostCallbackProps.onCancel(new Xp(o.commentId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229781);break;case Xe.CancelReplySession:Xb(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onCancel(new ms(o.threadId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229782);break;case Xe.ClickGhostCard:sS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.onGhostCommentClicked()}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229783);break;case Xe.ClosePane:w6(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.closePane()}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229784);break;case Xe.CreateThread:Yb(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onPost(new ms(n.getDraftCardId(),o.content),qn.CommitButton)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229785);break;case Xe.DeleteComment:Zb(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.commentPostCallbackProps.onDelete(o.commentId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229786);break;case Xe.DeleteThread:eS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.cardContextualMenuCallbackProps.onDeleteThread(o.threadId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229787);break;case Xe.PostEdit:if(iS(o)){var a=new Xp(o.commentId);a.setContents(o.content),n.runAction(o,Le.NeedDrafting,function(){return n.commentPostCallbackProps.onCommit(a,qn.CommitButton)})}else x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229788);break;case Xe.PostReply:Jb(o)?n.runAction(o,Le.NeedDrafting,function(){return n.commentCardCallbackProps.onPost(new ms(o.threadId,o.content),qn.CommitButton)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229789);break;case Xe.ReopenThread:rS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.cardContextualMenuCallbackProps.onReopenThread(o.threadId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229790);break;case Xe.ResolveThread:tS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.cardContextualMenuCallbackProps.onResolveThread(o.threadId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229791);break;case Xe.SelectComment:aS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.onRenderableItemSelect(new Xp(o.commentId),!1)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229792);break;case Xe.StartEditSession:nS(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.commentPostCallbackProps.onEdit(o.commentId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229793);break;case Xe.StartReplySession:Qb(o)?n.runAction(o,Le.NeedNotDrafting,function(){return n.commentCardCallbackProps.onEditorPress(new ms(o.threadId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592229794);break;default:Me(o.actionType)}}}),n.onCardLayout=void 0,n.state=m({actionHistory:[]},n.getInitialState(r)),n}return t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.registrationToken=this.props.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),this.props.pendingCommentLoad===void 0&&this.onMockUIAction.startProcessing()},t.prototype.componentWillUnmount=function(){var r;e.prototype.componentWillUnmount.call(this),(r=this.registrationToken)===null||r===void 0||r.unsubscribe()},t.prototype.componentDidUpdate=function(r,n){e.prototype.componentDidUpdate.call(this,r,n),!this.onMockUIAction.isProcessingEvents&&!this.props.pendingCommentLoad&&this.onMockUIAction.startProcessing();var o=fr(this.props.draftState);!o&&this.pendingActionReason===Le.NeedNotDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=Le.None);var a=Wo(this.props.draftState),d=Wo(r.draftState);a&&!d&&this.pendingActionReason===Le.NeedDrafting&&this.pendingAction&&(this.pendingAction(),this.pendingAction=void 0,this.pendingActionReason=Le.None)},t.prototype.onDrafting=function(r){Wo(this.props.draftState)?r():(this.pendingAction=r,this.pendingActionReason=Le.NeedDrafting)},t.prototype.onNotDrafting=function(r){fr(this.props.draftState)?(this.pendingAction=r,this.pendingActionReason=Le.NeedNotDrafting):r()},t.prototype.runAction=function(r,n,o){var a=this,d={action:r,pendingState:n};this.setState({actionHistory:w(w([],V(this.state.actionHistory),!1),[d],!1)},function(){var c=function(){o();var l=a.state.actionHistory.indexOf(d);if(l<0)x().assertConditionTag(!1,"Entry doesnt exist in history",592229778);else{var p=a.state.actionHistory.slice();p.splice(l,1,{action:p[l].action,pendingState:Le.None}),a.setState({actionHistory:p})}};switch(n){case Le.NeedDrafting:return a.onDrafting(c);case Le.NeedNotDrafting:return a.onNotDrafting(c);case Le.None:return o()}})},t.prototype.getDraftCardId=function(){var r=Ka(this.props.draftState);if(!r)throw new ge("Expected draft card",C.reserveTag(572846421),-2130957492);return r},t.prototype.render=function(){return this.renderInner()},t.prototype.getMentionableCommentEditorProps=function(r,n){},t.prototype.onContextChanged=function(){this.props.initializationStatus===Wn.NotInitialized&&this.props.initializeView(this.props.componentTree.componentTreeId.renderContextType)},t.prototype.invokeModalDialog=function(r,n,o){var a={renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:Qk,telemetryVisitor:this.props.telemetryVisitor};switch(r){case ur.CancelNewDraft:case ur.CancelReplyDraft:case ur.CancelPostEdit:return this.props.discardDraftAsync(a,le.SharedComments,!1);case ur.DeleteThread:return this.props.selectedComment&&this.props.requestDeleteThread(a,this.props.selectedComment.selectedCardId),Promise.resolve(He.Handled);case ur.ClosePaneDraft:return this.closePane(),Promise.resolve(He.Handled);default:Me(r)}},t.prototype.getCreateCommentInitialHeight=function(){return 0},t.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:Bi.AllCardsTabbable,postTabbingMode:Ui.AllPostsTabbable}},t.prototype.showDiscardDialog=function(){return Promise.resolve(!1)},t.prototype.isNewCommentButtonDisabled=function(){return!1},t.prototype.getContentsPreventDefaultKeyDownBehavior=function(){},t.prototype.getContentExtraPaddingLeft=function(){},t.prototype.getContentExtraPaddingRight=function(){},t.prototype.getAvailableScreenHeight=function(){},t.prototype.getMaxDraftHeight=function(){},t.prototype.getContentBackgroundColor=function(r,n){},t.prototype.getCommentCardStyle=function(){},t.prototype.getPinnedCardIndex_deprecated=function(){},t.prototype.scrollToThreadById=function(r){return!1},t}(Kp),uhe=wNe,u3={focus:function(){},blur:function(){}},FNe=function(t){return{isFocusOn:function(){return!1},isFocusWithin:function(){return!1},isFocusOnOrWithin:function(){return!1},isEventTarget:function(){return!1},isFocusWithinAny:function(){return!1},isFocusWithinPane:function(){return!1},getComponent:function(){return u3},getComponentById:function(){return u3},getCurrentlyFocused:function(){return[u3]},componentTreeId:{renderContextType:t,contextIdentifier:pd}}};function ONe(){var e=jB();return function(t){var r=e(t);return r.componentTree=FNe(t.paneState.componentTree.componentTreeId.renderContextType),r}}var lhe=ea(ONe,ol,void 0,{forwardRef:!0});var NNe=function(e){Z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.renderActionHistory=function(){return this.state.actionHistory.length===0?dc.createElement(qe,null,"No Actions Received"):this.state.actionHistory.map(function(r,n){return dc.createElement(ee,{key:n,style:vr},dc.createElement(qe,null,"Action: ",r.action.actionType),dc.createElement(qe,null,r.pendingState===Le.None?"Done":"Pending: ".concat(Le[r.pendingState])))})},t.prototype.renderInner=function(){return dc.createElement(ee,{testID:"MockCommentPaneRoot",style:vr},dc.createElement(qe,null,"MockCommentPane"),dc.createElement(qe,null,"Items: ",this.props.dataItems.length),dc.createElement(qe,null,"History"),dc.createElement(fhe.ScrollView,{style:vr},this.renderActionHistory()))},t}(uhe),MNe=lhe(NNe),phe=MNe;ye();s();Sd();ne();te();wd();s();s();var hk=S(Et());hk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::CodeMarkerPayload":{context:"$string",type:"$number",assertTag:"$number"},"Mso::Document::Comments::JS::StartEventPayload":{context:"$string",correlationId:"$string",useMockMode:"$boolean"},"Mso::Document::Comments::JS::StopEventPayload":{context:"$string"}});var LNe={APIContextEventService:["Mso::Document::Comments::JS::APIContextEventService",{sendCodeMarker:["FireAndForgetMethod",["Mso::Document::Comments::JS::CodeMarkerPayload"]],onStartEvent:["Event","Mso::Document::Comments::JS::StartEventPayload"],onStopEvent:["Event","Mso::Document::Comments::JS::StopEventPayload"]}]},mhe={APIContextEventService:hk.RekaServiceRegistry.getNativeService(LNe.APIContextEventService)};s();s();var vy;(function(e){e[e.Invalid=0]="Invalid",e[e.DataReceived=1]="DataReceived"})(vy||(vy={}));var wT=mhe.APIContextEventService;Aw();Na();ng();Jt();ye();var HNe=function(){function e(t,r){var n=this;this.commentViewManager=t,this.correlationId=r,this.visit=function(o){o.attachContext(n.commentViewManager.apiContext),n.correlationId&&o.addDataField("InstanceCorrelationId",n.correlationId,N.SystemMetadata)}}return e}();function ghe(e){return new HNe(hhe(e),e.correlationId)}var BNe=function(){throw new Error("ViewManagerFactory not set")},hhe=BNe;function yhe(e){hhe=e}var UNe=function(){function e(){this.instanceMap=new Map,this.initialized=!1}return e.prototype.getTelemetryVisitor=function(t){var r=this;return this.instanceMap.get(t)||{visit:function(o){var a=r.instanceMap.get(t);if(!a){o.attachContext(t),o.addDataField("MissingInstanceTelemetry",!0,N.SystemMetadata);return}a.visit(o)}}},e.prototype.closeViewManager=function(t){var r=this.instanceMap.get(t);r&&(r.commentViewManager.teardown(),this.instanceMap.delete(t))},e.prototype.disposeViewManager=function(){var t=this;this.instanceMap.forEach(function(r,n){Bf(n),t.closeViewManager(n)})},e.prototype.doesViewManagerExist=function(t){return this.instanceMap.has(t)},e.prototype.ensureViewManager=function(t){var r=t.apiContext,n=t.displayMode,o=t.contentNavigationAPIMockSettings,a=t.contentFilteredRangeHostAPIMockSettings;this.initialized||this.ensureInitialized();var d=this.instanceMap.get(r);return d?this.updateInstanceObject(d,n):(this.initializeContentNavigationAPI(r,o),this.initializeContentFilteredRangeAPI(r,a),d=ghe(t),this.instanceMap.set(r,d)),d.commentViewManager},e.prototype.getCorrelationId=function(t){var r=this.instanceMap.get(t);return r&&r.correlationId},e.prototype.getStore=function(t){var r=this.instanceMap.get(t);if(!r)throw new ge("Instance is not initialized",C.reserveTag(589103622),-2130957512);return r.commentViewManager.getCommentStore()},e.prototype.getViewManager=function(t){var r=this.tryGetViewManager(t);if(!r)throw new ge("Instance is not initialized",C.reserveTag(589103623),-2130957512);return r},e.prototype.tryGetViewManager=function(t){var r;return(r=this.instanceMap.get(t))===null||r===void 0?void 0:r.commentViewManager},e.prototype.ensureInitialized=function(){var t=this;ki()&&wT.onStartEvent.subscribe(function(r){t.initializeContentNavigationAPI(r.context,void 0),t.initializeContentFilteredRangeAPI(r.context,void 0),t.initializeViewManager(r.context,r.correlationId,r.useMockMode)}),wT.onStopEvent.subscribe(function(r){t.closeViewManager(r.context),Bf(r.context)}),this.initialized=!0},e.prototype.initializeViewManager=function(t,r,n){var o=this.instanceMap.get(t);if(o)o.correlationId=r;else{var a=void 0;n&&qt()&&(x().createActivityObject("OnMockUIDriverCreated",this.getTelemetryVisitor(t),{diagnosticLevel:Hn.FullEvent}).successTag(592511450),a=new Jy(t)),this.instanceMap.set(t,ghe({apiContext:t,correlationId:r,initializationReason:Ns.PaneOpen,displayMode:on.FullPane,foldableLayoutState:Ps.Indeterminate,paneVisible:!1,initializeImmediately:!0,mockDriver:a}))}},e.prototype.updateInstanceObject=function(t,r){var n=t.commentViewManager.viewProvider;n.getViewContainer().containerType!==r&&n.changeViewContainerType(r)},e.prototype.initializeContentNavigationAPI=function(t,r){if(!al(t)){if(r){r.useMock&&Hf(r.mock,t);return}var n=new ig(t);n.isAPIEnabled()&&Hf(n,t)}},e.prototype.initializeContentFilteredRangeAPI=function(t,r){if(!Lm(t)){if(r){r.useMock&&PC(t,r.mock);return}PC(t,new EC(t))}},e}(),VNe=new UNe,Cn=VNe;var jNe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;n.createTelemetryContext=Qe(SA);var o=r.initializationReason||Ns.PaneOpen,a=Cn.tryGetViewManager(r.apiContext);if(!a){var d=r.useMockCommentPane&&qt();a=Cn.ensureViewManager({apiContext:r.apiContext,displayMode:r.displayMode||on.FullPane,foldableLayoutState:r.foldableLayoutState,initializationReason:o,correlationId:r.correlationId,paneVisible:o!==Ns.InitRuntime,initializeImmediately:!0,mockDriver:d?new Jy(r.apiContext):void 0})}return n._containerProps={commentAPI:a.commentAPI,peopleAPI:a.peopleAPI,localizationAPI:a.localizationAPI,focusManager:a.getFocusManager(),selectionManager:a.getSelectionManager(),initializationReason:a.getInitializationReason(),registerComponentUIActionListener:a.registerComponentUIActionListener,unregisterComponentUIActionListener:a.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:a.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:a.unregisterComponentInterruptableCommandListener,resource:{id:"CommentPane"},telemetryVisitor:Cn.getTelemetryVisitor(n.props.apiContext),correlationId:Cn.getCorrelationId(n.props.apiContext)||Zn(),lppManager:a.lppManager,createOrUpdateFilter:a.createOrUpdateFilter,onInitialRender:Mn(a.onInitialRender)},MK(bz(r.displayClass)),n.props.useMockCommentPane&&(n._mockUIDriver_deprecated=new Jy(n.props.apiContext)),n}return t.prototype.componentWillUnmount=function(){ki()||Cn.closeViewManager(this.props.apiContext)},t.prototype.render=function(){var r=Cn.getStore(this.props.apiContext),n;!qt()&&this._mockUIDriver_deprecated?n=mu.createElement(phe,m({},this._containerProps,{mockUIDriver:this._mockUIDriver_deprecated})):qt()?n=mu.createElement(d3,m({},this._containerProps,{extensionRenderMode:de.Integrated,themeAPI:Cn.getViewManager(this.props.apiContext).themeAPI})):n=mu.createElement(WB,m({},this._containerProps));var o=n;return qt()||(o=mu.createElement(yy,{api:Cn.getViewManager(this.props.apiContext).themeAPI},n)),mu.createElement(sf,{store:r},mu.createElement(ey.Provider,{value:this.createTelemetryContext(Cn.getTelemetryVisitor(this.props.apiContext))},o))},t}(mu.Component),Che=jNe;ye();s();JF();var vhe={name:"OfficeSharedComments",version:TE};s();Sd();wd();s();k();ne();rt();Jt();ye();ln();s();k();ne();Jt();vs();ye();Pu();_w();var xhe=function(){function e(t,r,n,o,a){var d=this;this.hostCommentAPI=t,this.author=r,this._anchorHintText=n,this.sessionConfiguration=o,this._insertIndex=a,this._active=!0,this._propertiesToUpdate={},this.updateDraft=function(c){c.draftId===d.sessionConfiguration.draftId&&(c.anchorHintText&&(d._anchorHintText=c.anchorHintText),c.insertIndex!==void 0&&(d._insertIndex=c.insertIndex))},this.handleCommentEvents=function(c,u){c===Fe.CommentContextChanged&&Ss(u)&&u.contextDrafts?u.contextDrafts.forEach(function(l){return d.updateDraft(l)}):c===Fe.UpdateDraftThread&&pf(u)&&d.updateDraft(u)},this.hostCommentAPI.registerForCommentEvents(this.handleCommentEvents)}return Object.defineProperty(e.prototype,"active",{get:function(){return this._active},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchorHintText",{get:function(){return this._anchorHintText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"insertIndex",{get:function(){return this._insertIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propertiesToUpdate",{get:function(){return this._propertiesToUpdate},enumerable:!1,configurable:!0}),e.prototype.updateProperties=function(t,r){this._propertiesToUpdate[t]=m({},r)},e.prototype.commit=function(t){if(!this.hostCommentAPI.commit)throw new ge(y5,C.reserveTag(589103689),-2130957526);if(!this._active)throw new ge(b5,C.reserveTag(589103690),-2130957525);var r=at()||no(),n=r&&this.sessionConfiguration.sessionType===bc;if(t===void 0&&!n||n&&t!==void 0)throw new ge(ld,C.reserveTag(589103691),-2130957507);return r?this.hostCommentAPI.commit(this.sessionConfiguration.draftId,t,this._propertiesToUpdate):this.hostCommentAPI.commit(this.sessionConfiguration.draftId,t)},e.prototype.endDrafting=function(){this._active=!1,this.hostCommentAPI.unregisterForCommentEvents(this.handleCommentEvents),this.hostCommentAPI.endCommentSession(this.sessionConfiguration.draftId)},e}();var yk=function(){function e(t){this.hostCommentAPI=t,this.loadThreads=t.loadThreads.bind(t),this.deleteComment=t.deleteComment.bind(t),this.selectComment=t.selectComment.bind(t),this.highlightComment=t.highlightComment.bind(t),this.setThreadResolvedState=t.setThreadResolvedState.bind(t),this.selectFirstThreadInNextCommentContext=t.selectFirstThreadInNextCommentContext.bind(t),this.selectLastThreadInPreviousCommentContext=t.selectLastThreadInPreviousCommentContext.bind(t),this.registerForCommentEvents=t.registerForCommentEvents.bind(t),this.unregisterForCommentEvents=t.unregisterForCommentEvents.bind(t),this.registerForAction=t.registerForAction.bind(t),this.unregisterForAction=t.unregisterForAction.bind(t),this.checkAtMentionCapability=t.checkAtMentionCapability.bind(t),t.getCommentReactionData&&(this.getCommentReactionData=t.getCommentReactionData.bind(t)),nC()&&(this.presentLinkToComment=t.presentLinkToComment.bind(t)),t.registerForInterruptableCommands&&(this.registerForInterruptableCommands=t.registerForInterruptableCommands.bind(t)),t.unregisterForInterruptableCommands&&(this.unregisterForInterruptableCommands=t.unregisterForInterruptableCommands.bind(t)),t.onClickableTextClicked&&(this.onClickableTextClicked=t.onClickableTextClicked.bind(t))}return e.prototype.beginDraftingAsync=function(t){var r=this;if(!this.hostCommentAPI.beginDraftingAsync||!this.hostCommentAPI.commit)throw new ge("Drafting APIs are undefined on Host Comment API",C.reserveTag(589103700),-2130957527);var n=Zn(),o=m(m({},t),{draftId:n});return this.hostCommentAPI.beginDraftingAsync(o).then(function(a){var d=new xhe(r.hostCommentAPI,oj(a),a.anchorHintText,a.updatedDraftSessionConfiguration||o,a.insertIndex);return d})},e}();s();s();k();Eu();ne();rt();te();Jt();s();function WNe(e){switch(e){case-2130958286:return"Missing CommentsModelContext";default:return""}}function The(e){if(typeof e=="string")try{var t=JSON.parse(e);if(!(t instanceof Array)||t.length!==1)return;var r=parseInt(t[0]);return isNaN(r)?void 0:{message:WNe(r),SDXHostAPIErrorCode:r,name:""}}catch(n){return}}ye();si();s();var Ck=S(Et());Ck.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::SetThreadResolvedStateArgs":{threadId:"$string",isResolved:"$boolean"},"Mso::Document::Comments::JS::InitializeResult":{modelCapabilityFlags:"$number",richTextCapabilityFlags:"$number"},"Mso::Document::Comments::JS::CommitDraftArgs":{draftId:"$string",commentBody:["$optional","$string"],propertyUpdates:["opt-field","Mso::Document::Tasks::JS::HostUpdatableProperties"]}});var zNe={CommentAPI:["Mso::Document::Comments::JS::CommentAPI",{initialize:["ReturnsPromiseMethod","Mso::Document::Comments::JS::InitializeResult",["$string"]],beginDraftingAsync:["ReturnsPromiseMethod","Mso::Document::Comments::JS::BeginDraftingHostResult",["$string",["$union",["Mso::Document::Comments::JS::CreateDraftSessionConfiguration","Mso::Document::Comments::JS::ReplyDraftSessionConfiguration","Mso::Document::Comments::JS::EditDraftSessionConfiguration","Mso::Document::Comments::JS::UpdateMetadataSessionConfiguration"]]]],commit:["FireAndForgetMethod",["$string","Mso::Document::Comments::JS::CommitDraftArgs"]],endCommentSession:["FireAndForgetMethod",["$string","$string"]],loadThreads:["FireAndForgetMethod",["$string",["$array","$string"]]],deleteComment:["FireAndForgetMethod",["$string","$string"]],selectComment:["FireAndForgetMethod",["$string","$string"]],highlightComment:["FireAndForgetMethod",["$string","$string"]],setThreadResolvedState:["FireAndForgetMethod",["$string","Mso::Document::Comments::JS::SetThreadResolvedStateArgs"]],selectFirstThreadInNextCommentContext:["FireAndForgetMethod",["$string"]],selectLastThreadInPreviousCommentContext:["FireAndForgetMethod",["$string"]],checkAtMentionCapability:["ReturnsPromiseMethod","$boolean",["$string"]],presentLinkToComment:["FireAndForgetMethod",["$string","$string"]],getCommentReactionData:["ReturnsPromiseMethod",["$array","Mso::Document::Comments::JS::CommentReactionData"],["$string","$string","$number"]],onNativeEvent:["Event","Mso::Document::Comments::JS::CommentModelEvent"],onUIAction:["Event","$number"],onModelEvent:["Event","Mso::Document::Comments::JS::CommentModelEvent"],onError:["Event","$number"]}]},Ho={CommentAPI:Ck.RekaServiceRegistry.getNativeService(zNe.CommentAPI)};function GNe(e){if(e){var t=e.Resolve,r=e.Task?{type:"Task",assignee:e.Task.assignee,updatedState:{title:e.Task.title,schedule:e.Task.schedule,priority:e.Task.priority,completion:e.Task.completion}}:void 0,n=e.Reaction?{type:"Reaction",reactionType:e.Reaction.reactionType,isActive:e.Reaction.isActive}:void 0;return{Resolve:t,Task:r,Reaction:n}}}var She=function(){function e(t,r){var n=this;if(this.observer=t,this.apiContext=r,!Ho.CommentAPI)throw new ge("CommentAPI unavailable",C.reserveTag(589103701),-2130957557);Ho.CommentAPI.initialize(this.apiContext).then(function(o){var a,d,c={modelCapabilityFlags:o.modelCapabilityFlags,richTextCapabilityFlags:o.richTextCapabilityFlags};n.observer.onEvent.invoke(Fe.ModelCapabilitiesChanged,c),n.observer.enableEvents(),(d=(a=x()).logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(bhe||(bhe=zt(["CommentsInitialized"],["CommentsInitialized"]))),C.reserveTag(529105745),xt.Info,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary))}).catch(function(o){if(Ri(o))x().assertConditionTag(!1,o.message,591209547);else{var a=The(o);if(a&&a.SDXHostAPIErrorCode===-2130958286)return;x().assertConditionTag(!1,"Unknown error in CommentAPIModuleImpl constructor ".concat(a),591209548)}})}return e.prototype.beginDraftingAsync=function(t){return Ho.CommentAPI.beginDraftingAsync(this.apiContext,t)},e.prototype.commit=function(t,r,n){return Ho.CommentAPI.commit(this.apiContext,{draftId:t,commentBody:r,propertyUpdates:at()||no()?GNe(n):void 0}),t},e.prototype.endCommentSession=function(t){Ho.CommentAPI.endCommentSession(this.apiContext,t)},e.prototype.loadThreads=function(t){Ho.CommentAPI.loadThreads(this.apiContext,t)},e.prototype.deleteComment=function(t){Ho.CommentAPI.deleteComment(this.apiContext,t)},e.prototype.selectComment=function(t){Ho.CommentAPI.selectComment(this.apiContext,t)},e.prototype.highlightComment=function(t){Ho.CommentAPI.highlightComment(this.apiContext,t)},e.prototype.setThreadResolvedState=function(t,r){Ho.CommentAPI.setThreadResolvedState(this.apiContext,{threadId:t,isResolved:r})},e.prototype.selectFirstThreadInNextCommentContext=function(){Ho.CommentAPI.selectFirstThreadInNextCommentContext(this.apiContext)},e.prototype.selectLastThreadInPreviousCommentContext=function(){Ho.CommentAPI.selectLastThreadInPreviousCommentContext(this.apiContext)},e.prototype.checkAtMentionCapability=function(){return Ho.CommentAPI.checkAtMentionCapability(this.apiContext)},e.prototype.presentLinkToComment=function(t){Ho.CommentAPI.presentLinkToComment(this.apiContext,t)},e.prototype.onClickableTextClicked=function(t){x().assertConditionTag(!1,"onClickableTextClicked is not implemented for native",509658816)},e.prototype.getCommentReactionData=function(t,r){return Ho.CommentAPI.getCommentReactionData(this.apiContext,t,r)},e.prototype.registerForCommentEvents=function(t){this.ensureEmitterRegistered(),this.observer.onEvent.add(t)},e.prototype.unregisterForCommentEvents=function(t){this.observer.onEvent.remove(t)},e.prototype.registerForAction=function(t,r){this.ensureEmitterRegistered(),this.observer.onAction.add(t,r)},e.prototype.unregisterForAction=function(t){this.observer.onAction.removeAll(t)},e.prototype.registerForInterruptableCommands=function(t){var r=Wy.getInstance();r?r.registerForInterruptableCommands(this.apiContext,t):x().assertConditionTag(!1,"CommentAPIServiceModule instance not initialized",591209549)},e.prototype.unregisterForInterruptableCommands=function(t){var r=Wy.getInstance();r?r.unregisterForInterruptableCommands(this.apiContext,t):x().assertConditionTag(!1,"CommentAPIServiceModule instance not initialized",591209550)},e.prototype.ensureEmitterRegistered=function(){this.eventSubscription===void 0&&(this.eventSubscription=Ho.CommentAPI.onNativeEvent.subscribe(md(this.apiContext,this.observer.processEvent)))},e}();var bhe;s();te();s();s();k();var FT=function(){function e(){this._listeners=[]}return e.prototype.add=function(t){this._listeners.push(t)},e.prototype.remove=function(t){var r=this._listeners.indexOf(t);r>=-1&&this._listeners.splice(r,1)},Object.defineProperty(e.prototype,"invoke",{get:function(){var r=this;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];r._listeners.forEach(function(a){return a.apply(void 0,w([],V(n),!1))})}},enumerable:!1,configurable:!0}),e}();var Ihe=FT;var Ehe=function(){function e(){this._listeners={}}return e.prototype.add=function(t,r){this.on(t).add(r)},e.prototype.removeAll=function(t){delete this._listeners[t]},e.prototype.on=function(t){return this._listeners[t]||(this._listeners[t]=new FT),this._listeners[t]},e}();si();bm();s();function Phe(e){return e.type==="Event"}function _he(e){return e.type==="Action"}s();k();s();si();Is();function qNe(e){var t="Event",r=Fe.CommentContextChanged,n=e;return Ss(n)?{type:t,eventType:r,payload:{numberOfComments:n.numberOfComments,numberOfThreads:n.numberOfThreads,newNextPopulatedContextDetails:n.newNextPopulatedContextDetails,contextDetails:n.contextDetails,contextDrafts:n.contextDrafts,selectedThreadIndex:n.selectedThreadIndex}}:{type:t,eventType:r}}var Rhe=qNe;s();k();ne();te();ye();si();ii();s();k();function Wl(e){var t=e.date;return m(m({},e),{date:t?new Date(t):void 0})}s();k();ne();Jt();s();var KNe=S(Et()),Ahe=function(){function e(t){this.time=t}return e.isInstanceOf=function(t){return typeof t=="object"&&typeof t.time=="number"},e}();Pw();function xy(e){return{id:e.id,commentId:e.commentId,currentState:e.currentState,history:$Ne(e.id,e.history)}}function YNe(e){return Ahe.isInstanceOf(e)?new Date(e.time):e}function $Ne(e,t){return t.map(function(r){return{commentId:r.commentId,taskId:e,records:r.records.map(function(n){return QNe(n)})}})}function QNe(e){var t={time:YNe(e.details.time),displayTime:e.details.displayTime,user:e.details.user,recordId:e.details.recordId,isLossy:e.details.isLossy};switch(e.type){case"Assign":return cc(e,m({type:ar.Assign,assignee:e.assignee},t));case"Create":return cc(e,m({type:ar.Create},t));case"Delete":return cc(e,m({type:ar.Delete},t));case"Priority":return cc(e,m({type:ar.Priority,priority:e.priority},t));case"Progress":return cc(e,m({type:ar.Progress,completion:e.completion},t));case"Restore":return cc(e,m({type:ar.Restore},t));case"Schedule":return cc(e,m({type:ar.Schedule,schedule:e.schedule},t));case"SetTitle":return cc(e,m({type:ar.SetTitle,title:e.title},t));case"Unassign":return cc(e,m({type:ar.Unassign,assignee:e.assignee},t));case"UnassignAll":return cc(e,m({type:ar.UnassignAll},t));case"Undo":throw new ge("Should not receive undo history record type",C.reserveTag(589103697),-2130957497);case"Unknown":throw new ge("Unknown history record type",C.reserveTag(589103698),-2130957498)}}function cc(e,t){return t}function khe(e){return e.type==="CommentContextReload"}function Dhe(e){return e.changes!==void 0}function XNe(e){var t="Event",r=Fe.CommentContextReload;if(!khe(e))return{type:t,eventType:r};if(e.numberOfComments===void 0){x().assertConditionTag(Dhe(e)&&e.changes.length===0,"transformCommentContextReload called with changes and without numberOfComments in the event payload",570728577);return}var n=[],o=[],a,d=function(){var l=[{type:t,eventType:r,payload:m({contextDetails:e.contextDetails,comments:n},at()?{tasks:o}:{})}];return a&&l.push({type:"Event",eventType:Fe.CommentSelected,payload:{commentId:a}}),l};if(!e.numberOfComments)return d();var c=function u(l){if(!khe(l)){Ln(!1,"Non-context reload payload passed in!",C.reserveTag(576583251));return}return Dhe(l)&&(at()?l.changes.forEach(function(p){p.tempId&&yr(p.model)&&(x().assertConditionTag(!a,"expect 0 or 1 remapped tempIds",591677090),a=p.model.commentId),n.push(Wl(p.model)),p.task&&o.push(xy(p.task))}):n.push.apply(n,w([],V(l.changes.map(function(p){return p.tempId&&yr(p.model)&&(x().assertConditionTag(!a,"expect 0 or 1 remapped tempIds",591677091),a=p.model.commentId),Wl(p.model)})),!1))),n.length===e.numberOfComments?d():u};return c}var whe=XNe;s();si();function JNe(e){return e.type==="CommentHighlighted"}function ZNe(e){var t="Event";return JNe(e)?{type:t,eventType:Fe.CommentHighlighted,payload:{commentId:e.commentId}}:{type:t,eventType:Fe.CommentHighlighted}}var Fhe=ZNe;s();si();function eMe(e){return e.type==="CommentSelected"}function tMe(e){var t="Event";return eMe(e)?{type:t,eventType:Fe.CommentSelected,payload:{commentId:e.commentId,selectionReason:e.selectionReason}}:{type:t,eventType:Fe.CommentSelected}}var Ohe=tMe;s();k();ye();df();si();Iw();function rMe(e){return e.type==="CommentsChanged"}function nMe(e){var t=eC(e.type),r=e.tempId,n,o;return iC(t)&&(e.model&&(n=Wl(e.model)),at()&&e.task&&(o=xy(e.task))),m(m(m({type:t,index:e.index},r?{tempId:r}:{}),n?{model:n}:{}),o?{task:o}:{})}function oMe(e){var t="Event",r=Fe.CommentsChanged;if(!rMe(e))return{type:t,eventType:r};var n=e.changes.map(nMe);return{type:t,eventType:r,payload:{changes:n,contextDetails:e.contextDetails}}}var Nhe=oMe;s();k();ye();si();function iMe(e){return e.type==="CommentsLoaded"}function aMe(e){return!!e.threads}function sMe(e){var t="Event",r=Fe.LoadComments;if(!iMe(e))return{type:t,eventType:r};if(aMe(e)){var n=e.threads;return{type:t,eventType:r,payload:{threads:n}}}var o,a=[];return at()?(o=[],e.changes.forEach(function(d){o.push(Wl(d.model)),d.task&&a.push(xy(d.task))})):o=e.changes.map(function(d){return Wl(d.model)}),{type:t,eventType:r,payload:m({comments:o},at()?{tasks:a}:{})}}var Mhe=sMe;s();k();function dMe(e){return!!e.contextDetails}function cMe(e){if(!dMe(e))return e;var t={nextPopulatedContextDetails:e.contextDetails.nextPopulatedContextDetails,commentThreadCounts:e.contextDetails.commentThreadCounts,isReadOnly:!!e.contextDetails.isReadOnly,topVisibleThreadId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.topVisibleThreadId:void 0,selectedCommentId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.selectedCommentId:void 0,highlightedCommentId:e.contextDetails.selectionInfo?e.contextDetails.selectionInfo.highlightedCommentId:void 0};return m(m({},e),{contextDetails:t})}var Lhe=cMe;s();si();function uMe(e){return e.type==="ModelCapabilitiesChanged"}function lMe(e){var t="Event";return uMe(e)?{type:t,eventType:Fe.ModelCapabilitiesChanged,payload:e}:{type:t,eventType:Fe.ModelCapabilitiesChanged}}var Hhe=lMe;s();Pu();function fMe(e){return e.type==="ReturnToDraftRequested"}function pMe(e){var t="Event";return fMe(e)?{type:t,eventType:Fe.ReturnToDraftRequested,payload:{draftId:e.draftId}}:{type:t,eventType:Fe.ReturnToDraftRequested}}var Bhe=pMe;s();Zy();function mMe(e){return e.type==="UIAction"}function gMe(e){var t="Action";if(!mMe(e))return{type:t,actionType:void 0};var r=e.action;return{type:"Action",actionType:r,payload:{actionBehavior:ai.Execute,actionType:r}}}var Uhe=gMe;s();Pu();function hMe(e){return e.type==="UpdateDraftThread"}function yMe(e){var t="Event";return hMe(e)?{type:t,eventType:Fe.UpdateDraftThread,payload:{draftId:e.draftId,anchorHintText:e.anchorHintText,insertIndex:e.insertIndex}}:{type:t,eventType:Fe.UpdateDraftThread}}var Vhe=yMe;function l3(e){return typeof e=="function"}function jhe(e){return typeof e!="function"}function CMe(e){var t,r,n={};try{for(var o=$e(Object.keys(e)),a=o.next();!a.done;a=o.next()){var d=a.value;n[d]=e[d]===null?void 0:e[d]}}catch(c){t={error:c}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}function Whe(e,t){var r=Lhe(CMe(t));switch(e){case"CommentContextChanged":return Rhe(r);case"CommentContextReload":return whe(r);case"CommentsLoaded":return Mhe(r);case"CommentsChanged":return Nhe(r);case"CommentSelected":return Ohe(r);case"CommentHighlighted":return Fhe(r);case"ModelCapabilitiesChanged":return Hhe(r);case"ReturnToDraftRequested":return Bhe(r);case"UIAction":return Uhe(r);case"UpdateDraftThread":return Vhe(r);default:return}}var zhe=function(){function e(t){this.telemetryVisitor=t,this._commentListeners=new FT,this._actionListeners=new Ehe,this._aggregateEventCallbacks={},this.processEvent=this.processEvent.bind(this),this._eventQueue=[]}return Object.defineProperty(e.prototype,"onEvent",{get:function(){return this._commentListeners},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onAction",{get:function(){return this._actionListeners},enumerable:!1,configurable:!0}),e.prototype.invokeAction=function(t){t.payload!==void 0&&t.actionType!==void 0?this.onAction.on(t.actionType).invoke(t.payload):x().assertConditionTag(!1,"Invalid '".concat(t.actionType?Gt[t.actionType]:"unknown","' action payload"),591677120)},e.prototype.invokeEvent=function(t){x().assertConditionTag(t.payload!==void 0,"Invalid '".concat(Fe[t.eventType],"' event payload"),591677121),t.payload&&this.onEvent.invoke(t.eventType,t.payload)},e.prototype.dispatch=function(t){var r=this,n=t.constructor===Array?t:[t];return n.reduce(function(o,a){return Phe(a)?(r.invokeEvent(a),o):_he(a)?(r.invokeAction(a),o):!1},!0)},e.prototype.enableEvents=function(){if(this._eventQueue){var t=this._eventQueue;this._eventQueue=void 0,t.forEach(this.processEvent)}},e.prototype.processEvent=function(t){if(this._eventQueue){this._eventQueue.push(t);return}var r=x().createActivityObject("ProcessNativeEvent",this.telemetryVisitor,Ee()),n;try{n=JSON.parse(t.payload)}catch(a){a instanceof Error&&r.addDataField("ExceptionType",a.name,N.SystemMetadata),r.failTag(591677122,-2130957568);return}r.addDataField("EventType",n.type,N.SystemMetadata);var o=this._aggregateEventCallbacks[n.type];if(o?l3(o)?o=o(n):(x().assertConditionTag(l3(o),"invalid data in event aggregate",591677123),delete this._aggregateEventCallbacks[n.type],o=void 0):o=Whe(n.type,n),!o){r.failTag(591677124,-2130957567);return}if(jhe(o)){if(delete this._aggregateEventCallbacks[n.type],!this.dispatch(o)){r.failTag(591677125,-2130957566);return}}else this._aggregateEventCallbacks[n.type]=o;r.successTag(591677126)},e}();function Ghe(e){var t=Cn.getTelemetryVisitor(e),r=new zhe(t),n=new She(r,e),o=new yk(n);return o}xb();s();Eu();ne();yd();s();var vk=S(Et());vk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::GrantUsersAccessResponse":{OperationResult:"$number"},"Mso::Document::Comments::JS::SuggestionsDetailsChange":{apiContext:"$string",suggestionsDetails:"Mso::Document::Comments::JS::SuggestionsDetails"}});var vMe={PeopleModule:["Mso::Document::Comments::JS::PeopleModule",{checkUserAccess:["ReturnsPromiseMethod","Mso::Document::Comments::JS::UserPermissions",["$string","Mso::Document::Comments::JS::IUser"]],grantUsersAccess:["ReturnsPromiseMethod","Mso::Document::Comments::JS::GrantUsersAccessResponse",["$string",["$array","Mso::Document::Comments::JS::IUser"]]],getCurrentUserId:["ReturnsPromiseMethod","$string",["$string"]],getSuggestionsDetails:["ReturnsPromiseMethod","Mso::Document::Comments::JS::SuggestionsDetails",["$string"]],onSuggestionsDetailsChange:["Event","Mso::Document::Comments::JS::SuggestionsDetailsChange"]}]},qhe={PeopleModule:vk.RekaServiceRegistry.getNativeService(vMe.PeopleModule)};te();var NT=S($he());pn();Jt();Fc();var p3="Microsoft.Office.Docs.ModernComments",SMe=function(){function e(t){this.apiContext=t,this.suggestionsDetailsListeners=[],this.eventSubscription=void 0,this.capabilities=Ma.GetAuthToken|Ma.GetSuggestionsDetails,this.getPersonaIconPropertiesArray=void 0}return e.prototype.checkUserAccess=function(t){return this.getModule().checkUserAccess(this.apiContext,t)},e.prototype.grantUsersAccess=function(t){return this.getModule().grantUsersAccess(this.apiContext,t)},e.prototype.getContactsForMentions=function(t,r,n){return Promise.reject(new ge("Not implemented on native",C.reserveTag(589103651),-2130957557))},e.prototype.getAuthToken=function(t){var r=this,n=x().createActivityObject("PeopleAPIGetAuthToken",Cn.getTelemetryVisitor(this.apiContext),Ee());return n.addDataField("ServiceId",t,N.SystemMetadata),this.getCurrentUserId().then(function(o){return r.getTokenForUserId(o,t,n)},function(o){return Ri(o)?(n.failTag(595957842,sn(o)),Promise.reject(o)):(_y(o),n.failTag(592492748,-2130957547),Promise.reject(new ge("Uncaught error",C.reserveTag(589103680),-2130957547)))})},e.prototype.getModule=function(){return qhe.PeopleModule},e.prototype.getCurrentUserId=function(){return this.getModule().getCurrentUserId(this.apiContext).catch(function(t){return Promise.reject(new ge("getCurrentUserId() failed",C.reserveTag(589103681),-2130957547))})},e.sanitizeIdentityErrorMessage=function(t){switch(t){case"error config token":case"unexpected error":return t;default:return/^error\:\-?\d+$/.test(t)?t:"Unknown error"}},e.prototype.getTokenForUserId=function(t,r,n){var o={UserName:t,CorrelationId:p3},a;switch(r){case hd.Loki:a=NT.NativeServices.NativeGetLokiToken.QueryToken(o);break;case hd.MSGraph:a=NT.NativeServices.NativeGetMSGraphToken.QueryToken(o);break;default:return n.failTag(595952132,-2130957547),Promise.reject(new ge("Unrecognized service",C.reserveTag(589103682),-2130957547))}return a.then(function(d){var c=d.AuthToken,u=d.ErrorMessage;return n.addDataField("AuthDataError",e.sanitizeIdentityErrorMessage(u),N.SystemMetadata),d.OperationResult?c?(n.successTag(592492751),Promise.resolve(c)):(n.failTag(592492750,-2130957546),Promise.reject(new ge("Auth token empty",C.reserveTag(589103684),-2130957546))):(n.failTag(592492749,-2130957547),Promise.reject(new ge("OperationResult false",C.reserveTag(589103683),-2130957547)))},function(d){return n.failTag(592492752,-2130957547),Promise.reject(new ge("Identity QueryToken() failed",C.reserveTag(589103685),-2130957547))})},e.prototype.getSuggestionsDetails=function(){return this.getModule().getSuggestionsDetails(this.apiContext)},e.prototype.registerForSuggestionsDetailsChanges=function(t){var r=this;this.eventSubscription||(this.eventSubscription=this.getModule().onSuggestionsDetailsChange.subscribe(md(this.apiContext,function(n){r.suggestionsDetailsListeners.forEach(function(o){return o(n.suggestionsDetails)})}))),this.suggestionsDetailsListeners.push(t)},e.prototype.unregisterForSuggestionsDetailsChanges=function(t){var r=this.suggestionsDetailsListeners.indexOf(t);r>-1&&this.suggestionsDetailsListeners.splice(r,1),this.suggestionsDetailsListeners.length===0&&this.eventSubscription&&(this.eventSubscription.unsubscribe(),this.eventSubscription=void 0)},e.prototype.getLokiUrl=function(){var t=this;return this.getCurrentUserId().then(function(r){return t.getLokiUrlCore(r)})},e.prototype.getLokiUrlCore=function(t){var r={UserName:t,CorrelationId:p3};return NT.NativeServices.NativeGetLokiUrl.QueryLokiUrl(r).catch(function(n){return me(C.reserveTag(554783041))(n),Promise.reject(new ge("Identity GetLokiUrl() failed",C.reserveTag(560214533),-2130957487))})},e.prototype.getTenantId=function(){var t=this;return this.getCurrentUserId().then(function(r){return t.getTenantIdCore(r)})},e.prototype.getTenantIdCore=function(t){var r={UserName:t,CorrelationId:p3};return NT.NativeServices.NativeGetTenantId.QueryTenantId(r).catch(function(n){return me(C.reserveTag(554783042))(n),Promise.reject(new ge("Identity GetTenantId() failed",C.reserveTag(560214534),-2130957486))})},e}();function Qhe(e){return new SMe(e)}s();s();k();ne();CS();Na();s();var Xhe=function(){function e(){var t=this;this.changedEvent=new Ihe,this.fireEvent=function(r){t.changedEvent.invoke(r)}}return e.prototype.registerForViewContainerEvents=function(t){this.changedEvent.add(t)},e.prototype.unregisterForViewContainerEvents=function(t){this.changedEvent.remove(t)},e}();s();var m3=function(){function e(t,r,n){this.viewContainerBase=t,this.containerType=t.containerType,this.onReadyToRender=t.onReadyToRender,this.onReadyToRender&&(this.onReadyToRender=this.onReadyToRender.bind(t)),this.invokeModalConfirmationDialog=t.invokeModalConfirmationDialog,this.invokeModalConfirmationDialog&&(this.invokeModalConfirmationDialog=this.invokeModalConfirmationDialog.bind(t)),this.setDisplayConfiguration=t.setDisplayConfiguration,this.setDisplayConfiguration&&(this.setDisplayConfiguration=this.setDisplayConfiguration.bind(t)),this.closeView=t.closeView.bind(t),this.identifier=t.identifier}return e.prototype.openView=function(){this.viewContainerBase.openView&&this.viewContainerBase.openView()},e.prototype.moveFocusToCanvas_donotuse=function(){this.viewContainerBase.moveFocusToCanvas_donotuse&&this.viewContainerBase.moveFocusToCanvas_donotuse()},e}();s();k();Na();s();Na();var IMe=function(){function e(t){this._moduleAPI=t,this.containerType=on.FullPane}return e.prototype.openView=function(){this._moduleAPI.showView()},e.prototype.closeView=function(){this._moduleAPI.closeView()},e.prototype.onReadyToRender=function(){this._moduleAPI.onReadyToRender()},e.prototype.moveFocusToCanvas_donotuse=function(){this._moduleAPI.moveFocusToCanvas_donotuse()},e}(),xk=IMe;var EMe=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.containerType=on.FullPane,r}return t}(xk),Jhe=EMe;s();k();Zl();te();Mu();Na();var PMe=function(){function e(t,r){this._moduleAPI=t,this._details=r,this._activity=void 0,this._promise=void 0}return e.prototype.run=function(){var t=this;return this._promise?this._promise:(this._activity=x().createActivityObject("SetHalfPaneDisplayMode",ht(ut.Todo,3304490),Ee()),this._activity.addDataField("DisplayMode",this._details.displayMode,N.SystemMetadata),this._promise=this._moduleAPI.setHalfPaneDisplayMode(this._details).then(function(){if(t._activity)return t._activity.successTag(595932617),t._activity=void 0,t._details},function(){t._activity&&(t._activity.failTag(595932619,-2130957524),t._activity=void 0)}),this._promise)},e.prototype.markReplaced=function(){this._activity&&(this._activity.failTag(595932616,-2130957523),this._activity=void 0)},e.prototype.getDetails=function(){return this._details},e}(),_Me=function(e){Z(t,e);function t(){var r=e.apply(this,w([],V(arguments),!1))||this;return r.containerType=on.HalfPane,r._pendingDisplayConfigChange=void 0,r}return t.prototype.setDisplayConfiguration=function(r){var n=this;return this._pendingDisplayConfigChange&&!gf(this._pendingDisplayConfigChange.getDetails(),r)&&(this._pendingDisplayConfigChange.markReplaced(),this._pendingDisplayConfigChange=void 0),this._pendingDisplayConfigChange||(this._pendingDisplayConfigChange=new PMe(this._moduleAPI,r)),this._pendingDisplayConfigChange.run().then(function(){if(n._pendingDisplayConfigChange&&gf(n._pendingDisplayConfigChange.getDetails(),r)){var o=n._pendingDisplayConfigChange.getDetails();return n._pendingDisplayConfigChange=void 0,o}},function(){n._pendingDisplayConfigChange&&gf(n._pendingDisplayConfigChange.getDetails(),r)&&(n._pendingDisplayConfigChange=void 0)})},t}(xk),Zhe=_Me;s();Eu();ye();s();var eye=S(Et());s();var Ty;(function(e){e[e.HalfPane=0]="HalfPane",e[e.FullPane=1]="FullPane"})(Ty||(Ty={}));eye.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::ViewContainerNativeEventBase":{apiContext:"$string"},"Mso::Document::Comments::JS::ViewContainerChangedNativeEvent":{type:"$string",apiContext:"$string",newDisplayMode:"$number"},"Mso::Document::Comments::JS::FocusTriggeredNativeEvent":{type:"$string",apiContext:"$string",shouldFocus:"$boolean"},"Mso::Document::Comments::JS::VisibilityChangedNativeEvent":{type:"$string",apiContext:"$string",viewContainerVisibilityState:"$number"},"Mso::Document::Comments::JS::FoldableLayoutStateChangedNativeEvent":{type:"$string",apiContext:"$string",newFoldableLayoutState:"$number"}});s();var Tk=S(Et());Tk.CustomTypeRegistry.registerTypeInfos({"Mso::Document::Comments::JS::ViewContainerEventPayload":{apiContext:"$string",payload:"$string"}});var RMe={ViewContainerModule:["Mso::Document::Comments::JS::ViewContainerModule",{setHalfPaneDisplayMode:["ReturnsPromiseMethod","$any",["$string","$string"]],closeView:["FireAndForgetMethod",["$string"]],showView:["FireAndForgetMethod",["$string"]],onReadyToRender:["FireAndForgetMethod",["$string"]],moveFocusToCanvas_donotuse:["FireAndForgetMethod",["$string"]],onEvent:["Event",["$union",["Mso::Document::Comments::JS::ViewContainerChangedNativeEvent","Mso::Document::Comments::JS::FocusTriggeredNativeEvent","Mso::Document::Comments::JS::VisibilityChangedNativeEvent","Mso::Document::Comments::JS::FoldableLayoutStateChangedNativeEvent"]]],onDisplayModeChange:["Event","Mso::Document::Comments::JS::ViewContainerEventPayload"]}]},Jp={ViewContainerModule:Tk.RekaServiceRegistry.getNativeService(RMe.ViewContainerModule)};var tye=function(){function e(t){this.apiContext=t}return e.prototype.setHalfPaneDisplayMode=function(t){return Jp.ViewContainerModule.setHalfPaneDisplayMode(this.apiContext,JSON.stringify([t]))},e.prototype.showView=function(){ki()&&Jp.ViewContainerModule.showView(this.apiContext)},e.prototype.closeView=function(){Jp.ViewContainerModule.closeView(this.apiContext)},e.prototype.onReadyToRender=function(){Jp.ViewContainerModule.onReadyToRender(this.apiContext)},e.prototype.onEvent=function(t){Jp.ViewContainerModule.onEvent.subscribe(md(this.apiContext,t))},e.prototype.moveFocusToCanvas_donotuse=function(){Jp.ViewContainerModule.moveFocusToCanvas_donotuse(this.apiContext)},e}();function AMe(e){switch(e){case Ty.FullPane:return on.FullPane;case Ty.HalfPane:return on.HalfPane;default:Me(e)}}var kMe=function(e){Z(t,e);function t(r,n,o,a){var d=e.call(this)||this;return d.processEvent=function(c){switch(c.type){case"ViewContainerChanged":{d.changeViewContainerType(AMe(c.newDisplayMode));break}case"FocusTriggered":{d.fireEvent({eventType:di.FocusTriggered});break}case"VisibilityChanged":{d.fireEvent({eventType:di.VisibilityChanged,viewContainerVisibilityState:c.viewContainerVisibilityState});break}case"FoldableLayoutStateChanged":{d.fireEvent({eventType:di.FoldableLayoutStateChanged,newFoldableLayoutState:c.newFoldableLayoutState});break}default:Me(c)}},d._apiContext=r,d._moduleAPI=new tye(r),d._moduleAPI.onEvent(d.processEvent),d._foldableLayoutState=o,d.updateForNewViewContainerType(n),d}return t.prototype.getViewContainer=function(){return Ln(this._currentContainer,"Container must be set prior to querying it.",C.reserveTag(576583252)),this._currentContainer},t.prototype.changeViewContainerType=function(r){this.updateForNewViewContainerType(r),this.fireEvent({eventType:di.ViewContainerChanged,newViewContainer:this._currentContainer})},t.prototype.updateForNewViewContainerType=function(r){switch(r){case on.FullPane:this._currentContainer=new m3(new Jhe(this._moduleAPI),this._apiContext,this);break;case on.HalfPane:this._currentContainer=new m3(new Zhe(this._moduleAPI),this._apiContext,this),this._currentContainer.foldableLayoutState=this._foldableLayoutState;break}},t}(Xhe),rye=kMe;function nye(e,t,r,n){return new rye(e,t,r,n)}s();k();ne();rt();te();Eo();wd();Pt();Mu();yc();Jt();ye();Cr();an();Ad();HC();yt();zu();bn();so();St();Ni();lo();io();kd();Id();s();var Pi;(function(e){e[e.NoCommand=0]="NoCommand",e[e.ComponentNotFound=1]="ComponentNotFound",e[e.ShouldRetry=2]="ShouldRetry",e[e.Handled=3]="Handled"})(Pi||(Pi={}));Ve();Nf();Pr();li();s();s();var bo;(function(e){e[e.PreserveFocus=0]="PreserveFocus",e[e.FocusComponent=1]="FocusComponent",e[e.DispatchAction=2]="DispatchAction",e[e.Compound=3]="Compound"})(bo||(bo={}));function oye(e){return e.type===bo.DispatchAction&&e.action!==void 0}function id(e,t){return{type:bo.DispatchAction,action:t,causedBy:e,priorityArgs:{priority:1}}}s();k();function bk(e){return e.type===bo.FocusComponent&&e.component!==void 0}function nn(e,t,r){return r===void 0&&(r={priorityArgs:{priority:1}}),m({type:bo.FocusComponent,component:t,causedBy:e},r)}s();ne();yc();s();ne();te();yc();yi();s();function g3(e,t,r){if(!t)return r;if(!r)return t;var n={type:bo.Compound,priorityArgs:{priority:1},first:t,then:r,causedBy:e};return n}function iye(e){return e.type===bo.Compound&&e.first!==void 0&&e.then!==void 0}function DMe(e){return e.priorityArgs.priority!==1&&e.priorityArgs.phase!==0}function wMe(e,t,r){return t?(cn&&It("Calling focus for componentType: ".concat(e.component.componentType)),r(e.component),t.focus(e.preventScroll?{preventScroll:e.preventScroll}:void 0),Pi.Handled):DMe(e)?Pi.ShouldRetry:Pi.ComponentNotFound}function Gl(e,t,r,n){if(!e)return Pi.NoCommand;var o=Pi.Handled;if(bk(e)){var a=e.component;o=wMe(e,Dd(a)?t.getComponentById(a):t.getComponent(a.componentType),n)}else if(oye(e))r.dispatch(e.action);else if(iye(e)){var d=Gl(e.first,t,r,n),c=Gl(e.then,t,r,n);x().assertConditionTag(d!==Pi.ShouldRetry&&c!==Pi.ShouldRetry,"Compound command failed with status FocusManagerResult.ShouldRetry. No retry will occur.",559748948)}return e.stopPropagation&&e.causedBy&&e.causedBy.stopPropagation(),e.preventDefault&&e.causedBy&&e.causedBy.preventDefault(),o}var aye=50;function sye(e,t){var r=function n(o,a,d,c,u){if(!t||!o||t.indexOf(o.type)===-1||o.priorityArgs.priority===3){o&&(t==null?void 0:t.indexOf(o.type))!==-1&&(cn&&(o==null?void 0:o.type)===bo.FocusComponent&&It("Executing non-debounced focus command ".concat(JSON.stringify(o))),n.pendingCommand!==void 0&&clearTimeout(n.pendingCommand),n.pendingCommand=void 0),c(o,Gl(o,a,d,u));return}n.pendingCommand!==void 0&&clearTimeout(n.pendingCommand),cn&&o.type===bo.FocusComponent&&It("Caching debounced command ".concat(JSON.stringify(o))),n.pendingCommand=setTimeout(function(){cn&&o.type===bo.FocusComponent&&It("Executing debounced command ".concat(JSON.stringify(o))),c(o,Gl(o,a,d,u)),n.pendingCommand=void 0},e)};return r.pendingCommand=void 0,r}Xa();s();yi();function h3(e,t){return!!(Dd(t)?e.getComponentById(t):e.getComponent(t.componentType))}s();te();ye();St();Ni();Ve();Pr();li();yi();function OMe(e){return!(Q()==="win32"||Q()==="web"&&Sm()||!Kt(e))}function NMe(e,t){if(OMe(e.componentTreeId.renderContextType)){var r=e.getComponent(X.ClosePaneButton);if(!r){x().assertConditionTag(!1,"cannot find close button on platform where we should be able to find it",579086371);return}return nn(void 0,{componentType:X.ClosePaneButton},{priorityArgs:t})}}function MMe(e,t,r){if(!(!Au()||e.componentTreeId.renderContextType!==A.FullPane)){var n=t.getState(),o=Lr(n).newThread;if(o){var a=e.getComponent(X.NewCommentButton);if(!a){x().assertConditionTag(!1,"cannot find new comment button, but its enabled",579086400);return}return nn(void 0,{componentType:X.NewCommentButton},{priorityArgs:r})}}}function LMe(e,t,r){if(e.componentTreeId.renderContextType===A.FullPane){var n=t.getState(),o=tr(n);if(o){var a=e.getComponent(X.FilterButton);if(!a){x().assertConditionTag(!1,"cannot find filter button in full pane with filtering enabled",507339343);return}return nn(void 0,{componentType:X.FilterButton},{priorityArgs:r})}}}function HMe(e){if(Q()!=="web")return nn(void 0,{componentType:X.CommentsList},{priorityArgs:e})}function Sk(e,t,r){var n,o,a;if(r===void 0&&(r={priority:1}),!Kt(e.componentTreeId.renderContextType)){x().assertConditionTag(!1,"Shouldn't be called with renderContextType: ".concat(e.componentTreeId.renderContextType),576337157);return}var d=(a=(o=(n=MMe(e,t,r))!==null&&n!==void 0?n:LMe(e,t,r))!==null&&o!==void 0?o:NMe(e,r))!==null&&a!==void 0?a:HMe(r);if(d)return d;x().assertConditionTag(!1,"Couldn't find a focus target",576337158)}Ov();s();k();Pt();wN();function ad(e,t,r,n,o){var a=function(u){for(var l=[],p=1;p<arguments.length;p++)l[p-1]=arguments[p];return n.apply(void 0,w([u],V(l),!1))},d=function(u){for(var l=[],p=1;p<arguments.length;p++)l[p-1]=arguments[p];var g=a.apply(void 0,w([u],V(l),!1));o(g,u,e(),t,r)};return d.processCommand=a,d}function Ik(e,t,r,n,o){var a=function(p,g){var h=V(g),v=h[0],y=h.slice(1),T=v();o(d.apply(void 0,w([CZ(p),T],V(y),!1)),T,e(),function(){},function(){})},d=function(p,g){for(var h=[],v=2;v<arguments.length;v++)h[v-2]=arguments[v];if(r(g)){var y=vu(mc(p.key),t),T=n[J[y]];if(T)return T.handler.apply(T,w([p,g],V(h),!1))}},c=Object.keys(n).map(function(l){return{key:l,eventPhase:n[l].phase}}),u=function(){for(var p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];return{onKeyDown:function(v){return a(v,p)},getKeyDownEvents:function(){return c}}};return u.processEvent=d,u}yi();i0();s();ne();te();Eo();wd();Sc();s();Pu();ii();var y3=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1),this.model=t,this.startPostIndex=r,this.pointer=0,this.ignoreResolvedThreads=!1,r>t.length?this.pointer=t.length:r<0?this.pointer=-1:this.pointer=r,this.ignoreResolvedThreads=n}return e.prototype.getRootCommentForCurrentElement=function(t){if(this.model[this.pointer]){var r=Ze(this.model[this.pointer]);return t&&t.commentId===r?t:this.model.find(function(n){return n.commentId===r})}},e.prototype.next=function(){var t=this.pointer,r;if(this.pointer<this.model.length-1)if(!this.ignoreResolvedThreads)++this.pointer;else do++this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer<this.model.length&&r&&r.commentFlags&Ne.Resolved);return this.pointer<this.model.length-1||this.pointer===this.model.length-1&&t<this.model.length-1?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.previous=function(){var t=this.pointer,r;if(this.pointer>0)if(!this.ignoreResolvedThreads)--this.pointer;else do--this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer>-1&&r&&r.commentFlags&Ne.Resolved);return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.model[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();TI();ii();Di();ye();Cr();an();Ad();yt();so();St();lo();io();kd();Ve();Nf();zo();s();Tc();Af();zo();var C3=function(){function e(t,r,n){r===void 0&&(r=0),n===void 0&&(n=!1),this.items=t,this.startItemIndex=r,this.ignoreResolvedThreads=n,this.pointer=0,r>t.length?this.pointer=t.length:r<0?this.pointer=-1:this.pointer=r}return e.prototype.getRootCommentForCurrentElement=function(t){if(this.items[this.pointer]){var r=_o(this.items[this.pointer]);if(t&&t.commentId===r)return t;for(var n=this.pointer;n>=0;--n){var o=this.items[n];if(_r(o)&&o.commentModel.commentId===r)return o.commentModel}for(var n=this.pointer+1;n<this.items.length;++n){var o=this.items[n];if(_r(o)&&o.commentModel.commentId===r)return o.commentModel}}},e.prototype.next=function(){var t=this.pointer,r;if(this.pointer<this.items.length-1)if(!this.ignoreResolvedThreads)++this.pointer;else do++this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer<this.items.length&&r&&r.commentFlags&Ne.Resolved);return this.pointer<this.items.length-1||this.pointer===this.items.length-1&&t<this.items.length-1?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.previous=function(){var t=this.pointer,r;if(this.pointer>0)if(!this.ignoreResolvedThreads)--this.pointer;else do--this.pointer,r=this.getRootCommentForCurrentElement(r);while(this.pointer>-1&&r&&r.commentFlags&Ne.Resolved);return this.pointer>0||this.pointer===0&&t>0?{done:!1,value:this.items[this.pointer]}:{done:!0}},e.prototype.currentIndex=function(){return this.pointer},e}();yi();var Ek=function(){function e(t,r,n){this.commentStore=t,this.telemetryVisitor=r,this.useContentNavigationAPI=n}return e.prototype.selectThreadInCurrentContext=function(t,r,n,o,a){return id(t,fn(r,n,void 0,o?Ae.ExpandCard:Ae.SelectCard,a))},e.prototype.collapseThreadInCurrentContext=function(t,r,n){return id(t,Rm(r,n))},e.prototype.selectPost=function(t,r,n,o,a){return id(t,fn(r,n,o,Ae.SelectPost,a))},e.prototype.selectFirstThreadInCurrentContext=function(t,r,n,o,a){if(!sr()&&it()){var d=uo(this.commentStore.getState(),!0,o),c=tt(pe(this.commentStore.getState()),!0,o);if(c&&d&&d.flatIndex===0)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(588129411),telemetryVisitor:this.telemetryVisitor},c,!1,n)}var u=void 0,l=a?In(this.commentStore.getState()):pi(this.commentStore.getState());if(er(l))u=a?new xI(l,wt(this.commentStore.getState()),-1).next().value:l[0];else{var p=void 0;if(a){var g=new Uu(l,-1,a);p=g.next().value}else p=l[0];u=p==null?void 0:p.commentId}if(u)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(593278811),telemetryVisitor:this.telemetryVisitor},u,r,n)},e.prototype.selectLastThreadInCurrentContext=function(t,r,n,o,a){var d=wt(this.commentStore.getState());if(!ci(d)&&it()){var c=uo(this.commentStore.getState(),!0,o),u=tt(pe(this.commentStore.getState()),!0,o);if(u&&c&&c.flatIndex===d.length)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(588129412),telemetryVisitor:this.telemetryVisitor},u,!1,n)}var l=a?In(this.commentStore.getState()):pi(this.commentStore.getState());if(WC(l,d,a)){var p=void 0;if(er(l))p=a?new xI(l,d,l.length).previous().value:l[l.length-1];else{var g=new Uu(l,l.length,a),h=g.previous().value;p=h==null?void 0:h.commentId}if(!p){x().assertConditionTag(!1,"Unable to find last thread",593278812);return}return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(593278813),telemetryVisitor:this.telemetryVisitor},p,r,n)}},e.prototype.focusAndCollapseSelectedThread=function(t,r){var n=Ie(this.commentStore.getState());if(n){if(it()&&tt(pe(this.commentStore.getState()))===n.selectedCardId)return;var o=ia(this.commentStore.getState());if(da(n.selectedCardId,o,r)===Rt.Expanded)return g3(t,nn(t,{componentType:X.Card,id:n.selectedCardId,renderContextType:r}),this.collapseThreadInCurrentContext(t,{renderContextType:r,trackback:C.reserveTag(593278814),telemetryVisitor:this.telemetryVisitor},n.selectedCardId))}},e.prototype.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated=function(t,r,n,o,a,d,c,u){var l,p=r.direction===Yt.Next?t.next():t.previous();if(it()&&n&&o&&a.selectedCardId!==n){var g=r.direction===Yt.Next?d<o.flatIndex&&(p.done||t.currentIndex()>=o.flatIndex):d>=o.flatIndex&&(p.done||t.currentIndex()<o.flatIndex);if(g)return this.selectThreadInCurrentContext(c,{renderContextType:u,trackback:C.reserveTag(588289059),telemetryVisitor:this.telemetryVisitor},n,!1,r.source)}return p.done||(l=p.value.commentId),l},e.prototype.selectNextOrPreviousThread=function(t,r,n,o,a){var d=this.commentStore.getState(),c=Ie(d);if(this.useContentNavigationAPI&&(!c||o===A.DiscreteIntegrated||o===A.None&&aa(d)!==bt.Visible)){if(n!==void 0)return id(t,XS({renderContextType:o,trackback:C.reserveTag(578352064),telemetryVisitor:this.telemetryVisitor},r.direction,r.iterableContentTypes,!!r.restrictToCurrentContext,!!r.restrictToCurrentContext,c?{contentId:c.selectedCardId,contentType:Bt.CommentThread}:void 0,n));x().assertConditionTag(!1,"contentNavigationReason undefined when expecting to use content navigation",560756106)}var u=a?In(this.commentStore.getState()):pi(this.commentStore.getState()),l=Rd(d).nextPopulatedContextDetails,p=r.direction===Yt.Next,g=uo(d,!0,o);if(c!==void 0&&(a||Of(this.commentStore.getState(),c.selectedCardId))){var h=tt(pe(d),!0,o),v=void 0;!er(u)&&it()&&g&&c.selectedCardId===h?v=g.flatIndex+(p?-1:0):v=this.getSelectedThreadIndex(u);var y=void 0;if(er(u))if(a){var T=new xI(u,wt(d),v);y=p?T.next().value:T.previous().value}else y=u[v+(p?1:-1)];else{var T=new Uu(u,v,a),b=this.selectNextOrPreviousGetIdOrFocusCommandIfNecessary_deprecated(T,r,h,g,c,v,t,o);if(b&&typeof b!="string")return b;y=b}if(y)return this.selectThreadInCurrentContext(t,{renderContextType:o,trackback:C.reserveTag(593278816),telemetryVisitor:this.telemetryVisitor},y,r.expandCard,r.source);if(!r.restrictToCurrentContext)return this.selectAcrossContexts(t,r,o,l,a)}else{if(WC(a?In(this.commentStore.getState()):pi(this.commentStore.getState()),wt(d),a)||!sr()&&it()&&g)return this.selectFirstThreadInCurrentContext(t,r.expandCard,r.source,o,a);if(!r.restrictToCurrentContext&&l!==Ut.NoComments)return this.selectAcrossContexts(t,r,o,l,a)}},e.prototype.selectAcrossContexts=function(t,r,n,o,a){return this.useContentNavigationAPI&&!Ro(this.commentStore.getState())&&x().assertConditionTag(!1,"This method should not be used for DHC iteration across contexts when the content navigation API is being used.",560551957),r.direction===Yt.Next?o===Ut.OnlyCommentsInCurrent?this.selectFirstThreadInCurrentContext(t,r.expandCard,r.source,n,a):id(t,JS({renderContextType:n,trackback:C.reserveTag(593278817),telemetryVisitor:this.telemetryVisitor})):o===Ut.OnlyCommentsInCurrent?this.selectLastThreadInCurrentContext(t,r.expandCard,r.source,n,a):id(t,ZS({renderContextType:n,trackback:C.reserveTag(593278818),telemetryVisitor:this.telemetryVisitor}))},e.prototype.selectNextPostWithinCard=function(t,r,n){var o=Ie(this.commentStore.getState());if(o===void 0){x().assertConditionTag(!1,"Expected selectedComment",593278853);return}if(!at()){var a=wt(this.commentStore.getState()),d=this.getSelectedIndex(),c=void 0,u=void 0;if(ci(a)){var h=Un(this.commentStore.getState())[o.selectedCardId];h&&d<h.length-1&&(c=o.selectedCardId,u=h[d+1])}else{var l=new y3(a,d),p=l.next(),g=a[d];!p.done&&p.value.parentId&&p.value.parentId===Ze(g)&&(c=p.value.parentId,u=p.value.commentId)}return c&&u?this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278854),telemetryVisitor:this.telemetryVisitor},c,u,le.SharedComments):void 0}if(!n){x().assertConditionTag(!1,"renderableItems must not be undefined",593278855);return}var v=this.getSelectedIndexFromRenderableItems(n);if(v<0){x().assertConditionTag(!1,"Selection not found in renderableItems",571777352);return}var y=new C3(n,v),T=y.next(),b=n[v],I=_o(b);if(!T.done&&_o(T.value)===I)return this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278856),telemetryVisitor:this.telemetryVisitor},_o(T.value),co(T.value),le.SharedComments)},e.prototype.selectPreviousPostWithinCard=function(t,r,n){var o=Ie(this.commentStore.getState());if(o===void 0){x().assertConditionTag(!1,"Expected selectedComment",593278857);return}if(!at()){var a=wt(this.commentStore.getState()),d=this.getSelectedIndex(),c=void 0,u=void 0;if(ci(a)){var h=Un(this.commentStore.getState())[o.selectedCardId];h&&d>0&&(c=o.selectedCardId,u=h[d-1])}else{var l=a[d];if(l.parentId){var p=new y3(a,d),g=p.previous();!g.done&&Ze(g.value)===l.parentId&&(c=Ze(g.value),u=g.value.commentId)}}return c&&u?this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278858),telemetryVisitor:this.telemetryVisitor},c,u,le.SharedComments):void 0}if(!n){x().assertConditionTag(!1,"renderableItems must not be undefined",593278859);return}var v=this.getSelectedIndexFromRenderableItems(n);if(v<0){x().assertConditionTag(!1,"Selection not found in renderableItems",571777353);return}var y=n[v],T=zC(y);if(T){var p=new C3(n,v),g=p.previous();if(!g.done&&_o(g.value)===T)return this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278860),telemetryVisitor:this.telemetryVisitor},_o(g.value),co(g.value),le.SharedComments)}},e.prototype.selectRootPostOfSelectedThread=function(t,r){var n=Ie(this.commentStore.getState());if(n&&!et(n.selectionDetails))return this.selectPost(t,{renderContextType:r,trackback:C.reserveTag(593278861),telemetryVisitor:this.telemetryVisitor},n.selectedCardId,n.selectedCardId,le.SharedComments)},e.prototype.focusAndSelectSiblingThread=function(t,r){if(!(r<0)){var n=pi(this.commentStore.getState()),o=er(n)?n:n.filter(function(c){return!c.parentId});if(o.length!==0&&!(r===0&&o.length===1)){var a;r>o.length?(x().assertConditionTag(!1,"Passed in threadIndex too large.",526660886),a=o.length-1):r>=1?a=r-1:a=r+1;var d=er(o)?o[a]:o[a].commentId;return g3(void 0,nn(void 0,{componentType:X.Card,id:d,renderContextType:t}),id(void 0,fn({renderContextType:t,trackback:C.reserveTag(593278862),telemetryVisitor:this.telemetryVisitor},d,void 0,Ae.SelectCard,le.SharedComments)))}}},e.prototype.getSelectedIndex=function(){var t=this.commentStore.getState();return m7(wt(t),Un(t),Ie(t))},e.prototype.getSelectedThreadIndex=function(t){return p7(t,Ie(this.commentStore.getState()))},e.prototype.getSelectedIndexFromRenderableItems=function(t){var r=Ie(this.commentStore.getState());if(!r)return-1;var n=ui(r);return t.findIndex(function(o){return co(o)===n})},e}();var dye=15e3,BMe=500,uye=function(){function e(t,r){var n=this;this.isRTL=t,this.telemetryVisitor=r,this.focusToRetry=void 0,this.draftToFocus=void 0,this._commentStore=void 0,this.commandExecutor=sye(aye,[bo.FocusComponent]),this.pendingOnComponentFocusedRequest=void 0,this.clearPendingOnComponentFocusedRequest=function(o){var a=o?nl(o):"";n.pendingOnComponentFocusedRequest&&(a===""||a!==nl(n.pendingOnComponentFocusedRequest.targetedComponent))&&(cn&&It("Pending component focused request cleared."),clearTimeout(n.pendingOnComponentFocusedRequest.token),n.pendingOnComponentFocusedRequest=void 0)},this.commandOnWillFocusCallback=function(o){n.clearPendingOnComponentFocusedRequest(o)},this.commandExecuteCallback=function(o,a){!o||!bk(o)||(a===Pi.ShouldRetry?n.focusToRetry={command:o,timestamp:Date.now()}:a===Pi.Handled&&(n.focusToRetry=void 0))},this.commentContentsKeyDown=Ik(function(){return n.commentStore},this.isRTL,function(o){var a=pe(n.commentStore.getState());if(it()){var d=Ka(a);if(d&&o.isFocusOnOrWithin({componentType:X.CardEditor,id:d,renderContextType:a.drafts[a.cardIdToDraftIdMap[d]].renderContextType}))return!1;var c=Ds(a);if(c&&o.isFocusOnOrWithin({componentType:X.PostEditor,id:c,renderContextType:a.drafts[a.postIdToDraftIdMap[c]].renderContextType}))return!1}else if(jo(a))return!1;return!o.isFocusOn({componentType:X.GhostCard})},{ArrowDown:{handler:function(a,d,c){var u=n.onDownKey(a,d,c?c():void 0);return u&&(u.stopPropagation=!0,u.preventDefault=!0),u},phase:De.Bubbling},ArrowUp:{handler:function(a,d,c){var u=n.onUpKey(a,d,c?c():void 0);return u&&(u.stopPropagation=!0,u.preventDefault=!0),u},phase:De.Bubbling},ArrowRight:{handler:function(a,d){if(d.componentTreeId.renderContextType!==A.HalfPane){var c=n.onRightKey(a,d);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:De.Bubbling},ArrowLeft:{handler:function(a,d){if(d.componentTreeId.renderContextType!==A.HalfPane){var c=n.onLeftKey(a,d.componentTreeId.renderContextType);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:De.Bubbling},Home:{handler:function(a,d){if(d.componentTreeId.renderContextType===A.FullPane){var c=n.selectionCommandFactory.selectFirstThreadInCurrentContext(a,!0,le.SharedComments,d.componentTreeId.renderContextType,!1);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:De.Capturing},End:{handler:function(a,d){if(d.componentTreeId.renderContextType===A.FullPane){var c=n.selectionCommandFactory.selectLastThreadInCurrentContext(a,!0,le.SharedComments,d.componentTreeId.renderContextType,!1);return c&&(c.stopPropagation=!0,c.preventDefault=!0),c}},phase:De.Capturing},F12:{handler:function(a,d){var c=a.altKey?n.handleMoveFocusEvent(a,d):void 0;return c&&(c.stopPropagation=!0),c},phase:De.None},Escape:{handler:function(a,d){var c=Q()==="win32"?n.handleMoveFocusEvent(a,d):void 0;return c&&(c.stopPropagation=!0),c},phase:De.None}},this.commandExecutor),this.focusCommentCardCommand=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d=pe(n.commentStore.getState()),c=Ye(d),u=void 0;return(u=n.checkForRetryOfEditorFocus(o,d))||!it()&&(c==null?void 0:c.threadId)===a&&(u=n.checkForActiveEditorFocus(void 0,o.componentTreeId.renderContextType,d),u)?u:nn(void 0,{componentType:Oc(a,d),id:a,renderContextType:o.componentTreeId.renderContextType},{priorityArgs:{priority:1},preventScroll:o.componentTreeId.renderContextType===A.DiscreteIntegrated})},this.commandExecutor),this.focusCommentPostCommand=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d=pe(n.commentStore.getState());if(!it()&&d.postIdToDraftIdMap[a]){var c=n.checkForActiveEditorFocus(void 0,o.componentTreeId.renderContextType,d);if(c)return c}return nn(void 0,{componentType:X.Post,id:a,renderContextType:o.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:1}})},this.commandExecutor),this.focusCommentPaneCommand=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o){if(!Kt(o.componentTreeId.renderContextType)){x().assertConditionTag(!1,"paneContainerFocusHandler called outside of a pane render context",575239242);return}var a=pe(n.commentStore.getState()),d=void 0;if(d=n.checkForRetryOfEditorFocus(o,a))return d;if(!(o.isFocusWithinPane()&&!o.isFocusOn({componentType:X.PaneRoot}))){if(!it()&&(d=n.checkForActiveEditorFocus(void 0,o.componentTreeId.renderContextType,a)))return d;var c=oE(nE())(n.commentStore.getState());if(d=n.checkForCommentSelectionFocus(o.componentTreeId.renderContextType,c,a))return d;if(!Au()&&!o.getComponent(X.ClosePaneButton)){var u=pi(n.commentStore.getState());if(u.length>0)return n.focusCommentCardCommand.processCommand(o,er(u)?u[0]:u[0].commentId);x().assertConditionTag(Q()==="win32","Shouldn't be reached on current config",575239243);return}return Sk(o,n.commentStore)}},this.commandExecutor),this.commentCardMounted=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d=pe(n.commentStore.getState()),c={componentType:Oc(a.id,d),id:a.id,renderContextType:o.componentTreeId.renderContextType},u=void 0;if(u=n.handleFocusRetry(o,c,d,1))return u;if(a.selected&&!o.isFocusWithin(c)){var l=Kt(o.componentTreeId.renderContextType);if(!(l&&!o.isFocusWithinPane())&&(l||o.isFocusWithinAny(X.Card)||o.isFocusWithinAny(X.DraftCard)))return n.focusCommentCardCommand.processCommand(o,a.id)}},this.commandExecutor),this.commentCardEditorMounted=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){return n.handleFocusRetry(o,{componentType:X.CardEditor,id:a,renderContextType:o.componentTreeId.renderContextType},pe(n.commentStore.getState()),1)},this.commandExecutor),this.commentPostMounted=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){return n.handleFocusRetry(o,{componentType:X.Post,id:a,renderContextType:o.componentTreeId.renderContextType},pe(n.commentStore.getState()),1)},this.commandExecutor),this.commentPostEditorMounted=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){return n.handleFocusRetry(o,{componentType:X.PostEditor,id:a,renderContextType:o.componentTreeId.renderContextType},pe(n.commentStore.getState()),1)},this.commandExecutor),this.commentPanePropsUpdated=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a,d){var c=void 0;if(c=n.checkForRetryCommandOnPropsUpdated(o,d.draftState,!1))return c;var u=a.draftState,l=d.draftState,p=a.selectedComment,g=d.selectedComment;if((c=n.checkForDiscard(o,u,l,p,g))||(c=n.checkForHalfPaneFullTransition(o,a,d)))return c;if(o.isFocusWithinPane())return(c=n.checkForLowFidelityWarning(o,p,g))||(c=n.checkForSelectionChange(o,l,p,g))||(c=n.checkForCardPendingChange(o,a.cardViewStates,d.cardViewStates,l))||(c=n.checkForReplyFinished(o,g,a.draftState,d.draftState,g&&d.cardViewStates[g.selectedCardId]))?c:n.checkForLowFidelityWarning(o,p,g)},this.commandExecutor),this.discreteCommentCardRootRefMounted=function(o){CY(o)},this.discreteCommentCardPropsUpdated=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a,d){var c=void 0;if((c=n.checkForRetryCommandOnDiscreteCardPropsUpdated(o,d))||(c=n.checkForDiscard(o,a.draftState,d.draftState,a.selectedState,d.selectedState)))return c;if(o.isFocusWithinAny(X.Card)||o.isFocusWithinAny(X.DraftCard))return n.shouldFocusFromCardPendingStateChange(a.cardState,d.cardState)?nn(void 0,{renderContextType:o.componentTreeId.renderContextType,componentType:Lf(d.isDraftThread),id:d.threadId}):(c=n.checkForLowFidelityWarning(o,a.selectedState,d.selectedState))||(c=n.checkForSelectionChange(o,d.draftState,a.selectedState,d.selectedState))||(c=n.checkForReplyFinished(o,d.selectedState,a.draftState,d.draftState,d.cardState))?c:n.checkForLowFidelityWarning(o,a.selectedState,d.selectedState)},this.commandExecutor),this.paneContainerKeyDown=Ik(function(){return n.commentStore},this.isRTL,function(o){return Kt(o.componentTreeId.renderContextType)?!0:(x().assertConditionTag(!1,"paneContainerKeyDownHandler called outside of a pane render context",575239244),!1)},{Escape:{handler:function(a,d){return id(a,Hu({renderContextType:d.componentTreeId.renderContextType,trackback:C.reserveTag(575239245),telemetryVisitor:n.telemetryVisitor}))},phase:De.Capturing},Tab:{handler:function(a,d){return n.paneContainerTabHandling(a,d)},phase:De.None}},this.commandExecutor),this.commentEditorKeyDown=Ik(function(){return n.commentStore},this.isRTL,function(){return!0},{F12:{handler:function(a,d){var c=a.altKey?n.handleMoveFocusEvent(a,d):void 0;return c&&(c.stopPropagation=!0),c},phase:De.None}},this.commandExecutor),this.onUserAction=ad(function(){return n.commentStore},this.commandExecuteCallback,this.commandOnWillFocusCallback,function(o,a){var d;switch(a.userAction){case Pn.RequestNewCommentFromHost:return Kt(o.componentTreeId.renderContextType)?Sk(o,n.commentStore):void 0;case Pn.CancelReplyDraft:return nn(void 0,{componentType:X.Card,id:a.cardId,renderContextType:o.componentTreeId.renderContextType});case Pn.DeleteThread:case Pn.CancelNewThreadDraft:return!Kt(o.componentTreeId.renderContextType)||o.componentTreeId.renderContextType===A.HalfPane&&a.userAction===Pn.CancelNewThreadDraft?void 0:(d=Sk(o,n.commentStore,{priority:3,phase:0}))!==null&&d!==void 0?d:n.selectionCommandFactory.focusAndSelectSiblingThread(o.componentTreeId.renderContextType,a.threadIndex);case Pn.ResolveThread:return Q()!=="android"?void 0:nn(void 0,{componentType:X.ReopenThreadButton,id:a.cardId,renderContextType:o.componentTreeId.renderContextType},{priorityArgs:{priority:2,phase:3}});default:Me(a)}},this.commandExecutor)}return e.prototype.postOnComponentFocusedRequest=function(t,r){this.clearPendingOnComponentFocusedRequest();var n=setTimeout(r,BMe);this.pendingOnComponentFocusedRequest={callback:r,token:n,targetedComponent:t},cn&&It("Pending component focused request added for ".concat(nl(t),"."))},e.prototype.initialize=function(t,r,n){if(this._commentStore)throw new ge("FocusManager already initialized",C.reserveTag(575239239),-2130957489);this._commentStore=t,this.selectionCommandFactory=n??new Ek(t,this.telemetryVisitor,r)},Object.defineProperty(e.prototype,"commentStore",{get:function(){if(!this._commentStore)throw new ge("FocusManager not initialized",C.reserveTag(575239240),-2130957490);return this._commentStore},enumerable:!1,configurable:!0}),e.prototype.setDeferredActiveEditorFocusCommand=function(t){this.draftToFocus={draftId:t,timestamp:Date.now(),isPendingSetFocus:!0}},e.prototype.handleFocusRetry=function(t,r,n,o){var a=void 0;if(a=this.checkForRetryOfEditorFocus(t,n))return a;if(!(!this.focusToRetry||!r)){var d=this.focusToRetry.command.component,c=Date.now()-this.focusToRetry.timestamp;if(c>dye){x().assertConditionTag(!1,"Took too long to mount component type ".concat(d.componentType," for focus retry: ").concat(c," ms"),575239241),this.focusToRetry=void 0;return}if(this.shouldRetryFocusForPhase(this.focusToRetry,o)&&Z7(d,r)){var u=this.focusToRetry.command;return this.focusToRetry=void 0,u}}},e.prototype.shouldArrowNavigatePosts=function(t,r,n){return da(t.selectedCardId,r,n.componentTreeId.renderContextType)===Rt.Collapsed||t.selectedCardId===tt(pe(this.commentStore.getState()))?!1:n.isFocusWithinAny(X.Post)},e.prototype.onDownKey=function(t,r,n){var o=qt()&&!Ro(this.commentStore.getState()),a=Ie(this.commentStore.getState()),d=ia(this.commentStore.getState());if(a){if(!this.shouldArrowNavigatePosts(a,d,r)){if(r.componentTreeId.renderContextType===A.DiscreteIsolated)return;var c={direction:Yt.Next,source:le.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(t,c,ca.Keyboarding,r.componentTreeId.renderContextType,o)}return this.selectionCommandFactory.selectNextPostWithinCard(t,r.componentTreeId.renderContextType,n)}if(r.componentTreeId.renderContextType===A.DiscreteIsolated){x().assertConditionTag(!1,"selectedComment missing on down key handler for DiscreteIsolated card",575239249);return}return this.selectionCommandFactory.selectFirstThreadInCurrentContext(t,!1,le.SharedComments,r.componentTreeId.renderContextType,o)},e.prototype.onUpKey=function(t,r,n){var o=qt()&&!Ro(this.commentStore.getState()),a=Ie(this.commentStore.getState()),d=ia(this.commentStore.getState());if(a){if(!this.shouldArrowNavigatePosts(a,d,r)){if(r.componentTreeId.renderContextType===A.DiscreteIsolated)return;var c={direction:Yt.Previous,source:le.SharedComments,expandCard:!1,restrictToCurrentContext:!0,iterableContentTypes:void 0};return this.selectionCommandFactory.selectNextOrPreviousThread(t,c,ca.Keyboarding,r.componentTreeId.renderContextType,o)}return this.selectionCommandFactory.selectPreviousPostWithinCard(t,r.componentTreeId.renderContextType,n)}if(r.componentTreeId.renderContextType===A.DiscreteIsolated){x().assertConditionTag(!1,"selectedComment missing on up key handler for DiscreteIsolated card",575239250);return}return this.selectionCommandFactory.selectFirstThreadInCurrentContext(t,!1,le.SharedComments,r.componentTreeId.renderContextType,o)},e.prototype.onRightKey=function(t,r){var n=Ie(this.commentStore.getState());if(!(it()&&n&&n.selectedCardId===tt(pe(this.commentStore.getState())))){var o=this.selectionCommandFactory.selectRootPostOfSelectedThread(t,r.componentTreeId.renderContextType);if(o||(n&&et(n.selectionDetails)&&r.isFocusOn({componentType:X.Card,id:n.selectedCardId,renderContextType:r.componentTreeId.renderContextType})&&(o=this.focusCommentPostCommand.processCommand(r,n.selectionDetails.selectedPostId)),o))return o}},e.prototype.onLeftKey=function(t,r){return this.selectionCommandFactory.focusAndCollapseSelectedThread(t,r)},e.prototype.onTabKeyInPane=function(t,r){var n=Ie(this.commentStore.getState());if((n===void 0||!Of(this.commentStore.getState(),n.selectedCardId))&&k7(this.commentStore.getState()))return this.selectionCommandFactory.selectFirstThreadInCurrentContext(t,!1,le.SharedComments,r,!1);if(!it())return this.checkForActiveEditorFocus(t,r,pe(this.commentStore.getState()))},e.prototype.isDraftInOtherContext=function(){var t=En(this.commentStore.getState());return!!t&&!t.isInCurrentContext},e.prototype.logEditorRetryError=function(t,r,n,o){var a,d,c;(d=(a=x()).logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(cye||(cye=zt(["CommentsEditorFocusRetry"],["CommentsEditorFocusRetry"]))),o,xt.Info,mt.ProductServiceUsage,this.telemetryVisitor,Vr("RenderContextType",r.componentTreeId.renderContextType,N.SystemMetadata),Vr("IsDraftInCurrentContext",!!t&&t.isInCurrentContext,N.SystemMetadata),Vr("DraftRenderContextType",(c=t==null?void 0:t.renderContextType)!==null&&c!==void 0?c:A.None,N.SystemMetadata),Vr("ComponentType",n??0,N.SystemMetadata))},e.prototype.checkForRetryOfEditorFocus=function(t,r){var n=this;if(this.draftToFocus!==void 0){if(!this.draftToFocus.isPendingSetFocus)return{causedBy:void 0,type:bo.PreserveFocus,priorityArgs:{priority:1}};var o=r.drafts[this.draftToFocus.draftId],a=Date.now()-this.draftToFocus.timestamp;if(a>dye){x().assertConditionTag(!1,"Took too long to focus draft editor: ".concat(a," ms, expected draft still exists: ").concat(!!o),575239251),this.draftToFocus=void 0,this.logEditorRetryError(o,t,void 0,C.reserveTag(556607431));return}if(!o||o.renderContextType!==t.componentTreeId.renderContextType){this.logEditorRetryError(o,t,void 0,C.reserveTag(556794945));return}var d=this.checkForActiveEditorFocus(void 0,t.componentTreeId.renderContextType,r,{priority:2,phase:0});if(d&&h3(t,d.component))return this.draftToFocus=m(m({},this.draftToFocus),{isPendingSetFocus:!1}),setTimeout(function(){return n.draftToFocus=void 0}),this.clearPendingOnComponentFocusedRequest(),d;this.logEditorRetryError(o,t,d==null?void 0:d.component.componentType,C.reserveTag(556794947))}},e.prototype.checkForActiveEditorFocus=function(t,r,n,o){if(o===void 0&&(o={priority:1}),!this.isDraftInOtherContext()){var a=Ds(n);if(a)return nn(t,{componentType:X.PostEditor,id:a,renderContextType:r},{priorityArgs:o});var d=Ka(n);if(d)return nn(t,{componentType:X.CardEditor,id:d,renderContextType:r},{priorityArgs:o})}},e.prototype.handleMoveFocusEvent=function(t,r){var n=Ie(this.commentStore.getState()),o=n?{contentId:n==null?void 0:n.selectedCardId,contentType:Bt.CommentThread}:void 0;return id(t,BS({renderContextType:r.componentTreeId.renderContextType,trackback:C.reserveTag(575239252),telemetryVisitor:this.telemetryVisitor},o))},e.prototype.checkForCommentSelectionFocus=function(t,r,n){if(!(!it()&&this.isDraftInOtherContext())&&r&&r.selectedCardId)return nn(void 0,{componentType:Oc(r.selectedCardId,n),id:r.selectedCardId,renderContextType:t},{priorityArgs:{priority:2,phase:1}})},e.prototype.checkForDiscard=function(t,r,n,o,a){if(Q()!=="web"&&!(!o||!a)){var d=o.selectionDetails,c=a.selectionDetails;if(MC(r)&&!jo(n))return this.focusCommentCardCommand.processCommand(t,a.selectedCardId);if(et(d)===et(c)&&o.selectedCardId===a.selectedCardId&&GI(r,n)){if(!et(d)||!et(c))return nn(void 0,{componentType:X.CardEditor,id:a.selectedCardId,renderContextType:t.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}});if(d.selectedPostId===c.selectedPostId)return nn(void 0,{componentType:X.PostEditor,id:c.selectedPostId,renderContextType:t.componentTreeId.renderContextType},{priorityArgs:{priority:3,phase:1}})}}},e.prototype.paneContainerTabHandling=function(t,r){if(Q()!=="win32"){var n=this.commentStore.getState(),o=Lr(n).virtualized;if(!qu(Li(n),o,!!tr(n))){var a=nn(t,{componentType:X.ClosePaneButton});return a.stopPropagation=!0,a.preventDefault=!0,a}var d=r.getComponent(X.ClosePaneButton),c=r.getComponent(X.NewCommentButton),u=r.getComponent(X.FilterButton),l=Lr(n).newThread,p=tr(n),g=p&&u?u:l&&c?c:d;if(fe()){var h=Ie(n),v=pe(n),a=void 0;return!h||!Of(n,h.selectedCardId)?g&&t.isEventTarget(g)&&!t.shiftKey&&(a=this.onTabKeyInPane(t,r.componentTreeId.renderContextType)):!it()&&!r.isFocusWithin({componentType:Oc(h.selectedCardId,v),id:h.selectedCardId,renderContextType:r.componentTreeId.renderContextType})&&(a=this.checkForActiveEditorFocus(t,r.componentTreeId.renderContextType,v)),a&&(a.stopPropagation=!0,a.preventDefault=!0),a}if(d&&t.isEventTarget(d)&&t.shiftKey){var a=this.onTabKeyInPane(t,r.componentTreeId.renderContextType);return a&&(a.preventDefault=!0,a.stopPropagation=!0),a}if(g&&t.isEventTarget(g)&&!t.shiftKey){var a=this.onTabKeyInPane(t,r.componentTreeId.renderContextType);return a&&(a.preventDefault=!0,a.stopPropagation=!0),a}}},e.prototype.checkForSelectionChange=function(t,r,n,o){if(o){var a=!n||ui(n)!==ui(o)||et(n.selectionDetails)!==et(o.selectionDetails);if(a&&(this.clearPendingOnComponentFocusedRequest(),!(!it()&&fr(r))&&!(t.isFocusOn({componentType:X.NextCommentButton})||t.isFocusOn({componentType:X.PreviousCommentButton})))){if(!et(o.selectionDetails))return t.isFocusOnOrWithin({componentType:o.selectedCardId!==(n==null?void 0:n.selectedCardId)?Oc(o.selectedCardId,r):X.CardEditor,id:o.selectedCardId,renderContextType:t.componentTreeId.renderContextType},!0)?void 0:this.focusCommentCardCommand.processCommand(t,o.selectedCardId);if(!t.isFocusOnOrWithin({componentType:X.Post,id:o.selectionDetails.selectedPostId,renderContextType:t.componentTreeId.renderContextType}))return this.focusCommentPostCommand.processCommand(t,o.selectionDetails.selectedPostId)}}},e.prototype.checkForReplyFinished=function(t,r,n,o,a){var d=Ka(n),c=Ka(o);if(!(!a||a.pending===lt.Editor)&&d&&!c&&(r==null?void 0:r.selectedCardId)===d&&t.isFocusWithin({componentType:X.Card,id:d,renderContextType:t.componentTreeId.renderContextType}))return this.focusCommentCardCommand.processCommand(t,d)},e.prototype.checkForHalfPaneFullTransition=function(t,r,n){if(!(t.componentTreeId.renderContextType!==A.HalfPane||!Nu(n.displayConfigurationState)||n.displayConfigurationState.displayMode!==oo.Normal)&&!(Nu(r.displayConfigurationState)&&r.displayConfigurationState.displayMode!==oo.Variable))return nn(void 0,{componentType:X.ClosePaneButton})},e.prototype.shouldFocusFromCardPendingStateChange=function(t,r){return t?t.pending!==r.pending&&r.pending!==lt.Editor:!1},e.prototype.checkForCardPendingChange=function(t,r,n,o){var a=this,d=Object.entries(n).find(function(c){var u=r[c[0]];return a.shouldFocusFromCardPendingStateChange(u,c[1])});if(d)return nn(void 0,{renderContextType:t.componentTreeId.renderContextType,componentType:Oc(d[0],o),id:d[0]})},e.prototype.checkForRetryCommandOnPropsUpdated=function(t,r,n){var o=!n&&this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&h3(t,this.focusToRetry.command.component)?this.focusToRetry.command.component:void 0;return this.handleFocusRetry(t,o,r,2)},e.prototype.checkForRetryCommandOnDiscreteCardPropsUpdated=function(t,r){var n=this.focusToRetry&&this.shouldRetryFocusForPhase(this.focusToRetry,2)&&(!Dd(this.focusToRetry.command.component)||!J7(this.focusToRetry.command.component.componentType)||this.focusToRetry.command.component.id===r.threadId),o=this.draftToFocus&&(r.cardRelativeDraftingState===cr.InCard||r.cardRelativeDraftingState===cr.InChildPost);if(!(!n&&!o))return this.checkForRetryCommandOnPropsUpdated(t,r.draftState,!n)},e.prototype.checkForLowFidelityWarning=function(t,r,n){if(n&&(fe()?_s(n):Bm(n))){var o=r?ui(r):void 0,a=ui(n);if(a!==o||n.selectionDetails.lowFidelityWarningType!==(r==null?void 0:r.selectionDetails.lowFidelityWarningType))return nn(void 0,{componentType:X.Post,renderContextType:t.componentTreeId.renderContextType,id:a})}},e.prototype.shouldRetryFocusForPhase=function(t,r){return t.command.priorityArgs.priority!==1&&(t.command.priorityArgs.phase&r)!==0},e}();var cye;s();k();Ml();s();function lye(e){var t=function(n){var o=n.dispatch,a=n.getState;return function(d){return function(c){return typeof c=="function"?c(o,a,e):d(c)}}};return t}var fye=lye();fye.withExtraArgument=lye;var pye=fye;s();Ml();s();s();var UMe=re(),mye=UMe.unstable_batchedUpdates;var gye=function(){return function(t){return function(r){return mye(function(){return t(r)})}}};s();ne();var hye=function(){return function(t){return function(r){var n=typeof r.type=="string"?r.type:r.name||"Unknown Action",o=wy(Ql.Redux,n),a=t(r);return o==null||o.end(),a}}};s();ne();Ml();km();s();k();ne();rt();te();s();function gs(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map(function(o){return"'"+o+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function em(e){return!!e&&!!e[Zi]}function tm(e){var t;return!!e&&(function(r){if(!r||typeof r!="object")return!1;var n=Object.getPrototypeOf(r);if(n===null)return!0;var o=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;return o===Object||typeof o=="function"&&Function.toString.call(o)===YMe}(e)||Array.isArray(e)||!!e[Iye]||!!(!((t=e.constructor)===null||t===void 0)&&t[Iye])||R3(e)||A3(e))}function Eye(e){return em(e)||gs(23,e),e[Zi].t}function LT(e,t,r){r===void 0&&(r=!1),by(e)===0?(r?Object.keys:O3)(e).forEach(function(n){r&&typeof n=="symbol"||t(n,e[n],e)}):e.forEach(function(n,o){return t(o,n,e)})}function by(e){var t=e[Zi];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:R3(e)?2:A3(e)?3:0}function S3(e,t){return by(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function VMe(e,t){return by(e)===2?e.get(t):e[t]}function Pye(e,t,r){var n=by(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function jMe(e,t){return e===t?e!==0||1/e==1/t:e!=e&&t!=t}function R3(e){return qMe&&e instanceof Map}function A3(e){return KMe&&e instanceof Set}function Zp(e){return e.o||e.t}function k3(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=$Me(e);delete t[Zi];for(var r=O3(t),n=0;n<r.length;n++){var o=r[n],a=t[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[o]})}return Object.create(Object.getPrototypeOf(e),t)}function D3(e,t){return t===void 0&&(t=!1),w3(e)||em(e)||!tm(e)||(by(e)>1&&(e.set=e.add=e.clear=e.delete=WMe),Object.freeze(e),t&&LT(e,function(r,n){return D3(n,!0)},!0)),e}function WMe(){gs(2)}function w3(e){return e==null||typeof e!="object"||Object.isFrozen(e)}function uc(e){var t=QMe[e];return t||gs(18,e),t}function yye(){return HT}function v3(e,t){t&&(uc("Patches"),e.u=[],e.s=[],e.v=t)}function Pk(e){I3(e),e.p.forEach(zMe),e.p=null}function I3(e){e===HT&&(HT=e.l)}function Cye(e){return HT={p:[],l:HT,h:e,m:!0,_:0}}function zMe(e){var t=e[Zi];t.i===0||t.i===1?t.j():t.O=!0}function x3(e,t){t._=t.p.length;var r=t.p[0],n=e!==void 0&&e!==r;return t.h.g||uc("ES5").S(t,e,n),n?(r[Zi].P&&(Pk(t),gs(4)),tm(e)&&(e=_k(t,e),t.l||Rk(t,e)),t.u&&uc("Patches").M(r[Zi].t,e,t.u,t.s)):e=_k(t,r,[]),Pk(t),t.u&&t.v(t.u,t.s),e!==_ye?e:void 0}function _k(e,t,r){if(w3(t))return t;var n=t[Zi];if(!n)return LT(t,function(c,u){return vye(e,n,t,c,u,r)},!0),t;if(n.A!==e)return t;if(!n.P)return Rk(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var o=n.i===4||n.i===5?n.o=k3(n.k):n.o,a=o,d=!1;n.i===3&&(a=new Set(o),o.clear(),d=!0),LT(a,function(c,u){return vye(e,n,o,c,u,r,d)}),Rk(e,o,!1),r&&e.u&&uc("Patches").N(n,r,e.u,e.s)}return n.o}function vye(e,t,r,n,o,a,d){if(em(o)){var c=_k(e,o,a&&t&&t.i!==3&&!S3(t.R,n)?a.concat(n):void 0);if(Pye(r,n,c),!em(c))return;e.m=!1}else d&&r.add(o);if(tm(o)&&!w3(o)){if(!e.h.D&&e._<1)return;_k(e,o),t&&t.A.l||Rk(e,o)}}function Rk(e,t,r){r===void 0&&(r=!1),!e.l&&e.h.D&&e.m&&D3(t,r)}function T3(e,t){var r=e[Zi];return(r?Zp(r):e)[t]}function xye(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function E3(e){e.P||(e.P=!0,e.l&&E3(e.l))}function b3(e){e.o||(e.o=k3(e.t))}function P3(e,t,r){var n=R3(t)?uc("MapSet").F(t,r):A3(t)?uc("MapSet").T(t,r):e.g?function(o,a){var d=Array.isArray(o),c={i:d?1:0,A:a?a.A:yye(),P:!1,I:!1,R:{},l:a,t:o,k:null,o:null,j:null,C:!1},u=c,l=_3;d&&(u=[c],l=MT);var p=Proxy.revocable(u,l),g=p.revoke,h=p.proxy;return c.k=h,c.j=g,h}(t,r):uc("ES5").J(t,r);return(r?r.A:yye()).p.push(n),n}function GMe(e){return em(e)||gs(22,e),function t(r){if(!tm(r))return r;var n,o=r[Zi],a=by(r);if(o){if(!o.P&&(o.i<4||!uc("ES5").K(o)))return o.t;o.I=!0,n=Tye(r,a),o.I=!1}else n=Tye(r,a);return LT(n,function(d,c){o&&VMe(o.t,d)===c||Pye(n,d,t(c))}),a===3?new Set(n):n}(e)}function Tye(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return k3(e)}var bye,HT,F3=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",qMe=typeof Map<"u",KMe=typeof Set<"u",Sye=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",_ye=F3?Symbol.for("immer-nothing"):((bye={})["immer-nothing"]=!0,bye),Iye=F3?Symbol.for("immer-draftable"):"__$immer_draftable",Zi=F3?Symbol.for("immer-state"):"__$immer_state";var YMe=""+Object.prototype.constructor,O3=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,$Me=Object.getOwnPropertyDescriptors||function(e){var t={};return O3(e).forEach(function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)}),t},QMe={},_3={get:function(t,r){if(r===Zi)return t;var n=Zp(t);if(!S3(n,r))return function(a,d,c){var u,l=xye(d,c);return l?"value"in l?l.value:(u=l.get)===null||u===void 0?void 0:u.call(a.k):void 0}(t,n,r);var o=n[r];return t.I||!tm(o)?o:o===T3(t.t,r)?(b3(t),t.o[r]=P3(t.A.h,o,t)):o},has:function(t,r){return r in Zp(t)},ownKeys:function(t){return Reflect.ownKeys(Zp(t))},set:function(t,r,n){var o=xye(Zp(t),r);if(o!=null&&o.set)return o.set.call(t.k,n),!0;if(!t.P){var a=T3(Zp(t),r),d=a==null?void 0:a[Zi];if(d&&d.t===n)return t.o[r]=n,t.R[r]=!1,!0;if(jMe(n,a)&&(n!==void 0||S3(t.t,r)))return!0;b3(t),E3(t)}return t.o[r]===n&&(n!==void 0||r in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[r])||(t.o[r]=n,t.R[r]=!0),!0},deleteProperty:function(t,r){return T3(t.t,r)!==void 0||r in t.t?(t.R[r]=!1,b3(t),E3(t)):delete t.R[r],t.o&&delete t.o[r],!0},getOwnPropertyDescriptor:function(t,r){var n=Zp(t),o=Reflect.getOwnPropertyDescriptor(n,r);return o&&{writable:!0,configurable:t.i!==1||r!=="length",enumerable:o.enumerable,value:n[r]}},defineProperty:function(){gs(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){gs(12)}},MT={};LT(_3,function(e,t){MT[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),MT.deleteProperty=function(e,t){return MT.set.call(this,e,t,void 0)},MT.set=function(e,t,r){return _3.set.call(this,e[0],t,r,e[0])};var XMe=function(){function e(r){var n=this;this.g=Sye,this.D=!0,this.produce=function(o,a,d){if(typeof o=="function"&&typeof a!="function"){var c=a;a=o;var u=n;return function(T){var b=this;T===void 0&&(T=c);for(var I=arguments.length,E=Array(I>1?I-1:0),P=1;P<I;P++)E[P-1]=arguments[P];return u.produce(T,function(_){var D;return(D=a).call.apply(D,[b,_].concat(E))})}}var l;if(typeof a!="function"&&gs(6),d!==void 0&&typeof d!="function"&&gs(7),tm(o)){var p=Cye(n),g=P3(n,o,void 0),h=!0;try{l=a(g),h=!1}finally{h?Pk(p):I3(p)}return typeof Promise<"u"&&l instanceof Promise?l.then(function(T){return v3(p,d),x3(T,p)},function(T){throw Pk(p),T}):(v3(p,d),x3(l,p))}if(!o||typeof o!="object"){if((l=a(o))===void 0&&(l=o),l===_ye&&(l=void 0),n.D&&D3(l,!0),d){var v=[],y=[];uc("Patches").M(o,l,v,y),d(v,y)}return l}gs(21,o)},this.produceWithPatches=function(o,a){if(typeof o=="function")return function(l){for(var p=arguments.length,g=Array(p>1?p-1:0),h=1;h<p;h++)g[h-1]=arguments[h];return n.produceWithPatches(l,function(v){return o.apply(void 0,[v].concat(g))})};var d,c,u=n.produce(o,a,function(l,p){d=l,c=p});return typeof Promise<"u"&&u instanceof Promise?u.then(function(l){return[l,d,c]}):[u,d,c]},typeof(r==null?void 0:r.useProxies)=="boolean"&&this.setUseProxies(r.useProxies),typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze)}var t=e.prototype;return t.createDraft=function(r){tm(r)||gs(8),em(r)&&(r=GMe(r));var n=Cye(this),o=P3(this,r,void 0);return o[Zi].C=!0,I3(n),o},t.finishDraft=function(r,n){var o=r&&r[Zi],a=o.A;return v3(a,n),x3(void 0,a)},t.setAutoFreeze=function(r){this.D=r},t.setUseProxies=function(r){r&&!Sye&&gs(20),this.g=r},t.applyPatches=function(r,n){var o;for(o=n.length-1;o>=0;o--){var a=n[o];if(a.path.length===0&&a.op==="replace"){r=a.value;break}}o>-1&&(n=n.slice(o+1));var d=uc("Patches").$;return em(r)?d(r,n):this.produce(r,function(c){return d(c,n)})},e}(),_a=new XMe,JMe=_a.produce,QDr=_a.produceWithPatches.bind(_a),XDr=_a.setAutoFreeze.bind(_a),JDr=_a.setUseProxies.bind(_a),ZDr=_a.applyPatches.bind(_a),ewr=_a.createDraft.bind(_a),twr=_a.finishDraft.bind(_a),BT=JMe;Es();df();Tc();Sc();Rw();xf();ii();hS();s();var ti;(function(e){e[e.None=0]="None",e[e.AtMentionKnown=1]="AtMentionKnown",e[e.AtMentionEnabled=2]="AtMentionEnabled",e[e.NewThread=4]="NewThread",e[e.Resolve=8]="Resolve",e[e.Virtualized=16]="Virtualized",e[e.TasksKnown=32]="TasksKnown",e[e.TasksEnabled=64]="TasksEnabled",e[e.PresentLinkToComment=128]="PresentLinkToComment",e[e.AtMentionEmailAddresses=256]="AtMentionEmailAddresses",e[e.UIAAnnotationPattern=1048576]="UIAAnnotationPattern",e[e.ContentExtensionHostingDisabled=2097152]="ContentExtensionHostingDisabled"})(ti||(ti={}));ln();Di();Ve();lr();Pr();Zm();li();s();k();Is();yt();io();function Ak(e,t){for(var r=t==null?void 0:t(),n=[],o=0,a=void 0;o<e.length;){if(e[o].type===ff.Thread){var d=e[o].id;a=d,n.push(N3(d,void 0,r))}else n.push(N3(e[o].id,a,r));o++}return n}function Rye(e){return e.map(function(t){return N3(t,void 0,void 0)})}function N3(e,t,r){var n=void 0;return r&&(n=Or(Dc(r),e)),n||m(m({},qI(e)),{parentId:t??""})}FC();s();var Aye={isRightToLeft:!1,dataCulture:"",uiCulture:""};Jt();vs();ye();Cr();km();s();k();ne();rt();te();ii();zu();Rf();qm();yt();s();ne();te();Tc();xf();ii();Rf();so();yt();LC();function hs(e,t){var r=Eye(e);if(!r){x().assertConditionTag(!1,"immerDraft does not have original state",t);return}return r}function kk(e,t,r){var n=!1;if(yr(t)){var o=r===void 0;if(r){var a=ZMe(e.commentThreadIds,e.cardPostIds,r);n=!!a.beforeDraft,a.insertThreadIndex>=0?e.commentThreadIds.splice(a.insertThreadIndex,0,t.commentId):(x().assertConditionTag(!1,"Invalid thread insert flat index.",512508103),o=!0)}o&&e.commentThreadIds.push(t.commentId),e.cardPostIds[t.commentId]=[t.commentId]}else if(e.cardPostIds[t.parentId])if(r){var d=e2e(t.parentId,e.commentThreadIds,e.cardPostIds,r.draftIdToSkip);n=!!d.beforeDraft;var c=r.insertFlatIndex-d.flatIndex;x().assertConditionTag(c>=1&&c<=e.cardPostIds[t.parentId].length,"Invalid insert post index.",520646683),c=Math.max(Math.min(c,e.cardPostIds[t.parentId].length),1),e.cardPostIds[t.parentId].splice(c,0,t.commentId)}else e.cardPostIds[t.parentId].push(t.commentId);else{x().assertConditionTag(!1,"Orphaned post detected on processing comments array. Omitting storing data.",526242826);return}e.postData[t.commentId]=t,r!=null&&r.draftIdToSkip&&e.createdCommentLie&&n&&e.createdCommentLie.flatIndex++}function ZMe(e,t,r){if(r.insertFlatIndex<0)return{insertThreadIndex:-1};for(var n=r!=null&&r.draftIdToSkip?!0:void 0,o=0,a=0;a<e.length;a++){if(o===r.insertFlatIndex)return{insertThreadIndex:a,beforeDraft:n};if(e[a]===r.draftIdToSkip){n=!1;continue}if(o+=t[e[a]].length,r.insertFlatIndex<=o)return{insertThreadIndex:a+1,beforeDraft:n}}return o===r.insertFlatIndex?{insertThreadIndex:e.length,beforeDraft:n}:{insertThreadIndex:-1}}function e2e(e,t,r,n){for(var o=n?!0:void 0,a=0,d=0;d<t.length;d++){if(t[d]===e)return{flatIndex:a,beforeDraft:o};if(t[d]===n){o=!1;continue}a+=r[t[d]].length}return{flatIndex:-1}}function M3(e,t){var r=hs(e,C.reserveTag(524031042));if(r){var n,o;if(e.draftState.pendingDraft)switch(e.draftState.pendingDraft.sessionType){case"REPLY":if(n=e.draftState.pendingDraft.threadId,!r.cardViewState[n])return;break;case"EDIT":if(o=e.draftState.pendingDraft.commentId,!r.postViewState[o])return;break;default:return}else{var a=Ye(e.draftState);if(!a||!a.isInCurrentContext)return;switch(a.commentDraft.sessionConfiguration.sessionType){case"REPLY":n=a.threadId;break;case"EDIT":o=a.commentDraft.sessionConfiguration.commentId;break;default:return}}n&&!e.cardViewState[n]?(kye(e.draftState,n),Wa(r.draftState,e.draftState,3,t,C.reserveTag(526242828))):o&&!e.postViewState[o]&&(Dye(e.draftState,o),Wa(r.draftState,e.draftState,2,t,C.reserveTag(526242829)))}}function Dk(e,t,r,n){var o,a,d=hs(e,C.reserveTag(524031047));if(d&&r2e(t,r)&&(e.selectedComment&&e.selectedComment.selectedCardId===t.commentId&&(et(e.selectedComment.selectionDetails)||e.selectedComment.selectionDetails.lowFidelityWarningType!==void 0)&&(e.selectedComment.selectionDetails=jC()),t.commentId===((o=Ye(e.draftState))===null||o===void 0?void 0:o.threadId)&&(t2e(e.draftState,e.postData,t.commentId),Wa(d.draftState,e.draftState,1,n,C.reserveTag(526242836))),((a=d.cardViewState[t.commentId])===null||a===void 0?void 0:a.loadState.state)===st.Loaded)){var c=Yu(t.commentId,e.expandedComments,e.draftState,e.selectedComment);c!==e.expandedComments&&(e.expandedComments=c)}}function kye(e,t){e.pendingDraft&&wc(e.pendingDraft)&&e.pendingDraft.threadId===t&&(e.pendingDraft=void 0);var r=e.cardIdToDraftIdMap[t];r&&(wye(e,r),delete e.cardIdToDraftIdMap[t])}function Dye(e,t){e.pendingDraft&&ja(e.pendingDraft)&&e.pendingDraft.commentId===t&&(e.pendingDraft=void 0);var r=e.postIdToDraftIdMap[t];r&&(wye(e,r),delete e.postIdToDraftIdMap[t])}function t2e(e,t,r){kye(e,r);var n=Ds(e);if(n){var o=e.postIdToDraftIdMap[n],a=e.drafts[o];a&&a.threadId===r&&Dye(e,n)}if(e.pendingDraft&&ja(e.pendingDraft)){var d=e.pendingDraft.commentId,c=t[d];c&&Ze(c)===r&&(e.pendingDraft=void 0)}}function wye(e,t){if(!e.drafts[t]){x().assertConditionTag(Object.keys(e.drafts).length===0,"Invalid draftId",526131554);return}x().assertConditionTag(Object.keys(e.drafts).length===1,"Invalid number of drafts",526131555),delete e.drafts[t]}function r2e(e,t){return!!(e&&e.commentFlags&Ne.Resolved&&t&&!(t.commentFlags&Ne.Resolved))}function Oye(e,t,r){var n,o,a=r,d=t.model.parentId;if(d&&(e.cardViewState[d]?e.cardViewState[d].pending=lt.None:(o=(n=x())===null||n===void 0?void 0:n.logDiagnosticTrace)===null||o===void 0||o.call(n,Ot(Fye||(Fye=zt(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),C.reserveTag(520646684),xt.Warning,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary))),t.tempId){if(delete e.cardViewState[t.tempId],delete e.postViewState[t.tempId],e.draftState.committedLieId===t.tempId){var c=e.commentThreadIds.findIndex(function(l){return t.tempId===l});c<0?x().assertConditionTag(!1,"ThreadId to delete not found",520646688):(e.commentThreadIds.splice(c,1),delete e.cardPostIds[t.tempId]),delete e.postData[t.tempId],e.createdCommentLie=void 0,e.draftState.committedLieId=void 0,a=void 0}if(e.selectedComment&&e.selectedComment.selectedCardId===t.tempId)if(e.selectedComment=Sn(Ze(t.model)),!t.model.parentId)e.expandedComments=qa(e.expandedComments,e.selectedComment,e.draftState);else{var u=e.expandedComments.findIndex(function(l){return t.tempId===l});u>=0&&(e.expandedComments=Yu(t.tempId,e.expandedComments,e.draftState,e.selectedComment))}}x().assertConditionTag(!e.postViewState[t.model.commentId],"Received insert for existing comment",522856031),d||(e.cardViewState[t.model.commentId]=ks(t.tempId||void 0)),e.postViewState[t.model.commentId]=Ga(t.model.displayDate),kk(e,t.model,{insertFlatIndex:t.index,draftIdToSkip:a})}function Nye(e,t){var r=hs(e,C.reserveTag(522856032));if(r){var n=e.postData[t.model.commentId],o=r.modelCapabilities.virtualized;if(n){e.postData[t.model.commentId]=t.model;var a=Ze(t.model),d=e.cardViewState[a];d?(e.cardViewState[a].pending=lt.None,(d.loadState.state===st.Loading||!o)&&(e.cardViewState[a].loadState={state:st.Loaded})):(x().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",522856033),e.cardViewState[a]=ks(void 0,o?st.Placeholder:void 0)),e.postViewState[t.model.commentId]?(n.displayDate!==t.model.displayDate||n.date!==t.model.date)&&(e.postViewState[t.model.commentId].displayDate=As(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture),e.postViewState[t.model.commentId].pending=jr.None):e.postViewState[t.model.commentId]=Ga(As(t.model.date,t.model.displayDate,e.localizationDetails.dataCulture)),Dk(e,e.postData[t.model.commentId],n,2)}else x().assertConditionTag(!1,"change commentId not found in postData",522856034),It("change commentId not found in postData ".concat(t.model.commentId))}}function Mye(e,t,r){var n,o,a,d=e.postData[t.model.commentId];if(d){var c=-1,u=0;if(yr(d))c=e.commentThreadIds.findIndex(function(h){return d.commentId===h}),c<0?x().assertConditionTag(!1,"ThreadId to delete not found",520646687):e.commentThreadIds.splice(c,1),u=(o=(n=e.cardPostIds[d.commentId])===null||n===void 0?void 0:n.length)!==null&&o!==void 0?o:0,e.cardPostIds[d.commentId].forEach(function(h){delete e.postData[h]}),delete e.cardPostIds[d.commentId];else{if(x().assertConditionTag(e.cardPostIds[d.parentId]!==void 0,"Orphaned reply delete received",520646686),c=e.commentThreadIds.findIndex(function(h){return d.parentId===h}),e.cardPostIds[d.parentId]){var l=e.cardPostIds[d.parentId].findIndex(function(h){return d.commentId===h});l<0?x().assertConditionTag(!1,"PostID to delete not found",520646685):(u=1,e.cardPostIds[d.parentId].splice(l,1))}delete e.postData[t.model.commentId]}if(r&&((a=e.createdCommentLie)===null||a===void 0?void 0:a.flatIndex)!==void 0&&c>=0){var p=e.commentThreadIds.findIndex(function(h){return h===r});c<p&&(e.createdCommentLie.flatIndex-=u)}}if(e.highlightedCommentId===t.model.commentId&&(e.highlightedCommentId=void 0),e.topVisibleThreadId===t.model.commentId&&(e.topVisibleThreadId=void 0),delete e.cardViewState[t.model.commentId],delete e.postViewState[t.model.commentId],t.model.commentId===e.selectedThreadIdBeforeCommentSession&&d){var g=e.commentThreadIds.length;g?t.index>=e.commentThreadIds.length?e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[g-1]:e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[t.index]:e.selectedThreadIdBeforeCommentSession=void 0}}var Fye;LC();s();k();ne();te();zu();Rf();qm();yt();function Lye(e,t){var r=hs(e,C.reserveTag(523604707));if(r){var n=r.cardViewState[t];x().assertConditionTag(!n||n.pending!==lt.Delete,"Card pending delete remained after a reload.",523604736);var o=r.modelCapabilities.virtualized?st.NeedsReload:st.Loaded;if(!n)x().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default",523604737),e.cardViewState[t]=ks(void 0,o);else{var a=n.pending!==lt.None,d=(a||r.modelCapabilities.virtualized)&&n.loadState.state!==st.Placeholder&&n.loadState.state!==o;e.cardViewState[t]=a||d?m(m({},n),{pending:lt.None}):n,d&&(e.cardViewState[t].loadState=m(m({},e.cardViewState[t].loadState),{state:o}))}}}function Hye(e,t){var r=hs(e,C.reserveTag(523604738));if(r){var n=r.postViewState[t];x().assertConditionTag(!n||n.pending!==jr.Delete,"Post pending delete remained after a reload.",523604739),n?e.postViewState[t]=n.pending!==jr.None?m(m({},n),{pending:jr.None}):n:(x().assertConditionTag(!1,"Post state missing for existing post on reload. Creating default",523604740),e.postViewState[t]=Ga(void 0))}}function Bye(e){var t=hs(e,C.reserveTag(523604741));if(t!=null&&t.selectedThreadIdBeforeCommentSession){var r=t.commentThreadIds.indexOf(t.selectedThreadIdBeforeCommentSession);r<0&&(x().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in original commentThreadIds. Falling back to first comment",523604742),r=0);var n=e.commentThreadIds.length-1;e.commentThreadIds.length?(r>=e.commentThreadIds.length&&(r=n),e.selectedThreadIdBeforeCommentSession=e.commentThreadIds[r]):e.selectedThreadIdBeforeCommentSession=void 0}}function Uye(e){var t=hs(e,C.reserveTag(523604706));if(!(!t||!e.createdCommentLie)){var r=tt(e.draftState,!0);if(!r||!t.createdCommentLie||!t.cardViewState[r]||t.cardViewState[r].pending!==lt.None){e.createdCommentLie=void 0;return}var n=Object.keys(e.postData).length;e.createdCommentLie&&e.createdCommentLie.flatIndex>n&&(e.createdCommentLie.flatIndex=n);var o=Ym(e.commentThreadIds,e.cardPostIds,e.createdCommentLie.flatIndex);o>=0?(e.commentThreadIds.splice(o,0,r),e.cardPostIds[r]=[r],e.postData[r]=t.postData[r],e.cardViewState[r]=t.cardViewState[r],e.postViewState[r]=t.postViewState[r]):x().assertConditionTag(!1,"getThreadIndexFromFlatIndex unexpected failure to get threadIndex",523100547)}}yt();s();k();te();Es();ln();zo();ye();yt();function B3(e,t,r,n){var o,a,d,c,u;if(at()&&r.tasks){var l=!1,p={},g={},h=new Set,v=Object.keys(e);r.comments.forEach(function(_){_.parentId===""&&h.add(_.commentId)});try{for(var y=$e(v),T=y.next();!T.done;T=y.next()){var b=T.value;if(!h.has(b)){l=!0;break}}}catch(_){o={error:_}}finally{try{T&&!T.done&&(a=y.return)&&a.call(y)}finally{if(o)throw o.error}}v.length!==((u=r.tasks)===null||u===void 0?void 0:u.length)&&(l=!0);try{for(var I=$e(r.tasks),E=I.next();!E.done;E=I.next()){var P=E.value;l=V3(t,g,P,n)||l,p[P.commentId]=j3(P)}}catch(_){d={error:_}}finally{try{E&&!E.done&&(c=I.return)&&c.call(I)}finally{if(d)throw d.error}}if(l)return{updatedTasks:p,updatedHistoryRecordViewState:g}}}function U3(e,t,r,n){if(at()){var o=m({},e),a=m({},t),d=!1;if(r.changes.forEach(function(c){if(c.type===nt.Unknown){x().assertConditionTag(!1,"Unknown change type",554836096);return}var u=c.model.commentId;switch(c.type){case nt.Delete:if(delete o[u],e[u]!==void 0){var l=Object.keys(e);l.includes(u)&&(H3(a,e[u],void 0),d=!0)}break;case nt.Load:case nt.Insert:case nt.Modify:x().assertConditionTag(c.type===nt.Modify||!o[u],"Task should not already be populated on initial load",554836097);var p=c.task;if(p)d=V3(t,a,p,n)||d||!o[u]||!i2e(o[u].currentState,p.currentState),o[u]=j3(p);else if(c.model.parentId===""&&o[u]){var g=o[u];H3(a,g,void 0),delete o[u],d=!0}break}}),!!d)return{updatedTasks:o,updatedHistoryRecordViewState:a}}}function Vye(e,t){var r,n;if(!(!e||!at())){var o={},a={};try{for(var d=$e(e),c=d.next();!c.done;c=d.next()){var u=c.value;V3({},a,u,t),o[u.commentId]=j3(u)}}catch(l){r={error:l}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return{updatedTasks:o,updatedHistoryRecordViewState:a}}}function V3(e,t,r,n){var o,a,d,c;if(r.history.length===0)return!0;var u=!1,l=e&&Object.keys(e).length>0,p=l?new Set:void 0;try{for(var g=$e(r.history),h=g.next();!h.done;h=g.next()){var v=h.value;try{for(var y=(d=void 0,$e(v.records)),T=y.next();!T.done;T=y.next()){var b=T.value;p==null||p.add(b.recordId);var I=Xu(r.id,b.recordId);e[I]?t[I]=e[I]:(u=!0,t[I]=JW(As(b.time,b.displayTime,n.dataCulture)))}}catch(P){d={error:P}}finally{try{T&&!T.done&&(c=y.return)&&c.call(y)}finally{if(d)throw d.error}}}}catch(P){o={error:P}}finally{try{h&&!h.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}if(l){var E=H3(t,r,p);u=u||E}return u}function H3(e,t,r){var n,o,a,d,c=!1;try{for(var u=$e(t.history),l=u.next();!l.done;l=u.next()){var p=l.value;try{for(var g=(a=void 0,$e(p.records)),h=g.next();!h.done;h=g.next()){var v=h.value;(!r||!r.has(v.recordId))&&(delete e[Xu(t.id,v.recordId)],c=!0)}}catch(y){a={error:y}}finally{try{h&&!h.done&&(d=g.return)&&d.call(g)}finally{if(a)throw a.error}}}}catch(y){n={error:y}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return c}function i2e(e,t){if(e.completion!==t.completion||e.title!==t.title||e.isLossy!==t.isLossy||e.priority!==t.priority||e.schedule.dueDate!==t.schedule.dueDate||e.schedule.startDate!==t.schedule.startDate||e.assignees.length!==t.assignees.length)return!1;for(var r=0;r<e.assignees.length;r++)if(!nj(e.assignees[r],t.assignees[r]))return!1;return!0}function j3(e){var t,r,n,o,a=m({},e),d=[];try{for(var c=$e(e.history),u=c.next();!u.done;u=c.next()){var l=u.value,p=m({},l);p.taskId||(p.taskId=e.id);var g=[];try{for(var h=(n=void 0,$e(l.records)),v=h.next();!v.done;v=h.next()){var y=v.value;g.push(m({},y))}}catch(T){n={error:T}}finally{try{v&&!v.done&&(o=h.return)&&o.call(h)}finally{if(n)throw n.error}}p.records=g,d.push(p)}}catch(T){t={error:T}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}return a.history=d,a}zu();s();function wk(e){if(e){var t={};if(e.isReadOnly!==void 0&&(t.isReadOnly=e.isReadOnly),e.nextPopulatedContextDetails!==void 0&&(t.nextPopulatedContextDetails=e.nextPopulatedContextDetails),e.commentThreadCounts!==void 0&&(t.commentThreadCounts=e.commentThreadCounts||void 0),!!Object.keys(t).length)return t}}bn();Rf();qm();so();io();s();k();Sc();Di();Uf();s();k();Pt();li();Xa();yi();var s2e=function(){function e(t,r,n){this.componentTreeId={renderContextType:t,contextIdentifier:r},n&&$W(n.componentTreeId.renderContextType,t)?this.viewForest=new hb(n.viewForest):this.viewForest=new hb}return e.prototype.getViewForest=function(){return this.viewForest},e.prototype.getViewTrees=function(){return this.viewForest.getViewTrees()},e.prototype.getComponent=function(t){return this.viewForest.getDescendantById(jn(t))},e.prototype.getComponentById=function(t){return this.viewForest.getDescendantById(Qa(t))},e.prototype.isEventTarget=function(t,r){return!1},e.prototype.isFocusWithinPane=function(){return this.isFocusWithin({componentType:X.PaneRoot})},e.prototype.isFocusWithinAny=function(t){var r=this.getCurrentlyFocused(),n=Qa({componentType:t,id:"",renderContextType:this.componentTreeId.renderContextType});return r.some(function(o){return o.getId().startsWith(n)})},e.prototype.isFocusOn=function(t){var r=this.viewForest.getDescendantById(nl(t));return!!r&&r.getFocusState()===ce.FocusOn},e.prototype.isFocusWithin=function(t){var r=this.viewForest.getDescendantById(nl(t));return!!r&&r.getFocusState()===ce.FocusWithin},e.prototype.isFocusOnOrWithin=function(t){var r=this.viewForest.getDescendantById(nl(t));return!!r&&(r.getFocusState()===ce.FocusOn||r.getFocusState()===ce.FocusWithin)},e.prototype.getCurrentlyFocused=function(){var t,r,n=[];try{for(var o=$e(this.getViewTrees()),a=o.next();!a.done;a=o.next()){var d=a.value,c=d.getRoot();if(c)for(var u=c.getIterator(),l=void 0;!(l=u.next()).done;)l.value.getFocusState()!==ce.Unfocused&&n.push(l.value)}}catch(p){t={error:p}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n},e.prototype.setViewTreeRootHelper=function(t,r){this.getViewForest().getOrCreateViewTreeById(r).setRoot(t)},e.prototype.updateIdForViewTree=function(t,r){this.getViewForest().updateIdForViewTree(t,r)},e.prototype.onKeyDownTabHandlerHelper=function(t,r){return xD(this.getViewForest().getOrCreateViewTreeById(t),r)},e}(),ql=s2e;Zm();ye();yt();s();k();te();Cr();function W3(){return{extensions:{},contentNavigationSupported:!1}}function jye(e,t){switch(e===void 0&&(e=W3()),t===void 0&&(t=Bn),t.type){case"ADD_CONTENT_EXTENSION":return d2e(e,t);case"REMOVE_CONTENT_EXTENSION":return c2e(e,t);case"UPDATE_EXTENSION_PRIORITY":return u2e(e,t);case"SET_CONTENT_NAVIGATION_ENABLEMENT":return l2e(e,t);default:return e}}function d2e(e,t){var r;x().assertConditionTag(e[t.payload.extension.provider.scope.renderMode]===void 0,"Attempting to register extension on surface where extension is already registered. Overwriting previous registration.",594834317);var n=t.payload.extension;return m(m({},e),{extensions:m(m({},e.extensions),(r={},r[t.payload.extension.provider.scope.renderMode]={controller:n,priority:n.priority},r))})}function c2e(e,t){var r,n,o=m({},e.extensions);try{for(var a=$e(t.payload.renderModes),d=a.next();!d.done;d=a.next()){var c=d.value;delete o[c]}}catch(u){r={error:u}}finally{try{d&&!d.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return m(m({},e),{extensions:o})}function u2e(e,t){var r=m({},e.extensions);for(var n in t.payload.updates)r[n]&&(r[n]=m(m({},r[n]),{priority:t.payload.updates[n]}));return m(m({},e),{extensions:r})}function l2e(e,t){return m(m({},e),{contentNavigationSupported:t.payload.isEnabled})}s();k();Sd();te();Di();Cr();function Wye(e,t){return e===void 0&&(e=z3()),t===void 0&&(t=Bn),BT(e,function(r){switch(t.type){case"ACTIVE_FILTER_UPDATED":{f2e(r,t);return}case"VIEW_CONTAINER_VISIBILITY_CHANGED":{p2e(r,t);return}case"LOAD_FILTER":{m2e(r,t);return}case"SET_FILTERING_CAPABILITIES":{h2e(r,t);return}case"UPDATE_FILTER_RANGE":{y2e(r,t);return}case"SET_COLLABORATORS":{C2e(r,t);return}case"UPDATE_COLLABORATORS":{v2e(r,t);return}default:return e}})}function z3(){return{filteredRanges:{},filteringCapabilities:void 0,ensureActiveFilter:!1,collaborators:void 0}}function f2e(e,t){t.payload.newActiveFilterId!==e.activeFilterId&&(e.activeFilterId=t.payload.newActiveFilterId,e.activeFilterId&&(e.ensureActiveFilter=!0))}function p2e(e,t){!e.activeFilterId&&t.payload.visibilityState!==bt.Closed&&(e.ensureActiveFilter=!0)}function m2e(e,t){g2e(e,t.payload.filteredRange,t.payload.shouldSetActive)}function g2e(e,t,r){return e.filteredRanges[t.id]!==void 0?(x().assertConditionTag(!1,"Should not load a filter with the same id as a previously loaded filter",528527825),!1):(r&&(e.activeFilterId=t.id,e.ensureActiveFilter=!1),e.filteredRanges[t.id]={filter:t.getFilter(),order:t.getOrder(),canUpdateFilter:t.canBeUpdated()},!0)}function h2e(e,t){e.filteringCapabilities=t.payload.capabilities}function y2e(e,t){if(x().assertConditionTag(t.payload.filterId.length>0,"FilterId must not be empty string",529138905),!(t.payload.changes.length===0||!t.payload.filterId)){var r=e.filteredRanges[t.payload.filterId];if(!r){x().assertConditionTag(!1,"Processing update for a filter that is not found?",529138910);return}t.payload.changes.forEach(function(n){switch(n.type){case"FilterUpdate":{x().assertConditionTag(r.canUpdateFilter,"Should not get into FilterUpdate if canUpdateFilter is false",528749965),r.filter=n.updatedFilter;break}case"Insert":{if(n.index<0||n.index>r.order.length){x().assertConditionTag(!1,"Insert index out of bounds?",529138908);break}r.order=w(w(w([],V(r.order.slice(0,n.index)),!1),[n.content],!1),V(r.order.slice(n.index)),!1);break}case"Reload":{r.order=n.fullContent;break}case"Remove":{if(n.index<0||n.index>=r.order.length){x().assertConditionTag(!1,"Processing Remove with index out of bounds?",529138911);break}r.order.splice(n.index,1);break}case"Teardown":{t.payload.filterId===e.activeFilterId&&(x().assertConditionTag(n.teardownReason!==bd.Unknown,"Active filter was removed for unknown reason. Requesting a new filter to be set as active.",507794051),e.activeFilterId=void 0,e.ensureActiveFilter=n.teardownReason!==bd.RuntimeTeardown),delete e.filteredRanges[t.payload.filterId];break}}})}}function C2e(e,t){e.collaborators=t.payload.collaborators}function v2e(e,t){var r,n;switch(t.payload.change.type){case"UserAdded":(r=e.collaborators)===null||r===void 0||r.push(t.payload.change.user);break;case"UserRemoved":e.collaborators=(n=e.collaborators)===null||n===void 0?void 0:n.filter(function(o){return o.UserId!==t.payload.change.user.UserId});break;default:break}}bn();function x2e(e,t,r,n){return{paneState:{viewContainer:e,componentTree:new ql(Fs(e.containerType),n),visibilityState:t?bt.Visible:bt.Closed,initializationStatus:Wn.NotInitialized,viewContainerDisplayConfiguration:void 0},contentExtensions:W3(),commentState:G3(r),filterState:z3()}}function G3(e){return m(m({},sr()?{commentThreadIds:[],cardPostIds:{},postData:{}}:{commentData:[]}),{cardViewState:{},postViewState:{},selectedComment:void 0,expandedComments:[],pendingCommentLoad:void 0,contextState:{nextPopulatedContextDetails:Ut.Unknown,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:0},highlightedCommentId:void 0,topVisibleThreadId:void 0,createdCommentLie:void 0,selectedThreadIdBeforeCommentSession:void 0,personaIconPropertiesMap:{},draftState:Gm(),modelCapabilities:C7(),localizationDetails:e,suggestionsDetails:void 0,tasks:{},historyRecordViewState:{}})}function zye(e,t,r,n){return x2e(e,t,r,n)}var T2e=Aye;function qye(e,t){e===void 0&&(e=G3(T2e)),t===void 0&&(t=Bn);var r=b2e(e,t);return S2e(e,r)}function b2e(e,t){switch(t.type){case"HIGHLIGHT_COMMENT":return N2e(e,t);case"APPLY_COMMENT_CHANGES":return Qr(e)?BT(function(r){L2e(r,t)})(e):M2e(e,t);case"LOAD_COMMENT":return H2e(e,t);case"VIRTUALIZE_COMMENTS":return B2e(e,t);case"CANCEL_COMMENT_CREATE_THREAD":return K2e(e,t);case"CANCEL_COMMENT_POST_EDIT":return G2e(e,t);case"CANCEL_COMMENT_REPLY":return q2e(e,t);case"COLLAPSE_CARD":return V2e(e,t);case"SELECT_COMMENT":return U2e(e,t);case"REQUEST_THREAD_RESOLVE":return j2e(e,t);case"RELOAD_COMMENTS":return Qr(e)?BT(function(r){z2e(r,t)})(e):W2e(e,t);case"REQUEST_REOPEN_THREAD":return Q2e(e,t);case"REQUEST_DELETE_POST":return Y2e(e,t);case"REQUEST_DELETE_THREAD":return $2e(e,t);case"DISPATCH_LOAD_THREADS":return X2e(e,t);case"BEGIN_DRAFTING_SUCCESS":return F2e(e,t);case"BEGIN_DRAFTING_FAILURE":return O2e(e,t);case"SESSION_REQUEST_STARTED":return uLe(e,t);case"COMMENT_CONTEXT_CHANGED":return J2e(e,t);case"NEXT_POPULATED_CONTEXT_DETAILS_UPDATED":return Z2e(e,t);case"SHOW_LOW_FIDELITY_WARNING":return eLe(e,t);case"CLEAR_LOW_FIDELITY_WARNING":return tLe(e,t);case"CLEAR_COMMENT_SELECTION":return rLe(e,t);case"CLEAR_COMMENT_HIGHLIGHT":return nLe(e,t);case"TOP_VISIBLE_THREAD_CHANGED":return oLe(e,t);case"UPDATE_CONTEXT_DETAILS":return iLe(e,t);case"BEGIN_PROCESSING_COMMIT":return aLe(e,t);case"COMMIT_FAILURE":return sLe(e,t);case"BEGIN_PROCESSING_DISCARD":return cLe(e);case"CANCEL_DISCARD":return dLe(e);case"LOAD_PERSONA_ICON_PROPERTIES":return lLe(e,t);case"COMMIT_DRAFT":return _2e(e,t);case"RESOLVE_ATMENTION_CAPABILITY":return fLe(e,t);case"SAVE_DRAFT":return R2e(e,t);case"DRAFT_EMPTINESS_CHANGED":return A2e(e,t);case"UPDATE_DRAFT_RENDER_CONTEXT":return k2e(e,t);case"VIEW_CONTAINER_CHANGED":return w2e(e,t);case"DISPLAY_DRAFT_WARNING":return pLe(e,t);case"UPDATE_MODEL_STATE":return mLe(e,t);case"UPDATE_MENTIONEES_STILL_IN_DRAFT":return hLe(e,t);case"ADD_TO_CURRENT_MENTIONEES":return gLe(e,t);case"TOGGLE_TASK_ASSIGNER_TYPE":return vLe(e);case"UPDATE_SELECTED_TASK_ASSIGNEE":return yLe(e,t);case"UPDATE_SELECTED_TASK_ASSIGNEES":return CLe(e,t);case"POPULATE_SMART_REPLY":return ILe(e,t);case"SHOW_POST_ERROR_STATE":return TLe(e,t);case"CLEAR_POST_ERROR_STATE":return bLe(e,t);case"UPDATE_DRAFT_THREAD":return D2e(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return xLe(e,t);case"UPDATE_SUGGESTIONS_DETAILS":return SLe(e,t);default:return e}}function S2e(e,t){var r,n,o=t,a=Q()==="android",d=(r=o.selectedComment)===null||r===void 0?void 0:r.selectedCardId,c=tt(o.draftState);if(Qr(o)){var u=a&&d&&!o.expandedComments.includes(d)?w(w([],V(o.expandedComments),!1),[d],!1):o.expandedComments,l=o.cardPostIds,p=o.postData,g=void 0;u.forEach(function(y){y!==c&&l[y]&&(g=ZW(l[y],g??o.postViewState,p,o.localizationDetails))}),g&&(o=m(m({},o),{postViewState:g}))}else{if(d&&d!==c&&(a?d!==((n=e.selectedComment)===null||n===void 0?void 0:n.selectedCardId):o.expandedComments.includes(d)&&!e.expandedComments.includes(d))){var h=TF(d,o.postViewState,o.commentData,o.localizationDetails);h&&(o=m(m({},o),{postViewState:h}))}var v=tt(e.draftState);if(v&&v!==c&&(a||o.expandedComments.includes(v))){var h=TF(v,o.postViewState,o.commentData,o.localizationDetails);h&&(o=m(m({},o),{postViewState:h}))}}return o}function I2e(e,t){var r;if(!e.createdCommentLie)return e;var n=tt(e.draftState);if(!n)return e;var o=t.temporaryCommentId;if(!o)throw x().assertConditionTag(!1,"Expected middleware to set temporaryCommentId",593762520),new ge(ld,C.reserveTag(589103637),-2130957545);var a=Qr(e)?e.postData[n]:e.createdCommentLie.newComment_deprecated;if(Qr(e)&&!a)return x().assertConditionTag(!1,"Did not find model for draft thread on commit",527251200),e;var d=m(m({},a),{commentId:o,commentBody:t.commentBody}),c=m(m({},e.cardViewState),SF(o)),u=m(m({},e.postViewState),bF(o)),l=e.selectedComment&&{selectedCardId:o,selectionDetails:{lowFidelityWarningType:void 0}},p=$u(e.draftState,n);return m(m(m(m({},e),{selectedComment:l,expandedComments:qa(e.expandedComments,l,p)}),Qr(e)?{postData:m(m({},e.postData),(r={},r[n]=d,r))}:{createdCommentLie:m(m({},e.createdCommentLie),{newComment_deprecated:d})}),{cardViewState:c,postViewState:u,selectedThreadIdBeforeCommentSession:void 0,draftState:m(m({},p),{committedLieId:o})})}function E2e(e,t){var r;if(!t.parentId)throw new ge(mm,C.reserveTag(589103638),-2130957536);var n=m(m({},e.cardViewState),(r={},r[t.parentId]=m(m({},e.cardViewState[t.parentId]),{pending:lt.Editor,loadState:{state:st.Loaded}}),r)),o=Sn(t.parentId),a=$u(e.draftState,t.parentId);return m(m({},e),{cardViewState:n,selectedComment:o,expandedComments:oa(e.expandedComments,o,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}function P2e(e,t){var r,n=IF(e,t.commentId),o=m(m({},e.postViewState[t.commentId]),{pending:jr.Post}),a=$m(e.draftState,t.commentId);return m(m({},e),{postViewState:m(m({},e.postViewState),(r={},r[t.commentId]=o,r)),selectedComment:n,expandedComments:oa(e.expandedComments,n,a),selectedThreadIdBeforeCommentSession:void 0,draftState:a})}function _2e(e,t){var r=_d(e.draftState);if(r===void 0)return x().assertConditionTag(!1,"Invalid number of drafts during commit.",593762521),e;if(r.sessionConfiguration.sessionType!==t.payload.sessionType)return e;switch(t.payload.sessionType){case"CREATE":return I2e(e,t.payload.data);case"REPLY":return E2e(e,t.payload.data);case"EDIT":return P2e(e,t.payload.data);default:throw new ge("Unexpected session type for commit",C.reserveTag(589103639),-2130957532)}}function R2e(e,t){var r,n=e.draftState.drafts;if(n[t.payload.draftId]===void 0)return x().assertConditionTag(!jo(e.draftState),"saveDraftReducer called with an invalid draft id while a draft is active",587531107),e;var o=m(m({},n),(r={},r[t.payload.draftId]=m(m({},n[t.payload.draftId]),{savedDraftContent:t.payload.draftContent}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:o})})}function A2e(e,t){var r,n=e.draftState.drafts;if(n[t.payload.draftId]===void 0)return x().assertConditionTag(!1,"draftEmptinessChangedReducer called with an invalid draft id",592213846),e;var o=m(m({},n),(r={},r[t.payload.draftId]=m(m({},n[t.payload.draftId]),{isDraftEmpty:t.payload.isEmpty}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:o})})}function k2e(e,t){var r=KI(e.draftState,function(n){var o=e.draftState.drafts[n];return t.payload.draftId!==void 0&&t.payload.draftId!==n?o.renderContextType:t.payload.isClaimingLock&&o.renderContextType===A.None?t.actionDetail.renderContextType:!t.payload.isClaimingLock&&o.renderContextType===t.actionDetail.renderContextType?A.None:o.renderContextType});return m(m({},e),{draftState:r})}function D2e(e,t){var r;if(!e.createdCommentLie)return e;if(tt(e.draftState)!==t.payload.draftId)return x().assertConditionTag(!1,"Unexpected draft ID in updateDraftThread payload",593844429),e;if(t.payload.anchorHintText===void 0&&t.payload.insertIndex===void 0)return e;var n=Qr(e)?e.postData[t.payload.draftId]:e.createdCommentLie.newComment_deprecated;if(Qr(e)&&!n)return x().assertConditionTag(!1,"Did not find model for draft thread on update",527251201),e;var o=e.createdCommentLie,a={};if(t.payload.insertIndex!==void 0&&t.payload.insertIndex!==o.flatIndex&&(o=m(m({},o),{flatIndex:t.payload.insertIndex}),Qr(e))){var d=u7(e.commentThreadIds,e.cardPostIds,t.payload.draftId,o);a=m(m({},a),{commentThreadIds:d})}if(t.payload.anchorHintText!==void 0&&t.payload.anchorHintText!==n.anchorHintText){var c=m(m({},n),{anchorHintText:t.payload.anchorHintText});if(Qr(e)){var u=m(m({},e.postData),(r={},r[t.payload.draftId]=c,r));a=m(m({},a),{postData:u})}else o=m(m({},o),{newComment_deprecated:c})}return m(m(m({},e),a),{createdCommentLie:o})}function w2e(e,t){var r=KI(e.draftState,function(n){var o=e.draftState.drafts[n];return Kt(o.renderContextType)?Fs(t.payload.viewContainer.containerType):o.renderContextType});return m(m({},e),{draftState:r})}function F2e(e,t){var r,n,o,a,d,c,u,l,p,g,h;if(_d(e.draftState))throw new ge("Draft already active!",C.reserveTag(589103640),-2130957551);var v=e.selectedThreadIdBeforeCommentSession,y=t.payload.draftDetails,T=(p=(l=t.payload.rehydratedDraftParams)===null||l===void 0?void 0:l.inCurrentContext)!==null&&p!==void 0?p:!0,b=(h=(g=t.payload.rehydratedDraftParams)===null||g===void 0?void 0:g.isDraftEmpty)!==null&&h!==void 0?h:!0;switch(y.sessionConfiguration.sessionType){case"CREATE":{var I=y.sessionConfiguration.draftId,E=m(m({},qI(I)),{author:y.author,anchorHintText:y.anchorHintText}),P=T?EF(Dc(e),y):e.selectedComment,_=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(r={},r[I]={commentDraft:y,isDraftEmpty:b,isInCurrentContext:T,pendingState:Fi.None,renderContextType:t.payload.draftRenderContextType,threadId:I},r)),cardIdToDraftIdMap:m(m({},e.draftState.cardIdToDraftIdMap),(n={},n[I]=I,n)),pendingDraft:void 0}),D={};if(Qr(e)){var M=Ym(e.commentThreadIds,e.cardPostIds,y.insertIndex),H=e.commentThreadIds,U=e.cardPostIds;M>=0&&(H=w(w(w([],V(H.slice(0,M)),!1),[I],!1),V(H.slice(M)),!1),U=m(m({},e.cardPostIds),(o={},o[I]=[I],o))),D={commentThreadIds:H,cardPostIds:U,postData:m(m({},e.postData),(a={},a[I]=E,a))}}return m(m(m({},e),D),{createdCommentLie:{flatIndex:y.insertIndex,newComment_deprecated:E},cardViewState:m(m({},e.cardViewState),s7(E)),postViewState:m(m({},e.postViewState),d7(E)),selectedComment:P,expandedComments:qa(e.expandedComments,P,_),selectedThreadIdBeforeCommentSession:v,draftState:_})}case"EDIT":case"REPLY":if(!(Ua(y.sessionConfiguration)||mf(y.sessionConfiguration)))throw x().assertConditionTag(!1,"Expected BeginDraftingResult id to be set with CommentSessionType.Reply/Edit in beginDraftingSuccessReducer",593762523),new ge(ld,C.reserveTag(589103642),-2130957532);var F=void 0,z=mf(y.sessionConfiguration)&&(!e.selectedComment||y.sessionConfiguration.threadId!==e.selectedComment.selectedCardId),Y=ja(y.sessionConfiguration)&&(!e.selectedComment||!et(e.selectedComment.selectionDetails)||y.sessionConfiguration.commentId!==e.selectedComment.selectionDetails.selectedPostId);T?!e.selectedComment||z||Y?F=EF(Dc(e),y):F=m(m({},e.selectedComment),{selectionDetails:m(m({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):F=e.selectedComment;var B=e.draftState.cardIdToDraftIdMap,q=e.draftState.postIdToDraftIdMap,K="",$=!1,oe=!1;if(wc(y.sessionConfiguration))B=m(m({},B),(d={},d[y.sessionConfiguration.threadId]=y.sessionConfiguration.draftId,d)),K=y.sessionConfiguration.threadId,oe=b;else if(ja(y.sessionConfiguration)){var ie=y.sessionConfiguration.commentId;if(q=m(m({},q),(c={},c[ie]=y.sessionConfiguration.draftId,c)),$=!0,Qr(e)){var Ce=e.postData[ie],se=Wu(Ce.commentBody);oe=se.length===0||Q()==="web"&&se==="\n",K=Ze(Ce)}else e.commentData.some(function(Be){if(Be.commentId===ie){var _e=Wu(Be.commentBody);return oe=_e.length===0||Q()==="web"&&_e==="\n",K=Ze(Be),!0}return!1});!K&&y.sessionConfiguration.rootCommentId&&(K=y.sessionConfiguration.rootCommentId)}else Me(y.sessionConfiguration);var he=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(u={},u[y.sessionConfiguration.draftId]={commentDraft:y,isDraftEmpty:oe,isInCurrentContext:T,pendingState:Fi.None,renderContextType:t.payload.draftRenderContextType,threadId:K},u)),cardIdToDraftIdMap:B,postIdToDraftIdMap:q,pendingDraft:void 0});return m(m({},e),{selectedComment:F,expandedComments:$?qa(e.expandedComments,F,he):oa(e.expandedComments,F,he),selectedThreadIdBeforeCommentSession:v,draftState:he,createdCommentLie:void 0});default:return e}}function O2e(e,t){if(e.selectedComment===void 0)return x().assertConditionTag(!1,"SelectedComment already undefined when failing selected comment",593762525),e;var r=void 0;t.payload.beginDraftingParams.sessionType!=="CREATE"?r=m(m({},e.selectedComment),{selectionDetails:m(m({},e.selectedComment.selectionDetails),{lowFidelityWarningType:void 0})}):e.selectedThreadIdBeforeCommentSession&&(r={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}});var n=m(m({},e.draftState),{pendingDraft:void 0});return m(m({},e),{selectedComment:r,expandedComments:oa(e.expandedComments,r,n),selectedThreadIdBeforeCommentSession:void 0,createdCommentLie:void 0,draftState:n})}function N2e(e,t){var r=vF(t.payload.commentId);return r===e.highlightedCommentId?e:m(m({},e),{highlightedCommentId:r})}function M2e(e,t){var r,n,o,a,d,c,u;if(!t.payload.changes.length)return e;var l={commentData:w([],V(e.commentData),!1),cardViewState:m({},e.cardViewState),postViewState:m({},e.postViewState),highlightedCommentId:e.highlightedCommentId,topVisibleThreadId:e.topVisibleThreadId,selectedComment:e.selectedComment,expandedComments:e.expandedComments,selectedThreadIdBeforeCommentSession:e.selectedThreadIdBeforeCommentSession,draftState:e.draftState},p=e.createdCommentLie,g=!!tt(e.draftState,!0),h=p==null?void 0:p.flatIndex,v=e.modelCapabilities.virtualized,y;try{for(var T=$e(t.payload.changes),b=T.next();!b.done;b=T.next())if(y=b.value,y.type===ra.Load&&(l.postViewState[y.model.commentId]!==void 0?y=m(m({},y),{type:ra.Modify}):y=m(m({},y),{type:ra.Insert})),y.type===ra.Insert){var I=y.model.parentId;if(I&&(l.cardViewState[I]?l.cardViewState[I]=m(m({},l.cardViewState[I]),{pending:lt.None}):(d=(a=x())===null||a===void 0?void 0:a.logDiagnosticTrace)===null||d===void 0||d.call(a,Ot(Gye||(Gye=zt(["Inserting orphaned reply without root post?"],["Inserting orphaned reply without root post?"]))),C.reserveTag(526960065),xt.Warning,mt.ProductServiceUsage,ht(ut.ReviewedAsNotNecessary))),l.commentData.splice(y.index,0,y.model),y.tempId){if(!I){var E={};E[y.model.commentId]=ks(y.tempId),l.cardViewState=m(m({},za(l.cardViewState,y.tempId)),E)}l.postViewState=m(m({},za(l.postViewState,y.tempId)),BC([y.model],l.expandedComments,e.localizationDetails)),l.draftState.committedLieId===y.tempId&&(l.draftState=m(m({},l.draftState),{committedLieId:void 0}),h=void 0),l.selectedComment&&l.selectedComment.selectedCardId===y.tempId&&(l.selectedComment=Sn(Ze(y.model)),y.model.parentId||(l.expandedComments=qa(l.expandedComments,l.selectedComment,l.draftState)))}else{if(x().assertConditionTag(!l.postViewState[y.model.commentId],"Received insert for existing comment",594122589),!I){var E={};E[y.model.commentId]=ks(void 0),l.cardViewState=m(m({},l.cardViewState),E)}l.postViewState=m(m({},l.postViewState),BC([y.model],l.expandedComments,e.localizationDetails))}g&&h!==void 0&&y.index<=h&&h++}else if(y.type===ra.Modify){var P=l.commentData[y.index];if(P.commentId===y.model.commentId){l.commentData[y.index]=y.model;var I=Ze(y.model),_=l.cardViewState[I];_?l.cardViewState[I]=m(m({},_),{pending:lt.None,loadState:_.loadState.state===st.Loading||!v?{state:st.Loaded}:_.loadState}):(x().assertConditionTag(!1,"Received Modify change without existing card state? Creating default.",527962186),l.cardViewState[I]=ks(void 0,v?st.Placeholder:void 0));var D=P.displayDate===y.model.displayDate&&P.date===y.model.date?l.postViewState[y.model.commentId].displayDate:As(y.model.date,y.model.displayDate,e.localizationDetails.dataCulture);if(l.postViewState=m(m({},l.postViewState),(o={},o[y.model.commentId]=m(m({},l.postViewState[y.model.commentId]),{pending:jr.None,displayDate:D}),o)),y.model.commentFlags&Ne.Resolved&&!(P.commentFlags&Ne.Resolved)){var M=l.draftState;l.selectedComment&&l.selectedComment.selectedCardId===y.model.commentId&&(l.selectedComment=Sn(l.selectedComment.selectedCardId)),l.draftState=DF(l.draftState,y.model.commentId,l.commentData),Wa(M,l.draftState,1,2,C.reserveTag(539297114)),(_==null?void 0:_.loadState.state)===st.Loaded&&(l.expandedComments=Yu(y.model.commentId,l.expandedComments,l.draftState,l.selectedComment))}}else x().assertConditionTag(!1,"Found changeIndex mismatch",593762526),It("changeIndex did not match comment for ".concat(y.model.commentId))}else if(y.type===ra.Delete){var P=l.commentData[y.index];if(P.commentId===y.model.commentId&&l.commentData.splice(y.index,1),l.highlightedCommentId===y.model.commentId&&(l.highlightedCommentId=void 0),l.topVisibleThreadId===y.model.commentId&&(l.topVisibleThreadId=void 0),l.cardViewState=za(l.cardViewState,y.model.commentId),l.postViewState=za(l.postViewState,y.model.commentId),y.model.commentId===l.selectedThreadIdBeforeCommentSession){var H=y.index;l.commentData.length?(H>=l.commentData.length&&(H=l.commentData.length-1),l.selectedThreadIdBeforeCommentSession=Ze(l.commentData[H])):l.selectedThreadIdBeforeCommentSession=void 0}g&&h!==void 0&&y.index<h&&h--}}catch(F){r={error:F}}finally{try{b&&!b.done&&(n=T.return)&&n.call(T)}finally{if(r)throw r.error}}g&&(h===void 0?p=void 0:p&&h!==p.flatIndex&&(p=m(m({},p),{flatIndex:h}))),l.draftState=RF(l.draftState,e.cardViewState,l.cardViewState,e.postViewState,l.postViewState,2),l.selectedComment&&!Rs(l.draftState)&&(l.cardViewState[l.selectedComment.selectedCardId]?et(l.selectedComment.selectionDetails)&&!l.postViewState[l.selectedComment.selectionDetails.selectedPostId]&&(l.selectedComment=Sn(l.selectedComment.selectedCardId)):l.selectedComment=void 0);var U=U3(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return m(m({},e),{createdCommentLie:p,draftState:l.draftState,selectedComment:l.selectedComment,expandedComments:VC(l.expandedComments,l.cardViewState,l.draftState),commentData:l.commentData,cardViewState:l.cardViewState,postViewState:l.postViewState,highlightedCommentId:l.highlightedCommentId,topVisibleThreadId:l.topVisibleThreadId,selectedThreadIdBeforeCommentSession:l.selectedThreadIdBeforeCommentSession,tasks:(c=U==null?void 0:U.updatedTasks)!==null&&c!==void 0?c:e.tasks,historyRecordViewState:(u=U==null?void 0:U.updatedHistoryRecordViewState)!==null&&u!==void 0?u:e.historyRecordViewState})}function L2e(e,t){var r,n;if(t.payload.changes.length){var o=tt(e.draftState,!0),a;try{for(var d=$e(t.payload.changes),c=d.next();!c.done;c=d.next())switch(a=c.value,a.type===ra.Load&&(e.postViewState[a.model.commentId]!==void 0?a=m(m({},a),{type:ra.Modify}):a=m(m({},a),{type:ra.Insert})),a.type){case ra.Insert:Oye(e,a,o),e.createdCommentLie===void 0&&(o=void 0);break;case ra.Modify:Nye(e,a);break;case ra.Delete:Mye(e,a,o)}}catch(p){r={error:p}}finally{try{c&&!c.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}M3(e,2),e.selectedComment&&!Rs(e.draftState)&&(e.cardViewState[e.selectedComment.selectedCardId]?et(e.selectedComment.selectionDetails)&&!e.postViewState[e.selectedComment.selectionDetails.selectedPostId]&&(e.selectedComment=Sn(e.selectedComment.selectedCardId)):e.selectedComment=void 0),e.expandedComments=VC(e.expandedComments,e.cardViewState,e.draftState);var u=hs(e,C.reserveTag(520646682));if(u){var l=U3(u.tasks,u.historyRecordViewState,t.payload,u.localizationDetails);l!=null&&l.updatedTasks&&(e.tasks=l.updatedTasks),l!=null&&l.updatedHistoryRecordViewState&&(e.historyRecordViewState=l.updatedHistoryRecordViewState)}}}function H2e(e,t){var r,n,o=e.modelCapabilities.virtualized,a=wF(e,t.payload.commentData,o,!!t.payload.filteringEnabled),d={};d=e7(t.payload.commentData,o?st.Placeholder:st.Loaded);var c=Vye(t.payload.tasks,e.localizationDetails);return m(m(m({},e),a),{cardViewState:m(m({},e.cardViewState),d),postViewState:m(m({},e.postViewState),BC(t.payload.commentData,a.expandedComments,e.localizationDetails)),tasks:(r=c==null?void 0:c.updatedTasks)!==null&&r!==void 0?r:e.tasks,historyRecordViewState:(n=c==null?void 0:c.updatedHistoryRecordViewState)!==null&&n!==void 0?n:e.historyRecordViewState})}function B2e(e,t){if(!e.modelCapabilities.virtualized)throw new ge("virtualizeCommentsReducer requires virtualization",C.reserveTag(589103643),-2130957500);var r=Rye(t.payload.threadInfo.map(function(o){return o.threadId})),n=wF(e,r,!0,!!t.payload.filteringEnabled);return m(m(m({},e),n),{cardViewState:m(m({},e.cardViewState),t7(t.payload.threadInfo)),postViewState:m(m({},e.postViewState),BC(r,n.expandedComments,e.localizationDetails))})}function U2e(e,t){var r=e.selectedComment;if(!PF(e.draftState,r,t))return e;if(!t.payload.selectedCard)throw new ge(mm,C.reserveTag(589103644),-2130957536);var n=i7(e.selectedComment,t),o=Om(t.payload.selectType)?qa(e.expandedComments,n,e.draftState):oa(e.expandedComments,n,e.draftState);return m(m({},e),{selectedComment:n,expandedComments:o})}function V2e(e,t){var r=Ye(e.draftState);if((r==null?void 0:r.threadId)===t.payload.cardId)return e;var n=o7(t.payload.cardId,e.selectedComment,e.draftState);return m(m({},e),{selectedComment:n,expandedComments:Yu(t.payload.cardId,e.expandedComments,e.draftState,n)})}function j2e(e,t){var r;return m(m({},e),{cardViewState:m(m({},e.cardViewState),(r={},r[t.payload.commentId]=m(m({},e.cardViewState[t.payload.commentId]),{pending:lt.Card,loadState:{state:st.Loaded}}),r)),selectedComment:c7(e.selectedComment,t)})}function W2e(e,t){var r,n,o,a={},d={},c=e.selectedComment,u=void 0,l=e.expandedComments,p=c&&et(c.selectionDetails),g=!1,h=!1,v=!1,y=e.selectedThreadIdBeforeCommentSession,T=e.draftState,b=e.modelCapabilities.virtualized,I=(r=Ye(T))===null||r===void 0?void 0:r.threadId,E={};e.commentData.forEach(function(F){E[F.commentId]=F});var P=!1,_=!1;t.payload.comments.forEach(function(F){if(F.commentId===e.highlightedCommentId&&(P=!0),F.commentId===e.topVisibleThreadId&&(_=!0),c&&(F.commentId===c.selectedCardId&&(h=!0),c.selectedCardId===Ze(F)&&et(c.selectionDetails)&&c.selectionDetails.selectedPostId===F.commentId&&(g=!0)),F.commentId in E){if(F.parentId===""){e.cardViewState[F.commentId]&&x().assertConditionTag(e.cardViewState[F.commentId].pending!==lt.Delete,"Card pending delete remained after a reload.",593762527);var z=e.cardViewState[F.commentId];if(!z)x().assertConditionTag(!1,"Card state missing for existing card on reload? Creating default.",527958879),d[F.commentId]=ks(void 0,b?st.NeedsReload:st.Loaded);else if(z.pending!==lt.None||b){var Y=z.loadState;d[F.commentId]=m(m({},z),{pending:lt.None,loadState:Y.state===st.Placeholder?Y:{state:b?st.NeedsReload:st.Loaded}})}else d[F.commentId]=z}if(x().assertConditionTag(!e.postViewState[F.commentId]||e.postViewState[F.commentId].pending!==jr.Delete,"Post pending delete remained after a reload.",593762528),e.postViewState[F.commentId]?e.postViewState[F.commentId].pending!==jr.None?a[F.commentId]=m(m({},e.postViewState[F.commentId]),{pending:jr.None}):a[F.commentId]=e.postViewState[F.commentId]:a[F.commentId]=Ga(void 0),F.commentFlags&Ne.Resolved&&(!E[F.commentId]||!(E[F.commentId].commentFlags&Ne.Resolved))){if(c&&c.selectedCardId===F.commentId&&(c=Sn(c.selectedCardId)),F.commentId===I){var B=T;T=DF(T,F.commentId,t.payload.comments),Wa(B,T,1,1,C.reserveTag(539297115))}l=Yu(F.commentId,l,T,c)}y&&y===F.commentId&&(v=!0)}else{if(F.parentId===""){var q=F.commentId,K=b?{state:st.Placeholder,initialItemCount:1}:{state:st.Loaded};d[F.commentId]=UC(q,K)}a[F.commentId]=Ga(l.includes(Ze(F))?As(F.date,F.displayDate,e.localizationDetails.dataCulture):F.displayDate)}}),u=l7(e.createdCommentLie,t.payload.comments,e.cardViewState,e.draftState),T=m(m({},T),{committedLieId:void 0});var D=tt(T);if(D&&(c&&D===c.selectedCardId&&(h=!0),d[D]=e.cardViewState[D],a[D]=e.postViewState[D]),T=RF(T,e.cardViewState,d,e.postViewState,a,1),Rs(T)||(h?p&&!g&&c&&!b&&(c={selectedCardId:c.selectedCardId,selectionDetails:{lowFidelityWarningType:void 0}}):c=void 0),!v&&y){var M=e.commentData.findIndex(function(F){return F.commentId===y});if(M<0&&(x().assertConditionTag(!1,"selectedThreadIdBeforeCommentSession not found in old commentData. Falling back to first comment",593762529),M=0),t.payload.comments.length){M>=t.payload.comments.length&&(M=t.payload.comments.length-1);var H=t.payload.comments[M];y=Ze(H)}else y=void 0}var U=B3(e.tasks,e.historyRecordViewState,t.payload,e.localizationDetails);return m(m({},e),{draftState:T,commentData:w([],V(t.payload.comments),!1),cardViewState:d,postViewState:a,selectedComment:c,expandedComments:VC(l,d,T),pendingCommentLoad:void 0,highlightedCommentId:P?e.highlightedCommentId:void 0,topVisibleThreadId:_?e.topVisibleThreadId:void 0,createdCommentLie:u,selectedThreadIdBeforeCommentSession:y,tasks:(n=U==null?void 0:U.updatedTasks)!==null&&n!==void 0?n:e.tasks,historyRecordViewState:(o=U==null?void 0:U.updatedHistoryRecordViewState)!==null&&o!==void 0?o:e.historyRecordViewState})}function z2e(e,t){var r=hs(e,C.reserveTag(524031011));if(r){var n=!1,o=!1,a=!1,d=!1,c=r.selectedComment&&et(r.selectedComment.selectionDetails),u=!1;e.commentThreadIds=[],e.cardPostIds={},e.postData={},e.cardViewState={},e.postViewState={},t.payload.comments.forEach(function(h){if(h.commentId===r.highlightedCommentId&&(n=!0),h.commentId===r.topVisibleThreadId&&(o=!0),r.selectedComment&&(h.commentId===r.selectedComment.selectedCardId&&(a=!0),r.selectedComment.selectedCardId===Ze(h)&&et(r.selectedComment.selectionDetails)&&r.selectedComment.selectionDetails.selectedPostId===h.commentId&&(d=!0)),h.commentId in r.postData)yr(h)&&Lye(e,h.commentId),Hye(e,h.commentId),Dk(e,h,r.postData[h.commentId],1),r.selectedThreadIdBeforeCommentSession&&r.selectedThreadIdBeforeCommentSession===h.commentId&&(u=!0);else{if(yr(h)){var v=h.commentId,y=r.modelCapabilities.virtualized?{state:st.Placeholder,initialItemCount:1}:{state:st.Loaded};e.cardViewState[h.commentId]=UC(v,y)}e.postViewState[h.commentId]=Ga(h.displayDate)}kk(e,h)}),n||(e.highlightedCommentId=void 0),o||(e.topVisibleThreadId=void 0),!u&&r.selectedThreadIdBeforeCommentSession&&Bye(e),Uye(e),e.draftState.committedLieId=void 0;var l=tt(e.draftState);l&&e.selectedComment&&l===e.selectedComment.selectedCardId&&(a=!0),M3(e,1),Rs(e.draftState)||(a?c&&!d&&e.selectedComment&&!r.modelCapabilities.virtualized&&(e.selectedComment.selectionDetails=jC()):e.selectedComment=void 0),e.pendingCommentLoad=void 0;var p=B3(r.tasks,r.historyRecordViewState,t.payload,r.localizationDetails);p!=null&&p.updatedTasks&&(e.tasks=p.updatedTasks),p!=null&&p.updatedHistoryRecordViewState&&(e.historyRecordViewState=p.updatedHistoryRecordViewState);var g=VC(e.expandedComments,e.cardViewState,e.draftState);g!==e.expandedComments&&(e.expandedComments=g)}}function G2e(e,t){var r=IF(e,t.payload.commentId),n=$m(e.draftState,t.payload.commentId);return m(m({},e),{selectedComment:r,expandedComments:oa(e.expandedComments,r,n),selectedThreadIdBeforeCommentSession:void 0,draftState:n})}function q2e(e,t){var r=$u(e.draftState,t.payload.commentId);return m(m({},e),{expandedComments:oa(e.expandedComments,e.selectedComment,r),selectedThreadIdBeforeCommentSession:void 0,draftState:r})}function K2e(e,t){var r;if(!jo(e.draftState))return e;var n=tt(e.draftState);if(!n)return e;var o,a=!1;((r=e.selectedComment)===null||r===void 0?void 0:r.selectedCardId)!==n?o=e.selectedComment:e.selectedThreadIdBeforeCommentSession&&(o={selectedCardId:e.selectedThreadIdBeforeCommentSession,selectionDetails:{lowFidelityWarningType:void 0}},a=!0);var d=$u(e.draftState,n);return m(m(m({},e),Qr(e)?{commentThreadIds:xF(e.commentThreadIds,n),cardPostIds:za(e.cardPostIds,n),postData:za(e.postData,n)}:{}),{createdCommentLie:void 0,selectedComment:o,expandedComments:o&&a?qa(e.expandedComments,o,d):oa(e.expandedComments,o,d),cardViewState:za(e.cardViewState,n),postViewState:za(e.postViewState,n),selectedThreadIdBeforeCommentSession:void 0,draftState:d})}function Y2e(e,t){var r,n=m(m({},e.postViewState),(r={},r[t.payload.commentId]=m(m({},e.postViewState[t.payload.commentId]),{pending:jr.Delete}),r));return m(m({},e),{postViewState:n})}function $2e(e,t){var r,n=m(m({},e.cardViewState),(r={},r[t.payload.commentId]=m(m({},e.cardViewState[t.payload.commentId]),{pending:lt.Delete}),r));return m(m({},e),{cardViewState:n})}function Q2e(e,t){var r,n=m(m({},e.cardViewState),(r={},r[t.payload.commentId]=m(m({},e.cardViewState[t.payload.commentId]),{pending:lt.Card}),r));return m(m({},e),{cardViewState:n})}function X2e(e,t){var r=m({},e.cardViewState);return t.payload.threadIds.forEach(function(n){if(r[n]){var o=r[n].loadState;r[n]=m(m({},r[n]),{loadState:{state:st.Loading,initialItemCount:Ku(o)?o.initialItemCount:1}})}else x().assertConditionTag(!1,"Loading an unexpected thread?",528021317)}),m(m({},e),{cardViewState:r})}function J2e(e,t){var r,n,o,a=Gm(),d={},c={},u=void 0,l=void 0,p=void 0,g=void 0,h=tt(e.draftState),v=!!e.createdCommentLie;t.payload.contextDetails?o=m(m({},wk(t.payload.contextDetails)),{lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1}):o={nextPopulatedContextDetails:Ut.Unknown,isReadOnly:Au()&&e.contextState.isReadOnly,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement+1};var y=t.payload.contextDrafts;if(y){var T=_F(e.draftState);if(Gu(T)>0){var b={},I=void 0,E=void 0,P=!it();if(NC(T).forEach(function(F){var z,Y,B=y.find(function(q){return q.draftId===F});b[F]=m(m({},T.drafts[F]),{isInCurrentContext:!!B}),h===F&&(v=!!B,B&&(I=B.insertIndex,E=B.anchorHintText,((z=t.payload.contextDetails)===null||z===void 0?void 0:z.selectedCommentId)===h&&(u=Sn(h)))),!P&&!u&&B&&b[F].threadId===((Y=e.selectedComment)===null||Y===void 0?void 0:Y.selectedCardId)&&(P=!0)}),a=m(m({},e.draftState),{drafts:b}),l=e.createdCommentLie,p=h?Qr(e)?e.postData[h]:l==null?void 0:l.newComment_deprecated:void 0,P&&(u=e.selectedComment),l&&h&&v){x().assertConditionTag(I!==void 0,"Index unknown for lie in latest context",587309136);var _=I??0;_!==l.flatIndex&&(l=m(m({},l),{flatIndex:_})),p&&E!==void 0&&E!==l.newComment_deprecated.anchorHintText&&(p=m(m({},p),{anchorHintText:E}),l=m(m({},l),{newComment_deprecated:p})),d=SF(h),c=bF(h),l.flatIndex>-1&&(d[h].pending=lt.None,c[h].pending=jr.None)}}else g=g??-1}else g=g??4;o.isReadOnly&&(v&&(l=void 0),a=kF(a),g=g??5),Wa(e.draftState,a,g,4,C.reserveTag(539297116));var D;if(Qr(e)){var M=[],H={},U={};l&&h&&p&&(U=(r={},r[h]=p,r),v&&!l.flatIndex&&(M=[h],H=(n={},n[h]=[h],n))),D={commentThreadIds:M,cardPostIds:H,postData:U}}else D={commentData:[]};return m(m(m({},e),D),{cardViewState:d,postViewState:c,selectedComment:u,expandedComments:oa(e.expandedComments,u,a),pendingCommentLoad:t.payload.numberOfComments===0?void 0:{numberOfLoadedComments:0,numberOfLoadedThreads:0,numberOfTotalComments:t.payload.numberOfComments,numberOfTotalThreads:t.payload.numberOfThreads,selectedThreadIndex:t.payload.selectedThreadIndex!==void 0&&t.payload.selectedThreadIndex<t.payload.numberOfThreads?t.payload.selectedThreadIndex:void 0},contextState:o,highlightedCommentId:void 0,topVisibleThreadId:t.payload.contextDetails?vF(t.payload.contextDetails.topVisibleThreadId):void 0,createdCommentLie:l,selectedThreadIdBeforeCommentSession:void 0,draftState:a,tasks:{},historyRecordViewState:{}})}function Z2e(e,t){return m(m({},e),{contextState:{nextPopulatedContextDetails:t.payload.nextPopulatedContextDetails,isReadOnly:!1,commentThreadCounts:void 0,lastContextChangeIncrement:e.contextState.lastContextChangeIncrement}})}function eLe(e,t){var r=t.payload,n=r.commentId,o=r.lowFidelityWarningType,a=Or(Dc(e),n);if(!a)return x().assertConditionTag(!1,"Comment not found",593762530),e;if(fr(e.draftState))return x().assertConditionTag(!1,"Cannot show warning with pending or active session",593762531),e;var d,c=e.expandedComments;return o===Mt.DeleteThread?d={selectedCardId:n,selectionDetails:{lowFidelityWarningType:o}}:(d={selectedCardId:Ze(a),selectionDetails:{selectedPostId:n,lowFidelityWarningType:o}},c=qa(c,d,e.draftState)),m(m({},e),{selectedComment:d,expandedComments:c})}function tLe(e,t){var r=e.selectedComment;return!r||r.selectionDetails.lowFidelityWarningType===void 0?e:m(m({},e),{selectedComment:m(m({},r),{selectionDetails:{lowFidelityWarningType:void 0}})})}function rLe(e,t){return PF(e.draftState,e.selectedComment,t)?m(m({},e),{selectedComment:void 0}):e}function nLe(e,t){return t.payload.commentId!==void 0&&t.payload.commentId!==e.highlightedCommentId?e:m(m({},e),{highlightedCommentId:void 0})}function oLe(e,t){return m(m({},e),{topVisibleThreadId:t.payload.threadId})}function iLe(e,t){var r=!1,n=m({},e.contextState),o=e.createdCommentLie,a=e.draftState,d=void 0;return t.payload.contextState.commentThreadCounts!==void 0&&(r=!0,n.commentThreadCounts=t.payload.contextState.commentThreadCounts),t.payload.contextState.nextPopulatedContextDetails!==void 0&&(r=!0,n.nextPopulatedContextDetails=t.payload.contextState.nextPopulatedContextDetails),t.payload.contextState.isReadOnly!==void 0&&(r=!0,n.isReadOnly=t.payload.contextState.isReadOnly,n.isReadOnly&&(a=kF(e.draftState),d=d??5,tt(e.draftState,!0)&&(o=void 0))),r?(Wa(e.draftState,a,d,5,C.reserveTag(539297117)),m(m({},e),{draftState:a,contextState:n,createdCommentLie:o})):e}function aLe(e,t){var r;if(!Wo(e.draftState))return x().assertConditionTag(!1,"BeginProcessingCommitAction unexpected",593764352),e;var n=e.draftState,o=Ye(e.draftState);return o&&(n=m(m({},n),{drafts:m(m({},n.drafts),(r={},r[o.commentDraft.sessionConfiguration.draftId]=m(m({},o),{pendingState:Fi.Commit}),r))})),m(m({},e),{draftState:n})}function sLe(e,t){var r;if(!fi(e.draftState))return x().assertConditionTag(!1,"CommitFailureAction unexpected",593764353),e;var n=e.draftState,o=Ye(e.draftState);return o&&(n=m(m({},n),{drafts:m(m({},n.drafts),(r={},r[o.commentDraft.sessionConfiguration.draftId]=m(m({},o),{pendingState:Fi.None,savedDraftContent:t.payload.commitText!==void 0?{editorContent:Promise.resolve(t.payload.commitText),editorCursorPosition:Promise.resolve(void 0)}:o.savedDraftContent}),r))})),m(m({},e),{draftState:n})}function dLe(e){var t;if(!MC(e.draftState))return x().assertConditionTag(!1,"CancelDiscardAction unexpected",593764354),e;var r=e.draftState,n=Ye(e.draftState);return n&&(r=m(m({},r),{drafts:m(m({},r.drafts),(t={},t[n.commentDraft.sessionConfiguration.draftId]=m(m({},n),{pendingState:Fi.None}),t))})),m(m({},e),{draftState:r})}function cLe(e){var t;if(!Wo(e.draftState)&&!Bm(e.selectedComment))return x().assertConditionTag(!1,"BeginProcessingDiscardAction unexpected",593764355),e;var r=e.draftState,n=Ye(e.draftState);return n&&(r=m(m({},r),{drafts:m(m({},r.drafts),(t={},t[n.commentDraft.sessionConfiguration.draftId]=m(m({},n),{pendingState:Fi.Discard}),t))})),m(m({},e),{draftState:r})}function uLe(e,t){var r;if(e.createdCommentLie)return x().assertConditionTag(!1,"SessionRequestStartedAndLockSelection unexpected defined comment lie in state",593764356),e;if(wc(t.payload.params))r=t.payload.params.threadId;else if(ja(t.payload.params)){var n=t.payload.params.commentId,o=Or(Dc(e),n);if(o)r=Ze(o);else return x().assertConditionTag(!1,"Could not lock selection on missing comment",593764357),e}else r=Vm();var a=void 0;t.payload.captureSelectedThreadIdBeforeSession&&e.selectedComment&&(a=e.selectedComment.selectedCardId);var d=m(m({},e.draftState),{pendingDraft:t.payload.params,committedLieId:void 0}),c=a7(e.selectedComment,t,r),u=et(c.selectionDetails)?qa(e.expandedComments,c,d):e.expandedComments;return m(m({},e),{selectedThreadIdBeforeCommentSession:a,selectedComment:c,expandedComments:u,draftState:d})}function lLe(e,t){if(Object.keys(t.payload.personaIconPropertiesMap).length===0)return e;var r=m(m({},e.personaIconPropertiesMap),t.payload.personaIconPropertiesMap);return m(m({},e),{personaIconPropertiesMap:r})}function fLe(e,t){return m(m({},e),{modelCapabilities:m(m({},e.modelCapabilities),{atMention:t.payload.capability})})}function pLe(e,t){var r,n,o=_d(e.draftState);if(o===void 0)return x().assertConditionTag(!1,"Expected active draft to be present",593764360),e;var a=o.sessionConfiguration,d=a.draftId,c=e.draftState.drafts;if(!c[d])return x().assertConditionTag(!1,"Expected draft to be present on display draft warning",593764361),e;var u=c[d].draftWarningState,l=m(m({},c[d]),{draftWarningState:{warningCounter:u?u.warningCounter+1:0,type:t.payload.draftWarningType}}),p=m(m({},c),(r={},r[d]=l,r)),g=it()&&(Ua(l.commentDraft.sessionConfiguration)||((n=e.selectedComment)===null||n===void 0?void 0:n.selectedCardId)!==l.threadId)?n7(l):e.selectedComment,h=m(m({},e.draftState),{drafts:p});return m(m({},e),{draftState:h,selectedComment:g,expandedComments:oa(e.expandedComments,g,h)})}function mLe(e,t){var r={atMention:t.payload.modelCapabilityFlags&ti.AtMentionKnown?t.payload.modelCapabilityFlags&ti.AtMentionEnabled?_t.Enabled:_t.Disabled:_t.Unknown,newThread:!!(t.payload.modelCapabilityFlags&ti.NewThread),resolve:!!(t.payload.modelCapabilityFlags&ti.Resolve),richTextCapabilities:t.payload.richTextCapabilityFlags,virtualized:!!(t.payload.modelCapabilityFlags&ti.Virtualized),tasks:t.payload.modelCapabilityFlags&ti.TasksKnown?t.payload.modelCapabilityFlags&ti.TasksEnabled?xd.Enabled:xd.Disabled:xd.Unknown,presentLinkToComment:!!(t.payload.modelCapabilityFlags&ti.PresentLinkToComment),atMentionEmailAddresses:!!(t.payload.modelCapabilityFlags&ti.AtMentionEmailAddresses),UIAAnnotationPattern:!!(t.payload.modelCapabilityFlags&ti.UIAAnnotationPattern),ContentExtensionHostingDisabled:!!(t.payload.modelCapabilityFlags&ti.ContentExtensionHostingDisabled)};return m(m({},e),{modelCapabilities:r})}function gLe(e,t){var r,n,o=_d(e.draftState);if(o===void 0)return x().assertConditionTag(!1,"Expected active draft to be present",593764364),e;var a=o.sessionConfiguration;if(Ua(a))return e;var d=e.draftState.drafts[a.draftId];if(!d)return x().assertConditionTag(!1,"Missing draft for adding mentionees",593764365),e;var c=d.currentMentionees,u=bs(t.payload.mentionee);if(c&&c[u])return e;var l={};for(var p in c)l[p]={mentionee:m({},c[p].mentionee),stillInDraft:c[p].stillInDraft};l[u]={mentionee:m({},t.payload.mentionee),stillInDraft:!0};var g=void 0;e.draftState.drafts[a.draftId].selectedTaskAssignees&&(g=m({},e.draftState.drafts[a.draftId].selectedTaskAssignees),Sw(g,(r={},r[u]={mentionee:m({},t.payload.mentionee),stillInDraft:!0},r)));var h=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(n={},n[a.draftId]=m(m({},e.draftState.drafts[a.draftId]),{currentMentionees:l,selectedTaskAssignees:g}),n))});return m(m({},e),{draftState:h})}function hLe(e,t){var r,n=_d(e.draftState);if(n===void 0)return x().assertConditionTag(!1,"Expected active draft to be present",593764366),e;var o=n.sessionConfiguration;if(Ua(o))return e;var a=e.draftState.drafts[o.draftId];if(!a)return x().assertConditionTag(!1,"Missing draft for updating mentionees",593764367),e;var d=a.currentMentionees,c={};for(var u in d)c[u]={mentionee:m({},d[u].mentionee),stillInDraft:t.payload.emailsStillInDraft.has(u)};var l=a.selectedTaskAssignee;if(l){var p=bs(l);(!c[p]||!c[p].stillInDraft)&&(l=void 0)}var g=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(r={},r[o.draftId]=m(m({},e.draftState.drafts[o.draftId]),{currentMentionees:c,selectedTaskAssignee:l}),r))});return m(m({},e),{draftState:g})}function yLe(e,t){var r;if(Im())return x().assertConditionTag(!1,"Should not update selectedTaskAssignee if CommentTasksWithMultiAssign is on.",529096909),e;var n=_d(e.draftState);if(n===void 0)return x().assertConditionTag(!1,"Expected active draft to be present",593764368),e;var o=n.sessionConfiguration;if(Ua(o))return e;var a=o.draftId,d=e.draftState.drafts;if(!d[a])return x().assertConditionTag(!1,"Expected draft to be present on update selected task assignee",593764369),e;var c=m(m({},d),(r={},r[a]=m(m({},d[a]),{selectedTaskAssignee:t.payload.selectedAssignee}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:c})})}function CLe(e,t){var r,n;if(!Im())return x().assertConditionTag(!1,"Should not update selectedTaskAssignees if CommentTasksWithMultiAssign is off.",529096910),e;var o=_d(e.draftState);if(o===void 0)return x().assertConditionTag(!1,"Expected active draft to be present",529143574),e;var a=o.sessionConfiguration;if(Ua(a))return e;var d=a.draftId,c=e.draftState.drafts;if(!c[d])return x().assertConditionTag(!1,"Expected draft to be present on update selected task assignees",529143575),e;var u=(n=c[d].selectedTaskAssignees)!==null&&n!==void 0?n:{},l=m({},u);aj(l,t.payload.selectedAssignee);var p=m(m({},c),(r={},r[d]=m(m({},c[d]),{selectedTaskAssignees:l}),r));return m(m({},e),{draftState:m(m({},e.draftState),{drafts:p})})}function vLe(e){var t;if(!Im())return x().assertConditionTag(!1,"toggleTaskAssigner should not be called unless CommentTasksWithMultiAssign is enabled.",529143576),e;var r=Ye(e.draftState);if(r===void 0)return x().assertConditionTag(!1,"No draft available while initializing selected task assignees.",529143577),e;var n=r.commentDraft,o=r.selectedTaskAssignees,a={};if(o===void 0){if(mf(n.sessionConfiguration)){var d=e.tasks[n.sessionConfiguration.threadId];x().assertConditionTag(!!d,"Task not found.",529143616),ij(a,d.currentState.assignees)}r.currentMentionees!==void 0&&Sw(a,r.currentMentionees)}else a=void 0;var c=n.sessionConfiguration.draftId,u=m(m({},e.draftState),{drafts:m(m({},e.draftState.drafts),(t={},t[c]=m(m({},e.draftState.drafts[c]),{selectedTaskAssignees:a}),t))});return m(m({},e),{draftState:u})}function xLe(e,t){var r=e.draftState,n=e.selectedComment,o=e.expandedComments;if(t.payload.visibilityState!==bt.Visible&&!qt()&&(r=_F(r),e.selectedComment&&Object.keys(r.drafts).length===0&&Object.keys(e.draftState.drafts).length>0)){var a=Ka(e.draftState);a&&(n=Sn(a),o=oa(e.expandedComments,n,r))}return r=KI(r,function(d){var c=e.draftState.drafts[d];return h7(c.renderContextType,t.payload.visibilityState)}),m(m({},e),{selectedComment:n,expandedComments:o,draftState:r})}function TLe(e,t){var r=m(m({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!0}),n=m({},e.postViewState);return n[t.payload.commentId]=r,m(m({},e),{postViewState:n})}function bLe(e,t){var r=m(m({},e.postViewState[t.payload.commentId]),{displayingErrorUI:!1}),n=m({},e.postViewState);return n[t.payload.commentId]=r,m(m({},e),{postViewState:n})}function SLe(e,t){return m(m({},e),{suggestionsDetails:t.payload.details})}function ILe(e,t){return m(m({},e),{draftState:v7(e.draftState,t.payload)})}var Gye;s();k();Eu();te();Di();Na();Uf();Ve();Zm();ye();Cr();function q3(){x().assertConditionTag(!1,"Must specify initial pane state!",595918942)}function ELe(){return{viewContainer:{closeView:q3,openView:q3,containerType:on.FullPane,moveFocusToCanvas_donotuse:q3},componentTree:new ql(A.FullPane,pd),visibilityState:bt.Closed,initializationStatus:Wn.NotInitialized,viewContainerDisplayConfiguration:void 0}}function Kye(e,t){switch(e===void 0&&(e=ELe()),t===void 0&&(t=Bn),t.type){case"VIEW_CONTAINER_CHANGED":return PLe(e,t);case"VIEW_CONTAINER_DISPLAY_CONFIGURATION_CHANGED":return _Le(e,t);case"VIEW_CONTAINER_VISIBILITY_CHANGED":return RLe(e,t);case"VIEW_CONTAINER_FOLDABLE_LAYOUT_STATE_CHANGED":return ALe(e,t);case"BEGIN_VIEW_INIT":return kLe(e);case"END_VIEW_INIT":return DLe(e);default:return e}}function PLe(e,t){var r=e.viewContainer.containerType!==t.payload.viewContainer.containerType;return m(m({},e),{viewContainer:t.payload.viewContainer,componentTree:r?new ql(Fs(t.payload.viewContainer.containerType),e.componentTree.componentTreeId.contextIdentifier,e.componentTree):e.componentTree})}function _Le(e,t){return t.payload.displayConfiguration===e.viewContainerDisplayConfiguration?e:m(m({},e),{viewContainerDisplayConfiguration:t.payload.displayConfiguration})}function RLe(e,t){return m(m({},e),{initializationStatus:t.payload.visibilityState!==bt.Closed||ki()?e.initializationStatus:Wn.NotInitialized,visibilityState:t.payload.visibilityState})}function ALe(e,t){var r=m(m({},e.viewContainer),{foldableLayoutState:t.payload.foldableLayoutState});return m(m({},e),{viewContainer:r})}function kLe(e){return m(m({},e),{initializationStatus:Wn.Initializing})}function DLe(e){return m(m({},e),{initializationStatus:Wn.Initialized})}var K3=void 0;function Yye(e,t){t===void 0&&(t=Bn),K3||(K3=wh({paneState:Kye,contentExtensions:jye,commentState:qye,filterState:Wye}));var r=K3(e,t);return r}s();ne();te();gd();lr();pn();ye();an();s();k();ne();rt();Ve();Cr();Rf();St();var wLe=500,FLe=20,OLe=function(){return{threadIdRequests:new Map,sequenceId:0}};function $ye(e){return e&&(e.loadState.state===st.Placeholder||e.loadState.state===st.NeedsReload)}var NLe=function(t){return function(r,n){var o,a,d=Mi(t.getState());try{for(var c=$e(n),u=c.next();!u.done;u=c.next()){var l=u.value;$ye(d[l])&&r.threadIdRequests.set(l,r.sequenceId++)}}catch(p){o={error:p}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(o)throw o.error}}return r}},MLe=function(t,r,n){return function(o){for(var a=Array.from(o.threadIdRequests.entries()).sort(function(g,h){var v=V(g,2),y=v[0],T=v[1],b=V(h,2),I=b[0],E=b[1];return T-E}),d=[],c=Mi(t.getState()),u=a.pop();u&&d.length<n;u=a.pop()){var l=V(u,1),p=l[0];o.threadIdRequests.delete(p),$ye(c[p])&&d.push(p)}if(d.length&&t.dispatch(OS({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(594888212)},{threadIds:d})),o.threadIdRequests.size>0)return o}},Qye=function(t,r,n){return n===void 0&&(n=FLe),gu(NLe(t),MLe(t,r,n),OLe,wLe)};bn();St();Qp();el();var Xye=function(t,r){return function(n){var o=Qye(n,r);return function(a){return function(d){var c=n.getState();switch(d.type){case"COMMENT_CONTEXT_CHANGED":case"RELOAD_COMMENTS":o.reset();break;case"COMMIT_DRAFT":var u=Go(c),l=En(c);if(l!==void 0){var p=l.commentDraft;if(d.payload.metadataUpdates&&d.payload.metadataUpdates.Task){var g=void 0;p.sessionConfiguration.sessionType!==ro&&p.sessionConfiguration.sessionType!==na&&(g=u[p.sessionConfiguration.threadId]&&u[p.sessionConfiguration.threadId].id),d.payload.metadataUpdates.Task.taskId=g,p.updateProperties("Task",d.payload.metadataUpdates.Task)}d.payload.data.temporaryCommentId=p.commit(d.payload.data.commentBody)}break;case"QUEUE_LOAD_THREADS":{if(!Lr(c).virtualized){x().assertConditionTag(!1,"Load threads should not be queued if host is not virtualizing comments.",593768920);return}o(d.payload.threadIds);return}case"DISPATCH_LOAD_THREADS":{if(!Lr(c).virtualized)return;t.loadThreads(d.payload.threadIds);break}case"HIGHLIGHT_COMMENT":d.payload.actionSource===le.SharedComments&&t.highlightComment(d.payload.commentId);break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":var h=pe(c);if(fr(h))return;t.deleteComment(d.payload.commentId);break;case"REQUEST_THREAD_RESOLVE":{at()?t.beginDraftingAsync({sessionType:"METADATA",threadId:d.payload.commentId}).then(function(P){var _=Go(c)[d.payload.commentId];_&&P.updateProperties("Task",{type:"Task",completion:100,taskId:_.id}),P.updateProperties("Resolve",{type:"Resolve",isResolved:!0}),P.commit(),P.endDrafting()}).catch(me(C.reserveTag(593768922))):t.setThreadResolvedState(d.payload.commentId,!0);break}case"REQUEST_REOPEN_THREAD":{at()?t.beginDraftingAsync({sessionType:"METADATA",threadId:d.payload.commentId}).then(function(P){var _=Go(c)[d.payload.commentId];_&&P.updateProperties("Task",{type:"Task",completion:0,taskId:_.id}),P.updateProperties("Resolve",{type:"Resolve",isResolved:!1}),P.commit(),P.endDrafting()}).catch(me(C.reserveTag(593768924))):t.setThreadResolvedState(d.payload.commentId,!1);break}case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":t.selectFirstThreadInNextCommentContext();break;case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":t.selectLastThreadInPreviousCommentContext();break;case"PRESENT_LINK_TO_COMMENT":t.presentLinkToComment(d.payload.commentId);break;default:break}var v=a(d),y=n.getState(),T=Ie(c),b=Ie(y),I=void 0;switch(d.type!=="LOAD_COMMENT"&&d.type!=="VIRTUALIZE_COMMENTS"&&(d.type!=="SELECT_COMMENT"||d.payload.source===le.SharedComments)&&b&&b.selectedCardId!==(T==null?void 0:T.selectedCardId)&&b.selectedCardId!==Vm()&&(I=b.selectedCardId),d.type){case"CLEAR_COMMENT_HIGHLIGHT":d.payload.actionSource===le.SharedComments&&c.commentState.highlightedCommentId!==void 0&&y.commentState.highlightedCommentId===void 0&&t.highlightComment("");break;case"DISPLAY_DRAFT_WARNING":if(Tn()&&!hy(n.getState())){var E=En(y);E&&(I=E.threadId)}break;default:break}return I&&t.selectComment(I),v}}}};s();k();ne();Eo();Ve();Cr();St();Qp();lo();function Jye(e,t,r){var n=e.getState(),o=$p(n)[de.Isolated];return o?(r(t),o.controller.triggerUpdate(),!0):!1}function Y3(e,t,r,n){return n==="CREATE"?Jye(e,t,r):!1}function Sy(e,t){return Rd(t).lastContextChangeIncrement===0?Nt.Disabled:e===de.TaskPane||e===de.TaskPaneItem?Ro(t)?Nt.Primary:Nt.Disabled:Li(t)?Nt.Disabled:Sy(de.TaskPane,t)!==Nt.Primary?Nt.Primary:e===de.Integrated?Nt.Disabled:Nt.Secondary}function Fk(e,t){var r=$p(e)[t];r&&(r.controller.priority=r.priority)}var Zye=function(t){return function(r){return function(n){return function(o){var a,d,c;switch(o.type){case"ADD_CONTENT_EXTENSION":{o.payload.extension.priority=Sy(o.payload.extension.provider.scope.renderMode,r.getState());break}case"REMOVE_CONTENT_EXTENSION":{try{for(var u=$e(o.payload.renderModes),l=u.next();!l.done;l=u.next()){var p=l.value,g=$p(r.getState())[p];g&&g.controller.unregisterExtension()}}catch(v){a={error:v}}finally{try{l&&!l.done&&(d=u.return)&&d.call(u)}finally{if(a)throw a.error}}break}case"UPDATE_EXTENSION_PRIORITY":{n(o),Fk(r.getState(),de.TaskPane),Fk(r.getState(),de.TaskPaneItem),Fk(r.getState(),de.Integrated),Fk(r.getState(),de.Isolated);break}case"APPLY_COMMENT_CHANGES":case"CANCEL_COMMENT_CREATE_THREAD":if(Jye(r,o,n))return;break;case"COMMENT_CONTEXT_CHANGED":case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":case"RELOAD_COMMENTS":case"VIEW_CONTAINER_VISIBILITY_CHANGED":{n(o),r.dispatch(uI({renderContextType:A.None,telemetryVisitor:t,trackback:C.reserveTag(594834319)},(c={},c[de.TaskPane]=Sy(de.TaskPane,r.getState()),c[de.TaskPaneItem]=Sy(de.TaskPaneItem,r.getState()),c[de.Integrated]=Sy(de.Integrated,r.getState()),c[de.Isolated]=Sy(de.Isolated,r.getState()),c)));return}case"BEGIN_DRAFTING_SUCCESS":{if(Y3(r,o,n,o.payload.draftDetails.sessionConfiguration.sessionType))return;break}case"BEGIN_DRAFTING_FAILURE":{if(Y3(r,o,n,o.payload.beginDraftingParams.sessionType))return;break}case"UPDATE_DRAFT_RENDER_CONTEXT":{if(o.payload.isClaimingLock||o.actionDetail.renderContextType===A.DiscreteIsolated)break;var h=En(r.getState());if(h&&Y3(r,o,n,h.commentDraft.sessionConfiguration.sessionType))return;break}}return n(o)}}}};s();Eo();wd();li();ye();Cr();an();St();Qp();lo();var eCe=function(t){return function(r){return function(n){return function(o){var a;if(!t||!hy(r.getState()))return n(o);var d=r.getState(),c=n(o),u=r.getState();switch(o.type){case"DISPLAY_DRAFT_WARNING":{var l=Ie(d),p=Ie(u),g=!p||p.selectedCardId===(l==null?void 0:l.selectedCardId);if(Tn()&&g){var h=En(u);h&&t.bringContentIntoView({contentIdentifier:{contentId:h.threadId,contentType:Bt.CommentThread}})}break}case"SELECT_COMMENT":{var v=Ie(u);o.payload.source===le.SharedComments&&o.payload.selectType!==Ae.Polite&&Kt(o.actionDetail.renderContextType)&&v&&t.bringContentIntoView({contentIdentifier:{contentId:v.selectedCardId,contentType:Bt.CommentThread}});break}case"VIEW_CONTAINER_VISIBILITY_CHANGED":{if(Ro(u))break;var y=En(u),T=y&&y.isInCurrentContext&&((a=Ie(u))===null||a===void 0?void 0:a.selectedCardId)===y.threadId?y.threadId:void 0;T&&t.bringContentIntoView({contentIdentifier:{contentId:T,contentType:Bt.CommentThread}});break}case"SELECT_CONTENT":{t.selectNextOrPreviousContent(o.payload);break}case"MOVE_FOCUS_TO_CANVAS":{t.moveFocus({region:il.Canvas,resource:o.payload.resource});break}}return c}}}};s();te();II();ye();var tCe=function(t){return function(r){return function(n){return function(o){var a=r.getState().commentState.draftState.drafts;n(o);var d=r.getState().commentState.draftState.drafts;if(Object.keys(a).forEach(function(u){if(d[u]===void 0){var l=x().createActivityObject("EndDraftingCalledOnAction",t,Ee());l.addDataField("ActionName",o.type,N.SystemMetadata),l.successTag(539313865),a[u].commentDraft.endDrafting()}}),lf()&&o.type==="SAVE_DRAFT"){var c=d[o.payload.draftId];c&&Tf().storeEditorContentFromDraftSave(o.payload,c.commentDraft.sessionConfiguration)}}}}};s();ne();te();Jt();Fc();iE();s();te();Bw();var LLe="ApplyCommentChangesAction",HLe="BeginProcessingCommitAction",BLe="CancelCommentCreateThreadAction",ULe="CancelCommentPostEditAction",VLe="CancelCommentReplyAction",jLe="CollapseCardAction",WLe="CommitDraftAction",zLe="DeletePostAction",GLe="DeleteThreadAction",qLe="DisplayDraftWarningAction",KLe="LoadThreadsAction",YLe="PresentLinkToCommentAction",$Le="ReloadCommentsAction",QLe="ReopenThreadAction",XLe="ResolveThreadAction",JLe="SelectCommentAction",ZLe="SelectFirstThreadInNextCommentContextAction",eHe="SelectLastThreadInPreviousCommentContextAction",tHe="SessionRequestStartedAndLockSelectionAction",rHe="ShowLowFidelityWarningAction",nHe="ClearLowFidelityWarningAction",oHe="UpdateDraftRenderContext",On=Ee();function Ok(e){switch(e.type){case"APPLY_COMMENT_CHANGES":return{name:LLe,activityConfig:{aggregationMode:eo.OnSuccess}};case"BEGIN_PROCESSING_COMMIT":return{name:HLe,activityConfig:On};case"CANCEL_COMMENT_CREATE_THREAD":return{name:BLe,activityConfig:On};case"CANCEL_COMMENT_POST_EDIT":return{name:ULe,activityConfig:On};case"CANCEL_COMMENT_REPLY":return{name:VLe,activityConfig:On};case"COLLAPSE_CARD":return{name:jLe,activityConfig:On};case"COMMIT_DRAFT":return{name:WLe,activityConfig:On};case"DISPLAY_DRAFT_WARNING":return{name:qLe,activityConfig:On};case"RELOAD_COMMENTS":return{name:$Le,activityConfig:{aggregationMode:eo.OnSuccess}};case"REQUEST_DELETE_POST":return{name:zLe,activityConfig:On};case"REQUEST_DELETE_THREAD":return{name:GLe,activityConfig:On,logDocumentMetadata:_i.Basic};case"DISPATCH_LOAD_THREADS":return{name:KLe,activityConfig:{aggregationMode:eo.OnSuccess}};case"REQUEST_REOPEN_THREAD":return{name:QLe,activityConfig:On};case"REQUEST_THREAD_RESOLVE":return{name:XLe,activityConfig:On,logDocumentMetadata:_i.Basic};case"SELECT_COMMENT":return{name:JLe,activityConfig:On};case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":return{name:ZLe,activityConfig:On};case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":return{name:eHe,activityConfig:On};case"SESSION_REQUEST_STARTED":return{name:tHe,activityConfig:On};case"SHOW_LOW_FIDELITY_WARNING":return{name:rHe,activityConfig:On};case"CLEAR_LOW_FIDELITY_WARNING":return{name:nHe,activityConfig:On};case"UPDATE_DRAFT_RENDER_CONTEXT":return{name:oHe,activityConfig:On};case"PRESENT_LINK_TO_COMMENT":return{name:YLe,activityConfig:On};case"CLEAR_COMMENT_SELECTION":default:return}}function rCe(e){if(e.type==="COMMIT_DRAFT")return{name:"CommitDraft".concat(FS(e.payload),"Action"),activityConfig:On}}var nCe=function(){return function(t){return function(r){try{var n=t(r);return n}catch(d){var o=Ok(r);if(o===void 0){var a=x().createActivityObject("ExceptionMiddlewareCatch",r.actionDetail.telemetryVisitor,Ee());a.addDataField("OperationType",r.type,N.SystemMetadata),a.addDataField("Trackback",r.actionDetail.trackback,N.SystemMetadata),a.failTag(593278723,sn(d))}iHe(d)}}}};function iHe(e){if(eg(e))throw e;if(Ri(e))switch(e.errorCode){case-2130957565:throw e;case-2130957551:throw e;case-2130957536:return;default:x().assertConditionTag(!1,"Unexpected error: Name: ".concat(e.name," errorCode: ").concat(e.errorCode," Tag: ").concat(e.tag," internalDetails: ").concat(So(e)),e.tag);return}else throw x().assertConditionTag(!1,"Unknown error encountered, rethrowing: ".concat(So(e)),593278724),e}s();k();Sd();ne();te();Eo();Ve();pn();Cr();Ni();XC();s();te();Ad();var lc;(function(e){e[e.None=1]="None",e[e.Error=2]="Error",e[e.RequestDefaultFilter_unused=3]="RequestDefaultFilter_unused",e[e.LoadDefaultFilter_unused=4]="LoadDefaultFilter_unused",e[e.LoadFilter=5]="LoadFilter",e[e.UpdateFilter=6]="UpdateFilter",e[e.LoadActiveFilter=7]="LoadActiveFilter"})(lc||(lc={}));var Nk=function(t,r,n){if(t!==lc.None){var o=x().createActivityObject("FilterPerfScenario",r,Ee());return o.addDataField("FilterScenario",t,N.SystemMetadata),rg(n,o),o}},$3=function(t){switch(t){case"LOAD_FILTER":return lc.LoadFilter;case"UPDATE_FILTER_RANGE":return lc.UpdateFilter;default:return lc.None}};var Q3=!1,aHe=function(t,r,n,o,a,d){if(!a.get(n)){x().assertConditionTag(!1,"How did we receive an update, when we aren't tracking a filter? Did you forget to teardown an old filter?",528779330);return}r(Cf({renderContextType:o,telemetryVisitor:t,trackback:C.reserveTag(528779331)},{filterId:n,changes:d.changes}))},oCe=function(t,r){return function(n){var o=new Map;return function(a){return function(d){if(!tr(n.getState()))return a(d);var c,u=Nk($3(d.type),r,n.getState()),l=Oi(n.getState());switch(d.type){case"LOAD_FILTER":{c=Ju(n.getState(),d.payload.filteredRange.id);break}case"UPDATE_FILTER_RANGE":{c=Ju(n.getState(),d.payload.filterId);break}case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":{d.payload.filteringEnabled=!0;break}}var p=a(d),g=function(v,y,T){var b=v;if(!b){x().assertConditionTag(!1,"Activity should not be undefined",y);var I=$3(T);b=Nk(I!==lc.None?I:lc.Error,r,n.getState())}return Ln(b,"Perf activity not defined in error fallback case.",C.reserveTag(520168332)),b};switch(d.type){case"LOAD_FILTER":{sHe(t,r,n,d,o,g(u,C.reserveTag(520198025),d.type),c,l);break}case"UPDATE_FILTER_RANGE":{dHe(t,r,n,d,o,g(u,C.reserveTag(520198024),d.type),c,l);break}}return $I(n.getState())&&cHe(t,r,n,d.type,g),p}}}};function sHe(e,t,r,n,o,a,d,c){d===void 0&&Ju(r.getState(),n.payload.filteredRange.id)&&(o.set(n.payload.filteredRange.id,{filter:n.payload.filteredRange,changeToken:n.payload.filteredRange.onRangeUpdated.subscribe(function(u){aHe(t,r.dispatch,n.payload.filteredRange.id,n.actionDetail.renderContextType,o,u)})}),n.payload.shouldSetActive&&Oi(r.getState())===n.payload.filteredRange.id&&(Oi(r.getState())!==c&&e.setActiveFilteredRange(n.payload.filteredRange.id),c&&c!==Oi(r.getState())&&r.dispatch(Cf({renderContextType:n.actionDetail.renderContextType,telemetryVisitor:t,trackback:C.reserveTag(528779332)},{filterId:c,changes:[{type:"Teardown",teardownReason:bd.RangeObsolete}]})))),a.successTag(C.reserveTag(520198023))}function dHe(e,t,r,n,o,a,d,c){Oi(r.getState())!==c&&e.setActiveFilteredRange(Oi(r.getState()));var u=Ju(r.getState(),n.payload.filterId);if(d&&u&&d.filter!==u.filter){var l=o.get(n.payload.filterId);!l||!l.filter.canBeUpdated()?X3(e,t,a,r,u.filter,!1,c===n.payload.filterId):l.filter.updateFilter(u.filter)?a.successTag(520198022):(x().assertConditionTag(!1,"The filter should have been able to update",528527826),X3(e,t,a,r,u.filter,!1,c===n.payload.filterId))}var p=function(){return n.payload.changes.findIndex(function(v){return v.type==="Teardown"})>=0};if(!Ju(r.getState(),n.payload.filterId)){x().assertConditionTag(p(),"Range should not be removed unless there was a Teardown",528749966);var g=o.get(n.payload.filterId);g&&(g.filter.teardown(),g.changeToken.unsubscribe(),o.delete(n.payload.filterId))}a.isEnded()||a.successTag(520198021)}var X3=function(t,r,n,o,a,d,c){t.createFilteredRange({contentTypes:[Bt.CommentThread],filters:a,supportsFilterUpdates:d}).then(function(u){o.dispatch(yf({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(528532107)},{filteredRange:u,shouldSetActive:c})),n.successTag(520198020)}).catch(function(u){n.failTag(C.reserveTag(507597955),-2147467259),me(C.reserveTag(507597956))(u)})},cHe=function(t,r,n,o,a){if(!Q3){Q3=!0;var d=Nk(lc.LoadActiveFilter,r,n.getState()),c=a(d,C.reserveTag(507794050),o);uHe(t,r,n,c).catch(function(u){x().assertConditionTag(!1,"Failed to load active filter. Error: ".concat(So(u)),507794049),c.failTag(C.reserveTag(507794048),-2147467259)}).finally(function(){Q3=!1})}},uHe=function(t,r,n,o){return Wt(void 0,void 0,void 0,function(){var a,d,c,u,l,p,g;return pt(this,function(h){switch(h.label){case 0:return(p=Oi(n.getState()))!==null&&p!==void 0?(d=p,[3,3]):[3,1];case 1:return[4,t.getActiveFilteredRangeId()];case 2:d=h.sent(),h.label=3;case 3:return a=d,a?[4,t.getFilteredRange(a)]:[3,5];case 4:if(c=h.sent(),c)return n.dispatch(yf({renderContextType:A.None,telemetryVisitor:r,trackback:C.reserveTag(507794018)},{filteredRange:c,shouldSetActive:!0})),o.successTag(507597954),[2];h.label=5;case 5:return u=sa,l=!!(!((g=tr(n.getState()))===null||g===void 0)&&g.supportsFilterByUser),l&&(u=m(m({},sa),{userFilter:[]})),X3(t,r,o,n,u,!0,!0),[2]}})})};s();yt();Sf();St();var iCe=function(t){return function(r){return function(n){return function(o){var a,d,c=r.getState(),u=n(o),l=r.getState();switch(o.type){case"BEGIN_DRAFTING_SUCCESS":{var p=pe(l),g=o.payload.draftDetails.sessionConfiguration.draftId,h=p.drafts[g];h&&t.setDeferredActiveEditorFocusCommand(g);break}case"DISPLAY_DRAFT_WARNING":{if(o.payload.draftWarningType===Mr.CommitFailed)break;var p=pe(l),h=_d(p);h&&t.setDeferredActiveEditorFocusCommand(h.sessionConfiguration.draftId);break}}return(((a=Ie(l))===null||a===void 0?void 0:a.selectedCardId)!==((d=Ie(c))===null||d===void 0?void 0:d.selectedCardId)||pe(l)!==pe(c))&&t.clearPendingOnComponentFocusedRequest(),u}}}};s();ym();Di();Xa();yi();Vo();Pr();ye();lo();Sf();var aCe=function(t){return function(r){return function(n){return function(o){switch(o.type){case"DISPLAY_DRAFT_WARNING":{if(!Tn())break;var a=AI(t,o.payload.draftWarningType),d=Q()==="win32"&&(o.payload.draftWarningType===Mr.GrantAccessFailedSilently||o.payload.draftWarningType===Mr.GrantAccessCanceled)&&aa(r.getState())===bt.Visible;oi(o.payload.draftWarningType===Mr.ReturnToDraft?t.formatString(230,a):a,d?{nativeId:jn(X.PaneRoot)}:void 0);break}}return n(o)}}}};s();k();ne();rt();te();Es();df();xf();Di();nF();Fc();Cr();an();s();LC();Ad();yt();St();el();io();s();ne();te();s();var sCe=1e3,dCe=5e3;var VT;(function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.Unknown=2]="Unknown"})(VT||(VT={}));function UT(e){e.timerHandle&&clearTimeout(e.timerHandle)}var cCe=function(){function e(t){var r=this;this.telemetryVisitor=t,this.trackerActivityName="E2EPerfTracker",this.performanceActivities={},this.failTracker=function(n,o,a){var d=r.performanceActivities[n];d&&(d.activity.failTag(o,a??-2130957541),UT(d),delete r.performanceActivities[n])},this.timeoutTracker=function(n,o,a){var d=r.performanceActivities[n];d&&(UT(d),d.activity.addDataField("Timeout",!0,N.SystemMetadata),o.failOnTimeout?d.activity.failTag(a,-2130957491):d.activity.successTag(a),delete r.performanceActivities[n])}}return e.prototype.beginTracking=function(t,r,n,o,a){var d=this;a===void 0&&(a={timeout:sCe,failOnTimeout:!0});var c=o||x().createActivityObject(this.trackerActivityName,this.telemetryVisitor,Ee());c.addDataField("OperationType",n,N.SystemMetadata),this.performanceActivities.hasOwnProperty(t)&&(x().assertConditionTag(!1,"Duplicate ID used for PerfActivity. Overwriting initial perf tracker with failure.",595132703),this.failTracker(t,C.reserveTag(595907678)));var u={activity:c,expectedChangeType:r};u.timerHandle=setTimeout(function(){return d.timeoutTracker(t,a,C.reserveTag(575484417))},a.timeout),this.performanceActivities[t]=u},e.prototype.updateTrackerId=function(t,r){if(t!==r){this.performanceActivities.hasOwnProperty(r)&&(x().assertConditionTag(!1,"Duplicate ID used for updateTrackerId. Overwriting initial perf tracker with failure.",595132704),this.failTracker(r,C.reserveTag(595132705)));var n=this.performanceActivities[t];n&&(this.performanceActivities[r]=n,delete this.performanceActivities[t])}},e.prototype.failAllTrackers=function(t,r){var n=this;Object.keys(this.performanceActivities).forEach(function(o){var a=n.performanceActivities[o];UT(a),a.activity.failTag(t,r??-2130957541)}),this.performanceActivities={}},e.prototype.endTracker=function(t,r,n){var o=this.performanceActivities[t];o&&(UT(o),o.activity.addDataField("ExpectedChangeArrived",o.expectedChangeType===r?VT.Yes:VT.No,N.SystemMetadata),o.activity.successTag(n),delete this.performanceActivities[t])},e.prototype.endAllTrackers=function(t){for(var r in this.performanceActivities){var n=this.performanceActivities[r];UT(n),n.activity.addDataField("ExpectedChangeArrived",VT.Unknown,N.SystemMetadata),n.activity.successTag(t)}this.performanceActivities={}},e.prototype.getTracker=function(t,r){var n=this.performanceActivities[t];if(n&&n.expectedChangeType===r)return n},e}();s();te();so();var uCe=function(){function e(t){this.telemetryVisitor=t,this.trackerActivityName="LowFidelityScenarioTracker"}return e.prototype.beginTracking=function(t){var r=ui(t);this.activity&&r!==this.selectedCommentId&&(this.activity.addDataField("OperationType","SHOW_LOW_FIDELITY_WARNING",N.SystemMetadata),this.activity.successTag(593098840),this.activity=void 0,this.selectedCommentId=void 0),!this.activity&&!this.selectedCommentId&&(this.activity=x().createActivityObject(this.trackerActivityName,this.telemetryVisitor,Ee()),this.selectedCommentId=r)},e.prototype.endTrackingIfWarningDismissed=function(t,r){var n=ui(r);!this.activity||n===this.selectedCommentId&&_s(r)||(this.activity.addDataField("OperationType",t.type,N.SystemMetadata),this.activity.successTag(593098841),this.activity=void 0,this.selectedCommentId=void 0)},e}();function lCe(e,t){t?e.addDataField("AffectingTaskMetadata",!0,N.SystemMetadata):e.addDataField("AffectingTaskMetadata",!1,N.SystemMetadata)}function J3(e,t,r,n){var o=Or(t,n);if(o){var a=Ze(o),d;ci(t)?d=r[a].some(function(c){return(t[c].commentFlags&Ne.IsNew)!==0}):d=t.some(function(c){return(c.commentId===a||c.parentId===a)&&(c.commentFlags&Ne.IsNew)!==0}),d&&e.addDataField("HasNewComment",d,N.SystemMetadata)}}var fCe=function(t){var r=new cCe(t),n=new uCe(t),o="LoadCommentTracker",a=Mn(function(d){var c=x().createActivityObject("PostButtonTeachingCallout",d.actionDetail.telemetryVisitor,Ee());c.successTag(573687565)});return function(d){return function(c){return function(u){var l,p,g=function(){var $,oe,ie,Ce,se,he,Be=Ok(u);if(!Be)return x().assertConditionTag(!1,"Event name not defined for action type: ".concat(u.type),595616738),c(u);var _e=x().createActivityObject(Be.name,u.actionDetail.telemetryVisitor,Be.activityConfig);_e.addDataField("Trackback",u.actionDetail.trackback,N.SystemMetadata),_e.addDataField("RenderContextType",u.actionDetail.renderContextType,N.SystemMetadata),Be.logDocumentMetadata&&_e.addDocumentMetadata(Be.logDocumentMetadata);var ot=function(am,dve,i4){var Uk=Xm(am,i4);Uk.valid&&(_e.addDataField("MatchesCommentAuthor",Uk.matchesCurrentUser,N.SystemMetadata),_e.addDataField("ThreadCreationDeltaMs",Uk.timeElapsed,N.SystemMetadata)),J3(_e,am,dve,i4)},Ue=d.getState(),or=Go(Ue);switch(rg(Ue,_e),u.type){case"COMMIT_DRAFT":var ir=rCe(u);if(!ir)return x().assertConditionTag(!1,"Event name not defined for given draft action type",595903002),c(u);var ri=x().createActivityObject(ir.name,u.actionDetail.telemetryVisitor,Ee());ri.addDataField("RenderContextType",u.actionDetail.renderContextType,N.SystemMetadata),ri.successTag(595903074);var ni=Mm[u.payload.sessionType];_e.addDataField("SessionType",ni,N.SystemMetadata),u.payload.sessionType==="REPLY"&&J3(_e,wt(Ue),Un(Ue),u.payload.data.parentId);break;case"DISPLAY_DRAFT_WARNING":_e.addDataField("DraftWarningType",u.payload.draftWarningType,N.SystemMetadata),_e.addDataField("DraftWarningReason",u.payload.draftWarningReason,N.SystemMetadata);var Ra=Ye(Ue.commentState.draftState);Ra&&_e.addDataField("IsDraftInCurrentContext",Ra.isInCurrentContext,N.SystemMetadata);break;case"UPDATE_DRAFT_RENDER_CONTEXT":_e.addDataField("IsClaimingDraftLock",u.payload.isClaimingLock,N.SystemMetadata),_e.addDataField("IsUpdatingAllDraftLocks",!u.payload.draftId,N.SystemMetadata);break;case"SELECT_COMMENT":_e.addDataField("SelectType",Ae[u.payload.selectType],N.SystemMetadata),_e.addDataField("ActionSource",le[u.payload.source],N.SystemMetadata);var Aa=Ie(Ue),ka=!!(Aa&&Aa.selectedCardId===u.payload.selectedCard);_e.addDataField("IsCurrentCard",ka,N.SystemMetadata),ka||J3(_e,wt(Ue),Un(Ue),u.payload.selectedCard),p8(u.payload.source)&&m8(u.payload.selectType)&&CI(_e,vf(rE(Ue,u.payload.selectedCard)));break;case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":lCe(_e,u.payload.isTask),ot(wt(Ue),Un(Ue),u.payload.commentId);var sd=void 0;if(u.payload.isTask){sd=u.type==="REQUEST_THREAD_RESOLVE"?"ResolveThreadWithTask":"ReopenThreadWithTask",_e.addDataField(sd,!0,N.SystemMetadata,Io.Critical);var vt=(ie=(oe=($=or[u.payload.commentId])===null||$===void 0?void 0:$.history[0])===null||oe===void 0?void 0:oe.records[0])===null||ie===void 0?void 0:ie.time;_e.addDataField("TaskCreationTimeDeltaMs",vt?Date.now()-vt.getTime():0,N.SystemMetadata,Io.Critical)}CI(_e,vf(rE(Ue,u.payload.commentId)));break;case"REQUEST_DELETE_THREAD":if(lCe(_e,u.payload.isTask),u.payload.isTask){_e.addDataField("DeleteThreadWithTask",!0,N.SystemMetadata,Io.Critical);var vt=(he=(se=(Ce=or[u.payload.commentId])===null||Ce===void 0?void 0:Ce.history[0])===null||se===void 0?void 0:se.records[0])===null||he===void 0?void 0:he.time;_e.addDataField("TaskCreationTimeDeltaMs",vt?Date.now()-vt.getTime():0,N.SystemMetadata,Io.Critical)}CI(_e,vf(rE(Ue,u.payload.commentId))),ot(wt(Ue),Un(Ue),u.payload.commentId);break;case"REQUEST_DELETE_POST":ot(wt(Ue),Un(Ue),u.payload.commentId);break}try{var fc=d.getState(),Yl=c(u),Er=d.getState(),qr=pe(fc),ys=pe(Er);switch(u.type){case"UPDATE_DRAFT_RENDER_CONTEXT":var dd=u.payload.draftId?qr.drafts[u.payload.draftId]:Ye(qr),im=u.payload.draftId?ys.drafts[u.payload.draftId]:Ye(ys),Bk=dd!==void 0&&im!==void 0&&dd.renderContextType!==im.renderContextType;_e.addDataField("DidDraftLockUpdate",Bk,N.SystemMetadata);break}return _e.successTag(595616739),Yl}catch(pc){throw _e.failTag(595616768,sn(pc,-2130957541)),pc}};switch(u.type){case"BEGIN_PROCESSING_COMMIT":{var h=x().createActivityObject(r.trackerActivityName,u.actionDetail.telemetryVisitor,Ee());try{g()}catch(K){throw h.failTag(595687567,sn(K,-2130957541)),K}var v=En(d.getState());if(!v){h.failTag(595687569,-2130957541);break}var y=v.commentDraft.sessionConfiguration;r.beginTracking(y.draftId,g8[y.sessionType],y.sessionType,h);break}case"COMMIT_FAILURE":{var v=En(d.getState());x().assertConditionTag(!!v,"Draft should exist when failing a commit.",595132701),v&&r.failTracker(v.commentDraft.sessionConfiguration.draftId,C.reserveTag(595132702)),c(u);break}case"REQUEST_THREAD_RESOLVE":case"REQUEST_REOPEN_THREAD":r.beginTracking(u.payload.commentId,nt.Modify,u.type);try{g()}catch(K){throw r.failTracker(u.payload.commentId,C.reserveTag(595907670),sn(K,-2130957541)),K}break;case"REQUEST_DELETE_POST":case"REQUEST_DELETE_THREAD":r.beginTracking(u.payload.commentId,nt.Delete,u.type);try{g()}catch(K){throw r.failTracker(u.payload.commentId,C.reserveTag(595907671),sn(K,-2130957541)),K}break;case"COMMENT_CONTEXT_CHANGED":{try{c(u)}catch(K){throw r.failAllTrackers(C.reserveTag(595731294),sn(K,-2130957541)),K}break}case"LOAD_COMMENT":case"VIRTUALIZE_COMMENTS":var T=u.type==="LOAD_COMMENT"?u.payload.commentData:u.payload.threadInfo,b=T.length>0;if(b&&!r.getTracker(o,nt.Load)){var h=x().createActivityObject(r.trackerActivityName,u.actionDetail.telemetryVisitor,Ee());r.beginTracking(o,nt.Load,u.type,h,{timeout:dCe,failOnTimeout:!1})}c(u);break;case"RELOAD_COMMENTS":try{g()}catch(K){throw r.failAllTrackers(C.reserveTag(595907672),sn(K,-2130957541)),K}r.endAllTrackers(C.reserveTag(595907673));break;case"ON_INITIAL_RENDER":var I=r.getTracker(o,nt.Load);I&&(I.activity.addDataField("RenderContextType",u.payload.renderContextType,N.SystemMetadata),r.endTracker(o,nt.Load,C.reserveTag(595646476))),c(u);break;case"APPLY_COMMENT_CHANGES":try{g()}catch(K){throw r.failAllTrackers(C.reserveTag(595907674),sn(K,-2130957541)),K}try{for(var E=$e(u.payload.changes),P=E.next();!P.done;P=E.next()){var _=P.value;if(_.type===nt.Load||_.type===nt.Unknown)break;if(_.type===nt.Delete||_.type===nt.Modify){r.endTracker(_.model.commentId,_.type,C.reserveTag(595907675));continue}if(_.type===nt.Insert){_.tempId!==void 0&&_.model.parentId===""&&XW(u.actionDetail.telemetryVisitor);var D=_.tempId||_.model.parentId;D!==void 0&&r.endTracker(D,_.type,C.reserveTag(595857620))}}}catch(K){l={error:K}}finally{try{P&&!P.done&&(p=E.return)&&p.call(E)}finally{if(l)throw l.error}}break;case"COMMIT_DRAFT":{var v=En(d.getState());if(g(),u.payload.data.temporaryCommentId&&v){var M=void 0,y=v.commentDraft.sessionConfiguration;switch(y.sessionType){case"CREATE":{u.actionDetail.telemetryVisitor,M=u.payload.data.temporaryCommentId;break}case"REPLY":{M=u.payload.data.temporaryCommentId;break}case"EDIT":{M=y.commentId;break}case"METADATA":{M=y.threadId;break}default:Me(y)}M&&r.updateTrackerId(y.draftId,M)}break}case"DISPATCH_LOAD_THREADS":case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":case"PRESENT_LINK_TO_COMMENT":case"SELECT_FIRST_COMMENT_IN_NEXT_POPULATED_CONTEXT":case"SELECT_LAST_COMMENT_IN_PREVIOUS_POPULATED_CONTEXT":case"SESSION_REQUEST_STARTED":case"UPDATE_DRAFT_RENDER_CONTEXT":case"SELECT_COMMENT":case"DISPLAY_DRAFT_WARNING":case"CLEAR_LOW_FIDELITY_WARNING":g();break;case"SHOW_LOW_FIDELITY_WARNING":g();var H=Ie(d.getState());H&&n.beginTracking(H);break;case"VIEW_CONTAINER_VISIBILITY_CHANGED":{var U="";switch(u.payload.visibilityState){case bt.Closed:U="ViewContainerClosed";break;case bt.Hidden:U="ViewContainerHidden";break;case bt.Visible:U="ViewContainerVisible";break;default:Me(u.payload.visibilityState)}var F=x().createActivityObject(U,u.actionDetail.telemetryVisitor,{aggregationMode:eo.Always});c(u),F.successTag(592241220);break}case"DRAFT_EMPTINESS_CHANGED":var z=pe(d.getState()),Y=z.drafts[u.payload.draftId],B=Y.commentDraft.sessionConfiguration.sessionType;(B===ro||B===Bo)&&a(u),c(u);break;case"CLEAR_COMMENT_SELECTION":default:c(u);break}var q=Ie(d.getState());q&&n.endTrackingIfWarningDismissed(u,q)}}}};s();ne();te();hw();Di();Mu();yS();pn();ye();pE();yt();bn();St();Qp();lo();var mCe=function(t,r){return function(n){return function(o){return function(a){switch(a.type){case"REQUEST_SHOW_PANE":{var d=Vn(n.getState());d.openView();break}case"REQUEST_CLOSE_PANE":{var d=Vn(n.getState());d.closeView();break}case"MOVE_FOCUS_TO_CANVAS":{if(!hy(n.getState())){var d=Vn(n.getState());d.moveFocusToCanvas_donotuse()}break}case"REQUEST_MODAL_CONFIRMATION":{var d=Vn(n.getState());d.invokeModalConfirmationDialog?d.invokeModalConfirmationDialog(a.payload.onConfirm,a.payload.onCancel,a.payload.displayStrings):(x().assertConditionTag(!1,"Host does not have modal dialog implemented",593278688),d.closeView());break}case"READY_TO_RENDER":{var d=Vn(n.getState());d.onReadyToRender&&d.onReadyToRender();break}case"RESOLVE_ATMENTION_CAPABILITY":{if(La()){var c=a.payload.capability===_t.Enabled;r.initializeController(c)}break}case"BEGIN_DRAFTING_SUCCESS":{var d=Vn(n.getState());Ou(d)&&a.payload.draftDetails.sessionConfiguration.sessionType==="CREATE"&&Mk(n.dispatch,a.actionDetail,{displayMode:oo.Variable,desiredHeight:0}),pCe(n.getState(),d);break}case"DISPLAY_DRAFT_WARNING":{pCe(n.getState());break}case"CANCEL_COMMENT_CREATE_THREAD":case"CANCEL_COMMENT_POST_EDIT":case"CANCEL_COMMENT_REPLY":{if(a.payload.closeOnDiscard){var d=Vn(n.getState());o(a),d.closeView();return}break}}var u=n.getState(),l=o(a),p=n.getState();return fHe(n.dispatch,a.actionDetail,u,p),l}}}};function lHe(e){var t=aa(e);return ki()&&(qt()?t===bt.Hidden:t!==bt.Visible)}function pCe(e,t){if(lHe(e)){var r=t||Vn(e);r.openView()}}function Mk(e,t,r){e(Mf(t,r)).catch(me(C.reserveTag(578426776)))}function fHe(e,t,r,n){var o=Vn(n);if(Ou(o)){var a=pe(n),d=pe(r),c=jo(a),u=jo(d),l=!!tt(a),p=!!tt(d);if(c!==u||!Ou(Vn(r))||!l&&p){if(!c){if(l){Mk(e,t,{displayMode:oo.Variable,desiredHeight:0});return}Mk(e,t,{displayMode:oo.Normal});return}var g=Ie(n);if(g&&g.selectedCardId===tt(a))return;Mk(e,t,{displayMode:oo.FullScreen});return}}}function gCe(e,t,r,n,o,a,d,c,u){var l=u?[oCe(u,n)]:[],p=bp(xx.apply(void 0,w([hye,gye,pye,nCe,fCe(n),Xye(e,n),tCe(n),iCe(d),mCe(t,c),aCe(a),Zye(n),eCe(o)],V(l),!1))),g=Tp(Yye,r,p);return d.initialize(g,!!o),g}ye();s();k();s();k();ne();rt();yd();te();QF();Eo();Zy();si();bm();fd();oC();Is();CS();Ve();s();ye();an();St();lo();var hCe=function(){function e(t,r,n){this.commentStore=t,this.commandFactory=new Ek(this.commentStore,r,n)}return e.prototype.selectNextOrPreviousThread=function(t,r,n){var o=qt()&&!Ro(this.commentStore.getState()),a=ws(this.commentStore.getState());return Gl(this.commandFactory.selectNextOrPreviousThread(void 0,t,r,n,o),a,this.commentStore,function(){})===Pi.Handled},e.prototype.selectAcrossContexts=function(t,r){var n=ws(this.commentStore.getState()),o=Rd(this.commentStore.getState()),a=qt()&&!Ro(this.commentStore.getState());Gl(this.commandFactory.selectAcrossContexts(void 0,{direction:t,source:le.SharedComments,expandCard:!0,iterableContentTypes:void 0},r,o.nextPopulatedContextDetails,a),n,this.commentStore,function(){})},e}();$E();ZE();li();yT();s();k();var Lk=S(L());function Z3(e,t){var r=function(n){Z(o,n);function o(){return n!==null&&n.apply(this,arguments)||this}return o.prototype.render=function(){var a=m(m({},t),this.props);return Lk.createElement(e,a)},o}(Lk.PureComponent);return r}s();k();var jT=S(L());Ts();function e4(e,t){return function(r){Z(n,r);function n(){return r!==null&&r.apply(this,arguments)||this}return n.prototype.render=function(){return jT.createElement(sf,{store:t},jT.createElement(e,m({},this.props)))},n}(jT.PureComponent)}s();k();ne();rt();te();Eo();wd();Tm();Rc();fd();ZC();Um();Ve();Nf();Cv();TB();gv();zo();Af();pn();Fc();ye();s();ne();var _Mr=C.reserveTag(595723983),RMr=C.reserveTag(595723984),yCe=C.reserveTag(574456150),CCe=C.reserveTag(574456151),vCe=C.reserveTag(574456152),xCe=C.reserveTag(574456153);an();vl();yt();bn();St();lo();el();io();s();var TCe=function(){function e(t){this.mockContents="",this.mockId="",t&&(this.mockId=t)}return e.prototype.getId=function(){return this.mockId},e}();var bCe=function(){function e(t,r){var n=this;this.viewManager=t,this.mockUIDriver=r,this.pendingActionReason=Le.None,this.pendingAction=void 0,this.startProcessingActionsPending=void 0,this.getActiveComponentTree=function(o){return Ro(o)?ws(o):n.viewManager.getComponentTreeForRenderMode(de.Integrated)},this.makeGetRenderableItemThreads=function(o){return xn([pe,uo,Mi,o,n.getActiveComponentTree],function(a,d,c,u,l){return qC(u,c,d,l.componentTreeId.renderContextType!==A.HalfPane,cy(a,l.componentTreeId.renderContextType))})},this.getCompleteHostableCommentCardRendererOwnProps=function(o){return m(m({},n.viewManager.getHostableCommentCardRendererProps(de.Integrated)),{resource:{id:o},componentInstanceId:Zn()})},this.getCompletePaneOwnProps=function(){return m(m({},n.viewManager.getPaneOwnProps()),{resource:{id:"CommentPane"}})},this.getDispatchProps=function(o){var a=void 0,d=n.commentStore.getState(),c=n.commentStore.dispatch;return Ro(d)?a=ol(c,n.getCompletePaneOwnProps()):a=hE(c,n.getCompleteHostableCommentCardRendererOwnProps(o)),a},this.getNewThreadDraftId=function(){return tt(pe(n.commentStore.getState()),!0)},this.getParentId=function(o){var a=n.commentStore.getState(),d=wt(a),c=Or(d,o);return c?Ze(c):void 0},this.invokeModalDialog=function(o,a,d){var c=n.commentStore.getState(),u={renderContextType:n.getActiveComponentTree(c).componentTreeId.renderContextType,trackback:C.reserveTag(592240791),telemetryVisitor:n.viewManager.getTelemetryVisitor()},l=n.commentStore.dispatch,p=n.getCompletePaneOwnProps(),g=ol(l,p),h=Ie(c);switch(o){case ur.CancelNewDraft:case ur.CancelReplyDraft:case ur.CancelPostEdit:return g.discardDraftAsync(u,le.SharedComments,!1);case ur.DeleteThread:return h&&g.requestDeleteThread(u,h.selectedCardId),Promise.resolve(He.Handled);case ur.ClosePaneDraft:return yv({ownProps:p,dispatchProps:g,componentTree:n.getActiveComponentTree(c),draftState:pe(c),invokeModalDialog:n.invokeModalDialog}),Promise.resolve(He.Handled);default:Me(o)}},this.updateEventProcessingState=function(o){var a=Li(n.previousStoreState),d=Li(o);!a&&d&&n.pauseProcessing(),a&&!d&&n.beginProcessing()},this.handleStoreUpdate=function(){var o=n.commentStore.getState(),a=pe(o),d=pe(n.previousStoreState),c=fr(a);!c&&n.pendingActionReason===Le.NeedNotDrafting&&n.pendingAction&&(x().createActivityObject("TriggerPendingActionNeedNotDrafting",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent}).successTag(592269458),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Le.None);var u=Wo(a),l=Wo(d);u&&!l&&n.pendingActionReason===Le.NeedDrafting&&n.pendingAction&&(x().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent}).successTag(592269459),n.pendingAction(),n.pendingAction=void 0,n.pendingActionReason=Le.None),n.updateEventProcessingState(o),n.previousStoreState=o},this.onDrafting=function(o){var a=x().createActivityObject("OnDraftingCallback",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});Wo(pe(n.commentStore.getState()))?(a.addDataField("ActionDeferred",!1,N.SystemMetadata),o(),a.successTag(592269460)):(a.addDataField("ActionDeferred",!0,N.SystemMetadata),n.pendingAction=o,n.pendingActionReason=Le.NeedDrafting,a.successTag(592269461))},this.onNotDrafting=function(o){var a=x().createActivityObject("OnNotDraftingCallback",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});fr(pe(n.commentStore.getState()))?(a.addDataField("ActionDeferred",!0,N.SystemMetadata),n.pendingAction=o,n.pendingActionReason=Le.NeedNotDrafting,a.successTag(592269462)):(a.addDataField("ActionDeferred",!1,N.SystemMetadata),o(),a.successTag(592269463))},this.runAction=function(o,a){switch(o){case Le.NeedDrafting:return n.onDrafting(a);case Le.NeedNotDrafting:return n.onNotDrafting(a);case Le.None:return a()}},this.onMockUIAction=new sm(function(o){var a=x().createActivityObject("OnMockUIAction",n.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});a.addDataField("MockUIActionType",o.actionType,N.SystemMetadata);try{switch(o.actionType){case Xe.CreateThread:Yb(o)?n.runAction(Le.NeedDrafting,function(){return n.onCreateOrReply(new ms(n.getNewThreadDraftId(),o.content))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269464);break;case Xe.CancelCreateThread:$b(o)?n.runAction(Le.NeedDrafting,function(){return n.onCancelCreateThread(new ms(n.getNewThreadDraftId()))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269465);break;case Xe.StartReplySession:Qb(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onStartReplySession(new ms(o.threadId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269466);break;case Xe.CancelReplySession:Xb(o)?n.runAction(Le.NeedDrafting,function(){return n.onCancelReplySession(new ms(o.threadId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269467);break;case Xe.PostReply:Jb(o)?n.runAction(Le.NeedDrafting,function(){return n.onCreateOrReply(new ms(o.threadId,o.content))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269468);break;case Xe.DeleteComment:Zb(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onDeleteComment(o.commentId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269469);break;case Xe.DeleteThread:eS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onDeleteThread(o.threadId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269470);break;case Xe.ResolveThread:tS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onResolveThread(o.threadId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269471);break;case Xe.ReopenThread:rS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onReopenThread(o.threadId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269472);break;case Xe.StartEditSession:nS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onStartEditSession(o.commentId)}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269473);break;case Xe.CancelEditSession:oS(o)?n.runAction(Le.NeedDrafting,function(){return n.onCancelEditSession(new Xp(o.commentId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269474);break;case Xe.PostEdit:if(iS(o)){var d=new Xp(o.commentId);d.setContents(o.content),n.runAction(Le.NeedDrafting,function(){return n.onPostEdit(d)})}else x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269475);break;case Xe.SelectComment:aS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onSelectComment(new TCe(o.commentId))}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269504);break;case Xe.ClosePane:n.onClosePane();break;case Xe.ClickGhostCard:sS(o)?n.runAction(Le.NeedNotDrafting,function(){return n.onGhostCommentClicked()}):x().assertConditionTag(!1,"Invalid action - is JS and native out of sync?",592269505);break;default:Me(o.actionType)}}catch(c){a.failTag(592269507,sn(c));return}a.successTag(592269508)}),this.onStartEditSession=function(o){var a=n.commentStore.getState();Pg({trackback:C.reserveTag(592269509),id:o,data:n.getFilteredRenderableItems(a),selectedComment:Ie(a),renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,actionDispatchers:n.getDispatchProps(o),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.onResolveThread=function(o,a){var d=n.commentStore.getState();Yf({componentTree:n.getActiveComponentTree(d),focusManager:n.viewManager.getFocusManager(),trackback:C.reserveTag(592269510),id:o,renderContextType:n.getActiveComponentTree(d).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(o),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,isTask:a})},this.onClosePane=function(){var o=n.commentStore.getState();if(mi(o)){var a=n.commentStore.dispatch,d=ol(a,n.getCompletePaneOwnProps());d.requestClosePane({telemetryVisitor:n.viewManager.getTelemetryVisitor(),renderContextType:A.None,trackback:C.reserveTag(592269511)})}else x().assertConditionTag(!1,"Pane was already closed.",592269512)},this.onCreateOrReply=function(o){var a=o.getId(),d=n.commentStore.getState(),c=pe(d),u=Ye(c),l=u&&u.commentDraft.sessionConfiguration.sessionType==="CREATE"?{type:"CREATE"}:{type:"REPLY",parentId:a};kg({trackback:C.reserveTag(592269513),commentCardRef:o,draftState:c,areMentionsEnabled:Lr(d).atMention===_t.Enabled,session:l,componentTree:n.getActiveComponentTree(d),dispatchProps:n.getDispatchProps(a),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:qn.Programmatic}).catch(me(C.reserveTag(592269514)))},this.onCancelCreateThread=function(o){var a=o.getId(),d=n.getDispatchProps(a),c=n.commentStore.getState(),u=Ie(c),l=pe(c),p=mi(c),g=n.getActiveComponentTree(c).componentTreeId.renderContextType,h=tl(c),v=(u==null?void 0:u.selectedCardId)===o.getId()&&Bs(p,g,l,u,h),y=kf(n.getRenderableItemThreads(c),a);ml({trackback:C.reserveTag(592269516),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(c),dispatchProps:d,closeOnDiscard:v,cardId:a,draftState:l,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:y})},this.onGhostCommentClicked=function(){var o=n.commentStore.getState(),a=mi(o);a||x().assertConditionTag(!1,"There is no Ghost Card because the pane is closed.",592269517),n.viewManager.getPaneOwnProps().selectionManager.selectAcrossContexts(Yt.Next,n.getActiveComponentTree(o).componentTreeId.renderContextType)},this.onPostEdit=function(o){var a=n.commentStore.getState(),d=n.getParentId(o.getId());d&&_g({trackback:C.reserveTag(592269518),id:o.getId(),data:n.getFilteredRenderableItems(a),draftState:pe(a),contentPromise:o.getContentsAsync(),atMentionsEnabled:Lr(a).atMention===_t.Enabled,componentTree:n.getActiveComponentTree(a),actionDispatchers:n.getDispatchProps(d),telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,commitSource:qn.Programmatic}).catch(me(C.reserveTag(592269519)))},this.onCancelEditSession=function(o){var a=n.commentStore.getState(),d=pe(a),c=Ie(a),u=mi(a),l=tl(a),p=Bs(u,n.getActiveComponentTree(a).componentTreeId.renderContextType,d,c,l),g=n.getFilteredRenderableItems(a),h=n.getParentId(o.getId());if(h){var v=n.getDispatchProps(h);qf({trackback:C.reserveTag(592269521),commentId:o.getId(),setContents:o.setContents.bind(o),data:g,draftState:d,shouldClosePaneAfterDiscardDraft:p,onWillDiscardCallback:void 0,renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,dispatchProps:v,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onCancelReplySession=function(o){var a=n.commentStore.getState(),d=Ie(a),c=pe(a),u=o.getId(),l=n.getDispatchProps(u),p=mi(a),g=n.getActiveComponentTree(a).componentTreeId.renderContextType,h=tl(n.commentStore.getState()),v=(d==null?void 0:d.selectedCardId)===o.getId()&&Bs(p,g,c,d,h);ml({trackback:C.reserveTag(592269522),showDiscardDialog:!1,invokeModalDialog:n.invokeModalDialog,componentTree:n.getActiveComponentTree(a),dispatchProps:l,closeOnDiscard:v,cardId:o.getId(),draftState:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),lieIndex:-1})},this.onDeleteThread=function(o){var a=n.commentStore.getState(),d=Ie(a),c=n.getDispatchProps(o);wg({trackback:C.reserveTag(592269523),id:o,data:n.getFilteredRenderableItems(a),selectedComment:d,componentTree:n.getActiveComponentTree(a),invokeModalDialog:n.invokeModalDialog,dispatchProps:c,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI,focusManager:n.viewManager.getFocusManager(),isTask:!!Go(a)[o],threadIndex:kf(n.getRenderableItemThreads(a),o),shouldCheckForLowFidelity:!0})},this.onDeleteComment=function(o){var a=n.commentStore.getState(),d=Ie(a),c=n.getParentId(o);if(c){var u=n.getDispatchProps(c);Eg({trackback:C.reserveTag(592269524),id:o,data:n.getFilteredRenderableItems(a),selectedComment:d,renderContextType:n.getActiveComponentTree(a).componentTreeId.renderContextType,actionDispatchers:u,telemetryVisitor:n.viewManager.getTelemetryVisitor(),localizationAPI:n.viewManager.localizationAPI})}},this.onSelectComment=function(o){var a,d=n.commentStore.getState(),c=uo(d,!0),u=n.getNewThreadDraftId(),l=n.getFilteredRenderableItems(d),p=o.getId(),g=!sr()&&p===u?c&&{commentModel:c.newComment_deprecated}:l.find(function(E){return co(E)===p});if(!g||!_r(g)){x().assertConditionTag(!1,"Selection coming from an unknown post?",592269525);return}var h=g,v=n.getDispatchProps((a=h.commentModel.parentId)!==null&&a!==void 0?a:h.commentModel.commentId),y=Ie(d),T=pe(d),b=n.getActiveComponentTree(d),I=da(_o(g),ia(d),b.componentTreeId.renderContextType);Rg({trackback:C.reserveTag(592269526),renderableItem:g,selectedComment:y,cardCollapsedState:I,dispatchProps:v,telemetryVisitor:n.viewManager.getTelemetryVisitor(),shouldFocusAfter:!1,componentTree:b,draftState_deprecated:T}).catch(me(C.reserveTag(590123734)))},this.onStartReplySession=function(o){Ag({trackback:C.reserveTag(592269527),threadId:o.getId(),renderContextType:n.getActiveComponentTree(n.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:n.getDispatchProps(o.getId()),telemetryVisitor:n.viewManager.getTelemetryVisitor()})},this.commentStore=this.viewManager.getCommentStore(),this.previousStoreState=this.commentStore.getState(),this.unsubscribeStoreListener=this.commentStore.subscribe(this.handleStoreUpdate),this.getFilteredRenderableItems=eE(),this.getRenderableItemThreads=this.makeGetRenderableItemThreads(this.getFilteredRenderableItems)}return e.prototype.initialize=function(){var t=x().createActivityObject("InitializeMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});this.registrationToken=this.mockUIDriver.onMockUIAction.subscribe(this.onMockUIAction.handler),t.successTag(vCe)},e.prototype.teardown=function(){var t,r=x().createActivityObject("TeardownMockCommentViewHelper",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});(t=this.registrationToken)===null||t===void 0||t.unsubscribe(),this.unsubscribeStoreListener(),r.successTag(xCe)},e.prototype.beginProcessing=function(){var t=this,r=x().createActivityObject("StartMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});this.startProcessingActionsPending=setTimeout(function(){t.onMockUIAction.startProcessing(),t.startProcessingActionsPending=void 0,r.successTag(yCe)},100)},e.prototype.pauseProcessing=function(){var t=x().createActivityObject("PauseMockUIActionProcessing",this.viewManager.getTelemetryVisitor(),{diagnosticLevel:Hn.FullEvent});this.startProcessingActionsPending&&(clearTimeout(this.startProcessingActionsPending),this.startProcessingActionsPending=void 0),this.onMockUIAction.pauseProcessing(),t.successTag(CCe)},e.prototype.onReopenThread=function(t,r){Dg({trackback:C.reserveTag(592269528),id:t,renderContextType:this.getActiveComponentTree(this.commentStore.getState()).componentTreeId.renderContextType,dispatchProps:this.getDispatchProps(t),telemetryVisitor:this.viewManager.getTelemetryVisitor(),localizationAPI:this.viewManager.localizationAPI,isTask:r})},e}();Cr();s();yd();te();tF();function SCe(e,t){return function(r){if(!(t.capabilities&Ma.GetSuggestionsDetails))return Promise.resolve();var n=x().createActivityObject("RefreshSuggestionsDetails",e.telemetryVisitor,{aggregationMode:eo.OnSuccess});return t.getSuggestionsDetails?t.getSuggestionsDetails().then(function(o){n.successTag(592492760),r(Nm(e,o))},function(o){n.failTag(592492761,-2130957495)}):(n.failTag(592492759,-2130957494),Promise.resolve())}}s();Eo();kw();function WT(e,t,r,n){return function(o){return kb().registerExtension(t,r,n).then(function(a){return o(xS(e,a)),a})}}s();te();Es();Fc();$w();function ICe(e,t){return function(r){var n=x().createActivityObject("ResolveAtMentionCapabilityState",e.telemetryVisitor,Ee());return t.checkAtMentionCapability().then(function(o){n.addDataField("AtMentionsEnabled",o,N.SystemMetadata),n.successTag(595903522),r(bC(e,o?_t.Enabled:_t.Disabled))},function(o){n.failTag(595903523,sn(o,-2130957528)),r(bC(e,_t.Disabled))})}}Ad();yt();St();Ni();Ni();lo();s();ne();function t4(e){switch(e){case"ExtensionAwareCommentPaneContainer":return Promise.resolve((c3(),Vk(che)));case"HostableCommentCardRendererContainer":return Promise.resolve((OCe(),Vk(FCe)));default:Me(e)}}pn();ye();s();var NCe="SharedCommentPane",MCe="TaskPaneItemCommentCard",LCe="DiscreteIntegratedCommentCard",HCe="DiscreteIsolatedCommentCard";function r4(e,t){return"".concat(e,"-").concat(t)}s();var BCe=function(){function e(){this.hostableComponentRegistry=new Map}return e.prototype.registerComponent=function(t,r,n){this.hostableComponentRegistry.has(t)||this.hostableComponentRegistry.set(t,new Map);var o=this.hostableComponentRegistry.get(t);if(!n){o.delete(r);return}o.set(r,n)},e.prototype.getComponent=function(t,r){var n=this.hostableComponentRegistry.get(t);if(n)return n.get(r)},e}();var UCe=function(){function e(t){var r=t.apiContext,n=t.viewProvider,o=t.commentAPI,a=t.peopleAPI,d=t.localizationAPI,c=t.themeAPI,u=t.focusManager,l=t.lppManager,p=t.initializationReason,g=t.commentStore,h=t.viewStrategyFactory,v=t.mockUIDriver,y=t.contentFilteredRangeAPI,T=t.contentNavigationAPI,b=this;this.initialized=!1,this.initialLoadComplete=!1,this.commentUIActionListeners=[],this.commentInterruptableCommandListeners=[],this.unprocessedActionPayloads=[],this.onInitialRender=function(E){b.commentStore.dispatch(VS({renderContextType:A.None,trackback:C.reserveTag(595646478),telemetryVisitor:b.telemetryVisitor},{commentId:E.commentId,renderContextType:E.renderContextType})),Kt(E.renderContextType)&&b.sendDataReceivedCodeMarker()},this.sendDataReceivedCodeMarker=Mn(function(){wT.sendCodeMarker({context:b.apiContext,type:vy.DataReceived,assertTag:C.reserveTag(595731293)})}),this.getComponentTree=function(E){switch(E){case A.None:Ln(!1,"Unexpected render context type:".concat(E),C.reserveTag(589088338));case A.FullPane:case A.HalfPane:return b.getComponentTreeForRenderMode(de.TaskPaneItem);case A.DiscreteIntegrated:return b.getComponentTreeForRenderMode(de.Integrated);case A.DiscreteIsolated:return b.getComponentTreeForRenderMode(de.Isolated)}},this.getCommentContainerOwnProps=function(){return{commentAPI:b.commentAPI,localizationAPI:b.localizationAPI,peopleAPI:b.peopleAPI,focusManager:b.focusManager,telemetryVisitor:b.telemetryVisitor,onInitialRender:b.onInitialRender,correlationId:b.correlationId,lppManager:b.lppManager}},this.setComponentRef=function(E,P,_){b.viewManagerRefRegistry.registerComponent(E,P,_)},this.onSuggestionsDetailsChange=function(E){b.commentStore.dispatch(Nm({renderContextType:A.None,trackback:C.reserveTag(592492758),telemetryVisitor:b.telemetryVisitor},E))},this.internalInterruptableCommandHandler=function(E){return b.activeViewStrategy.handleCommentInterruptableCommand(E,b.commentStore.dispatch,b.commentStore.getState)},this.createOrUpdateFilter=function(E){var P=b.contentFilteredRangeAPI;if(!P||!tr(b.commentStore.getState())){x().assertConditionTag(!1,"Should not request new filter with gate off",528779338);return}if(!$I(b.commentStore.getState())){var _=N7(b.commentStore.getState());_?b.updateFilter(_,E):(x().assertConditionTag(!1,"In the UI layer, we should already have an active filter to update",507794013),b.createFilter(P,E))}},this.updateFilter=function(E,P){b.commentStore.dispatch(Cf({renderContextType:A.FullPane,telemetryVisitor:b.telemetryVisitor,trackback:C.reserveTag(528779344)},{filterId:E,changes:[{type:"FilterUpdate",updatedFilter:P}]}))},this.createFilter=function(E,P){E.createFilteredRange({contentTypes:[Bt.CommentThread],filters:P,supportsFilterUpdates:!0}).then(function(_){b.commentStore.dispatch(yf({renderContextType:A.FullPane,telemetryVisitor:b.telemetryVisitor,trackback:C.reserveTag(528779340)},{filteredRange:_,shouldSetActive:!0}))}).catch(me(C.reserveTag(528779341)))},this.apiContext=r,this.viewProvider=n,this.commentAPI=o,this.peopleAPI=a,this.localizationAPI=d,this.themeAPI=c,this.focusManager=u,this.contentFilteredRangeAPI=y,this.contentNavigationAPI=T,this.lastInitializationReason=p,this.viewStrategyFactory=h,this.mockUIDriver=v,this.telemetryVisitor=Cn.getTelemetryVisitor(this.apiContext),this.correlationId=Cn.getCorrelationId(this.apiContext)||Zn(),this.lppManager=l,this.registerComponentUIActionListener=this.registerComponentUIActionListener.bind(this),this.registerInterruptableCommandListener=this.registerInterruptableCommandListener.bind(this),this.onCommentEventReceived=this.onCommentEventReceived.bind(this),this.onCommentUIAction=this.onCommentUIAction.bind(this),this.onCommentInterruptableCommandReceived=this.onCommentInterruptableCommandReceived.bind(this),this.unregisterComponentUIActionListener=this.unregisterComponentUIActionListener.bind(this),this.unregisterComponentInterruptableCommandListener=this.unregisterComponentInterruptableCommandListener.bind(this),this.onViewContainerEvent=this.onViewContainerEvent.bind(this),this.observeStore=this.observeStore.bind(this),this.onChange=this.onChange.bind(this),this.onFirstLoadComplete=this.onFirstLoadComplete.bind(this),this.getComponentTreeForRenderMode=this.getComponentTreeForRenderMode.bind(this),this.selectionManager=new hCe(g,this.telemetryVisitor,!!this.contentNavigationAPI);var I=g.getState();this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(I.paneState.viewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor,this.lppManager),this.commentStore=g,this.discreteIntegratedComponentTree=new ql(A.DiscreteIntegrated,this.apiContext),this.discreteIsolatedComponentTree=new ql(A.DiscreteIsolated,this.apiContext),this.viewManagerRefRegistry=new BCe,this.registerActions(),this.observeStore(this.commentStore),this.mockUIDriver&&(this.mockCommentViewHelper=new bCe(this,this.mockUIDriver)),this.registerInterruptableCommandListener(this.internalInterruptableCommandHandler)}return e.prototype.getMockDriver=function(){return this.mockUIDriver},e.prototype.refreshAtMentionCapability=function(){var t=this.commentStore.dispatch;t(ICe({renderContextType:A.None,trackback:C.reserveTag(595616912),telemetryVisitor:this.telemetryVisitor},this.commentAPI)).catch(me(C.reserveTag(595152915)))},e.prototype.getCommentStore=function(){return this.commentStore},e.prototype.getFocusManager=function(){return this.focusManager},e.prototype.getInitializationReason=function(){return this.lastInitializationReason},e.prototype.getSelectionManager=function(){return this.selectionManager},e.prototype.beginInitialization=function(){var t=this,r,n;this.initialized||(this.contentNavigationAPI&&(this.commentStore.dispatch(rI({renderContextType:A.None,trackback:C.reserveTag(526405722),telemetryVisitor:this.telemetryVisitor},!0)),(r=this.contentFilteredRangeAPI)===null||r===void 0||r.getCapabilities().then(function(o){var a;t.commentStore.dispatch(nI({renderContextType:A.None,trackback:C.reserveTag(537421135),telemetryVisitor:t.telemetryVisitor},{capabilities:o})),o!=null&&o.supportsFilterByUser&&(t.userFilterManager=(a=t.contentFilteredRangeAPI)===null||a===void 0?void 0:a.getUserFilterManager(),t.userFilterManager&&(t.userFilterManager.getFilterUsers().then(function(d){t.commentStore.dispatch(tI({renderContextType:A.None,trackback:C.reserveTag(507347608),telemetryVisitor:t.telemetryVisitor},{collaborators:d}))}).catch(me(C.reserveTag(507347607))),t.userFilterManager.onUserFilterManagerEvent.subscribe(function(d){t.commentStore.dispatch(sI({renderContextType:A.None,trackback:C.reserveTag(507347606),telemetryVisitor:t.telemetryVisitor},{change:d.payload}))})))}).catch(me(C.reserveTag(528779335))),(n=this.contentFilteredRangeAPI)===null||n===void 0||n.onActiveFilterUpdated.subscribe(function(o){t.commentStore.dispatch(vS({renderContextType:A.None,trackback:C.reserveTag(507536257),telemetryVisitor:t.telemetryVisitor},{newActiveFilterId:o.newActiveFilterId}))})),this.commentAPI.registerForCommentEvents(this.onCommentEventReceived),this.commentAPI.registerForInterruptableCommands!==void 0&&this.commentAPI.registerForInterruptableCommands(this.onCommentInterruptableCommandReceived),qt()&&this.initializeContentExtensions(),this.viewProvider.registerForViewContainerEvents(this.onViewContainerEvent),this.refreshAtMentionCapability(),this.peopleAPI.capabilities&Ma.GetSuggestionsDetails&&(this.commentStore.dispatch(SCe({renderContextType:A.None,trackback:C.reserveTag(592492753),telemetryVisitor:this.telemetryVisitor},this.peopleAPI)).catch(me(C.reserveTag(592492754))),x().assertConditionTag(!!this.peopleAPI.registerForSuggestionsDetailsChanges,"registerForSuggestionsDetailsChanges expected to be defined if capability is set",592492756),this.peopleAPI.registerForSuggestionsDetailsChanges&&this.peopleAPI.registerForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),this.mockCommentViewHelper&&this.mockCommentViewHelper.initialize(),this.initialized=!0)},e.prototype.getTelemetryVisitor=function(){return this.telemetryVisitor},e.prototype.getAtMentionAuthToken=function(){return Promise.resolve(void 0)},e.prototype.onChange=function(t){!this.initialLoadComplete&&t&&Li(t)===void 0&&A7(t)&&this.onFirstLoadComplete()},e.prototype.observeStore=function(t){var r=this,n,o=t.subscribe(function(){var a=t.getState(),d=Li(a);d!==n&&(n=d,r.onChange(a))});return o},e.prototype.onFirstLoadComplete=function(){var t=this;x().assertConditionTag(!this.initialLoadComplete,"Process initial pending actions should only run once.",576570016),this.initialLoadComplete=!0,this.unprocessedActionPayloads.forEach(function(r){t.onCommentUIAction(r)}),this.unprocessedActionPayloads=[],this.mockCommentViewHelper&&this.mockCommentViewHelper.beginProcessing()},e.prototype.registerActions=function(){this.commentAPI.registerForAction(Gt.AddComment,this.onCommentUIAction),this.commentAPI.registerForAction(Gt.NextThread,this.onCommentUIAction),this.commentAPI.registerForAction(Gt.PreviousThread,this.onCommentUIAction),this.commentAPI.registerForAction(Gt.DeleteThread,this.onCommentUIAction),this.commentAPI.registerForAction(Gt.BackKeyPressed,this.onCommentUIAction),this.commentAPI.registerForAction(Gt.ShowHideCommentPane,this.onCommentUIAction)},e.prototype.getComponentTreeForRenderMode=function(t){switch(t){case de.Integrated:return this.discreteIntegratedComponentTree;case de.Isolated:return this.discreteIsolatedComponentTree;case de.TaskPane:case de.TaskPaneItem:return ws(this.getCommentStore().getState())}},e.prototype.getPaneOwnProps=function(){return m(m({},this.getCommentContainerOwnProps()),{selectionManager:this.selectionManager,initializationReason:this.lastInitializationReason,registerComponentUIActionListener:this.registerComponentUIActionListener,registerComponentInterruptableCommandListener:this.registerInterruptableCommandListener,unregisterComponentInterruptableCommandListener:this.unregisterComponentInterruptableCommandListener,unregisterComponentUIActionListener:this.unregisterComponentUIActionListener,correlationId:this.correlationId,createOrUpdateFilter:this.createOrUpdateFilter})},e.prototype.getHostableCommentCardRendererProps=function(t){var r=this;return m(m({},this.getCommentContainerOwnProps()),{componentTree:this.getComponentTreeForRenderMode(t),setComponentRef:function(o,a){r.setComponentRef(t,o,a)},correlationId:this.correlationId,themeAPI:this.themeAPI})},e.prototype.registerCommentCardHostableComponent=function(t,r,n){var o=this,a=Z3(n.HostableCommentCardRendererContainer,m({},this.getHostableCommentCardRendererProps(t))),d=e4(a,this.commentStore),c=r4(r,this.apiContext),u=rv().registerComponent(c,d);return u.onComponentCommand.subscribe(function(l){o.processHostableComponentCommand(l,t)}),{componentController:u,contextAwareName:c}},e.prototype.initializeContentExtensions=function(){var t=this;t4("ExtensionAwareCommentPaneContainer").then(function(r){var n=r;if(n!==void 0){var o=Z3(n.ExtensionAwareCommentPane,m(m({},t.getPaneOwnProps()),{extensionRenderMode:de.Integrated,themeAPI:t.themeAPI})),a=e4(o,t.commentStore),d=r4(NCe,t.apiContext);t.commentPaneComponentController=rv().registerComponent(d,a),Sm()&&t.commentStore.dispatch(WT({renderContextType:A.None,trackback:C.reserveTag(573384478),telemetryVisitor:t.telemetryVisitor},Bt.CommentThread,d,{renderMode:de.TaskPane,priority:Nt.Disabled,instanceId:t.apiContext,componentDimensions:void 0})).catch(me(C.reserveTag(573384479)))}var c;t4("HostableCommentCardRendererContainer").then(function(u){if(c=u,c!==void 0){var l=t.registerCommentCardHostableComponent(de.Integrated,LCe,c),p=l.componentController,g=l.contextAwareName;t.discreteIntegratedComponentController=p;var h=t.registerCommentCardHostableComponent(de.Isolated,HCe,c),v=h.componentController,y=h.contextAwareName;t.discreteIsolatedComponentController=v;var T=t.registerCommentCardHostableComponent(de.TaskPaneItem,MCe,c),b=T.componentController,I=T.contextAwareName;t.commentPaneItemComponentController=b,t.commentStore.dispatch(WT({renderContextType:A.None,trackback:C.reserveTag(574428426),telemetryVisitor:t.telemetryVisitor},Bt.CommentThread,g,{renderMode:de.Integrated,priority:Nt.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch(me(C.reserveTag(595645980))),t.commentStore.dispatch(WT({renderContextType:A.None,trackback:C.reserveTag(595616916),telemetryVisitor:t.telemetryVisitor},Bt.CommentThread,y,{renderMode:de.Isolated,priority:Nt.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize(),isContentAvailable:function(P){var _=t.commentStore.getState(),D=QE(P,In(_),Mi(_)),M=pe(_);return JE(P,XE(P,wt(_),Un(_),D,uo(_,!0),M.drafts[P],tt(M)),M,A.DiscreteIsolated,Gf(P,A.DiscreteIsolated,M))}})).catch(me(C.reserveTag(595645982))),t.commentStore.dispatch(WT({renderContextType:A.None,trackback:C.reserveTag(546174344),telemetryVisitor:t.telemetryVisitor},Bt.CommentThread,I,{renderMode:de.TaskPaneItem,priority:Nt.Disabled,instanceId:t.apiContext,componentDimensions:t.getAverageCardSize()})).catch(me(C.reserveTag(546174345)))}}).catch(me(C.reserveTag(595645984)))}).catch(me(C.reserveTag(595645986)))},e.prototype.getAverageCardSize=function(){return{width:KH,height:Vl({itemCount:3,readOnly:!1,isTask:!1})}},e.prototype.processHostableComponentCommand=function(t,r){var n=this;switch(t.command){case"Focus":setTimeout(function(){var o;return(o=n.viewManagerRefRegistry.getComponent(r,t.details.componentInstanceId))===null||o===void 0?void 0:o.focus()});return;case"UpdateComponentDataProps":break;default:x().assertConditionTag(!1,"Unexpected command type",593786644);return}},e.prototype.teardownContentExtensions=function(){var t,r,n,o,a=[de.Integrated,de.Isolated,de.TaskPaneItem];Sm()&&a.push(de.TaskPane),this.commentStore.dispatch(GS.apply(Td,w([{renderContextType:A.None,trackback:C.reserveTag(595616917),telemetryVisitor:this.telemetryVisitor}],V(a),!1))),(t=this.commentPaneComponentController)===null||t===void 0||t.unregister(),(r=this.commentPaneItemComponentController)===null||r===void 0||r.unregister(),(n=this.discreteIntegratedComponentController)===null||n===void 0||n.unregister(),(o=this.discreteIsolatedComponentController)===null||o===void 0||o.unregister()},e.prototype.teardown=function(){this.initialized&&(this.viewProvider.unregisterForViewContainerEvents(this.onViewContainerEvent),this.commentAPI.unregisterForCommentEvents(this.onCommentEventReceived),this.commentAPI.unregisterForAction(Gt.AddComment),this.commentAPI.unregisterForAction(Gt.NextThread),this.commentAPI.unregisterForAction(Gt.PreviousThread),this.commentAPI.unregisterForAction(Gt.DeleteThread),this.commentAPI.unregisterForAction(Gt.BackKeyPressed),this.commentAPI.unregisterForAction(Gt.ShowHideCommentPane),this.commentAPI.unregisterForInterruptableCommands!==void 0&&this.commentAPI.unregisterForInterruptableCommands(this.onCommentInterruptableCommandReceived),this.peopleAPI.capabilities&Ma.GetSuggestionsDetails&&(x().assertConditionTag(!!this.peopleAPI.unregisterForSuggestionsDetailsChanges,"unregisterForSuggestionsDetailsChanges should be defined if capability is set",592492757),this.peopleAPI.unregisterForSuggestionsDetailsChanges&&this.peopleAPI.unregisterForSuggestionsDetailsChanges(this.onSuggestionsDetailsChange)),qt()&&this.teardownContentExtensions(),this.initialized=!1)},e.prototype.registerComponentUIActionListener=function(t){this.commentUIActionListeners.push(t)},e.prototype.unregisterComponentUIActionListener=function(t){var r=this.commentUIActionListeners.indexOf(t);r>-1&&this.commentUIActionListeners.splice(r,1)},e.prototype.registerInterruptableCommandListener=function(t){this.commentInterruptableCommandListeners.push(t)},e.prototype.unregisterComponentInterruptableCommandListener=function(t){var r=this.commentInterruptableCommandListeners.indexOf(t);r>-1&&this.commentInterruptableCommandListeners.splice(r,1)},e.prototype.onCommentUIAction=function(t){var r,n;if(qt()&&t.actionBehavior===ai.Execute&&(this.initialized||this.beginInitialization(),!this.initialLoadComplete))return this.unprocessedActionPayloads.push(t),!0;try{for(var o=$e(this.commentUIActionListeners),a=o.next();!a.done;a=o.next()){var d=a.value,c=d(t);if(c!==dr.NotHandled)return c===dr.Success}}catch(u){r={error:u}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this.activeViewStrategy.processCommentUIAction(t,this.commentStore.dispatch,this.commentStore.getState)===dr.Success},e.prototype.onCommentEventReceived=function(t,r){var n=wy(Ql.Comments,Fe[t]);this.activeViewStrategy.processCommentEvent(t,r,this.commentStore.dispatch,this.commentStore.getState),n==null||n.end(),qt()&&!this.initialLoadComplete&&t===Fe.CommentContextChanged&&Ss(r)&&r.numberOfComments===0&&this.onFirstLoadComplete()},e.prototype.onCommentInterruptableCommandReceived=function(t){var r=Promise.resolve(He.Unhandled);return this.commentInterruptableCommandListeners.reduce(function(n,o){return n.then(function(a){return a!==He.Unhandled?Promise.resolve(a):o(t)})},r)},e.prototype.onViewContainerEvent=function(t){var r=this,n=this.commentStore.dispatch;switch(t.eventType){case di.VisibilityChanged:n(yI({renderContextType:A.None,trackback:C.reserveTag(592241221),telemetryVisitor:this.telemetryVisitor},t.viewContainerVisibilityState));return;case di.ViewContainerChanged:n(gI({renderContextType:A.None,trackback:C.reserveTag(595616919),telemetryVisitor:this.telemetryVisitor},t.newViewContainer)),this.activeViewStrategy=this.viewStrategyFactory.createViewStrategy(t.newViewContainer,this.localizationAPI,this.peopleAPI,this.commentAPI,this.selectionManager,this.focusManager,this.lastInitializationReason,this.telemetryVisitor,this.lppManager);return;case di.FocusTriggered:Sm()?setTimeout(function(){r.focusManager.focusCommentPaneCommand(ws(r.commentStore.getState()))}):this.focusManager.focusCommentPaneCommand(ws(this.commentStore.getState()));return;case di.FoldableLayoutStateChanged:n(hI({renderContextType:A.None,trackback:C.reserveTag(591660549),telemetryVisitor:this.telemetryVisitor},t.newFoldableLayoutState))}},e}();var VCe=function(e){Z(t,e);function t(r){var n=e.call(this,r)||this;return r.initializeImmediately&&n.beginInitialization(),n}return t.prototype.refreshAtMentionAuthToken=function(){},t}(UCe);s();k();rt();yd();te();s();MH();s();HH();s();pL();s();var jCe="Prod";Pr();var nm,om,mHe=(nm={},nm.android="Android",nm.web="Web",nm.win32="Win32",nm.macos="Mac",nm.ios="iOS",nm),gHe=(om={},om.android="OfficeAndroid",om.web="OfficeWebApps",om.win32="OfficeWin32",om.macos=void 0,om.ios="OfficeiOS",om),WCe=function(t){var r=t.getMetadata();return{clientType:gHe[Q()],hostAppName:r.appName,hostAppPlatform:mHe[Q()],hostAppRing:r.releaseAudienceGroup||r.ring||r.releaseAudience,hostAppVersion:r.appVersion,complianceEnvironment:r.sovereignEnvironmentName?cse(r.sovereignEnvironmentName):jCe}};s();var hHe={};function zCe(){return hHe}ye();var Hk;(function(e){e[e.Initialize=0]="Initialize",e[e.Refresh=1]="Refresh"})(Hk||(Hk={}));var GCe=function(){function e(t,r,n){var o=this;this.telemetryVisitor=r,this.online=!1,this.initialized=!1,this.enableEmailAddresses=!1,this.refreshLPPAuthToken=function(){return o.peopleAPI.getAuthToken(hd.Loki)},this.peopleAPI=t,this.correlationId=n,this.accountId=Zn()}return e.prototype.getAccountID=function(){return this.accountId},e.prototype.getLPPController=function(){if(this.isInitialized())return Np},e.prototype.ensureLPPController=function(){return this.isInitialized()||this.initializeController(!1,this.enableEmailAddresses),Np},e.prototype.initializeController=function(t,r){var n=t&&!this.online;r!==void 0&&this.enableEmailAddresses!==r&&(this.initialized=!1,this.enableEmailAddresses=r),this.isInitialized()||(this.online=t||this.online,this.initializeLPP(),this.initialized=!0,n=this.online),n&&(this.logLPPOnlineChange(Hk.Initialize),Np.switchToOnlineMode(this.accountId),this.online=!0)},e.prototype.isInitialized=function(){return this.initialized},e.prototype.isOnline=function(){return this.online},e.prototype.refreshLPPController=function(){this.online||this.logLPPOnlineChange(Hk.Refresh),this.online=!0,this.initialized=!0,this.initializeLPP(),Np.switchToOnlineMode(this.accountId)},e.prototype.initializeLPP=function(){var t,r=zCe();Np.start(this.accountId,m(m(m({},WCe(x())),r),{complianceEnvironment:void 0,clientCorrelationId:this.correlationId,hostAppSupportsLogging:!0,refreshAuthToken:this.refreshLPPAuthToken,offline:!this.online,getLokiEndpoint:(t=this.peopleAPI.getLokiUrl)===null||t===void 0?void 0:t.bind(this.peopleAPI),settings:ku()?m(m({},r.settings),{suggestUseEmailAddress:this.enableEmailAddresses}):r.settings}))},e.prototype.logLPPOnlineChange=function(t){var r=x().createActivityObject("LPPControllerOnlined",this.telemetryVisitor,Ee());r.addDataField("LPPOnlinedInRefresh",t,N.SystemMetadata),r.successTag(523618253)},e}();s();Na();s();ne();te();Eo();wd();Rc();si();bm();XF();oC();Is();Di();Vu();Ve();Cv();gv();ZE();Zm();zo();Cr();an();QC();sE();aE();s();te();s();function qCe(e){return e.draftContent!==void 0&&e.draftContent.content!==void 0&&e.draftingParams!==void 0&&e.draftingParams.sessionType!==void 0&&e.draftingParams.draftId!==void 0}II();St();km();Qw();QC();function KCe(e,t,r,n,o){return function(a,d){var c=Tf().getItem(t);if(!c)return x().assertConditionTag(!1,"no saved sessionStorage data for provided draft id",523510273),Promise.resolve(a(Bn));var u=JSON.parse(c);if(!qCe(u))return x().assertConditionTag(!1,"sessionStorage information is the wrong format",523510274),Promise.resolve(a(Bn));Tf().removeItem(t);var l=!!(r!=null&&r.some(function(g){return g.draftId===u.draftingParams.draftId})),p={inCurrentContext:l,isDraftEmpty:u.draftContent.content===""};return a(Os(e,n,u.draftingParams,!1,o,p)).then(function(){var g=En(d());if(!g)return x().assertConditionTag(!1,"no active draft to save to session",520136543),a(Bn);var h={draftId:g.commentDraft.sessionConfiguration.draftId,draftContent:{editorContent:Promise.resolve(u.draftContent.content),editorCursorPosition:Promise.resolve(u.draftContent.cursorPosition)}};return a(Fm(e,h))})}}gE();yt();IC();Sf();so();St();lo();io();pn();ye();s();Sc();yt();bn();St();lo();ye();function YCe(e){return Tn()?!0:!fr(e)&&!e.committedLieId}function $Ce(e){return!!e.selectedComment&&QCe(e.draftState)}function n4(e){return yHe(e)&&QCe(pe(e))}function yHe(e){var t=qt()&&!mi(e);return Rd(e).nextPopulatedContextDetails!==Ut.NoComments||WC(t?In(e):pi(e),wt(e),t)}function QCe(e){return Tn()||!fr(e)}var XCe=function(){function e(t,r,n,o,a,d){this.localizationAPI=t,this.peopleAPI=r,this.commentAPI=n,this.selectionManager=o,this.telemetryVisitor=a,this.lppManager=d}return e.prototype.processCommentEvent=function(t,r,n,o){var a=this,d=o();switch(t){case Fe.CommentContextChanged:{if(Ss(r))r.rehydrationDrafts&&r.rehydrationDrafts.forEach(function(l){n(KCe({renderContextType:A.None,trackback:C.reserveTag(595912089),telemetryVisitor:a.telemetryVisitor},l.draftId,r.contextDrafts,a.commentAPI,a.peopleAPI)).catch(me(C.reserveTag(523362973)))}),n(wS({renderContextType:A.None,trackback:C.reserveTag(512361622),telemetryVisitor:this.telemetryVisitor},r));else{x().assertConditionTag(!1,"Invalid eventPayload",595912090);return}break}case Fe.CommentsChanged:{if(!_c(r)){x().assertConditionTag(!1,"Invalid eventPayload",595912091);return}break}case Fe.LoadComments:{if(!Ic(r)){x().assertConditionTag(!1,"Invalid eventPayload",595912092);return}break}case Fe.CommentSelected:{if(sC(r))if(r.commentId){var c=void 0;if(Mi(d)[r.commentId]!==void 0)c=og(r.commentId,le.Canvas,{selectType:r.selectionReason&&r.selectionReason.type==="ContentNavigation"&&r.selectionReason.contentNavigationReason===ca.Keyboarding?Ae.SelectCard:Ae.ExpandCard});else{var u=Or(wt(d),r.commentId);if(u===void 0)return;c=og(u.parentId,le.Canvas,{selectType:Ae.SelectPost,selectedPost:r.commentId})}n(mE(void 0,{renderContextType:A.None,trackback:C.reserveTag(579744149),telemetryVisitor:this.telemetryVisitor},c,!1)).catch(me(C.reserveTag(579744150)))}else n(_m({renderContextType:A.None,trackback:C.reserveTag(595912095),telemetryVisitor:this.telemetryVisitor}));else{x().assertConditionTag(!1,"Invalid eventPayload",595912096);return}break}case Fe.CommentContextReload:{if(!Ec(r)){x().assertConditionTag(!1,"Invalid eventPayload",595912097);return}break}case Fe.CommentHighlighted:{if(dC(r))r.commentId?n(Ac({renderContextType:A.None,trackback:C.reserveTag(595912098),telemetryVisitor:this.telemetryVisitor},r.commentId,le.Canvas)):n(Lu({renderContextType:A.None,trackback:C.reserveTag(578586723),telemetryVisitor:this.telemetryVisitor},le.Canvas,void 0));else{x().assertConditionTag(!1,"Invalid eventPayload",595912128);return}break}case Fe.NextPopulatedContextDetailsUpdated:{if(cC(r)&&r.contextDetails.nextPopulatedContextDetails)n(US({renderContextType:A.None,trackback:C.reserveTag(595912129),telemetryVisitor:this.telemetryVisitor},r.contextDetails.nextPopulatedContextDetails));else{x().assertConditionTag(!1,"Invalid eventPayload",595912130);return}break}case Fe.ModelCapabilitiesChanged:{uC(r)?(La()&&ku()&&this.lppManager.initializeController(!1,!!(r.modelCapabilityFlags&ti.AtMentionEmailAddresses)),n(fI({renderContextType:A.None,trackback:C.reserveTag(595685376),telemetryVisitor:this.telemetryVisitor},r.modelCapabilityFlags,r.richTextCapabilityFlags))):x().assertConditionTag(!1,"Invalid eventPayload",595616784);break}case Fe.CommentError:{if(!lC(r)){x().assertConditionTag(!1,"Invalid eventPayload",595912131);return}break}case Fe.ReturnToDraftRequested:{fC(r)&&n(Va({draftWarningType:Mr.ReturnToDraft,draftWarningReason:ao.HostRequest},{renderContextType:A.None,trackback:C.reserveTag(593376912),telemetryVisitor:this.telemetryVisitor}));break}case Fe.UpdateDraftThread:{pf(r)?n(cI({renderContextType:A.None,trackback:C.reserveTag(594023371),telemetryVisitor:this.telemetryVisitor},r)):x().assertConditionTag(!1,"Invalid eventPayload",594023372);break}case Fe.SmartReplyPopulated:{if(pC(r))n(jS({renderContextType:A.None,trackback:C.reserveTag(590202466),telemetryVisitor:this.telemetryVisitor},r));else{x().assertConditionTag(!1,"Invalid eventPayload for smart replies",590202467);return}break}default:{x().assertConditionTag(!1,"Deprecated event detected.",595912132);return}}},e.prototype.processCommentUIAction=function(t,r,n,o){var a=this,d=n();switch(t.actionType){case Gt.ShowHideCommentPane:return Fu(t.actionBehavior)?mi(d)?dr.Success:dr.Fail:(Ba(t.actionBehavior)&&(mi(d)?r(Hu({renderContextType:A.None,trackback:C.reserveTag(595912133),telemetryVisitor:this.telemetryVisitor})):r($S({renderContextType:A.None,trackback:C.reserveTag(595912134),telemetryVisitor:this.telemetryVisitor}))),dr.Success);case Gt.AddComment:{if(wu(t.actionBehavior)){if(!YCe(pe(d)))return dr.Fail}else if(Ba(t.actionBehavior)){var c={renderContextType:A.None,trackback:C.reserveTag(595146382),telemetryVisitor:this.telemetryVisitor};return r(Os(c,this.commentAPI,{sessionType:"CREATE"},!!(o&&o.retainSelectionOnAddComment),this.peopleAPI)).catch(me(C.reserveTag(592314376))),dr.Success}return dr.Success}case Gt.NextThread:{if(x().assertConditionTag(!Fu(t.actionBehavior),"This action type does not support toggled status",595899713),Ba(t.actionBehavior))this.handleActionOrReturnToDraft(function(){return a.selectionManager.selectNextOrPreviousThread({direction:Yt.Next,source:le.SharedComments,expandCard:!0,iterableContentTypes:[Bt.CommentThread]},ca.HostAction,A.None)},r,it()?void 0:ao.NextThread,C.reserveTag(591729749));else if(wu(t.actionBehavior))return n4(d)?dr.Success:dr.Fail;return dr.Success}case Gt.PreviousThread:{if(x().assertConditionTag(!Fu(t.actionBehavior),"This action type does not support toggled status",595899714),Ba(t.actionBehavior))this.handleActionOrReturnToDraft(function(){return a.selectionManager.selectNextOrPreviousThread({direction:Yt.Previous,source:le.SharedComments,expandCard:!0,iterableContentTypes:[Bt.CommentThread]},ca.HostAction,A.None)},r,it()?void 0:ao.PreviousThread,C.reserveTag(591729750));else if(wu(t.actionBehavior))return n4(d)?dr.Success:dr.Fail;return dr.Success}case Gt.DeleteThread:{if(x().assertConditionTag(!Fu(t.actionBehavior),"This action type does not support toggled status",595899715),wu(t.actionBehavior)){if(!$Ce(d.commentState))return dr.Fail}else Ba(t.actionBehavior)&&this.handleActionOrReturnToDraft(function(){var u=Ie(d);u&&r(wm({renderContextType:A.None,trackback:C.reserveTag(591738706),telemetryVisitor:a.telemetryVisitor},u.selectedCardId))},r,ao.DeleteThread,C.reserveTag(591729751));return dr.Success}}return dr.NotHandled},e.prototype.beginDraftingHelper=function(t,r,n,o){return t(Os({renderContextType:A.None,trackback:n,telemetryVisitor:this.telemetryVisitor},this.commentAPI,r,!1,this.peopleAPI)).catch(me(o)).then(function(){return He.Handled})},e.prototype.handleCommentInterruptableCommand=function(t,r,n){switch(t.type){case"CreateComment":return this.beginDraftingHelper(r,{sessionType:"CREATE"},C.reserveTag(574371082),C.reserveTag(574371083));case"EditComment":{var o=n(),a=[],d=Ie(o);a=Qu(ZG(t.commentId,wt(o),Un(o)),void 0);var c=Ya(a,t.commentId);return c?hv({comment:c,threads:a,selectedComment:d,warningType:Mt.Edit})?(r(Bu({renderContextType:A.None,telemetryVisitor:this.telemetryVisitor,trackback:C.reserveTag(593000206)},t.commentId,Mt.Edit)),Promise.resolve(He.Handled)):this.beginDraftingHelper(r,{sessionType:"EDIT",commentId:t.commentId},C.reserveTag(593000207),C.reserveTag(593000208)):(x().assertConditionTag(!1,"Comment not found",593000205),Promise.resolve(He.Handled))}case"ReplyComment":return this.beginDraftingHelper(r,{sessionType:"REPLY",threadId:t.threadId},C.reserveTag(593000209),C.reserveTag(593000210));case"DiscardDraft":{var u=n();if(t.mode===jf.TryAutoDiscard)return r(Ff({renderContextType:A.None,telemetryVisitor:this.telemetryVisitor,trackback:C.reserveTag(575411521)},le.Canvas)).then(function(g){return g.draftDiscardResult});var d=Ie(u);if(t.mode===jf.Dialog&&Pd(pe(u))===Nr.CannotAutoDiscard)return Ro(u)?Promise.resolve(He.Unhandled):Promise.resolve(He.Canceled);var l=Bs(aa(u)===bt.Visible,Fs(Vn(u).containerType),pe(u),d,tl(u));return r(tg({renderContextType:A.None,telemetryVisitor:this.telemetryVisitor,trackback:C.reserveTag(575411522)},le.Canvas,l,void 0))}default:return Promise.resolve(He.Unhandled)}},e.prototype.handleActionOrReturnToDraft=function(t,r,n,o){r(Ff({renderContextType:A.None,trackback:o,telemetryVisitor:this.telemetryVisitor},le.SharedComments,n)).then(function(a){(n===void 0||a.draftDiscardBehavior===Nr.NoDraft||a.draftDiscardResult===He.Handled)&&t()}).catch(me(C.reserveTag(591738704)))},e}();s();ne();Rc();si();Is();Ve();i0();Cr();s();ne();so();St();io();an();Lw();Hw();zw();kc();Zw();eF();function Kl(e,t,r,n){return function(o,a){var d=a();n&&o(n);var c=n?n.actionDetail.telemetryVisitor:t;if(r){if(r.topVisibleThreadId!==void 0&&o(aI({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953696)},r.topVisibleThreadId||void 0)),r.selectedCommentId!==void 0){var u=Ie(d);if(r.selectedCommentId)if(u&&u.selectedCardId===r.selectedCommentId)if(et(u.selectionDetails)){var l=u.selectionDetails.selectedPostId,p=a();Or(wt(p),l)?o(fn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953698)},r.selectedCommentId,l,Ae.SelectPost,le.Canvas)):o(fn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953699)},r.selectedCommentId,void 0,Ae.ExpandCard,le.Canvas))}else o(fn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953697)},r.selectedCommentId,void 0,Ae.SelectCard,le.Canvas));else o(fn({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953728)},r.selectedCommentId,void 0,Ae.ExpandCard,le.Canvas));else if(u){var g=pe(d),h=g.cardIdToDraftIdMap[u.selectedCardId];(!h||g.drafts[h].commentDraft.sessionConfiguration.sessionType!=="CREATE")&&o(_m({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953729)}))}}r.highlightedCommentId!==void 0&&(r.highlightedCommentId?o(Ac({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953730)},r.highlightedCommentId,le.Canvas)):o(Lu({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(578586722)},le.Canvas,void 0)));var v=wk(r);v&&o(dI({renderContextType:e,telemetryVisitor:c,trackback:C.reserveTag(595953732)},v))}}}s();ne();te();Is();pn();ye();St();ue();Cr();$C();function JCe(e,t,r,n){return function(o,a){var d=[];Pc(t)?(x().assertConditionTag(a?Lr(a()).virtualized:!0,"contextReloadThunk's payload should only include comment ids when state is virtualized",595162893),d=Ak(t.commentIds,function(){return a().commentState})):d=t.comments;var c=Pc(t)?[]:t.tasks;o(Kl(e.renderContextType,n,t.contextDetails,Dm(Tt(e,C.reserveTag(595953694)),{comments:d,tasks:c}))),Ha()&&o(rl(Tt(e,C.reserveTag(595932895)),d,c,r)).catch(me(C.reserveTag(595645974)))}}s();ne();Is();ye();ue();Gw();Kw();$C();function Iy(e,t,r){return function(n){if(aC(t)){n(HS(Tt(e,C.reserveTag(595137280)),t.threads));return}Ha()&&n(rl(Tt(e,C.reserveTag(595137282)),t.comments,t.tasks,r)),n(LS(Tt(e,C.reserveTag(595137283)),t.comments,t.tasks))}}lo();var ZCe=function(){function e(t,r,n,o){this.commonViewStrategy=t,this.peopleAPI=r,this.focusManager=n,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(t,r,n,o){switch(t){case Fe.CommentsChanged:{_c(r)&&n(Kl(A.None,this.telemetryVisitor,r.contextDetails,Pm({renderContextType:A.None,trackback:C.reserveTag(595937042),telemetryVisitor:this.telemetryVisitor},r.changes)));break}case Fe.LoadComments:{Ic(r)&&n(Iy({renderContextType:A.None,trackback:C.reserveTag(595899532),telemetryVisitor:this.telemetryVisitor},r,this.peopleAPI));break}case Fe.CommentContextReload:{Ec(r)&&n(JCe({renderContextType:A.None,trackback:C.reserveTag(595899533),telemetryVisitor:this.telemetryVisitor},r,this.peopleAPI,this.telemetryVisitor));break}}this.commonViewStrategy.processCommentEvent(t,r,n,o)},e.prototype.processCommentUIAction=function(t,r,n){if(t.actionType===Gt.AddComment&&t.actionBehavior!==ai.CheckEnabled){var o=n();mi(o)&&this.focusManager.onUserAction(o.paneState.componentTree,{userAction:Pn.RequestNewCommentFromHost})}return this.commonViewStrategy.processCommentUIAction(t,r,n)},e.prototype.handleCommentInterruptableCommand=function(t,r,n){return this.commonViewStrategy.handleCommentInterruptableCommand(t,r,n)},e}();s();ne();si();Is();ng();Uf();Ve();s();k();ne();te();df();ii();Ve();Jt();vs();St();Ni();io();an();kc();Cr();function eve(e,t){return function(r,n){var o,a,d,c,u,l=n(),p=!1,g=e.contextDetails;if((g==null?void 0:g.selectedCommentId)===""&&(g=m(m({},g),{selectedCommentId:void 0})),r(Kl(A.None,t,g,Pm({renderContextType:A.None,trackback:C.reserveTag(595953743),telemetryVisitor:t},e.changes))),!(e.contextDetails&&e.contextDetails.selectedCommentId)){var h=Ie(l),v=h?h.selectedCardId:void 0,y=n(),T=Ie(y);x().assertConditionTag(!tr(l),"applyCommentChangesAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402329);var b=In(l),I=In(y);if(!v)!b.length&&I.length&&(r(fn({renderContextType:A.None,trackback:C.reserveTag(595947723),telemetryVisitor:t},er(I)?I[0]:I[0].commentId,void 0,Ae.ExpandCard,le.SharedComments)),p=!0);else{var E=v&&e.changes.some(function(ie){return ie.type===nt.Delete&&ie.model.commentId===v});if(E){var P=void 0;if(er(b)){var _=Un(l),D=[],M=0;P=-1;for(var H=0;H<b.length;H++)D.push(M),M+=_[b[H]].length,b[H]===v&&(P=H);try{for(var U=$e(e.changes),F=U.next();!F.done;F=U.next()){var z=F.value;switch(z.type){case nt.Insert:var Y=void 0;for(Y=D.length-1;Y>=0;Y--){if(z.index<=D[Y]){D[Y]+=1;continue}break}yr(z.model)&&(Y<P&&++P,D.splice(Y+1,0,z.index));break;case nt.Delete:var B=void 0;for(B=D.length-1;B>=0;B--){if(z.index<D[B]){D[B]-=1;continue}z.index===D[B]&&(B<P&&--P,D.splice(B,1));break}break;case nt.Modify:case nt.Unknown:case nt.Load:break;default:Me(z)}}}catch(ie){o={error:ie}}finally{try{F&&!F.done&&(a=U.return)&&a.call(U)}finally{if(o)throw o.error}}}else{P=b.findIndex(function(ie){return ie.commentId===v});try{for(var q=$e(e.changes),K=q.next();!K.done;K=q.next()){var z=K.value;switch(z.type){case nt.Insert:z.index<=P&&++P;break;case nt.Delete:z.index<P&&--P;break;case nt.Modify:case nt.Unknown:case nt.Load:break;default:Me(z)}}}catch(ie){d={error:ie}}finally{try{K&&!K.done&&(c=q.return)&&c.call(q)}finally{if(d)throw d.error}}}if(T)throw new ge(T5,C.reserveTag(589103626),-2130957551);if(I.length){var $=P;$===I.length&&($-=1);var oe=er(I)?I[$]:Ze(I[$]);r(fn({renderContextType:A.None,trackback:C.reserveTag(595953744),telemetryVisitor:t},oe,void 0,Ae.ExpandCard,le.SharedComments)),p=!0}}}x().assertConditionTag(p||I.length===0||((u=e.contextDetails)===null||u===void 0?void 0:u.selectedCommentId)!=="","Received empty selection from context details with existing comments and without setting selection afterwards in applyCommentChangesAndPreserveSelectionPositionThunk",590991767)}}}s();ne();te();Ad();HC();St();Ni();io();an();kc();Cr();function tve(e,t,r,n){return function(o,a){o(Iy({renderContextType:e,trackback:C.reserveTag(595899530),telemetryVisitor:n},t,r));var d=a();x().assertConditionTag(tr(d)===void 0,"Half pane specific logic should not run with filtering enabled.",523866629);var c=Lr(d).virtualized,u=Ie(d),l=pi(d);qu(Li(d),c,!!tr(a()))&&l.length&&(!u||!Of(d,u.selectedCardId))&&o(fn({renderContextType:e,trackback:C.reserveTag(595953680),telemetryVisitor:n},er(l)?l[0]:l[0].commentId,void 0,Ae.ExpandCard,le.SharedComments))}}s();k();ne();te();Is();ii();pn();ye();St();Ni();io();an();Yw();kc();Cr();$C();function rve(e,t,r,n){return function(o,a){var d,c,u=a(),l=!1,p=[];Pc(t)?(x().assertConditionTag(Lr(u).virtualized,"reloadCommentsAndPreserveSelectionPositionThunk's payload should only include comment ids when state is virtualized",595162891),p=Ak(t.commentIds)):p=t.comments;var g=t.contextDetails;(g==null?void 0:g.selectedCommentId)===""&&(g=m(m({},g),{selectedCommentId:void 0}));var h=Pc(t)?[]:t.tasks;o(Kl(e,n,g,Dm({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595953677)},{comments:p,tasks:h}))),Ha()&&o(rl({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595162892)},p,h,r)).catch(me(C.reserveTag(595645962))),x().assertConditionTag(!tr(u),"reloadCommentsAndPreserveSelectionPositionThunk is not presently supported with filtering enabled",526402328);var v=(d=Ie(u))===null||d===void 0?void 0:d.selectedCardId,y=In(u),T=a(),b=In(T);if(!v)!y.length&&b.length&&(o(fn({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595947722)},er(b)?b[0]:b[0].commentId,void 0,Ae.ExpandCard,le.SharedComments)),l=!0);else{var I=!Ie(T);if(I){var E=er(y)?y.findIndex(function(D){return D===v}):y.findIndex(function(D){return D.commentId===v});if(E<0)return;if(b.length){var P=E;P===b.length&&(P-=1);var _=er(b)?b[P]:Ze(b[P]);o(fn({renderContextType:e,telemetryVisitor:n,trackback:C.reserveTag(595953678)},_,void 0,Ae.ExpandCard,le.SharedComments)),l=!0}}}x().assertConditionTag(l||b.length===0||((c=t.contextDetails)===null||c===void 0?void 0:c.selectedCommentId)!=="","Received empty selection from context details with existing comments and without setting selection afterwards in reloadCommentsAndPreserveSelectionPositionThunk",590991766)}}lo();var nve=function(){function e(t,r,n,o){this.commonViewStrategy=t,this.peopleAPI=r,this.lastInitializationReason=n,this.telemetryVisitor=o}return e.prototype.processCommentEvent=function(t,r,n,o){switch(t){case Fe.CommentsChanged:{_c(r)&&n(eve(r,this.telemetryVisitor));break}case Fe.LoadComments:{Ic(r)&&((o().paneState.initializationStatus===Wn.Initialized||this.lastInitializationReason!==Ns.NewThread)&&mi(o())?n(tve(A.HalfPane,r,this.peopleAPI,this.telemetryVisitor)):n(Iy({renderContextType:A.None,trackback:C.reserveTag(595899531),telemetryVisitor:this.telemetryVisitor},r,this.peopleAPI)));break}case Fe.CommentContextReload:{Ec(r)&&n(rve(A.HalfPane,r,this.peopleAPI,this.telemetryVisitor));break}}this.commonViewStrategy.processCommentEvent(t,r,n,o)},e.prototype.processCommentUIAction=function(t,r,n){return this.commonViewStrategy.processCommentUIAction(t,r,n,{retainSelectionOnAddComment:!0})},e.prototype.handleCommentInterruptableCommand=function(t,r,n){return this.commonViewStrategy.handleCommentInterruptableCommand(t,r,n)},e}();var ove=function(){function e(){}return e.prototype.createViewStrategy=function(t,r,n,o,a,d,c,u,l){var p=new XCe(r,n,o,a,u,l);switch(t.containerType){case xc.HalfPane:return new nve(p,n,c,u);case xc.FullPane:return new ZCe(p,n,d,u)}},e}();function ive(e){var t=e.apiContext,r=e.peopleAPI||Qhe(t),n=al(t)?ag(t):void 0,o=Lm(t)?_I(t):void 0,a=e.viewContainerProvider||nye(t,e.displayMode,e.foldableLayoutState),d=e.localizationAPI||vb(),c=e.themeAPI||Sb(),u;e.hostCommentAPI?u=new yk(e.hostCommentAPI):u=Ghe(t);var l=Cn.getTelemetryVisitor(e.apiContext),p=new uye(d.getLocaleInfo().isRightToLeft,l),g=new GCe(r,l,e.correlationId||"");La()&&!ku()&&g.initializeController(!1);var h=gCe(u,a,zye(a.getViewContainer(),e.paneVisible,d.getLocaleInfo(),t),l,n,d,p,g,o);return new VCe({apiContext:t,viewProvider:a,commentAPI:u,peopleAPI:r,localizationAPI:d,themeAPI:c,focusManager:p,lppManager:g,initializationReason:e.initializationReason,commentStore:h,viewStrategyFactory:new ove,initializeImmediately:e.initializeImmediately,mockUIDriver:e.mockDriver,contentFilteredRangeAPI:o,contentNavigationAPI:n})}Re.enableStackLogging=!0;Re.enableMessageLogging=!0;Q()==="win32"?o4.LogBox.ignoreAllLogs():Q()==="android"&&o4.LogBox.ignoreLogs(["Warning: Can only update a mounted or mounting component. This usually means you called setState, replaceState, or forceUpdate on an unmounted component. This is a no-op."]);yhe(ive);(0,sve.initReka)();Jk();Hy(vhe);ki()&&Cn.ensureInitialized();Wy.register();D5();cn&&yD({logFocusDebugInfo:It});ave.AppRegistry.registerComponent("CommentHostNative",function(){return Che});Sb();j5();})();
//# sourceMappingURL=Comments.win32.bundle.map
