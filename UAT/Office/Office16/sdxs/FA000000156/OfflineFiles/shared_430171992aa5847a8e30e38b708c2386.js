/*! For license information please see shared.js.LICENSE.txt */
(self.webpackChunksdx_pptnarrativeview=self.webpackChunksdx_pptnarrativeview||[]).push([[1804],{47917:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CreateAugloopSessionModule:()=>i.M}),3023==o.j)var i=o(27413)},39675:(e,t,o)=>{"use strict";o.d(t,{h:()=>P}),o(28958);var i=o(56415);var n=o(80836),r=o(87803),s=o(98121),a=o(66504),l=o(43452),c=o(85640),u=o(56984),d=o(28022),h=o(80409),g=o(17226);const p=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o="inline"===e.type?u.b:c.e;return{components:{root:o},root:l.Gk({ref:t,...e},{elementType:o})}})(e,t),i=(0,a.X3)();return(e=>{e.root.className=(0,g.z)("fui-Drawer",e.root.className)})(o),(0,s.$e)("useDrawerStyles_unstable")(o),((e,t)=>((0,h.C)(e),(0,d.Y)(a.Th,{value:t,children:(0,d.Y)(e.root,{})})))(o,i)}));p.displayName="Drawer";var f=o(21678),m=o(38991),v=o(51033),b=o(46279),y=o(22295);const C=({scrollTop:e,scrollHeight:t,clientHeight:o})=>t<=o?"none":0===e?"top":e+o===t?"bottom":"middle";var S=o(33899);const w=(0,S.y)("ri6rvx7",null,[".ri6rvx7{padding:0 var(--spacingHorizontalXXL);flex:1;align-self:stretch;position:relative;z-index:1;overflow:auto;}",".ri6rvx7:last-child{padding-bottom:calc(var(--spacingHorizontalXXL) + 1px);}",".ri6rvx7:first-child{padding-top:calc(var(--spacingHorizontalXXL) + 1px);}"]),k=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{setScrollState:o}=(0,a.ls)(),n=i.useRef(null),[r,s]=(0,f.N)(),c=i.useCallback((()=>{s(),r((()=>{n.current&&o(C(n.current))}))}),[s,r,o]);return(0,m.E)((()=>{if(n.current)return o(C(n.current)),()=>s()}),[s,o]),{components:{root:"div"},root:l.Gk((0,v.g)("div",{ref:(0,b.a)(t,n),...e,onScroll:(0,y.p)(e.onScroll,c)}),{elementType:"div"})}})(e,t);return(e=>{const t=w();e.root.className=(0,g.z)("fui-DrawerBody",t,e.root.className)})(o),(0,s.$e)("useDrawerBodyStyles_unstable")(o),(e=>((0,h.C)(e),(0,d.Y)(e.root,{})))(o)}));k.displayName="DrawerBody";var T=o(15561),x=o(80029),I=o(38692),_=o(46968);const E=(0,x.n)({drawer:{position:"fixed",width:"100%",display:"flex",zIndex:100,flexDirection:"column",justifyContent:"flex-end",backgroundColor:"transparent"},drawerBody:Object.assign(Object.assign({backgroundColor:I.L.colorNeutralBackground2,maxHeight:"400px",boxShadow:"0px -4px 94px 0px rgba(0, 0, 0, 0.08)"},_.Pt.padding(0)),{"&:last-child":Object.assign({},_.Pt.padding(0))})});var A=o(20176);const R=(0,A.PA)((function(e){return i.createElement("div",null,"Drawer content goes here",i.createElement("div",null,"Query string:",e.calloutProps.queryString))})),B=(0,T.PA)((e=>{var t;const{isLoading:o,onDismissed:s,onFirstRender:a,onPreventDismissOnEvent:l,onRenderResults:c}=e.calloutProps,[u,d]=i.useState(!0),h=document.getElementById("chat-input-wrapper"),g=E();i.useEffect((()=>{a()}),[a]),i.useEffect((()=>{o||c()}),[o,c]);const f=i.useRef(null);let m;i.useEffect((()=>{const e=e=>{var t;f.current&&!(null===(t=null==f?void 0:f.current)||void 0===t?void 0:t.contains(e.target))&&s(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[s]),m=h?h.getBoundingClientRect():{top:0,left:0,right:0,bottom:0,width:0,height:0};const v=i.useRef(0);v.current=window.innerHeight-m.top;const[b,y]=i.useState(window.innerHeight-v.current);i.useEffect((()=>{const e=()=>{y(window.innerHeight-v.current)};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const C=i.useCallback((e=>{e&&"key"in e&&n.x.isKey(e,r.m.escape)&&(e.preventDefault(),e.stopPropagation()),s(!1)}),[s]),S={open:u,type:"inline",mountNode:h,position:"bottom",modalType:"modal",onOpenChange:(e,t)=>{!t.open&&(null==l?void 0:l(e))||(d(t.open),t.open||C())},className:g.drawer,style:{top:m.top-b+"px",left:0,width:`${null===(t=null==h?void 0:h.parentNode)||void 0===t?void 0:t.clientWidth}px`,height:`${b}px`}};return i.createElement(p,Object.assign({},S),i.createElement(k,{className:g.drawerBody,ref:f},i.createElement(R,{calloutProps:e.calloutProps})))}));var M=o(13920),D=o(22474),O=o(36284);const F=(0,D.F5)({inlineSuggestionsCalloutStore:O.A.on(M.Z)}),P=(0,A.PA)((()=>{var e;const{inlineSuggestionsCalloutStore:t}=(0,D.KN)(F);return(null===(e=t.displayCallout)||void 0===e?void 0:e.targetLocation)?i.createElement(B,Object.assign({},t.displayCallout)):null}))},42419:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{BizChatSuggestionsWebUXModule:()=>l}),3023==o.j)var i=o(30757);if(3023==o.j)var n=o(68358);if(3023==o.j)var r=o(72286);if(3023==o.j)var s=o(41800);if(3023==o.j)var a=o(39675);class l{constructor(){this.imports=[s.N,n.h]}get uniqueId(){return(0,i.z)(548253440)}configureRootServices(e){e.bind(r.i).toValue(a.h)}}},843:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CategoryLocalizationSlimModule:()=>i.N}),3023==o.j)var i=o(62898)},88417:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{NudgeUXModule:()=>i.B}),3023==o.j)var i=o(94653)},1006:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{UXModules:()=>s}),3023==o.j)var i=o(30757);if(3023==o.j)var n=o(16348);if(3023==o.j)var r=o(40199);class s{constructor(){this.imports=[r.q,n.y]}get uniqueId(){return(0,i.z)(507363479)}}},40199:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>u}),3023==o.j)var i=o(30757);if(3023==o.j)var n=o(29492);if(3023==o.j)var r=o(16216);if(3023==o.j)var s=o(92593);if(3023==o.j)var a=o(74880);if(3023==o.j)var l=o(32686);if(3023==o.j)var c=o(99995);class u{constructor(){this.imports=[r.f,n.D,a.I,c.p,s.S,l.O]}get uniqueId(){return(0,i.z)(507363480)}}},87557:(e,t,o)=>{"use strict";o.d(t,{A:()=>n});var i=o(91432);class n{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,o)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=n.Rejected,void o(t)}this.prevSeq=-1}e!=this.prevSeq+1&&i.tG.warn(542712385,i.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const r={seq:e,resolve:t};this.insertItem(r),this.runInOrder(r,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,o=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(o?(o.prev=e,e.next=o):this.lastQueueItem=e);o=t,t=t.prev}while(t);o&&(o.prev=e),e.next=o,this.firstQueueItem=e}runInOrder(e,t,o){let i=this.prevSeq,n=!1;const r=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(i+1!=t.seq&&(!o||t.seq>e.seq))break;i=t.seq,t.timeout&&clearTimeout(t.timeout),r.push(t),e==t&&(n=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}r.length>0&&setTimeout((()=>{for(const e of r)e.resolve(e.seq)}),0),this.prevSeq=i,!n&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}n.Rejected="SequenceItemRejected"},58307:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>d,n:()=>u}),3023==o.j)var i=o(16865);if(3023==o.j)var n=o(72e3);if(3023==o.j)var r=o(32720);var s=o(44109),a=o.n(s);const l=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,c=/[.!?]/g;function u(e,t){const o=[],i=h(e,t);return i&&o.push(i),o}function d(e,t){const o=[],r=h(e,t);r&&o.push(r);const s=function(e,t,o){var r,s,a,l,c,u;const d=e,h=t;if((null==d?void 0:d.ipPosition)!==(null==h?void 0:h.ipPosition)||(null==d?void 0:d.isColdIp)!==(null==h?void 0:h.isColdIp)){if((null==d?void 0:d.isColdIp)===(null==h?void 0:h.isColdIp)&&o)if(o.deltaType===i.WI.Add){if((null==h?void 0:h.ipPosition)===(null!==(r=o.position)&&void 0!==r?r:0)+(null!==(s=o.length)&&void 0!==s?s:0))return}else if(o.deltaType===i.WI.Update){if((null==h?void 0:h.ipPosition)===(null!==(a=o.position)&&void 0!==a?a:0)+(null!==(c=null===(l=o.content)||void 0===l?void 0:l.length)&&void 0!==c?c:0))return}else if(o.deltaType===i.WI.Delete&&(null==h?void 0:h.ipPosition)===(null!==(u=o.position)&&void 0!==u?u:0))return;return new n.s({deltaType:i.WI.CursorUpdate,cursorData:{ipPosition:null==h?void 0:h.ipPosition,isColdIp:null==h?void 0:h.isColdIp}})}}(e,t,r);s&&o.push(s);const l=function(e,t,o){var r,s,l,c,u,d,h;const g=e,p=t;if((null===(r=p.formattedRanges)||void 0===r?void 0:r.length)<=(null===(s=g.formattedRanges)||void 0===s?void 0:s.length))if(o){let e=g.formattedRanges?[...g.formattedRanges]:[];const t=function(e,t,o){if(!e)return;if(t.deltaType===i.WI.Add){const t=e.find((e=>e.start===o&&0===e.length));if(t)return t;o=Math.max(o-1,0)}const n=e.find((e=>0===e.length?e.start===o:e.start<=o&&o<e.start+e.length));return n}(g.formattedRanges,o,o.position),n=t?e.indexOf(t):-1;if(-1!==n&&(o.position+(o.length||0)>t.start+t.length?t.length=o.position+(null!==(l=o.content)&&void 0!==l?l:"").length-t.start:t.length+=(null!==(c=o.content)&&void 0!==c?c:"").length-(o.length||0),e[n]=t),e.length>0){for(const t of e.slice(n+1))t.start<o.position||(o.position+(o.length||0)>t.start?(t.length=t.start+t.length-(o.position+(o.length||0)),t.start=o.position+(null!==(u=o.content)&&void 0!==u?u:"").length):t.start+=(null!==(d=o.content)&&void 0!==d?d:"").length-(o.length||0));e=e.filter((e=>e.length>0))}const r=null!==(h=null==p?void 0:p.formattedRanges)&&void 0!==h?h:[];if(a()(e,r)||0===e.length&&0===r.length)return}else if(a()(null==g?void 0:g.formattedRanges,null==p?void 0:p.formattedRanges))return;return new n.s({deltaType:i.WI.FormattingUpdate,formattedRanges:null==p?void 0:p.formattedRanges})}(e,t,r);l&&o.push(l);const c=function(e,t){const o=e,r=t;let s;const l={};let c=!1;for(s in r)-1===["ipPosition","isColdIp","content","formattedRanges"].indexOf(s)&&(a()(r[s],o[s])||(c=!0,l[s]=r[s]));if(c)return new n.s({deltaType:i.WI.OtherNonContentUpdate,otherNonContentData:l})}(e,t);return c&&o.push(c),o}function h(e,t){const o=e.content,s=t.content,a=(0,r.C)(o,s),u=a.firstDiffLeft,d=o.length-a.firstDiffRight,h=s.length-a.firstDiffRight;let g,p=i.WI.Update;if(o.length!==s.length)d===u?(p=i.WI.Add,g=o[o.length-1]):h===u&&(p=i.WI.Delete,g=s[s.length-1]);else if(o===s)return;let f,m=0;switch(p){case i.WI.Update:m=d-u,f=s.substring(u,h);break;case i.WI.Add:f=s.substring(u,h);break;case i.WI.Delete:m=d-u,f=o.substring(u,d)}const v=function(e,t){const o=Array.from(e.matchAll(l));if(l.lastIndex=0,0===o.length)return i.OD.Chars;if(1===o.length){if(0===o[0].index)return t&&c.test(t)?i.OD.Sentence:t&&!l.test(t)?i.OD.Word:i.OD.Chars;if(o[0].index+1===e.length)return c.test(e[o[0].index-1])?i.OD.Sentence:l.test(e[o[0].index-1])?i.OD.Chars:i.OD.Word;if(e[o[0].index-1]){const t=e[o[0].index-1];if(c.test(t))return i.OD.Sentence;if(l.test(t))return i.OD.Chars}return i.OD.Word}const n=Array.from(e.matchAll(c));return c.lastIndex=0,0===n.length?i.OD.PartialSentence:n.length>1?i.OD.Paragraph:n[0].index+1<=e.length?l.test(e[n[0].index+1])?i.OD.Sentence:i.OD.Paragraph:void 0}(f,g);if(void 0!==v)return new n.s({content:p!==i.WI.Delete?f:void 0,deltaType:p,unit:v,position:u,length:p!==i.WI.Add?m:0})}},10257:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>r}),3023==o.j)var i=o(90628);if(3023==o.j)var n=o(58307);class r{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(i.qf.getTypeName(),n.n),this.registerDeltaBuilderHandler(i.Cg.getTypeName(),n.T)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,o){const i=this.deltaBuilderHandlers.get(e);return i?i(t,o):[]}}},52579:(e,t,o)=>{"use strict";if(o.d(t,{U:()=>u}),3023==o.j)var i=o(86997);if(3023==o.j)var n=o(5629);if(3023==o.j)var r=o(91432);if(3023==o.j)var s=o(90628);if(3023==o.j)var a=o(10257);const l=(e,t)=>t?c([...t,e]):e,c=e=>e.join("\\");class u{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var o;const a=new n.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return a.success=!1,a.resultDescription="Unable to create text tile delta, parent item is undefined",void r.tG.info(524883085,r.nh.CoreDefault,a.stop());if(!e.body)return a.success=!1,a.resultDescription="Unable to create text tile delta, parent item has undefined body",void r.tG.info(524883086,r.nh.CoreDefault,a.stop());const n=e.body;if(!s.qf.typeGuard(n))return a.success=!1,void(a.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${s.qf.getTypeName()}, received ${i.h.getTypeNameFor(n)}`);const c=l(e.id,t),u=null!==(o=this.lastSeenTileByTileId.get(c))&&void 0!==o?o:new s.qf({content:""}),d=this.createDeltas(u,n);return d&&0!==d.length?(a.dimension0=d.length.toString(),this.lastSeenTileByTileId.set(c,n)):(a.dimension0="0",a.resultDescription="No delta differences found"),r.tG.info(524883087,r.nh.CoreDefault,a.stop()),d}catch(e){return a.success=!1,a.resultDescription=`Error creating text tile delta: ${e}`,void r.tG.info(524883088,r.nh.CoreDefault,a.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new a.a}addItemToLocalMap(e,t){const o=l(e.id,t),i=e.body;s.qf.typeGuard(i)&&!this.lastSeenTileByTileId.has(o)&&this.lastSeenTileByTileId.set(o,i)}deleteItemFromLocalMap(e,t){const o=l(e.id,t);this.lastSeenTileByTileId.has(o)&&this.lastSeenTileByTileId.delete(o)}moveItemsInLocalMap(e,t,o){const i=new Set(o),n=c(t),r=c(e),s=[],a=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(n)){const o=a(e,n);if(void 0===o||i.has(o)){const o=e.replace(n,r);s.push({item:t,newPathKey:o,prevPathKey:e})}}for(const e of s)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(i.h.getTypeNameFor(t),e,t)}}},32720:(e,t,o)=>{"use strict";function i(e,t,o=!1){let i,s,a={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(i=e,s=t):(i=t,s=e),0===s.indexOf(i)?(a.firstDiffLeft=i.length,a.firstDiffRight=0):s.endsWith(i)?(a.firstDiffLeft=0,a.firstDiffRight=i.length):(a=function(e,t,o=!1){const i={firstDiffLeft:0,firstDiffRight:t.length};let r;for(r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(r),s=t.charCodeAt(r);if(!(i===s||n(i,o)&&n(s,o)))break}for(i.firstDiffLeft=r,r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(e.length-r-1),s=t.charCodeAt(t.length-r-1);if(!(i===s||n(i,o)&&n(s,o)))break}return i.firstDiffRight=r,i}(e,t,o),a.firstDiffLeft+a.firstDiffRight>i.length&&(a.firstDiffRight=i.length-a.firstDiffLeft)),function(e,t,o){if(e.firstDiffLeft>0){const i=e.firstDiffLeft<t.length&&r(t,e.firstDiffLeft),n=e.firstDiffLeft<o.length&&r(o,e.firstDiffLeft);(i||n)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const i=e.firstDiffRight<t.length&&r(t,t.length-e.firstDiffRight),n=e.firstDiffRight<o.length&&r(o,o.length-e.firstDiffRight);(i||n)&&(e.firstDiffRight-=1)}}(a,e,t),a}function n(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function r(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}o.d(t,{C:()=>i})},21889:(e,t,o)=>{"use strict";var i;o.d(t,{O:()=>i}),function(e){e.dev="dev",e.int="int",e.test="test",e.dogfood="dogfood",e.msit="msit",e.prod="prod",e.gcc="gcc",e.dod="dod",e.gccHigh="gcchigh",e.ag08="ag08",e.ag09="ag09",e.gallatin="gallatin"}(i||(i={}))},62277:(e,t,o)=>{"use strict";var i,n,r,s;o.d(t,{OY:()=>i}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(n||(n={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(r||(r={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(s||(s={}))},25731:(e,t,o)=>{"use strict";var i;o.d(t,{Z:()=>i}),function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(i||(i={}))},17788:(e,t,o)=>{"use strict";var i;o.d(t,{T:()=>i}),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(i||(i={})),Error},3768:(e,t,o)=>{"use strict";var i;o.d(t,{q:()=>i}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(i||(i={}))},59925:(e,t,o)=>{"use strict";var i,n,r,s,a,l,c,u,d,h,g;o.d(t,{Y$:()=>r,in:()=>a,wC:()=>i}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(i||(i={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(r||(r={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(s||(s={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(a||(a={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(l||(l={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(c||(c={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(u||(u={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(d||(d={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount"}(h||(h={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(g||(g={}))},82017:(e,t,o)=>{"use strict";o.d(t,{r:()=>r});const{AugLoopTextEncoder:i,AugLoopTextDecoder:n}=(()=>{if("undefined"==typeof TextEncoder){o(25130);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();class r{static deserialize(e,t=(e=>e)){if(e[0]!==r.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let o=1;const i=[],n=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;o<e.byteLength;){if(o+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const t=n.getUint32(o);if(o+t+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");"undefined"!=typeof Buffer&&Buffer.from?i.push(Buffer.from(e.buffer,e.byteOffset+o+4,t)):i.push(new Uint8Array(e.buffer,e.byteOffset+o+4,t)),o+=4+t}if(i.length<1)throw new Error("Invalid Binary: No fragments found");const s=r.textDecoder.decode(i[0]);return JSON.parse(s,((e,o)=>{if("string"==typeof o){if(o.substring(0,r.BINARYKEYWORD.length)===r.BINARYKEYWORD){const e=parseInt(o.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=i.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(i[e+1])}if(o.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return o.substring(r.ESCAPEKEYWORD.length)}return o}))}static serialize(e){const t=[void 0],o=JSON.stringify(e,((e,o)=>ArrayBuffer.isView(o)?(t.push(o),`${r.BINARYKEYWORD}${t.length-2}`):o&&"Buffer"===o.type&&Array.isArray(o.data)?(t.push(new Uint8Array(o.data)),`${r.BINARYKEYWORD}${t.length-2}`):"string"==typeof o&&o.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+o:o));t[0]=r.textEncoder.encode(o);const i=t.reduce(((e,t)=>e+4+t.byteLength),0),n=new Uint8Array(i+1);n[0]=r.IDENTIFIERBYTE;let s=1;const a=new DataView(n.buffer,n.byteOffset,n.byteLength);for(const e of t)a.setUint32(s,e.byteLength),n.set(e,s+4),s+=4+e.byteLength;return n}}r.IDENTIFIERBYTE=3,r.BINARYKEYWORD=":b",r.ESCAPEKEYWORD=":",r.textDecoder=new n,r.textEncoder=new i},41416:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},96749:(e,t,o)=>{"use strict";o.d(t,{u:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.operationName="",e.prototype.key="",e.prototype.value="",e.prototype.buildVersion="",e.prototype.datafield0="",e.prototype.datafield1="",e.prototype.datafield2="",e.prototype.datafield3="",e.prototype.tagId=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnonymizedOperationEvent"},e}());class r extends n{constructor(e){if(super(e),this.eventName="AnonymizedOperation",this.allowListedLogs=[508856344,508688156],!this.allowListedLogs.includes(e.tagId))throw new Error("AnonymizedOperations must be allow-listed and reviewed by AugLoop engineering team. Please include your privacy approval in the review.")}}},43241:(e,t,o)=>{"use strict";o.d(t,{W:()=>i});class i{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<r;e++)s[e]=n[Math.floor(Math.random()*n.length)];return s.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new i(e.substring(0,e.length-2)):new i(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new i(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=3023==o.j?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"]:null,r=22,s=new Array(r)},82580:(e,t,o)=>{"use strict";o.d(t,{u:()=>n});var i=o(43241);class n{get sessionKey(){var e;return null===(e=this.sessionDescriptor)||void 0===e?void 0:e.sessionKey}get interactionSessionId(){return this._interactionSessionId}set interactionSessionId(e){if(this._interactionSessionId&&this._interactionSessionId!==e)throw new Error("InteractionSessionId is already set");this._interactionSessionId=e}get interactionId(){return this._interactionId}set interactionId(e){if(this._interactionId&&this._interactionId!==e)throw new Error("InteractionId is already set");this._interactionId=e}constructor(e,t,o,i){this.cv=e,this.sessionDescriptor=t,this.clientMetadata=o,this.workflow=null==i?void 0:i.workflow,this.joinContextId=null==i?void 0:i.joinContextId,this.performanceEvent=null==i?void 0:i.performanceEvent,this.sessionLogsSampled=void 0,this._interactionId=null==i?void 0:i.interactionId,this._interactionSessionId=null==i?void 0:i.interactionSessionId,this.traceId=null==i?void 0:i.traceId}static deserialize(e){if(e)try{const t=JSON.parse(e),o={appName:t.clientAppName,appPlatform:t.clientAppPlatform,releaseAudienceGroup:t.clientReleaseAudienceGroup,flights:t.clientFlights};return new n(new i.W(t.cv),{sessionKey:t.sessionKey,userId:t.userId,mastermindEndpoint:t.mastermindEndpoint},o,{workflow:t.workflow,joinContextId:t.joinContextId,interactionId:t.interactionId,interactionSessionId:t.interactionSessionId,traceId:t.traceId})}catch(t){return new n(new i.W(e))}}static fromExisting(e,t,o,i,r){return new n(t||e.cv,o||e.sessionDescriptor,i||e.clientMetadata,{workflow:(null==r?void 0:r.workflow)||e.workflow,joinContextId:(null==r?void 0:r.joinContextId)||e.joinContextId,performanceEvent:(null==r?void 0:r.performanceEvent)||e.performanceEvent,interactionId:(null==r?void 0:r.interactionId)||e.interactionId,interactionSessionId:(null==r?void 0:r.interactionSessionId)||e.interactionSessionId,traceId:(null==r?void 0:r.traceId)||e.traceId})}toString(){var e,t;return`${null===(e=this.clientMetadata)||void 0===e?void 0:e.appName};${null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform};${this.sessionKey};${this.cv}`}serialize(){var e,t,o,i,r;const s=null===(e=this.clientMetadata)||void 0===e?void 0:e.appName,a=null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform,l=null===(o=this.clientMetadata)||void 0===o?void 0:o.releaseAudienceGroup,c=null===(i=this.clientMetadata)||void 0===i?void 0:i.flights;return n.stringify(Object.assign(Object.assign({cv:this.cv.toString()},null!==(r=this.sessionDescriptor)&&void 0!==r?r:{}),{clientAppName:s,clientAppPlatform:a,clientReleaseAudienceGroup:l,clientFlights:c,workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId}))}newChild(){return new n(this.cv.newChild(),this.sessionDescriptor,this.clientMetadata,{workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId})}}n.schema={type:"object",properties:{cv:{type:"string"},clientAppName:{type:"string"},clientAppPlatform:{type:"string"},clientReleaseAudienceGroup:{type:"string"},clientFlights:{type:"string"},sessionKey:{type:"string"},userId:{type:"string"},mastermindEndpoint:{type:"string"},workflow:{type:"string"},joinContextId:{type:"string"},interactionId:{type:"string"},interactionSessionId:{type:"string"},traceId:{type:"string"}}},n.stringify=(n.schema,JSON.stringify)},61445:(e,t,o)=>{"use strict";o.d(t,{HW:()=>d,IQ:()=>v,NS:()=>u,Ve:()=>c,Zw:()=>f,fK:()=>p,fZ:()=>m,nd:()=>h,z0:()=>g});var i=o(43241),n=o(82580);let r=new n.u(new i.W);const s=3023==o.j?[]:null,a=new Map;let l;const c=e=>{s.push(r),r=e},u=e=>{if(r===e)return void(r=s.pop());const t=s.lastIndexOf(e);if(t<0)throw new Error("Context not found");if(0===t)throw new Error("Cannot remove top context");s.splice(t,1)},d=e=>{l||(l=e.createHook({init(t){const o=h();if(o)a.set(t,o);else if(0===e.executionAsyncId()){const o=e.triggerAsyncId(),i=a.get(o);i&&a.set(t,i)}},before(e){const t=a.get(e);t&&c(t)},after(e){const t=a.get(e);t&&u(t)},destroy(e){a.delete(e)}}),l.enable())},h=()=>r,g=()=>r&&r.cv&&r.cv.toString()||null,p=()=>{var e;return new n.u((null===(e=null==r?void 0:r.cv)||void 0===e?void 0:e.newChild())||new i.W,null==r?void 0:r.sessionDescriptor,null==r?void 0:r.clientMetadata,{workflow:null==r?void 0:r.workflow,joinContextId:null==r?void 0:r.joinContextId,performanceEvent:null==r?void 0:r.performanceEvent,interactionId:null==r?void 0:r.interactionId,interactionSessionId:r.interactionSessionId,traceId:null==r?void 0:r.traceId})},f=e=>{const t=p();return v((t=>e(t&&t.cv||void 0)),t)},m=(e,t,o,s,a)=>{const l=new n.u(t&&i.W.fromString(t)||(null==r?void 0:r.cv)||new i.W,o||(null==r?void 0:r.sessionDescriptor),s||(null==r?void 0:r.clientMetadata),{workflow:(null==a?void 0:a.workflow)||(null==r?void 0:r.workflow),joinContextId:(null==a?void 0:a.joinContextId)||(null==r?void 0:r.joinContextId),performanceEvent:(null==a?void 0:a.performanceEvent)||(null==r?void 0:r.performanceEvent),interactionId:(null==a?void 0:a.interactionId)||(null==r?void 0:r.interactionId),interactionSessionId:(null==a?void 0:a.interactionSessionId)||(null==r?void 0:r.interactionSessionId),traceId:(null==a?void 0:a.traceId)||(null==r?void 0:r.traceId)});return v(e,l)},v=(e,t)=>{c(t);try{return e(t)}finally{u(t)}}},77196:(e,t,o)=>{"use strict";var i;o.d(t,{AQ:()=>r,GR:()=>i,HX:()=>c,He:()=>s,ax:()=>a,oX:()=>l,sw:()=>u,yL:()=>n}),function(e){e.UnexpectedClose="UnexpectedClose",e.ExpectedClose="ExpectedClose",e.ExpectedError="ExpectedError"}(i||(i={}));const n="ExcelExtensionClose",r="ExcelKeepAlive",s=3023==o.j?`ProcessMessage_${n}`:null,a=3023==o.j?`${n}_${i[i.ExpectedClose]}`:null,l=3023==o.j?`${n}_${i[i.ExpectedError]}`:null,c=3023==o.j?`${n}_${i[i.UnexpectedClose]}`:null;var u;!function(e){e[e.Unknown=0]="Unknown",e[e.SessionClosedOutside=1]="SessionClosedOutside",e[e.ClosedOutsideBeforeInitialSeedingCompleted=2]="ClosedOutsideBeforeInitialSeedingCompleted",e[e.EcsProxyClose=3]="EcsProxyClose",e[e.EcsProxyFailedToFetchContent=4]="EcsProxyFailedToFetchContent",e[e.EcsProxyFailedToFetchWorkbookMetadata=5]="EcsProxyFailedToFetchWorkbookMetadata",e[e.EcsProxyFailedToRequestWaitForWorkbookChange=6]="EcsProxyFailedToRequestWaitForWorkbookChange",e[e.EcsProxyReconnect=7]="EcsProxyReconnect",e[e.EcsProxyUnexpected=8]="EcsProxyUnexpected",e[e.EcsSessionClosedNotification=9]="EcsSessionClosedNotification",e[e.SessionIdle=10]="SessionIdle",e[e.FailedToProducePubSubMessage=11]="FailedToProducePubSubMessage",e[e.FailedToSetSessionData=12]="FailedToSetSessionData",e[e.FailedToGetSessionData=13]="FailedToGetSessionData",e[e.ReachUnexpectedCode=14]="ReachUnexpectedCode",e[e.RequestIdMismatch=15]="RequestIdMismatch",e[e.SeedingNotRequired=16]="SeedingNotRequired",e[e.ShortAccessTokenTTLReconnect=17]="ShortAccessTokenTTLReconnect"}(u||(u={}))},2732:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>s}),3023==o.j)var i=o(42847);if(3023==o.j)var n=o(91432);if(3023==o.j)var r=o(96749);class s{constructor(e,t,o,n,r=5,s){this.severity=e,this.resourceId=t,this.tokenExpirationInMS=o,this.idleDurationInMS=n,this.kAnonUser=r,this.log=s,this.cache=new i.l({idleDurationMs:this.idleDurationInMS,sweepInterval:6e4}),this.kAnonUser=Math.min(5,this.kAnonUser),this.log=s||this.logHits}updateTokenCount(e,t,o){this.flush();const i=Date.now(),n=this.cache.get(e);if(!n)return void this.cache.put(e,{users:[{userId:t,timestamp:i,count:o}]},this.tokenExpirationInMS);const r=n.users.find((e=>e.userId===t));if(r)r.timestamp=i,r.count+=o;else if(n.users.push({userId:t,timestamp:i,count:o}),n.users.length>=this.kAnonUser){const t=n.users.reduce(((e,t)=>e+t.count),0);this.cache.del(e),this.log(e,t)}}logHits(e,t){n.tG.info(508688156,n.nh.CoreSystem,new r.u({operationName:"BlocklistMatchEvent",key:e,value:t+"",datafield0:this.severity,datafield1:this.resourceId,buildVersion:process.env.BUILD_BUILDNUMBER||"DEV",tagId:508688156}))}flush(){this.cache.forEach((e=>{e.users=e.users.filter((e=>Date.now()<e.timestamp+this.tokenExpirationInMS))}))}getCount(e){this.flush();const t=this.cache.get(e);return t?t.users.reduce(((e,t)=>e+t.count),0):0}shutdown(){this.cache.clear(),this.cache=void 0}}},30892:(e,t,o)=>{"use strict";o.d(t,{H:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpRequestQueueEvent"},e}());class r extends n{getMetrics(){return{HttpRequestQueueV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpRequestQueue"}}},27268:(e,t,o)=>{"use strict";o.d(t,{S:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpSocketListEvent"},e}());class r extends n{getMetrics(){return{HttpSocketListV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpSocketList"}}},10125:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{AnnotationMetaDataChange:()=>d.v,AnonymizedOperation:()=>m.u,CorrelationContext:()=>a.u,CorrelationVector:()=>l.W,CustomBlockListLogger:()=>T.P,ExtensionCloseReason:()=>S.sw,ExtensionCloseType:()=>S.GR,HttpRequestQueue:()=>r.H,HttpSocketList:()=>y.S,Log:()=>i.tG,LogCategory:()=>i.nh,LoggingAggregator:()=>u.D,Operation:()=>n.I,OutboundHttpRequest:()=>b.c,PrivacyGuardIssue:()=>C.J,ProcessIdentification:()=>s.U,ScenarioStats:()=>f.y,SessionHealthEvent:()=>h.vf,SessionHealthEventAggregation:()=>g.N,SessionHealthImpact:()=>h.Pq,SessionHealthReason:()=>h.l6,SessionHealthSource:()=>h.aM,SessionIssue:()=>p.M,Timer:()=>v.M,WebSocketConnectionEnd:()=>c.j,argsToString:()=>i.am,createChildCorrelation:()=>w.fK,enter:()=>w.Ve,excelExtensionCloseEventName:()=>S.yL,excelExtensionExpectedCloseEventName:()=>S.ax,excelExtensionExpectedErrorEventName:()=>S.oX,excelExtensionUnexpectedCloseEventName:()=>S.HX,excelKeepAliveAggregationName:()=>S.He,excelKeepAliveMessageName:()=>S.AQ,exit:()=>w.NS,getCorrelation:()=>w.nd,getCorrelationVectorString:()=>w.z0,getNumLoggers:()=>i.OD,initAsyncHooks:()=>w.HW,now:()=>k.t,resumeCorrelation:()=>w.IQ,startChildCorrelation:()=>w.Zw,startCorrelation:()=>w.fZ,tagIdToString:()=>i.ih}),3023==o.j)var i=o(91432);if(3023==o.j)var n=o(5629);if(3023==o.j)var r=o(30892);if(3023==o.j)var s=o(17216);if(3023==o.j)var a=o(82580);if(3023==o.j)var l=o(43241);if(3023==o.j)var c=o(26627);if(3023==o.j)var u=o(67756);if(3023==o.j)var d=o(41416);if(3023==o.j)var h=o(36079);if(3023==o.j)var g=o(89142);if(3023==o.j)var p=o(91088);if(3023==o.j)var f=o(71817);if(3023==o.j)var m=o(96749);if(3023==o.j)var v=o(13028);if(3023==o.j)var b=o(84579);if(3023==o.j)var y=o(27268);if(3023==o.j)var C=o(9438);if(3023==o.j)var S=o(77196);if(3023==o.j)var w=o(61445);if(3023==o.j)var k=o(35489);if(3023==o.j)var T=o(2732)},67756:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});const i=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}class r{constructor(e,t,o,r,s){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const o=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])o.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n="n~"),o.push(`${n}${e[t].toString().replace(i,"_")}`)}const r=o.join("|");let s=this.buckets.get(r);if(!s){s=new n,s.traceLevel=e.traceLevel;for(const e of this.avgMeasures)s.measureSums.set(e,0);this.buckets.set(r,s)}s.count++;for(const t of this.avgMeasures)e[t]&&s.measureSums.set(t,s.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},i=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],n=i[e];0===n.indexOf("b~")?o[t]="b~true"===n:0===n.indexOf("n~")?o[t]=parseInt(n.slice(2),10):o[t]=n}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=o,this.avgMeasures=r,s>0&&(this.interval=setInterval(this.flush,1e3*s))}}},91432:(e,t,o)=>{"use strict";o.d(t,{tG:()=>v,nh:()=>M,am:()=>y,OD:()=>k,ih:()=>R});var i,n=o(3768);!function(e){e.Log="Log"}(i||(i={}));const r="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",s="abcdefghijklmnopqrstuvwxyz0123456789",a={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,c=[],u=[],d=e=>null,h=e=>{};const g=new Map,p=new Map,f=new Map,m=new Map;var v;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{c=[],u=[],p.clear(),f.clear()},e.clearAggregators=()=>{g.clear()},e.addLogger=e=>{-1===c.indexOf(e)&&(c.push(e),b(p,e))},e.addDecidingLogger=e=>{-1===u.indexOf(e)&&(u.push(e),b(f,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{_(e,t)})),g.has(e.eventName)?g.get(e.eventName).push(e):g.set(e.eventName,[e])},e.flushAggregators=e=>{g.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const o=B(e);m.set(o,t)},e.resetTagLevelOverrides=()=>{m.clear()},e.error=(e,t,o,i,r,s,a,l,c,u)=>{I(e,t,n.q.error,o,i,r,s,a,l,c,u)},e.warn=(e,t,o,i,r,s,a,l,c,u)=>{I(e,t,n.q.warn,o,i,r,s,a,l,c,u)},e.info=(e,t,o,i,r,s,a,l,c,u)=>{I(e,t,n.q.info,o,i,r,s,a,l,c,u)},e.verbose=(e,t,o,i,r,s,a,l,c,u)=>{I(e,t,n.q.verbose,o,i,r,s,a,l,c,u)},e.debug=(e,t,o,i,r,s,a,l,c,u)=>{I(e,t,n.q.debug,o,i,r,s,a,l,c,u)},e.metric=(e,t,o,i,r,s,a,l,c,u)=>{I(e,t,n.q.metric,o,i,r,s,a,l,c,u)},e.formatMetric=(e,t,o,i)=>{const n={};return n[e]={dimensionNames:o,dimensionValues:i,value:t},n},e.dynamic=e=>{_(e)}}(v||(v={}));const b=(e,t)=>{const o=t.level;Object.keys(n.q).map((e=>n.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=o)).forEach((o=>{e.has(o)?e.get(o).push(t):e.set(o,[t])}))},y=e=>{if("string"==typeof e)return e;let t="";for(let o=0;o<e.length;o++){o>0&&(t+=" ");const i=e[o];i instanceof Error?t+=JSON.stringify({message:i.message,name:i.name,stack:i.stack}):t+="object"==typeof i?JSON.stringify(i):i}return t},C=[],S=["Level","Tag"],w=["Level","Tag","Workflow"],k=e=>T(e).length,T=e=>void 0!==e?p.get(e)||C:c,x=(e,t)=>(void 0!==e?f.get(e)||[]:u).filter((e=>e.shouldLog(t))),I=(e,t,o,n,r,s,a,c,u,p,f)=>{o=m.get(e)||o;const v=T(o),b=x(o,n);if(0==v.length&&0==b.length)return;const C=d(i.Log),k=R(e),I=((e,t,o,i,n,r,s,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,o,i,n,r,s,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(n,r,s,a,c,u,p,f);if(E(t))A(I)&&_({eventName:"Metrics",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:"",getMetrics:()=>I},!1,v,b);else if(A(I)){const e=I;e.tagId=k,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const i=g.get(e.eventName);if(i)for(let t=0;t<i.length;++t){const o=i[t];if(o&&o.add(e,t===i.length-1))break}else _(e,!1,v,b)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>S,dimensionValues:[String(o),k],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>w,dimensionValues:[String(o),k,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};_({eventName:"Log",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:y(I),getMetrics:e},!1,v,b)}h(C)},_=(e,t=!1,o,i)=>{var n,s,a,c,u,d,h,g,p,f,m,v;if(null==o&&(o=T(e.traceLevel)),i=i||C,o.length>0||i.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(n=t.clientMetadata)||void 0===n?void 0:n.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(s=t.clientMetadata)||void 0===s?void 0:s.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(a=t.clientMetadata)||void 0===a?void 0:a.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(c=t.clientMetadata)||void 0===c?void 0:c.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(u=t.clientMetadata)||void 0===u?void 0:u.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(p=t.clientMetadata)||void 0===p?void 0:p.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(f=t.clientMetadata)||void 0===f?void 0:f.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(m=t.clientMetadata)||void 0===m?void 0:m.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(v=t.clientMetadata)||void 0===v?void 0:v.isClientTelemetrySampled)}for(const t of o)t.log(e);for(const t of i)t.log(e)}},E=e=>e.name===M.WorkflowMetricsOnly.name&&e.root===M.WorkflowMetricsOnly.root,A=e=>!Array.isArray(e)&&"object"==typeof e,R=e=>s[e>>24&63]+s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e],B=e=>e&&5===e.length?a[e.charCodeAt(0)]<<24|a[e.charCodeAt(1)]<<18|a[e.charCodeAt(2)]<<12|a[e.charCodeAt(3)]<<6|a[e.charCodeAt(4)]:-1;class M{}M.CoreDefault=v.defineCoreLogCategory("Default"),M.CoreSystem=v.defineCoreLogCategory("System"),M.CoreUnsampled=v.defineCoreLogCategory("Unsampled"),M.WorkflowDefault=v.defineWorkflowLogCategory("Default"),M.WorkflowUnsampled=v.defineWorkflowLogCategory("Unsampled"),M.WorkflowMetricsOnly=v.defineWorkflowLogCategory("MetricsOnly"),M.PrivacyGuardEvent=v.defineCoreLogCategory("PrivacyGuardEvent")},35489:(e,t,o)=>{"use strict";o.d(t,{t:()=>i});const i="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now()},5629:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),r=o(35489);class s extends n{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){if(null==t)return;const o=this.dataFields?JSON.parse(this.dataFields):{};o[e]=t,this.dataFields=JSON.stringify(o)}setDataFields(e){this.dataFields?this.dataFields=JSON.stringify(Object.assign(Object.assign({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)}start(){return this.startTime=(0,r.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,r.t)()-this.startTime)),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,o;const i={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":i[this.operationName+".CountV2"]={dimensionNames:s.getOrphanedSessionHealthDimensionNames.bind(s),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":i[this.operationName+".Reason"]={dimensionNames:s.getSessionHealthDimensionNames.bind(s),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(i["Workflow.DurationMs"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},i["Workflow.Count"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const o=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(o)>=0)&&(i[o]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(o=this.options)||void 0===o?void 0:o.metricCount)||e.indexOf(t)>=0)&&(i[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return i}getDimensionNames(){var e,t;let o=s.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){o=o.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(e)}return o}getDimensionValues(){var e,t;const o=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(this.options.metricCustomDimensions[e]);return o}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}s.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],s.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"]},84579:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.host="",e.prototype.statusCode=0,e.prototype.success=!1,e.prototype.wait=0,e.prototype.dns=0,e.prototype.tcp=0,e.prototype.firstByte=0,e.prototype.download=0,e.prototype.total=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OutboundHttpRequestEvent"},e}());class r extends n{getMetrics(){return{"OutboundHttpRequestV2.Wait":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.wait},"OutboundHttpRequestV2.DNS":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.dns},"OutboundHttpRequestV2.TCP":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.tcp},"OutboundHttpRequestV2.FirstByte":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.firstByte},"OutboundHttpRequestV2.Download":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.download},"OutboundHttpRequestV2.Total":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.total}}}constructor(e){super(e),this.eventName="OutboundHttpRequest"}getDimensionValues(){return[this.host,this.statusCode,this.success]}}r.dimensionNames=["Host","StatusCode","Success"]},9438:(e,t,o)=>{"use strict";o.d(t,{J:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.suspiciousLogTagId="",e.prototype.suspiciousStringIssues="",e.prototype.suspiciousStringValue="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/PrivacyGuardIssueEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="PrivacyGuardIssue"}}},17216:(e,t,o)=>{"use strict";o.d(t,{U:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Pid=0,e.prototype.ApplicationName="",e.prototype.ServiceName="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ProcessIdentificationEvent"},e}());class r extends n{constructor(){super(...arguments),this.eventName="ProcessIdentification"}}},71817:(e,t,o)=>{"use strict";o.d(t,{y:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.resourceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.scenarioHealthBucket="",e.prototype.scenarioHealthReason="",e.prototype.scenarioHealthBucketWithSuppressions="",e.prototype.scenarioHealthReasonWithSuppressions="",e.prototype.activationState="",e.prototype.modelItemsCountBucket="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ScenarioStatsEvent"},e}());class r extends n{getMetrics(){return{"ScenarioStats.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:1},"ScenarioStatsWithSuppressions.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getSuppressionsDimensionValues(),value:1},"ScenarioStatsScenario.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getScenarioDimensionValues(),value:1},"ScenarioStatsScenarioWithSuppressions.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getScenarioSuppressionsDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="ScenarioStats",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucket,this.healthReason]}getSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucketWithSuppressions,this.healthReasonWithSuppressions]}getScenarioDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucket,this.scenarioHealthReason]}getScenarioSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucketWithSuppressions,this.scenarioHealthReasonWithSuppressions]}}r.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","HealthBucket","HealthReason"]},89142:(e,t,o)=>{"use strict";o.d(t,{N:()=>a});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.sessionHealthEventName="",e.prototype.count=0,e.prototype.successes=0,e.prototype.failures=0,e.prototype.maxDurationMs=0,e.prototype.sumDurationMs=0,e.prototype.cancellations=0,e.prototype.failureBuckets="",e.prototype.firstFailureReason="",e.prototype.firstFailureImpact="",e.prototype.firstEventSource="",e.prototype.firstEventReason="",e.prototype.firstEventReasonDependency="",e.prototype.firstEventImpact="",e.prototype.firstEventSuccess=!1,e.prototype.firstEventDurationMs=0,e.prototype.firstEventCount=0,e.prototype.firstEventMessage="",e.prototype.firstEventAffectedWorkflows="",e.prototype.lastEventSource="",e.prototype.lastEventReason="",e.prototype.lastEventReasonDependency="",e.prototype.lastEventImpact="",e.prototype.lastEventSuccess=!1,e.prototype.lastEventDurationMs=0,e.prototype.lastEventCount=0,e.prototype.lastEventMessage="",e.prototype.lastEventAffectedWorkflows="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEventAggregation"},e}()),r=o(36079);const s=(e,t)=>"reason"===e?r.l6[t]:"impact"===e?r.Pq[t]:t;class a extends n{constructor(e,t){super({sessionHealthEventName:e,count:t.count,successes:t.successes,failures:t.failures,cancellations:t.cancellations,maxDurationMs:t.maxDurationMs,sumDurationMs:t.sumDurationMs,failureBuckets:JSON.stringify(t.failureBuckets,s),firstFailureReason:t.failureBuckets.length>0?r.l6[t.failureBuckets[0].reason]:"",firstFailureImpact:t.failureBuckets.length>0?r.Pq[t.failureBuckets[0].impact]:""}),this.eventName="SessionHealthAggregation",t.firstEvent&&(this.firstEventAffectedWorkflows=t.firstEvent.affectedWorkflows,this.firstEventCount=t.firstEvent.count,this.firstEventDurationMs=t.firstEvent.durationMs,this.firstEventImpact=t.firstEvent.impact,this.firstEventMessage=t.firstEvent.message,this.firstEventReason=t.firstEvent.reason,this.firstEventReasonDependency=t.firstEvent.reasonDependency,this.firstEventSource=t.firstEvent.source,this.firstEventSuccess=t.firstEvent.success),t.lastEvent&&(this.lastEventAffectedWorkflows=t.lastEvent.affectedWorkflows,this.lastEventCount=t.lastEvent.count,this.lastEventDurationMs=t.lastEvent.durationMs,this.lastEventImpact=t.lastEvent.impact,this.lastEventMessage=t.lastEvent.message,this.lastEventReason=t.lastEvent.reason,this.lastEventReasonDependency=t.lastEvent.reasonDependency,this.lastEventSource=t.lastEvent.source,this.lastEventSuccess=t.lastEvent.success)}}},36079:(e,t,o)=>{"use strict";o.d(t,{vf:()=>c,Pq:()=>r,l6:()=>n,aM:()=>i});var i,n,r,s={util:{},roots:{default:{}}},a=(s.util,s.roots.default||(s.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=o(35489);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(r={}));class c extends a{constructor(e,t){var o,s;super({source:i[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(o=e.durationMs)&&void 0!==o?o:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(s=e.affectedWorkflows)&&void 0!==s?s:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},91088:(e,t,o)=>{"use strict";o.d(t,{M:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthSubreason="",e.prototype.summarizedFindings="",e.prototype.affectedResource="",e.prototype.affectedSessions="",e.prototype.suppressionReason="",e.prototype.modelItemsCountBucket="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionIssueEvent"},e}());class r extends n{getMetrics(){return{"SessionIssue.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="SessionIssue",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.modelItemsCountBucket,this.healthBucket,this.healthReason,this.healthSubreason,this.affectedResource,this.affectedSessions,this.suppressionReason]}}r.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ModelItemsCountBucket","HealthBucket","HealthReason","HealthSubreason","AffectedResource","AffectedSessions","SuppressionReason"]},13028:(e,t,o)=>{"use strict";o.d(t,{M:()=>i});class i{constructor(e){null==e?this.reset():this.start=e}diffInMs(){const e=process.hrtime(this.start),t=1e3*e[0]+e[1]/1e6;return Math.floor(t)}diffInUs(){const e=process.hrtime(this.start),t=1e6*e[0]+e[1]/1e3;return Math.floor(t)}reset(){this.start=process.hrtime()}}},26627:(e,t,o)=>{"use strict";o.d(t,{j:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.TerminationReason="",e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.TotalRequestCount=0,e.prototype.LifetimeSec=0,e.prototype.ClientApp="",e.prototype.ClientAppPlatform="",e.prototype.ClientAppVersion="",e.prototype.ClientReleaseAudienceGroup="",e.prototype.ClientSessionId="",e.prototype.ClusterId="",e.prototype.ConnectionSequenceId=0,e.prototype.CorrelationId="",e.prototype.UsageType="",e.prototype.MaxActiveRequestsCount=0,e.prototype.unexpectedTerminationNotSeenInSessionHealth=!1,e.prototype.webSocketCloseCode=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WebSocketConnectionEndEvent"},e}());class r extends n{constructor(e,t){super(e),this.eventName="WebSocketConnectionEnd",t&&(this.ClientApp=null==t?void 0:t.appName,this.ClientAppPlatform=null==t?void 0:t.appPlatform,this.ClientAppVersion=null==t?void 0:t.appVersion,this.ClientReleaseAudienceGroup=null==t?void 0:t.releaseAudienceGroup,this.ClientSessionId=null==t?void 0:t.sessionId)}}},94684:(e,t,o)=>{"use strict";o.d(t,{a4:()=>c,gu:()=>l,si:()=>u});var i=o(99050);if(3023==o.j)var n=o(86997);if(3023==o.j)var r=o(5629);if(3023==o.j)var s=o(91432);if(3023==o.j)var a=o(50524);const l=new Set([i.Xr.getTypeName(),i.fZ.getTypeName(),i.g0.getTypeName(),i.xU.getTypeName()]);class c{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return(0,a.lO)(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=n.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new r.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return l.has(e)}tryLogMessage(e,t,o=!0){e&&(e.success=o,e.resultDescription=t,s.tG.verbose(527308633,s.nh.CoreDefault,e.stop()))}}var u;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(u||(u={}))},41125:(e,t,o)=>{"use strict";if(o.d(t,{MM:()=>u,a4:()=>d}),3023==o.j)var i=o(86997);if(3023==o.j)var n=o(5629);if(3023==o.j)var r=o(91432);var s=o(16865);if(3023==o.j)var a=o(90628);if(3023==o.j)var l=o(72e3);const c=[s.WI.CursorUpdate,s.WI.FormattingUpdate,s.WI.OtherNonContentUpdate];function u(e,t,o){const c=new n.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return c.success=!1,c.resultDescription="Unable to apply text tile delta, parent tile is undefined",void r.tG.info(538798173,r.nh.CoreDefault,c.stop());if(i.h.getTypeNameFor(t)!==a.qf.getTypeName())return c.success=!1,c.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${l.Q.getTypeName()}, received ${i.h.getTypeNameFor(t)}`,void r.tG.info(538798174,r.nh.CoreDefault,c.stop());const o=e,n=t.content;let u="";if(void 0===o.position||o.position<0)return c.success=!1,c.resultDescription="Unable to apply text tile delta, invalid text tile position",void r.tG.info(538798175,r.nh.CoreDefault,c.stop());switch(o.deltaType){case s.WI.Add:u=o.position<n.length?`${n.slice(0,o.position)}${o.content}${n.slice(o.position,n.length)}`:n+o.content;break;case s.WI.Update:o.content||o.unit!==s.OD.Sentence||(c.dimension0="1"),u=`${n.slice(0,o.position)}${o.content}${n.slice(o.position+(o.length||0),n.length)}`;break;case s.WI.Delete:u=`${n.slice(0,o.position)}${n.slice(o.position+(o.length||0),n.length)}`}return r.tG.info(538837071,r.nh.CoreDefault,c.stop()),new a.qf({content:u})}catch(e){return c.success=!1,c.resultDescription=`Error applying text tile delta: ${e}`,void r.tG.info(538798176,r.nh.CoreDefault,c.stop())}}function d(e,t,o){var l,c,u,d,p,f,m,v;const b=new n.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();b.clientFlights=o;try{if(!t)return b.success=!1,b.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void r.tG.info(538798177,r.nh.CoreDefault,b.stop());if(i.h.getTypeNameFor(t)!==a.Cg.getTypeName())return b.success=!1,b.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${a.Cg.getTypeName()}, received ${i.h.getTypeNameFor(t)}`,void r.tG.info(538798178,r.nh.CoreDefault,b.stop());const o=t,y=e,C=o.content;let S="";if((void 0===y.position||y.position<0)&&!g(y.deltaType))return b.success=!1,b.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void r.tG.info(538798179,r.nh.CoreDefault,b.stop());if(void 0===y.content&&!g(y.deltaType))return b.success=!1,b.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void r.tG.info(538798208,r.nh.CoreDefault,b.stop());if(y.deltaType===s.WI.Add&&0!==y.length?r.tG.info(538798209,r.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):g(y.deltaType)&&void 0!==y.content&&r.tG.info(538798210,r.nh.CoreDefault,new n.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!h(y.deltaType)){const e=function(e,t,o){const i=new n.I({operationName:"FindRangeForDelta",success:!0});if(i.start(),!e)return i.resultDescription="No formatted ranges found within the tile, skipping.",void r.tG.info(538798212,r.nh.CoreDefault,i.stop());if(t===s.WI.Add){const t=e.find((e=>e.start===o&&0===e.length));if(t)return i.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,r.tG.info(538798213,r.nh.CoreDefault,i.stop()),t;o=Math.max(o-1,0)}const a=e.find((e=>0===e.length?e.start===o:e.start<=o&&o<e.start+e.length));return a?(i.resultDescription=`Updating formatted range for operation with start: ${a.start} and length: ${a.length}`,r.tG.info(538798214,r.nh.CoreDefault,i.stop())):(i.resultDescription=`Unable to find formatted range for operation at position ${o}, skipping.`,r.tG.info(538798215,r.nh.CoreDefault,i.stop())),a}(o.formattedRanges,y.deltaType,y.position);let t=o.formattedRanges?[...o.formattedRanges]:[];const i=e?t.indexOf(e):-1;-1!==i&&(y.position+(y.length||0)>e.start+e.length?e.length=y.position+(null!==(l=y.content)&&void 0!==l?l:"").length-e.start:e.length+=(null!==(c=y.content)&&void 0!==c?c:"").length-(y.length||0),t[i]=e);let h=o.ipPosition;switch(y.deltaType){case s.WI.Add:S=y.position<C.length?`${C.slice(0,y.position)}${y.content}${C.slice(y.position,C.length)}`:C+y.content,h=y.position+y.length;break;case s.WI.Update:y.content||y.unit!==s.OD.Sentence||(b.dimension0="1"),S=`${C.slice(0,y.position)}${y.content}${C.slice(y.position+(null!==(u=y.length)&&void 0!==u?u:0),C.length)}`,h=y.position+y.content.length;break;case s.WI.Delete:S=`${C.slice(0,y.position)}${C.slice(y.position+(null!==(d=y.length)&&void 0!==d?d:0),C.length)}`,h=y.position}for(const e of t.slice(i+1))e.start<y.position||(y.position+(y.length||0)>e.start?(e.length=e.start+e.length-(y.position+(y.length||0)),e.start=y.position+(null!==(p=y.content)&&void 0!==p?p:"").length):e.start+=(null!==(f=y.content)&&void 0!==f?f:"").length-(y.length||0));t=t.filter((e=>e.length>0));const g=new a.Cg(Object.assign(Object.assign({},o),{ipPosition:h,content:S,formattedRanges:t,queryRange:y.queryRange}));return r.tG.info(538837073,r.nh.CoreDefault,b.stop()),g}if(y.deltaType===s.WI.CursorUpdate)return new a.Cg(Object.assign(Object.assign({},o),{ipPosition:null===(m=y.cursorData)||void 0===m?void 0:m.ipPosition,isColdIp:null===(v=y.cursorData)||void 0===v?void 0:v.isColdIp}));if(y.deltaType===s.WI.FormattingUpdate)return new a.Cg(Object.assign(Object.assign({},o),{formattedRanges:y.formattedRanges}));if(y.deltaType===s.WI.OtherNonContentUpdate){let e;const t={};for(e in y.otherNonContentData)t[e]=y.otherNonContentData[e];return new a.Cg(Object.assign(Object.assign({},o),t))}return}catch(e){return b.success=!1,b.resultDescription=`Error applying formatted text tile delta: ${e}`,void r.tG.info(538798211,r.nh.CoreDefault,b.stop())}}function h(e){return-1!==c.indexOf(e)}function g(e){return h(e)||s.WI.Delete===e}},65726:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(50524);class n{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,o){return Object.assign(Object.assign(Object.assign({},e),t),o)}mergeWorkflowDefinition(e,t,o){if(o){const r=(0,i.oF)(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));r.set(o,n.mergeDefinitions(e,r.get(o),t))}else this.workflowDefByWorkflow.set(e.id,n.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var o;let i;return t&&(i=null===(o=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===o?void 0:o.get(t)),i||(i=this.workflowDefByWorkflow.get(e.id)),i||(i=e),i}deleteWorkflowDefinition(e,t){const o=this.workflowDefByWorkflowAndContextId.get(e.id);o&&(o.delete(t),0===o.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}},50524:(e,t,o)=>{"use strict";o.d(t,{_$:()=>n,lO:()=>r,oF:()=>i});const i=(e,t,o)=>{let i=e.get(t);return i||(i=o(),e.set(t,i)),i},n=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),r=(e,t)=>null!=e&&null!=t&&e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))},26293:(e,t,o)=>{"use strict";if(o.d(t,{Q$:()=>a,aZ:()=>s}),3023==o.j)var i=o(59925);if(3023==o.j)var n=o(5629);if(3023==o.j)var r=o(91432);var s;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(s||(s={}));class a{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var o;const i=this.getLocation(t);return null===(o=this.graphNodeByLocationAndWorkflowId.get(i))||void 0===o?void 0:o.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const o=new n.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void r.tG.error(524300630,r.nh.CoreDefault,o.stop())}const o=this.getLocation(t),i=new l(e,o);this.addWorkflowAsDependency(i);let s=this.graphNodeByLocationAndWorkflowId.get(o);s||(s=new Map,this.graphNodeByLocationAndWorkflowId.set(o,s)),s.set(e.id,i)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const o of t.values()||[]){const t=this.createWorkflowDefinition(o.workflow);o.workflow.visibility===i.Y$.LocalOnly?this.compressDownstreamWorkflows(t,o):t.outputTypes.push(...o.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),o=this.graphNodeByLocationAndWorkflowId.get(t),i=Array.from((null==o?void 0:o.values())||[]);for(const e of i){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);o.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const o of t.values()||[])e.push(o.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const o of e.values())t.push(o);return t}getLocation(e){return e?s.External:s.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const o of t.downstreamWorkflows)if(o.workflow.visibility!==i.Y$.LocalOnly){if(o.workflow.kind!==i.wC.Join||-1!==e.inputTypes.indexOf(o.workflow.collectionScopeType))for(const t of o.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,o)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const o of t.values()){for(const t of o.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,o);for(const t of o.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(o,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class l{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}},43854:(e,t,o)=>{"use strict";if(o.d(t,{e:()=>a}),3023==o.j)var i=o(5629);if(3023==o.j)var n=o(91432);if(3023==o.j)var r=o(50524);if(3023==o.j)var s=o(47659);class a{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var o;const r=e.contextId;if(r)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(r,[]),this.scopeItemsByContextId.has(r)){if(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.has(r)){const o=new i.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${r} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();n.tG.verbose(527291288,n.nh.CoreDefault,o.stop())}}else this.scopeItemsByContextId.set(r,e)}updateScopeItemPath(e,t,o){var i,n;if(!e)return;const r=this.scopeItemsByContextId.get(e);if(!r)return;const a=r.parentPath;this.scopeItemsByContextId.set(e,(0,s.CY)(t,r));const l=null!==(n=null===(i=this.itemsByWorkflowAndContextId.get(o.id))||void 0===i?void 0:i.get(e))&&void 0!==n?n:[];for(let e=0;e<l.length;e++)l[e]=(0,s.CY)([...t,...l[e].parentPath.slice(0,a.length)],l[e])}getScopeItem(e,t){var o;for(const i of(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.keys())||[])if((0,r.lO)(i,e))return this.scopeItemsByContextId.get(i)}addItemToWorkflowList(e,t){const o=e.contextId;if(!o)return;const s=this.itemsByWorkflowAndContextId.get(t.id);if(s)for(const[a,l]of s)if((0,r.lO)(a,o)){l.push(e);const o=new i.I({resultDescription:`Items for contextId ${a}: [${l.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();n.tG.info(526403808,n.nh.CoreDefault,o.stop())}}isWorkflowReady(e,t){const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=o}getItemsToExecute(e,t){const o=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),o}onWorkflowExecuted(e,t){const o=e.contextId,i=this.itemsByWorkflowAndContextId.get(t.id);i&&(i.delete(o),0===i.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(o)||this.scopeItemsByContextId.delete(o)}getGeneratedItems(e,t){var o;if(!(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.get(e)))return[];const i=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,i)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const o of t.keys())if(o===e)return!0;return!1}}},95513:(e,t,o)=>{"use strict";o.d(t,{$:()=>x});var i=o(5629),n=o(91432);const r=(e,t)=>t.some((t=>e instanceof t));let s,a;const l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap;let g={get(e,t,o){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return f(e[t])},set:(e,t,o)=>(e[t]=o,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(m(this),e),f(l.get(this))}:function(...e){return f(t.apply(m(this),e))}:function(e,...o){const i=t.call(m(this),e,...o);return u.set(i,e.sort?e.sort():[e]),f(i)}:(e instanceof IDBTransaction&&function(e){if(c.has(e))return;const t=new Promise(((t,o)=>{const i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",r),e.removeEventListener("abort",r)},n=()=>{t(),i()},r=()=>{o(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",r),e.addEventListener("abort",r)}));c.set(e,t)}(e),r(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,g):e);var t}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,o)=>{const i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",r)},n=()=>{t(f(e.result)),i()},r=()=>{o(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&l.set(t,e)})).catch((()=>{})),h.set(t,e),t}(e);if(d.has(e))return d.get(e);const t=p(e);return t!==e&&(d.set(e,t),h.set(t,e)),t}const m=e=>h.get(e),v=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],y=new Map;function C(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(y.get(t))return y.get(t);const o=t.replace(/FromIndex$/,""),i=t!==o,n=b.includes(o);if(!(o in(i?IDBIndex:IDBObjectStore).prototype)||!n&&!v.includes(o))return;const r=async function(e,...t){const r=this.transaction(e,n?"readwrite":"readonly");let s=r.store;return i&&(s=s.index(t.shift())),(await Promise.all([s[o](...t),n&&r.done]))[0]};return y.set(t,r),r}var S;S=g,g={...S,get:(e,t,o)=>C(e,t)||S.get(e,t,o),has:(e,t)=>!!C(e,t)||S.has(e,t)};var w=o(67312);const k="undefined"!=typeof fetch?fetch:w;var T;!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(T||(T={}));class x{constructor(e,t,o,r){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(o),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${o}`:"",this.checkIdbByFeatures=null==r?void 0:r.checkIdbByFeatures;const s=new i.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});s.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,o=0,i=0;const n=new Promise(((t,o)=>{e=setTimeout((()=>{o(new Error("Took longer than 10000 ms"))}),1e4)})),r=this.accessDB().then((e=>{const n=e.transaction(this.osName,"readwrite");return n.objectStore(this.osName).openCursor().then((function e(r){if(i++,r){const i=r.value;let n;return i.timesSinceUsage||(i.timesSinceUsage=0),i.timesSinceUsage++,i.timesSinceUsage>5?(o++,n=r.delete()):(t++,n=r.update(i)),n.then((()=>r.continue())).then(e)}return n.done}))}));this.initPromise=Promise.race([n,r]).catch((e=>{s.success=!1,s.resultDescription+=`${e.message} `})).then((()=>{s.dimension0=`${i}`,s.dimension1=`${t}`,s.dimension2=`${o}`,clearTimeout(e),this.closeDBAndEndLog(s,"initializing idb storage")}))}else s.resultDescription="Incompatible browser for IDB",n.tG.info(538706242,n.nh.CoreDefault,s.stop())})).catch((()=>{s.resultDescription="Issue determining idb compatibility",n.tG.info(536966936,n.nh.CoreDefault,s.stop())}))}getResourceAsArrayBuffer(e,t,o){const n=new i.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:T.ArrayBuffer,dimension1:e,dimension2:t});n.start();const r={};return this.getResource(e,t,o,T.ArrayBuffer,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{const o=e.get(t);return o.arrayBuffer?o.arrayBuffer().then((e=>{r[t]=e})):new Promise(((e,i)=>{const n=new FileReader;n.readAsArrayBuffer(o),n.onload=o=>{const n=o.target.result;n instanceof ArrayBuffer?(r[t]=n,e()):i(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>r))}getKey(e,t,o){return o?`${e}_${t}_${JSON.stringify(Array.from(o.entries()))}`:`${e}_${t}`}updateCache(e,t,o,i){this.modelPathsCache.set(this.getKey(e,t,o),i)}getCache(e,t,o){return this.modelPathsCache.get(this.getKey(e,t,o))}getResourceAsURL(e,t,o){const n=new i.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:T.URL,dimension1:e,dimension2:t});n.start();const r={},s=this.getCache(e,t,o);return s?Promise.resolve(s):this.getResource(e,t,o,T.URL,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{r[t]=URL.createObjectURL(e.get(t))}))))).then((()=>this.getCache(e,t,o)||(this.updateCache(e,t,o,r),r)))}getResource(e,t,o,i,n,r){return this.getFiles(e,t,o,n).then((e=>r(e))).then((()=>{this.closeDBAndEndLog(n,`retrieving ${e}`)})).catch((t=>{throw n.resultDescription.indexOf(t.message)>=0&&(n.success=!1,n.resultDescription+=`${t.message} `),n.resultSignature=`Issue retrieving from CDN or translating to ${i}`,this.closeDBAndEndLog(n,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const o=globalThis.indexedDB.open(this.dbName,this.dbVersion);o.onsuccess=function(){e(!0)},o.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?this.checkIdbByFeatures&&(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=function(e,t,{blocked:o,upgrade:i,blocking:n,terminated:r}={}){const s=indexedDB.open(e,t),a=f(s);return i&&s.addEventListener("upgradeneeded",(e=>{i(f(s.result),e.oldVersion,e.newVersion,f(s.transaction))})),o&&s.addEventListener("blocked",(()=>o())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),n&&e.addEventListener("versionchange",(()=>n()))})).catch((()=>{})),a}(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,n.tG.info(573329487,n.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,n.tG.error(573329488,n.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,o,i){return this.isBrowserIdbCompatible().catch((e=>(i.success=!1,i.resultDescription+=`${e.message} `,i.resultSignature="Issue determining idb compatibility",!1))).then((n=>{const r=()=>{if(o){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,o,i,n);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,i,n)};return n?this.getFilesFromIDB(e,t,o,i).catch((e=>(e&&(i.resultDescription.indexOf(e.message)>=0&&(i.success=!1,i.resultDescription+=`${e.message} `),i.resultSignature="Issue retrieving from DB"),r()))):r()}))}getFilesFromIDB(e,t,o,i){return this.initPromise.catch((e=>{i.success=!1,i.resultDescription+=`${e.message} `,i.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((n=>{for(const r of n)if(r&&r.model&&r.version==t){if(!this.checkModelFiltersPass(o,r.filters))continue;return this.putModel(e,r.model,t,r.filters,i,r.id),Promise.resolve(r.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var o;for(const i of e){const e=null===(o=t.get(i[0]))||void 0===o?void 0:o.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${i[0]} to exist in metadata file`);if(e.indexOf(i[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,o,i,n){let r;return i.dimension3="Polymer",o||(o=new Map),k(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{var s,a;const l=JSON.parse(n);if(l.name!==e||l.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${l.name} version ${l.version}`);for(const e of l.variants)if(r=new Map(Object.entries(e)),this.checkModelFiltersPass(o,r))return(l.catalog?o.size+2:o.size+1!==r.size)&&(i.success=!1,i.resultDescription+=`Expected ${null===(s=r.keys)||void 0===s?void 0:s.length} # of filters, received ${null===(a=o.keys)||void 0===a?void 0:a.length}`),e.model_files;throw new Error("No model found with given filters")})).then((o=>Promise.all(o.map((o=>k(`${this.polymerBaseURL}/${e}/${t}/${o}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[o,e]))))))).then((o=>{const s=new Map(o);return n?this.putModel(e,s,t,r,i):s}))}downloadFiles(e,t,o,i){return o.dimension3="FS",k(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((o=>{const i=JSON.parse(o),n=`${i.MajorVersion}.${i.MinorVersion}/ModelResources`,r=`${e}/${t}/`;return Promise.all(i.Resources.map((e=>(e.Name.length>r.length&&e.Name.substring(0,r.length)===r&&(e.Name=e.Name.substring(r.length)),k(`${this.baseURL}/${n}/${r}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((n=>{const r=new Map(n);return i?this.putModel(e,r,t,new Map,o):r}))}getModelOptions(e){return this.accessDB().then((t=>{const o=[],i=t.transaction(this.osName,"readonly");return i.objectStore(this.osName).openCursor().then((function t(n){if(n){const i=n.value;return i.modelId==e&&o.push(i),n.continue().then(t)}return i.done})).then((()=>o))}))}putModel(e,t,o,i,n,r){return i||(i=new Map),this.accessDB().then((n=>n.put(this.osName,{modelId:e,model:t,version:o,filters:i,timesSinceUsage:0},r))).catch((e=>{n.resultDescription.indexOf(e.message)>=0&&(n.success=!1,n.resultDescription+=`${e.message} `),n.resultSignature="Issue adding to DB"})).then((()=>t))}}},56880:(e,t,o)=>{"use strict";if(o.d(t,{_:()=>r}),3023==o.j)var i=o(51831);if(3023==o.j)var n=o(97825);class r{static createFactory(e=".",t,o,n){return s=>{var a;const l=o||i.e3;return!r.onnxRetrievalPromise||s?e?((null===(a=l())||void 0===a?void 0:a.ai_outlook)&&!s?Promise.resolve():(0,i.el)(`${e}/ai_outlook.min.js`,l,"ai_outlook",t,n)).then((()=>{r.onnxRetrievalPromise=Promise.resolve(new r(l))})).catch((e=>{r.onnxRetrievalPromise=Promise.reject(e)})).then((()=>r.onnxRetrievalPromise)):Promise.reject(new Error("Error: folderPath not provided")):r.onnxRetrievalPromise}}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var o;const i=null===(o=this.getCache())||void 0===o?void 0:o.ai_outlook;return i?(i.env.wasm.simd=!0,i.env.wasm.numThreads=0,n.Kx.create(e,t||"",i)):Promise.reject(new Error("Error: aiOutlook is undefined"))}createInputs(){return n.G0.create()}}},97825:(e,t,o)=>{"use strict";if(o.d(t,{G0:()=>c,Kx:()=>l,fE:()=>a}),3023==o.j)var i=o(25731);if(3023==o.j)var n=o(91432);if(3023==o.j)var r=o(5629);var s=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function a(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,n.tG.info(540406806,n.nh.CoreDefault,e.stop()),!0)}class l{constructor(e,t,o){this.session=e,this.onnxObject=o,this.modelName=t}static create(e,t,o){return s(this,void 0,void 0,(function*(){const i=new r.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return i.start(),o[e]?(i.resultDescription="Model already existed",n.tG.info(509699716,n.nh.CoreDefault,i.stop()),o[e]):o[e]=this.getInferenceSession(o).create(e).then((e=>(n.tG.info(540406807,n.nh.CoreDefault,i.stop()),new l(e,t,o)))).catch((e=>{throw i.resultDescription=`Error: ${e}`,n.tG.info(540406808,n.nh.CoreDefault,i.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return s(this,void 0,void 0,(function*(){const o=new r.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(o.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),i={};return Object.keys(t).forEach((e=>{const o=t[e];if(Array.isArray(o.values)&&o.values.length>0&&"boolean"==typeof o.values[0]){const t=new Uint8Array(o.values);i[e]=new this.onnxObject.Tensor(t,o.dimensions)}else i[e]=new this.onnxObject.Tensor(o.values,o.dimensions)})),this.session.run(i).then((e=>(n.tG.info(540406809,n.nh.CoreDefault,o.stop()),new u(e)))).catch((e=>{o.resultDescription=`Problem running model. ${e.message}`,n.tG.info(540406810,n.nh.CoreDefault,o.stop())}))}throw o.resultDescription="Unable to run model. Tensor not defined",n.tG.info(540406811,n.nh.CoreDefault,o.stop()),new Error("Tensor is not defined")}))}}class c{constructor(){this.map={}}static create(){return new c}getInputs(){return this.map}add(e,t,o){return this.map[e]={dimensions:t,values:o},this}}class u{constructor(e){for(const t of Object.keys(e))this[t]=new d(t,e[t])}}class d{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return i.Z.Strings;case"int8":return i.Z.Int8s;case"int16":return i.Z.Int16s;case"int32":return i.Z.Int32s;case"bool":return i.Z.Booleans;case"uint8":return i.Z.UnsignedInt8s;case"uint16":return i.Z.UnsignedInt16s;case"uint32":return i.Z.UnsignedInt32s;case"float32":return i.Z.Float32s;case"float64":return i.Z.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===i.Z.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===i.Z.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===i.Z.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===i.Z.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===i.Z.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===i.Z.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===i.Z.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===i.Z.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===i.Z.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===i.Z.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}},51831:(e,t,o)=>{"use strict";if(o.d(t,{e3:()=>s,el:()=>l}),3023==o.j)var i=o(5629);if(3023==o.j)var n=o(91432);if(3023==o.j)var r=o(97825);function s(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function a(e,t){e.src=t}function l(e,t,o,s,l){const u=new i.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(u.start(),(0,r.fE)(u)){const e="Browser lacks necessary support for inference service";return u.success=!1,u.resultDescription=e,n.tG.info(540406803,n.nh.CoreDefault,u.stop()),Promise.reject(new Error(e))}return new Promise(((i,n)=>{if("undefined"!=typeof document){const r=document.createElement("script");(l||a)(r,e),r.onload=()=>{c(t,o)?(s&&(t()[o].env.wasm.wasmPaths=s),i()):(r.remove(),n(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},r.onerror=n,document.body.appendChild(r)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[o]=self[o],c(t,o)?(s&&(t()[o].env.wasm.wasmPaths=s),i()):n(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):n(new Error("Unexpected lack of document and importScripts"))})).then((()=>{n.tG.info(540406804,n.nh.CoreDefault,u.stop())})).catch((e=>{throw u.success=!1,u.resultDescription=e.message,n.tG.info(509871835,n.nh.CoreDefault,u.stop()),e}))}function c(e,t){const o=globalThis[t];if(o&&o.InferenceSession&&o.Tensor){const i=e();return i&&!i[t]&&(i[t]=o),!0}return!1}},4485:(e,t,o)=>{"use strict";o.d(t,{g:()=>n});var i=o(3687);class n{constructor(e,t,o,i){this.sendMessage=e,this.annotationType=t,this.options=o,this.token=`${t}-${n.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=i}activate(e,t,o){return new Promise(((n,r)=>{this.sendMessage(new i.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:o}),((e,t)=>{e?r(new Error(e.error)):(i.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),n({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new i.GA({token:this.token}),((o,i)=>{o?t(new Error(o.error)):e(i.lastRelease)}))}))}}n.nextActivationResultBatchId=1},16833:(e,t,o)=>{"use strict";if(o.d(t,{Z:()=>n}),3023==o.j)var i=o(53976);class n{constructor(e){this.annotationSequencer=null!=e?e:new i.N}process(e,t,o,i){const n=[];for(const i of e.ops){const r=[];if(null==i?void 0:i.items)for(const e of i.items){const o=this.annotationSequencer.sequence(e.body).then((()=>{t(i,e)}));r.push(o)}n.push(Promise.all(r).then((()=>{o(i,e.cv)})))}Promise.all(n).then((()=>i(e)))}}},53976:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>n}),3023==o.j)var i=o(41776);class n{constructor(e=500,t){this.sequencerFactory=null!=t?t:new i.k(e)}sequence(e){var t,o,i,n,r;return o=this,i=void 0,r=function*(){if(null==(null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq))return;const o=this.sequencerFactory.create(e);o&&(yield o.sequence(e.M_.seq))},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(s,a)}l((r=r.apply(o,i||[])).next())}))}}},41776:(e,t,o)=>{"use strict";if(o.d(t,{k:()=>n}),3023==o.j)var i=o(87557);class n{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new i.A(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}},76722:(e,t,o)=>{"use strict";o.d(t,{_:()=>i});class i{process(e,t,o,i){for(const i of e.ops){if(null==i?void 0:i.items)for(const e of i.items)t(i,e);o(i,e.cv)}i(e)}}},39254:(e,t,o)=>{"use strict";if(o.d(t,{Y:()=>l}),3023==o.j)var i=o(91432);if(3023==o.j)var n=o(5629);if(3023==o.j)var r=o(99050);if(3023==o.j)var s=o(10600);var a;!function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(a||(a={}));class l{constructor(e,t,o,i){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=i,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=o}addBatchItem(e,t,o,n,r,s){const{delayMs:l,delayMsMax:c,maxInputSize:u,estimateSize:d,groupingKeyExtractor:h}=t,g=d(e),p=h(e);if(t.split&&g>u){let a;try{a=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(s?s(t):i.tG.error(573366352,i.nh.CoreDefault,t))}if(a&&Array.isArray(a.inputs)&&a.inputs.length>1){let e;const i=[],l=s?(t,o)=>{if(e=e||t,i.push(o),i.length===a.inputs.length){let o;try{o=a.join(i)}catch(t){return void s(new Error("Join error: "+t.message))}s(e,o)}}:void 0;for(let e=0;e<a.inputs.length;e++){const i=a.inputs[e];this.addBatchItem(i,t,o,n,r&&e===a.inputs.length-1,l)}return}}let f=this.batchesByGroupingKey.get(p);if(f&&f.size+g>u&&(this.executeBatch(p,f,t,a.ExceedingMaxSize),f=void 0),f||(f={items:[],size:0,hasItemsWithCallbacks:!1,context:o,creationTime:Date.now()},this.batchesByGroupingKey.set(p,f)),this.batchMessagesEnabled){const t=f.items[f.items.length-1];t&&t.cv===n&&t.callback===s?(t.input=[...t.input,...e],t.size+=g):f.items.push({input:e,size:g,cv:n,callback:s})}else f.items.push({input:e,size:g,callback:s});f.size+=g,f.hasItemsWithCallbacks=f.hasItemsWithCallbacks||!!s,this.batchMessagesEnabled||(f.cv=n),f.groupComplete=r,f.groupComplete?this.executeBatch(p,f,t,a.GroupComplete):(Date.now()-f.creationTime+l<c&&(clearTimeout(f.timeout),f.timeout=void 0),f.timeout||(f.timeout=setTimeout((()=>{this.executeBatch(p,f,t,a.BatchIntervalElapsed)}),l)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new n.I({operationName:"ReduceBatchOperations"}).start();let o=0,s=0,a=0;const l=new Set,c=[],u=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const i of t.input.reverse())if(r.fZ.typeGuard(i)){const t=[];for(const e of i.items){a++;const n=u(i,e);l.has(n)?s++:(t.push(e),l.add(n),o++)}0!==t.length&&(i.items=t,e.push(i))}else if(r.Xr.typeGuard(i)){for(const e of i.items){const t=u(i,e);l.delete(t)}e.push(i)}else e.push(i);0!==e.length&&c.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=c.reverse(),0!=a&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(s)}`,t.dimension1=`noOp: ${0===s}`),t.success=a-s==o,i.tG.info(507839488,i.nh.CoreDefault,t.stop())}executeBatch(e,t,o,r){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const a=t.items,l=new n.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(a.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:r.toString()}).start(),c=(e,o,n)=>{let r;if(o&&o.exceptionType===s.K.NoOutput)l.success=!0,i.tG.info(573366353,i.nh.CoreDefault,l.stop());else{const n=`${e} error: ${o?o.message||o:"Unknown error"}`;r=o||new Error(n),l.success=!1,l.resultDescription=`Batch of ${a.length} items of size ${t.size} with ${n}`,l.resultSignature=`${e} Error`,i.tG.error(573366354,i.nh.CoreDefault,l.stop())}if(t.hasItemsWithCallbacks)for(const e of a)e.callback&&e.callback(r,n)};let u;try{u=o.multiplex(this.batchMessagesEnabled?a:a.map((e=>e.input)))}catch(e){return void c("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(u),this.submit(u.input,t,((e,n)=>{if(e||n&&("exceptionType"in n||n instanceof Error))c("Submit",e||n,n);else if(t.hasItemsWithCallbacks||o.summaryExtractor){let r,s,d;if(t.hasItemsWithCallbacks)try{if(r=u.demultiplex(n),r.length!==a.length)throw new Error("Mismatched output length")}catch(e){return void c("Demultiplex",e)}if(o.summaryExtractor)try{[d,s]=o.summaryExtractor(n)}catch(e){return void c("SummaryExtractor",e)}if(l.success=!0,i.tG.info(573366342,i.nh.CoreDefault,l.stop()),t.hasItemsWithCallbacks)for(let e=0;e<a.length;e++)a[e].callback&&a[e].callback(void 0,r[e]);s&&this.onSummary(d,s,t.context)}else l.success=!0,i.tG.info(573366343,i.nh.CoreDefault,l.stop())}))}}},82109:(e,t,o)=>{"use strict";if(o.d(t,{A:()=>d,Z:()=>h}),3023==o.j)var i=o(92068);if(3023==o.j)var n=o(91432);var r=o(67312);if(3023==o.j)var s=o(82017);if(3023==o.j)var a=o(3687);var l=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function c(e,t){return l(this,void 0,void 0,(function*(){const{authToken:o,origin:i,sessionUrl:n}=e,{body:s,cv:a,method:l,requestUrl:c}=t,u=yield(0,r.fetch)(c||n,{method:l,headers:Object.assign({Authorization:`Bearer ${o}`,"x-origin":i,"x-correlationid":a},t.headers),body:s});if(200!==u.status)throw new Error(`Unexpected status code: ${u.status}`);return u}))}const u=(e,t)=>{t?(e.resultDescription=t,e.success=!1,n.tG.error(507646878,n.nh.CoreDefault,e.stop())):n.tG.info(507646877,n.nh.CoreDefault,e.stop())};function d(e,t,o,i){let n;c(e,{headers:{"Content-Type":"application/jsond"},body:s.r.serialize(t),cv:o.cv,method:"POST"}).then((e=>e.json())).catch((e=>{n=new a._p({messageId:t.messageId,error:e.message})})).then((e=>{u(o,n?n.error:void 0),i(n,e)}))}function h(e,t,o,n){const{sessionUrl:r}=e;let s;c(e,{cv:n.cv,method:"GET",requestUrl:t.refType===i.J1.AlCodedLocation?`${r}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{s=e})).then((e=>{u(n,s?s.message:void 0),o(s,e)}))}},67902:(e,t,o)=>{"use strict";o.d(t,{_A:()=>a,OW:()=>r,t$:()=>n});var i=o(67312);const n="Request timed out";function r(e,t,o){const n=new i.Request(e,t);return s.add(n,o)}const s=new class{constructor(e,t,o){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=o}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,o]=this.queuedRequests.shift();clearTimeout(o),this.add(e,t)}}add(e,t){if(this.requestInProgress){const o=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,o])}else this.requestInProgress=!0,new Promise(((t,o)=>{let i=!1;const n=setTimeout((()=>{i=!0,o(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{i||(clearTimeout(n),t(e))})).catch((e=>{i||(clearTimeout(n),o(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}(i.fetch,2e4,12e4);function a(e,t,o){return new Promise(((r,s)=>{const a=setTimeout((()=>{s(new Error(n))}),t);(0,i.fetch)(e,o||{}).then((e=>{clearTimeout(a),r(e)})).catch((e=>{clearTimeout(a),s(e)}))}))}},19835:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n}),3023==o.j)var i=o(84921);class n{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=(0,i.Vh)(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}}},25091:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(91432);if(3023==o.j)var n=o(5629);if(3023==o.j)var r=o(94684);class s{constructor(e,t,o){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,o&&(this.itemsContextId=o.itemsContextId,this.executionState=o.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const o of this.itemsContextId)0===o.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(i.tG.info(520217546,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(i.tG.info(508883415,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,r.si.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,r.si.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===r.si.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[o,i]of t.getExecutionState())i===r.si.Executed&&r.a4.isParentContextId(e,o)&&t.tryToCompleteWorkflowExecution(o)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const o of t.getExecutionState().keys())if(r.a4.isParentContextId(o,e))return!1;return!0}}},34251:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>r}),3023==o.j)var i=o(43241);var n=o(51049);class r extends(3023==o.j?n.EventEmitter:null){init(){return Promise.resolve()}sendMessage(e,t,o){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new i.W}getNetworkWorkerManager(){}setState(e){}}},67130:(e,t,o)=>{"use strict";if(o.d(t,{Y:()=>c}),3023==o.j)var i=o(5629);if(3023==o.j)var n=o(91432);if(3023==o.j)var r=o(88154);if(3023==o.j)var s=o(3687);const a=3023==o.j?6e4:null,l="Request timed out";class c{constructor(e,t,o){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new i.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=o,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new i.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508163399,n.nh.CoreDefault,e.stop()),this.trySendLongPoll(r.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new i.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void n.tG.info(508162497,n.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,n.tG.info(508163398,n.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===l?r.PO.TimeoutResend:r.PO.FailResend;t.error===l||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",n.tG.info(508163397,n.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",n.tG.info(508163401,n.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(r.PO.Regular)}close(){const e=new i.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508162467,n.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new i.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508162496,n.nh.CoreDefault,e.stop()),this.trySendLongPoll(r.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&s.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(r.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new i.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void n.tG.info(507281438,n.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new i.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void n.tG.info(508163396,n.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>a&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new i.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void n.tG.info(507278739,n.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new s.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}},88484:(e,t,o)=>{"use strict";o.d(t,{Z:()=>u});var i=o(3687);if(3023==o.j)var n=o(38086);var r=o(67902),s=o(67312);if(3023==o.j)var a=o(5629);if(3023==o.j)var l=o(91432);const c=JSON.stringify(new i.ry({error:r.t$}));class u{constructor(){this.isClosed=!1,this.pendingEgress=[]}init(e,t,o,i){const r=new a.I({operationName:"HttpWorkerInit",success:!0}).start(),s=e.split("/?x-origin=");2===s.length?(this.url=n.Aq.convertWebSocketUrlToHttp(s[0]),this.origin=s[1]):(this.url=n.Aq.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=o,this.onClose=i,l.tG.info(507839180,l.nh.CoreDefault,r.stop())}egress(e){const t=new a.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void l.tG.info(508163394,l.nh.CoreDefault,t.stop());const o=this.getRequestInfo(e,t);if(!o.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void l.tG.error(508163393,l.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(o,t):(0,r.OW)(o.url,o.request,((e,o)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):o&&o.ok?o.text().then((e=>{t.success=!0,l.tG.info(508163362,l.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==o?void 0:o.status}: ${null==o?void 0:o.statusText}`)}))}close(){const e=new a.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void l.tG.info(508163360,l.nh.CoreDefault,e.stop());l.tG.info(508163359,l.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,l.tG.error(508163358,l.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let o=e;t||(o=this.formatServerInput(e));o&&(this.logIngressCount(o),this.ingress(o,(e=>{i.uN.typeGuard(e)&&this.onSessionInitResponse(e)})))}onSessionInitResponse(e){const t=new a.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void l.tG.error(507809949,l.nh.CoreDefault,t.stop());l.tG.info(508163357,l.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){(0,r._A)(e.url,2e4,e.request).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",l.tG.info(508163355,l.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===r.t$?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),l.tG.error(508163353,l.nh.CoreDefault,t.stop()),this.ingressInternal(c,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const o=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),i=this.getHeader(e,t);return t.resultSignature=o,{url:o,request:{method:"POST",headers:i,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){if(null==e?void 0:e.isHttpSessionInitMessage){const e=new s.Headers({"Content-Type":"application/json"});return this.origin&&e.set("x-origin",this.origin),e}if(this.isConnectedToSession()){let o;return e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(o=new s.Headers({"Content-Type":"application/jsond2"}),t.dimension0=e.obj.byteLength.toString().length.toString()):o=new s.Headers({"Content-Type":"application/json"}),o.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),o.set("x-origin",this.sessionSettings.origin),o}return new s.Headers}setSessionSettings(e,t,o,i){const n=i.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:o,sliceUrl:n}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new a.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),l.tG.info(508409622,l.nh.CoreDefault,e.stop())}}}},57353:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>s}),3023==o.j)var i=o(61617);if(3023==o.j)var n=o(67130);if(3023==o.j)var r=o(88484);const s=(e,t,o,s,a)=>e instanceof r.Z?new n.Y(e,o,s):new i.R(e,t,o,a)},61617:(e,t,o)=>{"use strict";o.d(t,{R:()=>s});var i=o(5629),n=o(91432);const r=3e4;class s{constructor(e,t,o,n){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=n,this.pingPongLogOp=new i.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(o,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultDescription="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,n.tG.info(506795283,n.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===s.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultDescription="close",n.tG.info(506795282,n.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),n.tG.info(506795281,n.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:s.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<r)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?this.ping():(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",n.tG.info(506795280,n.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=r,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),r)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,o,i){var r,s,a,l;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=o,i&&(this.pingPongLogOp.dimension0=null!==(r=i[0])&&void 0!==r?r:"",this.pingPongLogOp.dimension1=null!==(s=i[1])&&void 0!==s?s:"",this.pingPongLogOp.dimension2=null!==(a=i[2])&&void 0!==a?a:"",this.pingPongLogOp.dimension3=null!==(l=i[3])&&void 0!==l?l:""),n.tG.info(507320073,n.nh.CoreDefault,this.pingPongLogOp.stop())}}s.pingPongMessage="~"},12962:(e,t,o)=>{"use strict";o.d(t,{xB:()=>Pe});var i,n,r=o(3768),s=o(5629),a=o(91432);!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(i||(i={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(n||(n={}));var l=o(67756);const c=["cloud-dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],u=(e,t,o,i)=>new l.D(e,(e=>e.success&&o.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],i),d=e=>{if(!e)return e;for(const t of c)if(e.indexOf(t)>=0)return e;return"**redacted**"};class h{constructor(e){this.level=r.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,o,r,s)=>{let a=t.charAt(0).toUpperCase()+t.slice(1),l={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};o&&(l=Object.assign(Object.assign({},l),JSON.parse(o)));const c=r||h.augLoopAriaTenantToken,u=s||c!=h.augLoopAriaTenantToken?s:h.augLoopAriaNamespace;a=a||h.operationNamePlaceholder;const d={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(c,u?`${u}_${a}`:a,l,"Office.System.Activity",d,!1,i.ProductServiceUsage|i.ProductServicePerformance,n.RequiredServiceDataEvent)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const o=e;t(o,o.operationName,o.dataFields,void 0,o.ariaNamespace)}else if("SessionHealth"===e.eventName)t(e,e.sessionHealthEventName);else if("WorkflowOperation"===e.eventName){const o=e;t(o,o.operationName,o.dataFields,o.ariaTenant,o.ariaNamespace)}else"Log"===e.eventName&&((e,t,o)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,o)})(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}h.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",h.augLoopAriaNamespace="Office_AugLoop_Client",h.operationNamePlaceholder="OperationNameNotProvided";var g=o(59096),p=o.n(g);class f{constructor(){this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}init(e,t,o,i,n){this.clientMetadata=n,this.ws=new(p())(e),this.logOp=new s.I({operationName:f.className,success:!0}).start(),this.logOp.setClientMetadata(n,!0),this.ingressByteCountOp=new s.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(n,!0),this.ws.addEventListener("open",(e=>{o(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),a.tG.info(508843801,a.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,a.tG.info(508843800,a.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,a.tG.info(508843799,a.nh.CoreDefault,this.logOp.stop()),i(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,a.tG.info(508843797,a.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),a.tG.info(508843794,a.nh.CoreDefault,this.ingressByteCountOp.stop()))}logWsUndefinedError(e){const t=new s.I({operationName:f.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",a.tG.info(506566722,a.nh.CoreDefault,t.stop())}}f.className="WebSocketWorker";var m,v,b=o(43241),y=o(36079),C=o(67041),S=o(86997),w=o(88154),k=o(3687),T=o(42847);function x(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let o;for(const i of t)if(0===e.indexOf(i)){o=i;break}if(!o)return"MalformedMessageName";const i=e.indexOf("Message",e.length-7)===e.length-7;return e.slice(o.length,i?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found"}(m||(m={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(v||(v={}));class I{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new T.l({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?y.aM.ClientRuntime:y.aM.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){k.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),k.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,o,i=0){var n,r;const s=new y.vf({sessionHealthEventName:"SendMessage",source:this.source,reason:y.l6.Client,impact:this.source===y.aM.ClientRuntime?y.Pq.MissingInput:y.Pq.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:x(S.h.getTypeNameFor(e)),dimension0:i.toString()}).start(),l=()=>{if(s.setClientMetadata(this.clientMetadata),s.success)a.tG.info(572836e3,a.nh.CoreDefault,s.stop());else{const e="ErrorWithoutPendingResponse"===s.resultSignature||"ResponseCallbackException"===s.resultSignature||"We called into done callback"!==s.message;s.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),a.tG.error(572836001,a.nh.CoreDefault,s.stop())}};(0,C.I)("PersistMessageId")?e.messageId=null!==(n=e.messageId)&&void 0!==n?n:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,k.l0.typeGuard(e)&&e.messages.forEach(((t,o)=>t.messageId=e.messageId+"."+o));const c=S.h.getTypeNameFor(e)===k.w9.getTypeName(),u={message:e,logOp:s,logEvent:l,callback:void 0,sendCount:1};if(!o&&!c){u.callback=(o,i)=>{var n;if(o?(s.success=!1,s.resultSignature=o.error,s.resultDescription=`Error for ${S.h.getTypeNameFor(e)} message ${e.messageId}${k.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${o.error}`):s.resultSignature="Success",t)try{s.message="We called into done callback",t(o,i)}catch(e){s.success=!1,s.resultSignature="ResponseCallbackException",s.resultDescription="Web"===(null===(n=this.clientMetadata)||void 0===n?void 0:n.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}l(),this.updateSendMessageStats(s.success,s.durationMs,o?new Error(o.error):void 0)};const o=()=>{u.callback(new k.F_({code:w.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let i=this.config.responseTimeoutMs;if(k.LQ.typeGuard(e)){const t=e;i=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else k.Yp.typeGuard(e)&&(i=null!==(r=e.maxDelayMs)&&void 0!==r?r:12e4);this.pendingResponseCallbacks.put(e.messageId,u,i,o)}this.egress&&this.egress(e,(e=>this.onEgressError(e,u)),i)}onEgressError(e,t){var o,i;if(e){const n=t.message,r=this.pendingResponseCallbacks.get(t.message.messageId);r?(this.pendingResponseCallbacks.del(n.messageId),r.callback(new k._p({messageId:n.messageId,code:w.xv.EgressError,error:e.message}))):k.w9.typeGuard(n)?(t.logOp.success=null!==(i=null===(o=e.message)||void 0===o?void 0:o.endsWith("Client disconnected."))&&void 0!==i&&i,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${S.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${S.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t){this.messageCallbacks.set(e,t)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(){this.pendingResponseCallbacks.forEach(((e,t)=>{e&&(this.pendingResponseCallbacks.del(t),e.callback(new k._p({messageId:t,code:w.xv.Cancelled,error:"Cancelled"})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new s.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});a.tG.info(572836002,a.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const o=new y.vf({sessionHealthEventName:"ProcessMessage",source:this.source,reason:y.l6.Client,impact:this.source===y.aM.ClientRuntime?y.Pq.MissingOutput:y.Pq.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),i=()=>{if(o.setClientMetadata(this.clientMetadata),o.success)a.tG.info(572836003,a.nh.CoreDefault,o.stop());else{const e="UnsupportedMessage"===o.resourceId||"Timeout"===o.resultSignature||"OnResponseInvokedMoreThanOnce"===o.resultSignature||"MessageCallbackException"===o.resultSignature||"We called into messageCallback"!==o.message;o.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),a.tG.error(572836032,a.nh.CoreDefault,o.stop())}};let n=this.messageCallbacks.get(S.h.getTypeNameFor(e));n?o.resourceId=x(S.h.getTypeNameFor(e)):n=(e,t)=>{o.resourceId=x(S.h.getTypeNameFor(e)),"MalformedMessageName"!==o.resourceId&&(o.resourceId="UnsupportedMessage"),t(new k._p({messageId:e.messageId,code:w.xv.UnsupportedMessage,error:`Message type ${S.h.getTypeNameFor(e)} is not supported`}))};let r=!1;const s=(n,s)=>{r?(o.success=!1,o.resultSignature="OnResponseInvokedMoreThanOnce",o.resultDescription=`Invoked onResponse for ${S.h.getTypeNameFor(e)} message ${e.messageId} more than once`):n?(o.success=!1,o.resultSignature=n.error,void 0!==n.code&&(o.dimension0=w.xv[n.code]),o.resultDescription=`Error for ${S.h.getTypeNameFor(e)} message ${e.messageId}: ${n.error}`):o.resultSignature="Success",r=!0,i(),n&&!S.h.matchesTypesFor(n,[k._p.getTypeName()])&&(n=new k._p({error:"Internal Server Error"})),this.updateProcessMessageStats(o.success,o.durationMs,n?new Error(n.error):void 0),n?(n.messageId=e.messageId,t(n)):s?(s.messageId=e.messageId,t(void 0,s)):t()};try{o.message="We called into messageCallback",n(e,s)}catch(e){o.success=!1,o.resultSignature="MessageCallbackException",o.resultDescription=JSON.stringify({message:e.message,stack:e.stack}),i(),this.updateProcessMessageStats(!1,o.durationMs,e),t()}}processResponse(e){var t;const o=new s.I({operationName:"ProcessResponse"});if(o.success=!0,o.setClientMetadata(this.clientMetadata),o.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),i=null==t?void 0:t.callback;if(i){if(k.i.typeGuard(e)&&!e.finalResponse){const o=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,o)}else this.pendingResponseCallbacks.del(e.messageId);S.h.matchesTypesFor(e,[k._p.getTypeName()])?i(e):i(void 0,e)}else o.resultSignature="NoPendingMessage",o.resultDescription=`${e.messageId}`,o.success=!1}else o.resultSignature="NoMessageIdSetInResponse",k._p.typeGuard(e)?o.resultDescription=e.error:o.resultDescription="MessageId is not available",o.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(o.resourceId=x(S.h.getTypeNameFor(e)),a.tG.info(572836034,a.nh.CoreDefault,o.stop()))}updateSendMessageStats(e,t,o){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||o?e&&o&&a.tG.warn(572836036,a.nh.CoreDefault,"Succeeded send message provided error object."):a.tG.warn(572836035,a.nh.CoreDefault,"Failed send message did not provide error object."),e||(o&&o.message===m.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,o){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||o?e&&o&&a.tG.warn(572836038,a.nh.CoreDefault,"Succeeded process message provided error object."):a.tG.warn(572836037,a.nh.CoreDefault,"Failed process message did not provide error object."),e||(o&&o.message===v.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var _,E,A=o(51049),R=o(38086),B=o(85115),M=o.n(B);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(_||(_={}));class D{constructor(e){this.logOp=new s.I({operationName:"MessageQueue",success:!0}),this.queue=new(M())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,o){const i=this.queue;if(1e3===i.length){this.logOp.resourceId="QueueFull",this.logOp.durationMs=0,this.logOp.success=!1,a.tG.warn(508843746,a.nh.CoreDefault,this.logOp);const e=i.shift();e.onResponse&&e.onResponse(new k._p({error:_.DroppedAsOldestInQueue}))}i.push({message:e,onResponse:t,timeQueued:R.Aq.getCurrentTimeMs(),attemptNumber:o})}sendOnSessionInitialized(e){const t=this.queue.length;let o=0;if(t>0){const i=R.Aq.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(o++,t.onResponse&&t.onResponse(new k._p({error:_.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${o}`,this.logOp.durationMs=i,this.logOp.success=!0,a.tG.warn(508843745,a.nh.CoreDefault,this.logOp)}}containSequencedSyncMessage(e){return e.message instanceof k.Tb&&S.h.matchesTypesFor(e.message,[k.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof k.l0&&S.h.matchesTypesFor(e.message,[k.l0.getTypeName()])}}!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(E||(E={}));const O=(e,t,o,i)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,i)=>{t||S.h.getTypeNameFor(i)!==k.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),o&&o(t,i)}),void 0,i))},F=(e,t,o,i)=>{t&&(e.messageQueue.push(t,o,i),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new s.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});a.tG.error(508843789,a.nh.CoreDefault,t)})))},P=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{a.tG.error(508843788,a.nh.CoreDefault,`Init failed: ${e}`)})))};class N{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,o,i){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class L extends N{constructor(){super(...arguments),this.stateName=E.Initing,this.possibleNextStates=[E.Running,E.Disconnected,E.Closed]}sendMessage(e,t,o){S.h.matchesTypesFor(e,[k.eE.getTypeName()])?O(this.context,e,t,o):F(this.context,e,t)}sendBytes(e){P(this.context,e)}onConnectionClose(){this.context.setState(E.Disconnected)}}class j extends N{constructor(){super(...arguments),this.stateName=E.Running,this.possibleNextStates=[E.Disconnected,E.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,o,i){O(this.context,e,t,o)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(E.Disconnected)}}class q extends N{constructor(){super(...arguments),this.stateName=E.Disconnected,this.possibleNextStates=[E.Initing,E.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}sendMessage(e,t,o,i){if(S.h.matchesTypesFor(e,[k.eE.getTypeName()]))this.context.setState(E.Initing),O(this.context,e,t,o);else if(S.h.matchesTypesFor(e,[k.w9.getTypeName()]))this.context.setState(E.Closed);else{if(!i)return void F(this.context,e,t,o);t&&t(new k._p({messageId:e.messageId,error:_.DroppedBecauseClientDisconnected}))}}sendBytes(e){P(this.context,e)}}class H extends N{constructor(){super(...arguments),this.stateName=E.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()}}var z=o(82017),W=o(67902),G=o(57353),U=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const V=1e5,$=1e4,K=1e3;class Q{constructor(e){var t,o,i;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.pendingQueue=[],this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new s.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.dynamicRateControllerEnabled=null!==(t=null==e?void 0:e.dynamicRateControllerEnabled)&&void 0!==t&&t,this.dynamicRateControllerEnabled&&(this.messageQueue=new(M())),this.reducedPingPongRetryEnabled=null!==(o=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==o&&o,this.startQueueProcessingInOpen=null===(i=null==e?void 0:e.startQueueProcessingInOpen)||void 0===i||i}init(e,t,o,i,n,r){this.worker=e,this.ingress=t,this.queryEgressCacheSize=o,this.clientMetadata=n,this.networkMode=i,this.reliabilityManager=(0,G.a)(this.worker,this.close.bind(this),void 0,r,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.dynamicRateControllerEnabled&&(this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.startQueueProcessingInOpen||this.processQueue()),this.resolveInitPromise()}open(){const e=new s.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.dynamicRateControllerEnabled?this.startQueueProcessingInOpen&&this.processQueue():(this.egressRateControlTimer=setInterval((()=>this.flush()),1e3),this.flush())})).catch((t=>{var o;e.success=!1,e.resultDescription=null!==(o="Catch: "+(null==t?void 0:t.message))&&void 0!==o?o:""})).finally((()=>{a.tG.info(507834384,a.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){if(this.dynamicRateControllerEnabled){const t=new s.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),a.tG.info(507388684,a.nh.CoreDefault,t.stop())}}setRpsBps(e,t){const o=new s.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();o.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.9*e,o.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.9*t,o.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),a.tG.info(507388683,a.nh.CoreDefault,o.stop())}close(){var e,t;return U(this,void 0,void 0,(function*(){const o=new s.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();if(o.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,this.dynamicRateControllerEnabled){null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const i=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();o.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&i&&(yield this.queueProcessingCompletePromise),o.setDataField("QueueSizeAfterFlush",this.messageQueue.length),o.setDataField("IsConnected",i)}this.reliabilityManager?this.reliabilityManager.close():o.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,a.tG.info(507834381,a.nh.CoreDefault,o.stop())}))}clearMessageQueues(){this.pendingQueue=[],this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var o,i,n;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const r=this.getMessageSize(e);if(r>=3e6)this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${r}`);else{if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);if(this.validateSyncMessage(e.messageId,e.seqId),this.dynamicRateControllerEnabled){const n=null!==(o=e.messageId)&&void 0!==o?o:"id"+this.emptyMessageId++,r={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:n,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},l=t>0,c=new s.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${l}`}).start();c.setClientMetadata(this.clientMetadata,!0);const u={message:r,logOp:c};if(c.dimension0="Enqueue",l?this.messageQueue.unshift(u):this.messageQueue.push(u),this.messageQueue.length>1e4)throw this.messageQueue.shift(),new Error("MessageQueue max size reached.");a.tG.info(507388547,a.nh.CoreDefault,c.stop()),null===(i=this.resolveQueueNotEmptyPromise)||void 0===i||i.call(this)}else{const t=this.queryEgressCacheSize(),o=this.egressMessageCount>=this.rpsThreshold,i=this.egressByteCount>=this.bpsThreshold,r=t>$,s=this.reliabilityManager.checkConnection(),a=0!==this.pendingQueue.length,l=this.pendingQueue.length>=1e4;if(!s||o||i||a||l||r){let c="";const u=[];(a||l)&&(c+=l?"Pending queue max exceeded. ":"Pending queue not empty. ",u.push(this.pendingQueue.length.toString().length.toString())),r&&(c+=t>=$?"Egressed cache max exceeded. ":"",u.push(t.toString().length.toString())),o&&(c+="RPS exceeded. ",u.push(this.egressMessageCount.toString().length.toString())),i&&(c+="BPS exceeded. ",u.push(this.egressByteCount.toString().length.toString())),c+=s?"":"Not connected. ",this.logEgressActivity(!0,`networkMode: ${this.networkMode}`,c,u);const d=null!==(n=e.messageId)&&void 0!==n?n:"id"+this.emptyMessageId++;return void this.pendingQueue.push({obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:d,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage})}this.sendToNetworkWorker(e)}}}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.reliabilityManager.postEgress();const t=this.getMessageSize(e);this.logEgressCount(t)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}flush(){if(!this.reliabilityManager){const e=new s.I({operationName:"NetworkRateControllerFlushFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void a.tG.info(507834373,a.nh.CoreDefault,e.stop())}let e=0,t=0;for(;this.pendingQueue.length>0&&this.queryEgressCacheSize()<$&&e<this.rpsThreshold&&t<this.bpsThreshold&&this.reliabilityManager.checkConnection();){const o=this.pendingQueue.shift();this.sendToNetworkWorker(o),e++,t+=this.getMessageSize(o)}}processQueue(){var e,t;return U(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new s.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void a.tG.info(507573643,a.nh.CoreDefault,e.stop())}const o=new s.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){o.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new s.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),a.tG.info(507281410,a.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){o.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){o.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=K)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=Date.now()-this.egressRateControlIntervalStart,t=K-e+100;let o="";this.egressMessageCount>=this.rpsThreshold&&(o+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(o+="BPS exceeded.");const i="rateLimitHit",n=new s.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();n.setClientMetadata(this.clientMetadata,!0),n.success=!0,n.resultDescription=i,n.resultSignature=o,n.dimension0=this.messageQueue.length.toString().length.toString(),n.dimension1="rateLimitHit",n.setDataField("QueueLength",this.messageQueue.length),n.setDataField("RateLimitDelayMs",t),a.tG.info(507281409,a.nh.CoreDefault,n.stop()),this.startRateLimiting(t);break}const e=this.messageQueue.shift();e.logOp.dimension0="Dequeue",this.sendToNetworkWorker(e.message),a.tG.info(507388682,a.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}this.resolveQueueProcessingCompletePromise(),this.resolveQueueProcessingCompletePromise=void 0,o.setClientMetadata(this.clientMetadata,!0),o.setDataField("QueueSize",this.messageQueue.length),o.setDataField("IsConnected",null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection()),o.setDataField("IsClosing",this.isClosing),a.tG.info(507368671,a.nh.CoreDefault,o.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new s.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),a.tG.info(507834370,a.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,o,i){var n,r,l,c;const u=new s.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=o,i&&(u.dimension0=null!==(n=i[0])&&void 0!==n?n:"",u.dimension1=null!==(r=i[1])&&void 0!==r?r:"",u.dimension2=null!==(l=i[2])&&void 0!==l?l:"",u.dimension3=null!==(c=i[3])&&void 0!==c?c:""),a.tG.info(507626007,a.nh.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>K&&((this.egressMessageCount>50||this.egressByteCount>V)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>V?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,a.tG.info(508843792,a.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var Y=o(48028);class J{constructor(e,t,o,i,n,r,l,c,u,h,g){this.logCountLimiter=new R.yq(J.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=R.Aq.convertWebSocketUrlToHttp(this.globalUrl),o=!e,i=null!=e?e:new s.I({operationName:"HttpsTest",resourceId:d(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),n={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":i.cv},body:JSON.stringify(R.Aq.createHealthCheckRequest(this.clientMetadata))};(0,W.OW)(t,n,((e,t)=>{e?(i.dimension1="HttpErr",i.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(i.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,o&&(i.success=!0)):(i.dimension1="HttpNoResp",i.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),o&&i.stop(),this.logCountLimiter.log((()=>{a.tG.info(508843780,a.nh.CoreDefault,i)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=o,this.sessionInitializer=i,this.ingress=n,this.queryEgressCacheSize=r,this.onConnectionClose=l,this.onDetectedWSBlock=c,this.sessionCorrelationVector=u,this.httpFallbackEnabled=h.httpFallbackEnabled,this.dynamicRateControllerEnabled=h.dynamicRateControllerEnabled,this.reducedPingPongRetryEnabled=h.reducedPingPongRetryEnabled,this.startQueueProcessingInOpen=h.startQueueProcessingInOpen,this.networkWorkerLogOp=new s.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=g||Y.y.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,o=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const i=()=>{if(o||!this.alreadyLoggedReconnectAttempt){const e=o?J.initialAttemptTimeout:J.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new s.I({operationName:"ConnectionFailingOrSlow",dimension0:o?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});a.tG.info(508843787,a.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!o,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new s.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});a.tG.error(508843786,a.nh.CoreDefault,t)})).then((()=>{i(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),i(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.dynamicRateControllerEnabled&&this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),!this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new s.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});a.tG.info(508843785,a.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,o)=>{let i=0;const n=R.Aq.getCurrentTimeMs()?R.Aq.getCurrentTimeMs()-t:0,r=[1e3,2e3,5e3,1e4,6e4];return i=r[Math.max(0,Math.min(r.length-1,e-1))],i=Math.max(i-n,1e3),i=o&&o>0?Math.min(5e3,i):i,i})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpFallbackEnabled?this.httpTestsSuccessCount:void 0)):this.getNetworkMode()===Y.y.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!S.h.matchesTypesFor(e,[k.eE.getTypeName()]))return void(S.h.matchesTypesFor(e,[k.YK.getTypeName()])||a.tG.error(508843784,a.nh.CoreDefault,new s.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let o,i;if(S.h.matchesTypesFor(e,[k.VR.getTypeName()])?(this.castBinaryData(e),o=z.r.serialize(e)):o=JSON.stringify(e),k.Tb.typeGuard(e)&&(i=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:o});const n=k.eE.typeGuard(e)&&this.getNetworkMode()===Y.y.HttpFallback;this.getNetworkRateController().egress({obj:o,isHttpSessionInitMessage:n,messageId:e.messageId,seqId:i},t)}bypassRateController(e){return k.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):a.tG.error(508843783,a.nh.CoreDefault,new s.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=R.Aq.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const o=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",d(o)),this.connect(o),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(o,i)=>{if(t.success=!o,t.resourceId=i?d(i.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===Y.y.HttpFallback?(t.resultDescription=o?`HTTP Error: ${o.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=o?`WS Error: ${o.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),o||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.httpFallbackEnabled?this.getNetworkMode()===Y.y.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=Y.y.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"):0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(this.permanentlyClosed=!0,t.dimension1="WSBlocked",this.onDetectedWSBlock()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"),this.logCountLimiter.log((()=>{a.tG.info(508843782,a.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{a.tG.info(508843781,a.nh.CoreDefault,t.stop())})),i.forceReconnect){this.close();const t=new s.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=i.sliceUrl,this.dynamicRateControllerEnabled&&this.getNetworkRateController().setRpsBps(i.maxRPS,i.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new s.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new Q({dynamicRateControllerEnabled:this.dynamicRateControllerEnabled,reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled,startQueueProcessingInOpen:this.startQueueProcessingInOpen})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>a.tG.info(508372418,a.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,this.queryEgressCacheSize,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===Y.y.JSWebSockets?"WebSocket":"HTTP")}}J.initialAttemptTimeout=1e5,J.reconnectAttemptTimeout=2e4,J.className="NetworkWorkerManager";var Z=o(51917);class X extends A.EventEmitter{constructor(e,t,o,i,n,r,a,l,c){super(),this.cvParent=new b.W,this.logOp=new s.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new R.yq("SessionState"),this.logRetryTelemetry=!0,this.stats=t,this.allStates={[E.Initing]:new L(this),[E.Running]:new j(this),[E.Disconnected]:new q(this),[E.Closed]:new H(this)},this.setState(E.Initing),this.messageEndpoint=new I({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(n),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(k.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new J(e,n,o,i,this.ingress.bind(this),this.messageEndpoint.queryEgressCacheSize.bind(this.messageEndpoint),this.onConnectionClose.bind(this),(()=>{this.onSessionClose(void 0,"WSNotSupported")}),this.getCorrelationVector.bind(this),a,c),this.messageQueue=new D({sendMessage:(e,t,o,i)=>this.state.sendMessage(e,t,o,i),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),i.on("connect",((e,t,o,i,n,r,s)=>{this.setState(E.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,o,i,n,r,s)})),i.on("reconnect",(()=>this.emit("reconnect"))),i.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=r,this.delayBeforeSocketClose=a.delayBeforeSocketClose,this.gateUtils=l,this.gateUtils&&this.gateUtils.isChangeGateEnabled("LogRetryMessageEvent").then((e=>{this.logRetryTelemetry=e})).catch((()=>{}))}setState(e,t,o){if(this.state&&e===this.state.stateName)return;const i=this.state?E[this.state.stateName]:"undefined",n=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===E.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${n?E[e]:i}`,this.logOp.resultDescription=`Previous state: ${i}`,this.logOp.dimension0=`Attempted state: ${E[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!n?"Unexpected state change":""),this.logOp.success=n,a.tG.info(508843791,a.nh.CoreDefault,this.logOp)})),n&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(o))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,o){this.retrySendMessage(e,t,X.maxRetries,o)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){if(this.sendMessage(new k.w9),this.delayBeforeSocketClose)setTimeout((()=>{this.networkWorkerManager.close(!0);const t=e||new k.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new k.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}),100);else{this.networkWorkerManager.close(!0);const t=e||new k.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new k.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}}ingress(e,t){let o;try{o=JSON.parse(e)}catch(e){a.tG.error(508843790,a.nh.CoreDefault,new s.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(o){if(t&&k.YK.typeGuard(o)&&t(o),this.networkWorkerManager.getNetworkMode()===Y.y.HttpFallback&&k.ry.typeGuard(o)){const e=o;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(o,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,o){e&&this.networkWorkerManager.egress(e,o).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(E.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=R.Aq.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,o,i,n){const r=X.maxRetries-o;this.state.sendMessage(e,((l,c)=>{var u,d,h,g;n&&(l&&0==o?(n.success=!1,a.tG.info(507025311,a.nh.CoreDefault,n.stop())):l&&o>0?(n.dimension0=(r+1).toString(),n.dimension1=null!==(u=l.code.toString())&&void 0!==u?u:"NoErrorCode",n.resultSignature=null!==(d=l.error)&&void 0!==d?d:"NoErrorMessage"):(n.success=!0,a.tG.info(507025310,a.nh.CoreDefault,n.stop()))),l&&o>0&&this.canBeRetried(e)&&this.isTransientError(l)?(this.logRetryTelemetry&&!n&&((n=new s.I({operationName:"RetrySendMessage",success:!0,dimension0:r.toString()}).start()).resourceId=S.h.getTypeNameFor(e),n.dimension1=null!==(h=l.code.toString())&&void 0!==h?h:"NoErrorCode",n.resultSignature=null!==(g=l.error)&&void 0!==g?g:"NoErrorMessage",n.resultDescription=`Retrying message with messageId: ${e.messageId}${k.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),S.h.matchesTypesFor(l,[k.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(l),this.retrySendMessage(e,t,o-1,i)):t&&t(l,c)}),r,i)}canBeRetried(e){return!S.h.matchesTypesFor(e,[k.eE.getTypeName(),k.VR.getTypeName(),Z.x5.getTypeName()])}isTransientError(e){const t=e.error;return t!==m.SyncMessageUnsupportedBatch&&t!==m.UnexpectedSeedMessage&&t!==m.UnsupportedSyncMessage&&t!==m.AnnotationTokenNotFound&&t!==_.ArrivedBeforeReseeding&&t!==_.DroppedAsOldestInQueue&&t!==_.DroppedBecauseClientDisconnected}}X.maxRetries=2;var ee=o(8161);class te{}var oe,ie=o(52462),ne=o(62277),re=o(35500);!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(oe||(oe={}));class se{constructor(){this.timers=new Map}scheduleRefresh(e,t,o,i){let n=this.timers.get(e);n||(n={numberOfAttempts:0},this.timers.set(e,n)),n.refreshTimeoutId&&(clearTimeout(n.refreshTimeoutId),n.refreshTimeoutId=void 0),n.expiredTimeoutId&&(clearTimeout(n.expiredTimeoutId),n.expiredTimeoutId=void 0);let r=1e3*t-se.tokenRefreshBufferMs,s=1e3*t-se.tokenExpirationBufferMs;r>0?n.numberOfAttempts=0:(++n.numberOfAttempts,r=se.tokenRefreshBackoffIntervalMs,s=se.tokenExpirationBufferMs),n.numberOfAttempts<=se.tokenRefreshMaximumAttempts&&(n.refreshTimeoutId=setTimeout((()=>{o()}),r)),i&&(n.expiredTimeoutId=setTimeout((()=>{i()}),s))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,o)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(o)}))}}se.tokenRefreshBufferMs=24e4,se.tokenExpirationBufferMs=12e4,se.tokenRefreshBackoffIntervalMs=3e4,se.tokenRefreshMaximumAttempts=3;class ae extends A.EventEmitter{constructor(e,t,o,i,n){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=o,this.sendMessage=i,this.options=n||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=R.Aq.getCurrentTimeMs(),o=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,i=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,n=new s.I({operationName:"SessionInit"}).start(),r={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:o,timeSinceLastSyncMessage:i,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0},l=this.options.overrideSessionInitMessage(new k.eE({protocolVersion:w.mH,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(l,((t,o)=>{if(n.success=!t,n.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",n.resourceId=d(null==o?void 0:o.sliceUrl),n.setClientMetadata(this.clientMetadata),(null==o?void 0:o.sessionKey)&&r.sessionKey!==o.sessionKey&&(r.sessionKey=o.sessionKey),t&&(r.error=t.error),n.resultDescription=JSON.stringify(r),a.tG.info(508843779,a.nh.CoreDefault,n.stop()),e.onResponse(t,o),t)this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&o.forceReconnect)this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);else{if(!o.anonymousToken||!o.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),void a.tG.error(508843778,a.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=o.anonymousToken,this.onSuccessfulSessionInitOnServerSide(o)}}))}onSuccessfulSessionInitOnServerSide(e){this.tokenRefreshManager.scheduleRefresh(oe.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},this.initHostAuthToken();const t=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,t,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows),t&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:re.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new s.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==re.Pu.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",ie.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void a.tG.info(508843777,a.nh.CoreDefault,t.stop());a.tG.info(508843776,a.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,a.tG.error(508843747,a.nh.CoreDefault,t.stop())}))}}sendTokenProvisionMessage(e){const t=new k.kd({authToken:e,version:1});this.emit("serverAuthenticationStateChange",ie.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){if(e||!t||!t.tokenExpirationSeconds)return void this.emit("serverAuthenticationStateChange",ie.f.NotAuthenticated);const o=t.tokenType&&t.tokenType==ne.OY.WacUserInfo?ie.f.WacUserInfoAuthenticated:ie.f.Authenticated;this.emit("serverAuthenticationStateChange",o),this.tokenRefreshManager.scheduleRefresh(oe.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))}}var le,ce=o(95305),ue=o(99050),de=o(20463),he=o(10470),ge=o(54489),pe=o(59925),fe=o(17788),me=o(41416),ve=o(93271),be=o(41125),ye=o(94684),Ce=o(26293),Se=o(19835),we=o(93884),ke=o(72e3),Te=o(47659),xe=o(25091);!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(le||(le={}));class Ie{constructor(e,t,o){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,o)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,o):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,o)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,o):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,o.enableDeltas&&(this.deltaHandlers=(new Map).set(S.h.getTypeNameFor(ke.Q),be.MM).set(S.h.getTypeNameFor(ke.s),be.a4),this.itemsForDelta=new Map),this.enableEarlyJoin=o.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const o=new s.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes((0,we.v)(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),o.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,o)=>{t.push(this.createWorkflowImplementation(e,o))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,o)=>{o.registerContextTypes((0,we.v)(e.requestedContextTypesRules).map((([e,t])=>e))),o.attachToWorkflowGraph(e)}))),o.success=!0,a.tG.info(572838110,a.nh.CoreDefault,o.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const o=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>o.set(e.workflow.id,e.workflow))),o}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,o){const i=e.getWorkflowNodes(),n=this.executionTrackersByWorkflowNameBySession.get(t),r=(e,i)=>{o&&o(e,i),this.enableEarlyJoin&&(()=>{for(const e of this.executionTrackersByWorkflowNameBySession.get(t).values())if(e.graphNode.workflow.kind===pe.wC.Join)for(const t of e.getExecutionState().keys())if(ye.a4.isParentContextId(t,i))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())};for(const e of i){const t=n.get(e.workflow.id),o=new xe.g(e,r.bind(this),t);n.set(e.workflow.id,o)}for(const e of n.values())this.setDownstreamWorkflowExecutionTrackers(e,n),this.setUpstreamWorkflowExecutionTrackers(e,n)}canActivateWorkflow(e,t){var o;return e.location===Ce.aZ.Local||!!t.hasConnected&&!((null===(o=e.workflow.requiredTokenTypes)||void 0===o?void 0:o.length)>0&&t.getServerAuthenticationState()===ie.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:o}=e;for(const i of o.downstreamWorkflows||[]){const o=t.get(i.workflow.id);this.setDownstreamWorkflowExecutionTrackers(o,t),e.downstreamWorkflowExecutionTrackers.add(o)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:o}=e;for(const i of o.upstreamWorkflows||[]){const o=t.get(i.workflow.id);this.setUpstreamWorkflowExecutionTrackers(o,t),e.upstreamWorkflowExecutionTrackers.add(o)}}deactivateServerWorkflow(e,t){var o;e.location!==Ce.aZ.Local&&(null===(o=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===o||o.get(e.workflow.id).clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const o of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(o)),e.attachToWorkflowGraph(o);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,o){const i=this.executionTrackersByWorkflowNameBySession.get(o).get(e.id);e.kind===pe.wC.Join&&S.h.matchesTypesFor(t.body,e.inputTypes)&&i.addInputItemToProcess(t.contextId),(e.kind===pe.wC.SingleItem&&S.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===pe.wC.Join&&S.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&i.beforeWorkflowExecution(t.contextId)}isReadyToEarlyJoin(e,t,o){const i=i=>{var n;const r=Array.from(null!==(n=i.states)&&void 0!==n?n:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),l=new s.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();l.setClientMetadata(o),l.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${i.hasProcessedAllInputItems}, allUpstreamComplete: ${i.allUpstreamComplete}, states: ${r}`,a.tG.info(512550800,a.nh.CoreDefault,l.stop())},n=0===e.countItemsToProcess(t);if(!n)return this.enableEarlyJoin||i({hasProcessedAllInputItems:n}),!1;const{allUpstreamComplete:r,states:l}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?r:(i({hasProcessedAllInputItems:n,allUpstreamComplete:r,states:l}),!1)}areAllUpstreamWorkflowComplete(e,t){const o=new Map;for(const i of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[n,r]of i.getExecutionState())if(e.push([n,r]),ye.a4.isParentContextId(t,n))return o.set(i.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:o};e.length>0&&o.set(i.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:o}}runLocalWorkflows(e,t,o=!1){var i,n,r;const l=(e,o,i)=>{var n,r;const l=t.getWorkflowItemStorage(),{workflow:c}=e,u=null===(n=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===n?void 0:n.get(c.id),d=c.inputTypes.concat(c.kind===pe.wC.Join?c.collectionScopeType:[]),h=new s.I({operationName:"RunLocalWorkflows",success:!0,resourceId:c.id,joinContextId:o.contextId}).start();if(h.setClientMetadata(t.getClientMetadata()),S.h.matchesTypesFor(o.body,d)){const n=(0,Te.CY)(i.parentPath,o);if(c.kind===pe.wC.Join){if(S.h.matchesTypesFor(n.body,[c.collectionScopeType]))return l.setScopeItem(n,c),h.resultDescription=`Scope item: ${o.id} (${S.h.getTypeNameFor(o.body)})`,a.tG.info(524126153,a.nh.CoreDefault,h.stop()),void this.setScopeExecutionNotification(t,e,n,ee.VI.Internal);{u.removeProcessedInputItem(n.contextId);const e=l.getScopeItem(n.contextId,c);if(!e)return h.resultDescription=`Filtered out join invalidation: out of scope type (${c.collectionScopeType}), item id: ${n.id}`,void a.tG.info(541173894,a.nh.CoreDefault,h.stop());l.addItemToWorkflowList(n,c),h.joinContextId=e.contextId,h.resultDescription=`Input item: ${o.id} (${S.h.getTypeNameFor(o.body)})`}}if(S.h.getBaseTypesFor(n.body).indexOf(ce.W1.getTypeName())>=0){const e=[...n.parentPath,n.id];let o=!0;for(const i of null!==(r=c.outputTypes)&&void 0!==r?r:[])if(!t.getContextAnnotations(i,ee.vd.LocalWorkflow,e,c.id)){o=!1;break}if(o)return}const s=()=>{var i;const[r,d]=t.resolveRequestedContexts(c);if(!r)return h.resultDescription=`Required contexts are not ready for ${c.id}. Retrying execution in 500 milliseconds...`,a.tG.info(545837259,a.nh.CoreDefault,h.stop()),void setTimeout(s,500);if(c.kind===pe.wC.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:n,inputItems:[n],requestedContexts:d,session:t,orchestrationMode:ee.VI.Internal,triggerReason:le.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,c,t)}).then((()=>{a.tG.info(509154263,a.nh.WorkflowDefault,h.stop())})).catch((e=>{h.resultDescription=e,a.tG.error(572838111,a.nh.CoreDefault,h.stop())}));else if(c.kind===pe.wC.Join){const n=o.contextId,r=l.getScopeItem(n,e.workflow);if(!r)return h.resultDescription=`No scope item for ${c.id} workflow from contextId ${n}`,void a.tG.info(526758475,a.nh.CoreDefault,h.stop());const s=this.isReadyToEarlyJoin(u,r.contextId,t.getClientMetadata()),g=s?le.JoinEarlyCompletion:le.JoinMaxAnnnotation;if(l.isWorkflowReady(r.contextId,c)||s){if(!(null===(i=this.pendingScopeExecutionNotificationsByWorkflow.get(c.id))||void 0===i?void 0:i.get(r.contextId)))return h.resultDescription=`Workflow ${c.id}, contextId ${r.contextId}, already queued, skipping new scope execution`,void a.tG.info(528048977,a.nh.CoreDefault,h.stop());const o=l.getItemsToExecute(r.contextId,c);this.queueWorkflow({workflowInfo:e,scopeItem:r,inputItems:o,requestedContexts:d,session:t,orchestrationMode:ee.VI.Internal,triggerReason:g,onCompleteCallback:this.onWorkflowExecuted.bind(this,r,c,t)}).then((()=>{a.tG.info(509154262,a.nh.WorkflowDefault,h.stop())})).catch((e=>{h.resultDescription=e,a.tG.error(541173895,a.nh.CoreDefault,h.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(c.id).delete(r.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(c.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(c.id)}}};s()}};let c=e;o&&(c=[new ue.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new ce.hD}]}),new ue.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new ce.SB}]})],t.getContextIdManager().applyContextIdOnOperations(c),c=c.concat(e));for(const e of c){const o=S.h.getTypeNameFor(e);for(const s of e.items)if(t.applyOperationForContext(e,s,ee.vd.Submitted),o!==ue.n4.getTypeName()){if(s.body)if(o===ue.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(s,e,t);else{null===(n=this.itemsForDelta)||void 0===n||n.set(e.parentPath.concat(s.id).toString(),s);for(const t of this.workflowsWithoutSessionAffinity)l(t,s,e);for(const o of null!==(r=this.workflowsWithSessionAffinity.get(t))&&void 0!==r?r:[])l(o,s,e)}}else null===(i=this.itemsForDelta)||void 0===i||i.delete(e.parentPath.concat(s.id).toString())}}handleLocalDeltaUpdate(e,t,o){const i=new s.I({operationName:"LocalDeltaUpdate",dimension0:S.h.getTypeNameFor(e.body),success:!0});i.start();try{const n=this.deltaHandlers.get(S.h.getTypeNameFor(e.body)),r=this.itemsForDelta.get(t.parentPath.toString());if(n&&r){const s=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,l=n(e.body,r.body);if(l){const t={id:r.id,revId:e.revId,body:l,parentPath:s,delta:e.body,contextId:e.contextId},n=new ue.I({parentPath:t.parentPath,items:[t]});a.tG.info(539637591,a.nh.CoreDefault,i.stop()),this.runLocalWorkflows([n],o)}else i.success=!1,i.resultDescription="Failed because the handler did not produce valid updated item",a.tG.info(539637592,a.nh.CoreDefault,i.stop())}else i.success=!1,i.resultDescription="Failed due to lack of handler or parent item",a.tG.info(539637593,a.nh.CoreDefault,i.stop())}catch(e){i.success=!1,i.resultDescription=`Failed to apply delta, error: ${e}`,a.tG.info(539637594,a.nh.CoreDefault,i.stop())}}createWorkflowImplementation(e,t){const o=e.factory();return{workflow:e,workflowLambda:o,initPromise:this.initWorkflow(e.kind,o,t)}}initWorkflow(e,t,o){const i=new Se.I({model:void 0,clientMetadata:o?o.getClientMetadata():void 0,userContext:o?o.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===pe.wC.SingleItem||e===pe.wC.Join?t.init(this.site,i):Promise.resolve()}queueWorkflow(e){return this.executionTrackersByWorkflowNameBySession.get(e.session).get(e.workflowInfo.workflow.id).setExecutionState(e.scopeItem.contextId,ye.si.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.orchestrationMode,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const o of e)t.onAnnotationResults(o,ee.vd.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,o,i,n,r,l){return new Promise(((c,u)=>{var d,h,g;const p=[],f=e.workflow,m=new s.I({operationName:"ExecuteWorkflow",resourceId:f.id,joinContextId:null!==(d=null==t?void 0:t.contextId)&&void 0!==d?d:"",resultDescription:null!=l?l:"",success:!0}).setClientMetadata(i.getClientMetadata());m.start();const v=null!==(h=null==t?void 0:t.contextId)&&void 0!==h?h:o[0].contextId,b=null!==(g=null==t?void 0:t.revId)&&void 0!==g?g:o[0].revId,y=(()=>{const e=new Map;if(t&&(t.parentPath||a.tG.error(525382231,a.nh.CoreDefault,`Missing scope item parent. Workflow: ${f.id}. Type: ${S.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(o))for(const t of o)t&&t.body&&(t.parentPath||a.tG.error(525382232,a.nh.CoreDefault,`Missing parent. Workflow: ${f.id}. Type: ${S.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),C=(e,t=m)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",a.tG.error(572838112,a.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;a.tG.info(572838113,a.nh.CoreDefault,t.stop())},w=new Se.I({model:new ve.B(o[0],n),clientMetadata:i.getClientMetadata(),userContext:i.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),T=e=>{C(e?e.message:void 0),e?u(e):c(p)},x={setAnnotations:(n,l,c,d)=>{var h;const g=new s.I({operationName:"SetAnnotations",resourceId:l,joinContextId:null!==(h=null==t?void 0:t.contextId)&&void 0!==h?h:"",success:!0}).setClientMetadata(i.getClientMetadata());g.start();const m=t=>{a.tG.info(555866112,a.nh.CoreDefault,new me.v({annotationType:l,annotationState:t,workflowId:e.workflow.id}))};for(const e of c)e.metadata=Object.assign(Object.assign({},e.metadata),{state:de.r.Created}),m(de.r.Created);const w=y.get(n),T=S.h.getTypeNameFor(w.body),x=(()=>{var e;if(f.kind===pe.wC.SingleItem&&o[0].body!==n){const e=`Expected obj to be ${o[0].body} but instead it was ${n}`;return C(e,g),void u(C(e))}let t,s;if(Array.isArray(c))if(!f.outputTypes||f.outputTypes.indexOf(l)<0)t=`Workflow said it would output one of [${f.outputTypes}] but instead output ${l}`;else if(w)for(const e of c)S.h.matchesTypesFor(e,[he.YH.getTypeName()])?S.h.getTypeNameFor(e)!==l&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${S.h.getTypeNameFor(e)} did not match expected ${l})`):t=`Workflow produced an output that is not an annotation ${S.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return C(t,g),void u(C(t));if(s=d&&d.isSessionAnnotation?["session"]:d&&d.ancestorType?w.parentPath:w.parentPath.concat(w.id),r===ee.VI.External)return;const h=[],p=[];for(const t of c){t.metadata=Object.assign(Object.assign({},t.metadata),{state:de.r.Sent}),m(de.r.Sent);const o=t.id,n=o?null===(e=i.getContextAnnotations(l,ee.vd.LocalWorkflow,s,f.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==o})):void 0;1==(null==n?void 0:n.length)?1==n.length?p.push({id:n[0].id,source:f.id,revId:b,body:t,contextId:v}):a.tG.error(545837260,a.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${o} found for ${l} and local workflow ${f.id}).`):h.push({id:this.getNextClientAnnotationId(),source:f.id,revId:b,body:t,contextId:v})}const y=[];return h.length>0&&y.push(new ue.Xr({parentPath:s,items:h,parentRevId:b})),p.length>0&&y.push(new ue.fZ({parentPath:s,items:p,parentRevId:b})),new k.B_({annotationType:l,ops:y})})();x?(d&&d.immediate?i.onAnnotationResults(x,ee.vd.LocalWorkflow,(()=>{})):p.push(x),(T==ce.hD.getTypeName()||T==ce.SB.getTypeName()||S.h.matchesTypesFor(w.body,[ce.yo.getTypeName(),ce.I3.getTypeName()]))&&i.submitOperationsToSession(x.ops),a.tG.info(509644822,a.nh.CoreDefault,g.stop())):a.tG.info(509644823,a.nh.CoreDefault,g.stop())},submitSignals:e=>{if(r===ee.VI.External)return void u(C("NYI"));const t=new s.I({operationName:"submitSignalsAction",resourceId:f.id,success:!0}).setClientMetadata(i.getClientMetadata());for(const o of e){const e=S.h.getTypeNameFor(o);S.h.matchesTypesFor(o,[ge.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${S.h.getTypeNameFor(o)})`,a.tG.info(521413954,a.nh.CoreDefault,t)),f.outputTypes&&-1!==f.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${f.outputTypes}] but instead output ${e}`,a.tG.info(521413953,a.nh.CoreDefault,t)),o.timestamp&&(Ie.logTimestampUsageByWorkflowId.has(f.id)||(Ie.logTimestampUsageByWorkflowId.add(f.id),t.resultDescription=`Workflow "${f.id}" sets signal.timeStamp`,a.tG.info(509212803,a.nh.CoreDefault,t)))}const o=e.map((e=>({id:this.getNextClientSignalId(),source:f.id,revId:b,body:e,contextId:v}))),n=new ue.g0({parentPath:["session"],parentRevId:b,items:o});i.submitOperations([n])},done:T,overrideWorkflowDefinition:(e,o,n)=>{let r;switch(n){case fe.T.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw a.tG.error(527472289,a.nh.CoreDefault,e),new Error(e)}r=t.contextId;break;case fe.T.Session:r=void 0;break;default:{const e="Defined scope is not supported. "+n;throw a.tG.error(527472290,a.nh.CoreDefault,e),new Error(e)}}const s=new Z.Qr({definition:o,contextId:r,sourceWorkflowId:f.id,targetWorkflowId:e});i.onWorkflowDefinitionOverrideMessage(s)},getDynamicAnnotations:void 0,setBillingDomain:void 0},I=e.workflowLambda;if(f.kind===pe.wC.SingleItem){1!==o.length&&T(new Error("Single item workflows expect a single input")),w.delta=o[0].delta,w.deltas=o[0].deltas;try{const t=I;e.initPromise||(e.initPromise=t.init(this.site,w)),e.initPromise.then((()=>{t.execute(o[0].body,w,x)})).catch((e=>{C(e)}))}catch(e){C(e)}}else if(f.kind===pe.wC.Join){0===o.length&&T(new Error("Join workflows expect an inputs array")),w.delta=t.delta,w.deltas=t.deltas;try{const i=I;e.initPromise||(e.initPromise=i.init(this.site,w)),e.initPromise.then((()=>{i.execute(t.body,o.map((e=>e.body)),w,x)})).catch((e=>{C(e)}))}catch(e){C(e)}}else C(`Workflow kind ${f.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,o,i){var n,r;const l=Date.now(),c={session:e,workflowImplementation:t,scopeItem:o,startTime:l,minTime:l+(0,R.ZF)(t.workflow.minDelayMs,1e3),maxTime:l+(0,R.ZF)(t.workflow.maxDelayMs,5e3),orchestrationMode:i},u=t.workflow.kind===pe.wC.Join?o.contextId:c.scopeItem.parentPath.concat(o.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(u)){const i=new s.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(r=null==o?void 0:o.contextId)&&void 0!==r?r:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();a.tG.info(509727899,a.nh.CoreDefault,i.stop())}else{const i=new s.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${u}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(n=null==o?void 0:o.contextId)&&void 0!==n?n:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();a.tG.info(539883075,a.nh.CoreDefault,i.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(u,c)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const o=new Set(Array.from(this.sweepTimers.keys()));for(const[i,n]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[r,l]of Array.from(n.entries())){const{session:n,workflowImplementation:{workflow:c},orchestrationMode:u}=l,d=n.getWorkflowItemStorage(),h=new s.I({operationName:"LocalScopeExecutionNotification",resourceId:c.id,joinContextId:null!==(t=null===(e=l.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(n.getClientMetadata()).start(),g=()=>{if(c.kind===pe.wC.Join){const e=Date.now(),{workflow:t}=l.workflowImplementation,o=l.scopeItem.contextId,i=n.getWorkflowDefinition(t,o).maxDelayMs;return d.isWorkflowReady(o,t)?(h.resultDescription=`Join Workflow: ${t.id} queuing by maxAnnotation, contextId: ${o}`,a.tG.info(528048978,a.nh.CoreDefault,h.stop()),{isValid:!0,triggerReason:le.JoinMaxAnnnotation}):l.startTime+i<e?(h.resultDescription=`Join Workflow: ${t.id} queuing by maxTimeout, contextId: ${o}`,a.tG.info(528048979,a.nh.CoreDefault,h.stop()),{isValid:!0,triggerReason:le.JoinMaxTimeout}):this.isReadyToEarlyJoin(this.executionTrackersByWorkflowNameBySession.get(n).get(t.id),o,n.getClientMetadata())?(a.tG.info(512550856,a.nh.CoreDefault,`Workflow: ${t.id} queuing by early completion, contextId: ${o}, timeout: ${i}`),{isValid:!0,triggerReason:le.JoinEarlyCompletion}):{isValid:!1,triggerReason:le.Unknown}}return{isValid:!0,triggerReason:le.Unknown}};(()=>{const{isValid:e,triggerReason:t}=g();if(!e)return!1;const[o,i]=n.resolveRequestedContexts(c);if(!o)return!1;try{if(c.kind===pe.wC.Join){const e=l.scopeItem.contextId,o=d.getScopeItem(e,c);if(o){const r=d.getItemsToExecute(o.contextId,c);if(0===r.length)return h.resultDescription=`Failed to retrieve items for workflow: ${c.id}, contextId: ${e}, skipping execution`,a.tG.info(527472291,a.nh.CoreDefault,h.stop()),this.onWorkflowExecuted(o,c,n),!0;this.queueWorkflow({workflowInfo:l.workflowImplementation,scopeItem:o,inputItems:r,requestedContexts:i,session:n,orchestrationMode:u,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,o,c,n)}).catch((e=>{h.success=!1,h.resultDescription=e.message,a.tG.error(509092189,a.nh.CoreDefault,h.stop())}))}else h.resultDescription="ContextId no longer exists, skipping workflow execution",a.tG.info(539883076,a.nh.CoreDefault,h.stop())}else h.resultDescription=`Workflow in type ${c.kind} is not supported`,a.tG.error(539883077,a.nh.CoreDefault,h.stop())}catch(e){h.resultDescription=`Trying to execute ${c.id} caused an exception: ${e}`,a.tG.warn(539883078,a.nh.CoreDefault,h.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(i).delete(r),0===this.pendingScopeExecutionNotificationsByWorkflow.get(i).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(i)):o.delete(n)}if(0!==o.size)for(const e of Array.from(o)){const t=new s.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();a.tG.debug(539883079,a.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,o){const i={id:"",parentPath:[],contextId:e},n={id:t};this.onWorkflowExecuted(i,n,o,!1)}onWorkflowExecuted(e,t,o,i=!0){var n;null===(n=this.executionTrackersByWorkflowNameBySession.get(o).get(t.id))||void 0===n||n.afterWorkflowExecution(e.contextId),i&&t.kind===pe.wC.Join&&o.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}var _e=o(16833),Ee=o(76722);class Ae{constructor(e,t,o){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new _e.Z,this.unorderedAnnotationResultsProcessor=null!=o?o:new Ee._}process(e,t,o,i){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,o,i):this.unorderedAnnotationResultsProcessor.process(e,t,o,i)}}var Re=o(34251),Be=o(52008),Me=o(84921),De=o(88484);class Oe{constructor(e){this.hostCallbacks=e}isFeatureEnabled(e,t=!1,o="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,o).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){return this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled?this.hostCallbacks.isChangeGateEnabled(e):Promise.resolve(!1)}}class Fe{constructor(e,t,o){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,checkIdbByFeatures:!0,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,httpFallbackEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,dynamicRateControllerEnabled:!1,removeDuplicateFlights:!0,delayBeforeSocketClose:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,startQueueProcessingInOpen:!0},this.isDownloaderCompatible=()=>{if(this.settings.checkIdbByFeatures)return"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL;if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;return!(!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0)}return!1},this.workerFactory=e||(e=>e&&e===Y.y.HttpFallback?new De.Z:new f);const i=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||i(...e),this.sessionFactory=o||(e=>new ee.po(e))}init(e,t,i,n){var l,u,g,p,f,m,v,b,y,C;const S=new s.I({operationName:"InitRuntime",resourceId:d(e),dimension1:this.hasBeenInitialized.toString()});S.start(),this.hasBeenInitialized=!0,this.hostCallbacks=i,this.gateUtils=new Oe(this.hostCallbacks),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=o(65787).r),this.telemetryLogger=new h(this.hostCallbacks),this.shouldAddLogger(S)?(a.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(n)):(a.tG.clearLoggers(),a.tG.addLogger(this.telemetryLogger)),Fe.haveCalledInit=!0,this.annotationResultsProcessor=new Ae((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=n.inferenceServiceFactory,S.dimension2=(0,a.OD)(r.q.info).toString();const w=[];e&&(this.defaultServiceUrl=R.Aq.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),w.push(R.Aq.isChangeGateEnabled(this.hostCallbacks,"CheckIdbByFeatures").then((e=>{this.settings.checkIdbByFeatures=e}))),w.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),w.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),w.push(this.isFeatureEnabled("HttpFallbackEnabled").then((e=>{var t;(t=this.settings).httpFallbackEnabled||(t.httpFallbackEnabled=e)}))),w.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),w.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),w.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),w.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),w.push(this.isFeatureEnabled("DynamicRateControllerEnabled").then((e=>{this.settings.dynamicRateControllerEnabled=e}))),w.push(R.Aq.isChangeGateEnabled(this.hostCallbacks,"DelayBeforeSocketClose").then((e=>{this.settings.delayBeforeSocketClose=e}))),w.push(R.Aq.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),w.push(R.Aq.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),w.push(R.Aq.isChangeGateEnabled(this.hostCallbacks,"StartQueueProcessingInOpen").then((e=>{var t;(t=this.settings).startQueueProcessingInOpen||(t.startQueueProcessingInOpen=e)})));const k={enableDeltas:!1,enableEarlyJoin:!1};w.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>k.enableDeltas=e)).catch((()=>k.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>k.enableEarlyJoin=e)).catch((()=>k.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new Ie(n.modelDownloader&&this.isDownloaderCompatible()?n.modelDownloader:void 0,this.inferenceServiceFactory,k)})));const T=(0,Me.Vh)(null!==(l=t.flights)&&void 0!==l?l:"");var x;return this.isDeltaGeneratorEnabled=T.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(u=n.isDeltaGeneratorEnabled)&&void 0!==u&&u),this.disableSyncDeltaSending=T.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(g=n.disableSyncDeltaSending)&&void 0!==g&&g),this.syncDeltaTimeout=T.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",n.syncDeltaTimeout),(p=this.settings).httpFallbackEnabled||(p.httpFallbackEnabled=T.getBooleanValue("HttpFallbackEnabled",!1)),(f=this.settings).defaultBatchingEnabled&&(f.defaultBatchingEnabled=!T.getBooleanValue("DefaultBatchingDisabled",!1)),(m=this.settings).batchingWith20msIntervalEnabled&&(m.batchingWith20msIntervalEnabled=!T.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(v=this.settings).reduceBatchOperationsEnabled||(v.reduceBatchOperationsEnabled=T.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(b=this.settings).batchMessagesEnabled||(b.batchMessagesEnabled=T.getBooleanValue("BatchMessagesEnabled",!1)),(y=this.settings).removeDuplicateFlights&&(y.removeDuplicateFlights=T.getBooleanValue("RemoveDuplicateFlights",!0)),(C=this.settings).reducedPingPongRetryEnabled||(C.reducedPingPongRetryEnabled=T.getBooleanValue("ReducedPingPongRetryEnabled",!1)),S.setDataField("Flights",JSON.stringify(this.settings)),n&&n.loggableUrls&&(x=n.loggableUrls,c.push(...x)),Promise.all(w).then((()=>{this.batchOptions=n.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),n&&n.networkMode&&(n.networkMode===Y.y.HttpFallback&&(n.networkMode=this.settings.httpFallbackEnabled?Y.y.HttpFallback:Y.y.JSWebSockets),this.networkMode=n.networkMode,n.networkMode===Y.y.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new Re.t)),S.dimension0=JSON.stringify(this.batchOptions),this.logOperation(S,!0)})).catch((e=>{this.logOperation(S,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){a.tG.flushAggregators(e)}createSession(e){var t;const o=e&&e.docSessionId?e.docSessionId:(0,Be.v4)(),i=e&&e.documentId?e.documentId:void 0,n=this.sessionsByDocSessionId.get(o),r=new s.I({operationName:"CreateSession",resourceId:o,dimension1:this.hasBeenInitialized.toString()});if(r.start(),n&&!1===n.isClosed)throw this.logOperation(r,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let a=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;a=R.Aq.convertServiceUrlToWebSocket(a),a||((e=e||{}).networkMode=Y.y.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==Y.y.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=Y.y.HttpFallback),e&&e.networkMode===Y.y.HttpFallback&&(e.networkMode=this.settings.httpFallbackEnabled?Y.y.HttpFallback:Y.y.JSWebSockets);const l=Object.assign({},this.clientMetadata);l.docSessionId=o,i&&(l.documentId=i),e&&e.flights&&(l.flights=l.flights?l.flights+";"+e.flights:e.flights),this.settings.removeDuplicateFlights&&l.flights&&(l.flights=(0,Me.JU)(l.flights)),r.setDataField("Flights",l.flights||"");const c=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(l,a,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:l,userContext:e?e.userContext:void 0,localWorkflowManager:e&&e.enableComplexLocalWorkflows?void 0:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService});return this.sessionsByDocSessionId.set(o,c),e&&e.onSessionConnect&&c.setConnectCallback(e.onSessionConnect),e&&e.onSessionDisconnect&&c.setDisconnectCallback(e.onSessionDisconnect),e&&e.onSessionReconnect&&c.setReconnectCallback(e.onSessionReconnect),e&&e.onSessionClose&&c.setSessionCloseCallback(e.onSessionClose),e&&e.onServerAuthenticationStateChangeCallback&&c.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e&&e.onClaimsChallengeCallback&&c.setClaimsChallengeCallback(e.onClaimsChallengeCallback),this.logOperation(r,!0),c.initialize?c.initialize():Promise.resolve(c)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(Fe.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,a.OD)(r.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,o)=>{if(o&&o.enableComplexLocalWorkflows)throw new Error("NYI");if(o&&o.networkMode==Y.y.LocalWorkflowsOnly)return new Re.t;const i=new se,n=new te;let r=()=>{a.tG.error(573321615,a.nh.CoreDefault,"Unexpectedly not set sendMessage")};const s=new ae((()=>n),e,i,((e,t,o)=>{r(e,t,o)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==o?void 0:o.enableRemoteExecutionNotification)||!1}),l=new X(R.Aq.convertServiceUrlToWebSocket(t),n,this.workerFactory,s,e,i,this.settings,this.gateUtils,null==o?void 0:o.networkMode);return r=l.sendMessage.bind(l),l.on("disconnect",(()=>i.clearRefreshTimeouts())),l.on("connect",((e,t,o,i)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,o,i);const n=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(n)})),l}}isFeatureEnabled(e,t=!1,o="None"){return R.Aq.isFeatureEnabled(this.hostCallbacks,e,t,o)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,o,i){e.stop(),e.success=t,e.resultSignature=o,e.resultDescription=i,a.tG.info(573321622,a.nh.CoreDefault,e)}addLoggingAggregator(e){var t,o,i,n;R.Aq.isChangeGateEnabled(this.hostCallbacks,"AggregateInProductionOnly")&&"Dogfood"===this.clientMetadata.releaseAudienceGroup||(a.tG.addAggregator(u("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet","NetworkRateControllerQueueItem"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),a.tG.addAggregator(u("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:60)),a.tG.addAggregator(u("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(i=e.telemetryAggregationIntervalSec)&&void 0!==i?i:120)),a.tG.addAggregator(u("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)))}uninitialize(){this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,Fe.haveCalledInit=!1,a.tG.clearAggregators(),a.tG.clearLoggers()}}new Fe;const Pe=()=>new Fe},8161:(e,t,o)=>{"use strict";if(o.d(t,{VI:()=>j,po:()=>W,vd:()=>L}),3023==o.j)var i=o(52462);if(3023==o.j)var n=o(3687);if(3023==o.j)var r=o(88154);if(3023==o.j)var s=o(51917);if(3023==o.j)var a=o(48028);if(3023==o.j)var l=o(99050);if(3023==o.j)var c=o(86997);if(3023==o.j)var u=o(92068);if(3023==o.j)var d=o(10470);if(3023==o.j)var h=o(58051);if(3023==o.j)var g=o(35500);if(3023==o.j)var p=o(4485);if(3023==o.j)var f=o(39254);if(3023==o.j)var m=o(62277);if(3023==o.j)var v=o(59925);if(3023==o.j)var b=o(38086);if(3023==o.j)var y=o(91432);if(3023==o.j)var C=o(5629);if(3023==o.j)var S=o(43241);if(3023==o.j)var w=o(93884);if(3023==o.j)var k=o(47659);if(3023==o.j)var T=o(26293);if(3023==o.j)var x=o(65726);if(3023==o.j)var I=o(94684);if(3023==o.j)var _=o(43854);if(3023==o.j)var E=o(50524);if(3023==o.j)var A=o(35051);if(3023==o.j)var R=o(52579);if(3023==o.j)var B=o(16865);if(3023==o.j)var M=o(90628);if(3023==o.j)var D=o(72e3);if(3023==o.j)var O=o(52008);if(3023==o.j)var F=o(168);if(3023==o.j)var P=o(82109);if(3023==o.j)var N=o(34251);var L,j,q=function(e){return this instanceof q?(this.v=e,this):new q(e)};!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(L||(L={})),function(e){e[e.Internal=0]="Internal",e[e.External=1]="External"}(j||(j={}));const H=(e,t)=>{t?(e.resultDescription=t,e.success=!1,y.tG.error(509203144,y.nh.CoreDefault,e.stop())):y.tG.info(509203143,y.nh.CoreDefault,e.stop())},z=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class W{constructor(e){var t;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=i.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new T.Q$,this.workflowDefinitionManager=new x.h,this.contextIdManager=new I.a4(A.x.JsClient,this.workflowGraph),this.workflowItemStorage=new _.e(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.batchMessagesEnabled=!1,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,e.workflowRuntimeFactory&&(this.workflowRuntime=e.workflowRuntimeFactory(this.sessionManager)),this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(n.B_.getTypeName(),this.workflowRuntime?this.onAnnotationResultsFromLocal.bind(this):this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(n.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(n.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(n.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new C.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===T.aZ.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,y.tG.info(508879493,y.nh.CoreDefault,e.stop())}}initialize(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress).then((()=>(this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this)))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length){if(this.workflowRuntime)for(const t of e)this.workflowRuntime.registerWorkflow(t),this.sendMessageToSession(new s.Et({workflowDefinition:t}));if(this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new C.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();H(t)}activateAnnotation(e,t,o){var i;const n=new p.g(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),r=(t,o)=>{let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n.token,o)};(null==t?void 0:t.callback)&&r(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&r(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const s=null!==(i=this.tokensByAnnotationType.get(e))&&void 0!==i?i:[];return-1===s.indexOf(n.token)&&s.push(n.token),this.tokensByAnnotationType.set(e,s),this.annotationActivationTrackers.set(n.token,n),this.activateAnnotationForTracker(n,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateAnnotationForTracker(e,t){const o=new C.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((i=>(o.resultSignature="Ok",o.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,H(o),i))).catch((i=>{throw H(o,`error on activate annotation type ${e.annotationType}: ${i}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),i}))}updateAnnotationConfig(e,t){const o=new n.Ol({token:e,config:t});this.sendMessageToSession(o);const i=this.annotationActivationTrackers.get(e);i&&i.options&&(i.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const o=o=>{const i=o.get(t.annotationType);i&&(i.delete(e),0==i.size&&o.delete(t.annotationType))};return o(this.annotationCallbacks),o(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,o){const i={state:o};this.submitOperation(new l.XP({parentPath:e,items:[{id:t}],M_:i}))}setAnnotationMetadata(e,t,o){this.submitOperation(new l.XP({parentPath:e,items:[{id:t}],M_:o}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var o,i;if(t||(t=this.generateCorrelationId()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[o,i]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,t)}const n=e.filter(this.filterOperationsForSession.bind(this)).filter(z);if(this.workflowRuntime){if(this.onAnnotationsSubmittedEnabled){const[e,o]=this.partitionAnnotationOperations(n);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(o,t)}else this.submitOperationsToSession(n,t);return}const r=[];if(this.deltaGenerator){const e=new C.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of n)if(l.fZ.typeGuard(e))r.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const n of t.items)l.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(n,t.parentPath):l.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(n,t.parentPath):l.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(i=null===(o=e.items)||void 0===o?void 0:o.map((e=>e.id)))&&void 0!==i?i:[]);r.push(e)}H(e)}if(this.onAnnotationsSubmittedEnabled){const[e,o]=this.partitionAnnotationOperations(r.length?r:n);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(o,t)}else this.submitOperationsToSession(r.length?r:n,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===a.y.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[o,i]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,t):this.executeCallbacksOnAnnotationSubmitted(o,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?i:e,!0,t):this.sendMessageToSession(new n.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?i:e}))}submitSeedGroupOperations(e,t,o){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===a.y.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);o||(o=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[i,r]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(i,o),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(i,o):this.executeCallbacksOnAnnotationSubmitted(i,o),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?r:e,!!t,o):(this.seedGroupSize++,this.sendMessageToSession(new n.Tb({cv:o,seq:0,ops:this.onAnnotationsSubmittedEnabled?r:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,o)=>{this.sendMessageToSession(e,((i,n)=>{i?o(new Error(`${i.error}; for message type: ${c.h.getTypeNameFor(e)}`)):t(n)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,o)=>{this.sendMessageToSessionPostEndpoint(e,((e,i)=>{e?o(new Error(e.error)):t(i)}))}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==u.J1.None?new Promise(((t,o)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,i)=>{e?o(e):t(i)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new n.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.workflowRuntime&&this.workflowRuntime.close(),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(){return e=this,t=void 0,i=function*(){if(this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const e=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(n.D0.typeGuard(e))throw new Error(e.reason)},new((o=void 0)||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}));var e,t,o,i}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new N.t}onAnnotationResults(e,t,o){y.tG.info(508916486,y.nh.CoreDefault,new C.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),o(void 0,new n.YK),t===L.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,o)=>{this.applyOperationForContext(e,o,t)}),((t,o)=>{this.triggerRegisteredAnnotationCallbacks(t,e.annotationType,o,e.areApologies)}),(e=>{if(t!==L.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(z);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var o;t(void 0,new n.YK);for(const t of e.updates){const{annotationType:e,state:i}=t;if(!this.tokensByAnnotationType.has(e))continue;let n;n=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):i===r.K7.Idle?r.K7.Pending:r.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(o=e.options)||void 0===o?void 0:o.stateUpdateCallback)&&e.options.stateUpdateCallback(n,i)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const o=e.filter((e=>l.g0.typeGuard(e))),i=e.filter((e=>!l.g0.typeGuard(e)));if(o.length>0&&this.sendMessageToSession(new n.Tb({cv:t,ops:o})),i.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,o)=>{if(e.length){const t=new n.l0;t.messages=[],e.forEach((e=>{t.messages.push(new n.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{o(e?new Error(e.error):void 0)}))}}:(e,t,o)=>{this.sendMessageToSession(new n.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{o(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new f.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled)}this.batchedOperationsManager.addBatchItem(i,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new n.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:i}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),n.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const o=new C.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,P.A)(this.connectParams,e,o,t);else{const i=(i=>(0,P.A)(i,e,o,t)).bind(this);this.pendingConnectCallbacks.push(i)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const o=new C.I({operationName:"RequestBinaryData",success:!0,cv:(new S.W).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,P.Z)(this.connectParams,e,t,o);else{const i=(i=>(0,P.Z)(i,e,t,o)).bind(this);this.pendingConnectCallbacks.push(i)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,o){let i=c.h.getTypeNameFor(e);if(i!=l.Xr.getTypeName()&&i!=l.I.getTypeName()&&i!=l.fZ.getTypeName()&&i!=l.n4.getTypeName())return;i==l.I.getTypeName()&&(i=l.Xr.getTypeName());const n=(0,k.CY)(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),r=(0,k.M6)(n.parentPath);if(i==l.Xr.getTypeName()||i==l.fZ.getTypeName()){if(!n.body)return;const e=c.h.getTypeNameFor(n.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let s=t.get(o);if(s||(s=[],t.set(o,s)),!n.id){if(this.workflowRuntime)throw new Error("Expected item to have id already");this.localWorkflowManager&&(n.id=this.localWorkflowManager.getNextClientAnnotationId())}if(i==l.Xr.getTypeName())0==s.filter((e=>(0,k.M6)(e.parentPath)==r&&e.id==n.id)).length?s.push(n):y.tG.info(540848911,y.nh.CoreDefault,`AddOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<s.length;e++)if(s[e].id==n.id&&(0,k.M6)(s[e].parentPath)==r){if(s[e].source==n.source){s[e]=n;break}y.tG.warn(540848912,y.nh.CoreDefault,`UpdateOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with provided path and ID has different source: ${s[e].source}`)}else y.tG.warn(540848913,y.nh.CoreDefault,`UpdateOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(i==l.n4.getTypeName()){if(!n.id)return;this.availableContexts.forEach(((e,t)=>{let i=e.get(o);i&&(i=i.filter((e=>!((0,k.M6)(e.parentPath)==r&&e.id==n.id))),0==i.length?e.delete(o):e.set(o,i),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const o of e)if(I.gu.has(c.h.getTypeNameFor(o)))for(const e of o.items)for(const o of t||[])this.localWorkflowManager.preProcessItemToWorkflow(o,e,this)}}resolveRequestedContexts(e){const t=[];for(const[o,i,n]of(0,w.v)(e.requestedContextTypesRules)){if(!this.availableContexts.has(o)){if(i==v.in.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(o).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${o} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,o)=>o.findIndex((t=>b.Aq.deepEquals(t,e)))===t))}getContextAnnotations(e,t,o,i){var n,r;const s=o?(0,k.M6)(o):void 0;return null===(r=null===(n=this.availableContexts.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.filter((e=>!(s&&(0,k.M6)(e.parentPath)!=s||i&&e.source!=i)))}onWorkflowDefinitionOverrideMessage(e){const t=new C.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),o=e=>{throw H(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void o("Not supported by this local SessionProxy instance.");const i=this.localWorkflowManager.getWorkflowDefinitionsByName(this),n=i.get(e.sourceWorkflowId);if(!n)return void o(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=n.id;const r=i.get(e.targetWorkflowId);r&&(r.allowDefinitionOverride?n.definitionOverrideTargetWorkflows&&-1!==n.definitionOverrideTargetWorkflows.indexOf(r.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(r,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,H(t)):o(`Workflow '${n.id}' does not allow workflow definition for workflow '${r.id}'.`):o(`Workflow '${r.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,o,i){if(this.callAnnotationCallbacks(e,t,o,i),this.hostCallbacks.onAnnotationResult)try{i?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,o):this.hostCallbacks.onAnnotationResult(e,o)}catch(e){y.tG.error(540301151,y.nh.CoreDefault,new C.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new n.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new R.U,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,o;const i=[];y.tG.info(523776396,y.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(o=e.items)||void 0===o?void 0:o.length)>0?e.items[0].id:"(no items)"})`);let n=[...e.parentPath];for(const t of e.items){const o=[],r=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==r?void 0:r.length){for(const i of r){const r=(0,O.v4)();n=[...e.parentPath,t.id];const s={id:r,revId:t.revId,body:i,contextId:t.contextId,source:t.source};o.push(s)}o.length>0&&(i.push(new l.xU({parentPath:n,items:o})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,n,o))}else y.tG.info(523329632,y.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return i}setupSyncDeltaAfterDelay(e,t,o){var i,n,r;const s=this.syncDeltaTimers.get(e.id);s&&(clearTimeout(s),this.syncDeltaTimers.delete(e.id));const a=o.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===B.OD.Chars}));if(a){const o=a.body,s={content:"",deltaType:B.WI.Update,length:0,position:(null!==(i=null==o?void 0:o.position)&&void 0!==i?i:0)+(null!==(r=null===(n=null==o?void 0:o.content)||void 0===n?void 0:n.length)&&void 0!==r?r:0),unit:B.OD.Sentence},c=M.Cg.typeGuard(e.body)?new D.s(s):new D.Q(s),u={id:(0,O.v4)(),revId:e.revId,body:c,contextId:e.contextId,source:e.source},d=new l.xU({parentPath:t,items:[u]}),h=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,d,e.id);this.syncDeltaTimers.set(e.id,h)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow((0,E._$)(e))}getAnnotations(e,t){var o,i,n;const a=new C.I({operationName:"GetAnnotations",success:!0,dimension1:null===(o=e.annotationType)||void 0===o?void 0:o.toString(),dimension2:null===(i=e.maxDelayMs)||void 0===i?void 0:i.toString(),cv:e.cv}).setClientMetadata(this.clientMetadata).start(),l=this.sessionManager.getCorrelationVector(),c=new s.x5({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:null!==(n=e.cv)&&void 0!==n?n:l.newChild().toString()}}),u=[];let d;this.sendMessageToSession(c,((e,t)=>{u.push({error:e,response:t}),null==d||d(!0)}));const h=this;let g=!1;return{[Symbol.asyncIterator](){var e,o,i,n;return function(e,t,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=o.apply(e,t||[]),r=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise((function(o,i){r.push([e,t,o,i])>1||a(e,t)}))})}function a(e,t){try{(o=n[e](t)).value instanceof q?Promise.resolve(o.value.v).then(l,c):u(r[0][2],o)}catch(e){u(r[0][3],e)}var o}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function*(){for(;!g;)try{0===u.length&&(yield q(new Promise((e=>d=e))));const s=u.shift();if(t&&t.IsCancellationRequested){a.dimension0=`Error code: ${r.zy.RequestCancelled}`,H(a,"Request cancelled"),yield yield q({content:void 0,error:{clientError:{code:r.zy.RequestCancelled,error:"Request cancelled"}}}),g=!0;break}g=(null===(e=s.response)||void 0===e?void 0:e.finalResponse)||void 0!==s.error,a.dimension3=`final response: ${g}`;let l=!1;s.error?(a.dimension0=`Error code: ${s.error.code}`,H(a,s.error.error),l=!0):(null===(o=s.response)||void 0===o?void 0:o.errorInfo)?(a.dimension0=`Error code: ${s.response.errorInfo}`,H(a,"Workflow execution error"),l=!0):(a.resultDescription="OK",H(a)),yield yield q({content:null===(i=s.response)||void 0===i?void 0:i.content,error:l?{workflowError:null===(n=s.response)||void 0===n?void 0:n.errorInfo,serverError:s.error?{code:s.error.code,error:s.error.error,retryable:null==h?void 0:h.canBeRetried(s.error)}:void 0}:void 0})}catch(e){a.dimension0=`Error code: ${r.zy.Unknown}`,H(a,null==e?void 0:e.message),yield yield q({content:void 0,error:{clientError:{code:r.zy.Unknown,error:null==e?void 0:e.message}}}),g=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==a.y.JSWebSockets||e.getNetworkMode()!==a.y.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===r.xv.TooManyRequests||(null==e?void 0:e.code)===r.xv.RequestTimeout}getAuthToken(e,t){const o={Tickets:[]};this.clientMetadata.docSessionId&&(o.DocSessionId=this.clientMetadata.docSessionId);const i=(e=>{if(e===m.OY.Substrate)return g.OY.Substrate})(e);i&&(o.TokenType=i),this.hostCallbacks.requestAuthToken(o).then((o=>{var i;if(!o)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!o.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,o.Token,{returnedTokenType:e,timeToLiveSec:null===(i=o.TokenProperties)||void 0===i?void 0:i.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,o)=>{t(e)}))}onConnect(e,t,o,i,n,r){this.hasSessionConnected?e&&(this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})):this.enableRemoteExecutionNotification&&this.addDownstreamWorkflowsIntoClientGraph(r),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:o,authToken:i},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((n,r)=>{n(e,t,o,i)})),this.serverInputTypes=n}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,o)=>{t(e)}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==i.f.Authenticated&&e==i.f.Pending)return;this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,o,i){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const n=i?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);n&&n.forEach((t=>{t(e,o)}))}getOperationBatchConfig(e){let t;return t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]}),{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:F.E,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,o){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,o)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const i=new n.l0;i.messages=[],e.forEach((e=>{i.messages.push(new n.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(i,(e=>{o(e?new Error(e.error):void 0)}))}}:(e,t,o)=>{this.seedGroupSize++,this.sendMessageToSession(new n.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{o(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new f.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},o,t)}onAnnotationResultsFromServer(e,t){this.onAnnotationResults(e,L.ServerWorkflow,t)}onAnnotationResultsFromLocal(e,t){this.onAnnotationResults(e,L.LocalWorkflow,t)}getLocalRegisteredWorkflows(){return this.workflowRuntime?this.workflowRuntime.getRegisteredWorkflows():this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>(0,E._$)(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new C.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),o=new n.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(o,((o,i)=>{o?H(t,o.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${i.downstreamRuntimeWorkflows.map((e=>e.id))}`,H(t),this.onWorkflowGraphInitResponse(i))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.workflowRuntime||this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(y.tG.info(540848914,y.nh.CoreDefault,`Replacing user context placeholder for: ${(0,k.M6)(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(y.tG.info(540848915,y.nh.CoreDefault,`Replacing tenant context placeholder for: ${(0,k.M6)(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return!!this.workflowRuntime||(0,b.zX)(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:o,apologyOpsMap:i}=this.getAnnotationOperationsByType(e);o.forEach(((e,o)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,o,t,!1)))})),i.forEach(((e,o)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,o,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],o)=>o.items.some((e=>e.body&&d.YH.typeGuard(e.body)))?[[...e,o],t]:[e,[...t,o]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:o,apologyOpsMap:i}=this.getAnnotationOperationsByType(e);o.forEach(((e,o)=>{const i=Array.from(e);this.onAnnotationResults(new n.B_({annotationType:o,ops:i,cv:t,areApologies:!1}),L.Submitted,(()=>{}))})),i.forEach(((e,o)=>{const i=Array.from(e);this.onAnnotationResults(new n.B_({annotationType:o,ops:i,cv:t,areApologies:!0}),L.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,o=new Map;for(const i of e)for(const e of i.items)if(e.body&&d.YH.typeGuard(e.body)){const n=(e,t)=>{const o=e.get(t)||new Set;o.add(i),e.set(t,o)};h.k$.typeGuard(e.body)?n(o,e.body.annotationTypeName):n(t,c.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:o}}onClaimsChallengeMessage(e,t){e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0}));for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge);t(void 0,new n.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e,t){if(e||!t)return;const o=t.tokenType&&t.tokenType==m.OY.WacUserInfo?i.f.WacUserInfoAuthenticated:i.f.Authenticated;this.onServerAuthenticationStateChange(o)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var o;const i=new C.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(o=null==t?void 0:t.interactive)&&void 0!==o&&o}`}).start();i.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const r={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:g.OY.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(r).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return i.resultSignature="Token",new n.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(i.resultSignature="NoToken",i.dimension2=t.message,new n.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,o)=>{this.sendMessageToSession(e,((r,s)=>{H(i,null==r?void 0:r.error),this.onTokenProvisionResponse(r,s),r?o(new Error(r.error)):(n.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1),t(e))}))}))))}}},38086:(e,t,o)=>{"use strict";o.d(t,{yq:()=>g,Aq:()=>h,MY:()=>f,ZF:()=>m,zX:()=>v});var i,n=o(91432),r=o(5629);!function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(i||(i={}));var s=o(86997),a=o(10470),l=o(54489),c=o(99050),u=o(44109),d=o.n(u);class h{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:i.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,o=!1,i="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,i).catch((()=>Promise.resolve(o))):Promise.resolve(o)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const o=e.split(":");let i=o[0].toLowerCase();return 0==i.indexOf(t?"http":"ws")?(i=t?i.replace("http","ws"):i.replace("ws","http"),o[0]=i,o.join(":")):e}static deepEquals(e,t){return d()(e,t)}static collectTelemetry(e,t,o,i,r,s){var a,l,c,u;e.start(),e.resultSignature=null!=i?i:"",e.resultDescription=null!=r?r:"",e.success=o,s?(e.dimension0=null!==(a=s[0])&&void 0!==a?a:"",e.dimension1=null!==(l=s[1])&&void 0!==l?l:"",e.dimension2=null!==(c=s[2])&&void 0!==c?c:"",e.dimension3=null!==(u=s[3])&&void 0!==u?u:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>n.tG.info(508367457,n.nh.CoreDefault,e.stop())))}}h.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class g{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new r.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});n.tG.warn(572838107,n.nh.CoreDefault,e)}}}const p=[s.h.getTypeName(),a.YH.getTypeName(),l.HN.getTypeName()],f=e=>{const t=new Set;for(const o of e)if("string"==typeof o)-1===p.indexOf(o)&&t.add(o);else for(const e of[o.getTypeName(),...o.getBaseTypes()])-1===p.indexOf(e)&&t.add(e);return Array.from(t)},m=(e,t=0)=>Number.isFinite(e)?e:t,v=(e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(c.xU.typeGuard(e)||c.XP.typeGuard(e))return!0;for(const o of e.items)if(!o.body||s.h.matchesTypesFor(o.body,t))return!0;return!1}},66656:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>r}),3023==o.j)var i=o(59925);if(3023==o.j)var n=o(38086);class r{constructor(e,t){var o,n,r,s,a;this.kind=i.wC.Join,this.isStateful=!1,this.maxDelayMs=1e3,this.maxAnnotations=1,this.allowDefinitionOverride=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.maxDelayMs=null!==(s=t.maxDelayMs)&&void 0!==s?s:this.maxDelayMs,this.requestedContextTypesRules=null!==(a=t.requestedContextTypesRules)&&void 0!==a?a:this.requestedContextTypesRules)}static create(e){return new r(e)}setCollectionScopeType(e){return this.collectionScopeType=e,this}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setMaxDelayTime(e){return this.maxDelayMs=e?Math.max(0,e):void 0,this}setMaxAnnotations(e){return this.maxAnnotations=e,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setAllowDefinitionOverride(){return this.allowDefinitionOverride=!0,this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},82666:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>r}),3023==o.j)var i=o(59925);if(3023==o.j)var n=o(38086);class r{constructor(e,t){var o,n,r,s,a,l;this.kind=i.wC.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.requestedContextTypesRules=null!==(s=t.requestedContextTypesRules)&&void 0!==s?s:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(a=t.definitionOverrideTargetWorkflows)&&void 0!==a?a:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(l=t.correlatedSignals)||void 0===l?void 0:l.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new r(e)}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},93271:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(47659);if(3023==o.j)var n=o(86997);class r{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=(0,i.M6)(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class s{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&n.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&n.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new r(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}},35051:(e,t,o)=>{"use strict";var i;o.d(t,{x:()=>i}),function(e){e.JsClient="C",e.Server="S"}(i||(i={}))},35500:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OY:()=>n,Pu:()=>r}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(i||(i={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(r||(r={}))},10600:(e,t,o)=>{"use strict";var i,n;o.d(t,{K:()=>n}),function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(n||(n={}))},47659:(e,t,o)=>{"use strict";o.d(t,{CY:()=>n,M6:()=>r});const i="\\",n=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),r=e=>Array.isArray(e)?5===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}${i}${e[3]}${i}${e[4]}`:4===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}${i}${e[3]}`:3===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}`:2===e.length?`${e[0]}${i}${e[1]}`:1===e.length?e[0]:e.join(i):"(malformed path)"},51917:(e,t,o)=>{"use strict";o.d(t,{Et:()=>n,Qr:()=>h,x5:()=>g});var i=o(86997);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},48028:(e,t,o)=>{"use strict";var i;o.d(t,{y:()=>i}),function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(i||(i={}))},52462:(e,t,o)=>{"use strict";var i;o.d(t,{f:()=>i}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(i||(i={}))},3687:(e,t,o)=>{"use strict";o.d(t,{$j:()=>x,B_:()=>F,D0:()=>N,F_:()=>h,GA:()=>I,Gs:()=>z,LQ:()=>m,Ol:()=>E,PY:()=>T,Sy:()=>ee,TV:()=>q,Tb:()=>B,VR:()=>M,YK:()=>r,Yp:()=>a,Zy:()=>b,_p:()=>d,eE:()=>p,fZ:()=>D,i:()=>s,kd:()=>P,l0:()=>R,n4:()=>k,ru:()=>g,ry:()=>v,uN:()=>f,w9:()=>C,z_:()=>S});var i=o(86997);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class C{constructor(e){i.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){i.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class w{constructor(e){i.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class k{constructor(e){i.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class T{constructor(e){i.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class x{constructor(e){i.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class I{constructor(e){i.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class _{constructor(e){i.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class E{constructor(e){i.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class A{constructor(e){i.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class R{constructor(e){i.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class B{constructor(e){i.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class M{constructor(e){i.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class D{constructor(e){i.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class O{constructor(e){i.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class F{constructor(e){i.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class P{constructor(e){i.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class N{constructor(e){i.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class L{constructor(e){i.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class j{constructor(e){i.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class q{constructor(e){i.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class H{constructor(e){i.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class z{constructor(e){i.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class W{constructor(e){i.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class G{constructor(e){i.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class U{constructor(e){i.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class V{constructor(e){i.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class ${constructor(e){i.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class K{constructor(e){i.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class Q{constructor(e){i.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class Y{constructor(e){i.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class J{constructor(e){i.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Z{constructor(e){i.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class X{constructor(e){i.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{constructor(e){i.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()}},88154:(e,t,o)=>{"use strict";o.d(t,{K7:()=>c,PO:()=>a,mH:()=>i,xv:()=>s,zy:()=>r});const i=2;var n,r,s,a,l,c;!function(e){e[e.WorkflowDisabled=0]="WorkflowDisabled",e[e.TokenNotReady=1]="TokenNotReady",e[e.FlightNotReady=2]="FlightNotReady",e[e.ContextNotReady=3]="ContextNotReady",e[e.WorkflowExcluded=4]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=5]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=6]="LambdaExecutionError",e[e.UnexpectedOutput=7]="UnexpectedOutput"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(s||(s={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(a||(a={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(l||(l={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(c||(c={}))},67041:(e,t,o)=>{"use strict";o.d(t,{I:()=>c});var i=o(44109),n=o.n(i),r=o(91432);class s{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}class a extends s{constructor(e){super(),this.name=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new a(e);const o=a.tryGetConfigProperty(a.currentConfig,e);o.success&&t.updateValue(o.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new a(e)};const o=a.tryGetConfigPropertyByPattern(a.currentConfig,t.regex);t.setting.updateValue(o),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){a.currentConfig=e,r.tG.info(572837966,r.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),a.allSettings.forEach(((e,t)=>{const o=a.tryGetConfigProperty(a.currentConfig,t).value;e.updateValue(o)&&(r.tG.info(572837967,r.nh.CoreDefault,`Setting new value for ${t}: ${o instanceof Object?JSON.stringify(o):o}`),e.notifyListeners(o))})),a.allPatternSettings.forEach(((t,o)=>{const i=a.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(i)&&(r.tG.info(508432774,r.nh.CoreDefault,`Setting new value for pattern ${o}: ${JSON.stringify(i)}`),t.setting.notifyListeners(i))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:a.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const o=[];if(e){const i=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of i)o.push({name:t,value:a.selectApplicableValue(e[t])})}return o}static setGlobalFilter(e){a.globalFilter=e}static clear(){a.currentConfig=void 0,a.allSettings.clear(),a.allPatternSettings.clear()}static selectApplicableValue(e){let t;if(e){const o=e.find((e=>!a.globalFilter||a.globalFilter(e)));o&&(t=o.value)}return t}getName(){return this.name}getValue(){return this.value}updateValue(e){return!n()(this.value,e)&&(r.tG.info(572837968,r.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}}a.allSettings=new Map,a.allPatternSettings=new Map;const l=new class extends s{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=a.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}}("disabledChangeGates",[]),c=(e,t,...o)=>{const i=-1===l.getValue().indexOf(e);return t?i?t(...o):void 0:i}},42847:(e,t,o)=>{"use strict";o.d(t,{l:()=>i});class i{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){i.logIntervalError=e}put(e,t,o,i,n,r,s){if(null==o||o<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const a={value:t,lastUsed:n?Date.now():void 0,expire:o+Date.now(),idleDurationMs:n,expireCallback:i,expiringTriggerTime:r+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,o)=>{e(t.value,o)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,o)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(o),void(this.options.idleCallback&&this.options.idleCallback(o,t.value));t.expire<e&&(this.del(o),t.expireCallback&&t.expireCallback(o,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(o,t.value),t.expiringCallback=void 0)}catch(e){i.logIntervalError&&i.logIntervalError(e)}}))}}},20463:(e,t,o)=>{"use strict";var i;o.d(t,{r:()=>i}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(i||(i={}))},10470:(e,t,o)=>{"use strict";o.d(t,{YH:()=>n});var i=o(86997);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},58051:(e,t,o)=>{"use strict";o.d(t,{k$:()=>n});var i=o(86997);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},54489:(e,t,o)=>{"use strict";o.d(t,{HN:()=>n});var i=o(86997);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},92068:(e,t,o)=>{"use strict";var i,n;o.d(t,{J1:()=>i}),function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token"}(i||(i={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(n||(n={}));class r{}r.lowerIndexBound=1,r.maxNumberOfRows=1048576,r.maxNumberOfColumns=16384,r.firstColumnName="A",r.lastColumnName="XFD"},41295:(e,t,o)=>{"use strict";o.d(t,{N0:()=>n,NC:()=>d,Xv:()=>r,Z8:()=>c,aD:()=>u,f4:()=>h,hl:()=>a,iU:()=>l,ub:()=>s});var i=o(75159);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentSuggestion"}static getBaseTypes(){return["AugLoop_SmartCompose_Suggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentPrefilterTriggered"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntent"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentHybrid"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_Prefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_FlagWithIntent"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_EntityPrediction"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},21300:(e,t,o)=>{"use strict";o.d(t,{A$:()=>s,R6:()=>n,aO:()=>r});var i=o(75159);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionSignal"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedRequestSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},65140:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{EntityPrediction:()=>n.f4,FlagWithIntent:()=>n.NC,GraphIntentDetectionBaseSignal:()=>r.R6,GraphIntentDetectionSignal:()=>r.aO,GraphIntentPrefilterTriggered:()=>n.Xv,GraphIntentSuggestion:()=>n.N0,IntentConfidenceLevel:()=>i.Z,IntentScope:()=>i.f,Prefetch:()=>n.aD,SystemInitiatedRequestSignalHybrid:()=>r.A$,SystemInitiatedWithIntent:()=>n.hl,SystemInitiatedWithIntentBase:()=>n.ub,SystemInitiatedWithIntentClient:()=>n.iU,SystemInitiatedWithIntentHybrid:()=>n.Z8}),3023==o.j)var i=o(54897);if(3023==o.j)var n=o(41295);if(3023==o.j)var r=o(21300)},54897:(e,t,o)=>{"use strict";var i,n;o.d(t,{Z:()=>i,f:()=>n}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(i||(i={})),function(e){e.FirstParty="FirstParty",e.ThirdParty="ThirdParty"}(n||(n={}))},67849:(e,t,o)=>{"use strict";o.d(t,{J_:()=>a,NG:()=>u,VL:()=>s,nm:()=>l,rQ:()=>r,t9:()=>c,xz:()=>n});var i=o(75159);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetchCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDeleteCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid"}static getBaseTypes(){return["AugLoop_GraphSearch_SearchSuggestionsAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphSearch_PredictionAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphSearch_NudgeAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphSearch_EccAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_GraphSearch_UserInitiatedAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},49768:(e,t,o)=>{"use strict";o.d(t,{$9:()=>s,Z5:()=>n,tE:()=>r,zV:()=>a});var i=o(75159);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsRequest"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_GraphSearchSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDelete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},12420:(e,t,o)=>{"use strict";o.d(t,{JM:()=>n,VP:()=>r});var i=o(75159),n=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),r=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}())},21330:(e,t,o)=>{"use strict";t.pR=t.O7=t.i6=t.Jq=t.wS=t._C=void 0;const i=o(65140);var n,r;!function(e){e[e.Person=0]="Person",e[e.NonPerson=1]="NonPerson",e[e.File=2]="File",e[e.WordDocument=3]="WordDocument",e[e.Powerpoint=4]="Powerpoint",e[e.PDF=5]="PDF",e[e.Excel=6]="Excel",e[e.Meeting=7]="Meeting",e[e.Chat=8]="Chat",e[e.Email=9]="Email",e[e.Unknown=10]="Unknown"}(n||(n={})),function(e){e[e.PastMeeting=0]="PastMeeting",e[e.FutureMeeting=1]="FutureMeeting",e[e.Unknown=2]="Unknown"}(r||(r={}));t._C={"whats the latest from":n.Person,"when is my next meeting with":n.Person,"what s the latest from":n.Person,"when s my next meeting with":n.Person,"what did":n.Person,recap:n.Meeting,"draft an email with action items from":n.Meeting,"what are the unresolved issues from":n.Meeting,"help me prepare for my next meeting":n.Meeting,"what were the key takeaways from":n.Meeting,"what are the key takeaways from":n.Meeting,"list key points from":n.File,"create a faq based on":n.File,"propose a new introduction to":n.File,"suggest edits make this more concise":n.File},t.wS={"cules fueron los problemas abiertos de":r.PastMeeting,"cules fueron los problemas abiertos de la":r.PastMeeting,"rdige un courriel contenant des notes et des lments daction de la":r.PastMeeting,"rdige un e-mail contenant des notes et des lments daction de la":r.PastMeeting,"crea una bozza di e-mail con le note e le attivit definite durante la":r.PastMeeting,"entwirf eine e-mail mit notizen und aktionselementen aus":r.PastMeeting,"redacta un borrador de correo electrnico con notas y acciones de":r.PastMeeting,:r.PastMeeting,"draft an email with notes and action items from":r.PastMeeting,"cules son los elementos de accin de":r.PastMeeting,"elabore um email com anotaes e itens de ao":r.PastMeeting,"was waren die offenen fragen in":r.PastMeeting,"what were the open issues from":r.PastMeeting,"quels taient les problmes en suspens par rapport  la":r.PastMeeting,"quali sono state le questioni discusse nella":r.PastMeeting,"quais foram os problemas em aberto da":r.PastMeeting,"what are the action items from":r.PastMeeting,"quali sono le attivit da svolgere definite nella":r.PastMeeting,"was sind die aktionselemente aus":r.PastMeeting,"quels sont les points d'action issus de la":r.PastMeeting,"quais so os itens de ao da":r.PastMeeting,recap:r.PastMeeting,"resuma a":r.PastMeeting,"rcap. la":r.PastMeeting,"resume las conclusiones y elementos de accin de la":r.PastMeeting,"crea un riepilogo della":r.PastMeeting,:r.PastMeeting,rcap:r.PastMeeting},t.Jq={"?":r.PastMeeting," ":r.PastMeeting,"?":r.PastMeeting," ?":r.PastMeeting,"?":r.PastMeeting,"zusammen, mit ergebnissen/aktionselementen als abschnitten, mit zustndigen.":r.PastMeeting," ":r.PastMeeting},t.i6={"latest from":n.Person,"manager of":n.Person,who:n.Person,"who is":n.Person,message:n.NonPerson,messages:n.NonPerson,summarize:n.NonPerson,concise:n.NonPerson,elaborate:n.NonPerson,"introduction to":n.NonPerson,"points from":n.NonPerson,"items from":n.NonPerson,"issues from":n.NonPerson,"based on":n.NonPerson,in:n.NonPerson,meeting:n.Meeting,event:n.Meeting,meet:n.Meeting,sync:n.Meeting,"sync up":n.Meeting,call:n.Meeting,huddle:n.Meeting,scrum:n.Meeting,conference:n.Meeting,conf:n.Meeting,review:n.Meeting,discussion:n.Meeting,brief:n.Meeting,briefing:n.Meeting,appointment:n.Meeting,recap:n.Meeting,"prepare for":n.Meeting,"prep for":n.Meeting,file:n.File,files:n.File,document:n.WordDocument,documents:n.WordDocument,doc:n.WordDocument,word:n.WordDocument,docx:n.WordDocument,excel:n.Excel,sheet:n.Excel,spreadsheet:n.Excel,"spread sheet":n.Excel,presentation:n.Powerpoint,deck:n.Powerpoint,powerpoint:n.Powerpoint,"power point":n.Powerpoint,ppt:n.Powerpoint,pptx:n.Powerpoint,pdf:n.PDF,email:n.Email,emails:n.Email,"e mail":n.Email,"e mails":n.Email,chat:n.Chat,chats:n.Chat,group:n.Chat,groups:n.Chat,conversation:n.Chat,conversations:n.Chat};const s=new Set(["with","to","by"]);function a(e,t,o){const n=function(e,t){let o;if(void 0!==e&&e!==r.Unknown)switch(e){case r.FutureMeeting:o={name:"#event#",scope:i.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?i.IntentConfidenceLevel.High:i.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"future"}],highConfidenceSign:!!t};break;case r.PastMeeting:o={name:"#event#",scope:i.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?i.IntentConfidenceLevel.High:i.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"past"}],highConfidenceSign:!!t}}return o}(e,o);if(void 0===n)return;const s=t.find((e=>e.name===n.name));s?(s.score=Math.max(s.score,n.score),s.confidenceLevel=Math.max(s.confidenceLevel,n.confidenceLevel),s.highConfidenceSign=s.highConfidenceSign||n.highConfidenceSign,s.slots=function(e,t){if(t){if(e){const o=t.filter((t=>!e.some((e=>t.slotName===e.slotName))));return[...e,...o]}return t}return e}(s.slots,n.slots)):t.push(n)}function l(e){let t=e.toLowerCase().trim().replace(/[^\w\s]/g," ").trim().toLowerCase();return t=t.replace(/\s+/g," "),t}t.O7={"prepare for":r.FutureMeeting,"prep for":r.FutureMeeting,"prepare me for":r.FutureMeeting,"prep me for":r.FutureMeeting,"next meeting":r.FutureMeeting,"next event":r.FutureMeeting,"next sync":r.FutureMeeting,"next call":r.FutureMeeting,upcoming:r.FutureMeeting,"to be discussed":r.FutureMeeting,recap:r.PastMeeting,"last meeting":r.PastMeeting,"previous meeting":r.PastMeeting,summarize:r.PastMeeting,"summary of":r.PastMeeting,"points from":r.PastMeeting,"items from":r.PastMeeting,"takeaways from":r.PastMeeting,discussed:r.PastMeeting,"issues from":r.PastMeeting,"based on":r.PastMeeting},t.pR=function(e,o){var c,u;if((null!==(c=null==e?void 0:e.length)&&void 0!==c?c:0)<=0&&(null!==(u=null==o?void 0:o.length)&&void 0!==u?u:0)<=0)return;const d=function(e){const t=[];if(void 0!==e&&e!==n.Unknown)switch(e){case n.Person:t.push({name:"#people#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.NonPerson:t.push({name:"#people#",scope:i.IntentScope.FirstParty,score:0,confidenceLevel:i.IntentConfidenceLevel.Low,highConfidenceSign:!1});break;case n.File:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.WordDocument:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"doc"},{slotName:"file_type",slotValue:"docx"}],highConfidenceSign:!0});break;case n.Powerpoint:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"ppt"},{slotName:"file_type",slotValue:"pptx"}],highConfidenceSign:!0});break;case n.PDF:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"pdf"}],highConfidenceSign:!0});break;case n.Excel:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"xls"},{slotName:"file_type",slotValue:"xlsx"}],highConfidenceSign:!0});break;case n.Meeting:t.push({name:"#event#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Chat:t.push({name:"#chat#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Email:t.push({name:"#email#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0})}return t}(function(e){let o=n.Unknown;const i=l(e);if(t._C.hasOwnProperty(i))return t._C[i];const r=i.split(" "),a=r[r.length-1];if(t.i6.hasOwnProperty(a)&&(o=t.i6[a]),r.length>=2){const e=r.slice(Math.max(0,r.length-2)).join(" ");t.i6.hasOwnProperty(e)&&(o=t.i6[e]);const i=r[r.length-2];("from"===a&&t.i6.hasOwnProperty(i)||s.has(a))&&(o=n.Person)}return o}(e)),h=function(e,o){const i=e.trim().toLowerCase();if(t.wS.hasOwnProperty(i))return t.wS[i];if(o){const e=o.trim().toLowerCase();if(t.Jq.hasOwnProperty(e))return t.Jq[e]}return r.Unknown}(e,o);return h!==r.Unknown?a(h,d,!0):a(function(e){const o=l(e).split(" "),i=Math.min(o.length,5),n=o.slice(Math.max(0,o.length-i)).join(" ");for(const e in t.O7)if(n.includes(e))return t.O7[e];return r.Unknown}(e),d),d}},28247:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildEmscriptenCustomContextFromSite=t.buildEmscriptenCustomContext=void 0;const i=o(10125);function n(e,t){function o(e,t,o,i){const n=function(e,t,o){const i=new Headers,n=o.keys();for(let e=0;e<n.size();e++){const t=n.get(e);i.append(t,o.get(t))}const r={};return r.method=e,void 0!==t&&(r.body=t),n.size()>0&&(r.headers=i),n.delete(),r}(t,o,i);let r=0;return fetch(e,n).then((e=>{if(r=e.status,!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((e=>({bufferArray:new Uint8Array(e),length:e.byteLength,isError:!1,statusCode:r}))).catch((e=>{const t=e;return t.isError=!0,t.statusCode=r,t}))}function n(e,t,o){if(e||t&&0!==t.length){if(e){const t=e;return t.isError=!0,t}return{token:t,ttl:o?o.timeToLiveSec:void 0}}return{name:"Missing Token",message:"Unable to fetch token",isError:!0}}function r(e){if(!e)return;const t=new Map,o=e.keys();for(let i=0;i<o.size();i++){const n=o.get(i);t.set(n,e.get(n))}return t}function s(e,t){return new Promise((async(o,i)=>{try{if(!e.run)throw new Error("WorkflowSite is unimplemented.");const i=await e.run(t);if(!i)throw new Error("Outputs returned as undefined.");o(i)}catch(e){const t=e;t.isError=!0,o(t)}}))}function a(e,t,o){if(!e||!e.run){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.run(t).then((e=>{if(!e)throw new Error("Outputs returned as undefined.");i.opcall(e)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))}const l={createModel:function(t){return new Promise((async(o,i)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const i=await e.site.createModel(t);i.customRun=s.bind(null,i),i.customRunInCallback=a.bind(null,i),o(i)}catch(e){const t=e;t.isError=!0,o(t)}}))},createModelInCallback:function(t,o){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.site.createModel(t).then((e=>{e.customRun=s.bind(null,e),e.customRunInCallback=a.bind(null,e),i.opcall(e)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))},createModelInputs:function(){return new Promise((async(t,o)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");t(await e.site.createModelInputs())}catch(e){const o=e;o.isError=!0,t(o)}}))},createModelInputsInCallback:function(t){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void t(e)}const o=t.clone();e.site.createModelInputs().then((e=>{o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))}},c={};return c.docSessionId=e.clientMetadata.docSessionId,c.getToken=function(t){return new Promise(((o,i)=>{e.getToken(t,((e,t,i)=>{if(e||t&&0!==t.length)if(e){const t=e;t.isError=!0,o(t)}else o(t);else o({name:"Missing Token",message:"Unable to fetch token",isError:!0})}))}))},c.getTokenWithPropertiesAsync=function(t){return new Promise(((o,i)=>{e.getToken(t,((e,t,i)=>{const r=n(e,t,i);o(r)}))}))},c.getTokenWithPropertiesInCallback=function(t,o){const i=o.clone();e.getToken(t,((e,t,o)=>{const r=n(e,t,o);i.opcall(r),i.delete()}))},c.getResourceAsUrlInCallback=function(t,o,i,n){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void n(e)}const s=n.clone();e.site.getResourceAsURL(t,o,r(i)).then((e=>{const t=Object.entries(e),o=new Map(t);s.opcall(o)})).catch((e=>{const t=e;t.isError=!0,s.opcall(t)})).finally((()=>{s.delete()}))},c.httpRequest=o,c.httpRequestInCallback=function(e,t,i,n,r){const s=r.clone();o(e,t,i,n).then((e=>{s.opcall(e)})).catch((e=>{})).finally((()=>{s.delete()}))},c.copyUint8ArrayToWasmMemory=function(e,o){t().HEAPU8.set(e,o)},c.copyUint16ArrayToWasmMemory=function(e,o){t().HEAPU16.set(e,o>>1)},c.copyUint32ArrayToWasmMemory=function(e,o){t().HEAPU32.set(e,o>>2)},c.copyInt8ArrayToWasmMemory=function(e,o){t().HEAP8.set(e,o)},c.copyInt16ArrayToWasmMemory=function(e,o){t().HEAP16.set(e,o>>1)},c.copyInt32ArrayToWasmMemory=function(e,o){t().HEAP32.set(e,o>>2)},c.copyFloat32ArrayToWasmMemory=function(e,o){t().HEAPF32.set(e,o>>2)},c.copyFloat64ArrayToWasmMemory=function(e,o){t().HEAPF64.set(e,o>>3)},c.getResourceAsUrl=function(t,o,i){return new Promise((async(n,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const s=await e.site.getResourceAsURL(t,o,r(i)),a=Object.entries(s);n(new Map(a))}catch(e){const t=e;t.isError=!0,n(t)}}))},c.getResourceAsByteArray=function(t,o,i){return new Promise((async(n,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const s=await e.site.getResourceAsArrayBuffer(t,o,r(i)),a=new Map;for(const[e,t]of Object.entries(s)){console.log(e,t);const o=new Uint8Array(t),i={};i.bufferArray=o,i.length=t.byteLength,a.set(e,i)}n(a)}catch(e){const t=e;t.isError=!0,n(t)}}))},c.site=l,c.context=e,c.logOperationClass=i.Operation,c.logInfoFunction=i.Log.info.bind(null,0,i.LogCategory.WorkflowDefault),c.dummyPromise=Promise.resolve("Success"),c.logDebugTrace=function(e,t){i.Log.debug(e,i.LogCategory.WorkflowDefault,t)},c.logInfoTrace=function(e,t){i.Log.info(e,i.LogCategory.WorkflowDefault,t)},c.logWarnTrace=function(e,t){i.Log.warn(e,i.LogCategory.WorkflowDefault,t)},c.logErrorTrace=function(e,t){i.Log.error(e,i.LogCategory.WorkflowDefault,t)},c.getUserContext=function(){if(!e.userContext)return;const t={UserContextObject:e.userContext};return JSON.stringify(t)},c}t.buildEmscriptenCustomContext=n,t.buildEmscriptenCustomContextFromSite=function(e,t){return n({clientMetadata:void 0,getToken:function(e,t){throw new Error("GetToken not available in init.")},site:e},t)}},54889:function(e,t,o){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,i,n)}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(o(15845),t),n(o(28247),t)},15845:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmWebFromModularizeFunction=void 0;const i=o(10125),n=new Set,r=new Map,s="function"==typeof globalThis.importScripts;function a(e,t){e.src=t}function l(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function c(e,t,o,n,r){if(!n)return!1;const s=r||l;return!!s()[e+"Module"]&&(t.resultDescription="Module Loaded From Cache",i.Log.info(538576341,i.LogCategory.WorkflowDefault,t.stop()),o(s()[e+"Module"]),!0)}t.loadWasmWebFromModularizeFunction=async function(e,t,o,u,d,h,g){const p=new i.Operation({operationName:"LoadWasmWebFromModularizeFunction",success:!0,resourceId:o,resultDescription:""}).start();return new Promise(((f,m)=>{if(c(t,p,f,u,h))return;if(u&&n.has(t)){if(c(t,p,f,u,h))return;let e=r.get(t);void 0===e&&(e=[],r.set(t,e)),e.push({onSuccess:e=>f(e),onError:e=>m(e)})}else!function(e,t,o,i){if(s)try{globalThis.importScripts(e),t()}catch(e){o(e)}else{const n=document.createElement("script");(i||a)(n,e),n.onload=function(){t(),n.remove()},n.onerror=function(e){o(e),n.remove()},document.body.appendChild(n)}}(e,(()=>{if(c(t,p,f,u,h))return;if(!self[t])return p.success=!1,p.resultDescription="ModularizeFunction Missing",i.Log.info(538576343,i.LogCategory.WorkflowDefault,p.stop()),void m(new Error("ModularizeFunction Missing"));const e={};void 0!==d&&(e.locateFile=d),e.onAbort=function(e){const t=new i.Operation({operationName:"WasmCrashHappenedOnAbortCalled",resourceId:o}).start();"string"==typeof e&&(t.resultDescription=e),i.Log.error(509154189,i.LogCategory.WorkflowDefault,t.stop())},self[t](e).then((e=>{!function(e,t,o,n,a,u){var d;if(c(e,t,o,n,u))return;s&&(globalThis.top=self);const h=u||l;n&&(h()[e+"Module"]=a,null===(d=r.get(e))||void 0===d||d.forEach((t=>{t.onSuccess(h()[e+"Module"])})),r.set(e,[])),t.dimension0=n.toString(),i.Log.info(512237901,i.LogCategory.WorkflowDefault,t.stop()),o(a)}(t,p,f,u,e,h)})).catch((e=>{var o,n;p.success=!1,p.resultDescription="ModularizeFunction Failed: "+(null!==(o=e.message)&&void 0!==o?o:"Unknown Error Message"),i.Log.info(512237900,i.LogCategory.WorkflowDefault,p.stop()),null===(n=r.get(t))||void 0===n||n.forEach((t=>{t.onError(e)})),r.set(t,[]),m(e)}))}),(e=>{var o;p.success=!1,p.resultDescription="ScriptLoad Failed: "+("string"==typeof e?e:"Unknown Error Message"),i.Log.info(538706265,i.LogCategory.WorkflowDefault,p.stop()),null===(o=r.get(t))||void 0===o||o.forEach((t=>{t.onError(e)})),r.set(t,[]),m(e)}),g);u&&n.add(t)}))}},168:(e,t,o)=>{"use strict";o.d(t,{E:()=>i});const i=e=>n(e,Number.POSITIVE_INFINITY),n=(e,t)=>{let o=0;const i=[],n=[e];for(;n.length>0;){const e=n.pop(),r=typeof e;if("boolean"===r)o+=4;else if("string"===r)o+=2*e.length;else if("number"===r)o+=8;else if("object"===r&&e&&-1===i.indexOf(e))if(e instanceof Uint8Array)o+=e.length;else{i.push(e);for(const t in e)n.push(e[t])}if(o>t)return o}return o}},52008:(e,t,o)=>{"use strict";function i(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}o.d(t,{v4:()=>i})},84921:(e,t,o)=>{"use strict";o.d(t,{JU:()=>s,Vh:()=>r});const i=";",n=":";function r(e){if(!e)return new a([],new Set,new Map,new Map);const t=e.split(i),o=new Set,r=new Map,s=new Map;for(const e of t){const t=e.trim();if(""===t)continue;o.add(a.normalizeName(t));const[i,...l]=t.split(n),c=l.join(n),u=a.normalizeName(i);if(u){r.set(u,c);const e=a.parseName(u);e&&e!==u&&s.set(e,u)}}return new a(t,o,r,s)}function s(e){if(!e)return"";const t=new Set,o=[];for(const r of e.split(i).reverse()){const e=r.split(n)[0],i=a.normalizeName(e);t.has(i)||(t.add(i),o.push(r))}return o.reverse().join(i)}class a{constructor(e,t,o,i){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=o,this.parsedFlightsMap=i}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=a.normalizeName(e),o=this.normalizedFlights.has(t),i=this.keyValueFlightsMap.has(t),n=this.parsedFlightsMap.has(t);return o||i||n}getBooleanValue(e,t){var o,i;const n=null===(o=this.getStringValue(e))||void 0===o?void 0:o.toLowerCase(),r=null===(i=this.getStringValue(this.parsedFlightsMap.get(a.normalizeName(e))))||void 0===i?void 0:i.toLowerCase();return"true"===n||"true"===r||"false"!==n&&"false"!==r&&t}getIntValue(e,t){const o=this.getStringValue(e),i=Number.parseInt(o,10);return Number.isNaN(i)?t:i}getStringValue(e,t){var o;return null!==(o=this.keyValueFlightsMap.get(a.normalizeName(e)))&&void 0!==o?o:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,o)=>{const i=null==t?void 0:t.toLowerCase();switch(i){case"true":e.push({name:o,value:!0});break;case"false":e.push({name:o,value:!1});break;default:{const n=Number.parseInt(i,10);Number.isNaN(n)?e.push({name:o,value:t}):e.push({name:o,value:n})}}})),e}}},93884:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=(e,t)=>{const o=[];for(const i of null!=e?e:[])if(void 0===t||t===i.cardinality)for(const e of i.contextTypes)o.push([e,i.cardinality,i.producerWaitPolicy]);return o}},12018:(e,t,o)=>{"use strict";o.d(t,{L:()=>i});class i{constructor(e){this.outlookDataHandle=e}getLocalPeopleData(){const e=this.outlookDataHandle.getAllRecipients(),t=[];for(const o of e)t.push({DisplayName:o.displayName,EmailAddresses:[o.emailAddress],Id:o.id,confidence:0,entityType:"",providerName:"",text:""});return t}}},8499:(e,t,o)=>{"use strict";o.d(t,{L4:()=>b});var i=o(67849),n=o(49768),r=o(91432),s=o(66656),a=o(75159),l=o(91168),c=o(68288),u=o(12420),d=o(41295),h=o(96170),g=o(30210);const p=e=>"GraphSearchClient"===e.ownerId,f=new Map([["AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid",0],["AugLoop_ObservationalAssistance_EccAnnotationClient",1],["AugLoop_GraphSearch_EccAnnotationHybrid",1],["AugLoop_GraphSearch_PredictionAnnotationHybrid",2],["AugLoop_GraphSearch_NudgeAnnotationHybrid",3]]);class m extends h.c{constructor(e,t){super("GraphSearchJoinWorkflowInstance",e,t)}async execute(e,t,o,n){let s=!1,c=!1;const u=new Date,d=this.startLogOperation("GraphSearchJoinWorkflowExecute",u,t);this.logWasmStats(d);const h=f.get(a.h.getTypeNameFor(t[0]));if(void 0!==h&&d.setDataFields({scenario:h}),2===t.length){if(l.SM.typeGuard(t[0])||l.SM.typeGuard(t[1])){const e=t[p(t[0])?0:1];d.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:o.clientMetadata.sessionId})}if(i.nm.typeGuard(t[0])||i.nm.typeGuard(t[1])){const e=t[p(t[0])?0:1];d.setDataFields({logicalId:e.logicalId,sessionId:o.clientMetadata.sessionId}),"Ignore"===e.entityType&&(c=!0)}}d.setDataFields({dimension0:(new Date).getTime()-u.getTime()}),s=this.executeWorkflowLambda(d,e,o,n,t),c&&!s||r.tG.info(509638786,r.nh.WorkflowDefault,d.stop())}}const v=(e,t)=>new m(e,t),b=(e,t)=>s.a.create("GraphSearchJoinECC").setCollectionScopeType(u.VP.getTypeName()).setInputTypes([l.SM.getTypeName(),i.NG.getTypeName()]).setOutputTypes([c.os.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,e,t));var y,C;y=g.aU,C=g.zb,s.a.create("GraphSearchJoinWorkflow").setCollectionScopeType(n.Z5.getTypeName()).setInputTypes([i.J_.getTypeName()]).setOutputTypes([i.VL.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,y,C)),((e,t)=>{s.a.create("GraphSearchJoinPrediction").setCollectionScopeType(d.iU.getTypeName()).setInputTypes([i.nm.getTypeName(),i.t9.getTypeName()]).setOutputTypes([l.k2.getTypeName(),l.KL.getTypeName(),c.Vm.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,e,t))})(g.aU,g.zb),b(g.aU,g.zb)},4434:(e,t,o)=>{"use strict";o.d(t,{X8:()=>v});var i=o(82666),n=o(91432),r=o(75159),s=o(49768),a=o(67849),l=o(41295),c=o(12420);if(3023==o.j)var u=o(91168);var d=o(96170),h=o(30210);if(3023==o.j)var g=o(12018);const p=new Map([["AugLoop_GraphSearch_SearchSuggestionsRequest",0],["AugLoop_ObservationalAssistance_UserInitiatedRequestClient",1],["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient",2]]);class f extends d.c{constructor(e,t){super("GraphSearchWorkflowInstance",e,t)}async execute(e,t,o){var i;let s=!1,a=!1;const u=new Date,d=this.startLogOperation("GraphSearchWorkflowExecute",u);this.logWasmStats(d);const h=p.get(r.h.getTypeNameFor(e));void 0!==h&&d.setDataFields({scenario:h}),(c.VP.typeGuard(e)||l.iU.typeGuard(e))&&(d.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:t.clientMetadata.sessionId}),l.iU.typeGuard(e)&&0===(null===(i=e.multiIntents)||void 0===i?void 0:i.length)&&(a=!0)),s=this.executeWorkflowLambda(d,e,t,o),a&&!s||n.tG.info(509638755,n.nh.WorkflowDefault,d.stop())}}const m=(e,t)=>new f(e,t),v=(e,t)=>{const o=t.localContext?new g.L(t.localContext):null;return i.z.create("GraphSearchLocalWorkflowOA").setStateful().setInputTypes([s.$9.getTypeName(),l.iU.getTypeName(),c.VP.getTypeName(),s.zV.getTypeName()]).setOutputTypes([a.nm.getTypeName(),a.t9.getTypeName(),u.SM.getTypeName(),a.NG.getTypeName(),s.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(m.bind(null,{...e,localContext:o},t))};var b,y;b=h.aU,y=h.zb,i.z.create("GraphSearchLocalWorkflow").setStateful().setInputTypes([s.$9.getTypeName(),s.Z5.getTypeName(),s.zV.getTypeName()]).setOutputTypes([a.J_.getTypeName(),s.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(m.bind(null,b,y))},96170:(e,t,o)=>{"use strict";o.d(t,{c:()=>m});var i=o(54889);if(3023==o.j)var n=o(30210);if(3023==o.j)var r=o(21889);if(3023==o.j)var s=o(91432);if(3023==o.j)var a=o(5629);if(3023==o.j)var l=o(9054);if(3023==o.j)var c=o(49768);if(3023==o.j)var u=o(67849);if(3023==o.j)var d=o(12420);if(3023==o.j)var h=o(82540);if(3023==o.j)var g=o(91168);if(3023==o.j)var p=o(68288);if(3023==o.j)var f=o(85417);class m{constructor(e,t,o){var i,s;this.ariaNamespace="GraphSearch",this.prodAriaToken="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",this.devAriaToken="30d62489eb65462bb3a5c93b0cad786b-0260e5be-afb3-4f7c-a14a-f0b25b00a080-7662",this.isDisposed=!1,this.wasmConfig=o,this.propertyName=e,this.ariaToken=void 0!==t.environment&&t.environment===r.O.dev?this.devAriaToken:this.prodAriaToken;const a=t.scenarios&&t.scenarios.includes(n.Nz.BIZ_CHAT)?(0,l.E)():void 0;this.config={...t,...void 0===t.scenarioLength?{scenarioLength:t.scenarios.length}:{},heuristicIntentsConfig:a};const c=null!==(i=null==o?void 0:o.jsAssetName)&&void 0!==i?i:"GraphSearchLocalWorkflow.js",u=`${o.wasmRoot}/${c}`;this.wasmConfig={...void 0===o?{}:o,wasmRoot:u},t.enableMemoryLeakDetection&&(this.memoryLeakDetector=new f.j(null!==(s=t.memoryLeakDetectorConfig)&&void 0!==s?s:{}))}async init(e,t){var o;const n=this.startLogOperation("GraphSearchWorkflowInstance"===this.propertyName?"GraphSearchWorkflowInit":"GraphSearchJoinWorkflowInit",new Date);n.setDataFields({isPrefetch:this.config.prefetchOnly});try{await this.initializeWasmModule(this.wasmConfig.wasmRoot,this.wasmConfig.locateFile,this.wasmConfig.cacheModule,this.wasmConfig.wasmModuleCache,this.wasmConfig.scriptSrcSetter),this.logWasmStats(n),this.workflowLambda=this.wasmModule[this.propertyName](this.config);const o=t?(0,i.buildEmscriptenCustomContext)(t,(()=>this.wasmModule)):(0,i.buildEmscriptenCustomContextFromSite)(e,(()=>this.wasmModule));this.workflowLambda.init(o)}catch(e){const t=null!==(o=null==e?void 0:e.stack)&&void 0!==o?o:"";n.resultDescription=e&&e.message?`${e.message} // ${t}`:"Unknown error.",n.success=!1}s.tG.info(507573794,s.nh.WorkflowDefault,n.stop())}executeWorkflowLambda(e,t,o,n,r){var a;let l=!1;if(!this.wasmModule||!this.workflowLambda)return e.resultDescription="null lambda",e.success=!1,s.tG.info(507564037,s.nh.WorkflowDefault,e.stop()),"GraphSearchWorkflowInstance"===this.propertyName?this.sendDummyAndTriggerServiceFallback(n,t):this.sendInputAnnotation(n,t,r),!1;try{const e=(0,i.buildEmscriptenCustomContext)(o,this.wasmModule);void 0===r?this.workflowLambda.execute(t,e,n):this.workflowLambda.execute(t,r,e,n)}catch(t){const o=null!==(a=null==t?void 0:t.stack)&&void 0!==a?a:"";e.resultDescription=t&&t.message?`${t.message} // ${o}`:"Unknown error.",e.success=!1,l=!0}return l}dispose(){this.isDisposed=!0,void 0!==this.workflowLambda&&this.workflowLambda.delete(),this.workflowLambda=void 0,this.wasmModule=void 0}async initializeWasmModule(e,t,o=!0,n,r){if(this.wasmModule=await(0,i.loadWasmWebFromModularizeFunction)(e,"createGSWLocalInstance","GraphSearchWorkflowWasm_Prefetch",o,t,n,r),this.isDisposed)throw new Error("Workflow was disposed while initializing WASM module")}startLogOperation(e,t,o){const i=new a.I({operationName:"GraphSearchWorkflowInstance"===this.propertyName?"graphsearchworkflow_ts":"graphsearchjoinworkflow_ts",success:!0,resultDescription:"",ariaTenant:this.ariaToken,ariaNamespace:this.ariaNamespace}).start();return i.setDataFields({msg:e,startTimestamp:t.toISOString(),inputCount:o?o.length:0}),i}logWasmStats(e){this.wasmModule&&e.setDataFields({version:this.wasmModule.version,sdkVersion:this.wasmModule.sdkVersion,wasmModuleHeapSize:this.wasmModule.HEAP8?this.wasmModule.HEAP8.buffer.byteLength:void 0}),this.config.enableMemoryLeakDetection&&this.wasmModule&&this.wasmModule.HEAP8&&this.memoryLeakDetector.recordMemoryUsage(this.wasmModule.HEAP8.buffer.byteLength)}sendDummyAndTriggerServiceFallback(e,t){if(d.VP.typeGuard(t)||c.Z5.typeGuard(t)){const o={ownerId:"GraphSearchClient",conversationId:t.conversationId,logicalId:t.logicalId,entityResults:[],status:h.i.Success},i=d.VP.typeGuard(t)?g.SM.getTypeName():u.J_.getTypeName();e.setAnnotations(t,i,[o],{immediate:!0}),e.submitSignals([new c.tE({cachedIntents:[],inputObject:t,entityTypesResolved:this.config.entityTypes})])}}sendInputAnnotation(e,t,o){void 0!==o&&o.length>0&&(g.SM.typeGuard(o[0])?this.sendEccInputAnnotation(e,t,o):u.J_.typeGuard(o[0])&&this.sendSearchSuggestionInputAnnotation(e,t,o))}sendEccInputAnnotation(e,t,o){if(void 0!==o&&o.length>0&&g.SM.typeGuard(o[0])){const i=new p.os({entityResults:o[0].entityResults,status:h.i.Success});e.setAnnotations(t,p.os.getTypeName(),[i],{immediate:!0})}}sendSearchSuggestionInputAnnotation(e,t,o){if(void 0!==o&&o.length>0&&u.J_.typeGuard(o[0])){const i=new u.VL({results:o[0].results,status:h.i.Success});e.setAnnotations(t,u.VL.getTypeName(),[i],{immediate:!0})}}}},9054:(e,t,o)=>{"use strict";o.d(t,{E:()=>r});var i=o(21330);function n(e,t,o){var n;if(!t||void 0===o)return[];const r=t.substring(0,o).trimEnd(),s=t.substring(o+(null!==(n=1+(null==e?void 0:e.length))&&void 0!==n?n:0)).trim();return(0,i.pR)(r,s)||[]}function r(){return{getHeuristicIntents:n}}},85417:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});class i{constructor(e){var t,o,i,n;this.memoryPoints=new Set,this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now(),this.growthFrequencyThreshold=null!==(t=e.growthFrequencyThreshold)&&void 0!==t?t:5,this.shortTermWindow=null!==(o=e.shortTermWindow)&&void 0!==o?o:6e4,this.longTermGrowthThreshold=null!==(i=e.longTermGrowthThreshold)&&void 0!==i?i:.5,this.longTermWindow=null!==(n=e.longTermWindow)&&void 0!==n?n:288e5}recordMemoryUsage(e){const t=Date.now();0===this.memoryPoints.size&&(this.startMemorySize=e,this.startTimestamp=t),this.memoryPoints.add(e),this.memoryTimestamps.push(t),this.checkShortTermGrowths(t),this.checkLongTermGrowth(e,t)}checkShortTermGrowths(e){const t=e-this.shortTermWindow;for(;this.memoryTimestamps.length>0&&this.memoryTimestamps[0]<t;)this.memoryTimestamps.shift();const o=new Set(this.memoryTimestamps.map((t=>Array.from(this.memoryPoints).find((()=>-1!==this.memoryTimestamps.findIndex((o=>o>=t&&o<=e)))))).filter(Boolean));if(o.size>=this.growthFrequencyThreshold)throw new Error(`Potential memory leak detected: ${o.size} unique memory points in the last ${this.shortTermWindow/1e3} seconds.`)}checkLongTermGrowth(e,t){const o=t-this.startTimestamp;if(o>=this.longTermWindow){const i=(e-this.startMemorySize)/this.startMemorySize;if(i>this.longTermGrowthThreshold)throw new Error(`Potential memory leak detected: ${(100*i).toFixed(2)}% growth over ${(o/36e5).toFixed(2)} hours.`);this.startMemorySize=e,this.startTimestamp=t}}getUniqueMemoryPointCount(){return this.memoryPoints.size}getCurrentMemoryUsage(){return Array.from(this.memoryPoints).pop()}resetDetector(){this.memoryPoints.clear(),this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now()}}},30210:(e,t,o)=>{"use strict";o.d(t,{Nz:()=>i,Xe:()=>n,aU:()=>s,zb:()=>a});var i,n,r=o(25308);!function(e){e[e.OWA_REACT_COMPOSE=0]="OWA_REACT_COMPOSE",e[e.OUTLOOK_WEB_OA=1]="OUTLOOK_WEB_OA",e[e.OWA_PEOPLE_NAME_PRED=2]="OWA_PEOPLE_NAME_PRED",e[e.OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE=3]="OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE",e[e.DYNAMIC_SEARCH_BOX=4]="DYNAMIC_SEARCH_BOX",e[e.WORKPLACE_SEARCH=5]="WORKPLACE_SEARCH",e[e.COPILOT=6]="COPILOT",e[e.COPILOT_POWERPOINT=7]="COPILOT_POWERPOINT",e[e.BIZ_CHAT=1e4]="BIZ_CHAT"}(i||(i={})),function(e){e[e.SUBSTRATE_AAD=0]="SUBSTRATE_AAD",e[e.SUBSTRATE_MSA=1]="SUBSTRATE_MSA"}(n||(n={}));const s={emailId:"",puid:"",scenarios:[i.OWA_REACT_COMPOSE],market:"",tenantId:"",substrateAuthTokenType:n.SUBSTRATE_AAD,entityTypes:[r.ck.People,r.ck.File,r.ck.Scope],prefetchOnly:!1},a={wasmRoot:"graph-search-local"}},5561:(e,t,o)=>{"use strict";o.d(t,{A:()=>g});var i=o(68288),n=o(82540),r=o(12420),s=o(91432),a=o(82666),l=o(90628),c=o(16865),u=o(72320),d=o(15222);class h{constructor(){this.seqCounter=0,this.lastInput="",this.lastConversationId="",this.lastLogicalId=""}async init(e){}initialize(e){var t,o;!0!==this.initialized&&(this.enableUserInitiatedRequests=null===(t=null==e?void 0:e.flights)||void 0===t?void 0:t.hasFlight("mc-editor-oa-client-ecc"),this.enableSystemInitiatedRequest=null===(o=null==e?void 0:e.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-predictions"),this.initialized=!0)}async execute(e,t,o){this.executeInner(e,t,o),o.done()}executeInner(e,t,o){var i;if(s.tG.info(526713100,s.nh.WorkflowDefault,"Executing oa-client router workflow"),e&&e.content&&t&&o){if(this.initialize(t),l.Cg.typeGuard(e)||l.qf.typeGuard(e))if(null===(i=null==t?void 0:t.flights)||void 0===i?void 0:i.hasFlight("mc-editor-oa-client-router-refactor"))this.processTextTileInput(e.content,e,o,t);else{if(this.tryGenerateUserInitiatedRequest(e.content,e,o,t))return;this.tryGenerateSystemInitiatedRequest(e.content,e,o,t)}}else s.tG.warn(526713101,s.nh.WorkflowDefault,"unexpected inputs, ignoring request")}dispose(){this.seqCounter=0}processTextTileInput(e,t,o,r){var a,l,c,h,g,p,f;const m=(new Date).toISOString(),v=(0,d.K)("Router_UserInitiated",r).start(),b=r.delta,y=null!==(l=null===(a=null==b?void 0:b.additionalData)||void 0===a?void 0:a.conversationId)&&void 0!==l?l:"",C=null!==(h=null===(c=null==b?void 0:b.additionalData)||void 0===c?void 0:c.logicalId)&&void 0!==h?h:"",S=this.getValidUserInitQuery(t,r,v);if(S){const i=null!==(p=null===(g=null==b?void 0:b.additionalData)||void 0===g?void 0:g.scopeInfo)&&void 0!==p?p:void 0,n=void 0===i&&this.sameAsLastUserInitRequest(e,b),r=null!==(f=null==i?void 0:i.entityType)&&void 0!==f?f:"";return v.setDataFields({hasScope:void 0!==i,entityType:r,repeatedReuquest:n}),this.generateUserInitiatedRequest(e,t,o,S,C,y,i,v),void this.finalizeLogging(v,m,C,y)}if(this.enableUserInitiatedRequests){const e=new i.os({conversationId:null!=y?y:"",entityResults:[],logicalId:null!=C?C:"",status:n.i.EarlyExit});o.setAnnotations(t,i.os.getTypeName(),[e]),v.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"}),this.finalizeLogging(v,m,C,y)}else v.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),this.finalizeLogging(v,m,C,y);const w=(new Date).toISOString(),k=(0,d.K)("Router_SystemInitiated",r).start(),T=(0,u.A)();this.isValidSystemInitQuery(t,r,k)?this.generateSystemInitiatedRequest(e,t,o,T,k):this.enableSystemInitiatedRequest?k.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"}):k.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),s.tG.info(508408097,s.nh.WorkflowDefault,`sending SystemInitiatedRequestClient (${this.seqCounter})`),this.finalizeLogging(k,w,T)}finalizeLogging(e,t,o,i){const n=(new Date).toISOString();i&&e.setDataFields({conversationId:i}),e.setDataFields({startTimeStamp:t,endTimeStamp:n,logicalId:o}),s.tG.info(508356445,s.nh.WorkflowDefault,e.stop())}generateUserInitiatedRequest(e,t,o,i,n,s,a,l){if(!this.enableUserInitiatedRequests)return void l.setDataFields({statusDescription:"Request skipped because required flight is missing"});const c=new r.VP({content:this.sanitizeText(e),logicalId:n,conversationId:s,seq:++this.seqCounter,scope:a,...i});o.setAnnotations(t,r.VP.getTypeName(),[c]),l.setDataFields({statusDescription:"User-Initiated request generated"})}generateSystemInitiatedRequest(e,t,o,i,n){if(!this.enableSystemInitiatedRequest)return void n.setDataFields({statusDescription:"Request skipped because required flight is missing"});const s=new r.JM({content:this.sanitizeText(e),logicalId:i,seq:++this.seqCounter});o.setAnnotations(t,r.JM.getTypeName(),[s]),n.setDataFields({statusDescription:"System-Initiated request generated"})}tryGenerateUserInitiatedRequest(e,t,o,a){var l,c,u,h,g,p,f,m;let v=!1;const b=(new Date).toISOString(),y=(0,d.K)("Router_UserInitiated",a).start(),C=a.delta,S=null!==(c=null===(l=null==C?void 0:C.additionalData)||void 0===l?void 0:l.conversationId)&&void 0!==c?c:"",w=null!==(h=null===(u=null==C?void 0:C.additionalData)||void 0===u?void 0:u.logicalId)&&void 0!==h?h:"";if(null===(g=null==a?void 0:a.flights)||void 0===g?void 0:g.hasFlight("mc-editor-oa-client-ecc")){const s=this.getValidUserInitQuery(t,a,y);if(s){const i=null!==(f=null===(p=null==C?void 0:C.additionalData)||void 0===p?void 0:p.scopeInfo)&&void 0!==f?f:void 0,n=void 0===i&&this.sameAsLastUserInitRequest(e,C),a=null!==(m=null==i?void 0:i.entityType)&&void 0!==m?m:"";y.setDataFields({hasScope:void 0!==i,entityType:a,repeatedReuquest:n});const l=new r.VP({content:this.sanitizeText(e),logicalId:w,conversationId:S,seq:++this.seqCounter,scope:i,...s});o.setAnnotations(t,r.VP.getTypeName(),[l]),y.setDataFields({statusDescription:"User-Initiated request generated"}),v=!0}else{const e=new i.os({conversationId:null!=S?S:"",entityResults:[],logicalId:null!=w?w:"",status:n.i.EarlyExit});o.setAnnotations(t,i.os.getTypeName(),[e]),y.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"})}}else y.setDataFields({statusDescription:"Request skipped because required flight is missing"});const k=(new Date).toISOString();return y.setDataFields({startTimeStamp:b,endTimeStamp:k,conversationId:S,logicalId:w}),s.tG.info(508409808,s.nh.WorkflowDefault,y.stop()),v}tryGenerateSystemInitiatedRequest(e,t,o,i){var n;const a=(new Date).toISOString(),l=(0,d.K)("Router_SystemInitiated",i).start(),c=(0,u.A)();if(null===(n=null==i?void 0:i.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-predictions")){if(this.isValidSystemInitQuery(t,i,l)){const i=new r.JM({content:this.sanitizeText(e),logicalId:c,seq:++this.seqCounter});o.setAnnotations(t,r.JM.getTypeName(),[i]),l.setDataFields({statusDescription:"System-Initiated request generated"})}else l.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"});s.tG.info(508409807,s.nh.WorkflowDefault,`sending SystemInitiatedRequestClient(${this.seqCounter})`)}else l.setDataFields({statusDescription:"Request skipped because required flight is missing"});const h=(new Date).toISOString();l.setDataFields({startTimeStamp:a,endTimeStamp:h,logicalId:c}),s.tG.info(508409806,s.nh.WorkflowDefault,l.stop())}sanitizeText(e,t){if("number"!=typeof(null==e?void 0:e.length))return"";"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1));const o=e.replace(/\s/g," ");return t?o.trim():o}sameAsLastUserInitRequest(e,t){var o,i,n,r;const s=null!==(i=null===(o=null==t?void 0:t.additionalData)||void 0===o?void 0:o.conversationId)&&void 0!==i?i:"",a=null!==(r=null===(n=null==t?void 0:t.additionalData)||void 0===n?void 0:n.logicalId)&&void 0!==r?r:"";let l=!1;return e===this.lastInput&&s===this.lastConversationId&&a===this.lastLogicalId&&(l=!0),this.lastInput=e,this.lastConversationId=s,this.lastLogicalId=a,l}getValidUserInitQuery(e,t,o){var i,n;if(!l.Cg.typeGuard(e))return void o.setDataFields({statusDescription:"Invalid input type"});const r=e;if((null===(i=t.delta)||void 0===i?void 0:i.unit)!==c.OD.Chars&&this.sanitizeText(r.content,!0).length<1)return void o.setDataFields({statusDescription:"Ignore empty tile"});const s=t.delta;if(s&&(s.unit!==c.OD.Sentence||s.queryRange&&s.content)){const t=e.content;let i;const r=s.queryRange;if(r){const{length:e,start:o}=r,s=null!==(n=r.prefix)&&void 0!==n?n:h.userInitiatedIntentChar;i={query:this.sanitizeText(t.substring(o+s.length,o+e)),queryChar:s,queryCharIndex:o}}else o.setDataFields({statusDescription:"Invalid or non-existent queryRange provided."});if(i){const e={start:i.queryCharIndex,end:i.queryCharIndex+i.query.length+1};return(s.position>=e.start||s.position+s.content.length>=e.start)&&s.position<=e.end?(o.setDataFields({seqCounter:this.seqCounter,querylength:r.length}),i):void o.setDataFields({statusDescription:"Delta outside of query bounds"})}o.setDataFields({statusDescription:"Invalid query to generate user init request."})}else o.setDataFields({statusDescription:"Delta is undefined. Cannot proceed with query detection logic."})}isValidSystemInitQuery(e,t,o){var i;if(!l.Cg.typeGuard(e))return o.setDataFields({statusDescription:"Invalid input type, ignore"}),!1;const n=e.content,r=this.sanitizeText(n,!0),s=t.delta;if(!s)return o.setDataFields({statusDescription:"Delta is undefined."}),!1;{if(s.unit===c.OD.Sentence||s.unit===c.OD.Paragraph)return!1;if(s.unit!==c.OD.Chars&&r.length<1)return o.setDataFields({statusDescription:"Empty tile, ignore"}),!1;const e=n.endsWith("\n")?n.substring(0,n.length-1):n;if((null===(i=null==t?void 0:t.flights)||void 0===i?void 0:i.hasFlight("mc-editor-oa-client-router-refactor"))&&s.position>=e.length-1)return!0;if(s.position>=e.length-1&&h.triggerCharacters.has(r[r.length-1]))return o.setDataFields({statusDescription:"Router should not generate system initiated requests for ECC requests"}),!1}return!0}}h.userInitiatedIntentChar="@",h.triggerCharacters=new Set(["@","/"]);const g=a.z.create("oaClientRouter").setInputTypes([l.qf.getTypeName()]).setOutputTypes([i.os.getTypeName(),r.JM.getTypeName(),r.VP.getTypeName()]).setLambdaType((()=>new h))},16232:(e,t,o)=>{"use strict";o.d(t,{TE:()=>y});var i=o(38279),n=o(68288),r=o(82540),s=o(90628),a=o(66656),l=o(91432),c=o(15222),u=o(67041);const d=new Map([[i.c.People,1300],[i.c.PeopleInGroup,1250],[i.c.File,1200],[i.c.Event,1100],[i.c.Message,1e3],[i.c.Chat,920],[i.c.Team,910],[i.c.Channel,900],[i.c.MessageExtensionApp,800],[i.c.External,700],[i.c.Topic,600],[i.c.Loop,500],[i.c.Address,400],[i.c.Scope,100],[i.c.App,90],[i.c.Prompt,85],[i.c.CopilotPlugin,80]]),h=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,g=e=>{const t=d.get(e);return void 0===t?(l.tG.error(509743565,l.nh.WorkflowDefault,`unsupported entity type:'${e}'`),1):t},p=(e,t)=>{const o=g(e.entityType),i=g(t.entityType);return o===i?(l.tG.warn(509743564,l.nh.WorkflowDefault,`unexpected priority:'${e.entityType}','${t.entityType}'`),e.entityType.localeCompare(t.entityType)):i-o},f=(e,t,o)=>{t||l.tG.warn(e,l.nh.WorkflowDefault,o)};class m{constructor(){this.seqCounter=0,this.seqCounter=0}async init(e){this.seqCounter=0}async execute(e,t,o,i){const r=(new Date).toISOString();l.tG.info(524066818,l.nh.WorkflowDefault,`Executing oa-client client-server ranker workflow. sequence number : ${this.seqCounter}`),this.seqCounter++;const s=(0,c.K)("Ranker_Ecc",o).start(),a=this.getRankedResults(t,s);a&&i.setAnnotations(e,n.c$.getTypeName(),[a]);const u=(new Date).toISOString();s.setDataFields({startTimeStamp:r,endTimeStamp:u}),l.tG.info(512500928,l.nh.WorkflowDefault,s.stop()),i.done()}dispose(){this.seqCounter=0}getRankedResults(e,t){var o,i,s,a,c,d,g,m,v,b,y,C;if(0===e.length||this.seqCounter<0)return t.success=!1,t.resultDescription="oa-client-server ecc result ranker lambda has no inputs",void l.tG.warn(524066819,l.nh.WorkflowDefault,t.resultDescription);if(e.length>2)return t.success=!1,t.resultDescription="Unexpected. Client-server ranker can never have more than 2 inputs",void l.tG.warn(523854672,l.nh.WorkflowDefault,t.resultDescription);const S=null!==(i=null===(o=e[0])||void 0===o?void 0:o.conversationId)&&void 0!==i?i:"",w=null!==(a=null===(s=e[0])||void 0===s?void 0:s.logicalId)&&void 0!==a?a:"";if(t.setDataFields({conversationId:S,logicalId:w}),0===(e=e.filter((e=>e.status!==r.i.EarlyExit))).length)return t.success=!0,t.resultDescription="oa-client-server ecc result ranker skipping execution due to receiving early-exit annotations only",void l.tG.warn(509112707,l.nh.WorkflowDefault,t.resultDescription);const k=e.length.toString(),T=e.map((e=>e.ownerId)).join(";");let x;if(t.setDataFields({providerCount:k,souces:T}),1===e.length&&e[0].entityResults)x=new n.c$({conversationId:S,entityResults:e[0].entityResults,logicalId:w,status:e[0].status,treatments:e[0].treatments});else{const t=new Map,o=e[0].entityResults.length>=e[1].entityResults.length?0:1,i=(o+1)%2,s=new Set,a=e[o];for(let o=0;o<a.entityResults.length;++o){const n=a.entityResults[o],r=n.entityType;s.add(r);const l=n.entities,c=e[i];let u=n.modelInfo,d=l,h=a.entityResults[o].intent;for(let e=0;e<c.entityResults.length;++e){const t=c.entityResults[e];if(r===t.entityType){const o=c.entityResults[e].intent;o&&(h=Math.max(null!=h?h:0,o)),d=this.getDeDupedEntityList(l,t.entities),u=this.getMergedModelInfo(n.modelInfo,t.modelInfo);break}}const g={entities:d,entityType:r,modelInfo:u,intent:h};t.set(r,g)}const k=e[i];for(let e=0;e<k.entityResults.length;++e){const o=k.entityResults[e],i=o.entityType;s.has(i)||t.set(i,o)}const T=Array.from(t.values()).sort(p),I=[];let _=[],E=!1;if((0,u.I)("UseLocallyGeneratedBM")&&(null===(c=null==a?void 0:a.entityResults)||void 0===c?void 0:c.length)>0&&"GraphSearchClient"===(null==a?void 0:a.ownerId)&&(null===(g=null===(d=null==a?void 0:a.treatments)||void 0===d?void 0:d.bestMatchEntries)||void 0===g?void 0:g.length)>0)_=a.treatments.bestMatchEntries;else if((0,u.I)("UseLocallyGeneratedBM")&&(null===(m=null==k?void 0:k.entityResults)||void 0===m?void 0:m.length)>0&&"GraphSearchClient"===(null==k?void 0:k.ownerId)&&(null===(b=null===(v=null==k?void 0:k.treatments)||void 0===v?void 0:v.bestMatchEntries)||void 0===b?void 0:b.length)>0)_=k.treatments.bestMatchEntries;else{const e=null===(y=null==a?void 0:a.treatments)||void 0===y?void 0:y.bestMatchEntries,t=null===(C=null==k?void 0:k.treatments)||void 0===C?void 0:C.bestMatchEntries;if(e)for(let t=0;t<e.length;t++)I.push(e[t]);if(t)for(let e=0;e<t.length;e++)I.push(t[e]);_=I.sort(((e,t)=>h(t.confidence)-h(e.confidence))).sort(p).slice(0,3),E=((e,t)=>{var o;const i=null===(o=t.find((e=>e.entities.length>0)))||void 0===o?void 0:o.entityType,n=i&&!e.some((e=>e.entityType!=i));return n&&l.tG.info(509662157,l.nh.WorkflowDefault,"Best Match results suppressed"),n})(_,T)}f(520135894,(null==a?void 0:a.conversationId)===(null==k?void 0:k.conversationId),"Unexpected mismatch of conversation id in ranker"),f(520135893,(null==a?void 0:a.logicalId)===(null==k?void 0:k.logicalId),"Unexpected mismatch of logical id in ranker"),x=new n.c$({conversationId:null!=S?S:"",entityResults:T,logicalId:null!=w?w:"",status:0===T.length?r.i.NoResults:r.i.Success,treatments:new n.Fe({bestMatchEntries:E?[]:_})})}var I;return t.setDataFields({entityCount:(I=[x],I.reduce(((e,t)=>{var o;return e+((null===(o=t.entityResults)||void 0===o?void 0:o.reduce(((e,t)=>{var o;return e+((null===(o=t.entities)||void 0===o?void 0:o.length)||0)}),0))||0)}),0).toString())}),x}getDeDupedEntityList(e,t){const o=[],i=new Set;for(let t=0;t<e.length;++t){const n=e[t],r=n.text.toLocaleLowerCase();i.has(r)||(i.add(r),o.push(n))}for(let e=0;e<t.length;++e){const n=t[e];i.has(n.text.toLocaleLowerCase())||o.push(n)}return o}getMergedModelInfo(e,t){return{elapsedTime:Math.max(e.elapsedTime,t.elapsedTime),name:`${e.name}|${t.name}`,version:`${e.version}|${t.version}`}}}const v=()=>new m,b=(e,t)=>a.a.create("OaClientServerEccResultRanker").setCollectionScopeType(s.Cg.getTypeName()).setInputTypes(t).setOutputTypes([n.c$.getTypeName()]).setMaxAnnotations(e).setMaxDelayTime(3400).setLambdaType(v),y=(b(2,[n.J2.getTypeName(),n.os.getTypeName()]),b(2,[n.os.getTypeName()]))},15222:(e,t,o)=>{"use strict";if(o.d(t,{K:()=>n}),3023==o.j)var i=o(5629);const n=(e,t)=>{var o,n;const r=new i.I({operationName:e,success:!0,resultDescription:"",ariaTenant:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ariaNamespace:"Oa_Client"});return r.setClientMetadata(null==t?void 0:t.clientMetadata),r.setUserContext(null==t?void 0:t.userContext),r.setDataFields({contextId:null===(n=null===(o=null==t?void 0:t.model)||void 0===o?void 0:o.scopeItem)||void 0===n?void 0:n.getContextId()}),r}},41335:(e,t,o)=>{"use strict";var i;o.d(t,{N:()=>i}),function(e){e[e.GENERIC=0]="GENERIC",e[e.OFFICE=1]="OFFICE",e[e.SVG=2]="SVG"}(i||(i={}))},17417:(e,t,o)=>{"use strict";o.d(t,{z:()=>i});const i=(0,o(41509).f)("IEditorSettingsState")},68191:(e,t,o)=>{"use strict";if(o.d(t,{K2:()=>s,KV:()=>a,Pe:()=>r,Sg:()=>c,ug:()=>l}),3023==o.j)var i=o(90730);if(3023==o.j)var n=o(84874);const r=e=>{const t=e;return void 0!==t.x&&void 0!==t.y},s=e=>{const t=e;return void 0!==t.left&&void 0!==t.top&&void 0!==t.width&&void 0!==t.height};function a(e){return e?e instanceof HTMLElement?e:s(e)?new n.M(e.left,e.right,e.top,e.bottom):r(e)?e:e.getBoundingClientRect():null}function l(e){if(e)return s(e)?{getBoundingClientRect:()=>{var t,o;return{x:e.left,y:e.top,top:e.top,left:e.left,bottom:null!==(t=e.bottom)&&void 0!==t?t:0,right:null!==(o=e.right)&&void 0!==o?o:0,width:e.width,height:e.height}}}:r(e)?{getBoundingClientRect:()=>({x:e.x,y:e.y,top:e.y,left:e.x,bottom:e.y,right:e.x,width:0,height:0})}:e}function c(e,t){if(void 0===e)return{position:"below",align:"start"};if(t)return{position:"above",align:"start"};switch(e){case i.A.topLeftEdge:return{position:"above",align:"start"};case i.A.topCenter:case i.A.topAutoEdge:return{position:"above",align:"center"};case i.A.topRightEdge:return{position:"above",align:"end"};case i.A.bottomLeftEdge:return{position:"below",align:"start"};case i.A.bottomCenter:case i.A.bottomAutoEdge:return{position:"below",align:"center"};case i.A.bottomRightEdge:return{position:"below",align:"end"};case i.A.leftTopEdge:return{position:"before",align:"top"};case i.A.leftCenter:return{position:"before",align:"center"};case i.A.leftBottomEdge:return{position:"before",align:"bottom"};case i.A.rightTopEdge:return{position:"after",align:"top"};case i.A.rightCenter:return{position:"after",align:"center"};case i.A.rightBottomEdge:return{position:"after",align:"bottom"}}}},45204:(e,t,o)=>{"use strict";function i(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const o=new URL(e),i=t.trim();return o.pathname.endsWith("/")?o.pathname+=i:o.pathname=`${o.pathname}/${i}`,o.toString()}o.d(t,{W:()=>i})},29446:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(45204);function n(e,t=""){const o=null===t?e:(0,i.W)(e,t);window.open(o,"_blank","noopener,noreferrer")}},62898:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>a}),3023==o.j)var i=o(14336);if(3023==o.j)var n=o(82652);if(3023==o.j)var r=o(30757);if(3023==o.j)var s=o(83901);class a{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918409)}configureRootServices(e){e.bind(i.C).toDynamicValue((e=>{const t=e.get(s.n);return new n.t(t.defaultLocale)}))}}},75231:(e,t,o)=>{"use strict";o.d(t,{t:()=>r});var i=o(73027),n=o(11049);let r=class{setOnFeedbackIconClicked(e){this._onFeedbackIconClicked=e}feedbackIconClicked(e,t){this._onFeedbackIconClicked&&this._onFeedbackIconClicked(e,t)}};r=(0,i.Cg)([(0,n._)()],r)},39019:(e,t,o)=>{"use strict";if(o.d(t,{cl:()=>s,nv:()=>l}),3023==o.j)var i=o(64949);if(3023==o.j)var n=o(86997);if(3023==o.j)var r=o(72659);const s=(0,o(41509).f)("HostCallbacksTransformer");class a{constructor(e,t,o,i,n,r){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=o,this.logger=i,this.clientRuntime=n,this.aggregateLogger=r}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let o=t;for(const t of e)o=t(o,this);return o},this}async build(e,t){try{const e=await this.createClientMetadata(),o=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),i=this.createRuntimeOptions();return await this.runPreRuntimeInit(e,i),await this.initClientRuntime(e,o,i),{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const o=n.h.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:o,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(o,t)}logAnnotationResultItem(e,t){var o;const i=t.body?n.h.getTypeNameFor(t.body):"unknown";null===(o=this.aggregateLogger)||void 0===o||o.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:i,operationType:e}))}async createClientMetadata(){var e,t,o,i,n,r;const s={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(i=null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.appPlatform)&&void 0!==i?i:"Online",releaseAudienceGroup:null===(n=this.hostSettings.hostMetadata)||void 0===n?void 0:n.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(r=this.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId},a=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return a&&(s.flights=a.value),s}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var o;let i;return i=(null===(o=this.hostSettings.orchestratorSettings)||void 0===o?void 0:o.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,i},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(0,r.U)(this.telemetrySink)}}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var o;(null===(o=this.hostSettings.orchestratorSettings)||void 0===o?void 0:o.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((o=>o(e,t))))}async initClientRuntime(e,t,o){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,o)}createSession(e){var t;const o=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new i.L).generate();return this.clientRuntime.createSession({docSessionId:o})}}const l=(e,t,o,i,n,r)=>new a(e,t,o,i,n,r)},27413:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>p}),3023==o.j)var i=o(53153);if(3023==o.j)var n=o(30757);if(3023==o.j)var r=o(83901);if(3023==o.j)var s=o(70468);if(3023==o.j)var a=o(76595);if(3023==o.j)var l=o(86752);if(3023==o.j)var c=o(37800);if(3023==o.j)var u=o(58206);if(3023==o.j)var d=o(12962);if(3023==o.j)var h=o(39019);const g=(0,o(41509).f)("IClientRuntime");class p{constructor(){this.imports=[u.E]}get uniqueId(){return(0,n.z)(507918289)}configureRootServices(e){var t;const o=e.get(r.n);(null===(t=o.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&o.orchestratorSettings.augLoopEndpoint&&(e.bind(g).toDynamicValue((()=>(0,d.xB)())),e.bind(i.a).toDynamicValue((e=>(t,o)=>{const i=e.get(r.n),n=e.get(c.o),u=e.get(s.qy),d=e.get(a.g),p=e.getOptional(l.v),f=e.get(g),m=(0,h.nv)(i,n,u,d,f,p),v=e.getAll(h.cl);return m.withHostCallbacksCustomizations(v),m.build(t,o)})))}}},68358:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>c}),3023==o.j)var i=o(30757);if(3023==o.j)var n=o(83901);if(3023==o.j)var r=o(45313);if(3023==o.j)var s=o(131);if(3023==o.j)var a=o(37853);if(3023==o.j)var l=o(63545);class c{constructor(){this.imports=[a.g]}get uniqueId(){return(0,i.z)(507918402)}configureRootServices(e){e.bind(s.R9).toDynamicValue((e=>{const t=e.get(n.n);return new s.R9({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(r.S).to(l.M)}}},72659:(e,t,o)=>{"use strict";o.d(t,{U:()=>r});const i="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",n=(e,t)=>{const o=[];for(const n of Object.keys(e)){if(void 0===e[n]||null===e[n])continue;const r={name:t?`${t}.${n}`:n,dataType:(i=e[n],"string"==typeof i?0:"boolean"==typeof i?1:"number"==typeof i?2:0),value:e[n],classification:4};o.push(r)}var i;return o};function r(e){return(t,o,r,s,a,l,c,u)=>{const d=t===i;let h,g=n(r);if(s){let e=n(a,s.split(".").slice(-1)[0]);d&&(e=[...e,...g],g=[]),h={name:s,dataFields:e}}const p={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:o,dataFields:g,eventFlags:{dataCategories:c,diagnosticLevel:u},eventContract:h};e.sendTelemetryEvent(p)}}},63545:(e,t,o)=>{"use strict";o.d(t,{M:()=>g});var i=o(73027),n=o(48883),r=o(25555),s=o(83901),a=o(76595),l=o(87662),c=o(131),u=o(11049),d=o(41453),h=o(9806);let g=class{constructor(e,t,o,i,n,r){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=o,this._hostSettings=i,this._logger=n,this._sessionContextProvider=r}async initialize(){this._hostEmitter.on(n.pD.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const o=await this._sessionContextProvider();return o.sessionId&&(this._editorService.xUserSessionId=o.sessionId),o.composeSessionId&&(this._editorService.xUserComposeSessionId=o.composeSessionId),function(e,t,o){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let i=h.G_.NoLicense;t?i=h.G_.Subscription:o&&(i=o),null==e||e.push({name:"LicenseType",value:i})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};g=(0,i.Cg)([(0,u._)(),(0,i.Qj)(0,(0,d.W)(r.e)),(0,i.Qj)(1,(0,d.W)(n.M5)),(0,i.Qj)(2,(0,d.W)(c.R9)),(0,i.Qj)(3,(0,d.W)(s.n)),(0,i.Qj)(4,(0,d.W)(a.g)),(0,i.Qj)(5,(0,d.W)(l.a))],g)},88290:(e,t,o)=>{"use strict";o.d(t,{u:()=>u});var i=o(56415),n=o(22474),r=o(36284),s=o(20176),a=o(69920),l=o(59696);const c=(0,n.F5)({state:r.A.on(a.JY),featureFlagsReader:r.A.on(l.c)}),u=(0,s.PA)((()=>{const{featureFlagsReader:e,state:t}=(0,n.KN)(c),{politeUpdates:o,assertiveUpdates:r,status:s,statusSeverity:a}=t,l={width:0,height:0,color:"transparent",background:"none",border:"none",outline:"none",overflow:"hidden",pointerEvents:"none"};return window.self===window.top||e.flags.enableAriaStatusInNonRootIFrames?i.createElement(i.Fragment,null,s&&i.createElement("div",{role:"status","aria-live":a,"aria-label":s,style:l}),0!==r.length&&i.createElement("div",{role:"log","aria-live":"assertive",style:l},r),0!==o.length&&i.createElement("div",{role:"log","aria-live":"polite",style:l},o)):null}))},26433:(e,t,o)=>{"use strict";o.d(t,{Jx:()=>i,XG:()=>d,mU:()=>u});var i,n=o(73027),r=o(66131),s=o(69920),a=o(41509),l=o(11049),c=o(41453);!function(e){e[e.KeepOriginal=0]="KeepOriginal",e[e.AutoCorrectAppearance=1]="AutoCorrectAppearance",e[e.AutoCorrectHover=2]="AutoCorrectHover",e[e.SingleIssueOnLine=3]="SingleIssueOnLine",e[e.IssuesOnLine=4]="IssuesOnLine"}(i||(i={}));const u=(0,a.f)("IAriaStatusUniqueProxy");let d=class{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.existingCritiques=new Set,this.completeStatusMessage=(e,t)=>{const o=this.getMessageKey(t);if(!o)return e;let n=this.localizer.getMessage(o,e);return t===i.AutoCorrectHover&&(n=`${n} ${this.localizer.getMessage("ebx_autoCorrectedKeyboardAccess")}`),n},this.getMessageKey=e=>e===i.AutoCorrectAppearance||e===i.AutoCorrectHover?"ebx_autoCorrected":e===i.SingleIssueOnLine?"ebx_issuesOnLineSingular":e===i.IssuesOnLine?"ebx_issuesOnLinePlural":void 0}setStatus(e,t,o=!1,i,n){if(i&&o){if(this.existingCritiques.has(i))return;this.existingCritiques.add(i)}const r=void 0===n?e:this.completeStatusMessage(e,n);this.ariaStatusStateStore.setStatus(r,t,o)}addPreservedStatuses(e,t){const o=e.filter((e=>{const t=this.existingCritiques.has(e.id);return t||this.existingCritiques.add(e.id),!t})).map((e=>void 0===e.messageKind?e.text:this.completeStatusMessage(e.text,e.messageKind)));this.ariaStatusStateStore.addPreservedStatuses(o,t)}setLineNavStatus(e,t,o){e<1||this.setStatus(e.toLocaleString(),t,o,void 0,1===e?i.SingleIssueOnLine:i.IssuesOnLine)}};d=(0,n.Cg)([(0,l._)(),(0,n.Qj)(0,(0,c.W)(s.JY)),(0,n.Qj)(1,(0,c.W)(r.H))],d)},17088:(e,t,o)=>{"use strict";o.d(t,{v:()=>g});var i=o(22474),n=o(36284),r=o(64944),s=o(83901),a=o(3428),l=o(57566),c=o(8207),u=o(56415);const d=u.createContext(void 0),h=(0,i.F5)({languageScriptDirectionDetector:n.A.on(r.iw).optional(),hostSettings:n.A.on(s.n).optional()}),g=u.forwardRef(((e,t)=>{var o,n,r,s;const{hostSettings:g,languageScriptDirectionDetector:p}=(0,i.SM)(h),f=u.useContext(d),m=u.useRef(null),v=(null===(o=e.popover)||void 0===o?void 0:o.positioning).target;return u.useImperativeHandle(t,(()=>({getElementRef:()=>m}))),u.useEffect((()=>{var e;const t=m.current;return null===(e=null==g?void 0:g.onCalloutOpened)||void 0===e||e.call(g,t,v,f),()=>{var e;null===(e=null==g?void 0:g.onCalloutClosed)||void 0===e||e.call(g,t,v,f)}}),[g,f,v]),u.createElement(a.A,Object.assign({},e.popover,{"aria-label":null===(n=e.popover)||void 0===n?void 0:n.ariaLabel,"aria-labelledBy":null===(r=e.popover)||void 0===r?void 0:r.ariaLabelledBy,"aria-role":null===(s=e.popover)||void 0===s?void 0:s.ariaRole}),u.createElement(l.H,Object.assign({},e.surface,{ref:m,dir:null==p?void 0:p.dir()}),void 0===p?e.children:u.createElement(c.K,{rtl:p.isRtl()},e.children)))}))},43726:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=(0,o(41509).f)("ICritiqueCalloutStateStoreBase")},87964:(e,t,o)=>{"use strict";o.d(t,{x:()=>i});const i=(0,o(41509).f)("IUndoCalloutStateStoreBase")},55180:(e,t,o)=>{"use strict";o.d(t,{D:()=>r,Y:()=>i});var i,n=o(41509);!function(e){e.critique="critique",e.inlineSuggestions="inlineSuggestions",e.languageAutoDetection="languageAutoDetection"}(i||(i={}));const r=(0,n.f)("IFooterFreStore")},81406:(e,t,o)=>{"use strict";function i(e){if(null===r&&function(){r={};for(const e in s)r[e]=new RegExp("["+s[e]+"]","g")}(),e&&!function(e){null===n&&function(){let e="[";for(const t in s)e+=s[t];e+="]",n=new RegExp(e)}();return!(null==n?void 0:n.test(e.toLowerCase()))}(e))for(const t in r)e=e.replace(r[t],t);return e}o.d(t,{S:()=>i});let n=null,r=null;const s={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",2:"",3:"",:"",1:"",ae:"",th:"",ss:"",:"",oe:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",pts:"",tm:"",:"",4:"",5:"",6:"",7:"",8:"",9:"",10:"",11:"",12:"",13:"",14:"",15:"",16:"",17:"",18:"",19:"",20:"",0:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",21:"",22:"",23:"",24:"",25:"",26:"",27:"",28:"",29:"",30:"",31:"",32:"",33:"",34:"",35:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",36:"",37:"",38:"",39:"",40:"",41:"",42:"",43:"",44:"",45:"",46:"",47:"",48:"",49:"",50:"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"",hg:"",erg:"",ev:"",ltd:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","0":"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"",hpa:"",da:"",au:"",bar:"",ov:"",pc:"",dm:"",dm2:"",dm3:"",iu:"",:"",:"",:"",:"",:"",pa:"",na:"",a:"",ma:"",ka:"",kb:"",mb:"",gb:"",cal:"",kcal:"",pf:"",nf:"",f:"",g:"",mg:"",kg:"",hz:"",khz:"",mhz:"",ghz:"",thz:"",:"",m:"",d:"",k:"",fm:"",nm:"",m:"",mm:"",cm:"",km:"",mm2:"",cm2:"",m2:"",km2:"",mm3:"",cm3:"",m3:"",km3:"",ms:"",ms2:"",kpa:"",mpa:"",gpa:"",rad:"",rads:"",rads2:"",ps:"",ns:"",s:"",pv:"",nv:"",v:"",mv:"",kv:"",pw:"",nw:"",w:"",mw:"",kw:"",k:"",m:"",am:"",bq:"",cc:"",cd:"",ckg:"",co:"",db:"",gy:"",ha:"",hp:"",in:"",kk:"",kt:"",lm:"",ln:"",log:"",lx:"",mil:"",mol:"",ph:"",pm:"",ppm:"",pr:"",sr:"",sv:"",wb:"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""}},6798:(e,t,o)=>{"use strict";o.r(t),o.d(t,{mockInlineSuggestions:()=>r});var i=o(38279),n=o(59187);const r=[{entities:[{entityType:i.c.People,Id:"0",text:"Annie Reid",EmailAddresses:["areid@microsoft.com"],confidence:0},{entityType:i.c.People,Id:"0",text:"Ed Taylor",EmailAddresses:["et@microsoft.com"],confidence:0},{entityType:i.c.People,Id:"0",text:"Clippy",EmailAddresses:["clippy@microsoft.com"],confidence:0}],entityType:i.c.People},{entities:[{entityType:i.c.File,Id:"0",FileSourceType:"Unknown",text:"Feature Spec",FileName:"Feature Spec",FileExtension:"Docx",FileSize:1e3,AccessUrl:"mockFile.gg/FeatureSpec",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"1",FileSourceType:"Unknown",text:"Planning Deck",FileName:"Planning Deck",FileExtension:"pptx",FileSize:1e3,AccessUrl:"mockFile.gg/PlanningDeck",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",isBestMatch:!0,confidence:0},{entityType:i.c.File,Id:"2",FileSourceType:"Unknown",text:"Crunched Numbers",FileName:"Crunched Numbers",FileExtension:"xls",FileSize:1e3,AccessUrl:"mockFile.gg/CrunchedNumbers",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"3",FileSourceType:"Unknown",text:"Some Contract with a very very long name",FileName:"Some Contract with a very very long name",FileExtension:"pdf",FileSize:1e3,AccessUrl:"mockFile.gg/contract",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"4",FileSourceType:"Unknown",text:"Even more files",FileName:"Even more files",FileExtension:"txt",FileSize:1e3,AccessUrl:"mockFile.gg/txt",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0}],entityType:i.c.File},{entities:[{ContentDomainName:"People",ScopeTitle:"Insert People",ScopeDescription:"Search people in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",entityType:i.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",text:"Insert People",scopeInfo:{entityType:"People",contentSource:""},confidence:0},{ContentDomainName:"Files",ScopeTitle:"Insert Files",ScopeDescription:"Search files in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",entityType:i.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",text:"Insert Files",scopeInfo:{entityType:"File",contentSource:""},confidence:0},{ItemId:"Ci7lEZX87y1MfPYPsAnbHw",Title:"FL Desktop 2.0",Url:"https://www.figma.com/file/Ci7lEZX87y1MfPYPsAnbHw",IconUrl:"https://figmaconnector.blob.core.windows.net/assets/icons/figma-logo.svg",ContentDomainId:"nonEssFigmaConnector",Authors:[],LastModifiedDateTimeUtc:"2022-04-26T03:57:42",CreatedTimeUtc:"2022-04-26T03:57:42",Text:"FL Desktop 2.0",PropertyHits:[],ReferenceId:"e60f6f30-9164-8d5e-7451-1da86e66df64.7000.22",entityType:i.c.External,Id:"Ci7lEZX87y1MfPYPsAnbHw",text:"FL Desktop 2.0",confidence:0}],entityType:i.c.Scope},{entities:[{entityType:i.c.Loop,Id:"0",text:"Action Items",icon:{iconName:"FFXCCompleted"},confidence:0},{entityType:i.c.Loop,Id:"0",text:"Bulleted List",icon:{iconName:"FFXCBulletedList"},confidence:0},{entityType:i.c.Loop,Id:"0",text:"Checklist",icon:{iconName:"FFXCChecklist"},confidence:0}],entityType:i.c.Loop},{entities:[{entityType:i.c.MessageExtensionApp,AppId:"ExcelOnline",DisplayName:"Excel",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.1",Id:"ExcelOnline",text:"Excel",confidence:0},{entityType:i.c.MessageExtensionApp,AppId:"f12466e6-a66c-495f-86f5-135938125391",DisplayName:"Azure DevOps (Internal)",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.2",Id:"f12466e6-a66c-495f-86f5-135938125391",text:"Azure DevOps (Internal)",confidence:0}],entityType:i.c.MessageExtensionApp},{entityType:i.c.Event,entities:[{entityType:i.c.Event,confidence:1,text:"Multiday meeting",EventId:{Id:"id1"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",HasRecording:!0,isBestMatch:!0},{entityType:i.c.Event,confidence:1,text:"Sameday meeting",EventId:{Id:"id2"},Start:"2023-05-12T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",isBestMatch:!0},{entityType:i.c.Event,confidence:1,text:"Multiday all day meeting",EventId:{Id:"id3"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",IsAllDay:!0}]},{entityType:i.c.Message,entities:[{entityType:i.c.Message,confidence:1,text:"Error while running Local IIS",Subject:"Error while running Local IIS",From:{EmailAddress:{Name:"John Doe"}},ItemId:{Id:"id1"}},{entityType:i.c.Message,confidence:1,text:"RE: Enable console logging question",Subject:"RE: Enable console logging question",From:{EmailAddress:{Name:"Jane Doe"}},ItemId:{Id:"id2"}}]},{entityType:i.c.Chat,entities:[{entityType:i.c.Chat,confidence:1,text:"Group Chat",Name:"Group Chat",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4,ChatMembers:[{Id:"1",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"John Doe"}]},{entityType:i.c.Chat,confidence:1,text:"Group Chat 2",Name:"Group Chat 2",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:5,ChatMembers:[{Id:"1",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"John Doe"},{Id:"2",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"Jane Doe"}]}]},{entityType:i.c.Channel,entities:[{entityType:i.c.Channel,confidence:1,text:"Developer Channel",Name:"Developer Channel",TeamName:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entityType:i.c.Team,entities:[{entityType:i.c.Team,confidence:1,text:"Editor-SDK",Name:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entities:[{entityType:i.c.App,id:"id",Title:"Sales meetings",text:"",subtitle:"Turned on last week",imageUrl:"https://vivasales.dynamics.com/outlookaddin/manifestimages/appLogoCopilotForSales_64px.png",confidence:0},{entityType:i.c.App,Title:"Bing",subtitle:"Available on Copilot",text:"Turned on last week",imageUrl:"https://content.powerapps.com/resource/powerbiwfe/images/PowerBI96x96.c2c49fdb8eb6008a98b3.png",confidence:0}],entityType:i.c.App}]},46536:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});const i=(0,o(41509).f)("IMultilingualFreStore")},55099:(e,t,o)=>{"use strict";o.d(t,{QE:()=>m});var i=o(73027),n=o(56415),r=o(3594),s=o(19264),a=o(96095),l=o(79851),c=o(73857),u=o(37167),d=o(11049),h=o(39690);const g=function(e){return t=>{const o=a.Bn.AutoCorrectSquiggle,i=t.squiggleRef||n.useRef(null),r=t.element.ownerDocument.defaultView||window,s=n.useRef(0),l=n.useRef(1-t.initializationProgress),c=n.useCallback((()=>t.isCaretOver||t.isMouseOver||t.isCalloutOpened),[t.isCaretOver,t.isMouseOver,t.isCalloutOpened]),d=n.useCallback((()=>c()||l.current>0?"ms-squiggle ms-squiggle-autocorrect-hl ":"ms-squiggle ms-squiggle-autocorrect"),[l,c]),h=d(),g=l.current>0?{opacity:l.current}:{},[p,f]=n.useState(h),[m,v]=n.useState(g);n.useEffect((()=>{f(d())}),[t.isHighlighted,t.isCaretOver,t.isMouseOver,t.isCalloutOpened,f]);const b=t.useSvgUnderline?a.fQ[o]:0,y=e=>{var o;t.onCallOut(i.current,t.critique,null!==(o=t.critique.textInContext)&&void 0!==o?o:"","keyboard"===e,(()=>{}),t.element,t.squiggleKind,(0,u.eO)(t.data),b)},C=n.useCallback((()=>t.closeCallout(t.critique.traceId)),[t,t.critique.traceId]),S=t.openCalloutOnHover?void 0:()=>y("mouse");n.useEffect((()=>{t.openCalloutOnHover?t.isMouseOver?y("mouse"):t.isCalloutOpened||t.closeCallout(t.critique.traceId):t.isMouseOver&&(l.current=0,k(),v({}),f(d()))}),[t.isMouseOver,t.isCalloutOpened,l,v]);const w=t.isCaretOver&&!t.isCalloutOpened;n.useEffect((()=>{w?t.showTooltip(t.squiggleKind,i.current,t.critique,"keyboard"):t.closeTooltip(t.critique.traceId)}),[i,w]);const k=n.useCallback((()=>{0!==s.current&&(v({}),f(d()),r.clearInterval(s.current),s.current=0)}),[s,f,v]),T=n.useCallback((()=>{if(l.current<.01)l.current=0,k();else{l.current-=.02;const e=c();v({opacity:e?1:l.current}),f(d())}t.critique.traceId&&t.setInitializationProgress(t.critique.traceId,1-l.current)}),[l,k,v,d,f,c]),x=n.useCallback((()=>{l.current>0&&(k(),s.current=r.setInterval(T,100))}),[s]);return n.useEffect((()=>(x(),()=>{k(),t.closeCallout(t.critique.traceId),t.closeTooltip(t.critique.traceId)})),[x,k]),t.critique.isApplying?null:e(Object.assign(Object.assign({},t),{patternName:o,className:p,calloutOpened:t.isCalloutOpened,squiggleRef:i,styleOverrides:m,openCalloutPredicate:e=>!e.shiftKey&&!e.altKey&&"Control"===e.key,onClick:S,onNonLeftClick:C,onKeyboardEvent:()=>y("keyboard"),onEscapePress:()=>t.closeTooltip(t.critique.traceId)}))}},p=n.memo(g(s.m),c.I),f=n.memo(g(l.G),c.P);let m=class{constructor(e,t){this.hostSettings=e,this.featureFlagsReader=t}getSquiggles(e,t,o,i){if((0,h.v4)(this.featureFlagsReader))return n.createElement(n.Fragment,null,t.map(((e,t)=>n.createElement(r.X,{key:t.toString(),autoCorrectProps:e,theme:o,isHighContrastMode:i,hostSettings:this.hostSettings}))));{const s=((0,h.l9)(this.featureFlagsReader)||(0,h.YY)(this.featureFlagsReader))&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,isHighContrastMode:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!0,ariaStatusUpdatesOnlyForSpellingGrammar:(0,h.YY)(this.featureFlagsReader)});return n.createElement(n.Fragment,null,s,t.map(((e,t)=>n.createElement(p,Object.assign({key:t.toString()},e,{useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,o,i){return n.createElement(f,Object.assign({key:e},t,{initializationProgress:o,setInitializationProgress:i}))}};m=(0,i.Cg)([(0,d._)()],m)},56020:(e,t,o)=>{"use strict";o.d(t,{FY:()=>y,hJ:()=>v});var i=o(73027),n=o(56415),r=o(3594),s=o(30856),a=o(19264),l=o(90113),c=o(37167),u=o(96095),d=o(79851),h=o(73857),g=o(11049),p=o(39690);const f=function(e){return t=>{var o;const[i,r]=n.useState(!1),a=null!==(o=t.squiggleRef)&&void 0!==o?o:n.useRef(null),l=(0,u.H7)(t.critique,!!t.isAutoCorrectionEnabled),d=()=>{r(!1)},h=e=>{var o;r(!0);const i=t.useSvgUnderline?u.fQ[l]:0;t.onCallOut(a.current,t.critique,null!==(o=t.critique.textInContext)&&void 0!==o?o:"",!0,d,t.element,c.Ah.critique,(0,c.eO)(t.data),i)},g=n.useCallback((()=>t.closeCallout(t.critique.traceId)),[t,t.critique.traceId]),f=t.critique.typeId?"ms-squiggle-"+function(e,t){const o=Object.keys(e).filter((o=>e[o]===t));return o.length>0?o[0]:null}(s.L9,t.critique.typeId):void 0,m=`ms-squiggle ms-squiggle-${t.critique.priority} ${f} ${i||t.isHighlighted?"hl":""} ${t.stealth?"stealth":""}`,v=t.isMouseOver?"mouse":t.isCaretOver?"keyboard":void 0,b=v&&!i;return n.useEffect((()=>{b?t.showTooltip(t.squiggleKind,a.current,t.critique,v):t.closeTooltip(t.critique.traceId)}),[a.current,t.critique,b]),n.useEffect((()=>()=>{t.closeTooltip(t.critique.traceId)}),[]),e(Object.assign(Object.assign({},t),{patternName:l,className:m,calloutOpened:i,squiggleRef:a,openCalloutPredicate:e=>(0,p.iN)()||t.useAltHotkey?!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key:!e.shiftKey&&!e.ctrlKey&&e.altKey&&"ArrowDown"===e.key,onKeyboardEvent:()=>h(),onClick:()=>h(),onNonLeftClick:g,onEscapePress:()=>t.closeTooltip(t.critique.traceId)}))}},m=n.memo(f(a.m),h.I),v=n.memo(f(l.z),h.I),b=n.memo(f(d.G),h.P);let y=class{constructor(e,t){this.hostSettings=e,this.featureFlagsReader=t}getSquiggles(e,t,o,i){if((0,p.v4)(this.featureFlagsReader))return n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,isHighContrastMode:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!1,ariaStatusUpdatesOnlyForSpellingGrammar:!1});{const s=((0,p.l9)(this.featureFlagsReader)||(0,p.YY)(this.featureFlagsReader))&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,isHighContrastMode:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!0,ariaStatusUpdatesOnlyForSpellingGrammar:(0,p.YY)(this.featureFlagsReader)});return n.createElement(n.Fragment,null,s,t.map(((e,t)=>n.createElement(m,Object.assign({key:t.toString()},e,{isAutoCorrectionEnabled:this.hostSettings.enableAutoCorrect,squiggleKind:c.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,o,i){return n.createElement(b,Object.assign({key:e},t,{squiggleKind:c.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey}))}};y=(0,i.Cg)([(0,g._)()],y)},51384:(e,t,o)=>{"use strict";o.d(t,{g:()=>i});const i=(0,o(41509).f)("ISquigglerUXFactory")},73857:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n,P:()=>r}),3023==o.j)var i=o(53347);function n(e,t){const o=e.stealth===t.stealth,n=e.isHighlighted===t.isHighlighted,r=e.isCaretOver===t.isCaretOver,s=e.isMouseOver===t.isMouseOver,a=(0,i.a)(e.data.clientRect,t.data.clientRect);return r&&s&&a&&n&&o}function r(e,t){const o=e.isHighlighted===t.isHighlighted,i=e.isCaretOver===t.isCaretOver,n=e.isMouseOver===t.isMouseOver,r=e.data.start===t.data.start,s=e.data.end===t.data.end,a=e.data.text===t.data.text,l=e.data.overlayCss.height===t.data.overlayCss.height,c=e.data.overlayCss.width===t.data.overlayCss.width;return i&&s&&l&&c&&n&&r&&a&&o}},3594:(e,t,o)=>{"use strict";if(o.d(t,{X:()=>d,u:()=>h}),3023==o.j)var i=o(56020);var n=o(22474),r=o(36284);if(3023==o.j)var s=o(37167);if(3023==o.j)var a=o(96095);var l=o(39228),c=o(56415);const u=(0,n.F5)({targetWindow:r.A.on(l.sh)}),d=e=>{const{targetWindow:t}=(0,n.KN)(u),{autoCorrectProps:o}=e,{critique:i,initializationProgress:r}=o,s=c.useRef(0),[a,l]=c.useState(1-r);return c.useEffect((()=>{const e=()=>{var e;0!==s.current&&(null===(e=t.deref())||void 0===e||e.clearInterval(s.current),s.current=0)},n=()=>{l((t=>t<.01?(e(),0):t-.02)),i.traceId&&o.setInitializationProgress(i.traceId,1-a)};return(()=>{if(a>0){e();const o=t.deref();o&&(s.current=o.setInterval(n,100))}})(),()=>{e()}}),[o,i.traceId,a,t]),c.createElement(h,Object.assign({},e,{squigglerId:o.id,squigglesProps:[o],opacity:a,isAutoCorrection:!0,ariaStatusUpdatesOnly:!1,ariaStatusUpdatesOnlyForSpellingGrammar:!1}))},h=e=>{var t;const{squigglerId:o,squigglesProps:n,theme:r,isHighContrastMode:l,opacity:u,hostSettings:d,isAutoCorrection:h,ariaStatusUpdatesOnly:f,ariaStatusUpdatesOnlyForSpellingGrammar:m}=e,v=CSS.highlights;if(!v)return null;for(const e in a.Bn){const t=a.Bn[e];h===(t===a.Bn.AutoCorrectSquiggle)&&(v.delete(g(t,o,!1)),v.delete(g(t,o,!0)))}const b=new Map,y=[];for(const e of n){const i=(0,a.H7)(e.critique,!!d.enableAutoCorrect),n=g(i,o,!1),r=g(i,o,e.isHighlighted),l=null!==(t=b.get(r))&&void 0!==t?t:new Highlight;switch(i){case"SpellingSquiggle":if(m&&(e.squiggleKind===s.Ah.autocorrection||e.squiggleKind===s.Ah.personalizedAutocorrection))continue;l.type="spelling-error";break;case"GrammarSquiggle":l.type="grammar-error";break;default:if(m)continue;l.type="highlight"}l.add(e.data.range),b.set(r,l),y.push([n,i,u])}for(const[e,t]of b)v.set(e,t);return f?c.createElement(c.Fragment,null):c.createElement(c.Fragment,null,n.map(((e,t)=>c.createElement(i.hJ,Object.assign({key:t.toString()},e,{squiggleKind:s.Ah.critique,useAltHotkey:!!d.useAlternativeSquiggleHotkey})))),c.createElement("style",null,"@media not print {\n        ",y.map((e=>{const[t,o,i]=e,n=e=>l?"highlight":e;let s="",c="";switch(o){case a.Bn.SpellingSquiggle:s=`text-decoration: ${n(r.highPriorityColors.tile)} wavy underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 1px;\n                   text-underline-offset: 0px;`,c=`background-color: ${n(r.highPriorityColors.highlight)};`;break;case a.Bn.GrammarSquiggle:s=`text-decoration: ${n(r.mediumPriorityColors.tile)} double underline;\n                   text-decoration-skip-ink: none;\n                   text-underline-offset: 0.5px;`,c=`background-color: ${n(r.mediumPriorityColors.highlight)};`;break;case a.Bn.AdvancedSquiggle:s=`text-decoration: ${n(r.lowPriorityColors.tile)} dashed underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 2px;`,c=`background-color: ${n(r.lowPriorityColors.highlight)};`;break;case a.Bn.CIQFlagSquiggle:s=`text-decoration: ${n(r.ciqFlagColors.tile)} dotted underline;\n                   text-decoration-skip-ink: none;\n                   text-underline-offset: 1px;\n                   text-decoration-thickness: 3px;`,c=`background-color: ${n(r.ciqFlagColors.highlight)};`;break;case a.Bn.HeadingDetectionSquiggle:s=`text-decoration: ${n(r.headingDetectionColors.tile)} dashed underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 2px;`,c=`background-color: ${n(r.headingDetectionColors.highlight)};`;break;case a.Bn.AutoCorrectSquiggle:s=`text-decoration: ${n(p(r.autoCorrectColors.tile,i))} solid underline;\n                    background-color: ${n(p(r.autoCorrectColors.highlight,i))};\n                    text-decoration-skip-ink: none;\n                    text-underline-offset: 1px;\n                    text-decoration-thickness: 1px;`,c=`text-decoration: ${n(r.autoCorrectColors.tile)} solid underline;\n                background-color: ${n(r.autoCorrectColors.highlight)};`}return`\n            ::highlight(${t}) {\n              ${s}\n            }\n            ::highlight(${t}-hl) {\n              ${s}\n              ${c}\n            }\n            `})),"}"))};function g(e,t,o){return e+"-"+t+(o?"-hl":"")}const p=(e,t)=>{const o=Math.max(0,Math.min(1,t));if(7===e.length)return e+Math.floor(255*o).toString(16).padStart(2,"0");{const t=parseInt(e.slice(-2),16)/255,i=Math.floor(o*t*255).toString(16).padStart(2,"0");return e.slice(0,-2)+i}}},58074:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>n}),3023==o.j)var i=o(45302);class n{constructor(e,t,o,i){this.calloutStateStore=e,this.inlineSuggestionsRenderer=t,this.undoCalloutStateStore=o,this.logger=i}async showFlagCritique(e){var t,o,n,r,s,a;(0,i.r3)(e.critique)?e.onApplyFlag?this.inlineSuggestionsRenderer?(await this.inlineSuggestionsRenderer.showFlag(e.critique,e.onApplyFlag,((e,t)=>{var o,i,n;t?null===(o=this.calloutStateStore)||void 0===o||o.hide():null===(i=this.calloutStateStore)||void 0===i||i.clickNoActionHide(e),null===(n=this.undoCalloutStateStore)||void 0===n||n.hide()}),e.onFlagIgnoreOnce,e.onFlagIgnoreAll,e.onDisableFlag,e.onShowFeedback,null===(r=this.calloutStateStore)||void 0===r?void 0:r.navInfo,null===(s=this.calloutStateStore)||void 0===s?void 0:s.navigate),null===(a=this.calloutStateStore)||void 0===a||a.markAsShown(e.critique,e.onDismiss)):null===(n=this.logger)||void 0===n||n.error(508909200,"Got flag callout display, but no inlineSuggestionRenderer"):null===(o=this.logger)||void 0===o||o.error(508909201,"Got flag callout display, but no function for onApplyFlag was specified"):null===(t=this.logger)||void 0===t||t.error(0,"Got a critique that is not a flag critique, but expected a flag critique")}}},19264:(e,t,o)=>{"use strict";o.d(t,{m:()=>s});var i=o(56415);if(3023==o.j)var n=o(90113);if(3023==o.j)var r=o(33390);const s=e=>{const{top:t,left:o,width:s,height:a}=e.data.clientRect,l=e.isVisible?void 0:"none";return i.createElement(i.Fragment,null,i.createElement(n.z,{anchor:e.anchor,calloutOpened:e.calloutOpened,disableCalloutOnDoubleClick:e.disableCalloutOnDoubleClick,element:e.element,isCaretOver:e.isCaretOver,isMouseOver:e.isMouseOver,onClick:e.onClick,onEscapePress:e.onEscapePress,onKeyboardEvent:e.onKeyboardEvent,onNonLeftClick:e.onNonLeftClick,openCalloutPredicate:e.openCalloutPredicate}),i.createElement("span",{role:e.role,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,ref:e.squiggleRef,className:e.className,style:Object.assign({top:t,left:o,width:s,height:a,zIndex:e.data.zIndex,display:l},e.styleOverrides)}),e.useSvgUnderline&&i.createElement(r.a,{width:s,left:o,squiggleHeight:t+a,patternName:e.patternName,className:e.className,styleOverrides:Object.assign({display:l},e.styleOverrides)}))}},90113:(e,t,o)=>{"use strict";o.d(t,{z:()=>s});var i=o(56415);if(3023==o.j)var n=o(81609);if(3023==o.j)var r=o(85447);const s=e=>{const{anchor:t,calloutOpened:o,disableCalloutOnDoubleClick:s,element:a,isCaretOver:l,isMouseOver:c,onClick:u,onEscapePress:d,onKeyboardEvent:h,onNonLeftClick:g,openCalloutPredicate:p}=e,f=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),m=i.useRef(null);return i.useEffect((()=>{const e=e=>{if(c&&!o){const e=(a.ownerDocument.defaultView||window).getSelection();e&&e.focusNode===e.anchorNode&&e.focusOffset===e.anchorOffset&&(null==u||u())}},i=e=>{o&&0!==e.button&&(null==g||g())};if(s){const o=a.ownerDocument.defaultView||window,r=t=>{const i=t;0===i.button?1===i.detail&&(m.current=o.setTimeout(e,200)):null==g||g()},s=()=>{m.current&&(o.clearTimeout(m.current),m.current=null)},l=e=>s(),c=new n.J(t);return c.addListener("click",r),c.addListener("dblclick",l),c.addListener("mouseup",i),()=>{c.removeAllListeners(),s()}}{const o=new n.J(t);return o.addListener("click",e),o.addListener("mouseup",i),()=>{o.removeAllListeners()}}}),[t,s,a,g,c,o,u]),i.useEffect((()=>{if(l||c||o){const e=(0,r.a2)(t),i=new n.J(e),s=e=>{const t=e;l&&(null==p?void 0:p(t))&&!o?"keyup"===t.type?null==h||h():f(e):"Escape"===t.key&&"keyup"===t.type&&(null==d||d())};return i.addListener("keyup",s),o||(i.addListener("focus",f),i.addListener("blur",f),i.addListener("keydown",s)),()=>{i.removeAllListeners()}}}),[c,l,o,t,p,h,d]),null}},96095:(e,t,o)=>{"use strict";o.d(t,{Bn:()=>s,H7:()=>a,K3:()=>c,VA:()=>u,fQ:()=>l});var i=o(56415);if(3023==o.j)var n=o(30856);if(3023==o.j)var r=o(53216);const s={SpellingSquiggle:"SpellingSquiggle",GrammarSquiggle:"GrammarSquiggle",AdvancedSquiggle:"AdvancedSquiggle",CIQFlagSquiggle:"CIQFlagSquiggle",HeadingDetectionSquiggle:"HeadingDetectionSquiggle",AutoCorrectSquiggle:"AutoCorrectSquiggle",UnknownSquiggle:"UnknownSquiggle"};function a(e,t){switch(e.priority){case n.bx.High:return(0,r.MG)(e)&&t?"AutoCorrectSquiggle":"SpellingSquiggle";case n.bx.Medium:return"GrammarSquiggle";case n.bx.Low:return"AdvancedSquiggle";case n.bx.Informational:return e.typeId===n.L9.HeadingDetection?"HeadingDetectionSquiggle":"CIQFlagSquiggle";default:return"UnknownSquiggle"}}const l={SpellingSquiggle:4,GrammarSquiggle:3,AdvancedSquiggle:2,CIQFlagSquiggle:3,HeadingDetectionSquiggle:2,AutoCorrectSquiggle:1,UnknownSquiggle:0},c={SpellingSquiggle:0,GrammarSquiggle:0,AdvancedSquiggle:0,CIQFlagSquiggle:1,HeadingDetectionSquiggle:0,AutoCorrectSquiggle:0,UnknownSquiggle:0},u=e=>{const{isHighContrastMode:t,theme:o}=e,n=e=>t?"highlight":e;return i.createElement("svg",{width:"0",height:"0",style:{position:"absolute"}},i.createElement("defs",null,i.createElement("pattern",{id:s.SpellingSquiggle,width:"5",height:l.SpellingSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("path",{d:"M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3",stroke:n(o.highPriorityColors.tile),strokeWidth:"1",fill:"transparent"})),i.createElement("pattern",{id:s.GrammarSquiggle,width:"5",height:l.GrammarSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round"},i.createElement("g",{stroke:n(o.mediumPriorityColors.tile)},i.createElement("path",{d:"M0,0.5 L5,0.5"}),i.createElement("path",{d:"M0,2.5 L5,2.5"})))),i.createElement("pattern",{id:s.AdvancedSquiggle,width:"10",height:l.AdvancedSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M1,1 L5,1",stroke:n(o.lowPriorityColors.tile),strokeWidth:"2",strokeLinecap:"round"}))),i.createElement("pattern",{id:s.AutoCorrectSquiggle,width:"5",height:l.AutoCorrectSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none"},i.createElement("path",{d:"M0,0.5 L5,0.5",strokeWidth:"1",stroke:n(o.autoCorrectColors.tile)}))),i.createElement("pattern",{id:s.CIQFlagSquiggle,width:"6",height:l.CIQFlagSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("circle",{cx:"1.5",cy:"1.5",r:"1.5",fill:n(o.ciqFlagColors.tile)}))),i.createElement("pattern",{id:s.HeadingDetectionSquiggle,width:"10",height:l.HeadingDetectionSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M1,1 L5,1",stroke:n(o.headingDetectionColors.tile),strokeWidth:"2",strokeLinecap:"round"})))))}},33390:(e,t,o)=>{"use strict";o.d(t,{a:()=>r});var i=o(56415);if(3023==o.j)var n=o(96095);const r=e=>{const{className:t,left:o,patternName:r,squiggleHeight:s,styleOverrides:a,width:l}=e,c=n.fQ[r],u=n.K3[r];return i.createElement("svg",{width:l,height:c,viewBox:`0 0 ${l} ${c}`,className:t,style:Object.assign({top:s?s-c+u:void 0,bottom:s?void 0:-1*(c+u),left:o,position:"absolute"},a)},i.createElement("rect",{fill:`url(#${r})`,width:l,height:c}))}},16757:(e,t,o)=>{"use strict";o.d(t,{g:()=>x});var i=o(56415),n=o(22474),r=o(36284),s=o(34624),a=o(59696),l=o(34848),c=o(16392),u=o(89970),d=o(41335),h=o(89931),g=o(51384),p=o(37167),f=o(15561);const m=(0,f.PA)((e=>{const t=new Map;for(const o of e.squiggles){let e=t.get(o.squiggleKind);e||(e=[],t.set(o.squiggleKind,e)),e.push(o)}return i.createElement(i.Fragment,null,Array.from(t).map(((t,o)=>{const[n,r]=t,s=e.squigglerUXFactory(n),a=r.map((t=>{const o=t.critique.traceId===e.caretHoveredCritiqueId||t.critique.traceId===e.mouseHoveredCritiqueId||t.critique.traceId===e.calloutOpenedForCritique;let i=t.id===e.mouseHoveredElement;return(0,p.kI)(t.squiggleKind)&&(i=i||t.id===e.mouseIndirectlyHoveredElement),Object.assign(Object.assign({},t),{isHighlighted:o,isCaretOver:t.id===e.caretHoveredElement,isMouseOver:i,isCalloutOpened:t.critique.traceId===e.calloutOpenedForCritique})}));return i.createElement(i.Fragment,{key:o},s.getSquiggles(e.squigglerId,a,e.theme,e.isHighContrastMode))})))}));var v=o(96095),b=o(39690),y=o(30856);const C=(e,t=d.N.GENERIC,o)=>{const i=function(e,t){switch(e){case d.N.OFFICE:return function(e){return`\n    span.ms-squiggle-${y.bx.High} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.spellingTile};\n    }\n\n    span.ms-squiggle-${y.bx.Medium} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.grammarTile};\n    }\n\n    span.ms-squiggle-${y.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.insightTile};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 1px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      border-image-source: ${e.autoCorrectTile};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t);case d.N.SVG:return function(e){return`\n  span.ms-squiggle-autocorrect-hl, svg.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      box-sizing: border-box;\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-autocorrect, svg.ms-squiggle-autocorrect {\n      opacity: 0%;\n    }\n  `}(t);case d.N.GENERIC:default:return function(e){return`\n    span.ms-squiggle-${y.bx.High} {\n      border-bottom: 4px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.highPriorityColors.tile};\n      border-image-source: ${e.spellingTileBorder};\n    }\n\n    span.ms-squiggle-${y.bx.Medium} {\n      border-bottom: 3px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.mediumPriorityColors.tile};\n      border-image-source: ${e.grammarTileBorder};\n    }\n\n    span.ms-squiggle-${y.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px solid;\n      border-image-slice: 0 1 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.lowPriorityColors.tile};\n      border-image-source: ${e.insightTileBorder};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-image-source: ${e.autoCorrectTileBorder};\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t)}}(t,o),n=`\n        span.ms-squiggle {\n            position: absolute;\n            border-radius: 2px;\n            border-image-repeat: repeat;\n            background-clip: content-box;\n            cursor: text;\n            pointer-events: none;\n            box-sizing: ${t===d.N.OFFICE?"content-box":"border-box"};\n        }\n\n        span.ms-squiggle.stealth {\n          opacity: 0%;\n          transition: opacity 0.25s;\n        }\n\n        span.ms-squiggle.stealth.hl {\n          opacity: 100%;\n        }\n\n        ${i}\n        ${function(e){return`\n    span.ms-squiggle-${y.bx.High}.hl {\n      background-color: ${e.theme.highPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${y.bx.Medium}.hl {\n      background-color: ${e.theme.mediumPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${y.bx.Low}.hl:not(.ms-squiggle-TopicSuggestion.hl) {\n      background-color: ${e.theme.lowPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition.hl, .ms-squiggle-CIQFlag_DateEntityRecognition.hl, .ms-squiggle-CIQFlag_SatoriEntityRecognition.hl, .ms-squiggle-CIQFlag_Location.hl, .ms-squiggle-CIQFlag_File.hl, .ms-squiggle-CIQFlag_Time.hl, .ms-squiggle-CIQFlag_Topic.hl, .ms-squiggle-CIQFlag_TaskRecognition.hl, .ms-squiggle-TopicSuggestion.hl, .ms-squiggle-CIQFlag_LocalBusiness.hl {\n      background-color: ${e.theme.ciqFlagColors.highlight};\n    }\n\n    span.ms-squiggle-HeadingDetection.hl {\n      background-color:${e.theme.headingDetectionColors.highlight};\n    }\n  `}(o)}\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n    `,r=`\n        span.hc-noadjust {\n          -ms-high-contrast-adjust: none;\n        }\n\n        span.ms-squiggle {\n          forced-color-adjust:none;\n          cursor: text;\n          box-sizing: border-box;\n          pointer-events: none;\n          border-color: highlight;\n          border-image-source: none;\n          background-image: none;\n          position: absolute;\n          border-radius: 0px;\n        }\n\n        ${function(e){return e===d.N.SVG?"":`\n    span.ms-squiggle-${y.bx.High} {\n      border-bottom: 4px solid highlight;\n    }\n\n    span.ms-squiggle-${y.bx.Medium} {\n      border-bottom: 3px double highlight;\n    }\n\n    span.ms-squiggle-${y.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px dashed highlight;\n    }\n\n    span.ms-squiggle-autocorrect {\n      border-bottom: none;\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid highlight;\n    }\n  `}(t)}\n\n        span.ms-squiggle-autocorrect {\n          border-bottom: none;\n        }\n\n        span.hl {\n          outline: 2px solid highlight;\n        }\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n\n        span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition,, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n          background-image: linear-gradient(to right, #3c97dd 33%, rgba(0,0,0,0) 0%);\n          background-position: bottom;\n          background-size: 6px 2px;\n          background-repeat: repeat-x;\n        }\n    `;return e?r:n};var S=o(25526),w=o(5959);const k=(0,n.F5)({featureFlagsReader:r.A.on(a.c),squigglerUXFactory:r.A.on(g.g),safeWindow:r.A.on(l.j),highConstrastModeDetector:r.A.on(h.P)});class T extends i.Component{constructor(e){super(e),this.connectSquiggler=()=>{this.squigglerEvents.connectSquiggler()},this.disconnectSquiggler=()=>{this.squigglerEvents.disconnectSquiggler()},this.setSquigglerRef=e=>{this.props.state.setSquigglerRef(e),this.squigglerEvents.updatePositionIfRelative()},this.shouldRender=()=>{var e,t;return null!==(t=null===(e=this.props.state.hostElement)||void 0===e?void 0:e.shouldRender(this.props.state.anchorElement))&&void 0!==t&&t},this.selectorRef=i.createRef();const t=new c.O(this.props.state.anchorElement?(0,u.e)(this.props.state.anchorElement):window);this.squigglerEvents=this.props.state.squigglerEventManager.createEventManager(t,this.props.state,this.props.deps.safeWindow)}componentDidUpdate(e){var t;const o=this.props.state.isVisible,i=e.state.isVisible;o?(this.props.state.reactOnComponentUpdate&&(this.squigglerEvents.updatePositionIfRelative(),this.squigglerEvents.checkHighlight()),i||this.connectSquiggler()):i&&this.disconnectSquiggler(),this.selectorRef.current&&(null===(t=this.props.state.hostElement)||void 0===t||t.squigglerUpdated(this.selectorRef.current))}async componentDidMount(){this.connectSquiggler(),await this.props.state.updateRanges(),this.squigglerEvents.checkHighlight(),this.squigglerEvents.updatePositionIfRelative()}componentWillUnmount(){this.disconnectSquiggler(),this.props.state.disconnectVisibilityTracker(),this.squigglerEvents.dispose()}render(){let e={};const{isRelativePositionEnabled:t,squiggleStyleType:o,id:n,top:r,left:s,anchorElement:a,isVisible:l,squigglesToRender:c,parentToRenderTo:u,hostElement:h,theme:g,caretHoveredCritiqueId:p,mouseHoveredCritiqueId:f,calloutOpenedForCritique:y,caretHoveredElement:k,mouseHoveredElement:T,mouseIndirectlyHoveredElement:x,scaleTransformValue:I}=this.props.state;if(!a||!u||!h)return null;e=t?{pointerEvents:"none",position:"relative",flexGrow:0,msHighContrastAdjust:"none",display:"block",top:`${r}px`,left:`${s}px`}:{pointerEvents:"none",position:"absolute",msHighContrastAdjust:"none",flexGrow:0,top:`${r}px`,left:`${s}px`};const _=this.props.deps.highConstrastModeDetector.enabled,E=h.squigglerInlineStyles(a,I),A=o===d.N.SVG,R=C(_,o,g),B=i.createElement(m,{squiggles:c,squigglerId:n,theme:g.theme,isHighContrastMode:_,squigglerUXFactory:this.props.deps.squigglerUXFactory,caretHoveredCritiqueId:p,mouseHoveredCritiqueId:f,calloutOpenedForCritique:y,caretHoveredElement:k,mouseHoveredElement:T,mouseIndirectlyHoveredElement:x});return(0,b.v4)(this.props.deps.featureFlagsReader)?l&&this.shouldRender()?B:null:S.createPortal(i.createElement("editor-squiggler",{"aria-hidden":!0,tabindex:-1,style:{height:"0px",width:"0px"},ref:this.selectorRef},i.createElement(i.Fragment,null,i.createElement("style",null,"\n  @media print {\n    .ms-editor-squiggler {\n        display:none !important;\n    }\n  }\n  .ms-editor-squiggler {\n    all: initial;\n    display: block !important;\n    height: 0px !important;\n    width: 0px !important;\n  }"),i.createElement(w.Ay.div,{className:"ms-editor-squiggler",ref:this.setSquigglerRef,style:E},i.createElement("style",{type:"text/css"},R),A&&i.createElement(v.VA,{theme:g.theme,isHighContrastMode:_}),i.createElement("div",{style:e},l&&this.shouldRender()&&B)))),u)}}const x=(0,s.r)((0,f.PA)(T),k)},85447:(e,t,o)=>{"use strict";o.d(t,{a2:()=>d,pT:()=>l});var i=o(73027),n=o(81609),r=o(17365),s=o(83962),a=o(11049);let l=class{createEventManager(e,t,o){return new u(e,t,o)}};l=(0,i.Cg)([(0,a._)()],l);const c={passive:!1};class u{constructor(e,t,o){var i;this.targetWindowRef=e,this.state=t,this.safeWindow=o,this.isMouseWithinElement=!1,this.disconnectAdditionalHandlers=()=>null,this.connectedEventListeners=[],this.connectSquiggler=()=>{for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[];const e=this.targetWindowRef.deref();if(!e)return;const t=new n.J(e),o=new n.J(e.document);if(this.connectedEventListeners.push(t),this.connectedEventListeners.push(o),t.addListener("resize",this.reRenderDeferred,c),o.addListener("mouseup",this.onDocumentMouseUp,c),o.addListener("pointerup",this.onDocumentMouseUp,c),o.addListener("selectionchange",this.checkHighlight,c),this.state.anchorElement&&this.state.hostElement){const e=new n.J(this.state.anchorElement);if(this.connectedEventListeners.push(e),e.addListener("mouseenter",this.onMouseEnter,c),e.addListener("mouseleave",this.onMouseLeave,c),this.resizeObserver){this.resizeObserver.observe(this.state.anchorElement);for(const e of this.state.hostElement.shouldObserveSize(this.state.anchorElement))e&&this.resizeObserver.observe(e)}const t=d(this.state.anchorElement),o=new n.J(t);this.connectedEventListeners.push(o),o.addListener("input",this.onInputHandler,c),o.addListener("keyup",this.throttleKeyUp,c),this.isScrollable&&(o.addListener("scroll",this.throttleScroll,c),o.addListener("mousewheel",this.throttleScroll,c),o.addListener("touchmove",this.throttleScroll,c)),o.addListener("focusin",this.checkHighlight,c),o.addListener("focusout",this.throttleFocusOut,c),this.disconnectAdditionalHandlers=this.state.hostElement.addHandlers(this.state.anchorElement,this,this.state.proofedElements.map((e=>e.id)))}},this.disconnectSquiggler=()=>{var e;for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[],this.lastMouseMoveEvent=void 0,null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,this.disconnectAdditionalHandlers(),this.disconnectAdditionalHandlers=()=>{}},this.dispose=()=>{this.disconnectSquiggler(),this.throttledCheckCursorHighlight=void 0},this.reRender=()=>{this.state.updateRanges()},this.updatePositionIfRelative=()=>{this.requiresUpdateForRelativePosition()&&this.reRender()},this.checkHighlight=()=>{var e,t;const o=this.targetWindowRef.deref();o&&this.state.anchorElement&&(o.document.activeElement===this.state.anchorElement||this.state.anchorElement.contains(o.document.activeElement)||(null===(e=o.document.activeElement)||void 0===e?void 0:e.contains(this.state.anchorElement)))&&(this.onMouseEnter(),this.checkCaretPosition(),null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this))},this.onMouseEnter=()=>{var e;this.isMouseWithinElement=!0,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.anchorElement&&(this.mouseWithinElementEventListener=new n.J(this.state.anchorElement),this.connectedEventListeners.push(this.mouseWithinElementEventListener),this.mouseWithinElementEventListener.addListener("mousemove",this.onMouseMove,c))},this.onMouseLeave=()=>{var e;this.isMouseWithinElement=!1,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.setLastMousePosition(void 0),this.state.trivializeAllSquiggles(s.Rw.cursor)},this.onFocusOut=()=>{this.state.trivializeAllSquiggles(s.Rw.caret),this.state.closeTooltip()},this.onInputHandler=()=>{this.onInput()},this.onInput=()=>{(this.getShouldReactToInput()||this.state.isAutoCorrectionOnly||this.requiresUpdateForRelativePosition())&&this.reRender()},this.onKeyup=e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key)?this.checkCaretPosition():("Delete"===e.key||"Backspace"===e.key||this.isTabPressed(e)||this.state.isAutoCorrectionOnly)&&this.onInput()},this.isTabPressed=e=>"Tab"===e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey,this.checkCaretPosition=()=>{var e;const t=((null===(e=this.state.anchorElement)||void 0===e?void 0:e.ownerDocument)||document).getSelection();t&&t.rangeCount>0&&this.state.updateSelectionHighlightState(t)},this.onMouseMove=e=>{var t;this.state.anchorElement&&this.isMouseWithinElement?(this.lastMouseMoveEvent=e,null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this)):this.lastMouseMoveEvent=void 0},this.checkCursorHighlight=()=>{if(this.lastMouseMoveEvent&&this.state.anchorElement){const e={x:this.lastMouseMoveEvent.clientX,y:this.lastMouseMoveEvent.clientY};this.state.setLastMousePosition(e)}this.state.updateCursorHighlightState(),this.lastMouseMoveEvent=void 0},this.onDocumentMouseUp=e=>{this.onMouseClick(e),this.reRenderDeferred()},this.onMouseClick=e=>{const{anchorElement:t,updateCursorHighlightState:o,setLastMousePosition:i}=this.state;t&&(i({x:e.clientX,y:e.clientY}),this.checkCaretPosition(),o())},this.throttleScroll=()=>{this.reRenderDeferred()},this.reRenderDeferred=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRender()),this.targetWindowRef)},this.throttleKeyUp=e=>{this.safeWindow.requestAnimationFrame((()=>this.onKeyup(e)),this.targetWindowRef)},this.throttleFocusOut=()=>{this.safeWindow.requestAnimationFrame((()=>this.onFocusOut()),this.targetWindowRef)},this.throttleUpdateOnResize=()=>{this.safeWindow.requestAnimationFrame((()=>{this.state.updatePosition(this.state.isRelativePositionEnabled),this.reRender()}),this.targetWindowRef)},this.requiresUpdateForRelativePosition=()=>{const{isRelativePositionEnabled:e}=this.state;return e&&this.state.updatePosition(e)},this.determineIfScrollable=e=>{switch(e){case"scroll":return!0;case"hidden":case"visible":return!1;default:return null}};const a=e.deref();if(a&&(this.throttledCheckCursorHighlight=(0,r.hQ)(this.safeWindow,a,this.checkCursorHighlight,"After"),this.state.anchorElement)){if(this.isScrollable=null===(i=this.state.hostElement)||void 0===i?void 0:i.isScrollable(this.state.anchorElement),void 0===this.isScrollable){const e=this.getAnchorElementComputedStyle();this.isScrollable=e&&!(!1===this.determineIfScrollable(e.overflowX)&&!1===this.determineIfScrollable(e.overflowY))}a.ResizeObserver&&(this.resizeObserver=new a.ResizeObserver((()=>this.throttleUpdateOnResize())))}}getAnchorElementComputedStyle(){var e;return this.anchorElementComputedStyle||(this.anchorElementComputedStyle=this.state.anchorElement&&(null===(e=this.targetWindowRef.deref())||void 0===e?void 0:e.getComputedStyle(this.state.anchorElement))),this.anchorElementComputedStyle}getShouldReactToInput(){if(void 0!==this.reactToOnInput)return this.reactToOnInput;const e=this.getAnchorElementComputedStyle();return this.reactToOnInput=["center","right"].includes((null==e?void 0:e.textAlign)||"")||"rtl"===(null==e?void 0:e.direction),this.reactToOnInput}}function d(e){let t=e;if("true"!==t.contentEditable&&t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(t=e)}return t}},29842:(e,t,o)=>{"use strict";o.d(t,{i:()=>fe});var i=o(73027),n=o(56415),r=o(26433),s=o(53347),a=o(517),l=o(54596);class c{constructor(e,t){this.proofingDom=e,this.critiqueStore=t}setIsApplyingAutoCorrection(e){const t=this.getCritique(e);t&&(u(e),u(t))}setIsFinishedApplyingAutoCorrection(e,t){const o=this.getCritique(e);return o?(d(e,t),d(o,t)):0}convertToNormalSquiggle(e){const t=this.getCritique(e);t&&(h(e),h(t))}getCritique(e){if(e.traceId){if(!this.critiqueStore){if(!e.tileId)return;const t=this.proofingDom.findTileNode(e.tileId.nodeId);if(!t)return;return t.critiques.find((t=>t.traceId===e.traceId))}{if(!e.nodeId)return;const t=this.proofingDom.findParagraphNode(e.nodeId);if(!(null==t?void 0:t.parent))return;const o=this.critiqueStore.getCritiques(t.parent.id);if(!(null==o?void 0:o.critiques.size))return;for(const t of o.critiques)if(t.traceId===e.traceId)return t}}}}function u(e){e.isApplying=!0,e.hasBeenApplied=!0}function d(e,t){if(e.isApplying=!1,!e.suggestions.length)return 0;e.start=e.start+t,e.length=e.suggestions[0].text.length;const o=e.textInContext,i=e.suggestions[0].text;return e.textInContext=i,e.suggestions[0].text=o,i.length-o.length}function h(e){e.isApplying=void 0,e.hasBeenApplied=void 0,e.hasBeenConvertedToNormalSquiggle=!0,(0,l._V)(e)}var g=o(83997),p=o(81314),f=o(56504),m=o(27516),v=o(82751),b=o(63524);class y{constructor(e,t,o){this.range=e,this.zIndex=o,this.originalStartContainerOfRange=e.startContainer,this.clientRect=t}isRangeInValidState(){return this.range.startContainer===this.originalStartContainerOfRange&&!this.range.collapsed}updateRange(e){e&&(this.range=e)}}class C{constructor(e,t,o,i,n,r,s,a){this.id=e,this.element=t,this.squiggleKind=o,this.critique=i,this.isVisible=n,this.stealth=r,this.data=s,this.squiggleRef=a,(0,b.Gn)(this,{isVisible:v.observable,stealth:v.observable,data:v.observable,updateFromRect:v.action})}updateFromRect(e,t){var o;this.isVisible!==e.visible&&(this.isVisible=e.visible),e.visible&&(this.data=new y(t,e,this.data.zIndex));const i=null!==(o=this.critique.isStealth)&&void 0!==o&&o;i!==this.stealth&&(this.stealth=i)}}var S,w=o(55717),k=o(48883),T=o(30856),x=o(29446),I=o(89970),_=o(16392),E=o(41335),A=o(34848),R=o(64949),B=o(17365),M=o(70732),D=o(83901),O=o(76595),F=o(17417),P=o(64947),N=o(93223);function L(e,t,o,i){return e&&o>=e.top&&o<=e.bottom?t>=e.left&&t<=e.right?S.direct:i&&t>=e.right-i&&t<=e.left?S.indirect:S.line:S.none}function j(e,t){if("Caret"!==t.type||!t.focusNode)return S.none;if(e.isPointInRange(t.focusNode,t.focusOffset))return S.direct;const o=e.getBoundingClientRect(),i=t.getRangeAt(0).getBoundingClientRect();return o.top<=i.top&&o.bottom>=i.bottom?S.line:S.none}function q(e,t){return!("Caret"!==t.type||!t.focusNode)&&e.isPointInRange(t.focusNode,t.focusOffset)}!function(e){e.none="none",e.direct="direct",e.line="line",e.indirect="indirect"}(S||(S={}));var H=o(83962),z=o(53216),W=o(13199),G=o(37113),U=o(48336),V=o(81584),$=o(6716),K=o(28178),Q=o(3100),Y=o(11884),J=o(54967),Z=o(45375),X=o(37167),ee=o(71297),te=o(38184),oe=o(85447);function ie(e){if(!e||"auto"===e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t+1}function ne(e,t){return e.bottom>t.bottom+e.height/4||e.left>t.right||e.right<t.left||e.bottom<t.top}function re(e){if(!e)return 0;const t=parseFloat(e);return isNaN(t)?0:t}var se=o(84191);const ae=()=>!0;var le=o(87857),ce=o(41509),ue=o(11049),de=o(41453),he=o(97811),ge=o(46916);const pe=(0,ce.f)("SquigglerV2StateStoreOptionsToken");let fe=class{constructor(e,t,o,i,l,u,d,h,g,p,f,M,D,O,F,P,N,G,U,V,$,K){var Q,Y,J,re,ce,ue,de;this.tileContent=t,this.instrumentationProcessor=o,this._hostEmitters=i,this.hostEmitter=l,this.hostSettings=u,this.proofingDom=d,this._squiggleThemeStore=h,this.logger=g,this._tileNodeTraverser=p,this.upsellStore=f,this.editorSettingsState=D,this.feedbackStore=O,this._disableCritiqueHandler=F,this.critiqueStore=P,this.applyCritiqueSuggestionHandler=N,this.applyFlagHandler=G,this.wordDictionary=U,this.editorSettingsManager=V,this._formElementAutoCorrectionCache=$,this.isMobile=K,this.diffPrecision=.01,this.isTooltipShown=!1,this.squigglesCache=new v.ObservableMap,this.autoCorrectDisabledLanguages=[],this.proofedElements=[],this.proofedElementDomRects=[],this.calloutOpenedForCritique=void 0,this.mouseHoveredElement=void 0,this.mouseIndirectlyHoveredElement=void 0,this.caretHoveredElement=void 0,this.scaleTransformValue=1,this.top=0,this.left=0,this.isAutoCorrectionOnly=!1,this.recalculateRelativePosition=()=>{this.isRelativePositionEnabledValue=this.calculateRelativePosition()},this.isVisible=!1,this.onCalloutPositionUpdated=(e,t)=>{this.isUndoCalloutAlignedRight=e,this.undoCalloutRect=t},this.autoCorrectLanguagesUpdated=async e=>{this.autoCorrectDisabledLanguages=e.message},this.recordAutoCorrectInstrumentationEvent=(e,t)=>{this.hostEmitter.emit(k.pD.autoCorrectionTriggered);const o={isPersonalized:(0,z.dP)(t).toString()};this.instrumentationProcessor.process({critique:e,eventId:15,customProperties:o})},this.setCritiques=async e=>{const t=this.proofedElements.find((t=>t.id===e.id));t?t.critiques=e.critiques:this.proofedElements.push(e),await this.updateRanges()},this.removeCritiques=async e=>{const t=this.proofedElements.findIndex((t=>t.id===e));-1!==t&&(this.squigglesCache.delete(e),this.proofedElements.splice(t,1),await this.updateRanges())},this.updateRanges=async()=>{this.throttledUpdateRanges?await this.throttledUpdateRanges():await this.updateRangesImmediately()},this.updateSquiggles=()=>{this.throttledUpdateSquiggles?this.throttledUpdateSquiggles():this.innerUpdateSquiggles()},this.setVisible=e=>{this.isVisible=e,e&&this.safeWindow.requestAnimationFrame((async()=>{await this.updateRanges()}))},this.setLastMousePosition=e=>{this.isMobile||(this.lastMousePosition=e)},this.disconnectVisibilityTracker=()=>{var e;null===(e=this._visibilityTracker)||void 0===e||e.disconnect()},this.getCritiques=()=>this.proofedElements.reduce(((e,t)=>e.concat(t.critiques)),[]),this.showCallout=(e,t)=>{var o,i;const n=null===(o=this.targetWindowRef)||void 0===o?void 0:o.deref();if(!e.traceId||!n)return;const r=this.findSquiggle(e.traceId);if(r){const o=null!==(i=r.data.range.startContainer.parentElement)&&void 0!==i?i:r.element;this.safeWindow.requestAnimationFrame((()=>{o.scrollIntoView({behavior:"auto"}),n.setTimeout((()=>{var o,i;me(r)&&(this.onShowCallout(null!==(i=null===(o=r.squiggleRef)||void 0===o?void 0:o.current)&&void 0!==i?i:null,e,r.data.range.toString(),!0,(()=>{}),r.element,X.Ah.critique),null==t||t())}),100)}),n)}},this.updateSelectionHighlightState=e=>{let t,o=0;this.forEachCritique((i=>{var n,r;for(const s of i.squiggles){if(!s.isVisible)continue;let a=S.none;this.ariaLineNavUpdatesEnabled?a=j(s.data.range,e):q(s.data.range,e)&&(a=S.direct),a===S.direct?(this.caretHoveredCritiqueId=s.critique.traceId,(1===i.squiggles.length||this.checkSquiggleSelection(s,e))&&(this.caretHoveredElement=s.id,me(s)&&this.showTooltipAt(s.squiggleKind,null===(n=s.squiggleRef)||void 0===n?void 0:n.current,s.critique,"keyboard")),t=s,this.caretPosition={node:e.focusNode,offset:e.focusOffset}):(this.caretHoveredElement===s.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),a===S.line&&(o+=1),this.trivializeSquiggle(s,H.Rw.caret))}})),this.updateAriaStatus(o,t)},this.updateSelectionHighlightStateFromCoordinates=e=>{let t,o=0;this.forEachCritique((i=>{var n,r;for(const s of i.squiggles){if(!s.isVisible)continue;const i=L(s.data.clientRect,e.x,e.y);i===S.direct?(this.caretHoveredCritiqueId=s.critique.traceId,this.caretHoveredElement=s.id,me(s)&&this.showTooltipAt(s.squiggleKind,null===(n=s.squiggleRef)||void 0===n?void 0:n.current,s.critique,"keyboard",e),t=s):(i===S.line&&(o+=1),this.caretHoveredElement===s.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),this.trivializeSquiggle(s,H.Rw.caret))}})),this.updateAriaStatus(o,t)},this.startUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=t.setTimeout((()=>{this.lastMousePosition?this.setMouseIndirectlyHoveredElement(void 0):this.clearUndoCardTimeout()}),2e3))},this.clearUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=void 0)},this.isMouseWithinUndoCallout=()=>{if(!this.undoCalloutRect||!this.lastMousePosition||!this.anchorElement)return!1;const e=(e,t,o)=>e>=t&&e<=t+o;return e(this.lastMousePosition.x,this.undoCalloutRect.x,this.undoCalloutRect.width)&&e(this.lastMousePosition.y,this.undoCalloutRect.y,this.undoCalloutRect.height)},this.updateCursorHighlightState=()=>{var e;if(this.lastMousePosition&&this.anchorElement)if(null===(e=this.options)||void 0===e?void 0:e.enableCursorIntersectionObserver){const e=new IntersectionObserver((t=>{this.updateCursorHighlightStateWithAnchorBoundingBox(t[0].boundingClientRect),e.disconnect()}));e.observe(this.anchorElement)}else{const e=this.anchorElement.getBoundingClientRect();this.updateCursorHighlightStateWithAnchorBoundingBox(e)}},this.updateCursorHighlightStateWithAnchorBoundingBox=e=>{if(!this.lastMousePosition)return;const{x:t,y:o}=this.lastMousePosition;let i,n=0;this.forEachCritique((r=>{var s,a,l,c;for(const u of r.squiggles){if(!u.isVisible||!this.anchorElement)continue;const r=this.mouseIndirectlyHoveredElement===u.id?null===(s=this.undoCalloutRect)||void 0===s?void 0:s.width:void 0;let d=L({left:u.data.clientRect.left+e.left,top:u.data.clientRect.top+e.top,right:u.data.clientRect.right+e.left,bottom:u.data.clientRect.bottom+e.top,width:u.data.clientRect.width,height:u.data.clientRect.height},t,o,r);const h=(0,X.kI)(u.squiggleKind);if(this.ariaLineNavUpdatesEnabled||d!==S.line||(d=S.none),h)if(this.mouseIndirectlyHoveredElement===u.id)if(d===S.indirect){if(void 0!==this.indirectTimer)continue;this.startUndoCardTimeout()}else this.setMouseIndirectlyHoveredElement(void 0),this.clearUndoCardTimeout();else(null===(a=this.options)||void 0===a?void 0:a.disableOpenAutoCorrectCalloutOnHover)||this.calloutOpenedForCritique!==u.critique.traceId||d!==S.none||this.isMouseWithinUndoCallout()||(null===(l=this.critiqueCalloutHandler)||void 0===l||l.hideCallout(),this.undoCalloutRect=void 0);if(d===S.direct)return i=u,this.mouseHoveredCritiqueId=u.critique.traceId,this.mouseHoveredElement=u.id,this.isUndoCalloutAlignedRight&&this.setMouseIndirectlyHoveredElement(u.id),void(u.squiggleKind===X.Ah.critique&&me(u)&&this.showTooltipAt(u.squiggleKind,null===(c=u.squiggleRef)||void 0===c?void 0:c.current,u.critique,"mouse"));d===S.line&&(n+=1),this.trivializeSquiggle(u,H.Rw.cursor)}})),this.updateAriaStatus(n,i),i||this.trivializeCursorSquiggle()},this.trivializeAllSquiggles=e=>{e===H.Rw.caret?this.trivializeCaretSquiggle():this.trivializeCursorSquiggle()},this.trivializeSquiggle=(e,t,o=!1)=>{t===H.Rw.caret?this.trivializeSquiggleCaretHover(e.critique.traceId):this.mouseHoveredCritiqueId!==e.critique.traceId||o&&(0,X.kI)(e.squiggleKind)||this.trivializeCursorSquiggle()},this.trivializeSquiggleCaretHover=e=>{this.caretHoveredCritiqueId===e&&this.trivializeCaretSquiggle()},this.trivializeCursorSquiggle=()=>{this.mouseHoveredCritiqueId=void 0,this.mouseHoveredElement=void 0},this.trivializeCaretSquiggle=()=>{this.caretHoveredCritiqueId=void 0,this.caretHoveredElement=void 0},this.flagShowFeedback=(e,t)=>{var o,i,n,r,s;this.proofedElements.find((t=>t.element===e))&&((null==t?void 0:t.typeId)===T.L9.CIQFlag_Topic?(0,x.z)((0,le.S)({topicIds:(null===(o=t.suggestionItems)||void 0===o?void 0:o.map((e=>e.entities.map((e=>e.TopicId)))).join(","))||"",topicNames:(null===(i=t.suggestionItems)||void 0===i?void 0:i.map((e=>e.entities.map((e=>e.DisplayName)))).join(","))||"",highlightedText:t.textInContext||"",hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),requestId:t.nodeId,source:"EditorFlag",traceId:t.traceId||""})):null===(n=this.feedbackStore)||void 0===n||n.feedbackIconClicked(null!==(r=null==t?void 0:t.textInContext)&&void 0!==r?r:"",null!==(s=null==t?void 0:t.typeId)&&void 0!==s?s:""))},this.scaleTransform=e=>{this.scaleTransformValue=e,this.innerUpdateSquiggles()},this.updateAriaStatus=(e,t)=>{this.ariaStatusStateStore&&(t&&this.isAriaFeatureEnabled(te.j.highlight)?this.isAriaFeatureEnabled(te.j.highlight,t.critique)?this.ariaStatusStateStore.setStatus(this.getAriaStatusString(t),"assertive",!1,void 0,t.squiggleKind===X.Ah.critique?r.Jx.KeepOriginal:r.Jx.AutoCorrectHover):this.ariaStatusStateStore.setStatus("","assertive",!1,void 0):this.ariaLineNavUpdatesEnabled&&this.ariaStatusStateStore.setLineNavStatus(e,"polite",!1))},this.updateRangesImmediately=async()=>{var e;if(!this.isVisible)return;const t=new Set(this.squigglesCache.keys()),o=!!(null===(e=this.options)||void 0===e?void 0:e.autoCorrectionEnabled)&&!!this.autoCorrectionCache;let i=!1;await(0,v.transaction)((async()=>{var e,n,r,s,a,l;for(const c of this.proofedElements){const u=[],d=null!==(e=this.squigglesCache.get(c.id))&&void 0!==e?e:new v.ObservableMap,h=new Set(d.keys());for(const e of c.critiques)e.traceId&&h.delete(e.traceId),u.push(e);const g=await this.critiqueRangeBuilder.getCritiqueRanges(u,c.element);if(h.size>0&&this.removeCritiquesFromCache(h,d),g.length>0){const e=await this.buildSquigglesForCritiques(c.element,g,d,o),t=[];if(this.autoCorrectionBroker){for(let o=e.length-1;o>=0;o-=1){const i=e[o];if(!(null===(n=this.autoCorrectionCache)||void 0===n?void 0:n.process(i.critique.traceId)))continue;const u=null!==(r=i.critique.nodeId)&&void 0!==r?r:null===(s=i.critique.tileId)||void 0===s?void 0:s.nodeId,d=u?this.proofingDom.findNode(u):null;if(!d){null===(a=this.logger)||void 0===a||a.error(508146701,"Unable to find node while applying autocorrection");continue}this.autoCorrectionBroker.setIsApplyingAutoCorrection(i.critique);const h=await this.tileContent.autoCorrect(d,c.element,i.critique.start,i.critique.length,i.suggestion.text,i.range,null===(l=this.options)||void 0===l?void 0:l.autoCorrectionInputCacheEnabled);h?(t.push({replacedText:h,critique:i.critique}),this.recordAutoCorrectInstrumentationEvent(i.critique,i.suggestion)):this.autoCorrectionBroker.convertToNormalSquiggle(i.critique)}let o=0;for(let e=t.length-1;e>=0;e-=1)o+=this.autoCorrectionBroker.setIsFinishedApplyingAutoCorrection(t[e].critique,o),i=!0}}this.setCacheEntry(c.id,d),t.delete(c.id)}t.size>0&&this.removeMissingElements(t),this.updatePosition(this.isRelativePositionEnabled)})),i&&await this.updateRangesImmediately()},this.getValidCritiques=async e=>{const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.critiques,e.element);return this.determineValidSquiggles(t).map((e=>e.critique))},this.setCacheEntry=(e,t)=>{this.squigglesCache.set(e,t)},this.removeCritiquesFromCache=(e,t)=>{var o;for(const i of e.keys())t.delete(i),this.calloutOpenedForCritique===i&&(null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.mouseHoveredCritiqueId!==i&&this.caretHoveredCritiqueId!==i||(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle())},this.removeMissingElements=e=>{var t;for(const o of e){const e=this.squigglesCache.get(o);if(e)for(const o of e.values())for(const e of o)null===(t=this._visibilityTracker)||void 0===t||t.unTrackSquiggle(e.data.range.startContainer);this.squigglesCache.delete(o)}},this.buildSquigglesForCritiques=async(e,t,o,i,n=X.Ah.critique)=>{var r,s,a,l,c,u,d;const h=[];if(this.anchorElement){const g=this.anchorElement.getBoundingClientRect(),p=null===(r=this.anchorElement.ownerDocument.activeElement)||void 0===r?void 0:r.contains(e),f=null===(s=this.targetWindowRef)||void 0===s?void 0:s.deref(),m=f&&(null===(a=this.hostElement)||void 0===a?void 0:a.getForbiddenRects(f)),v=(e,t)=>{var o;return null===(o=this.hostElement)||void 0===o?void 0:o.transformSquiggleRects(e,t,m)},b=[];for(const r of t){if(!r.range||!r.critique.traceId)continue;const t=o.get(r.critique.traceId);let s=null!==(l=null==t?void 0:t[0].squiggleKind)&&void 0!==l?l:n;if(i&&!t&&p){const e=(0,z.MG)(r.critique);if(e){const t=r.critique;if(!t.hasBeenConvertedToNormalSquiggle)if(t.hasBeenApplied)s=(null===(d=this.options)||void 0===d?void 0:d.personalizedAutoCorrectionEnabled)&&(0,z.dP)(e)?X.Ah.personalizedAutocorrection:X.Ah.autocorrection;else{if(this.enableAutoCorrectionForLanguages(e.languages)&&await(null===(c=this._visibilityTracker)||void 0===c?void 0:c.checkImmediateVisibility(r.range.startContainer))&&this.isAutoCorrectApplicable(r.range)){h.push({critique:t,suggestion:e,range:r.range});continue}null===(u=this.autoCorrectionBroker)||void 0===u||u.convertToNormalSquiggle(t)}}}this.createOrUpdateSquiggleStates(r.critique,r.range,e,o,s,g,t,v).shouldAnnounce&&b.push({critique:r.critique,squiggleKind:s})}b.length&&this.setAriaStatuses(b)}return h},this.isAutoCorrectApplicable=e=>{var t;const o=null===(t=this.targetWindowRef)||void 0===t?void 0:t.deref();if(!o)return!1;const i=o.document.getSelection();if(!(null==i?void 0:i.focusNode)||!i.isCollapsed)return!1;const n=e.comparePoint(i.focusNode,i.focusOffset);if(0===n)return!1;const r=o.document.createRange();return 1===n?(r.setStart(e.endContainer,e.endOffset),r.setEnd(i.focusNode,i.focusOffset)):(r.setStart(i.focusNode,i.focusOffset),r.setEnd(e.startContainer,e.startOffset)),r.toString().length<=X.tB},this.createOrUpdateSquiggleStates=(e,t,o,i,n,r,s,a)=>e.traceId&&this.anchorElement&&this.hostElement?this.updateSquiggle(s,t,e,o,n,r,a,i,e.traceId):{shouldAnnounce:!1},this.setAriaStatuses=e=>{if(this.ariaStatusStateStore){const t=e.map((e=>{if(!this.isAriaFeatureEnabled(te.j.appearance,e.critique))return;const{critique:t,squiggleKind:o}=e,i=t.textInContext;if(!i)return;const n=o===X.Ah.critique?`${t.categoryTitle} ${i}`:i,s=o===X.Ah.critique?r.Jx.KeepOriginal:r.Jx.AutoCorrectAppearance;return{text:n,id:t.traceId,messageKind:s}}));this.ariaStatusStateStore.addPreservedStatuses(t.filter((e=>!!e)),"assertive")}},this.findSquiggle=e=>{let t;return this.squigglesCache.forEach((o=>{const i=o.get(e);(null==i?void 0:i.length)&&(t=i[0])})),t},this.onShowCallout=(e,t,o,i,n,r,s,a,l)=>{var c,u,d,h,g;if(!this.isVisible)return;if(this.calloutOpenedForCritique===t.traceId)return;this.calloutOpenedForCritique&&this.onCalloutClosed(n,!1,this.calloutOpenedForCritique),this.closeTooltip(),this.setCalloutOpenedForCritique(t.traceId);const p=this.proofedElements.find((e=>e.element===r));let f=null===(c=null==p?void 0:p.graphNode)||void 0===c?void 0:c.element;if(!f&&t.nodeId){const e=this.proofingDom.findNode(t.nodeId);(0,W.l)(e)?f=e.parent.element:e&&(f=e.element)}if(!f)return void(null===(u=this.logger)||void 0===u||u.error(508146700,"Unable to find graph node while showing callout"));const m=null!=e?e:a;if(!m)return void(null===(d=this.logger)||void 0===d||d.error(507562183,"Unable to find target location while showing callout"));const v=e&&(0,I.C)(e,"HTMLElement")?e.ownerDocument:null===(h=this.anchorElement)||void 0===h?void 0:h.ownerDocument;null===(g=this.critiqueCalloutHandler)||void 0===g||g.showCallout({critique:t,issueText:o,setInitialFocus:i,target:m,gapSpace:l,targetDocumentRef:v&&new _.O(v),squiggleKind:s,onDismiss:e=>{this.onCalloutClosed(n,e,t.traceId)},onApplySuggestion:async(e,t)=>{var o,i;this.caretPosition=void 0,await this.critiqueApplicationHandler.applyCritiqueSuggestion(f,r,null!==(o=e.nodeId)&&void 0!==o?o:null==p?void 0:p.id,e,t,(null===(i=this.options)||void 0===i?void 0:i.disableRangeWhenApplyingCritiqueSuggestions)?void 0:a,s)},onApplyFlag:async(e,t,o)=>{await this.critiqueApplicationHandler.applyFlagSuggestion(f,r,e.nodeId,e,t,o)},onIgnoreOnce:e=>{var t,o,i;this.critiqueApplicationHandler.ignoreCritiqueOnce(f,r,null!==(i=null!==(t=e.nodeId)&&void 0!==t?t:null===(o=e.tileId)||void 0===o?void 0:o.nodeId)&&void 0!==i?i:null==p?void 0:p.id,e)},onIgnoreAll:e=>{var t;this.critiqueApplicationHandler.ignoreAllOfCritique(f,r,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onFlagIgnoreOnce:e=>{this.critiqueApplicationHandler.ignoreFlagOnce(f,r,e.nodeId,e)},onFlagIgnoreAll:e=>{this.critiqueApplicationHandler.ignoreAllOfFlag(f,r,e)},onDisableFlag:e=>{this.critiqueApplicationHandler.disableFlagType(f,r,e.nodeId,e)},onShowFeedback:e=>{this.flagShowFeedback(r,e)},onDisableCritiqueType:async e=>{var t;await this.critiqueApplicationHandler.disableCritiqueType(f,r,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onCalloutPositionUpdated:this.onCalloutPositionUpdated})},this.setCalloutOpenedForCritique=e=>{this.calloutOpenedForCritique=e},this.setMouseIndirectlyHoveredElement=e=>{this.mouseIndirectlyHoveredElement=e},this.innerUpdateSquiggles=async()=>{const e=[];if(this.forEachCritique((t=>{if(t.squiggles.length)for(const o of t.squiggles)o.data.isRangeInValidState()||e.push(o)})),e.length){const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.map((e=>e.critique)));if(t.length===e.length)for(let o=0;o<e.length;o++)e[o].data.updateRange(t[o].range)}this.innerUpdateSquigglesWithValidRanges()},this.innerUpdateSquigglesWithValidRanges=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();if(!(this.isVisible&&this.anchorElement&&t&&this.hostElement))return;const o=this.anchorElement.getBoundingClientRect(),i=this.hostElement.getForbiddenRects(t),n=(e,t)=>{var o;return null===(o=this.hostElement)||void 0===o?void 0:o.transformSquiggleRects(e,t,i)},r=[];(0,v.transaction)((()=>{this.forEachCritique((e=>{if(!e.squiggles.length)return;const t=e.squiggles[0];this.updateSquiggle(e.squiggles,t.data.range,t.critique,t.element,t.squiggleKind,o,n,e.elementCritiques,e.key).shouldAnnounce&&r.push(t)}))})),r.length&&this.setAriaStatuses(r)},this.updateSquiggle=(e,t,o,i,r,a,l,c,u)=>{var d,h,g,p,f,m;let v=!0;e?v=null===(g=null===(h=this._visibilityTracker)||void 0===h?void 0:h.isSquiggleVisible(t.startContainer))||void 0===g||g:null===(d=this._visibilityTracker)||void 0===d||d.trackSquiggle(t.startContainer);let b=!1;if(v&&this.anchorElement){const d=function(e,t,o,i,n=1){const r=i,s={top:t.clientTop,left:t.clientLeft,right:0,bottom:0,width:t.clientWidth,height:t.clientHeight},a=o(function(e){if(e.startContainer===e.endContainer)return Array.from(e.getClientRects());const t=e.startContainer.ownerDocument||document,o=t.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ALL),i=[];for(;o.nextNode()&&(0===i.length&&o.referenceNode!==e.startContainer||(i.push(o.referenceNode),o.referenceNode!==e.endContainer)););const n=[],r=t.createRange();for(const t of i)t.nodeType===t.TEXT_NODE&&(r.selectNode(t),t===e.startContainer?r.setStart(t,e.startOffset):t===e.endContainer&&r.setEnd(t,e.endOffset),n.push(...Array.from(r.getClientRects())));let s=!0;for(const e of n)if(e.top!==n[0].top||e.height!==n[0].height){s=!1;break}return s?[n.reduce(((e,t)=>new DOMRect(Math.min(e.left,t.left),e.top,Math.max(e.right,t.right)-Math.min(e.left,t.left),e.height)))]:n}(e),e),l=[];if(a)for(const e of a){const t=0===s.width?r.right-r.left:s.width/n,o=Math.max(e.left-r.left,s.left),i=Math.min(e.right-r.left,t),a={top:e.top-r.top,left:o,bottom:e.bottom-r.top,right:i,width:i-o,height:e.height,visible:!ne(e,r)};l.push(a)}return l}(t,this.anchorElement,l,a,this.scaleTransformValue);if(e&&d.length===e.length)for(let i=0;i<d.length;i+=1){const n=d[i],r=e[i];n.visible===r.isVisible&&(0,s.a)(n,r.data.clientRect)||e[i].updateFromRect(n,t),r.critique.start=o.start,r.stealth!==(null!==(p=r.critique.isStealth)&&void 0!==p&&p)&&(r.stealth=null!==(f=r.critique.isStealth)&&void 0!==f&&f)}else{const s=[];for(const e of d){const a=new C(this.guidGenerator.generate(),i,r,o,e.visible,null!==(m=o.isStealth)&&void 0!==m&&m,new y(t,e,this.zIndex),n.createRef());s.push(a)}s.length>0&&(e||(b=!0),c.set(u,s))}}else if(e)for(const t of e)t.isVisible&&(t.isVisible=!1);return{shouldAnnounce:b}},this.forEachCritique=e=>{this.forEachCritiqueInCache(this.squigglesCache,e)},this.forEachCritiqueInCache=(e,t)=>{const o=new Map;for(const i of e){const e=i[0],n=i[1],r=[];for(const o of n){const i=o[0],s=o[1];s.length>0&&r.push(s[0].critique),t({squiggles:s,key:i,elementCritiques:n,elementId:e})}o.set(e,r)}return o},this.showTooltipAt=(e,t,o,i,n)=>{var r,s,a,l;if(!(null===(r=this.options)||void 0===r?void 0:r.tooltipEnabled)||(null===(s=this.upsellStore)||void 0===s?void 0:s.isSquiggleBeingPreviewed(o)))return;if(this.calloutOpenedForCritique||(null===(a=this.editorSettingsState)||void 0===a?void 0:a.currentlyOpen))return void this.closeTooltip();const c=(null==t?void 0:t.ownerDocument)||(null===(l=this.anchorElement)||void 0===l?void 0:l.ownerDocument)||document;let u;if("keyboard"===i)if(n)u=this.getTooltipCoordinatesFromLocalPosition(n);else{const e=c.getSelection();if(!(e&&e.rangeCount>0))return;{const t=e.getRangeAt(0);let o;o=t.collapsed&&t.getClientRects().length?t.getClientRects()[0]:t.getBoundingClientRect(),u={x:o.left,y:o.bottom}}}else{if(!this.lastMousePosition)return;if(this.options.disableSquiggleTooltipOnTextSelection){const e=c.getSelection();if(e&&0!==e.toString().length)return}u=this.getTooltipCoordinatesFromGlobalPoint(this.lastMousePosition)}this.clearTooltipTimeout();const d=(0,se.m)(c.activeElement);this.tooltipTimeout=window.setTimeout((()=>{var n;if("keyboard"===i){const e=(0,se.m)(c.activeElement);if(d!==e)return}this.isTooltipShown=!0,null===(n=this.tooltipHandler)||void 0===n||n.showTooltip({squiggleKind:e,critique:o,position:u,origin:null!=t?t:void 0,isAbsolute:void 0,targetDocument:c})}),1e3)},this.getTooltipCoordinatesFromGlobalPoint=e=>({x:e.x+6,y:e.y+16}),this.getTooltipCoordinatesFromLocalPosition=e=>{var t,o,i;const n=null===(t=this.anchorElement)||void 0===t?void 0:t.getBoundingClientRect();return this.getTooltipCoordinatesFromGlobalPoint({x:e.x+(null!==(o=null==n?void 0:n.left)&&void 0!==o?o:0),y:e.y+(null!==(i=null==n?void 0:n.top)&&void 0!==i?i:0)})},this.closeTooltip=()=>{var e;this.clearTooltipTimeout(),this.isTooltipShown&&(this.isTooltipShown=!1,null===(e=this.tooltipHandler)||void 0===e||e.hideTooltip())},this.clearTooltipTimeout=()=>{this.tooltipTimeout&&(window.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=void 0)},this.onSquigglerVisibilityChange=e=>{this.setVisible(e)},this.onSquigglesVisibilityChange=()=>{this.updateSquiggles()},this.isAriaFeatureEnabled=(e,t)=>{var o,i;const n=null!==(i=null===(o=this.options)||void 0===o?void 0:o.ariaFeatures)&&void 0!==i?i:te.j.none;return e!==te.j.appearance&&e!==te.j.highlight||!this.isAriaFeatureEnabled(te.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar)?e===te.j.none?n===e:(n&e)===e:!((null==t?void 0:t.priority)===T.bx.High||(null==t?void 0:t.priority)===T.bx.Medium)},this.restoreCaretOnCalloutClose=()=>{var e,t,o,i,n;if((null===(e=this.options)||void 0===e?void 0:e.restoreCaretPosition)&&void 0!==this.caretPosition){const{node:e,offset:r}=this.caretPosition;if(void 0!==e){const s=((null===(t=this.anchorElement)||void 0===t?void 0:t.ownerDocument)||document).getSelection();if(!s||!e)return;const a=null!==(i=null===(o=e.textContent)||void 0===o?void 0:o.length)&&void 0!==i?i:0,l=Math.min(r,a);try{s.removeAllRanges(),s.setPosition(e,l)}catch(e){null===(n=this.logger)||void 0===n||n.error(539824961,"Error while restoring the IP on callout dismissed",e)}}}},this.checkSquiggleSelection=(e,t)=>{var o,i,n;if(!me(e)||t.rangeCount<1)return!1;const r=t.getRangeAt(0);let s;s=r.collapsed&&r.getClientRects().length?r.getClientRects()[0]:r.getBoundingClientRect();const a=null!==(n=null===(i=null===(o=e.squiggleRef)||void 0===o?void 0:o.current)||void 0===i?void 0:i.getBoundingClientRect())&&void 0!==n?n:e.data.range.getBoundingClientRect();return!(a.left>s.right||a.right<s.left||a.top>s.bottom||a.bottom<s.top)},this.onCalloutClosed=(e,t,o)=>{e(),this.calloutOpenedForCritique===o&&this.setCalloutOpenedForCritique(void 0),!1===t?this.caretPosition=void 0:this.restoreCaretOnCalloutClose()},this.getAriaStatusString=e=>{const t=e.data.range.toString();return e.squiggleKind===X.Ah.critique?`${e.critique.categoryTitle} ${t}`:t},this.closeCalloutCallback=e=>{var t;e&&this.calloutOpenedForCritique===e&&(null===(t=this.critiqueCalloutHandler)||void 0===t||t.hideCallout())},this.getSquiggleProps=e=>{const t=this.anchorElement;return t?e.map((e=>{var o,i,n,r;const s=Object.assign(Object.assign({},e),{isHighlighted:!1,isCaretOver:!1,isMouseOver:!1,isCalloutOpened:!1,useSvgUnderline:(null===(o=this.options)||void 0===o?void 0:o.squiggleStyleType)===E.N.SVG,role:this.isAriaFeatureEnabled(te.j.none)?"status":"none presentation",ariaLive:this.isAriaFeatureEnabled(te.j.none)?"assertive":"off",ariaLabel:this.isAriaFeatureEnabled(te.j.highlight,e.critique)?this.getAriaStatusString(e):"",describedBy:ee.y,anchor:t,onCallOut:this.onShowCallout,closeCallout:this.closeCalloutCallback,showTooltip:this.showTooltipAt,closeTooltip:this.closeTooltip});return s.disableCalloutOnDoubleClick=(null===(i=this.options)||void 0===i?void 0:i.disableCalloutOnDoubleClick)&&(null===(n=this.hostElement)||void 0===n?void 0:n.disableCalloutOnDoubleClick),(0,X.kI)(e.squiggleKind)&&this.autoCorrectionCache?Object.assign(Object.assign({},s),{squiggleKind:e.squiggleKind,initializationProgress:this.autoCorrectionCache.getSquiggleInitializationProgress(e.critique.traceId),setInitializationProgress:this.autoCorrectionCache.setInitializationProgress,openCalloutOnHover:!(!0===(null===(r=this.options)||void 0===r?void 0:r.disableOpenAutoCorrectCalloutOnHover))}):Object.assign(Object.assign({},s),{squiggleKind:X.Ah.critique})})):[]};const{anchorElement:he,anchorId:ge,proofedItem:pe,critiqueCalloutHandler:fe,tooltipHandler:ve,options:be}=e;let ye;this.critiqueCalloutHandler=fe,this.tooltipHandler=ve,this.id=ge,this.options=be,this.ariaStatusStateStore=(null==be?void 0:be.ariaFeatures)?M:void 0,this.anchorElement=he,this.proofedElements.push(pe),this.targetWindowRef=new _.O((0,I.e)(this.anchorElement)),this.critiqueRangeBuilder=new a.$(this.tileContent,this.proofingDom,this._tileNodeTraverser),this.safeWindow=new A.c(u),this.critiqueApplicationHandler=new w.n(this._hostEmitters,this.tileContent,this.critiqueRangeBuilder,this.proofingDom,this.safeWindow,this._disableCritiqueHandler,this.logger,this.critiqueStore,this.applyCritiqueSuggestionHandler,this.applyFlagHandler,this.wordDictionary,this.editorSettingsManager,this._formElementAutoCorrectionCache),this.guidGenerator=new R.L,this.squigglerEventManager=new oe.pT,this.autoCorrectionBroker=new c(d,this.critiqueStore),this.autoCorrectionCache=new m.Qr;const Ce=()=>ye||(ye=getComputedStyle(he));this.hostElement=((e,t,o,i,n=!0)=>{var r,s,a,l,c,u,d,h,g,p,f;const m=o.find((t=>t.match(e))),v=null!==(r=null==m?void 0:m.shouldRender)&&void 0!==r?r:ae,b=null!==(s=null==m?void 0:m.shouldRenderSquiggle)&&void 0!==s?s:ae,y=null!==(a=null==m?void 0:m.shouldObserveSize)&&void 0!==a?a:()=>[],C=null!==(l=null==m?void 0:m.addHandlers)&&void 0!==l?l:()=>()=>null,S=null!==(c=null==m?void 0:m.squigglerInlineStyles)&&void 0!==c?c:()=>{},w=null!==(u=null==m?void 0:m.transformSquiggleRects)&&void 0!==u?u:e=>e,k=null!==(d=null==m?void 0:m.getForbiddenRects)&&void 0!==d?d:()=>[],T=null!==(h=null==m?void 0:m.isScrollable)&&void 0!==h?h:()=>{},x=null!==(g=null==m?void 0:m.squigglerUpdated)&&void 0!==g?g:()=>{},I=e.tagName.toLowerCase(),_="editor-shadow-element"===I?window.document.body:e.parentElement,E={element:null!==(p=e.parentElement)&&void 0!==p?p:window.document.body,zIndex:null!==(f=null==m?void 0:m.zIndex)&&void 0!==f?f:"auto",shouldRender:v,shouldRenderSquiggle:b,shouldObserveSize:y,addHandlers:C,squigglerInlineStyles:S,transformSquiggleRects:w,getForbiddenRects:k,isScrollable:T,squigglerUpdated:x,disableCalloutOnDoubleClick:null==m?void 0:m.disableCalloutOnDoubleClick};if("body"===I||!_)return E;if(null==m?void 0:m.selector){const t="string"==typeof m.selector?e.closest(m.selector):m.selector(e,null==i?void 0:i.element);if(t)return E.element=t,E}return E.element=n?((e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let o=e.parentElement,i=window.getComputedStyle(o);for(;o&&"relative"!==i.position&&o!==document.body;)o=o.parentElement,i=window.getComputedStyle(o);return o})(e,t()):_,E})(he,(()=>Ce().position),null!==(Q=null==be?void 0:be.edgeCases)&&void 0!==Q?Q:[],pe,!1),(null===(Y=this.hostElement.element)||void 0===Y?void 0:Y.parentElement)===this.anchorElement&&(this.anchorElement.firstElementChild===this.hostElement.element?this.top=0:this.top=-1*this.anchorElement.getBoundingClientRect().height),this.zIndex=this.hostElement.zIndex?ie(this.hostElement.zIndex.toString()):ie(Ce().zIndex),this.parentToRenderTo=this.hostElement.element,this._visibilityTracker=null!==(J=null==be?void 0:be.visibilityTracker)&&void 0!==J?J:Z.Y,this.isVisible=this._visibilityTracker===Z.Y,this._visibilityTracker.connect({trackSquiggler:!0,trackSquiggles:null===(ce=null===(re=this.options)||void 0===re?void 0:re.visibilityTrackerShouldTrackSquiggles)||void 0===ce||ce,anchorElement:he,onSquigglerVisibilityChange:this.onSquigglerVisibilityChange,onSquigglesVisibilityChange:this.onSquigglesVisibilityChange}),(null===(ue=this.options)||void 0===ue?void 0:ue.mutationObserverBasedRelativePosition)&&(this.recalculateRelativePosition(),this._relativePositionMutationObserver=new MutationObserver((e=>this.recalculateRelativePosition())),this._relativePositionMutationObserver.observe(this.parentToRenderTo,{attributeFilter:["class","style"]})),(null==be?void 0:be.throttleUpdates)&&(this.throttledUpdateSquiggles=(0,B.IS)(this.safeWindow,this.targetWindowRef,this.innerUpdateSquiggles,16,"After"),this.throttledUpdateRanges=(0,B.IS)(this.safeWindow,this.targetWindowRef,this.updateRangesImmediately,16,"After")),this.autoCorrectDisabledLanguages=null!==(de=null==be?void 0:be.autoCorrectDisabledLanguages)&&void 0!==de?de:[],this.hostEmitter.on(k.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),(0,b.Gn)(this)}get squigglesToRender(){const e=[];let t=!0;return this.forEachCritique((o=>{t&&o.squiggles.length>0&&!(0,X.kI)(o.squiggles[0].squiggleKind)&&(t=!1);const i=o.squiggles.filter((e=>{var t;return e.isVisible&&this.anchorElement&&(null===(t=this.hostElement)||void 0===t?void 0:t.shouldRenderSquiggle(e.data.range.startContainer,this.anchorElement))})),n=this.getSquiggleProps(i);e.push(...n)})),this.isAutoCorrectionOnly=t,e}get isRelativePositionEnabled(){return this.isRelativePositionEnabledValue?this.isRelativePositionEnabledValue:this.calculateRelativePosition()}calculateRelativePosition(){return!!this.parentToRenderTo&&"static"===(""!==this.parentToRenderTo.style.position?this.parentToRenderTo.style.position:getComputedStyle(this.parentToRenderTo).position)}get isEmpty(){return 0===this.proofedElements.length}get theme(){return this._squiggleThemeStore}get squiggleStyleType(){var e;return null===(e=this.options)||void 0===e?void 0:e.squiggleStyleType}get reactOnComponentUpdate(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.reactOnComponentUpdate)&&void 0!==t&&t}get ariaLineNavUpdatesEnabled(){return this.isAriaFeatureEnabled(te.j.lineNavigation)}setSquigglerRef(e){this._squigglerElement=e}checkProofingElementsPosition(){let e=this.proofedElementDomRects.length!==this.proofedElements.length;const t=[];return this.proofedElements.forEach(((o,i)=>{const n=o.element.getBoundingClientRect();t.push(n);const r=this.proofedElementDomRects[i],s=!r||!(n.x===r.x&&n.y===r.y&&n.width===r.width&&n.height===r.height);e=e||s})),e&&(this.proofedElementDomRects=t),e}updatePosition(e){var t,o,i,n,r;if(e){if(this._squigglerElement&&this.anchorElement){if((null===(o=null===(t=this.hostElement)||void 0===t?void 0:t.element)||void 0===o?void 0:o.parentElement)===this.anchorElement&&this.anchorElement.firstElementChild===this.hostElement.element&&0===this.top&&0===this.left)return!1;let e=!1;const s=this._squigglerElement.getBoundingClientRect(),a=this.anchorElement.getBoundingClientRect(),l=a.top-s.top-this.top,c=a.left-s.left-this.left;return Math.abs(l)>(null!==(i=this.diffPrecision)&&void 0!==i?i:.01)&&(this.top+=l,e=!0),Math.abs(c)>(null!==(n=this.diffPrecision)&&void 0!==n?n:.01)&&(this.left+=c,e=!0),!e&&(null===(r=this.options)||void 0===r?void 0:r.trackProofingElementsPositionEnabled)&&(e=this.checkProofingElementsPosition()),e}}else if(this.anchorElement)if(this.anchorElement===this.parentToRenderTo)if(this.anchorElement===this.parentToRenderTo&&["body","html"].includes(this.anchorElement.nodeName.toLowerCase())){const e=function(e){const t=getComputedStyle(e),o=re(t.marginTop);return{x:re(t.marginLeft),y:o}}(this.anchorElement);this.left=this.anchorElement.offsetLeft+e.x,this.top=this.anchorElement.offsetTop+e.y}else this.left=0,this.top=0;else this.left=this.anchorElement.offsetLeft,this.top=this.anchorElement.offsetTop;return!1}dispose(){var e,t,o;this.anchorElement&&(this.squigglesCache.clear(),null===(e=this._visibilityTracker)||void 0===e||e.disconnect(),this._visibilityTracker=void 0,null===(t=this._relativePositionMutationObserver)||void 0===t||t.disconnect(),this._relativePositionMutationObserver=void 0,this.proofedElements=[],this.anchorElement=void 0,this.parentToRenderTo=void 0,this.hostElement=void 0,this._squigglerElement=void 0,this.targetWindowRef=void 0,this.throttledUpdateSquiggles=void 0,this.throttledUpdateRanges=void 0,this.hostEmitter.off(k.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),(this.caretHoveredCritiqueId||this.mouseHoveredCritiqueId)&&(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle()),this.calloutOpenedForCritique&&(null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout(),this.setCalloutOpenedForCritique(void 0)))}determineValidSquiggles(e){var t,o,i,n,r,s,a,l,c;const u=[];for(const d of e){if(!d.range)continue;const e=d.range.commonAncestorContainer.nodeType===Node.TEXT_NODE?d.range.commonAncestorContainer.parentElement:d.range.commonAncestorContainer;let h=!0;("a"===(null==e?void 0:e.nodeName.toLowerCase())||!0===(null===(i=null===(o=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.squigglerSettings)||void 0===o?void 0:o.checkSquigglePositionValidity)||void 0===i?void 0:i.call(o,d.critique,d.range))||(null===(s=null===(r=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.squigglerSettings)||void 0===r?void 0:r.invalidSquiggleParentSelectors)||void 0===s?void 0:s.some((t=>null==e?void 0:e.closest(t)))))&&(h=!1);const g=[...null!==(c=null===(l=null===(a=this.hostSettings.serviceSettings)||void 0===a?void 0:a.squigglerSettings)||void 0===l?void 0:l.invalidSquiggleSelectors)&&void 0!==c?c:[],".ms-prediction","a"];let p=d.range.startContainer;if(g.some((e=>{var t;return(0,I.C)(p,"HTMLElement")&&p.closest(e)||(null===(t=null==p?void 0:p.parentElement)||void 0===t?void 0:t.closest(e))})))h=!1;else for(;p=this.getNextNode(d.range.startContainer,!1,d.range.endContainer);){g.some((e=>{var t;return(0,I.C)(p,"HTMLElement")&&p.closest(e)||(null===(t=null==p?void 0:p.parentElement)||void 0===t?void 0:t.closest(e))}))&&(h=!1);break}h&&u.push(d)}return u}getNextNode(e,t,o){var i;if(o!==e){if(e.firstChild&&!t)return e.firstChild;if(e.parentNode)return null!==(i=e.nextSibling)&&void 0!==i?i:this.getNextNode(e.parentNode,!0,o)}}enableAutoCorrectionForLanguages(e=[]){return 0===this.autoCorrectDisabledLanguages.length||e.some((e=>!this.autoCorrectDisabledLanguages.includes(e)))}};function me(e){return!e.squiggleRef||!!e.squiggleRef.current}(0,i.Cg)([v.observable],fe.prototype,"squigglesCache",void 0),(0,i.Cg)([v.observable],fe.prototype,"calloutOpenedForCritique",void 0),(0,i.Cg)([v.observable],fe.prototype,"mouseHoveredElement",void 0),(0,i.Cg)([v.observable],fe.prototype,"mouseIndirectlyHoveredElement",void 0),(0,i.Cg)([v.observable],fe.prototype,"caretHoveredElement",void 0),(0,i.Cg)([v.observable],fe.prototype,"scaleTransformValue",void 0),(0,i.Cg)([v.observable],fe.prototype,"top",void 0),(0,i.Cg)([v.observable],fe.prototype,"left",void 0),(0,i.Cg)([v.computed],fe.prototype,"squigglesToRender",null),(0,i.Cg)([v.observable],fe.prototype,"isVisible",void 0),(0,i.Cg)([v.action],fe.prototype,"removeCritiques",void 0),(0,i.Cg)([v.action],fe.prototype,"setVisible",void 0),(0,i.Cg)([v.action],fe.prototype,"updatePosition",null),(0,i.Cg)([v.action],fe.prototype,"updateSelectionHighlightState",void 0),(0,i.Cg)([v.action],fe.prototype,"updateSelectionHighlightStateFromCoordinates",void 0),(0,i.Cg)([v.action],fe.prototype,"updateCursorHighlightState",void 0),(0,i.Cg)([v.action],fe.prototype,"trivializeCursorSquiggle",void 0),(0,i.Cg)([v.action],fe.prototype,"trivializeCaretSquiggle",void 0),(0,i.Cg)([v.action],fe.prototype,"scaleTransform",void 0),(0,i.Cg)([v.action],fe.prototype,"dispose",null),(0,i.Cg)([v.action],fe.prototype,"updateRangesImmediately",void 0),(0,i.Cg)([v.action],fe.prototype,"setCacheEntry",void 0),(0,i.Cg)([v.action],fe.prototype,"removeCritiquesFromCache",void 0),(0,i.Cg)([v.action],fe.prototype,"removeMissingElements",void 0),(0,i.Cg)([v.action],fe.prototype,"buildSquigglesForCritiques",void 0),(0,i.Cg)([v.action],fe.prototype,"setCalloutOpenedForCritique",void 0),(0,i.Cg)([v.action],fe.prototype,"setMouseIndirectlyHoveredElement",void 0),(0,i.Cg)([v.action],fe.prototype,"innerUpdateSquigglesWithValidRanges",void 0),(0,i.Cg)([v.action],fe.prototype,"updateSquiggle",void 0),fe=(0,i.Cg)([(0,ue._)(),(0,i.Qj)(0,(0,de.W)(pe)),(0,i.Qj)(1,(0,de.W)(G.d)),(0,i.Qj)(2,(0,de.W)(M.f)),(0,i.Qj)(3,(0,he.t)(k.zJ)),(0,i.Qj)(4,(0,de.W)(k.M5)),(0,i.Qj)(5,(0,de.W)(D.n)),(0,i.Qj)(6,(0,de.W)(U.w)),(0,i.Qj)(7,(0,de.W)(J.Vw)),(0,i.Qj)(8,(0,ge.l)()),(0,i.Qj)(8,(0,de.W)(O.g)),(0,i.Qj)(9,(0,ge.l)()),(0,i.Qj)(9,(0,de.W)(V.M)),(0,i.Qj)(10,(0,ge.l)()),(0,i.Qj)(10,(0,de.W)($.Ey)),(0,i.Qj)(11,(0,ge.l)()),(0,i.Qj)(11,(0,de.W)(r.mU)),(0,i.Qj)(12,(0,ge.l)()),(0,i.Qj)(12,(0,de.W)(F.z)),(0,i.Qj)(13,(0,ge.l)()),(0,i.Qj)(13,(0,de.W)(K.M)),(0,i.Qj)(14,(0,ge.l)()),(0,i.Qj)(14,(0,de.W)(Q.W)),(0,i.Qj)(15,(0,ge.l)()),(0,i.Qj)(15,(0,de.W)(g.$)),(0,i.Qj)(16,(0,ge.l)()),(0,i.Qj)(16,(0,de.W)(p.a)),(0,i.Qj)(17,(0,ge.l)()),(0,i.Qj)(17,(0,de.W)(f.K)),(0,i.Qj)(18,(0,ge.l)()),(0,i.Qj)(18,(0,de.W)(Y.s)),(0,i.Qj)(19,(0,ge.l)()),(0,i.Qj)(19,(0,de.W)(P.rI)),(0,i.Qj)(20,(0,ge.l)()),(0,i.Qj)(20,(0,de.W)(m.PF)),(0,i.Qj)(21,(0,ge.l)()),(0,i.Qj)(21,(0,de.W)(N.n))],fe)},45375:(e,t,o)=>{"use strict";if(o.d(t,{J:()=>r,Y:()=>s}),3023==o.j)var i=o(16392);if(3023==o.j)var n=o(89970);class r{constructor(){this._targetWindow=new i.O(window),this._visibleSquigglesRangeContainers=new Map,this._checkedElements=new Map,this._isAnchorElementVisible=!0,this.connect=e=>{var t;this._targetWindow=new i.O((0,n.e)(e.anchorElement)),(null===(t=this._targetWindow.deref())||void 0===t?void 0:t.IntersectionObserver)&&(this.initSquigglerObserver(e.trackSquiggler,e.anchorElement,e.onSquigglerVisibilityChange),this.initSquigglesObserver(e.trackSquiggles,e.onSquigglesVisibilityChange))},this.disconnect=()=>{this._squigglesVisibilityObserver&&this._squigglesVisibilityObserver.disconnect(),this._squigglerVisibilityObserver&&this._squigglerVisibilityObserver.disconnect(),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.disconnect()},this.trackSquiggle=e=>{var t;let o;if(!this._squigglesVisibilityObserver||!(o=this.getElementFromRange(e)))return;const i=null!==(t=this._visibleSquigglesRangeContainers.get(o))&&void 0!==t?t:{visible:void 0,handles:0};i.handles=i.handles+1,this._visibleSquigglesRangeContainers.set(o,i),this._squigglesVisibilityObserver.observe(o)},this.unTrackSquiggle=e=>{var t;let o;if(!this._squigglesVisibilityObserver||!(o=this.getElementFromRange(e)))return;const i=null!==(t=this._visibleSquigglesRangeContainers.get(o))&&void 0!==t?t:{visible:!1,handles:0};i.handles=i.handles-1,this._visibleSquigglesRangeContainers.set(o,i),i.handles<=0&&this.untrackElement(o)},this.isSquiggleVisible=e=>{const t=this.getElementFromRange(e);if(!t)return;if(!this._visibleSquigglesRangeContainers.has(t))return void this.trackSquiggle(e);const o=this._visibleSquigglesRangeContainers.get(t);return null==o?void 0:o.visible},this.checkImmediateVisibility=async e=>{const t=this.getElementFromRange(e);if(!t)return!1;const o=await this.asyncCheckVisibility(t);return this._checkedElements.delete(t),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.unobserve(t),o},this.asyncCheckVisibility=async e=>new Promise((t=>this.checkVisibility(e,t))),this.asyncVisibilityCallback=e=>{for(const t of e){const e=this._checkedElements.get(t.target);e&&e(t.isIntersecting)}},this.checkVisibility=(e,t)=>{if(!this._asyncVisibilityObserver){const e=this._targetWindow.deref();if(!e)return;this._asyncVisibilityObserver=new e.IntersectionObserver(this.asyncVisibilityCallback,{rootMargin:"0px",threshold:[0,1]})}this._checkedElements.set(e,t),this._asyncVisibilityObserver.observe(e)},this.untrackElement=e=>{var t;null===(t=this._squigglesVisibilityObserver)||void 0===t||t.unobserve(e),this._visibleSquigglesRangeContainers.delete(e)},this.initSquigglerObserver=(e,t,o)=>{if(!e)return;const i=this._targetWindow.deref();i&&(this._squigglerVisibilityObserver=new i.IntersectionObserver((e=>{o(this.getSquigglerIsVisible(e))}),{rootMargin:"0px",threshold:[0,1]}),this._squigglerVisibilityObserver.observe(t))},this.initSquigglesObserver=(e,t)=>{if(!e)return;const o=this._targetWindow.deref();o&&(this._squigglesVisibilityObserver=new o.IntersectionObserver((e=>{t(this.getVisibleSquigglesRangeContainers(e))}),{rootMargin:"0px",threshold:[0,1]}))},this.getVisibleSquigglesRangeContainers=e=>{var t;let o=!1;for(const i of e.values())if(i.target.isConnected){const e=null!==(t=this._visibleSquigglesRangeContainers.get(i.target))&&void 0!==t?t:{visible:!1,handles:1};e.visible=i.isIntersecting,this._visibleSquigglesRangeContainers.set(i.target,e)}else o=!0;return o&&this.removeZombies(),e},this.removeZombies=()=>{for(const e of this._visibleSquigglesRangeContainers.keys())e.isConnected&&this.untrackElement(e)},this.getSquigglerIsVisible=e=>(this._isAnchorElementVisible=e[e.length-1].isIntersecting,this._isAnchorElementVisible),this.getElementFromRange=e=>1===e.nodeType?e:e.parentElement}}const s={connect:()=>null,disconnect:()=>null,isSquiggleVisible:()=>!0,trackSquiggle:()=>null,unTrackSquiggle:()=>null,checkImmediateVisibility:async()=>!0}},38184:(e,t,o)=>{"use strict";var i;o.d(t,{j:()=>i}),function(e){e[e.none=0]="none",e[e.appearance=1]="appearance",e[e.highlight=2]="highlight",e[e.lineNavigation=4]="lineNavigation",e[e.cssHighlightsAPIAnnouncement=8]="cssHighlightsAPIAnnouncement",e[e.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar=16]="cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar"}(i||(i={}))},83962:(e,t,o)=>{"use strict";o.d(t,{Rw:()=>i,fD:()=>r,ue:()=>s});var i,n=o(41509);!function(e){e.caret="caret",e.cursor="cursor"}(i||(i={}));const r=(0,n.f)("ISquigglerStateStoreFactory"),s=(0,n.f)("ContentEditableSquigglerComponent")},26060:(e,t,o)=>{"use strict";o.d(t,{_:()=>i});const i=(0,o(41509).f)("ISquigglePositioningEdgeCases")},54967:(e,t,o)=>{"use strict";o.d(t,{Vw:()=>i,pz:()=>n});const i=(0,o(41509).f)("ISquiggleThemeStore"),n={highPriorityColors:{tile:"#EB0000",highlight:"#FF30001A"},mediumPriorityColors:{tile:"#3355FF",highlight:"#0055CC1A"},lowPriorityColors:{tile:"#7160E8",highlight:"#7160E833"},autoCorrectColors:{tile:"#38BA62",highlight:"#5BC55240"},ciqFlagColors:{tile:"#0F6CBD",highlight:"#0F6CBD1A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}};n.autoCorrectColors.tile,n.ciqFlagColors.tile,n.headingDetectionColors.tile,n.mediumPriorityColors.tile,n.highPriorityColors.tile,n.lowPriorityColors.tile},57419:(e,t,o)=>{"use strict";o.d(t,{$K:()=>r,iV:()=>n});var i=o(41509);(0,i.f)("InputControlsV2ProxyOptionsToken");const n=(0,i.f)("IInputControlsStateStoreFactory"),r=(0,i.f)("InputControlsSquigglerComponent")},79851:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>s}),3023==o.j)var i=o(81609);if(3023==o.j)var n=o(33390);var r=o(56415);const s=e=>{const t=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1);r.useEffect((()=>{const t=new i.J(e.anchor);return t.addListener("click",(()=>{var t;e.isMouseOver&&!e.calloutOpened&&(null===(t=e.onClick)||void 0===t||t.call(e))})),()=>{t.removeAllListeners()}}),[e.calloutOpened,e.critique,e.isMouseOver,e.anchor,e.onClick]);const o=o=>{var i,n,r;const s=o;e.isCaretOver&&(null===(i=e.openCalloutPredicate)||void 0===i?void 0:i.call(e,s))&&!e.calloutOpened?(t(o),"keyup"===s.type&&(null===(n=e.onKeyboardEvent)||void 0===n||n.call(e))):"Escape"===s.key&&"keyup"===s.type&&(null===(r=e.onEscapePress)||void 0===r||r.call(e))};return r.useEffect((()=>{if(e.isCaretOver||e.isMouseOver){const n=new i.J(e.anchor);return n.addListener("keyup",o),n.addListener("focus",t),n.addListener("blur",t),n.addListener("keydown",o),()=>{n.removeAllListeners()}}}),[e.isCaretOver,e.isMouseOver,e.calloutOpened,e.critique,e.anchor,e.openCalloutPredicate,e.onKeyboardEvent,e.onEscapePress]),r.createElement("span",{ref:e.squiggleRef,id:e.id,role:e.role,className:e.className,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,style:Object.assign({},e.styleOverrides)},r.createElement("span",{"aria-hidden":"true"},e.data.text),e.useSvgUnderline&&r.createElement(n.a,{width:"100%",left:0,patternName:e.patternName,styleOverrides:e.styleOverrides}))}},91814:(e,t,o)=>{"use strict";o.d(t,{U:()=>h});var i=o(73027);const n=(0,o(41509).f)("ISquiggleThemeFactory");var r=o(82751),s=o(63524),a=o(54967),l=o(11049),c=o(46916),u=o(41453);const d=e=>`url("data:image/svg+xml,${encodeURIComponent(e.trim())}")`;let h=class{constructor(e){this._grammarTile="",this._grammarTileBorder="",this._insightTile="",this._insightTileBorder="",this._spellingTile="",this._spellingTileBorder="",this._autoCorrectTile="",this._autoCorrectBorder="",this._ciqFlagTile="",this._ciqFlagBorder="",this._headingDetectionTile="",this._headingDetectionBorder="",this.setSquiggleTheme=e=>{this._theme={highPriorityColors:e.highPriorityColors||this._theme.highPriorityColors,mediumPriorityColors:e.mediumPriorityColors||this._theme.mediumPriorityColors,lowPriorityColors:e.lowPriorityColors||this._theme.lowPriorityColors,autoCorrectColors:e.autoCorrectColors||this._theme.autoCorrectColors,ciqFlagColors:e.ciqFlagColors||this._theme.ciqFlagColors,headingDetectionColors:e.headingDetectionColors||this._theme.headingDetectionColors},this.setGrammarTiles(this._theme),this.setInsightTiles(this._theme),this.setSpellingTiles(this._theme),this.setAutoCorrectTiles(this._theme),this.setCiqFlagTiles(this._theme),this.setHeadingDetectionTiles(this._theme)},this.setGrammarTiles=e=>{this._grammarTile=d(`\n      <svg width="5px" height="3px" viewBox="0 0 5 3" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>grammar_double_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="grammar_double_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n            <path d="M0,2.5 L5,2.5" id="Line-2-Copy-11"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._grammarTileBorder=d(`\n    <svg width="15px" height="9px" viewBox="0 0 15 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n      <title>grammar_double_line</title>\n      <desc>Created with Sketch.</desc>\n      <g id="grammar_double_line" stroke="none" stroke-width="3" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n        <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n          <path d="M0,1.5 L15,1.5" id="Line-2-Copy-10"></path>\n          <path d="M0,7.5 L15,7.5" id="Line-2-Copy-11"></path>\n        </g>\n      </g>\n    </svg>\n  `)},this.setInsightTiles=e=>{this._insightTile=d(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._insightTileBorder=d(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this.setSpellingTiles=e=>{this._spellingTile=d(`\n      <svg width="5px" height="4px" viewBox="0 0 5 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="1"></path>\n              <rect id="Rectangle" x="0" y="0" width="5" height="4"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `),this._spellingTileBorder=d(`\n      <svg width="17px" height="9px" viewBox="0 0 17 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M 0,7.5 H 1 C 4.75,7.5 4.75,1.5 8.5,1.5 12.25,1.5 12.25,7.5 16,7.5 H 17" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="3"></path>\n              <rect id="Rectangle" x="0" y="0" width="17" height="9"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `)},this.setAutoCorrectTiles=e=>{this._autoCorrectTile=d(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._autoCorrectBorder=d(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `)},this.setCiqFlagTiles=e=>{this._ciqFlagTile=d(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n          <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `),this._ciqFlagBorder=d(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n            <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `)},this.setHeadingDetectionTiles=e=>{this._headingDetectionTile=d(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._headingDetectionBorder=d(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this._theme=a.pz;const t=null==e?void 0:e();t&&this.setSquiggleTheme(t),(0,s.Gn)(this)}get theme(){return this._theme}get grammarTile(){return this._grammarTile||this.setGrammarTiles(this._theme),this._grammarTile}get grammarTileBorder(){return this._grammarTileBorder||this.setGrammarTiles(this._theme),this._grammarTileBorder}get insightTile(){return this._insightTile||this.setInsightTiles(this._theme),this._insightTile}get insightTileBorder(){return this._insightTileBorder||this.setInsightTiles(this._theme),this._insightTileBorder}get spellingTile(){return this._spellingTile||this.setSpellingTiles(this._theme),this._spellingTile}get spellingTileBorder(){return this._spellingTileBorder||this.setSpellingTiles(this._theme),this._spellingTileBorder}get autoCorrectTile(){return this._autoCorrectTile||this.setAutoCorrectTiles(this._theme),this._autoCorrectTile}get autoCorrectTileBorder(){return this._autoCorrectBorder||this.setAutoCorrectTiles(this._theme),this._autoCorrectBorder}get ciqFlagTile(){return this._ciqFlagTile||this.setCiqFlagTiles(this._theme),this._ciqFlagTile}get ciqFlagTileBorder(){return this._ciqFlagBorder||this.setCiqFlagTiles(this._theme),this._ciqFlagBorder}get headingDetectionTile(){return this._headingDetectionTile||this.setHeadingDetectionTiles(this._theme),this._headingDetectionTile}get headingDetectionTileBorder(){return this._headingDetectionBorder||this.setHeadingDetectionTiles(this._theme),this._headingDetectionBorder}};(0,i.Cg)([r.observable],h.prototype,"_theme",void 0),(0,i.Cg)([r.observable],h.prototype,"_grammarTile",void 0),(0,i.Cg)([r.observable],h.prototype,"_grammarTileBorder",void 0),(0,i.Cg)([r.observable],h.prototype,"_insightTile",void 0),(0,i.Cg)([r.observable],h.prototype,"_insightTileBorder",void 0),(0,i.Cg)([r.observable],h.prototype,"_spellingTile",void 0),(0,i.Cg)([r.observable],h.prototype,"_spellingTileBorder",void 0),(0,i.Cg)([r.observable],h.prototype,"_autoCorrectTile",void 0),(0,i.Cg)([r.observable],h.prototype,"_autoCorrectBorder",void 0),(0,i.Cg)([r.observable],h.prototype,"_ciqFlagTile",void 0),(0,i.Cg)([r.observable],h.prototype,"_ciqFlagBorder",void 0),(0,i.Cg)([r.observable],h.prototype,"_headingDetectionTile",void 0),(0,i.Cg)([r.observable],h.prototype,"_headingDetectionBorder",void 0),(0,i.Cg)([r.computed],h.prototype,"theme",null),(0,i.Cg)([r.computed],h.prototype,"grammarTile",null),(0,i.Cg)([r.computed],h.prototype,"grammarTileBorder",null),(0,i.Cg)([r.computed],h.prototype,"insightTile",null),(0,i.Cg)([r.computed],h.prototype,"insightTileBorder",null),(0,i.Cg)([r.computed],h.prototype,"spellingTile",null),(0,i.Cg)([r.computed],h.prototype,"spellingTileBorder",null),(0,i.Cg)([r.computed],h.prototype,"autoCorrectTile",null),(0,i.Cg)([r.computed],h.prototype,"autoCorrectTileBorder",null),(0,i.Cg)([r.computed],h.prototype,"ciqFlagTile",null),(0,i.Cg)([r.computed],h.prototype,"ciqFlagTileBorder",null),(0,i.Cg)([r.computed],h.prototype,"headingDetectionTile",null),(0,i.Cg)([r.computed],h.prototype,"headingDetectionTileBorder",null),(0,i.Cg)([r.action],h.prototype,"setSquiggleTheme",void 0),h=(0,i.Cg)([(0,l._)(),(0,i.Qj)(0,(0,c.l)()),(0,i.Qj)(0,(0,u.W)(n))],h)},54201:(e,t,o)=>{"use strict";o.d(t,{$:()=>i});const i=(0,o(41509).f)("IStyleDefinitions")},71297:(e,t,o)=>{"use strict";o.d(t,{y:()=>i});const i="ms-squiggle-tooltip"},1620:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});const i=(0,o(41509).f)("ISquiggleTooltipStateStore")},77195:(e,t,o)=>{"use strict";o.d(t,{F:()=>g});var i=o(56415),n=o(22474),r=o(36284),s=o(66131),a=o(81609),l=o(1620),c=o(71297),u=o(20176),d=o(5959);const h=(0,n.F5)({state:r.A.on(l.A),localizer:r.A.on(s.H)}),g=(0,u.PA)((()=>{const{state:e,localizer:t}=(0,n.KN)(h),{styles:o,fontsUrl:r,targetDocumentRef:s}=e,l=i.useCallback((()=>{e.hide()}),[e]),u=i.useCallback((()=>{e.emergencyDismiss("Tooltip dismissed on click.")}),[e]);return i.useEffect((()=>{var e,t;const o=new a.J(s),i=new a.J(null!==(t=null===(e=s.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window);return o.addListener("scroll",l,{capture:!0}),i.addListener("resize",l,{capture:!0}),()=>{o.removeAllListeners(),i.removeAllListeners()}}),[l,s]),i.createElement("div",{style:o.container},r&&i.createElement("link",{rel:"stylesheet",href:r}),i.createElement(d.Ay.div,{style:o.shadowBoundary},(()=>{const{top:o,right:n,left:r,isVisible:s,ariaLabel:a,title:l,text:d,styles:h,isEccOpen:g}=e;return!s||g?i.createElement(i.Fragment,null):i.createElement("div",{role:"status","aria-live":"polite",id:c.y,style:h.shadowRoot},i.createElement("div",{onClick:u,style:Object.assign(Object.assign({},h.root),{top:o,left:r,right:n}),role:"tooltip","aria-label":t.getMessage("combineSentences",[l,a])},i.createElement("div",{"aria-hidden":!0,style:h.tooltipMain},i.createElement("div",{"aria-hidden":!0,style:h.title},l),i.createElement("div",{"aria-hidden":!0,style:h.text},d))))})()))}))},34309:(e,t,o)=>{"use strict";o.d(t,{X:()=>x});var i=o(73027),n=o(30856),r=o(16392),s=o(39734),a=o(73186),l=o(94013),c=o(66131),u=o(83901),d=o(59696),h=o(76595),g=o(64944),p=o(38655),f=o(80098),m=o(2526),v=o(54201),b=o(82751),y=o(11049),C=o(41453),S=o(46916),w=o(37167),k=o(39690),T=o(63524);let x=class{constructor(e,t,o,i,r,s,a,l,c){this.localizer=e,this.hostSettings=t,this.presentationDomSettings=o,this.featureFlagsReader=i,this.logger=r,this.scriptDirectionDetector=s,this.styleDefinitions=a,this.urlFormatter=l,this.inlineSuggestionsRenderer=c,this._position=void 0,this._title=void 0,this._isVisible=!1,this._targetDocumentRef=void 0,this.getTitleCritique=e=>{var t;switch(e.priority){case n.bx.Low:return e.typeId===n.L9.TopicSuggestion?this.localizer.getMessage("ebx_SquiggleTooltipTopicTitle"):this.localizer.getMessage("ebx_SquiggleTooltipRefinementTitle");case n.bx.Medium:return this.localizer.getMessage("ebx_SquiggleTooltipGrammarTitle");case n.bx.High:return this.localizer.getMessage("ebx_SquiggleTooltipSpellingTitle");case n.bx.Informational:return null!==(t=e.tooltipTitle)&&void 0!==t?t:""}},this.getTitleAutocorrect=()=>this.localizer.getMessage("ebx_SquiggleTooltipAutoCorrectTitle"),this.resetTimeout=()=>{this.originStatusCheckTimer&&(window.clearTimeout(this.originStatusCheckTimer),this.originStatusCheckTimer=void 0)},this.checkOriginState=()=>{var e;null===(null===(e=this.origin)||void 0===e?void 0:e.parentElement)?this.emergencyDismiss("Tooltip dismissed on timeout: the origin is orphaned."):this.setOriginStateCheckTimeout()},this.setOriginStateCheckTimeout=()=>{this.originStatusCheckTimer=window.setTimeout(this.checkOriginState,3e3)},(0,T.Gn)(this)}get fontsUrl(){var e;return null===(e=this.urlFormatter)||void 0===e?void 0:e.getUrl(this.presentationDomSettings.fabricFontsDefinitionPath)}get title(){var e;return null!==(e=this._title)&&void 0!==e?e:""}get text(){if((0,w.kI)(this.squiggleKind))return this.localizer.getMessage("ebx_AutoCorrectTooltipText");{const e=(0,k.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipCombinationMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipCombinationAlt":"ebx_SquiggleTooltipCombination");return`${this.localizer.getMessage("ebx_SquiggleTooltipText")} ${e}`}}get ariaLabel(){return(0,w.kI)(this.squiggleKind)?this.localizer.getMessage("ebx_AutocorrectTooltipAriaText"):(0,k.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipAriaTextMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipAriaTextAlt":"ebx_SquiggleTooltipAriaText")}get isVisible(){return this._isVisible}get top(){return this._position?`${this._position.y}px`:"auto"}get left(){return!this._position||this.scriptDirectionDetector.isRtl()?"auto":`calc(min(100vw - ${this._position.x+300}px, 0px) + ${this._position.x}px)`}get right(){return this._position&&this.scriptDirectionDetector.isRtl()?`calc(100vw - max(${this._position.x}px, 300px))`:"auto"}get styles(){return this.styleDefinitions.tooltip}get isEccOpen(){var e;return!!(null===(e=this.inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo())}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new r.O(document)}async initialize(){}shutDown(){this.hide()}show(e,t,o,i,n){this.resetTimeout(),this.squiggleKind=e,this._title=(0,w.kI)(this.squiggleKind)?this.getTitleAutocorrect():this.getTitleCritique(t),this._position=o,this._isVisible=this.featureFlagsReader.flags.enableSquiggleTooltipFeature&&!!this.hostSettings.showSquiggleTooltip,this.origin=i;const c=null!=n?n:null==i?void 0:i.ownerDocument;this._targetDocumentRef=c&&new r.O(c),this.setOriginStateCheckTimeout();const u=this.logger.getNewActivity(s.n.SquiggleTooltipShown,a.o.SamplingPolicy.CriticalExperimentation);u&&(u.dataFields.push((0,l.n)("CritiqueTypeId",t.typeId)),u.success=!0,u.endNow())}hide(){this.resetTimeout(),this.origin=void 0,this._targetDocumentRef=void 0,this._isVisible=!1,this._position=void 0,this.squiggleKind=void 0}emergencyDismiss(e){this.logger.warn(545910989,e),this.hide()}};(0,i.Cg)([b.observable],x.prototype,"_position",void 0),(0,i.Cg)([b.observable],x.prototype,"_title",void 0),(0,i.Cg)([b.computed],x.prototype,"title",null),(0,i.Cg)([b.observable],x.prototype,"_isVisible",void 0),(0,i.Cg)([b.computed],x.prototype,"isVisible",null),(0,i.Cg)([b.computed],x.prototype,"top",null),(0,i.Cg)([b.computed],x.prototype,"left",null),(0,i.Cg)([b.computed],x.prototype,"right",null),(0,i.Cg)([b.observable],x.prototype,"_targetDocumentRef",void 0),(0,i.Cg)([b.computed],x.prototype,"targetDocumentRef",null),(0,i.Cg)([b.action],x.prototype,"show",null),(0,i.Cg)([b.action],x.prototype,"hide",null),x=(0,i.Cg)([(0,y._)(),(0,i.Qj)(0,(0,C.W)(c.H)),(0,i.Qj)(1,(0,C.W)(u.n)),(0,i.Qj)(2,(0,C.W)(m.D)),(0,i.Qj)(3,(0,C.W)(d.c)),(0,i.Qj)(4,(0,C.W)(h.g)),(0,i.Qj)(5,(0,C.W)(g.iw)),(0,i.Qj)(6,(0,C.W)(v.$)),(0,i.Qj)(7,(0,C.W)(p.n)),(0,i.Qj)(7,(0,S.l)()),(0,i.Qj)(8,(0,S.l)()),(0,i.Qj)(8,(0,C.W)(f.V))],x)},48551:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>c}),3023==o.j)var i=o(88290);if(3023==o.j)var n=o(69920);if(3023==o.j)var r=o(26433);if(3023==o.j)var s=o(72286);if(3023==o.j)var a=o(30757);if(3023==o.j)var l=o(45313);class c{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918365)}configureRootServices(e){e.bind(s.i).toValue(i.u),e.bind(n.JY).to(n.yi),e.bind(l.S).toExisting(n.JY),e.bind(r.mU).to(r.XG)}}},15315:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>u}),3023==o.j)var i=o(48551);if(3023==o.j)var n=o(85787);if(3023==o.j)var r=o(89931);if(3023==o.j)var s=o(94360);if(3023==o.j)var a=o(93347);if(3023==o.j)var l=o(28178);if(3023==o.j)var c=o(75231);class u{constructor(){this.imports=[a.r,i.E]}configureRootServices(e){e.bind(l.M).to(c.t),e.bind(n.$).to(n.I),e.bind(r.P).to(s.Q)}}},29492:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>d}),3023==o.j)var i=o(48551);if(3023==o.j)var n=o(72286);if(3023==o.j)var r=o(30757);if(3023==o.j)var s=o(45313);if(3023==o.j)var a=o(1620);if(3023==o.j)var l=o(77195);if(3023==o.j)var c=o(34309);if(3023==o.j)var u=o(99604);class d{constructor(){this.imports=[i.E,u.f]}get uniqueId(){return(0,r.z)(507918353)}configureRootServices(e){e.bind(a.A).to(c.X),e.bind(s.S).toExisting(a.A),e.bind(n.i).toValue(l.F)}}},99604:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>u}),3023==o.j)var i=o(55099);if(3023==o.j)var n=o(56020);if(3023==o.j)var r=o(30757);if(3023==o.j)var s=o(83901);if(3023==o.j)var a=o(59696);if(3023==o.j)var l=o(51384);if(3023==o.j)var c=o(37167);class u{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918356)}configureRootServices(e){e.bind(l.g).toDynamicValue((e=>{const t=e.get(s.n),o=e.get(a.c);return e=>{switch(e){case c.Ah.critique:return new n.FY(t,o);case c.Ah.autocorrection:case c.Ah.personalizedAutocorrection:return new i.QE(t,o);default:throw new Error("Unknown squiggle kind")}}}))}}},87857:(e,t,o)=>{"use strict";o.d(t,{S:()=>i});const i=({topicIds:e,topicNames:t,highlightedText:o,hostMetadata:i,requestId:n,source:r,traceId:s})=>{const a=`&body=${encodeURIComponent(`Tell us about your experience with this topic suggestion. Was the suggestion accurate or helpful?\n    \n\n\n\nEngineering notes:\n_______________________________\n\n    TopicIds: ${e}\n\n    TopicNames: ${t}\n\n    HighlightedText: ${o}\n\n    HostMetadata: ${i}\n\n    KMAPIRequestId: ${n}\n\n    Source: ${r}\n\n    TraceId: ${s}\n_______________________________\n`)}`;return"mailto:projecthedleyfeedback@service.microsoft.com?subject=Viva Topics Editor Suggestion Feedback"+encodeURIComponent(": "+o)+a}},94360:(e,t,o)=>{"use strict";o.d(t,{Q:()=>l});var i=o(73027),n=o(96807),r=o(11049),s=o(46916),a=o(41453);let l=class{constructor(e){this.themeStore=e}get enabled(){var e,t;return(null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme)===n.SV.highContrast||(null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"screen and (-ms-high-contrast: active)").matches)}};l=(0,i.Cg)([(0,r._)(),(0,i.Qj)(0,(0,s.l)()),(0,i.Qj)(0,(0,a.W)(n.YQ))],l)},89931:(e,t,o)=>{"use strict";o.d(t,{P:()=>i});const i=(0,o(41509).f)("IHighContrastModeDetector")},53347:(e,t,o)=>{"use strict";function i(e,t){return e===t||e.bottom===t.bottom&&e.height===t.height&&e.left===t.left&&e.right===t.right&&e.top===t.top&&e.width===t.width}o.d(t,{a:()=>i})},85787:(e,t,o)=>{"use strict";o.d(t,{$:()=>l,I:()=>c});var i=o(73027),n=o(41509),r=o(11049),s=o(41453),a=o(24719);const l=(0,n.f)("IContentValidator");let c=class{constructor(e){this.presentationSettings=e}validate(e){if(!e)return"";let t=e;return t.includes("")&&(t=t.replace(//g,"")),t.slice(0,this.presentationSettings.maxServiceContentLengthInChars)}};c=(0,i.Cg)([(0,r._)(),(0,i.Qj)(0,(0,s.W)(a.z))],c)},83652:(e,t,o)=>{"use strict";o.d(t,{f:()=>r});var i=o(73027),n=o(11049);let r=class{get critiqueCallout(){return{goPremium:{forcedColorAdjust:"none",msHighContrastAdjust:"none",backgroundColor:"window",color:"windowtext"},goPremiumLink:{color:"highlight"}}}get tooltip(){return{tooltipMain:{background:"window",boxShadow:"none",border:"1px solid windowframe"},title:{color:"windowtext"},text:{color:"windowtext"}}}};r=(0,i.Cg)([(0,n._)()],r)},99788:(e,t,o)=>{"use strict";o.d(t,{U:()=>d});var i,n=o(73027);!function(e){e.focused="1px solid #605e5c",e.none="none"}(i||(i={}));var r=o(4074),s=(0,o(88499).a)({}),a=o(33980),l=o(96807);const c=e=>{let t="'Segoe UI'";if(e)switch(e.toLowerCase()){case"ar":t="'Segoe UI Web (Arabic)'";break;case"bg-bg":case"ru-ru":case"uk-ua":t="'Segoe UI Web (Cyrillic)'";break;case"cs-cz":case"et-ee":case"hr-hr":case"hu-hu":case"lt-lt":case"lv-lv":case"pl-pl":case"lt-sr-sp":case"tr-tr":case"sk-sk":case"kk-kz":t="'Segoe UI Web (East European)'";break;case"el-gr":t="'Segoe UI Web (Greek)'";break;case"he-il":t="'Segoe UI Web (Hebrew)'";break;case"vi-vn":t="'Segoe UI Web (Vietnamese)'";break;case"ja-jp":t="YuGothic, 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka";break;case"ko-kr":t="'Malgun Gothic', Gulim";break;case"ch-zhs":t="'Microsoft Yahei', Verdana, Simsun";break;case"ch-zht":t="'Microsoft Jhenghei', Pmingliu";break;case"hi-in":t="'Nirmala UI'";break;case"th-th":t="'Leelawadee UI Regular', 'Kmer UI'";break;default:t="'Segoe UI Web (West European)'"}return`${t}, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif`};var u=o(11049);let d=class{constructor(e,t){this.uxLanguageCode=e,this.themeStore=t,this._calloutZIndex=Number.MAX_SAFE_INTEGER-1}get critiqueCallout(){return{shadowHost:{all:"initial",position:"absolute",zIndex:this._calloutZIndex},calloutMain:{root:{fontFamily:c(this.uxLanguageCode),borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:[{borderRadius:8,MsHighContrastAdjust:"auto",fontFamily:c(this.uxLanguageCode)}]},calloutV9:{fontFamily:c(this.uxLanguageCode),borderRadius:8}}}get undoCallout(){return{buttonIcon:{icon:{color:r.kd.black},root:{selectors:{"&.ms-editor-focus":{border:i.focused}}},borderRadius:"2px"},logoButtonBase:{cursor:"default",pointerEvents:"all",lineHeight:"24px",fontSize:a.s.size12,fontWeight:a.BO.semibold,WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",padding:0,margin:"0 8px",flexGrow:0,whiteSpace:"nowrap",overflow:"visible",color:s.palette.blue,alignSelf:"center"},calloutContainer:{height:"40px",borderRadius:"4px",padding:"4px"},calloutMain:{root:{borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:{borderRadius:8,MsHighContrastAdjust:"auto"}},calloutV9:{fontFamily:c(this.uxLanguageCode),borderRadius:8}}}get tooltip(){var e,t,o,i,n;const r=null===(e=this.themeStore)||void 0===e?void 0:e.getComponentActiveTheme(l.yF.squiggleTooltipComponentName);return{container:{all:"initial",position:"absolute",zIndex:Number.MAX_SAFE_INTEGER},shadowBoundary:{all:"initial"},shadowRoot:{width:"0px !important",height:"0px !important",overflowX:"hidden"},root:{position:"fixed",maxWidth:300,background:"transparent",border:"none",cursor:"default"},tooltipMain:{msHighContrastAdjust:"none",forcedColorAdjust:"none",fontFamily:c(this.uxLanguageCode),fontSize:"12px",fontWeight:600,background:null!==(t=null==r?void 0:r.background)&&void 0!==t?t:s.palette.white,padding:"6px 12px",display:"inline-block",boxShadow:null!==(o=null==r?void 0:r.shadow)&&void 0!==o?o:"0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",border:"none",borderRadius:4},title:{marginBottom:"4px",color:null!==(i=null==r?void 0:r.text)&&void 0!==i?i:s.palette.neutralSecondary},text:{color:null!==(n=null==r?void 0:r.altText)&&void 0!==n?n:s.palette.black}}}};d=(0,n.Cg)([(0,u._)()],d)},39e3:(e,t,o)=>{"use strict";o.d(t,{Y:()=>v,bb:()=>T,c$:()=>y});var i=o(73027),n=o(64944),r=o(27165),s=o(65515),a=o(54228),l=o(82739),c=o(6064),u=o(89931),d=o(82751),h=o(41509),g=o(11049),p=o(41453),f=o(46916),m=o(63524);const v=(0,h.f)("IDefaultStyleDefinitionsFactory"),b=(0,h.f)("IDefaultStyleOverrides"),y=(0,h.f)("IHighContrastStyleOverrides"),C=(0,h.f)("IRightToLeftUxStyleOverrides"),S=(0,h.f)("IRightToLeftUxFabricStyleOverrides"),w=(0,h.f)("IRightToLeftProofingStyleOverrides"),k=(0,h.f)("IRightToLeftProofingFabricStyleOverrides");let T=class{constructor(e,t,o,i,a,l,c,u,d,h,g,p){this.scriptDirectionDetector=e,this.highContrastModeDetector=t,this.proofingStore=o,this.emitter=i,this.defaultStyleDefinitionsFactory=l,this.highContrastStyleOverrides=c,this.rtlUxStyleOverrides=u,this.rtlUxFabricStyleOverrides=d,this.rltProofingStyleOverrides=h,this.rltProofingFabricStyleOverrides=g,this.styleOverrides=p,this.onProofingLanguageChanged=e=>{this.styles=this.defineStyles()},this.defineStyles=()=>{const e=this.defaultStyleDefinitionsFactory(this.uxLanguage);return this.styleOverrides?{critiqueCallout:this.applyOverrides(e.critiqueCallout,this.styleOverrides.critiqueCallout),undoCallout:this.applyOverrides(e.undoCallout,this.styleOverrides.undoCallout),tooltip:this.applyOverrides(e.tooltip,this.styleOverrides.tooltip)}:e},this.getAdjustedStyle=e=>{let t=this.styles[e];const o=this.scriptDirectionDetector.isRtl();o&&this.rtlUxStyleOverrides&&(t=this.applyOverrides(t,this.rtlUxStyleOverrides[e])),this.rtlUxFabricStyleOverrides&&(o&&document.dir!==n.K3.rtl||!o&&document.dir===n.K3.rtl)&&(t=this.applyOverrides(t,this.rtlUxFabricStyleOverrides[e]));const i=this.scriptDirectionDetector.getProofingLanguageDir();return(i===n.K3.rtl||i===n.K3.auto&&o)&&this.rltProofingStyleOverrides&&(t=this.applyOverrides(t,this.rltProofingStyleOverrides[e])),document.dir===n.K3.rtl&&this.rltProofingFabricStyleOverrides&&(t=this.applyOverrides(t,this.rltProofingFabricStyleOverrides[e])),this.highContrastModeDetector.enabled&&this.highContrastStyleOverrides&&(t=this.applyOverrides(t,this.highContrastStyleOverrides[e])),t},this.applyOverrides=(e,t)=>{if(!t)return e;const o={};for(const i of Object.keys(e))o[i]=Object.assign(Object.assign({},e[i]),t[i]);return o},this.uxLanguage=a.getUILanguage(),this.styles=this.defineStyles(),this.proofingStore.read(r.l.ProofingLanguages).then((e=>{this.onProofingLanguageChanged(s.I.getDefaultLanguageCode(e))})).catch((()=>{})),this.emitter.on("proofingLanguageChanged",(async e=>{this.onProofingLanguageChanged(e.data.defaultLanguageCode)})),(0,m.Gn)(this)}get critiqueCallout(){return this.getAdjustedStyle("critiqueCallout")}get undoCallout(){return this.getAdjustedStyle("undoCallout")}get tooltip(){return this.getAdjustedStyle("tooltip")}};(0,i.Cg)([d.observable],T.prototype,"styles",void 0),(0,i.Cg)([d.computed],T.prototype,"critiqueCallout",null),(0,i.Cg)([d.computed],T.prototype,"undoCallout",null),(0,i.Cg)([d.computed],T.prototype,"tooltip",null),(0,i.Cg)([d.action],T.prototype,"onProofingLanguageChanged",void 0),T=(0,i.Cg)([(0,g._)(),(0,i.Qj)(0,(0,p.W)(n.iw)),(0,i.Qj)(1,(0,p.W)(u.P)),(0,i.Qj)(2,(0,p.W)(a.K)),(0,i.Qj)(3,(0,p.W)(l.o)),(0,i.Qj)(4,(0,p.W)(c.v)),(0,i.Qj)(5,(0,p.W)(v)),(0,i.Qj)(6,(0,f.l)()),(0,i.Qj)(6,(0,p.W)(y)),(0,i.Qj)(7,(0,f.l)()),(0,i.Qj)(7,(0,p.W)(C)),(0,i.Qj)(8,(0,f.l)()),(0,i.Qj)(8,(0,p.W)(S)),(0,i.Qj)(9,(0,f.l)()),(0,i.Qj)(9,(0,p.W)(w)),(0,i.Qj)(10,(0,f.l)()),(0,i.Qj)(10,(0,p.W)(k)),(0,i.Qj)(11,(0,f.l)()),(0,i.Qj)(11,(0,p.W)(b))],T)},94653:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>l}),3023==o.j)var i=o(48551);if(3023==o.j)var n=o(72286);if(3023==o.j)var r=o(98218);if(3023==o.j)var s=o(55803);if(3023==o.j)var a=o(30757);class l{constructor(){this.imports=[s.Q,i.E]}get uniqueId(){return(0,a.z)(507918302)}configureRootServices(e){e.bind(n.i).toValue(r._)}}},16348:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>m}),3023==o.j)var i=o(15315);if(3023==o.j)var n=o(43726);if(3023==o.j)var r=o(54201);if(3023==o.j)var s=o(67033);if(3023==o.j)var a=o(18102);if(3023==o.j)var l=o(99788);if(3023==o.j)var c=o(72286);if(3023==o.j)var u=o(83652);if(3023==o.j)var d=o(39e3);if(3023==o.j)var h=o(30757);if(3023==o.j)var g=o(45313);var p=o(96807);if(3023==o.j)var f=o(68358);class m{constructor(){this.imports=[i.E,f.h]}get uniqueId(){return(0,h.z)(507918293)}configureRootServices(e){e.bind(c.i).toValue(s.r),e.bind(n.v).to(a.b),e.bind(g.S).toExisting(n.v),e.bind(r.$).to(d.bb),e.bind(d.c$).to(u.f),e.bind(d.Y).toDynamicValue((e=>{const t=e.getOptional(p.YQ);return e=>new l.U(e,t)}))}}},32686:(e,t,o)=>{"use strict";if(o.d(t,{O:()=>a}),3023==o.j)var i=o(29492);if(3023==o.j)var n=o(99604);if(3023==o.j)var r=o(61987);if(3023==o.j)var s=o(30757);class a{constructor(){this.imports=[r.C,i.D,n.f]}get uniqueId(){return(0,s.z)(507918281)}configureRootServices(e){}}},55118:(e,t,o)=>{"use strict";o.d(t,{C:()=>d});var i=o(35012),n=o(83962),r=o(57419),s=o(22474),a=o(36284),l=o(20176),c=o(56415);const u=(0,s.F5)({squigglerCanvasRenderingState:a.A.on(i.C),contentEditableSquigglerComponent:a.A.on(n.ue).optional(),inputControlsSquigglerComponent:a.A.on(r.$K).optional()}),d=(0,l.PA)((()=>{const{contentEditableSquigglerComponent:e,inputControlsSquigglerComponent:t,squigglerCanvasRenderingState:o}=(0,s.KN)(u),i=[],n=[];if(e)for(const t of o.squigglers)i.push(e(t[0],t[1]));if(t)for(const e of o.inputControlsProxyList)n.push(t(e));return c.createElement(c.Fragment,null,...n,...i)}))},31048:(e,t,o)=>{"use strict";o.d(t,{D:()=>P});var i=o(73027),n=o(58074),r=o(37167),s=o(45302);class a{constructor(e,t,o,i,r,s){this.hostSettings=e,this.calloutStateStore=t,this.undoCalloutStateStore=o,this.squiggleTooltipStateStore=i,this.squigglerFlagCritiqueHandler=new n.G(t,r,o,s)}hideCallout(){var e;this.calloutStateStore.isVisible&&!this.calloutStateStore.isApplyingCritiqueAction&&(this.calloutStateStore.recordInstrumentationEventId(12),this.calloutStateStore.hide()),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}async showCallout(e){var t,o,i;if(null===(t=this.squiggleTooltipStateStore)||void 0===t||t.hide(),!(null===(i=null===(o=this.hostSettings.serviceSettings)||void 0===o?void 0:o.squigglerSettings)||void 0===i?void 0:i.onSquiggleClicked)||this.hostSettings.serviceSettings.squigglerSettings.onSquiggleClicked(e.critique))if((0,s.r3)(e.critique))await this.squigglerFlagCritiqueHandler.showFlagCritique(e);else{if(this.undoCalloutStateStore&&e.squiggleKind===r.Ah.autocorrection)return this.undoCalloutStateStore.show(e);await this.calloutStateStore.show(e)}}}class l{constructor(e,t,o,i){this.squiggleTooltipStateStore=e,this.calloutStateStore=t,this.undoCalloutStateStore=o,this.featureFlagsReader=i}showTooltip(e){var t,o,i,n,r;const{squiggleKind:s,critique:a,position:l,origin:c,targetDocument:u}=e;if(!(null===(t=this.calloutStateStore)||void 0===t?void 0:t.isVisible)&&!(null===(o=this.undoCalloutStateStore)||void 0===o?void 0:o.isVisible)){if(!c&&!(null===(i=this.featureFlagsReader)||void 0===i?void 0:i.flags.enableCSSHighlightApiSquiggleRendering))return;(null===(n=this.squiggleTooltipStateStore)||void 0===n?void 0:n.isVisible)&&this.squiggleTooltipStateStore.hide(),null===(r=this.squiggleTooltipStateStore)||void 0===r||r.show(s,a,l,c,u)}}hideTooltip(){var e;null===(e=this.squiggleTooltipStateStore)||void 0===e||e.hide()}}var c=o(83962),u=o(57419),d=o(43726),h=o(1620),g=o(96206),p=o(80098),f=o(26060),m=o(87964);const v=(0,o(41509).f)("INativeApi");var b=o(47355),y=o(16392),C=o(89970),S=o(82739),w=o(88194),k=o(76595),T=o(34848),x=o(59696),I=o(83901),_=o(13199),E=o(31467),A=o(48336),R=o(37113),B=o(82751),M=o(11049),D=o(41453),O=o(46916),F=o(63524);let P=class{constructor(e,t,o,i,n,r,c,u,d,h,g,p,f,m,v,S,w,k){this.proofingEventListener=e,this.squigglerStateStoreFactory=t,this.inputControlsStateStoreFactory=o,this.calloutStateStore=i,this.settings=n,this.guidGenerator=r,this.squiggleTooltipStateStore=c,this._logger=u,this.critiqueApplicationHandler=d,this.proofingDom=h,this.safeWindow=g,this.tileContent=p,this.featureFlagsReader=f,this.hostSettings=m,this.inlineSuggestionsRenderer=v,this.squigglePositioningEdgeCases=S,this.undoCalloutStateStore=w,this.nativeApi=k,this.anchorElements=new Map,this.squigglers=new Map,this._inputControlsProxyList=[],this._inputControlsProxyListCache=[],this.getSquigglerForTile=e=>{const t=this.anchorElements.get(e);return t?this.squigglers.get(t.id):void 0},this.getCritiqueCount=e=>{var t;return!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null!==(t=null==e?void 0:e.getCritiques().length)&&void 0!==t?t:0},this.update=e=>(!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null==e?void 0:e.updateSquiggles()),this.navigate=(e,t)=>{!t&&this.squigglers.size>0&&(t=Array.from(this.squigglers.values())),t&&(this.calloutStateStore.setNavInfo({stores:t,ctr:"contenteditable",currentIndex:0,category:"category",onCloseNavigation:()=>{e()},onNavSuggestionApplied:()=>{this.calloutStateStore.navigate(0)}}),this.calloutStateStore.navigate(0))},this.clearSquiggles=(e,t,o)=>{1===e.proofedElements.length&&e.proofedElements[0].id===t?(this.anchorElements.delete(t),(0,B.runInAction)((()=>{this.squigglers.delete(o)})),e.dispose()):e.removeCritiques(t).then((()=>{(0,B.runInAction)((()=>{e.isEmpty&&(this.squigglers.delete(o),this.anchorElements.delete(t),e.dispose())}))}))},this.displayFlag=async e=>{const t={critique:e,issueText:"",setInitialFocus:!1,onDismiss(e){},onIgnoreOnce:this.onIgnoreOnce,onIgnoreAll:this.onIgnoreAll,onApplyFlag:this.onApplyFlag};await this.critiqueCalloutHandler.showCallout(t)},this.onApplyFlag=async(e,t,o)=>{await this.applyChange(e,(async(i,n)=>{await i.applyFlagSuggestion(n,void 0,e.nodeId,e,t,o)}))},this.applyChange=(e,t)=>{const o=this.proofingDom.findParagraphNode(e.nodeId);return(0,_.l)(o)&&o.parent.element?t(this.critiqueApplicationHandler,o.parent.element):Promise.resolve()},this.onIgnoreOnce=e=>{(0,s.r3)(e)&&this.applyChange(e,((t,o)=>{t.ignoreFlagOnce(o,void 0,e.nodeId,e)}))},this.onIgnoreAll=e=>{(0,s.r3)(e)&&this.applyChange(e,((t,o)=>{t.ignoreAllOfCritique(o,void 0,e.nodeId,e)}))},this.setSquiggler=(e,t)=>{this.squigglers.set(e,t)},this.notifyHost=e=>{var t,o;const i=e.data.critiquesToElementsMap;if(e.messageType===b.G.NewData)for(const e of i)null===(t=this.nativeApi)||void 0===t||t.critiqueCountChanged(e.critiques.length);else if(e.messageType===b.G.RemoveData)for(const e of i)this.anchorElements.get(e.elementId)&&(null===(o=this.nativeApi)||void 0===o||o.critiqueCountChanged(e.critiques.length))},this.getAnchorElement=(e,t)=>{var o;let i=this.anchorElements.get(e);if(i){const t=i.elementRef.deref();if(null==t?void 0:t.isConnected)return i;this.clearSquiggler(e),this.anchorElements.delete(e)}let n=t;const r=null===(o=this.squigglePositioningEdgeCases)||void 0===o?void 0:o.getEdgeCases(),s=null==r?void 0:r.find((e=>e.match(t)));if(null==s?void 0:s.getAnchorElement)n=s.getAnchorElement(t);else{if(t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(n=e)}if("true"===n.getAttribute(this.settings.editorSpellcheckAttribute)){let t;for(const o of this.anchorElements.values())o.elementRef.deref()===n&&(this.anchorElements.set(e,o),t=o);i=t}}return i||(i={id:this.guidGenerator.generate(),elementRef:new y.O(n)},this.anchorElements.set(e,i)),i},this._zoomScale=1,this.updateInputControlsProxyListCache=e=>{this._inputControlsProxyListCache=e,this.safeWindow.requestAnimationFrame((()=>(0,B.action)((()=>this._inputControlsProxyList=this._inputControlsProxyListCache))()))},this.buildInputAndTextAreaList=e=>{if(!this.inputControlsStateStoreFactory)return;this._inputControlsProxyListCache=this._inputControlsProxyListCache.map((e=>(e.messageItem.changed=!1,e)));const t=e.data.critiquesToElementsMap;for(const e of t){if(!e.element)continue;const t=this.tileContent.getContainingElement(e.element);if(!t)continue;if(!(0,C.C)(t,"HTMLInputElement")&&!(0,C.C)(t,"HTMLTextAreaElement"))continue;const o=this.getAnchorElement(e.elementId,t);if(o){this._inputControlsProxyListCache=this._inputControlsProxyListCache.filter((e=>e.messageItem.anchor.id!==o.id));const t={entry:{elementId:e.elementId,element:e.element,critiques:e.critiques},anchor:{element:o.elementRef.deref(),id:o.id},changed:!0};this._inputControlsProxyListCache.push(this.inputControlsStateStoreFactory({messageItem:t,critiqueCalloutHandler:this.critiqueCalloutHandler,tooltipHandler:this.tooltipHandler,disableClearOnFocusFix:!1}))}}this.updateInputControlsProxyListCache(this._inputControlsProxyListCache)},this.buildContentEditableList=async e=>{if(!this.squigglerStateStoreFactory)return;const t=e.data.critiquesToElementsMap;if(e.messageType===b.G.NewData||e.messageType===b.G.ChangeData)for(const e of t){if(!e.element)continue;const t=this.proofingDom.findTileNode(e.elementId);if(!t)continue;const o=this.tileContent.getContainingElement(e.element);if(!o)continue;if((0,C.C)(o,"HTMLInputElement")||(0,C.C)(o,"HTMLTextAreaElement")||!(0,C.C)(o,"HTMLElement"))continue;const i=this.getAnchorElement(e.elementId,o);let n;if(i&&(n=this.squigglers.get(i.id)),!i||!e.critiques.length){i&&n&&!e.critiques.length&&this.clearSquiggles(n,e.elementId,i.id);continue}const r={id:e.elementId,graphNode:t,element:o,critiques:e.critiques};n?await n.setCritiques(r):(n=this.squigglerStateStoreFactory(r,i.elementRef.deref(),i.id,this.critiqueCalloutHandler,this.tooltipHandler),1!==this._zoomScale&&n.scaleTransform(this._zoomScale),this.setSquiggler(i.id,n))}else if(e.messageType===b.G.RemoveData)for(const e of t)this.clearSquiggler(e.elementId)},this.critiqueCalloutHandler=new a(this.hostSettings,this.calloutStateStore,this.undoCalloutStateStore,this.squiggleTooltipStateStore,this.inlineSuggestionsRenderer,this._logger),this.tooltipHandler=new l(this.squiggleTooltipStateStore,this.calloutStateStore,this.undoCalloutStateStore,this.featureFlagsReader),(0,F.Gn)(this)}get inputControlsProxyList(){return this._inputControlsProxyList}async initialize(){this.proofingEventListener.emit("squiggleUXReadyEvent",{messageType:b.G.NewData})}shutDown(){var e;if(this.squigglers.size)for(const e of this.squigglers.values())e.dispose();this.squigglers.clear(),this.anchorElements.clear(),this.calloutStateStore.hide(),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}clearSquiggler(e){const t=this.anchorElements.get(e);if(!t)return;const o=this.squigglers.get(t.id);o&&this.clearSquiggles(o,e,t.id)}async onCritiqueForUiEvent(e){this.buildInputAndTextAreaList(e),await this.buildContentEditableList(e),this.notifyHost(e)}setZoomScale(e){this._zoomScale=e;for(const[,t]of this.squigglers)t.scaleTransform(e)}};(0,i.Cg)([B.observable],P.prototype,"squigglers",void 0),(0,i.Cg)([B.observable],P.prototype,"_inputControlsProxyList",void 0),(0,i.Cg)([B.computed],P.prototype,"inputControlsProxyList",null),(0,i.Cg)([B.action],P.prototype,"setSquiggler",void 0),(0,i.Cg)([B.action],P.prototype,"updateInputControlsProxyListCache",void 0),P=(0,i.Cg)([(0,M._)(),(0,i.Qj)(0,(0,D.W)(S.o)),(0,i.Qj)(1,(0,O.l)()),(0,i.Qj)(1,(0,D.W)(c.fD)),(0,i.Qj)(2,(0,O.l)()),(0,i.Qj)(2,(0,D.W)(u.iV)),(0,i.Qj)(3,(0,D.W)(d.v)),(0,i.Qj)(4,(0,D.W)(E.k)),(0,i.Qj)(5,(0,D.W)(w.G)),(0,i.Qj)(6,(0,D.W)(h.A)),(0,i.Qj)(6,(0,O.l)()),(0,i.Qj)(7,(0,D.W)(k.g)),(0,i.Qj)(8,(0,D.W)(g.i)),(0,i.Qj)(9,(0,D.W)(A.w)),(0,i.Qj)(10,(0,D.W)(T.j)),(0,i.Qj)(11,(0,D.W)(R.d)),(0,i.Qj)(12,(0,D.W)(x.c)),(0,i.Qj)(13,(0,D.W)(I.n)),(0,i.Qj)(14,(0,O.l)()),(0,i.Qj)(14,(0,D.W)(p.V)),(0,i.Qj)(15,(0,O.l)()),(0,i.Qj)(15,(0,D.W)(f._)),(0,i.Qj)(16,(0,O.l)()),(0,i.Qj)(16,(0,D.W)(m.x)),(0,i.Qj)(17,(0,O.l)()),(0,i.Qj)(17,(0,D.W)(v))],P)},7810:(e,t,o)=>{"use strict";const i=new(o(71927).diff_match_patch);i.Diff_Timeout=0;const n=(e,t)=>e.index>=0?(e.index=t,e):t;addEventListener("message",(e=>{"get-url"!==e.data[0]?(e=>{try{const o=[],r=e.data[0],s=e.data[1],a=e.data[2],l=i.diff_main(r,s);1===l.length&&0===l[0][0]&&e.ports[0].postMessage({result:a});let c=0,u=0,d=0,h=0,g=0,p=0;for(const e of l){const i=e[0],r=e[1].length;switch(i){case 0:g=r,p=r;break;case 1:g=0,p=r;break;case-1:d+=r;continue}u+=d,d=0;for(let e=c;e<a.length;e+=1){const r=(t=a[e]).index>=0?t.index:t;if(r<h)throw new Error("Indices are not sorted!");if(!(r>=h&&r<h+p))break;o[e]=n(a[e],0===i?r+u-h:u),c+=1}if(c===a.length)break;u+=g,h+=p}for(let e=c;e<a.length;e+=1)o[e]=n(a[e],u);e.ports[0].postMessage({result:o})}catch(t){e.ports[0].postMessage({error:t})}var t})(e):e.ports[0].postMessage({url:self.location.href})}),!1)},16216:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>R}),3023==o.j)var i=o(99604);if(3023==o.j)var n=o(83962);if(3023==o.j)var r=o(16757);if(3023==o.j)var s=o(54967);if(3023==o.j)var a=o(91814);if(3023==o.j)var l=o(26433);if(3023==o.j)var c=o(27516);if(3023==o.j)var u=o(29842);if(3023==o.j)var d=o(83997);if(3023==o.j)var h=o(81314);if(3023==o.j)var g=o(56504);if(3023==o.j)var p=o(37113);if(3023==o.j)var f=o(48336);if(3023==o.j)var m=o(81584);if(3023==o.j)var v=o(6716);if(3023==o.j)var b=o(28178);if(3023==o.j)var y=o(3100);if(3023==o.j)var C=o(11884);if(3023==o.j)var S=o(30757);if(3023==o.j)var w=o(70732);if(3023==o.j)var k=o(76595);if(3023==o.j)var T=o(48883);if(3023==o.j)var x=o(83901);if(3023==o.j)var I=o(17417);if(3023==o.j)var _=o(64947);if(3023==o.j)var E=o(92593);var A=o(56415);class R{constructor(){this.imports=[i.f]}get uniqueId(){return(0,S.z)(507847257)}configureRootServices(e){e.bind(n.ue).toValue(((e,t)=>A.createElement(r.g,{key:`squiggler-${e}`,state:t}))),e.bind(s.Vw).to(a.U),e.bind(n.fD).toDynamicValue((t=>{const o=e.get(p.d),i=e.get(w.f),n=e.get(k.g),r=e.getAll(T.zJ),a=e.get(T.M5),S=e.get(x.n),A=e.get(f.w),R=e.get(s.Vw),B=e.getOptional(m.M),M=e.getOptional(v.Ey),D=e.getOptional(l.mU),O=e.getOptional(I.z),F=e.getOptional(b.M),P=e.getOptional(y.W),N=e.getOptional(d.$),L=e.getOptional(h.a),j=e.getOptional(g.K),q=e.getOptional(C.s),H=e.getOptional(_.rI),z=e.getOptional(c.PF);return(t,s,l,c,d,h={})=>new u.i({proofedItem:t,anchorElement:s,anchorId:l,critiqueCalloutHandler:c,tooltipHandler:d,options:e.get(E.z)(h)},o,i,r,a,S,A,R,n,B,M,D,O,F,P,N,L,j,q,H,z)}))}}},92593:(e,t,o)=>{"use strict";if(o.d(t,{S:()=>d,z:()=>u}),3023==o.j)var i=o(30757);if(3023==o.j)var n=o(59696);if(3023==o.j)var r=o(83901);if(3023==o.j)var s=o(41335);if(3023==o.j)var a=o(26060);if(3023==o.j)var l=o(45375);if(3023==o.j)var c=o(38184);const u=(0,o(41509).f)("ISquigglerOptionsFactory");class d{constructor(){this.imports=[]}get uniqueId(){return(0,i.z)(507918274)}configureRootServices(e){e.bind(u).toDynamicValue((e=>{const t=e.get(n.c),o=e.get(r.n),i=e.getOptional(a._);return(e={})=>{const n=!!o.enableCaretPositionRestore&&t.flags.enableCaretPositionRestore,a=t.flags.enableSquiggleTooltipFeature&&!!o.showSquiggleTooltip,u=t.flags.enableSvgSquiggleUnderline?s.N.SVG:o.sessionType===r.d.OWA_New_Email||o.sessionType===r.d.OWA_Draft_Email?s.N.OFFICE:s.N.GENERIC;e.edgeCases=null==i?void 0:i.getEdgeCases(),e.visibilityTracker=t.flags.enableVisibilityTracker?new l.J:l.Y,e.throttleUpdates=t.flags.enableSquigglesUpdateThrottling,e.visibilityTrackerShouldTrackSquiggles=t.flags.visibilityTrackerShouldTrackSquiggles,e.mutationObserverBasedRelativePosition=t.flags.mutationObserverBasedRelativePosition,e.enableCursorIntersectionObserver=t.flags.enableCursorIntersectionObserver;let d=c.j.none;t.flags.enableAriaStatusElement&&(t.flags.enableCssHighlightApiAnnouncementsOnly?d|=c.j.cssHighlightsAPIAnnouncement:t.flags.enableCssHighlightApiAnnouncementsOnlyForSpellingAndGrammar?d|=c.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar:d|=c.j.appearance|c.j.highlight,t.flags.enableLineNavAriaAnnouncement&&(d|=c.j.lineNavigation));const h=e;return h.restoreCaretPosition=n,h.ariaFeatures=d,h.tooltipEnabled=a,h.disableSquiggleTooltipOnTextSelection=!!o.disableSquiggleTooltipOnTextSelection,h.squiggleStyleType=u,h.autoCorrectionEnabled=o.enableAutoCorrect,h.personalizedAutoCorrectionEnabled=o.enablePersonalizedAutoCorrect,h.autoCorrectionInputCacheEnabled=o.enableAutoCorrect&&t.flags.enableAutoCorrectInputCache,h.trackProofingElementsPositionEnabled=o.dynamicProofingElementsEnabled,h.disableRangeWhenApplyingCritiqueSuggestions=o.disableRangeWhenApplyingCritiqueSuggestions,h.enableClientRectBasedAutoCorrectIgnore=t.flags.enableClientRectBasedAutoCorrectIgnore,h.disableOpenAutoCorrectCalloutOnHover=o.disableOpenAutoCorrectCalloutOnHover,h}}))}}},61987:(e,t,o)=>{"use strict";if(o.d(t,{C:()=>u}),3023==o.j)var i=o(72286);if(3023==o.j)var n=o(30757);if(3023==o.j)var r=o(45313);if(3023==o.j)var s=o(99604);if(3023==o.j)var a=o(35012);if(3023==o.j)var l=o(55118);if(3023==o.j)var c=o(31048);class u{constructor(){this.imports=[s.f]}get uniqueId(){return(0,n.z)(507918273)}configureRootServices(e){e.bind(i.i).toValue(l.C),e.bind(a.C).to(c.D),e.bind(r.S).toExisting(a.C)}}},86744:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>v}),3023==o.j)var i=o(99050);if(3023==o.j)var n=o(49768);if(3023==o.j)var r=o(67849);if(3023==o.j)var s=o(68288);if(3023==o.j)var a=o(95513);if(3023==o.j)var l=o(56880);if(3023==o.j)var c=o(4434);if(3023==o.j)var u=o(8499);if(3023==o.j)var d=o(21245);if(3023==o.j)var h=o(5561);if(3023==o.j)var g=o(16232);const p={requiredFlights:["mc-editor-oa","mc-editor-oa-client-ecc"],isFeatureEnabled:(e,t)=>!0===(null==t?void 0:t.some((t=>t===e)))},f={};class m{constructor(e,t,o,i){this.refreshCadence=e,this.augloopSession=t,this.timer=o,this._logger=i}start(){this.timer.setIntervalWithDelay("refreshGraphSearchData",(()=>this.tryRefresh()),this.refreshCadence,this.refreshCadence)}stop(){this.timer.clearTimer("refreshGraphSearchData")}async tryRefresh(){if(this.augloopSession.isClosed)return;const e={parentPath:["session","doc"],items:[{id:"0",body:new n.$9({forceRefresh:!1})}]};this.augloopSession.submitOperation(new i.Xr(e))}onRefreshDone(){this._logger.info(507349215,"Graph search data refresh done")}}class v{constructor(e,t,o){var i,n,r,s,a,l,c,u,d,h;this.timer=o,this.defaultRefreshInterval=3e5,this.annotationListenerType="",this.config=e,this._logger=t,this.requiredSetting(null===(i=this.config.oaSettings)||void 0===i?void 0:i.enableOaClient,"oaSettings.enableOaClient"),this.requiredSetting(null===(r=null===(n=this.config.serviceSettings)||void 0===n?void 0:n.hybridAugloop)||void 0===r?void 0:r.enabled,"serviceSettings.hybridAugloop.enabled"),this.requiredSetting(null===(a=null===(s=this.config.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.enableGraphSearchLocal,"serviceSettings.hybridAugloop.enableGraphSearchLocal"),this.requiredSetting(null===(l=this.config.orchestratorSettings)||void 0===l?void 0:l.enableAugLoop,"orchestratorSettings.enableAugLoop"),this.requiredSetting(!!(null===(c=this.config.orchestratorSettings)||void 0===c?void 0:c.substrateAuthTokenCallback),"orchestratorSettings.substrateAuthTokenCallback"),this.checkRequiredFlights(this.config.flightsToTrack),this.cacheGetter=(null===(h=null===(d=null===(u=this.config.serviceSettings)||void 0===u?void 0:u.hybridAugloop)||void 0===d?void 0:d.wasmConfig)||void 0===h?void 0:h.disableModuleCache)?()=>f:void 0,this.config.orchestratorSettings?(this.config.orchestratorSettings.preRuntimeInit=this.config.orchestratorSettings.preRuntimeInit||[],this.config.orchestratorSettings.preRuntimeInit.push(((e,t)=>this.preRuntimeInit(e,t)))):this._logger.error(507349214,"OrchestratorSettings missing. Required for Hybrid ECC"),this.eccEnabled=(e=>{var t;return!!(null===(t=e.oaSettings)||void 0===t?void 0:t.enableOaClient)})(e),this.eccEnabled||this._logger.warn(507349213,"Hybrid ECC workflows are not enabled.  Consider excluding Hybrid plugin support to reduce overall package size.")}get wasmScriptPath(){var e,t,o;return(0,d.Gm)(null===(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.wasmConfig)||void 0===o?void 0:o.scriptPath)}preRuntimeInit(e,t){return t.inferenceServiceFactory=l._.createFactory(this.wasmScriptPath,(0,d.$A)(this.config),this.cacheGetter),t.modelDownloader=new a.$(e.appName,"fs.microsoft.com/fs/augmentationLoop","res.cdn.office.net/polymer/models"),Promise.resolve()}requiredSetting(e,t){e||this._logger.error(507349212,`Required setting ${t} for hybrid wasn't set.`,t)}checkRequiredFlights(e){const t=p.requiredFlights.filter((t=>!p.isFeatureEnabled(t,e)));0!==t.length&&this._logger.error(507349211,`Hybrid requires these flights be enabled: ${t}`,t)}async activateAnnotations(e){if(!e||!this.eccEnabled)return;e.registerLocalWorkflow(h.A);const t=this.wasmScriptPath||"",o=e=>(0,d.$A)(this.config,e),i=(0,d.uz)(this.config);e.registerLocalWorkflow((0,c.X8)(i,t,void 0,o,this.cacheGetter,void 0,!0)),e.registerLocalWorkflow((0,u.L4)(t,o,this.cacheGetter,void 0,!0)),e.activateAnnotation(r.NG.getTypeName()),e.registerLocalWorkflow(g.TE),e.activateAnnotation(s.os.getTypeName()),this.isUpdateSchedulerEnabled()?this.setupGraphSearchDataRefreshScheduler(e):e.activateAnnotation(n.$9.getTypeName())}isUpdateSchedulerEnabled(){var e,t,o;return null!==(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.enablePeriodicUpdates)&&void 0!==o&&o}getUpdateInterval(){var e,t,o;return null!==(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.periodicUpdateInterval)&&void 0!==o?o:this.defaultRefreshInterval}setupGraphSearchDataRefreshScheduler(e){this.graphSearchDataRefreshScheduler&&this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=new m(this.getUpdateInterval(),e,this.timer,this._logger),this.graphSearchDataRefreshScheduler.start(),e.activateAnnotation(n.$9.getTypeName(),{callback:this.graphSearchDataRefreshScheduler.onRefreshDone.bind(this.graphSearchDataRefreshScheduler)})}async deactivateAnnotations(e){return!(!e||!this.eccEnabled||(this.graphSearchDataRefreshScheduler&&(this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=void 0),e.releaseAnnotation(r.NG.getTypeName()),e.releaseAnnotation(s.os.getTypeName()),e.releaseAnnotation(n.$9.getTypeName()),0))}async updateAnnotationActivationConfig(){}}},39549:(e,t,o)=>{"use strict";o.d(t,{g:()=>u});var i=o(73027),n=o(86744),r=o(83901),s=o(76595),a=o(63293),l=o(11049),c=o(41453);let u=class{constructor(e,t,o){this.isEnabled=!0,this.graphSearchLocalAnnotationListener=new n.N(e,t,o)}onInitialize(){}register(e,t){}unregister(){}createAnnotationListener(){return this.graphSearchLocalAnnotationListener}onSessionReconnected(){}onDocumentCreated(){}};u=(0,i.Cg)([(0,l._)(),(0,i.Qj)(0,(0,c.W)(r.n)),(0,i.Qj)(1,(0,c.W)(s.g)),(0,i.Qj)(2,(0,c.W)(a.J))],u)},19665:(e,t,o)=>{"use strict";if(o.d(t,{p:()=>u}),3023==o.j)var i=o(15708);if(3023==o.j)var n=o(88613);if(3023==o.j)var r=o(39019);if(3023==o.j)var s=o(39549);if(3023==o.j)var a=o(20198);if(3023==o.j)var l=o(30757);if(3023==o.j)var c=o(10603);class u{constructor(){this.imports=[i.J,a.k]}get uniqueId(){return(0,l.z)(507918226)}configureRootServices(e){e.bind(n.T).to(s.g),e.bind(r.cl).toDynamicValue((e=>(e,t)=>{var o;const i=(0,c.g)(e,null===(o=t.hostSettings.orchestratorSettings)||void 0===o?void 0:o.substrateAuthTokenCallback);return Object.assign(Object.assign({},e),{isFeatureEnabled:i.isFeatureEnabled,requestAuthToken:i.requestAuthToken})}))}}},10603:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>r}),3023==o.j)var i=o(35500);function n(e,t){return async o=>o.TokenType===i.OY.Substrate&&t?{Token:await t(o)}:e(o)}function r(e,t){return{isFeatureEnabled:(o=e.isFeatureEnabled,async(e,t)=>{switch(e){case"Microsoft.Office.AugLoop.AnnotationsOrderingEnabled":case"Microsoft.Office.AugLoop.EarlyJoinCompletionEnabled":return!1;case"Microsoft.Office.AugLoop.DeltaOperationsEnabled":return!0}return o(e,t)}),requestAuthToken:n(e.requestAuthToken,t)};var o}},21245:(e,t,o)=>{"use strict";o.d(t,{$A:()=>s,Gm:()=>r,uz:()=>a});var i=o(30210);if(3023==o.j)var n=o(40857);const r=e=>{if(e){try{return new URL(e),"/"===e[e.length-1]?e.substring(0,e.length-1):e}catch(e){}const t=e.split("/").filter((e=>0!==e.length));if(0!==t.length)return["/",t.join("/")].join("")}return e},s=(e,t)=>{var o,i,n,s,a,l;return((e,t)=>["/"===e?"":r(e),t].join("/"))((null===(n=null===(i=null===(o=e.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===i?void 0:i.wasmConfig)||void 0===n?void 0:n.binaryPath)||(null===(l=null===(a=null===(s=e.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.wasmConfig)||void 0===l?void 0:l.scriptPath),t)},a=e=>{var t,o,r,s,a;const c=(0,n.e)(e);return{emailId:e.userId.email,puid:e.userId.puid,scenarios:[i.Nz.BIZ_CHAT,"PowerPoint"===(null===(t=e.hostMetadata)||void 0===t?void 0:t.appName)?i.Nz.COPILOT_POWERPOINT:i.Nz.WORKPLACE_SEARCH],tenantId:e.userId.tenantId,substrateAuthTokenType:l[e.userId.identityProvider],entityTypes:[],clientConfig:{getConfig:()=>c},prefetchOnly:!1,market:e.defaultLocale,useLocalFileRanker:null===(r=null===(o=e.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===r?void 0:r.useLocalFileRanker,includeLoopFiles:null===(a=null===(s=e.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.includeLoopFiles}},l=[i.Xe.SUBSTRATE_MSA,i.Xe.SUBSTRATE_AAD]},7389:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{GraphSearchLocalAnnotationListener:()=>i.N,HybridModule:()=>n.p,graphSearchLocalOverrideHostCallbacks:()=>s.g,hostConfigToGraphConfig:()=>r.uz}),3023==o.j)var i=o(86744);if(3023==o.j)var n=o(19665);if(3023==o.j)var r=o(21245);if(3023==o.j)var s=o(10603)},82652:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>u}),3023==o.j)var i=o(31807);if(3023==o.j)var n=o(17436);if(3023==o.j)var r=o(39671);if(3023==o.j)var s=o(48719);if(3023==o.j)var a=o(75145);if(3023==o.j)var l=o(97217);if(3023==o.j)var c=o(99790);class u{constructor(e,t){this._displayLanguage=e,this._stringProvider=t,this._defaultUiLocale="en-us",this._categoryNameToLocalizedName=new Map,this._localizationTableFallbackMapping=(0,c.mO)(),this._localizedNameToCategoryName=new Map,this._nonEditorCategories=new Set([s.s.Acronyms,s.s.Perspectives,s.s.TonalRewrite]),this.uiLocale="",this.isCategorySupportedInCurrentUiLanguage=e=>!!this._categoriesForUILocale&&e in this._categoriesForUILocale&&this._categoriesForUILocale[e].IsImplemented,this.setUiLocale(this._displayLanguage)}async setUiLocale(e){const t=e;this.uiLocale=t?t.toLowerCase():this._defaultUiLocale;const o=this._localizationTableFallbackMapping.get(this.uiLocale);if(o&&(this.uiLocale=o),this._categoriesForUILocale=await(0,a.oZ)(this.uiLocale),!this._categoriesForUILocale)throw Error(`Failed to load categories strings from localization file dynamically: ${this.uiLocale}`);this.cacheLocalizedCategories(this.uiLocale.toLowerCase(),this._categoriesForUILocale)}cacheLocalizedCategories(e,t){for(const o of Object.keys(t))this.cacheCategoryNames(o,t[o].LocalizedName,e)}get NonEditorCategories(){return this._nonEditorCategories}categoryNameToLocale(e,t){var o;const s=t.toLowerCase(),a=null===(o=this._categoryNameToLocalizedName.get(e))||void 0===o?void 0:o.get(s);if(a)return a;if(this._nonEditorCategories.has(e)){const t=this.localizeNonEditorCategoryNameToUiLocale(e);return this.cacheCategoryNames(e,t,s),t}return(0,i.C)().logEvent(571281556,"CategoryLocalizationNotFoundInLocalizationTable",n.h.Host,r.q.Error,{category:e,language:s}),e}toUiLocale(e){return this.categoryNameToLocale(e,this.uiLocale)}async localizedNameToStandardizedName(e,t){if(t===s.s.Spelling||t===s.s.Grammar||this.NonEditorCategories.has(t))return t;const o=this._localizedNameToCategoryName.get(t);if(o)return o;const i=await(0,a.oZ)(null!=e?e:this.uiLocale);if(i){const o=Object.keys(i).find((e=>{const o=i[e];return o&&o.LocalizedName===t}));if(o)return this.cacheCategoryNames(o,t,null!=e?e:this.uiLocale),o}const n=this.mapNonEditorCategoryNameToStandardizedName(t);return n?(this.cacheCategoryNames(n,t,this.uiLocale),n):t}cacheCategoryNames(e,t,o){const i=this._categoryNameToLocalizedName.get(e),n=null==i?void 0:i.get(o),r=this._localizedNameToCategoryName.get(t);if(!n)if(i)i.set(o,t);else{const i=new Map;i.set(o,t),this._categoryNameToLocalizedName.set(e,i)}r||this._localizedNameToCategoryName.set(t,e)}localizeNonEditorCategoryNameToUiLocale(e){var t;const o=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,i=o.getString.bind(o);switch(e){case s.s.Acronyms:return i("CritiqueCategoryStrings","Acronyms");case s.s.Perspectives:return i("CritiqueCategoryStrings","Perspectives");case s.s.TonalRewrite:return i("CritiqueCategoryStrings","TonalRewrite");default:return e}}mapNonEditorCategoryNameToStandardizedName(e){var t;const o=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,i=o.getString.bind(o);switch(e){case i("CritiqueCategoryStrings","Acronyms"):return s.s.Acronyms;case i("CritiqueCategoryStrings","Perspectives"):return s.s.Perspectives;case i("CritiqueCategoryStrings","TonalRewrite"):return s.s.TonalRewrite;default:return e}}}},99790:(e,t,o)=>{"use strict";var i;o.d(t,{mO:()=>n}),function(e){e.CATALAN="ca",e.CATALANCATALAN="ca-es",e.CHINESE="zh",e.CHINESESIMPLIFIED="zh-hans",e.CHINESETRADITIONAL="zh-hant",e.ENGLISH="en",e.ENGLISH_AUSTRALIA="en-au",e.ENGLISH_CANADA="en-ca",e.ENGLISH_INDIA="en-in",e.ENGLISH_UNITEDKINGDOM="en-gb",e.ENGLISH_UNITEDSTATES="en-us",e.FRENCH="fr",e.FRENCH_CANADA="fr-ca",e.FRENCH_FRANCE="fr-fr",e.GERMAN="de",e.ITALIAN="it",e.JAPANESE="ja",e.PORTUGUESE="pt",e.SPANISH="es",e.SPANISH_MEXICO="es-mx",e.SPANISH_SPAIN="es-es",e.VALENCIAN="ca-es-valencia",e.RUSSIAN="ru",e.BRAZILIAN="br"}(i||(i={}));const n=()=>new Map([[i.ENGLISH_AUSTRALIA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_CANADA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_INDIA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_UNITEDKINGDOM,i.ENGLISH_UNITEDSTATES],[i.FRENCH_CANADA,i.FRENCH_FRANCE],[i.SPANISH_MEXICO,i.SPANISH_SPAIN]]);var r;!function(e){e.Goals="Goals"}(r||(r={}))},48719:(e,t,o)=>{"use strict";var i;o.d(t,{s:()=>i}),function(e){e.Acronyms="Acronyms",e.Clarity="Clarity",e.Conciseness="Conciseness",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Vocabulary="Vocabulary",e.TonalRewrite="Tone",e.Synonyms="Synonyms",e.DistinctWords="DistinctWords",e.Readability="Readability",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Similarity="SimilarityCategoryLevel",e.Goals="GoalsCard"}(i||(i={}))},75145:(e,t,o)=>{"use strict";if(o.d(t,{oZ:()=>l}),3023==o.j)var i=o(31807);if(3023==o.j)var n=o(17436);if(3023==o.j)var r=o(39671);if(3023==o.j)var s=o(2498);const a=new Map([["es-419","es-MX"]]);async function l(e,t=!1){var c;const u=null!==(c=a.get(e))&&void 0!==c?c:e,d=(0,i.C)();try{return await o(29743)(`./${u.toLowerCase()}.json`)}catch(o){try{if(!t){const t=e.split("-")[0];if(t in s.Y){const e=s.Y[t];return l(Array.isArray(e)?e[0]:e,!0)}}d.logEvent(0,"Diagnostics",n.h.Undefined,r.q.Error,`Failed to load categories strings for locale ${e} from localization file dynamically: ${o}`,void 0,void 0,void 0,"Text_Message")}catch(t){d.logEvent(0,"Diagnostics",n.h.Undefined,r.q.Error,`Failed to load neutral categories strings for locale ${e} from localization file dynamically: ${o}`,void 0,void 0,void 0,"Text_Message")}return}}},67033:(e,t,o)=>{"use strict";o.d(t,{r:()=>We,h:()=>He});var i=o(56415),n=o(22474),r=o(36284),s=o(34624),a=o(43726),l=o(55180),c=o(36598),u=o(69261),d=o(9062),h=o(17088),g=o(66131),p=o(83901),f=o(68191),m=o(89970),v=o(81609),b=o(81991),y=o(89058);class C{get isHighContrastActive(){return window.matchMedia("(-ms-high-contrast: active), (forced-colors: active)").matches}get isHighContrastBlack(){return window.matchMedia("(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)").matches}get isHighContrastWhite(){return window.matchMedia("(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)").matches}}new C;var S=o(96807),w=o(39530),k=o(10894),T=o(33638);function x(e){return{background:{resting:e,disabled:"transparent"},border:"#D1D1D1",focusRing:"black",title:{resting:"transparent"}}}const I={marginHorizontal:16,marginTop:0,marginBottom:0},_={marginHorizontal:0,marginTop:2,marginBottom:0};T.R.Center;var E=o(43825),A=o(26086);function R(e){return{paddingHorizontal:k.QL,paddingVertical:9,backgroundColor:e.addOnFooterBackground}}function B(e,t,o){return{fontSize:t.xxsmall,fontFamily:E.V,cssColor:o?e.addOnAction:e.addOnFooterMessage,underlineType:o?A.RV.Single:A.RV.None,wrapMode:o?A.bd.NoWrap:A.bd.Normal}}function M(e){return e.premiumEmphasis}var D=o(42720),O=o(15624),F=o(65541),P=o(8357),N=o(95012),L=o(90096),j=o(4168),q=o(82913),H=o(30444);function z(e,t){return e.hover?t?Object.assign(Object.assign({},e),{resting:e.hover}):Object.assign(Object.assign({},e),{hover:void 0}):e}function W(e,t){return Object.assign(Object.assign({},e),{resting:t,hover:void 0})}function G(e,t,o,i){return Object.assign(Object.assign({},e),{background:t&&t.splitMenuHoverBackground&&o&&i?W(e.background,t.splitMenuHoverBackground):z(e.background,o),title:t&&t.splitMenuHoverForeground&&o&&i?W(e.title,t.splitMenuHoverForeground):z(e.title,o),icon:t&&t.splitMenuHoverForeground&&o&&i?W(e.icon,t.splitMenuHoverForeground):e.icon&&z(e.icon,o)})}function U(e){var t;return null!==(t=null==e?void 0:e.borderThickness)&&void 0!==t?t:1}function V(e){var t;return null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:0}var $=o(4301),K=o(53429),Q=o(11563),Y=o(98138);class J extends i.PureComponent{constructor(e){super(e),this.state={buttonHover:!1,buttonFocus:!1,overflowHover:!1,overflowFocus:!1,menuOpened:!1,overflowTimeout:void 0,highlightTimeout:void 0},this.buttonRef=i.createRef(),this.onButtonHoverIn=this.handleEvent.bind(this,"buttonHover",!0),this.onButtonHoverOut=this.handleEvent.bind(this,"buttonHover",!1),this.onButtonFocus=this.handleEvent.bind(this,"buttonFocus",!0),this.onButtonBlur=this.handleEvent.bind(this,"buttonFocus",!1),this.onOverflowHoverIn=this.handleEvent.bind(this,"overflowHover",!0),this.onOverflowHoverOut=this.handleEvent.bind(this,"overflowHover",!1),this.onOverflowFocus=this.handleEvent.bind(this,"overflowFocus",!0),this.onOverflowBlur=this.handleEvent.bind(this,"overflowFocus",!1),this.onMenuOpened=this.handleEvent.bind(this,"menuOpened",!0),this.onMenuDismissed=this.handleEvent.bind(this,"menuOpened",!1)}static shouldShowHighlight(e,t){return e.buttonHover||e.overflowHover||e.menuOpened||!t&&void 0!==e.highlightTimeout}static shouldSetHighlightTimerForEvent(e){return"buttonHover"===e||"overflowHover"===e}static shouldShowOverflow(e,t){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened||!t&&void 0!==e.overflowTimeout}static setTimerHighlightedInstance(e){this.timerHighlightedInstance!==e&&(void 0!==e&&void 0!==this.timerHighlightedInstance&&void 0!==this.timerHighlightedInstance.state.highlightTimeout&&this.timerHighlightedInstance.cancelUnhighlightTimer(!1),this.timerHighlightedInstance=e)}render(){var e,t;const o=this.props.style,n={marginHorizontal:null==o?void 0:o.marginHorizontal,marginVertical:null==o?void 0:o.marginVertical,flexibleSize:null==o?void 0:o.flexibleSize,height:null==o?void 0:o.height,minHeight:null==o?void 0:o.minHeight,maxHeight:null==o?void 0:o.maxHeight},r=this.context;if(this.drawBorderOnRoot()&&!r){const o=null!==(e=this.props.buttonProps.theme)&&void 0!==e?e:$.G7;n.borderColor=null!==(t=o.border)&&void 0!==t?t:J.shouldShowHighlight(this.state)?o.background.hover:o.background.resting,n.borderStyle="solid",n.borderWidth=U(this.props.style),n.borderRadius=V(this.props.style)}return i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Stretch,style:n},i.createElement(K.u,Object.assign({ref:this.buttonRef},this.computeButtonProps())),(s=this.props).menuProps&&s.menuProps.items&&s.menuProps.items.length>0?i.createElement(Q.o,Object.assign({},this.computeOverflowMenuProps())):null);var s}focus(){this.buttonRef.current&&this.buttonRef.current.focus()}componentWillUnmount(){J.timerHighlightedInstance===this&&J.setTimerHighlightedInstance(void 0),this.cancelOverflowTimer(!1),this.cancelUnhighlightTimer(!1),super.componentWillUnmount&&super.componentWillUnmount()}cancelOverflowTimer(e){void 0!==this.state.overflowTimeout&&(clearTimeout(this.state.overflowTimeout),e||this.setState({overflowTimeout:void 0}))}cancelUnhighlightTimer(e){void 0!==this.state.highlightTimeout&&(clearTimeout(this.state.highlightTimeout),e||this.setState({highlightTimeout:void 0}))}computeButtonProps(){var e;const t=this.context,o=U(this.props.style),i=V(this.props.style),n=Object.assign(Object.assign({},this.props.style),{paddingEnd:o,borderRadius:{topStart:i,bottomStart:i}});this.drawBorderOnRoot()||t?n.borderThickness=0:n.borderThickness={start:o,top:o,bottom:o},this.props.menuProps||delete n.paddingEnd,delete n.marginHorizontal,delete n.marginVertical,delete n.height,delete n.minHeight,delete n.maxHeight;const r=this.props.buttonProps,s=(null==r?void 0:r.icon)?null==r?void 0:r.icon:void 0,a=function(e,t){return Object.assign(Object.assign({},e),{background:z(e.background,t),title:z(e.title,t),subtitle:e.subtitle&&z(e.subtitle,t),icon:e.icon&&z(e.icon,t)})}(null!==(e=r.theme)&&void 0!==e?e:t?$.$C:$.G7,J.shouldShowHighlight(this.state)),l=function(e,t){if(null!=e)return e.map((e=>{const o=Object.assign({},e);return t&&o.cssColorHover&&(o.cssColor=o.cssColorHover),o}))}(r.titleStyle,J.shouldShowHighlight(this.state));return Object.assign(Object.assign({},r),{titleStyle:l,appearance:"subtle",icon:s,style:n,theme:a,tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0,onHoverIn:this.onButtonHoverIn,onHoverOut:this.onButtonHoverOut,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize})}computeOverflowMenuProps(){var e;const t=U(this.props.style),o=V(this.props.style),i={paddingStart:t,borderRadius:{topEnd:o,bottomEnd:o}},n=this.context;this.drawBorderOnRoot()||n?i.borderThickness=0:i.borderThickness={top:t,end:t,bottom:t};const r=this.props.menuProps,s=null!==(e=r.theme)&&void 0!==e?e:n?$.$C:$.G7;return Object.assign(Object.assign({},r),{icon:{type:"Overflow",filled:!0},hidden:!J.shouldShowOverflow(this.state),style:i,theme:G(s,this.props.theme,J.shouldShowHighlight(this.state),this.state.overflowHover||this.state.menuOpened),accessibilityLabel:(a=this.props,a.menuProps&&a.menuProps.accessibilityLabel?a.menuProps.accessibilityLabel:a.buttonProps.title&&a.strings&&a.strings.defaultSplitButtonOverflowAccessibilityLabel?a.strings.defaultSplitButtonOverflowAccessibilityLabel.replace("{0}",a.buttonProps.title):void 0),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,layerHostId:this.props.layerHostId,onHoverIn:this.onOverflowHoverIn,onHoverOut:this.onOverflowHoverOut,onFocus:this.onOverflowFocus,onBlur:this.onOverflowBlur,onMenuOpen:this.onMenuOpened,onMenuDismiss:this.onMenuDismissed});var a}setOverflowTimer(){if(!(J.hideOverflowLagInMs<=0))return this.cancelOverflowTimer(!0),setTimeout((()=>{this.setState({overflowTimeout:void 0})}),J.hideOverflowLagInMs)}setUnhighlightTimer(){if(!(J.unhoverLagInMs<=0))return this.cancelUnhighlightTimer(!0),setTimeout((()=>{J.timerHighlightedInstance===this&&J.setTimerHighlightedInstance(void 0),this.setState({highlightTimeout:void 0})}),J.unhoverLagInMs)}handleEvent(e,t){J.shouldSetHighlightTimerForEvent(e)&&t&&J.setTimerHighlightedInstance(this),this.setState((o=>{if(o[e]===t)return;const i=Object.assign({},o);return i[e]=t,t&&("overflowHover"===e&&(i.buttonHover=!1),"buttonHover"===e&&(i.overflowHover=!1)),i.highlightTimeout=J.shouldShowHighlight(o)&&!J.shouldShowHighlight(i)?this.setUnhighlightTimer():void 0,i.overflowTimeout=J.shouldShowOverflow(o)&&!J.shouldShowOverflow(i)?this.setOverflowTimer():void 0,i}))}drawBorderOnRoot(){return!this.props.menuProps||!J.shouldShowOverflow(this.state)}}J.hideOverflowLagInMs=5,J.unhoverLagInMs=5,J.timerHighlightedInstance=void 0,J.contextType=Y.O;var Z=o(23691),X=o(94458),ee=o(53899),te=o(17451),oe=o(86738),ie=o(86383);class ne extends i.Component{constructor(e){super(e),this.firstSuggestionRef=i.createRef(),this.firstSuggestionButtonRef=i.createRef(),this.footerRef=i.createRef(),this.state={definition:e.definition}}setDefinition(e){this.setState({definition:e})}componentDidMount(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)}componentDidUpdate(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}render(){var e,t,o;const{automationId:n,fontTable:r,layerHostId:s,onAction:a,settings:l,spacing:c,strings:u,style:d,theme:h}=this.props,g=k.uI(this.getTheme(),this.props.style,{useFluentV9:!!this.context});return i.createElement(N.S,{style:g,align:L.j5.Stretch},this.renderHeader(),this.renderBody(),this.renderFooterTitle(),i.createElement(oe.w,{automationId:n,layerHostId:s,definition:this.state.definition,theme:h,fontTable:r,spacing:c,style:d,strings:u,settings:l,onAction:a,overflowMenuCalloutStyle:null===(e=null==d?void 0:d.footerStyle)||void 0===e?void 0:e.overflowMenuCalloutStyle,footerContainerStyle:ie.m$(null==d?void 0:d.footerStyle),footerButtonStyle:null===(t=null==d?void 0:d.footerStyle)||void 0===t?void 0:t.buttonStyles,overflowMenuButtonStyle:null===(o=null==d?void 0:d.footerStyle)||void 0===o?void 0:o.buttonStyles,ref:this.footerRef}),this.renderAddOnFooter())}focus(){var e;this.firstSuggestionRef.current?this.firstSuggestionRef.current.focus():this.firstSuggestionButtonRef.current?this.firstSuggestionButtonRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()}executeBadgedAction(e){if(!this.props.onAction)return;const t=ie.do(this.getDefinition(),this.props.strings),o={actionSourceId:D.tR.VoiceDictationBadge,maxBadgeId:t.reduce(((e,t)=>Math.max(e,t.badgeId)),0)},i=t.filter((t=>t.badgeId===e));i.length>0?(o.executedBadgeId=i[0].badgeId,this.props.onAction(i[0].action,i[0].suggestionIndex,void 0,o)):this.props.onAction(O._R.Dismiss,void 0,void 0,o)}getBooleanSetting(e){return!!this.props.settings&&"true"===this.props.settings[e]}getDefinition(){return this.state.definition}renderContext(e){if(!e.showContext||!e.contextText||!e.contextText.length)return null;const t=(0,F.y)(this.props.strings.textFormatting,e.critiqueType,e.contextText,e.contextDecorations),o=ie.xt(e,O._R.ReadContext),n=o?Object.assign(Object.assign({},k.YV),{flexibleSize:!0}):k.YV,r=i.createElement(N.S,{style:n,accessibleLive:L.pq.Polite},i.createElement(j.c,{text:(0,P.EE)(e.contextText,ne.contextMaxLength),style:k.yl(this.getTheme(),this.getFontTable()),formatting:(0,q.S)(e.contextText.length,this.getTheme(),e.contextDecorations),accessibilityLabel:t}));if(!o)return r;const s=this.getBooleanSetting("NoTooltipForReadContext")?void 0:ie.a4(e,this.props.strings,O._R.ReadContext);return i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Center},r,ie.o2(this.getDefinition(),this.getTheme(),O._R.ReadContext,k.Bd(this.getFontTable()),this.props.strings,{action:"readcontext",context:t||e.contextText},void 0,void 0,s,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId))}getCardHeaderText(){var e,t,o,i;const n=this.getDefinition();let r;switch(n.critiqueType){case O.L9.Classification:r=this.props.strings.critique("sensitiveContentCardHeader");break;case O.L9.Spelling:case O.L9.RepeatedWord:r=this.props.strings.critique("spellingCardHeader");break;case O.L9.Grammar:r=this.props.strings.critique("grammarCardHeader");break;case O.L9.NeuralRewrite:r=this.getBooleanSetting("renderNRForAIFeedback")?void 0:this.props.strings.critique("neuralRewriteCardHeader");break;case O.L9.SimilarityChecker:r=this.props.strings.critique("similarityCheckerCardHeader");break;case O.L9.TonalRewrite:r=this.props.strings.critique("tonalRewriteCardHeader");break;case O.L9.AccColorChecker:r=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardHeader");break;case O.L9.TextPenAlternates:r=null===(i=(o=this.props.strings).textPenAlternates)||void 0===i?void 0:i.call(o,"textPenAlternatesGroupTitle");break;default:r=this.props.definition.header}return n.showDictationCommandUx&&!r&&(r=this.props.strings.critique("dictationCorrectionsGroupTitle")),r}getCardSubheaderText(){var e,t,o,i;const n=this.getDefinition();let r;if(n.isBehindPaywall)return null===(t=(e=this.props.strings).premiumPreview)||void 0===t?void 0:t.call(e,"premiumPreviewSubheader");switch(n.critiqueType){case O.L9.Spelling:r=void 0;break;case O.L9.RepeatedWord:r=this.props.strings.critique("repeatedWordCardSubheader");break;case O.L9.NeuralRewrite:r=this.getBooleanSetting("renderNRForAIFeedback")?this.props.strings.critique("aIFeedbackCardSubHeader"):this.props.strings.critique("neuralRewriteCardSubheader");break;case O.L9.SimilarityChecker:r=this.props.strings.critique("similarityCheckerCardSubheader");break;case O.L9.AccColorChecker:r=null===(i=(o=this.props.strings).accChecker)||void 0===i?void 0:i.call(o,"accColorCheckerCardSubheader");break;default:r=n.subheader}return n.showDictationCommandUx&&!r&&(r=this.props.strings.critique("dictationCorrectionCommandCardTitle")),r}renderPreviewMarker(){return i.createElement(j.c,{text:this.props.strings.critique("previewHeaderLabel"),style:k.HV(this.getTheme(),this.getFontTable())})}renderCardHeader(e){const t=e.critiqueType===O.L9.NeuralRewrite||e.critiqueType===O.L9.SimilarityChecker||e.critiqueType===O.L9.TonalRewrite?this.renderPreviewMarker():void 0,o=this.getCardHeaderText(),n=o?i.createElement(j.c,{text:o,style:k.k(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null,r=n?this.getDefinition().showPremiumIcon?i.createElement(N.S,{direction:L.PR.LeftToRight},i.createElement(H.In,{type:"PremiumDiamond",primaryColor:this.getTheme().header}),i.createElement(N.S,{style:{minWidth:6}}),n):n:null;return t?i.createElement(N.S,{align:L.j5.Stretch,direction:L.PR.LeftToRight},r,i.createElement(N.S,{style:{flexibleSize:!0,minWidth:16}}),t):r}renderCardFooterTitle(e){return e.showDictationCommandUx&&this.props.strings.critique("dictationSpelloutCommandCardTitle"),null}renderCardSubheader(){const e=this.getCardSubheaderText();return e?i.createElement(j.c,{text:e,style:k.GP(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null}renderHeader(){const e=this.getDefinition();return i.createElement(N.S,{style:k.WC,align:L.j5.Stretch},this.renderCardHeader(e),this.renderCardSubheader(),this.renderContext(e))}getAllSuggestionOverflowActions(){switch(this.getDefinition().critiqueType){case O.L9.Spelling:return[O._R.Accept,O._R.ReadAloud,O._R.SpellOut,O._R.ChangeAll,O._R.AddToAutoCorrect,O._R.AutoCorrectOptions];case O.L9.Grammar:case O.L9.Refinement:case O.L9.NeuralRewrite:return[O._R.Accept,O._R.ReadAloud,O._R.SpellOut];case O.L9.SimilarityChecker:return[O._R.LearnMore,O._R.ReadAloud,O._R.SpellOut];case O.L9.AccColorChecker:return[O._R.LearnMore];case O.L9.AddinCritique:return[O._R.Accept,O._R.ReadAloud,O._R.SpellOut];default:return[]}}shouldShowSuggestionDescription(e){return ie.eS(this.getDefinition(),O._R.Accept,e)&&this.getDefinition().showDescription&&e.subtitle&&e.subtitle.length>0}getSuggestionButtonProps(e,t,o,i){const n=this.getDefinition(),r=this.getSuggestionButtonKind(n.critiqueType,e),s=n.critiqueType===O.L9.Topic?`#${e.title}`:e.title,a=s.length,l=ie.t$(n,o,e),c=ie.EH(n,this.props.strings,this.getTheme(),l,o,t),u=void 0!==i?{type:i,filled:n.critiqueType===O.L9.RepeatedWord}:void 0,d={title:s,titleStyle:void 0!==r&&o!==O._R.MoreSources?k.D0(this.getFontTable(),a):(0,q.S)(a,this.getTheme(),e.titleDecorations),tag:e.tag,tagStyle:k.RU(this.getFontTable()),icon:u,disabled:l,onClick:()=>{var e,i;null===(i=(e=this.props).onAction)||void 0===i||i.call(e,o,t)},theme:n.critiqueType===O.L9.RepeatedWord?k.P4(this.getTheme(),r,!0):k.P4(this.getTheme(),r),strings:ie.Eh(this.props.strings.common),accessibilityRole:"menuitem",accessibilityLabel:this.getSuggestionAccessibilityLabel(e),automationLabel:"CritiqueSuggestionButton_"+e.id,badgeProps:c};return this.shouldShowSuggestionDescription(e)&&(d.subtitle=e.subtitle,d.subtitleStyle=k.qw(this.getFontTable())),d}getSuggestionButtonKind(e,t){if(t.titleDecorations&&t.titleDecorations.length>0)return;const o=this.getDefinition();if(o.isBehindPaywall)return o.actions&&-1!==o.actions.indexOf(O._R.RevealSuggestions)?"refinement":"suggestion";switch(e){case O.L9.Grammar:return"grammar";case O.L9.Refinement:case O.L9.Topic:return"refinement";default:return"suggestion"}}getSuggestionAccessibilityLabel(e){const t=this.getDefinition(),o=e.tagAccessibilityLabel||e.tag||"";return t.critiqueType!==O.L9.Spelling&&t.critiqueType!==O.L9.NeuralRewrite||!t.showDescription||!e.subtitle||0===e.subtitle.trim().length?o?this.props.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",o).replace("{1}",e.title):void 0:o&&t.critiqueType===O.L9.Spelling?this.props.strings.critique("spellingSuggestionTagAndDescriptionAccessibilityLabel").replace("{0}",o).replace("{1}",e.title).replace("{2}",e.subtitle):(t.critiqueType===O.L9.Spelling?this.props.strings.critique("spellingSuggestionDescriptionAccessibilityLabel"):this.props.strings.critique("neuralRewriteSuggestionAccessibilityLabel")).replace("{0}",e.title).replace("{1}",e.subtitle)}renderSplitButtonSuggestion(e,t,o,n,r,s){const a=this.getTheme();return i.createElement(J,{key:e,ref:t,buttonProps:o,menuProps:n,style:k.kw,theme:{splitMenuHoverBackground:a.suggestionMenuHoverBackground,splitMenuHoverForeground:a.suggestionMenuHoverForeground},strings:ie.Hz(this.props.strings.common),accessibilityPositionInSet:void 0!==r?r:1,accessibilitySetSize:void 0!==s?s:1,layerHostId:this.props.layerHostId})}renderSingleSuggestion(e,t,o,i,n,r,s,a){return[this.renderSplitButtonSuggestion(e,o,this.getSuggestionButtonProps({title:t,actions:n?[]:[i]},e,i,r),void 0,s,a)]}renderActionListAsSuggestions(e){const t=this.getDefinition();return e.filter((e=>ie.a4(t,this.props.strings,e))).map(((e,o,i)=>this.renderSingleSuggestion(o,ie.a4(t,this.props.strings,e),0===o?this.firstSuggestionRef:void 0,e,void 0,ie.g$(e),o+1,i.length)[0]))}renderSpecialSuggestions(e,t){var o,n,r;if(e.critiqueType===O.L9.RepeatedWord)return this.renderSingleSuggestion(0,this.props.strings.critique("deleteRepeatedWord"),this.firstSuggestionRef,t[0],!1,"Delete");if(e.critiqueType===O.L9.SimilarityChecker)return this.renderActionListAsSuggestions(t);if(e.isBehindPaywall){const t=!e.actions||-1===(null===(o=e.actions)||void 0===o?void 0:o.indexOf(O._R.RevealSuggestions));return this.renderSingleSuggestion(0,(null===(r=(n=this.props.strings).premiumPreview)||void 0===r?void 0:r.call(n,"premiumPreviewSuggestionTitle"))||"",this.firstSuggestionRef,O._R.RevealSuggestions,t,"Wand")}return[i.createElement(Z.v,{key:0,shimmerCount:k.Wi,styles:k.B8(this.getSpacing()),render:()=>{const e=this.renderSingleSuggestion(0,this.props.strings.common("suggestionsGroupLoadingSuggestionsText"),void 0,O._R.Accept,!0);return e.length>0?e[0]:null}})]}renderSuggestions(){const e=this.getDefinition(),t=ie.zh(e,this.props.strings);if(t)return this.renderSpecialSuggestions(e,t);const o=ie.KW(e),n=o.map(((t,n)=>{const r=this.renderSplitButtonSuggestion(n,0===n?this.firstSuggestionRef:void 0,this.getSuggestionButtonProps(t,n,O._R.Accept,this.getSuggestionIcon(e.critiqueType,t,o.length)),ie.ms(e,this.getTheme(),this.props.strings,this.getFontTable(),this.getAllSuggestionOverflowActions(),this.getBooleanSetting("NoTooltipForFooterOverflow"),void 0,n,this.props.automationId,this.props.layerHostId,this.props.onAction),n+1,o.length);return n>0&&t.tag!==o[n-1].tag?i.createElement(i.Fragment,null,i.createElement(X.w,{key:n,color:this.props.theme&&this.props.theme.separator,style:k.cK}),r):r}));return 0===n.length?this.renderSingleSuggestion(0,e.critiqueType===O.L9.NeuralRewrite?this.props.strings.critique("neuralRewriteNoSuggestionsText"):this.props.strings.common("suggestionsGroupNoSuggestionsText"),void 0,O._R.Accept,!0):n}getSuggestionIcon(e,t,o){return e===O.L9.Classification&&1===o?"Delete":e===O.L9.Grammar&&this.props.critiqueSource===D.UD.Inference?"Cloud":e!==O.L9.NeuralRewrite||ie.eS(this.getDefinition(),O._R.Accept,t)?void 0:"Info"}renderSourceUrlAsHyperlink(e,t){return i.createElement(ee.R,{url:e,theme:k.ki(this.getTheme()),style:k.eO(this.getFontTable()),text:t})}renderSourceUrlAsText(e){return i.createElement(j.c,{text:e,style:k.lb(this.getTheme(),this.getFontTable())})}renderSource(){const e=this.getDefinition(),t=this.props.sourceIndex||0;if(!e.sources)return;const o=e.sources[t].sourceUrl,n=e.sources[t].sourceTitle;if(!o||!n)return;const r=(0,P.SE)(o);return i.createElement(N.S,{style:k.ID,align:L.j5.Stretch},i.createElement(j.c,{text:n,style:k.F6(this.getFontTable(),this.getTheme())}),i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Baseline},i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Baseline,style:{flexibleSize:!0}},e.sourceUrlClickable?this.renderSourceUrlAsHyperlink(o,r):this.renderSourceUrlAsText(r)),i.createElement(j.c,{text:this.props.strings.critique("poweredByBing"),style:k.Ps(this.getFontTable())})))}generateButtonProps(e,t,o){return{onClick:()=>{this.props.onAction&&this.props.onAction(O._R.ApplyColor,o)},hoverRing:!0,style:{width:32,height:32,borderRadius:2,marginEnd:8,borderThickness:2},theme:x(e),automationLabel:`ColorPickerButton_${this.props.automationId}`,tooltip:t,tooltipProps:{layerHostId:this.props.layerHostId}}}renderColors(){var e,t,o;const n=(this.getDefinition().suggestions||[]).map(((e,t)=>i.createElement(K.u,Object.assign({key:e.id,ref:0===t?this.firstSuggestionButtonRef:void 0},this.generateButtonProps(e.title,e.subtitle,t)))));return i.createElement(N.S,{align:L.j5.Start,justifyContent:L.Pr.Start,style:I},i.createElement(j.c,{text:null!==(o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerSecondCardSubheader"))&&void 0!==o?o:"",style:k.qL(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}),i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Start,justifyContent:L.Pr.Start,style:_},n))}renderHelpLink(){const e=this.getDefinition();if(e.helpLink)return i.createElement(N.S,{direction:L.PR.LeftToRight,style:k.cq,align:L.j5.Stretch},i.createElement(ee.R,{text:e.helpLink.text,url:e.helpLink.url,theme:k.dG(this.getTheme()),style:k.ej(this.getFontTable())}))}renderBodySuggestions(){const e=this.getDefinition().critiqueType!==O.L9.SimilarityChecker?this.props.strings.critique("suggestionsGroupAccessibilityLabel"):void 0,t=this.renderSuggestions();return i.createElement(N.S,{align:L.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:e},t)}renderBody(){const e=this.getDefinition();return i.createElement(N.S,{align:L.j5.Stretch},e.critiqueType===O.L9.SimilarityChecker?this.renderSource():void 0,i.createElement(te.R,{disabled:!0},e.critiqueType===O.L9.AccColorChecker?this.renderColors():this.renderBodySuggestions()),this.renderHelpLink())}renderFooterTitle(){const e=this.getDefinition(),t=this.renderCardFooterTitle(e);return t?i.createElement(N.S,{style:k.WC,align:L.j5.Stretch},t):null}renderAddOnFooter(){if(!this.props.addOnFooterData)return null;const{addOnFooterData:e}=this.props,t={onClick:()=>{var e,t;null===(t=(e=this.props).onAction)||void 0===t||t.call(e,O._R.AddOnFooterAction)},style:k.Oc,theme:(o=this.getTheme(),{background:{resting:"transparent"},title:{resting:o.addOnAction||o.background.resting}}),automationLabel:`AddonFooterButton_${e.actionText}_${this.props.automationId}`};var o,n;return i.createElement(N.S,{style:R(this.getTheme()),direction:L.PR.LeftToRight,align:L.j5.Center,accessible:!0,accessibilityLabel:e.message},e.icon&&i.createElement(i.Fragment,null,i.createElement(H.In,{type:e.icon,primaryColor:M(this.getTheme()),fontSize:(n=this.getFontTable(),n.xsmall)}),i.createElement(N.S,{style:{width:8}})),this.getAddOnFooterFormattedText(),i.createElement(N.S,{style:{width:4}}),i.createElement(K.u,Object.assign({},t),i.createElement(j.c,{text:e.actionText,style:B(this.getTheme(),this.getFontTable(),!0)})))}getAddOnFooterFormattedText(){if(!this.props.addOnFooterData)return;const{addOnFooterData:e}=this.props;return i.createElement(j.c,{text:e.message,style:B(this.getTheme(),this.getFontTable(),!1),formatting:e.footerDecorations?(0,q.S)(e.message.length,this.getTheme(),e.footerDecorations):void 0})}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?k.ol:k.vy}getFontTable(){return this.props.fontTable?this.props.fontTable:k.d4}getSpacing(){return this.props.spacing?this.props.spacing:k.lT}}ne.contextMaxLength=120,ne.contextType=Y.O;var re,se,ae,le,ce=o(43416),ue=o(96018),de=o(89757),he=o(37918),ge=o(28352),pe=(re=function(e){var t=e.semanticColors,o=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:o.medium.fontFamily,fontWeight:o.medium.fontWeight,fontSize:o.medium.fontSize,MozOsxFontSmoothing:o.medium.MozOsxFontSmoothing,WebkitFontSmoothing:o.medium.WebkitFontSmoothing}]}},se=new Map,ae=new Set,le=function(e){var t=e.currentTarget,o=t.__id__;se.delete(o),t.removeEventListener("unload",le),ae.delete(o)},function(e){void 0===e&&(e={});var t,o=e.theme,n=(0,ue.ox)();n&&(n.__id__=n.__id__||(0,he.O)(),t=n.__id__,ae.has(t)||(ae.add(t),n.addEventListener("unload",le)));var r=(0,de.D)();o=o||r;var s=ge.K.getId(),a=[t,s,o],l=function(e,t){var o,i,n,r=t[0],s=t[1],a=t[2];return null===(n=null===(i=null===(o=e.get(r))||void 0===o?void 0:o.get(s))||void 0===i?void 0:i.get(a))||void 0===n?void 0:n.classMap}(se,a);if((0,i.useEffect)((function(){return function(e,t){var o,i,n=t[0],r=t[1],s=t[2],a=null===(i=null===(o=e.get(n))||void 0===o?void 0:o.get(r))||void 0===i?void 0:i.get(s);a&&a.refCount++}(se,[t,s,o]),function(){return function(e,t){var o,i,n,r,s,a,l,c,u=t[0],d=t[1],h=t[2],g=null===(i=null===(o=e.get(u))||void 0===o?void 0:o.get(d))||void 0===i?void 0:i.get(h);g&&(g.refCount--,0===g.refCount&&(null===(r=null===(n=e.get(u))||void 0===n?void 0:n.get(d))||void 0===r||r.delete(h),0===(null===(a=null===(s=e.get(u))||void 0===s?void 0:s.get(d))||void 0===a?void 0:a.size)&&(null===(l=e.get(u))||void 0===l||l.delete(d),0===(null===(c=e.get(u))||void 0===c?void 0:c.size)&&e.delete(u))))}(se,[t,s,o])}}),[t,s,o]),!l){var c=function(e){return"function"==typeof e}(re)?re(o):re;l=ge.K.renderStyles(c,{targetWindow:n,rtl:!!o.rtl}),function(e,t,o){var i,n,r=t[0],s=t[1],a=t[2],l=null!==(i=e.get(r))&&void 0!==i?i:new Map;e.set(r,l);var c=null!==(n=l.get(s))&&void 0!==n?n:new Map;l.set(s,c),c.set(a,{classMap:o,refCount:0})}(se,a,l)}return l});var fe=o(26473),me=o(72007),ve=o(39011),be=o(8427),ye=i.forwardRef((function(e,t){var o=function(e,t){var o=(0,ve.N)(t,e);return(0,me.T)(o),{state:o,render:fe.j}}(e,{ref:(0,be.a)(t,i.useRef(null)),as:"div",applyTo:"element"}),n=o.render,r=o.state;return function(e){var t=pe(e),o=e.className,n=e.applyTo;!function(e,t){var o,n="body"===e.applyTo,r=null===(o=(0,ue.ZY)())||void 0===o?void 0:o.body;i.useEffect((function(){if(n&&r){for(var e=0,o=t;e<o.length;e++){var i=o[e];i&&r.classList.add(i)}return function(){if(n&&r)for(var e=0,o=t;e<o.length;e++){var i=o[e];i&&r.classList.remove(i)}}}}),[n,r,t])}(e,[t.root,t.body]),e.className=(0,ce.A)(o,t.root,"element"===n&&t.body)}(r),n(r)}));ye.displayName="ThemeProvider";const Ce={primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#969696",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000"},Se={marginHorizontal:16,marginTop:12},we={marginBottom:16,marginTop:16},ke={marginBottom:16,marginTop:8},Te={marginVertical:12,marginStart:16,maxWidth:236},xe={paddingVertical:5,textAlign:T.R.Center,borderRadius:2,borderThickness:1},Ie={paddingHorizontal:0,paddingVertical:0};function _e(e,t){return{fontSize:14,lineHeight:20,fontFamily:E.V,cssColor:t?null==e?void 0:e.link:null==e?void 0:e.rejectionTextColor,underlineType:t?A.RV.Single:A.RV.None,wrapMode:t?A.bd.NoWrap:A.bd.Normal}}function Ee(e,t){return{fontFamily:E.V,fontSize:12,lineHeight:t?12:16,cssColor:t?null==e?void 0:e.titleColor:null==e?void 0:e.descriptionColor,fontWeight:t?A.IT.SemiBold:A.IT.Normal}}function Ae(e,t){return{background:t?e.primaryButtonBackground:e.defaultButtonBackground,title:t?e.primaryButtonText:e.defaultButtonText,border:t?e.primaryBorder:e.defaultBorder,focusRing:t?e.primaryButtonFocusRing:e.defaultButtonFocusRing}}function Re(e){return{background:{resting:e.backgroundColor},title:{resting:e.link},focusRing:e.defaultButtonFocusRing}}function Be(e){return{background:{resting:e.backgroundColor},title:{resting:e.dismissButtonColor},focusRing:e.defaultButtonFocusRing}}const Me={iconFontWeight:A.IT.SemiBold,iconFontSize:12,paddingHorizontal:8,paddingVertical:8,textAlign:T.R.Center};var De,Oe=o(80427);!function(e){e[e.Default=0]="Default",e[e.RejectMessage=1]="RejectMessage"}(De||(De={}));class Fe extends i.Component{constructor(e){super(e),this.acceptButtonRef=i.createRef(),this.showSettingsButtonRef=i.createRef(),this.state={tonalFirstRunState:De.Default},this.onAccept=this.onClickAction.bind(this,Oe.h.Accept),this.onIgnore=this.onClickAction.bind(this,Oe.h.Ignore),this.onReject=this.onClickAction.bind(this,Oe.h.Reject),this.onOpenEditorSettings=this.onClickAction.bind(this,Oe.h.OpenEditorSettings),this.onDismissRejectMessage=this.onClickAction.bind(this,Oe.h.DismissRejectMessage)}componentDidUpdate(e,t){if(t.tonalFirstRunState!==this.state.tonalFirstRunState)switch(this.state.tonalFirstRunState){case De.Default:this.acceptButtonRef.current&&this.acceptButtonRef.current.focus();break;case De.RejectMessage:this.showSettingsButtonRef.current&&this.showSettingsButtonRef.current.focus()}}render(){return this.state.tonalFirstRunState===De.RejectMessage?this.renderRejectionMessageCard():this.renderFreCard()}renderFreCard(){return i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Start,style:(e=this.theme,{backgroundColor:null==e?void 0:e.backgroundColor,minWidth:292})},this.renderNewFeatureIcon(),i.createElement(N.S,null,this.renderText(),this.renderButtons()));var e}renderNewFeatureIcon(){var e,t;return i.createElement(N.S,{style:Se},i.createElement(H.In,{type:"NewFeature",primaryColor:this.context?"var(--editorTonalFreCardIconPrimaryColor, var(--colorPaletteBlueBackground2))":null===(e=this.theme)||void 0===e?void 0:e.iconPrimaryColor,secondaryColor:this.context?"var(--editorTonalFreCardIconSecondaryColor, var(--colorPaletteBlueBorderActive))":null===(t=this.theme)||void 0===t?void 0:t.iconSecondaryColor}))}renderText(){const{strings:e}=this.props;return i.createElement(N.S,{style:we},i.createElement(N.S,{direction:L.PR.TopToBottom,justifyContent:L.Pr.SpaceBetween,style:{maxWidth:184}},i.createElement(N.S,{style:{marginBottom:4}},i.createElement(j.c,{text:e.cardTitle,style:Ee(this.theme,!0),accessibilityRole:"heading"})),i.createElement(j.c,{text:e.textDescription,style:Ee(this.theme,!1),accessibilityRole:"text"})))}renderButtons(){const{strings:e,automationId:t}=this.props;return i.createElement(N.S,null,i.createElement(N.S,{align:L.j5.Baseline,direction:L.PR.LeftToRight},i.createElement(N.S,{style:{marginEnd:6}},this.renderAnswerButton(e.acceptButtonText,this.onAccept,!0)),this.renderAnswerButton(e.ignoreButtonText,this.onIgnore,!1)),i.createElement(N.S,{style:ke},this.context?i.createElement(ee.R,{text:e.rejectLinkText,onClick:this.onReject,style:{fontSize:10,fontWeight:A.IT.Normal,underlineType:A.RV.Single}}):i.createElement(K.u,{onClick:this.onReject,style:Ie,theme:void 0===this.theme?void 0:Re(this.theme),automationLabel:`TonalFirstRunLinkButton_${t}`},i.createElement(j.c,{text:e.rejectLinkText,style:(o=this.theme,{fontSize:10,lineHeight:12,fontFamily:E.V,cssColor:null==o?void 0:o.link,underlineType:A.RV.Single,wrapMode:A.bd.NoWrap})}))));var o}renderAnswerButton(e,t,o){const n=o?"Primary":"Default";return i.createElement(K.u,{ref:o?this.acceptButtonRef:void 0,title:e,titleStyle:(r=e.length,[{start:0,length:r,fontWeight:A.IT.SemiBold,fontFamily:E.V,fontSize:12,lineHeight:16}]),onClick:t,appearance:o?"primary":"secondary",theme:void 0===this.theme?void 0:Ae(this.theme,o),disabled:!1,style:xe,automationLabel:`TonalFirstRunAnswerButton_${n}_${this.props.automationId}`});var r}renderRejectionMessageCard(){const{strings:e,automationId:t}=this.props;return i.createElement(N.S,{direction:L.PR.LeftToRight,align:L.j5.Start,style:(o=this.theme,{backgroundColor:null==o?void 0:o.backgroundColor})},i.createElement(N.S,{align:L.j5.Baseline,style:Te,direction:L.PR.TopToBottom},i.createElement(j.c,{text:e.rejectionMessage,style:_e(this.theme,!1),accessibilityRole:"text"}),this.context?i.createElement(ee.R,{text:e.editorSettingsText,onClick:this.onOpenEditorSettings,style:{fontSize:14,fontWeight:A.IT.Normal,underlineType:A.RV.Single}}):i.createElement(K.u,{ref:this.showSettingsButtonRef,onClick:this.onOpenEditorSettings,style:Ie,theme:void 0===this.theme?void 0:Re(this.theme),automationLabel:`OpenEditorSettings_${t}`},i.createElement(j.c,{text:e.editorSettingsText,style:_e(this.theme,!0)}))),i.createElement(K.u,{automationLabel:`DismissRejectMessage_${t}`,icon:{type:"Cancel"},onClick:this.onDismissRejectMessage,appearance:"subtle",theme:void 0===this.theme?void 0:Be(this.theme),style:Me,accessibilityLabel:e.dissmissButtonAccessibilityLabel}));var o}onClickAction(e){e===Oe.h.Reject&&this.setState({tonalFirstRunState:De.RejectMessage}),this.props.onClickAction(e)}get theme(){var e;return this.context?void 0:null!==(e=this.props.theme)&&void 0!==e?e:Ce}}Fe.contextType=Y.O;var Pe=o(16035),Ne=o(88499);let Le;var je=o(33980),qe=o(15561);const He=(0,n.F5)({store:r.A.on(a.v),footerFREStore:r.A.on(l.D).optional(),themeStore:r.A.on(S.YQ).optional(),localizer:r.A.on(g.H),calloutDismissalHandler:r.A.on(c.J).optional(),styleStore:r.A.on(S.UC).optional(),hostSettings:r.A.on(p.n)});class ze extends i.Component{constructor(e){super(e),this.hasPositioned=!1,this.renderCallout=()=>i.createElement("div",null,i.createElement(ye,Object.assign({},null!=Le?Le:Le={settings:{theme:(0,Pe.I)((0,Ne.a)())},scopedSettings:{}}),this.renderSharedCallout())),this.emitClick=e=>{const t=new MouseEvent("click",{clientX:e.clientX,clientY:e.clientY});window.document.documentElement.dispatchEvent(t)},this.onAfterRender=()=>{var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),null===(t=this.documentEventListener)||void 0===t||t.addListener("contextmenu",this.emitClick,{capture:!0}),this.store.afterRender()},this.dismiss=()=>{var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.store.clickNoActionHide()},this.renderTonalFreCard=()=>{const{themeStore:e,localizer:t}=this.props.deps,{onTonalFreAction:o}=this.store,n=null==e?void 0:e.getComponentActiveTheme(S.yF.tonalFreComponentName);if(n){let t;const o=null==e?void 0:e.getComponentThemes(S.yF.tonalFreComponentName),i=new C;o&&(i.isHighContrastWhite?t=o.get(S.SV.light):i.isHighContrastBlack&&(t=o.get(S.SV.dark)),t&&(n.iconPrimaryColor=t.highContrast.iconPrimaryColor,n.iconSecondaryColor=t.highContrast.iconSecondaryColor))}return i.createElement(Fe,{automationId:"tonal_fre_card",onClickAction:o,strings:{cardTitle:t.getMessage("ebx_tonalFreTitle"),textDescription:t.getMessage("ebx_tonalFreDescription"),acceptButtonText:t.getMessage("ebx_tonalFreAcceptButton"),ignoreButtonText:t.getMessage("ebx_tonalFreIgnoreButton"),rejectLinkText:t.getMessage("ebx_tonalFreRejectButton"),rejectionMessage:t.getMessage("ebx_tonalFreRejectMessage"),editorSettingsText:t.getMessage("ebx_tonalFreOpenEditorSettings"),dissmissButtonAccessibilityLabel:t.getMessage("ebx_tonalFreDismissButtonAccessibilityLabel")},theme:n})},this.renderSharedCard=()=>{var e,t;const{deps:o}=this.props,{footerFREStore:n,themeStore:r,styleStore:s,hostSettings:a}=o,{addOnFooterData:c,critiqueSource:h,critiqueType:g,calloutCategory:p,calloutTitle:f,suggestionsToRender:m,showSynonyms:v,dropDownActions:b,navInfo:C,brandingMode:w,explanation:k,explanationTitle:T,onCalloutAction:x,settings:I,isUpsell:_}=this.store,E=null==r?void 0:r.getComponentActiveTheme(S.iN.critiqueCalloutComponentName),A=null==s?void 0:s.getComponentStyle(S.iN.critiqueCalloutComponentName),R=null==s?void 0:s.getComponentStyle(S.iN.footerFreComponentName),B=null===(t=null===(e=a.serviceSettings)||void 0===e?void 0:e.multilingual)||void 0===t?void 0:t.hideFooterFreIcon;E&&_&&(E.addOnFooterBackground=E.upsellFooterColor);const M=null==n?void 0:n.footerProps.get(l.Y.critique);return i.createElement(u.d.Consumer,null,(e=>{var t,o,n,r;return i.createElement(i.Fragment,null,i.createElement(ne,{addOnFooterData:(null==M?void 0:M.display)?void 0:c,automationId:"browser_extension",critiqueSource:h,definition:{definitionType:"CritiqueDefinition",critiqueType:g,header:p,subheader:f,contextText:void 0,contextDecorations:void 0,suggestions:m,maximumSuggestions:m.length,showContext:!1,showDescription:v,actions:b,critiqueSetSize:C?(0,d.v)(C).length:void 0,critiquePosition:null==C?void 0:C.currentIndex,brandingMode:w,explanation:k,explanationTitle:T},onAction:x,onAfterUpdate:this.onAfterRender,settings:I,strings:this.getLocalizedSharedStrings(),style:Object.assign(Object.assign({},A),{minWidth:null!==(t=null==A?void 0:A.minWidth)&&void 0!==t?t:300,maxWidth:null!==(o=null==A?void 0:A.maxWidth)&&void 0!==o?o:420,hasBottomAttachment:(null==M?void 0:M.display)&&!M.pages.size}),theme:E,layerHostId:e}),i.createElement(y.b,{target:l.Y.critique,styles:{container:Object.assign({borderRadius:{topStart:0,topEnd:0,bottomStart:2,bottomEnd:2},minWidth:null!==(n=null==A?void 0:A.minWidth)&&void 0!==n?n:300,maxWidth:null!==(r=null==A?void 0:A.maxWidth)&&void 0!==r?r:420},null==R?void 0:R.container),dismissContainerStyle:null==R?void 0:R.dismissContainerStyle,textContainerStyle:null==R?void 0:R.textContainerStyle},hideIcon:B}))}))},this.renderSharedCallout=()=>{var e,t,o;const{localizer:n,themeStore:r}=this.props.deps,{target:s,setInitialFocus:a,shouldShowTonalFre:l,gapSpace:c,styles:d}=this.store,g=null==r?void 0:r.getComponentActiveTheme(S.yF.critiqueCalloutComponentName);if(!0!==this.context){const o=(0,je.Zq)(null===(e=d.calloutMain)||void 0===e?void 0:e.root,{marginLeft:this.state.marginLeft,marginRight:this.state.marginRight,border:(null===(t=null==g?void 0:g.callout)||void 0===t?void 0:t.borderColor)?`1px solid ${g.callout.borderColor}`:void 0});return i.createElement(u.U,{className:"ms-critique-callout","aria-label":n.getMessage("ebx_brandText"),ariaLabelledBy:"replacement-list",calloutMaxWidth:450,doNotLayer:!1,gapSpace:c,isBeakVisible:!1,onDismiss:this.dismiss,onPositioned:e=>{e&&!this.hasPositioned&&(this.hasPositioned=!0,e.alignmentEdge===w.x.left?e.elementPosition.left?this.setState({marginLeft:-15,marginRight:0}):this.setState({marginLeft:0,marginRight:15}):e.alignmentEdge===w.x.right?e.elementPosition.left?this.setState({marginLeft:15,marginRight:0}):this.setState({marginLeft:0,marginRight:-15}):this.setState({marginLeft:0,marginRight:0}))},role:"dialog",target:(0,f.KV)(s),preventDismissOnLostFocus:!1,preventDismissOnEvent:this.onPreventDismissCalloutOnEvent,styles:Object.assign(Object.assign({},d.calloutMain),{root:o})},i.createElement(b.Y,{disableFirstFocus:!a,isClickableOutsideFocusTrap:!0},l?this.renderTonalFreCard():this.renderSharedCard()))}{const e={popover:{trapFocus:a,withArrow:!1,open:this.state.calloutOpen,onOpenChange:(e,t)=>{!t.open&&this.onPreventDismissCalloutOnEvent(e)||(this.setState((e=>Object.assign(Object.assign({},e),{callOpen:t.open}))),t.open||this.dismiss())},positioning:{target:(0,f.ug)(s),align:"start",position:"below",offset:e=>({mainAxis:c,crossAxis:"start"===e.alignment?-15:0})},ariaLabel:n.getMessage("ebx_brandText"),ariaLabelledBy:"replacement-list"},surface:{className:"ms-critique-callout",style:Object.assign({padding:0,maxWidth:450,border:(null===(o=null==g?void 0:g.callout)||void 0===o?void 0:o.borderColor)?`1px solid ${g.callout.borderColor}`:void 0},d.calloutV9)}};return i.createElement(h.v,Object.assign({},e),l?this.renderTonalFreCard():this.renderSharedCard())}},this.onPreventDismissCalloutOnEvent=e=>{const{deps:t}=this.props,{calloutDismissalHandler:o}=t;if(o&&!o.shouldDismissCallout(e,"CritiqueCallout",void 0))return!0;if("click"===e.type){const t=this.store.target;if((0,m.C)(t,"HTMLElement")){if(i=t.getBoundingClientRect(),n=e.pageX,r=e.pageY,i.x<=n&&n<=i.x+i.width&&i.y<=r&&r<=i.y+i.height)return!0}}var i,n,r;return!1},this.store=e.deps.store,this.state={marginLeft:-15,marginRight:-15,calloutOpen:!0},this.documentEventListener=new v.J(this.store.targetDocumentRef)}componentWillUnmount(){var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.documentEventListener=void 0}render(){const{styles:e,target:t}=this.store;let o=this.store.isVisible;return(!t||"x"in t&&"y"in t&&0===t.x&&0===t.y||(0,m.C)(t,"HTMLElement")&&!t.isConnected)&&(o=!1),i.createElement("div",{style:e.shadowHost},o?this.renderCallout():null)}getCommonStringsMap(){return{suggestionsGroupNoSuggestionsText:this.store.noSuggestionLabel}}getTextFormattingStringsMap(){const{localizer:e}=this.props.deps,{text:t,textInContext:o}=this.store;return{contextAccessibilityLabelForSpelling:e.getMessage("contextAccessibilityLabelForSpelling",[t,o]),contextAccessibilityLabelForRepeatedWord:e.getMessage("contextAccessibilityLabelForRepeatedWord",[t,o]),contextAccessibilityLabelForGrammar:e.getMessage("contextAccessibilityLabelForGrammar",[t,o]),contextAccessibilityLabelForRefinement:e.getMessage("contextAccessibilityLabelForRefinement",[t,o]),contextAccessibilityLabelForCorrection:e.getMessage("contextAccessibilityLabelForCorrection",[t,o])}}getCritiqueExplanationStringsMap(){const{localizer:e}=this.props.deps;return{explanationTableBefore:e.getMessage("explanationTableBefore"),explanationTableAfter:e.getMessage("explanationTableAfter"),explanationTableSeparator:e.getMessage("explanationTableSeparator"),explanationTableAccessibilityLabel:e.getMessage("explanationTableAccessibilityLabel")}}getCritiqueStringsMap(){var e;const{localizer:t}=this.props.deps,{calloutCategory:o,calloutTitle:i,navInfo:n}=this.store,r=t.getMessage("ebx_asInSynonyms"),s=`{0} ${r} {1}`,a=`{0}, {1} ${r} {2}`,l=n?(0,d.v)(n).length:0,c=null!==(e=null==n?void 0:n.currentIndex)&&void 0!==e?e:0,u=l-c-1;return{previewHeaderLabel:t.getMessage("ebx_previewLabel"),spellingCardHeader:o,repeatedWordCardSubheader:i,grammarCardHeader:o,tonalRewriteCardHeader:t.getMessage("ebx_toneLabel"),deleteRepeatedWord:t.getMessage("ebx_deleteRepeatedWord"),spellingSuggestionDescriptionAccessibilityLabel:s,suggestionWithTagAccessibilityLabel:"{0}, {1}",spellingSuggestionTagAndDescriptionAccessibilityLabel:a,ignoreAll:t.getMessage("ebx_ignoreAllButtonLabel"),ignoreOnce:t.getMessage("ebx_ignoreOnceButtonLabel"),addToDictionary:t.getMessage("ebx_addToDictionaryButtonLabel"),microsoftEditorBranding:t.getMessage("ebx_brandText"),microsoftEditorBrandingAccessibilityLabel:t.getMessage("ebx_brandTextArialLabel"),editorButtonTooltipContent:t.getMessage("ebx_settingsButtonTooltip"),footerSeeMoreActionsAccessibilityLabel:t.getMessage("ebx_moreButtonArialLabel"),changeAll:t.getMessage("ebx_changeAllCommandLabel"),giveFeedbackButtonText:t.getMessage("ebx_giveFeedback"),hideSynonyms:t.getMessage("ebx_hideSynonyms"),showSynonyms:t.getMessage("ebx_showSynonyms"),ignoreRule:t.getMessage("ebx_disableCritiqueButton"),options:t.getMessage("ebx_changeSettingsCommandLabel"),manageLanguages:t.getMessage("ebx_manageLanguages"),nextIssue:t.getMessage("ebx_nextIssueWithCount",u.toString()),nextIssueWithCount:t.getMessage("ebx_nextIssueWithCount",u.toString()),previousIssue:t.getMessage("ebx_previousIssueWithCount",c.toString()),previousIssueWithCount:t.getMessage("ebx_previousIssueWithCount",c.toString()),readAloudOriginalSentenceAccessibilityLabel:t.getMessage("readAloudOriginalSentenceAccessibilityLabel"),explanationFlyoutAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),footerExplanationButtonAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),editorButtonText:t.getMessage("editorButtonText")}}getLocalizedSharedStrings(){const e=this.getCritiqueStringsMap(),t=this.getCommonStringsMap(),o=this.getCritiqueExplanationStringsMap(),i=this.getTextFormattingStringsMap();return{critique:t=>e[t]||"",common:e=>t[e]||"",critiqueExplanation:e=>o[e]||"",textFormatting:e=>i[e]||""}}}ze.contextType=S.O1;const We=(0,s.r)((0,qe.PA)(ze),He)},18102:(e,t,o)=>{"use strict";o.d(t,{b:()=>ie});var i,n,r=o(73027),s=o(55623),a=o(27165),l=o(41509);!function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(i||(i={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(n||(n={}));const c=(0,l.f)("IUpsellFeature");var u=o(92038),d=o(39734),h=o(73186),g=o(94013),p=o(30856),f=o(29446),m=o(73135);const v=(e,t,o,i)=>{if(i){let i=t;for(;" "!==e.charAt(i)&&i<o;)i+=1;return i}{let i=o;const n=o;for(;" "!==e.charAt(i)&&i>t;)i-=1;return i+1<=n&&(i+=1),i}};var b=o(6601),y=o(16392),C=o(45505),S=o(54228),w=o(66131),k=o(83901),T=o(70732),x=o(76595),I=o(64944),_=o(36016),E=o(59696),A=o(23433),R=o(64058),B=o(6716),M=o(53216),D=o(11884),O=o(28178);const F=(0,l.f)("ITonalFreStore");var P=o(61874),N=o(63524),L=o(87857),j=o(9062),q=o(37167),H=o(54201),z=o(69920),W=o(46536),G=o(14336),U=o(85787),V=o(65030),$=o(82751),K=o(11049),Q=o(41453),Y=o(46916),J=o(15624),Z=o(42720),X=o(80427),ee=o(39609),te=o(69631),oe=o(15567);let ie=class{constructor(e,t,o,r,l,c,y,C,S,w,k,T,x,I,_,E,A,R,D,O,F,H,z,W){var G;this.proofingStore=e,this.localizerService=t,this.hostSettings=o,this.wordDictionary=r,this.instrumentationProcessor=l,this.logger=c,this.validator=y,this._showSynonymsFeature=C,this._upsellFeature=S,this.styleDefinitions=w,this.scriptDirectionDetector=k,this._roamingDictionaryBroker=T,this._upsellStore=x,this._featureFlagsReader=I,this._unSignedInEditorFeature=_,this._ariaStatusStateStore=E,this._feedbackStore=A,this._tonalFreStore=R,this._categoryLocalization=D,this._paneOpenState=O,this._externalSettingsFeature=F,this._roamingDictionaryFeature=H,this._indicatorStore=z,this._multilingualFreStore=W,this.wasMarkedAsShown=!1,this.enableUpsell=!1,this._setInitialFocus=!1,this._isVisible=!1,this._target=void 0,this.showSynonymsState=!1,this._suggestionsToRender=[],this.isApplyingCritiqueAction=!1,this.navInfo=void 0,this._gapSpace=void 0,this._unsignedInEditorFeatureEnabled=!1,this.show=async e=>{var t,o,r,l,c,d;const{critique:h,setInitialFocus:g,target:p,onDismiss:f,onApplySuggestion:m,onIgnoreOnce:v,onIgnoreAll:b,onDisableCritiqueType:y,onShowFeedback:C,targetDocumentRef:S,gapSpace:w}=e,k=null!==(o=null===(t=this._upsellStore)||void 0===t?void 0:t.reducePreviewCount(h))&&void 0!==o?o:B.nz.Visible,T=null===(r=this._upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(h);if(k!==B.nz.Hidden&&!T){if(this._unsignedInEditorFeatureEnabled=await this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:s.o9.CalloutShown,sender:s.v$.CritiqueCallout}),this.setSynonymsState(await this.proofingStore.read(a.l.ShowSynonyms)),this._suggestionsToRender=[],this._setInitialFocus=g,this.critique=h,this._targetDocumentRef=S,this.enableUpsell=!!(null===(l=this._upsellFeature)||void 0===l?void 0:l.emitAndEvaluate({eventId:i.CritiqueClicked,sender:n.ShowCritiqueCallout,critique:this.critique})),h.suggestions.length>0)for(const[e,t]of h.suggestions.entries()){if((0,u.gA)(t.action))continue;let o={id:e.toString(),title:this.getSuggestionTitle(t),subtitle:this.getSuggestionDescription(t),tag:this.getLanguageTags(t),actions:[J._R.Accept]};this.isRewrite&&(o=Object.assign(Object.assign({},o),this.getSuggestionTitleWithDecorations(t))),this.suggestionsToRender.push(o)}this.critique.shouldShowMultilingualFre?null===(c=this._multilingualFreStore)||void 0===c||c.addMultilingualProofingFre():null===(d=this._multilingualFreStore)||void 0===d||d.removeMultilingualProofingFre(),this.onAfterShownCallback=()=>{this._setInitialFocus&&(0,oe.Fy)(!0),this.onAfterShownCallback=void 0},this._gapSpace=w,(0,$.runInAction)((()=>{this._target=p})),this.onApplySuggestion=m,this.onIgnoreOnce=v,this.onIgnoreAll=b,this.onDisableCritiqueType=y,this.onShowFeedback=C,this.setIsVisible(!0),this.onShown(h,f)}},this.setSynonymsState=e=>{this.showSynonymsState=e},this.setIsVisible=e=>{this._isVisible=e,this.wasMarkedAsShown=!1},this.hide=()=>{var e;(this._isVisible||this.wasMarkedAsShown)&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isRewrite&&(null===(e=this._tonalFreStore)||void 0===e||e.checkIfDisableTonalCritiqueInitiatedAndCompleteIt()),this._isVisible=!1,this.wasMarkedAsShown=!1,this.instrumentationEventId=void 0,this.critique=void 0,this._target=void 0,this._targetDocumentRef=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onDisableCritiqueType=void 0,this.footerAction=void 0,this._gapSpace=void 0,this._suggestionsToRender=[],this.onDismiss()},this.onDismiss=()=>{var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this),this.onDismissCallback=void 0},this.afterRender=()=>{var e;null===(e=this.onAfterShownCallback)||void 0===e||e.call(this)},this.onCalloutAction=(e,t,o)=>{this.isApplyingCritiqueAction=!0;try{this.isCritiqueAction(e)?this.onCritiqueAction(e,t):this.onCardAction(e)}finally{this.isApplyingCritiqueAction=!1}},this.onTonalFreAction=e=>{var t;if(this._tonalFreStore){this.isApplyingCritiqueAction=!0;try{let o=!1;switch(e){case X.h.Accept:this._tonalFreStore.acceptTonalRewriteCritique();break;case X.h.Ignore:this.ignoreOnce(),o=!0,this._tonalFreStore.logTonalFreIgnored();break;case X.h.Reject:void 0!==(null===(t=this.critique)||void 0===t?void 0:t.typeId)&&this._tonalFreStore.disableTonalRewriteCritique(this.critique.typeId);break;case X.h.OpenEditorSettings:this._tonalFreStore.showEditorSettings(),o=!0;break;case X.h.DismissRejectMessage:o=!0}o&&this.hide()}finally{this.isApplyingCritiqueAction=!1}}},this.changeShowSynonymsState=()=>{const e=!this.showSynonymsState;this.proofingStore.write(a.l.ShowSynonyms,e).then((()=>{this.updateShowSynonyms(e)}))},this.updateShowSynonyms=e=>{this.showSynonymsState=e;const t=this.logger.getNewActivity(this.showSynonyms?d.n.ActionShowSynonymsFromCallout:d.n.ActionHideSynonymsFromCallout,h.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())},this.goPremium=e=>{var t;null===(t=this._upsellFeature)||void 0===t||t.goPremium(n.ShowCritiqueCallout,this.critique,e)},this.tryPremiumPreview=()=>{var e;null===(e=this._upsellStore)||void 0===e||e.tryPremiumPreview(this.critique)},this.signIn=()=>{chrome.runtime.sendMessage({activity:"authentication",type:"msidUserService"});const e=this.logger.getNewActivity(d.n.SignInInitialized,h.o.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push((0,g.n)("Entry","CritiqueCallout")),e.success=!0,e.endNow())},this.clickNoActionHide=()=>{const e=this.shouldShowTonalFre;!this.isVisible&&!this.wasMarkedAsShown||e||this.recordInstrumentationEventId(V.xp.ClickNoAction),this.hide()},this.notifyAriaStatusChange=e=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(e,"assertive")},this.applySuggestion=(e,t)=>{var o;this.critique&&this.onApplySuggestion&&(null===(o=this._upsellStore)||void 0===o||o.removePremiumCritique(this.critique),this.onApplySuggestion(this.critique,e))},this.ignoreOnce=()=>{var e,t;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&(null===(t=this.onIgnoreOnce)||void 0===t||t.call(this,this.critique))},this.ignoreAll=()=>{var e;this.critique&&(null===(e=this.onIgnoreAll)||void 0===e||e.call(this,this.critique))},this.addToDictionary=()=>{var e;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&this.wordDictionary.addWordToCustomDictionary(this.critique.textInContext)},this.disableCritiqueType=async()=>{var e;const t=this.critique;if(void 0===(null==t?void 0:t.typeId))return void this.logger.error(571326788,"Undefined critique or typeId while trying to disable a critique type");await(null===(e=this.onDisableCritiqueType)||void 0===e?void 0:e.call(this,t));const o=this.logger.getNewActivity(d.n.ActionDisableCritique,h.o.SamplingPolicy.CriticalExperimentation);o&&(o.dataFields.push((0,g.n)("CritiqueTypeId",t.typeId)),t.typeId===p.L9.TopicSuggestion&&o.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(t.metadata))),o.success=!0,o.endNow()),this.recordInstrumentationEventId(V.xp.DoNotCheckThisIssue),this.notifyAriaStatusChange(t.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",t.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel")),this.hide()},this.onRewriteFeedback=()=>{if(this.isRewrite){const e=this.suggestionsToRender.length>0?this.suggestionsToRender[0].title:"";this._feedbackStore.feedbackIconClicked(e,"tonal"),this.hide()}},this.isCritiqueAction=e=>{switch(e){case J._R.Accept:case J._R.IgnoreOnce:case J._R.IgnoreAll:case J._R.AddToDictionary:case J._R.IgnoreRule:return!0;default:return!1}},this.onCritiqueAction=(e,t)=>{var o;if(!this.critique)return void this.logger.error(562438878,`Undefined critique on action: ${e}`);const i=void 0!==t?this.critique.suggestions[t]:void 0;let n,r;switch(e){case J._R.Accept:i&&void 0!==t?(this.applySuggestion(i,t),n=this.localizer.getMessage("ebx_SuggestionAppliedMessage",i.text),r=this.isSpellingDeletion?V.xp.Delete:Math.min(t+V.xp.ChangeSugg0,V.xp.ChangeSuggOther)):this.logger.error(543495585,`Undefined suggestionIndex or suggestion on Accept: ${t}, ${i}`);break;case J._R.IgnoreOnce:this.ignoreOnce(),n=this.localizer.getMessage("ebx_GrammarIgnored"),r=V.xp.Ignore;break;case J._R.IgnoreAll:this.ignoreAll(),n=this.localizer.getMessage("ebx_SpellingIgnored"),r=V.xp.IgnoreAll;break;case J._R.AddToDictionary:this.addToDictionary(),n=this.localizer.getMessage("ebx_AddedToDictionary",this.critique.textInContext),r=V.xp.AddToDictionary;break;case J._R.IgnoreRule:this.disableCritiqueType(),n=this.critique.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",this.critique.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel"),r=V.xp.DoNotCheckThisIssue}void 0!==r?this.recordInstrumentationEventId(r):this.logger.error(562438879,`Undefined actionInstrumentationEventId on action: ${e}`),void 0!==n?this.notifyAriaStatusChange(n):this.logger.error(562438880,`Undefined actionAriaNotification on action: ${e}`),this.hide(),null===(o=this.navInfo)||void 0===o||o.onNavSuggestionApplied()},this.executeActionIfDefined=(e,t)=>{t?t():this.logger.error(561853783,`Undefined action clicked: ${e}`)},this.onCardAction=e=>{var t,o;switch(e){case J._R.Options:this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide();break;case J._R.ManageLanguages:this.executeActionIfDefined("manageLanguagesAction",this.manageLanguagesAction),this.hide();break;case J._R.ShowExplanation:break;case J._R.Feedback:if(this.isRewrite)this.onRewriteFeedback();else if(this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback){let e;try{e=this.critique.suggestions.map((e=>{var t;return JSON.parse(null!==(t=e.metadataJSON)&&void 0!==t?t:"{}")}))}catch(e){this.logger.error(537778203,"Error parsing topic metadata json.")}(0,f.z)((0,L.S)({topicIds:(null==e?void 0:e.map((e=>e.id)).join(", "))||"",topicNames:(null==e?void 0:e.map((e=>e.displayName)).join(", "))||"",highlightedText:this.critique.textInContext||"",requestId:this.critique.metadata[0].value,hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),source:"EditorFlag",traceId:this.critique.traceId||""}))}else this.executeActionIfDefined("onShowFeedback",this.onShowFeedback);break;case J._R.ToggleDescription:this.changeShowSynonymsState();break;case J._R.AddOnFooterAction:this.executeActionIfDefined("footerAction",this.footerAction);break;case J._R.Next:this.navigate(1);break;case J._R.Previous:this.navigate(-1);break;case J._R.OpenEditorPane:this._indicatorStore?null===(o=(t=this._indicatorStore).onOpenEditorPane)||void 0===o||o.call(t,P.k.ContextualCard):this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide()}},this.getSuggestionTitle=e=>!(0,M.qB)(e)&&this.critique&&(0,M.ht)(this.critique)?this.localizer.getMessage("ebx_deleteRepeatedWord"):this.validator.validate(e.text),this.getSuggestionTitleWithDecorations=e=>{var t;if(null===(t=this.critique)||void 0===t?void 0:t.textInContext){const{truncatedPrefix:t,truncatedSubstring:o,truncatedSuffix:i}=((e,t)=>{const o=t.length,i=((e,t)=>{const o=e.length,i=t.length;let n=0,r=0;for(let s=0;s<Math.min(o,i)&&e.charAt(s)===t.charAt(s);s+=1)n+=1,(0,m.Yv)(e.charCodeAt(s))&&(r=n);return r})(e,t),n=Math.min(((e,t)=>{const o=e.length,i=t.length;let n=0,r=0;for(let s=0;s<Math.min(o,i)&&e.charAt(o-s-1)===t.charAt(i-s-1);s+=1)n+=1,(0,m.Yv)(e.charCodeAt(o-s-1))&&(r=n);return r})(e,t),Math.min(o,e.length)-i),r=i+n,s=o-r,a=Math.min(130,s),l=Math.min(150-a,r),c=Math.min(l,i),u=Math.min(l,n),{actualLeftContextLength:d,actualRightContextLength:h}=((e,t,o)=>{let i,n;const r=e/2;return t<r&&o<r?(i=t,n=o):t<r?(i=t,n=Math.min(o,e-i)):o<r?(n=o,i=Math.min(t,e-n)):(i=r,n=r),{actualLeftContextLength:i,actualRightContextLength:n}})(l,c,u),g=t.substring(i-d,i),p=t.substring(i,o-n),f=t.substring(o-n,o-n+h);let b=g,y=p,C=f;if(i>d){const e=v(g,0,g.length,!0);b=`...${g.substring(e,g.length)}`}if(p.length>a){const e=v(p,0,a/2,!1),t=v(p,a/2,p.length,!0);y=`${p.substring(0,e)}...${p.substring(t,p.length)}`}if(n>h){const e=v(f,0,f.length,!1);C=`${f.substring(0,e)}...`}return{truncatedPrefix:b,truncatedSubstring:y,truncatedSuffix:C}})(this.critique.textInContext,e.text);return{title:t+o+i,titleDecorations:[{start:e.text.indexOf(o),length:o.length,decorationType:J.vr.Rewrite}]}}return{title:this.getSuggestionTitle(e),titleDecorations:void 0}},this.getSuggestionDescription=e=>{if(!this.isSynonymsEnabled)return;if(!this.isSynonymsAvailable)return;let t=this.validator.validate(e.description);return this.isTopicSuggestionCritique&&(t=t.slice(0,125),e.description&&e.description.length>t.length&&(t+="...")),t||this.localizer.getMessage("ebx_synonymsNotAvailable")},this.getNeutralLanguageCode=e=>{const t=e.indexOf("-");return(t<0?e:e.slice(0,t)).toUpperCase()},this.getLanguageTags=e=>{const t=this.proofingStore.getCachedEntry(a.l.ProofingLanguages).storeEntryValue;if(!t||t.length<2||!e.languages)return"";const o=[];for(const t of e.languages){const e=this.getNeutralLanguageCode(t);o.includes(e)||o.push(e)}return o.join(", ")},this.setNavInfo=e=>{this.navInfo=e},this.navigate=(e=0)=>{const t=(0,j.v)(this.navInfo),o=t.length;if(!this.navInfo||0===o)return this.resetNavigation(),this.clickNoActionHide(),!1;const i=((this.navInfo.currentIndex+e)%o+o)%o,n=t[i];return this.navInfo=Object.assign(Object.assign({},this.navInfo),{currentIndex:i}),this.hide(),"contenteditable"===this.navInfo.ctr?this.navigateCe(n.store,n.critique):this.navigateV2(n.store,n.critique),!0},this.navigateCe=(e,t)=>{const o=this.navInfo;e.showCallout(t,(()=>{this.setNavInfo(o)}))},this.navigateV2=(e,t)=>{const o=e.messageItem.anchor.element,i=this.navInfo;e.showCallout(t,o,o.innerText,!0,(()=>{this.setNavInfo(i)}),q.Ah.critique)},this.resetNavigation=()=>{var e;null===(e=this.navInfo)||void 0===e||e.onCloseNavigation(),this.navInfo=void 0},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e),e===V.xp.ClickNoAction&&this.resetNavigation(),this._indicatorStore&&(0,ee.sw)(this._indicatorStore)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,$.toJS)(this.critique),eventId:e})},(0,N.Gn)(this),(null===(G=this._externalSettingsFeature)||void 0===G?void 0:G.openSettings)&&(this.showOptionsAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(b.kY.dropdown)},this.manageLanguagesAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(b.kY.manageLanguages)})}get roamingDictionaryEnabled(){var e,t;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!(null===(t=this._roamingDictionaryFeature)||void 0===t?void 0:t.isReady())}get cloudIconEnabled(){return this.hostSettings.inferenceCritiqueCloudIconEnabled&&!this.isRewrite}get shouldShowAddToDictionary(){return!!this.critique&&this.roamingDictionaryEnabled&&this.isSpelling&&!(0,M.dt)(this.critique)}get isUpsell(){return this.enableUpsell}get setInitialFocus(){return this._setInitialFocus}get isVisible(){return this._isVisible}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new y.O(document)}get target(){return this._target}get isSynonymsEnabled(){return this._showSynonymsFeature.emitAndEvaluate({eventId:C.OV.GetMoreCommands,sender:C.xr.CritiqueCallout})}get showSynonyms(){return this.showSynonymsState||this.isTopicSuggestionCritique}get brandingMode(){return this.hostSettings.brandingMode}get suggestionsToRender(){return this._suggestionsToRender}get noSuggestionLabel(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.suggestions.length)&&(0,u.gA)(this.critique.suggestions[0].action)?this.critique.suggestions[0].text:""}get calloutTitle(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}return(0,M.dt)(this.critique)?this.localizer.getMessage("ebx_repeatedWordsExplanationTitle"):(0,M.r)(this.critique)?this.localizer.getMessage("ebx_spellingExplanationTitle"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionExplanationTitle"):this.validator.validate(this.critique.explanationTitle)}get text(){var e,t,o;return null!==(o=null===(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)||void 0===t?void 0:t.substring(this.critique.start,this.critique.start+this.critique.length))&&void 0!==o?o:""}get textInContext(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&void 0!==t?t:""}get calloutCategory(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}const e=this.critique.categoryTitle?this._categoryLocalization.toUiLocale(this.critique.categoryTitle):void 0,t=this.isRewrite?this.localizer.getMessage("ebx_toneLabel"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionLabel"):e;return this.validator.validate(t)}get explanation(){var e;return this.hostSettings.critiqueCalloutExplanationFlyout&&this.critique&&null!==(e=this.critique.explanation)&&void 0!==e?e:""}get explanationTitle(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.explanationLabel)&&void 0!==t?t:""}get localizer(){return this.localizerService}get styles(){return this.styleDefinitions.critiqueCallout}get proofingLanguageDir(){return this.scriptDirectionDetector.getProofingLanguageDir()}get isSpelling(){return(0,M.r)(this.critique)}get isTopicSuggestionCritique(){return(0,M.W)(this.critique)}get isAutoCorrection(){return!!(this.hostSettings.enableAutoCorrect&&this.critique&&(0,M.MG)(this.critique)&&this.critique.hasBeenApplied)}get isSpellingDeletion(){return!!this.critique&&(0,M.ht)(this.critique)}get isRewrite(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.typeId)===p.L9.TonalRewrite}get shouldShowTonalFre(){return this.isRewrite&&!!this.hostSettings.tonalFreEnabledForUser&&!!this._tonalFreStore&&!this._tonalFreStore.isTonalFreAccepted}get settings(){const e={RenderFooterIcons:"true"};return this.hostSettings.isFeedbackEnabled&&this.isRewrite&&(e.EnableFeedback="true"),this.hostSettings.ignoreAllEnabled&&(e.EnableIgnoreAll="true"),e}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:4}get critiqueType(){return this.critique&&(0,M.dt)(this.critique)?J.L9.RepeatedWord:(0,M.r)(this.critique)?J.L9.Spelling:(0,M.W)(this.critique)?J.L9.Topic:this.critique&&this.critique.priority===p.bx.Medium?J.L9.Grammar:this.isRewrite?J.L9.TonalRewrite:J.L9.Refinement}get critiqueSource(){if(this.critique&&this.cloudIconEnabled){const e=this.critique.metadata;if(e&&e.length>0)for(const t of e)if("CritiqueSource"===t.name&&"Inference"===t.value)return Z.UD.Inference}return Z.UD.Unknown}get isSynonymsAvailable(){var e;const t=null===(e=this.critique)||void 0===e?void 0:e.suggestions.find((e=>!!e.description&&!e.description.match(/\[(.*)\]/g)));return(this.isSpelling||this.isTopicSuggestionCritique)&&!this.isAutoCorrection&&!!t}get showDisableCritiqueTypeMenuItem(){return!!this.hostSettings.enableStopCheckingForThis&&!!this.critique&&this.critique.priority!==p.bx.High&&!this.isTopicSuggestionCritique}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}async initialize(){}shutDown(){this._target=void 0,this._targetDocumentRef=void 0,this.onDisableCritiqueType=void 0,this.onDismissCallback=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onAfterShownCallback=void 0,this.onShowFeedback=void 0,this.showOptionsAction=void 0,this.manageLanguagesAction=void 0,this.footerAction=void 0}markAsShown(e,t){this.wasMarkedAsShown=!0,this.onShown(e,t)}onShown(e,t){var o;this.shouldShowTonalFre&&(null===(o=this._tonalFreStore)||void 0===o||o.logTonalFreShown());const i=this.logger.getNewActivity(d.n.ActionShowCallout,h.o.SamplingPolicy.CriticalExperimentation);i&&(i.dataFields.push((0,g.n)("CritiqueTypeId",e.typeId)),e.typeId===p.L9.TopicSuggestion&&i.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata))),i.success=!0,i.endNow()),this.onDismiss(),this.onDismissCallback=t}get dropDownActions(){var e;const t=[];return this.isAutoCorrection?t.push(J._R.AutoCorrectOptions):this.isSpelling&&!this.isSpellingDeletion?(this.hostSettings.ignoreAllEnabled&&t.push(J._R.IgnoreAll),this.hostSettings.isMultilingualProofingEnabled&&this.hostSettings.enableManageLanguagesInCritiqueCallout&&t.push(J._R.ManageLanguages)):this.hostSettings.ignoreOnceEnabled&&t.push(J._R.IgnoreOnce),this.isTopicSuggestionCritique&&this.hostSettings.ignoreAllEnabled&&t.push(J._R.IgnoreAll),this.isSynonymsAvailable&&this.isSynonymsEnabled&&!this.isTopicSuggestionCritique&&t.push(J._R.ToggleDescription),this.hostSettings.showOptionsButton&&t.push(J._R.Options),(this._featureFlagsReader.flags.enableOcvFeedbackUi||this.hostSettings.isFeedbackEnabled&&this.isRewrite||this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback)&&t.push(J._R.Feedback),this.showDisableCritiqueTypeMenuItem&&t.push(J._R.IgnoreRule),!this.isAutoCorrection&&this.shouldShowAddToDictionary&&t.push(J._R.AddToDictionary),this.navInfo&&(t.push(J._R.Next),t.push(J._R.Previous)),(null===(e=this._paneOpenState)||void 0===e?void 0:e.isPaneOpen)||this.brandingMode!==J.nH.IconButton&&this.brandingMode!==J.nH.IconAndTextButton||t.push(J._R.OpenEditorPane),t}get addOnFooterData(){if(this.unsignedInEditorFeatureEnabled)return this.footerAction=this.signIn,{actionText:this.localizer.getMessage("ebx_signIntoEditor"),message:`${this.localizer.getMessage("ebx_addGrammarChecking")}${this.localizer.getMessage("ebx_enhancedUpsellCategoriesComma")}`};if(!this.enableUpsell)return;if(!this.hostSettings.areAdditionalPaneEntryPointsEnabled||!this._indicatorStore)return this.premiumPreviewFooter;this.footerAction=()=>{var e,t;null===(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.onOpenEditorPane)||void 0===t||t.call(e,P.k.ContextualCard),this.hide()};const e=(t=this._indicatorStore,Array.from(t.paneCritiques.values()).filter((e=>e)).length);var t;return{actionText:this.localizer.getMessage("ebx_openEditorLabel"),message:e>0?this.localizer.getMessage("ebx_editorAdvancedCritiquesLabel",e.toString()):this.localizer.getMessage("ebx_tryEditorLabel"),icon:"Editor"}}get premiumPreviewFooter(){if(!this.hostSettings.enhancedUpsellEnabled||!this._upsellStore)return this.footerAction=()=>this.goPremium("Regular_CCard"),{actionText:this.localizer.getMessage("ebx_goPremiumLinkText"),message:this.localizer.getMessage("ebx_goPremiumLine"),icon:"PremiumDiamond"};const e=this._upsellStore.previewModeActive,t=this.hostSettings.premiumPreviewEnabled,o=this._upsellStore.previewUnit,i=e?this._upsellStore.previewCount:this._upsellStore.premiumCount,n=t&&!e&&i>0;let r="ebx_premiumPreviewGeneralLine";const s=1===i;e&&o===B.mq.Suggestions?r=s?"ebx_premiumPreviewSuggestionsSingular":"ebx_premiumPreviewSuggestionsPlural":e&&o===B.mq.Days?r=s?"ebx_premiumPreviewDaysSingular":"ebx_premiumPreviewDaysPlural":i>0&&(r=s?"ebx_enhancedUpsellLineSingular":"ebx_enhancedUpsellLinePlural");const a=i.toLocaleString(),l=this.localizer.getMessage(r,a);return this.footerAction=n?()=>{var e;return null===(e=this._upsellStore)||void 0===e?void 0:e.tryPremiumPreview(this.critique)}:()=>this.goPremium("ContextualUpsell_CCard"),{actionText:n?this.localizer.getMessage("ebx_tryPremiumPreviewLink"):this.localizer.getMessage("ebx_goPremiumLinkText"),footerDecorations:i>0||e?[{decorationType:J.vr.PremiumEmphasis,length:a.length,start:l.indexOf(a)}]:void 0,message:l,icon:"PremiumDiamond"}}};(0,r.Cg)([$.observable],ie.prototype,"enableUpsell",void 0),(0,r.Cg)([$.computed],ie.prototype,"isUpsell",null),(0,r.Cg)([$.observable],ie.prototype,"_setInitialFocus",void 0),(0,r.Cg)([$.computed],ie.prototype,"setInitialFocus",null),(0,r.Cg)([$.observable],ie.prototype,"_isVisible",void 0),(0,r.Cg)([$.computed],ie.prototype,"isVisible",null),(0,r.Cg)([$.observable],ie.prototype,"_target",void 0),(0,r.Cg)([$.computed],ie.prototype,"target",null),(0,r.Cg)([$.observable],ie.prototype,"showSynonymsState",void 0),(0,r.Cg)([$.computed],ie.prototype,"showSynonyms",null),(0,r.Cg)([$.computed],ie.prototype,"brandingMode",null),(0,r.Cg)([$.observable],ie.prototype,"_suggestionsToRender",void 0),(0,r.Cg)([$.computed],ie.prototype,"suggestionsToRender",null),(0,r.Cg)([$.computed],ie.prototype,"noSuggestionLabel",null),(0,r.Cg)([$.observable],ie.prototype,"navInfo",void 0),(0,r.Cg)([$.computed],ie.prototype,"calloutTitle",null),(0,r.Cg)([$.computed],ie.prototype,"text",null),(0,r.Cg)([$.computed],ie.prototype,"textInContext",null),(0,r.Cg)([$.computed],ie.prototype,"calloutCategory",null),(0,r.Cg)([$.computed],ie.prototype,"explanation",null),(0,r.Cg)([$.computed],ie.prototype,"explanationTitle",null),(0,r.Cg)([$.computed],ie.prototype,"styles",null),(0,r.Cg)([$.computed],ie.prototype,"shouldShowTonalFre",null),(0,r.Cg)([$.computed],ie.prototype,"settings",null),(0,r.Cg)([$.observable],ie.prototype,"_gapSpace",void 0),(0,r.Cg)([$.computed],ie.prototype,"gapSpace",null),(0,r.Cg)([$.computed],ie.prototype,"critiqueType",null),(0,r.Cg)([$.computed],ie.prototype,"critiqueSource",null),(0,r.Cg)([$.action],ie.prototype,"show",void 0),(0,r.Cg)([$.action],ie.prototype,"setSynonymsState",void 0),(0,r.Cg)([$.action],ie.prototype,"setIsVisible",void 0),(0,r.Cg)([$.action],ie.prototype,"hide",void 0),(0,r.Cg)([$.action],ie.prototype,"onDismiss",void 0),(0,r.Cg)([$.action],ie.prototype,"afterRender",void 0),(0,r.Cg)([$.action],ie.prototype,"onCalloutAction",void 0),(0,r.Cg)([$.action],ie.prototype,"onTonalFreAction",void 0),(0,r.Cg)([$.computed],ie.prototype,"dropDownActions",null),(0,r.Cg)([$.action],ie.prototype,"updateShowSynonyms",void 0),(0,r.Cg)([$.computed],ie.prototype,"addOnFooterData",null),(0,r.Cg)([$.action],ie.prototype,"setNavInfo",void 0),(0,r.Cg)([$.action],ie.prototype,"navigate",void 0),(0,r.Cg)([$.action],ie.prototype,"resetNavigation",void 0),ie=(0,r.Cg)([(0,K._)(),(0,r.Qj)(0,(0,Q.W)(S.K)),(0,r.Qj)(1,(0,Q.W)(w.H)),(0,r.Qj)(2,(0,Q.W)(k.n)),(0,r.Qj)(3,(0,Q.W)(D.s)),(0,r.Qj)(4,(0,Q.W)(T.f)),(0,r.Qj)(5,(0,Q.W)(x.g)),(0,r.Qj)(6,(0,Q.W)(U.$)),(0,r.Qj)(7,(0,Q.W)(C.DS)),(0,r.Qj)(8,(0,Q.W)(c)),(0,r.Qj)(8,(0,Y.l)()),(0,r.Qj)(9,(0,Q.W)(H.$)),(0,r.Qj)(10,(0,Q.W)(I.iw)),(0,r.Qj)(11,(0,Q.W)(_.C)),(0,r.Qj)(11,(0,Y.l)()),(0,r.Qj)(12,(0,Q.W)(B.Ey)),(0,r.Qj)(12,(0,Y.l)()),(0,r.Qj)(13,(0,Q.W)(E.c)),(0,r.Qj)(14,(0,Q.W)(s.tq)),(0,r.Qj)(15,(0,Q.W)(z.JY)),(0,r.Qj)(16,(0,Q.W)(O.M)),(0,r.Qj)(17,(0,Q.W)(F)),(0,r.Qj)(17,(0,Y.l)()),(0,r.Qj)(18,(0,Q.W)(G.C)),(0,r.Qj)(19,(0,Y.l)()),(0,r.Qj)(19,(0,Q.W)(A.F)),(0,r.Qj)(20,(0,Y.l)()),(0,r.Qj)(20,(0,Q.W)(b.In)),(0,r.Qj)(21,(0,Y.l)()),(0,r.Qj)(21,(0,Q.W)(R.Zp)),(0,r.Qj)(22,(0,Y.l)()),(0,r.Qj)(22,(0,Q.W)(te.$)),(0,r.Qj)(23,(0,Y.l)()),(0,r.Qj)(23,(0,Q.W)(W.j))],ie)},98547:(e,t,o)=>{"use strict";var i;o.d(t,{u:()=>i}),function(e){e.calloutMain="calloutMain",e.moreActions="moreActions"}(i||(i={}))},99660:(e,t,o)=>{"use strict";o.d(t,{$:()=>S,v:()=>y});var i=o(73027),n=o(56415),r=o(52595);const s=(0,o(63233).U)("Settings16Regular","16",["M8 6a2 2 0 1 0 0 4 2 2 0 0 0 0-4ZM7 8a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm3.62-3.6a.7.7 0 0 1-.83-.57l-.26-1.42a.35.35 0 0 0-.27-.28 6.07 6.07 0 0 0-2.52 0 .35.35 0 0 0-.27.29L6.2 3.83a.71.71 0 0 1-.94.54l-1.36-.49a.36.36 0 0 0-.38.1c-.57.63-1 1.37-1.26 2.17-.05.14 0 .29.1.38l1.1.93a.7.7 0 0 1 0 1.08l-1.1.93c-.1.1-.15.24-.1.38.26.8.69 1.54 1.26 2.17.1.1.25.14.38.1l1.36-.49a.7.7 0 0 1 .94.54l.26 1.41c.02.15.13.26.27.29a6.07 6.07 0 0 0 2.52 0 .35.35 0 0 0 .27-.29l.26-1.41a.71.71 0 0 1 .94-.54l1.36.49c.13.04.28 0 .38-.1.57-.63 1-1.37 1.26-2.17a.35.35 0 0 0-.1-.38l-1.1-.93a.7.7 0 0 1 0-1.08l1.1-.93c.1-.1.15-.24.1-.38-.26-.8-.69-1.54-1.26-2.17a.36.36 0 0 0-.38-.1l-1.36.49a.71.71 0 0 1-.11.03ZM4 4.98l.94.33a1.71 1.71 0 0 0 2.25-1.3l.18-.97a5.1 5.1 0 0 1 1.26 0l.18.97a1.7 1.7 0 0 0 2.25 1.3l.94-.33c.26.33.47.7.63 1.08l-.75.64a1.7 1.7 0 0 0 0 2.6l.75.64c-.16.39-.37.75-.63 1.08l-.94-.33a1.7 1.7 0 0 0-2.25 1.3l-.18.97a5.1 5.1 0 0 1-1.26 0l-.18-.97a1.7 1.7 0 0 0-2.25-1.3l-.94.33c-.26-.33-.47-.7-.63-1.08l.75-.64a1.7 1.7 0 0 0 0-2.6l-.75-.64c.16-.39.37-.75.63-1.08Z"]);var a=o(73981),l=o(22474),c=o(36284),u=o(34624),d=o(87964),h=o(69261),g=o(17088),p=o(39530),f=o(24855),m=o(96807),v=o(68191),b=o(15561);const y=(0,l.F5)({state:c.A.on(d.x)});let C=class extends n.Component{constructor(){super(...arguments),this.applyUndo=()=>{this.props.deps.state.applyUndo()},this.openSettings=()=>{this.props.deps.state.openSettings()},this.onPositioned=e=>{this.props.deps.state.updateCalloutPosition((null==e?void 0:e.alignmentEdge)===p.x.right,!1)}}render(){const{state:e}=this.props.deps,{isVisible:t,undoAriaLabel:o,undoTitle:i,localizer:l,target:c,styles:u,showEditorBranding:d,gapSpace:p}=e,m=l.getMessage("ebx_settingsButtonTooltip"),b=l.getMessage("ebx_undoCalloutAriaLabel"),y=n.createElement("div",{style:Object.assign({display:"flex",flexDirection:"row",flexWrap:"nowrap"},u.calloutContainer)},n.createElement(a.$,{icon:n.createElement(r.t2R,{style:u.buttonIcon.icon}),appearance:"subtle",className:`${f.g.undoButton}`,"data-automation-id":"undo-callout-undo-button",key:"Undo",role:"button",style:u.buttonIcon,title:i,"aria-label":o,onClick:this.applyUndo}),n.createElement(a.$,{icon:n.createElement(s,{style:u.buttonIcon.icon}),appearance:"subtle",className:f.g.settingsButton,key:"Settings","data-automation-id":"undo-callout-settings-button",role:"button",style:Object.assign({marginLeft:2},u.buttonIcon),title:m,"aria-label":m,onClick:this.openSettings}),d&&n.createElement("span",{role:"none presentation","aria-hidden":!0,style:u.logoButtonBase},l.getMessage("ebx_brandText")));if(this.context){const o={popover:{trapFocus:e.setInitialFocus,withArrow:!1,open:t,ariaLabel:b,ariaRole:"group",positioning:{target:(0,v.ug)(c),align:"center",position:"above",offset:e=>(this.props.deps.state.updateCalloutPosition("end"===e.alignment,!0),{mainAxis:p})}},surface:{style:Object.assign({padding:0,background:"transparent",borderRadius:8},u.calloutV9)}};return n.createElement(g.v,Object.assign({ref:e.undoCardV9Ref},o),y)}return t&&n.createElement(h.U,{ref:e.undoCardRef,isBeakVisible:!1,gapSpace:p,target:(0,v.KV)(c),doNotLayer:!0,role:"group",ariaLabel:b,setInitialFocus:e.setInitialFocus,onRestoreFocus:()=>{},onPositioned:this.onPositioned,styles:u.calloutMain},y)}};C.contextType=m.O1,C=(0,i.Cg)([b.PA],C);const S=(0,u.r)(C,y)},24855:(e,t,o)=>{"use strict";o.d(t,{f:()=>T,g:()=>k});var i=o(73027),n=o(68191),r=o(6601),s=o(39734),a=o(73186),l=o(66131),c=o(83901),u=o(76595),d=o(59696),h=o(70732),g=o(69920),p=o(54201),f=o(85787),m=o(11884),v=o(82751),b=o(11049),y=o(41453),C=o(46916),S=o(63524),w=o(56415);const k={undoButton:"ebx_undoButton",settingsButton:"ebx_settingsButton"};let T=class{constructor(e,t,o,i,s,a,l,c,u,d){var h;let g;this.localizer=e,this.hostSettings=t,this.externalSettingsFeature=o,this.logger=i,this.wordDictionary=s,this._ariaStatusStateStore=a,this._featureFlagsReader=l,this.validator=c,this.instrumentationProcessor=u,this.styleDefinitions=d,this._undoCardRef=w.createRef(),this._undoCardV9Ref=w.createRef(),this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._unsignedInEditorFeatureEnabled=!1,this.getTargetRect=()=>{var e,t;if(this.target)return(0,n.Pe)(this.target)?{left:this.target.x,right:this.target.x,top:this.target.y,bottom:this.target.y,width:0,height:0}:(0,n.K2)(this.target)?{left:this.target.left,right:null!==(e=this.target.right)&&void 0!==e?e:0,top:this.target.top,bottom:null!==(t=this.target.bottom)&&void 0!==t?t:0,width:this.target.width,height:this.target.height}:this.target.getBoundingClientRect()},this.setIsVisible=e=>{this._isVisible=e},this.executeShowOptionsAction=()=>{this.showOptionsAction&&this.showOptionsAction()},this.setShowOptionsAction=e=>{e&&(this.showOptionsAction=e)},this.notifyAriaStatusChange=(e,t)=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(this.localizer.getMessage(e,t),"assertive")},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,v.toJS)(this.critique),eventId:e})},(null===(h=this.externalSettingsFeature)||void 0===h?void 0:h.openSettings)&&(g=()=>{var e;null===(e=this.externalSettingsFeature)||void 0===e||e.openSettings(r.kY.dropdown)}),this.setShowOptionsAction(g),(0,S.Gn)(this)}get undoCardRef(){return this._undoCardRef}get undoCardV9Ref(){return this._undoCardV9Ref}get isVisible(){return this._isVisible}get target(){return this._target}get targetRect(){return this._targetRect||(this._targetRect=this.getTargetRect()),this._targetRect}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:0}get setInitialFocus(){var e;return null!==(e=this._setInitialFocus)&&void 0!==e&&e}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}get mainFocusZoneId(){return"calloutMain--undo"}get undoTitle(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,o=this.localizer.getMessage("ebx_autoCorrectRevertTo",t);return this.validator.validate(o)}get undoAriaLabel(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,o=t.split("").join(" "),i=this.localizer.getMessage("ebx_autoCorrectRevertTo",t),n=this.localizer.getMessage("ebx_undoButtonAriaLabel");return this.validator.validate(`${n}, ${i}, ${o}`)}get showEditorBranding(){return!!this.hostSettings.undoCardShowEditorLogo}get styles(){return this.styleDefinitions.undoCallout}checkShowConditions(e){return!!this.hostSettings.enableAutoCorrect}async prepareShowContent(e){const{onApplySuggestion:t,critique:o,onCalloutPositionUpdated:i}=e;this.critique=o,this.onApplySuggestion=t,this.onCalloutPositionUpdated=i}hide(e){this.isVisible&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isVisible&&(this.resetVariablesAfterHide(),this.onDismiss(e))}resetVariablesAfterHide(){this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._gapSpace=void 0,this.instrumentationEventId=void 0,this.onApplySuggestion=void 0,this.critique=void 0}onDismiss(e){this.onDismissCallback&&(this.onDismissCallback(e),this.onDismissCallback=void 0)}async show(e){if(!this.checkShowConditions(e))return;const{setInitialFocus:t,target:o,onDismiss:i,gapSpace:n}=e;this._target=o,this._gapSpace=n,this._setInitialFocus=t,this.onDismiss(!1),this.onDismissCallback=i,await this.prepareShowContent(e),this.setIsVisible(!0),this.doAfterShow()}doAfterShow(){this.logUndoCalloutOpened()}logUndoCalloutOpened(){const e=this.logger.getNewActivity(s.n.UndoCalloutShown,a.o.SamplingPolicy.CriticalExperimentation);e&&(e.success=!0,e.endNow())}clickNoActionHide(e){this.isVisible&&this.recordInstrumentationEventId(12),this.hide(e)}applyUndo(){if(this.onApplySuggestion&&this.critique&&this.critique.suggestions.length){const e=this.critique.suggestions[0];this.onApplySuggestion(this.critique,e),this.wordDictionary.addWordToIgnoreList(e.text),this.notifyAriaStatusChange("ebx_autoCorrectIgnored",e.text),this.recordInstrumentationEventId(16)}this.hide()}openSettings(){this.executeShowOptionsAction(),this.hide()}updateCalloutPosition(e,t){var o,i,n;if(this.onCalloutPositionUpdated){const r=t?null===(n=null===(i=this._undoCardV9Ref.current)||void 0===i?void 0:i.getElementRef().current)||void 0===n?void 0:n.firstChild:null===(o=this._undoCardRef.current)||void 0===o?void 0:o.firstChild;if(r){const t=r.getBoundingClientRect();this.onCalloutPositionUpdated(e,t)}}}};(0,i.Cg)([v.observable],T.prototype,"_isVisible",void 0),(0,i.Cg)([v.computed],T.prototype,"isVisible",null),(0,i.Cg)([v.observable],T.prototype,"_target",void 0),(0,i.Cg)([v.observable],T.prototype,"_targetRect",void 0),(0,i.Cg)([v.action],T.prototype,"onDismiss",null),(0,i.Cg)([v.action],T.prototype,"setIsVisible",void 0),(0,i.Cg)([v.action],T.prototype,"show",null),(0,i.Cg)([v.action],T.prototype,"clickNoActionHide",null),T=(0,i.Cg)([(0,b._)(),(0,i.Qj)(0,(0,y.W)(l.H)),(0,i.Qj)(1,(0,y.W)(c.n)),(0,i.Qj)(2,(0,C.l)()),(0,i.Qj)(2,(0,y.W)(r.In)),(0,i.Qj)(3,(0,y.W)(u.g)),(0,i.Qj)(4,(0,y.W)(m.s)),(0,i.Qj)(5,(0,y.W)(g.JY)),(0,i.Qj)(6,(0,y.W)(d.c)),(0,i.Qj)(7,(0,y.W)(f.$)),(0,i.Qj)(8,(0,y.W)(h.f)),(0,i.Qj)(9,(0,y.W)(p.$))],T)},61467:(e,t,o)=>{"use strict";o.d(t,{U:()=>p});var i=o(73027),n=o(38279),r=o(89970),s=o(81609),a=o(48883),l=o(80098),c=o(9893),u=o(48336),d=o(11049),h=o(41453),g=o(46916);let p=class{constructor(e,t,o){this._hostEmitter=e,this._proofingDom=t,this._inlineSuggestionsRenderer=o,this._menuItems=new Map,this._rootItemEventListeners=new Map,this.registerMenuItem=e=>!!this._inlineSuggestionsRenderer&&!this._menuItems.get(e.id)&&(this._menuItems.set(e.id,e),!0),this.unregisterMenuItem=e=>this._menuItems.delete(e),this.onHostModelAddedRootNode=e=>{const t=this._proofingDom.findTerminalNode(e.message);if((null==(o=t)?void 0:o.nodeType)===c.Z.TerminalNode&&(0,r.C)(t.element,"HTMLElement")&&t.children){const e=new s.J(t.element);this._rootItemEventListeners.set(t.id,e),e.addListener("contextmenu",(e=>this.onContextMenuOpened(e,t.children[0])))}var o},this.onHostModelRemovedRootNode=e=>{var t;const o=this._proofingDom.findTerminalNode(e.message);o&&this._rootItemEventListeners.has(o.id)&&(null===(t=this._rootItemEventListeners.get(o.id))||void 0===t||t.removeAllListeners(),this._rootItemEventListeners.delete(o.id))},this.onContextMenuOpened=(e,t)=>{var o,i;if(!(null===(o=t.children)||void 0===o?void 0:o.length))return;const r={entities:[],entityType:n.c.Text};for(const e of this._menuItems.values()){if(e.isValid&&!e.isValid())return;r.entities.push(Object.assign({entityType:n.c.Text,text:e.title,confidence:0},e))}r.entities.length>0&&(e.preventDefault(),null===(i=this._inlineSuggestionsRenderer)||void 0===i||i.renderMenuWithItems(t.children[0].id,e,{menuType:"InlineSuggestionsRightClickContextMenuType"},[r],this.onItemSelected))},this.onItemSelected=e=>{const t=e;t.onItemSelected(t)}}async initialize(){this._inlineSuggestionsRenderer&&(this._hostEmitter.on(a.pD.hostModelAddedRootNode,this.onHostModelAddedRootNode),this._hostEmitter.on(a.pD.hostModelRemovedRootNode,this.onHostModelRemovedRootNode))}shutDown(){for(const e of this._rootItemEventListeners.values())e.removeAllListeners();this._rootItemEventListeners.clear()}};p=(0,i.Cg)([(0,d._)(),(0,i.Qj)(0,(0,h.W)(a.M5)),(0,i.Qj)(1,(0,h.W)(u.w)),(0,i.Qj)(2,(0,g.l)()),(0,i.Qj)(2,(0,h.W)(l.V))],p)},42981:(e,t,o)=>{"use strict";o.d(t,{I:()=>i});const i=(0,o(41509).f)("IContextualMenuEventHandler")},89058:(e,t,o)=>{"use strict";o.d(t,{b:()=>x});var i=o(56415),n=o(22474),r=o(36284),s=o(53429),a=o(30444),l=o(26086),c=o(95012),u=o(90096),d=o(4168),h=o(23854),g=o(4119),p=o(8357);const f=e=>{var t,o,n,r,f,m,v;const b=new Map([["EditorWithStars","EditorWithStarsAnimated"],["EditorWithStarsDarkMode","EditorWithStarsDarkModeAnimated"]]),[y,C]=i.useState(0),S=i.useRef(!0);i.useEffect((()=>{S.current&&(S.current=!1)}));const{theme:w,styles:k,animated:T,strings:x}=e,I=(0,g.v)(),_=S.current&&null!=T&&T,E=e.pages[y].icon,A=()=>{y>0&&C(y-1)},R=()=>{y<e.pages.length-1&&C(y+1)};return i.createElement(c.S,{style:Object.assign(Object.assign(Object.assign({},I.containerStyle),{paddingEnd:e.onDismiss?28:I.containerStyle.paddingEnd,borderRadius:null!==(o=null===(t=null==k?void 0:k.container)||void 0===t?void 0:t.borderRadius)&&void 0!==o?o:I.containerStyle.borderRadius,minWidth:null!==(r=null===(n=null==k?void 0:k.container)||void 0===n?void 0:n.minWidth)&&void 0!==r?r:I.containerStyle.minWidth,maxWidth:null!==(m=null===(f=null==k?void 0:k.container)||void 0===f?void 0:f.maxWidth)&&void 0!==m?m:I.containerStyle.maxWidth,backgroundImage:null!==(v=null==w?void 0:w.background)&&void 0!==v?v:"#FFFFFF"}),null==k?void 0:k.container)},i.createElement(c.S,{style:Object.assign(Object.assign({},I.dismissContainerStyle),null==k?void 0:k.dismissContainerStyle)},(()=>{if(e.onDismiss)return i.createElement(s.u,{theme:{background:{resting:"transparent"},title:{resting:"transparent"}},style:I.buttonStyle,onClick:e.onDismiss,automationLabel:""},i.createElement(a.In,{type:"Cancel",primaryColor:null==w?void 0:w.dismissColor,fontSize:12,fontWeight:l.IT.Bold}))})()),i.createElement(c.S,{direction:u.PR.LeftToRight,style:{zIndex:1}},(()=>{var t;if(!e.hideIcon)return i.createElement(c.S,{style:I.iconContainerStyle,justifyContent:u.Pr.SpaceBetween},i.createElement(a.In,{type:_&&null!==(t=b.get(E))&&void 0!==t?t:E,primaryColor:null==w?void 0:w.iconColor}))})(),i.createElement(c.S,{justifyContent:u.Pr.SpaceBetween,style:Object.assign(Object.assign({},I.textContainerStyle),null==k?void 0:k.textContainerStyle)},i.createElement(c.S,{direction:u.PR.LeftToRight,align:u.j5.Center},(()=>{var t,o;const n=e.pages[y].newTag;if(n)return i.createElement(c.S,{style:Object.assign(Object.assign({},I.newTagContainerStyle),{backgroundColor:null!==(t=null==w?void 0:w.newTag.background)&&void 0!==t?t:"#FFFFFF",boxShadow:null==w?void 0:w.newTag.shadow})},i.createElement(d.c,{style:Object.assign(Object.assign({},I.newTagTextStyle),{cssColor:null!==(o=null==w?void 0:w.newTag.textColor)&&void 0!==o?o:"#000000"}),text:n}))})(),(()=>{const t=e.pages[y].title;if(t)return i.createElement(c.S,{style:I.titleContainerStyle},i.createElement(d.c,{style:Object.assign(Object.assign({},I.titleTextStyle),{cssColor:null==w?void 0:w.textColor}),text:t}))})()),e.pages[y].content(I.contentContainerStyle,w))),(()=>{var t,o,n;if(1===e.pages.length)return;let r=null==w?void 0:w.pagination.textColor,l=null==w?void 0:w.pagination.textColor;return 0===y?r=null==w?void 0:w.pagination.arrow.disabledButtonColor:y===e.pages.length-1&&(l=null==w?void 0:w.pagination.arrow.disabledButtonColor),i.createElement(c.S,{style:Object.assign(Object.assign({},I.pageArrowContainerStyle),{zIndex:1}),direction:u.PR.LeftToRight,justifyContent:u.Pr.Center,align:u.j5.Center},i.createElement(s.u,{theme:{background:{resting:null!==(t=null==w?void 0:w.pagination.arrow.background.resting)&&void 0!==t?t:"transparent",hover:null==w?void 0:w.pagination.arrow.background.hover},title:{resting:"transparent"},tooltip:{backgroundColor:null==w?void 0:w.tooltip.background,textColor:null==w?void 0:w.tooltip.textColor}},style:I.buttonStyle,onClick:A,tooltip:x.footer("previousPageTooltip"),automationLabel:"",tooltipProps:{layerHostId:e.layerHostId}},i.createElement(a.In,{type:"Previous",primaryColor:r})),i.createElement(d.c,{style:Object.assign(Object.assign({},I.paginationTextStyle),{cssColor:null!==(o=null==w?void 0:w.pagination.textColor)&&void 0!==o?o:"black"}),text:(0,p.JT)(x.footer("paginationTipsText"),y+1,e.pages.length)}),i.createElement(s.u,{theme:{background:{resting:null!==(n=null==w?void 0:w.pagination.arrow.background.resting)&&void 0!==n?n:"transparent",hover:null==w?void 0:w.pagination.arrow.background.hover},title:{resting:"transparent"},tooltip:{backgroundColor:null==w?void 0:w.tooltip.background,textColor:null==w?void 0:w.tooltip.textColor}},style:I.buttonStyle,onClick:R,tooltip:x.footer("nextPageTooltip"),automationLabel:"",tooltipProps:{layerHostId:e.layerHostId}},i.createElement(a.In,{type:"Next",primaryColor:l})))})(),(()=>{if(_)return i.createElement(h.w,{theme:null==w?void 0:w.shimmer})})())};var m=o(55180),v=o(64944),b=o(96807),y=o(8207),C=o(97217),S=o(20176);const w=e=>{switch(e){case m.Y.critique:return"footer_fre_in_critique_callout";case m.Y.inlineSuggestions:return"footer_fre_in_inline_suggestion_callout";default:return"footer_fre_generic"}},k=()=>{const e=(0,C.$)().getStringsFor("OnCanvasCalloutStrings"),t={nextPageTooltip:e("footerFRE_nextPageTooltip"),paginationTipsText:e("footerFRE_paginationTipsText"),previousPageTooltip:e("footerFRE_previousPageTooltip")};return{footer:e=>t[e]||""}},T=(0,n.F5)({themeStore:r.A.on(b.YQ).optional(),footerFreStore:r.A.on(m.D).optional(),languageScriptDirectionDetector:r.A.on(v.iw).optional()}),x=(0,S.PA)((e=>{const{target:t,styles:o}=e,{footerFreStore:r,languageScriptDirectionDetector:s,themeStore:a}=(0,n.SM)(T),l=null==r?void 0:r.footerProps.get(t);if(!(null==l?void 0:l.display)||!l.pages.size)return i.createElement(i.Fragment,null);const c=null==a?void 0:a.getComponentThemes(b.yF.footerFreComponentName),u=a?null==c?void 0:c.get(a.currentTheme):void 0,d=i.createElement(f,{automationId:w(t),pages:Array.from(l.pages.values()),animated:l.animated,styles:o,strings:k(),theme:u,onDismiss:()=>null==r?void 0:r.setFooterDisplay(t,!1),hideIcon:e.hideIcon});return s?i.createElement(y.K,{rtl:s.isRtl()},d):d}))},64017:(e,t,o)=>{"use strict";o.d(t,{o:()=>a});var i=o(73027),n=o(82751),r=o(11049),s=o(63524);let a=class{constructor(){this.footerProps=new Map,(0,s.Gn)(this)}setFooterDisplay(e,t){const o=this.footerProps.get(e);o&&this.footerProps.set(e,Object.assign(Object.assign({},o),{display:t}))}setFooterAnimated(e,t){const o=this.footerProps.get(e);o&&this.footerProps.set(e,Object.assign(Object.assign({},o),{animated:t}))}addFooterPage(e,t,o){var i;const n=null!==(i=this.footerProps.get(e))&&void 0!==i?i:{display:!0,pages:new Map,animated:!0};n.pages.set(t,o),n.display=!0,this.footerProps.set(e,n)}removeFooterPage(e,t){const o=this.footerProps.get(e);o&&(o.pages.delete(t),0===o.pages.size&&(o.display=!1),this.footerProps.set(e,o))}};(0,i.Cg)([n.observable],a.prototype,"footerProps",void 0),(0,i.Cg)([n.action],a.prototype,"setFooterDisplay",null),(0,i.Cg)([n.action],a.prototype,"setFooterAnimated",null),(0,i.Cg)([n.action],a.prototype,"addFooterPage",null),(0,i.Cg)([n.action],a.prototype,"removeFooterPage",null),a=(0,i.Cg)([(0,r._)()],a)},72287:(e,t,o)=>{"use strict";o.d(t,{a:()=>h});var i=o(73981),n=o(22474),r=o(36284),s=o(40555),a=o(55180),l=o(66131),c=o(20176),u=o(56415);const d=(0,n.F5)({localizer:r.A.on(l.H),footerFreStore:r.A.on(a.D)}),h=(0,c.PA)((e=>{var t;const{theme:o,style:r,languageName:l,undoCallback:c,manageLanguagesCallback:h}=e,{localizer:g,footerFreStore:p}=(0,n.KN)(d),f=()=>{p.removeFooterPage(a.Y.languageAutoDetection,s.Id)};return u.createElement("div",{style:Object.assign({color:null!==(t=null==o?void 0:o.textColor)&&void 0!==t?t:"#323130",minWidth:250},r)},u.createElement("div",{style:{marginBottom:12,paddingRight:14}},g.getMessage("autoDetectionFRE_HeadingText",l)),u.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},u.createElement(i.$,{appearance:"transparent",style:{fontSize:12,padding:2,minWidth:"fit-content",height:"revert",minHeight:24},onClick:()=>{c(),f()}},g.getMessage("autoDetectionFRE_UndoButtonText",l)),u.createElement(i.$,{style:{borderRadius:4,marginLeft:8,fontSize:12,height:"fit-content",minHeight:24,textAlign:"left",paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2},onClick:()=>{h(),f()}},g.getMessage("autoDetectionFRE_ManageLanguagesText",l))))}))},40555:(e,t,o)=>{"use strict";o.d(t,{Id:()=>v,lP:()=>b,sy:()=>y});var i=o(22474),n=o(36284),r=o(90730),s=o(55180),a=o(69261),l=o(17088),c=o(81609),u=o(68191),d=o(89058),h=o(96807),g=o(20176),p=o(4728),f=o(56415);const m=(0,i.F5)({footerFreStore:n.A.on(s.D)}),v="LanguageAutoDetection",b="lang-auto-detect-footer",y=(0,g.PA)((()=>{const{footerFreStore:e}=(0,i.KN)(m),t=e.footerProps.get(s.Y.languageAutoDetection);return(null==t?void 0:t.display)&&1===t.pages.size?f.createElement(C,null):null})),C=(0,g.PA)((()=>{var e,t;const o=f.useContext(h.O1),i=null!==(e=(0,p.ZY)())&&void 0!==e?e:document,n=null!==(t=i.defaultView)&&void 0!==t?t:window,[g,m]=f.useState(S(i)),[v,y]=f.useState(!0),C=f.useCallback((()=>{m(S(i))}),[i,m]);if(f.useEffect((()=>{const e=new c.J(n);return e.addListener("resize",C,{passive:!0,capture:!0}),()=>{e.removeAllListeners()}}),[C,n]),o){const e={popover:{id:b,withArrow:!1,open:v,onOpenChange:(e,t)=>{y(t.open)},positioning:{target:(0,u.ug)(g),align:"center",position:"above",offset:e=>({mainAxis:8})}},surface:{style:{padding:0,background:"transparent",borderRadius:8}}};return f.createElement(l.v,Object.assign({},e),f.createElement(d.b,{target:s.Y.languageAutoDetection}))}return f.createElement(a.U,{id:b,target:g,directionalHint:r.A.topCenter,isBeakVisible:!1,gapSpace:8,style:{borderRadius:8},styles:{root:{borderRadius:8},calloutMain:{background:"transparent"}}},f.createElement(d.b,{target:s.Y.languageAutoDetection}))}));function S(e){return{x:e.body.clientWidth-240,y:e.body.clientHeight-13}}},14895:(e,t,o)=>{"use strict";o.d(t,{Nt:()=>l,cu:()=>c});var i=o(85317),n=o(13593),r=o(16392),s=o(56415),a=o(25526);function l(e,t,o){return new d(e,t,o)}function c(e,t){const o=new u(e);return{element:s.createElement(h,{eccUxReplacement:o,commonOptions:t}),eccUxReplacement:o}}class u{constructor(e){this.iframeElement=e,this.eccStateChanged=e=>{var t;null===(t=this.listener)||void 0===t||t.call(this,e)},this.setListener=e=>{this.listener=e}}dispose(){this.listener&&(this.listener(void 0),this.listener=void 0)}}class d extends u{constructor(e,t,o){super(t),this.editorCard=document.createElement("external-editor-card"),this.editorCard.setAttribute("style","position:absolute;top:0px;left:0px;z-index:auto;display: block !important"),e.appendChild(this.editorCard),a.render(s.createElement(h,{eccUxReplacement:this,commonOptions:o}),this.editorCard)}dispose(){this.editorCard&&(a.unmountComponentAtNode(this.editorCard),this.editorCard.remove(),this.editorCard=void 0),super.dispose()}}const h=e=>{var t;const{iframeElement:o,setListener:a}=e.eccUxReplacement,[l,c]=s.useState(),u=s.useCallback((e=>{c(e)}),[c]);if(s.useEffect((()=>(a(u),()=>{a(void 0)})),[u,a]),!l)return null;const d=function(e,t){var o,i;if(!e||!t||"string"==typeof t)return t;let n=e.getBoundingClientRect();const r=getComputedStyle(e),s=parseFloat(r.borderWidth.replace("px",""));return n=new DOMRect(n.left+s,n.top+s,n.width-s-s,n.height-s-s),"left"in t&&"top"in t&&t.left&&t.top?"width"in t&&"height"in t?{left:t.left+n.left,right:t.left+n.left+t.width,top:t.top+n.top,bottom:t.top+n.top+t.height,width:t.width,height:t.height}:{x:(null!==(o=t.left)&&void 0!==o?o:0)+n.left,y:(null!==(i=t.top)&&void 0!==i?i:0)+n.top}:"x"in t&&"y"in t&&void 0!==t.x&&void 0!==t.y?{x:t.x+n.left,y:t.y+n.top}:t}(o,l.targetLocation);return d?s.createElement(n.O.Provider,{value:!!(null===(t=e.commonOptions)||void 0===t?void 0:t.useFluentV9)},s.createElement("div",{dir:l.calloutProps.isRtl?"rtl":"ltr",style:{all:"initial"}},s.createElement(i.$,Object.assign({},l,{targetWindow:new r.O(window),targetLocation:d})))):null}},38643:(e,t,o)=>{"use strict";o.d(t,{V:()=>ge});var i=o(56415),n=o(38279),r=o(81609),s=o(10894),a=o(18028),l=o(98138),c=o(73463),u=o(95012),d=o(90096),h=o(17451),g=o(7122),p=o(68664),f=o(53429),m=o(94458),v=o(43333),b=o(89416),y=o(69380),C=o(69868),S=o(43906),w=o(64548),k=o(37996),T=o(82448),x=o(58021),I=o(2121);const _="overflow-expanded-ecc",E="uploadFileButton",A="eccFeedbackButton",R="eccSearchBar",B=({definition:e,theme:t,style:o,styles:n,strings:r,layerHostId:B,queryString:M,results:D,scopes:O,isError:F,isLoading:P,enablePrefixHighlighting:N,keyboardHandlerTarget:L,expandedKeyboardHandlerTarget:j,showMoreEntitiesConfig:q,browseThisComputerConfig:H,listID:z,disableTooltips:W,isFeedbackEnabledForEcc:G,isSmallWindow:U,isSmallHeight:V,enableResponsiveLayout:$,refocus:K,onGroupSelected:Q,onAction:Y,onItemSelected:J,onItemFocused:Z,onAfterUpdate:X,noSuggestionsHeaderInfo:ee,expandedEccSearchBarConfig:te,showMeetingBanner:oe,enableMeetingBanner:ie,meetingBannerText:ne,isFeedbackButtonEnabled:re,onFeedbackButtonClicked:se,isUnsupported:ae,locale:le,useFURNTabList:ce})=>{var ue,de,he,ge,pe;const fe=!!G&&!re,me=i.useContext(l.O),[ve,be]=i.useState(!1),ye=()=>{be(!ve)},Ce=D.every((e=>!e.suggestions||0===e.suggestions.length)),[Se,we]=i.useState([]),ke=i.useCallback((e=>{e.type===S.E9?e.id===S.Es?null==Y||Y(C.L.Retry):e.id===S.WM&&(Ze(""),null==Y||Y(C.L.ClearSearch)):J(e)}),[Y,J]),Te=null!=t?t:x.nk(void 0,me),xe=null!=o?o:a.Ss,Ie=(0,y.W)(n,xe,U&&$),_e=i.useRef(null),Ee=i.useRef(null),Ae=i.useRef(null),Re=i.useRef(null),Be=i.useRef(null),Me=i.useRef({groupLayouts:[]}),[De,Oe]=i.useState({value:0}),[Fe,Pe]=i.useState({value:-1}),[Ne,Le]=i.useState(!1),[je,qe]=i.useState(!1),[He,ze]=i.useState(!1),[We,Ge]=i.useState(!1),[Ue,Ve]=i.useState(!1),[$e,Ke]=i.useState(),[Qe,Ye]=i.useState(!1),[Je,Ze]=i.useState(""),[Xe,et]=i.useState(!1),[tt,ot]=i.useState(!1),[it,nt]=i.useState(!1),[rt,st]=i.useState(O.suggestions.length),[at,lt]=i.useState(!1),ct=i.useRef(!0),[ut,dt]=i.useState(!1),[ht,gt]=i.useState(!1),pt=i.useRef(null),ft=Se.reduce(((e,t)=>t.suggestions.length+e),0),mt=i.useCallback((e=>{J(e),Le(!1)}),[J,Le]);i.useEffect((()=>{if(-1===De.value)return void(Ee.current=null);let e=0;for(const t of Se)e++,De.value>=e&&De.value<e+t.suggestions.length&&(Ee.current=t.suggestions[De.value-e]),e+=t.suggestions.length}),[De,Se]),i.useEffect((()=>{!P&&we((0,S.Oz)(P,F,Ce,r,D,ee,ae))}),[P,F,Ce,r,D,ee,ae]),i.useEffect((()=>{P||Qe&&(null==H?void 0:H.isBrowseThisComputerEnabled)||(St(De.value,0),Oe({value:0}),Ct(Fe.value,-1),Pe({value:-1}))}),[P,Qe,K,Se,H]),i.useEffect((()=>{je&&Ke({top:0,bottom:0,isNewRender:!1})}),[je]),i.useEffect((()=>{He&&Ke({top:0,bottom:0,isNewRender:!1})}),[He]),i.useEffect((()=>{_e.current&&(clearTimeout(_e.current),_e.current=null),P?Se&&Se.length?_e.current=setTimeout((()=>Ve(!0)),S.al):Ve(!0):Ve(!1)}),[P,Se]),i.useEffect((()=>{X&&e&&X(e)}));const vt=i.useCallback(((e,t)=>{t.type===S.E9?t.id===S.Es?null==Z||Z({focusedItemHtmlId:S.E9,item:{type:"retryButton"}}):t.id===S.WM&&(null==Z||Z({focusedItemHtmlId:S.E9,item:{type:"clearSearchButton"}})):null==Z||Z({focusedItemHtmlId:(0,S.Bn)(e),item:t})}),[Z]),bt=(e,t)=>{var o,i,n,r,s;let a=0;const l={top:0,bottom:0};for(let c=0;c<Se.length;c++){const u=Se[c];l.top=l.bottom+(null===(o=Me.current.groupLayouts[c])||void 0===o?void 0:o.separatorHeight),l.bottom=l.top+(null===(i=Me.current.groupLayouts[c])||void 0===i?void 0:i.headerHeight);for(let o=0;o<u.suggestions.length;o++){const i=u.suggestions[o];if(0!==o&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(r=null===(n=Me.current.groupLayouts[c])||void 0===n?void 0:n.itemHeights[o])&&void 0!==r?r:0),o===u.suggestions.length-1&&(l.bottom+=null===(s=Me.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return i.isHighlighted=t,t&&(Ke(Object.assign(Object.assign({},l),{isNewRender:ct.current})),ct.current=!1,vt(e,i)),void we((e=>(c<e.length&&(e[c].isHighlighted=t),e)));a++}}},yt=(e,t)=>{e>=0&&e<O.suggestions.length&&(O.suggestions[e].isHighlighted=t)},Ct=(e,t)=>(e>=0&&yt(e,!1),t<0?-1:(t%=O.suggestions.length,yt(t,!0),null==Z||Z({focusedItemHtmlId:(0,S.Bn)(t,!0),item:O.suggestions[t]}),t)),St=(e,t)=>(e>=0&&bt(e,!1),t<0?-1:(bt(t%=ft,!0),t)),wt=()=>{var e;Ye(!0),et(!1),null===(e=null==q?void 0:q.onClickShowMoreEntities)||void 0===e||e.call(q,!0),Oe({value:-1})},kt=e=>{switch(e){case c.h.ArrowDown:Xe?(et(!1),Oe({value:St(-1,0)})):(bt(De.value,!1),et(!0),Ke({top:1e4,bottom:1e4,isNewRender:!1}));break;case c.h.ArrowUp:Xe?(et(!1),Oe({value:St(-1,ft-1)})):(bt(De.value,!1),et(!0),Ke({top:1e4,bottom:1e4,isNewRender:!1}));break;case c.h.Enter:case c.h.Tab:wt()}},Tt=e=>{var t;switch(e){case c.h.ArrowDown:return ot(!0),qe(!1),Oe({value:St(Fe.value,0)}),!0;case c.h.ArrowUp:return ot(!0),qe(!1),Oe({value:St(Fe.value,ft-1)}),!0;case c.h.Tab:return xt(),!0;case c.h.Enter:return be(!ve),null===(t=null==H?void 0:H.onClickBrowseThisComputer)||void 0===t||t.call(H),!0}return!1},xt=()=>{var e;ot(!0),Ne||ut?(Le(!1),Pe({value:Ct(Fe.value,-1)}),dt(!1),re?(Ge(!0),null==Z||Z({focusedItemHtmlId:A})):(null==H?void 0:H.isUploadFileButtonEnabled)?(qe(!0),null==Z||Z({focusedItemHtmlId:E})):(null==te?void 0:te.enableExpandedECCSearchBar)?(ze(!0),null==Z||Z({focusedItemHtmlId:R})):Oe({value:St(Fe.value,0)})):We?(Ge(!1),(null==H?void 0:H.isUploadFileButtonEnabled)?(qe(!0),null==Z||Z({focusedItemHtmlId:E})):(null==te?void 0:te.enableExpandedECCSearchBar)?(ze(!0),null==Z||Z({focusedItemHtmlId:R})):Oe({value:St(Fe.value,0)})):je?(qe(!1),(null==te?void 0:te.enableExpandedECCSearchBar)?(ze(!0),null==Z||Z({focusedItemHtmlId:R})):(null===(e=Be.current)||void 0===e||e.focus(),Oe({value:St(Fe.value,0)}))):He?(ze(!1),Oe({value:St(Fe.value,0)})):(Le(!0),Oe({value:St(De.value,-1)}),Pe({value:Ct(Fe.value,0)}))},It=e=>_t(e,!1),_t=(e,t)=>{var o,i,n,r;if(e!==c.h.ArrowDown&&e!==c.h.ArrowUp&&e!==c.h.ArrowLeft&&e!==c.h.ArrowRight&&e!==c.h.Enter&&e!==c.h.Tab&&e!==c.h.Home&&e!==c.h.End)return!1;if(t&&e!==c.h.ArrowDown&&e!==c.h.ArrowUp)return!1;if(Ne)return(e=>{switch(e){case c.h.ArrowLeft:{ot(!0);let e=Fe.value-1;return e<0&&(it?(dt(!0),Le(!1),null==Z||Z({focusedItemHtmlId:_}),e=-1):e=rt-1),Pe({value:Ct(Fe.value,e)}),!0}case c.h.ArrowRight:{ot(!0);let e=Fe.value+1;return e>=rt&&(it?(dt(!0),Le(!1),null==Z||Z({focusedItemHtmlId:_}),e=-1):e=0),Pe({value:Ct(Fe.value,e)}),!0}case c.h.ArrowDown:return ot(!0),Le(!1),Pe({value:Ct(Fe.value,-1)}),Oe({value:St(Fe.value,0)}),!0;case c.h.ArrowUp:return ot(!0),Le(!1),Pe({value:Ct(Fe.value,-1)}),Oe({value:St(Fe.value,ft-1)}),!0;case c.h.Tab:return xt(),!0;case c.h.Enter:return Fe.value>=0&&Fe.value<O.suggestions.length&&(Le(!1),J(O.suggestions[Fe.value])),!0}return!1})(e);if(ut)return(e=>{switch(e){case c.h.ArrowLeft:return ot(!0),Le(!0),dt(!1),Pe({value:Ct(Fe.value,rt-1)}),!0;case c.h.ArrowRight:return ot(!0),Le(!0),dt(!1),Pe({value:Ct(Fe.value,0)}),!0;case c.h.ArrowDown:return ot(!0),dt(!1),Oe({value:St(Fe.value,0)}),null==Z||Z({focusedItemHtmlId:_+Fe.value}),!0;case c.h.ArrowUp:return ot(!0),dt(!1),Oe({value:St(Fe.value,ft-1)}),null==Z||Z({focusedItemHtmlId:_+Fe.value}),!0;case c.h.Tab:return xt(),!0;case c.h.Enter:return gt(!0),null==Z||Z({focusedItemHtmlId:_+0}),!0}return!1})(e);if(je)return Tt(e);if(He)return e===c.h.Tab&&(xt(),!0);if(We)return(e=>{switch(e){case c.h.ArrowDown:return ot(!0),Ge(!1),Oe({value:St(Fe.value,0)}),!0;case c.h.ArrowUp:return ot(!0),Ge(!1),Oe({value:St(Fe.value,ft-1)}),!0;case c.h.Tab:return xt(),!0;case c.h.Enter:return null==se||se(),!0}return!1})(e);switch(e){case c.h.ArrowDown:if(ot(!0),t){Ne&&(null===(o=pt.current)||void 0===o||o.focus(1)),!Ne&&(null===(i=Re.current)||void 0===i||i.focus(Fe.value)),lt(!0),Oe({value:St(De.value,-1)}),Le(!0);const e=O.suggestions.findIndex((e=>e.isSelected));Pe({value:Ct(Fe.value,e)})}else if(De.value===ft-1||Xe)if((null==q?void 0:q.isShowMoreEntitiesEnabled)&&!Qe)kt(e);else{if(!(null==H?void 0:H.isBrowseThisComputerEnabled))return!0;Tt(e)}else{const e=St(De.value,De.value+1);Oe({value:e})}break;case c.h.ArrowUp:if(t)if(Ne&&(null===(n=pt.current)||void 0===n||n.focus(1)),!Ne&&(null===(r=Re.current)||void 0===r||r.focus(Fe.value)),lt(!0),Oe({value:St(De.value,-1)}),null==H?void 0:H.isUploadFileButtonEnabled)qe(!0);else{Le(!0);const e=O.suggestions.findIndex((e=>e.isSelected));Pe({value:Ct(Fe.value,e)})}else{if(ot(!0),0===De.value&&Qe)return!0;if(0===De.value||Xe){if(!(Xe||0===De.value&&(null==q?void 0:q.isShowMoreEntitiesEnabled)&&!Qe))return!0;kt(e)}else Oe({value:St(De.value,0===De.value?(ft||1)-1:De.value-1)})}break;case c.h.Home:ot(!0),Oe({value:St(De.value,0)});break;case c.h.End:ot(!0),Oe({value:St(De.value,ft-1)});break;case c.h.Enter:if(Xe){kt(e);break}if(P&&Ee.current)ke(Ee.current);else{let e=0;Se.forEach((t=>{De.value>=e&&De.value<e+t.suggestions.length&&ke(t.suggestions[De.value-e]),e+=t.suggestions.length}))}break;case c.h.Tab:if(!at)return!1;xt();break;case c.h.ArrowLeft:case c.h.ArrowRight:default:return!1}return!0},Et=e=>{(at||!L&&!j)&&_t(e.key,e.alt)},At=i.useCallback((e=>{e(Me.current)}),[]);i.useEffect((()=>void 0!==j?(j.setKeyPressHandler(_t),()=>{j.setKeyPressHandler(void 0)}):(null==L||L.setKeyPressHandler(It),()=>{null==L||L.setKeyPressHandler(void 0)})));const Rt=Ie.containerStyles||{},{paddingStart:Bt,paddingEnd:Mt,paddingHorizontal:Dt,paddingTop:Ot,paddingBottom:Ft,paddingVertical:Pt,paddingScrollTop:Nt,scrollbarThumbWidth:Lt}=Rt,jt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(Rt,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth"]),qt=(null==q?void 0:q.isShowMoreEntitiesEnabled)&&!Qe&&!(F||Ce||ae),Ht=V?"30%":250,zt=O.suggestions.findIndex((e=>e.isSelected)),[Wt,Gt]=i.useState(null===(ue=O.suggestions[zt])||void 0===ue?void 0:ue.id);i.useEffect((()=>{var e;Gt(null===(e=O.suggestions[zt])||void 0===e?void 0:e.id)}),[zt]);const Ut=O.suggestions.map((e=>{var t;return{label:null!==(t=e.title)&&void 0!==t?t:"",tabKey:e.id,overflowPriority:e.id===Wt?1:0}})),Vt=i.useCallback((e=>{for(let t=0;t<O.suggestions.length;t++)if(O.suggestions[t].id===e){mt(O.suggestions[t]);break}Gt(e)}),[O,mt,Gt]);return i.createElement(u.S,{style:Object.assign(Object.assign(Object.assign({},s.uI(Te,void 0,{useFluentV9:me})),jt),{hideFocusBox:!0}),align:d.j5.Stretch,focusable:!0,ref:Be,onKeyDown:Et,handledKeys:[c.h.ArrowDown,c.h.ArrowUp,c.h.ArrowLeft,c.h.ArrowRight,c.h.Enter,c.h.Tab,c.h.Home,c.h.End],accessibilityRole:Ue||F||Ce||ae?void 0:"application",accessible:!0,accessibilityLabel:r.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:z},i.createElement(h.R,null,i.createElement(u.S,{style:{height:44,minHeight:44,marginVertical:2,marginEnd:12},ref:Ae,direction:d.PR.LeftToRight,align:d.j5.Center},ce?i.createElement(u.S,{accessibilityRole:"tablist",direction:d.PR.LeftToRight,align:d.j5.Center,accessible:!0,ref:Re,style:{flexibleSize:!0}},i.createElement(g.w,{overflow:!0,selectedKey:Wt,onTabSelect:Vt,theme:x.T_(Te),items:Ut})):i.createElement(u.S,{accessibilityRole:"tablist",direction:d.PR.LeftToRight,align:d.j5.Center,accessible:!0,ref:Re},i.createElement(b.U,{theme:Te,headerRef:Ae,headerScopesRef:Re,styles:(0,y.o)(n,xe),overflowUid:_,strings:r,scopes:O,groupLayouts:Me.current.groupLayouts,itemQueryString:M,onGroupSelected:Q,onItemSelected:mt,onOverflowCalculated:(e,t)=>{nt(e||fe),st(e?t:O.suggestions.length)},isOverflowHighlighted:ut,isOverflowMenuOpened:ht,onOverflowClose:e=>{var t;e||(null===(t=pt.current)||void 0===t||t.focus(),dt(!1),Pe({value:Ct(Fe.value,-1)}),Le(!1)),gt(!1)},enablePrefixHighlighting:N,hasSelectionBeenModifiedViaKeyboard:tt,layerHostId:B,isFeedbackEnabledForEcc:fe,isSmallWindow:U,enableResponsiveLayout:$})),(null==H?void 0:H.isUploadFileButtonEnabled)||re?i.createElement(p.q.Consumer,null,(e=>i.createElement(u.S,{nativeID:"uploadFileButtonContainer",style:ce?{}:e?{position:"absolute",left:12}:{position:"absolute",right:12}},i.createElement(u.S,{accessible:!0,direction:d.PR.LeftToRight,align:d.j5.Center},re?i.createElement(f.u,{htmlId:A,style:a.gl,accessibilityRole:"option",automationLabel:"InlineSuggestionsFeedback",icon:{type:"ECCFeedback",style:a.p},title:void 0,onClick:se,theme:x.$d(Te,We),isSelectedByKeyboard:tt}):null,(null==H?void 0:H.isUploadFileButtonEnabled)?i.createElement(T.Y,Object.assign({handledKeys:[c.h.Enter,c.h.Tab,c.h.Home,c.h.End],onKeyDown:Et,strings:r,isUploadButtonHighlighted:je,hasSelectionBeenModifiedViaKeyboard:tt,theme:x.wK(Te,je),iconOnly:U&&$,open:ve,onOpenChange:ye},H)):null)))):null),i.createElement(m.w,null),Qe&&i.createElement(u.S,{direction:d.PR.LeftToRight},i.createElement(u.S,{style:{flexibleSize:!1}},i.createElement(f.u,{style:a.Ek,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;Ye(!1),null===(e=null==q?void 0:q.onCloseShowMoreEntities)||void 0===e||e.call(q,!1),Oe({value:0})},theme:x.VD(Te),icon:{type:"ChevronLeftMed",style:a.dt}}),i.createElement(k.y,{theme:Te,style:null==n?void 0:n.searchBoxStyles,htmlId:null==q?void 0:q.searchBoxHtmlId,autoFocus:!0,handledKeys:[c.h.ArrowDown,c.h.ArrowUp,c.h.Enter,c.h.Tab,c.h.Home,c.h.End],onKeyDown:Et,placeholder:(null==q?void 0:q.searchBoxPlaceHolder)||"",value:Je,onValueChange:e=>{var t;Ze(e),null===(t=null==q?void 0:q.onSearchChange)||void 0===t||t.call(q,e)},onClear:()=>{var e;Ze(""),null===(e=null==q?void 0:q.onSearchClear)||void 0===e||e.call(q)}}))),(null==te?void 0:te.enableExpandedECCSearchBar)&&i.createElement(u.S,{direction:d.PR.LeftToRight},i.createElement(I.V,{placeholder:(null==r?void 0:r.inlineSuggestions("expandedInlineSuggestionsSearchBarPlaceholder"))||"",onValueChange:e=>{var t;Ze(e),null===(t=null==te?void 0:te.onSearchChange)||void 0===t||t.call(te,e)},onClear:()=>{var e;Ze(""),null===(e=null==te?void 0:te.onSearchClear)||void 0===e||e.call(te)},dismiss:null,accessibilityLabel:(null==r?void 0:r.inlineSuggestions("expandedInlineSuggestionsSearchBarPlaceholder"))||"",theme:Te,style:xe,htmlId:null==te?void 0:te.searchBoxHtmlId,autoFocus:null==te?void 0:te.autoFocus,handledKeys:[c.h.ArrowDown,c.h.ArrowUp,c.h.Enter,c.h.Tab,c.h.Home,c.h.End],onKeyDown:Et,value:Je,showIcon:!0,isSearchBoxHighlighted:He,hideDismiss:te.hideDismiss})),i.createElement(u.S,{nativeID:"inlineSuggestionsEnclosingDiv","aria-label":(0===zt?`${r.inlineSuggestions("startTypingToSearch")} `:"").concat((null!==(de=r.inlineSuggestions("tabAriaLabel"))&&void 0!==de?de:"{0} tab, press alt + down to change tabs").replace("{0}",null!==(ge=null===(he=O.suggestions[zt])||void 0===he?void 0:he.title)&&void 0!==ge?ge:"")),accessibilityRole:"listbox",style:{position:"relative",maxHeight:Ht}},i.createElement(v.B,{scrollDirection:"vertical",style:{paddingStart:Bt,paddingEnd:Mt,paddingHorizontal:Dt,paddingTop:Ot,paddingBottom:Ft,paddingVertical:Pt,paddingScrollTop:Nt,scrollbarThumbWidth:Lt,borderRadius:jt.borderRadius,width:"100%"},theme:{thumbColor:null===(pe=null==Te?void 0:Te.scroll)||void 0===pe?void 0:pe.thumbColor},scrollTo:$e,alwaysShowScrollbar:!0,hidden:Ue},i.createElement(w.p,{theme:Te,suggestionsRef:pt,styles:Ie,strings:r,locale:le,results:Se,isShimmerVisible:Ue,enableScopedHeader:!1,itemsCount:ft,updateMenuLayout:At,itemQueryString:M,onGroupSelected:Q,onItemSelected:ke,enablePrefixHighlighting:N,isGroupHeaderVisible:!1,hasSelectionBeenModifiedViaKeyboard:tt,layerHostId:B,disableTooltips:W,showMeetingBanner:oe,enableMeetingBanner:ie,meetingBannerText:ne,isSmallWindow:U}))),qt&&i.createElement(f.u,{automationLabel:"InlineSuggestionMoreEntitiesButton",title:q.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:x.zN(Te,Xe),onClick:wt})))};var M=o(15624),D=o(45438),O=o(26534),F=o(53899),P=o(86738),N=o(65755),L=o(19254),j=o(73050),q=o(47149),H=o(70847),z=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const W=({definition:e,theme:t,style:o,styles:r,strings:g,layerHostId:p,queryString:m,results:b,isError:y,isLoading:T,menuType:I,enableScopedHeader:_,enablePrefixHighlighting:E,enableStickyFooter:A,keyboardHandlerTarget:R,showMoreEntitiesConfig:B,browseThisComputerConfig:W,showDiscoveryPromoFooter:G,listID:U,noSuggestionsHeaderInfo:V,disableTooltips:$,moveSelectionOnHover:K,locale:Q,showMeetingBanner:Y,enableMeetingBanner:J,meetingBannerText:Z,isUnsupported:X,onGroupSelected:ee,onAction:te,onItemSelected:oe,onFocus:ie,onFooterAction:ne,onAfterUpdate:re,appGptConfig:se})=>{var ae,le,ce;const ue=i.useContext(l.O),de=b.every((e=>{var t;return!(null===(t=e.suggestions)||void 0===t?void 0:t.length)||e.alwaysDisplay})),[he,ge]=i.useState({type:"item",groupIndex:0,itemIndex:0}),pe=i.useCallback((e=>{var t;e.type===S.E9?e.id===S.Es?null==te||te(C.L.Retry):e.id===S.WM&&(Ne(""),null==te||te(C.L.ClearSearch)):e.type===n.c.App&&void 0===e.AppType?null===(t=null==se?void 0:se.onClickExploreMoreCopilots)||void 0===t||t.call(se):oe(e)}),[te,oe]),fe=null!=o?o:a.Js,me=i.useMemo((()=>(0,N.H)(r,fe)),[r,fe]),ve={RenderFooterIcons:"true"},be=i.useRef(null),ye=i.createRef(),Ce=i.useRef({groupLayouts:[]}),[Se,we]=i.useState(0),[ke,Te]=i.useState(!1),[xe,Ie]=i.useState(void 0),[_e,Ee]=i.useState([]),Ae=i.useCallback((e=>{Ee(e)}),[Ee]),[Re,Be]=i.useState(!1),[Me,De]=i.useState(),[Oe,Fe]=i.useState(!1),[Pe,Ne]=i.useState(""),[Le,je]=i.useState(!1),[qe,He]=i.useState(!1),[ze,We]=i.useState(!1),[Ge,Ue]=i.useState(!0),Ve=i.useRef(null),{baseInlineSuggestionsGroups:$e,isScopedHeaderEnabled:Ke,itemsCount:Qe,itemsAndGroupHeadingCount:Ye,isGptMenu:Je}=i.useMemo((()=>{var e,t;let o=!1;if(null==se?void 0:se.enableAppGpt){b[0]||(b[0]={suggestions:[]}),o=null===(e=b[0].suggestions)||void 0===e?void 0:e.every((e=>e.type===n.c.App));const i=null===(t=b[0].suggestions)||void 0===t?void 0:t.some((e=>e.isMoreButton));if(o&&!i){const e={type:n.c.App,title:"Explore more extensions",isMoreButton:!0};b[0].suggestions.push(e)}}const i=(0,S.Oz)(T,y,de,g,b,V,X),r=i.filter((e=>!1!==e.isScopingEnabled&&!!e.title)).length,s=_&&!Oe&&r>0&&!o,a=i.reduce(((e,t)=>t.suggestions.length+e),0);return{baseInlineSuggestionsGroups:i,isScopedHeaderEnabled:s,itemsCount:a,itemsAndGroupHeadingCount:s?a+r:a,isGptMenu:o}}),[T,y,de,g,b,V]),Ze=i.useRef(),Xe=i.useMemo((()=>void 0===he?$e:"group"===he.type?$e.map(((e,t)=>t===he.groupIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e)):$e.map(((e,t)=>t===he.groupIndex?Object.assign(Object.assign({},e),{suggestions:e.suggestions.map(((e,t)=>t===he.itemIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e))}):e))),[he,$e]),et=(0,S.O5)(I),tt=I&&"brandingMode"in I&&void 0!==I.brandingMode?I.brandingMode:void 0,ot=I&&"flag"in I?I.critiquePosition:void 0,it=I&&"flag"in I?I.critiqueSetSize:void 0,nt=null!=t?t:x.nk(tt,ue);i.useEffect((()=>{De({top:0,bottom:0,isNewRender:!0})}),[m]),i.useEffect((()=>{if(T)return;let e=Ke&&$e.length>0&&$e[0].title?1:0;Oe&&(null==W?void 0:W.isBrowseThisComputerEnabled)&&(e=-1,De({top:0,bottom:0,isNewRender:!0}),Te(!0)),lt(e,1===e),we(e)}),[T,Oe,$e]);const rt=$e.length;i.useEffect((()=>{be.current&&(clearTimeout(be.current),be.current=null),T?rt?be.current=setTimeout((()=>Be(!0)),S.al):Be(!0):Be(!1)}),[T,rt]),i.useEffect((()=>{re&&e&&re(e)}));const st=i.useCallback((e=>{e(Ce.current)}),[]),at=i.useCallback(((e,t)=>{t.type===S.E9?t.id===S.Es?null==ie||ie({focusedItemHtmlId:S.E9,selection:{type:"retryButton"}}):t.id===S.WM&&(null==ie||ie({focusedItemHtmlId:S.E9,selection:{type:"clearSearchButton"}})):null==ie||ie({focusedItemHtmlId:(0,S.Bn)(e),selection:{type:"item",item:t,positionInSet:e,setSize:Ye}})}),[Ye,ie]),lt=i.useCallback(((e,t)=>{var o,i,n,r,s;if(void 0===e)return ge(void 0),-1;e%=Ye;let a=0;const l={top:0,bottom:0};for(let c=0;c<$e.length;c++){const u=$e[c];if(l.top=l.bottom+(null===(o=Ce.current.groupLayouts[c])||void 0===o?void 0:o.separatorHeight),l.bottom=l.top+(null===(i=Ce.current.groupLayouts[c])||void 0===i?void 0:i.headerHeight),Ke&&!1!==u.isScopingEnabled&&u.title){if(e===a)return De(Object.assign(Object.assign({},l),{isNewRender:!!t})),null==ie||ie({focusedItemHtmlId:(0,S.Bn)(e),selection:{type:"group",group:u,positionInSet:e,setSize:Ye}}),c<$e.length&&ge({type:"group",groupIndex:c}),e;a++}for(let o=0;o<u.suggestions.length;o++){const i=u.suggestions[o];if(0!==o&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(r=null===(n=Ce.current.groupLayouts[c])||void 0===n?void 0:n.itemHeights[o])&&void 0!==r?r:0),o===u.suggestions.length-1&&(l.bottom+=null===(s=Ce.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return De(Object.assign(Object.assign({},l),{isNewRender:!!t})),at(e,i),c<$e.length&&o<$e[c].suggestions.length&&ge({type:"item",groupIndex:c,itemIndex:o}),e;a++}}return e}),[$e]),ct=i.useCallback((e=>{Ie(e),null==ie||ie({focusedItemHtmlId:(0,P.k)(_e[e]),selection:{type:"action",action:_e[e],positionInSet:e,setSize:_e.length}})}),[_e,ie,Ie]),ut=i.useRef(!0),dt=i.useCallback((e=>{K?(Ue(!1),we(lt(e))):(ut.current||(0,D.i)())&&(we(e),lt(void 0))}),[K,$e,lt]),ht=i.useCallback((e=>{const t=(0,H.r)(e);if(!t)return;const o=(()=>{let o=0;for(const i of $e){Ke&&!1!==i.isScopingEnabled&&i.title&&o++;for(const n of i.suggestions){if(n.type===e.type&&(0,H.r)(n)===t)return o;o++}}return o})();dt(o)}),[dt]),gt=i.useCallback((e=>{const t=(()=>{let t=0;for(const o of $e){if(Ke&&!1!==o.isScopingEnabled&&o.title){if(e.title===o.title&&e.subtitle===o.subtitle)return t;t++}t+=o.suggestions.length}return t})();dt(t)}),[dt]);(0,O.c)((()=>{ut.current=!0}));const pt=e=>{var t;switch(e){case c.h.ArrowDown:void 0===xe?(ct(0),ge(void 0),De({top:1e4,bottom:1e4,isNewRender:!1})):xe<_e.length-1?(ct(xe+1),De({top:1e4,bottom:1e4,isNewRender:!1})):Oe&&(null==W?void 0:W.isBrowseThisComputerEnabled)?vt(e):(we(lt(0)),Ie(void 0));break;case c.h.ArrowUp:0===xe?(Ie(void 0),(null==B?void 0:B.isShowMoreEntitiesEnabled)&&!Oe?(ge(void 0),je(!0),De({top:1e4,bottom:1e4,isNewRender:!1})):we(lt(Ye-1))):void 0!==xe&&xe>0?(ct(xe-1),De({top:1e4,bottom:1e4,isNewRender:!1})):(lt(void 0,!1),ct(_e.length-1),De({top:1e4,bottom:1e4,isNewRender:!1}));break;case c.h.Enter:case c.h.Tab:if(void 0===xe)break;_e[xe]===M._R.Overflow?null===(t=ye.current)||void 0===t||t.openOverflowMenu(!0):null==ne||ne(_e[xe])}},ft=()=>{var e;Ze.current=Xe[0],Fe(!0),je(!1),null===(e=null==B?void 0:B.onClickShowMoreEntities)||void 0===e||e.call(B,!0),we(void 0)},mt=e=>{switch(e){case c.h.ArrowDown:Le?_e.length>0?(je(!1),Ie(0)):(je(!1),we(lt(0))):(lt(Se,!1),je(!0),De({top:1e4,bottom:1e4,isNewRender:!1}));break;case c.h.ArrowUp:Le?(je(!1),we(lt(Ye-1))):(lt(Se,!1),Ie(void 0),je(!0),De({top:1e4,bottom:1e4,isNewRender:!1}));break;case c.h.Enter:case c.h.Tab:ft()}},vt=e=>{var t;const o=Qe-1===Se;switch(e){case c.h.ArrowDown:if(et&&xe===_e.length-1)Ie(void 0),we(lt(void 0)),Te(!0);else{const e=!et&&o&&!ke;Te(e),we(e?void 0:lt((null!=Se?Se:-1)+1))}break;case c.h.ArrowUp:ke?(Te(!1),et&&void 0===xe?pt(e):we(lt(Ye-1))):(lt(Se,!1),we(void 0),Te(!0));break;case c.h.Enter:case c.h.Tab:null===(t=null==W?void 0:W.onClickBrowseThisComputer)||void 0===t||t.call(W)}},bt=e=>{if(e!==c.h.ArrowDown&&e!==c.h.ArrowUp&&e!==c.h.Enter&&e!==c.h.Tab&&e!==c.h.Home&&e!==c.h.End)return!1;switch(e){case c.h.ArrowDown:if(He(!0),We(!1),Ue(!1),ut.current=!1,void 0!==xe||Se===Ye-1||Le)!(null==B?void 0:B.isShowMoreEntitiesEnabled)||Oe||void 0!==xe&&!Le?_e.length>0?pt(e):(null==W?void 0:W.isBrowseThisComputerEnabled)&&!Je?vt(e):we(lt(0)):mt(e);else if(!(null==W?void 0:W.isBrowseThisComputerEnabled)||Je){const e=lt((null!=Se?Se:-1)+1);we(e)}else vt(e);break;case c.h.ArrowUp:He(!0),We(!1),Ue(!1),ut.current=!1,ke&&Oe?vt(e):0===Se&&Oe?(null==W?void 0:W.isBrowseThisComputerEnabled)?vt(e):et?pt(e):we(lt(Ye-1)):void 0!==xe||0===Se||Le?(0===Se||void 0!==xe)&&_e.length>0&&!Le?pt(e):Le||0===Se&&(null==B?void 0:B.isShowMoreEntitiesEnabled)&&!Oe&&(0===xe||void 0===xe)?mt(e):we(lt(Ye-1)):we(lt((null!=Se?Se:-1)-1));break;case c.h.Home:He(!0),We(!1),Ue(!1),we(lt(0)),ut.current=!1;break;case c.h.End:He(!0),We(!1),Ue(!1),we(lt(Ye-1)),ut.current=!1;break;case c.h.Enter:case c.h.Tab:{if(Le){mt(e);break}if(void 0!==xe){pt(e);break}if(ke){vt(e);break}let t=0;$e.forEach((e=>{Ke&&!1!==e.isScopingEnabled&&e.title&&(Se===t&&(null==ee||ee(e)),t++),void 0!==Se&&Se>=t&&Se<t+e.suggestions.length&&pe(e.suggestions[Se-t]),t+=e.suggestions.length}));break}default:return!1}return!0},yt=e=>{R||bt(e.key)};i.useEffect((()=>(null==R||R.setKeyPressHandler(bt),()=>{null==R||R.setKeyPressHandler(void 0)})));const Ct=i.useRef(),St=()=>{Ct.current&&clearTimeout(Ct.current),Ct.current=setTimeout((()=>{clearTimeout(Ct.current),Ct.current=void 0,We(!0)}),50)};i.useEffect(St,[Me]);const wt=me.containerStyles||{},{paddingStart:kt,paddingEnd:Tt,paddingHorizontal:xt,paddingTop:It,paddingBottom:_t,paddingVertical:Et,paddingScrollTop:At,scrollbarThumbWidth:Rt,scrollbarPaddingBottom:Bt}=wt,Mt=z(wt,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth","scrollbarPaddingBottom"]),[Dt,Ot]=i.useState(null!==(le=null===(ae=me.gptViewStyles)||void 0===ae?void 0:ae.defaultContainerHeight)&&void 0!==le?le:250),{maxHeight:Ft}=Mt,Pt=z(Mt,["maxHeight"]),Nt=(null==se?void 0:se.enableAppGpt)&&Je?Object.assign(Object.assign({},Pt),{minWidth:260,maxWidth:260,maxHeight:Dt,height:Dt}):Mt,Lt=null!=kt?kt:xt,jt=null!=Tt?Tt:xt,qt=G&&I&&"flag"in I&&I.flag===M.z4.File,Ht=()=>i.createElement(j.R,{strings:{inlineSuggestions:g.inlineSuggestions}}),zt=()=>{var e,t;return!et||(null==se?void 0:se.enableAppGpt)?i.createElement(i.Fragment,null):i.createElement(P.w,{ref:ye,theme:x.Dj(nt),definition:{critiqueType:M.L9.InlineSuggestion,flagType:I&&"flag"in I?I.flag:void 0,brandingMode:tt,onlyShowFeedbackButton:A,actions:(0,S.Jx)(I),critiquePosition:ot,critiqueSetSize:it},layerHostId:p,strings:g,settings:ve,onAction:ne,overflowMenuCalloutStyle:null===(e=null==me?void 0:me.footerStyles)||void 0===e?void 0:e.overflowMenuCalloutStyles,footerContainerStyle:me.footerStyles,footerButtonStyle:me.footerStyles.buttonStyles,overflowMenuButtonStyle:null!==(t=me.footerStyles.buttonStyles)&&void 0!==t?t:me.footerStyles.overFlowButtonStyles,setFooterActionIdList:Ae,selectedButtonIndex:xe,showPreviewTooltipForBranding:!0})},Wt=(null==B?void 0:B.isShowMoreEntitiesEnabled)&&!Oe&&!(y||de||X);return i.createElement(u.S,{style:Object.assign(Object.assign(Object.assign({},s.uI(nt,void 0,{useFluentV9:ue})),Nt),{hideFocusBox:!0}),align:d.j5.Stretch,focusable:!0,onKeyDown:yt,handledKeys:[c.h.ArrowDown,c.h.ArrowUp,c.h.Enter,c.h.Tab,c.h.Home,c.h.End],accessibilityRole:Re||y||de||X?void 0:"listbox",accessible:!0,accessibilityLabel:g.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:U},i.createElement(v.B,{scrollDirection:"vertical",style:{paddingStart:Lt,paddingEnd:jt,paddingTop:It,paddingBottom:_t,paddingVertical:Et,paddingScrollTop:At,scrollbarThumbWidth:Rt,scrollbarPaddingBottom:Bt,borderRadius:Mt.borderRadius},theme:{thumbColor:null===(ce=null==nt?void 0:nt.scroll)||void 0===ce?void 0:ce.thumbColor},onScroll:St,onScrollStatusChange:e=>{e&&Ue(!1)},scrollTo:Me,hidden:Re,alwaysShowScrollbar:(null==se?void 0:se.enableAppGpt)&&Je},i.createElement(h.R,null,Oe&&i.createElement(i.Fragment,null,(null==B?void 0:B.displayGroupHeaderDuringSearch)&&Ze.current?i.createElement(q.h,{theme:nt,styles:null==me?void 0:me.headerStyles,group:Ze.current,isScopableHeader:!1,onHeightChange:e=>{Ce.current.groupLayouts[0]||(Ce.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),Ce.current.groupLayouts[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{Ce.current.groupLayouts[0]||(Ce.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),Ce.current.groupLayouts[0].extraSpaceBottomHeight=e},strings:g,displayNewItemTag:!1}):void 0,i.createElement(u.S,{direction:d.PR.LeftToRight},!0!==(null==B?void 0:B.shouldOnlyShowSearchBox)?i.createElement("span",{style:{flexGrow:0,flexShrink:0}},i.createElement(f.u,{appearance:"subtle",style:a.Ek,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;Fe(!1),null===(e=null==B?void 0:B.onCloseShowMoreEntities)||void 0===e||e.call(B,!1),we(0)},theme:x.VD(nt),icon:{type:"Previous",style:a.dt}})):void 0,i.createElement(k.y,{theme:nt,style:null==me?void 0:me.searchBoxStyles,htmlId:null==B?void 0:B.searchBoxHtmlId,autoFocus:!0,handledKeys:[c.h.ArrowDown,c.h.ArrowUp,c.h.Enter,c.h.Tab,c.h.Home,c.h.End],onKeyDown:e=>{bt(e.key)},placeholder:(null==B?void 0:B.searchBoxPlaceHolder)||"",value:Pe,onValueChange:e=>{var t;Ne(e),null===(t=null==B?void 0:B.onSearchChange)||void 0===t||t.call(B,e)},onClear:()=>{var e;Ne(""),null===(e=null==B?void 0:B.onSearchClear)||void 0===e||e.call(B)}}))),(null==W?void 0:W.isBrowseThisComputerEnabled)&&Oe&&i.createElement(L.i,{handledKeys:[c.h.ArrowDown,c.h.ArrowUp,c.h.Enter,c.h.Tab,c.h.Home,c.h.End],onKeyDown:yt,strings:g,browseThisComputerButtonLabel:null==W?void 0:W.browseThisComputerButtonLabel,isBrowseThisComputerEnabled:ke,hasSelectionBeenModifiedViaKeyboard:qe,browseThisComputerHtmlId:null==W?void 0:W.browseThisComputerHtmlId,onClickBrowseThisComputer:null==W?void 0:W.onClickBrowseThisComputer,theme:x.Ui(nt,ke)}),i.createElement(w.p,{suggestionsRef:Ve,theme:nt,styles:me,strings:g,locale:Q,results:Xe,isShimmerVisible:Re,enableScopedHeader:Ke,itemsCount:Ye,itemQueryString:m,onGroupSelected:ee,onGroupHovered:gt,onItemHovered:ht,onItemSelected:pe,enablePrefixHighlighting:E,isGroupHeaderVisible:!Oe&&!Je,hasSelectionBeenModifiedViaKeyboard:qe,showKeyboardTooltip:ze,isInitialSelection:Ge,layerHostId:p,disableTooltips:$,updateMenuLayout:st,updateItemHeight:e=>{var t,o;const i=Math.min(null!==(o=null===(t=b[0])||void 0===t?void 0:t.suggestions.length)&&void 0!==o?o:1,5);Ot(e*i+(null!=It?It:0)+(null!=_t?_t:0))},showMeetingBanner:Y,enableMeetingBanner:J,meetingBannerText:Z}),Wt&&i.createElement(f.u,{appearance:"subtle",automationLabel:"InlineSuggestionMoreEntitiesButton",title:B.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:x.zN(nt,Le),onClick:ft})),I&&"flag"in I&&I.flag===M.z4.SatoriEntity&&i.createElement(u.S,{style:{paddingHorizontal:s.QL}},i.createElement(F.R,{url:(0,S.MN)(m),text:g.inlineSuggestions("seeMoreHyperLinkLabel"),theme:x.fj(nt),style:a.v9(),inline:!1})),!A&&zt(),!A&&qt&&Ht()),A&&zt(),A&&qt&&Ht())};var G=o(98756),U=o(89058),V=o(19430),$=o(74574),K=o(81406);const Q='[\\.\\:\\;\\,\\s-_\\(\\)\\/\\"\\u2018\\u2019\\u201c\\u201d\\xab\\xbb\\!\\?\\#\\&\\+\\\\<\\>\\@\\+\\=\\xa1\\xbf\\xaa\\xba]';function Y(e,t,o,i){if(t){const n=e.map((e=>(0,K.S)(e))),r=(0,K.S)(t);return 1===e.length&&""===e[0]?[]:function(e,t,o,i){let n;t=t.toUpperCase();const r={};for(const o of e){if(!o)continue;const e=i(o.toUpperCase());for(;n=e.exec(t);)Z(o,n,r)}const s=function(e,t){const o=[];for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&o.push({offset:parseInt(i,10),word:e[i],propertyHit:t});return o.sort(((e,t)=>t.offset-e.offset))}(r,o);return s.length&&function(e,t){let o=e[e.length-1].offset+e[e.length-1].word.length;for(let i=e.length-2;i>=0;i--){const n=e[i].offset+e[i].word.length-1;e[i].offset<o?n>o?e[i].offset<o&&(e[i].word=t.substring(o,e[i].offset+e[i].word.length),e[i].offset=o):e.splice(i,1):o=n}}(s,t),s}(n,r,o,i||J)}return[]}function J(e){return new RegExp("(^|"+Q+")"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"ig")}function Z(e,t,o){var i;const n=(null===(i=t[1])||void 0===i?void 0:i.length)?t.index+t[1].length:t.index;(!o[n]||o[n].length<e.length)&&(o[n]=e)}var X=o(80098),ee=o(13717),te=o(55180),oe=o(27293),ie=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,ne=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,re=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,se=/\s+/g,ae=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;var le=o(20176),ce=o(82751);const ue=e=>!(void 0===e.isScopingEnabled&&void 0===e.showSeparator);function de(e,t,o){var i;return o?o.message:null!==(i=null==e?void 0:e.customizedEmptyECCSuggestionsString)&&void 0!==i?i:t("suggestionsGroupNoSuggestionsText")}function he(e,t,o,i){const n={clearSearchLabel:t("clearSearchLabel"),showAvailableSuggestionsLabel:t("showAvailableSuggestionsLabel"),somethingWentWrongLabel:t("somethingWentWrongLabel"),tryAgainLabel:t("tryAgainLabel"),suggestionsGroupSearchResultAccessibilityLabel:t("suggestionsGroupSearchResultAccessibilityLabel"),combineSentences:t("combineSentences"),newTagText:t("newTagText"),discoveryPromoFooterText:t("discoveryPromoFooterText"),emailSentBy:t("emailSentBy"),feedbackText:t("feedbackText"),meetingSeries:t("meetingSeries"),recordText:t("recordText"),allTabAriaLabel:t("allTabAriaLabel"),overflowTabAriaLabel:t("overflowTabAriaLabel"),expandedInlineSuggestionsSearchBarPlaceholder:t("expandedInlineSuggestionsSearchBarPlaceholder"),startTypingToSearch:t("startTypingToSearch")},r={ignoreAll:o("ebx_ignoreAllButtonLabel"),ignoreOnce:o("ebx_ignoreOnceButtonLabel"),ignoreRule:o("ebx_disableCritiqueButton"),options:o("ebx_changeSettingsCommandLabel"),giveFeedbackButtonText:o("ebx_giveFeedback"),editorButtonTooltipContent:o("ebx_settingsButtonTooltip"),editorButtonText:o("editorButtonText")},s={suggestionsGroupNoSuggestionsText:de(e,t,i)};return Object.assign(Object.assign({},function(){const e=Array(),t={};for(const o of e)t[o]=e=>"";return t}()),{inlineSuggestions:e=>n[e]||"",common:e=>s[e]||"",critique:e=>r[e]||""})}const ge=(0,le.PA)((e=>{var t,o,s,a,l,c,u,d,h;const{calloutProps:g,layerHostId:p,styles:f}=e,{calloutStrings:m,currentScope:v,enableExpandedECC:b,enableScopedHeader:y,expandedEccSearchBarConfig:C,generateExpandedECCHeader:S,inlineSuggestionsStrings:w,isDividerShown:k,isFeedbackEnabled:T,isFeedbackButtonEnabled:x,onFeedbackButtonClicked:I,isFlightEnabled:_,isLoading:E,isRtl:A,oaSettings:R,onGroupSelected:M,onItemFocused:D,onItemSelected:O,onProcessedResults:F,onUserInteraction:P,queryString:N,resultReset:L,suggestions:j,theme:q,removeComposingBoxQuery:H,updateComposingBoxQuery:z,handleKeyDown:K,triggerMethod:Q,appGptConfig:J,unsupportedEntities:Z}=g,ie=null==Z?void 0:Z.find((e=>e.entityType===(null==v?void 0:v.entityType))),ne=null===(t=null==R?void 0:R.bestMatchConfig)||void 0===t?void 0:t.enabled,re=null==R?void 0:R.enablePrefixHighlighting,se=new Map,ae=i.useRef([]),le=[],de=i.useRef(S(b));b&&(de.current.suggestions=de.current.suggestions.map((e=>{var t,o,i;return Object.assign(Object.assign({},e),{isSelected:!(null==v?void 0:v.entityType)&&!(null===(t=e.scopeInfo)||void 0===t?void 0:t.entityType)||(null==v?void 0:v.entityType)===(null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType)||!v&&e.isSelected&&1===(null===(i=null==R?void 0:R.entitiesEnabled)||void 0===i?void 0:i.length)})})));let ge=!1;(0,ce.runInAction)((()=>{var e,t,o,i,r,s,a;if(E)return;const l=j.slice().sort(((e,t)=>{var o,i;return(null!==(o=e.priority)&&void 0!==o?o:0)-(null!==(i=t.priority)&&void 0!==i?i:0)}));let c;for(const r of l)for(const[,s]of r.entities.entries()){ge=ge||s.entityType===n.c.PIM;const a=ne&&s.isBestMatch,u=a?"":null!==(e=r.groupTitle)&&void 0!==e?e:s.entityType===n.c.PIM?(0,V.X)(s.type,s.IntentId):(0,V.X)(s.type);if(s.icon&&(s.icon.iconName=(0,$.S)(s.icon.iconName)),s.entityType===n.c.People&&pe(s,A),s.entityType===n.c.Scope&&(null===(t=s.scopeInfo)||void 0===t?void 0:t.entityType)&&s.scopeInfo.entityType!==n.c.External&&(s.title=(0,V.X)(s.scopeInfo.entityType)),re&&!s.hitHighlightIndexes){const e=s[null!==(o=s.titleHitHighlightProperty)&&void 0!==o?o:"title"],t=s[null!==(i=s.subtitleHitHighlightProperty)&&void 0!==i?i:"subtitle"];s.hitHighlightIndexes=Y([N],e,"title").concat(t?Y([N],t,"subTitle"):[])}let d=se.get(u);if(!d)if(d=Object.assign(Object.assign(Object.assign({title:u,subtitle:r.groupSubtitle,suggestions:[]},(null==v?void 0:v.entityType)===l[0].entityType&&{isScoped:!0}),s.entityType===n.c.Scope&&{isScopingEnabled:!1,showSeparator:!0}),k&&{showSeparator:!0}),se.set(u,d),a)le.unshift(d);else if(r.entityType===n.c.Scope)c=d;else{if(v&&v.entityType!==r.entityType)continue;if(!v&&(null==Z?void 0:Z.some((e=>e.entityType===r.entityType))))continue;le.push(d)}d.suggestions.push(s)}if(c&&le.push(c),null==R?void 0:R.preventAllTabBackfill){const e=!v,t=(null===(r=le[0])||void 0===r?void 0:r.suggestions.length)>0;b&&e&&t&&le.splice(1)}(null==R?void 0:R.gptResultsLengthCap)&&"App"===(null===(s=le[0])||void 0===s?void 0:s.title)&&(null===(a=le[0])||void 0===a||a.suggestions.splice(R.gptResultsLengthCap)),le.length&&(le[0].showSeparator=!1),F()}));const fe=i.useCallback((()=>{P()}),[P]),me=i.useCallback(((e,t)=>{if(C&&Q!==X.P.AttachFile&&Q!==X.P.Fre){const o=document.querySelectorAll("input[type=search]");o.length>0&&e.target===o[0]&&(null==z||z(),0===o[0].value.length&&setTimeout((()=>{o[0].value=t||""}),100))}if(!b&&(0,ee.m)(e.target)&&"BUTTON"!==e.target.nodeName&&"INPUT"!==e.target.nodeName){e.preventDefault();const t=e.relatedTarget;null==t||t.focus()}}),[]),ve=document.querySelectorAll("input[type=search]"),be=document.querySelectorAll('[data-ms-editor="true"]');C&&ve.length>0&&be.length>0&&document.activeElement===be[0]&&(Q===X.P.AttachFile||Q===X.P.Fre?(null==H||H(ve[0]),ve[0].focus()):N?ve[0].setAttribute("placeholder",N):ve[0].setAttribute("placeholder",w("expandedInlineSuggestionsSearchBarPlaceholder")));const[ye,Ce]=i.useState(!1),[Se,we]=i.useState(!1);i.useEffect((()=>{function e(){Ce(window.matchMedia("(max-width: 480px)").matches),we(window.matchMedia("(max-height: 480px)").matches)}e();const t=new r.J(window);t.addListener("resize",e);const o=document.getElementsByClassName("ms-Callout"),i=o.length>0&&new r.J(o[0]);return i&&i.addListener("keydown",K),()=>{t.removeAllListeners(),i&&i.removeAllListeners()}}),[]);const ke=_("mc-editor-expanded-ecc-responsive"),Te=_("mc-editor-enable-meeting-banner");(L||!E||le.length)&&(ae.current=y?(e=>{if(e.length>0&&e.some(ue))return e;const t=e.findIndex((e=>{var t;return(null===(t=e.suggestions[0])||void 0===t?void 0:t.type)===n.c.Scope}));return-1!==t?(e[t]=Object.assign(Object.assign({},e[t]),{isScopingEnabled:!1,showSeparator:!0}),e.concat(e.splice(t,1))):e})(le):le);const xe=w("managePersonalInfoLinkText"),Ie=w("managePersonalInfoLinkUrl"),_e=w("meetingBannerText"),Ee=Object.assign(Object.assign({},g),{keyboardHandlerTarget:b?void 0:g.keyboardHandlerTarget,expandedKeyboardHandlerTarget:b?g.expandedKeyboardHandlerTarget:void 0,enablePrefixHighlighting:re,appGptConfig:J,layerHostId:p,onGroupSelected:M,onItemSelected:O,showDiscoveryPromoFooter:null==R?void 0:R.enableDiscoveryPromoFooter,strings:he(R,w,m,ie),styles:f,theme:q}),Ae=i.useMemo((()=>(0,oe.jI)()?"rtl":"ltr"),[]);return i.createElement("div",{onMouseEnter:fe,onFocus:e=>me(e,N)},b?i.createElement(G.q,{theme:g.fluentTheme,dir:Ae},i.createElement(B,Object.assign({},Ee,{results:ae.current,scopes:de.current,onItemFocused:D,disableTooltips:!0,isFeedbackEnabledForEcc:T,isFeedbackButtonEnabled:x,onFeedbackButtonClicked:I,enableResponsiveLayout:ke,isSmallWindow:ke&&ye,isSmallHeight:ke&&Se,enableMeetingBanner:Te,showMeetingBanner:Te&&(null==v?void 0:v.entityType)===n.c.Event,meetingBannerText:_e,isUnsupported:!!ie}))):i.createElement(W,Object.assign({},Ee,{results:ae.current,onFocus:D,enableScopedHeader:y,disableTooltips:null==R?void 0:R.disableInlineSuggestionTooltips})),ge?i.createElement("div",{style:{height:"32px",padding:"4px 12px"}},i.createElement("a",{href:Ie,target:"_blank",rel:"noreferrer","aria-label":xe,style:{textDecoration:"unset",color:"#0078D4",fontSize:12,lineHeight:"16px"}},xe)):null,i.createElement(U.b,{target:te.Y.inlineSuggestions,styles:{container:{borderRadius:{topStart:0,topEnd:0,bottomStart:null!==(s=null===(o=null==f?void 0:f.containerStyles)||void 0===o?void 0:o.borderRadius)&&void 0!==s?s:8,bottomEnd:null!==(l=null===(a=null==f?void 0:f.containerStyles)||void 0===a?void 0:a.borderRadius)&&void 0!==l?l:8},minWidth:null!==(u=null===(c=null==f?void 0:f.containerStyles)||void 0===c?void 0:c.minWidth)&&void 0!==u?u:300,maxWidth:null!==(h=null===(d=null==f?void 0:f.containerStyles)||void 0===d?void 0:d.maxWidth)&&void 0!==h?h:420}}}))}));function pe(e,t){e.initials=function(e,t,o){return e?(e=function(e){return(e=(e=(e=e.replace(ie,"")).replace(ne,"")).replace(se," ")).trim()}(e),ae.test(e)||!o&&re.test(e)?"":function(e,t){var o="",i=e.split(" ");return 2===i.length?(o+=i[0].charAt(0).toUpperCase(),o+=i[1].charAt(0).toUpperCase()):3===i.length?(o+=i[0].charAt(0).toUpperCase(),o+=i[2].charAt(0).toUpperCase()):0!==i.length&&(o+=i[0].charAt(0).toUpperCase()),t&&o.length>1?o.charAt(1)+o.charAt(0):o}(e,t)):""}(e.displayName,t)}},91427:(e,t,o)=>{"use strict";o.d(t,{b:()=>u});var i=o(22474),n=o(36284),r=o(13920),s=o(85317),a=o(20176),l=o(56415);const c=(0,i.F5)({inlineSuggestionsCalloutStore:n.A.on(r.Z)}),u=(0,a.PA)((()=>{var e;const{inlineSuggestionsCalloutStore:t}=(0,i.KN)(c);return(null===(e=t.displayCallout)||void 0===e?void 0:e.targetLocation)?l.createElement(s.$,Object.assign({},t.displayCallout)):null}))},85317:(e,t,o)=>{"use strict";o.d(t,{$:()=>h});var i=o(73027),n=o(56415),r=o(69261),s=o(17088),a=o(38643),l=o(80836),c=o(87803),u=o(96807),d=o(68191);const h=(0,o(15561).PA)((e=>{var t,o,h,g,p,f,m,v,b,y,C,S,w,k,T,x,I,_;const E=n.useContext(u.O1),{maxHeightCallback:A,targetLocation:R,popoverProps:B,isMobile:M}=e,{isLoading:D,isFlightEnabled:O,onDismissed:F,onFirstRender:P,onPreventDismissOnEvent:N,onRenderResults:L,onRestoreFocus:j,style:q,styles:H,theme:z}=e.calloutProps;let W=!0;const[G,U]=n.useState(!0);n.useEffect((()=>{P()}),[P]),n.useEffect((()=>{D||L()}),[D,L]);const V=n.useCallback((e=>{e&&"key"in e&&l.x.isKey(e,c.m.escape)&&(e.preventDefault(),e.stopPropagation()),e&&"focus"===e.type&&(W=!1),F(!1)}),[F]),$=n.useCallback((e=>{W&&j(e,(()=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()}))}),[j,W]),K=H||{},{calloutStyles:Q}=K,Y=(0,i.Tt)(K,["calloutStyles"]),J=Y.containerStyles||{},Z=O("mc-editor-expanded-ecc-responsive"),X=null!==(g=null!==(o=null===(t=null==H?void 0:H.calloutStyles)||void 0===t?void 0:t.borderRadius)&&void 0!==o?o:null===(h=null==z?void 0:z.callout)||void 0===h?void 0:h.borderRadius)&&void 0!==g?g:8;if(!e.targetLocation)return null;const ee=null==A?void 0:A(e.targetLocation,null!==(p=e.targetWindow.deref())&&void 0!==p?p:window),te=null===(f=e.directionalHintCallback)||void 0===f?void 0:f.call(e,e.targetLocation,null!==(m=e.targetWindow.deref())&&void 0!==m?m:window,ee);let oe,ie="absolute";if(M&&(ie="fixed",oe=!0),E){const t=Z?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(w=null==z?void 0:z.callout)||void 0===w?void 0:w.width},Q),o={popover:Object.assign(Object.assign({},B),{trapFocus:null===(k=null==B?void 0:B.trapFocus)||void 0===k||k,withArrow:null!==(x=null===(T=null==z?void 0:z.callout)||void 0===T?void 0:T.isBeakVisible)&&void 0!==x&&x,open:G,onOpenChange:(e,t)=>{!t.open&&(null==N?void 0:N(e))||(U(t.open),t.open||V())},positioning:Object.assign(Object.assign({},(0,d.Sg)(te,M)),{target:(0,d.ug)(R),strategy:ie,autoSize:oe})}),surface:{className:"ms-ecc-callout",style:Object.assign({padding:0,maxWidth:450,maxHeight:ee,overflow:"hidden",border:null===(I=null==z?void 0:z.callout)||void 0===I?void 0:I.border,boxShadow:null===(_=null==z?void 0:z.callout)||void 0===_?void 0:_.shadow},t)}};return n.createElement(s.v,Object.assign({},o),n.createElement(a.V,{calloutProps:e.calloutProps,styles:(null==q?void 0:q.fitToContent)||J.maxHeight?Object.assign(Object.assign({},Y),{containerStyles:Object.assign(Object.assign({},J),{maxHeight:ee})}):Y}))}return n.createElement(r.U,{className:"ms-ecc-callout",target:(0,d.KV)(R),shouldDismissOnWindowFocus:!1,onDismiss:V,preventDismissOnEvent:N,gapSpace:0,doNotLayer:!1,isBeakVisible:null!==(b=null===(v=null==z?void 0:z.callout)||void 0===v?void 0:v.isBeakVisible)&&void 0!==b&&b,directionalHint:te,alignTargetEdge:!0,onRestoreFocus:$,calloutMaxHeight:ee,style:Z?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(y=null==z?void 0:z.callout)||void 0===y?void 0:y.width},Q),styles:{beakCurtain:{borderRadius:X},calloutMain:{overflow:"hidden",border:null===(C=null==z?void 0:z.callout)||void 0===C?void 0:C.border,borderRadius:X,boxShadow:null===(S=null==z?void 0:z.callout)||void 0===S?void 0:S.shadow},root:{borderRadius:X,width:"fit-content"}}},n.createElement(r.d.Consumer,null,(t=>n.createElement(a.V,{calloutProps:e.calloutProps,styles:(null==q?void 0:q.fitToContent)||J.maxHeight?Object.assign(Object.assign({},Y),{containerStyles:Object.assign(Object.assign({},J),{maxHeight:ee})}):Y,layerHostId:t}))))}))},49313:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>l}),3023==o.j)var i=o(64017);if(3023==o.j)var n=o(55180);if(3023==o.j)var r=o(46536);if(3023==o.j)var s=o(50921);if(3023==o.j)var a=o(30757);class l{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918212)}configureRootServices(e){e.bind(n.D).to(i.o),e.bind(r.j).to(s.S)}}},77840:(e,t,o)=>{"use strict";if(o.d(t,{u:()=>a}),3023==o.j)var i=o(61467);if(3023==o.j)var n=o(42981);if(3023==o.j)var r=o(30757);if(3023==o.j)var s=o(45313);class a{get uniqueId(){return(0,r.z)(507918230)}configureRootServices(e){e.bind(s.S).toExisting(n.I),e.bind(n.I).to(i.U)}}},92318:(e,t,o)=>{"use strict";if(o.d(t,{Q:()=>l}),3023==o.j)var i=o(72286);if(3023==o.j)var n=o(91427);if(3023==o.j)var r=o(41800);if(3023==o.j)var s=o(68358);if(3023==o.j)var a=o(30757);class l{constructor(){this.imports=[r.N,s.h]}get uniqueId(){return(0,a.z)(507918216)}configureRootServices(e){e.bind(i.i).toValue(n.b)}}},94086:(e,t,o)=>{"use strict";o.d(t,{R:()=>h});var i=o(22474),n=o(36284),r=o(46536),s=o(43726),a=o(66131),l=o(46050),c=o(20176),u=o(56415);const d=(0,i.F5)({multilingualStore:n.A.on(r.j),critiqueCalloutStateStore:n.A.on(s.v),localizer:n.A.on(a.H)}),h=(0,c.PA)((e=>{var t;const{theme:o,style:n}=e,{critiqueCalloutStateStore:r,multilingualStore:s,localizer:a}=(0,i.KN)(d);return u.createElement("div",{style:Object.assign({color:null!==(t=null==o?void 0:o.textColor)&&void 0!==t?t:"#323130"},n)},u.createElement("div",{style:{marginBottom:8}},u.createElement("b",null,a.getMessage("multilingualFRE_HeadingText"))),a.getMessage("multilingualFRE_DescriptionText")," ",u.createElement("br",null),u.createElement(l.N,{style:{fontSize:12},onClick:()=>{r.hide(),s.showEditorSettings()},"aria-label":a.getMessage("multilingualFRE_DescriptionButtonLinkAriaLabel"),"data-is-focusable":!0},a.getMessage("multilingualFRE_DescriptionButtonLink")))}))},50921:(e,t,o)=>{"use strict";o.d(t,{S:()=>u});var i=o(73027),n=o(56415),r=o(55180),s=o(94086),a=o(11049),l=o(41453);const c="multilingualProofingFre";let u=class{constructor(e){this.footerFreStore=e}addMultilingualProofingFre(){this.footerFreStore.addFooterPage(r.Y.critique,c,{icon:"LocaleLanguage",content:(e,t)=>n.createElement(s.R,{style:e,theme:t})})}removeMultilingualProofingFre(){this.footerFreStore.removeFooterPage(r.Y.critique,c)}setOnShowEditorSettings(e){this._onShowEditorSettings=e}showEditorSettings(){this._onShowEditorSettings&&this._onShowEditorSettings(!0)}};u=(0,i.Cg)([(0,a._)(),(0,i.Qj)(0,(0,l.W)(r.D))],u)},98218:(e,t,o)=>{"use strict";o.d(t,{_:()=>S});var i=o(22474),n=o(36284),r=o(35814),s=o(56415),a=o(90730),l=o(74574),c=o(69261),u=o(17088),d=o(81609),h=o(68191),g=o(96807),p=o(73440),f=o(80836),m=o(87803),v=o(20176);const b=(0,i.F5)({styleStore:n.A.on(g.UC).optional(),themeStore:n.A.on(g.YQ).optional()}),y=(0,v.PA)((e=>{var t,o,n,r,v,y,C,S,w;const k=s.useContext(g.O1),{styleStore:T,themeStore:x}=(0,i.KN)(b),{nudge:I,nudgeDisplayLocation:_,nudgeTargetDocumentRef:E,onAcceptNudgeAction:A,onHideNudge:R,inlineNudge:B,insertionCharacter:M}=e,[D,O]=s.useState(!1),[F,P]=s.useState(!0),N=s.useRef(void 0),L=s.useCallback((e=>{window.clearTimeout(N.current),N.current=e}),[N]),j=s.useCallback(((e,t)=>{window.clearTimeout(N.current),R(e,t)}),[R,N]),q=s.useCallback((()=>{window.clearTimeout(N.current),O(!0)}),[O,N]),H=s.useCallback((()=>{L(window.setTimeout((()=>{j("timeout 5000")}),5e3)),O(!1)}),[j,L,O]),z=s.useCallback((()=>A("click",!0)),[A]);s.useEffect((()=>(L(window.setTimeout((()=>{j("timeout 5000")}),5e3)),()=>{window.clearTimeout(N.current)})),[]);const W=s.useCallback((e=>{f.x.isKey(e,m.m.escape)?(e.stopPropagation(),e.preventDefault(),j(e.key)):f.x.isKey(e,m.m.enter)||f.x.isKey(e,m.m.backspace)?j(e.key):f.x.isKey(e,"v",void 0,!0)?j("user pasted text",!0):(f.x.isKey(e,m.m.tab)||e.key===M)&&(e.stopPropagation(),e.preventDefault(),A(e.key,!0))}),[j,I.entityType,A]),G=s.useCallback((()=>{j("MouseDown")}),[j]),U=s.useCallback((()=>{j("Scroll")}),[j]),V=s.useCallback((()=>{j("Resize")}),[j]);s.useEffect((()=>{var e,t;const o=null!==(t=null===(e=E.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window,i=new d.J(E),n=new d.J(o);return i.addListener("keydown",W,{capture:!0}),i.addListener("mouseup",G),n.addListener("resize",V),n.addListener("scroll",U,{capture:!0}),()=>{i.removeAllListeners(),n.removeAllListeners()}}),[W,G,U,V,E]);const $=null==T?void 0:T.getComponentStyle(B?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName),K=null==x?void 0:x.getComponentActiveTheme(B?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName),Q=I.entityResults?(0,l.S)(null!==(o=null===(t=I.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==o?o:""):void 0,Y=null!==(n=null==$?void 0:$.borderRadius)&&void 0!==n?n:B?4:15,J=null!==(r=null==$?void 0:$.fontSize)&&void 0!==r?r:"10pt",Z=null==$?void 0:$.fontWeight,X=null!==(v=null==$?void 0:$.paddingTop)&&void 0!==v?v:2,ee=null!==(y=null==$?void 0:$.paddingBottom)&&void 0!==y?y:2,te=null!==(C=null==$?void 0:$.paddingLeftRight)&&void 0!==C?C:8,oe=null==$?void 0:$.lineHeight,ie=B?a.A.rightTopEdge:a.A.bottomCenter,ne=B?"none":null==$?void 0:$.boxShadow,re=I.text.split(/(@|\/)/g),se=B?{align:"center",position:"after",offset:e=>({mainAxis:1})}:{align:"center",position:"below",offset:e=>({mainAxis:8})},ae=s.createElement("div",{style:{borderRadius:Y,display:"flex",cursor:"pointer"}},Q?s.createElement("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8}},s.createElement(p.In,{type:Q,style:{width:void 0,height:void 0},primaryColor:D&&null!==(S=null==K?void 0:K.text.hover)&&void 0!==S?S:null==K?void 0:K.text.resting,fontSize:void 0})):void 0,s.createElement("span",{className:"ms-nudge-text",style:{color:D&&null!==(w=null==K?void 0:K.text.hover)&&void 0!==w?w:null==K?void 0:K.text.resting,fontSize:J,fontWeight:Z,paddingTop:X,paddingBottom:ee,paddingLeft:te,paddingRight:te,textDecoration:"none",userSelect:"none",lineHeight:oe}},re.map((e=>{var t,o,i,n,r,a,l,c,u,d;return"@"===e||"/"===e?s.createElement("span",{key:e,style:Object.assign({backgroundColor:D?null!==(o=null===(t=null==K?void 0:K.highlight)||void 0===t?void 0:t.background.hover)&&void 0!==o?o:null===(i=null==K?void 0:K.highlight)||void 0===i?void 0:i.background.resting:null===(n=null==K?void 0:K.highlight)||void 0===n?void 0:n.background.resting,color:D?null!==(a=null===(r=null==K?void 0:K.highlight)||void 0===r?void 0:r.text.hover)&&void 0!==a?a:null===(l=null==K?void 0:K.highlight)||void 0===l?void 0:l.text.resting:null===(c=null==K?void 0:K.highlight)||void 0===c?void 0:c.text.resting,paddingLeft:null===(u=null==$?void 0:$.highlightStyle)||void 0===u?void 0:u.paddingLeftRight,paddingRight:null===(d=null==$?void 0:$.highlightStyle)||void 0===d?void 0:d.paddingLeftRight},null==$?void 0:$.highlightStyle)},e):s.createElement("span",{key:e},e)}))));if(k||B){const e={popover:{trapFocus:!0,withArrow:!1,open:F,onOpenChange:(e,t)=>{P(t.open)},positioning:Object.assign({target:(0,h.ug)(_)},se)},surface:{className:"ms-ecc-callout",style:{padding:0,overflowY:"hidden",borderRadius:Y,backgroundColor:D?null==K?void 0:K.background.hover:null==K?void 0:K.background.resting,boxShadow:ne,cursor:"pointer"}}};return s.createElement("div",{role:"button",tabIndex:-1,onMouseOver:q,onMouseLeave:H,onMouseUp:z,onFocus:q,onBlur:H},s.createElement(u.v,Object.assign({},e),ae))}return s.createElement(c.U,{target:_,directionalHint:ie,isBeakVisible:!1,gapSpace:8,onMouseOver:q,onMouseLeave:H,onMouseUp:z,style:{overflowY:"hidden"},styles:{root:{borderRadius:Y,boxShadow:ne,cursor:"pointer"},calloutMain:{borderRadius:Y,backgroundColor:D?null==K?void 0:K.background.hover:null==K?void 0:K.background.resting}}},ae)})),C=(0,i.F5)({nudgeStateStore:n.A.on(r.V)}),S=(0,v.PA)((()=>{const{nudgeStateStore:e}=(0,i.KN)(C);return e.nudge&&e.nudgeDisplayLocation&&e.nudgeTargetDocumentRef?s.createElement(y,{nudge:e.nudge,inlineNudge:e.enableInlineNudge,insertionCharacter:e.insertionCharacter,nudgeTargetDocumentRef:e.nudgeTargetDocumentRef,nudgeDisplayLocation:e.nudgeDisplayLocation,onAcceptNudgeAction:(t,o)=>{e.onNudgeAccepted(t,o)},onHideNudge:(t,o)=>{e.onNudgeDismiss(t,o)}}):null}))},55429:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CritiqueCallout:()=>i.r,CritiqueCalloutStateStore:()=>n.b,FOOTER_FRE_PAGE_ID:()=>u.Id,FocusZoneId:()=>r.u,FooterFre:()=>g.b,FooterFreModule:()=>y.B,FooterFreStore:()=>h.o,HTMLElementContextualMenuEventHandler:()=>l.U,HTMLElementContextualMenuModule:()=>b.u,IContextualMenuEventHandler:()=>c.I,IPredictionStateStore:()=>T.Tc,InlineSuggestions:()=>f.V,InlineSuggestionsCalloutPortal:()=>m.b,InlineSuggestionsWebUXModule:()=>C.Q,InlineSuggestionsWithCallout:()=>v.$,InsertionPredictionStateStore:()=>x.l,LanguageAutoDetectionFRE:()=>d.a,LanguageAutoDetectionFRECallout:()=>u.sy,LayeredPrediction:()=>I.q,LayeredPredictionStateStore:()=>_.O,MultilingualFre:()=>w.R,MultilingualFreStore:()=>k.S,NudgeCallout:()=>E._,PredictionCoreModule:()=>S.B,PredictionDismissalReason:()=>T.R8,UndoCallout:()=>s.$,UndoCalloutStateStore:()=>a.f,UndoQuerySelectorClass:()=>a.g,critiqueCalloutDeps:()=>i.h,getEccUxReplacement:()=>p.Nt,getEccUxReplacementUX:()=>p.cu,langAutoDetectFooterId:()=>u.lP,undoCalloutDeps:()=>s.v}),3023==o.j)var i=o(67033);if(3023==o.j)var n=o(18102);if(3023==o.j)var r=o(98547);if(3023==o.j)var s=o(99660);if(3023==o.j)var a=o(24855);if(3023==o.j)var l=o(61467);if(3023==o.j)var c=o(42981);if(3023==o.j)var u=o(40555);if(3023==o.j)var d=o(72287);if(3023==o.j)var h=o(64017);if(3023==o.j)var g=o(89058);if(3023==o.j)var p=o(14895);if(3023==o.j)var f=o(38643);if(3023==o.j)var m=o(91427);if(3023==o.j)var v=o(85317);if(3023==o.j)var b=o(77840);if(3023==o.j)var y=o(49313);if(3023==o.j)var C=o(92318);if(3023==o.j)var S=o(87646);if(3023==o.j)var w=o(94086);if(3023==o.j)var k=o(50921);if(3023==o.j)var T=o(34645);if(3023==o.j)var x=o(98541);if(3023==o.j)var I=o(2577);if(3023==o.j)var _=o(98691);if(3023==o.j)var E=o(98218)},31634:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>r}),3023==o.j)var i=o(40712);if(3023==o.j)var n=o(50577);function r(e,t,o){var r=(0,i.w)(e,(function(e){return t===e||e.hasAttribute(n.r)}),o);return null!==r&&r.hasAttribute(n.r)}},79665:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,W:()=>i});const i="data-overflowing",n="data-overflow-group"},31323:(e,t,o)=>{"use strict";function i(e,t){var o;const i=null===(o=e.ownerDocument.defaultView)||void 0===o?void 0:o.ResizeObserver;if(!i)return()=>null;let n=new i(t);return n.observe(e),()=>{null==n||n.disconnect(),n=void 0}}o.d(t,{v:()=>i})},84766:(e,t,o)=>{"use strict";function i(e){let t;return()=>{t||(t=!0,queueMicrotask((()=>{t=!1,e()})))}}o.d(t,{s:()=>i})},87092:(e,t,o)=>{"use strict";if(o.d(t,{A:()=>a}),3023==o.j)var i=o(79665);if(3023==o.j)var n=o(31323);if(3023==o.j)var r=o(84766);if(3023==o.j)var s=o(7586);function a(){const e=new Map;let t,o,a=!1,c=!0;const u={padding:10,overflowAxis:"horizontal",overflowDirection:"end",minimumVisible:0,onUpdateItemVisibility:()=>{},onUpdateOverflow:()=>{}},d={},h={};let g=()=>null;const p=(e,t)=>{const o=e.dequeue();return t.enqueue(o),d[o]},f=l();function m(e,t){if(!e||!t)return 0;const o=d[e],i=d[t];if(o.priority!==i.priority)return o.priority>i.priority?1:-1;const n="end"===u.overflowDirection?Node.DOCUMENT_POSITION_FOLLOWING:Node.DOCUMENT_POSITION_PRECEDING;return o.element.compareDocumentPosition(i.element)&n?1:-1}function v(t,o,i){return e.has(i)||e.set(i,"horizontal"===u.overflowAxis?i[t]:i[o]),e.get(i)}const b=v.bind(null,"offsetWidth","offsetHeight"),y=v.bind(null,"clientWidth","clientHeight"),C=(0,s.w)(((e,t)=>-1*m(e,t))),S=(0,s.w)(m);function w(){return S.all().map((e=>d[e].element)).map(b).reduce(((e,t)=>e+t),0)+Object.entries(f.groupVisibility()).reduce(((e,[t,o])=>e+("hidden"!==o&&h[t]?b(h[t].element):0)),0)+(C.size()>0&&o?b(o):0)}const k=()=>{const e=p(C,S);var t;u.onUpdateItemVisibility({item:e,visible:!0}),e.groupId&&(f.showItem(e.id,e.groupId),f.isSingleItemVisible(e.id,e.groupId)&&(null===(t=h[e.groupId])||void 0===t||t.element.removeAttribute(i.W)))},T=()=>{const e=p(S,C);var t;(u.onUpdateItemVisibility({item:e,visible:!1}),e.groupId)&&(f.isSingleItemVisible(e.id,e.groupId)&&(null===(t=h[e.groupId])||void 0===t||t.element.setAttribute(i.W,"")),f.hideItem(e.id,e.groupId))},x=()=>{((()=>{if(!t)return!1;e.clear();const o=y(t)-u.padding,i=S.peek(),n=C.peek();for(;m(C.peek(),S.peek())>0;)T();for(let e=0;e<2;e++){for(;w()<o&&C.size()>0||1===C.size();)k();for(;w()>o&&S.size()>u.minimumVisible;)T()}return S.peek()!==i||C.peek()!==n})()||c)&&(c=!1,(()=>{const e=S.all(),t=C.all(),o=e.map((e=>d[e])),i=t.map((e=>d[e]));u.onUpdateOverflow({visibleItems:o,invisibleItems:i,groupVisibility:f.groupVisibility()})})())},I=(0,r.s)(x),_=()=>{o=void 0},E=e=>{if(!h[e])return;const t=h[e];t.groupId&&(delete h[e],t.element.removeAttribute(i.Q))},A=t=>{if(!d[t])return;a&&(c=!0);const o=d[t];S.remove(t),C.remove(t),o.groupId&&(f.removeItem(o.id,o.groupId),o.element.removeAttribute(i.Q)),e.delete(o.element),delete d[t],I()};return{addItem:e=>{d[e.id]||(d[e.id]=e,a&&(c=!0,S.enqueue(e.id)),e.groupId&&(f.addItem(e.id,e.groupId),e.element.setAttribute(i.Q,e.groupId)),I())},disconnect:()=>{g(),t=void 0,a=!1,c=!0,Object.keys(d).forEach((e=>A(e))),Object.keys(h).forEach((e=>E(e))),_(),e.clear()},forceUpdate:x,observe:(e,o)=>{Object.assign(u,o),a=!0,Object.values(d).forEach((e=>S.enqueue(e.id))),t=e,g=(0,n.v)(t,(e=>{e[0]&&t&&I()}))},removeItem:A,update:I,addOverflowMenu:e=>{o=e},removeOverflowMenu:_,addDivider:e=>{e.groupId&&!h[e.groupId]&&(e.element.setAttribute(i.Q,e.groupId),h[e.groupId]=e)},removeDivider:E}}const l=()=>{const e={},t={};function o(o){const i=t[o];i.invisibleItemIds.size&&i.visibleItemIds.size?e[o]="overflow":0===i.visibleItemIds.size?e[o]="hidden":e[o]="visible"}return{groupVisibility:()=>e,isSingleItemVisible:(o,i)=>function(t){return"visible"===e[t]||"overflow"===e[t]}(i)&&t[i].visibleItemIds.has(o)&&1===t[i].visibleItemIds.size,addItem(e,i){var n,r,s;null!==(s=(n=t)[r=i])&&void 0!==s||(n[r]={visibleItemIds:new Set,invisibleItemIds:new Set}),t[i].visibleItemIds.add(e),o(i)},removeItem(e,i){t[i].invisibleItemIds.delete(e),t[i].visibleItemIds.delete(e),o(i)},showItem(e,i){t[i].invisibleItemIds.delete(e),t[i].visibleItemIds.add(e),o(i)},hideItem(e,i){t[i].invisibleItemIds.add(e),t[i].visibleItemIds.delete(e),o(i)}}}},7586:(e,t,o)=>{"use strict";function i(e){const t=[];let o=0;const i=e=>Math.floor((e-1)/2),n=(e,o)=>{const i=t[e];t[e]=t[o],t[o]=i},r=i=>{let s=i;const a=(e=>2*e+1)(i),l=(e=>2*e+2)(i);a<o&&e(t[a],t[s])<0&&(s=a),l<o&&e(t[l],t[s])<0&&(s=l),s!==i&&(n(s,i),r(s))};return{all:()=>t.slice(0,o),clear:()=>{o=0},contains:e=>{const i=t.indexOf(e);return i>=0&&i<o},dequeue:()=>{if(0===o)throw new Error("Priority queue empty");const e=t[0];return t[0]=t[--o],r(0),e},enqueue:r=>{t[o++]=r;let s=o-1,a=i(s);for(;s>0&&e(t[a],t[s])>0;)n(a,s),s=a,a=i(s)},peek:()=>0===o?null:t[0],remove:e=>{const i=t.indexOf(e);-1===i||i>=o||(t[i]=t[--o],r(i))},size:()=>o}}o.d(t,{w:()=>i})},94742:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>s}),3023==o.j)var i=o(38991);var n=o(56415),r=o(25920);const s=e=>{const t=n.createContext({value:{current:e},version:{current:-1},listeners:[]});var o;return t.Provider=(o=t.Provider,e=>{const t=n.useRef(e.value),s=n.useRef(0),a=n.useRef();return a.current||(a.current={value:t,version:s,listeners:[]}),(0,i.E)((()=>{t.current=e.value,s.current+=1,(0,r.unstable_runWithPriority)(r.unstable_NormalPriority,(()=>{a.current.listeners.forEach((t=>{t([s.current,e.value])}))}))}),[e.value]),n.createElement(o,{value:a.current},e.children)}),delete t.Consumer,t}},7102:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(83546);if(3023==o.j)var n=o(38991);var r=o(56415);const s=(e,t)=>{const o=r.useContext(e),{value:{current:s},version:{current:a},listeners:l}=o,c=t(s),[u,d]=r.useState([s,c]),h=e=>{d((o=>{if(!e)return[s,c];if(e[0]<=a)return Object.is(o[1],c)?o:[s,c];try{if(Object.is(o[0],e[1]))return o;const i=t(e[1]);return Object.is(o[1],i)?o:[e[1],i]}catch(e){}return[o[0],o[1]]}))};Object.is(u[1],c)||h(void 0);const g=(0,i.D)(h);return(0,n.E)((()=>(l.push(g),()=>{const e=l.indexOf(g);l.splice(e,1)})),[g,l]),u[1]}},39329:(e,t,o)=>{"use strict";o.d(t,{V:()=>n});var i=o(56415);function n(e){const t=i.useContext(e);return!!t.version&&-1!==t.version.current}},40450:(e,t,o)=>{"use strict";o.d(t,{v:()=>s});var i=o(59970),n=o(73023);const r=[{opacity:0},{opacity:1}],s=(0,i.$)({enter:{keyframes:r,easing:n.TV.curveLinear,duration:n.TV.durationGentle},exit:{keyframes:[...r].reverse(),easing:n.TV.curveLinear,duration:n.TV.durationGentle}})},87749:(e,t,o)=>{"use strict";o.d(t,{U:()=>s});var i=o(59970),n=o(73023);const r=[{opacity:0,boxShadow:"0px 0px 0px 0px rgba(0, 0, 0, 0.1)",transform:"scale(0.85) translateZ(0)"},{boxShadow:o(38692).L.shadow64,transform:"scale(1) translateZ(0)",opacity:1}],s=(0,i.$)({enter:{keyframes:r,easing:n.TV.curveDecelerateMid,duration:n.TV.durationGentle},exit:{keyframes:[...r].reverse(),easing:n.TV.curveAccelerateMin,duration:n.TV.durationGentle}})},43458:(e,t,o)=>{"use strict";o.d(t,{l:()=>v});var i=o(56415),n=o(39329),r=o(20331),s=o(26094),a=o(31941),l=o(83546),c=o(37092),u=o(79506),d=o(15067),h=o(87749);var g=o(28022),p=o(80409),f=o(55961),m=o(62548);const v=i.memo((e=>{const t=(e=>{const{children:t,modalType:o="modal",onOpenChange:g,inertTrapFocus:p=!1}=e,[f,m]=function(e){const t=i.Children.toArray(e);switch(t.length){case 2:return t;case 1:return[void 0,t[0]];default:return[void 0,void 0]}}(t),[v,b]=(0,a.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1}),y=(0,l.D)((e=>{null==g||g(e.event,e),e.event.isDefaultPrevented()||b(e.open)})),C=(0,u.c)(v,o),{modalAttributes:S,triggerAttributes:w}=(0,r.y)({trapFocus:"non-modal"!==o,legacyTrapFocus:!p}),k=(0,n.V)(d.MV);return{components:{surfaceMotion:h.U},inertTrapFocus:p,open:v,modalType:o,content:m,trigger:f,requestOpenChange:y,dialogTitleId:(0,c.Bi)("dialog-title-"),isNestedDialog:k,dialogRef:C,modalAttributes:S,triggerAttributes:w,surfaceMotion:(0,s.s)(e.surfaceMotion,{elementType:h.U,defaultProps:{appear:!0,visible:v,unmountOnExit:!0}})}})(e),o=function(e){const{modalType:t,open:o,dialogRef:i,dialogTitleId:n,isNestedDialog:r,inertTrapFocus:s,requestOpenChange:a,modalAttributes:l,triggerAttributes:c}=e;return{dialog:{open:o,modalType:t,dialogRef:i,dialogTitleId:n,isNestedDialog:r,inertTrapFocus:s,modalAttributes:l,triggerAttributes:c,requestOpenChange:a},dialogSurface:!1}}(t);return((e,t)=>((0,p.C)(e),(0,g.Y)(d.Co,{value:t.dialog,children:(0,g.FD)(m.Rc,{value:t.dialogSurface,children:[e.trigger,e.content&&(0,g.Y)(e.surfaceMotion,{children:(0,g.Y)(f.K,{children:e.content})})]})})))(t,o)}));v.displayName="Dialog"},55961:(e,t,o)=>{"use strict";o.d(t,{K:()=>s,Z:()=>r});var i=o(56415);const n=3023==o.j?i.createContext(void 0):null;function r(){return i.useContext(n)}const s=3023==o.j?i.forwardRef(((e,t)=>i.createElement(n.Provider,{value:t},e.children))):null},15067:(e,t,o)=>{"use strict";o.d(t,{Co:()=>a,MV:()=>s,e4:()=>l}),o(56415);var i=o(94742);if(3023==o.j)var n=o(7102);const r={open:!1,inertTrapFocus:!1,modalType:"modal",isNestedDialog:!1,dialogRef:{current:null},requestOpenChange(){}},s=(0,i.q)(void 0),a=s.Provider,l=e=>(0,n.i)(s,((t=r)=>e(t)))},62548:(e,t,o)=>{"use strict";o.d(t,{Rc:()=>i});const i=(0,o(56415).createContext)(void 0).Provider},74997:(e,t,o)=>{"use strict";if(o.d(t,{d:()=>s}),3023==o.j)var i=o(33341);var n=o(56415);if(3023==o.j)var r=o(53825);function s(){const e=(0,r.x)(),t=(0,r.o)(),{targetDocument:o}=(0,i.Y)();return{disableBodyScroll:(0,n.useCallback)((()=>{var i,n;o&&o.body.clientHeight>(null!==(n=null===(i=o.defaultView)||void 0===i?void 0:i.innerHeight)&&void 0!==n?n:0)&&(o.documentElement.classList.add(e),o.body.classList.add(t))}),[o,e,t]),enableBodyScroll:(0,n.useCallback)((()=>{o&&(o.documentElement.classList.remove(e),o.body.classList.remove(t))}),[o,e,t])}}},53825:(e,t,o)=>{"use strict";if(o.d(t,{o:()=>r,x:()=>n}),3023==o.j)var i=o(33899);const n=3023==o.j?(0,i.y)("r6pzz3z",null,[".r6pzz3z{overflow-y:hidden;overflow-y:clip;scrollbar-gutter:stable;}"]):null,r=3023==o.j?(0,i.y)("r144vlu9",null,[".r144vlu9{overflow-y:hidden;}"]):null},79506:(e,t,o)=>{"use strict";o.d(t,{c:()=>s});var i=o(56415);if(3023==o.j)var n=o(12382);if(3023==o.j)var r=o(33341);function s(e,t){const{findFirstFocusable:o}=(0,n.r)(),{targetDocument:s}=(0,r.Y)(),a=i.useRef(null);return i.useEffect((()=>{if(!e)return;const t=a.current&&o(a.current);var i;t?t.focus():null===(i=a.current)||void 0===i||i.focus()}),[o,e,t,s]),a}},81343:(e,t,o)=>{"use strict";o.d(t,{c:()=>f});var i=o(56415),n=o(28022),r=o(80409),s=o(37092),a=o(43452),l=o(51033),c=o(85701),u=o(17226);const d=(0,c.X)({base:{Bt984gj:"f122n59",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bh6795r:"fqerorx",qhf8xq:"f10pi13n",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",fsow6f:"f17mccla",Bcvre1j:"fyl8oag",Br0sdwz:"f16vkdww",Bn78ew0:"fhsnbul",li1rpt:"f1gw3sf2",ap17g6:"f1ly5f7u",B771hl4:"f1s3tz6t"},childless:{susq4k:"f1kyqvp9",Bicfajf:["fzynn9s","f1z0ukd1"],jwcpgy:["fekrn8e","ftdg338"],B4rk6o:"fesgyo"},start:{Bsft5z2:"f13zj6fq"},center:{Ftih45:"f1wl9k8s",Bsft5z2:"f13zj6fq"},end:{Ftih45:"f1wl9k8s"},brand:{sj55zd:"f16muhyy",Bq4z7u6:"fcbuu2a",Bk5zm6e:["f1wdw2dr","f1ttio3w"],Bqjgrrk:"f1582fpk",Bm6vgfq:["f1ttio3w","f1wdw2dr"],B0n5ga8:"f1ahrvm8",s924m2:["f1cd3wbc","f17hbk9y"],B1q35kw:"fvrapl0",Gp14am:["f17hbk9y","f1cd3wbc"]},default:{sj55zd:"fkfq4zb",Bq4z7u6:"f1vccso1",Bk5zm6e:["f1geml7w","fjml6kk"],Bqjgrrk:"f1r7kh1m",Bm6vgfq:["fjml6kk","f1geml7w"],B0n5ga8:"f16j7guv",s924m2:["fx01ahm","fj1a37q"],B1q35kw:"fl8d8yv",Gp14am:["fj1a37q","fx01ahm"]},subtle:{sj55zd:"f11d4kpn",Bq4z7u6:"f5g06un",Bk5zm6e:["f13sxdku","f1n015lb"],Bqjgrrk:"f1x6bl8t",Bm6vgfq:["f1n015lb","f13sxdku"],B0n5ga8:"fvod1wy",s924m2:["fwslg65","flk0e17"],B1q35kw:"f103fvts",Gp14am:["flk0e17","fwslg65"]},strong:{sj55zd:"f19n0e5",Bq4z7u6:"f10tv6oz",Bk5zm6e:["f16xp3sf","f1seuxxq"],Bqjgrrk:"fwrmqbx",Bm6vgfq:["f1seuxxq","f16xp3sf"],B0n5ga8:"ft83z1f",s924m2:["f1g4150c","f192dr6e"],B1q35kw:"f1qnawh6",Gp14am:["f192dr6e","f1g4150c"]}},{d:[".f122n59{align-items:center;}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fqerorx{flex-grow:1;}",".f10pi13n{position:relative;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f17mccla{text-align:center;}",".fyl8oag::before{box-sizing:border-box;}",".f16vkdww::before{display:flex;}",".fhsnbul::before{flex-grow:1;}",".f1gw3sf2::after{box-sizing:border-box;}",".f1ly5f7u::after{display:flex;}",".f1s3tz6t::after{flex-grow:1;}",".f1kyqvp9::before{margin-bottom:0;}",".fzynn9s::before{margin-right:0;}",".f1z0ukd1::before{margin-left:0;}",".fekrn8e::after{margin-left:0;}",".ftdg338::after{margin-right:0;}",".fesgyo::after{margin-top:0;}",'.f13zj6fq::after{content:"";}','.f1wl9k8s::before{content:"";}',".f16muhyy{color:var(--colorBrandForeground1);}",".fcbuu2a::before{border-top-color:var(--colorBrandStroke1);}",".f1wdw2dr::before{border-right-color:var(--colorBrandStroke1);}",".f1ttio3w::before{border-left-color:var(--colorBrandStroke1);}",".f1582fpk::before{border-bottom-color:var(--colorBrandStroke1);}",".f1ahrvm8::after{border-top-color:var(--colorBrandStroke1);}",".f1cd3wbc::after{border-right-color:var(--colorBrandStroke1);}",".f17hbk9y::after{border-left-color:var(--colorBrandStroke1);}",".fvrapl0::after{border-bottom-color:var(--colorBrandStroke1);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f1vccso1::before{border-top-color:var(--colorNeutralStroke2);}",".f1geml7w::before{border-right-color:var(--colorNeutralStroke2);}",".fjml6kk::before{border-left-color:var(--colorNeutralStroke2);}",".f1r7kh1m::before{border-bottom-color:var(--colorNeutralStroke2);}",".f16j7guv::after{border-top-color:var(--colorNeutralStroke2);}",".fx01ahm::after{border-right-color:var(--colorNeutralStroke2);}",".fj1a37q::after{border-left-color:var(--colorNeutralStroke2);}",".fl8d8yv::after{border-bottom-color:var(--colorNeutralStroke2);}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f5g06un::before{border-top-color:var(--colorNeutralStroke3);}",".f13sxdku::before{border-right-color:var(--colorNeutralStroke3);}",".f1n015lb::before{border-left-color:var(--colorNeutralStroke3);}",".f1x6bl8t::before{border-bottom-color:var(--colorNeutralStroke3);}",".fvod1wy::after{border-top-color:var(--colorNeutralStroke3);}",".fwslg65::after{border-right-color:var(--colorNeutralStroke3);}",".flk0e17::after{border-left-color:var(--colorNeutralStroke3);}",".f103fvts::after{border-bottom-color:var(--colorNeutralStroke3);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f10tv6oz::before{border-top-color:var(--colorNeutralStroke1);}",".f16xp3sf::before{border-right-color:var(--colorNeutralStroke1);}",".f1seuxxq::before{border-left-color:var(--colorNeutralStroke1);}",".fwrmqbx::before{border-bottom-color:var(--colorNeutralStroke1);}",".ft83z1f::after{border-top-color:var(--colorNeutralStroke1);}",".f1g4150c::after{border-right-color:var(--colorNeutralStroke1);}",".f192dr6e::after{border-left-color:var(--colorNeutralStroke1);}",".f1qnawh6::after{border-bottom-color:var(--colorNeutralStroke1);}"]}),h=(0,c.X)({base:{a9b677:"fly5x3f",Bdkvgpv:"f163fonl",B0qfbqy:"f51yk4v",pbipgd:"f13rof3u",Bm2nyyq:"f8rth92",xrcqlc:"f6czdpx",i5u598:"f1iyka9k"},inset:{uwmqm3:["fjlbh76","f11qrl6u"],z189sj:["f11qrl6u","fjlbh76"]},start:{Ftih45:"f1wl9k8s",Bicfajf:["f1ojjlep","fk1kexq"],Bxwl2t9:"f1he2m4d",jwcpgy:["f12w1bnb","f1558wlj"]},center:{Bicfajf:["f1ojjlep","fk1kexq"],jwcpgy:["f12w1bnb","f1558wlj"]},end:{Bicfajf:["f1ojjlep","fk1kexq"],Bsft5z2:"f13zj6fq",jwcpgy:["f12w1bnb","f1558wlj"],Iy66sp:"f1ayce8x"}},{d:[".fly5x3f{width:100%;}",".f163fonl::before{border-top-style:solid;}",".f51yk4v::before{border-top-width:var(--strokeWidthThin);}",".f13rof3u::before{min-width:8px;}",".f8rth92::after{border-top-style:solid;}",".f6czdpx::after{border-top-width:var(--strokeWidthThin);}",".f1iyka9k::after{min-width:8px;}",".fjlbh76{padding-left:12px;}",".f11qrl6u{padding-right:12px;}",'.f1wl9k8s::before{content:"";}',".f1ojjlep::before{margin-right:12px;}",".fk1kexq::before{margin-left:12px;}",".f1he2m4d::before{max-width:8px;}",".f12w1bnb::after{margin-left:12px;}",".f1558wlj::after{margin-right:12px;}",'.f13zj6fq::after{content:"";}',".f1ayce8x::after{max-width:8px;}"]}),g=(0,c.X)({base:{Beiy3e4:"f1vx9l62",sshi5w:"f16gbxbe",m598lv:["f1yq6w5o","f1jpmc5p"],B4f6apu:["f9sc749","f1x8pvcy"],zkzzav:"fhkwbjy",Barhvk9:["flthirb","ftkbnf5"],Ihftqj:["f13hvwk3","f1en4csx"],Bde111x:"f19onpk6"},inset:{B6of3ja:"f1xdg43u",jrapky:"f1jlhsmd"},withChildren:{sshi5w:"f1tjaq3g"},start:{Ftih45:"f1wl9k8s",susq4k:"fg2pwug",Bbdr6tz:"fkjtzyi",B4rk6o:"f8vk40g"},center:{susq4k:"fg2pwug",B4rk6o:"f8vk40g"},end:{susq4k:"fg2pwug",Bsft5z2:"f13zj6fq",B4rk6o:"f8vk40g",gn64ia:"fqg5mu5"}},{d:[".f1vx9l62{flex-direction:column;}",".f16gbxbe{min-height:20px;}",".f1yq6w5o::before{border-right-style:solid;}",".f1jpmc5p::before{border-left-style:solid;}",".f9sc749::before{border-right-width:var(--strokeWidthThin);}",".f1x8pvcy::before{border-left-width:var(--strokeWidthThin);}",".fhkwbjy::before{min-height:8px;}",".flthirb::after{border-right-style:solid;}",".ftkbnf5::after{border-left-style:solid;}",".f13hvwk3::after{border-right-width:var(--strokeWidthThin);}",".f1en4csx::after{border-left-width:var(--strokeWidthThin);}",".f19onpk6::after{min-height:8px;}",".f1xdg43u{margin-top:12px;}",".f1jlhsmd{margin-bottom:12px;}",".f1tjaq3g{min-height:84px;}",'.f1wl9k8s::before{content:"";}',".fg2pwug::before{margin-bottom:12px;}",".fkjtzyi::before{max-height:8px;}",".f8vk40g::after{margin-top:12px;}",'.f13zj6fq::after{content:"";}',".fqg5mu5::after{max-height:8px;}"]});var p=o(98121);const f=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{alignContent:o="center",appearance:i="default",inset:n=!1,vertical:r=!1,wrapper:c}=e,u=(0,s.Bi)("divider-");return{alignContent:o,appearance:i,inset:n,vertical:r,components:{root:"div",wrapper:"div"},root:a.Gk((0,l.g)("div",{role:"separator","aria-orientation":r?"vertical":"horizontal","aria-labelledby":e.children?u:void 0,...e,ref:t}),{elementType:"div"}),wrapper:a.Gk(c,{defaultProps:{id:u,children:e.children},elementType:"div"})}})(e,t);return(e=>{const t=d(),o=h(),i=g(),{alignContent:n,appearance:r,inset:s,vertical:a}=e;e.root.className=(0,u.z)("fui-Divider",t.base,t[n],r&&t[r],!a&&o.base,!a&&s&&o.inset,!a&&o[n],a&&i.base,a&&s&&i.inset,a&&i[n],a&&void 0!==e.root.children&&i.withChildren,void 0===e.root.children&&t.childless,e.root.className),e.wrapper&&(e.wrapper.className=(0,u.z)("fui-Divider__wrapper",e.wrapper.className))})(o),(0,p.$e)("useDividerStyles_unstable")(o),(e=>((0,r.C)(e),(0,n.Y)(e.root,{children:void 0!==e.root.children&&(0,n.Y)(e.wrapper,{children:e.root.children})})))(o)}));f.displayName="Divider"},56984:(e,t,o)=>{"use strict";o.d(t,{b:()=>C});var i=o(56415),n=o(98121),r=o(66504),s=o(26094),a=o(43452),l=o(51033),c=o(1357),u=o(80950);const d={active:!0,canRender:!0,ref:i.createRef(),type:"idle"};var h=o(28022),g=o(80409),p=o(33899),f=o(85701),m=o(17226),v=o(13082);const b=(0,p.y)("rkjj3x6",null,[".rkjj3x6{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:relative;}"]),y=(0,f.X)({separatorStart:{h3c5rm:0,vrafjx:0,Bekrc4i:0,u1mtju:["f1cxmi7i","f1j970fk"]},separatorEnd:{zhjwy3:0,wvpqe5:0,ibv6hh:0,B4g9neb:["f1j970fk","f1cxmi7i"]},separatorBottom:{g2u3we:0,icvyot:0,B4j52fo:0,i8vvqc:"f1n3kblk"},start:{},end:{},bottom:{a9b677:"fly5x3f",Bqenvij:"fub80nq"}},{d:[[".f1cxmi7i{border-right:1px solid var(--colorNeutralBackground3);}",{p:-1}],[".f1j970fk{border-left:1px solid var(--colorNeutralBackground3);}",{p:-1}],[".f1j970fk{border-left:1px solid var(--colorNeutralBackground3);}",{p:-1}],[".f1cxmi7i{border-right:1px solid var(--colorNeutralBackground3);}",{p:-1}],[".f1n3kblk{border-top:1px solid var(--colorNeutralBackground3);}",{p:-1}],".fly5x3f{width:100%;}",".fub80nq{height:var(--fui-Drawer--size);}"]}),C=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{size:o,position:i,open:n}=(0,u.y)(e),{separator:r=!1,surfaceMotion:h}=e;return{components:{root:"div",surfaceMotion:c.vk},root:a.Gk((0,l.g)("div",{...e,ref:t}),{elementType:"div"}),open:n,position:i,size:o,separator:r,surfaceMotion:(0,s.s)(h,{elementType:c.vk,defaultProps:{position:i,size:o,visible:n,unmountOnExit:!0}}),motion:d}})(e,t),i=(0,r.X3)();return(e=>{const t=b(),o=(0,v.UT)(e),i=y();e.root.className=(0,m.z)("fui-InlineDrawer",t,o,function(e,t){if(e.separator)switch(e.position){case"start":return t.separatorStart;case"end":return t.separatorEnd;case"bottom":return t.separatorBottom;default:return}}(e,i),i[e.position],e.root.className)})(o),(0,n.$e)("useDrawerInlineStyles_unstable")(o),(0,n.$e)("useInlineDrawerStyles_unstable")(o),((e,t)=>((0,g.C)(e),(0,h.Y)(r.Th,{value:t,children:(0,h.Y)(e.surfaceMotion,{children:(0,h.Y)(e.root,{})})})))(o,i)}));C.displayName="InlineDrawer"},85640:(e,t,o)=>{"use strict";o.d(t,{e:()=>S});var i=o(56415),n=o(98121),r=o(66504),s=o(43458),a=o(43452),l=o(1357),c=o(80950),u=o(11057),d=o(91193);const h={active:!0,canRender:!0,ref:i.createRef(),type:"idle"};var g=o(28022),p=o(80409),f=o(33899),m=o(85701),v=o(17226),b=o(13082);const y=(0,f.y)("r7dfyj8","rmx02j7",{r:[".r7dfyj8{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:fixed;top:0;bottom:0;}",".r7dfyj8:focus{outline-style:none;}",".r7dfyj8:focus-visible{outline-style:none;}",".r7dfyj8[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.r7dfyj8[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".rmx02j7{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:fixed;top:0;bottom:0;}",".rmx02j7:focus{outline-style:none;}",".rmx02j7:focus-visible{outline-style:none;}",".rmx02j7[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.rmx02j7[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:["@media (forced-colors: active){.r7dfyj8[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}","@media (forced-colors: active){.rmx02j7[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),C=(0,m.X)({start:{},end:{},bottom:{Bhzewxz:"f198g47y",Bqenvij:"fub80nq",a9b677:"fr97h3j"}},{d:[".f198g47y{top:auto;}",".fub80nq{height:var(--fui-Drawer--size);}",".fr97h3j{width:100vw;}"]}),S=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{open:o,size:i,position:n}=(0,c.y)(e),{backdropMotion:r,modalType:g="modal",inertTrapFocus:p,onOpenChange:f,surfaceMotion:m}=e,v=a.Gf(e.backdrop),b="non-modal"!==g&&null!==v,y=a.Gk({...e,ref:t,backdrop:b?{...v}:null,backdropMotion:(0,d.b)(r,l.oc,{size:i})},{elementType:u.j}),C=a.Gk({open:o,onOpenChange:f,inertTrapFocus:p,modalType:g,surfaceMotion:(0,d.b)(m,l.Ab,{position:n,size:i}),children:null},{elementType:s.l});return{components:{root:u.j,dialog:s.l},root:y,dialog:C,open:o,size:i,position:n,motion:h}})(e,t),i=(0,r.X3)();return(e=>{const t=(0,b.UT)(e),o=y(),i=C(),n=e.root.backdrop;e.root.className=(0,v.z)("fui-OverlayDrawer",t,o,i[e.position],e.root.className),n&&(n.className=(0,v.z)("fui-OverlayDrawer__backdrop",n.className))})(o),(0,n.$e)("useDrawerOverlayStyles_unstable")(o),(0,n.$e)("useOverlayDrawerStyles_unstable")(o),((e,t)=>((0,p.C)(e),(0,g.Y)(r.Th,{value:t,children:(0,g.Y)(e.dialog,{children:(0,g.Y)(e.root,{})})})))(o,i)}));S.displayName="OverlayDrawer"},11057:(e,t,o)=>{"use strict";o.d(t,{j:()=>x});var i=o(56415),n=o(54544),r=o(26094),s=o(83546),a=o(82169),l=o(43452),c=o(38991),u=o(51033),d=o(46279),h=o(15067),g=o(74997),p=o(40450),f=o(55961),m=o(28022),v=o(657),b=o(80409),y=o(62548),C=o(33899),S=o(85701),w=o(17226);const k=(0,C.y)("rmnljus",null,[".rmnljus{inset:0px;position:fixed;background-color:rgba(0, 0, 0, 0.4);}"]),T=(0,S.X)({nested:{De3pzq:"f1c21dwh"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}"]}),x=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,f.Z)(),i=(0,h.e4)((e=>e.modalType)),m=(0,h.e4)((e=>e.isNestedDialog)),v=(0,h.e4)((e=>e.modalAttributes)),b=(0,h.e4)((e=>e.dialogRef)),y=(0,h.e4)((e=>e.requestOpenChange)),C=(0,h.e4)((e=>e.dialogTitleId)),S=(0,h.e4)((e=>e.open)),w=(0,s.D)((t=>{var o,n;(0,a.g)(e.backdrop)&&(null===(o=(n=e.backdrop).onClick)||void 0===o||o.call(n,t)),"modal"!==i||t.isDefaultPrevented()||y({event:t,open:!1,type:"backdropClick"})})),k=(0,s.D)((t=>{var o;null===(o=e.onKeyDown)||void 0===o||o.call(e,t),t.key!==n.uf9||t.isDefaultPrevented()||(y({event:t,open:!1,type:"escapeKeyDown"}),t.preventDefault())})),T=l.lq(e.backdrop,{renderByDefault:"non-modal"!==i,defaultProps:{"aria-hidden":"true"},elementType:"div"});T&&(T.onClick=w);const{disableBodyScroll:x,enableBodyScroll:I}=(0,g.d)();return(0,c.E)((()=>{if(!m&&"non-modal"!==i)return x(),()=>{I()}}),[I,m,x,i]),{components:{backdrop:"div",root:"div",backdropMotion:p.v},open:S,backdrop:T,isNestedDialog:m,mountNode:e.mountNode,root:l.Gk((0,u.g)("div",{tabIndex:-1,"aria-modal":"non-modal"!==i,role:"alert"===i?"alertdialog":"dialog","aria-labelledby":e["aria-label"]?void 0:C,...e,...v,onKeyDown:k,ref:(0,d.a)(t,o,b)}),{elementType:"div"}),backdropMotion:(0,r.s)(e.backdropMotion,{elementType:p.v,defaultProps:{appear:!0,visible:S}}),transitionStatus:void 0}})({...e,as:e.as},t);return(e=>{const t=k(),o=T();e.backdrop&&(e.backdrop.className=(0,w.z)(t,e.isNestedDialog&&o.nested,e.backdrop.className))})(o),i=o,C={dialogSurface:!0},(0,b.C)(i),(0,m.FD)(v.Z,{mountNode:i.mountNode,children:[i.backdrop&&(0,m.Y)(i.backdropMotion,{children:(0,m.Y)(i.backdrop,{})}),(0,m.Y)(y.Rc,{value:C.dialogSurface,children:(0,m.Y)(i.root,{})})]});var i,C}));x.displayName="OverlayDrawerSurface"},66504:(e,t,o)=>{"use strict";o.d(t,{Th:()=>s,X3:()=>l,ls:()=>a});var i=o(56415);const n={scrollState:"none",setScrollState:()=>({})},r=i.createContext(void 0),s=r.Provider,a=()=>{var e;return null!==(e=i.useContext(r))&&void 0!==e?e:n},l=()=>{const[e,t]=i.useState("none");return{setScrollState:t,scrollState:e}}},91193:(e,t,o)=>{"use strict";o.d(t,{b:()=>n});var i=o(56415);function n(e,t,o){return null===e?null:{...e,children:(n,r)=>(null==e?void 0:e.children)?e.children(t,{...r,...o}):i.createElement(t,{...r,...o},r.children)}}},1357:(e,t,o)=>{"use strict";o.d(t,{Ab:()=>c,oc:()=>u,vk:()=>l});var i=o(73023),n=o(59970),r=o(38692),s=o(13082);const a={small:i.TV.durationGentle,medium:i.TV.durationSlow,large:i.TV.durationSlower,full:i.TV.durationUltraSlow},l=(0,n.$)((({position:e,size:t})=>{const o=[{..."start"===e&&{transform:`translate3d(calc(var(${s.pS.drawerSizeVar}) * -1), 0, 0)`},..."end"===e&&{transform:`translate3d(var(${s.pS.drawerSizeVar}), 0, 0)`},..."bottom"===e&&{transform:`translate3d(0, var(${s.pS.drawerSizeVar}), 0)`},opacity:0},{transform:"translate3d(0, 0, 0)",opacity:1}],n=a[t];return{enter:{keyframes:o,duration:n,easing:i.TV.curveDecelerateMid},exit:{keyframes:[...o].reverse(),duration:n,easing:i.TV.curveAccelerateMin}}})),c=(0,n.$)((({position:e,size:t})=>{const o=[{..."start"===e&&{transform:`translate3D(calc(var(${s.pS.drawerSizeVar}) * -1), 0, 0)`},..."end"===e&&{transform:`translate3d(calc(var(${s.pS.drawerSizeVar}) * 1), 0, 0)`},..."bottom"===e&&{transform:`translate3d(0, calc(var(${s.pS.drawerSizeVar}) * 1), 0)`},boxShadow:`0px ${r.L.colorTransparentBackground}`,opacity:0},{transform:"translate3d(0, 0, 0)",boxShadow:r.L.shadow64,opacity:1}],n=a[t];return{enter:{keyframes:o,duration:n,easing:i.TV.curveDecelerateMid},exit:{keyframes:[...o].reverse(),duration:n,easing:i.TV.curveAccelerateMin}}})),u=(0,n.$)((({size:e})=>{const t=[{opacity:0},{opacity:1}],o=a[e];return{enter:{keyframes:t,easing:i.TV.curveLinear,duration:o},exit:{keyframes:[...t].reverse(),easing:i.TV.curveLinear,duration:o}}}))},13082:(e,t,o)=>{"use strict";o.d(t,{UT:()=>c,pS:()=>s});var i=o(85701);if(3023==o.j)var n=o(17226);var r=o(38692);const s={drawerSizeVar:"--fui-Drawer--size"},a=(s.drawerSizeVar,r.L.colorNeutralBackground1,r.L.colorNeutralForeground1,(0,i.X)({start:{h3c5rm:0,vrafjx:0,Bekrc4i:0,u1mtju:["f1xteiwb","fsqykmd"],oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["fvfyk4","frppm18"]},end:{zhjwy3:0,wvpqe5:0,ibv6hh:0,B4g9neb:["fsqykmd","f1xteiwb"],j35jbq:["f1e31b4d","f1vgc2s3"],oyh7mz:["frppm18","fvfyk4"]},bottom:{B5kzvoi:"f1yab3r1",Bhzewxz:"f198g47y"},small:{Bjr0ffy:"f1exhnwo"},medium:{Bjr0ffy:"fqofjzu"},large:{Bjr0ffy:"fce6y3m"},full:{Bjr0ffy:"fsdmzs6"}},{d:[[".f1xteiwb{border-right:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],[".fsqykmd{border-left:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".fvfyk4{right:auto;}",".frppm18{left:auto;}",[".fsqykmd{border-left:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],[".f1xteiwb{border-right:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],".f1yab3r1{bottom:0;}",".f198g47y{top:auto;}",".f1exhnwo{--fui-Drawer--size:320px;}",".fqofjzu{--fui-Drawer--size:592px;}",".fce6y3m{--fui-Drawer--size:940px;}",".fsdmzs6{--fui-Drawer--size:100vw;}"]})),l=(0,i.X)({small:{Bjr0ffy:"f1exhnwo"},medium:{Bjr0ffy:"fqofjzu"},large:{Bjr0ffy:"fce6y3m"},full:{Bjr0ffy:"fno8cgj"}},{d:[".f1exhnwo{--fui-Drawer--size:320px;}",".fqofjzu{--fui-Drawer--size:592px;}",".fce6y3m{--fui-Drawer--size:940px;}",".fno8cgj{--fui-Drawer--size:100vh;}"]}),c=({position:e,size:t})=>{const o=a(),i=l();return(0,n.z)(o[e],"bottom"===e&&i[t],"bottom"!==e&&o[t])}},80950:(e,t,o)=>{"use strict";function i(e){const{open:t=!1,size:o="small",position:i="start"}=e;return{size:o,position:i,open:t}}o.d(t,{y:()=>i})},27873:(e,t,o)=>{"use strict";o.d(t,{o:()=>r});var i=o(56415);const n=i.createContext(void 0),r=(n.Provider,()=>i.useContext(n))},6722:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>n}),3023==o.j)var i=o(27873);function n(e,t){return function(e,t,o){if(!e)return t;t={...t};const{generatedControlId:i,hintId:n,labelFor:r,labelId:s,required:a,validationMessageId:l,validationState:c}=e;var u,d,h,g,p,f,m,v,b,y,C,S,w;(i&&(null!==(d=(u=t).id)&&void 0!==d||(u.id=i)),!s||(null==o?void 0:o.supportsLabelFor)&&r===t.id||null!==(p=(h=t)[g="aria-labelledby"])&&void 0!==p||(h[g]=s),(l||n)&&(t["aria-describedby"]=[l,n,null==t?void 0:t["aria-describedby"]].filter(Boolean).join(" ")),"error"===c&&(null!==(m=(f=t)["aria-invalid"])&&void 0!==m||(f["aria-invalid"]=!0)),a)&&((null==o?void 0:o.supportsRequired)?null!==(C=(y=t).required)&&void 0!==C||(y.required=!0):null!==(w=(S=t)["aria-required"])&&void 0!==w||(S["aria-required"]=!0));return(null==o?void 0:o.supportsSize)&&(null!==(b=(v=t).size)&&void 0!==b||(v.size=e.size)),t}((0,i.o)(),e,t)}},76455:(e,t,o)=>{"use strict";o.d(t,{R:()=>F});var i,n=o(73027),r=o(56415),s=o(67056),a=o(43910),l=o(74004),c=o(94780),u=o(83592),d=o(27293),h=o(73449),g=o(37918),p=o(9190),f=o(92090),m=o(43416),v=o(55246),b=o(31634),y=o(97117),C=o(49288),S=o(62421),w=o(33980),k="data-is-focusable",T="data-focuszone-id",x="tabindex",I="data-no-vertical-wrap",_="data-no-horizontal-wrap",E=999999999,A=-999999999;function R(e,t){var o;"function"==typeof MouseEvent?o=new MouseEvent("click",{ctrlKey:null==t?void 0:t.ctrlKey,metaKey:null==t?void 0:t.metaKey,shiftKey:null==t?void 0:t.shiftKey,altKey:null==t?void 0:t.altKey,bubbles:null==t?void 0:t.bubbles,cancelable:null==t?void 0:t.cancelable}):(o=document.createEvent("MouseEvents")).initMouseEvent("click",!!t&&t.bubbles,!!t&&t.cancelable,window,0,0,0,0,0,!!t&&t.ctrlKey,!!t&&t.altKey,!!t&&t.shiftKey,!!t&&t.metaKey,0,null),e.dispatchEvent(o)}var B={},M=new Set,D=["text","number","password","email","tel","url","search","textarea"],O=!1,F=function(e){function t(o){var i,n,p,f,m=this;(m=e.call(this,o)||this)._root=r.createRef(),m._mergedRef=(0,a.K)(),m._onFocus=function(e){var t;if(!m._portalContainsElement(e.target)){var o,i=(t=m.props).onActiveElementChanged,n=t.doNotAllowFocusEventToPropagate,r=t.stopFocusPropagation,s=t.onFocusNotification,a=t.onFocus,u=t.shouldFocusInnerElementWhenReceivedFocus,d=t.defaultTabbableElement,h=m._isImmediateDescendantOfZone(e.target);if(h)o=e.target;else for(var g=e.target;g&&g!==m._root.current;){if((0,l.S0)(g,void 0,m._inShadowRoot)&&m._isImmediateDescendantOfZone(g)){o=g;break}g=(0,c.P)(g,O)}if(u&&e.target===m._root.current){var p=d&&"function"==typeof d&&m._root.current&&d(m._root.current);p&&(0,l.S0)(p,void 0,m._inShadowRoot)?(o=p,p.focus()):(m.focus(!0),m._activeElement&&(o=null))}var f=!m._activeElement;o&&o!==m._activeElement&&((h||f)&&m._setFocusAlignment(o,!0,!0),m._activeElement=o,f&&m._updateTabIndexes()),i&&i(m._activeElement,e),(r||n)&&e.stopPropagation(),a?a(e):s&&s()}},m._onBlur=function(){m._setParkedFocus(!1)},m._onMouseDown=function(e){if(!m._portalContainsElement(e.target)&&!m.props.disabled){for(var t=e.target,o=[];t&&t!==m._root.current;)o.push(t),t=(0,c.P)(t,O);for(;o.length&&((t=o.pop())&&(0,l.S0)(t,void 0,m._inShadowRoot)&&m._setActiveElement(t,!0),!(0,l.HC)(t)););}},m._onKeyDown=function(e,t){var o;if(!m._portalContainsElement(e.target)){var i=(o=m.props).direction,n=o.disabled,r=o.isInnerZoneKeystroke,a=o.pagingSupportDisabled,c=o.shouldEnterInnerZone;if(!(n||(m.props.onKeyDown&&m.props.onKeyDown(e),e.isDefaultPrevented()||m._getDocument().activeElement===m._root.current&&m._isInnerZone))){if((c&&c(e)||r&&r(e))&&m._isImmediateDescendantOfZone(e.target)){var h=m._getFirstInnerZone();if(h){if(!h.focus(!0))return}else{if(!(0,l.Z5)(e.target))return;if(!m.focusElement((0,l.eX)(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case u.c.space:if(m._shouldRaiseClicksOnSpace&&m._tryInvokeClickForFocusable(e.target,e))break;return;case u.c.left:if(i!==s.E.vertical&&(m._preventDefaultWhenHandled(e),m._moveFocusLeft(t)))break;return;case u.c.right:if(i!==s.E.vertical&&(m._preventDefaultWhenHandled(e),m._moveFocusRight(t)))break;return;case u.c.up:if(i!==s.E.horizontal&&(m._preventDefaultWhenHandled(e),m._moveFocusUp()))break;return;case u.c.down:if(i!==s.E.horizontal&&(m._preventDefaultWhenHandled(e),m._moveFocusDown()))break;return;case u.c.pageDown:if(!a&&m._moveFocusPaging(!0))break;return;case u.c.pageUp:if(!a&&m._moveFocusPaging(!1))break;return;case u.c.tab:if(m.props.allowTabKey||m.props.handleTabKey===s.l.all||m.props.handleTabKey===s.l.inputOnly&&m._isElementInput(e.target)){var g=!1;if(m._processingTabKey=!0,g=i!==s.E.vertical&&m._shouldWrapFocus(m._activeElement,_)?((0,d.jI)(t)?!e.shiftKey:e.shiftKey)?m._moveFocusLeft(t):m._moveFocusRight(t):e.shiftKey?m._moveFocusUp():m._moveFocusDown(),m._processingTabKey=!1,g)break;m.props.shouldResetActiveElementWhenTabFromZone&&(m._activeElement=null)}return;case u.c.home:if(m._isContentEditableElement(e.target)||m._isElementInput(e.target)&&!m._shouldInputLoseFocus(e.target,!1))return!1;var p=m._root.current&&m._root.current.firstChild;if(m._root.current&&p&&m.focusElement((0,l.eX)(m._root.current,p,!0)))break;return;case u.c.end:if(m._isContentEditableElement(e.target)||m._isElementInput(e.target)&&!m._shouldInputLoseFocus(e.target,!0))return!1;var f=m._root.current&&m._root.current.lastChild;if(m._root.current&&m.focusElement((0,l.yv)(m._root.current,f,!0,!0,!0)))break;return;case u.c.enter:if(m._shouldRaiseClicksOnEnter&&m._tryInvokeClickForFocusable(e.target,e))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}},m._getHorizontalDistanceFromCenter=function(e,t,o){var i=m._focusAlignment.left||m._focusAlignment.x||0,n=Math.floor(o.top),r=Math.floor(t.bottom),s=Math.floor(o.bottom),a=Math.floor(t.top);return e&&n>r||!e&&s<a?i>=o.left&&i<=o.left+o.width?0:Math.abs(o.left+o.width/2-i):m._shouldWrapFocus(m._activeElement,I)?E:A},(0,h.f)(m),m._id=(0,g.O)("FocusZone"),m._focusAlignment={left:0,top:0},m._processingTabKey=!1;var v=null===(n=null!==(i=o.shouldRaiseClicks)&&void 0!==i?i:t.defaultProps.shouldRaiseClicks)||void 0===n||n;return m._shouldRaiseClicksOnEnter=null!==(p=o.shouldRaiseClicksOnEnter)&&void 0!==p?p:v,m._shouldRaiseClicksOnSpace=null!==(f=o.shouldRaiseClicksOnSpace)&&void 0!==f?f:v,m}return(0,n.C6)(t,e),t.getOuterZones=function(){return M.size},t._onKeyDownCapture=function(e){e.which===u.c.tab&&M.forEach((function(e){return e._updateTabIndexes()}))},t.prototype.componentDidMount=function(){var e,o=this._root.current;if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),B[this._id]=this,o){for(var i=(0,c.P)(o,O);i&&i!==this._getDocument().body&&1===i.nodeType;){if((0,l.HC)(i)){this._isInnerZone=!0;break}i=(0,c.P)(i,O)}this._isInnerZone||(M.add(this),this._root.current&&this._root.current.addEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},t.prototype.componentDidUpdate=function(){var e,t=this._root.current,o=this._getDocument();if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),(this._activeElement&&!(0,p.s)(this._root.current,this._activeElement,O)||this._defaultFocusElement&&!(0,p.s)(this._root.current,this._defaultFocusElement,O))&&(this._activeElement=null,this._defaultFocusElement=null,this._updateTabIndexes()),!this.props.preventFocusRestoration&&o&&this._lastIndexPath&&(o.activeElement===o.body||null===o.activeElement||o.activeElement===t)){var i=(0,l.nA)(t,this._lastIndexPath);i?(this._setActiveElement(i,!0),i.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},t.prototype.componentWillUnmount=function(){delete B[this._id],this._isInnerZone||(M.delete(this),this._root.current&&this._root.current.removeEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},t.prototype.render=function(){var e,t=this,o=(e=this.props).as,s=e.elementType,a=e.rootProps,l=e.ariaDescribedBy,c=e.ariaLabelledBy,u=e.className,d=(0,f.G1)(this.props,f.vt),h=o||s||"div";this._evaluateFocusBeforeRender();var g=(0,w.O4)();return r.createElement(h,(0,n.Cl)({"aria-labelledby":c,"aria-describedby":l},d,a,{className:(0,m.A)((i||(i=(0,S.Z)({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),i),u),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(e){return t._onKeyDown(e,g)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},t.prototype.focus=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._root.current){if(!e&&"true"===this._root.current.getAttribute(k)&&this._isInnerZone){var o=this._getOwnerZone(this._root.current);if(o!==this._root.current){var i=B[o.getAttribute(T)];return!!i&&i.focusElement(this._root.current)}return!1}if(!e&&this._activeElement&&(0,p.s)(this._root.current,this._activeElement)&&(0,l.S0)(this._activeElement,void 0,this._inShadowRoot)&&(!t||(0,l.F2)(this._activeElement)))return this._activeElement.focus(),!0;var n=this._root.current.firstChild;return this.focusElement((0,l.eX)(this._root.current,n,!0,void 0,void 0,void 0,void 0,void 0,t))}return!1},t.prototype.focusLast=function(){if(this._root.current){var e=this._root.current&&this._root.current.lastChild;return this.focusElement((0,l.yv)(this._root.current,e,!0,!0,!0))}return!1},t.prototype.focusElement=function(e,t){var o,i=(o=this.props).onBeforeFocus,n=o.shouldReceiveFocus;return!(n&&!n(e)||i&&!i(e)||!e||(this._setActiveElement(e,t),this._activeElement&&this._activeElement.focus(),0))},t.prototype.setFocusAlignment=function(e){this._focusAlignment=e},Object.defineProperty(t.prototype,"defaultFocusElement",{get:function(){return this._defaultFocusElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeElement",{get:function(){return this._activeElement},enumerable:!1,configurable:!0}),t.prototype._evaluateFocusBeforeRender=function(){var e=this._root.current,t=this._getDocument();if(t){var o=t.activeElement;if(o!==e){var i=(0,p.s)(e,o,!1);this._lastIndexPath=i?(0,l.Ep)(e,o):void 0}}},t.prototype._setParkedFocus=function(e){var t=this._root.current;t&&this._isParked!==e&&(this._isParked=e,e?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},t.prototype._setActiveElement=function(e,t){var o=this._activeElement;this._activeElement=e,o&&((0,l.HC)(o)&&this._updateTabIndexes(o),o.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)},t.prototype._preventDefaultWhenHandled=function(e){this.props.preventDefaultWhenHandled&&e.preventDefault()},t.prototype._tryInvokeClickForFocusable=function(e,t){var o=e;if(o===this._root.current)return!1;do{if("BUTTON"===o.tagName||"A"===o.tagName||"INPUT"===o.tagName||"TEXTAREA"===o.tagName||"SUMMARY"===o.tagName)return!1;if(this._isImmediateDescendantOfZone(o)&&"true"===o.getAttribute(k)&&"true"!==o.getAttribute("data-disable-click-on-enter"))return R(o,t),!0;o=(0,c.P)(o,O)}while(o!==this._root.current);return!1},t.prototype._getFirstInnerZone=function(e){if(!(e=e||this._activeElement||this._root.current))return null;if((0,l.HC)(e))return B[e.getAttribute(T)];for(var t=e.firstElementChild;t;){if((0,l.HC)(t))return B[t.getAttribute(T)];var o=this._getFirstInnerZone(t);if(o)return o;t=t.nextElementSibling}return null},t.prototype._moveFocus=function(e,t,o,i){void 0===i&&(i=!0);var n=this._activeElement,r=-1,a=void 0,c=!1,u=this.props.direction===s.E.bidirectional;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,e))return!1;var d=u?n.getBoundingClientRect():null;do{if(n=e?(0,l.eX)(this._root.current,n):(0,l.yv)(this._root.current,n),!u){a=n;break}if(n){var h=t(d,n.getBoundingClientRect());if(-1===h&&-1===r){a=n;break}if(h>-1&&(-1===r||h<r)&&(r=h,a=n),r>=0&&h<0)break}}while(n);if(a&&a!==this._activeElement)c=!0,this.focusElement(a);else if(this.props.isCircularNavigation&&i)return e?this.focusElement((0,l.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,l.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return c},t.prototype._moveFocusDown=function(){var e=this,t=-1,o=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(i,n){var r=-1,s=Math.floor(n.top),a=Math.floor(i.bottom);return s<a?e._shouldWrapFocus(e._activeElement,I)?E:A:((-1===t&&s>=a||s===t)&&(t=s,r=o>=n.left&&o<=n.left+n.width?0:Math.abs(n.left+n.width/2-o)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusUp=function(){var e=this,t=-1,o=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(i,n){var r=-1,s=Math.floor(n.bottom),a=Math.floor(n.top),l=Math.floor(i.top);return s>l?e._shouldWrapFocus(e._activeElement,I)?E:A:((-1===t&&s<=l||a===t)&&(t=a,r=o>=n.left&&o<=n.left+n.width?0:Math.abs(n.left+n.width/2-o)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusLeft=function(e){var t=this,o=this._shouldWrapFocus(this._activeElement,_);return!!this._moveFocus((0,d.jI)(e),(function(i,n){var r=-1;return((0,d.jI)(e)?parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)):parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)))&&n.right<=i.right&&t.props.direction!==s.E.vertical?r=i.right-n.right:o||(r=A),r}),void 0,o)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusRight=function(e){var t=this,o=this._shouldWrapFocus(this._activeElement,_);return!!this._moveFocus(!(0,d.jI)(e),(function(i,n){var r=-1;return((0,d.jI)(e)?parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)):parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)))&&n.left>=i.left&&t.props.direction!==s.E.vertical?r=n.left-i.left:o||(r=A),r}),void 0,o)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusPaging=function(e,t){void 0===t&&(t=!0);var o=this._activeElement;if(!o||!this._root.current)return!1;if(this._isElementInput(o)&&!this._shouldInputLoseFocus(o,e))return!1;var i=(0,v.Hc)(o);if(!i)return!1;var n=-1,r=void 0,s=-1,a=-1,c=i.clientHeight,u=o.getBoundingClientRect();do{if(o=e?(0,l.eX)(this._root.current,o):(0,l.yv)(this._root.current,o)){var d=o.getBoundingClientRect(),h=Math.floor(d.top),g=Math.floor(u.bottom),p=Math.floor(d.bottom),f=Math.floor(u.top),m=this._getHorizontalDistanceFromCenter(e,u,d);if(e&&h>g+c||!e&&p<f-c)break;m>-1&&(e&&h>s?(s=h,n=m,r=o):!e&&p<a?(a=p,n=m,r=o):(-1===n||m<=n)&&(n=m,r=o))}}while(o);var b=!1;if(r&&r!==this._activeElement)b=!0,this.focusElement(r),this._setFocusAlignment(r,!1,!0);else if(this.props.isCircularNavigation&&t)return e?this.focusElement((0,l.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,l.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return b},t.prototype._setFocusAlignment=function(e,t,o){if(this.props.direction===s.E.bidirectional&&(!this._focusAlignment||t||o)){var i=e.getBoundingClientRect(),n=i.left+i.width/2,r=i.top+i.height/2;this._focusAlignment||(this._focusAlignment={left:n,top:r}),t&&(this._focusAlignment.left=n),o&&(this._focusAlignment.top=r)}},t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this._root.current},t.prototype._getOwnerZone=function(e){for(var t=(0,c.P)(e,O);t&&t!==this._root.current&&t!==this._getDocument().body;){if((0,l.HC)(t))return t;t=(0,c.P)(t,O)}return t},t.prototype._updateTabIndexes=function(e){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!e&&this._root.current&&(this._defaultFocusElement=null,e=this._root.current,this._activeElement&&!(0,p.s)(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!(0,l.S0)(this._activeElement,void 0,this._inShadowRoot)&&(this._activeElement=null);for(var t=e&&e.children,o=0;t&&o<t.length;o++){var i=t[o];(0,l.HC)(i)?"true"===i.getAttribute(k)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(x)&&i.setAttribute(x,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(x)&&i.setAttribute(x,"0"))):(i.getAttribute&&"false"===i.getAttribute(k)&&i.setAttribute(x,"-1"),(0,l.S0)(i,void 0,this._inShadowRoot)?this.props.disabled?i.setAttribute(x,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(x)&&i.setAttribute(x,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(x)&&i.setAttribute(x,"0")):"svg"===i.tagName&&"false"!==i.getAttribute("focusable")&&i.setAttribute("focusable","false")),this._updateTabIndexes(i)}},t.prototype._isContentEditableElement=function(e){return e&&"true"===e.getAttribute("contenteditable")},t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())},t.prototype._shouldInputLoseFocus=function(e,t){if(!this._processingTabKey&&e&&e.type&&D.indexOf(e.type.toLowerCase())>-1){var o=e.selectionStart,i=o!==e.selectionEnd,n=e.value,r=e.readOnly;if(i||o>0&&!t&&!r||o!==n.length&&t&&!r||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(e)))return!1}return!0},t.prototype._shouldWrapFocus=function(e,t){return!this.props.checkForNoWrap||(0,l._l)(e,t)},t.prototype._portalContainsElement=function(e){return e&&!!this._root.current&&(0,b.s)(e,this._root.current)},t.prototype._getDocument=function(){return(0,y.Y)(this._root.current)},t.contextType=C.c,t.defaultProps={isCircularNavigation:!1,direction:s.E.bidirectional,shouldRaiseClicks:!0,"data-tabster":'{"uncontrolled": {}}'},t}(r.Component)},67056:(e,t,o)=>{"use strict";o.d(t,{E:()=>i,l:()=>n});var i,n={none:0,all:1,inputOnly:2};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(i||(i={}))},94520:(e,t,o)=>{"use strict";o.d(t,{B:()=>r});var i=o(56415);if(3023==o.j)var n=o(37918);function r(e,t){var o=i.useRef(t);return o.current||(o.current=(0,n.O)(e)),o.current}},61888:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var i=o(56415);function n(e){var t=(0,i.useRef)();return(0,i.useEffect)((function(){t.current=e})),t.current}},36115:(e,t,o)=>{"use strict";o.d(t,{MOA:()=>s,afj:()=>a,p2N:()=>n,tNe:()=>r});var i=o(63233);const n=3023==o.j?(0,i.U)("PersonFeedback20Filled","20",["M10.5 12c.83 0 1.5.67 1.5 1.5v.5c0 1.97-1.86 4-5 4-3.14 0-5-2.03-5-4v-.5c0-.83.67-1.5 1.5-1.5h7ZM7 5.5A2.75 2.75 0 1 1 7 11a2.75 2.75 0 0 1 0-5.5ZM16 2a2 2 0 0 1 2 1.85V6a2 2 0 0 1-1.85 2H14.5l-1.2 1.6a1 1 0 0 1-1.78-.38l-.01-.1V9l-.01-1.07-.08-.01a2 2 0 0 1-1.4-1.6l-.01-.17L10 6V4a2 2 0 0 1 1.85-2H16Z"]):null,r=3023==o.j?(0,i.U)("PersonFeedback20Regular","20",["M10.5 12c.83 0 1.5.67 1.5 1.5v.5c0 1.97-1.86 4-5 4-3.14 0-5-2.03-5-4v-.5c0-.83.67-1.5 1.5-1.5h7Zm0 1h-7a.5.5 0 0 0-.5.5v.5c0 1.44 1.43 3 4 3 2.57 0 4-1.56 4-3v-.5a.5.5 0 0 0-.5-.5ZM7 5.5A2.75 2.75 0 1 1 7 11a2.75 2.75 0 0 1 0-5.5ZM16 2a2 2 0 0 1 2 1.85V6a2 2 0 0 1-1.85 2H14.5l-1.2 1.6a1 1 0 0 1-1.78-.38l-.01-.1V9l-.01-1.07-.08-.01a2 2 0 0 1-1.4-1.6l-.01-.17L10 6V4a2 2 0 0 1 1.85-2H16ZM7 6.5A1.75 1.75 0 1 0 7 10a1.75 1.75 0 0 0 0-3.5ZM16 3h-4a1 1 0 0 0-1 .88V6a1 1 0 0 0 .88 1h.62v2L14 7h2a1 1 0 0 0 1-.88V4a1 1 0 0 0-.88-1H16Z"]):null,s=3023==o.j?(0,i.U)("PersonNote20Filled","20",["M10 2a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm-5 9a2 2 0 0 0-2 2c0 1.7.83 2.97 2.13 3.8 1.1.69 2.5 1.07 4.03 1.17A3 3 0 0 1 9 17v-4c0-.77.29-1.47.76-2H5.01Zm5 2c0-1.1.9-2 2-2h5a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-4Zm6.5 3h-4a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1Zm-4-3a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1h-4Z"]):null,a=3023==o.j?(0,i.U)("PersonNote20Regular","20",["M10 2a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM7 6a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm-2 5a2 2 0 0 0-2 2c0 1.7.83 2.97 2.13 3.8 1.1.69 2.5 1.07 4.03 1.17A3 3 0 0 1 9 17v-.04a7.42 7.42 0 0 1-3.33-1A3.36 3.36 0 0 1 4 13a1 1 0 0 1 1-1h4.17a3 3 0 0 1 .6-1H5Zm5 2c0-1.1.9-2 2-2h5a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-4Zm6.5 3h-4a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1Zm-4-3a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1h-4Z"]):null},53993:(e,t,o)=>{"use strict";if(o.d(t,{n:()=>c}),o(56415),3023==o.j)var i=o(6722);if(3023==o.j)var n=o(31941);if(3023==o.j)var r=o(79420);if(3023==o.j)var s=o(43452);if(3023==o.j)var a=o(83546);if(3023==o.j)var l=o(58035);const c=(e,t)=>{e=(0,i.c)(e,{supportsLabelFor:!0,supportsRequired:!0,supportsSize:!0});const o=(0,l.Pv)();var c;const{size:u="medium",appearance:d=(null!==(c=o.inputDefaultAppearance)&&void 0!==c?c:"outline"),onChange:h}=e,[g,p]=(0,n.i)({state:e.value,defaultState:e.defaultValue,initialState:""}),f=(0,r.n)({props:e,primarySlotTagName:"input",excludedPropNames:["size","onChange","value","defaultValue"]}),m={size:u,appearance:d,components:{root:"span",input:"input",contentBefore:"span",contentAfter:"span"},input:s.Gk(e.input,{defaultProps:{type:"text",ref:t,...f.primary},elementType:"input"}),contentAfter:s.lq(e.contentAfter,{elementType:"span"}),contentBefore:s.lq(e.contentBefore,{elementType:"span"}),root:s.Gk(e.root,{defaultProps:f.root,elementType:"span"})};return m.input.value=g,m.input.onChange=(0,a.D)((e=>{const t=e.target.value;null==h||h(e,{value:t}),p(t)})),m}},60619:(e,t,o)=>{"use strict";o.d(t,{d:()=>g});var i=o(38692),n=o(33899),r=o(85701);if(3023==o.j)var s=o(17226);const a=(i.L.spacingHorizontalSNudge,i.L.spacingHorizontalMNudge,i.L.spacingHorizontalM,i.L.spacingHorizontalXXS,i.L.spacingHorizontalXXS,i.L.spacingHorizontalSNudge,i.L.spacingHorizontalS,i.L.spacingHorizontalM,i.L.spacingHorizontalM,i.L.spacingHorizontalSNudge,(0,n.y)("r1oeeo9n","r9sxh5",{r:[".r1oeeo9n{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r1oeeo9n::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-left-radius:var(--borderRadiusMedium);border-bottom-right-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r1oeeo9n:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r1oeeo9n:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r1oeeo9n:focus-within{outline:2px solid transparent;}",".r9sxh5{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r9sxh5::after{box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-right-radius:var(--borderRadiusMedium);border-bottom-left-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r9sxh5:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r9sxh5:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r9sxh5:focus-within{outline:2px solid transparent;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]})),l=(0,r.X)({small:{sshi5w:"f1pha7fy",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},medium:{},large:{sshi5w:"f1w5jphr",Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},outline:{},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1l4zc64",gg5e9n:["f1m52nbi","f1ub3y4t"],Drbcw7:"f8vnjqi",udz0bu:["fz1etlk","f1hc16gm"],Be8ivqh:"f1klwx88",ofdepl:["f1hc16gm","fz1etlk"]},underline:{De3pzq:"f1c21dwh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],wvpqe5:["f1deefiw","f1n71otn"],Eqx8gd:["f1n6gb5g","f15yvnhg"],B1piin3:["f15yvnhg","f1n6gb5g"]},underlineInteractive:{oetu4i:"f1l4zc64",Be8ivqh:"f1klwx88",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f2ale1x"},filled:{g2u3we:"fghlq4f",h3c5rm:["f1gn591s","fjscplz"],B9xav0g:"fb073pr",zhjwy3:["fjscplz","f1gn591s"]},filledInteractive:{q7v0qe:"ftmjh5b",kmh5ft:["f17blpuu","fsrcdbj"],nagaa4:"f1tpwn32",B1yhkcb:["fsrcdbj","f17blpuu"]},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},"filled-darker":{De3pzq:"f16xq7d1"},"filled-lighter":{De3pzq:"fxugw4r"},"filled-darker-shadow":{De3pzq:"f16xq7d1",E5pizo:"fyed02w"},"filled-lighter-shadow":{De3pzq:"fxugw4r",E5pizo:"fyed02w"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bsft5z2:"fhr9occ",Bduesf4:"f99w1ws"},smallWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},smallWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},mediumWithContentBefore:{uwmqm3:["f1ng84yb","f11gcy0p"]},mediumWithContentAfter:{z189sj:["f11gcy0p","f1ng84yb"]},largeWithContentBefore:{uwmqm3:["f1uw59to","fw5db7e"]},largeWithContentAfter:{z189sj:["fw5db7e","f1uw59to"]}},{d:[".f1pha7fy{min-height:24px;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1w5jphr{min-height:40px;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".fokr779{border-radius:0;}",{p:-1}],".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",[".f2ale1x::after{border-radius:0;}",{p:-1}],".fghlq4f{border-top-color:var(--colorTransparentStroke);}",".f1gn591s{border-right-color:var(--colorTransparentStroke);}",".fjscplz{border-left-color:var(--colorTransparentStroke);}",".fb073pr{border-bottom-color:var(--colorTransparentStroke);}",".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".fyed02w{box-shadow:var(--shadow2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fhr9occ::after{content:unset;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}"],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".ftmjh5b:hover,.ftmjh5b:focus-within{border-top-color:var(--colorTransparentStrokeInteractive);}",".f17blpuu:hover,.f17blpuu:focus-within{border-right-color:var(--colorTransparentStrokeInteractive);}",".fsrcdbj:hover,.fsrcdbj:focus-within{border-left-color:var(--colorTransparentStrokeInteractive);}",".f1tpwn32:hover,.f1tpwn32:focus-within{border-bottom-color:var(--colorTransparentStrokeInteractive);}"],a:[".f8vnjqi:active,.f8vnjqi:focus-within{border-top-color:var(--colorNeutralStroke1Pressed);}",".fz1etlk:active,.fz1etlk:focus-within{border-right-color:var(--colorNeutralStroke1Pressed);}",".f1hc16gm:active,.f1hc16gm:focus-within{border-left-color:var(--colorNeutralStroke1Pressed);}",".f1klwx88:active,.f1klwx88:focus-within{border-bottom-color:var(--colorNeutralStrokeAccessiblePressed);}"],m:[["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],w:[".f99w1ws:focus-within{outline-style:none;}"]}),c=3023==o.j?(0,n.y)("r12stul0",null,[".r12stul0{align-self:stretch;box-sizing:border-box;flex-grow:1;min-width:0;border-style:none;padding:0 var(--spacingHorizontalM);color:var(--colorNeutralForeground1);background-color:transparent;outline-style:none;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;}",".r12stul0::-webkit-input-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::-moz-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::placeholder{color:var(--colorNeutralForeground4);opacity:1;}"]):null,u=(0,r.X)({small:{uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},medium:{},large:{uwmqm3:["fnphzt9","flt1dlf"],z189sj:["flt1dlf","fnphzt9"]},smallWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},smallWithContentAfter:{z189sj:["ffczdla","fgiv446"]},mediumWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},mediumWithContentAfter:{z189sj:["ffczdla","fgiv446"]},largeWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},largeWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},disabled:{sj55zd:"f1s2aq7o",De3pzq:"f1c21dwh",Bceei9c:"fdrzuqr",yvdlaj:"fahhnxm"}},{d:[".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".fnphzt9{padding-left:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".flt1dlf{padding-right:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".fgiv446{padding-left:var(--spacingHorizontalXXS);}",".ffczdla{padding-right:var(--spacingHorizontalXXS);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fdrzuqr{cursor:not-allowed;}",".fahhnxm::-webkit-input-placeholder{color:var(--colorNeutralForegroundDisabled);}",".fahhnxm::-moz-placeholder{color:var(--colorNeutralForegroundDisabled);}"]}),d=3023==o.j?(0,n.y)("r1572tok",null,[".r1572tok{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;}",".r1572tok>svg{font-size:20px;}"]):null,h=(0,r.X)({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),g=e=>{const{size:t,appearance:o}=e,i=e.input.disabled,n="true"==`${e.input["aria-invalid"]}`,r=o.startsWith("filled"),g=l(),p=u(),f=h();e.root.className=(0,s.z)("fui-Input",a(),g[t],e.contentBefore&&g[`${t}WithContentBefore`],e.contentAfter&&g[`${t}WithContentAfter`],g[o],!i&&"outline"===o&&g.outlineInteractive,!i&&"underline"===o&&g.underlineInteractive,!i&&r&&g.filledInteractive,r&&g.filled,!i&&n&&g.invalid,i&&g.disabled,e.root.className),e.input.className=(0,s.z)("fui-Input__input",c(),p[t],e.contentBefore&&p[`${t}WithContentBefore`],e.contentAfter&&p[`${t}WithContentAfter`],i&&p.disabled,e.input.className);const m=[d(),i&&f.disabled,f[t]];return e.contentBefore&&(e.contentBefore.className=(0,s.z)("fui-Input__contentBefore",...m,e.contentBefore.className)),e.contentAfter&&(e.contentAfter.className=(0,s.z)("fui-Input__contentAfter",...m,e.contentAfter.className)),e}},20298:(e,t,o)=>{"use strict";o.d(t,{D:()=>M});var i=o(56415),n=o(43452),r=o(51033),s=o(46279),a=o(83546),l=o(33341),c=o(76908),u=o(42511),d=o(22271),h=o(49080),g=o(22521),p=o(47857),f=o(35946),m=o(54544);const v=(0,d.A)(h.oAB,h.Crl),b=(0,d.A)(h.NGN,h.nUb);var y=o(28022),C=o(80409),S=o(33899),w=o(85701),k=o(17226),T=o(32285);const x=(0,S.y)("r11normc","r1lnj0i0",{r:[".r11normc{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-right:var(--spacingVerticalSNudge);padding-left:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r11normc:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r11normc:hover .fui-Icon-filled{display:inline;}",".r11normc:hover .fui-Icon-regular{display:none;}",".r11normc:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r11normc:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r11normc:focus{outline-style:none;}",".r11normc:focus-visible{outline-style:none;}",".r11normc[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.r11normc[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".r1lnj0i0{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-left:var(--spacingVerticalSNudge);padding-right:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r1lnj0i0:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r1lnj0i0:hover .fui-Icon-filled{display:inline;}",".r1lnj0i0:hover .fui-Icon-regular{display:none;}",".r1lnj0i0:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r1lnj0i0:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r1lnj0i0:focus{outline-style:none;}",".r1lnj0i0:focus-visible{outline-style:none;}",".r1lnj0i0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.r1lnj0i0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:['@media (forced-colors: active){.r11normc:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r11normc:focus{outline-style:none;}.r11normc:focus-visible{outline-style:none;}.r11normc[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}@media (forced-colors: active){.r11normc[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}.r11normc[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}}',"@media (forced-colors: active){.r11normc[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}",'@media (forced-colors: active){.r1lnj0i0:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r1lnj0i0:focus{outline-style:none;}.r1lnj0i0:focus-visible{outline-style:none;}.r1lnj0i0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}@media (forced-colors: active){.r1lnj0i0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}.r1lnj0i0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}}',"@media (forced-colors: active){.r1lnj0i0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),I=(0,S.y)("r1ls86vo","rpbc5dr",[".r1ls86vo{padding-left:2px;padding-right:2px;background-color:transparent;flex-grow:1;}",".rpbc5dr{padding-right:2px;padding-left:2px;background-color:transparent;flex-grow:1;}"]),_=(0,S.y)("r12mwwux","r1ewgu5j",[".r12mwwux{padding-left:2px;padding-right:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r12mwwux:hover{color:var(--colorNeutralForeground3Hover);}",".r12mwwux:focus{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j{padding-right:2px;padding-left:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r1ewgu5j:hover{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j:focus{color:var(--colorNeutralForeground3Hover);}"]),E=(0,S.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),A=(0,S.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),R=(0,w.X)({checkmark:{B6of3ja:"fmnzpld"},splitItemMain:{Bh6795r:"fqerorx"},splitItemTrigger:{Btl43ni:["f1ozlkrg","f10ostut"],Beyfa6y:["f1deotkl","f1krrbdw"],uwmqm3:["f1cnd47f","fhxju0i"],Ftih45:"f1wl9k8s",Ccq8qp:"f1yn80uh",Baz25je:"f68mna0",cmx5o7:"f1p5zmk"},disabled:{sj55zd:"f1s2aq7o",Bi91k9c:"fvgxktp",Jwef8y:"f1ijtazh",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bg7n49j:"f1q1x1ba",B2d53fq:"fcvwxyo",iro3zm:"f1to34ca",t0hwav:"ft33916",Bbusuzp:"f1dcs8yz",ze5xyy:"f1kc2mi9",Bqrx1nm:"fkavljg",Bctn1xl:"fk56vqo",h5esng:"ff3wi9b",Bh6z0a4:"f1ikwg0d",Bh953qp:"f10l1t5h"}},{d:[".fmnzpld{margin-top:2px;}",".fqerorx{flex-grow:1;}",".f1ozlkrg{border-top-left-radius:0;}",".f10ostut{border-top-right-radius:0;}",".f1deotkl{border-bottom-left-radius:0;}",".f1krrbdw{border-bottom-right-radius:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}",'.f1wl9k8s::before{content:"";}',".f1yn80uh::before{width:var(--strokeWidthThin);}",".f68mna0::before{height:24px;}",".f1p5zmk::before{background-color:var(--colorNeutralStroke1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"],h:[".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1ijtazh:hover{background-color:var(--colorNeutralBackground1);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1q1x1ba:hover .fui-MenuItem__icon{color:var(--colorNeutralForegroundDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f1to34ca:hover:active{background-color:var(--colorNeutralBackground1);}"],f:[".ft33916:focus{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkavljg:hover{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fk56vqo:hover .fui-MenuItem__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff3wi9b:hover .fui-MenuItem__icon{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ikwg0d:focus{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f10l1t5h:focus{background-color:Canvas;}}",{m:"(forced-colors: active)"}]]});var B=o(98121);const M=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,u.T)(),d=(0,p.tv)((e=>e.persistOnItemClick)),{as:h="div",disabled:y=!1,hasSubmenu:C=o,persistOnClick:S=d}=e,w=(0,g.f_)((e=>e.hasIcons)),k=(0,g.f_)((e=>e.hasCheckmarks)),T=(0,p.tv)((e=>e.setOpen)),{dir:x}=(0,l.Y)(),I=i.useRef(null),_=i.useRef(!1),E={hasSubmenu:C,disabled:y,persistOnClick:S,components:{root:"div",icon:"span",checkmark:"span",submenuIndicator:"span",content:"span",secondaryContent:"span"},root:n.Gk((0,r.g)(h,(0,f.F)(h,{role:"menuitem",...e,disabled:!1,disabledFocusable:y,ref:(0,s.a)(t,I),onKeyDown:(0,a.D)((t=>{var o;null===(o=e.onKeyDown)||void 0===o||o.call(e,t),t.isDefaultPrevented()||t.key!==m.$xS&&t.key!==m.xyI||(_.current=!0)})),onMouseEnter:(0,a.D)((t=>{var o,i;null===(o=I.current)||void 0===o||o.focus(),null===(i=e.onMouseEnter)||void 0===i||i.call(e,t)})),onClick:(0,a.D)((t=>{var o;C||S||(T(t,{open:!1,keyboard:_.current,bubble:!0,type:"menuItemClick",event:t}),_.current=!1),null===(o=e.onClick)||void 0===o||o.call(e,t)}))})),{elementType:"div"}),icon:n.lq(e.icon,{renderByDefault:w,elementType:"span"}),checkmark:n.lq(e.checkmark,{renderByDefault:k,elementType:"span"}),submenuIndicator:n.lq(e.submenuIndicator,{renderByDefault:C,defaultProps:{children:"ltr"===x?i.createElement(v,null):i.createElement(b,null)},elementType:"span"}),content:n.lq(e.content,{renderByDefault:!!e.children,defaultProps:{children:e.children},elementType:"span"}),secondaryContent:n.lq(e.secondaryContent,{elementType:"span"})};return(0,c.t)(E,I),E})(e,t);return(e=>{const t=R(),o=x(),i=I(),n=_(),r=E(),s=A();e.root.className=(0,k.z)("fui-MenuItem",o,e.disabled&&t.disabled,e.root.className),e.content&&(e.content.className=(0,k.z)("fui-MenuItem__content",i,e.content.className)),e.checkmark&&(e.checkmark.className=(0,k.z)("fui-MenuItem__checkmark",t.checkmark,e.checkmark.className)),e.secondaryContent&&(e.secondaryContent.className=(0,k.z)("fui-MenuItem__secondaryContent",!e.disabled&&n,e.secondaryContent.className)),e.icon&&(e.icon.className=(0,k.z)("fui-MenuItem__icon",r,e.icon.className)),e.submenuIndicator&&(e.submenuIndicator.className=(0,k.z)("fui-MenuItem__submenuIndicator",s,e.submenuIndicator.className)),(0,T.Y)(e)})(o),(0,B.$e)("useMenuItemStyles_unstable")(o),(e=>((0,C.C)(e),(0,y.FD)(e.root,{children:[e.checkmark&&(0,y.Y)(e.checkmark,{}),e.icon&&(0,y.Y)(e.icon,{}),e.content&&(0,y.Y)(e.content,{}),e.secondaryContent&&(0,y.Y)(e.secondaryContent,{}),e.submenuIndicator&&(0,y.Y)(e.submenuIndicator,{})]})))(o)}));M.displayName="MenuItem"},76908:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>n}),o(56415),3023==o.j)var i=o(22521);const n=(e,t)=>{const o=(0,i.f_)((e=>e.setFocusByFirstCharacter)),{onKeyDown:n}=e.root;return e.root.onKeyDown=e=>{var i;null==n||n(e),(null===(i=e.key)||void 0===i?void 0:i.length)>1||t.current&&(null==o||o(e,t.current))},e}},5567:(e,t,o)=>{"use strict";o.d(t,{c:()=>w});var i=o(56415),n=o(31941),r=o(83546),s=o(43452),a=o(51033),l=o(46279),c=o(12382),u=o(43173),d=o(70398),h=o(33341),g=o(39329),p=o(47857);var f=o(28022),m=o(80409),v=o(22521),b=o(85701),y=o(17226);const C=(0,b.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",i8kkvl:0,Belr9w4:0,rmohyg:"f1t6b6ee"},hasMenuContext:{Bqenvij:"f1l02sjl"}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",[".f1t6b6ee{gap:2px;}",{p:-1}],".f1l02sjl{height:100%;}"]});var S=o(98121);const w=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{findAllFocusable:o}=(0,c.r)(),{targetDocument:f}=(0,h.Y)(),m={checkedValues:(0,p.tv)((e=>e.checkedValues)),onCheckedValueChange:(0,p.tv)((e=>e.onCheckedValueChange)),triggerId:(0,p.tv)((e=>e.triggerId)),hasIcons:(0,p.tv)((e=>e.hasIcons)),hasCheckmarks:(0,p.tv)((e=>e.hasCheckmarks))},v=(0,g.V)(p.xu),b=(0,u.i)({circular:!0});((e,t,o)=>{let i=!1;for(const o in t)e[o]&&(i=!0);return o&&i})(e,m,v)&&console.warn("You are using both MenuList and Menu props, we recommend you to use Menu props when available");const y=i.useRef(null);i.useEffect((()=>{const e=y.current;if(v&&f&&e){const t=t=>{const o=t.detail.next;o&&e.contains(f.activeElement)&&!e.contains(o)&&t.preventDefault()};return f.addEventListener(d.GD,t),()=>{f.removeEventListener(d.GD,t)}}}),[y,f,v]);const C=i.useCallback(((e,t)=>{const i=["menuitem","menuitemcheckbox","menuitemradio"];if(!y.current)return;const n=o(y.current,(e=>e.hasAttribute("role")&&-1!==i.indexOf(e.getAttribute("role"))));let r=n.indexOf(t)+1;r===n.length&&(r=0);const s=n.map((e=>{var t;return null===(t=e.textContent)||void 0===t?void 0:t.charAt(0).toLowerCase()})),a=e.key.toLowerCase(),l=(e,t)=>{for(let t=e;t<s.length;t++)if(a===s[t])return t;return-1};let c=l(r);-1===c&&(c=l(0)),c>-1&&n[c].focus()}),[o]);var S;const[w,k]=(0,n.i)({state:null!==(S=e.checkedValues)&&void 0!==S?S:v?m.checkedValues:void 0,defaultState:e.defaultCheckedValues,initialState:{}});var T;const x=null!==(T=e.onCheckedValueChange)&&void 0!==T?T:v?m.onCheckedValueChange:void 0,I=(0,r.D)(((e,t,o,i)=>{const n=[...(null==w?void 0:w[t])||[]];i?n.splice(n.indexOf(o),1):n.push(o),null==x||x(e,{name:t,checkedItems:n}),k((e=>({...e,[t]:n})))})),_=(0,r.D)(((e,t,o)=>{const i=[o];k((e=>({...e,[t]:i}))),null==x||x(e,{name:t,checkedItems:i})}));return{components:{root:"div"},root:s.Gk((0,a.g)("div",{ref:(0,l.a)(t,y),role:"menu","aria-labelledby":m.triggerId,...b,...e}),{elementType:"div"}),hasIcons:m.hasIcons||!1,hasCheckmarks:m.hasCheckmarks||!1,checkedValues:w,hasMenuContext:v,setFocusByFirstCharacter:C,selectRadio:_,toggleCheckbox:I}})(e,t),b=function(e){const{checkedValues:t,hasCheckmarks:o,hasIcons:i,selectRadio:n,setFocusByFirstCharacter:r,toggleCheckbox:s}=e;return{menuList:{checkedValues:t,hasCheckmarks:o,hasIcons:i,selectRadio:n,setFocusByFirstCharacter:r,toggleCheckbox:s}}}(o);return(e=>{const t=C();e.root.className=(0,y.z)("fui-MenuList",t.root,e.hasMenuContext&&t.hasMenuContext,e.root.className)})(o),(0,S.$e)("useMenuListStyles_unstable")(o),((e,t)=>((0,m.C)(e),(0,f.Y)(v.j4,{value:t.menuList,children:(0,f.Y)(e.root,{})})))(o,b)}));w.displayName="MenuList"},48570:(e,t,o)=>{"use strict";o.d(t,{b:()=>w});var i=o(56415),n=o(54544),r=o(83950),s=o(43452),a=o(51033),l=o(46279),c=o(83546),u=o(47857),d=o(22747),h=o(33341),g=o(41186),p=o(10413),f=o(85701),m=o(17226);const v=(0,f.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",De3pzq:"fxugw4r",sj55zd:"f19n0e5",B7ck84d:"f1ewtqcl",Bf4jedk:"fl8fusi",B2u0y6b:"f1kaai3v",B68tc82:"f1p9o1ba",a9b677:"f1ahpp82",E5pizo:"f1hg901r",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fd3pd8h",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f18k4bn6",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",Bvtglag:"fjp4h9y"}},{d:[[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1ewtqcl{box-sizing:border-box;}",".fl8fusi{min-width:138px;}",".f1kaai3v{max-width:300px;}",".f1p9o1ba{overflow-x:hidden;}",".f1ahpp82{width:max-content;}",".f1hg901r{box-shadow:var(--shadow16);}",[".fd3pd8h{padding:4px;}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f18k4bn6{animation-composition:accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}"],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]});var b=o(28022),y=o(80409),C=o(657),S=o(98121);const w=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,u.tv)((e=>e.menuPopoverRef)),f=(0,u.tv)((e=>e.setOpen)),m=(0,u.tv)((e=>e.open)),v=(0,u.tv)((e=>e.openOnHover)),b=(0,u.tv)((e=>e.triggerRef)),y=(0,g.R)(),C=i.useRef(!0),S=(0,p.P)(),[w,k]=(0,r.Z)(),{dir:T}=(0,h.Y)(),x="ltr"===T?n.nkM:n.Qpb,I=i.useCallback((e=>{e&&e.addEventListener("mouseover",(e=>{C.current&&(C.current=!1,(0,d.uD)(o.current,e),w((()=>C.current=!0),250))}))}),[o,w]);var _;i.useEffect((()=>{}),[k]);const E=null!==(_=(0,u.tv)((e=>e.inline)))&&void 0!==_&&_,A=(0,u.tv)((e=>e.mountNode)),R=s.Gk((0,a.g)("div",{role:"presentation",...S,...e,ref:(0,l.a)(t,o,I)}),{elementType:"div"}),{onMouseEnter:B,onKeyDown:M}=R;return R.onMouseEnter=(0,c.D)((e=>{(v||y)&&f(e,{open:!0,keyboard:!1,type:"menuPopoverMouseEnter",event:e}),null==B||B(e)})),R.onKeyDown=(0,c.D)((e=>{const t=e.key;var i,r;(t===n.uf9||y&&t===x)&&m&&(null===(i=o.current)||void 0===i?void 0:i.contains(e.target))&&!e.isDefaultPrevented()&&(f(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),e.preventDefault()),t===n.ozo&&(f(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),y||null===(r=b.current)||void 0===r||r.focus()),null==M||M(e)})),{inline:E,mountNode:A,components:{root:"div"},root:R}})(e,t);return(e=>{const t=v();e.root.className=(0,m.z)("fui-MenuPopover",t.root,e.root.className)})(o),(0,S.$e)("useMenuPopoverStyles_unstable")(o),(e=>((0,y.C)(e),e.inline?(0,b.Y)(e.root,{}):(0,b.Y)(C.Z,{mountNode:e.mountNode,children:(0,b.Y)(e.root,{})})))(o)}));w.displayName="MenuPopover"},42937:(e,t,o)=>{"use strict";o.d(t,{c:()=>y});var i=o(56415),n=o(47857),r=o(41186),s=o(10413),a=o(12382),l=o(33341),c=o(54544),u=o(44760),d=o(46279),h=o(83546),g=o(22295),p=o(67894),f=o(51664),m=o(35946);const v=e=>{const t=e=>e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&"true"===e.getAttribute("aria-disabled");return!(!(0,f.s)(e.target)||!t(e.target))||(0,f.s)(e.currentTarget)&&t(e.currentTarget)};var b=o(42511);const y=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:o=!1}=e,f=(0,n.tv)((e=>e.triggerRef)),b=(0,n.tv)((e=>e.menuPopoverRef)),y=(0,n.tv)((e=>e.setOpen)),C=(0,n.tv)((e=>e.open)),S=(0,n.tv)((e=>e.triggerId)),w=(0,n.tv)((e=>e.openOnHover)),k=(0,n.tv)((e=>e.openOnContext)),T=(0,s.X)(),x=(0,r.R)(),{findFirstFocusable:I}=(0,a.r)(),_=i.useCallback((()=>{const e=I(b.current);null==e||e.focus()}),[I,b]),E=i.useRef(!1),A=i.useRef(!1),{dir:R}=(0,l.Y)(),B="ltr"===R?c.Qpb:c.nkM,M=(0,u.h)(t),D={id:S,...T,...null==M?void 0:M.props,ref:(0,d.a)(f,null==M?void 0:M.ref),onMouseEnter:(0,h.D)((0,g.p)(null==M?void 0:M.props.onMouseEnter,(e=>{v(e)||w&&A.current&&y(e,{open:!0,keyboard:!1,type:"menuTriggerMouseEnter",event:e})}))),onMouseLeave:(0,h.D)((0,g.p)(null==M?void 0:M.props.onMouseLeave,(e=>{v(e)||w&&y(e,{open:!1,keyboard:!1,type:"menuTriggerMouseLeave",event:e})}))),onContextMenu:(0,h.D)((0,g.p)(null==M?void 0:M.props.onContextMenu,(e=>{v(e)||e.isDefaultPrevented()||k&&(e.preventDefault(),y(e,{open:!0,keyboard:!1,type:"menuTriggerContextMenu",event:e}))}))),onMouseMove:(0,h.D)((0,g.p)(null==M?void 0:M.props.onMouseMove,(e=>{v(e)||w&&!A.current&&(y(e,{open:!0,keyboard:!1,type:"menuTriggerMouseMove",event:e}),A.current=!0)})))},O={"aria-haspopup":"menu","aria-expanded":C||x?C:void 0,...D,onClick:(0,h.D)((0,g.p)(null==M?void 0:M.props.onClick,(e=>{v(e)||k||(y(e,{open:!C,keyboard:E.current,type:"menuTriggerClick",event:e}),E.current=!1)}))),onKeyDown:(0,h.D)((0,g.p)(null==M?void 0:M.props.onKeyDown,(e=>{if(v(e))return;const t=e.key;!k&&(x&&t===B||!x&&t===c.yd$)&&y(e,{open:!0,keyboard:!0,type:"menuTriggerKeyDown",event:e}),t!==c.uf9||x||y(e,{open:!1,keyboard:!0,type:"menuTriggerKeyDown",event:e}),C&&t===B&&x&&_()})))},F=(0,m.F)("button"===(null==M?void 0:M.type)||"a"===(null==M?void 0:M.type)?M.type:"div",O);return{isSubmenu:x,children:(0,p.L)(t,k?D:o?O:F)}})(e);return(e=>i.createElement(b._,{value:e.isSubmenu},e.children))(t)};y.displayName="MenuTrigger",y.isFluentTriggerComponent=!0},9443:(e,t,o)=>{"use strict";o.d(t,{W:()=>C});var i=o(56415),n=o(71463),r=o(9667),s=o(92881),a=o(37092),l=o(31941),c=o(83546),u=o(83950),d=o(23779),h=o(71864),g=o(84270),p=o(33341),f=o(12382),m=o(47857),v=o(22747),b=o(41186);const y=["after","after-bottom","before-top","before","before-bottom","above"],C=e=>{const t=(e=>{const t=(0,b.R)(),{hoverDelay:o=500,inline:C=!1,hasCheckmarks:S=!1,hasIcons:w=!1,closeOnScroll:k=!1,openOnContext:T=!1,persistOnItemClick:x=!1,openOnHover:I=t,defaultCheckedValues:_,mountNode:E=null}=e,A=(0,a.Bi)("menu"),[R,B]=(0,n.N)(),M={position:t?"after":"below",align:t?"top":"start",target:e.openOnContext?R:void 0,fallbackPositions:t?y:void 0,...(0,r.P)(e.positioning)},D=i.Children.toArray(e.children);let O,F;2===D.length?(O=D[0],F=D[1]):1===D.length&&(F=D[0]);const{targetRef:P,containerRef:N}=(0,s.T)(M),[L,j]=(e=>{const{targetDocument:t}=(0,p.Y)(),o=(0,m.tv)((e=>e.setOpen)),n=(0,c.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),r=i.useRef(!1),[s,a]=(0,l.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1}),b=(0,c.D)(((t,i)=>{const r=t instanceof CustomEvent&&t.type===v.C4?t.detail.nativeEvent:t;null==n||n(r,{...i}),i.open&&"contextmenu"===t.type&&e.setContextTarget(t),i.open||e.setContextTarget(void 0),i.bubble&&o(t,{...i}),a(i.open)})),[y,C]=(0,u.Z)(),S=(0,c.D)(((t,o)=>{var i;C(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type||"mouseenter"===t.type||"mousemove"===t.type||t.type===v.C4?((null===(i=e.triggerRef.current)||void 0===i?void 0:i.contains(t.target))&&(r.current="mouseenter"===t.type||"mousemove"===t.type),y((()=>b(t,o)),e.hoverDelay)):b(t,o)}));(0,d.W)({contains:h.s,disabled:!s,element:t,refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),callback:e=>S(e,{open:!1,type:"clickOutside",event:e})});const w=e.openOnContext||e.closeOnScroll;(0,g.z)({contains:h.s,element:t,callback:e=>S(e,{open:!1,type:"scrollOutside",event:e}),refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),disabled:!s||!w}),(0,v.Ji)({element:t,callback:e=>{r.current||S(e,{open:!1,type:"menuMouseEnter",event:e})},disabled:!s,refs:[e.menuPopoverRef]});const{findFirstFocusable:k}=(0,f.r)(),T=i.useCallback((()=>{const t=k(e.menuPopoverRef.current);null==t||t.focus()}),[k,e.menuPopoverRef]);return i.useEffect((()=>{s&&T()}),[s,T]),[s,S]})({hoverDelay:o,isSubmenu:t,setContextTarget:B,closeOnScroll:k,menuPopoverRef:N,triggerRef:P,open:e.open,defaultOpen:e.defaultOpen,onOpenChange:e.onOpenChange,openOnContext:T}),[q,H]=(e=>{const[t,o]=(0,l.i)({state:e.checkedValues,defaultState:e.defaultCheckedValues,initialState:{}});return[t,(0,c.D)(((t,{name:i,checkedItems:n})=>{var r;null===(r=e.onCheckedValueChange)||void 0===r||r.call(e,t,{name:i,checkedItems:n}),o((e=>({...e,[i]:n})))}))]})({checkedValues:e.checkedValues,defaultCheckedValues:_,onCheckedValueChange:e.onCheckedValueChange});return{inline:C,hoverDelay:o,triggerId:A,isSubmenu:t,openOnHover:I,contextTarget:R,setContextTarget:B,hasCheckmarks:S,hasIcons:w,closeOnScroll:k,menuTrigger:O,menuPopover:F,mountNode:E,triggerRef:P,menuPopoverRef:N,components:{},openOnContext:T,open:L,setOpen:j,checkedValues:q,onCheckedValueChange:H,persistOnItemClick:x}})(e),o=function(e){const{checkedValues:t,hasCheckmarks:o,hasIcons:i,inline:n,isSubmenu:r,menuPopoverRef:s,mountNode:a,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:h,setOpen:g,triggerId:p,triggerRef:f}=e;return{menu:{checkedValues:t,hasCheckmarks:o,hasIcons:i,inline:n,isSubmenu:r,menuPopoverRef:s,mountNode:a,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:h,setOpen:g,triggerId:p,triggerRef:f}}}(t);return((e,t)=>i.createElement(m.BV,{value:t.menu},e.menuTrigger,e.open&&e.menuPopover))(t,o)};C.displayName="Menu"},47857:(e,t,o)=>{"use strict";o.d(t,{BV:()=>a,tv:()=>l,xu:()=>r}),o(56415);var i=o(94742);if(3023==o.j)var n=o(7102);const r=(0,i.q)(void 0),s={open:!1,setOpen:()=>!1,checkedValues:{},onCheckedValueChange:()=>null,isSubmenu:!1,triggerRef:{current:null},menuPopoverRef:{current:null},mountNode:null,triggerId:"",openOnContext:!1,openOnHover:!1,hasIcons:!1,hasCheckmarks:!1,inline:!1,persistOnItemClick:!1},a=r.Provider,l=e=>(0,n.i)(r,((t=s)=>e(t)))},22521:(e,t,o)=>{"use strict";o.d(t,{VU:()=>r,f_:()=>l,j4:()=>a}),o(56415);var i=o(94742);if(3023==o.j)var n=o(7102);const r=(0,i.q)(void 0),s={checkedValues:{},setFocusByFirstCharacter:()=>null,toggleCheckbox:()=>null,selectRadio:()=>null,hasIcons:!1,hasCheckmarks:!1},a=r.Provider,l=e=>(0,n.i)(r,((t=s)=>e(t)))},42511:(e,t,o)=>{"use strict";o.d(t,{T:()=>s,_:()=>r});var i=o(56415);const n=i.createContext(void 0),r=n.Provider,s=()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e&&e}},32285:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(85701);if(3023==o.j)var n=o(17226);const r=(0,i.X)({root:{a9b677:"fjw5fx7",Bqenvij:"fd461yt",Bcdw1i0:"fd7fpy0"},rootChecked:{Bcdw1i0:"f1022m68"}},{d:[".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".fd7fpy0{visibility:hidden;}",".f1022m68{visibility:visible;}"]}),s=e=>{const t=r();e.checkmark&&(e.checkmark.className=(0,n.z)(t.root,e.checked&&t.rootChecked,e.checkmark.className))}},41186:(e,t,o)=>{"use strict";if(o.d(t,{R:()=>s}),3023==o.j)var i=o(39329);if(3023==o.j)var n=o(47857);if(3023==o.j)var r=o(22521);function s(){const e=(0,n.tv)((e=>e.isSubmenu)),t=(0,i.V)(r.VU);return e||t}},22747:(e,t,o)=>{"use strict";o.d(t,{C4:()=>s,Ji:()=>a,uD:()=>l});var i=o(56415);if(3023==o.j)var n=o(83546);if(3023==o.j)var r=o(71864);const s="fuimenuenter",a=e=>{const{refs:t,callback:o,element:a,disabled:l}=e,c=(0,n.D)((e=>{const i=t[0],n=e.target;var s;!(0,r.s)(null!==(s=i.current)&&void 0!==s?s:null,n)&&!l&&o(e)}));i.useEffect((()=>{if(null!=a)return l||a.addEventListener(s,c),()=>{a.removeEventListener(s,c)}}),[c,a,l])},l=(e,t)=>{e.dispatchEvent(new CustomEvent(s,{bubbles:!0,detail:{nativeEvent:t}}))}},71057:(e,t,o)=>{"use strict";o.d(t,{q:()=>i});const i=o(56415).createContext(void 0)},59970:(e,t,o)=>{"use strict";if(o.d(t,{$:()=>f}),3023==o.j)var i=o(46279);if(3023==o.j)var n=o(55134);if(3023==o.j)var r=o(83546);if(3023==o.j)var s=o(38991);var a=o(56415);if(3023==o.j)var l=o(71057);if(3023==o.j)var c=o(48087);if(3023==o.j)var u=o(51970);if(3023==o.j)var d=o(91098);if(3023==o.j)var h=o(58139);if(3023==o.j)var g=o(87303);const p=Symbol("MOTION_DEFINITION");function f(e){return Object.assign((t=>{const o={...a.useContext(l.q),...t},{appear:p,children:f,imperativeRef:m,onExit:v,onMotionFinish:b,onMotionStart:y,onMotionCancel:C,visible:S,unmountOnExit:w,...k}=o,T=k,[x,I]=(0,d.p)(S,w),_=(0,g.N)(f),E=(0,u.Z)(m),A=a.useRef(),R=(0,i.a)(A,_.ref),B=a.useRef({appear:p,params:T}),M=(0,c.B)(),D=(0,n.t)(),O=(0,h.u)(),F=(0,r.D)((e=>{null==y||y(null,{direction:e})})),P=(0,r.D)((e=>{null==b||b(null,{direction:e}),"exit"===e&&w&&(I(!1),null==v||v())})),N=(0,r.D)((e=>{null==C||C(null,{direction:e})}));return(0,s.E)((()=>{B.current={appear:p,params:T}})),(0,s.E)((()=>{const t=A.current;if(!t||function(e,t,o){return!e&&t&&!!o}(B.current.appear,D,S))return;const o="function"==typeof e?e({element:t,...B.current.params}):e,i=S?o.enter:o.exit,n=S?"enter":"exit",r=!S&&D;r||F(n);const s=M(t,i,{isReducedMotion:O()});if(!r)return E.current=s,s.setMotionEndCallbacks((()=>P(n)),(()=>N(n))),()=>{s.cancel()};s.finish()}),[M,E,O,P,F,N,S]),x?a.cloneElement(_,{ref:R}):null}),{[p]:"function"==typeof e?e:()=>e})}},48087:(e,t,o)=>{"use strict";o.d(t,{B:()=>n});var i=o(56415);function n(){return i.useCallback(((e,t,o)=>{const i=Array.isArray(t)?t:[t],{isReducedMotion:n}=o,r=i.map((t=>{const{keyframes:o,...i}=t,r=e.animate(o,{fill:"forwards",...i,...n&&{duration:1}});return r.persist(),r}));return{set playbackRate(e){r.forEach((t=>{t.playbackRate=e}))},setMotionEndCallbacks(t,o){Promise.all(r.map((e=>e.finished))).then((()=>{t()})).catch((t=>{var i;const n=null===(i=e.ownerDocument.defaultView)||void 0===i?void 0:i.DOMException;if(!(n&&t instanceof n&&"AbortError"===t.name))throw t;o()}))},cancel:()=>{r.forEach((e=>{e.cancel()}))},pause:()=>{r.forEach((e=>{e.pause()}))},play:()=>{r.forEach((e=>{e.play()}))},finish:()=>{r.forEach((e=>{e.finish()}))}}}),[])}},58139:(e,t,o)=>{"use strict";o.d(t,{u:()=>s});var i=o(56415);if(3023==o.j)var n=o(33341);const r="screen and (prefers-reduced-motion: reduce)";function s(){const{targetDocument:e}=(0,n.Y)();var t;const o=null!==(t=null==e?void 0:e.defaultView)&&void 0!==t?t:null,s=i.useRef(!1),a=i.useCallback((()=>s.current),[]);return i.useEffect((()=>{if(null===o||"function"!=typeof o.matchMedia)return;const e=o.matchMedia(r);e.matches&&(s.current=!0);const t=e=>{s.current=e.matches};return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}}),[o]),a}},51970:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var i=o(56415);function n(e){const t=i.useRef();return i.useImperativeHandle(e,(()=>({setPlayState:e=>{var o,i;"running"===e&&(null===(o=t.current)||void 0===o||o.play()),"paused"===e&&(null===(i=t.current)||void 0===i||i.pause())},setPlaybackRate:e=>{t.current&&(t.current.playbackRate=e)}}))),t}},91098:(e,t,o)=>{"use strict";if(o.d(t,{p:()=>r}),3023==o.j)var i=o(93991);var n=o(56415);function r(e=!1,t=!1){const o=n.useRef(!t||e),r=(0,i.C)(),s=n.useCallback((e=>{o.current!==e&&(o.current=e,r())}),[r]);return n.useEffect((()=>{e&&(o.current=e)})),[e||o.current,s]}},73023:(e,t,o)=>{"use strict";o.d(t,{TV:()=>i});const i={durationUltraFast:50,durationFaster:100,durationFast:150,durationNormal:200,durationGentle:250,durationSlow:300,durationSlower:400,durationUltraSlow:500,curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},26094:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>r}),3023==o.j)var i=o(82123);var n=o(56415);function r(e,t){const{as:o,children:r,...s}=null!=e?e:{};if(null===e){const e=!t.defaultProps.visible&&t.defaultProps.unmountOnExit,o=(t,o)=>e?null:n.createElement(n.Fragment,null,o.children);return{[i.Y]:o,[i.o]:t.elementType}}const a={...t.defaultProps,...s,[i.o]:t.elementType};return"function"==typeof r&&(a[i.Y]=r),a}},87303:(e,t,o)=>{"use strict";o.d(t,{N:()=>r});var i=o(56415),n=o(25556);function r(e){try{const t=i.Children.only(e);if("string"==typeof t.type||n.isForwardRef(t))return t}catch{}throw new Error(["@fluentui/react-motion: Invalid child element.","\n","Motion factories require a single child element to be passed. ","That element element should support ref forwarding i.e. it should be either an intrinsic element (e.g. div) or a component that uses React.forwardRef()."].join(""))}},9960:(e,t,o)=>{"use strict";o.d(t,{n:()=>d});var i=o(56415);if(3023==o.j)var n=o(17226);if(3023==o.j)var r=o(44760);if(3023==o.j)var s=o(67894);if(3023==o.j)var a=o(46279);if(3023==o.j)var l=o(50550);if(3023==o.j)var c=o(92855);if(3023==o.j)var u=o(92247);const d=3023==o.j?i.forwardRef(((e,t)=>{const o=(0,u.I)(),{children:d,minimumVisible:h,overflowAxis:g="horizontal",overflowDirection:p,padding:f}=e,[m,v]=i.useState({hasOverflow:!1,itemVisibility:{},groupVisibility:{}}),{containerRef:b,registerItem:y,updateOverflow:C,registerOverflowMenu:S,registerDivider:w}=(0,c.f)((e=>{const{visibleItems:t,invisibleItems:o,groupVisibility:i}=e,n={};t.forEach((e=>{n[e.id]=!0})),o.forEach((e=>n[e.id]=!1)),v((()=>({hasOverflow:e.invisibleItems.length>0,itemVisibility:n,groupVisibility:i})))}),{overflowDirection:p,overflowAxis:g,padding:f,minimumVisible:h,onUpdateItemVisibility:c.K}),k=(0,r.h)(d),T=(0,s.L)(d,{ref:(0,a.a)(b,t,null==k?void 0:k.ref),className:(0,n.z)("fui-Overflow",o.overflowMenu,o.overflowingItems,d.props.className)});return i.createElement(l.a.Provider,{value:{itemVisibility:m.itemVisibility,groupVisibility:m.groupVisibility,hasOverflow:m.hasOverflow,registerItem:y,updateOverflow:C,registerOverflowMenu:S,registerDivider:w}},T)})):null},37591:(e,t,o)=>{"use strict";o.d(t,{M:()=>c});var i=o(56415),n=o(44760),r=o(67894),s=o(46279),a=o(38991),l=o(50550);const c=i.forwardRef(((e,t)=>{const{id:o,groupId:c,priority:u,children:d}=e,h=function(e,t,o){const n=i.useRef(null),r=(0,l.J)((e=>e.registerItem));return(0,a.E)((()=>{if(n.current)return r({element:n.current,id:e,priority:null!=t?t:0,groupId:o})}),[e,t,r,o]),n}(o,u,c),g=(0,n.h)(d);return(0,r.L)(d,{ref:(0,s.a)(h,t,null==g?void 0:g.ref)})}));c.isFluentTriggerComponent=!0},92247:(e,t,o)=>{"use strict";o.d(t,{I:()=>i});const i=(0,o(85701).X)({overflowMenu:{Brvla84:"fyfkpbf"},overflowingItems:{zb22lx:"f10570jf"}},{d:[".fyfkpbf [data-overflow-menu]{flex-shrink:0;}",".f10570jf [data-overflowing]{display:none;}"]})},55666:(e,t,o)=>{"use strict";o.d(t,{K7:()=>n,My:()=>s,Od:()=>r,Wg:()=>i});const i="data-overflowing",n="data-overflow-item",r="data-overflow-menu",s="data-overflow-divider"},50550:(e,t,o)=>{"use strict";o.d(t,{J:()=>a,a:()=>r});var i=o(94742);if(3023==o.j)var n=o(7102);const r=(0,i.q)(void 0),s={itemVisibility:{},groupVisibility:{},hasOverflow:!1,registerItem:()=>()=>null,updateOverflow:()=>null,registerOverflowMenu:()=>()=>null,registerDivider:()=>()=>null},a=e=>(0,n.i)(r,((t=s)=>e(t)))},31787:(e,t,o)=>{"use strict";if(o.d(t,{R:()=>n}),3023==o.j)var i=o(50550);function n(e){return!!(0,i.J)((t=>t.itemVisibility[e]))}},92855:(e,t,o)=>{"use strict";o.d(t,{K:()=>h,f:()=>d});var i=o(56415);if(3023==o.j)var n=o(87092);if(3023==o.j)var r=o(83546);if(3023==o.j)var s=o(55134);if(3023==o.j)var a=o(4185);if(3023==o.j)var l=o(38991);if(3023==o.j)var c=o(55666);const u=()=>null,d=(e,t)=>{const{overflowAxis:o="horizontal",overflowDirection:d="end",padding:h=10,minimumVisible:g=0,onUpdateItemVisibility:p=u}=t,f=(0,r.D)(e),m=i.useMemo((()=>({overflowAxis:o,overflowDirection:d,padding:h,minimumVisible:g,onUpdateItemVisibility:p,onUpdateOverflow:f})),[g,p,o,d,h,f]),v=(0,s.t)(),b=i.useRef(null),[y,C]=i.useState((()=>(0,a.S)()?(0,n.A)():null));return(0,l.E)((()=>{v&&b.current&&(null==y||y.observe(b.current,m))}),[v,y,m]),(0,l.E)((()=>{if(!b.current||!(0,a.S)()||v)return;const e=(0,n.A)();e.observe(b.current,m),C(e)}),[m,v]),i.useEffect((()=>()=>{null==y||y.disconnect()}),[y]),{registerItem:i.useCallback((e=>(null==y||y.addItem(e),e.element.setAttribute(c.K7,""),()=>{e.element.removeAttribute(c.Wg),e.element.removeAttribute(c.K7),null==y||y.removeItem(e.id)})),[y]),registerDivider:i.useCallback((e=>{const t=e.element;return null==y||y.addDivider(e),t.setAttribute(c.My,""),()=>{e.groupId&&(null==y||y.removeDivider(e.groupId)),t.removeAttribute(c.My)}}),[y]),registerOverflowMenu:i.useCallback((e=>(null==y||y.addOverflowMenu(e),e.setAttribute(c.Od,""),()=>{null==y||y.removeOverflowMenu(),e.removeAttribute(c.Od)})),[y]),updateOverflow:i.useCallback((()=>{null==y||y.update()}),[y]),containerRef:b}},h=({item:e,visible:t})=>{t?e.element.removeAttribute(c.Wg):e.element.setAttribute(c.Wg,"")}},7827:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>n}),3023==o.j)var i=o(50550);const n=()=>(0,i.J)((e=>Object.entries(e.itemVisibility).reduce(((e,[t,o])=>(o||e++,e)),0)))},70541:(e,t,o)=>{"use strict";o.d(t,{z:()=>l});var i=o(56415);if(3023==o.j)var n=o(37092);if(3023==o.j)var r=o(38991);if(3023==o.j)var s=o(50550);if(3023==o.j)var a=o(7827);function l(e){const t=(0,n.Bi)("overflow-menu",e),o=(0,a.D)(),l=(0,s.J)((e=>e.registerOverflowMenu)),c=(0,s.J)((e=>e.updateOverflow)),u=i.useRef(null),d=o>0;return(0,r.E)((()=>{if(u.current)return l(u.current)}),[l,d,t]),(0,r.E)((()=>{d&&c()}),[d,c,u]),{ref:u,overflowCount:o,isOverflowing:d}}},57566:(e,t,o)=>{"use strict";o.d(t,{H:()=>p});var i=o(56415),n=o(43452),r=o(51033),s=o(46279),a=o(42989),l=o(33447),c=o(28022),u=o(80409),d=o(46661),h=o(53194),g=o(98121);const p=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,l.pO)((e=>e.contentRef)),i=(0,l.pO)((e=>e.openOnHover)),c=(0,l.pO)((e=>e.setOpen)),u=(0,l.pO)((e=>e.mountNode)),d=(0,l.pO)((e=>e.arrowRef)),h=(0,l.pO)((e=>e.size)),g=(0,l.pO)((e=>e.withArrow)),p=(0,l.pO)((e=>e.appearance)),f=(0,l.pO)((e=>e.trapFocus)),m=(0,l.pO)((e=>e.inertTrapFocus)),v=(0,l.pO)((e=>e.inline)),{modalAttributes:b}=(0,a.y)({trapFocus:f,legacyTrapFocus:!m,alwaysFocusable:!f}),y={inline:v,appearance:p,withArrow:g,size:h,arrowRef:d,mountNode:u,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:(0,s.a)(t,o),role:f?"dialog":"group","aria-modal":!!f||void 0,...b,...e}),{elementType:"div"})},{onMouseEnter:C,onMouseLeave:S,onKeyDown:w}=y.root;return y.root.onMouseEnter=e=>{i&&c(e,!0),null==C||C(e)},y.root.onMouseLeave=e=>{i&&c(e,!1),null==S||S(e)},y.root.onKeyDown=e=>{var t;"Escape"===e.key&&(null===(t=o.current)||void 0===t?void 0:t.contains(e.target))&&(e.preventDefault(),c(e,!1)),null==w||w(e)},y})(e,t);return(0,h.Ls)(o),(0,g.$e)("usePopoverSurfaceStyles_unstable")(o),(e=>{(0,u.C)(e);const t=(0,c.FD)(e.root,{children:[e.withArrow&&(0,c.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.root.children]});return e.inline?t:(0,c.Y)(d.Z,{mountNode:e.mountNode,children:t})})(o)}));p.displayName="PopoverSurface"},53194:(e,t,o)=>{"use strict";o.d(t,{Ls:()=>a,aT:()=>r});var i=o(85701);if(3023==o.j)var n=o(17226);const r={small:6,medium:8,large:8},s=(0,i.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f18k4bn6",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",Bvtglag:"fjp4h9y",Bhu2qc9:"fymb6k8"},inline:{Bj3rh1h:"f19g0ac"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},brand:{De3pzq:"ffp7eso",sj55zd:"f1phragk"},smallPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1sy4kr4"},mediumPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4zyqsv"},largePadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fop8ug2"},smallArrow:{rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz"},mediumLargeArrow:{rhnwrx:"f1f72gjr",Bdy53xb:"f69yoe5"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f18k4bn6{animation-composition:accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}",".fymb6k8{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 8px 16px var(--colorNeutralShadowKey));}",".f19g0ac{z-index:1;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",[".f1sy4kr4{padding:12px;}",{p:-1}],[".f4zyqsv{padding:16px;}",{p:-1}],[".fop8ug2{padding:20px;}",{p:-1}],".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1f72gjr{--fui-positioning-arrow-height:11.312px;}",".f69yoe5{--fui-positioning-arrow-offset:-5.656px;}",".f1ewtqcl{box-sizing:border-box;}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}'],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]}),a=e=>{const t=s();return e.root.className=(0,n.z)("fui-PopoverSurface",t.root,e.inline&&t.inline,"small"===e.size&&t.smallPadding,"medium"===e.size&&t.mediumPadding,"large"===e.size&&t.largePadding,"inverted"===e.appearance&&t.inverted,"brand"===e.appearance&&t.brand,e.root.className),e.arrowClassName=(0,n.z)(t.arrow,"small"===e.size?t.smallArrow:t.mediumLargeArrow),e}},69260:(e,t,o)=>{"use strict";o.d(t,{W:()=>h}),o(56415);var i=o(44760),n=o(83546),r=o(22295),s=o(46279),a=o(67894),l=o(42989),c=o(33447),u=o(35946),d=o(54544);const h=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:o=!1}=e,h=(0,i.h)(t),g=(0,c.pO)((e=>e.open)),p=(0,c.pO)((e=>e.setOpen)),f=(0,c.pO)((e=>e.toggleOpen)),m=(0,c.pO)((e=>e.triggerRef)),v=(0,c.pO)((e=>e.openOnHover)),b=(0,c.pO)((e=>e.openOnContext)),{triggerAttributes:y}=(0,l.y)(),C={...y,"aria-expanded":`${g}`,...null==h?void 0:h.props,onMouseEnter:(0,n.D)((0,r.p)(null==h?void 0:h.props.onMouseEnter,(e=>{v&&p(e,!0)}))),onMouseLeave:(0,n.D)((0,r.p)(null==h?void 0:h.props.onMouseLeave,(e=>{v&&p(e,!1)}))),onContextMenu:(0,n.D)((0,r.p)(null==h?void 0:h.props.onContextMenu,(e=>{b&&(e.preventDefault(),p(e,!0))}))),ref:(0,s.a)(m,null==h?void 0:h.ref)},S={...C,onClick:(0,n.D)((0,r.p)(null==h?void 0:h.props.onClick,(e=>{b||f(e)}))),onKeyDown:(0,n.D)((0,r.p)(null==h?void 0:h.props.onKeyDown,(e=>{e.key===d.uf9&&g&&!e.isDefaultPrevented()&&(p(e,!1),e.preventDefault())})))},w=(0,u.F)("button"===(null==h?void 0:h.type)||"a"===(null==h?void 0:h.type)?h.type:"div",S);return{children:(0,a.L)(e.children,(0,u.F)("button"===(null==h?void 0:h.type)||"a"===(null==h?void 0:h.type)?h.type:"div",b?C:o?S:w))}})(e);return(e=>e.children)(t)};h.displayName="PopoverTrigger",h.isFluentTriggerComponent=!0},3428:(e,t,o)=>{"use strict";o.d(t,{A:()=>y});var i=o(56415),n=o(83950),r=o(83546),s=o(23779),a=o(71864),l=o(84270),c=o(31941),u=o(33341),d=o(71463),h=o(9667),g=o(97277),p=o(92881),f=o(50012),m=o(53194),v=o(45231);var b=o(33447);const y=e=>(e=>{const{appearance:t,arrowRef:o,contentRef:n,inline:r,mountNode:s,open:a,openOnContext:l,openOnHover:c,setOpen:u,size:d,toggleOpen:h,trapFocus:g,triggerRef:p,withArrow:f,inertTrapFocus:m}=e;return i.createElement(b.nt.Provider,{value:{appearance:t,arrowRef:o,contentRef:n,inline:r,mountNode:s,open:a,openOnContext:l,openOnHover:c,setOpen:u,toggleOpen:h,triggerRef:p,size:d,trapFocus:g,inertTrapFocus:m,withArrow:f}},e.popoverTrigger,e.open&&e.popoverSurface)})((e=>{const[t,o]=(0,d.N)(),b={size:"medium",contextTarget:t,setContextTarget:o,...e},y=i.Children.toArray(e.children);let C,S;2===y.length?(C=y[0],S=y[1]):1===y.length&&(S=y[0]);const[w,k]=function(e){const t=(0,r.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),[o,n]=(0,c.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1});e.open=void 0!==o?o:e.open;const s=e.setContextTarget;return[o,i.useCallback(((e,o)=>{o&&"contextmenu"===e.type&&s(e),o||s(void 0),n(o),null==t||t(e,{open:o})}),[n,t,s])]}(b),[T,x]=(0,n.Z)(),I=(0,r.D)(((t,o)=>{var i;x(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type?T((()=>{k(t,o)}),null!==(i=e.mouseLeaveDelay)&&void 0!==i?i:500):k(t,o)})),_=i.useCallback((e=>{I(e,!w)}),[I,w]),E=function(e){const t={position:"above",align:"center",arrowPadding:2*v.v,target:e.openOnContext?e.contextTarget:void 0,...(0,h.P)(e.positioning)};t.coverTarget&&(e.withArrow=!1),e.withArrow&&(t.offset=(0,g.H)(t.offset,m.aT[e.size]));const{targetRef:o,containerRef:i,arrowRef:n}=(0,p.T)(t);return{triggerRef:o,contentRef:i,arrowRef:n}}(b),{targetDocument:A}=(0,u.Y)();var R;(0,s.W)({contains:a.s,element:A,callback:e=>I(e,!1),refs:[E.triggerRef,E.contentRef],disabled:!w,disabledFocusOnIframe:!(null===(R=e.closeOnIframeFocus)||void 0===R||R)});const B=b.openOnContext||b.closeOnScroll;(0,l.z)({contains:a.s,element:A,callback:e=>I(e,!1),refs:[E.triggerRef,E.contentRef],disabled:!w||!B});const{findFirstFocusable:M}=(0,f.r)();var D,O;return i.useEffect((()=>{if(!e.unstable_disableAutoFocus&&w&&E.contentRef.current){var t;const e=null!==(t=E.contentRef.current.getAttribute("tabIndex"))&&void 0!==t?t:void 0,o=isNaN(e)?M(E.contentRef.current):E.contentRef.current;null==o||o.focus()}}),[M,w,E.contentRef,e.unstable_disableAutoFocus]),{...b,...E,inertTrapFocus:null!==(D=e.inertTrapFocus)&&void 0!==D?D:void 0!==e.legacyTrapFocus&&!e.legacyTrapFocus,popoverTrigger:C,popoverSurface:S,open:w,setOpen:I,toggleOpen:_,setContextTarget:o,contextTarget:t,inline:null!==(O=e.inline)&&void 0!==O&&O}})(e));y.displayName="Popover"},45231:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=4},33447:(e,t,o)=>{"use strict";o.d(t,{nt:()=>r,pO:()=>a});var i=o(94742);if(3023==o.j)var n=o(7102);const r=(0,i.q)(void 0),s={open:!1,setOpen:()=>null,toggleOpen:()=>null,triggerRef:{current:null},contentRef:{current:null},arrowRef:{current:null},openOnContext:!1,openOnHover:!1,size:"medium",trapFocus:!1,inline:!1},a=(r.Provider,e=>(0,n.i)(r,((t=s)=>e(t))))},657:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var i=o(56415),n=o(62886),r=o(82494),s=o(70522),a=o(25526);const l=e=>{const t=(e=>{const{element:t,className:o}=(0,r.h)(e.mountNode),a=i.useRef(null),l=(0,s.v)({disabled:!!t,className:o}),c=null!=t?t:l,u={children:e.children,mountNode:c,virtualParentRootRef:a};return i.useEffect((()=>{if(!c)return;const e=a.current,t=c.contains(e);return e&&!t?((0,n.g)(c,e),()=>{(0,n.g)(c,void 0)}):void 0}),[a,c]),u})(e);return(e=>i.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&a.createPortal(e.children,e.mountNode)))(t)};l.displayName="Portal"},70522:(e,t,o)=>{"use strict";var i;o.d(t,{v:()=>g});var n=o(56415);if(3023==o.j)var r=o(33341);if(3023==o.j)var s=o(52326);if(3023==o.j)var a=o(39449);if(3023==o.j)var l=o(17226);if(3023==o.j)var c=o(13734);if(3023==o.j)var u=o(73811);if(3023==o.j)var d=o(24314);const h=(i||(i=o.t(n,2))).useInsertionEffect,g=e=>{const{targetDocument:t,dir:o}=(0,r.Y)(),i=(0,s.v)(),g=(0,c.Y)(),p=(0,d.B)(),f=(0,a.q)(),m=(0,l.z)(f,p.root,e.className),v=null!=i?i:null==t?void 0:t.body,b=(0,u.K)((()=>{if(void 0===v||e.disabled)return[null,()=>null];const t=v.ownerDocument.createElement("div");return v.appendChild(t),[t,()=>t.remove()]}),[v]);return h?h((()=>{if(!b)return;const e=m.split(" ").filter(Boolean);return b.classList.add(...e),b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b,()=>{b.classList.remove(...e),b.removeAttribute("dir")}}),[m,o,b,g]):n.useMemo((()=>{b&&(b.className=m,b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b)}),[m,o,b,g]),b}},24314:(e,t,o)=>{"use strict";o.d(t,{B:()=>i});const i=(0,o(85701).X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]})},82494:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(51664);function n(e){return(0,i.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}},46661:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var i=o(56415),n=o(62886),r=o(16250),s=o(18038),a=o(25526);const l=e=>{const t=(e=>{const{element:t,className:o}=(0,r.h)(e.mountNode),a=i.useRef(null),l=(0,s.v)({disabled:!!t,className:o}),c=null!=t?t:l,u={children:e.children,mountNode:c,virtualParentRootRef:a};return i.useEffect((()=>{if(!c)return;const e=a.current,t=c.contains(e);return e&&!t?((0,n.g)(c,e),()=>{(0,n.g)(c,void 0)}):void 0}),[a,c]),u})(e);return(e=>i.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&a.createPortal(e.children,e.mountNode)))(t)};l.displayName="Portal"},18038:(e,t,o)=>{"use strict";var i;o.d(t,{v:()=>g});var n=o(56415);if(3023==o.j)var r=o(33341);if(3023==o.j)var s=o(52326);if(3023==o.j)var a=o(39449);if(3023==o.j)var l=o(17226);if(3023==o.j)var c=o(30723);if(3023==o.j)var u=o(73811);if(3023==o.j)var d=o(56182);const h=(i||(i=o.t(n,2))).useInsertionEffect,g=e=>{const{targetDocument:t,dir:o}=(0,r.Y)(),i=(0,s.v)(),g=(0,c.Y)(),p=(0,d.B)(),f=(0,a.q)(),m=(0,l.z)(f,p.root,e.className),v=null!=i?i:null==t?void 0:t.body,b=(0,u.K)((()=>{if(void 0===v||e.disabled)return[null,()=>null];const t=v.ownerDocument.createElement("div");return v.appendChild(t),[t,()=>t.remove()]}),[v]);return h?h((()=>{if(!b)return;const e=m.split(" ").filter(Boolean);return b.classList.add(...e),b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b,()=>{b.classList.remove(...e),b.removeAttribute("dir")}}),[m,o,b,g]):n.useMemo((()=>{b&&(b.className=m,b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b)}),[m,o,b,g]),b}},56182:(e,t,o)=>{"use strict";o.d(t,{B:()=>i});const i=(0,o(85701).X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]})},16250:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(51664);function n(e){return(0,i.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}},29752:(e,t,o)=>{"use strict";o.d(t,{Hz:()=>n,Pg:()=>s,VJ:()=>i,a_:()=>r,l7:()=>a});const i="data-popper-is-intersecting",n="data-popper-escaped",r="data-popper-reference-hidden",s="data-popper-placement",a="fui-positioningend"},59391:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>d}),3023==o.j)var i=o(45385);if(3023==o.j)var n=o(51664);if(3023==o.j)var r=o(89549);if(3023==o.j)var s=o(67463);if(3023==o.j)var a=o(27896);if(3023==o.j)var l=o(36513);if(3023==o.j)var c=o(29752);if(3023==o.j)var u=o(62409);function d(e){let t=!1;const{container:o,target:d,arrow:h,strategy:g,middleware:p,placement:f,useTransform:m=!0,disableUpdateOnResize:v=!1}=e,b=o.ownerDocument.defaultView;if(!d||!o||!b)return{updatePosition:()=>{},dispose:()=>{}};const y=v?null:(0,u.J)(b,(e=>{e.every((e=>e.contentRect.width>0&&e.contentRect.height>0))&&w()}));let C=!0;const S=new Set;Object.assign(o.style,{position:"fixed",left:0,top:0,margin:0});const w=(0,a.s)((()=>{t||(C&&((0,l.X)(o).forEach((e=>S.add(e))),(0,n.s)(d)&&(0,l.X)(d).forEach((e=>S.add(e))),S.forEach((e=>{e.addEventListener("scroll",w,{passive:!0})})),null==y||y.observe(o),(0,n.s)(d)&&(null==y||y.observe(d)),C=!1),Object.assign(o.style,{position:g}),(0,i.rD)(d,o,{placement:f,middleware:p,strategy:g}).then((({x:e,y:i,middlewareData:n,placement:a})=>{t||((0,r.P)({arrow:h,middlewareData:n}),(0,s.f)({container:o,middlewareData:n,placement:a,coordinates:{x:e,y:i},lowPPI:((null==b?void 0:b.devicePixelRatio)||1)<=1,strategy:g,useTransform:m}),o.dispatchEvent(new CustomEvent(c.l7)))})).catch((e=>{})))}));return b&&(b.addEventListener("scroll",w,{passive:!0}),b.addEventListener("resize",w)),w(),{updatePosition:w,dispose:()=>{t=!0,b&&(b.removeEventListener("scroll",w),b.removeEventListener("resize",w)),S.forEach((e=>{e.removeEventListener("scroll",w)})),S.clear(),null==y||y.disconnect()}}}},95718:(e,t,o)=>{"use strict";function i(e){const t=e.clientX,o=e.clientY,i=t+1,n=o+1;return{getBoundingClientRect:function(){return{left:t,top:o,right:i,bottom:n,x:t,y:o,height:1,width:1}}}}o.d(t,{S:()=>i})},96132:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(32669);function n(){return{name:"coverTarget",fn:e=>{const{placement:t,rects:o,x:n,y:r}=e,s={x:n,y:r};switch((0,i.n)(t).side){case"bottom":s.y-=o.reference.height;break;case"top":s.y+=o.reference.height;break;case"left":s.x+=o.reference.width;break;case"right":s.x-=o.reference.width}return s}}}},83779:(e,t,o)=>{"use strict";if(o.d(t,{U:()=>a}),3023==o.j)var i=o(45385);if(3023==o.j)var n=o(9667);if(3023==o.j)var r=o(32959);if(3023==o.j)var s=o(95733);function a(e){const{hasScrollableElement:t,flipBoundary:o,container:a,fallbackPositions:l=[],isRtl:c}=e,u=l.reduce(((e,t)=>{const{position:o,align:i}=(0,n.P)(t),s=(0,r.h)(i,o,c);return s&&e.push(s),e}),[]);return(0,i.UU)({...t&&{boundary:"clippingAncestors"},...o&&{altBoundary:!0,boundary:(0,s.r)(a,o)},fallbackStrategy:"bestFit",...u.length&&{fallbackPlacements:u}})}},88595:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>n}),3023==o.j)var i=o(45385);function n(){return{name:"intersectionObserver",fn:async e=>{const t=e.rects.floating,o=await(0,i.__)(e,{altBoundary:!0}),n=o.top<t.height&&o.top>0,r=o.bottom<t.height&&o.bottom>0;return{data:{intersecting:n||r}}}}}},24079:(e,t,o)=>{"use strict";o.d(t,{_:()=>n});const i="--fui-match-target-size";function n(){return{name:"matchTargetSize",fn:async e=>{const{rects:{reference:t,floating:o},elements:{floating:n},middlewareData:{matchTargetSize:{matchTargetSizeAttempt:r=!1}={}}}=e;if(t.width===o.width||r)return{};const{width:s}=t;return n.style.setProperty(i,`${s}px`),n.style.width||(n.style.width=`var(${i})`),{data:{matchTargetSizeAttempt:!0},reset:{rects:!0}}}}}},10465:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>s,e:()=>a}),3023==o.j)var i=o(45385);if(3023==o.j)var n=o(95733);if(3023==o.j)var r=o(99281);const s=e=>({name:"resetMaxSize",fn({middlewareData:t,elements:o}){var i;if(null===(i=t.resetMaxSize)||void 0===i?void 0:i.maxSizeAlreadyReset)return{};const{applyMaxWidth:n,applyMaxHeight:r}=e;return n&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-width"),o.floating.style.removeProperty("width")),r&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-height"),o.floating.style.removeProperty("height")),{data:{maxSizeAlreadyReset:!0},reset:{rects:!0}}}});function a(e,t){const{container:o,overflowBoundary:s,overflowBoundaryPadding:a,isRtl:l}=t;return(0,i.Ej)({...a&&{padding:(0,r.z)(a,l)},...s&&{altBoundary:!0,boundary:(0,n.r)(o,s)},apply({availableHeight:t,availableWidth:o,elements:i,rects:n}){const r=(e,t,o)=>{if(e&&(i.floating.style.setProperty("box-sizing","border-box"),i.floating.style.setProperty(`max-${t}`,`${o}px`),n.floating[t]>o)){i.floating.style.setProperty(t,`${o}px`);const e="width"===t?"x":"y";i.floating.style.getPropertyValue(`overflow-${e}`)||i.floating.style.setProperty(`overflow-${e}`,"auto")}},{applyMaxWidth:s,applyMaxHeight:a}=e;r(s,"width",o),r(a,"height",t)}})}},53075:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>r}),3023==o.j)var i=o(45385);if(3023==o.j)var n=o(37068);function r(e){const t=(0,n.u)(e);return(0,i.cY)(t)}},69454:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(45385);if(3023==o.j)var n=o(99281);if(3023==o.j)var r=o(95733);function s(e){const{hasScrollableElement:t,disableTether:o,overflowBoundary:s,container:a,overflowBoundaryPadding:l,isRtl:c}=e;return(0,i.BN)({...t&&{boundary:"clippingAncestors"},...o&&{crossAxis:"all"===o,limiter:(0,i.ER)({crossAxis:"all"!==o,mainAxis:!1})},...l&&{padding:(0,n.z)(l,c)},...s&&{altBoundary:!0,boundary:(0,r.r)(a,s)}})}},92881:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>w}),3023==o.j)var i=o(45385);if(3023==o.j)var n=o(33341);if(3023==o.j)var r=o(4185);if(3023==o.j)var s=o(83546);if(3023==o.j)var a=o(38991);var l=o(56415);if(3023==o.j)var c=o(88378);if(3023==o.j)var u=o(69754);if(3023==o.j)var d=o(39582);if(3023==o.j)var h=o(32959);if(3023==o.j)var g=o(10465);if(3023==o.j)var p=o(24079);if(3023==o.j)var f=o(53075);if(3023==o.j)var m=o(96132);if(3023==o.j)var v=o(83779);if(3023==o.j)var b=o(69454);if(3023==o.j)var y=o(88595);if(3023==o.j)var C=o(59391);if(3023==o.j)var S=o(29752);function w(e){const t=l.useRef(null),o=l.useRef(null),w=l.useRef(null),k=l.useRef(null),T=l.useRef(null),{enabled:x=!0}=e,I=function(e){const{align:t,arrowPadding:o,autoSize:r,coverTarget:s,flipBoundary:a,offset:c,overflowBoundary:C,pinned:S,position:w,unstable_disableTether:k,positionFixed:T,strategy:x,overflowBoundaryPadding:I,fallbackPositions:_,useTransform:E,matchTargetSize:A,disableUpdateOnResize:R=!1}=e,{dir:B,targetDocument:M}=(0,n.Y)(),D="rtl"===B,O=(null!=x?x:T)?"fixed":"absolute",F=(0,u.a)(r);return l.useCallback(((e,n)=>{const r=(0,d.iv)(e),l=[F&&(0,g.D)(F),A&&(0,p._)(),c&&(0,f.c)(c),s&&(0,m.z)(),!S&&(0,v.U)({container:e,flipBoundary:a,hasScrollableElement:r,isRtl:D,fallbackPositions:_}),(0,b.B)({container:e,hasScrollableElement:r,overflowBoundary:C,disableTether:k,overflowBoundaryPadding:I,isRtl:D}),F&&(0,g.e)(F,{container:e,overflowBoundary:C,overflowBoundaryPadding:I,isRtl:D}),(0,y.M)(),n&&(0,i.UE)({element:n,padding:o}),(0,i.jD)({strategy:"referenceHidden"}),(0,i.jD)({strategy:"escaped"}),!1].filter(Boolean);return{placement:(0,h.h)(t,w,D),middleware:l,strategy:O,useTransform:E,disableUpdateOnResize:R}}),[t,o,F,s,k,a,D,c,C,S,w,O,I,_,E,A,M,R])}(e),_=l.useCallback((()=>{var e;t.current&&t.current.dispose(),t.current=null;const i=null!==(e=w.current)&&void 0!==e?e:o.current;x&&(0,r.S)()&&i&&k.current&&(t.current=(0,C.h)({container:k.current,target:i,arrow:T.current,...I(k.current,T.current)}))}),[x,I]),E=(0,s.D)((e=>{w.current=e,_()}));l.useImperativeHandle(e.positioningRef,(()=>({updatePosition:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.updatePosition()},setTarget:t=>{e.target,E(t)}})),[e.target,E]),(0,a.E)((()=>{var t;E(null!==(t=e.target)&&void 0!==t?t:null)}),[e.target,E]),(0,a.E)((()=>{_()}),[_]);const A=(0,c.c)(null,(e=>{o.current!==e&&(o.current=e,_())})),R=(0,s.D)((()=>{var t;return null===(t=e.onPositioningEnd)||void 0===t?void 0:t.call(e)}));return{targetRef:A,containerRef:(0,c.c)(null,(e=>{var t;k.current!==e&&(null===(t=k.current)||void 0===t||t.removeEventListener(S.l7,R),null==e||e.addEventListener(S.l7,R),k.current=e,_())})),arrowRef:(0,c.c)(null,(e=>{T.current!==e&&(T.current=e,_())}))}}},71463:(e,t,o)=>{"use strict";o.d(t,{N:()=>r});var i=o(56415);if(3023==o.j)var n=o(95718);const r=e=>{const[t,o]=i.useState(e);return[t,e=>{if(null==e)return void o(void 0);let t;t=e instanceof MouseEvent?e:e.nativeEvent,MouseEvent;const i=(0,n.S)(t);o(i)}]}},62409:(e,t,o)=>{"use strict";function i(e,t){return new e.ResizeObserver(t)}o.d(t,{J:()=>i})},27896:(e,t,o)=>{"use strict";function i(e){let t;return()=>(t||(t=new Promise((o=>{Promise.resolve().then((()=>{t=void 0,o(e())}))}))),t)}o.d(t,{s:()=>i})},12508:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>n}),3023==o.j)var i=o(32669);const n=e=>{const{side:t,alignment:o}=(0,i.n)(e),n={top:"above",bottom:"below",right:"after",left:"before"}[t],r=o&&(e=>"above"===e||"below"===e?{start:"start",end:"end"}:{start:"top",end:"bottom"})(n)[o];return{position:n,alignment:r}}},95733:(e,t,o)=>{"use strict";if(o.d(t,{r:()=>n}),3023==o.j)var i=o(39582);function n(e,t){if("window"===t)return null==e?void 0:e.ownerDocument.documentElement;if("clippingParents"===t)return"clippingAncestors";if("scrollParent"===t){let t=(0,i.mH)(e);return"BODY"===t.nodeName&&(t=null==e?void 0:e.ownerDocument.documentElement),t}return t}},37068:(e,t,o)=>{"use strict";if(o.d(t,{u:()=>n}),3023==o.j)var i=o(12508);function n(e){return e?"number"==typeof e||"object"==typeof e?e:({rects:{floating:t,reference:o},placement:n})=>{const{position:r,alignment:s}=(0,i.y)(n);return e({positionedRect:t,targetRect:o,position:r,alignment:s})}:e}},39582:(e,t,o)=>{"use strict";o.d(t,{iv:()=>n,mH:()=>i});const i=e=>{const t=e&&(e=>"HTML"===e.nodeName?e:e.parentNode||e.host)(e);if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:o,overflowX:n,overflowY:r}=(e=>{var t;return 1!==e.nodeType?{}:(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView).getComputedStyle(e,null)})(t);return/(auto|scroll|overlay)/.test(o+r+n)?t:i(t)},n=e=>{var t;const o=i(e);return!!o&&o!==(null===(t=o.ownerDocument)||void 0===t?void 0:t.body)}},36513:(e,t,o)=>{"use strict";if(o.d(t,{X:()=>n}),3023==o.j)var i=o(39582);function n(e){const t=[];let o=e;for(;o;){const n=(0,i.mH)(o);if(e.ownerDocument.body===n){t.push(n);break}if("BODY"===n.nodeName&&n!==e.ownerDocument.body)break;t.push(n),o=n}return t}},97277:(e,t,o)=>{"use strict";function i(e,t){return"number"==typeof e||"object"==typeof e&&null!==e?n(e,t):"function"==typeof e?o=>{const i=e(o);return n(i,t)}:{mainAxis:t}}o.d(t,{H:()=>i});const n=(e,t)=>{return"number"==typeof e?{mainAxis:e+t}:{...e,mainAxis:(null!==(o=e.mainAxis)&&void 0!==o?o:0)+t};var o}},69754:(e,t,o)=>{"use strict";o.d(t,{a:()=>i});const i=e=>{switch(e){case"always":case!0:return{applyMaxWidth:!0,applyMaxHeight:!0};case"width-always":case"width":return{applyMaxWidth:!0,applyMaxHeight:!1};case"height-always":case"height":return{applyMaxWidth:!1,applyMaxHeight:!0};default:return!1}}},32669:(e,t,o)=>{"use strict";function i(e){const t=e.split("-");return{side:t[0],alignment:t[1]}}o.d(t,{n:()=>i})},9667:(e,t,o)=>{"use strict";o.d(t,{P:()=>n});const i={above:{position:"above",align:"center"},"above-start":{position:"above",align:"start"},"above-end":{position:"above",align:"end"},below:{position:"below",align:"center"},"below-start":{position:"below",align:"start"},"below-end":{position:"below",align:"end"},before:{position:"before",align:"center"},"before-top":{position:"before",align:"top"},"before-bottom":{position:"before",align:"bottom"},after:{position:"after",align:"center"},"after-top":{position:"after",align:"top"},"after-bottom":{position:"after",align:"bottom"}};function n(e){return null==e?{}:"string"==typeof e?i[e]:e}},99281:(e,t,o)=>{"use strict";function i(e,t){if("number"==typeof e)return e;const{start:o,end:i,...n}=e,r=n,s=t?"end":"start",a=t?"start":"end";return e[s]&&(r.left=e[s]),e[a]&&(r.right=e[a]),r}o.d(t,{z:()=>i})},32959:(e,t,o)=>{"use strict";o.d(t,{h:()=>i});const i=(e,t,o)=>{const i=((e,t)=>{const o="above"===e||"below"===e,i="top"===t||"bottom"===t;return o&&i||!o&&!i})(t,e)?"center":e,n=t&&(e=>({above:"top",below:"bottom",before:e?"right":"left",after:e?"left":"right"}))(o)[t],r=i&&{start:"start",end:"end",top:"start",bottom:"end",center:void 0}[i];return n&&r?`${n}-${r}`:n}},88378:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i=o(56415);if(3023==o.j)var n=o(38991);function r(e,t,o){const r=i.useRef(!0),[s]=i.useState((()=>({value:e,callback:t,facade:{get current(){return s.value},set current(e){const t=s.value;if(t!==e){if(s.value=e,o&&r.current)return;s.callback(e,t)}}}})));return(0,n.E)((()=>{r.current=!1}),[]),s.callback=t,s.facade}},89549:(e,t,o)=>{"use strict";function i(e){const{arrow:t,middlewareData:o}=e;if(!o.arrow||!t)return;const{x:i,y:n}=o.arrow;Object.assign(t.style,{left:`${i}px`,top:`${n}px`})}o.d(t,{P:()=>i})},67463:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(29752);function n(e){var t,o,n;const{container:r,placement:s,middlewareData:a,strategy:l,lowPPI:c,coordinates:u,useTransform:d=!0}=e;if(!r)return;r.setAttribute(i.Pg,s),r.removeAttribute(i.VJ),a.intersectionObserver.intersecting&&r.setAttribute(i.VJ,""),r.removeAttribute(i.Hz),(null===(t=a.hide)||void 0===t?void 0:t.escaped)&&r.setAttribute(i.Hz,""),r.removeAttribute(i.a_),(null===(o=a.hide)||void 0===o?void 0:o.referenceHidden)&&r.setAttribute(i.a_,"");const h=(null===(n=r.ownerDocument.defaultView)||void 0===n?void 0:n.devicePixelRatio)||1,g=Math.round(u.x*h)/h,p=Math.round(u.y*h)/h;Object.assign(r.style,{position:l}),d?Object.assign(r.style,{transform:c?`translate(${g}px, ${p}px)`:`translate3d(${g}px, ${p}px, 0)`}):Object.assign(r.style,{left:`${g}px`,top:`${p}px`})}},69103:(e,t,o)=>{"use strict";o.d(t,{G:()=>T});var i=o(56415),n=o(31941),r=o(43452),s=o(83546),a=o(82169),l=o(46279),c=o(22295),u=o(53993),d=o(95522),h=o(49080),g=o(28022),p=o(80409),f=o(85701),m=o(33899),v=o(17226),b=o(60619);const y=(0,f.X)({small:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["fk8j09s","fdw0yi8"],z189sj:["fdw0yi8","fk8j09s"]},medium:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},large:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["f1ng84yb","f11gcy0p"],z189sj:["f11gcy0p","f1ng84yb"]},input:{uwmqm3:["fk8j09s","fdw0yi8"],z189sj:["fhxju0i","f1cnd47f"],Boqhc8c:"f18izjht",B8uat0v:"fcoa6sg"},unfocusedNoContentAfter:{z189sj:["fhxju0i","f1cnd47f"]}},{d:[".fjuset5{column-gap:0;}",".f1xzfw5u{max-width:468px;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".fhxju0i{padding-right:0;}",".f1cnd47f{padding-left:0;}",".f18izjht::-webkit-search-decoration{display:none;}",".fcoa6sg::-webkit-search-cancel-button{display:none;}"]}),C=(0,f.X)({small:{z189sj:["fdw0yi8","fk8j09s"]},medium:{z189sj:["f1vdfbxk","f1f5gg8d"]},large:{z189sj:["f11gcy0p","f1ng84yb"]}},{d:[".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}"]}),S=(0,f.X)({contentAfter:{uwmqm3:["f1uw59to","fw5db7e"],i8kkvl:"f1ufnopg"},rest:{abs64n:"fk73vx1",Bqenvij:"fniina8",a9b677:"f3tsq5r",uwmqm3:["f1cnd47f","fhxju0i"]}},{d:[".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}",".f1ufnopg{column-gap:var(--spacingHorizontalXS);}",".fk73vx1{opacity:0;}",".fniina8{height:0;}",".f3tsq5r{width:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}"]}),w=(0,m.y)("r1pvzcuu",null,[".r1pvzcuu{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;cursor:pointer;}",".r1pvzcuu>svg{font-size:20px;}"]),k=(0,f.X)({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),T=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{size:o="medium",disabled:g=!1,root:p,contentBefore:f,dismiss:m,contentAfter:v,value:b,defaultValue:y,...C}=e,S=i.useRef(null),w=i.useRef(null),[k,T]=(0,n.i)({state:b,defaultState:y,initialState:""}),[x,I]=i.useState(!1),_=i.useCallback((()=>{I(!0)}),[I]),E=i.useCallback((e=>{var t;I(!!(null===(t=S.current)||void 0===t?void 0:t.contains(e.relatedTarget)))}),[I]),A=r.Gf(p),R=(0,s.D)((t=>{var o,i;(0,a.g)(m)&&(null===(i=m.onClick)||void 0===i||i.call(m,t)),T(""),null===(o=e.onChange)||void 0===o||o.call(e,t,{value:""})})),B=(0,u.n)({type:"search",disabled:g,size:o,value:k,root:r.Gk({...A,ref:(0,l.a)(null==A?void 0:A.ref,S),onFocus:(0,c.p)(null==A?void 0:A.onFocus,_),onBlur:(0,c.p)(null==A?void 0:A.onBlur,E)},{elementType:"span"}),contentBefore:r.lq(f,{renderByDefault:!0,defaultProps:{children:i.createElement(d.vMY,null)},elementType:"span"}),contentAfter:r.lq(v,{renderByDefault:!0,elementType:"span"}),...C,onChange:(0,s.D)((t=>{var o;const i=t.target.value;null===(o=e.onChange)||void 0===o||o.call(e,t,{value:i}),T(i)}))},(0,l.a)(w,t)),M={...B,components:{...B.components,dismiss:"span"},dismiss:r.lq(m,{defaultProps:{children:i.createElement(h.BEt,null),role:"button","aria-label":"clear",tabIndex:-1},renderByDefault:!0,elementType:"span"}),disabled:g,focused:x,size:o};return M.dismiss&&(M.dismiss.onClick=R),M})(e,t);return(e=>{const{disabled:t,focused:o,size:i}=e,n=y(),r=C(),s=S(),a=w(),l=k();e.root.className=(0,v.z)("fui-SearchBox",n[i],!o&&n.unfocusedNoContentAfter,e.root.className),e.input.className=(0,v.z)("fui-SearchBox__input",n.input,!o&&r[i],e.input.className),e.dismiss&&(e.dismiss.className=(0,v.z)("fui-SearchBox__dismiss",a,t&&l.disabled,l[i],e.dismiss.className)),e.contentBefore&&(e.contentBefore.className=(0,v.z)("fui-SearchBox__contentBefore",e.contentBefore.className)),e.contentAfter?e.contentAfter.className=(0,v.z)("fui-SearchBox__contentAfter",s.contentAfter,!o&&s.rest,e.contentAfter.className):e.dismiss&&(e.dismiss.className=(0,v.z)(e.dismiss.className,s.contentAfter)),(0,b.d)(e)})(o),(e=>((0,p.C)(e),(0,g.FD)(e.root,{children:[e.contentBefore&&(0,g.Y)(e.contentBefore,{}),(0,g.Y)(e.input,{}),e.contentAfter&&(0,g.FD)(e.contentAfter,{children:[e.contentAfter.children,e.dismiss&&(0,g.Y)(e.dismiss,{})]})]})))(o)}));T.displayName="SearchBox"},52326:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i=o(56415);const n=i.createContext(void 0);function r(){return i.useContext(n)}n.Provider},24281:(e,t,o)=>{"use strict";o.d(t,{H:()=>f});var i=o(56415),n=o(43452),r=o(51033),s=o(68689),a=o(28022),l=o(80409),c=o(85701),u=o(17226);const d=(0,c.X)({root:{qhf8xq:"f10pi13n",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Bsft5z2:"f13zj6fq",ap17g6:"f2gz7yw",E3zdtr:"f1mdlcz9",By385i5:0,Eqx8gd:0,B1piin3:0,bn5sak:0,B58onuk:"f1nt53hs",s9ouvv:"f18xs7ez",xr36ep:"ffm3629",Bitv4sc:"f1f9zsvm",Jx5sug:"f1ub80pn",Hzyzrh:"f1e7twep"},wave:{De3pzq:"f1gjxg63",Br128sd:["f3fo419","f6m9r4"],h62rwi:["ftnv2js","f12jzhyt"],b1kco5:["fig1c6l","f1rv5y9h"],oi31me:"f103n15n"},pulse:{Br128sd:"f171zwvm",xr36ep:"fs3pcyf",Bjyk6c5:"f1yu5riq"},translucent:{De3pzq:"f162mh4z",h62rwi:["flvf4r0","f1uek97b"]},translucentPulse:{De3pzq:"flu3bqm",Bjyk6c5:"fxucc0w"}},{d:[".f10pi13n{position:relative;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],'.f13zj6fq::after{content:"";}',".f2gz7yw::after{display:block;}",".f1mdlcz9::after{position:absolute;}",[".f1nt53hs::after{inset:0;}",{p:-1}],".f18xs7ez::after{animation-iteration-count:infinite;}",".ffm3629::after{animation-duration:3s;}",".f1f9zsvm::after{animation-timing-function:ease-in-out;}",".f1gjxg63{background-color:var(--colorNeutralStencil1);}",".f3fo419::after{animation-name:f1efwx7q;}",".f6m9r4::after{animation-name:f1kkgpz1;}",".ftnv2js::after{background-image:linear-gradient(\n        to right,\n        var(--colorNeutralStencil1) 0%,\n        var(--colorNeutralStencil2) 50%,\n        var(--colorNeutralStencil1) 100%);}",".f12jzhyt::after{background-image:linear-gradient(\n        to left,\n        var(--colorNeutralStencil1) 0%,\n        var(--colorNeutralStencil2) 50%,\n        var(--colorNeutralStencil1) 100%);}",".fig1c6l::after{transform:translate(-100%);}",".f1rv5y9h::after{transform:translate(100%);}",".f171zwvm::after{animation-name:f12o7gg6;}",".fs3pcyf::after{animation-duration:1s;}",".f1yu5riq::after{background-color:var(--colorNeutralStencil1);}",".f162mh4z{background-color:var(--colorNeutralStencil1Alpha);}",".flvf4r0::after{background-image:linear-gradient(\n      to right,\n      transparent 0%,\n      var(--colorNeutralStencil1Alpha) 50%,\n      transparent 100%);}",".f1uek97b::after{background-image:linear-gradient(\n      to left,\n      transparent 0%,\n      var(--colorNeutralStencil1Alpha) 50%,\n      transparent 100%);}",".flu3bqm{background-color:none;}",".fxucc0w::after{background-color:var(--colorNeutralStencil1Alpha);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1ub80pn::after{animation-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1e7twep::after{animation-iteration-count:1;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (forced-colors: active){.f103n15n::after{background-color:WindowText;}}",{m:"screen and (forced-colors: active)"}]],k:["@keyframes f1efwx7q{to{transform:translate(100%);}}","@keyframes f1kkgpz1{to{transform:translate(-100%);}}","@keyframes f12o7gg6{0%{opacity:1;}50%{opacity:0.4;}100%{opacity:1;}}"]}),h=(0,c.X)({8:{Bqenvij:"f1x82gua"},12:{Bqenvij:"fvblgha"},16:{Bqenvij:"fd461yt"},20:{Bqenvij:"fjamq6b"},24:{Bqenvij:"frvgh55"},28:{Bqenvij:"fxldao9"},32:{Bqenvij:"f1d2rq10"},36:{Bqenvij:"f8ljn23"},40:{Bqenvij:"fbhnoac"},48:{Bqenvij:"ff2sm71"},56:{Bqenvij:"fzki0ko"},64:{Bqenvij:"f16k9i2m"},72:{Bqenvij:"f1shusfg"},96:{Bqenvij:"fypu0ge"},120:{Bqenvij:"fjr5b71"},128:{Bqenvij:"fele2au"},root:{a9b677:"fly5x3f",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ff3glw6"}},{d:[".f1x82gua{height:8px;}",".fvblgha{height:12px;}",".fd461yt{height:16px;}",".fjamq6b{height:20px;}",".frvgh55{height:24px;}",".fxldao9{height:28px;}",".f1d2rq10{height:32px;}",".f8ljn23{height:36px;}",".fbhnoac{height:40px;}",".ff2sm71{height:48px;}",".fzki0ko{height:56px;}",".f16k9i2m{height:64px;}",".f1shusfg{height:72px;}",".fypu0ge{height:96px;}",".fjr5b71{height:120px;}",".fele2au{height:128px;}",".fly5x3f{width:100%;}",[".ff3glw6{border-radius:4px;}",{p:-1}]]}),g=(0,c.X)({8:{a9b677:"f1o3cbw4",Bqenvij:"f1x82gua"},12:{a9b677:"frx94fk",Bqenvij:"fvblgha"},16:{a9b677:"fjw5fx7",Bqenvij:"fd461yt"},20:{a9b677:"f64fuq3",Bqenvij:"fjamq6b"},24:{a9b677:"fq4mcun",Bqenvij:"frvgh55"},28:{a9b677:"f1w9dchk",Bqenvij:"fxldao9"},32:{a9b677:"f1szoe96",Bqenvij:"f1d2rq10"},36:{a9b677:"fpdz1er",Bqenvij:"f8ljn23"},40:{a9b677:"feqmc2u",Bqenvij:"fbhnoac"},48:{a9b677:"f124akge",Bqenvij:"ff2sm71"},56:{a9b677:"f1u66zr1",Bqenvij:"fzki0ko"},64:{a9b677:"fa9ln6p",Bqenvij:"f16k9i2m"},72:{a9b677:"fhcae8x",Bqenvij:"f1shusfg"},96:{a9b677:"f1kyr2gn",Bqenvij:"fypu0ge"},120:{a9b677:"fwfqyga",Bqenvij:"fjr5b71"},128:{a9b677:"f1iksgmy",Bqenvij:"fele2au"}},{d:[".f1o3cbw4{width:8px;}",".f1x82gua{height:8px;}",".frx94fk{width:12px;}",".fvblgha{height:12px;}",".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f64fuq3{width:20px;}",".fjamq6b{height:20px;}",".fq4mcun{width:24px;}",".frvgh55{height:24px;}",".f1w9dchk{width:28px;}",".fxldao9{height:28px;}",".f1szoe96{width:32px;}",".f1d2rq10{height:32px;}",".fpdz1er{width:36px;}",".f8ljn23{height:36px;}",".feqmc2u{width:40px;}",".fbhnoac{height:40px;}",".f124akge{width:48px;}",".ff2sm71{height:48px;}",".f1u66zr1{width:56px;}",".fzki0ko{height:56px;}",".fa9ln6p{width:64px;}",".f16k9i2m{height:64px;}",".fhcae8x{width:72px;}",".f1shusfg{height:72px;}",".f1kyr2gn{width:96px;}",".fypu0ge{height:96px;}",".fwfqyga{width:120px;}",".fjr5b71{height:120px;}",".f1iksgmy{width:128px;}",".fele2au{height:128px;}"]}),p=(0,c.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f5q2cvs"}},{d:[[".f5q2cvs{border-radius:50%;}",{p:-1}]]}),f=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{animation:o,appearance:i}=(0,s.O)(),{animation:a=(null!=o?o:"wave"),appearance:l=(null!=i?i:"opaque"),size:c=16,shape:u="rectangle"}=e;return{appearance:l,animation:a,size:c,shape:u,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:t,...e}),{elementType:"div"})}})(e,t);return(e=>{const{animation:t,appearance:o,size:i,shape:n}=e,r=d(),s=h(),a=g(),l=p();e.root.className=(0,u.z)("fui-SkeletonItem",r.root,"wave"===t&&r.wave,"pulse"===t&&r.pulse,"translucent"===o&&r.translucent,"pulse"===t&&"translucent"===o&&r.translucentPulse,"rectangle"===n&&s.root,"rectangle"===n&&s[i],"square"===n&&a[i],"circle"===n&&l.root,"circle"===n&&a[i],e.root.className)})(o),(e=>((0,l.C)(e),(0,a.Y)(e.root,{})))(o)}));f.displayName="SkeletonItem"},3451:(e,t,o)=>{"use strict";o.d(t,{E:()=>u});var i=o(56415),n=o(43452),r=o(51033),s=o(68689),a=o(28022),l=o(80409),c=o(17226);const u=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{animation:o,appearance:i}=(0,s.O)(),{animation:a=(null!=o?o:"wave"),appearance:l=(null!=i?i:"opaque")}=e;return{animation:a,appearance:l,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:t,role:"progressbar","aria-busy":!0,...e}),{elementType:"div"})}})(e,t),u=(e=>{const{animation:t,appearance:o}=e;return{skeletonGroup:i.useMemo((()=>({animation:t,appearance:o})),[t,o])}})(o);return(e=>{e.root.className=(0,c.z)("fui-Skeleton",e.root.className)})(o),((e,t)=>((0,l.C)(e),(0,a.Y)(s.Q,{value:t.skeletonGroup,children:(0,a.Y)(e.root,{})})))(o,u)}));u.displayName="Skeleton"},68689:(e,t,o)=>{"use strict";o.d(t,{O:()=>a,Q:()=>s});var i=o(56415);const n=i.createContext(void 0),r={},s=n.Provider,a=()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}},88902:(e,t,o)=>{"use strict";o.d(t,{w:()=>v});var i=o(56415),n=o(90211),r=o(31941),s=o(83546),a=o(43452),l=o(51033),c=o(46279),u=o(28022),d=o(80409),h=o(31115),g=o(85701),p=o(17226);const f=(0,g.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bnnss6s:"fi64zpg",Eh141a:"flvyvdh",qhf8xq:"f10pi13n"},horizontal:{Bt984gj:"f1q9h2pe",Beiy3e4:"f1063pyq"},vertical:{Bt984gj:"f1q9h2pe",Beiy3e4:"f1vx9l62"}},{d:[".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fi64zpg{flex-shrink:0;}",".flvyvdh{flex-wrap:nowrap;}",".f10pi13n{position:relative;}",".f1q9h2pe{align-items:stretch;}",".f1vx9l62{flex-direction:column;}"]});var m=o(98121);const v=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{appearance:o="transparent",reserveSelectedTabSpace:u=!0,disabled:d=!1,onTabSelect:h,selectTabOnFocus:g=!1,size:p="medium",vertical:f=!1}=e,m=i.useRef(null),v=(0,n.i)({circular:!0,axis:f?"vertical":"horizontal",memorizeCurrent:!0}),[b,y]=(0,r.i)({state:e.selectedValue,defaultState:e.defaultSelectedValue,initialState:void 0}),C=i.useRef(void 0),S=i.useRef(void 0);i.useEffect((()=>{S.current=C.current,C.current=b}),[b]);const w=(0,s.D)(((e,t)=>{y(t.value),null==h||h(e,t)})),k=i.useRef({}),T=(0,s.D)((e=>{k.current[JSON.stringify(e.value)]=e})),x=(0,s.D)((e=>{delete k.current[JSON.stringify(e.value)]})),I=i.useCallback((()=>({selectedValue:C.current,previousSelectedValue:S.current,registeredTabs:k.current})),[]);return{components:{root:"div"},root:a.Gk((0,l.g)("div",{ref:(0,c.a)(t,m),role:"tablist","aria-orientation":f?"vertical":"horizontal",...v,...e}),{elementType:"div"}),appearance:o,reserveSelectedTabSpace:u,disabled:d,selectTabOnFocus:g,selectedValue:b,size:p,vertical:f,onRegister:T,onUnregister:x,onSelect:w,getRegisteredTabs:I}})(e,t),g=function(e){const{appearance:t,reserveSelectedTabSpace:o,disabled:i,selectTabOnFocus:n,selectedValue:r,onRegister:s,onUnregister:a,onSelect:l,getRegisteredTabs:c,size:u,vertical:d}=e;return{tabList:{appearance:t,reserveSelectedTabSpace:o,disabled:i,selectTabOnFocus:n,selectedValue:r,onSelect:l,onRegister:s,onUnregister:a,getRegisteredTabs:c,size:u,vertical:d}}}(o);return(e=>{const{vertical:t}=e,o=f();e.root.className=(0,p.z)("fui-TabList",o.root,t?o.vertical:o.horizontal,e.root.className)})(o),(0,m.$e)("useTabListStyles_unstable")(o),((e,t)=>((0,d.C)(e),(0,u.Y)(e.root,{children:(0,u.Y)(h.bd,{value:t.tabList,children:e.root.children})})))(o,g)}));v.displayName="TabList"},31115:(e,t,o)=>{"use strict";o.d(t,{H:()=>l,bd:()=>a});var i=o(94742);if(3023==o.j)var n=o(7102);const r={appearance:"transparent",reserveSelectedTabSpace:!0,selectTabOnFocus:!1,disabled:!1,selectedValue:void 0,onRegister:()=>{},onUnregister:()=>{},onSelect:()=>{},getRegisteredTabs:()=>({registeredTabs:{}}),size:"medium",vertical:!1},s=(0,i.q)(void 0),a=s.Provider,l=e=>(0,n.i)(s,((t=r)=>e(t)))},3194:(e,t,o)=>{"use strict";o.d(t,{o:()=>k});var i=o(56415),n=o(83546),r=o(22295),s=o(43452),a=o(19794),l=o(51033),c=o(46279),u=o(31115),d=o(28022),h=o(80409),g=o(85701),p=o(17226),f=o(42617);const m=(0,g.X)({base:{Bt984gj:"f122n59",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bceei9c:"f1k6fduh",mc9l5x:"f13qh94s",Bnnss6s:"fi64zpg",Bxotwcr:"f1u07yai",Budl1dq:"frn2hmy",wkccdc:"f1olsevy",Bahqtrf:"fk6fouc",Bg96gwp:"f1i3iumi",oeaueh:"f1s6fcnf",qhf8xq:"f10pi13n",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B9bfxx9:"f1cxpek8"},horizontal:{Brf1p80:"f4d9j23"},vertical:{Brf1p80:"f1s9ku6b"},smallHorizontal:{i8kkvl:"f14mj54c",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1wmopi4"},smallVertical:{i8kkvl:"f14mj54c",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f12or63q"},mediumHorizontal:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1w08f2p"},mediumVertical:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fymxs25"},largeHorizontal:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ssfvub"},largeVertical:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fwkd1rq"},transparent:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",ecr2s2:"fophhak",Bptxc3x:"fmmjozx",B076xvk:"f1mfqf41",q9r9w5:"f10aiid4",cl4aha:"fpkze5g",Bk452zc:"f149wc3x",a4hkcw:"fjioou7"},subtle:{De3pzq:"fhovq9v",Jwef8y:"f1t94bn6",ecr2s2:"f1wfn5kd",Bptxc3x:"fmmjozx",B076xvk:"f1mfqf41",q9r9w5:"f10aiid4",cl4aha:"fpkze5g",Bk452zc:"f149wc3x",a4hkcw:"fjioou7"},disabled:{De3pzq:"f1c21dwh",Bptxc3x:"fato7r6",cl4aha:"fao1bnu",Bceei9c:"fdrzuqr"},selected:{Bptxc3x:"f1cadz5z",B076xvk:"f1ck17l",q9r9w5:"f42ak0g",cl4aha:"ffplhdr",Bk452zc:"ffth601",a4hkcw:"fhklyu5"}},{d:[".f122n59{align-items:center;}",[".f3bhgqh{border:none;}",{p:-2}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1k6fduh{cursor:pointer;}",".f13qh94s{display:grid;}",".fi64zpg{flex-shrink:0;}",".f1u07yai{grid-auto-flow:column;}",".frn2hmy{grid-template-columns:auto;}",".f1olsevy{grid-template-rows:auto;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f1s6fcnf{outline-style:none;}",".f10pi13n{position:relative;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f1cxpek8{text-transform:none;}",".f4d9j23{justify-content:center;}",".f1s9ku6b{justify-content:start;}",".f14mj54c{column-gap:var(--spacingHorizontalXXS);}",[".f1wmopi4{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalSNudge);}",{p:-1}],[".f12or63q{padding:var(--spacingVerticalXXS) var(--spacingHorizontalSNudge);}",{p:-1}],".f1rjii52{column-gap:var(--spacingHorizontalSNudge);}",[".f1w08f2p{padding:var(--spacingVerticalM) var(--spacingHorizontalMNudge);}",{p:-1}],[".fymxs25{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalMNudge);}",{p:-1}],[".f1ssfvub{padding:var(--spacingVerticalL) var(--spacingHorizontalMNudge);}",{p:-1}],[".fwkd1rq{padding:var(--spacingVerticalS) var(--spacingHorizontalMNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fmmjozx .fui-Tab__icon{color:var(--colorNeutralForeground2);}",".fpkze5g .fui-Tab__content{color:var(--colorNeutralForeground2);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fato7r6 .fui-Tab__icon{color:var(--colorNeutralForegroundDisabled);}",".fao1bnu .fui-Tab__content{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f1cadz5z .fui-Tab__icon{color:var(--colorCompoundBrandForeground1);}",".ffplhdr .fui-Tab__content{color:var(--colorNeutralForeground1);}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".f1mfqf41:hover .fui-Tab__icon{color:var(--colorNeutralForeground2Hover);}",".f149wc3x:hover .fui-Tab__content{color:var(--colorNeutralForeground2Hover);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".f1ck17l:hover .fui-Tab__icon{color:var(--colorCompoundBrandForeground1Hover);}",".ffth601:hover .fui-Tab__content{color:var(--colorNeutralForeground1Hover);}"],a:[".fophhak:active{background-color:var(--colorTransparentBackgroundPressed);}",".f10aiid4:active .fui-Tab__icon{color:var(--colorNeutralForeground2Pressed);}",".fjioou7:active .fui-Tab__content{color:var(--colorNeutralForeground2Pressed);}",".f1wfn5kd:active{background-color:var(--colorSubtleBackgroundPressed);}",".f42ak0g:active .fui-Tab__icon{color:var(--colorCompoundBrandForeground1Pressed);}",".fhklyu5:active .fui-Tab__content{color:var(--colorNeutralForeground1Pressed);}"]}),v=(0,g.X)({base:{B8q5s1w:"f8hki3x",Bci5o5g:["f1d2448m","ffh67wi"],n8qw10:"f1bjia2o",Bdrgwmp:["ffh67wi","f1d2448m"],Bn4voq9:"f1p7hgxw",Bfpq7zp:"f1way5bb",g9k6zt:"f9znhxp",j6ew2k:["fqa318h","fqa318h"],Bhxq17a:"f1vjpng2"}},{d:[".f8hki3x[data-fui-focus-visible]{border-top-color:transparent;}",".f1d2448m[data-fui-focus-visible]{border-right-color:transparent;}",".ffh67wi[data-fui-focus-visible]{border-left-color:transparent;}",".f1bjia2o[data-fui-focus-visible]{border-bottom-color:transparent;}",".f1p7hgxw[data-fui-focus-visible]{outline-width:var(--strokeWidthThick);}",".f1way5bb[data-fui-focus-visible]{outline-color:transparent;}",".f9znhxp[data-fui-focus-visible]{outline-style:solid;}",".fqa318h[data-fui-focus-visible]{box-shadow:var(--shadow4),0 0 0 var(--strokeWidthThick) var(--colorStrokeFocus2);}",".f1vjpng2[data-fui-focus-visible]{z-index:1;}"]}),b=(0,g.X)({base:{az7l2e:"fhw179n",vqofr:0,Bv4n3vi:0,Bgqb9hq:0,B0uxbk8:0,Bf3jju6:"fg9j5n4",amg5m6:"f1kmhr4c",zkfqfm:"fl1ydde",Bkydozb:"f1y7maxz",Bka2azo:0,vzq8l0:0,csmgbd:0,Br4ovkg:0,aelrif:"fceyvr4",y36c18:"f16cxu0",B1ctymy:"f1nwgacf",Bgvrrv0:"f15ovonk",ddr6p5:"fvje46l"},disabled:{az7l2e:"f1ut20fw",Bkydozb:"fhrzcfn"},smallHorizontal:{lawp4y:"fchca7p",Baz25je:"f1r53b5e",Fbdkly:["f1s6rxz5","fo35v8s"],mdwyqc:["fo35v8s","f1s6rxz5"]},smallVertical:{lawp4y:"fze4zud",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"fdp32p8",Ccq8qp:"f1aij3q"},mediumHorizontal:{lawp4y:"fchca7p",Baz25je:"f1s2r9ax",Fbdkly:["f1o0nnkk","fxb7rol"],mdwyqc:["fxb7rol","f1o0nnkk"]},mediumVertical:{lawp4y:"f17jracn",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"f117lcb2",Ccq8qp:"f1aij3q"},largeHorizontal:{lawp4y:"fchca7p",Baz25je:"f1s2r9ax",Fbdkly:["f1o0nnkk","fxb7rol"],mdwyqc:["fxb7rol","f1o0nnkk"]},largeVertical:{lawp4y:"fel9d3z",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"f6vqlre",Ccq8qp:"f1aij3q"}},{h:[".fhw179n:hover::before{background-color:var(--colorNeutralStroke1Hover);}",[".fg9j5n4:hover::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f1kmhr4c:hover::before{content:"";}',".fl1ydde:hover::before{position:absolute;}",".f1ut20fw:hover::before{background-color:var(--colorTransparentStroke);}"],a:[".f1y7maxz:active::before{background-color:var(--colorNeutralStroke1Pressed);}",[".fceyvr4:active::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f16cxu0:active::before{content:"";}',".f1nwgacf:active::before{position:absolute;}",".fhrzcfn:active::before{background-color:var(--colorTransparentStroke);}"],m:[["@media (forced-colors: active){.f15ovonk:hover::before{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fvje46l:active::before{background-color:Highlight;}}",{m:"(forced-colors: active)"}]],d:[".fchca7p::before{bottom:0;}",".f1r53b5e::before{height:var(--strokeWidthThick);}",".f1s6rxz5::before{left:var(--spacingHorizontalSNudge);}",".fo35v8s::before{right:var(--spacingHorizontalSNudge);}",".fze4zud::before{bottom:var(--spacingVerticalXS);}",".f1fzr1x6::before{left:0;}",".f1f351id::before{right:0;}",".fdp32p8::before{top:var(--spacingVerticalXS);}",".f1aij3q::before{width:var(--strokeWidthThicker);}",".f1s2r9ax::before{height:var(--strokeWidthThicker);}",".f1o0nnkk::before{left:var(--spacingHorizontalM);}",".fxb7rol::before{right:var(--spacingHorizontalM);}",".f17jracn::before{bottom:var(--spacingVerticalS);}",".f117lcb2::before{top:var(--spacingVerticalS);}",".fel9d3z::before{bottom:var(--spacingVerticalMNudge);}",".f6vqlre::before{top:var(--spacingVerticalMNudge);}"]}),y=(0,g.X)({base:{Bjyk6c5:"f1rp0jgh",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f3b9emi",Bsft5z2:"f13zj6fq",E3zdtr:"f1mdlcz9"},selected:{Bjyk6c5:"f1ksivud",Glksuk:"f1eytvvh",Blzl0y7:"fuaa9s",f7digc:"fy7ktjt",Biqphg1:"f16tp0gf",Bntoloa:"fj0yp7j"},disabled:{Bjyk6c5:"f13lkzet"},smallHorizontal:{By385i5:"fo72kxq",Dlnsje:"f9bb2ob",Eqx8gd:["f1q70ajw","f18rbzdx"],B1piin3:["f18rbzdx","f1q70ajw"]},smallVertical:{By385i5:"fqbue9b",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"fk1klkt",a2br6o:"f1o25lip"},mediumHorizontal:{By385i5:"fo72kxq",Dlnsje:"f1vx7lu8",Eqx8gd:["fna7m5n","f1oxpfwv"],B1piin3:["f1oxpfwv","fna7m5n"]},mediumVertical:{By385i5:"fipylg0",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"fqchiol",a2br6o:"f1o25lip"},largeHorizontal:{By385i5:"fo72kxq",Dlnsje:"f1vx7lu8",Eqx8gd:["fna7m5n","f1oxpfwv"],B1piin3:["f1oxpfwv","fna7m5n"]},largeVertical:{By385i5:"f1w7dm5g",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"f1p6em4m",a2br6o:"f1o25lip"}},{d:[".f1rp0jgh::after{background-color:var(--colorTransparentStroke);}",[".f3b9emi::after{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f13zj6fq::after{content:"";}',".f1mdlcz9::after{position:absolute;}",".f1ksivud::after{background-color:var(--colorCompoundBrandStroke);}",".f13lkzet::after{background-color:var(--colorNeutralForegroundDisabled);}",".fo72kxq::after{bottom:0;}",".f9bb2ob::after{height:var(--strokeWidthThick);}",".f1q70ajw::after{left:var(--spacingHorizontalSNudge);}",".f18rbzdx::after{right:var(--spacingHorizontalSNudge);}",".fqbue9b::after{bottom:var(--spacingVerticalXS);}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",".fk1klkt::after{top:var(--spacingVerticalXS);}",".f1o25lip::after{width:var(--strokeWidthThicker);}",".f1vx7lu8::after{height:var(--strokeWidthThicker);}",".fna7m5n::after{left:var(--spacingHorizontalM);}",".f1oxpfwv::after{right:var(--spacingHorizontalM);}",".fipylg0::after{bottom:var(--spacingVerticalS);}",".fqchiol::after{top:var(--spacingVerticalS);}",".f1w7dm5g::after{bottom:var(--spacingVerticalMNudge);}",".f1p6em4m::after{top:var(--spacingVerticalMNudge);}"],h:[".f1eytvvh:hover::after{background-color:var(--colorCompoundBrandStrokeHover);}"],a:[".fuaa9s:active::after{background-color:var(--colorCompoundBrandStrokePressed);}"],m:[["@media (forced-colors: active){.fy7ktjt::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f16tp0gf:hover::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fj0yp7j:active::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}]]}),C=(0,g.X)({base:{Br312pm:"fwpfdsa",Ijaq50:"f16hsg94",Bt984gj:"f122n59",mc9l5x:"ftuwxu6",Brf1p80:"f4d9j23",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",D0sxk3:"f16u1re",t6yez3:"f8bsbmo"},small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3"},medium:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3"},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun"},selected:{D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"}},{d:[".fwpfdsa{grid-column-start:1;}",".f16hsg94{grid-row-start:1;}",".f122n59{align-items:center;}",".ftuwxu6{display:inline-flex;}",".f4d9j23{justify-content:center;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f16u1re .fui-Icon-filled{display:none;}",".f8bsbmo .fui-Icon-regular{display:inline;}",".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}"]}),S=(0,g.X)({base:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bwptpd"},selected:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"fl43uef",Bg96gwp:"f1i3iumi"},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k"},largeSelected:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},noIconBefore:{Br312pm:"fwpfdsa",Ijaq50:"f16hsg94"},iconBefore:{Br312pm:"fd46tj4",Ijaq50:"f16hsg94"},placeholder:{Bcdw1i0:"fd7fpy0"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],[".f1bwptpd{padding:var(--spacingVerticalNone) var(--spacingHorizontalXXS);}",{p:-1}],".fl43uef{font-weight:var(--fontWeightSemibold);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fwpfdsa{grid-column-start:1;}",".f16hsg94{grid-row-start:1;}",".fd46tj4{grid-column-start:2;}",".fd7fpy0{visibility:hidden;}"]});var w=o(98121);const k=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{content:o,disabled:d=!1,icon:h,onClick:g,onFocus:p,value:f}=e,m=(0,u.H)((e=>e.appearance)),v=(0,u.H)((e=>e.reserveSelectedTabSpace)),b=(0,u.H)((e=>e.selectTabOnFocus)),y=(0,u.H)((e=>e.disabled)),C=(0,u.H)((e=>e.selectedValue===f)),S=(0,u.H)((e=>e.onRegister)),w=(0,u.H)((e=>e.onUnregister)),k=(0,u.H)((e=>e.onSelect)),T=(0,u.H)((e=>e.size)),x=(0,u.H)((e=>!!e.vertical)),I=y||d,_=i.useRef(null),E=e=>k(e,{value:f}),A=(0,n.D)((0,r.p)(g,E)),R=(0,n.D)((0,r.p)(p,E));i.useEffect((()=>(S({value:f,ref:_}),()=>{w({value:f,ref:_})})),[S,w,_,f]);const B=s.lq(h,{elementType:"span"}),M=s.Gk(o,{defaultProps:{children:e.children},elementType:"span"}),D=o&&"object"==typeof o?(0,a.c)(o,["ref"]):o,O=Boolean((null==B?void 0:B.children)&&!M.children);return{components:{root:"button",icon:"span",content:"span",contentReservedSpace:"span"},root:s.Gk((0,l.g)("button",{ref:(0,c.a)(t,_),role:"tab",type:"button","aria-selected":I?void 0:`${C}`,...e,disabled:I,onClick:A,onFocus:b?R:p}),{elementType:"button"}),icon:B,iconOnly:O,content:M,contentReservedSpace:s.lq(D,{renderByDefault:!C&&!O&&v,defaultProps:{children:e.children},elementType:"span"}),appearance:m,disabled:I,selected:C,size:T,value:f,vertical:x}})(e,t);return(e=>{const t=m(),o=v(),i=b(),n=y(),r=C(),s=S(),{appearance:a,disabled:l,selected:c,size:u,vertical:d}=e;e.root.className=(0,p.z)("fui-Tab",t.base,d?t.vertical:t.horizontal,"small"===u&&(d?t.smallVertical:t.smallHorizontal),"medium"===u&&(d?t.mediumVertical:t.mediumHorizontal),"large"===u&&(d?t.largeVertical:t.largeHorizontal),o.base,!l&&"subtle"===a&&t.subtle,!l&&"transparent"===a&&t.transparent,!l&&c&&t.selected,l&&t.disabled,i.base,"small"===u&&(d?i.smallVertical:i.smallHorizontal),"medium"===u&&(d?i.mediumVertical:i.mediumHorizontal),"large"===u&&(d?i.largeVertical:i.largeHorizontal),l&&i.disabled,c&&n.base,c&&!l&&n.selected,c&&"small"===u&&(d?n.smallVertical:n.smallHorizontal),c&&"medium"===u&&(d?n.mediumVertical:n.mediumHorizontal),c&&"large"===u&&(d?n.largeVertical:n.largeHorizontal),c&&l&&n.disabled,e.root.className),e.icon&&(e.icon.className=(0,p.z)("fui-Tab__icon",r.base,r[u],c&&r.selected,e.icon.className)),e.contentReservedSpace&&(e.contentReservedSpace.className=(0,p.z)("fui-Tab__content--reserved-space",s.base,"large"===u?s.largeSelected:s.selected,e.icon?s.iconBefore:s.noIconBefore,s.placeholder,e.content.className),e.contentReservedSpaceClassName=e.contentReservedSpace.className),e.content.className=(0,p.z)("fui-Tab__content",s.base,"large"===u&&s.large,c&&("large"===u?s.largeSelected:s.selected),e.icon?s.iconBefore:s.noIconBefore,e.content.className),(0,f.U)(e)})(o),(0,w.$e)("useTabStyles_unstable")(o),(e=>((0,h.C)(e),(0,d.FD)(e.root,{children:[e.icon&&(0,d.Y)(e.icon,{}),!e.iconOnly&&(0,d.Y)(e.content,{}),e.contentReservedSpace&&(0,d.Y)(e.contentReservedSpace,{})]})))(o)}));k.displayName="Tab"},42617:(e,t,o)=>{"use strict";o.d(t,{U:()=>c});var i=o(56415),n=o(85701);if(3023==o.j)var r=o(17226);if(3023==o.j)var s=o(31115);const a=(0,n.X)({base:{B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1gl81tg"},animated:{Ba2ppi3:"fhwpy7i",F2fol1:"f6zz20j",B1dyfl9:"f1ai4sc1",B0vmy72:"f9qxlq5",u9bimw:"f1aql376"},horizontal:{sjv3b2:["fug4aj8","f1i5xzg7"],b1kco5:"f1q7ujh"},vertical:{sjv3b2:"f1hqboyk",b1kco5:"f1dxupa6"}},{d:[[".f1gl81tg{overflow:visible;}",{p:-1}],".fhwpy7i::after{transition-property:transform;}",".f6zz20j::after{transition-duration:var(--durationSlow);}",".f1ai4sc1::after{transition-timing-function:var(--curveDecelerateMax);}",".fug4aj8::after{transform-origin:left;}",".f1i5xzg7::after{transform-origin:right;}",".f1q7ujh::after{transform:translateX(var(--fui-Tab__indicator--offset)) scaleX(var(--fui-Tab__indicator--scale));}",".f1hqboyk::after{transform-origin:top;}",".f1dxupa6::after{transform:translateY(var(--fui-Tab__indicator--offset)) scaleY(var(--fui-Tab__indicator--scale));}"],m:[["@media (prefers-reduced-motion: reduce){.f9qxlq5::after{transition-property:none;}}",{m:"(prefers-reduced-motion: reduce)"}],["@media (prefers-reduced-motion: reduce){.f1aql376::after{transition-duration:0.01ms;}}",{m:"(prefers-reduced-motion: reduce)"}]]}),l=(e,t)=>{var o;const i=null!=t?null===(o=e[JSON.stringify(t)])||void 0===o?void 0:o.ref.current:void 0;return i?(e=>{if(e){var t;const o=(null===(t=e.parentElement)||void 0===t?void 0:t.getBoundingClientRect())||{x:0,y:0,width:0,height:0},i=e.getBoundingClientRect();return{x:i.x-o.x,y:i.y-o.y,width:i.width,height:i.height}}})(i):void 0},c=e=>{const{disabled:t,selected:o,vertical:n}=e,c=a(),[u,d]=i.useState(),[h,g]=i.useState({offset:0,scale:1}),p=(0,s.H)((e=>e.getRegisteredTabs));if(i.useEffect((()=>{u&&g({offset:0,scale:1})}),[u]),o){const{previousSelectedValue:e,selectedValue:t,registeredTabs:o}=p();if(e&&u!==e){const i=l(o,e),r=l(o,t);if(r&&i){const t=n?i.y-r.y:i.x-r.x,o=n?i.height/r.height:i.width/r.width;g({offset:t,scale:o}),d(e)}}}else u&&d(void 0);if(t)return e;const f=0===h.offset&&1===h.scale;e.root.className=(0,r.z)(e.root.className,o&&c.base,o&&f&&c.animated,o&&(n?c.vertical:c.horizontal));const m={"--fui-Tab__indicator--offset":`${h.offset}px`,"--fui-Tab__indicator--scale":`${h.scale}`};return e.root.style={...m,...e.root.style},e}},43173:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(70398);if(3023==o.j)var n=o(6841);if(3023==o.j)var r=o(56496);const s=(e={})=>{const{circular:t,axis:o,memorizeCurrent:s=!0,tabbable:l,ignoreDefaultKeydown:c,unstable_hasDefault:u}=e,d=(0,r.p)();return d&&(0,i.S)(d),(0,n.g)({mover:{cyclic:!!t,direction:a(null!=o?o:"vertical"),memorizeCurrent:s,tabbable:l,hasDefault:u},...c&&{focusable:{ignoreKeydown:c}}})};function a(e){switch(e){case"horizontal":return i.iA.Horizontal;case"grid":return i.iA.Grid;case"grid-linear":return i.iA.GridLinear;case"both":return i.iA.Both;default:return i.iA.Vertical}}},12382:(e,t,o)=>{"use strict";o.d(t,{r:()=>s});var i=o(56415);if(3023==o.j)var n=o(33341);if(3023==o.j)var r=o(56496);const s=()=>{const e=(0,r.p)(),{targetDocument:t}=(0,n.Y)();return{findAllFocusable:i.useCallback(((t,o)=>(null==e?void 0:e.focusable.findAll({container:t,acceptCondition:o}))||[]),[e]),findFirstFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findFirst({container:t})),[e]),findLastFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findLast({container:t})),[e]),findNextFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findNext({currentElement:o,container:n})}),[e,t]),findPrevFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findPrev({currentElement:o,container:n})}),[e,t])}}},20331:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>a}),3023==o.j)var i=o(37092);if(3023==o.j)var n=o(6841);if(3023==o.j)var r=o(70398);if(3023==o.j)var s=o(56496);const a=(e={})=>{const{trapFocus:t,alwaysFocusable:o,legacyTrapFocus:a}=e,l=(0,s.p)();l&&((0,r.Az)(l),(0,r.mz)(l));const c=(0,i.Bi)("modal-",e.id);return{modalAttributes:(0,n.g)({restorer:{type:r.CP.Source},...t&&{modalizer:{id:c,isOthersAccessible:!t,isAlwaysAccessible:o,isTrapped:a&&t}}}),triggerAttributes:(0,n.g)({restorer:{type:r.CP.Target}})}}},10413:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>s,X:()=>r}),3023==o.j)var i=o(70398);if(3023==o.j)var n=o(56496);function r(){const e=(0,n.p)();return e&&(0,i.mz)(e),(0,i.U6)({restorer:{type:i.CP.Target}})}function s(){const e=(0,n.p)();return e&&(0,i.mz)(e),(0,i.U6)({restorer:{type:i.CP.Source}})}},56496:(e,t,o)=>{"use strict";o.d(t,{p:()=>l});var i=o(56415);if(3023==o.j)var n=o(33341);if(3023==o.j)var r=o(70398);if(3023==o.j)var s=o(37005);if(3023==o.j)var a=o(38991);const l=()=>{const{targetDocument:e}=(0,n.Y)(),t=(null==e?void 0:e.defaultView)||void 0,o=null==t?void 0:t.__tabsterShadowDOMAPI,l=i.useMemo((()=>t?(0,r._A)(t,{autoRoot:{},controlTab:!1,getParent:s.P,checkUncontrolledTrappingFocus:e=>{var t;return!!(null===(t=e.firstElementChild)||void 0===t?void 0:t.hasAttribute("data-is-focus-trap-zone-bumper"))},DOMAPI:o}):null),[t,o]);return(0,a.E)((()=>()=>{l&&(0,r.hC)(l)}),[l]),l}},6841:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(70398);if(3023==o.j)var n=o(56496);var r=o(56415);const s=e=>{(0,n.p)();const t=(0,i.U6)(e,!0);return r.useMemo((()=>({[i.h7]:t})),[t])}},35595:(e,t,o)=>{"use strict";o.d(t,{A7:()=>i});const i="data-fui-focus-visible"},95589:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>s}),3023==o.j)var i=o(51664);if(3023==o.j)var n=o(13327);if(3023==o.j)var r=o(35595);function s(e,t){if(a(e))return()=>{};const o={current:void 0},s=(0,n.SQ)(t);function l(e){s.isNavigatingWithKeyboard()&&(0,i.s)(e)&&(o.current=e,e.setAttribute(r.A7,""))}function c(){o.current&&(o.current.removeAttribute(r.A7),o.current=void 0)}s.subscribe((e=>{e||c()}));const u=e=>{c(),l(e.composedPath()[0])},d=t=>{(!t.relatedTarget||(0,i.s)(t.relatedTarget)&&!e.contains(t.relatedTarget))&&c()};return e.addEventListener(n.Oy,u),e.addEventListener("focusout",d),e.focusVisible=!0,e.contains(t.document.activeElement)&&l(t.document.activeElement),()=>{c(),e.removeEventListener(n.Oy,u),e.removeEventListener("focusout",d),delete e.focusVisible,(0,n.bd)(s)}}function a(e){return!!e&&(!!e.focusVisible||a(null==e?void 0:e.parentElement))}},90211:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(70398);if(3023==o.j)var n=o(3779);if(3023==o.j)var r=o(48918);const s=(e={})=>{const{circular:t,axis:o,memorizeCurrent:s=!0,tabbable:l,ignoreDefaultKeydown:c,unstable_hasDefault:u}=e,d=(0,r.p)();return d&&(0,i.S)(d),(0,n.g)({mover:{cyclic:!!t,direction:a(null!=o?o:"vertical"),memorizeCurrent:s,tabbable:l,hasDefault:u},...c&&{focusable:{ignoreKeydown:c}}})};function a(e){switch(e){case"horizontal":return i.iA.Horizontal;case"grid":return i.iA.Grid;case"grid-linear":return i.iA.GridLinear;case"both":return i.iA.Both;default:return i.iA.Vertical}}},50012:(e,t,o)=>{"use strict";o.d(t,{r:()=>s});var i=o(56415);if(3023==o.j)var n=o(33341);if(3023==o.j)var r=o(48918);const s=()=>{const e=(0,r.p)(),{targetDocument:t}=(0,n.Y)();return{findAllFocusable:i.useCallback(((t,o)=>(null==e?void 0:e.focusable.findAll({container:t,acceptCondition:o}))||[]),[e]),findFirstFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findFirst({container:t})),[e]),findLastFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findLast({container:t})),[e]),findNextFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findNext({currentElement:o,container:n})}),[e,t]),findPrevFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findPrev({currentElement:o,container:n})}),[e,t])}}},30723:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(56415);if(3023==o.j)var n=o(33341);if(3023==o.j)var r=o(95589);function s(e={}){const t=(0,n.Y)(),o=i.useRef(null);var s;const a=null!==(s=e.targetDocument)&&void 0!==s?s:t.targetDocument;return i.useEffect((()=>{if((null==a?void 0:a.defaultView)&&o.current)return(0,r.y)(o.current,a.defaultView)}),[o,a]),o}},42989:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>a}),3023==o.j)var i=o(37092);if(3023==o.j)var n=o(3779);if(3023==o.j)var r=o(70398);if(3023==o.j)var s=o(48918);const a=(e={})=>{const{trapFocus:t,alwaysFocusable:o,legacyTrapFocus:a}=e,l=(0,s.p)();l&&((0,r.Az)(l),(0,r.mz)(l));const c=(0,i.Bi)("modal-",e.id);return{modalAttributes:(0,n.g)({restorer:{type:r.CP.Source},...t&&{modalizer:{id:c,isOthersAccessible:!t,isAlwaysAccessible:o,isTrapped:a&&t}}}),triggerAttributes:(0,n.g)({restorer:{type:r.CP.Target}})}}},48918:(e,t,o)=>{"use strict";o.d(t,{p:()=>l});var i=o(56415);if(3023==o.j)var n=o(33341);if(3023==o.j)var r=o(70398);if(3023==o.j)var s=o(37005);if(3023==o.j)var a=o(38991);const l=()=>{const{targetDocument:e}=(0,n.Y)(),t=(null==e?void 0:e.defaultView)||void 0,o=null==t?void 0:t.__tabsterShadowDOMAPI,l=i.useMemo((()=>t?(0,r._A)(t,{autoRoot:{},controlTab:!1,getParent:s.P,checkUncontrolledTrappingFocus:e=>{var t;return!!(null===(t=e.firstElementChild)||void 0===t?void 0:t.hasAttribute("data-is-focus-trap-zone-bumper"))},DOMAPI:o}):null),[t,o]);return(0,a.E)((()=>()=>{l&&(0,r.hC)(l)}),[l]),l}},3779:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(70398);if(3023==o.j)var n=o(48918);var r=o(56415);const s=e=>{(0,n.p)();const t=(0,i.U6)(e,!0);return r.useMemo((()=>({[i.h7]:t})),[t])}},93952:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,d:()=>i});const i=6,n=4},82169:(e,t,o)=>{"use strict";o.d(t,{g:()=>n});var i=o(56415);function n(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&!(0,i.isValidElement)(e)}},21678:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>a}),3023==o.j)var i=o(28148);if(3023==o.j)var n=o(33341);const r=e=>(e(0),0),s=e=>e;function a(){const{targetDocument:e}=(0,n.Y)(),t=null==e?void 0:e.defaultView,o=t?t.requestAnimationFrame:r,a=t?t.cancelAnimationFrame:s;return(0,i.X)(o,a)}},55134:(e,t,o)=>{"use strict";o.d(t,{t:()=>n});var i=o(56415);function n(){const e=i.useRef(!0);return e.current?(e.current=!1,!0):e.current}},93991:(e,t,o)=>{"use strict";o.d(t,{C:()=>n});var i=o(56415);function n(){return(0,i.useReducer)((e=>e+1),0)[1]}},23779:(e,t,o)=>{"use strict";o.d(t,{W:()=>a});var i=o(56415);if(3023==o.j)var n=o(83546);if(3023==o.j)var r=o(33341);const s=(e,t)=>!!(null==e?void 0:e.contains(t)),a=e=>{const{targetDocument:t}=(0,r.Y)(),o=null==t?void 0:t.defaultView,{refs:a,callback:c,element:d,disabled:h,disabledFocusOnIframe:g,contains:p=s}=e,f=i.useRef(void 0);u({element:d,disabled:g||h,callback:c,refs:a,contains:p});const m=i.useRef(!1),v=(0,n.D)((e=>{if(m.current)return void(m.current=!1);const t=e.composedPath()[0];a.every((e=>!p(e.current||null,t)))&&!h&&c(e)})),b=(0,n.D)((e=>{m.current=a.some((t=>p(t.current||null,e.target)))}));i.useEffect((()=>{if(h)return;let e=l(o);const t=t=>{t!==e?v(t):e=void 0};return null==d||d.addEventListener("click",t,!0),null==d||d.addEventListener("touchstart",t,!0),null==d||d.addEventListener("contextmenu",t,!0),null==d||d.addEventListener("mousedown",b,!0),f.current=null==o?void 0:o.setTimeout((()=>{e=void 0}),1),()=>{null==d||d.removeEventListener("click",t,!0),null==d||d.removeEventListener("touchstart",t,!0),null==d||d.removeEventListener("contextmenu",t,!0),null==d||d.removeEventListener("mousedown",b,!0),null==o||o.clearTimeout(f.current),e=void 0}}),[v,d,h,b,o])},l=e=>{var t,o,i;if(e)return"object"==typeof e.window&&e.window===e?e.event:null!==(i=null===(o=e.ownerDocument)||void 0===o||null===(t=o.defaultView)||void 0===t?void 0:t.event)&&void 0!==i?i:void 0},c="fuiframefocus",u=e=>{const{disabled:t,element:o,callback:r,contains:a=s,pollDuration:l=1e3,refs:u}=e,d=i.useRef(),h=(0,n.D)((e=>{u.every((t=>!a(t.current||null,e.target)))&&!t&&r(e)}));i.useEffect((()=>{if(!t)return null==o||o.addEventListener(c,h,!0),()=>{null==o||o.removeEventListener(c,h,!0)}}),[o,t,h]),i.useEffect((()=>{var e;if(!t)return d.current=null==o||null===(e=o.defaultView)||void 0===e?void 0:e.setInterval((()=>{const e=null==o?void 0:o.activeElement;if("IFRAME"===(null==e?void 0:e.tagName)||"WEBVIEW"===(null==e?void 0:e.tagName)){const t=new CustomEvent(c,{bubbles:!0});e.dispatchEvent(t)}}),l),()=>{var e;null==o||null===(e=o.defaultView)||void 0===e||e.clearTimeout(d.current)}}),[o,t,l])}},84270:(e,t,o)=>{"use strict";o.d(t,{z:()=>r});var i=o(56415);if(3023==o.j)var n=o(83546);const r=e=>{const{refs:t,callback:o,element:r,disabled:s,contains:a}=e,l=(0,n.D)((e=>{const i=a||((e,t)=>!!(null==e?void 0:e.contains(t))),n=e.composedPath()[0];t.every((e=>!i(e.current||null,n)))&&!s&&o(e)}));i.useEffect((()=>{if(!s)return null==r||r.addEventListener("wheel",l),null==r||r.addEventListener("touchmove",l),()=>{null==r||r.removeEventListener("wheel",l),null==r||r.removeEventListener("touchmove",l)}}),[l,r,s])}},67894:(e,t,o)=>{"use strict";o.d(t,{L:()=>r});var i=o(56415);if(3023==o.j)var n=o(2280);function r(e,t){return"function"==typeof e?e(t):e?s(e,t):e||null}function s(e,t){if(!i.isValidElement(e)||e.type===i.Fragment)throw new Error("A trigger element must be a single element for this component. Please ensure that you're not using React Fragments.");if((0,n.Z)(e)){const o=s(e.props.children,t);return i.cloneElement(e,void 0,o)}return i.cloneElement(e,t)}},44760:(e,t,o)=>{"use strict";o.d(t,{h:()=>r});var i=o(56415);if(3023==o.j)var n=o(2280);function r(e){return i.isValidElement(e)?(0,n.Z)(e)?r(e.props.children):e:null}},2280:(e,t,o)=>{"use strict";function i(e){return Boolean(e.type.isFluentTriggerComponent)}o.d(t,{Z:()=>i}),o(56415)},19794:(e,t,o)=>{"use strict";function i(e,t){const o={};for(const i in e)-1===t.indexOf(i)&&e.hasOwnProperty(i)&&(o[i]=e[i]);return o}o.d(t,{c:()=>i})},71864:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>n}),3023==o.j)var i=o(37005);function n(e,t){if(!e||!t)return!1;if(e===t)return!0;{const o=new WeakSet;for(;t;){const n=(0,i.P)(t,{skipVirtual:o.has(t)});if(o.add(t),n===e)return!0;t=n}}return!1}},37005:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>n}),3023==o.j)var i=o(91864);function n(e,t={}){if(!e)return null;if(!t.skipVirtual){const t=function(e){return(0,i.q)(e)&&e._virtual.parent||null}(e);if(t)return t}const o=e.parentNode;return o&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o}},91864:(e,t,o)=>{"use strict";function i(e){return e&&!!e._virtual}o.d(t,{q:()=>i})},62886:(e,t,o)=>{"use strict";function i(e,t){if(!e)return;const o=e;o._virtual||(o._virtual={}),o._virtual.parent=t}o.d(t,{g:()=>i})},5730:(e,t,o)=>{"use strict";o.d(t,{C:()=>s,J:()=>l});var i=o(73027),n=o(33980),r=o(94255),s=36,a=(0,n.L6)(0,n.mm),l=(0,r.J9)((function(e){var t,o,r,l,c,u=e.semanticColors,d=e.fonts,h=e.palette,g=u.menuItemBackgroundHovered,p=u.menuItemTextHovered,f=u.menuItemBackgroundPressed,m=u.bodyDivider,v={item:[d.medium,{color:u.bodyText,position:"relative",boxSizing:"border-box"}],divider:{display:"block",height:"1px",backgroundColor:m,position:"relative"},root:[(0,n.gm)(e),d.medium,{color:u.bodyText,backgroundColor:"transparent",border:"none",width:"100%",height:s,lineHeight:s,display:"block",cursor:"pointer",padding:"0px 8px 0 4px",textAlign:"left"}],rootDisabled:{color:u.disabledBodyText,cursor:"default",pointerEvents:"none",selectors:(t={},t[n.up]={color:"GrayText",opacity:1},t)},rootHovered:{backgroundColor:g,color:p,selectors:{".ms-ContextualMenu-icon":{color:h.themeDarkAlt},".ms-ContextualMenu-submenuIcon":{color:h.neutralPrimary}}},rootFocused:{backgroundColor:h.white},rootChecked:{selectors:{".ms-ContextualMenu-checkmarkIcon":{color:h.neutralPrimary}}},rootPressed:{backgroundColor:f,selectors:{".ms-ContextualMenu-icon":{color:h.themeDark},".ms-ContextualMenu-submenuIcon":{color:h.neutralPrimary}}},rootExpanded:{backgroundColor:f,color:u.bodyTextChecked,selectors:(o={".ms-ContextualMenu-submenuIcon":(r={},r[n.up]={color:"inherit"},r)},o[n.up]=(0,i.Cl)({},(0,n.Qg)()),o)},linkContent:{whiteSpace:"nowrap",height:"inherit",display:"flex",alignItems:"center",maxWidth:"100%"},anchorLink:{padding:"0px 8px 0 4px",textRendering:"auto",color:"inherit",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",textDecoration:"none",boxSizing:"border-box"},label:{margin:"0 4px",verticalAlign:"middle",display:"inline-block",flexGrow:"1",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},secondaryText:{color:e.palette.neutralSecondary,paddingLeft:"20px",textAlign:"right"},icon:{display:"inline-block",minHeight:"1px",maxHeight:s,fontSize:n.fF.medium,width:n.fF.medium,margin:"0 4px",verticalAlign:"middle",flexShrink:"0",selectors:(l={},l[a]={fontSize:n.fF.large,width:n.fF.large},l)},iconColor:{color:u.menuIcon},iconDisabled:{color:u.disabledBodyText},checkmarkIcon:{color:u.bodySubtext},subMenuIcon:{height:s,lineHeight:s,color:h.neutralSecondary,textAlign:"center",display:"inline-block",verticalAlign:"middle",flexShrink:"0",fontSize:n.fF.small,selectors:(c={":hover":{color:h.neutralPrimary},":active":{color:h.neutralPrimary}},c[a]={fontSize:n.fF.medium},c)},splitButtonFlexContainer:[(0,n.gm)(e),{display:"flex",height:s,flexWrap:"nowrap",justifyContent:"center",alignItems:"flex-start"}]};return(0,n.TW)(v)}))},81991:(e,t,o)=>{"use strict";o.d(t,{Y:()=>T});var i=o(73027),n=o(56415),r=o(61108),s=o(39011),a=o(74004),l=o(9190),c=function(e){for(var t=e.activeElement;null==t?void 0:t.shadowRoot;)t=t.shadowRoot.activeElement;return t},u=function(e){var t=e.target;return t&&t.shadowRoot&&(t=e.composedPath()[0]),t},d=o(18687),h=o(77198),g=o(92090),p=o(8427),f=o(61888),m=o(2478),v=o(94520),b=o(21690);function y(e){var t=n.useRef((function(){throw new Error("Cannot call an event handler while rendering")}));return(0,b.E)((function(){t.current=e}),[e]),(0,m.d)((function(){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.current.apply(void 0,e)}}))}var C=o(46861),S=o(96018),w=o(17874),k={disabled:!1,disableFirstFocus:!1,forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!1,"data-tabster":'{"uncontrolled": {"completely": true}}'},T=n.forwardRef((function(e,t){var o,b=n.useRef(null),x=n.useRef(null),I=n.useRef(null),_=(0,p.a)(b,t),E=(0,S.ZY)(),A=(0,w.bX)(),R=(0,r.h)(),B=null===(o=(0,f.Z)(!1))||void 0===o||o,M=(0,s.N)(k,e),D=(0,m.d)({hasFocus:!1,focusStackId:(0,v.B)("ftz-",M.id)}),O=M.children,F=M.componentRef,P=M.disabled,N=M.disableFirstFocus,L=M.forceFocusInsideTrap,j=M.focusPreviouslyFocusedInnerElement,q=M.firstFocusableSelector,H=M.firstFocusableTarget,z=M.disableRestoreFocus,W=void 0===z?M.ignoreExternalFocusing:z,G=M.isClickableOutsideFocusTrap,U=M.enableAriaHiddenSiblings,V={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:P?-1:0,"data-is-visible":!0,"data-is-focus-trap-zone-bumper":!0},$=n.useCallback((function(e){e!==x.current&&e!==I.current&&(0,a.lo)(e)}),[]),K=y((function(){if(b.current){var e=D.previouslyFocusedElementInTrapZone;if(j&&e&&(0,l.s)(b.current,e))$(e);else{var t=null;if("string"==typeof H)t=b.current.querySelector(H);else if(H)t=H(b.current);else if(q){var o="string"==typeof q?q:q();t=b.current.querySelector("."+o)}t||(t=(0,a.eX)(b.current,b.current.firstChild,!1,!1,!1,!0,void 0,void 0,void 0,R)),t&&$(t)}}})),Q=function(e){if(!P&&b.current){var t=e===D.hasFocus?(0,a.Cm)(b.current,I.current,!0,!1,R):(0,a.oR)(b.current,x.current,!0,!1,R);t&&(t===x.current||t===I.current?K():t.focus())}},Y=y((function(e){if(T.focusStack=T.focusStack.filter((function(e){return D.focusStackId!==e})),E){var t=E.activeElement;W||"function"!=typeof(null==e?void 0:e.focus)||!(0,l.s)(b.current,t)&&t!==E.body&&!t.shadowRoot||$(e)}})),J=y((function(e){if(!P&&D.focusStackId===T.focusStack.slice(-1)[0]){var t=u(e);t&&!(0,l.s)(b.current,t)&&(E&&c(E)===E.body?setTimeout((function(){E&&c(E)===E.body&&(K(),D.hasFocus=!0)}),0):(K(),D.hasFocus=!0),e.preventDefault(),e.stopPropagation())}}));return n.useEffect((function(){var e=[];return L&&e.push((0,d.on)(A,"focus",J,!0)),G||e.push((0,d.on)(A,"click",J,!0)),function(){e.forEach((function(e){return e()}))}}),[L,G,A]),n.useEffect((function(){if(!P&&(B||L)&&b.current){T.focusStack.push(D.focusStackId);var e=M.elementToFocusOnDismiss||c(E);return N||(0,l.s)(b.current,e)||K(),function(){return Y(e)}}}),[L,P]),n.useEffect((function(){if(!P&&U)return(0,h.q)(b.current)}),[P,U,b]),(0,C.i)((function(){delete D.previouslyFocusedElementInTrapZone})),function(e,t,o){n.useImperativeHandle(e,(function(){return{get previouslyFocusedElement(){return t},focus:o}}),[o,t])}(F,D.previouslyFocusedElementInTrapZone,K),n.createElement("div",(0,i.Cl)({"aria-labelledby":M.ariaLabelledBy},(0,g.G1)(M,g.JM),{ref:_,onFocusCapture:function(e){var t;null===(t=M.onFocusCapture)||void 0===t||t.call(M,e),e.target===x.current?Q(!0):e.target===I.current&&Q(!1),D.hasFocus=!0,e.target!==e.currentTarget&&e.target!==x.current&&e.target!==I.current&&(D.previouslyFocusedElementInTrapZone=u(e.nativeEvent))},onBlurCapture:function(e){var t;null===(t=M.onBlurCapture)||void 0===t||t.call(M,e);var o=e.relatedTarget;null===e.relatedTarget&&(o=c(E)),(0,l.s)(b.current,o)||(D.hasFocus=!1)}}),n.createElement("div",(0,i.Cl)({},V,{ref:x})),O,n.createElement("div",(0,i.Cl)({},V,{ref:I})))}));T.displayName="FocusTrapZone",T.focusStack=[]},37418:(e,t,o)=>{"use strict";o.d(t,{_:()=>v});var i=o(9916),n=o(73027),r=o(56415),s=o(48499),a=o(92090),l=o(1022),c=o(21690),u=o(8427),d=(0,s.Z)(),h=/\.svg$/i,g=r.forwardRef((function(e,t){var o=r.useRef(),i=r.useRef(),s=function(e,t){var o=e.onLoadingStateChange,i=e.onLoad,n=e.onError,s=e.src,a=r.useState(l.P6.notLoaded),u=a[0],d=a[1];(0,c.E)((function(){d(l.P6.notLoaded)}),[s]),r.useEffect((function(){u===l.P6.notLoaded&&t.current&&(s&&t.current.naturalWidth>0&&t.current.naturalHeight>0||t.current.complete&&h.test(s))&&d(l.P6.loaded)})),r.useEffect((function(){null==o||o(u)}),[u]);var g=r.useCallback((function(e){null==i||i(e),s&&d(l.P6.loaded)}),[s,i]),p=r.useCallback((function(e){null==n||n(e),d(l.P6.error)}),[n]);return[u,g,p]}(e,i),g=s[0],p=s[1],f=s[2],m=(0,a.G1)(e,a.xM,["width","height"]),v=e.src,b=e.alt,y=e.width,C=e.height,S=e.shouldFadeIn,w=void 0===S||S,k=e.shouldStartVisible,T=e.className,x=e.imageFit,I=e.role,_=e.maximizeFrame,E=e.styles,A=e.theme,R=e.loading,B=function(e,t,o,i){var n=r.useRef(t),s=r.useRef();return(void 0===s||n.current===l.P6.notLoaded&&t===l.P6.loaded)&&(s.current=function(e,t,o,i){var n=e.imageFit,r=e.width,s=e.height;if(void 0!==e.coverStyle)return e.coverStyle;if(t===l.P6.loaded&&(n===l.N_.cover||n===l.N_.contain||n===l.N_.centerContain||n===l.N_.centerCover)&&o.current&&i.current){var a;if(a="number"==typeof r&&"number"==typeof s&&n!==l.N_.centerContain&&n!==l.N_.centerCover?r/s:i.current.clientWidth/i.current.clientHeight,o.current.naturalWidth/o.current.naturalHeight>a)return l.Aw.landscape}return l.Aw.portrait}(e,t,o,i)),n.current=t,s.current}(e,g,i,o),M=d(E,{theme:A,className:T,width:y,height:C,maximizeFrame:_,shouldFadeIn:w,shouldStartVisible:k,isLoaded:g===l.P6.loaded||g===l.P6.notLoaded&&e.shouldStartVisible,isLandscape:B===l.Aw.landscape,isCenter:x===l.N_.center,isCenterContain:x===l.N_.centerContain,isCenterCover:x===l.N_.centerCover,isContain:x===l.N_.contain,isCover:x===l.N_.cover,isNone:x===l.N_.none,isError:g===l.P6.error,isNotImageFit:void 0===x});return r.createElement("div",{className:M.root,style:{width:y,height:C},ref:o},r.createElement("img",(0,n.Cl)({},m,{onLoad:p,onError:f,key:"fabricImage"+e.src||"",className:M.image,ref:(0,u.a)(i,t),src:v,alt:b,role:I,loading:R})))}));g.displayName="ImageBase";var p=o(33980),f=o(99148),m={root:"ms-Image",rootMaximizeFrame:"ms-Image--maximizeFrame",image:"ms-Image-image",imageCenter:"ms-Image-image--center",imageContain:"ms-Image-image--contain",imageCover:"ms-Image-image--cover",imageCenterContain:"ms-Image-image--centerContain",imageCenterCover:"ms-Image-image--centerCover",imageNone:"ms-Image-image--none",imageLandscape:"ms-Image-image--landscape",imagePortrait:"ms-Image-image--portrait"},v=(0,i.I)(g,(function(e){var t=e.className,o=e.width,i=e.height,n=e.maximizeFrame,r=e.isLoaded,s=e.shouldFadeIn,a=e.shouldStartVisible,l=e.isLandscape,c=e.isCenter,u=e.isContain,d=e.isCover,h=e.isCenterContain,g=e.isCenterCover,v=e.isNone,b=e.isError,y=e.isNotImageFit,C=e.theme,S=(0,p.Km)(m,C),w={position:"absolute",left:"50% /* @noflip */",top:"50%",transform:"translate(-50%,-50%)"},k=(0,f.z)(),T=void 0!==k&&void 0===k.navigator.msMaxTouchPoints,x=u&&l||d&&!l?{width:"100%",height:"auto"}:{width:"auto",height:"100%"};return{root:[S.root,C.fonts.medium,{overflow:"hidden"},n&&[S.rootMaximizeFrame,{height:"100%",width:"100%"}],r&&s&&!a&&p.lw.fadeIn400,(c||u||d||h||g)&&{position:"relative"},t],image:[S.image,{display:"block",opacity:0},r&&["is-loaded",{opacity:1}],c&&[S.imageCenter,w],u&&[S.imageContain,T&&{width:"100%",height:"100%",objectFit:"contain"},!T&&x,!T&&w],d&&[S.imageCover,T&&{width:"100%",height:"100%",objectFit:"cover"},!T&&x,!T&&w],h&&[S.imageCenterContain,l&&{maxWidth:"100%"},!l&&{maxHeight:"100%"},w],g&&[S.imageCenterCover,l&&{maxHeight:"100%"},!l&&{maxWidth:"100%"},w],v&&[S.imageNone,{width:"auto",height:"auto"}],y&&[!!o&&!i&&{height:"auto",width:"100%"},!o&&!!i&&{height:"100%",width:"auto"},!!o&&!!i&&{height:"100%",width:"100%"}],l&&S.imageLandscape,!l&&S.imagePortrait,!r&&"is-notLoaded",s&&"is-fadeIn",b&&"is-error"]}}),void 0,{scope:"Image"},!0);v.displayName="Image"},1022:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{Aw:()=>n,N_:()=>i,P6:()=>r}),function(e){e[e.center=0]="center",e[e.contain=1]="contain",e[e.cover=2]="cover",e[e.none=3]="none",e[e.centerCover=4]="centerCover",e[e.centerContain=5]="centerContain"}(i||(i={})),function(e){e[e.landscape=0]="landscape",e[e.portrait=1]="portrait"}(n||(n={})),function(e){e[e.notLoaded=0]="notLoaded",e[e.loaded=1]="loaded",e[e.error=2]="error",e[e.errorLoaded=3]="errorLoaded"}(r||(r={}))},82804:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>d}),3023==o.j)var i=o(73027);var n=o(56415);if(3023==o.j)var r=o(2478);if(3023==o.j)var s=o(61888);if(3023==o.j)var a=o(21690);if(3023==o.j)var l=o(86402);if(3023==o.j)var c=o(6903);if(3023==o.j)var u=o(62589);function d(e){var t=n.useRef(),o=e.keytipProps?(0,i.Cl)({disabled:e.disabled},e.keytipProps):void 0,d=(0,r.d)(c._.getInstance()),h=(0,s.Z)(e);(0,a.E)((function(){t.current&&o&&((null==h?void 0:h.keytipProps)!==e.keytipProps||(null==h?void 0:h.disabled)!==e.disabled)&&d.update(o,t.current)})),(0,a.E)((function(){return o&&(t.current=d.register(o)),function(){o&&d.unregister(o,t.current)}}),[]);var g={ariaDescribedBy:void 0,keytipId:void 0};return o&&(g=function(e,t,o){var n=e.addParentOverflow(t),r=(0,l._)(o,(0,u.gt)(n.keySequences)),s=(0,i.fX)([],n.keySequences,!0);return n.overflowSetSequence&&(s=(0,u.YY)(s,n.overflowSetSequence)),{ariaDescribedBy:r,keytipId:(0,u.Z2)(s)}}(d,o,e.ariaDescribedBy)),g}},45373:(e,t,o)=>{"use strict";o.d(t,{D:()=>i});var i=o(56415).createContext(void 0)},26473:(e,t,o)=>{"use strict";if(o.d(t,{j:()=>u}),3023==o.j)var i=o(73027);var n=o(56415);if(3023==o.j)var r=o(32186);if(3023==o.j)var s=o(95848);if(3023==o.j)var a=o(9348);if(3023==o.j)var l=o(91005);if(3023==o.j)var c=o(45373);var u=function(e){var t=e.customizerContext,o=e.ref,u=e.theme,d=e.as||"div",h="string"==typeof e.as?(0,r._)(e.as,e):e.as===n.Fragment?{children:e.children}:(0,s.cJ)(e,["as"]);return n.createElement(c.D.Provider,{value:u},n.createElement(a.z.Provider,{value:t},n.createElement(l.N,{providerRef:o},n.createElement(d,(0,i.Cl)({},h)))))}},28352:(e,t,o)=>{"use strict";o.d(t,{K:()=>l});var i=o(14443),n=o(11911),r=o(94863),s=o(20794),a=0,l={reset:function(){i.nr.getInstance().onReset((function(){return a++}))},getId:function(){return a},renderStyles:function(e,t){return(0,n.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,r.n)(e)},renderKeyframes:function(e){return(0,s.i)(e)}}},89757:(e,t,o)=>{"use strict";o.d(t,{D:()=>a});var i=o(56415);if(3023==o.j)var n=o(53937);if(3023==o.j)var r=o(88499);if(3023==o.j)var s=o(45373);var a=function(){var e=(0,i.useContext)(s.D),t=(0,n.m)(["theme"]).theme;return e||t||(0,r.a)({})}},72007:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>l}),3023==o.j)var i=o(12663);var n=o(56415);if(3023==o.j)var r=o(89757);if(3023==o.j)var s=o(37918);var a=new Map,l=function(e){var t=e.theme,o=(0,r.D)(),l=e.theme=n.useMemo((function(){var e=(0,i.z)(o,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=[],i=0,n=e;i<n.length;i++){var r=n[i];if(r){var l=r.id||a.get(r);l||(l=(0,s.O)(""),a.set(r,l)),o.push(l)}}return o.join("-")}(o,t),e}),[o,t]);e.customizerContext=n.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:l},scopedSettings:l.components||{}}}}),[l]),e.theme.rtl!==o.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")}},81232:(e,t,o)=>{"use strict";var i;o.d(t,{AR:()=>i,YF:()=>a,kA:()=>c}),o(56415),function(e){e[e.small=0]="small",e[e.medium=1]="medium",e[e.large=2]="large",e[e.xLarge=3]="xLarge",e[e.xxLarge=4]="xxLarge",e[e.xxxLarge=5]="xxxLarge",e[e.unknown=999]="unknown"}(i||(i={}));var n,r,s=3023==o.j?[479,639,1023,1365,1919,99999999]:null;function a(){var e;return null!==(e=null!=n?n:r)&&void 0!==e?e:i.large}function l(e){try{return e.document.documentElement.clientWidth}catch(t){return e.innerWidth}}function c(e){var t=i.small;if(e){try{for(;l(e)>s[t];)t++}catch(e){t=a()}r=t}else{if(void 0===n)throw new Error("Content was rendered in a server environment without providing a default responsive mode. Call setResponsiveMode to define what the responsive mode is.");t=n}return t}},43289:(e,t,o)=>{"use strict";o.d(t,{Cm:()=>l,aR:()=>s,er:()=>a,fy:()=>n,oQ:()=>r,uA:()=>i});var i,n="ktp",r="-",s="data-ktp-target",a="data-ktp-execute-target",l="ktp-layer-id";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(i||(i={}))},6903:(e,t,o)=>{"use strict";o.d(t,{_:()=>a});var i=o(73027),n=o(18772),r=o(37918),s=o(43289),a=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var o=e;t||(o=this.addParentOverflow(e),this.sequenceMapping[o.keySequences.toString()]=o);var i=this._getUniqueKtp(o);if(t?this.persistedKeytips[i.uniqueID]=i:this.keytips[i.uniqueID]=i,this.inKeytipMode||!this.delayUpdatingKeytipChange){var r=t?s.uA.PERSISTED_KEYTIP_ADDED:s.uA.KEYTIP_ADDED;n.g.raise(this,r,{keytip:o,uniqueID:i.uniqueID})}return i.uniqueID},e.prototype.update=function(e,t){var o=this.addParentOverflow(e),i=this._getUniqueKtp(o,t),r=this.keytips[t];r&&(i.keytip.visible=r.keytip.visible,this.keytips[t]=i,delete this.sequenceMapping[r.keytip.keySequences.toString()],this.sequenceMapping[i.keytip.keySequences.toString()]=i.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||n.g.raise(this,s.uA.KEYTIP_UPDATED,{keytip:i.keytip,uniqueID:i.uniqueID}))},e.prototype.unregister=function(e,t,o){void 0===o&&(o=!1),o?delete this.persistedKeytips[t]:delete this.keytips[t],!o&&delete this.sequenceMapping[e.keySequences.toString()];var i=o?s.uA.PERSISTED_KEYTIP_REMOVED:s.uA.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||n.g.raise(this,i,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){n.g.raise(this,s.uA.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){n.g.raise(this,s.uA.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=(0,i.fX)([],e.keySequences,!0);if(t.pop(),0!==t.length){var o=this.sequenceMapping[t.toString()];if(o&&o.overflowSetSequence)return(0,i.Cl)((0,i.Cl)({},e),{overflowSetSequence:o.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){n.g.raise(this,s.uA.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=(0,r.O)()),{keytip:(0,i.Cl)({},e),uniqueID:t}},e._instance=new e,e}()},62589:(e,t,o)=>{"use strict";if(o.d(t,{YY:()=>a,Z2:()=>s,gt:()=>l}),3023==o.j)var i=o(73027);if(3023==o.j)var n=o(43289);if(3023==o.j)var r=o(69682);function s(e){return e.reduce((function(e,t){return e+n.oQ+t.split("").join(n.oQ)}),n.fy)}function a(e,t){var o=t.length,n=(0,i.fX)([],t,!0).pop(),s=(0,i.fX)([],e,!0);return(0,r.Ty)(s,o-1,n)}function l(e){var t=" "+n.Cm;return e.length?t+" "+s(e):t}},16035:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n}),3023==o.j)var i=o(90265);function n(e){e.schemes={strong:(0,i.pw)(e),soft:(0,i.uy)(e),neutral:(0,i.h9)(e)}}},90265:(e,t,o)=>{"use strict";if(o.d(t,{h9:()=>s,pw:()=>l,uy:()=>a}),3023==o.j)var i=o(73027);if(3023==o.j)var n=o(56641);function r(e,t,o){var r=(0,n.a)({palette:(0,i.Cl)((0,i.Cl)({},e.palette),t)});return r.semanticColors=(0,i.Cl)((0,i.Cl)({},r.semanticColors),o),(0,i.Cl)((0,i.Cl)({},e),{palette:r.palette,semanticColors:r.semanticColors})}function s(e){var t=(0,n.a)(e),o=t.palette;return r(t,{themeDark:o.themeDarker,themeDarkAlt:o.themeDark,themePrimary:o.themeDarkAlt,themeSecondary:o.themePrimary,themeTertiary:o.themeSecondary,themeLight:o.themeTertiary,themeLighter:o.themeLight,themeLighterAlt:o.themeLighterAlt,neutralQuaternary:o.neutralTertiaryAlt,neutralQuaternaryAlt:o.neutralQuaternary,neutralLight:o.neutralQuaternaryAlt,neutralLighter:o.neutralLight,neutralLighterAlt:o.neutralLight,white:o.neutralLighter},{bodyBackground:o.neutralLighter,bodyStandoutBackground:o.neutralLight,bodyFrameBackground:t.isInverted?o.neutralLighter:o.neutralLight,bodyFrameDivider:t.isInverted?o.neutralQuaternaryAlt:o.neutralLight,bodyText:o.neutralPrimary,bodySubtext:o.neutralSecondary,bodyDivider:o.neutralQuaternaryAlt,focusBorder:o.neutralSecondary,variantBorder:o.neutralLight,variantBorderHovered:o.neutralTertiary,defaultStateBackground:o.neutralLight,actionLink:o.neutralPrimary,actionLinkHovered:o.neutralDark,link:o.themeDarkAlt,linkHovered:o.themeDarker,disabledBackground:t.isInverted?o.neutralLighter:o.neutralLight,disabledText:o.neutralTertiary,disabledBodyText:o.neutralTertiary,disabledBodySubtext:o.neutralTertiaryAlt,inputBorder:o.neutralTertiary,inputBorderHovered:o.neutralPrimary,inputBackground:o.white,inputFocusBorderAlt:o.themePrimary,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,buttonBackground:o.neutralQuaternaryAlt,buttonBackgroundHovered:o.neutralQuaternary,buttonBackgroundPressed:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBackgroundDisabled:o.neutralLight,buttonBorder:o.neutralSecondaryAlt,buttonText:o.neutralPrimary,buttonTextHovered:o.neutralDark,buttonTextPressed:o.neutralDark,buttonTextDisabled:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBorderDisabled:o.neutralLighter,primaryButtonBackground:o.themePrimary,primaryButtonBackgroundHovered:o.themeDarkAlt,primaryButtonBackgroundPressed:o.themeDark,primaryButtonBorder:"transparent",primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,accentButtonBackground:o.accent,accentButtonText:o.white,menuBackground:o.white,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.neutralLighter,menuItemBackgroundPressed:o.neutralLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.neutralPrimary:o.neutralDark})}function a(e){var t=(0,n.a)(e),o=t.palette;return r(t,{themeDark:o.themeDarker,themeDarkAlt:o.themeDark,themePrimary:o.themeDarkAlt,themeSecondary:o.themePrimary,themeTertiary:o.themeSecondary,themeLight:o.themeTertiary,themeLighter:o.themeLight,themeLighterAlt:o.themeLighter,neutralTertiaryAlt:t.isInverted?o.themeDarker:o.themeDarkAlt,neutralQuaternary:t.isInverted?o.themeDark:o.themePrimary,neutralQuaternaryAlt:t.isInverted?o.themeDarkAlt:o.themeSecondary,neutralLight:t.isInverted?o.themePrimary:o.themeTertiary,neutralLighter:t.isInverted?o.themeSecondary:o.themeLight,neutralLighterAlt:t.isInverted?o.themeTertiary:o.themeLighter,white:t.isInverted?o.themeLight:o.themeLighterAlt},{bodyBackground:t.isInverted?o.themeLight:o.themeLighterAlt,bodyStandoutBackground:t.isInverted?o.themeTertiary:o.themeLighter,bodyFrameBackground:t.isInverted?o.themeLight:o.themeLighter,bodyFrameDivider:t.isInverted?o.neutralQuaternary:o.themeLighter,bodyText:o.neutralPrimary,bodySubtext:o.neutralSecondary,bodyDivider:o.neutralQuaternaryAlt,inputBorder:o.neutralTertiary,inputBackground:o.white,inputForegroundChecked:o.themeLighter,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,focusBorder:o.neutralSecondary,variantBorder:o.neutralLight,variantBorderHovered:o.neutralTertiary,defaultStateBackground:o.neutralLight,actionLink:o.neutralPrimary,actionLinkHovered:o.neutralDark,link:o.themeDarkAlt,linkHovered:o.themeDarker,disabledBackground:o.neutralLight,disabledText:o.neutralTertiary,disabledBodyText:o.neutralTertiary,disabledBodySubtext:o.neutralTertiaryAlt,buttonBackground:o.neutralQuaternaryAlt,buttonBackgroundHovered:o.neutralQuaternary,buttonBackgroundPressed:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBackgroundDisabled:o.neutralLight,buttonBorder:"transparent",buttonText:o.neutralPrimary,buttonTextHovered:o.neutralDark,buttonTextPressed:o.neutralDark,buttonTextDisabled:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBorderDisabled:"transparent",primaryButtonBackground:o.themePrimary,primaryButtonBackgroundHovered:o.themeDarkAlt,primaryButtonBackgroundPressed:o.themeDark,primaryButtonBorder:"transparent",primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,accentButtonBackground:o.accent,accentButtonText:o.white,menuBackground:o.white,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.neutralLighter,menuItemBackgroundPressed:o.neutralLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.neutralPrimary:o.neutralDark})}function l(e){var t=(0,n.a)(e),o=t.palette,r={themeDarker:o.white,themeDark:o.neutralLighterAlt,themeDarkAlt:o.neutralLighterAlt,themePrimary:o.white,themeSecondary:o.neutralLighter,themeTertiary:o.neutralLight,themeLight:o.neutralQuaternaryAlt,themeLighter:o.neutralQuaternary,themeLighterAlt:o.neutralTertiaryAlt,black:o.neutralLighterAlt,neutralDark:o.neutralLighter,neutralPrimary:o.white,neutralPrimaryAlt:o.neutralLight,neutralSecondary:o.neutralQuaternaryAlt,neutralTertiary:o.neutralQuaternary,neutralTertiaryAlt:o.themeLighterAlt,neutralQuaternary:o.themeLighterAlt,neutralQuaternaryAlt:o.themeLighter,neutralLight:o.themeLight,neutralLighter:o.themeTertiary,neutralLighterAlt:o.themeSecondary,white:o.themePrimary},s={bodyBackground:o.themePrimary,bodyStandoutBackground:o.themeDarkAlt,bodyFrameBackground:t.isInverted?o.themePrimary:o.themeDarkAlt,bodyFrameDivider:t.isInverted?o.themeTertiary:o.themeDarkAlt,bodyText:o.white,bodySubtext:o.white,bodyDivider:o.themeTertiary,inputBorder:o.themeDarkAlt,inputBorderHovered:o.themeDarker,inputBackground:o.white,inputBackgroundChecked:o.white,inputBackgroundCheckedHovered:o.themePrimary,inputForegroundChecked:o.themeDark,inputFocusBorderAlt:o.themeTertiary,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,focusBorder:o.white,variantBorder:o.themeDarkAlt,variantBorderHovered:o.themeDarker,defaultStateBackground:o.neutralLighterAlt,actionLink:o.white,actionLinkHovered:o.white,link:o.white,linkHovered:o.white,disabledBackground:o.themeDarkAlt,disabledText:o.themeTertiary,disabledBodyText:o.neutralQuaternary,disabledBodySubtext:o.neutralTertiaryAlt,buttonBackground:o.themePrimary,buttonBackgroundHovered:o.themeDarkAlt,buttonBackgroundPressed:o.themeDark,buttonBackgroundDisabled:t.isInverted?o.themeLight:o.themeLighter,buttonBorder:o.white,buttonText:o.white,buttonTextHovered:o.white,buttonTextPressed:o.white,buttonTextDisabled:o.themeTertiary,buttonBorderDisabled:"transparent",primaryButtonBackground:o.white,primaryButtonBackgroundHovered:t.isInverted?o.themeLight:o.themeLighter,primaryButtonBackgroundPressed:t.isInverted?o.themeTertiary:o.themeLight,primaryButtonBorder:"transparent",primaryButtonText:t.isInverted?o.neutralPrimary:o.themePrimary,primaryButtonTextHovered:t.isInverted?o.neutralDark:o.themeDark,primaryButtonTextPressed:t.isInverted?o.neutralDark:o.themeDark,accentButtonBackground:o.white,accentButtonText:t.isInverted?o.neutralPrimary:o.themePrimary,menuBackground:o.themePrimary,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.themeTertiary,menuItemBackgroundPressed:o.themeLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.white:o.neutralLighter},a=(0,n.a)({palette:(0,i.Cl)((0,i.Cl)({},t.palette),r)});return a.semanticColors=(0,i.Cl)((0,i.Cl)({},a.semanticColors),s),(0,i.Cl)((0,i.Cl)({},t),{palette:a.palette,semanticColors:a.semanticColors,isInverted:!t.isInverted})}},18772:(e,t,o)=>{"use strict";o.d(t,{g:()=>r});var i=o(97117),n=o(95848),r=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,o,r,s,a){var l,c=null!=a?a:(0,i.Y)();if(e._isElement(t)){if(void 0!==c&&c.createEvent){var u=c.createEvent("HTMLEvents");u.initEvent(o,s||!1,!0),(0,n.kp)(u,r),l=t.dispatchEvent(u)}else if(void 0!==c&&c.createEventObject){var d=c.createEventObject(r);t.fireEvent("on"+o,d)}}else for(;t&&!1!==l;){var h=t.__events__,g=h?h[o]:null;if(g)for(var p in g)if(g.hasOwnProperty(p))for(var f=g[p],m=0;!1!==l&&m<f.length;m++){var v=f[m];v.objectCallback&&(l=v.objectCallback.call(v.parent,r))}t=s?t.parent:null}return l},e.isObserved=function(e,t){var o=e&&e.__events__;return!!o&&!!o[t]},e.isDeclared=function(e,t){var o=e&&e.__declaredEvents;return!!o&&!!o[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,o){for(var i in t)t.hasOwnProperty(i)&&this.on(e,i,t[i],o)},e.prototype.on=function(t,o,i,n){var r=this;if(o.indexOf(",")>-1)for(var s=o.split(/[ ,]+/),a=0;a<s.length;a++)this.on(t,s[a],i,n);else{var l=this._parent,c={target:t,eventName:o,parent:l,callback:i,options:n};if((s=t.__events__=t.__events__||{})[o]=s[o]||{count:0},s[o][this._id]=s[o][this._id]||[],s[o][this._id].push(c),s[o].count++,e._isElement(t)){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed){var o;try{if(!1===(o=i.apply(l,e))&&e[0]){var n=e[0];n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0}}catch(n){}return o}};c.elementCallback=u,t.addEventListener?t.addEventListener(o,u,n):t.attachEvent&&t.attachEvent("on"+o,u)}else c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed)return i.apply(l,e)};this._eventRecords.push(c)}},e.prototype.off=function(e,t,o,i){for(var n=0;n<this._eventRecords.length;n++){var r=this._eventRecords[n];if(!(e&&e!==r.target||t&&t!==r.eventName||o&&o!==r.callback||"boolean"==typeof i&&i!==r.options)){var s=r.target.__events__,a=s[r.eventName],l=a?a[this._id]:null;l&&(1!==l.length&&o?(a.count--,l.splice(l.indexOf(r),1)):(a.count-=l.length,delete s[r.eventName][this._id]),a.count||delete s[r.eventName]),r.elementCallback&&(r.target.removeEventListener?r.target.removeEventListener(r.eventName,r.elementCallback,r.options):r.target.detachEvent&&r.target.detachEvent("on"+r.eventName,r.elementCallback)),this._eventRecords.splice(n--,1)}}},e.prototype.raise=function(t,o,i){return e.raise(this._parent,t,o,i)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var o=0;o<e.length;o++)t[e[o]]=!0},e._uniqueId=0,e}()},42899:(e,t,o)=>{"use strict";function i(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return t.length<2?t[0]:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];t.forEach((function(t){return t&&t.apply(e,o)}))}}o.d(t,{$:()=>i})},86402:(e,t,o)=>{"use strict";function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=e.filter((function(e){return e})).join(" ").trim();return""===o?void 0:o}o.d(t,{_:()=>i})},69682:(e,t,o)=>{"use strict";function i(e,t,o){var i=e.slice();return i.splice(t,0,o),i}function n(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}o.d(t,{Ty:()=>i,r1:()=>n})},43910:(e,t,o)=>{"use strict";if(o.d(t,{K:()=>n}),3023==o.j)var i=o(69682);var n=function(e){var t={refs:[]};return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.resolver&&(0,i.r1)(t.refs,e)||(t.resolver=function(e){return function(t){for(var o=0,i=e.refs;o<i.length;o++){var n=i[o];"function"==typeof n?n(t):n&&(n.current=t)}}}(t)),t.refs=e,t.resolver}}},25296:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>n}),3023==o.j)var i=o(42899);function n(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=(0,i.$)(e,e[o],t[o]))}},32186:(e,t,o)=>{"use strict";o.d(t,{_:()=>r});var i=o(92090),n={label:i.q6,audio:i.Sg,video:i.Fo,ol:i.p3,li:i.P4,a:i.t0,button:i.uw,input:i.QQ,textarea:i.Sh,select:i.Cq,option:i.tK,table:i.al,tr:i.g0,th:i.cr,td:i.k3,colGroup:i.lA,col:i.Qf,form:i.Gp,iframe:i.Cs,img:i.xM};function r(e,t,o){var r=e&&n[e]||i.vt;return(0,i.G1)(t,r,o)}},41178:(e,t,o)=>{"use strict";function i(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}o.d(t,{D:()=>i})},73449:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(25296);function n(e){(0,i.i)(e,{componentDidMount:r,componentDidUpdate:s,componentWillUnmount:a})}function r(){l(this.props.componentRef,this)}function s(e){e.componentRef!==this.props.componentRef&&(l(e.componentRef,null),l(this.props.componentRef,this))}function a(){l(this.props.componentRef,null)}function l(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}},75787:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>s}),3023==o.j)var i=o(40089);if(3023==o.j)var n=o(70186);if(3023==o.j)var r=o(61108);var s=function(e){var t=e.stylesheetKey,o=e.children,s=(0,n.A)(),a=s.useAdoptedStylesheetEx,l=s.useMergeStylesRootStylesheets,c=s.useWindow,u=(0,r.v)(),d=l(),h=c();return a(i.P6,u,d,h),a(t,u,d,h),o(!!u)}},49288:(e,t,o)=>{"use strict";o.d(t,{c:()=>i});var i=o(56415).createContext(void 0)},61108:(e,t,o)=>{"use strict";o.d(t,{h:()=>r,v:()=>s});var i=o(56415);if(3023==o.j)var n=o(49288);var r=function(){return!!s()},s=function(){return i.useContext(n.c)}},23854:(e,t,o)=>{"use strict";o.d(t,{w:()=>n});var i=o(56415);(0,o(1854).hN)([{rawString:"@-webkit-keyframes rollout_09ccd899{0%{left:-100px}100%{left:calc(100% + 100px)}}@keyframes rollout_09ccd899{0%{left:-100px}100%{left:calc(100% + 100px)}}.backgroundShimmer_09ccd899{position:absolute;background:var(--background-color);width:80px;height:calc(100% + 100px);left:0;top:-50px;-webkit-transform:rotate(30deg);transform:rotate(30deg);-webkit-box-shadow:0 0 15px 8px var(--background-color);box-shadow:0 0 15px 8px var(--background-color);z-index:0;-webkit-animation:rollout_09ccd899 var(--animation-time) forwards;animation:rollout_09ccd899 var(--animation-time) forwards}"}]);const n=i.memo((e=>{var t;const{animationTimeMs:o,theme:n}=e;return i.createElement("div",{className:"backgroundShimmer_09ccd899",style:{"--background-color":null!==(t=null==n?void 0:n.shimmerColor)&&void 0!==t?t:"rgba(255, 255, 255, 0.8)","--animation-time":`${null!=o?o:1750}ms`}})}));n.displayName="BackgroundShimmer"},95012:(e,t,o)=>{"use strict";o.d(t,{S:()=>l});var i=o(56415),n=o(30885),r=o(90096),s=o(2381),a=o(68664);class l extends i.PureComponent{constructor(){super(...arguments),this.divRef=i.createRef()}render(){return i.createElement(a.q.Consumer,null,(e=>i.createElement("div",Object.assign({},this.getRootDivAttributes(e),{ref:this.divRef}),this.props.children)))}focus(e){var t,o,i;e&&(null===(o=null===(t=this.divRef.current)||void 0===t?void 0:t.children[e])||void 0===o||o.focus()),null===(i=this.divRef.current)||void 0===i||i.focus()}el(){return this.divRef.current}getChildItem(e,t=0){const o=this.el(),i=null==o?void 0:o.querySelectorAll(e);return(null==i?void 0:i.length)&&(null==i?void 0:i.length)>=t+1?i[t]:null}getRootDivAttributes(e){const t={style:this.computeStyles(this.props.style,e)};return n.tO(this.props,t),this.props.accessible?(t["aria-hidden"]=!1,t["aria-label"]=this.props.accessibilityLabel,t.role=this.getAccessibilityRole()):!1===this.props.accessible&&(t["aria-hidden"]=!0),this.props.focusable&&(t.tabIndex=0),void 0!==this.props.accessibleLive&&(t["aria-live"]=this.getAriaLive()),t.id=this.props.nativeID,t}computeStyles(e,t){const o={display:"flex",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0};switch(this.props.direction===r.PR.LeftToRight?o.flexDirection="row":o.flexDirection="column",this.props.align){case r.j5.Stretch:o.alignItems="stretch";break;case r.j5.Center:o.alignItems="center";break;case r.j5.Baseline:o.alignItems="baseline";break;default:o.alignItems="flex-start"}switch(this.props.justifyContent){case r.Pr.Center:o.justifyContent="center";break;case r.Pr.End:o.justifyContent="flex-end";break;case r.Pr.SpaceBetween:o.justifyContent="space-between";break;default:o.justifyContent="flex-start"}if(e){switch(e.flexibleSize&&(o.flexGrow=1,o.flexShrink=1),void 0!==e.paddingStart&&(o.paddingLeft=t?e.paddingEnd:e.paddingStart),void 0!==e.paddingEnd&&(o.paddingRight=t?e.paddingStart:e.paddingEnd),void 0!==e.paddingHorizontal&&(o.paddingRight=e.paddingHorizontal,o.paddingLeft=e.paddingHorizontal),void 0!==e.paddingTop&&(o.paddingTop=e.paddingTop),void 0!==e.paddingBottom&&(o.paddingBottom=e.paddingBottom),void 0!==e.paddingVertical&&(o.paddingTop=o.paddingTop||0+e.paddingVertical,o.paddingBottom=o.paddingBottom||0+e.paddingVertical),void 0!==e.marginTop&&(o.marginTop=e.marginTop),void 0!==e.marginBottom&&(o.marginBottom=e.marginBottom),void 0!==e.marginVertical&&(o.marginTop=(e.marginTop||0)+e.marginVertical,o.marginBottom=(e.marginBottom||0)+e.marginVertical),t?(void 0!==e.marginStart&&(o.marginRight=e.marginStart),void 0!==e.marginEnd&&(o.marginLeft=e.marginEnd)):(void 0!==e.marginStart&&(o.marginLeft=e.marginStart),void 0!==e.marginEnd&&(o.marginRight=e.marginEnd)),void 0!==e.marginHorizontal&&(o.marginLeft=(t?e.marginEnd||0:e.marginStart||0)+e.marginHorizontal,o.marginRight=(t?e.marginStart||0:e.marginEnd||0)+e.marginHorizontal),void 0!==e.gap&&(o.gap=e.gap),void 0!==e.maxWidth&&(o.maxWidth=e.maxWidth),void 0!==e.minWidth&&(o.minWidth=e.minWidth),void 0!==e.width&&(o.width=e.width),void 0!==e.minHeight&&(o.minHeight=e.minHeight),void 0!==e.maxHeight&&(o.maxHeight=e.maxHeight),void 0!==e.height&&(o.height=e.height),e.backgroundColor&&(o.backgroundColor=e.backgroundColor),e.backgroundImage&&(o.backgroundImage=e.backgroundImage),void 0!==e.borderColor&&(o.borderColor=e.borderColor),void 0!==e.borderStyle&&(o.borderStyle=e.borderStyle),typeof e.borderWidth){case"number":o.borderWidth=e.borderWidth;break;case"object":o.borderTopWidth=e.borderWidth.top,o.borderRightWidth=t?e.borderWidth.start:e.borderWidth.end,o.borderBottomWidth=e.borderWidth.bottom,o.borderLeftWidth=t?e.borderWidth.end:e.borderWidth.start}switch(typeof e.borderRadius){case"number":o.borderRadius=(0,s.W)(e);break;case"object":const i=(0,s.W)(e,"topStart",0),n=(0,s.W)(e,"topEnd",0),r=(0,s.W)(e,"bottomStart",0),a=(0,s.W)(e,"bottomEnd",0);o.borderTopLeftRadius=t?n:i,o.borderTopRightRadius=t?i:n,o.borderBottomRightRadius=t?r:a,o.borderBottomLeftRadius=t?a:r}e.hideFocusBox&&(o.outline="none"),e.transform&&(o.transform=e.transform),void 0!==e.zIndex&&(o.zIndex=e.zIndex),e.position&&(o.position=e.position),(e.top||0===e.top)&&(o.top=e.top),(e.bottom||0===e.bottom)&&(o.bottom=e.bottom),(e.right||0===e.right)&&(o.right=e.right),(e.left||0===e.left)&&(o.left=e.left),e.overflow&&(o.overflow=e.overflow),e.boxShadow&&(o.boxShadow=e.boxShadow)}return o}getAccessibilityRole(){switch(this.props.accessibilityRole){case"list":case"listbox":case"menu":case"tablist":case"application":return this.props.accessibilityRole;default:return"group"}}getAriaLive(){return this.props.accessibleLive===r.pq.Polite?"polite":void 0}}},90096:(e,t,o)=>{"use strict";var i,n,r,s;o.d(t,{PR:()=>i,Pr:()=>r,j5:()=>n,pq:()=>s}),function(e){e[e.TopToBottom=0]="TopToBottom",e[e.LeftToRight=1]="LeftToRight"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Stretch=1]="Stretch",e[e.Baseline=2]="Baseline",e[e.Center=3]="Center"}(n||(n={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.SpaceBetween=2]="SpaceBetween",e[e.End=3]="End"}(r||(r={})),function(e){e[e.Polite=0]="Polite",e[e.Off=1]="Off"}(s||(s={}))},53429:(e,t,o)=>{"use strict";o.d(t,{u:()=>jo});var i=o(33980),n=o(73027),r=o(56415),s=o(43910),a=o(94255),l=o(43416),c=o(31634),u=o(83592),d=o(15567),h=o(73449),g=o(11631),p=o(18772),f=o(37918),m=o(92090),v=o(95848);function b(e,t,o){var i=e[o],n=t[o];(i||n)&&(e[o]=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return n&&(e=n.apply(this,t)),i!==n&&(e=i.apply(this,t)),e})}function y(){return null}!function(e){function t(o,i){var n=e.call(this,o,i)||this;return function(e,t,o){for(var i=0,n=o.length;i<n;i++)b(e,t,o[i])}(n,t.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),n}(0,n.C6)(t,e),t.prototype.componentDidUpdate=function(e,t){this._updateComponentRef(e,this.props)},t.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},t.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var o=this.__disposables[e];o.dispose&&o.dispose()}this.__disposables=null}},Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_async",{get:function(){return this.__async||(this.__async=new g.j(this),this._disposables.push(this.__async)),this.__async},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_events",{get:function(){return this.__events||(this.__events=new p.g(this),this._disposables.push(this.__events)),this.__events},enumerable:!1,configurable:!0}),t.prototype._resolveRef=function(e){var t=this;return this.__resolves||(this.__resolves={}),this.__resolves[e]||(this.__resolves[e]=function(o){return t[e]=o}),this.__resolves[e]},t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={}),e&&t&&e.componentRef!==t.componentRef&&(this._setComponentRef(e.componentRef,null),this._setComponentRef(t.componentRef,this))},t.prototype._warnDeprecations=function(e){this.className,this.props},t.prototype._warnMutuallyExclusive=function(e){this.className,this.props},t.prototype._warnConditionallyRequiredProps=function(e,t,o){this.className,this.props},t.prototype._setComponentRef=function(e,t){!this._skipComponentRefResolution&&e&&("function"==typeof e&&e(t),"object"==typeof e&&(e.current=t))}}(r.Component);var C,S=o(53928),w=o(86402),k=o(9916);!function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(C||(C={}));var T=o(37418),x=o(1022),I=o(48499),_=o(27936),E=(0,I.Z)({cacheSize:100}),A=function(e){function t(t){var o=e.call(this,t)||this;return o._onImageLoadingStateChange=function(e){o.props.imageProps&&o.props.imageProps.onLoadingStateChange&&o.props.imageProps.onLoadingStateChange(e),e===x.P6.error&&o.setState({imageLoadError:!0})},o.state={imageLoadError:!1},o}return(0,n.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,o=e.className,i=e.styles,s=e.iconName,a=e.imageErrorAs,l=e.theme,c="string"==typeof s&&0===s.length,u=!!this.props.imageProps||this.props.iconType===C.image||this.props.iconType===C.Image,d=(0,_.ne)(s)||{},h=d.iconClassName,g=d.children,p=d.mergeImageProps,f=E(i,{theme:l,className:o,iconClassName:h,isImage:u,isPlaceholder:c}),v=u?"span":"i",b=(0,m.G1)(this.props,m.vt,["aria-label"]),y=this.state.imageLoadError,S=(0,n.Cl)((0,n.Cl)({},this.props.imageProps),{onLoadingStateChange:this._onImageLoadingStateChange}),w=y&&a||T._,k=this.props["aria-label"]||this.props.ariaLabel,x=S.alt||k||this.props.title,I=x||this.props["aria-labelledby"]||S["aria-label"]||S["aria-labelledby"]?{role:u||p?void 0:"img","aria-label":u||p?void 0:x}:{"aria-hidden":!0},A=g;return p&&g&&"object"==typeof g&&x&&(A=r.cloneElement(g,{alt:x})),r.createElement(v,(0,n.Cl)({"data-icon-name":s},I,b,p?{title:void 0,"aria-label":void 0}:{},{className:f.root}),u?r.createElement(w,(0,n.Cl)({},S)):t||A)},t}(r.Component),R=o(66837),B=(0,k.I)(A,R.$f,void 0,{scope:"Icon"},!0);B.displayName="Icon";var M,D=function(e){var t=e.className,o=e.imageProps,i=(0,m.G1)(e,m.vt,["aria-label","aria-labelledby","title","aria-describedby"]),s=o.alt||e["aria-label"],a=s||e["aria-labelledby"]||e.title||o["aria-label"]||o["aria-labelledby"]||o.title,c={"aria-labelledby":e["aria-labelledby"],"aria-describedby":e["aria-describedby"],title:e.title},u=a?{}:{"aria-hidden":!0};return r.createElement("div",(0,n.Cl)({},u,i,{className:(0,l.A)(R.xD,R.xW.root,R.xW.image,t)}),r.createElement(T._,(0,n.Cl)({},c,o,{alt:a?s:""})))},O=o(90730),F=(0,a.J5)((function(e){return(0,a.J5)((function(t){var o=(0,a.J5)((function(e){return function(o){return t(o,e)}}));return function(i,n){return e(i,n?o(n):t)}}))}));!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.Section=3]="Section"}(M||(M={}));var P,N=o(67056),L=o(76455),j=o(27293),q=o(97117),H=o(74004),z=o(99148);function W(e){var t;if(void 0===P||e){var o=(0,z.z)(),i=null===(t=null==o?void 0:o.navigator)||void 0===t?void 0:t.userAgent;P=!!i&&-1!==i.indexOf("Macintosh")}return!!P}var G=function(){return!!(window&&window.navigator&&window.navigator.userAgent)&&/iPad|iPhone|iPod/i.test(window.navigator.userAgent)},U=o(39011),V=(0,a.J5)((function(e){var t=e;return(0,a.J5)((function(o){if(e===o)throw new Error("Attempted to compose a component with itself.");var i=o,s=(0,a.J5)((function(e){return function(t){return r.createElement(i,(0,n.Cl)({},t,{defaultRender:e}))}}));return function(e){var o=e.defaultRender;return r.createElement(t,(0,n.Cl)({},e,{defaultRender:o?s(o):i}))}}))}));function $(e,t){return V(e)(t)}function K(e){return e.canCheck?!(!e.isChecked&&!e.checked):"boolean"==typeof e.isChecked?e.isChecked:"boolean"==typeof e.checked?e.checked:null}function Q(e){return!(!e.subMenuProps&&!e.items)}function Y(e){return!(!e.isDisabled&&!e.disabled)}function J(e){return null!==K(e)?"menuitemcheckbox":"menuitem"}var Z=o(96490),X=function(e){var t=e.item,o=e.classNames,i=t.iconProps;return r.createElement(B,(0,n.Cl)({},i,{className:o.icon}))},ee=function(e){var t=e.item;return e.hasIcons?t.onRenderIcon?t.onRenderIcon(e,X):X(e):null},te=function(e){var t=e.onCheckmarkClick,o=e.item,i=e.classNames,n=K(o);return t?r.createElement(B,{iconName:!1!==o.canCheck&&n?"CheckMark":"",className:i.checkmarkIcon,onClick:function(e){return t(o,e)}}):null},oe=function(e){var t=e.item,o=e.classNames;return t.text||t.name?r.createElement("span",{className:o.label},t.text||t.name):null},ie=function(e){var t=e.item,o=e.classNames;return t.secondaryText?r.createElement("span",{className:o.secondaryText},t.secondaryText):null},ne=function(e){var t=e.item,o=e.classNames,i=e.theme;return Q(t)?r.createElement(B,(0,n.Cl)({iconName:(0,j.jI)(i)?"ChevronLeft":"ChevronRight"},t.submenuIconProps,{className:o.subMenuIcon})):null},re=function(e){function t(t){var o=e.call(this,t)||this;return o.openSubMenu=function(){var e=o.props,t=e.item,i=e.openSubMenu,n=e.getSubmenuTarget;if(n){var r=n();Q(t)&&i&&r&&i(t,r)}},o.dismissSubMenu=function(){var e=o.props,t=e.item,i=e.dismissSubMenu;Q(t)&&i&&i()},o.dismissMenu=function(e){var t=o.props.dismissMenu;t&&t(void 0,e)},(0,h.f)(o),o}return(0,n.C6)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,o=e.classNames,i=t.onRenderContent||this._renderLayout;return r.createElement("div",{className:t.split?o.linkContentMenu:o.linkContent},i(this.props,{renderCheckMarkIcon:te,renderItemIcon:ee,renderItemName:oe,renderSecondaryText:ie,renderSubMenuIcon:ne}))},t.prototype._renderLayout=function(e,t){return r.createElement(r.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),t.renderItemName(e),t.renderSecondaryText(e),t.renderSubMenuIcon(e))},t}(r.Component),se=(0,a.J9)((function(e){return(0,i.l8)({wrapper:{display:"inline-flex",height:"100%",alignItems:"center"},divider:{width:1,height:"100%",backgroundColor:e.palette.neutralTertiaryAlt}})})),ae=o(5730),le="28px",ce=(0,i.L6)(0,i.mm),ue=(0,a.J9)((function(e){var t;return(0,i.l8)(se(e),{wrapper:{position:"absolute",right:28,selectors:(t={},t[ce]={right:32},t)},divider:{height:16,width:1}})})),de={item:"ms-ContextualMenu-item",divider:"ms-ContextualMenu-divider",root:"ms-ContextualMenu-link",isChecked:"is-checked",isExpanded:"is-expanded",isDisabled:"is-disabled",linkContent:"ms-ContextualMenu-linkContent",linkContentMenu:"ms-ContextualMenu-linkContent",icon:"ms-ContextualMenu-icon",iconColor:"ms-ContextualMenu-iconColor",checkmarkIcon:"ms-ContextualMenu-checkmarkIcon",subMenuIcon:"ms-ContextualMenu-submenuIcon",label:"ms-ContextualMenu-itemText",secondaryText:"ms-ContextualMenu-secondaryText",splitMenu:"ms-ContextualMenu-splitMenu",screenReaderText:"ms-ContextualMenu-screenReaderText"},he=(0,a.J9)((function(e,t,o,n,r,s,a,l,c,u,h,g){var p,f,m,v,b=(0,ae.J)(e),y=(0,i.Km)(de,e);return(0,i.l8)({item:[y.item,b.item,a],divider:[y.divider,b.divider,l],root:[y.root,b.root,n&&[y.isChecked,b.rootChecked],r&&b.anchorLink,o&&[y.isExpanded,b.rootExpanded],t&&[y.isDisabled,b.rootDisabled],!t&&!o&&[{selectors:(p={":hover":b.rootHovered,":active":b.rootPressed},p[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,p[".".concat(d.Y2," &:hover, :host(.").concat(d.Y2,") &:hover")]={background:"inherit;"},p)}],g],splitPrimary:[b.root,{width:"calc(100% - ".concat(le,")")},n&&["is-checked",b.rootChecked],(t||h)&&["is-disabled",b.rootDisabled],!(t||h)&&!n&&[{selectors:(f={":hover":b.rootHovered},f[":hover ~ .".concat(y.splitMenu)]=b.rootHovered,f[":active"]=b.rootPressed,f[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,f[".".concat(d.Y2," &:hover, :host(.").concat(d.Y2,") &:hover")]={background:"inherit;"},f)}]],splitMenu:[y.splitMenu,b.root,{flexBasis:"0",padding:"0 8px",minWidth:le},o&&["is-expanded",b.rootExpanded],t&&["is-disabled",b.rootDisabled],!t&&!o&&[{selectors:(m={":hover":b.rootHovered,":active":b.rootPressed},m[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,m[".".concat(d.Y2," &:hover, :host(.").concat(d.Y2,") &:hover")]={background:"inherit;"},m)}]],anchorLink:b.anchorLink,linkContent:[y.linkContent,b.linkContent],linkContentMenu:[y.linkContentMenu,b.linkContent,{justifyContent:"center"}],icon:[y.icon,s&&b.iconColor,b.icon,c,t&&[y.isDisabled,b.iconDisabled]],iconColor:b.iconColor,checkmarkIcon:[y.checkmarkIcon,s&&b.checkmarkIcon,b.icon,c],subMenuIcon:[y.subMenuIcon,b.subMenuIcon,u,o&&{color:e.palette.neutralPrimary},t&&[b.iconDisabled]],label:[y.label,b.label],secondaryText:[y.secondaryText,b.secondaryText],splitContainer:[b.splitButtonFlexContainer,!t&&!n&&[{selectors:(v={},v[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,v)}]],screenReaderText:[y.screenReaderText,b.screenReaderText,i.dX,{visibility:"hidden"}]})})),ge=function(e){var t=e.theme,o=e.disabled,i=e.expanded,n=e.checked,r=e.isAnchorLink,s=e.knownIcon,a=e.itemClassName,l=e.dividerClassName,c=e.iconClassName,u=e.subMenuClassName,d=e.primaryDisabled,h=e.className;return he(t,o,i,n,r,s,a,l,c,u,d,h)},pe=(0,k.I)(re,ge,void 0,{scope:"ContextualMenuItem"}),fe=function(e){function t(t){var o=e.call(this,t)||this;return o._onItemMouseEnter=function(e){var t=o.props,i=t.item,n=t.onItemMouseEnter;n&&n(i,e,e.currentTarget)},o._onItemClick=function(e){var t=o.props,i=t.item,n=t.onItemClickBase;n&&n(i,e,e.currentTarget)},o._onItemMouseLeave=function(e){var t=o.props,i=t.item,n=t.onItemMouseLeave;n&&n(i,e)},o._onItemKeyDown=function(e){var t=o.props,i=t.item,n=t.onItemKeyDown;n&&n(i,e)},o._onItemMouseMove=function(e){var t=o.props,i=t.item,n=t.onItemMouseMove;n&&n(i,e,e.currentTarget)},o._getSubmenuTarget=function(){},(0,h.f)(o),o}return(0,n.C6)(t,e),t.prototype.shouldComponentUpdate=function(e){return!(0,v.ab)(e,this.props)},t}(r.Component),me=o(43289),ve=o(82804),be=function(e){var t,o=e.children,i=(0,n.Tt)(e,["children"]),r=(0,ve.i)(i),s=r.keytipId,a=r.ariaDescribedBy;return o(((t={})[me.aR]=s,t[me.er]=s,t["aria-describedby"]=a,t))},ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._anchor=r.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.Cl)((0,n.Cl)({},e),{hasMenu:!0})})),t._getSubmenuTarget=function(){return t._anchor.current?t._anchor.current:void 0},t._onItemClick=function(e){var o=t.props,i=o.item,n=o.onItemClick;n&&n(i,e)},t._renderAriaDescription=function(e,o){return e?r.createElement("span",{id:t._ariaDescriptionId,className:o},e):null},t}return(0,n.C6)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.item,i=t.classNames,s=t.index,a=t.focusableElementIndex,l=t.totalItemCount,c=t.hasCheckmarks,u=t.hasIcons,d=t.expandedMenuItemKey,h=t.onItemClick,g=t.openSubMenu,p=t.dismissSubMenu,v=t.dismissMenu,b=pe;this.props.item.contextualMenuItemAs&&(b=$(this.props.item.contextualMenuItemAs,b)),this.props.contextualMenuItemAs&&(b=$(this.props.contextualMenuItemAs,b));var y=o.rel;o.target&&"_blank"===o.target.toLowerCase()&&(y=y||"nofollow noopener noreferrer");var C=Q(o),S=(0,m.G1)(o,m.t0),k=Y(o),T=o.itemProps,x=o.ariaDescription,I=o.keytipProps;I&&C&&(I=this._getMemoizedMenuButtonKeytipProps(I)),x&&(this._ariaDescriptionId=(0,f.O)());var _=(0,w._)(o.ariaDescribedBy,x?this._ariaDescriptionId:void 0,S["aria-describedby"]),E={"aria-describedby":_};return r.createElement("div",null,r.createElement(be,{keytipProps:o.keytipProps,ariaDescribedBy:_,disabled:k},(function(t){return r.createElement("a",(0,n.Cl)({},E,S,t,{ref:e._anchor,href:o.href,target:o.target,rel:y,className:i.root,role:"menuitem","aria-haspopup":C||void 0,"aria-expanded":C?o.key===d:void 0,"aria-posinset":a+1,"aria-setsize":l,"aria-disabled":Y(o),style:o.style,onClick:e._onItemClick,onMouseEnter:e._onItemMouseEnter,onMouseLeave:e._onItemMouseLeave,onMouseMove:e._onItemMouseMove,onKeyDown:C?e._onItemKeyDown:void 0}),r.createElement(b,(0,n.Cl)({componentRef:o.componentRef,item:o,classNames:i,index:s,onCheckmarkClick:c&&h?h:void 0,hasIcons:u,openSubMenu:g,dismissSubMenu:p,dismissMenu:v,getSubmenuTarget:e._getSubmenuTarget},T)),e._renderAriaDescription(x,i.screenReaderText))})))},t}(fe),Ce=(0,I.Z)(),Se=r.forwardRef((function(e,t){var o=e.styles,i=e.theme,n=e.getClassNames,s=e.className,a=Ce(o,{theme:i,getClassNames:n,className:s});return r.createElement("span",{className:a.wrapper,ref:t},r.createElement("span",{className:a.divider}))}));Se.displayName="VerticalDividerBase";var we=(0,k.I)(Se,(function(e){var t=e.theme,o=e.getClassNames,i=e.className;if(!t)throw new Error("Theme is undefined or null.");if(o){var n=o(t);return{wrapper:[n.wrapper],divider:[n.divider]}}return{wrapper:[{display:"inline-flex",height:"100%",alignItems:"center"},i],divider:[{width:1,height:"100%",backgroundColor:t.palette.neutralTertiaryAlt}]}}),void 0,{scope:"VerticalDivider"}),ke=function(e){function t(t){var o=e.call(this,t)||this;return o._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.Cl)((0,n.Cl)({},e),{hasMenu:!0})})),o._onItemKeyDown=function(e){var t=o.props,i=t.item,n=t.onItemKeyDown;e.which===u.c.enter?(o._executeItemClick(e),e.preventDefault(),e.stopPropagation()):n&&n(i,e)},o._getSubmenuTarget=function(){return o._splitButton},o._renderAriaDescription=function(e,t){return e?r.createElement("span",{id:o._ariaDescriptionId,className:t},e):null},o._onItemMouseEnterPrimary=function(e){var t=o.props,i=t.item,r=t.onItemMouseEnter;r&&r((0,n.Cl)((0,n.Cl)({},i),{subMenuProps:void 0,items:void 0}),e,o._splitButton)},o._onItemMouseEnterIcon=function(e){var t=o.props,i=t.item,n=t.onItemMouseEnter;n&&n(i,e,o._splitButton)},o._onItemMouseMovePrimary=function(e){var t=o.props,i=t.item,r=t.onItemMouseMove;r&&r((0,n.Cl)((0,n.Cl)({},i),{subMenuProps:void 0,items:void 0}),e,o._splitButton)},o._onItemMouseMoveIcon=function(e){var t=o.props,i=t.item,n=t.onItemMouseMove;n&&n(i,e,o._splitButton)},o._onIconItemClick=function(e){var t=o.props,i=t.item,n=t.onItemClickBase;n&&n(i,e,o._splitButton?o._splitButton:e.currentTarget)},o._executeItemClick=function(e){var t=o.props,i=t.item,n=t.executeItemClick,r=t.onItemClick;if(!i.disabled&&!i.isDisabled)return o._processingTouch&&!i.canCheck&&r?r(i,e):void(n&&n(i,e))},o._onTouchStart=function(e){o._splitButton&&!("onpointerdown"in o._splitButton)&&o._handleTouchAndPointerEvent(e)},o._onPointerDown=function(e){"touch"===e.pointerType&&(o._handleTouchAndPointerEvent(e),e.preventDefault(),e.stopImmediatePropagation())},o._async=new g.j(o),o._events=new p.g(o),o._dismissLabelId=(0,f.O)(),o}return(0,n.C6)(t,e),t.prototype.componentDidMount=function(){this._splitButton&&"onpointerdown"in this._splitButton&&this._events.on(this._splitButton,"pointerdown",this._onPointerDown,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e,t=this,o=this.props,i=o.item,s=o.classNames,a=o.index,l=o.focusableElementIndex,c=o.totalItemCount,u=o.hasCheckmarks,d=o.hasIcons,h=o.onItemMouseLeave,g=o.expandedMenuItemKey,p=Q(i),m=i.keytipProps;m&&(m=this._getMemoizedMenuButtonKeytipProps(m));var v=i.ariaDescription;v&&(this._ariaDescriptionId=(0,f.O)());var b=null!==(e=K(i))&&void 0!==e?e:void 0;return r.createElement(be,{keytipProps:m,disabled:Y(i)},(function(e){return r.createElement("div",{"data-ktp-target":e["data-ktp-target"],ref:function(e){return t._splitButton=e},role:J(i),"aria-label":i.ariaLabel,className:s.splitContainer,"aria-disabled":Y(i),"aria-expanded":p?i.key===g:void 0,"aria-haspopup":!0,"aria-describedby":(0,w._)(i.ariaDescribedBy,v?t._ariaDescriptionId:void 0,e["aria-describedby"]),"aria-checked":b,"aria-posinset":l+1,"aria-setsize":c,onMouseEnter:t._onItemMouseEnterPrimary,onMouseLeave:h?h.bind(t,(0,n.Cl)((0,n.Cl)({},i),{subMenuProps:null,items:null})):void 0,onMouseMove:t._onItemMouseMovePrimary,onKeyDown:t._onItemKeyDown,onClick:t._executeItemClick,onTouchStart:t._onTouchStart,tabIndex:0,"data-is-focusable":!0,"aria-roledescription":i["aria-roledescription"]},t._renderSplitPrimaryButton(i,s,a,u,d),t._renderSplitDivider(i),t._renderSplitIconButton(i,s,a,e),t._renderAriaDescription(v,s.screenReaderText))}))},t.prototype._renderSplitPrimaryButton=function(e,t,o,i,s){var a=this.props,l=a.contextualMenuItemAs,c=void 0===l?pe:l,u=a.onItemClick,d={key:e.key,disabled:Y(e)||e.primaryDisabled,name:e.name,text:e.text||e.name,secondaryText:e.secondaryText,className:t.splitPrimary,canCheck:e.canCheck,isChecked:e.isChecked,checked:e.checked,iconProps:e.iconProps,id:this._dismissLabelId,onClick:e.onClick,onRenderIcon:e.onRenderIcon,data:e.data,"data-is-focusable":!1},h=e.itemProps;return r.createElement("button",(0,n.Cl)({},(0,m.G1)(d,m.uw)),r.createElement(c,(0,n.Cl)({"data-is-focusable":!1,item:d,classNames:t,index:o,onCheckmarkClick:i&&u?u:void 0,hasIcons:s},h)))},t.prototype._renderSplitDivider=function(e){var t=e.getSplitButtonVerticalDividerClassNames||ue;return r.createElement(we,{getClassNames:t})},t.prototype._renderSplitIconButton=function(e,t,o,i){var s=this.props,a=s.onItemMouseLeave,l=s.onItemMouseDown,c=s.openSubMenu,u=s.dismissSubMenu,d=s.dismissMenu,h=pe;this.props.item.contextualMenuItemAs&&(h=$(this.props.item.contextualMenuItemAs,h)),this.props.contextualMenuItemAs&&(h=$(this.props.contextualMenuItemAs,h));var g={onClick:this._onIconItemClick,disabled:Y(e),className:t.splitMenu,subMenuProps:e.subMenuProps,submenuIconProps:e.submenuIconProps,split:!0,key:e.key,"aria-labelledby":this._dismissLabelId},p=(0,n.Cl)((0,n.Cl)({},(0,m.G1)(g,m.uw)),{onMouseEnter:this._onItemMouseEnterIcon,onMouseLeave:a?a.bind(this,e):void 0,onMouseDown:function(t){return l?l(e,t):void 0},onMouseMove:this._onItemMouseMoveIcon,"data-is-focusable":!1,"data-ktp-execute-target":i["data-ktp-execute-target"],"aria-haspopup":!0}),f=e.itemProps;return r.createElement("button",(0,n.Cl)({},p),r.createElement(h,(0,n.Cl)({componentRef:e.componentRef,item:g,classNames:t,index:o,hasIcons:!1,openSubMenu:c,dismissSubMenu:u,dismissMenu:d,getSubmenuTarget:this._getSubmenuTarget},f)))},t.prototype._handleTouchAndPointerEvent=function(e){var t=this,o=this.props.onTap;o&&o(e),this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){t._processingTouch=!1,t._lastTouchTimeoutId=void 0}),500)},t}(fe),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._btn=r.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.Cl)((0,n.Cl)({},e),{hasMenu:!0})})),t._renderAriaDescription=function(e,o){return e?r.createElement("span",{id:t._ariaDescriptionId,className:o},e):null},t._getSubmenuTarget=function(){return t._btn.current?t._btn.current:void 0},t}return(0,n.C6)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.item,i=t.classNames,s=t.index,a=t.focusableElementIndex,l=t.totalItemCount,c=t.hasCheckmarks,u=t.hasIcons,d=t.contextualMenuItemAs,h=t.expandedMenuItemKey,g=t.onItemMouseDown,p=t.onItemClick,v=t.openSubMenu,b=t.dismissSubMenu,y=t.dismissMenu,C=pe;o.contextualMenuItemAs&&(C=$(o.contextualMenuItemAs,C)),d&&(C=$(d,C));var S=K(o),k=null!==S,T=J(o),x=Q(o),I=o.itemProps,_=o.ariaLabel,E=o.ariaDescription,A=(0,m.G1)(o,m.uw);delete A.disabled;var R=o.role||T;E&&(this._ariaDescriptionId=(0,f.O)());var B=(0,w._)(o.ariaDescribedBy,E?this._ariaDescriptionId:void 0,A["aria-describedby"]),M={className:i.root,onClick:this._onItemClick,onKeyDown:x?this._onItemKeyDown:void 0,onMouseEnter:this._onItemMouseEnter,onMouseLeave:this._onItemMouseLeave,onMouseDown:function(e){return g?g(o,e):void 0},onMouseMove:this._onItemMouseMove,href:o.href,title:o.title,"aria-label":_,"aria-describedby":B,"aria-haspopup":x||void 0,"aria-expanded":x?o.key===h:void 0,"aria-posinset":a+1,"aria-setsize":l,"aria-disabled":Y(o),"aria-checked":"menuitemcheckbox"!==R&&"menuitemradio"!==R||!k?void 0:!!S,"aria-selected":"menuitem"===R&&k?!!S:void 0,role:R,style:o.style},D=o.keytipProps;return D&&x&&(D=this._getMemoizedMenuButtonKeytipProps(D)),r.createElement(be,{keytipProps:D,ariaDescribedBy:B,disabled:Y(o)},(function(t){return r.createElement("button",(0,n.Cl)({ref:e._btn},A,M,t),r.createElement(C,(0,n.Cl)({componentRef:o.componentRef,item:o,classNames:i,index:s,onCheckmarkClick:c&&p?p:void 0,hasIcons:u,openSubMenu:v,dismissSubMenu:b,dismissMenu:y,getSubmenuTarget:e._getSubmenuTarget},I)),e._renderAriaDescription(E,i.screenReaderText))}))},t}(fe),xe=o(61888),Ie=o(94520),_e=o(21690),Ee=o(53965),Ae=o(67780),Re=o(6190),Be=o(81232),Me=o(96018),De=r.createContext({}),Oe=(0,I.Z)(),Fe=(0,I.Z)(),Pe={items:[],shouldFocusOnMount:!0,gapSpace:0,directionalHint:O.A.bottomAutoEdge,beakWidth:16};function Ne(e){for(var t=0,o=0,i=e;o<i.length;o++){var n=i[o];n.itemType!==M.Divider&&n.itemType!==M.Header&&(t+=n.customOnRenderListLength?n.customOnRenderListLength:1)}return t}function Le(e,t){var o=null==t?void 0:t.target,i=e.subMenuProps?e.subMenuProps.items:e.items;if(i){for(var r=[],s=0,a=i;s<a.length;s++){var l=a[s];if(l.preferMenuTargetAsEventTarget){var c=l.onClick,u=(0,n.Tt)(l,["onClick"]);r.push((0,n.Cl)((0,n.Cl)({},u),{onClick:$e(c,o)}))}else r.push(l)}return r}}var je="ContextualMenu",qe=(0,a.J9)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return i.pB.apply(void 0,(0,n.fX)([t,ge],e,!1))}}));function He(e,t){var o=e.hidden,i=e.items,n=e.theme,s=e.className,a=e.id,l=e.target,c=r.useState(),u=c[0],d=c[1],h=r.useState(),g=h[0],p=h[1],f=r.useState(),m=f[0],b=f[1],y=(0,Ie.B)(je,a),C=r.useCallback((function(){b(void 0),d(void 0),p(void 0)}),[]),S=r.useCallback((function(e,t,o){var i=e.key;u!==i&&(t.focus(),b(o),d(i),p(t))}),[u]);r.useEffect((function(){o&&C()}),[o,C]);var w=function(e,t){var o=r.useRef(!1);r.useEffect((function(){return o.current=!0,function(){o.current=!1}}),[]);return function(i,n){n?e(i,n):o.current&&t()}}(t,C);return[u,S,function(){var e=Ve(u,i),t=null;if(e&&(t={items:Le(e,{target:l}),target:g,onDismiss:w,isSubMenu:!0,id:y,shouldFocusOnMount:!0,shouldFocusOnContainer:m,directionalHint:(0,j.jI)(n)?O.A.leftTopEdge:O.A.rightTopEdge,className:s,gapSpace:0,isBeakVisible:!1},e.subMenuProps&&(0,v.kp)(t,e.subMenuProps),e.preferMenuTargetAsEventTarget)){var o=e.onItemClick;t.onItemClick=$e(o,l)}return t},w]}var ze=r.memo(r.forwardRef((function(e,t){var o,i=(0,U.N)(Pe,e),s=(i.ref,(0,n.Tt)(i,["ref"])),a=r.useRef(null),c=(0,Ee.Y)(),d=(0,Ie.B)(je,s.id),h=function(e,t){var o;return null===(o=s.onDismiss)||void 0===o?void 0:o.call(s,e,t)},g=(0,Ae.P)(s.target,a),p=g[0],f=g[1],v=function(e,t,o){var i=e.hidden,n=e.onRestoreFocus,s=r.useRef(),a=r.useCallback((function(e){var t,o;n?n(e):(null==e?void 0:e.documentContainsFocus)&&(null===(o=null===(t=s.current)||void 0===t?void 0:t.focus)||void 0===o||o.call(t))}),[n]);return(0,_e.E)((function(){var e,n;if(i)s.current&&(a({originalElement:s.current,containsFocus:!0,documentContainsFocus:(null===(n=(0,q.Y)())||void 0===n?void 0:n.hasFocus())||!1}),s.current=void 0);else{var r=null==t?void 0:t.document.activeElement;(null===(e=o.current)||void 0===e?void 0:e.contains(r))||"BODY"===r.tagName||(s.current=r)}}),[i,null==t?void 0:t.document.activeElement,a,o]),[a]}(s,f,a)[0],b=He(s,h),y=b[0],C=b[1],w=b[2],k=b[3],T=function(e){var t=e.delayUpdateFocusOnHover,o=e.hidden,i=r.useRef(!t),n=r.useRef(!1);r.useEffect((function(){i.current=!t,n.current=!o&&!t&&n.current}),[t,o]);var s=r.useCallback((function(){t&&(i.current=!1)}),[t]);return[i,n,s]}(s),x=T[0],I=T[1],_=T[2],E=function(e){var t=r.useRef(!0),o=r.useRef();return[function(){t.current||void 0===o.current?t.current=!1:(e.clearTimeout(o.current),o.current=void 0),o.current=e.setTimeout((function(){t.current=!0}),250)},t]}(c),A=E[0],R=E[1],B=function(e,t){var o=e.subMenuHoverDelay,i=void 0===o?250:o,n=r.useRef(void 0),s=function(){void 0!==n.current&&(t.clearTimeout(n.current),n.current=void 0)};return[s,function(e){n.current=t.setTimeout((function(){e(),s()}),i)},n]}(s,c),D=B[0],O=B[1],F=B[2],P=function(e,t){var o=r.useState((0,Be.YF)()),i=o[0],n=o[1],s=r.useCallback((function(){var t=(0,Be.kA)((0,z.z)(e.current));i!==t&&n(t)}),[e,i]),a=(0,Me.ox)();return(0,Re.x)(a,"resize",s),r.useEffect((function(){void 0===t&&s()}),[t]),null!=t?t:i}(a,s.responsiveMode);!function(e,t){var o=e.hidden,i=void 0!==o&&o,n=e.onMenuDismissed,s=e.onMenuOpened,a=(0,xe.Z)(i),l=r.useRef(s),c=r.useRef(n),u=r.useRef(e);l.current=s,c.current=n,u.current=e,r.useEffect((function(){var e,t;i&&!1===a?null===(e=c.current)||void 0===e||e.call(c,u.current):i||!1===a||null===(t=l.current)||void 0===t||t.call(l,u.current)}),[i,a]),r.useEffect((function(){return function(){var e;return null===(e=c.current)||void 0===e?void 0:e.call(c,u.current)}}),[])}(s);var V,J=function(e,t,o,i){var n=e.theme,s=e.isSubMenu,a=e.focusZoneProps,l=void 0===a?{}:a,c=l.checkForNoWrap,d=l.direction,h=void 0===d?N.E.vertical:d,g=r.useRef(),p=function(e,o,i){var n=!1;return o(e)&&(t(e,i),e.preventDefault(),e.stopPropagation(),n=!0),n},f=function(e){return e.which===u.c.escape||function(e){var t=(0,j.jI)(n)?u.c.right:u.c.left;return!(e.which!==t||!s||h!==N.E.vertical&&(!c||(0,H._l)(e.target,"data-no-horizontal-wrap")))}(e)||e.which===u.c.up&&(e.altKey||e.metaKey)},m=function(e){g.current=We(e);var t=e.which===u.c.escape&&(W()||G());return p(e,f,t)},v=function(e){var t=g.current&&We(e);return g.current=!1,!!t&&!(G()||W())};return[m,function(e){return p(e,v,!0)},function(e){if(!m(e)&&o.current){var t=!(!e.altKey&&!e.metaKey),i=e.which===u.c.up,n=e.which===u.c.down;if(!t&&(i||n)){var r=i?(0,H.dm)(o.current,o.current.lastChild,!0):(0,H.j5)(o.current,o.current.firstChild,!0);r&&(r.focus(),e.preventDefault(),e.stopPropagation())}}},function(e,t){var o=(0,j.jI)(n)?u.c.left:u.c.right;e.disabled||t.which!==o&&t.which!==u.c.enter&&(t.which!==u.c.down||!t.altKey&&!t.metaKey)||(i(e,t.currentTarget),t.preventDefault())}]}(s,h,a,C),X=J[0],ee=J[1],te=J[2],oe=J[3],ie=function(e,t,o,i,n,r,s,a,l,c,u,d,h){var g=e.target,p=function(){return!t.current||!r.current},f=function(e,t,o){var i=o||t.currentTarget;e.key!==s&&(c(),void 0===s&&i.focus(),Q(e)?(t.stopPropagation(),l((function(){i.focus(),u(e,i,!0)}))):l((function(){d(t),i.focus()})))},m=function(t,o,i){var n=Le(t,{target:g});if(c(),Q(t)||n&&n.length){if(t.key!==s){var r="boolean"==typeof e.shouldFocusOnContainer?e.shouldFocusOnContainer:"mouse"===o.nativeEvent.pointerType;u(t,i,r)}}else v(t,o);o.stopPropagation(),o.preventDefault()},v=function(t,o){if(!t.disabled&&!t.isDisabled){t.preferMenuTargetAsEventTarget&&Ke(o,g);var i=!1;t.onClick?i=!!t.onClick(o,t):e.onItemClick&&(i=!!e.onItemClick(o,t)),!i&&o.defaultPrevented||h(o,!0)}};return[function(e,t,o){n.current&&(r.current=!0),p()||f(e,t,o)},function(e,s,a){var l=s.currentTarget;n.current&&(r.current=!0,t.current&&void 0===o.current&&l!==(null==i?void 0:i.document.activeElement)&&f(e,s,a))},function(e,t){var o;if(!p()&&(c(),void 0===s))if(a.current.setActive)try{a.current.setActive()}catch(e){}else null===(o=a.current)||void 0===o||o.focus()},function(e,t){m(e,t,t.currentTarget)},function(e,t){v(e,t),t.stopPropagation()},v,m]}(s,R,F,f,x,I,y,a,O,D,C,k,h),ne=ie[0],re=ie[1],se=ie[2],ae=ie[3],le=ie[4],ce=ie[5],ue=ie[6],de=function(e,t,o){var i=0,n=e.items,s=e.totalItemCount,a=e.hasCheckmarks,l=e.hasIcons;return r.createElement("ul",{className:t.list,onKeyDown:X,onKeyUp:ee,role:"presentation"},n.map((function(e,o){var n=he(e,o,i,s,a,l,t);if(e.itemType!==M.Divider&&e.itemType!==M.Header){var r=e.customOnRenderListLength?e.customOnRenderListLength:1;i+=r}return n})))},he=function(e,t,o,i,n,a,l){var c,u,d=[],h=e.iconProps||{iconName:"None"},g=e.getItemClassNames,p=e.itemProps,f=p?p.styles:void 0,m=e.itemType===M.Divider?e.className:void 0,v=e.submenuIconProps?e.submenuIconProps.className:"";if(g)u=g(s.theme,Y(e),y===e.key,!!K(e),!!e.href,"None"!==h.iconName,e.className,m,h.className,v,e.primaryDisabled);else{var b={theme:s.theme,disabled:Y(e),expanded:y===e.key,checked:!!K(e),isAnchorLink:!!e.href,knownIcon:"None"!==h.iconName,itemClassName:e.className,dividerClassName:m,iconClassName:h.className,subMenuClassName:v,primaryDisabled:e.primaryDisabled};u=Fe(qe(null===(c=l.subComponentStyles)||void 0===c?void 0:c.menuItem,f),b)}switch("-"!==e.text&&"-"!==e.name||(e.itemType=M.Divider),e.itemType){case M.Divider:d.push(me(t,u));break;case M.Header:d.push(me(t,u));var C=be(e,u,l,t,n,a);d.push(fe(C,e.key||t,u,e.title));break;case M.Section:d.push(ge(e,u,l,t,n,a));break;default:var S=function(){return ve(e,u,t,o,i,n,a)},w=s.onRenderContextualMenuItem?s.onRenderContextualMenuItem(e,S):S();d.push(fe(w,e.key||t,u,e.title))}return r.createElement(r.Fragment,{key:e.key},d)},ge=function(e,t,o,i,s,a){var l=e.sectionProps;if(l){var c,u;if(l.title){var h=void 0,g="";if("string"==typeof l.title){var p=d+l.title.replace(/\s/g,"");h={key:"section-".concat(l.title,"-title"),itemType:M.Header,text:l.title,id:p},g=p}else{var f=l.title.id||d+l.title.key.replace(/\s/g,"");h=(0,n.Cl)((0,n.Cl)({},l.title),{id:f}),g=f}h&&(u={role:"group","aria-labelledby":g},c=be(h,t,o,i,s,a))}if(l.items&&l.items.length>0){var m=0;return r.createElement("li",{role:"presentation",key:l.key||e.key||"section-".concat(i)},r.createElement("div",(0,n.Cl)({},u),r.createElement("ul",{className:o.list,role:"presentation"},l.topDivider&&me(i,t,!0,!0),c&&fe(c,e.key||i,t,e.title),l.items.map((function(e,t){var i=he(e,t,m,Ne(l.items),s,a,o);if(e.itemType!==M.Divider&&e.itemType!==M.Header){var n=e.customOnRenderListLength?e.customOnRenderListLength:1;m+=n}return i})),l.bottomDivider&&me(i,t,!1,!0))))}}},fe=function(e,t,o,i){return r.createElement("li",{role:"presentation",title:i,key:t,className:o.item},e)},me=function(e,t,o,i){return i||e>0?r.createElement("li",{role:"separator",key:"separator-"+e+(void 0===o?"":o?"-top":"-bottom"),className:t.divider,"aria-hidden":"true"}):null},ve=function(e,t,o,i,a,l,c){if(e.onRender)return e.onRender((0,n.Cl)({"aria-posinset":i+1,"aria-setsize":a},e),h);var u={item:e,classNames:t,index:o,focusableElementIndex:i,totalItemCount:a,hasCheckmarks:l,hasIcons:c,contextualMenuItemAs:s.contextualMenuItemAs,onItemMouseEnter:ne,onItemMouseLeave:se,onItemMouseMove:re,onItemMouseDown:Ge,executeItemClick:ce,onItemKeyDown:oe,expandedMenuItemKey:y,openSubMenu:C,dismissSubMenu:k,dismissMenu:h};if(e.href){var d=ye;return e.contextualMenuItemWrapperAs&&(d=$(e.contextualMenuItemWrapperAs,d)),r.createElement(d,(0,n.Cl)({},u,{onItemClick:le}))}if(e.split&&Q(e)){var g=ke;return e.contextualMenuItemWrapperAs&&(g=$(e.contextualMenuItemWrapperAs,g)),r.createElement(g,(0,n.Cl)({},u,{onItemClick:ae,onItemClickBase:ue,onTap:D}))}var p=Te;return e.contextualMenuItemWrapperAs&&(p=$(e.contextualMenuItemWrapperAs,p)),r.createElement(p,(0,n.Cl)({},u,{onItemClick:ae,onItemClickBase:ue}))},be=function(e,t,o,i,a,l){var c=pe;e.contextualMenuItemAs&&(c=$(e.contextualMenuItemAs,c)),s.contextualMenuItemAs&&(c=$(s.contextualMenuItemAs,c));var u=e.itemProps,d=e.id,h=u&&(0,m.G1)(u,m.JM);return r.createElement("div",(0,n.Cl)({id:d,className:o.header},h,{style:e.style}),r.createElement(c,(0,n.Cl)({item:e,classNames:t,index:i,onCheckmarkClick:a?ae:void 0,hasIcons:l},u)))},Ce=s.isBeakVisible,Se=s.items,we=s.labelElementId,ze=s.id,Ve=s.className,$e=s.beakWidth,Qe=s.directionalHint,Ye=s.directionalHintForRTL,Je=s.alignTargetEdge,Ze=s.gapSpace,Xe=s.coverTarget,et=s.ariaLabel,tt=s.doNotLayer,ot=s.target,it=s.bounds,nt=s.useTargetWidth,rt=s.useTargetAsMinWidth,st=s.directionalHintFixed,at=s.shouldFocusOnMount,lt=s.shouldFocusOnContainer,ct=s.title,ut=s.styles,dt=s.theme,ht=s.calloutProps,gt=s.onRenderSubMenu,pt=void 0===gt?Ue:gt,ft=s.onRenderMenuList,mt=void 0===ft?function(e,t){return de(e,yt)}:ft,vt=s.focusZoneProps,bt=s.getMenuClassNames,yt=bt?bt(dt,Ve):Oe(ut,{theme:dt,className:Ve}),Ct=function e(t){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(n.iconProps)return!0;if(n.itemType===M.Section&&n.sectionProps&&e(n.sectionProps.items))return!0}return!1}(Se),St=(0,n.Cl)((0,n.Cl)({direction:N.E.vertical,handleTabKey:N.l.all,isCircularNavigation:!0,"data-tabster":'{"uncontrolled": {}, "focusable": { "excludeFromMover": true }}'},vt),{className:(0,l.A)(yt.root,null===(o=s.focusZoneProps)||void 0===o?void 0:o.className)}),wt=function(e){return e.some((function(e){return!!e.canCheck||!(!e.sectionProps||!e.sectionProps.items.some((function(e){return!0===e.canCheck})))}))}(Se),kt=y&&!0!==s.hidden?w():null;Ce=void 0===Ce?P<=Be.AR.medium:Ce;var Tt=p.current;if((nt||rt)&&Tt&&Tt.offsetWidth){var xt=Tt.getBoundingClientRect().width-2;nt?V={width:xt}:rt&&(V={minWidth:xt})}if(Se&&Se.length>0){var It=Ne(Se),_t=yt.subComponentStyles?yt.subComponentStyles.callout:void 0;return r.createElement(De.Consumer,null,(function(e){return r.createElement(Z.P,(0,n.Cl)({styles:_t,onRestoreFocus:v},ht,{target:ot||e.target,isBeakVisible:Ce,beakWidth:$e,directionalHint:Qe,directionalHintForRTL:Ye,gapSpace:Ze,coverTarget:Xe,doNotLayer:tt,className:(0,l.A)("ms-ContextualMenu-Callout",ht&&ht.className),setInitialFocus:at,onDismiss:s.onDismiss||e.onDismiss,onScroll:A,bounds:it,directionalHintFixed:st,alignTargetEdge:Je,hidden:s.hidden||e.hidden,ref:t}),r.createElement("div",{style:V,ref:a,id:ze,className:yt.container,tabIndex:lt?0:-1,onKeyDown:te,onKeyUp:ee,onFocusCapture:_,"aria-label":et,"aria-labelledby":we,role:"menu"},ct&&r.createElement("div",{className:yt.title}," ",ct," "),Se&&Se.length?function(e,t){var o=s.focusZoneAs,i=void 0===o?L.R:o;return r.createElement(i,(0,n.Cl)({},t),e)}(mt({ariaLabel:et,items:Se,totalItemCount:It,hasCheckmarks:wt,hasIcons:Ct,defaultMenuItemRenderer:function(e){return function(e,t){var o=e.index,i=e.focusableElementIndex,n=e.totalItemCount,r=e.hasCheckmarks,s=e.hasIcons;return he(e,o,i,n,r,s,t)}(e,yt)},labelElementId:we},(function(e,t){return de(e,yt)})),St):null,kt&&pt(kt,Ue)),r.createElement(S.MO,null))}))}return null})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,v.ab)(e,t)}));function We(e){return e.which===u.c.alt||"Meta"===e.key}function Ge(e,t){var o;null===(o=e.onMouseDown)||void 0===o||o.call(e,e,t)}function Ue(e,t){throw Error("ContextualMenuBase: onRenderSubMenu callback is null or undefined. Please ensure to set `onRenderSubMenu` property either manually or with `styled` helper.")}function Ve(e,t){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(n.itemType===M.Section&&n.sectionProps){var r=Ve(e,n.sectionProps.items);if(r)return r}else if(n.key&&n.key===e)return n}}function $e(e,t){return e?function(o,i){return Ke(o,t),e(o,i)}:e}function Ke(e,t){e&&t&&(e.persist(),t instanceof Event?e.target=t.target:t instanceof Element&&(e.target=t))}ze.displayName="ContextualMenuBase";var Qe={root:"ms-ContextualMenu",container:"ms-ContextualMenu-container",list:"ms-ContextualMenu-list",header:"ms-ContextualMenu-header",title:"ms-ContextualMenu-title",isopen:"is-open"};function Ye(e){return r.createElement(Je,(0,n.Cl)({},e))}var Je=(0,k.I)(ze,(function(e){var t=e.className,o=e.theme,n=(0,i.Km)(Qe,o),r=o.fonts,s=o.semanticColors,a=o.effects;return{root:[o.fonts.medium,n.root,n.isopen,{backgroundColor:s.menuBackground,minWidth:"180px"},t],container:[n.container,{selectors:{":focus":{outline:0}}}],list:[n.list,n.isopen,{listStyleType:"none",margin:"0",padding:"0"}],header:[n.header,r.small,{fontWeight:i.BO.semibold,color:s.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:ae.C,lineHeight:ae.C,cursor:"default",padding:"0px 6px",userSelect:"none",textAlign:"left"}],title:[n.title,{fontSize:r.mediumPlus.fontSize,paddingRight:"14px",paddingLeft:"14px",paddingBottom:"5px",paddingTop:"5px",backgroundColor:s.menuItemBackgroundPressed}],subComponentStyles:{callout:{root:{boxShadow:a.elevation8}},menuItem:{}}}}),(function(e){return{onRenderSubMenu:e.onRenderSubMenu?(t=e.onRenderSubMenu,o=Ye,F(t)(o)):Ye};var t,o}),{scope:"ContextualMenu"}),Ze=Je;Ze.displayName="ContextualMenu";var Xe,et={msButton:"ms-Button",msButtonHasMenu:"ms-Button--hasMenu",msButtonIcon:"ms-Button-icon",msButtonMenuIcon:"ms-Button-menuIcon",msButtonLabel:"ms-Button-label",msButtonDescription:"ms-Button-description",msButtonScreenReaderText:"ms-Button-screenReaderText",msButtonFlexContainer:"ms-Button-flexContainer",msButtonTextContainer:"ms-Button-textContainer"},tt=(0,a.J9)((function(e,t,o,n,r,s,a,l,c,u,d){var h,g,p=(0,i.Km)(et,e||{}),f=u&&!d;return(0,i.l8)(t.__shadowConfig__,{root:[p.msButton,t.root,n,c&&["is-checked",t.rootChecked],f&&["is-expanded",t.rootExpanded,(h={},h[":hover .".concat(p.msButtonIcon)]=t.iconExpandedHovered,h[":hover .".concat(p.msButtonMenuIcon)]=t.menuIconExpandedHovered||t.rootExpandedHovered,h[":hover"]=t.rootExpandedHovered,h)],l&&[et.msButtonHasMenu,t.rootHasMenu],a&&["is-disabled",t.rootDisabled],!a&&!f&&!c&&(g={":hover":t.rootHovered},g[":hover .".concat(p.msButtonLabel)]=t.labelHovered,g[":hover .".concat(p.msButtonIcon)]=t.iconHovered,g[":hover .".concat(p.msButtonDescription)]=t.descriptionHovered,g[":hover .".concat(p.msButtonMenuIcon)]=t.menuIconHovered,g[":focus"]=t.rootFocused,g[":active"]=t.rootPressed,g[":active .".concat(p.msButtonIcon)]=t.iconPressed,g[":active .".concat(p.msButtonDescription)]=t.descriptionPressed,g[":active .".concat(p.msButtonMenuIcon)]=t.menuIconPressed,g),a&&c&&[t.rootCheckedDisabled],!a&&c&&{":hover":t.rootCheckedHovered,":active":t.rootCheckedPressed},o],flexContainer:[p.msButtonFlexContainer,t.flexContainer],textContainer:[p.msButtonTextContainer,t.textContainer],icon:[p.msButtonIcon,r,t.icon,f&&t.iconExpanded,c&&t.iconChecked,a&&t.iconDisabled],label:[p.msButtonLabel,t.label,c&&t.labelChecked,a&&t.labelDisabled],menuIcon:[p.msButtonMenuIcon,s,t.menuIcon,c&&t.menuIconChecked,a&&!d&&t.menuIconDisabled,!a&&!f&&!c&&{":hover":t.menuIconHovered,":active":t.menuIconPressed},f&&["is-expanded",t.menuIconExpanded]],description:[p.msButtonDescription,t.description,c&&t.descriptionChecked,a&&t.descriptionDisabled],screenReaderText:[p.msButtonScreenReaderText,t.screenReaderText]})})),ot=(0,a.J9)((function(e,t,o,n,r){return{root:(0,i.Zq)(e.splitButtonMenuButton,o&&[e.splitButtonMenuButtonExpanded],t&&[e.splitButtonMenuButtonDisabled],n&&!t&&[e.splitButtonMenuButtonChecked],r&&!t&&[{":focus":e.splitButtonMenuFocused}]),splitButtonContainer:(0,i.Zq)(e.splitButtonContainer,!t&&n&&[e.splitButtonContainerChecked,{":hover":e.splitButtonContainerCheckedHovered}],!t&&!n&&[{":hover":e.splitButtonContainerHovered,":focus":e.splitButtonContainerFocused}],t&&e.splitButtonContainerDisabled),icon:(0,i.Zq)(e.splitButtonMenuIcon,t&&e.splitButtonMenuIconDisabled,!t&&r&&e.splitButtonMenuIcon),flexContainer:(0,i.Zq)(e.splitButtonFlexContainer),divider:(0,i.Zq)("ms-SplitButton-divider",e.splitButtonDivider,(r||t)&&e.splitButtonDividerDisabled)}})),it=function(e){function t(t){var o=e.call(this,t)||this;return o._buttonElement=r.createRef(),o._splitButtonContainer=r.createRef(),o._mergedRef=(0,s.K)(),o._renderedVisibleMenu=!1,o._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.Cl)((0,n.Cl)({},e),{hasMenu:!0})})),o._onRenderIcon=function(e,t){var i=o.props.iconProps;if(i&&(void 0!==i.iconName||i.imageProps)){var s=i.className,a=i.imageProps,c=(0,n.Tt)(i,["className","imageProps"]);if(i.styles)return r.createElement(B,(0,n.Cl)({className:(0,l.A)(o._classNames.icon,s),imageProps:a},c));if(i.iconName)return r.createElement(_.l8,(0,n.Cl)({className:(0,l.A)(o._classNames.icon,s)},c));if(a)return r.createElement(D,(0,n.Cl)({className:(0,l.A)(o._classNames.icon,s),imageProps:a},c))}return null},o._onRenderTextContents=function(){var e,t,i,n,s=(e=o.props).text,a=e.children,l=void 0===(t=e.secondaryText)?o.props.description:t,c=void 0===(i=e.onRenderText)?o._onRenderText:i,u=void 0===(n=e.onRenderDescription)?o._onRenderDescription:n;return s||"string"==typeof a||l?r.createElement("span",{className:o._classNames.textContainer},c(o.props,o._onRenderText),u(o.props,o._onRenderDescription)):[c(o.props,o._onRenderText),u(o.props,o._onRenderDescription)]},o._onRenderText=function(){var e=o.props.text,t=o.props.children;return void 0===e&&"string"==typeof t&&(e=t),o._hasText()?r.createElement("span",{key:o._labelId,className:o._classNames.label,id:o._labelId},e):null},o._onRenderChildren=function(){var e=o.props.children;return"string"==typeof e?null:e},o._onRenderDescription=function(e){var t,i=void 0===(t=e.secondaryText)?o.props.description:t;return i?r.createElement("span",{key:o._descriptionId,className:o._classNames.description,id:o._descriptionId},i):null},o._onRenderAriaDescription=function(){var e=o.props.ariaDescription;return e?r.createElement("span",{className:o._classNames.screenReaderText,id:o._ariaDescriptionId},e):null},o._onRenderMenuIcon=function(e){var t=o.props.menuIconProps;return r.createElement(_.l8,(0,n.Cl)({iconName:"ChevronDown"},t,{className:o._classNames.menuIcon}))},o._onRenderMenu=function(e){var t=o.props.menuAs?$(o.props.menuAs,Ze):Ze;return r.createElement(t,(0,n.Cl)({},e))},o._onDismissMenu=function(e){var t=o.props.menuProps;t&&t.onDismiss&&t.onDismiss(e),e&&e.defaultPrevented||o._dismissMenu()},o._dismissMenu=function(){o._menuShouldFocusOnMount=void 0,o._menuShouldFocusOnContainer=void 0,o.setState({menuHidden:!0})},o._openMenu=function(e,t){void 0===t&&(t=!0),o.props.menuProps&&(o._menuShouldFocusOnContainer=e,o._menuShouldFocusOnMount=t,o._renderedVisibleMenu=!0,o.setState({menuHidden:!1}))},o._onToggleMenu=function(e){var t=!0;o.props.menuProps&&!1===o.props.menuProps.shouldFocusOnMount&&(t=!1),o.state.menuHidden?o._openMenu(e,t):o._dismissMenu()},o._onSplitContainerFocusCapture=function(e){var t=o._splitButtonContainer.current;!t||e.target&&(0,c.s)(e.target,t)||t.focus()},o._onSplitButtonPrimaryClick=function(e){o.state.menuHidden||o._dismissMenu();var t=o._processingTouch&&!o.props.toggle;!t&&o.props.onClick?o.props.onClick(e):t&&o._onMenuClick(e)},o._onKeyDown=function(e){!o.props.disabled||e.which!==u.c.enter&&e.which!==u.c.space?o.props.disabled||(o.props.menuProps?o._onMenuKeyDown(e):void 0!==o.props.onKeyDown&&o.props.onKeyDown(e)):(e.preventDefault(),e.stopPropagation())},o._onKeyUp=function(e){o.props.disabled||void 0===o.props.onKeyUp||o.props.onKeyUp(e)},o._onKeyPress=function(e){o.props.disabled||void 0===o.props.onKeyPress||o.props.onKeyPress(e)},o._onMouseUp=function(e){o.props.disabled||void 0===o.props.onMouseUp||o.props.onMouseUp(e)},o._onMouseDown=function(e){o.props.disabled||void 0===o.props.onMouseDown||o.props.onMouseDown(e)},o._onClick=function(e){o.props.disabled||(o.props.menuProps?o._onMenuClick(e):void 0!==o.props.onClick&&o.props.onClick(e))},o._onSplitButtonContainerKeyDown=function(e){e.which===u.c.enter||e.which===u.c.space?o._buttonElement.current&&(o._buttonElement.current.click(),e.preventDefault(),e.stopPropagation()):o._onMenuKeyDown(e)},o._onMenuKeyDown=function(e){var t;if(!o.props.disabled){o.props.onKeyDown&&o.props.onKeyDown(e);var i=e.which===u.c.up,n=e.which===u.c.down;if(!e.defaultPrevented&&o._isValidMenuOpenKey(e)){var r=o.props.onMenuClick;r&&r(e,o.props),o._onToggleMenu(!1),e.preventDefault(),e.stopPropagation()}e.which!==u.c.enter&&e.which!==u.c.space||(0,d.Fy)(!0,e.target,null===(t=o.context)||void 0===t?void 0:t.registeredProviders),e.altKey||e.metaKey||!i&&!n||!o.state.menuHidden&&o.props.menuProps&&((void 0!==o._menuShouldFocusOnMount?o._menuShouldFocusOnMount:o.props.menuProps.shouldFocusOnMount)||(e.preventDefault(),e.stopPropagation(),o._menuShouldFocusOnMount=!0,o.forceUpdate()))}},o._onTouchStart=function(){o._isSplitButton&&o._splitButtonContainer.current&&!("onpointerdown"in o._splitButtonContainer.current)&&o._handleTouchAndPointerEvent()},o._onMenuClick=function(e){var t,i=(t=o.props).onMenuClick,n=t.menuProps;i&&i(e,o.props);var r="boolean"==typeof(null==n?void 0:n.shouldFocusOnContainer)?n.shouldFocusOnContainer:"mouse"===e.nativeEvent.pointerType;e.defaultPrevented||(o._onToggleMenu(r),e.preventDefault(),e.stopPropagation())},(0,h.f)(o),o._async=new g.j(o),o._events=new p.g(o),o.props.split,o._labelId=(0,f.O)(),o._descriptionId=(0,f.O)(),o._ariaDescriptionId=(0,f.O)(),o.state={menuHidden:!0},o}return(0,n.C6)(t,e),Object.defineProperty(t.prototype,"_isSplitButton",{get:function(){return!!this.props.menuProps&&!!this.props.onClick&&!0===this.props.split},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t,o,i,n=(e=this.props).ariaDescription,r=e.ariaLabel,s=e.ariaHidden,a=e.className,l=e.disabled,c=e.allowDisabledFocus,u=e.primaryDisabled,d=void 0===(t=e.secondaryText)?this.props.description:t,h=e.href,g=e.iconProps,p=e.menuIconProps,f=e.styles,b=e.checked,C=e.variantClassName,S=e.theme,w=e.toggle,k=e.getClassNames,T=e.role,x=this.state.menuHidden,I=l||u;this._classNames=k?k(S,a,C,g&&g.className,p&&p.className,I,b,!x,!!this.props.menuProps,this.props.split,!!c):tt(S,f,a,C,g&&g.className,p&&p.className,I,!!this.props.menuProps,b,!x,this.props.split);var _=this._ariaDescriptionId,E=this._labelId,A=this._descriptionId,R=!I&&!!h,B=R?"a":"button",M=(0,m.G1)((0,v.kp)(R?{}:{type:"button"},this.props.rootProps,this.props),R?m.t0:m.uw,["disabled"]),D=r||M["aria-label"],O=void 0;n?O=_:d&&this.props.onRenderDescription!==y?O=A:M["aria-describedby"]&&(O=M["aria-describedby"]);var F=void 0;M["aria-labelledby"]?F=M["aria-labelledby"]:O&&!D&&(F=this._hasText()?E:void 0);var P=!(!1===this.props["data-is-focusable"]||l&&!c||this._isSplitButton),N="menuitemcheckbox"===T||"checkbox"===T,L=N||!0===w?!!b:void 0,j=(0,v.kp)(M,((o={className:this._classNames.root,ref:this._mergedRef(this.props.elementRef,this._buttonElement),disabled:I&&!c,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onClick:this._onClick,"aria-label":D,"aria-labelledby":F,"aria-describedby":O,"aria-disabled":I,"data-is-focusable":P})[N?"aria-checked":"aria-pressed"]=L,o));if(s&&(j["aria-hidden"]=!0),this._isSplitButton)return this._onRenderSplitButtonContent(B,j);if(this.props.menuProps){var q=void 0===(i=this.props.menuProps.id)?"".concat(this._labelId,"-menu"):i;(0,v.kp)(j,{"aria-expanded":!x,"aria-controls":x?null:q,"aria-haspopup":!0})}return this._onRenderContent(B,j)},t.prototype.componentDidMount=function(){this._isSplitButton&&this._splitButtonContainer.current&&("onpointerdown"in this._splitButtonContainer.current&&this._events.on(this._splitButtonContainer.current,"pointerdown",this._onPointerDown,!0),"onpointerup"in this._splitButtonContainer.current&&this.props.onPointerUp&&this._events.on(this._splitButtonContainer.current,"pointerup",this.props.onPointerUp,!0))},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&!t.menuHidden&&this.state.menuHidden&&this.props.onAfterMenuDismiss()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.focus=function(){var e,t;this._isSplitButton&&this._splitButtonContainer.current?((0,d.Fy)(!0,void 0,null===(e=this.context)||void 0===e?void 0:e.registeredProviders),this._splitButtonContainer.current.focus()):this._buttonElement.current&&((0,d.Fy)(!0,void 0,null===(t=this.context)||void 0===t?void 0:t.registeredProviders),this._buttonElement.current.focus())},t.prototype.dismissMenu=function(){this._dismissMenu()},t.prototype.openMenu=function(e,t){this._openMenu(e,t)},t.prototype._onRenderContent=function(e,t){var o,i,s,a,l,c=this,u=this.props,d=e,h=u.menuIconProps,g=u.menuProps,p=void 0===(o=u.onRenderIcon)?this._onRenderIcon:o,f=void 0===(i=u.onRenderAriaDescription)?this._onRenderAriaDescription:i,m=void 0===(s=u.onRenderChildren)?this._onRenderChildren:s,v=void 0===(a=u.onRenderMenu)?this._onRenderMenu:a,b=void 0===(l=u.onRenderMenuIcon)?this._onRenderMenuIcon:l,y=u.disabled,C=u.keytipProps;C&&g&&(C=this._getMemoizedMenuButtonKeytipProps(C));var w=function(e){return r.createElement(d,(0,n.Cl)({},t,e),r.createElement("span",{className:c._classNames.flexContainer,"data-automationid":"splitbuttonprimary"},p(u,c._onRenderIcon),c._onRenderTextContents(),f(u,c._onRenderAriaDescription),m(u,c._onRenderChildren),!c._isSplitButton&&(g||h||c.props.onRenderMenuIcon)&&b(c.props,c._onRenderMenuIcon),g&&!g.doNotLayer&&c._shouldRenderMenu()&&v(c._getMenuProps(g),c._onRenderMenu)))},k=C?r.createElement(be,{keytipProps:this._isSplitButton?void 0:C,ariaDescribedBy:t["aria-describedby"],disabled:y},(function(e){return w(e)})):w();return g&&g.doNotLayer?r.createElement(r.Fragment,null,k,this._shouldRenderMenu()&&v(this._getMenuProps(g),this._onRenderMenu)):r.createElement(r.Fragment,null,k,r.createElement(S.MO,null))},t.prototype._shouldRenderMenu=function(){var e,t=this.state.menuHidden,o=(e=this.props).persistMenu,i=e.renderPersistedMenuHiddenOnMount;return!t||!(!o||!this._renderedVisibleMenu&&!i)},t.prototype._hasText=function(){return null!==this.props.text&&(void 0!==this.props.text||"string"==typeof this.props.children)},t.prototype._getMenuProps=function(e){var t=this.props.persistMenu,o=this.state.menuHidden;return e.ariaLabel||e.labelElementId||!this._hasText()||(e=(0,n.Cl)((0,n.Cl)({},e),{labelElementId:this._labelId})),(0,n.Cl)((0,n.Cl)({id:this._labelId+"-menu",directionalHint:O.A.bottomLeftEdge},e),{shouldFocusOnContainer:this._menuShouldFocusOnContainer,shouldFocusOnMount:this._menuShouldFocusOnMount,hidden:t?o:void 0,className:(0,l.A)("ms-BaseButton-menuhost",e.className),target:this._isSplitButton?this._splitButtonContainer.current:this._buttonElement.current,onDismiss:this._onDismissMenu})},t.prototype._onRenderSplitButtonContent=function(e,t){var o,i,s=this,a=void 0===(i=(o=this.props).styles)?{}:i,l=o.disabled,c=o.allowDisabledFocus,u=o.checked,d=o.getSplitButtonClassNames,h=o.primaryDisabled,g=o.menuProps,p=o.toggle,f=o.role,b=o.primaryActionButtonProps,y=this.props.keytipProps,C=this.state.menuHidden,S=d?d(!!l,!C,!!u,!!c):a&&ot(a,!!l,!C,!!u,!!h);(0,v.kp)(t,{onClick:void 0,onPointerDown:void 0,onPointerUp:void 0,tabIndex:-1,"data-is-focusable":!1}),y&&g&&(y=this._getMemoizedMenuButtonKeytipProps(y));var k=(0,m.G1)(t,[],["disabled"]);b&&(0,v.kp)(t,b);var T=function(o){return r.createElement("div",(0,n.Cl)({},k,{"data-ktp-target":o?o["data-ktp-target"]:void 0,role:f||"button","aria-disabled":l,"aria-haspopup":!0,"aria-expanded":!C,"aria-pressed":p?!!u:void 0,"aria-describedby":(0,w._)(t["aria-describedby"],o?o["aria-describedby"]:void 0),className:S&&S.splitButtonContainer,onKeyDown:s._onSplitButtonContainerKeyDown,onTouchStart:s._onTouchStart,ref:s._splitButtonContainer,"data-is-focusable":!0,onClick:l||h?void 0:s._onSplitButtonPrimaryClick,tabIndex:!l&&!h||c?0:void 0,"aria-roledescription":t["aria-roledescription"],onFocusCapture:s._onSplitContainerFocusCapture}),r.createElement("span",{style:{display:"flex",width:"100%"}},s._onRenderContent(e,t),s._onRenderSplitButtonMenuButton(S,o),s._onRenderSplitButtonDivider(S)))};return y?r.createElement(be,{keytipProps:y,disabled:l},(function(e){return T(e)})):T()},t.prototype._onRenderSplitButtonDivider=function(e){return e&&e.divider?r.createElement("span",{className:e.divider,"aria-hidden":!0,onClick:function(e){e.stopPropagation()}}):null},t.prototype._onRenderSplitButtonMenuButton=function(e,o){var i,s=(i=this.props).allowDisabledFocus,a=i.checked,l=i.disabled,c=i.splitButtonMenuProps,u=i.splitButtonAriaLabel,d=i.primaryDisabled,h=this.state.menuHidden,g=this.props.menuIconProps;void 0===g&&(g={iconName:"ChevronDown"});var p=(0,n.Cl)((0,n.Cl)({},c),{styles:e,checked:a,disabled:l,allowDisabledFocus:s,onClick:this._onMenuClick,menuProps:void 0,iconProps:(0,n.Cl)((0,n.Cl)({},g),{className:this._classNames.menuIcon}),ariaLabel:u,"aria-haspopup":!0,"aria-expanded":!h,"data-is-focusable":!1});return r.createElement(t,(0,n.Cl)({},p,{"data-ktp-execute-target":o?o["data-ktp-execute-target"]:o,onMouseDown:this._onMouseDown,tabIndex:d&&!s?0:-1}))},t.prototype._onPointerDown=function(e){var t=this.props.onPointerDown;t&&t(e),"touch"===e.pointerType&&(this._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0,e.state.menuHidden&&e.focus()}),500)},t.prototype._isValidMenuOpenKey=function(e){return this.props.menuTriggerKeyCode?e.which===this.props.menuTriggerKeyCode:!!this.props.menuProps&&e.which===u.c.down&&(e.altKey||e.metaKey)},t.defaultProps={baseClassName:"ms-Button",styles:{},split:!1},t.contextType=S.dM,t}(r.Component),nt=o(8838),rt=o(41178),st=o(9348),at=o(40089),lt=o(28011),ct=o(75787),ut=(0,a.J9)(at.HD),dt=(0,a.J9)((function(e,t,o){return(0,n.Cl)((0,n.Cl)((0,n.Cl)({},e),t),{__shadowConfig__:o})})),ht={outline:0},gt=function(e){return{fontSize:e,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",flexShrink:0}},pt=(0,a.J9)((function(e){var t,o,n=e.semanticColors,r=e.effects,s=e.fonts,a=n.buttonBorder,l=n.disabledBackground,c=n.disabledText,u={left:-2,top:-2,bottom:-2,right:-2,outlineColor:"ButtonText"};return{root:[(0,i.gm)(e,{inset:1,highContrastStyle:u,borderColor:"transparent"}),e.fonts.medium,{border:"1px solid "+a,borderRadius:r.roundedCorner2,boxSizing:"border-box",cursor:"pointer",display:"inline-block",padding:"0 16px",textDecoration:"none",textAlign:"center",userSelect:"none",":active > span":{position:"relative",left:0,top:0}}],rootDisabled:[(0,i.gm)(e,{inset:1,highContrastStyle:u,borderColor:"transparent"}),{backgroundColor:l,borderColor:l,color:c,cursor:"default",":hover":ht,":focus":ht}],iconDisabled:(t={color:c},t[i.up]={color:"GrayText"},t),menuIconDisabled:(o={color:c},o[i.up]={color:"GrayText"},o),flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},description:{display:"block"},textContainer:{flexGrow:1,display:"block"},icon:gt(s.mediumPlus.fontSize),menuIcon:gt(s.small.fontSize),label:{margin:"0 4px",lineHeight:"100%",display:"block"},screenReaderText:i.dX}})),ft=(0,a.J9)((function(e,t){var o,r,s,a,l,c,u,d,h,g,p,f,m,v,b,y,C=e.effects,S=e.palette,w=e.semanticColors,k={left:-2,top:-2,bottom:-2,right:-2,border:"none"},T={position:"absolute",width:1,right:31,top:8,bottom:8},x={splitButtonContainer:[(0,i.gm)(e,{highContrastStyle:k,inset:2,pointerEvents:"none"}),{display:"inline-flex",".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none",flexGrow:"1"},".ms-Button--primary":(o={borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",flexGrow:"1",":hover":{border:"none"},":active":{border:"none"}},o[i.up]=(0,n.Cl)((0,n.Cl)({color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0"},(0,i.Qg)()),{":hover":{backgroundColor:"Highlight",border:"1px solid Highlight",borderRightWidth:"0",color:"HighlightText"},":active":{border:"1px solid Highlight"}}),o),".ms-Button--default + .ms-Button":(r={},r[i.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,n.Cl)({backgroundColor:"HighlightText",color:"Highlight"},(0,i.Qg)())}},r),'.ms-Button--default + .ms-Button[aria-expanded="true"]':(s={},s[i.up]={backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,n.Cl)({backgroundColor:"HighlightText",color:"Highlight"},(0,i.Qg)())},s),".ms-Button--primary + .ms-Button":(a={border:"none"},a[i.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{borderLeftWidth:"0",backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",".ms-Button-menuIcon":(0,n.Cl)((0,n.Cl)({},(0,i.Qg)()),{color:"HighlightText"})}},a),'.ms-Button--primary + .ms-Button[aria-expanded="true"]':(0,n.Cl)((0,n.Cl)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},(0,i.Qg)()),{".ms-Button-menuIcon":{color:"HighlightText"}}),".ms-Button.is-disabled":(l={},l[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},l)}],splitButtonContainerHovered:{".ms-Button--default.is-disabled":(c={backgroundColor:w.buttonBackgroundDisabled,color:w.buttonTextDisabled},c[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c),".ms-Button--primary.is-disabled":(u={backgroundColor:w.primaryButtonBackgroundDisabled,color:w.primaryButtonTextDisabled},u[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u)},splitButtonContainerChecked:{".ms-Button--primary":(d={},d[i.up]=(0,n.Cl)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),d)},splitButtonContainerCheckedHovered:{".ms-Button--primary":(h={},h[i.up]=(0,n.Cl)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),h)},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:(g={padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:C.roundedCorner2,borderBottomRightRadius:C.roundedCorner2,border:"1px solid ".concat(S.neutralSecondaryAlt),borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},g[i.up]={".ms-Button-menuIcon":{color:"WindowText"}},g),splitButtonDivider:(0,n.Cl)((0,n.Cl)({},T),(p={},p[i.up]={backgroundColor:"WindowText"},p)),splitButtonDividerDisabled:(0,n.Cl)((0,n.Cl)({},T),(f={},f[i.up]={backgroundColor:"GrayText"},f)),splitButtonMenuButtonDisabled:(m={pointerEvents:"none",border:"none",":hover":{cursor:"default"},".ms-Button--primary":(v={},v[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},v),".ms-Button-menuIcon":(b={},b[i.up]={color:"GrayText"},b)},m[i.up]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},m),splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:(y={outline:"none",border:"none"},y[i.up]=(0,n.Cl)({color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},(0,i.Qg)()),y),splitButtonMenuFocused:(0,n.Cl)({},(0,i.gm)(e,{highContrastStyle:k,inset:2}))};return(0,i.TW)(x,t)})),mt=(0,a.J9)((function(e,t,o){var r,s,a,l,c,u=e.fonts,h=e.palette,g=pt(e),p=ft(e),f={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"16px 12px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:i.BO.semibold},description:[u.small,{lineHeight:"100%"}]},m={description:{color:h.neutralSecondary},descriptionHovered:{color:h.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},v={description:(r={color:h.white},r[i.up]=(0,n.Cl)({backgroundColor:"WindowText",color:"Window"},(0,i.Qg)()),r),descriptionHovered:(s={color:h.white},s[i.up]={backgroundColor:"Highlight",color:"Window"},s),descriptionPressed:(a={color:"inherit"},a[i.up]=(0,n.Cl)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),a),descriptionChecked:(l={color:"inherit"},l[i.up]=(0,n.Cl)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),l),descriptionDisabled:(c={color:"inherit"},c[i.up]={color:"inherit"},c)};return(0,i.TW)(g,f,o?function(e){var t,o,r,s,a,l,c,u,h,g=e.palette,p=e.semanticColors;return{root:(t={backgroundColor:p.primaryButtonBackground,border:"1px solid ".concat(p.primaryButtonBackground),color:p.primaryButtonText},t[i.up]=(0,n.Cl)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,i.Qg)()),t[".".concat(d.Y2," &:focus, :host(.").concat(d.Y2,") &:focus")]={":after":{border:"none",outlineColor:g.white}},t),rootHovered:(o={backgroundColor:p.primaryButtonBackgroundHovered,border:"1px solid ".concat(p.primaryButtonBackgroundHovered),color:p.primaryButtonTextHovered},o[i.up]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},o),rootPressed:(r={backgroundColor:p.primaryButtonBackgroundPressed,border:"1px solid ".concat(p.primaryButtonBackgroundPressed),color:p.primaryButtonTextPressed},r[i.up]=(0,n.Cl)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,i.Qg)()),r),rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:(s={color:p.primaryButtonTextDisabled,backgroundColor:p.primaryButtonBackgroundDisabled},s[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s),splitButtonContainer:(a={},a[i.up]={border:"none"},a),splitButtonDivider:(0,n.Cl)((0,n.Cl)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(l={backgroundColor:g.white},l[i.up]={backgroundColor:"Window"},l)),splitButtonMenuButton:(c={backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText},c[i.up]={backgroundColor:"Canvas"},c[":hover"]=(u={backgroundColor:p.primaryButtonBackgroundHovered},u[i.up]={color:"Highlight"},u),c),splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,":hover":{backgroundColor:p.primaryButtonBackgroundPressed}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,":hover":{backgroundColor:p.primaryButtonBackgroundPressed}},splitButtonMenuIcon:{color:p.primaryButtonText},splitButtonMenuIconDisabled:(h={color:g.neutralTertiary},h[i.up]={color:"GrayText"},h)}}(e):function(e){var t,o,r,s,a,l=e.semanticColors,c=e.palette,u=l.buttonBackground,d=l.buttonBackgroundPressed,h=l.buttonBackgroundHovered,g=l.buttonBackgroundDisabled,p=l.buttonText,f=l.buttonTextHovered,m=l.buttonTextDisabled,v=l.buttonTextChecked,b=l.buttonTextCheckedHovered;return{root:{backgroundColor:u,color:p},rootHovered:(t={backgroundColor:h,color:f},t[i.up]={borderColor:"Highlight",color:"Highlight"},t),rootPressed:{backgroundColor:d,color:v},rootExpanded:{backgroundColor:d,color:v},rootChecked:{backgroundColor:d,color:v},rootCheckedHovered:{backgroundColor:d,color:b},rootDisabled:(o={color:m,backgroundColor:g},o[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},o),splitButtonContainer:(r={},r[i.up]={border:"none"},r),splitButtonMenuButton:{color:c.white,backgroundColor:"transparent",":hover":(s={backgroundColor:c.neutralLight},s[i.up]={color:"Highlight"},s)},splitButtonMenuButtonDisabled:{backgroundColor:l.buttonBackgroundDisabled,":hover":{backgroundColor:l.buttonBackgroundDisabled}},splitButtonDivider:(0,n.Cl)((0,n.Cl)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(a={backgroundColor:c.neutralTertiaryAlt},a[i.up]={backgroundColor:"WindowText"},a)),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:c.neutralQuaternaryAlt,":hover":{backgroundColor:c.neutralQuaternaryAlt}},splitButtonMenuButtonExpanded:{backgroundColor:c.neutralQuaternaryAlt,":hover":{backgroundColor:c.neutralQuaternaryAlt}},splitButtonMenuIcon:{color:l.buttonText},splitButtonMenuIconDisabled:{color:l.buttonTextDisabled}}}(e),o?v:m,p,t)})),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o,i;return(0,n.C6)(t,e),t.prototype.render=function(){var e,t,o=void 0!==(t=(e=this.props).primary)&&t,i=e.styles,s=e.theme;return r.createElement(it,(0,n.Cl)({},this.props,{variantClassName:o?"ms-Button--compoundPrimary":"ms-Button--compound",styles:mt(s,i,o)}))},t=(0,n.Cg)([(o="CompoundButton",i=["theme","styles"],!0,function(e){var t,s=(t=function(t){function s(e){var o=t.call(this,e)||this;return o._styleCache={},o._onSettingChanged=o._onSettingChanged.bind(o),o}return(0,n.C6)(s,t),s.prototype.componentDidMount=function(){nt.X.observe(this._onSettingChanged)},s.prototype.componentWillUnmount=function(){nt.X.unobserve(this._onSettingChanged)},s.prototype.render=function(){var t=this;return r.createElement(ct.f,{stylesheetKey:o},(function(s){return r.createElement(st.z.Consumer,null,(function(a){var l,c=nt.X.getSettings(i,o,a.customizations),u=null!==(l=t.context.window)&&void 0!==l?l:(0,z.z)(),d=ut(o,s,u),h=t.props;if(c.styles&&"function"==typeof c.styles&&(c.styles=c.styles((0,n.Cl)((0,n.Cl)({},c),h))),c.styles){if(t._styleCache.default!==c.styles||t._styleCache.component!==h.styles){var g=(0,lt.T)(c.styles,h.styles);g.__shadowConfig__=d,t._styleCache.default=c.styles,t._styleCache.component=h.styles,t._styleCache.merged=g}return r.createElement(e,(0,n.Cl)({},c,h,{styles:t._styleCache.merged}))}var p=dt(c.styles,h.styles,d);return r.createElement(e,(0,n.Cl)({},c,h,{styles:p}))}))}))},s.prototype._onSettingChanged=function(){this.forceUpdate()},s}(r.Component),t.displayName="Customized"+o,t.contextType=Me._0,t);return(0,rt.D)(e,s)})],t),t}(r.Component);!function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(Xe||(Xe={}));var bt,yt=(0,I.Z)(),Ct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"==typeof e.content?r.createElement("p",{className:t._classNames.subText},e.content):r.createElement("div",{className:t._classNames.subText},e.content)},t}return(0,n.C6)(t,e),t.prototype.render=function(){var e,t,o=(e=this.props).className,i=e.calloutProps,s=e.directionalHint,a=e.directionalHintForRTL,l=e.styles,c=e.id,u=e.maxWidth,d=void 0===(t=e.onRenderContent)?this._onRenderContent:t,h=e.targetElement,g=e.theme;return this._classNames=yt(l,{theme:g,className:o||i&&i.className,beakWidth:i&&i.isBeakVisible?i.beakWidth:0,gapSpace:i&&i.gapSpace,maxWidth:u}),r.createElement(Z.P,(0,n.Cl)({target:h,directionalHint:s,directionalHintForRTL:a},i,(0,m.G1)(this.props,m.JM,["id"]),{className:this._classNames.root}),r.createElement("div",{className:this._classNames.content,id:c,onFocus:this.props.onFocus,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},d(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:O.A.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(r.Component),St=(0,k.I)(Ct,(function(e){var t=e.className,o=e.beakWidth,n=void 0===o?16:o,r=e.gapSpace,s=void 0===r?0:r,a=e.maxWidth,l=e.theme,c=l.semanticColors,u=l.fonts,d=l.effects,h=-(Math.sqrt(n*n/2)+s)+1/window.devicePixelRatio;return{root:["ms-Tooltip",l.fonts.medium,i.lw.fadeIn200,{background:c.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:a,selectors:{":after":{content:"''",position:"absolute",bottom:h,left:h,right:h,top:h,zIndex:0}}},t],content:["ms-Tooltip-content",u.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"});!function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(bt||(bt={}));var wt=o(17874),kt=(0,I.Z)(),Tt=function(e){function t(o){var i=e.call(this,o)||this;return i._tooltipHost=r.createRef(),i._defaultTooltipId=(0,f.O)("tooltip"),i.show=function(){i._toggleTooltip(!0)},i.dismiss=function(){i._hideTooltip()},i._getTargetElement=function(){if(i._tooltipHost.current){var e=i.props.overflowMode;if(void 0!==e)switch(e){case Xe.Parent:return i._tooltipHost.current.parentElement;case Xe.Self:return i._tooltipHost.current}return i._tooltipHost.current}},i._onTooltipFocus=function(e){i._ignoreNextFocusEvent?i._ignoreNextFocusEvent=!1:i._onTooltipMouseEnter(e)},i._onTooltipContentFocus=function(e){t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,i._clearDismissTimer(),i._clearOpenTimer()},i._onTooltipBlur=function(e){var t;i._ignoreNextFocusEvent=(null===(t=(0,wt.LW)(i.context))||void 0===t?void 0:t.activeElement)===e.target,i._dismissTimerId=i._async.setTimeout((function(){i._hideTooltip()}),0)},i._onTooltipMouseEnter=function(e){var o,n,r=(o=i.props).overflowMode,s=o.delay,a=(0,wt.LW)(i.context);if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,void 0!==r){var l=i._getTargetElement();if(l&&!function(e){return e.clientWidth<e.scrollWidth}(n=l)&&!function(e){return e.clientHeight<e.scrollHeight}(n))return}if(!e.target||!(0,c.s)(e.target,i._getTargetElement(),a))if(i._clearDismissTimer(),i._clearOpenTimer(),s!==bt.zero){var u=i._getDelayTime(s);i._openTimerId=i._async.setTimeout((function(){i._toggleTooltip(!0)}),u)}else i._toggleTooltip(!0)},i._onTooltipMouseLeave=function(e){var o=i.props.closeDelay;i._clearDismissTimer(),i._clearOpenTimer(),o?i._dismissTimerId=i._async.setTimeout((function(){i._toggleTooltip(!1)}),o):i._toggleTooltip(!1),t._currentVisibleTooltip===i&&(t._currentVisibleTooltip=void 0)},i._onTooltipKeyDown=function(e){(e.which===u.c.escape||e.ctrlKey)&&i.state.isTooltipVisible&&(i._hideTooltip(),e.stopPropagation())},i._clearDismissTimer=function(){i._async.clearTimeout(i._dismissTimerId)},i._clearOpenTimer=function(){i._async.clearTimeout(i._openTimerId)},i._hideTooltip=function(){i._clearOpenTimer(),i._clearDismissTimer(),i._toggleTooltip(!1)},i._toggleTooltip=function(e){i.state.isTooltipVisible!==e&&i.setState({isTooltipVisible:e},(function(){return i.props.onTooltipToggle&&i.props.onTooltipToggle(e)}))},i._getDelayTime=function(e){switch(e){case bt.medium:return 300;case bt.long:return 500;default:return 0}},(0,h.f)(i),i.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},i}return(0,n.C6)(t,e),t.prototype.render=function(){var e,t,o=(e=this.props).calloutProps,s=e.children,a=e.content,l=e.directionalHint,c=e.directionalHintForRTL,u=e.hostClassName,d=e.id,h=void 0===(t=e.setAriaDescribedBy)||t,g=e.tooltipProps,p=e.styles,f=e.theme;this._classNames=kt(p,{theme:f,className:u});var b=this.state.isTooltipVisible,y=d||this._defaultTooltipId,C=(0,n.Cl)((0,n.Cl)({id:"".concat(y,"--tooltip"),content:a,targetElement:this._getTargetElement(),directionalHint:l,directionalHintForRTL:c,calloutProps:(0,v.kp)({},o,{onDismiss:this._hideTooltip,onFocus:this._onTooltipContentFocus,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},(0,m.G1)(this.props,m.JM,["id"])),g),S=(null==g?void 0:g.onRenderContent)?g.onRenderContent(C,(function(e){return(null==e?void 0:e.content)?r.createElement(r.Fragment,null,e.content):null})):a,w=b&&!!S,k=h&&b&&S?y:void 0;return r.createElement("div",(0,n.Cl)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipFocus},{onBlurCapture:this._onTooltipBlur},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":k}),s,w&&r.createElement(St,(0,n.Cl)({},C)),r.createElement("div",{hidden:!0,id:y,style:i.dX},S))},t.prototype.componentDidMount=function(){this._async=new g.j(this)},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:bt.medium},t.contextType=Me._0,t}(r.Component),xt={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"},It=(0,k.I)(Tt,(function(e){var t=e.className,o=e.theme;return{root:[(0,i.Km)(xt,o).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"});(0,o(1854).hN)([{rawString:"@media screen and (-ms-high-contrast: active),(forced-colors: active){.hasKeyboardFocus_67b207b6{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials:hover{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}}"}]);var _t=o(98138),Et=o(95012);class At extends r.Component{render(){var e;const t=-16-(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.horizontalSpacing)?this.props.style.horizontalSpacing:0);return r.createElement("div",{style:{height:24,width:24,position:"fixed",background:this.props.theme.badgeBackground,border:"1px solid "+this.props.theme.badgeText,borderTopRightRadius:"50%",borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",boxSizing:"border-box",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13)",marginLeft:t,marginTop:-16,textAlign:"center",color:this.props.theme.badgeText,paddingTop:2,zIndex:1,userSelect:"none"}},this.props.text)}}var Rt=o(68664);class Bt{constructor(e){this._event=e}get isOriginal(){return this._event.currentTarget===this._event.target}stopPropagation(){this._event.stopPropagation()}}var Mt=o(30885),Dt=o(2381),Ot=o(90379);let Ft=0;var Pt=o(90096),Nt=o(4168),Lt=o(30444),jt=o(11212),qt=o(96748),Ht=o(4301);const zt=(e,t,o,i,n,s,a)=>{var l,c,u,d,h,g,p,f,m,v,b;if(e.children)return e.children;const y={flexibleSize:qt.f6(e)?"center"!==qt.AW(e.style):void 0},C=Ut(e,o,i,n,s,a),S=Vt(e),w=$t(e,t,o,i,n,a),k=Kt(e,o,i,n,a),T=C||S;if(!T&&!w)return null;let x=null!==(c=null===(l=e.style)||void 0===l?void 0:l.textPaddingStart)&&void 0!==c?c:null===(u=e.style)||void 0===u?void 0:u.textHorizontalPadding,I=null!==(h=null===(d=e.style)||void 0===d?void 0:d.textPaddingEnd)&&void 0!==h?h:null===(g=e.style)||void 0===g?void 0:g.textHorizontalPadding;if(void 0===x&&void 0===I){const e=C||S?8:0;x=e,I=e}const _=w?r.createElement(Et.S,{justifyContent:Pt.Pr.Center,align:"center"!==qt.AW(e.style)?Pt.j5.Stretch:void 0,style:Object.assign({paddingStart:x,paddingEnd:I,minWidth:0},T?{flexibleSize:!0}:y)},k?r.createElement(Et.S,{direction:Pt.PR.LeftToRight,align:Pt.j5.Baseline,style:{flexibleSize:!0}},w,k):w,Qt(e,o,i,n,a)):void 0,E=e.tagText?r.createElement(Et.S,{align:Pt.j5.Center,justifyContent:Pt.Pr.Center,style:null===(p=e.tagStyles)||void 0===p?void 0:p.containerStyles},r.createElement(Nt.c,{text:e.tagText,style:null===(f=e.tagStyles)||void 0===f?void 0:f.textStyles})):void 0;return T?r.createElement(Et.S,{direction:Pt.PR.LeftToRight,align:Pt.j5.Center,style:Object.assign({minWidth:0},y)},null!=C?C:S,void 0!==(null===(m=e.style)||void 0===m?void 0:m.iconTextSpacing)&&0!==(null===(v=e.style)||void 0===v?void 0:v.iconTextSpacing)&&r.createElement(Et.S,{style:{paddingHorizontal:null===(b=e.style)||void 0===b?void 0:b.iconTextSpacing}}),_,E):_},Wt=(e,t,o)=>{const i=e.accessibilityLabel||e.title||e.subtitle;return o&&t&&e.strings&&e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment?e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment.replace("{0}",i||"").replace("{1}",e.accessibilityPositionInSet.toString(10)).replace("{2}",e.accessibilitySetSize.toString(10)):i},Gt=e=>void 0!==e.accessibilityPositionInSet&&void 0!==e.accessibilitySetSize&&e.accessibilityPositionInSet>0&&e.accessibilityPositionInSet<=e.accessibilitySetSize&&e.accessibilitySetSize>=1,Ut=(e,t,o,i,n,s)=>{var a,l;if(void 0===e.icon)return;const c={type:e.icon.type,style:e.icon.style,primaryColor:e.icon.primaryColor||oo(e,t,o,i,n,s),filled:o&&(null===(a=e.icon)||void 0===a?void 0:a.filled),fontSize:e.icon.fontSize||(null===(l=e.style)||void 0===l?void 0:l.iconFontSize)};return Lt.In.shouldRender(c,s)?r.createElement(Et.S,{accessible:e.iconShouldBeAccessible},r.createElement(Lt.In,Object.assign({},c))):void 0},Vt=e=>{if(void 0!==e.personaCoinProps&&!e.icon)return r.createElement(Et.S,{accessible:e.iconShouldBeAccessible},r.createElement(jt.c,Object.assign({},e.personaCoinProps)))},$t=(e,t,o,i,n,s)=>{if(e.title)return r.createElement(Nt.c,{text:e.title,style:Object.assign(Object.assign({},e.titleRootStyle),Jt(e,o,i,n,s)||{}),formatting:t(Xt(e,o,i,n,s)),accessibilityHidden:!0})},Kt=(e,t,o,i,n)=>e.tag?r.createElement(Et.S,{style:{marginHorizontal:8}},r.createElement(Nt.c,{text:e.tag,style:Zt(e,t,o,i,n),accessibilityHidden:!0})):void 0,Qt=(e,t,o,i,n)=>e.subtitle?r.createElement(Et.S,{style:{paddingTop:2,width:"100%"}},r.createElement(Nt.c,{text:e.subtitle,style:eo(e,t,o,i,n),formatting:to(e,t,o,i,n),accessibilityHidden:!0})):void 0,Yt=e=>e.title&&e.titleStyle&&0!==e.titleStyle.length?1===e.titleStyle.length&&0===e.titleStyle[0].start&&e.titleStyle[0].length===e.title.length?Object.assign({},e.titleStyle[0]):void 0:{},Jt=(e,t,o,i,n)=>{const r=Yt(e);if(!r)return;const s=Ht.O4(e,n),a=Ht.gZ(t,o,e.disabled,Ht.uk(e,i),s.title);return Ht.hM(r,a)},Zt=(e,t,o,i,n)=>{const r=Ht.O4(e,n),s=Ht.gZ(t,o,e.disabled,Ht.uk(e,i),r.tag||r.title);return Ht.hM(e.tagStyle,s)},Xt=(e,t,o,i,n)=>{var r;if(!e.titleFormatting_DONOTUSE&&Yt(e))return;const s=Ht.O4(e,n),a=Ht.gZ(t,o,e.disabled,Ht.uk(e,i),s.title);return Ht.EF(null!==(r=e.titleFormatting_DONOTUSE)&&void 0!==r?r:e.titleStyle,a,o)},eo=(e,t,o,i,n)=>{const r=Ht.O4(e,n),s=Ht.gZ(t,o,e.disabled,Ht.uk(e,i),r.subtitle||r.title);return Ht.hM(e.subtitleStyle,s)},to=(e,t,o,i,n)=>{if(!e.subtitleFormatting)return;const r=Ht.O4(e,n),s=Ht.gZ(t,o,e.disabled,Ht.uk(e,i),r.subtitle||r.title);return Ht.EF(e.subtitleFormatting,s,o)},oo=(e,t,o,i,n,r)=>{const s=null!=n?n:((e,t)=>{const o=Ht.O4(e,t);return o.icon||o.title})(e,r);return Ht.gZ(t,o,e.disabled,Ht.uk(e,i),s)};var io=o(28022),no=o(80409),ro=o(43452),so=o(25138),ao=o(85701),lo=o(17226),co=o(54313);const uo=(0,ao.X)({base:{Bqenvij:"f11ysow2",J657lq:"f1um431h",Jlnjib:"fte7hqw",Bc29nj9:"f1yh8ef3"},highContrast:{pu7qz5:"fi3u9nm",B10010i:"f1tdgb9w"},outline:{},primary:{J657lq:"foe7gw6",Jlnjib:"fvxlz81",Bc29nj9:"f1c2mdy",B8ia98v:"f1r39r2s"},secondary:{},subtle:{J657lq:"f1um431h",Jlnjib:"fte7hqw",Bc29nj9:"f1yh8ef3",pu7qz5:"f1xoeh18",B10010i:"f1ca1nd7"},transparent:{J657lq:"f1um431h",Jlnjib:"f1wn9xqz",Bc29nj9:"f1a8q4d0"},small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ge6w2w",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fnnf4v2",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f14s4sho",Be2twd7:"fod5ikn",Bg96gwp:"faaz57k"},disabled:{J657lq:"f1rlv8bf",Jlnjib:"fd1dbtm",Bc29nj9:"f1vqmdmi"},disabledHighContrast:{B8ia98v:"f1csacz4",pu7qz5:"f1s5tkfe",B10010i:"fs0rda3"}},{d:[".f11ysow2{height:auto;}",".f1um431h .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2);}",".foe7gw6 .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",[".f1ge6w2w{padding:var(--spacingHorizontalS) var(--spacingHorizontalS) var(--spacingHorizontalMNudge) var(--spacingHorizontalS);}",{p:-1}],".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".fnnf4v2{padding:14px var(--spacingHorizontalM) var(--spacingHorizontalL) var(--spacingHorizontalM);}",{p:-1}],[".f14s4sho{padding:18px var(--spacingHorizontalL) var(--spacingHorizontalXL) var(--spacingHorizontalL);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1rlv8bf .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}"],h:[".fte7hqw:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2Hover);}",".f1yh8ef3:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2Pressed);}",".fvxlz81:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",".f1c2mdy:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",".f1wn9xqz:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2BrandHover);}",".f1a8q4d0:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2BrandPressed);}",".fd1dbtm:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}",".f1vqmdmi:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.fi3u9nm:hover .fui-CompoundButton__secondaryContent{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tdgb9w:hover:active .fui-CompoundButton__secondaryContent{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1r39r2s .fui-CompoundButton__secondaryContent{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1xoeh18:hover .fui-CompoundButton__secondaryContent{color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ca1nd7:hover:active .fui-CompoundButton__secondaryContent{color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1csacz4 .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1s5tkfe:hover .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fs0rda3:hover:active .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),ho=(0,ao.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1t35pdg",B2u0y6b:"ft5vyj6",Bf4jedk:"f17suaiq"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1r1wyb6",B2u0y6b:"fdczgix",Bf4jedk:"fjdcg9m"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bnz8pu",B2u0y6b:"fww51uw",Bf4jedk:"f1qhsl2h"}},{d:[[".f1t35pdg{padding:var(--spacingHorizontalXS);}",{p:-1}],".ft5vyj6{max-width:48px;}",".f17suaiq{min-width:48px;}",[".f1r1wyb6{padding:var(--spacingHorizontalSNudge);}",{p:-1}],".fdczgix{max-width:52px;}",".fjdcg9m{min-width:52px;}",[".f1bnz8pu{padding:var(--spacingHorizontalS);}",{p:-1}],".fww51uw{max-width:56px;}",".f1qhsl2h{min-width:56px;}"]}),go=(0,ao.X)({base:{Be2twd7:"fndrnj9",Bqenvij:"fbhnoac",a9b677:"feqmc2u"},before:{t21cq0:["fkujibs","f199hnxi"]},after:{Frg6f3:["f199hnxi","fkujibs"]}},{d:[".fndrnj9{font-size:40px;}",".fbhnoac{height:40px;}",".feqmc2u{width:40px;}",".fkujibs{margin-right:var(--spacingHorizontalM);}",".f199hnxi{margin-left:var(--spacingHorizontalM);}"]}),po=(0,ao.X)({base:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",fsow6f:["f1o700av","fes3tcz"]}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}"]}),fo=(0,ao.X)({base:{Bg96gwp:"flkuc6h",Bhrd7zp:"figsok6"},small:{Be2twd7:"fy9rknc"},medium:{Be2twd7:"fy9rknc"},large:{Be2twd7:"fkhj508"}},{d:[".flkuc6h{line-height:100%;}",".figsok6{font-weight:var(--fontWeightRegular);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fkhj508{font-size:var(--fontSizeBase300);}"]});var mo=o(98121);const vo=r.forwardRef(((e,t)=>{const o=(({contentContainer:e,secondaryContent:t,...o},i)=>{var n,r;const s={...(0,so.P)(o,i),components:{root:"button",icon:"span",contentContainer:"span",secondaryContent:"span"},contentContainer:ro.Gk(e,{elementType:"span"}),secondaryContent:ro.lq(t,{elementType:"span"})};return s.iconOnly=Boolean((null===(n=s.icon)||void 0===n?void 0:n.children)&&!o.children&&!(null===(r=s.secondaryContent)||void 0===r?void 0:r.children)),s})(e,t);return(e=>{const t=uo(),o=ho(),i=go(),n=po(),r=fo(),{appearance:s,disabled:a,disabledFocusable:l,iconOnly:c,iconPosition:u,size:d}=e;e.root.className=(0,lo.z)("fui-CompoundButton",t.base,t.highContrast,s&&t[s],t[d],(a||l)&&t.disabled,(a||l)&&t.disabledHighContrast,c&&o[d],e.root.className),e.contentContainer.className=(0,lo.z)("fui-CompoundButton__contentContainer",n.base,e.contentContainer.className),e.icon&&(e.icon.className=(0,lo.z)("fui-CompoundButton__icon",i.base,void 0!==e.root.children&&null!==e.root.children&&i[u],e.icon.className)),e.secondaryContent&&(e.secondaryContent.className=(0,lo.z)("fui-CompoundButton__secondaryContent",r.base,r[d],e.secondaryContent.className)),(0,co.B)(e)})(o),(0,mo.$e)("useCompoundButtonStyles_unstable")(o),(e=>{(0,no.C)(e);const{iconOnly:t,iconPosition:o}=e;return(0,io.FD)(e.root,{children:["after"!==o&&e.icon&&(0,io.Y)(e.icon,{}),!t&&(0,io.FD)(e.contentContainer,{children:[e.root.children,e.secondaryContent&&(0,io.Y)(e.secondaryContent,{})]}),"after"===o&&e.icon&&(0,io.Y)(e.icon,{})]})})(o)}));vo.displayName="CompoundButton";var bo=o(9667),yo=o(97277),Co=o(92881),So=o(70491),wo=o(33341),ko=o(13327),To=o(14771),xo=o(83950),Io=o(31941),_o=o(37092),Eo=o(46279),Ao=o(38991),Ro=o(22295),Bo=o(44760),Mo=o(67894),Do=o(83546),Oo=o(93952),Fo=o(54544),Po=o(657);const No=(0,ao.X)({root:{mc9l5x:"fjseox",B7ck84d:"f1ewtqcl",B2u0y6b:"f132xexn",Bceei9c:"f158kwzp",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm",Btd35i7:"fokg9q4",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bzqsji",De3pzq:"fxugw4r",sj55zd:"f19n0e5",Bhu2qc9:"fxeb0a7"},visible:{mc9l5x:"ftgm304"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".fjseox{display:none;}",".f1ewtqcl{box-sizing:border-box;}",".f132xexn{max-width:240px;}",".f158kwzp{cursor:default;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fokg9q4{overflow-wrap:break-word;}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],[".f1bzqsji{padding:4px 11px 6px 11px;}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".fxeb0a7{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 4px 8px var(--colorNeutralShadowKey));}",".ftgm304{display:block;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}']}),Lo=e=>{const t=(e=>{var t,o,i,n;const s=(0,So.n)(),a=(0,To.wR)(),{targetDocument:l}=(0,wo.Y)(),[c,u]=(0,xo.Z)(),{appearance:d="normal",children:h,content:g,withArrow:p=!1,positioning:f="above",onVisibleChange:m,relationship:v,showDelay:b=250,hideDelay:y=250,mountNode:C}=e,[S,w]=(0,Io.i)({state:e.visible,initialState:!1}),k=r.useCallback(((e,t)=>{u(),w((o=>(t.visible!==o&&(null==m||m(e,t)),t.visible)))}),[u,w,m]),T={withArrow:p,positioning:f,showDelay:b,hideDelay:y,relationship:v,visible:S,shouldRenderTooltip:S,appearance:d,mountNode:C,components:{content:"div"},content:ro.Gk(g,{defaultProps:{role:"tooltip"},elementType:"div"})};T.content.id=(0,_o.Bi)("tooltip-",T.content.id);const x={enabled:T.visible,arrowPadding:2*Oo.Q,position:"above",align:"center",offset:4,...(0,bo.P)(T.positioning)};T.withArrow&&(x.offset=(0,yo.H)(x.offset,Oo.d));const{targetRef:I,containerRef:_,arrowRef:E}=(0,Co.T)(x);T.content.ref=(0,Eo.a)(T.content.ref,_),T.arrowRef=E,(0,Ao.E)((()=>{if(S){var e;const t={hide:e=>k(void 0,{visible:!1,documentKeyboardEvent:e})};null===(e=s.visibleTooltip)||void 0===e||e.hide(),s.visibleTooltip=t;const o=e=>{e.key!==Fo.uf9||e.defaultPrevented||(t.hide(e),e.preventDefault())};return null==l||l.addEventListener("keydown",o,{capture:!0}),()=>{s.visibleTooltip===t&&(s.visibleTooltip=void 0),null==l||l.removeEventListener("keydown",o,{capture:!0})}}}),[s,l,S,k]);const A=r.useRef(!1),R=r.useCallback((e=>{if("focus"===e.type&&A.current)return void(A.current=!1);const t=s.visibleTooltip?0:T.showDelay;c((()=>{k(e,{visible:!0})}),t),e.persist()}),[c,k,T.showDelay,s]),[B]=r.useState((()=>{const e=e=>{var t;(null===(t=e.detail)||void 0===t?void 0:t.isFocusedProgrammatically)&&(A.current=!0)};let t=null;return o=>{null==t||t.removeEventListener(ko.Oy,e),null==o||o.addEventListener(ko.Oy,e),t=o}})),M=r.useCallback((e=>{let t=T.hideDelay;"blur"===e.type&&(t=0,A.current=(null==l?void 0:l.activeElement)===e.target),c((()=>{k(e,{visible:!1})}),t),e.persist()}),[c,k,T.hideDelay,l]);T.content.onPointerEnter=(0,Ro.p)(T.content.onPointerEnter,u),T.content.onPointerLeave=(0,Ro.p)(T.content.onPointerLeave,M),T.content.onFocus=(0,Ro.p)(T.content.onFocus,u),T.content.onBlur=(0,Ro.p)(T.content.onBlur,M);const D=(0,Bo.h)(h),O={};return"label"===v?"string"==typeof T.content.children?O["aria-label"]=T.content.children:(O["aria-labelledby"]=T.content.id,T.shouldRenderTooltip=!0):"description"===v&&(O["aria-describedby"]=T.content.id,T.shouldRenderTooltip=!0),a&&(T.shouldRenderTooltip=!1),T.children=(0,Mo.L)(h,{...O,...null==D?void 0:D.props,ref:(0,Eo.a)(null==D?void 0:D.ref,B,void 0===x.target?I:void 0),onPointerEnter:(0,Do.D)((0,Ro.p)(null==D||null===(t=D.props)||void 0===t?void 0:t.onPointerEnter,R)),onPointerLeave:(0,Do.D)((0,Ro.p)(null==D||null===(o=D.props)||void 0===o?void 0:o.onPointerLeave,M)),onFocus:(0,Do.D)((0,Ro.p)(null==D||null===(i=D.props)||void 0===i?void 0:i.onFocus,R)),onBlur:(0,Do.D)((0,Ro.p)(null==D||null===(n=D.props)||void 0===n?void 0:n.onBlur,M))}),T})(e);return(e=>{const t=No();e.content.className=(0,lo.z)("fui-Tooltip__content",t.root,"inverted"===e.appearance&&t.inverted,e.visible&&t.visible,e.content.className),e.arrowClassName=t.arrow})(t),(0,mo.$e)("useTooltipStyles_unstable")(t),(e=>((0,no.C)(e),(0,io.FD)(r.Fragment,{children:[e.children,e.shouldRenderTooltip&&(0,io.Y)(Po.Z,{mountNode:e.mountNode,children:(0,io.FD)(e.content,{children:[e.withArrow&&(0,io.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.content.children]})})]})))(t)};Lo.displayName="Tooltip",Lo.isFluentTriggerComponent=!0;const jo=r.memo(r.forwardRef(((e,t)=>{var o;const n=!1,s=r.useRef(null),a=r.useRef(null),l=(Ft++,`CompositeButton${Ft}`),c=r.useRef(null),u=r.useRef(null),h=r.useContext(_t.O),[g,p]=r.useState(!1),[f,m]=r.useState(!1),[v,b]=r.useState(!1);r.useImperativeHandle(t,(()=>({focus:C,getElementRef:k,updateState_StorybookTestOnly:()=>{}})));const y=()=>{var t,o,i,n;h?e.updateItemHeight&&(null===(i=a.current)||void 0===i?void 0:i.offsetHeight)&&e.updateItemHeight(null===(n=a.current)||void 0===n?void 0:n.offsetHeight):e.updateItemHeight&&(null===(t=c.current)||void 0===t?void 0:t.offsetHeight)&&e.updateItemHeight(null===(o=c.current)||void 0===o?void 0:o.offsetHeight)};r.useEffect((()=>{y()}),[y]);const C=()=>{var t,o;e.refusesKeyboardFocus||(h?null===(t=a.current)||void 0===t||t.focus():null===(o=s.current)||void 0===o||o.focus())},S=(0,i.Zq)({":focus-visible":{outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important"},".fui-CompoundButton__contentContainer":{width:"100%"}}),w=(0,i.Zq)({outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important","@media (forced-colors: active)":{outline:"var(--strokeWidthThick) solid highlight !important"}}),k=()=>c;r.useEffect((()=>{h||e.tooltip&&u.current&&(e.isSelectedByKeyboard?u.current.show():u.current.dismiss())}),[e.isSelectedByKeyboard,h,u]);const T=()=>{var t,o;if((0,Ot.I)())return{resting:"CanvasText",focused:(null===(o=null===(t=e.icon)||void 0===t?void 0:t.style)||void 0===o?void 0:o.backgroundColor)?"CanvasText":h?"Highlight":"HighlightText",pressed:"Canvas"}},x=e=>e,I=()=>{var t;e.disabled||(null===(t=e.onHoverIn)||void 0===t||t.call(e),b(!0))},_=()=>{var t;e.disabled||(null===(t=e.onHoverOut)||void 0===t||t.call(e),b(!1),p(!1))},E=()=>{e.disabled||p(!0)},A=()=>{e.disabled||p(!1)},R=()=>{var t;!e.disabled&&(null===(t=e.onClick)||void 0===t||t.call(e))},B=t=>{var o;const i=new Bt(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,i),m(!0))},M=t=>{var o;const i=new Bt(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,i),m(!1))},D=()=>{const t=Gt(e),o=(e=>("overflow"===e.accessibilityRole||"splitbutton"===e.accessibilityRole)&&void 0!==e.accessibilityState&&void 0!==e.onAccessibilityExpandCollapse)(e),i=o&&e.accessibilityState,r=e.disableAccessibilityExpanded?void 0:i;return{role:L(),"aria-label":Wt(e,n,t),"aria-posinset":t?e.accessibilityPositionInSet:void 0,"aria-setsize":t?e.accessibilitySetSize:void 0,"aria-haspopup":o,"aria-expanded":r,"aria-selected":e.hasKeyboardFocus,"aria-labelledby":!h&&e.tooltip?l:void 0}},F=t=>{var o,i,n,r,s,a,l,c,u,g,p,f,m;const v=Ht.O4(e,{useFluentV9:h}),b=qt.f6(e),y=v.focusRing?{[`.${d.Y2} &:focus`]:{selectors:{":after":{border:"none",outlineColor:v.focusRing}}}}:void 0,C=qt.DF(e.style),S=qt.Q6(e.style),w=qt.ot(e.style),k=qt.Xo(e.style),T=qt.Cl(e.style,"start"),x=qt.Cl(e.style,"end"),I=(0,Dt.W)(e.style,"topStart"),_=(0,Dt.W)(e.style,"topEnd"),E=(0,Dt.W)(e.style,"bottomStart"),A=(0,Dt.W)(e.style,"bottomEnd"),R={borderWidth:qt.Cl(e.style),borderLeftWidth:t?x:T,borderTopWidth:qt.Cl(e.style,"top"),borderRightWidth:t?T:x,borderBottomWidth:qt.Cl(e.style,"bottom"),borderRadius:(0,Dt.W)(e.style),borderTopLeftRadius:t?_:I,borderTopRightRadius:t?I:_,borderBottomRightRadius:t?E:A,borderBottomLeftRadius:t?A:E,border:null===(o=e.style)||void 0===o?void 0:o.border};return Object.assign(Object.assign({backgroundColor:v.background.resting,paddingTop:qt.AF(e.style),paddingLeft:t?S:C,paddingBottom:qt.em(e.style),paddingRight:t?C:S,marginTop:qt.rf(e.style),marginRight:t?w:k,marginBottom:qt.dV(e.style),marginLeft:t?k:w},R),{boxShadow:null===(i=e.style)||void 0===i?void 0:i.boxShadow,opacity:qt.qr(e),flexGrow:b,flexShrink:b,textAlign:qt.AW(e.style),width:e.useFullWidth?"100%":null===(n=e.style)||void 0===n?void 0:n.width,minWidth:null!==(s=null===(r=e.style)||void 0===r?void 0:r.minWidth)&&void 0!==s?s:0,maxWidth:null!==(l=null===(a=e.style)||void 0===a?void 0:a.maxWidth)&&void 0!==l?l:"none",height:null===(c=e.style)||void 0===c?void 0:c.height,minHeight:null!==(g=null===(u=e.style)||void 0===u?void 0:u.minHeight)&&void 0!==g?g:"min-content",maxHeight:null===(p=e.style)||void 0===p?void 0:p.maxHeight,position:null===(f=e.style)||void 0===f?void 0:f.position,bottom:null===(m=e.style)||void 0===m?void 0:m.bottom,selectors:y})},P=()=>({justifyContent:qt.XI(e.style),flexDirection:"row",alignItems:"stretch"}),N=t=>{const o=Object.assign(Object.assign({},Ht.O4(e,{useFluentV9:h})),{focusRing:void 0}),i=Ht.SL(g&&!e.topPanelScopeButton,v&&!e.topPanelScopeButton,e.hoverRing,Ht.uk(e,f),e.disabled,e.showBorderWhenDisabled,o);return Object.assign(Object.assign({},F(t)),i)},L=()=>{switch(e.accessibilityRole){case"menuitem":case"option":case"tab":return e.accessibilityRole;default:return"button"}},{badgeProps:j,theme:q,tooltip:H,tooltipProps:z,refusesKeyboardFocus:W}=e,{tooltip:G,title:U}=null!=q?q:{},V=null!==(o=null==G?void 0:G.backgroundColor)&&void 0!==o?o:null==q?void 0:q.background.resting,$=r.createElement(r.Fragment,null,j?r.createElement(At,Object.assign({},j)):void 0,r.createElement(Rt.q.Consumer,null,(t=>{const o=h?(t=>{var o,i;const n=(s=Object.assign(Object.assign({lineHeight:"normal",fontWeight:"normal"},N(t)),P()),Object.keys(s).forEach((e=>void 0===s[e]&&delete s[e])),s);var s;const l=Object.assign({onFocus:B,onBlur:M,onClick:R,onPointerEnter:I,onPointerLeave:_,onPointerDown:E,onPointerUp:A,style:n,disabled:e.disabled},D());e.onHeightChange&&(null==a?void 0:a.current)&&e.onHeightChange(a.current.getBoundingClientRect().height);const c=r.createElement(vo,Object.assign({className:Ht.uk(e,f)?(0,lo.z)(S,w):S,as:"button","data-automation-id":e.automationLabel,id:e.htmlId,ref:a,appearance:e.appearance},l),zt(e,x,g,v,f,T(),{useFluentV9:h}));return e.topPanelScopeButton?r.createElement(Et.S,null,c,r.createElement("div",{style:{paddingLeft:n.paddingLeft,paddingRight:n.paddingRight,width:"100%",boxSizing:"border-box"}},r.createElement("div",{style:{width:"100%",height:"3px",background:null!==(i=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==i?i:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):c})(t):(t=>{var o,i;const a=N(t),l=Object.assign({onFocus:B,onBlur:M,onClick:R,onPointerEnter:I,onPointerLeave:_,onPointerDown:E,onPointerUp:A,styles:{root:a,rootPressed:a,rootFocused:a,rootHovered:a,rootDisabled:a,flexContainer:P()},disabled:e.disabled,ariaLabel:Wt(e,n,Gt(e))},D());Mt.tO(e,l),e.onHeightChange&&c.current&&e.onHeightChange(c.current.getBoundingClientRect().height);const u=r.createElement(vt,Object.assign({role:e.topPanelScopeButton?"tab":"button",id:e.htmlId,elementRef:c,componentRef:s,className:Ht.uk(e,f)?"hasKeyboardFocus_67b207b6":void 0},l,{"data-automation-id":e.automationLabel}),zt(e,x,g,v,f,T()));return e.topPanelScopeButton?r.createElement(Et.S,null,u,r.createElement("div",{style:{paddingLeft:a.paddingLeft,paddingRight:a.paddingRight,width:"100%",boxSizing:"border-box"}},r.createElement("div",{style:{width:"100%",height:"3px",background:null!==(i=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==i?i:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):u})(t);return W?(t=>{const o=F(t),i=P(),n=Object.assign({onMouseEnter:I,onMouseLeave:_,onMouseDown:E,onMouseUp:A,onClick:R,style:Object.assign(Object.assign(Object.assign(Object.assign({},o),{display:"flex"}),i),{cursor:"pointer"})},D());return r.createElement("div",Object.assign({},n),zt(e,x,g,v,f,T(),{useFluentV9:h}))})(t):o})));return H?h?r.createElement(Rt.q.Consumer,null,(t=>{var o,n,s,a,c,u,d;const h=(0,i.Zq)({maxWidth:null==z?void 0:z.calloutMaxWidth,borderRadius:null==z?void 0:z.borderRadius,paddingLeft:t?null==z?void 0:z.paddingEnd:null==z?void 0:z.paddingStart,paddingTop:null==z?void 0:z.paddingTop,paddingRight:t?null==z?void 0:z.paddingStart:null==z?void 0:z.paddingEnd,paddingBottom:null==z?void 0:z.paddingBottom});return r.createElement(Lo,{withArrow:null==z?void 0:z.showBeak,content:{children:H,className:h},relationship:"inaccessible",mountNode:document.getElementById(null!==(n=null===(o=e.tooltipProps)||void 0===o?void 0:o.layerHostId)&&void 0!==n?n:l),positioning:null!==(a=null===(s=e.tooltipProps)||void 0===s?void 0:s.positioning)&&void 0!==a?a:qo(null!==(u=null===(c=e.tooltipProps)||void 0===c?void 0:c.directionHint)&&void 0!==u?u:O.A.bottomCenter)},(null===(d=e.tooltipProps)||void 0===d?void 0:d.layerHostId)?$:r.createElement("div",{id:l,style:{display:"flex"}},$))})):r.createElement(Rt.q.Consumer,null,(e=>{var t,o;return r.createElement(It,{componentRef:u,directionalHint:null!==(t=null==z?void 0:z.directionHint)&&void 0!==t?t:O.A.bottomCenter,content:H,styles:{root:{display:"flex"}},id:l,calloutProps:{coverTarget:null==z?void 0:z.coverTarget,isBeakVisible:null==z?void 0:z.showBeak,onClick:R,backgroundColor:V,gapSpace:null==z?void 0:z.gapSpace,calloutMaxWidth:null==z?void 0:z.calloutMaxWidth,layerProps:(null==z?void 0:z.layerHostId)?{hostId:z.layerHostId}:void 0,styles:{beakCurtain:{backgroundColor:V},root:{backgroundColor:V,cursor:"pointer",borderRadius:null==z?void 0:z.borderRadius,paddingLeft:e?null==z?void 0:z.paddingEnd:null==z?void 0:z.paddingStart,paddingTop:null==z?void 0:z.paddingTop,paddingRight:e?null==z?void 0:z.paddingStart:null==z?void 0:z.paddingEnd,paddingBottom:null==z?void 0:z.paddingBottom}}},tooltipProps:{styles:{content:{backgroundColor:V},subText:{color:null!==(o=null==G?void 0:G.textColor)&&void 0!==o?o:null==U?void 0:U.resting,borderRadius:8}}},delay:bt.long},$)})):$})));function qo(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case O.A.topLeftEdge:return{position:"above",align:"start"};case O.A.topCenter:case O.A.topAutoEdge:return{position:"above",align:"center"};case O.A.topRightEdge:return{position:"above",align:"end"};case O.A.bottomLeftEdge:return{position:"below",align:"start"};case O.A.bottomCenter:case O.A.bottomAutoEdge:return{position:"below",align:"center"};case O.A.bottomRightEdge:return{position:"below",align:"end"};case O.A.leftTopEdge:return{position:"before",align:"top"};case O.A.leftCenter:return{position:"before",align:"center"};case O.A.leftBottomEdge:return{position:"before",align:"bottom"};case O.A.rightTopEdge:return{position:"after",align:"top"};case O.A.rightCenter:return{position:"after",align:"center"};case O.A.rightBottomEdge:return{position:"after",align:"bottom"}}}jo.displayName="CompositeButton"},33638:(e,t,o)=>{"use strict";var i,n;o.d(t,{A:()=>i,R:()=>n}),function(e){e[e.bottomCenter=5]="bottomCenter",e[e.rightCenter=12]="rightCenter"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center"}(n||(n={}))},96748:(e,t,o)=>{"use strict";if(o.d(t,{AF:()=>s,AW:()=>f,Cl:()=>h,DF:()=>n,Q6:()=>r,XI:()=>m,Xo:()=>c,dV:()=>d,em:()=>a,f6:()=>p,ot:()=>l,qr:()=>g,rf:()=>u}),3023==o.j)var i=o(33638);const n=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingStart)&&void 0!==o?o:0)},r=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingEnd)&&void 0!==o?o:0)},s=e=>{var t;return null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8},a=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingBottom)&&void 0!==o?o:0)},l=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginStart)&&void 0!==o?o:0)},c=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginEnd)&&void 0!==o?o:0)},u=e=>{var t;return null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0},d=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginBottom)&&void 0!==o?o:0)},h=(e,t)=>{var o,i;return void 0===t?void 0===(null==e?void 0:e.borderThickness)||"number"==typeof(null==e?void 0:e.borderThickness)?null!==(o=null==e?void 0:e.borderThickness)&&void 0!==o?o:1:void 0:"object"==typeof(null==e?void 0:e.borderThickness)?null!==(i=e.borderThickness[t])&&void 0!==i?i:0:void 0},g=e=>e.hidden?0:1,p=e=>{var t;return(null===(t=e.style)||void 0===t?void 0:t.flexibleSize)?1:void 0},f=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"start",m=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"flex-start"},4301:(e,t,o)=>{"use strict";o.d(t,{$C:()=>n,EF:()=>l,G7:()=>i,O4:()=>d,SL:()=>s,gZ:()=>a,hM:()=>c,uk:()=>u});const i={background:{resting:"#FFFFFF",hover:"#D2D2D2",pressed:"#B1B1B1"},title:{resting:"#262626",disabled:"#666666"},tag:{resting:"#605e5c",disabled:"#666666"},subtitle:{resting:"#666666",disabled:"#666666"},focusRing:"#969696"},n={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},tag:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},subtitle:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},r={background:{resting:"var(--colorBrandBackground)",hover:"var(--colorBrandBackgroundHover)",pressed:"var(--colorBrandBackgroundPressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForegroundOnBrand)"},tag:{resting:"var(--colorNeutralForegroundOnBrand)"},subtitle:{resting:"var(--colorNeutralForegroundOnBrand)"},icon:{resting:"var(--colorNeutralForegroundOnBrand)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},s=(e,t,o,i,n,r,s)=>{const a={};n?s.background.disabled&&(a.backgroundColor=s.background.disabled,r&&s.border&&(a.borderColor=s.border)):(t&&(s.background.hover&&(a.backgroundColor=s.background.hover),s.focusRing&&o&&(a.borderColor=s.focusRing)),i&&(s.background.focused&&(a.backgroundColor=s.background.focused),s.focusRing&&(a.borderColor=s.focusRing)),e&&s.background.pressed&&(a.backgroundColor=s.background.pressed),s.border&&!a.borderColor&&(a.borderColor=s.border));const l=a.backgroundColor||s.background.resting;return{backgroundColor:l,borderColor:a.borderColor||l}},a=(e,t,o,i,n)=>{let r=n.resting;return o?n.disabled&&(r=n.disabled):(t&&n.hover&&(r=n.hover),i&&n.focused&&(r=n.focused),e&&n.pressed&&(r=n.pressed)),r},l=(e,t,o)=>e.map((e=>{var i;let n=null!==(i=e.cssColor)&&void 0!==i?i:t;return o&&e.cssColorHover&&(n=e.cssColorHover),Object.assign(Object.assign({},e),{cssColor:n})})).filter((e=>!!e)),c=(e,t)=>e&&e.cssColor?e:e&&t?Object.assign(Object.assign({},e),{cssColor:t}):t?{cssColor:t}:e,u=(e,t)=>{const o=!(!e.showUnderline||!e.topPanelScopeButton);return t||!!e.hasKeyboardFocus||o},d=(e,t)=>e.theme?e.theme:(null==t?void 0:t.useFluentV9)?"primary"===e.appearance?r:n:i},17451:(e,t,o)=>{"use strict";o.d(t,{R:()=>u,y:()=>d});var i=o(56415),n=o(98138),r=o(12477),s=o(67056),a=o(76455),l=o(12382),c=o(43173);const u=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useContext(n.O),l=i.useRef(null),c=i.useRef(null);(0,i.useImperativeHandle)(t,(()=>({focus:u})));const u=()=>{var e,t;o?null===(e=c.current)||void 0===e||e.focus():null===(t=l.current)||void 0===t||t.focus()};return o?i.createElement(d,Object.assign({},e,{ref:c})):i.createElement(a.R,{direction:(()=>{switch(e.direction){case r.E.Horizontal:return s.E.horizontal;case r.E.Vertical:return s.E.vertical;default:return s.E.bidirectional}})(),componentRef:l},e.children)})));u.displayName="FocusZone";const d=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useRef(null),{findFirstFocusable:n}=(0,l.r)(),{children:s,disabled:a,direction:u=r.E.Default}=e;(0,i.useEffect)((()=>{a||d()}),[]),(0,i.useImperativeHandle)(t,(()=>({focus:d})));const d=()=>{var e;o.current&&(null===(e=n(o.current))||void 0===e||e.focus())},h=(0,c.i)({circular:u===r.E.Default,axis:u===r.E.Default?"grid":u===r.E.Horizontal?"horizontal":"vertical"}),g=u!==r.E.None?h:{};return i.createElement("div",Object.assign({ref:o},g),s)})));d.displayName="FocusZoneV9"},12477:(e,t,o)=>{"use strict";var i;o.d(t,{E:()=>i}),function(e){e[e.Default=0]="Default",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal",e[e.None=3]="None"}(i||(i={}))},90218:(e,t,o)=>{"use strict";o.d(t,{Y:()=>a});var i=o(56415);if(3023==o.j)var n=o(95012);if(3023==o.j)var r=o(90096);if(3023==o.j)var s=o(4168);function a(e){var t,o,a;const l=i.useRef(0),c=i.useRef(0),u=()=>{if(!e.onHeaderHeightChange)return;const t=e.componentStackStyle.marginTop?e.componentStackStyle.marginTop:e.componentStackStyle.marginVertical,o=e.componentStackStyle.paddingTop?e.componentStackStyle.paddingTop:e.componentStackStyle.paddingVertical;let i=0;e.componentStackStyle.borderWidth&&(i="object"==typeof e.componentStackStyle.borderWidth?e.componentStackStyle.borderWidth.top?e.componentStackStyle.borderWidth.top:0:e.componentStackStyle.borderWidth),e.onHeaderHeightChange((t||0)+(o||0)+i+l.current+c.current)},d=e.tagText?i.createElement(n.S,{align:r.j5.Center,justifyContent:r.Pr.Center,style:null===(t=e.tagStyles)||void 0===t?void 0:t.containerStyles},i.createElement(s.c,{text:e.tagText,style:null===(o=e.tagStyles)||void 0===o?void 0:o.textStyles})):void 0;return i.createElement(n.S,{direction:e.stackDirection,style:e.componentStackStyle,align:e.stackAlignment,accessibleLive:null!==(a=e.accessibleLive)&&void 0!==a?a:r.pq.Polite,accessibilityLabel:e.header,accessibilityRole:"group",accessible:!0,focusable:e.focusable},e.header&&i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Center},i.createElement(s.c,{onHeightChange:e=>{e!=l.current&&(l.current=e,u())},text:e.header,style:e.headerStyle,accessibilityRole:"heading"}),d),e.subheader&&e.subheaderStyle?i.createElement(s.c,{onHeightChange:e=>{e!=c.current&&(c.current=e,u())},text:e.subheader,style:e.subheaderStyle,accessibilityRole:"text"}):i.createElement(i.Fragment,null),e.children)}},90379:(e,t,o)=>{"use strict";function i(){return window.matchMedia("@media screen and (-ms-high-contrast: active), (forced-colors: active)").matches}o.d(t,{I:()=>i})},49967:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var i=o(93007),n=o(95522),r=o(49080);const s={addBotIcon:{regular:i.zo9,filled:i.Jy2},addPeopleIcon:{regular:n.bkw,filled:n.TXX},checkmarkIcon:{regular:r.iNx,filled:r._jO}},a=3023==o.j?s:null},4066:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var i=o(38955),n=o(49080);const r={dislikeIcon:{regular:i.z49,filled:i.EyP},dropdownChevronIcon:{regular:n.yuG,filled:n.W_M},errorBadgeIcon:{regular:n.V0o,filled:n.Tox}},s=3023==o.j?r:null},71953:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var i=o(49080),n=o(63409);const r={hideIcon:{regular:i.FEI,filled:i.j2V},imageGalleryIcon:{regular:n.AqR,filled:n.SH1}},s=3023==o.j?r:null},48228:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var i=o(63409),n=o(38955),r=o(93007),s=o(95522);const a={infoIcon:{regular:i.BFD,filled:i.N_H},likeIcon:{regular:n.gDx,filled:n.cP8},linkIcon:{regular:i.kN3,filled:i.quz},meetingIcon:{regular:r.TDj,filled:r.zA2},premiumDiamondIcon:{regular:s.Kh4,filled:s.m3d}},l=3023==o.j?a:null},47499:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var i=o(95522),n=o(38955);const r={readAloudIcon:{regular:i.ew3,filled:i.wrJ},sparkleIcon:{regular:i.rMb,filled:i.hw3},wandIcon:{regular:n.xE$,filled:n.vWM}},s=3023==o.j?r:null},82475:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var i=o(93007),n=o(38955);const r={accessibilityIcon:{regular:i.vXm,filled:i.ZtX},bowTieIcon:{regular:i.Zw6,filled:i.DU7},mergeCellsIcon:{regular:n.yKF,filled:n.k36},splitCellsIcon:{regular:n.slQ,filled:n.Qnz},firstRowAsHeaderIcon:{regular:n.yqm,filled:n.gbh}},s=3023==o.j?r:null},69090:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var i=o(49080),n=o(93007);const r={acceptIcon:{regular:i.iNx,filled:i._jO},cancelIcon:{regular:i.BEt,filled:i.Z5f},completedIcon:{regular:i._Xk,filled:i.gcm},repeatIcon:{regular:n.a2s,filled:n.uEE},undoIcon:{regular:n.aCh,filled:n.QZ9}},s=3023==o.j?r:null},27201:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>s});var i=o(93007),n=o(49080);const r={arrowResetIcon:{regular:i.Rvv,filled:i.Tdu},cloudIcon:{regular:n.wSM,filled:n._B},colorIcon:{regular:n.akU,filled:n.MVw},copyIcon:{regular:n.Qvr,filled:n.Enj},deleteIcon:{regular:n.y7H,filled:n.Sz$},plusIcon:{regular:i.m61,filled:i.on3}},s=3023==o.j?r:null},32240:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>l});var i=o(93007),n=o(95522),r=o(49080),s=o(63409);const a={addToDictionaryIcon:{regular:i.Rcd,filled:i.NVh},editorSettingsIcon:{regular:n.cFr,filled:n.YLH},cancelIcon:{regular:r.BEt,filled:r.Z5f},giveFeedbackIcon:{regular:n.bBX,filled:n.FfV},ignoreIcon:{regular:n.V_h,filled:n.LKJ},ignoreAllIcon:{regular:n.jrs,filled:n.tXZ},nextIcon:{regular:r.Crl,filled:r.oAB,rtlRegular:r.nUb,rtlFilled:r.NGN},overflowIcon:{regular:s.mmJ,filled:s.aKh},previousIcon:{regular:r.nUb,filled:r.NGN,rtlRegular:r.Crl,rtlFilled:r.oAB},showExplanationIcon:{regular:s.wit,filled:s.mlX}},l=3023==o.j?a:null},21168:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>g});var i=o(63233);const n=(0,i.U)("AppsAddIn20Filled","20",["M15 2.5c.41 0 .75.34.75.75v1.5h1.5a.75.75 0 0 1 0 1.5h-1.5v1.5a.75.75 0 0 1-1.5 0v-1.5h-1.5a.75.75 0 0 1 0-1.5h1.5v-1.5c0-.41.34-.75.75-.75ZM4.75 3C3.78 3 3 3.78 3 4.75v10.5c0 .97.78 1.75 1.75 1.75h10.5c.97 0 1.75-.78 1.75-1.75v-4.5C17 9.78 16.22 9 15.25 9h-4a.25.25 0 0 1-.25-.25v-4C11 3.78 10.22 3 9.25 3h-4.5ZM4.5 4.75c0-.14.11-.25.25-.25h4.5c.14 0 .25.11.25.25v4c0 .08 0 .17.02.25H4.5V4.75Zm5 5.75v5H4.75a.25.25 0 0 1-.25-.25V10.5h5Zm1.5 5v-5.02l.25.02h4c.14 0 .25.11.25.25v4.5c0 .14-.11.25-.25.25H11Z"]),r=(0,i.U)("AppsAddIn20Regular","20",["M15 3a.5.5 0 0 0-1 0v2h-2a.5.5 0 0 0 0 1h2v2a.5.5 0 0 0 1 0V6h2a.5.5 0 0 0 0-1h-2V3ZM4.5 17A1.5 1.5 0 0 1 3 15.5v-11C3 3.67 3.67 3 4.5 3H9c.83 0 1.5.67 1.5 1.5v5h5c.83 0 1.5.67 1.5 1.5v4.5c0 .83-.67 1.5-1.5 1.5h-11Zm6-6.5V16h5a.5.5 0 0 0 .5-.5V11a.5.5 0 0 0-.5-.5h-5Zm-1 5.5v-5.5H4v5a.5.5 0 0 0 .5.5h5Zm0-11.5A.5.5 0 0 0 9 4H4.5a.5.5 0 0 0-.5.5v5h5.5v-5Z"]);var s=o(52595),a=o(51189),l=o(36115),c=o(64052),u=o(75478),d=o(68695),h=o(95522);const g={appsIcon:{regular:r,filled:n},arrowUploadIcon:{regular:s.WG1,filled:s.WG1},chatBubblesQuestionIcon:{regular:a.kNP,filled:a.kNP},eccFeedbackIcon:{regular:l.tNe,filled:l.p2N},emailsIcon:{regular:c.GOF,filled:c.IJL},eventIcon:{regular:u.lVp,filled:u.HVY,rtlRegular:u.FXX,rtlFilled:u.jtT},eventRecordedIcon:{regular:u.e2F,filled:u.MzH},eventSeriesIcon:{regular:u.Sn0,filled:u.unN},filesIcon:{regular:d.OL4,filled:d.csZ},peopleIcon:{regular:h.eFJ,filled:h.mFV}}},38713:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c});var i=o(63579),n=o(64052),r=o(36115),s=o(75478),a=o(51189);const l={hashtagIcon:{regular:i.swq,filled:i.oaK},laptopIcon:{regular:n.N6m,filled:n.$8m},locationIcon:{regular:n.uwA,filled:n.OEH},memberIcon:{regular:r.afj,filled:r.MOA},personIcon:{regular:i.HNj,filled:i.hD3},phoneNumberIcon:{regular:s.FWW,filled:s.Bv7},teamsChatIcon:{regular:a.Tw6,filled:a.T$n}},c=3023==o.j?l:null},41697:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>g});var i=o(63579),n=o(1175),r=o(27392),s=o(11456),a=o(52595),l=o(42646),c=o(45337),u=o(70028),d=o(28857);const h={ffxcCalloutIcon:{regular:i.hSs,filled:i.BTT},ffxcBulletedListIcon:{regular:n.i5S,filled:n.if_,rtlRegular:n.MyB,rtlFilled:n.uhv},ffxcChecklistIcon:{regular:n.CSm,filled:n.uE4,rtlRegular:n.OUC,rtlFilled:n.a4W},ffxcCompletedIcon:{regular:n.b4K,filled:n.nVo,rtlRegular:n.ZDw,rtlFilled:n.PLv},ffxcDiscoverMenuCodeIcon:{regular:r.MiG,filled:r.IY4},ffxcInsertTextBox:{regular:s.MKZ,filled:s.Wro},ffxcNumberedListIcon:{regular:s.BHo,filled:s.Pf_,rtlRegular:s.z0D,rtlFilled:s.VmI},ffxQuestionAnswerIcon:{regular:a.Ncu,filled:a.pTW},ffxcQuoteIcon:{regular:s.g1i,filled:s.gBG},ffxcStatusTrackerIcon:{regular:l.z6r,filled:l.lq8},ffxcTableIcon:{regular:l.X_q,filled:l.xge},ffxcTableKanbanBoardIcon:{regular:c.iUz,filled:c.Gyp},ffxcTableTeamRetrospectiveIcon:{regular:u.It2,filled:u.Uhh},ffxcVoteIcon:{regular:d.TL0,filled:d.ZRL}},g=3023==o.j?h:null},46280:(e,t,o)=>{"use strict";o.d(t,{_:()=>r});var i=o(56415);if(3023==o.j)var n=o(65259);const r=e=>{var t,o;return i.createElement(i.Fragment,null,i.createElement(n._,{src:e.uri,width:null===(t=e.style)||void 0===t?void 0:t.width,height:null===(o=e.style)||void 0===o?void 0:o.height,alt:e.altText}))}},11563:(e,t,o)=>{"use strict";o.d(t,{o:()=>E});var i=o(56415),n=o(4301),r=o(53429),s=o(73463),a=o(98138);const l=e=>e.accessibilityLabel||e.title||e.strings&&e.strings.defaultOverflowButtonAccessibilityLabel,c=(e,t,o)=>{var i,r;const s=Object.assign({},null!==(r=null!==(i=t.buttonOnlyTheme)&&void 0!==i?i:t.theme)&&void 0!==r?r:(null==o?void 0:o.useFluentV9)?n.$C:n.G7);return e&&(s.background.hover&&(s.background=Object.assign(Object.assign({},s.background),{resting:s.background.hover})),s.title.hover&&(s.title=Object.assign(Object.assign({},s.title),{resting:s.title.hover})),s.subtitle&&s.subtitle.hover&&(s.subtitle=Object.assign(Object.assign({},s.subtitle),{resting:s.subtitle.hover})),s.icon&&s.icon.hover&&(s.icon=Object.assign(Object.assign({},s.icon),{resting:s.icon.hover}))),s},u=e=>{const t=e.style;return t&&void 0!==t.paddingHorizontal?t:Object.assign(Object.assign({},t),{paddingHorizontal:8})};var d=o(43173),h=o(3428),g=o(69260),p=o(57566),f=o(95012),m=o(90096),v=o(30444),b=o(94458);function y(e){return void 0!==e.iconType?{type:e.iconType,filled:!0}:void 0}function C(e,t,o){var i;const n={paddingHorizontal:8,flexibleSize:!0,iconFontSize:20};return!t||o||(n.paddingStart=8+(0,v.SL)(null===(i=e.icon)||void 0===i?void 0:i.fontSize)),n}const S=e=>{const t=[];if(e.items){const o=e.items.filter((e=>"item"===e.type)),n=o.some((e=>{const t=y(e);return!!t&&v.In.shouldRender(t)})),s=(null==e?void 0:e.id)||"";let a=1;t.push(e.items.map((t=>{switch(t.type){case"item":return function(e,t,o,n,s,a,l){const c=y(t),{itemTheme:u,automationLabelType:d,automationId:h}=e;return i.createElement(r.u,{appearance:"subtle",key:t.key,title:t.title,titleStyle:t.titleStyle,onClick:()=>o(t),disabled:t.disabled,theme:u,htmlId:l+t.key,accessibilityRole:"menuitem",automationLabel:`${d}_${t.title}_${h}`,icon:c,style:C(e,a,void 0!==t.iconType),accessibilityPositionInSet:n,accessibilitySetSize:s})}(e,t,e.onItemClick,a++,o.length,n,s);case"separator":return i.createElement(b.w,{key:t.key,color:e.theme&&e.theme.separator});default:return null}})))}return i.createElement(f.S,{style:e.style,align:m.j5.Stretch,onKeyDown:e.onKeyDown,handledKeys:[s.h.Tab]},t)};class w extends i.PureComponent{getAccessibilityLabel(){return this.props.accessibilityLabel||this.props.title||this.props.strings&&this.props.strings.defaultOverflowButtonAccessibilityLabel}renderButton(e,t,o,n,s,a,l){var c,u,d,h,g;const p=Object.assign(Object.assign({},l),{layerHostId:this.props.layerHostId?this.props.layerHostId:void 0});return i.createElement(r.u,{ref:s,key:t,htmlId:a,title:this.props.title,icon:{type:null!==(u=null===(c=this.props.icon)||void 0===c?void 0:c.type)&&void 0!==u?u:"Overflow",filled:(null===(d=this.props.icon)||void 0===d?void 0:d.filled)||o},tooltip:null!==(h=this.props.tooltip)&&void 0!==h?h:null===(g=this.props.strings)||void 0===g?void 0:g.defaultOverflowButtonAccessibilityLabel,tooltipProps:p,disabled:this.props.disabled,hidden:this.props.hidden,refusesKeyboardFocus:this.props.refusesKeyboardFocus,style:this.getStyle(),theme:this.getCompositeButtonTheme(),strings:this.props.strings,onClick:e,onHoverIn:this.props.onHoverIn,onHoverOut:this.props.onHoverOut,onFocus:this.props.onFocus,onBlur:this.props.onBlur,accessibilityLabel:this.getAccessibilityLabel(),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:o,onAccessibilityExpandCollapse:n,automationLabel:`${this.props.automationLabelType}_${this.props.title||"OverFlow"}_${this.props.automationId}`,hasKeyboardFocus:this.props.hasKeyboardFocus,onHeightChange:this.props.onHeightChange})}getCompositeButtonTheme(){return this.props.buttonOnlyTheme?this.props.buttonOnlyTheme:this.props.theme?this.props.theme:n.G7}getStyle(){const e=this.props.style;return e&&void 0!==e.paddingHorizontal?e:Object.assign(Object.assign({},e),{paddingHorizontal:8})}}class k extends w{constructor(e){super(e),this.state={menuOpen:!!e.startOpen},this.buttonRef=i.createRef(),this.onMenuDismiss=this.onMenuDismiss.bind(this),this.onButtonClick=this.onButtonClick.bind(this),this.onItemClick=this.onItemClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this)}componentDidUpdate(){this.props.startOpen&&this.openMenu()}openMenu(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.handleMenuOpen())}focus(){var e;null===(e=this.buttonRef.current)||void 0===e||e.focus()}performAccessibilityExpandCollapse(e){this.onAccessibilityExpandCollapse(e)}renderAnchorButtonAndMaybeCallout(){var e;const t=this.renderButton(this.onButtonClick,"button",this.state.menuOpen,this.onAccessibilityExpandCollapse,this.buttonRef,this.props.id,null===(e=this.props.style)||void 0===e?void 0:e.tooltipProps),o=this.state.menuOpen?this.renderCallout("callout",this.onMenuDismiss):void 0;return o?[t,o]:[t]}renderCalloutItems(e){return i.createElement(S,Object.assign({},this.props,{style:e,onItemClick:this.onItemClick,onKeyDown:this.onKeyDown}))}getCompositeButtonTheme(){const e=Object.assign({},super.getCompositeButtonTheme());return this.state.menuOpen&&(e.background.hover&&(e.background=Object.assign(Object.assign({},e.background),{resting:e.background.hover})),e.title.hover&&(e.title=Object.assign(Object.assign({},e.title),{resting:e.title.hover})),e.subtitle&&e.subtitle.hover&&(e.subtitle=Object.assign(Object.assign({},e.subtitle),{resting:e.subtitle.hover})),e.icon&&e.icon.hover&&(e.icon=Object.assign(Object.assign({},e.icon),{resting:e.icon.hover}))),e}handleMenuOpen(){this.props.onMenuOpen&&this.props.onMenuOpen()}handleMenuDismiss(e){this.props.onMenuDismiss&&this.props.onMenuDismiss(e),this.shouldFocusButtonOnDismiss()&&this.focus()}onMenuDismiss(e){this.handleMenuDismiss(e),this.setState({menuOpen:!1})}onButtonClick(){this.setState((e=>{const t={menuOpen:!e.menuOpen};return t.menuOpen?this.handleMenuOpen():this.handleMenuDismiss(),t}))}onItemClick(e){this.props.onClick&&this.props.onClick(e),e.preventDismiss||this.onMenuDismiss()}onKeyDown(e){this.props.onTabClose&&e.key===s.h.Tab&&this.onMenuDismiss(!0)}onAccessibilityExpandCollapse(e){"expand"===e&&this.state.menuOpen||"collapse"===e&&!this.state.menuOpen||this.onButtonClick()}}var T=o(96490),x=o(90730),I=o(76455),_=o(67056);class E extends k{constructor(e){super(e),this.overflowButtonRef=i.createRef()}render(){return this.context?i.createElement(A,Object.assign({},this.props,{ref:this.props.refV9})):i.createElement("div",{ref:this.overflowButtonRef,style:{display:"flex"}},this.renderAnchorButtonAndMaybeCallout())}shouldFocusButtonOnDismiss(){var e;return null===(e=this.props.shouldFocusButtonOnDismiss)||void 0===e||e}renderCallout(e,t){var o,n,r,s;const a=null===(n=null===(o=this.props.style)||void 0===o?void 0:o.calloutStyle)||void 0===n?void 0:n.borderRadius;return i.createElement(T.P,{layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:a},calloutMain:{backgroundColor:null===(r=this.props.theme)||void 0===r?void 0:r.background.resting,borderRadius:a},root:{backgroundColor:null===(s=this.props.theme)||void 0===s?void 0:s.background.resting,borderRadius:a}},key:e,role:"menu",target:this.overflowButtonRef,isBeakVisible:!1,alignTargetEdge:!0,directionalHint:x.A.bottomLeftEdge,onDismiss:t,setInitialFocus:!0},i.createElement(I.R,{isCircularNavigation:!0,handleTabKey:_.l.all},this.renderCalloutItems()))}}E.contextType=a.O;const A=i.memo((0,i.forwardRef)(((e,t)=>{var o,n,f,m,v;const b=i.useRef(null),{menuOpen:y,button:C,buttonRef:w,focus:k,setMenuOpen:T,onAccessibilityExpandCollapse:x,onMenuOpen:I,onMenuDismiss:_,onItemClick:E,onKeyDown:A}=(e=>{const t=i.useRef(null),o=i.useRef(null),[n,d]=i.useState(!!e.startOpen),h=i.useContext(a.O),g=()=>{var e;null===(e=t.current)||void 0===e||e.focus()},p=t=>{var i;null===(i=e.onMenuDismiss)||void 0===i||i.call(e,t),!1!==e.shouldFocusButtonOnDismiss?g():(()=>{var e;null===(e=o.current)||void 0===e||e.focus()})(),o.current=null},f=e=>{p(e),d(!1)},m=()=>{d((t=>{var o;const i=!t;return i?null===(o=e.onMenuOpen)||void 0===o||o.call(e):p(),i}))},v=e=>{"expand"===e&&n||"collapse"===e&&!n||m()},b=((e,t,o,n=!1,s,a,d,h)=>{var g,p,f,m,v;return i.createElement(r.u,{appearance:"subtle",ref:a,key:o,htmlId:d,title:e.title,icon:{type:null!==(p=null===(g=e.icon)||void 0===g?void 0:g.type)&&void 0!==p?p:"Overflow",filled:(null===(f=e.icon)||void 0===f?void 0:f.filled)||n},tooltip:null!==(m=e.tooltip)&&void 0!==m?m:null===(v=e.strings)||void 0===v?void 0:v.defaultOverflowButtonAccessibilityLabel,tooltipProps:e.layerHostId?{layerHostId:e.layerHostId}:void 0,disabled:e.disabled,hidden:e.hidden,refusesKeyboardFocus:e.refusesKeyboardFocus,style:u(e),theme:c(n,e,h),strings:e.strings,onClick:t,onHoverIn:e.onHoverIn,onHoverOut:e.onHoverOut,onFocus:e.onFocus,onBlur:e.onBlur,accessibilityLabel:l(e),accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:n,onAccessibilityExpandCollapse:s,automationLabel:`${e.automationLabelType}_${e.title||"OverFlow"}_${e.automationId}`,hasKeyboardFocus:e.hasKeyboardFocus,onHeightChange:e.onHeightChange})})(e,m,"button",n,v,t,e.id,{useFluentV9:h});return{menuOpen:n,button:b,buttonRef:t,focus:g,setMenuOpen:d,onAccessibilityExpandCollapse:v,onMenuOpen:t=>{var i;n||(o.current=t?document.activeElement:null,d(!0),null===(i=e.onMenuOpen)||void 0===i||i.call(e))},onMenuDismiss:f,onItemClick:t=>{var o;null===(o=e.onClick)||void 0===o||o.call(e,t),t.preventDismiss||f()},onKeyDown:t=>{e.onTabClose&&t.key===s.h.Tab&&f(!0)}}})(Object.assign(Object.assign({},e),{shouldFocusButtonOnDismiss:null===(o=e.shouldFocusButtonOnDismiss)||void 0===o||o}));(0,i.useImperativeHandle)(t,(()=>({focus:k,openMenu:I,onAccessibilityExpandCollapse:x})));const R=(0,d.i)({circular:!0,axis:"vertical"});return i.createElement(h.A,{"aria-role":"menu",trapFocus:!0,open:y,onOpenChange:(e,t)=>{T(t.open),t.open?I():_()},closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(f=null===(n=w.current)||void 0===n?void 0:n.getElementRef())||void 0===f?void 0:f.current}},i.createElement(g.W,null,i.createElement("div",{id:e.layerHostId,style:{display:"flex"},ref:b,tabIndex:-1},C)),i.createElement(p.H,{style:{padding:4,borderWidth:"0px",borderRadius:null===(v=null===(m=e.style)||void 0===m?void 0:m.calloutStyle)||void 0===v?void 0:v.borderRadius}},i.createElement("div",Object.assign({style:{display:"flex",flexDirection:"column"}},R),i.createElement(S,Object.assign({},e,{onItemClick:E,onKeyDown:A})))))})))},11212:(e,t,o)=>{"use strict";o.d(t,{c:()=>a});var i=o(56415);if(3023==o.j)var n=o(65580);if(3023==o.j)var r=o(95012);if(3023==o.j)var s=o(44932);const a=e=>{var t,o,a,c,u,d,h,g,p;const[f,m]=i.useState(!1),v=i.useRef(void 0),b=i.useRef(void 0);v.current===e.imageUrl||f||m(!0),i.useEffect((()=>(f&&!b.current&&(b.current=setTimeout((()=>{b.current=void 0,v.current=e.imageUrl,m(!1)}),e.animationTimeMs?e.animationTimeMs+200:1e3)),()=>clearTimeout(b.current))),[f,b.current]);const y=Object.assign({left:0,top:0,position:"absolute","--animation-time":`${null!==(t=e.animationTimeMs)&&void 0!==t?t:800}ms`},e.borderColor?{border:`2px solid ${e.borderColor}`,borderRadius:"50%"}:{}),C={animation:"none !important"},S=l(e.coinSize);return i.createElement(r.S,{style:{position:"relative",width:null!==(o=e.size)&&void 0!==o?o:S,height:null!==(a=e.size)&&void 0!==a?a:S}},f&&i.createElement(n.e,Object.assign({},e,{image:{src:v.current,style:C},className:s.SD,style:Object.assign({},y),initials:null!==(c=e.initials)&&void 0!==c?c:e.imageInitials,name:e.text,color:null!==(u=e.color)&&void 0!==u?u:"brand",size:null!==(d=e.size)&&void 0!==d?d:S})),i.createElement(n.e,Object.assign({},e,{image:{src:e.imageUrl,style:C},className:f?s.Dd:"",style:Object.assign({},y),initials:null!==(h=e.initials)&&void 0!==h?h:e.imageInitials,name:e.text,color:null!==(g=e.color)&&void 0!==g?g:"brand",size:null!==(p=e.size)&&void 0!==p?p:S})))},l=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},44932:(e,t,o)=>{"use strict";o.d(t,{Dd:()=>i,SD:()=>n}),(0,o(1854).hN)([{rawString:"@-webkit-keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}@keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}.coinFadeIn_04b4b0a2{-webkit-animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important;animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important}.coinFadeOut_04b4b0a2{-webkit-animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important;animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important}"}]);const i="coinFadeIn_04b4b0a2",n="coinFadeOut_04b4b0a2"},43333:(e,t,o)=>{"use strict";o.d(t,{B:()=>r});var i=o(56415),n=o(68664);(0,o(1854).hN)([{rawString:".customScrollBar_cfe9a557{scrollbar-width:none}.customScrollBar_cfe9a557::-webkit-scrollbar{display:none}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:6px;top:4px;overflow:hidden}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{position:absolute;width:3px;border-radius:6px;background:var(--thumb-color);opacity:.7}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557:hover{width:5px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.ltr_cfe9a557{right:3px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.rtl_cfe9a557{left:3px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{background:highlight !important}}"}]);const r=i.memo((e=>{var t,o,r,a;const l=!!e.alwaysShowScrollbar,[c,u]=i.useState(l),[d,h]=i.useState(20),[g,p]=i.useState((null===(t=e.style)||void 0===t?void 0:t.paddingScrollTop)?e.style.paddingScrollTop:0),[f,m]=i.useState(0),[v,b]=i.useState(!1),y=i.useRef({delta:{x:0,y:0}}),C=i.useRef(null),S=i.useRef(null),w=(null===(o=e.style)||void 0===o?void 0:o.scrollbarThumbWidth)?e.style.scrollbarThumbWidth:6,k=(null===(r=e.style)||void 0===r?void 0:r.scrollbarPaddingBottom)?e.style.scrollbarPaddingBottom:0,T=()=>{var t,o;if(C.current){const{style:i}=e,{clientHeight:n,scrollHeight:r}=C.current;return{clientHeight:n,contentHeight:r,viewableRatio:(n-(null!==(t=null==i?void 0:i.paddingTop)&&void 0!==t?t:0)-(null!==(o=null==i?void 0:i.paddingBottom)&&void 0!==o?o:0))/(r+k)}}return{clientHeight:0,contentHeight:0,viewableRatio:0}},x=(null===(a=e.style)||void 0===a?void 0:a.paddingScrollTop)?e.style.paddingScrollTop:0,I={scrollableContainer:{scroll:t=>{var o;if(C.current){const{viewableRatio:e}=T();p(Math.max(e*C.current.scrollTop,x))}null===(o=e.onScroll)||void 0===o||o.call(e,t)},mouseOver:()=>{if(s(C,c,g,l)){const{onScrollStatusChange:t}=e;t&&t(!0),u(!0)}},mouseUp:()=>{b(!1),y.current.delta={x:0,y:0}}},scrollbarContainer:{mouseDown:e=>{if(e.preventDefault(),C.current&&S.current){const{clientHeight:t,contentHeight:o}=T(),i=e.clientY-S.current.getBoundingClientRect().top;C.current.scroll({top:i/t*o}),b(!0)}}},scrollbarThumb:{mouseDown:e=>{e.stopPropagation(),e.preventDefault(),b(!0)}}},{scrollTo:_}=e;let E;switch(i.useEffect((()=>{if(C.current){const t=s(C,c,g,l);if(t!==c){const{onScrollStatusChange:o}=e;o&&o(t),u(t)}}})),i.useEffect((()=>(()=>{if(C.current&&e.scrollTo){const{top:t,bottom:o,isNewRender:i}=e.scrollTo,n=6,r=Math.max(t-n,0),a=Math.min(o+n,C.current.scrollHeight);if(r<C.current.scrollTop?C.current.scrollTo({top:r,behavior:"smooth"}):a>=C.current.scrollTop+C.current.offsetHeight&&C.current.scrollTo({top:a-C.current.offsetHeight,behavior:"smooth"}),!i&&s(C,c,g,l)){const{onScrollStatusChange:t}=e;t&&t(!0),u(!0)}}})()),[null==_?void 0:_.top,null==_?void 0:_.bottom]),i.useEffect((()=>(()=>{if(C.current){const{clientHeight:e,viewableRatio:t}=T();h(Math.round(t*e)),m(e)}})())),i.useEffect((()=>{if(!v)return;const e=()=>b(!1);return window.addEventListener("mouseup",e,{once:!0,passive:!0}),()=>window.removeEventListener("mouseup",e)}),[v]),i.useEffect((()=>{if(!v)return;let e;const t=t=>{v&&(t.movementX||t.movementY)&&(y.current.delta.x+=t.movementX,y.current.delta.y+=t.movementY,null==e&&(e=requestAnimationFrame((()=>{if(e=void 0,C.current){const{y:e}=y.current.delta;y.current.delta={x:0,y:0};const{clientHeight:t,contentHeight:o}=T();C.current.scroll({top:C.current.scrollTop+e/t*o})}}))))};return window.addEventListener("mousemove",t,{passive:!0}),()=>window.removeEventListener("mousemove",t)}),[v]),e.scrollDirection){case"horizontal":E={overflowY:"hidden",overflowX:"auto",display:"flex",flexDirection:"row"};break;case"both":E={overflowY:"auto",overflowX:"auto",display:"block",flexDirection:"row"};break;default:E={overflowY:"auto",overflowX:"hidden",display:"block",flexDirection:"column"}}const A=i.useContext(n.q),R="horizontal"!==e.scrollDirection?i.createElement("div",{style:{height:f,opacity:e.hidden?0:1},className:"scrollbarContainer_cfe9a557 "+(A?"rtl_cfe9a557":"ltr_cfe9a557"),ref:S,onMouseDown:I.scrollbarContainer.mouseDown},c&&i.createElement("div",{style:{height:d,top:g,width:w},className:"scrollbarThumb_cfe9a557",onMouseDown:I.scrollbarThumb.mouseDown})):void 0;return i.createElement("div",{style:(t=>{let o=Object.assign({},t);const{style:i,theme:n}=e;if(i){if(i.paddingHorizontal)o.paddingRight=i.paddingHorizontal,o.paddingLeft=i.paddingHorizontal;else{const e=A?i.paddingEnd:i.paddingStart,t=A?i.paddingStart:i.paddingEnd;void 0!==t&&(o.paddingRight=t),void 0!==e&&(o.paddingLeft=e)}i.paddingTop&&(o.paddingTop=i.paddingTop),i.paddingBottom&&(o.paddingBottom=i.paddingBottom),i.borderRadius&&(o.borderRadius=i.borderRadius),i.width&&(o.width=i.width)}return n&&n.thumbColor&&(o=Object.assign(Object.assign({},o),{"--thumb-color":n.thumbColor})),o})(E),className:"customScrollBar_cfe9a557",ref:C,onScroll:I.scrollableContainer.scroll,onMouseUp:I.scrollableContainer.mouseUp,onMouseOver:I.scrollableContainer.mouseOver},e.children,R)}));function s(e,t,o,i){if(e.current){const{clientHeight:n,scrollHeight:r}=e.current;return r>n&&(o>4||t||i)}return!1}r.displayName="ScrollView"},3592:(e,t,o)=>{"use strict";o.d(t,{G:()=>u});var i=o(56415);if(3023==o.j)var n=o(30885);if(3023==o.j)var r=o(33980);if(3023==o.j)var s=o(68664);if(3023==o.j)var a=o(69103);if(3023==o.j)var l=o(49080);if(3023==o.j)var c=o(95522);const u=({htmlId:e,theme:t,styles:o,accessibilityLabel:u,accessibilitySetSize:d,accessibilityPositionInSet:h,placeholder:g,disabled:p,handledKeys:f,spellCheck:m,value:v,hideDismiss:b,autoFocus:y,isSearchBoxHighlighted:C,onValueChange:S,onKeyDown:w,onClear:k})=>{var T,x,I;const _={};n.tO({onKeyDown:w,handledKeys:f},_);const E=i.useContext(s.q),A=(0,r.Zq)({"& input":{color:null==t?void 0:t.textColor,"::placeholder":{color:null==t?void 0:t.placeholderTextColor}}}),R=(0,r.Zq)({backgroundColor:null===(T=null==t?void 0:t.clearButton)||void 0===T?void 0:T.resting,":hover":{backgroundColor:null===(x=null==t?void 0:t.clearButton)||void 0===x?void 0:x.hover}}),B=i.useRef(null);return i.useEffect((()=>{var e;C&&(null===(e=B.current)||void 0===e||e.focus())}),[C]),i.useEffect((()=>{var e;y&&(null===(e=B.current)||void 0===e||e.focus())}),[]),i.createElement(a.G,{ref:B,className:A,style:{background:null==t?void 0:t.background,borderColor:null===(I=null==t?void 0:t.borderColor)||void 0===I?void 0:I.resting,borderRadius:null==o?void 0:o.borderRadius,borderBottom:null==o?void 0:o.borderBottom,width:null==o?void 0:o.width,marginTop:null==o?void 0:o.marginTop,marginBottom:null==o?void 0:o.marginBottom,marginLeft:E?null==o?void 0:o.marginEnd:null==o?void 0:o.marginStart,marginRight:E?null==o?void 0:o.marginStart:null==o?void 0:o.marginEnd},autoComplete:"off",placeholder:g,onChange:(e,t)=>null==S?void 0:S(t.value),id:e,"aria-label":u,"aria-posinset":h,"aria-setsize":d,disabled:p,defaultValue:v,onKeyDown:_.onKeyDown,dismiss:b?null:i.createElement(l.BEt,{color:null==t?void 0:t.textColor,className:R,onClick:k}),spellCheck:m,contentBefore:i.createElement(c.vMY,{color:null==t?void 0:t.iconColor})})}},94458:(e,t,o)=>{"use strict";o.d(t,{w:()=>s});var i=o(56415);if(3023==o.j)var n=o(81343);if(3023==o.j)var r=o(68664);const s=({style:e,onHeightChange:t})=>{var o;const s=(null==e?void 0:e.marginHorizontal)?e.marginHorizontal:0,a=(null==e?void 0:e.marginVertical)?e.marginVertical:0,l=void 0!==(null==e?void 0:e.marginTop)?e.marginTop:a||0,c=void 0!==(null==e?void 0:e.marginBottom)?e.marginBottom:a||0,u=void 0!==(null==e?void 0:e.marginStart)?e.marginStart:s||0,d=void 0!==(null==e?void 0:e.marginEnd)?e.marginEnd:s||0,h=i.useContext(r.q),g=h?d:u,p=h?u:d,f=null!==(o=null==e?void 0:e.height)&&void 0!==o?o:2;t&&t(f+l+c);const m={height:`${f}px`,padding:"0px"};return i.createElement("div",{style:{marginTop:l,marginBottom:c,marginLeft:g,marginRight:p}},i.createElement(n.c,{style:m}))}},23691:(e,t,o)=>{"use strict";o.d(t,{v:()=>c});var i=o(56415);if(3023==o.j)var n=o(95012);if(3023==o.j)var r=o(90096);if(3023==o.j)var s=o(24281);if(3023==o.j)var a=o(3451);function l(e){if(e)return{paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingHorizontal:e.paddingHorizontal}}const c=e=>{var t,o,c;if(e.styles&&e.styles.widths&&e.shimmerCount!==e.styles.widths.length)return null;const u=[];for(let n=0;n<e.shimmerCount;n+=1)u.push(i.createElement("div",{style:{width:null!==(c=null===(o=null===(t=e.styles)||void 0===t?void 0:t.widths)||void 0===o?void 0:o[n])&&void 0!==c?c:void 0}},i.createElement(s.H,{style:{marginBottom:5}})));return i.createElement(n.S,{style:l(e.styles),direction:r.PR.TopToBottom,align:r.j5.Stretch},i.createElement(a.E,{appearance:"translucent"},u))}},43825:(e,t,o)=>{"use strict";o.d(t,{V:()=>i,m:()=>n});const i='"Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif',n='Bahnschrift, "Bahnschrift Web", "Segoe UI", "Helvetica Neue"'},2381:(e,t,o)=>{"use strict";function i(e,t,o=1){var i,n;return void 0===t?void 0===(null==e?void 0:e.borderRadius)||"number"==typeof(null==e?void 0:e.borderRadius)?null!==(i=null==e?void 0:e.borderRadius)&&void 0!==i?i:o:void 0:"object"==typeof(null==e?void 0:e.borderRadius)?null!==(n=e.borderRadius[t])&&void 0!==n?n:0:void 0}o.d(t,{W:()=>i})},7122:(e,t,o)=>{"use strict";o.d(t,{w:()=>y});var i=o(56415);if(3023==o.j)var n=o(31787);if(3023==o.j)var r=o(20298);if(3023==o.j)var s=o(70541);if(3023==o.j)var a=o(9443);if(3023==o.j)var l=o(42937);if(3023==o.j)var c=o(73981);if(3023==o.j)var u=o(48570);if(3023==o.j)var d=o(5567);if(3023==o.j)var h=o(88902);if(3023==o.j)var g=o(3194);if(3023==o.j)var p=o(37591);if(3023==o.j)var f=o(9960);if(3023==o.j)var m=o(30444);const v=e=>{const{onItemClick:t,disabled:o,label:s,tabKey:a,theme:l}=e,c=(0,n.R)(a),u=i.useCallback((()=>{null==t||t(a)}),[t,a]);return c?null:i.createElement(r.D,{onFocus:e=>{l&&(e.currentTarget.style.backgroundColor=l.overflowItem.hover)},onBlur:e=>{l&&(e.currentTarget.style.backgroundColor=l.overflowItem.resting)},onClick:u,disabled:o},s)},b=({appearance:e,size:t,items:o,onTabSelect:n,theme:r})=>{const{ref:h,isOverflowing:g}=(0,s.z)();return g?i.createElement(a.W,null,i.createElement(l.c,null,i.createElement(c.$,{appearance:e,icon:i.createElement(m.In,{type:"Overflow"}),ref:h,role:"tab",size:t})),i.createElement(u.b,{style:{backgroundColor:null==r?void 0:r.overflowItem.resting}},i.createElement(d.c,null,o.map((e=>i.createElement(v,Object.assign({theme:r,key:e.tabKey,onItemClick:n},e))))))):null},y=e=>{const{items:t,overflow:o=!0,onTabSelect:n}=e,r=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["items","overflow","onTabSelect"]),s=i.useCallback(((e,t)=>{"string"==typeof t.value&&(null==n||n(t.value))}),[n]),a=i.useMemo((()=>{var e,t;return Object.assign(Object.assign({},r),{appearance:null!==(e=r.appearance)&&void 0!==e?e:"transparent",onTabSelect:s,size:null!==(t=r.size)&&void 0!==t?t:"medium",selectedValue:r.selectedKey,defaultSelectedValue:r.defaultSelectedKey,theme:r.theme})}),[r,s]),l={items:t,appearance:a.appearance,size:a.size,onTabSelect:n,theme:a.theme};let c=i.createElement(h.w,Object.assign({},a,{style:{width:"100%"}}),t.map((e=>{const{tabKey:t,label:n,disabled:r,overflowPriority:s=0}=e;let a=i.createElement(g.o,{value:t,disabled:r},n);return o&&(a=i.createElement(p.M,{priority:s,key:t,id:t},a)),a})),o&&i.createElement(b,Object.assign({},l)));return o&&(c=i.createElement(f.n,{minimumVisible:1},c)),c}},82913:(e,t,o)=>{"use strict";if(o.d(t,{S:()=>s,v:()=>r}),3023==o.j)var i=o(43825);if(3023==o.j)var n=o(26086);var r;function s(e,t,o){const i=o?o.filter((e=>!!e)).sort(((e,t)=>e.start-t.start)):[],n=[];for(let o=0;o<i.length;o+=1){if(e<i[o].start+i[o].length)continue;const s=0===o?0:i[o-1].start+i[o-1].length;s<i[o].start&&a(n,s,i[o].start-s,r.None,t),a(n,i[o].start,i[o].length,i[o].decorationType,t);const l=i[o].start+i[o].length;o===i.length-1&&l<e&&a(n,l,e-l,r.None,t)}return 0===n.length&&a(n,0,e,r.None,t),n}function a(e,t,o,s,a){var l,c;const u={start:t,length:o};switch(s){case r.Spelling:u.emphasizedColor=a.errorText,u.underlineType=n.RV.SpellingSquiggle;break;case r.Grammar:u.emphasizedColor=a.errorText,u.underlineType=n.RV.GrammarSquiggle;break;case r.Refinement:u.emphasizedColor=a.errorText,u.underlineType=n.RV.CritiqueSquiggle;break;case r.Rewrite:case r.SimilarityChecker:u.fontWeight=n.IT.Bold,u.cssColor=null===(l=a.rewriteText)||void 0===l?void 0:l.resting,u.cssColorHover=null===(c=a.rewriteText)||void 0===c?void 0:c.hover;break;case r.Modification:u.highlightColor=a.correctionHighlight,u.highlightRadius=2,u.fontWeight=n.IT.SemiBold;break;case r.PremiumEmphasis:u.cssColor=a.premiumEmphasis,u.fontFamily=i.m;break;case r.TrackChangeContent:u.italic=!0;break;case r.TrackChangePlaceholder:u.cssColor=a.trackChangePlaceholderText;break;case r.PremiumPreviewCredits:u.cssColor=a.addOnAction,u.fontWeight=n.IT.Bold;break;case r.CatchUp:u.cssColor=a.catchUpDescriptorText,u.fontWeight=n.IT.SemiBold}e.push(u)}!function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.AccColorChecker=6]="AccColorChecker",e[e.Modification=7]="Modification",e[e.PremiumEmphasis=8]="PremiumEmphasis",e[e.TrackChangeContent=9]="TrackChangeContent",e[e.TrackChangePlaceholder=10]="TrackChangePlaceholder",e[e.PremiumPreviewCredits=11]="PremiumPreviewCredits",e[e.CatchUp=12]="CatchUp"}(r||(r={}))},30885:(e,t,o)=>{"use strict";o.d(t,{tO:()=>s});var i=o(73463);const n={ArrowDown:i.h.ArrowDown,ArrowUp:i.h.ArrowUp,ArrowLeft:i.h.ArrowLeft,ArrowRight:i.h.ArrowRight,Enter:i.h.Enter,End:i.h.End,Escape:i.h.Escape,Home:i.h.Home,Tab:i.h.Tab," ":i.h.Space,Down:i.h.ArrowDown,Up:i.h.ArrowUp,Left:i.h.ArrowLeft,Right:i.h.ArrowRight,Spacebar:i.h.Space,Esc:i.h.Escape};function r(e,t,o){void 0!==n[o.key]&&-1!==t.indexOf(n[o.key])&&(e({key:n[o.key],alt:o.altKey,ctrl:o.ctrlKey,shift:o.shiftKey,meta:o.metaKey}),o.preventDefault(),o.stopPropagation())}function s(e,t){e.onKeyDown&&e.handledKeys&&(t.onKeyDown=r.bind(void 0,e.onKeyDown,e.handledKeys)),e.onKeyUp&&e.handledKeys&&(t.onKeyUp=r.bind(void 0,e.onKeyUp,e.handledKeys))}},73463:(e,t,o)=>{"use strict";var i;o.d(t,{h:()=>i}),function(e){e[e.ArrowDown=0]="ArrowDown",e[e.ArrowUp=1]="ArrowUp",e[e.ArrowLeft=2]="ArrowLeft",e[e.ArrowRight=3]="ArrowRight",e[e.End=4]="End",e[e.Enter=5]="Enter",e[e.Escape=6]="Escape",e[e.Home=7]="Home",e[e.Space=8]="Space",e[e.Tab=9]="Tab"}(i||(i={}))},45438:(e,t,o)=>{"use strict";o.d(t,{i:()=>i});const i=()=>!1},26534:(e,t,o)=>{"use strict";o.d(t,{c:()=>n});var i=o(56415);const n=e=>{i.useEffect((()=>(window.addEventListener("mousemove",e,{capture:!0,passive:!0}),()=>window.removeEventListener("mousemove",e,{capture:!0}))),[])}},86383:(e,t,o)=>{"use strict";o.d(t,{EH:()=>p,Eh:()=>l,HP:()=>I,Hz:()=>u,KW:()=>f,OF:()=>T,T4:()=>b,a4:()=>y,do:()=>m,eS:()=>x,g$:()=>C,m$:()=>E,ms:()=>d,o2:()=>h,pj:()=>g,rj:()=>S,t$:()=>k,xt:()=>w,zh:()=>v});var i=o(56415);if(3023==o.j)var n=o(10894);if(3023==o.j)var r=o(15624);if(3023==o.j)var s=o(53429);if(3023==o.j)var a=o(30444);function l(e){return{oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function c(e){return{defaultOverflowButtonAccessibilityLabel:e("defaultOverflowButtonAccessibilityLabel"),oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function u(e){return{defaultSplitButtonOverflowAccessibilityLabel:e("defaultSplitButtonOverflowAccessibilityLabel"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function d(e,t,o,i,s,a,l,u,d,h,g,p,m,v){const b=f(e),C=void 0!==u;if(void 0!==u&&(u<0||u>=b.length))return;const S=C?b[u]:void 0,k=s.filter((t=>w(e,t,S))).filter((t=>y(e,o,t))).map((t=>_(e,o,i,t)));return!C&&w(e,r._R.ShowMenu)&&(k.length>0&&k.push({type:"separator",key:"separator"}),k.push(_(e,o,i,r._R.ShowMenu))),0!==k.length?{tooltip:C||a?void 0:l,items:k,onClick:e=>{if(g){const t=parseInt(e.key,10);g(t,u)}},style:C?{}:Object.assign(Object.assign({},n.lI(v)),{calloutStyle:null==v?void 0:v.calloutStyle}),theme:n.B1(t,p),itemTheme:n.P4(t,void 0,!0),strings:c(o.common),accessibilityLabel:l,automationLabelType:"CritiqueActionButton",automationId:d||"",hasKeyboardFocus:p,layerHostId:h,onHeightChange:m,shouldFocusButtonOnDismiss:e.critiqueType!==r.L9.InlineSuggestion&&void 0}:void 0}function h(e,t,o,r,a,l,c,u,d,h,g,p,f,m,v,y,S,w,T,x){const _=Object.assign(Object.assign({},r.tooltipProps),{layerHostId:x||void 0}),E=C(o),A=void 0!==E?{type:E,filled:v}:void 0,R={onClick:()=>{null==m||m(o,void 0,l)},title:c,titleStyle:u,tooltip:d,tooltipProps:_,disabled:k(e,o),style:r,theme:n.P4(t,void 0,v,S),accessibilityLabel:b(e,a,o),automationLabel:null!=h?h:I(o,f),badgeProps:p,icon:A,htmlId:y,onHeightChange:T,uiAnchorId:w,hasKeyboardFocus:S,appearance:"subtle"};return i.createElement(s.u,Object.assign({ref:g},R,{key:o.toString()}))}function g(e,t,o,a,l,c,u,d,h){const g=y(e,a,r._R.Feedback);if(!g)return null;const p={type:C(r._R.Feedback),filled:!0},f=n.$d(t,u),m={onClick:()=>{null==c||c(r._R.Feedback,void 0,void 0)},title:g,tooltip:g,tooltipProps:{layerHostId:h},disabled:k(e,r._R.Feedback),style:o,theme:f,accessibilityLabel:b(e,a,r._R.Feedback),automationLabel:`CritiqueActionButton_${g}_${l}`,icon:p,onHeightChange:d};return i.createElement(s.u,Object.assign({},m,{key:r._R.Feedback.toString()}))}function p(e,t,o,i,n,r,s){if(e.showDictationCommandUx&&!i){const i=function(e,t,o,i){const n=m(e,t).filter((e=>e.action===o&&e.suggestionIndex===i));return n.length>0?n[0].badgeId:void 0}(e,t,n,r);if(void 0!==i)return{text:i.toString(),theme:o,style:s}}}function f(e){const t=e.maximumSuggestions||n.gc;return e.suggestions?e.suggestions.length>t?e.suggestions.slice(0,t):e.suggestions:[]}function m(e,t){var o;const i=v(e,t),n=[];let s=1;return i?i.forEach(((e,t)=>{n.push({action:e,badgeId:s++,suggestionIndex:t})})):null===(o=f(e))||void 0===o||o.forEach(((t,o)=>{k(e,r._R.Accept,t)||n.push({action:r._R.Accept,badgeId:s++,suggestionIndex:o})})),n}function v(e,t){switch(e.critiqueType){case r.L9.RepeatedWord:return[r._R.Accept];case r.L9.SimilarityChecker:return(w(e,r._R.MoreSources)?[r._R.IntextCitation,r._R.FullCitation,r._R.MoreSources]:[r._R.IntextCitation,r._R.FullCitation]).filter((o=>y(e,t,o)))}return e.isContentPending||e.isBehindPaywall?[]:void 0}function b(e,t,o){switch(o){case r._R.Previous:case r._R.Next:if(e.wrapAroundNavigation&&void 0!==e.critiqueSetSize&&e.critiqueSetSize>1){const i=e.critiqueSetSize.toString(10);return o===r._R.Previous?t.critique("previousIssueWithCount").replace("{0}",i):t.critique("nextIssueWithCount").replace("{0}",i)}return o===r._R.Previous?t.critique("previousIssue"):t.critique("nextIssue")}return y(e,t,o)}function y(e,t,o){var i,n,s,a,l,c,u,d,h,g,p,f,m,v,b,y;switch(o){case r._R.ReadAloud:return t.critique("readAloud");case r._R.SpellOut:return t.critique("spellOut");case r._R.ChangeAll:return t.critique("changeAll");case r._R.AddToAutoCorrect:return t.critique("addToAutoCorrect");case r._R.AutoCorrectOptions:return t.critique("autoCorrectOptions");case r._R.IgnoreOnce:return t.critique("ignoreOnce");case r._R.IgnoreAll:return t.critique("ignoreAll");case r._R.IgnoreRule:return t.critique("ignoreRule");case r._R.AddToDictionary:return t.critique("addToDictionary");case r._R.Options:return t.critique("options");case r._R.ShowExplanation:return t.critique("footerExplanationButtonAccessibilityLabel");case r._R.ManageLanguages:return t.critique("manageLanguages");case r._R.Next:return t.critique("nextIssue");case r._R.Previous:return t.critique("previousIssue");case r._R.ToggleContext:return e.showContext?t.critique("hideContext"):t.critique("showContext");case r._R.ToggleDescription:return e.critiqueType===r.L9.Spelling?e.showDescription?t.critique("hideSynonyms"):t.critique("showSynonyms"):e.critiqueType===r.L9.NeuralRewrite?e.showDescription?t.critique("hideExplanationButtonText"):t.critique("showExplanationButtonText"):void 0;case r._R.ReadContext:return t.critique("readAloudOriginalSentenceAccessibilityLabel");case r._R.ShowMenu:return t.critique("showMenuButtonText");case r._R.Feedback:return t.critique("giveFeedbackButtonText");case r._R.Dismiss:return t.common("cancelButton");case r._R.OpenEditorPane:return t.critique("accessibilityLabelForEditorButton");case r._R.LearnMore:return t.critique("learnMore");case r._R.IntextCitation:return t.critique("addInTextCitation");case r._R.FullCitation:return t.critique("copyFullCitation");case r._R.MoreSources:return t.critique("moreSources");case r._R.Accessibility:return null===(i=t.accChecker)||void 0===i?void 0:i.call(t,"accAssistant");case r._R.OpenColorPicker:return null===(n=t.accChecker)||void 0===n?void 0:n.call(t,"moreColors");case r._R.MoreFontColors:return null===(s=t.accChecker)||void 0===s?void 0:s.call(t,"moreFontColors");case r._R.ChangeColors:return null===(a=t.accChecker)||void 0===a?void 0:a.call(t,"changeColors");case r._R.ResetGraphic:return null===(l=t.accChecker)||void 0===l?void 0:l.call(t,"resetGraphic");case r._R.TurnOffAccChecker:return null===(c=t.accChecker)||void 0===c?void 0:c.call(t,"turnOffAccChecker");case r._R.Allow:return null===(u=t.accChecker)||void 0===u?void 0:u.call(t,"allowTextColorIssue");case r._R.AllowAll:return null===(d=t.accChecker)||void 0===d?void 0:d.call(t,"allowAllTextColorIssues");case r._R.FixSimilarColors:return null===(h=t.accChecker)||void 0===h?void 0:h.call(t,"fixSimilarColors");case r._R.FixAllColors:return null===(g=t.accChecker)||void 0===g?void 0:g.call(t,"fixAllColors");case r._R.AutoGenAltText:case r._R.MissingAltText:return null===(p=t.accChecker)||void 0===p?void 0:p.call(t,"altText");case r._R.UseFirstRowAsHeader:return null===(f=t.accChecker)||void 0===f?void 0:f.call(t,"useFirstRowAsHeader");case r._R.SplitCell:return null===(m=t.accChecker)||void 0===m?void 0:m.call(t,"splitCell");case r._R.MergeCells:return null===(v=t.accChecker)||void 0===v?void 0:v.call(t,"mergeCells");case r._R.MarkAsDecorative:return null===(b=t.accChecker)||void 0===b?void 0:b.call(t,"markAsDecorative");case r._R.MarkAsLayout:return null===(y=t.accChecker)||void 0===y?void 0:y.call(t,"markAsLayout");case r._R.Accept:case r._R.AddOnFooterAction:case r._R.Report:case r._R.RejectHoverIn:case r._R.RejectHoverOut:case r._R.AcceptHoverIn:case r._R.AcceptHoverOut:case r._R.Reject:case r._R.OpenCustomDictionary:case r._R.SourceSelected:case r._R.ApplyColor:case r._R.GoPremium:case r._R.RevealSuggestions:case r._R.RefreshSummary:case r._R.UndoInsertSummarization:case r._R.Overflow:case r._R.InsertBelow:case r._R.Regenerate:case r._R.Cancel:case r._R.StopGenerating:case r._R.ContainerHoverIn:case r._R.ContainerHoverOut:case r._R.LaunchAIRewrite:case r._R.LaunchAIRewriteHoverIn:case r._R.LaunchAIRewriteHoverOut:return}}function C(e){switch(e){case r._R.Allow:return"Ignore";case r._R.AllowAll:return"IgnoreAll";case r._R.IgnoreOnce:return"Ignore";case r._R.IgnoreAll:return"IgnoreAll";case r._R.FixAllColors:return"Completed";case r._R.AddToDictionary:return"AddToDictionary";case r._R.ShowExplanation:return"ShowExplanation";case r._R.Next:return"Next";case r._R.Previous:return"Previous";case r._R.ReadContext:return"ReadAloud";case r._R.Feedback:return"GiveFeedback";case r._R.Dismiss:return"Cancel";case r._R.OpenEditorPane:return"Editor";case r._R.ManageLanguages:return"LocaleLanguage";case r._R.Options:return"EditorSettings";case r._R.IntextCitation:return"Plus";case r._R.FullCitation:return"Copy";case r._R.Accessibility:return"Accessibility";case r._R.OpenColorPicker:case r._R.MoreFontColors:case r._R.ChangeColors:return"Color";case r._R.TurnOffAccChecker:return"Hide";case r._R.RevealSuggestions:return"Wand";case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return"BowTie";case r._R.UseFirstRowAsHeader:return"FirstRowAsHeader";case r._R.ResetGraphic:return"ArrowReset"}}function S(e,t){switch(e){case r.L9.Refinement:case r.L9.RepeatedWord:case r.L9.SimilarityChecker:case r.L9.AccColorChecker:case r.L9.TonalRewrite:case r.L9.Grammar:case r.L9.DictationCorrection:case r.L9.TextPenAlternates:return r._R.IgnoreOnce;case r.L9.Spelling:case r.L9.Topic:return r._R.IgnoreAll;case r.L9.InlineSuggestion:switch(t){case r.z4.Person:case r.z4.File:case r.z4.Location:case r.z4.SatoriEntity:return r._R.IgnoreOnce;case r.z4.Topic:return r._R.IgnoreAll;default:return}case r.L9.AddinCritique:return r._R.IgnoreOnce;case r.L9.NeuralRewrite:case r.L9.Classification:case r.L9.WritersUnblock:default:return}}function w(e,t,o){switch(t){case r._R.Previous:case r._R.Next:return T(e)&&x(e,t);case r._R.ToggleContext:if(void 0===e.contextText)return!1;break;case r._R.ReadContext:const o=C(t);if(void 0===o||!a.In.shouldRender({type:o}))return!1;break;case r._R.IgnoreOnce:if(e.critiqueType===r.L9.SimilarityChecker)return!0;break;case r._R.Accessibility:case r._R.OpenColorPicker:case r._R.Allow:case r._R.AllowAll:case r._R.FixSimilarColors:case r._R.FixAllColors:case r._R.AutoGenAltText:case r._R.MissingAltText:case r._R.UseFirstRowAsHeader:case r._R.SplitCell:case r._R.MergeCells:case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return!0;case r._R.Feedback:case r._R.TurnOffAccChecker:if(e.critiqueType===r.L9.AccColorChecker||e.critiqueType===r.L9.AltText||e.critiqueType===r.L9.MergeSplitCell||e.critiqueType===r.L9.MissingTableHeader)return!0}return x(e,t,o)}function k(e,t,o){switch(t){case r._R.Next:case r._R.Previous:return!T(e)||!x(e,t)||!e.wrapAroundNavigation&&(t===r._R.Previous?e.critiquePosition<=0:e.critiquePosition>=e.critiqueSetSize-1);case r._R.Dismiss:case r._R.Accessibility:case r._R.OpenColorPicker:case r._R.Allow:case r._R.AllowAll:case r._R.FixSimilarColors:case r._R.FixAllColors:case r._R.Overflow:case r._R.AutoGenAltText:case r._R.MissingAltText:case r._R.UseFirstRowAsHeader:case r._R.SplitCell:case r._R.MergeCells:case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return!1;default:return!x(e,t,o)}}function T(e){return void 0!==e.critiquePosition&&void 0!==e.critiqueSetSize&&e.critiquePosition>=0&&e.critiqueSetSize>0}function x(e,t,o){const{actions:i}=e,n=o?o.actions:i;return!!n&&n.indexOf(t)>=0}function I(e,t){switch(e){case r._R.Previous:return`CritiqueNavButton_Left_${t}`;case r._R.Next:return`CritiqueNavButton_Right_${t}`;case r._R.Dismiss:return`CritiqueCloseButton_${t}`;case r._R.OpenEditorPane:return`EditorPaneOpenButton_${t}`}return"undefined"}function _(e,t,o,i){const r=y(e,t,i);return{type:"item",key:i.toString(),title:r,titleStyle:n.Ot(o,r.length),iconType:C(i)}}function E(e={}){return Object.assign(Object.assign({},n.Y_),e)}},42720:(e,t,o)=>{"use strict";var i,n;o.d(t,{UD:()=>i,tR:()=>n}),function(e){e[e.Unknown=0]="Unknown",e[e.Inference=1]="Inference"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.VoiceDictationBadge=1]="VoiceDictationBadge",e[e.VoiceDictationPhrase=2]="VoiceDictationPhrase"}(n||(n={}))},73050:(e,t,o)=>{"use strict";o.d(t,{R:()=>c});var i=o(56415);if(3023==o.j)var n=o(10894);if(3023==o.j)var r=o(95012);if(3023==o.j)var s=o(90096);if(3023==o.j)var a=o(30444);if(3023==o.j)var l=o(4168);const c=e=>i.createElement(r.S,{direction:s.PR.LeftToRight,style:n.JP},i.createElement(a.In,{type:"ForwardSlashPromo",style:n.VP}),i.createElement(l.c,{text:e.strings.inlineSuggestions("discoveryPromoFooterText"),style:n.vP}))},86738:(e,t,o)=>{"use strict";o.d(t,{w:()=>z,k:()=>H});var i=o(56415),n=o(10894),r=o(65541),s=o(81991),a=o(98138),l=o(17451),c=o(12477);const u=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useContext(a.O),n=i.useRef(null),r=i.useRef(null);(0,i.useImperativeHandle)(t,(()=>({focus:u})));const u=()=>{var e,t;o?null===(e=r.current)||void 0===e||e.focus():null===(t=n.current)||void 0===t||t.focus()};return o?i.createElement(l.y,Object.assign({},e,{ref:r,direction:c.E.None})):i.createElement(s.Y,{disabled:e.disabled,componentRef:n,forceFocusInsideTrap:!1},e.children)})));u.displayName="FocusTrapZone";var d=o(90218),h=o(90096),g=o(95012),p=o(4168),f=o(30444),m=o(26086);class v extends i.PureComponent{render(){return i.createElement("tr",null,this.props.children)}}class b extends i.PureComponent{render(){return this.props.header?i.createElement("th",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children):i.createElement("td",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableCellStyle(){const e={};return this.props.style&&this.props.style.paddingVertical&&(e.paddingBottom=this.props.style.paddingVertical,e.paddingTop=this.props.style.paddingVertical),this.props.style&&this.props.style.paddingHorizontal&&(e.paddingLeft=this.props.style.paddingHorizontal,e.paddingRight=this.props.style.paddingHorizontal),this.props.style&&this.props.style.paddingStart&&(e.paddingInlineStart=this.props.style.paddingStart),this.props.style&&this.props.style.paddingEnd&&(e.paddingInlineEnd=this.props.style.paddingEnd),this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),this.props.style&&this.props.style.marginHorizontal&&(e.marginLeft=this.props.style.marginHorizontal,e.marginRight=this.props.style.marginHorizontal),this.props.style&&this.props.style.verticalAlign&&(e.verticalAlign=this.props.style.verticalAlign),this.props.style&&this.props.style.horizontalAlign&&(e.textAlign=this.props.style.horizontalAlign),e}}var y=o(82913);class C extends i.PureComponent{render(){return i.createElement("table",{style:this.getTableStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableStyle(){const e={borderCollapse:"collapse"};return this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),e}}var S,w=o(15624);!function(e){e[e.Exposition=0]="Exposition",e[e.Example=1]="Example"}(S||(S={}));class k extends i.PureComponent{componentDidMount(){const e=this.getDefinition();e&&e.explanationTitle,this.getExplanationText()}render(){const e=this.parseExplanationText(this.getExplanationText()),t=this.getDefinition(),o=t&&t.explanationTitle||"";return i.createElement(u,null,i.createElement(d.Y,{componentStackStyle:n.tJ(this.props.style,this.props.theme),stackAlignment:h.j5.Stretch,stackDirection:h.PR.TopToBottom,header:o,headerStyle:n.J2(this.props.theme,this.props.fontTable)},this.renderExplanationText(e),this.renderAccessibleColorsLearningTip(),this.renderMergeSplitCellsLearningTip()))}renderAccessibleColorsLearningTip(){var e,t,o,r,s,a;if(this.props.definition.critiqueType!==w.L9.AccColorChecker)return null;const l={height:16,width:16},c={type:"ErrorBadge",primaryColor:"#E41323",style:l},u={type:"Completed",primaryColor:"#0B6A0B",style:l},d={backgroundColor:"#CCCCCC",borderRadius:2,minHeight:24,marginVertical:4,marginStart:10,paddingHorizontal:15},v={width:"50%"};return i.createElement(g.S,null,i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:v},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableBefore"),style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})),i.createElement(g.S,{style:v},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableAfter"),style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:v},i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{height:32}},i.createElement(f.In,Object.assign({},c))),i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:d},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#BECFFA",fontSize:this.props.fontTable.xsmall,fontWeight:m.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:{width:26}}),i.createElement(p.c,{text:null!==(o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"poorContrast"))&&void 0!==o?o:"",style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{style:v},i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{height:32}},i.createElement(f.In,Object.assign({},u))),i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:d},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#002EA3",fontSize:this.props.fontTable.xsmall,fontWeight:m.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:{width:26}}),i.createElement(p.c,{text:null!==(a=null===(s=(r=this.props.strings).accChecker)||void 0===s?void 0:s.call(r,"goodContrast"))&&void 0!==a?a:"",style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))))}renderMergeSplitCellsLearningTip(){const{critiqueType:e}=this.props.definition,t=this.props.strings.accChecker;return e===w.L9.MergeSplitCell&&t?i.createElement(g.S,null,["mergeSplitCellStepsTitle","mergeSplitCellStepsLine1","mergeSplitCellStepsLine2","mergeSplitCellStepsLine3","mergeSplitCellStepsLine4","mergeSplitCellStepsEnd"].map((e=>i.createElement(p.c,{key:e,text:null==t?void 0:t(e),style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))):null}getDefinition(){return this.props.definition}getExplanationText(){const e=this.getDefinition();return e&&e.explanation?e.explanation.replace("\\r\\n","\r\n"):""}parseExplanationText(e){const t=[];let o=[],n=null,r=!0,s=!1,a=0,l=0,c=0,u=this.props.strings.critiqueExplanation("explanationTableBefore"),d=this.props.strings.critiqueExplanation("explanationTableAfter");const h=e.split("\r\n");for(const e of h)if(0!==e.length)if(""===e[0]){const t=e.indexOf(":"),h=e.substr(2,t-1),g=e.substr(t+2);r?(u=h,n=this.renderBeforeText(g,l++),r=!1,s=!0):s?(d=h,o.push(i.createElement(v,{key:a++},this.renderTableHeaderText(u,l++,0===o.length,!0),this.renderTableHeaderText(d,c++,0===o.length,!1))),o.push(i.createElement(v,{key:a++},n,this.renderAfterText(g,c++))),n=null,s=!1):(o.push(i.createElement(v,{key:a++},this.renderPlaceholder(l++),this.renderExampleSeparator(c++))),o.push(i.createElement(v,{key:a++},this.renderPlaceholder(l++),this.renderAfterText(g,c++))))}else o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t.push(this.renderExplanationNonExampleText(e));else n=null,r=!0,s=!1;return o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t}analyzeExampleText(e){const t={trimmedText:e,emphasisStart:-1,emphasisLength:-1},o=e.indexOf("{ul}");if(-1!==o){const i=e.indexOf("{ul 0}",o);if(-1!==i){const n=o+4,r=i-n;t.trimmedText=e.substr(0,o)+e.substr(n,r)+e.substr(i+6),t.emphasisStart=o,t.emphasisLength=r}}return t}renderTableHeaderText(e,t,o,r){const s=r?n.i6():n.db();return o?i.createElement(b,{header:!0,key:t,style:s},i.createElement(p.c,{text:e,style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})):i.createElement(b,{key:t,style:s},"")}renderCurrentTable(e){return{explanationPartType:S.Example,data:e}}getDecorationType(e){switch(e){case w.L9.Grammar:return w.vr.Grammar;case w.L9.Refinement:return w.vr.Refinement;default:return w.vr.None}}renderBeforeText(e,t){return this.renderExampleText(e,t,this.getDecorationType(this.getDefinition().critiqueType),this.props.strings.critiqueExplanation("explanationTableBefore"),!0)}renderAfterText(e,t){return this.renderExampleText(e,t,w.vr.Modification,this.props.strings.critiqueExplanation("explanationTableAfter"),!1)}renderExampleText(e,t,o,s,a){const l=[],c=this.analyzeExampleText(e);-1!==c.emphasisStart&&-1!==c.emphasisLength&&l.push({start:c.emphasisStart,length:c.emphasisLength,decorationType:o});const u=s+" "+(0,r.y)(this.props.strings.textFormatting,this.getDefinition().critiqueType,c.trimmedText,l),d=a?n.i6():n.db();return i.createElement(b,{key:t,style:d},i.createElement(p.c,{text:c.trimmedText,style:n._e(this.props.theme,this.props.fontTable),formatting:(0,y.S)(e.length,this.props.theme,l),accessibilityRole:"text",accessibilityLabel:u}))}renderExampleSeparator(e){return i.createElement(b,{key:e,style:n.db()},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableSeparator"),style:n.LO(this.props.theme,this.props.fontTable),accessibilityRole:"text"}))}renderPlaceholder(e){return i.createElement(b,{key:e,style:n.i6()})}renderExplanationNonExampleText(e){return{explanationPartType:S.Exposition,data:[i.createElement(p.c,{key:0,text:e,style:n.MW(this.props.theme,this.props.fontTable),accessibilityRole:"text"})]}}renderExplanationText(e){const t=[];for(const o of e)switch(o.explanationPartType){case S.Exposition:o.data[0]&&t.push(o.data[0]);break;case S.Example:t.push(i.createElement(C,{style:n.PN(),accessibilityLabel:this.props.strings.critiqueExplanation("explanationTableAccessibilityLabel")},o.data))}return t}}var T=o(53429),x=o(46280),I=o(1127),_=o(86383);const E=e=>{const{brandingMode:t,theme:o}=e,n={useFluentV9:i.useContext(a.O)};switch(t){case w.nH.Text:const{strings:t,fontTable:r}=e,s=t.critique("microsoftEditorBranding"),a=I.ET(o,r,n),l=t.critique("microsoftEditorBrandingAccessibilityLabel"),c=i.createElement(p.c,{text:s,accessibilityLabel:l,style:a});return A(c);case w.nH.Icon:return A(i.createElement(f.In,{type:"Editor",primaryColor:I.C_(o,n)}));case w.nH.MonochromeIcon:return A(i.createElement(f.In,{type:"EditorSingleColor",primaryColor:I.C_(o,n)}));case w.nH.IconButton:return R(e,n);case w.nH.IconAndTextButton:return B(e,n);case w.nH.CustomImageAndText:return D(e,n);default:return i.createElement(i.Fragment,null)}},A=e=>i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{paddingHorizontal:6,paddingVertical:6}},e),R=(e,t)=>{const{definition:o,strings:n,theme:r,automationId:s,onAction:a,fontTable:l,htmlId:c,hasKeyboardFocus:u,isDisabled:d,showPreviewTooltipForBranding:p,layerHostId:f}=e,m=I.m7(r,u,t),v=I.qv(l),b=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch},M(o,m,v,n,void 0,void 0,b,s,a,c,d,u,f))},B=(e,t)=>{const{definition:o,strings:n,theme:r,automationId:s,onAction:a,fontTable:l,htmlId:c,hasKeyboardFocus:u,isDisabled:d,showPreviewTooltipForBranding:p,layerHostId:f}=e,m=I._s(r,u,t),v=I.Eq(l),b=n.critique("editorButtonText"),y=I.zB(l),C=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch},M(o,m,v,n,b,y,C,s,a,c,d,u,f))},M=(e,t,o,n,r,s,a,l,c,u,d,h,g)=>{const p=_.g$(w._R.OpenEditorPane),f=void 0!==p?{type:p}:void 0,m={appearance:"subtle",onClick:()=>{null==c||c(w._R.OpenEditorPane,void 0,void 0)},title:r,titleRootStyle:s,tooltip:a,tooltipProps:g?{layerHostId:g}:void 0,disabled:d,style:o,theme:t,accessibilityLabel:_.T4(e,n,w._R.OpenEditorPane),automationLabel:_.HP(w._R.OpenEditorPane,l),icon:f,htmlId:u,hasKeyboardFocus:h};return i.createElement(T.u,Object.assign({},m,{key:w._R.OpenEditorPane.toString()}))},D=(e,t)=>{const{theme:o,fontTable:n,definition:r}=e;return r.brandingImageUri&&r.brandingText?i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{paddingHorizontal:8,paddingVertical:8}},i.createElement(i.Fragment,null,i.createElement(x._,{uri:r.brandingImageUri,style:{width:20,height:20}}),i.createElement(g.S,{style:{paddingHorizontal:3}},i.createElement(i.Fragment,null)),i.createElement(p.c,{text:r.brandingText,style:I.pd(o,n,t)}))):i.createElement(i.Fragment,null)};var O=o(11563),F=o(23691),P=o(3428),N=o(69260),L=o(57566),j=o(96490);class q extends i.PureComponent{constructor(e){super(e),this.shouldFocusButtonOnUpdate=!1,this.buttonRef=i.createRef(),this.flyoutAnchorRef=i.createRef(),this.buttonId="FlyoutAnchor"+q.ids,q.ids+=1,this.handleClick=this.handleClick.bind(this),this.closeCallout=this.closeCallout.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this),this.onPopoverOpenChange=this.onPopoverOpenChange.bind(this),this.state={calloutVisible:!1}}render(){var e,t,o,n;if(!this.context){const t=this.renderButton();if(this.state.calloutVisible){const o=null===(e=this.props.calloutStyle)||void 0===e?void 0:e.borderRadius,n={role:"dialog",target:"#"+this.buttonId,isBeakVisible:!1,ariaLabel:this.props.calloutAccessibilityLabel,setInitialFocus:!0,onDismiss:this.closeCallout,layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:o},calloutMain:{borderRadius:o},root:{borderRadius:o}}},r=i.createElement(j.P,Object.assign({},n),this.props.children);return i.createElement("div",{id:this.buttonId,style:{display:"flex"}},t,r)}return t}return i.createElement(P.A,{"aria-role":"dialog","aria-lable":this.props.calloutAccessibilityLabel,trapFocus:!0,inline:!0,open:this.state.calloutVisible,onOpenChange:this.onPopoverOpenChange,closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(o=null===(t=this.buttonRef.current)||void 0===t?void 0:t.getElementRef())||void 0===o?void 0:o.current}},i.createElement(N.W,null,i.createElement("div",{id:this.props.layerHostId,ref:this.flyoutAnchorRef,tabIndex:-1},this.renderButton())),i.createElement(L.H,{style:{padding:0,borderWidth:"0px",borderRadius:null===(n=this.props.calloutStyle)||void 0===n?void 0:n.borderRadius}},this.props.children))}componentDidUpdate(){var e;this.shouldFocusButtonOnUpdate&&(null===(e=this.buttonRef.current)||void 0===e||e.focus(),this.shouldFocusButtonOnUpdate=!1)}renderButton(){const e=Object.assign(Object.assign({},this.props.buttonProps),{htmlId:this.buttonId,onClick:this.context?this.props.buttonProps.onClick:this.handleClick,accessibilityState:this.state.calloutVisible,accessibilityRole:this.props.buttonAccessibilityRole||"button",tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0});return this.state.calloutVisible&&e.theme&&e.theme.background.hover&&(e.theme=Object.assign(Object.assign({},e.theme),{background:Object.assign(Object.assign({},e.theme.background),{resting:e.theme.background.hover})})),i.createElement(T.u,Object.assign({},e,{onAccessibilityExpandCollapse:this.onAccessibilityExpandCollapse,ref:this.buttonRef}))}onPopoverOpenChange(e,t){t.open||(this.shouldFocusButtonOnUpdate=!0),this.setState((e=>Object.assign(Object.assign({},e),{calloutVisible:t.open})))}handleClick(){this.props.buttonProps.onClick&&this.props.buttonProps.onClick(),this.setState((e=>({calloutVisible:!e.calloutVisible})))}closeCallout(){this.shouldFocusButtonOnUpdate=!0,this.setState((e=>({calloutVisible:!1})))}onAccessibilityExpandCollapse(e){var t,o;"expand"===e&&this.state.calloutVisible||"collapse"===e&&!this.state.calloutVisible||(this.context?null===(o=(t=this.props.buttonProps).onClick)||void 0===o||o.call(t):this.handleClick())}}q.contextType=a.O,q.ids=0;const H=e=>"footerButton"+e.toString();class z extends i.Component{constructor(e){super(e),this.defaultActionButtonRef=i.createRef(),this.overflowMenuRef=i.createRef(),this.overflowMenuRefV9=i.createRef(),this.isFirstTimeRendering=i.createRef(),this.actionIds=i.createRef(),this.state={actionIdShowAppearFocusMap:{}},this.addActionId=this.addActionId.bind(this),this.isFirstTimeRendering.current=!0}componentDidMount(){var e;this.props.setFooterActionIdList&&this.props.setFooterActionIdList(null!==(e=this.actionIds.current)&&void 0!==e?e:[]),this.isFirstTimeRendering.current=!1}componentDidUpdate(e,t){const{selectedButtonIndex:o}=this.props,i=e.selectedButtonIndex;o!==i&&(void 0!==i&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[i],o=Object.assign({},e.actionIdShowAppearFocusMap);return o[t]=!1,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:o})}return e})),void 0!==o&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[o],i=Object.assign({},e.actionIdShowAppearFocusMap);return i[t]=!0,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:i})}return e})))}render(){return i.createElement(g.S,{direction:h.PR.LeftToRight,style:this.getFooterStyle(),align:h.j5.Stretch},this.renderIcons(),i.createElement(g.S,{style:{flexibleSize:!0}}),this.props.definition.critiqueType===w.L9.AccColorChecker||this.props.definition.critiqueType===w.L9.AltText||this.props.definition.critiqueType===w.L9.MergeSplitCell||this.props.definition.critiqueType===w.L9.MissingTableHeader?this.renderFooterButton(w._R.Accessibility):null,this.renderBrandingOrPrevNextButton())}focus(){var e,t;this.defaultActionButtonRef.current?this.defaultActionButtonRef.current.focus():this.context?null===(e=this.overflowMenuRefV9.current)||void 0===e||e.focus():null===(t=this.overflowMenuRef.current)||void 0===t||t.focus()}openOverflowMenu(e){var t,o;this.context?null===(t=this.overflowMenuRefV9.current)||void 0===t||t.openMenu(e):null===(o=this.overflowMenuRef.current)||void 0===o||o.openMenu()}componentWillUnmount(){this.props.setFooterActionIdList&&this.props.setFooterActionIdList([]),this.isFirstTimeRendering.current=null}renderIcons(){return this.props.definition.onlyShowFeedbackButton?this.renderFeedbackIcon():i.createElement(i.Fragment,null,this.renderDefaultActionButtons(),this.renderExplanation(),this.renderOverflowMenu())}renderFeedbackIcon(){const{definition:e,strings:t,layerHostId:o,onAction:i,automationId:r}=this.props;return _.xt(e,w._R.Feedback)?(this.addActionId(w._R.Feedback),_.pj(e,this.getTheme(),n.Vn(this.props.footerButtonStyle),t,r,i,this.state.actionIdShowAppearFocusMap[w._R.Feedback],void 0,o)):null}addActionId(e){_.t$(this.props.definition,e)||this.isFirstTimeRendering.current&&(null===this.actionIds.current&&(this.actionIds.current=[]),this.actionIds.current.push(e))}parseBooleanSetting(e){return!!this.props.settings&&"true"===this.props.settings[e]}renderOverflowMenu(){const{definition:e,layerHostId:t,strings:o,onAction:n,automationId:r}=this.props,{critiqueType:s,isContentPending:a}=e;if(s===w.L9.NeuralRewrite&&a||s===w.L9.NeuralRewrite&&this.parseBooleanSetting("renderNRForAIFeedback")||s===w.L9.DictationCorrection)return null;const l=this.state.actionIdShowAppearFocusMap[w._R.Overflow],c=_.ms(e,this.getTheme(),o,this.getFontTable(),this.calculateOverflowActions(),this.parseBooleanSetting("NoTooltipForFooterOverflow"),o.critique("footerSeeMoreActionsAccessibilityLabel"),void 0,r,t,n,l,void 0,Object.assign(Object.assign({},this.props.overflowMenuButtonStyle),{calloutStyle:this.props.overflowMenuCalloutStyle}));return c?(this.addActionId(w._R.Overflow),i.createElement(O.o,Object.assign({ref:this.overflowMenuRef,refV9:this.overflowMenuRefV9},c,{icon:{type:"Overflow",filled:!0}}))):null}calculateOverflowActions(){const{actions:e}=this.props.definition;return void 0===e||0===e.length?[]:this.getAllFooterOverflowActions().filter((t=>void 0!==t&&-1!==e.indexOf(t)))}getTheme(e){var t;const o=null!==(t=this.props.theme)&&void 0!==t?t:this.context?n.ol:n.vy,i=o.altIcon;return e===w._R.Accessibility&&o.accessibilityIcon?Object.assign(Object.assign({},o),{altIcon:Object.assign(Object.assign({},i),{resting:o.accessibilityIcon})}):o}getBrandingTheme(){var e,t;return null!==(t=null===(e=this.props.theme)||void 0===e?void 0:e.branding)&&void 0!==t?t:I.m0(this.props.definition.brandingMode,{useFluentV9:!!this.context})}getFontTable(){var e;return null!==(e=this.props.fontTable)&&void 0!==e?e:n.d4}getFooterStyle(){var e;return null!==(e=this.props.footerContainerStyle)&&void 0!==e?e:n.Y_}renderFooterButton(e,t,o){var r;const{definition:s,strings:a,onAction:l,automationId:c}=this.props;if(!_.xt(s,e))return null;const u=_.a4(s,a,e);if(!u)return null;this.addActionId(e);const d=`CritiqueActionButton_${u}_${c}`,h=_.t$(s,e),g=e===w._R.IgnoreOnce||e===w._R.IgnoreAll?_.EH(s,a,this.getTheme(),h,e,void 0,{horizontalSpacing:null===(r=this.getFooterStyle())||void 0===r?void 0:r.paddingHorizontal}):void 0;if(!this.shouldRenderFooterIconActionInOverflow(e))return _.o2(s,this.getTheme(e),e,n.Vn(this.props.footerButtonStyle),a,void 0,void 0,void 0,u,d,t?this.defaultActionButtonRef:void 0,g,c,l,!0,H(e),this.state.actionIdShowAppearFocusMap[e],o,void 0,this.props.layerHostId);const p={appearance:"subtle",title:u,titleStyle:n.Dd(this.getFontTable(),u.length),onClick:()=>{null==l||l(e)},style:n.Vn(this.props.footerButtonStyle),theme:n.P4(this.getTheme(e)),automationLabel:d,disabled:h};return i.createElement(T.u,Object.assign({key:e,ref:this.defaultActionButtonRef},p))}renderDefaultActionButtons(){const{definition:e,strings:t,onAction:o,automationId:r}=this.props,{critiqueType:s,actions:a}=e;let l=[];return void 0!==a&&a.length>0&&(l=this.getDefaultActions().filter((e=>void 0!==e&&-1!==a.indexOf(e)))),s!==w.L9.NeuralRewrite?i.createElement(i.Fragment,null,l.map((e=>e===w._R.OpenColorPicker?this.renderFooterButton(w._R.OpenColorPicker,0===l.indexOf(e),"ACCF2E3E-7EC7-46DF-AB25-A1AFEDBC6B7B"):this.renderFooterButton(e,0===l.indexOf(e)))),this.props.definition.critiqueType===w.L9.AltText&&this.renderFooterButton(w._R.MarkAsDecorative),this.props.definition.critiqueType===w.L9.MissingTableHeader&&this.renderFooterButton(w._R.MarkAsLayout)):0===l.length?i.createElement(F.v,{shimmerCount:1,styles:n.ys(this.getSpacing())}):i.createElement(i.Fragment,null,l.map((i=>i===w._R.Dismiss?(this.addActionId(i),_.o2(e,this.getTheme(i),w._R.Dismiss,n.nV(this.getFontTable()),t,void 0,void 0,void 0,void 0,void 0,this.defaultActionButtonRef,void 0,r,o,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId)):this.renderFooterButton(i))))}getDefaultActions(){const{definition:e}=this.props,{critiqueType:t,isContentPending:o,flagType:i}=e,n=_.rj(t,i),r=this.parseBooleanSetting("EnableFeedback"),s=this.parseBooleanSetting("FirstActionTurnOffAccChecker");switch(t){case w.L9.Refinement:case w.L9.Topic:const a=[n];return _.xt(e,w._R.Feedback)&&(this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)&&t!==w.L9.Topic||a.push(w._R.Feedback)),a;case w.L9.Spelling:return[n,_.xt(e,w._R.Feedback)&&!this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0,this.shouldRenderFooterIconActionInOverflow(w._R.AddToDictionary)?void 0:w._R.AddToDictionary];case w.L9.AccColorChecker:{const e=this.parseBooleanSetting("AllowTextColorIssueEnabled"),t=[];return e&&t.push(w._R.Allow),!e&&s&&t.push(w._R.TurnOffAccChecker),t.push(w._R.OpenColorPicker),t}case w.L9.AltText:case w.L9.MissingTableHeader:case w.L9.MergeSplitCell:return[s?w._R.TurnOffAccChecker:void 0];case w.L9.RepeatedWord:case w.L9.SimilarityChecker:case w.L9.DictationCorrection:case w.L9.TextPenAlternates:return[n];case w.L9.Grammar:return[n,r&&!this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0];case w.L9.TonalRewrite:return[n,r?w._R.Feedback:void 0];case w.L9.NeuralRewrite:return o?[]:0===_.KW(e).length?[w._R.Dismiss]:[w._R.Feedback];case w.L9.InlineSuggestion:if(void 0===i)return[n,_.xt(e,w._R.Feedback)&&!this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0];switch(i){case w.z4.Location:case w.z4.SatoriEntity:case w.z4.Topic:return[n];case w.z4.File:case w.z4.Person:return[n,w._R.Feedback];default:return[]}case w.L9.AddinCritique:return[n];default:return[]}}renderExplanation(){const{automationId:e,footerButtonStyle:t,layerHostId:o,onAction:r,overflowMenuCalloutStyle:s,strings:a,style:l}=this.props,c=Object.assign({},this.props.definition),u=this.getTheme(),d=this.getFontTable();if(!c.explanationTitle||!c.explanation)return null;const h={appearance:"subtle",onClick:()=>{null==r||r(w._R.ShowExplanation)},style:n.uY(d,t),theme:n.P4(u,void 0,!0),tooltip:_.a4(c,a,w._R.ShowExplanation),accessibilityLabel:_.T4(c,a,w._R.ShowExplanation),automationLabel:`CritiqueExplanationButton_${e}`,icon:{type:"ShowExplanation",filled:!0},tooltipProps:{layerHostId:o}};this.addActionId(w._R.ShowExplanation);const g={definition:c,strings:a,style:l,theme:u,fontTable:d};return i.createElement(q,{calloutAccessibilityLabel:a.critique("explanationFlyoutAccessibilityLabel"),calloutStyle:s,layerHostId:o,buttonAccessibilityRole:"button",buttonProps:h,showCloseButton_DONOTUSE:!0,closeButtonAccessibilityLabel_DONOTUSE:a.critique("explanationFlyoutCloseLabel")},i.createElement(k,Object.assign({},g)))}renderBrandingOrPrevNextButton(){const{definition:e,showPreviewTooltipForBranding:t}=this.props,{brandingMode:o}=e;if(_.OF(e))return this.renderPrevNextButtons();if(void 0===o)return null;const{strings:n,automationId:r,layerHostId:s,onAction:a}=this.props,l=_.t$(e,w._R.OpenEditorPane);return o!==w.nH.IconButton&&o!==w.nH.IconAndTextButton||this.addActionId(w._R.OpenEditorPane),i.createElement(E,{strings:n,theme:this.getBrandingTheme(),fontTable:this.getFontTable(),definition:e,automationId:r,brandingMode:o,onAction:a,htmlId:H(w._R.OpenEditorPane),hasKeyboardFocus:l?void 0:this.state.actionIdShowAppearFocusMap[w._R.OpenEditorPane],isDisabled:l,showPreviewTooltipForBranding:t,layerHostId:s})}renderPrevNextButtons(){if(!_.xt(this.props.definition,w._R.Previous)||!_.xt(this.props.definition,w._R.Next))return null;const e=n.nV(this.getFontTable()),t=!this.parseBooleanSetting("NoTooltipForPrevNext");return this.addActionId(w._R.Previous),this.addActionId(w._R.Next),i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch},_.o2(this.props.definition,this.getTheme(),w._R.Previous,e,this.props.strings,void 0,void 0,void 0,t?_.a4(this.props.definition,this.props.strings,w._R.Previous):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,H(w._R.Previous),this.state.actionIdShowAppearFocusMap[w._R.Previous],void 0,void 0,this.props.layerHostId),_.o2(this.props.definition,this.getTheme(),w._R.Next,e,this.props.strings,void 0,void 0,void 0,t?_.a4(this.props.definition,this.props.strings,w._R.Next):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,H(w._R.Next),this.state.actionIdShowAppearFocusMap[w._R.Next],void 0,void 0,this.props.layerHostId))}getAllFooterOverflowActions(){const{critiqueType:e,flagType:t}=this.props.definition,o=this.parseBooleanSetting("EnableFeedback"),i=this.parseBooleanSetting("FirstActionTurnOffAccChecker");switch(e){case w.L9.Spelling:return[w._R.IgnoreOnce,this.shouldRenderFooterIconActionInOverflow(w._R.AddToDictionary)?w._R.AddToDictionary:void 0,w._R.ToggleContext,w._R.ToggleDescription,w._R.Options,w._R.ManageLanguages];case w.L9.RepeatedWord:return[w._R.ToggleContext,w._R.Options];case w.L9.Grammar:return[w._R.IgnoreAll,w._R.IgnoreRule,w._R.ShowExplanation,w._R.ToggleContext,o&&this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0,w._R.Options];case w.L9.Refinement:return[w._R.IgnoreRule,w._R.ToggleContext,o&&this.shouldRenderFooterIconActionInOverflow(w._R.Feedback)?w._R.Feedback:void 0,w._R.Options];case w.L9.TonalRewrite:return[w._R.IgnoreAll,w._R.IgnoreRule,w._R.ToggleContext,w._R.Options];case w.L9.Topic:return[w._R.IgnoreOnce,w._R.IgnoreRule,w._R.ToggleContext,w._R.Options];case w.L9.NeuralRewrite:return[w._R.ToggleContext,w._R.ToggleDescription];case w.L9.SimilarityChecker:return[w._R.Feedback,w._R.LearnMore];case w.L9.AccColorChecker:{const e=this.parseBooleanSetting("AllowTextColorIssueEnabled");return[this.parseBooleanSetting("BulkFixTextColorIssuesEnabled")?w._R.FixAllColors:void 0,e?w._R.AllowAll:void 0,e||!i?w._R.TurnOffAccChecker:void 0,w._R.Feedback]}case w.L9.AltText:case w.L9.MergeSplitCell:case w.L9.MissingTableHeader:return[i?void 0:w._R.TurnOffAccChecker];case w.L9.InlineSuggestion:if(void 0!==t)switch(t){case w.z4.Location:case w.z4.SatoriEntity:return[w._R.IgnoreRule,w._R.Feedback,w._R.ReadAloud,w._R.Options];case w.z4.File:case w.z4.Person:return[w._R.IgnoreRule,w._R.IgnoreAll,w._R.ReadAloud,w._R.Options];case w.z4.Topic:return[w._R.Feedback,w._R.Options];default:return[]}return[w._R.IgnoreRule,w._R.IgnoreAll,w._R.ReadAloud,w._R.Options];default:return[]}}shouldRenderFooterIconActionInOverflow(e){const t=_.g$(e);return!this.parseBooleanSetting("RenderFooterIcons")||!t||!f.In.shouldRender({type:t})}getSpacing(){var e;return null!==(e=this.props.spacing)&&void 0!==e?e:n.lT}}z.contextType=a.O},4119:(e,t,o)=>{"use strict";if(o.d(t,{v:()=>n}),3023==o.j)var i=o(26086);const n=()=>({containerStyle:{position:"relative",borderRadius:8,paddingVertical:14,paddingStart:12,paddingEnd:12,maxWidth:309,minWidth:309,overflow:"hidden"},dismissContainerStyle:{position:"absolute",top:12.65,right:12.65,zIndex:2},iconContainerStyle:{marginEnd:12},textContainerStyle:{maxWidth:220},newTagContainerStyle:{borderRadius:3,paddingHorizontal:4,paddingVertical:2,marginEnd:8,marginBottom:4},newTagTextStyle:{fontSize:10,lineHeight:12},titleContainerStyle:{marginBottom:4},titleTextStyle:{fontSize:12,lineHeight:16,fontWeight:i.IT.SemiBold},contentContainerStyle:{fontSize:12,lineHeight:1.25},tryLinkContainerStyle:{marginTop:10},pageArrowContainerStyle:{marginTop:14,width:"100%"},paginationTextStyle:{fontSize:12,lineHeight:16,fontWeight:i.IT.SemiBold,marginHorizontal:13,marginVertical:0},buttonStyle:{paddingHorizontal:0,paddingVertical:0}})},89416:(e,t,o)=>{"use strict";o.d(t,{U:()=>u});var i=o(56415),n=o(98138),r=o(68664),s=o(11563),a=o(58021);const l=i.memo((({group:e,onItemSelected:t,overflowIndex:o,theme:r,isFeedbackEnabledForEcc:l,strings:c,isHighlighted:u,isOpen:d,onOverflowClose:h,overflowUid:g})=>{const p=i.useContext(n.O);r||(r=a.nk(void 0,p));let f=[];o&&o>0&&(f=e.suggestions.slice(o,e.suggestions.length).filter((e=>!!e.title)).map(((e,t)=>{var o;return{title:e.title,type:"item",key:t.toString(),entityType:null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType}})));const m=a.JE(r,u),v={title:r.text,background:r.background};if(l){f.length&&f.push({type:"separator",key:"separator"});const e=f.length?f.length-1:0;f.push({type:"item",title:c.inlineSuggestions("feedbackText"),key:e.toString()})}return f.length?i.createElement(s.o,{items:f,onClick:t,shouldFocusButtonOnDismiss:!1,hasKeyboardFocus:u,theme:v,buttonOnlyTheme:m,itemTheme:v,id:g,icon:{type:"Overflow",filled:!1},automationLabelType:"",automationId:"",startOpen:d,onTabClose:!0,onMenuDismiss:h,accessibilityLabel:c.inlineSuggestions("overflowTabAriaLabel")}):null}));l.displayName="ExpandedInlineSuggestionsOverflow";var c=o(6195);const u=i.memo((({theme:e,styles:t,strings:o,scopes:s,enablePrefixHighlighting:u,layerHostId:h,groupLayouts:g,itemQueryString:p,hasSelectionBeenModifiedViaKeyboard:f,isFeedbackEnabledForEcc:m,isSmallWindow:v,enableResponsiveLayout:b,overflowUid:y,headerRef:C,headerScopesRef:S,onGroupSelected:w,onItemSelected:k,onOverflowCalculated:T,isOverflowHighlighted:x,isOverflowMenuOpened:I,onOverflowClose:_})=>{var E,A,R;const B=i.useContext(n.O),M=null!=e?e:a.nk(void 0,B);let D=0;const[O,F]=i.useState(0),[P,N]=i.useState(0),L=function(e){const t=i.useRef();return i.useEffect((()=>{t.current=e})),t.current}(v),j=null===(E=C.current)||void 0===E?void 0:E.el(),q=null===(A=S.current)||void 0===A?void 0:A.el(),H=document.getElementById("uploadFileButtonContainer"),z=H?H.clientWidth+12:0,W=null!==(R=null==j?void 0:j.clientWidth)&&void 0!==R?R:0;return i.useEffect((()=>{if(b&&(0===O||L!==v||(null==j?void 0:j.clientWidth)&&P>=j.clientWidth)){const e=d(j,z,q);null==T||T(0!==e[0],e[0]),F(e[0]),N(e[1])}}),[b,O,L,v,P,T,j]),i.useEffect((()=>{if(!b){const e=d(j,z,q);D=e[0],F(D),N(e[1]),null==T||T(0!==D,D)}}),[W]),D=O,i.createElement(i.Fragment,null,i.createElement(c.K,{theme:M,strings:o,key:"scopes",group:s,layerHostId:h,accessibilitySetSize:s.suggestions.length,headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:0,accessibilityRole:"tab",enablePrefixHighlighting:u,onHeaderClick:()=>null==w?void 0:w(s),onHeaderHeightChange:e=>{g[0]||(g[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),g[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{g[0]||(g[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),g[0].extraSpaceBottomHeight=e},onSeparatorHeightChange:e=>{g[0]||(g[0]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),g[0].separatorHeight=e},itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:p,onItemSelected:k,onItemHeightChange:(e,t)=>{g[0]||(g[0]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),g[0].itemHeights[t]=e},showSeparator:!1,separatorProps:void 0,hasSelectionBeenModifiedViaKeyboard:f,disableTooltips:!0,enableExpandedECCScopeLayout:!0,overflowIndex:b?O:D}),b&&0===O&&!m||!b&&0===D&&!m?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,i.createElement(r.q.Consumer,null,(e=>i.createElement("div",{style:0!==P&&b?e?{position:"absolute",right:P}:{position:"absolute",left:P}:{}},i.createElement(l,{overflowIndex:b?O:D,group:s,onItemSelected:k,theme:M,isFeedbackEnabledForEcc:m,strings:o,isHighlighted:x,isOpen:I,onOverflowClose:_,overflowUid:y}))))))})),d=(e,t,o)=>{if(!e||!o)return[0,0];const i=(null==e?void 0:e.clientWidth)-38-t,n=Array.from(o.children);let r=0,s=0;for(let e=0;e<n.length;e++){if(!(n[e].clientWidth+r<i)){s=e;break}r+=n[e].clientWidth}return[s,r]}},2121:(e,t,o)=>{"use strict";o.d(t,{V:()=>s});var i=o(56415),n=o(95012),r=o(3592);const s=i.memo((e=>{var t,o,s,a,l,c,{theme:u,accessibilityLabel:d}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["theme","accessibilityLabel"]);return i.createElement(i.Fragment,null,i.createElement(n.S,{style:{marginTop:10,marginStart:12,marginEnd:12,width:"100%",minWidth:0}},i.createElement(r.G,Object.assign({},h,{autoComplete:!1,spellCheck:!1,accessibilityLabel:d,styles:{borderRadius:4,width:"100%",borderBottom:`${null===(t=null==u?void 0:u.searchBox)||void 0===t?void 0:t.borderBottomColor} solid 3px`},theme:{iconColor:null===(o=null==u?void 0:u.searchBox)||void 0===o?void 0:o.iconColor,borderColor:{hover:null===(a=null===(s=null==u?void 0:u.searchBox)||void 0===s?void 0:s.borderColor)||void 0===a?void 0:a.hover,resting:null===(c=null===(l=null==u?void 0:u.searchBox)||void 0===l?void 0:l.borderColor)||void 0===c?void 0:c.resting}}}))))}));s.displayName="ExpandedInlineSuggestionsSearchBox"},69380:(e,t,o)=>{"use strict";if(o.d(t,{W:()=>r,o:()=>s}),3023==o.j)var i=o(10894);if(3023==o.j)var n=o(18028);const r=(e={},t,o)=>({containerStyles:a(e.containerStyles,t,o),shimmerStyles:l(e),headerStyles:c(e.headerStyles),itemsStyles:d(e.itemsStyles,t),footerStyles:S(e.footerStyles)}),s=(e={},t)=>({containerStyles:a(e.containerStyles,t),shimmerStyles:l(e),headerStyles:c(e.headerStyles),itemsStyles:d(e.itemsStyles,t),footerStyles:S(e.footerStyles)}),a=(e={},t,o)=>{var i,n,r;return Object.assign({minWidth:o?304:null!==(i=null==t?void 0:t.menuMaxWidth)&&void 0!==i?i:480,maxWidth:o?304:null!==(n=null==t?void 0:t.menuMaxWidth)&&void 0!==n?n:480,minHeight:100,maxHeight:o?280:null!==(r=null==t?void 0:t.menuHeight)&&void 0!==r?r:300,paddingHorizontal:4,paddingTop:4,paddingBottom:4,marginEnd:10,scrollbarThumbWidth:10},e)},l=(e={})=>{var t,o,i,n,r,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({titleLineHeight:null!==(i=null===(o=null==e?void 0:e.headerStyles)||void 0===o?void 0:o.titleLineHeight)&&void 0!==i?i:16,itemPaddingVertical:null!==(n=null==l?void 0:l.paddingVertical)&&void 0!==n?n:6,itemPaddingHorizontal:null!==(r=null==l?void 0:l.paddingHorizontal)&&void 0!==r?r:12,textPaddingLeft:null!==(s=null==l?void 0:l.textPaddingStart)&&void 0!==s?s:8,personaCoinSize:null!==(a=null==l?void 0:l.personaCoinSize)&&void 0!==a?a:32},e.shimmerStyles)},c=(e={})=>Object.assign({},e),u=(e={},t={},o={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),n.ZD.item),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),n.ZD.description),t),e.description)}),d=(e={},t)=>({genericItemStyles:p(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:f(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:m(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:v(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:b(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:y(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:C(e.chatItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:u(e.noSuggestionsStyles,e.sharedItemStyles,t)}),h=e=>{var t,o;return Object.assign(Object.assign({},n.cK),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:n.cK.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:n.cK.height})},g=e=>Object.assign(Object.assign({},n.nI),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),p=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},f=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:32}),t),e),{paddingVertical:6})},m=(e={},t={},o)=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)}),{paddingVertical:6}),v=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{height:40,iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)}),{paddingHorizontal:12,paddingVertical:10})},b=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},g(o)),{width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"}),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},y=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},g(o)),{width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"}),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},C=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:32}),t),e),{iconStyles:Object.assign({width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"},null==e?void 0:e.iconStyles)}),{paddingVertical:6})},S=(e={})=>Object.assign(Object.assign(Object.assign({},i.Y_),{height:40,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},18028:(e,t,o)=>{"use strict";o.d(t,{B3:()=>v,Ek:()=>m,Js:()=>r,L_:()=>C,MG:()=>k,RR:()=>p,Ss:()=>s,XC:()=>b,ZD:()=>T,cK:()=>a,dm:()=>y,dt:()=>f,g4:()=>w,gl:()=>d,mX:()=>g,nI:()=>u,p:()=>h,v9:()=>S,z0:()=>c,zx:()=>l});var i=o(26086);if(3023==o.j)var n=o(43825);const r={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:24,menuHeight:252},s={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:32,menuHeight:300},a={flexibleSize:!0,borderRadius:4},l={width:300,maxHeight:48};function c(e){const t=Object.assign(Object.assign({},u),{margin:8}),o={borderRadius:4,paddingHorizontal:1,paddingVertical:1,fontWeight:i.IT.Bold,height:35,border:"1px solid var(--color-neutral-stroke-1-rest, #D1D1D1)"};return e?Object.assign(Object.assign({},u),{minWidth:"unset",style:{width:32,borderRadius:4,paddingHorizontal:6,paddingVertical:6,fontWeight:i.IT.Bold,height:32,border:"1px solid var(--color-neutral-stroke-1-rest, #D1D1D1)"}}):{icon:Object.assign(Object.assign({},t),{marginRight:0}),style:Object.assign({width:100},o)}}i.IT.Bold;const u={width:24,height:24,minWidth:24},d={width:24,height:30,marginHorizontal:12,paddingHorizontal:0,paddingVertical:0},h={width:16,height:16,margin:2};function g(e,t){var o,n,r,s,a,l,c,u,d;return{containerStyles:{paddingHorizontal:null!==(o=null==t?void 0:t.paddingHorizontal)&&void 0!==o?o:2,paddingVertical:null!==(n=null==t?void 0:t.paddingVertical)&&void 0!==n?n:6,minWidth:null!==(r=null==t?void 0:t.minWidth)&&void 0!==r?r:33,height:null!==(s=null==t?void 0:t.height)&&void 0!==s?s:18,backgroundColor:null===(a=e.tag)||void 0===a?void 0:a.background,borderRadius:null!==(l=null==t?void 0:t.borderRadius)&&void 0!==l?l:4},textStyles:{width:null!==(c=null==t?void 0:t.minWidth)&&void 0!==c?c:33,height:(null==t?void 0:t.height)?(null==t?void 0:t.height)-4:20,fontSize:null!==(u=null==t?void 0:t.fontSize)&&void 0!==u?u:10,cssColor:null===(d=e.tag)||void 0===d?void 0:d.textColor,fontFamily:"Segoe UI",fontWeight:i.IT.Bold,textAlign:"center"}}}const p=Object.assign(Object.assign({},u),{margin:8}),f=(Object.assign(Object.assign({},u),{margin:8,marginRight:0}),{marginTop:6,fontSize:20}),m={paddingHorizontal:12};function v(e,t,o){var r,s;return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:o.xsmall,paddingHorizontal:8,marginVertical:null!==(r=t.headerMarginVertical)&&void 0!==r?r:4,cssColor:e.text.resting,lineHeight:null!==(s=t.headerLineHeight)&&void 0!==s?s:20}}function b(e,t,o){var r,s,a;return{fontWeight:i.IT.Normal,fontFamily:n.V,fontSize:o.xsmall,marginTop:0,marginBottom:null!==(r=t.headerMarginVertical)&&void 0!==r?r:4,paddingHorizontal:8,cssColor:null!==(a=null===(s=e.altText)||void 0===s?void 0:s.resting)&&void 0!==a?a:"#605e5c"}}function y(e,t){return{fontWeight:i.IT.Normal,fontFamily:n.V,fontSize:t.small,cssColor:e,lineHeight:20}}function C(e){const t={};return e&&(t.borderWidth={top:0,end:0,start:0,bottom:1},t.borderStyle="solid"),t}function S(){return{fontSize:12,fontWeight:600}}const w={style:{marginStart:-8,marginEnd:-12,marginTop:8,marginBottom:8,height:1}},k={paddingTop:12,paddingBottom:8,paddingHorizontal:12},T={description:k,item:{paddingVertical:8,paddingStart:4,borderRadius:8}}},19254:(e,t,o)=>{"use strict";o.d(t,{i:()=>l});var i=o(56415),n=o(95012),r=o(90096),s=o(53429),a=o(18028);const l=i.memo((e=>{var{strings:t,theme:o,browseThisComputerButtonLabel:l,isBrowseThisComputerEnabled:c,onClickBrowseThisComputer:u,hasSelectionBeenModifiedViaKeyboard:d}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["strings","theme","browseThisComputerButtonLabel","isBrowseThisComputerEnabled","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard"]);return i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Stretch},i.createElement(s.u,Object.assign({},h,{style:a.zx,accessibilityRole:"option",automationLabel:"InlineSuggestionsBrowseThisComputer",title:l,icon:{type:"Laptop",style:a.RR},onClick:u,hasKeyboardFocus:c,theme:o,isSelectedByKeyboard:c&&d})))}));l.displayName="InlineSuggestionsBrowseThisComputer"},6195:(e,t,o)=>{"use strict";o.d(t,{K:()=>_});var i=o(56415),n=o(94458),r=o(30444),s=o(38279),a=o(15624),l=o(26086),c=o(98138),u=o(33638),d=o(53429),h=o(10894),g=o(18028),p=o(17660),f=o(58021),m=o(57107);function v(e,t){if(!t)return;e=e.toLocaleLowerCase();const o=(t=t.toLocaleLowerCase()).indexOf(e);return o<0?void 0:[{start:o,length:e.length,fontWeight:l.IT.SemiBold,wrapMode:l.bd.NoWrap}]}function b(e,t,o){if(!e)return;const i=o?null==t?void 0:t.filter((e=>e.propertyHit===o)):t,n=[];return i&&i.forEach((e=>{n.push({start:e.offset,length:e.word.length,fontWeight:l.IT.SemiBold,wrapMode:l.bd.NoWrap})})),n}const y=({htmlId:e,theme:t,style:o,strings:n,suggestionId:r,suggestionType:l,queryString:y,title:C,titleFontSize:S,subtitle:w,subtitleFontSize:k,truncateSubtitle:T,tooltip:x,icon:I,layerHostId:_,personaCoinProps:E,isHighlighted:A,hasSelectionBeenModifiedViaKeyboard:R,showKeyboardTooltip:B,isInitialSelection:M,accessibilityRole:D,accessibilityPositionInSet:O,accessibilitySetSize:F,disableAccessibilityExpanded:P,onHeightChange:N,onHoverIn:L,onClick:j,enablePrefixHighlighting:q,hitHighlightIndexes:H,displayNewItemTag:z,newItemTagStyles:W,disableTooltips:G,enableExpandedECCScopeLayout:U,isScopeSelected:V,isDisabled:$,updateItemHeight:K})=>{var Q,Y,J,Z,X,ee,te,oe,ie,ne,re,se,ae;const le=i.useContext(c.O),ce=l===s.c.Topic,ue=null!=t?t:f.nk(void 0,le);let de=u.A.rightCenter;switch(null===(Q=null==ue?void 0:ue.tooltip)||void 0===Q?void 0:Q.directionHint){case a.A8.centered:de=void 0;break;case a.A8.rightCenter:de=u.A.rightCenter;break;case a.A8.bottomCenter:de=u.A.bottomCenter;break;default:de=ce?u.A.rightCenter:void 0}const he=f.yi(l,t,A),ge=C&&w?(0,p.w)(n,C,w):C,{borderThickness:pe,shadows:fe}=(0,m.j)(o,le?null!==(Y=ue.focusRing)&&void 0!==Y?Y:"var(--colorStrokeFocus2)":null!==(J=he.border)&&void 0!==J?J:"#000",null!=M&&M,null!=R&&R,null!=A&&A);return i.createElement(d.u,{appearance:"subtle",htmlId:e,onClick:j,onHoverIn:L,accessibilityLabel:ge,accessibilityRole:D,accessibilityPositionInSet:O,accessibilitySetSize:F,disableAccessibilityExpanded:P,onHeightChange:N,automationLabel:`Inline${l}Suggestion-${r}`,tooltipProps:{showBeak:null!==(X=null===(Z=null==ue?void 0:ue.tooltip)||void 0===Z?void 0:Z.showBeak)&&void 0!==X?X:ce,gapSpace:null===(ee=null==ue?void 0:ue.tooltip)||void 0===ee?void 0:ee.gapSpace,borderRadius:null===(te=null==ue?void 0:ue.tooltip)||void 0===te?void 0:te.borderRadius,calloutMaxWidth:null===(oe=null==ue?void 0:ue.tooltip)||void 0===oe?void 0:oe.calloutMaxWidth,paddingStart:null===(ie=null==ue?void 0:ue.tooltip)||void 0===ie?void 0:ie.paddingStart,paddingEnd:null===(ne=null==ue?void 0:ue.tooltip)||void 0===ne?void 0:ne.paddingEnd,paddingTop:null===(re=null==ue?void 0:ue.tooltip)||void 0===re?void 0:re.paddingTop,paddingBottom:null===(se=null==ue?void 0:ue.tooltip)||void 0===se?void 0:se.paddingBottom,coverTarget:void 0===de,directionHint:de,layerHostId:_},title:C,titleStyle:h.D0(h.d4,C?C.length:0,!0,S),titleRootStyle:h.Xp(),personaCoinProps:E,style:o?Object.assign(Object.assign({},o),{borderThickness:fe?0:pe,boxShadow:(null!==(ae=null==fe?void 0:fe.length)&&void 0!==ae?ae:0)>0?fe:void 0}):void 0,subtitle:w,subtitleStyle:h.qw(h.d4,!0,T,k),theme:he,hasKeyboardFocus:A,isSelectedByKeyboard:A&&R&&B,tooltip:G?"":x,icon:I?Object.assign(Object.assign({},I),{filled:!0}):void 0,titleFormatting_DONOTUSE:y?q?b(C,H,"title"):v(y,C):void 0,subtitleFormatting:y?q?b(w,H,"subTitle"):v(y,w):void 0,tagStyles:g.mX(ue,W),tagText:z?n.inlineSuggestions("newTagText"):void 0,topPanelScopeButton:U,showUnderline:V,disabled:$,updateItemHeight:K})};var C=o(95012),S=o(90096),w=o(4168),k=o(70847),T=o(43906);const x=i.memo((e=>{var t,o,{suggestion:n,theme:r,styles:s,newItemTagStyles:a,onItemHovered:l,onItemSelected:u,strings:d,enableExpandedECCScopeLayout:p,enableMeetingBanner:m,locale:v}=e,b=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["suggestion","theme","styles","newItemTagStyles","onItemHovered","onItemSelected","strings","enableExpandedECCScopeLayout","enableMeetingBanner","locale"]);const x=i.useContext(c.O),I=null!=r?r:f.nk(void 0,x),_=i.useCallback((()=>{u(n)}),[n,u]),E=i.useCallback((()=>{null==l||l(n)}),[n,l]),A=(0,k.D)(n,d,s,I,p,m,v),R=n.type===T.E9&&(null===(t=null==s?void 0:s.noSuggestionsStyles)||void 0===t?void 0:t.item)?s.noSuggestionsStyles.item:A.style,B=i.createElement(y,Object.assign({},b,A,{style:R,newItemTagStyles:a,strings:d,theme:r,onClick:_,onHoverIn:E,isDisabled:n.isDisabled}));if(n.noSuggestionsDescription){const e=n.type===T.E9?null===(o=null==s?void 0:s.noSuggestionsStyles)||void 0===o?void 0:o.description:void 0;return i.createElement(C.S,{align:S.j5.Stretch,direction:S.PR.TopToBottom},i.createElement(C.S,{style:null!=e?e:g.MG},i.createElement(w.c,{text:n.noSuggestionsDescription,style:g.dm(f.FP(n,r),h.d4)})),B)}return B}));x.displayName="InlineSuggestionsItem";var I=o(47149);const _=i.memo((({theme:e,group:t,accessibilitySetSize:o,strings:a,headerHtmlId:l,isHeaderVisible:c,headerStyles:u,containerStyles:d,hasScopableHeader:h,headerAccessibilityPositionInSet:g,enablePrefixHighlighting:p,showSeparator:f,separatorProps:m,hasSelectionBeenModifiedViaKeyboard:v,showKeyboardTooltip:b,isInitialSelection:y,layerHostId:C,itemsStyles:S,newItemTagStyles:w,itemQueryString:k,onHeaderClick:x,onHeaderHeightChange:_,onSeparatorHeightChange:A,onHeightExtraSpaceBottomChange:R,onGroupHovered:B,onItemHovered:M,onItemSelected:D,onItemHeightChange:O,disableTooltips:F,enableExpandedECCScopeLayout:P,overflowIndex:N,showMeetingBanner:L,enableMeetingBanner:j,meetingBannerText:q,accessibilityRole:H="option",isSmallWindow:z,updateItemHeight:W,locale:G})=>{var U,V,$,K;const Q=t.suggestions;let Y=!1,J=!1;const Z=Q.map(((t,n)=>{if(N&&N<=n)return;const r=g+(h?++n:n);return Y=Y||t.isNew&&t.type===s.c.Scope||!1,J=L&&t.type===s.c.Event||!1,i.createElement(E,{styles:S,containerStyles:d,newItemTagStyles:w,strings:a,suggestion:t,key:`suggestion-item-${n}`,index:n,locale:G,htmlId:P?(0,T.Bn)(n,!0):t.type===T.E9?T.E9:(0,T.Bn)(r),theme:e,queryString:""!==k?k:void 0,accessibilityRole:H,accessibilityPositionInSet:r+1,accessibilitySetSize:o,truncateSubtitle:!0,onItemHovered:M,onItemSelected:D,onItemHeightChange:O,enablePrefixHighlighting:p,hasSelectionBeenModifiedViaKeyboard:v,showKeyboardTooltip:b&&!!t.isHighlighted,isInitialSelection:y,layerHostId:C,disableTooltips:F,enableExpandedECCScopeLayout:P,enableMeetingBanner:j,hasScopableHeader:h,updateItemHeight:W})}));return i.createElement(i.Fragment,null,f&&i.createElement(n.w,Object.assign({},m,{onHeightChange:A})),J&&i.createElement("div",{style:{display:"flex",width:"100%",height:z?"52px":"36px",alignItems:"center",gap:"12px",borderRadius:"6px",backgroundColor:`${null===(U=null==e?void 0:e.meetingBanner)||void 0===U?void 0:U.backgroundColor}`,padding:"6px 12px",border:`1px solid ${null===(V=null==e?void 0:e.meetingBanner)||void 0===V?void 0:V.borderColor}`,margin:"6px 0",boxSizing:"border-box"},"aria-label":q},i.createElement(r.In,{type:"Info",filled:!0,primaryColor:null===($=null==e?void 0:e.meetingBanner)||void 0===$?void 0:$.iconPrimaryColor}),i.createElement("span",{style:{fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",padding:"1px 0px 3px 0px",color:`${null===(K=null==e?void 0:e.meetingBanner)||void 0===K?void 0:K.text}`}},q)),c?i.createElement(I.h,{theme:e,styles:u,htmlId:l,group:t,isScopableHeader:h,accessibilityPositionInSet:g+1,accessibilitySetSize:o,onClick:x,onGroupHovered:B,onHeightChange:_,onHeightExtraSpaceBottomChange:R,strings:a,displayNewItemTag:Y,newItemTagStyles:w,hasSelectionBeenModifiedViaKeyboard:v},Z):Z)}));_.displayName="InlineSuggestionsGroup";const E=e=>{var{index:t,hasScopableHeader:o,onItemHeightChange:n}=e,r=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["index","hasScopableHeader","onItemHeightChange"]);const s=i.useCallback((e=>n(e,t-(o?1:0))),[t,o]);return i.createElement(x,Object.assign({},r,{onHeightChange:s}))}},47149:(e,t,o)=>{"use strict";o.d(t,{h:()=>f});var i=o(56415),n=o(10894),r=o(18028),s=o(98138),a=o(95012),l=o(90096),c=o(90379),u=o(53429),d=o(30444),h=o(90218),g=o(58021),p=o(57107);const f=i.memo((({group:e,htmlId:t,theme:o,style:f,styles:m,isScopableHeader:v,accessibilityPositionInSet:b,accessibilitySetSize:y,onClick:C,onGroupHovered:S,onHeightChange:w,onHeightExtraSpaceBottomChange:k,children:T,strings:x,displayNewItemTag:I,newItemTagStyles:_,hasSelectionBeenModifiedViaKeyboard:E})=>{var A,R,B,M,D,O,F;const P=i.useContext(s.O),{title:N,subtitle:L,isScoped:j=!1,isHighlighted:q,addBottomBorder:H}=e,[z,W]=i.useState(!1),G=null!=o?o:g.nk(void 0,P),U=null!=f?f:r.Js,V=Object.assign(Object.assign({},g.Fr(G)),r.L_(H)),$=i.useCallback((()=>{W(!0),null==S||S(e)}),[e,S]);if(k){let e=0;V.borderWidth&&(e="object"==typeof V.borderWidth?V.borderWidth.bottom?V.borderWidth.bottom:0:V.borderWidth),k(e)}const K=i.createElement(a.S,{direction:l.PR.TopToBottom,style:V,align:l.j5.Stretch,accessible:!0,accessibilityRole:"list",accessibilityLabel:N},T);if(v&&N){const e=null!==(A=null==m?void 0:m.titleLineHeight)&&void 0!==A?A:10,r=null!==(R=null==m?void 0:m.headerIconSize)&&void 0!==R?R:10;let s;s=(0,c.I)()?q&&null!==(B=P?"Highlight":"HighlightText")&&void 0!==B?B:"CanvasText":(q||z)&&null!==(M=null==G?void 0:G.text.hover)&&void 0!==M?M:null==G?void 0:G.text.resting;const a={lineHeight:e+"px",display:"flex",width:j?"auto":"100%",flexDirection:j?"row-reverse":"row",justifyContent:"flex-end"},l={color:s,marginLeft:"4px",fontWeight:"600",flexGrow:j?0:1,fontSize:n.d4.xsmall,display:"flex",alignItems:"center"},h=j?"Previous":"Next",f=g.vA(G,q),{borderThickness:v,shadows:S}=(0,p.j)(m,P?null!==(D=null==o?void 0:o.focusRing)&&void 0!==D?D:"var(--colorStrokeFocus2)":null!==(O=f.border)&&void 0!==O?O:"#000",!1,null!=E&&E,null!=q&&q);return i.createElement(i.Fragment,null,i.createElement(u.u,{appearance:"subtle",hasKeyboardFocus:q,htmlId:t,icon:{type:h},automationLabel:N,title:N,titleStyle:n.D0(n.d4,(null==N?void 0:N.length)||0,!0),theme:f,onClick:C,style:Object.assign(Object.assign({flexibleSize:!0},m),{borderThickness:S?0:v,boxShadow:(null!==(F=null==S?void 0:S.length)&&void 0!==F?F:0)>0?S:void 0}),onHeightChange:w,onHoverIn:$,onHoverOut:()=>W(!1),accessibilityRole:"option",accessibilityPositionInSet:b,accessibilitySetSize:y,useFullWidth:!0},i.createElement("span",{"data-is-focusable":!0,style:a},i.createElement("span",{style:l},N),i.createElement(d.In,{type:h,primaryColor:s,fontSize:r,style:{margin:(e-r)/2}}))),K)}return i.createElement(h.Y,{header:N,headerStyle:Object.assign(Object.assign(Object.assign({},r.B3(G,U,n.d4)),m),{userSelectable:!1}),subheader:L,subheaderStyle:Object.assign(Object.assign({},r.XC(G,U,n.d4)),m),componentStackStyle:V,stackDirection:l.PR.TopToBottom,stackAlignment:l.j5.Stretch,accessibleLive:l.pq.Off,onHeaderHeightChange:w,tagStyles:r.mX(G,_),tagText:I?null==x?void 0:x.inlineSuggestions("newTagText"):void 0},K)}));f.displayName="InlineSuggestionsGroupHeader"},70847:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>m,r:()=>f}),3023==o.j)var i=o(38279);if(3023==o.j)var n=o(17475);if(3023==o.j)var r=o(46789);var s=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};function a(e){return e.type===i.c.Event}function l(e){return e.type===i.c.Message}function c(e){return e.type===i.c.File}function u(e){return e.type===i.c.People}function d(e){return e.type===i.c.Scope}function h(e){return e.type===i.c.Chat}function g(e){return e.type===i.c.CopilotPlugin}function p(e){return e.type===i.c.App}function f(e){return a(e)?e.eventId:l(e)?e.emailId:c(e)?e.fileName:u(e)?e.displayName:d(e)?e.id:h(e)?e.name:g(e)?e.previewCard.title:(p(e),e.title)}const m=(e,t,o,i,f,m,b)=>{var y,C,S,w,k,T,x,I,_,E,A,R,B,M;if(c(e)){const t=e.hitFileName||`${e.fileName}.${e.fileExtension}`,i=(null==o?void 0:o.fileItemStyles)||{},{iconStyles:n,titleFontSize:a,subtitleFontSize:l}=i,c=s(i,["iconStyles","titleFontSize","subtitleFontSize"]);return{suggestionId:e.itemId,suggestionType:e.type,title:t,titleFontSize:a,icon:{type:(0,r.Z)(e.fileExtension),style:n||{}},style:c,subtitle:e.subject,subtitleFontSize:l,tooltip:t,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(u(e)){const t=(null==o?void 0:o.personItemStyles)||{},{personaCoinSize:n,titleFontSize:r,subtitleFontSize:a}=t,l=s(t,["personaCoinSize","titleFontSize","subtitleFontSize"]);return Object.assign(Object.assign({suggestionId:e.displayName,suggestionType:e.type,title:e.displayName,titleFontSize:r,personaCoinProps:{text:"",size:v(n),imageUrl:e.imageUrl,initials:e.initials,borderColor:null==i?void 0:i.userAvatarBorderColor}},e.iconName&&{icon:{type:e.iconName}}),{style:l,subtitle:null!==(y=e.subtitleOverride)&&void 0!==y?y:e.primaryEmailAddress,subtitleFontSize:a,truncateSubtitle:!0,tooltip:e.primaryEmailAddress,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes})}if(d(e)){const t=(null==o?void 0:o.scopeItemStyles)||{},{iconStyles:i,titleFontSize:r,subtitleFontSize:a,personaCoinSize:l}=t,c=s(t,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),u=(0,n.S)(e.iconName);return{suggestionId:e.id,suggestionType:e.type,title:e.title,titleFontSize:r,icon:void 0===u||f?void 0:{type:u,style:i||{}},personaCoinProps:!e.imageUrl&&!e.iconName||f?void 0:{text:"",size:v(l),imageUrl:e.imageUrl,color:"neutral"},style:c,subtitle:e.subtitle,subtitleFontSize:a,tooltip:null!==(C=e.tooltip)&&void 0!==C?C:e.title,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew,enableExpandedECCScopeLayout:f,isScopeSelected:e.isSelected}}if(a(e)){const{eventId:n,eventName:r,eventStartDateTime:a,eventEndDateTime:l,isAllDay:c,isSeries:u,hasRecording:d}=e,h=(null==o?void 0:o.eventItemStyles)||{},{iconStyles:g,titleFontSize:p,subtitleFontSize:f}=h,v=s(h,["iconStyles","titleFontSize","subtitleFontSize"]),y=function(e,t,o,i="en-US"){let n="";const r=Date.parse(e);if(!Number.isNaN(r)){const e=new Date(r),s=Date.parse(t);if(Number.isNaN(s))n=o?e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i):e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"});else{const t=new Date(s);n=e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()?o?e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i):e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"}):o?e.toLocaleDateString(i)+" - "+t.toLocaleDateString(i):e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleDateString(i)+" "+t.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})}}return n}(a,l,c,b),C=(null==t?void 0:t.inlineSuggestions("recordText"))||"",k=m&&d?y+" | "+C:y;return{suggestionId:n,suggestionType:e.type,title:r,titleFontSize:p,icon:{type:m&&d?"EventRecorded":u?"EventSeries":"Event",fontSize:u?16:14,style:Object.assign(Object.assign({},g),{backgroundColor:(null===(S=null==i?void 0:i.fallbackIcon)||void 0===S?void 0:S.background)||(null==g?void 0:g.backgroundColor)}),primaryColor:null===(w=null==i?void 0:i.fallbackIcon)||void 0===w?void 0:w.color},style:v,subtitle:k,subtitleFontSize:f,truncateSubtitle:!0,tooltip:r+" "+k,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(l(e)){const{subject:n,sender:r,emailId:a}=e,l=(null==o?void 0:o.emailItemStyles)||{},{iconStyles:c,titleFontSize:u,subtitleFontSize:d}=l,h=s(l,["iconStyles","titleFontSize","subtitleFontSize"]),g=null===(k=t.inlineSuggestions("emailSentBy"))||void 0===k?void 0:k.replace("{0}",r);return{suggestionId:a,suggestionType:e.type,title:n,titleFontSize:u,icon:{type:"Emails",fontSize:null!==(T=h.iconFontSize)&&void 0!==T?T:16,style:Object.assign(Object.assign({},c),{backgroundColor:(null===(x=null==i?void 0:i.fallbackIcon)||void 0===x?void 0:x.background)||(null==c?void 0:c.backgroundColor)}),primaryColor:null===(I=null==i?void 0:i.fallbackIcon)||void 0===I?void 0:I.color},style:h,subtitle:g,subtitleFontSize:d,truncateSubtitle:!0,tooltip:n,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(p(e)){const{title:t,imageUrl:o,collectorId:n,appType:r,subtitle:s,isMoreButton:a}=e;return{suggestionId:n,suggestionType:e.type,title:t,appType:r,subtitle:s,icon:o?void 0:a?{type:"ExploreMoreCopilot",fontSize:32,style:{backgroundColor:null===(_=null==i?void 0:i.fallbackIcon)||void 0===_?void 0:_.background,height:32,width:32}}:{type:"ChatBubblesQuestion",fontSize:32,style:{backgroundColor:null===(E=null==i?void 0:i.fallbackIcon)||void 0===E?void 0:E.background,height:32,width:32}},personaCoinProps:o?{text:t,imageUrl:o,color:"neutral",size:32}:void 0,truncateSubtitle:!0,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,disableAccessibilityExpanded:!0}}if(h(e)){const{name:t,chatMembers:n,threadId:r,lastMessageTime:a,imageUrl:l}=e,c=(null==o?void 0:o.chatItemStyles)||{},{iconStyles:u,titleFontSize:d,subtitleFontSize:h,personaCoinSize:g}=c,p=s(c,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),f=2,m=n.length-f;let b=n.slice(0,f).map((e=>e.displayName)).join(", ");m>0&&(b+=`, +${m}`);const y=t||b,C=new Date(a),S=C.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric",hour12:!0}),w=`${C.toLocaleDateString("en-US")} ${S}`;return Object.assign({title:y,tooltip:y,subtitle:t?b:w,suggestionId:r,suggestionType:e.type,truncateSubtitle:!0,titleFontSize:d,subtitleFontSize:h,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,style:p},l?{personaCoinProps:{text:y,imageUrl:l,size:v(g),borderColor:null==i?void 0:i.userAvatarBorderColor}}:{icon:{type:"TeamsChat",style:Object.assign(Object.assign({},u),{backgroundColor:(null===(A=null==i?void 0:i.fallbackIcon)||void 0===A?void 0:A.background)||(null==u?void 0:u.backgroundColor)}),primaryColor:null===(R=null==i?void 0:i.fallbackIcon)||void 0===R?void 0:R.color}})}if(g(e)){const t=(null==o?void 0:o.genericItemStyles)||{},{iconStyles:i,personaCoinSize:n,titleFontSize:r,subtitleFontSize:a}=t,l=s(t,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),c=e.previewCard,u=null===(M=null===(B=c.images)||void 0===B?void 0:B[0])||void 0===M?void 0:M.url;return{suggestionId:c.title,suggestionType:e.type,title:c.title,titleFontSize:r,personaCoinProps:u?{text:"",size:v(n),imageUrl:u,color:"neutral"}:void 0,style:l,subtitle:c.subtitle,subtitleFontSize:a,tooltip:c.title,displayNewItemTag:e.isNew,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}const{id:D,title:O,subtitle:F,imageUrl:P,tooltip:N,type:L,isHighlighted:j}=e,q=(null==o?void 0:o.genericItemStyles)||{},{iconStyles:H,personaCoinSize:z,titleFontSize:W,subtitleFontSize:G}=q,U=s(q,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),V=(0,n.S)(e.iconName);return{suggestionId:D,suggestionType:L,title:O,titleFontSize:W,icon:void 0!==V?{type:V,style:H}:void 0,personaCoinProps:P||V?{text:"",size:v(z),imageUrl:P,color:"neutral"}:void 0,style:U,subtitle:F,subtitleFontSize:G,truncateSubtitle:!!N,tooltip:null!=N?N:O,isHighlighted:j,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew}},v=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},57107:(e,t,o)=>{"use strict";function i(e,t,o,i,n){const r=o?null==e?void 0:e.borderThicknessInitialSelection:i?null==e?void 0:e.borderThicknessWithKeyboardFocus:void 0,s=n&&r?r:null==e?void 0:e.borderThickness,a="number"==typeof s?s:null==s?void 0:s.start,l="number"==typeof s?s:null==s?void 0:s.end,c="number"==typeof s?s:null==s?void 0:s.top,u="number"==typeof s?s:null==s?void 0:s.bottom;let d="";return a&&(d+=`inset ${a}px 0 0 0 ${t},`),l&&(d+=`inset -${l}px 0 0 0 ${t},`),c&&(d+=`inset 0 ${c}px 0 0 ${t},`),u&&(d+=`inset 0 -${u}px 0 0 ${t},`),d.length>0&&(d=d.substring(0,d.length-1)),{borderThickness:s,shadows:d}}o.d(t,{j:()=>i})},64548:(e,t,o)=>{"use strict";o.d(t,{p:()=>p});var i=o(56415),n=o(98138),r=o(95012),s=o(90096),a=o(3451),l=o(24281);const c=({hideTitle:e,style:t})=>{var o,n,c,u,d;const h=null!==(o=null==t?void 0:t.itemPaddingVertical)&&void 0!==o?o:6,g=null!==(n=null==t?void 0:t.itemPaddingHorizontal)&&void 0!==n?n:12,p=null!==(c=null==t?void 0:t.textPaddingLeft)&&void 0!==c?c:8,f=null!==(u=null==t?void 0:t.personaCoinSize)&&void 0!==u?u:24,m=((null!==(d=null==t?void 0:t.titleLineHeight)&&void 0!==d?d:16)-12)/2+10,v=i.createElement(a.E,{style:{paddingTop:h,paddingBottom:h,paddingLeft:g,paddingRight:g}},i.createElement("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:p,alignItems:"center"}},i.createElement(l.H,{shape:"circle",style:{width:f,height:f}}),i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:4,paddingTop:4,paddingBottom:4}},i.createElement(l.H,{style:{height:14}}),i.createElement(l.H,{style:{height:10,width:"80%"}}))));return i.createElement(r.S,{align:s.j5.Stretch,style:{width:"100%"}},!e&&i.createElement(a.E,{style:{paddingLeft:g,paddingRight:g}},i.createElement(l.H,{style:{height:12,width:80,marginTop:m,marginBottom:m}})),v,v,v,v,v)};var u=o(6195),d=o(43906),h=o(18028),g=o(58021);const p=i.memo((({theme:e,styles:t,strings:o,results:a,isShimmerVisible:l,enableScopedHeader:u,enablePrefixHighlighting:p,layerHostId:m,itemsCount:v,itemQueryString:b,isGroupHeaderVisible:y,hasSelectionBeenModifiedViaKeyboard:C,showKeyboardTooltip:S,isInitialSelection:w,disableTooltips:k,showMeetingBanner:T,enableMeetingBanner:x,meetingBannerText:I,isSmallWindow:_,suggestionsRef:E,locale:A,onGroupSelected:R,onGroupHovered:B,onItemHovered:M,onItemSelected:D,updateMenuLayout:O,updateItemHeight:F})=>{var P,N;const L=i.useContext(n.O),j=null!=e?e:g.nk(void 0,L);let q=0;return l?i.createElement(c,{hideTitle:!y,style:null==t?void 0:t.shimmerStyles,inlineSuggestionsTheme:j}):i.createElement(r.S,{ref:E,style:{marginEnd:null===(P=null==t?void 0:t.containerStyles)||void 0===P?void 0:P.marginEnd,height:null===(N=null==t?void 0:t.gptViewStyles)||void 0===N?void 0:N.height},align:s.j5.Stretch},a.map(((e,n)=>{const r=e.suggestions,s=u&&!1!==e.isScopingEnabled&&void 0!==e.title,a=i.createElement(f,{theme:j,styles:t,strings:o,key:`suggestion-group-${n}`,entryIndex:n,itemsCount:v,cumulativeCount:q,group:e,locale:A,layerHostId:m,accessibilitySetSize:v,headerHtmlId:(0,d.Bn)(q),headerStyles:null==t?void 0:t.headerStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:q,hasScopableHeader:s,enablePrefixHighlighting:p,onGroupSelected:R,onGroupHovered:B,itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:b,onItemHovered:M,onItemSelected:D,showSeparator:e.showSeparator,isHeaderVisible:y,separatorProps:e.showSeparator&&h.g4||void 0,hasSelectionBeenModifiedViaKeyboard:C,showKeyboardTooltip:S,isInitialSelection:w,disableTooltips:k||e.disableTooltips,showMeetingBanner:T&&0===n,enableMeetingBanner:x,meetingBannerText:I,isSmallWindow:_,updateMenuLayout:O,updateItemHeight:F});return s&&(q+=1),q+=r.length,a})))}));p.displayName="InlineSuggestionsResultBody";const f=e=>{var{styles:t,group:o,entryIndex:n,itemsCount:r,cumulativeCount:s,onGroupSelected:a,updateMenuLayout:l,updateItemHeight:c}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["styles","group","entryIndex","itemsCount","cumulativeCount","onGroupSelected","updateMenuLayout","updateItemHeight"]);const g=i.useCallback((()=>null==a?void 0:a(o)),[a,o]),p=i.useCallback((e=>l((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[n].headerHeight=e}))),[]),f=i.useCallback((e=>l((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),t.groupLayouts[n].extraSpaceBottomHeight=e}))),[]),m=i.useCallback((e=>l((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[n].separatorHeight=e}))),[]),v=i.useCallback(((e,t)=>l((o=>{o.groupLayouts[n]||(o.groupLayouts[n]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),o.groupLayouts[n].itemHeights[t]=e}))),[]);return i.createElement(u.K,Object.assign({},h,{group:o,accessibilitySetSize:r,headerHtmlId:(0,d.Bn)(s),headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:s,onHeaderClick:g,onHeaderHeightChange:p,onHeightExtraSpaceBottomChange:f,onSeparatorHeightChange:m,itemsStyles:null==t?void 0:t.itemsStyles,onItemHeightChange:v,updateItemHeight:c}))}},43906:(e,t,o)=>{"use strict";o.d(t,{Bn:()=>a,E9:()=>i,Es:()=>r,Jx:()=>c,MN:()=>u,O5:()=>l,Oz:()=>d,WM:()=>s,al:()=>n});const i="noSuggestions",n=2e3,r="Retry",s="ClearSearch",a=(e,t)=>(t?"header-option":"option")+e,l=e=>!!e&&("InlineSuggestionsResultsUserInitiatedMenuType"===e.menuType?void 0!==e.brandingMode:"InlineSuggestionsResultsFlagMenuType"===e.menuType),c=e=>e&&"actions"in e?e.actions:[],u=e=>"https://www.bing.com/q="+e,d=(e=!1,t,o,n,a,l,c)=>{if(e&&o)return[];const u=h(a);if(t)return[Object.assign(Object.assign({},l),{disableTooltips:!0,suggestions:[{id:r,type:i,title:n.inlineSuggestions("tryAgainLabel"),noSuggestionsDescription:n.inlineSuggestions("somethingWentWrongLabel")}]}),...u.filter((e=>e.alwaysDisplay))];if(o||c){const e=o?"clearSearchLabel":"showAvailableSuggestionsLabel";return[Object.assign(Object.assign({},l),{disableTooltips:!0,suggestions:[{id:s,type:i,title:n.inlineSuggestions(e),noSuggestionsDescription:n.common("suggestionsGroupNoSuggestionsText")}]}),...u.filter((e=>e.alwaysDisplay))]}return u},h=e=>{if(e instanceof Array){const t=[];return e.forEach((e=>t.push(h(e)))),t}if("object"==typeof e){const t={};for(const o in e)t[o]=h(e[o]);return t}return e}},37996:(e,t,o)=>{"use strict";o.d(t,{y:()=>s});var i=o(56415),n=o(95012),r=o(3592);const s=i.memo((e=>{var t,o,s,a,l,c,u,d,h,g,p,f,m,v,{style:b,theme:y}=e,C=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["style","theme"]);return i.createElement(i.Fragment,null,i.createElement(n.S,{style:{marginBottom:null!==(t=null==b?void 0:b.marginBottom)&&void 0!==t?t:8,marginTop:null!==(o=null==b?void 0:b.marginTop)&&void 0!==o?o:8,marginStart:null!==(s=null==b?void 0:b.marginStart)&&void 0!==s?s:0,marginEnd:null!==(a=null==b?void 0:b.marginEnd)&&void 0!==a?a:12,width:"100%",minWidth:0}},i.createElement(r.G,Object.assign({},C,{autoComplete:!1,spellCheck:!1,accessibilityLabel:"InlineSuggestionsSearchBox",styles:{borderRadius:4,width:"100%",borderBottom:`${null===(l=null==y?void 0:y.searchBox)||void 0===l?void 0:l.borderBottomColor} solid 1px`},theme:{background:null==y?void 0:y.background.resting,textColor:null===(c=null==y?void 0:y.text)||void 0===c?void 0:c.resting,placeholderTextColor:null===(u=null==y?void 0:y.text)||void 0===u?void 0:u.disabled,clearButton:{hover:null===(d=null==y?void 0:y.background)||void 0===d?void 0:d.hover,resting:null===(h=null==y?void 0:y.background)||void 0===h?void 0:h.resting},iconColor:null===(g=null==y?void 0:y.searchBox)||void 0===g?void 0:g.iconColor,borderColor:{hover:null===(f=null===(p=null==y?void 0:y.searchBox)||void 0===p?void 0:p.borderColor)||void 0===f?void 0:f.hover,resting:null===(v=null===(m=null==y?void 0:y.searchBox)||void 0===m?void 0:m.borderColor)||void 0===v?void 0:v.resting}}}))))}));s.displayName="InlineSuggestionsSearchBox"},65755:(e,t,o)=>{"use strict";if(o.d(t,{H:()=>r}),3023==o.j)var i=o(10894);if(3023==o.j)var n=o(18028);const r=(e={},t)=>Object.assign(Object.assign({},e),{containerStyles:s(e.containerStyles,t),shimmerStyles:a(e),headerStyles:l(e.headerStyles),itemsStyles:u(e.itemsStyles,t),footerStyles:S(e.footerStyles)}),s=(e={},t)=>{var o,i;return Object.assign({minWidth:240,maxWidth:null!==(o=null==t?void 0:t.menuMaxWidth)&&void 0!==o?o:240,maxHeight:null!==(i=null==t?void 0:t.menuHeight)&&void 0!==i?i:252,borderRadius:8,paddingTop:4,paddingBottom:4,paddingHorizontal:4},e)},a=(e={})=>{var t,o,i,n,r,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({itemPaddingVertical:null!==(o=null==l?void 0:l.paddingVertical)&&void 0!==o?o:6,itemPaddingHorizontal:null!==(i=null==l?void 0:l.paddingHorizontal)&&void 0!==i?i:12,textPaddingLeft:null!==(n=null==l?void 0:l.textPaddingStart)&&void 0!==n?n:8,personaCoinSize:null!==(r=null==l?void 0:l.personaCoinSize)&&void 0!==r?r:24,titleLineHeight:null!==(a=null===(s=null==e?void 0:e.headerStyles)||void 0===s?void 0:s.titleLineHeight)&&void 0!==a?a:16},e.shimmerStyles)},l=(e={})=>Object.assign({},e),c=(e={},t={},o={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),n.ZD.item),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),n.ZD.description),t),e.description)}),u=(e={},t)=>({genericItemStyles:g(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:p(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:f(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:m(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:v(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:b(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:C(e.chatItemStyles,e.sharedItemStyles,t),appGptItemStyles:y(e.appGptItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:c(e.noSuggestionsStyles,e.sharedItemStyles,t)}),d=e=>{var t,o;return Object.assign(Object.assign({},n.cK),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:n.cK.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:n.cK.height})},h=e=>Object.assign(Object.assign({},n.nI),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),g=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},p=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e)},f=(e={},t={},o)=>Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)}),m=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},v=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},b=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},y=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},C=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign({width:24,height:24,borderRadius:20},null==e?void 0:e.iconStyles)})},S=(e={})=>Object.assign(Object.assign(Object.assign({},i.Y_),{height:45,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},82448:(e,t,o)=>{"use strict";o.d(t,{Y:()=>E});var i=o(56415),n=o(20298),r=o(9443),s=o(42937),a=o(28022),l=o(80409),c=o(49080),u=o(43452),d=o(25138),h=o(85701),g=o(17226),p=o(54313);const f=(0,h.X)({base:{D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"},outline:{g2u3we:"f1ly1fcm",h3c5rm:["fi8bssc","fj6btzu"],B9xav0g:"f1s9tnsa",zhjwy3:["fj6btzu","fi8bssc"],B4j52fo:"fgx37oo",Bekrc4i:["f130t4y6","f1efpmoh"],Bn0qgzm:"fv51ejd",ibv6hh:["f1efpmoh","f130t4y6"],sj55zd:"f14nttnl"},primary:{De3pzq:"f8w4g0q"},secondary:{De3pzq:"f1nfm20t",g2u3we:"f1ly1fcm",h3c5rm:["fi8bssc","fj6btzu"],B9xav0g:"f1s9tnsa",zhjwy3:["fj6btzu","fi8bssc"],sj55zd:"f14nttnl"},subtle:{De3pzq:"fq5gl1p",sj55zd:"f1eryozh"},transparent:{De3pzq:"f1q9pm1r",sj55zd:"f1qj7y59"}},{d:[".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}",".f1ly1fcm{border-top-color:var(--colorNeutralStroke1Selected);}",".fi8bssc{border-right-color:var(--colorNeutralStroke1Selected);}",".fj6btzu{border-left-color:var(--colorNeutralStroke1Selected);}",".f1s9tnsa{border-bottom-color:var(--colorNeutralStroke1Selected);}",".fgx37oo{border-top-width:var(--strokeWidthThicker);}",".f130t4y6{border-right-width:var(--strokeWidthThicker);}",".f1efpmoh{border-left-width:var(--strokeWidthThicker);}",".fv51ejd{border-bottom-width:var(--strokeWidthThicker);}",".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f8w4g0q{background-color:var(--colorBrandBackgroundSelected);}",".f1nfm20t{background-color:var(--colorNeutralBackground1Selected);}",".fq5gl1p{background-color:var(--colorSubtleBackgroundSelected);}",".f1eryozh{color:var(--colorNeutralForeground2Selected);}",".f1q9pm1r{background-color:var(--colorTransparentBackgroundSelected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"]}),m=(0,h.X)({outline:{sj55zd:"f14nttnl"},primary:{},secondary:{sj55zd:"f14nttnl"},subtle:{sj55zd:"f1qj7y59"},transparent:{sj55zd:"f1qj7y59"},highContrast:{ze5xyy:"fqyhrn0"}},{d:[".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"],m:[["@media (forced-colors: active){.fqyhrn0:hover{color:Canvas;}}",{m:"(forced-colors: active)"}]]}),v=(0,h.X)({base:{Bg96gwp:"fez10in"},small:{Be2twd7:"f1ugzwwg",Bqenvij:"fvblgha",Bg96gwp:"fwrc4pm",a9b677:"frx94fk"},medium:{Be2twd7:"f1ugzwwg",Bqenvij:"fvblgha",Bg96gwp:"fwrc4pm",a9b677:"frx94fk"},large:{Be2twd7:"f4ybsrx",Bqenvij:"fd461yt",Bg96gwp:"faaz57k",a9b677:"fjw5fx7"},notIconOnly:{Frg6f3:["fbyavb5","fm0x6gh"]}},{d:[".fez10in{line-height:0;}",".f1ugzwwg{font-size:12px;}",".fvblgha{height:12px;}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".frx94fk{width:12px;}",".f4ybsrx{font-size:16px;}",".fd461yt{height:16px;}",".faaz57k{line-height:var(--lineHeightBase400);}",".fjw5fx7{width:16px;}",".fbyavb5{margin-left:var(--spacingHorizontalXS);}",".fm0x6gh{margin-right:var(--spacingHorizontalXS);}"]});var b=o(98121);const y=i.forwardRef(((e,t)=>{const o=(({menuIcon:e,...t},o)=>{const n=(0,d.P)(t,o);return n.root["aria-expanded"]=!!t["aria-expanded"]&&("true"===t["aria-expanded"]||!0===t["aria-expanded"]),{...n,iconOnly:Boolean(!t.children),components:{root:"button",icon:"span",menuIcon:"span"},menuIcon:u.lq(e,{defaultProps:{children:i.createElement(c.yuG,null)},renderByDefault:!0,elementType:"span"})}})(e,t);return(e=>{const t=f(),o=m(),i=v();e.root.className=(0,g.z)("fui-MenuButton",e.root["aria-expanded"]&&t.base,e.root["aria-expanded"]&&t[e.appearance],e.root.className),e.icon&&(e.icon.className=(0,g.z)("fui-MenuButton__icon",e.root["aria-expanded"]&&o[e.appearance]&&o.highContrast,e.icon.className)),e.menuIcon&&(e.menuIcon.className=(0,g.z)("fui-MenuButton__menuIcon",i.base,i[e.size],!e.iconOnly&&i.notIconOnly,e.menuIcon.className)),(0,p.B)({...e,iconPosition:"before"})})(o),(0,b.$e)("useMenuButtonStyles_unstable")(o),(e=>{(0,l.C)(e);const{icon:t,iconOnly:o}=e;return(0,a.FD)(e.root,{children:[e.icon&&(0,a.Y)(e.icon,{}),!o&&e.root.children,(!o||!(null==t?void 0:t.children))&&e.menuIcon&&(0,a.Y)(e.menuIcon,{})]})})(o)}));y.displayName="MenuButton";var C=o(48570),S=o(5567),w=o(30444);const k=i.memo((({menuButtonText:e,menuButtonIcon:t,enableMenuButtonIcon:o,menuItems:a,open:l,isUploadButtonHighlighted:c,onOpenChange:u,onClick:d})=>{const h=i.useRef(null);i.useEffect((()=>{var e;c&&(null===(e=h.current)||void 0===e||e.focus())}),[c]);const g=a.map(((e,t)=>i.createElement(n.D,{key:t,icon:e.enableMenuItemIcon&&e.menuItemIcon?i.createElement(w.In,{type:e.menuItemIcon,filled:!0}):void 0,onClick:()=>e.onClickHandler()},e.menuItemText)));return i.createElement(r.W,{positioning:"below-end",open:l,onOpenChange:u},i.createElement(s.c,{disableButtonEnhancement:!0},i.createElement(y,{ref:h,id:"uploadFileButton",menuIcon:null,onClick:d,icon:o&&t?i.createElement(w.In,{type:t}):void 0},e)),i.createElement(C.b,null,i.createElement(S.c,null,g)))}));k.displayName="FluentMenu";var T=o(53429),x=o(95012),I=o(90096),_=o(18028);const E=i.memo((e=>{var{fluentMenuConfig:t,enableCloudPicker:o,strings:n,theme:r,uploadFileButtonLabel:s,onClickBrowseThisComputer:a,hasSelectionBeenModifiedViaKeyboard:l,iconOnly:c,isUploadButtonHighlighted:u,open:d,onOpenChange:h}=e,g=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["fluentMenuConfig","enableCloudPicker","strings","theme","uploadFileButtonLabel","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard","iconOnly","isUploadButtonHighlighted","open","onOpenChange"]);const p=(0,_.z0)(c),f=o&&t?i.createElement(k,{enableMenuButtonIcon:t.enableMenuButtonIcon,menuButtonIcon:"ArrowUpload",menuButtonText:t.menuButtonText,menuItems:t.menuItems,isUploadButtonHighlighted:u,open:d,onOpenChange:h,onClick:a}):i.createElement(T.u,Object.assign({},g,{style:p.style,accessibilityRole:"option",automationLabel:"InlineSuggestionsBrowseThisComputer",title:c?void 0:s,icon:{type:"ArrowUpload",style:Object.assign(Object.assign({},p.icon),{width:16,height:16})},onClick:a,theme:r,isSelectedByKeyboard:l}));return i.createElement(x.S,{direction:I.PR.LeftToRight,align:I.j5.Stretch},f)}));E.displayName="InlineSuggestionsUploadFile"},17660:(e,t,o)=>{"use strict";function i(e,t,o){var i;return(null!==(i=e.inlineSuggestions("combineSentences"))&&void 0!==i?i:"{0}. {1}").replace("{0}",t).replace("{1}",o)}o.d(t,{w:()=>i})},58021:(e,t,o)=>{"use strict";if(o.d(t,{$d:()=>f,Dj:()=>C,FP:()=>b,Fr:()=>S,JE:()=>c,T_:()=>y,Ui:()=>g,VD:()=>m,fj:()=>v,nk:()=>l,vA:()=>d,wK:()=>p,yi:()=>u,zN:()=>h}),3023==o.j)var i=o(43906);if(3023==o.j)var n=o(1127);if(3023==o.j)var r=o(15624);const s={background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},text:{resting:"#201F1E",disabled:"#707070"},altText:{resting:"#605E5C"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5",highlightingBorderColor:"#201f1e",shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},focusRing:"#323130",searchBox:{borderColor:{resting:"#D1D1D1",hover:"#D1D1D1"},borderBottomColor:"#464FEB",iconColor:"#424242"},tooltip:{directionHint:1},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}},a={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)",highlightingBorderColor:"var(--colorStrokeFocus2)",focusRing:"var(--colorStrokeFocus2)",footerButtonBackground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},noSuggestions:{descriptionTextColor:"var(--colorNeutralForeground2)",item:{background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorNoSuggestionsTextColorHover, var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover)))",disabled:"var(--colorNeutralForegroundDisabled)"},actionButtonForeground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)"}},actionButtonForeground:{resting:"var(--editorActionButtonForegroundResting)",hover:"var(--editorActionButtonForegroundHover)",pressed:"var(--editorActionButtonForegroundPressed)",disabled:"var(--editorActionButtonForegroundDisabled)"},shimmer:{shimmerColor:"var(--editorShimmerColor)",shimmerWaveColor:"var(--editorShimmerWaveColor)"},scroll:{thumbColor:"var(--editorScrollThumbColor)"},searchBox:{borderColor:{resting:"var(--editorSearchBoxBorderColorResting)",hover:"var(--editorSearchBoxBorderColorHover)"},borderBottomColor:"var(--editorSearchBoxBorderBottomColor)",iconColor:"var(--editorSearchBoxIconColor)"},tooltip:{directionHint:1},tag:{background:"var(--editorTagBackground)",textColor:"var(--editorTagTextColor)"},meetingBanner:{backgroundColor:"var(--editorMeetingBannerBackgroundColor)",text:"var(--editorMeetingBannerText)",iconPrimaryColor:"var(--editorMeetingBannerIconPrimaryColor)",borderColor:"var(--editorMeetingBannerBorderColor)"}},l=(e,t)=>{var o,i;return t?Object.assign(Object.assign({},a),{branding:e?null===(o=n.no[e])||void 0===o?void 0:o.v9:void 0}):Object.assign(Object.assign({},s),{branding:e?null===(i=n.no[e])||void 0===i?void 0:i.v8[r.SV.light]:void 0})};function c(e,t){const o=Object.assign({},e.background);let i;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,border:i,title:Object.assign({},e.text)}}function u(e,t,o){return e===i.E9?function(e,t){var o,i,n;const r=null===(o=null==e?void 0:e.noSuggestions)||void 0===o?void 0:o.item;if(r){const e=Object.assign(Object.assign({},r.background),{disabled:void 0}),o=Object.assign(Object.assign({},r.text),{focused:r.text.hover});return t&&r.highlighting&&(o.resting=null!==(i=o.focused)&&void 0!==i?i:o.resting,e.resting=r.highlighting),{background:e,title:o,focusRing:"transparent"}}const a=null!=e?e:s,l=Object.assign(Object.assign({},a.background),{disabled:void 0}),c=Object.assign(Object.assign({},a.actionButtonForeground),{focused:a.actionButtonForeground.hover});return t&&a.highlighting&&(c.resting=null!==(n=c.focused)&&void 0!==n?n:c.resting,l.resting=a.highlighting),{background:l,title:c,focusRing:"transparent"}}(t,o):d(null!=t?t:s,o)}function d(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0}),i=Object.assign({},e.text),n=e.altText?Object.assign({},e.altText):void 0;let r;return t&&(e.highlighting&&(o.resting=e.highlighting,r=e.highlightingBorderColor),i.hover&&(i.resting=i.hover),(null==n?void 0:n.hover)&&(n.resting=n.hover)),{background:o,title:i,subtitle:n,focusRing:"transparent",border:r,tooltip:e.tooltip,underline:e.headerUnderlineColor}}function h(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});let i;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,title:e.actionButtonForeground,subtitle:e.altText,focusRing:"transparent",border:i}}function g(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function p(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent",border:"1px solid #D1D1D1"}}function f(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function m(e){return{background:{resting:"transparent",hover:"transparent"},title:e.actionButtonForeground}}function v(e){var t;return{focusRing:null!==(t=e.focusRing)&&void 0!==t?t:"#323130"}}function b(e,t){var o,n,r,a;const l=null!==(o=s.text.disabled)&&void 0!==o?o:s.text.resting;return e.type===i.E9?null!==(r=null===(n=null==t?void 0:t.noSuggestions)||void 0===n?void 0:n.descriptionTextColor)&&void 0!==r?r:l:null!==(a=null==t?void 0:t.text.disabled)&&void 0!==a?a:l}function y(e){var t;return{overflowItem:{resting:e.background.resting,hover:null!==(t=e.background.hover)&&void 0!==t?t:"#F5F5F5"}}}const C=e=>{var t,o;if(e)return Object.assign(Object.assign({},e),{background:null!==(t=e.footerButtonBackground)&&void 0!==t?t:e.background,header:"",subheader:"",dialogText:"",iconText:"",contextText:"",errorText:"",border:"",separator:"",focusRing:null!==(o=e.focusRing)&&void 0!==o?o:"",link:"",linkPressed:"",tag:void 0})},S=(e,t)=>{const o={backgroundColor:e.background.resting};return t&&(o.borderColor="#E1DFDD"),o}},1127:(e,t,o)=>{"use strict";if(o.d(t,{C_:()=>h,ET:()=>u,Eq:()=>f,_s:()=>p,m0:()=>c,m7:()=>g,no:()=>a,pd:()=>d,qv:()=>v,zB:()=>m}),3023==o.j)var i=o(26086);if(3023==o.j)var n=o(43825);if(3023==o.j)var r=o(33638);var s=o(15624);const a={[s.nH.Text]:{v8:{[s.SV.light]:{type:"Text",textColor:"#616161"},[s.SV.dark]:{type:"Text",textColor:"#616161"}},v9:{type:"Text",textColor:"var(--editorTextBrandingTextColor, var(--colorNeutralForeground2))"}},[s.nH.Icon]:{v8:{[s.SV.light]:{type:"Icon",iconColor:"#616161"},[s.SV.dark]:{type:"Icon",iconColor:"#616161"}},v9:{type:"Icon",iconColor:"var(--editorIconBrandingIconColor, var(--colorNeutralForeground2))"}},[s.nH.IconButton]:{v8:{[s.SV.light]:{type:"IconButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#616161",disabled:"#BDBDBD"},focusRing:"#323130"},[s.SV.dark]:{type:"IconButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1"},focusRing:"#323130"}},v9:{type:"IconButton",background:{resting:"var(--editorIconButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconButtonBrandingIconResting, var(--colorNeutralForeground2))",disabled:"var(--editorIconButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconButtonBrandingFocusRing, var(--colorStrokeFocus2))"}},[s.nH.IconAndTextButton]:{v8:{[s.SV.light]:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},[s.SV.dark]:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#6794D7"},title:{resting:"#6794D7"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"}},v9:{type:"IconAndTextButton",background:{resting:"var(--editorIconAndTextButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconAndTextButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconAndTextButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconAndTextButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},title:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconAndTextButtonBrandingFocusRing, var(--colorStrokeFocus2))"}}};function l(e,t){const o=Object.assign({},e);return t&&(null==o?void 0:o.hover)&&(o.resting=o.hover),o}const c=(e,t)=>{var o,i;if(void 0===e)return;e===s.nH.MonochromeIcon&&(e=s.nH.Icon);const n=a[e];if(void 0===n)return;const r=null!==(o=null==t?void 0:t.themeType)&&void 0!==o?o:s.SV.light;return(null==t?void 0:t.useFluentV9)?n.v9:null!==(i=n.v8[r])&&void 0!==i?i:n.v9};function u(e,t,o){const n="Text"===(null==e?void 0:e.type)?e:c(s.nH.Text,o);return{fontWeight:i.IT.SemiBold,fontSize:t.xsmall,cssColor:null==n?void 0:n.textColor}}function d(e,t,o){const r="Text"===(null==e?void 0:e.type)?e:c(s.nH.Text,o);return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:t.small,cssColor:null==r?void 0:r.textColor,userSelectable:!1}}function h(e,t){return("Icon"===(null==e?void 0:e.type)?e:c(s.nH.Icon,t)).iconColor}function g(e,t,o){var i;const n="IconButton"===(null==e?void 0:e.type)?e:c(s.nH.IconButton,o),r=l(n.icon,t);return Object.assign(Object.assign({},n),{background:Object.assign(Object.assign({},n.background),{resting:t&&null!==(i=n.background.hover)&&void 0!==i?i:n.background.resting}),title:r,icon:r,border:t?n.focusRing:void 0})}function p(e,t,o){var i;const n="IconAndTextButton"===(null==e?void 0:e.type)?e:c(s.nH.IconAndTextButton,o);return Object.assign(Object.assign({},n),{background:Object.assign(Object.assign({},n.background),{resting:t&&null!==(i=n.background.hover)&&void 0!==i?i:n.background.resting}),title:l(n.title,t),icon:l(n.icon,t),border:t?n.focusRing:void 0})}function f(e){return{textAlign:r.R.Center,borderRadius:2,iconFontSize:e.xlarge,paddingHorizontal:7,paddingBottom:0,textHorizontalPadding:0,iconTextSpacing:3}}function m(e){return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:e.small}}function v(e){return{textAlign:r.R.Center,borderRadius:4,iconFontSize:e.xsmall}}},8357:(e,t,o)=>{"use strict";function i(e,t){return t<0||e.length<=t?e:e.substring(0,t).concat("")}function n(e){const t=(e=(e=e.replace(/https:\/\//i,"")).replace(/http:\/\//i,"")).indexOf("/");return t>0?e.substring(0,t):e}function r(e,...t){if(t&&Array.isArray(t))for(let o=0;o<t.length;o++)e=e.replace(`{${o}}`,t[o].toString());return e}o.d(t,{EE:()=>i,JT:()=>r,SE:()=>n})},10894:(e,t,o)=>{"use strict";o.d(t,{$d:()=>q,B1:()=>H,B8:()=>re,Bd:()=>K,D0:()=>W,Dd:()=>V,F6:()=>J,GP:()=>E,HV:()=>oe,ID:()=>f,J2:()=>B,JP:()=>v,LO:()=>F,MW:()=>M,Oc:()=>x,Ot:()=>$,P4:()=>j,PN:()=>ue,Ps:()=>te,QL:()=>a,RU:()=>G,VP:()=>b,Vn:()=>S,WC:()=>p,Wi:()=>l,Xp:()=>ie,YV:()=>k,Y_:()=>m,_e:()=>D,cK:()=>I,cq:()=>ce,d4:()=>h,dG:()=>ae,dU:()=>O,db:()=>he,eO:()=>Z,ej:()=>le,gc:()=>s,i6:()=>de,k:()=>_,ki:()=>X,kw:()=>C,lI:()=>w,lT:()=>g,lb:()=>ee,nV:()=>Q,ol:()=>d,qL:()=>A,qw:()=>ne,tJ:()=>T,uI:()=>z,uY:()=>Y,vP:()=>y,vy:()=>u,yl:()=>R,ys:()=>se});var i=o(26086),n=o(33638);if(3023==o.j)var r=o(43825);const s=3,a=16,l=3,c=8,u={background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#F3F2F1"},text:{resting:"#201F1E",disabled:"#A19F9D"},tooltip:{textColor:"#201F1E",backgroundColor:"#FFFFFF"},tag:{resting:"#201F1E"},altText:{resting:"#605E5C"},icon:{resting:"#757470",disabled:"#CCCCCC"},altIcon:{resting:"#616161",hover:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A45B6"},rewriteText:{resting:"#5A45B6"},suggestionMenuHoverBackground:"#E1DFDD",primaryButtonBackground:{resting:"#2E6AC5",hover:"#1651AA",pressed:"#0E336A",disabled:"#F3F2F1"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},header:"#3B3A39",subheader:"#605E5C",dialogText:"#323130",iconText:"#201F1E",contextText:"#201F1E",errorText:"red",border:"#201F1E",separator:"#E6E6E6",focusRing:"#969696",link:"#1651AA",linkPressed:"#002050",addOnFooterBackground:"#F2F6FD",addOnFooterMessage:"#11100F",addOnHeaderBackground:"#ebf3fc",premiumEmphasis:"#2E6AC5",addOnAction:"#2E6AC5",editorIcon:"#185ABD",accessibilityIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",focused:"#1651AA",pressed:"#0E336A"},focusRing:"#323130"},badgeBackground:"#185ABD",badgeText:"#FFFFFF"},d={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},suggestionMenuHoverForeground:"var(--colorNeutralForeground1Hover)",suggestionMenuHoverBackground:"var(--colorNeutralBackground1Hover)",tag:{resting:"var(--editorTagResting)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--editorAltTextResting)",disabled:"var(--colorNeutralForegroundDisabled)"},grammarText:{resting:"var(--editorGrammarTextResting)",hover:"var(--editorGrammarTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},refinementText:{resting:"var(--editorRefinementTextResting)",hover:"var(--editorRefinementTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},rewriteText:{resting:"var(--editorRewriteTextResting)",hover:"var(--editorRewriteTextHover)"},primaryButtonBackground:{resting:"var(--editorPrimaryButtonBackgroundResting)",hover:"var(--editorPrimaryButtonBackgroundHover)",pressed:"var(--editorPrimaryButtonBackgroundPressed)",disabled:"var(--editorPrimaryButtonBackgroundDisabled)"},primaryButtonText:{resting:"var(--editorPrimaryButtonTextResting)",disabled:"var(--editorPrimaryButtonTextDisabled)"},header:"var(--editorHeader)",subheader:"var(--editorSubheader)",dialogText:"var(--editorDialogText)",iconText:"var(--editorIconText)",contextText:"var(--editorContextText)",errorText:"var(--editorErrorText)",border:"var(--editorBorder)",separator:"var(--editorSeparator)",focusRing:"var(--editorFocusRing)",addOnFooterBackground:"var(--editorAddOnFooterBackground)",addOnFooterMessage:"var(--editorAddOnFooterMessage)",addOnHeaderBackground:"var(--editorAddOnHeaderBackground)",premiumEmphasis:"var(--editorPremiumEmphasis)",addOnAction:"var(--editorAddOnAction)",editorIcon:"var(--editorEditorIcon)",accessibilityIcon:"var(--editorAccessibilityIcon)",correctionHighlight:"var(--editorCorrectionHighlight)",helpLink:{text:{resting:"var(--editorHelpLinkTextResting)",hover:"var(--editorHelpLinkTextHover)",focused:"var(--editorHelpLinkTextFocused)",pressed:"var(--editorHelpLinkTextPressed)"},focusRing:"var(--editorHelpLinkFocusRing)"},badgeBackground:"var(--editorBadgeBackground)",badgeText:"var(--editorBadgeText)"},h=(i.RV.Single,n.R.Center,{x4small:7,x3small:8,xxsmall:10,xsmall:12,small:14,medium:16,large:18,xlarge:20,xxlarge:22}),g={xsmall:8,small:12,medium:16},p={paddingHorizontal:a,paddingTop:10,paddingBottom:8},f={paddingHorizontal:a,paddingBottom:8},m={paddingHorizontal:c,paddingVertical:4,gap:4},v={paddingHorizontal:12,paddingVertical:8,backgroundColor:"#EBF3FC",marginTop:4,marginBottom:-8},b={width:32,height:32},y={paddingHorizontal:8,fontSize:12},C={paddingHorizontal:a,flexibleSize:!0};function S(e){var t,o;return Object.assign(Object.assign({},e),{paddingHorizontal:null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:a-c,borderRadius:null!==(o=null==e?void 0:e.borderRadius)&&void 0!==o?o:2})}function w(e){var t;return Object.assign(Object.assign({},e),{borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:2})}n.R.Center;const k={marginTop:14};function T(e,t){return{backgroundColor:null==t?void 0:t.background.resting,minWidth:e?e.minWidth:void 0,maxWidth:e?e.maxWidth:void 0,paddingHorizontal:16,paddingTop:6,paddingBottom:22}}const x={paddingHorizontal:0,paddingVertical:0,borderThickness:0},I={marginHorizontal:a};function _(e,t,o){return{fontWeight:i.IT.SemiBold,fontFamily:r.V,fontSize:t.xsmall,cssColor:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralForeground1)":e.header}}function E(e,t,o){let n=t.xsmall;((null==o?void 0:o.isLargeHeader)||(null==o?void 0:o.isIconHeader))&&(n=(null==o?void 0:o.isLargeHeader)?t.xxlarge:t.xxsmall);const s=(null==o?void 0:o.isIconHeader)?e.iconText:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralForeground2)":e.subheader;return{fontWeight:(null==o?void 0:o.isIconHeader)?i.IT.SemiBold:i.IT.Normal,fontFamily:r.V,fontSize:n,cssColor:s}}function A(e,t){return{fontWeight:i.IT.SemiBold,fontFamily:r.V,fontSize:t.xsmall,cssColor:e.subheader}}function R(e,t){return{cssColor:e.contextText,fontSize:t.small}}function B(e,t){return{cssColor:e.addOnAction,fontSize:t.xlarge,fontWeight:i.IT.SemiBold,marginVertical:6}}function M(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,marginVertical:6,lineHeight:16}}function D(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,lineHeight:16}}function O(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,fontWeight:i.IT.SemiBold,lineHeight:16}}function F(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,lineHeight:16,fontWeight:i.IT.SemiBold,italic:!0}}function P(e,t,o){var i;return"primary"===t&&e.primaryButtonBackground?Object.assign(Object.assign({},e.primaryButtonBackground),{focused:e.primaryButtonBackground.hover}):"dialog"===t?Object.assign(Object.assign({},e.background),{focused:e.background.hover}):o?{resting:null!==(i=e.background.hover)&&void 0!==i?i:"",disabled:void 0}:Object.assign(Object.assign({},e.background),{disabled:void 0})}function N(e,t){return"primary"===t&&e.primaryButtonText?e.primaryButtonText:"grammar"===t&&e.grammarText?e.grammarText:"refinement"===t&&e.refinementText?e.refinementText:e.text}function L(e,t,o){var i;let n=t&&null!==(i=e.altIcon)&&void 0!==i?i:e.icon;return n=n&&Object.assign({},n),o&&(null==n?void 0:n.hover)&&(n.resting=n.hover),n}function j(e,t,o,i){return{background:P(e,t,i),title:N(e,t),tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:L(e,o,i),border:"dialog"===t||"primary"===t?e.border:i?e.focusRing:void 0,focusRing:e.focusRing}}function q(e,t){var o;let i=null!==(o=e.altIcon)&&void 0!==o?o:e.icon;return i=Object.assign(Object.assign({},i),{resting:i.hover}),{background:P(e,void 0,t),title:i,tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:i,border:t?e.focusRing:void 0,focusRing:e.focusRing}}function H(e,t){return Object.assign(Object.assign({},j(e,void 0,!0,t)),{separator:e.separator})}function z(e,t,o){return{minWidth:t?t.minWidth:void 0,maxWidth:t?t.maxWidth:void 0,minHeight:t?t.minHeight:void 0,maxHeight:t?t.maxHeight:void 0,backgroundColor:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralBackground1)":e.background.resting,borderRadius:(null==t?void 0:t.hasBottomAttachment)?{topStart:8,topEnd:8}:8}}function W(e,t,o,n){return[{start:0,length:t,fontWeight:o?i.IT.Normal:i.IT.SemiBold,fontFamily:r.V,fontSize:n||e.small}]}function G(e){return{fontFamily:r.V,fontWeight:i.IT.Normal,fontSize:e.xsmall}}function U(e,t){return[{start:0,length:t,fontWeight:i.IT.Normal,fontFamily:r.V,fontSize:e.small}]}const V=3023==o.j?U:null,$=3023==o.j?U:null;function K(e){return{paddingHorizontal:8,borderRadius:2,iconFontSize:e.medium}}function Q(e){return{paddingHorizontal:8,borderRadius:4,iconFontSize:e.xlarge}}function Y(e,t){var o;return{paddingHorizontal:8,borderRadius:null!==(o=null==t?void 0:t.borderRadius)&&void 0!==o?o:2,iconFontSize:e.xlarge}}function J(e,t){return{fontWeight:i.IT.Normal,fontSize:e.xsmall,cssColor:t.subheader}}function Z(e){return{fontSize:e.xsmall,fontWeight:i.IT.SemiBold}}function X(e){return{color:e.subheader,hoverColor:e.link,pressedColor:e.linkPressed,focusRing:e.focusRing}}function ee(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,fontWeight:i.IT.SemiBold}}function te(e){return{fontWeight:i.IT.Normal,fontSize:e.xxsmall}}function oe(e,t){return{fontWeight:i.IT.SemiBold,fontSize:t.xxsmall,cssColor:e.text.resting}}function ie(){return{lineHeight:20,truncate:!0}}function ne(e,t,o,n){return{fontWeight:i.IT.Normal,fontFamily:r.V,fontSize:n||(t?e.xxsmall:e.xsmall),width:"100%",truncate:!!o,height:14}}function re(e){return{paddingTop:e.small,paddingBottom:3*e.small,paddingHorizontal:e.medium,widths:["91%","96%","71%"]}}function se(e){return{paddingHorizontal:e.xsmall,widths:[5*e.medium]}}function ae(e){var t,o,i,n,r;return{color:null===(t=e.helpLink)||void 0===t?void 0:t.text.resting,hoverColor:null===(o=e.helpLink)||void 0===o?void 0:o.text.hover,focusColor:null===(i=e.helpLink)||void 0===i?void 0:i.text.focused,pressedColor:null===(n=e.helpLink)||void 0===n?void 0:n.text.pressed,focusRing:e.helpLink?null===(r=e.helpLink)||void 0===r?void 0:r.focusRing:e.focusRing}}function le(e){return{fontSize:e.xxsmall}}const ce={marginHorizontal:16,marginVertical:10};function ue(){return{marginVertical:6}}function de(){return{paddingStart:0,paddingEnd:10,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}}function he(){return{paddingStart:10,paddingEnd:0,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}}i.IT.SemiBold,n.R.Center},65541:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>r}),3023==o.j)var i=o(15624);if(3023==o.j)var n=o(82913);function r(e,t,o,r){if(o&&r)for(const s of r)switch(s.decorationType){case n.v.Spelling:{const n=o.substr(s.start,s.length);return t===i.L9.RepeatedWord?e("contextAccessibilityLabelForRepeatedWord").replace("{0}",n).replace("{1}",o):e("contextAccessibilityLabelForSpelling").replace("{0}",n).replace("{1}",o)}case n.v.Grammar:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForGrammar").replace("{0}",t).replace("{1}",o)}case n.v.Refinement:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForRefinement").replace("{0}",t).replace("{1}",o)}case n.v.Modification:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForCorrection").replace("{0}",t).replace("{1}",o)}}}},80427:(e,t,o)=>{"use strict";var i;o.d(t,{h:()=>i}),function(e){e[e.Accept=0]="Accept",e[e.Ignore=1]="Ignore",e[e.Reject=2]="Reject",e[e.OpenEditorSettings=3]="OpenEditorSettings",e[e.DismissRejectMessage=4]="DismissRejectMessage"}(i||(i={}))},71927:e=>{var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},o=-1;t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,o,i,n){void 0===n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==e||null==o)throw new Error("Null input. (diff_main)");if(e==o)return e?[new t.Diff(0,e)]:[];void 0===i&&(i=!0);var s=i,a=this.diff_commonPrefix(e,o),l=e.substring(0,a);e=e.substring(a),o=o.substring(a),a=this.diff_commonSuffix(e,o);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),o=o.substring(0,o.length-a);var u=this.diff_compute_(e,o,s,r);return l&&u.unshift(new t.Diff(0,l)),c&&u.push(new t.Diff(0,c)),this.diff_cleanupMerge(u),u},t.prototype.diff_compute_=function(e,i,n,r){var s;if(!e)return[new t.Diff(1,i)];if(!i)return[new t.Diff(o,e)];var a=e.length>i.length?e:i,l=e.length>i.length?i:e,c=a.indexOf(l);if(-1!=c)return s=[new t.Diff(1,a.substring(0,c)),new t.Diff(0,l),new t.Diff(1,a.substring(c+l.length))],e.length>i.length&&(s[0][0]=s[2][0]=o),s;if(1==l.length)return[new t.Diff(o,e),new t.Diff(1,i)];var u=this.diff_halfMatch_(e,i);if(u){var d=u[0],h=u[1],g=u[2],p=u[3],f=u[4],m=this.diff_main(d,g,n,r),v=this.diff_main(h,p,n,r);return m.concat([new t.Diff(0,f)],v)}return n&&e.length>100&&i.length>100?this.diff_lineMode_(e,i,r):this.diff_bisect_(e,i,r)},t.prototype.diff_lineMode_=function(e,i,n){var r=this.diff_linesToChars_(e,i);e=r.chars1,i=r.chars2;var s=r.lineArray,a=this.diff_main(e,i,!1,n);this.diff_charsToLines_(a,s),this.diff_cleanupSemantic(a),a.push(new t.Diff(0,""));for(var l=0,c=0,u=0,d="",h="";l<a.length;){switch(a[l][0]){case 1:u++,h+=a[l][1];break;case o:c++,d+=a[l][1];break;case 0:if(c>=1&&u>=1){a.splice(l-c-u,c+u),l=l-c-u;for(var g=this.diff_main(d,h,!1,n),p=g.length-1;p>=0;p--)a.splice(l,0,g[p]);l+=g.length}u=0,c=0,d="",h=""}l++}return a.pop(),a},t.prototype.diff_bisect_=function(e,i,n){for(var r=e.length,s=i.length,a=Math.ceil((r+s)/2),l=a,c=2*a,u=new Array(c),d=new Array(c),h=0;h<c;h++)u[h]=-1,d[h]=-1;u[l+1]=0,d[l+1]=0;for(var g=r-s,p=g%2!=0,f=0,m=0,v=0,b=0,y=0;y<a&&!((new Date).getTime()>n);y++){for(var C=-y+f;C<=y-m;C+=2){for(var S=l+C,w=(_=C==-y||C!=y&&u[S-1]<u[S+1]?u[S+1]:u[S-1]+1)-C;_<r&&w<s&&e.charAt(_)==i.charAt(w);)_++,w++;if(u[S]=_,_>r)m+=2;else if(w>s)f+=2;else if(p&&(x=l+g-C)>=0&&x<c&&-1!=d[x]&&_>=(T=r-d[x]))return this.diff_bisectSplit_(e,i,_,w,n)}for(var k=-y+v;k<=y-b;k+=2){for(var T,x=l+k,I=(T=k==-y||k!=y&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-k;T<r&&I<s&&e.charAt(r-T-1)==i.charAt(s-I-1);)T++,I++;if(d[x]=T,T>r)b+=2;else if(I>s)v+=2;else if(!p){var _;if((S=l+g-k)>=0&&S<c&&-1!=u[S])if(w=l+(_=u[S])-S,_>=(T=r-T))return this.diff_bisectSplit_(e,i,_,w,n)}}}return[new t.Diff(o,e),new t.Diff(1,i)]},t.prototype.diff_bisectSplit_=function(e,t,o,i,n){var r=e.substring(0,o),s=t.substring(0,i),a=e.substring(o),l=t.substring(i),c=this.diff_main(r,s,!1,n),u=this.diff_main(a,l,!1,n);return c.concat(u)},t.prototype.diff_linesToChars_=function(e,t){var o=[],i={};function n(e){for(var t="",n=0,s=-1,a=o.length;s<e.length-1;){-1==(s=e.indexOf("\n",n))&&(s=e.length-1);var l=e.substring(n,s+1);(i.hasOwnProperty?i.hasOwnProperty(l):void 0!==i[l])?t+=String.fromCharCode(i[l]):(a==r&&(l=e.substring(n),s=e.length),t+=String.fromCharCode(a),i[l]=a,o[a++]=l),n=s+1}return t}o[0]="";var r=4e4,s=n(e);return r=65535,{chars1:s,chars2:n(t),lineArray:o}},t.prototype.diff_charsToLines_=function(e,t){for(var o=0;o<e.length;o++){for(var i=e[o][1],n=[],r=0;r<i.length;r++)n[r]=t[i.charCodeAt(r)];e[o][1]=n.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var o=0,i=Math.min(e.length,t.length),n=i,r=0;o<n;)e.substring(r,n)==t.substring(r,n)?r=o=n:i=n,n=Math.floor((i-o)/2+o);return n},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var o=0,i=Math.min(e.length,t.length),n=i,r=0;o<n;)e.substring(e.length-n,e.length-r)==t.substring(t.length-n,t.length-r)?r=o=n:i=n,n=Math.floor((i-o)/2+o);return n},t.prototype.diff_commonOverlap_=function(e,t){var o=e.length,i=t.length;if(0==o||0==i)return 0;o>i?e=e.substring(o-i):o<i&&(t=t.substring(0,o));var n=Math.min(o,i);if(e==t)return n;for(var r=0,s=1;;){var a=e.substring(n-s),l=t.indexOf(a);if(-1==l)return r;s+=l,0!=l&&e.substring(n-s)!=t.substring(0,s)||(r=s,s++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var o=e.length>t.length?e:t,i=e.length>t.length?t:e;if(o.length<4||2*i.length<o.length)return null;var n=this;function r(e,t,o){for(var i,r,s,a,l=e.substring(o,o+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var d=n.diff_commonPrefix(e.substring(o),t.substring(c)),h=n.diff_commonSuffix(e.substring(0,o),t.substring(0,c));u.length<h+d&&(u=t.substring(c-h,c)+t.substring(c,c+d),i=e.substring(0,o-h),r=e.substring(o+d),s=t.substring(0,c-h),a=t.substring(c+d))}return 2*u.length>=e.length?[i,r,s,a,u]:null}var s,a,l,c,u,d=r(o,i,Math.ceil(o.length/4)),h=r(o,i,Math.ceil(o.length/2));return d||h?(s=h?d&&d[4].length>h[4].length?d:h:d,e.length>t.length?(a=s[0],l=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],a=s[2],l=s[3]),[a,l,c,u,s[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var i=!1,n=[],r=0,s=null,a=0,l=0,c=0,u=0,d=0;a<e.length;)0==e[a][0]?(n[r++]=a,l=u,c=d,u=0,d=0,s=e[a][1]):(1==e[a][0]?u+=e[a][1].length:d+=e[a][1].length,s&&s.length<=Math.max(l,c)&&s.length<=Math.max(u,d)&&(e.splice(n[r-1],0,new t.Diff(o,s)),e[n[r-1]+1][0]=1,r--,a=--r>0?n[r-1]:-1,l=0,c=0,u=0,d=0,s=null,i=!0)),a++;for(i&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]==o&&1==e[a][0]){var h=e[a-1][1],g=e[a][1],p=this.diff_commonOverlap_(h,g),f=this.diff_commonOverlap_(g,h);p>=f?(p>=h.length/2||p>=g.length/2)&&(e.splice(a,0,new t.Diff(0,g.substring(0,p))),e[a-1][1]=h.substring(0,h.length-p),e[a+1][1]=g.substring(p),a++):(f>=h.length/2||f>=g.length/2)&&(e.splice(a,0,new t.Diff(0,h.substring(0,f))),e[a-1][0]=1,e[a-1][1]=g.substring(0,g.length-f),e[a+1][0]=o,e[a+1][1]=h.substring(f),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){function o(e,o){if(!e||!o)return 6;var i=e.charAt(e.length-1),n=o.charAt(0),r=i.match(t.nonAlphaNumericRegex_),s=n.match(t.nonAlphaNumericRegex_),a=r&&i.match(t.whitespaceRegex_),l=s&&n.match(t.whitespaceRegex_),c=a&&i.match(t.linebreakRegex_),u=l&&n.match(t.linebreakRegex_),d=c&&e.match(t.blanklineEndRegex_),h=u&&o.match(t.blanklineStartRegex_);return d||h?5:c||u?4:r&&!a&&l?3:a||l?2:r||s?1:0}for(var i=1;i<e.length-1;){if(0==e[i-1][0]&&0==e[i+1][0]){var n=e[i-1][1],r=e[i][1],s=e[i+1][1],a=this.diff_commonSuffix(n,r);if(a){var l=r.substring(r.length-a);n=n.substring(0,n.length-a),r=l+r.substring(0,r.length-a),s=l+s}for(var c=n,u=r,d=s,h=o(n,r)+o(r,s);r.charAt(0)===s.charAt(0);){n+=r.charAt(0),r=r.substring(1)+s.charAt(0),s=s.substring(1);var g=o(n,r)+o(r,s);g>=h&&(h=g,c=n,u=r,d=s)}e[i-1][1]!=c&&(c?e[i-1][1]=c:(e.splice(i-1,1),i--),e[i][1]=u,d?e[i+1][1]=d:(e.splice(i+1,1),i--))}i++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var i=!1,n=[],r=0,s=null,a=0,l=!1,c=!1,u=!1,d=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(u||d)?(n[r++]=a,l=u,c=d,s=e[a][1]):(r=0,s=null),u=d=!1):(e[a][0]==o?d=!0:u=!0,s&&(l&&c&&u&&d||s.length<this.Diff_EditCost/2&&l+c+u+d==3)&&(e.splice(n[r-1],0,new t.Diff(o,s)),e[n[r-1]+1][0]=1,r--,s=null,l&&c?(u=d=!0,r=0):(a=--r>0?n[r-1]:-1,u=d=!1),i=!0)),a++;i&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var i,n=0,r=0,s=0,a="",l="";n<e.length;)switch(e[n][0]){case 1:s++,l+=e[n][1],n++;break;case o:r++,a+=e[n][1],n++;break;case 0:r+s>1?(0!==r&&0!==s&&(0!==(i=this.diff_commonPrefix(l,a))&&(n-r-s>0&&0==e[n-r-s-1][0]?e[n-r-s-1][1]+=l.substring(0,i):(e.splice(0,0,new t.Diff(0,l.substring(0,i))),n++),l=l.substring(i),a=a.substring(i)),0!==(i=this.diff_commonSuffix(l,a))&&(e[n][1]=l.substring(l.length-i)+e[n][1],l=l.substring(0,l.length-i),a=a.substring(0,a.length-i))),n-=r+s,e.splice(n,r+s),a.length&&(e.splice(n,0,new t.Diff(o,a)),n++),l.length&&(e.splice(n,0,new t.Diff(1,l)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,s=0,r=0,a="",l=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),c=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),c=!0)),n++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var i,n=0,r=0,s=0,a=0;for(i=0;i<e.length&&(1!==e[i][0]&&(n+=e[i][1].length),e[i][0]!==o&&(r+=e[i][1].length),!(n>t));i++)s=n,a=r;return e.length!=i&&e[i][0]===o?a:a+(t-s)},t.prototype.diff_prettyHtml=function(e){for(var t=[],i=/&/g,n=/</g,r=/>/g,s=/\n/g,a=0;a<e.length;a++){var l=e[a][0],c=e[a][1].replace(i,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(s,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case o:t[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[a]="<span>"+c+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],o=0;o<e.length;o++)1!==e[o][0]&&(t[o]=e[o][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==o&&(t[i]=e[i][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,i=0,n=0,r=0;r<e.length;r++){var s=e[r][0],a=e[r][1];switch(s){case 1:i+=a.length;break;case o:n+=a.length;break;case 0:t+=Math.max(i,n),i=0,n=0}}return t+Math.max(i,n)},t.prototype.diff_toDelta=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i][0]){case 1:t[i]="+"+encodeURI(e[i][1]);break;case o:t[i]="-"+e[i][1].length;break;case 0:t[i]="="+e[i][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,i){for(var n=[],r=0,s=0,a=i.split(/\t/g),l=0;l<a.length;l++){var c=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{n[r++]=new t.Diff(1,decodeURI(c))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var u=parseInt(c,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(s,s+=u);"="==a[l].charAt(0)?n[r++]=new t.Diff(0,d):n[r++]=new t.Diff(o,d);break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(s!=e.length)throw new Error("Delta length ("+s+") does not equal source text length ("+e.length+").");return n},t.prototype.match_main=function(e,t,o){if(null==e||null==t||null==o)throw new Error("Null input. (match_main)");return o=Math.max(0,Math.min(o,e.length)),e==t?0:e.length?e.substring(o,o+t.length)==t?o:this.match_bitap_(e,t,o):-1},t.prototype.match_bitap_=function(e,t,o){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(t),n=this;function r(e,i){var r=e/t.length,s=Math.abs(o-i);return n.Match_Distance?r+s/n.Match_Distance:s?1:r}var s=this.Match_Threshold,a=e.indexOf(t,o);-1!=a&&(s=Math.min(r(0,a),s),-1!=(a=e.lastIndexOf(t,o+t.length))&&(s=Math.min(r(0,a),s)));var l,c,u=1<<t.length-1;a=-1;for(var d,h=t.length+e.length,g=0;g<t.length;g++){for(l=0,c=h;l<c;)r(g,o+c)<=s?l=c:h=c,c=Math.floor((h-l)/2+l);h=c;var p=Math.max(1,o-c+1),f=Math.min(o+c,e.length)+t.length,m=Array(f+2);m[f+1]=(1<<g)-1;for(var v=f;v>=p;v--){var b=i[e.charAt(v-1)];if(m[v]=0===g?(m[v+1]<<1|1)&b:(m[v+1]<<1|1)&b|(d[v+1]|d[v])<<1|1|d[v+1],m[v]&u){var y=r(g,v-1);if(y<=s){if(s=y,!((a=v-1)>o))break;p=Math.max(1,2*o-a)}}}if(r(g+1,o)>s)break;d=m}return a},t.prototype.match_alphabet_=function(e){for(var t={},o=0;o<e.length;o++)t[e.charAt(o)]=0;for(o=0;o<e.length;o++)t[e.charAt(o)]|=1<<e.length-o-1;return t},t.prototype.patch_addContext_=function(e,o){if(0!=o.length){if(null===e.start2)throw Error("patch not initialized");for(var i=o.substring(e.start2,e.start2+e.length1),n=0;o.indexOf(i)!=o.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=o.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var r=o.substring(e.start2-n,e.start2);r&&e.diffs.unshift(new t.Diff(0,r));var s=o.substring(e.start2+e.length1,e.start2+e.length1+n);s&&e.diffs.push(new t.Diff(0,s)),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+s.length,e.length2+=r.length+s.length}},t.prototype.patch_make=function(e,i,n){var r,s;if("string"==typeof e&&"string"==typeof i&&void 0===n)r=e,(s=this.diff_main(r,i,!0)).length>2&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(e&&"object"==typeof e&&void 0===i&&void 0===n)s=e,r=this.diff_text1(s);else if("string"==typeof e&&i&&"object"==typeof i&&void 0===n)r=e,s=i;else{if("string"!=typeof e||"string"!=typeof i||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,s=n}if(0===s.length)return[];for(var a=[],l=new t.patch_obj,c=0,u=0,d=0,h=r,g=r,p=0;p<s.length;p++){var f=s[p][0],m=s[p][1];switch(c||0===f||(l.start1=u,l.start2=d),f){case 1:l.diffs[c++]=s[p],l.length2+=m.length,g=g.substring(0,d)+m+g.substring(d);break;case o:l.length1+=m.length,l.diffs[c++]=s[p],g=g.substring(0,d)+g.substring(d+m.length);break;case 0:m.length<=2*this.Patch_Margin&&c&&s.length!=p+1?(l.diffs[c++]=s[p],l.length1+=m.length,l.length2+=m.length):m.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(l,h),a.push(l),l=new t.patch_obj,c=0,h=g,u=d)}1!==f&&(u+=m.length),f!==o&&(d+=m.length)}return c&&(this.patch_addContext_(l,h),a.push(l)),a},t.prototype.patch_deepCopy=function(e){for(var o=[],i=0;i<e.length;i++){var n=e[i],r=new t.patch_obj;r.diffs=[];for(var s=0;s<n.diffs.length;s++)r.diffs[s]=new t.Diff(n.diffs[s][0],n.diffs[s][1]);r.start1=n.start1,r.start2=n.start2,r.length1=n.length1,r.length2=n.length2,o[i]=r}return o},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var i=this.patch_addPadding(e);t=i+t+i,this.patch_splitMax(e);for(var n=0,r=[],s=0;s<e.length;s++){var a,l,c=e[s].start2+n,u=this.diff_text1(e[s].diffs),d=-1;if(u.length>this.Match_MaxBits?-1!=(a=this.match_main(t,u.substring(0,this.Match_MaxBits),c))&&(-1==(d=this.match_main(t,u.substring(u.length-this.Match_MaxBits),c+u.length-this.Match_MaxBits))||a>=d)&&(a=-1):a=this.match_main(t,u,c),-1==a)r[s]=!1,n-=e[s].length2-e[s].length1;else if(r[s]=!0,n=a-c,u==(l=-1==d?t.substring(a,a+u.length):t.substring(a,d+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[s].diffs)+t.substring(a+u.length);else{var h=this.diff_main(u,l,!1);if(u.length>this.Match_MaxBits&&this.diff_levenshtein(h)/u.length>this.Patch_DeleteThreshold)r[s]=!1;else{this.diff_cleanupSemanticLossless(h);for(var g,p=0,f=0;f<e[s].diffs.length;f++){var m=e[s].diffs[f];0!==m[0]&&(g=this.diff_xIndex(h,p)),1===m[0]?t=t.substring(0,a+g)+m[1]+t.substring(a+g):m[0]===o&&(t=t.substring(0,a+g)+t.substring(a+this.diff_xIndex(h,p+m[1].length))),m[0]!==o&&(p+=m[1].length)}}}}return[t=t.substring(i.length,t.length-i.length),r]},t.prototype.patch_addPadding=function(e){for(var o=this.Patch_Margin,i="",n=1;n<=o;n++)i+=String.fromCharCode(n);for(n=0;n<e.length;n++)e[n].start1+=o,e[n].start2+=o;var r=e[0],s=r.diffs;if(0==s.length||0!=s[0][0])s.unshift(new t.Diff(0,i)),r.start1-=o,r.start2-=o,r.length1+=o,r.length2+=o;else if(o>s[0][1].length){var a=o-s[0][1].length;s[0][1]=i.substring(s[0][1].length)+s[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}return 0==(s=(r=e[e.length-1]).diffs).length||0!=s[s.length-1][0]?(s.push(new t.Diff(0,i)),r.length1+=o,r.length2+=o):o>s[s.length-1][1].length&&(a=o-s[s.length-1][1].length,s[s.length-1][1]+=i.substring(0,a),r.length1+=a,r.length2+=a),i},t.prototype.patch_splitMax=function(e){for(var i=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=i)){var r=e[n];e.splice(n--,1);for(var s=r.start1,a=r.start2,l="";0!==r.diffs.length;){var c=new t.patch_obj,u=!0;for(c.start1=s-l.length,c.start2=a-l.length,""!==l&&(c.length1=c.length2=l.length,c.diffs.push(new t.Diff(0,l)));0!==r.diffs.length&&c.length1<i-this.Patch_Margin;){var d=r.diffs[0][0],h=r.diffs[0][1];1===d?(c.length2+=h.length,a+=h.length,c.diffs.push(r.diffs.shift()),u=!1):d===o&&1==c.diffs.length&&0==c.diffs[0][0]&&h.length>2*i?(c.length1+=h.length,s+=h.length,u=!1,c.diffs.push(new t.Diff(d,h)),r.diffs.shift()):(h=h.substring(0,i-c.length1-this.Patch_Margin),c.length1+=h.length,s+=h.length,0===d?(c.length2+=h.length,a+=h.length):u=!1,c.diffs.push(new t.Diff(d,h)),h==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(h.length))}l=(l=this.diff_text2(c.diffs)).substring(l.length-this.Patch_Margin);var g=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==g&&(c.length1+=g.length,c.length2+=g.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=g:c.diffs.push(new t.Diff(0,g))),u||e.splice(++n,0,c)}}},t.prototype.patch_toText=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=e[o];return t.join("")},t.prototype.patch_fromText=function(e){var i=[];if(!e)return i;for(var n=e.split("\n"),r=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var a=n[r].match(s);if(!a)throw new Error("Invalid patch string: "+n[r]);var l=new t.patch_obj;for(i.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),r++;r<n.length;){var c=n[r].charAt(0);try{var u=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+u)}if("-"==c)l.diffs.push(new t.Diff(o,u));else if("+"==c)l.diffs.push(new t.Diff(1,u));else if(" "==c)l.diffs.push(new t.Diff(0,u));else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+u)}r++}}return i},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:e="+";break;case o:e="-";break;case 0:e=" "}t[i+1]=e+encodeURI(this.diffs[i][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=o,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},51049:e=>{"use strict";var t=Object.prototype.hasOwnProperty,o="~";function i(){}function n(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function r(e,t,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,r||e,s),l=o?o+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),a.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(o?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=o?o+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,r=i.length,s=new Array(r);n<r;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(e){var t=o?o+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,n,r,s){var a=o?o+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,r),!0;case 6:return u.fn.call(u.context,t,i,n,r,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,g=u.length;for(c=0;c<g;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,n);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,o){return r(this,e,t,o,!1)},a.prototype.once=function(e,t,o){return r(this,e,t,o,!0)},a.prototype.removeListener=function(e,t,i,n){var r=o?o+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||n&&!a.once||i&&a.context!==i||s(this,r);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[r]=1===c.length?c[0]:c:s(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=o,a.EventEmitter=a,e.exports=a},44109:e=>{"use strict";e.exports=function e(t,o){if(t===o)return!0;if(t&&o&&"object"==typeof t&&"object"==typeof o){if(t.constructor!==o.constructor)return!1;var i,n,r;if(Array.isArray(t)){if((i=t.length)!=o.length)return!1;for(n=i;0!=n--;)if(!e(t[n],o[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(o).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(o,r[n]))return!1;for(n=i;0!=n--;){var s=r[n];if(!e(t[s],o[s]))return!1}return!0}return t!=t&&o!=o}},59096:(e,t,o)=>{var i=null;"undefined"!=typeof WebSocket?i=WebSocket:"undefined"!=typeof MozWebSocket?i=MozWebSocket:void 0!==o.g?i=o.g.WebSocket||o.g.MozWebSocket:"undefined"!=typeof window?i=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(i=self.WebSocket||self.MozWebSocket),e.exports=i},70398:(e,t,o)=>{"use strict";o.d(t,{Az:()=>Re,CP:()=>s,GD:()=>u,S:()=>Ae,U6:()=>X,_A:()=>Ee,h7:()=>n,hC:()=>Me,iA:()=>a,mz:()=>Be});var i=o(13327);const n="data-tabster",r=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]","details > summary","audio[controls]","video[controls]"].join(", "),s={Source:0,Target:1},a={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4};function l(e,t){var o;return null===(o=e.storageEntry(t))||void 0===o?void 0:o.tabster}function c(e,t,o){var i,r;const s=o||e._noop?void 0:t.getAttribute(n);let a,l=e.storageEntry(t);if(s){if(s===(null===(i=null==l?void 0:l.attr)||void 0===i?void 0:i.string))return;try{const e=JSON.parse(s);if("object"!=typeof e)throw new Error(`Value is not a JSON object, got '${s}'.`);a={string:s,object:e}}catch(e){}}else if(!l)return;l||(l=e.storageEntry(t,!0)),l.tabster||(l.tabster={});const c=l.tabster||{},u=(null===(r=l.attr)||void 0===r?void 0:r.object)||{},d=(null==a?void 0:a.object)||{};for(const o of Object.keys(u))if(!d[o]){if("root"===o){const t=c[o];t&&e.root.onRoot(t,!0)}switch(o){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":const i=c[o];i&&(i.dispose(),delete c[o]);break;case"observed":delete c[o],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete c[o]}}for(const o of Object.keys(d)){const i=d.sys;switch(o){case"deloser":c.deloser?c.deloser.setProps(d.deloser):e.deloser&&(c.deloser=e.deloser.createDeloser(t,d.deloser));break;case"root":c.root?c.root.setProps(d.root):c.root=e.root.createRoot(t,d.root,i),e.root.onRoot(c.root);break;case"modalizer":c.modalizer?c.modalizer.setProps(d.modalizer):e.modalizer&&(c.modalizer=e.modalizer.createModalizer(t,d.modalizer,i));break;case"restorer":c.restorer?c.restorer.setProps(d.restorer):e.restorer&&d.restorer&&(c.restorer=e.restorer.createRestorer(t,d.restorer));break;case"focusable":c.focusable=d.focusable;break;case"groupper":c.groupper?c.groupper.setProps(d.groupper):e.groupper&&(c.groupper=e.groupper.createGroupper(t,d.groupper,i));break;case"mover":c.mover?c.mover.setProps(d.mover):e.mover&&(c.mover=e.mover.createMover(t,d.mover,i));break;case"observed":e.observedElement&&(c.observed=d.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":c.uncontrolled=d.uncontrolled;break;case"outline":e.outline&&(c.outline=d.outline);break;case"sys":c.sys=d.sys;break;default:console.error(`Unknown key '${o}' in data-tabster attribute value.`)}}a?l.attr=a:(0===Object.keys(c).length&&(delete l.tabster,delete l.attr),e.storageEntry(t,!1))}const u="tabster:movefocus",d="tabster:mover:movefocus",h="tabster:mover:memorized-element",g="tabster:restorer:restore-focus",p="undefined"!=typeof CustomEvent?CustomEvent:function(){};class f extends p{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class m extends f{constructor(e){super("tabster:focusin",e)}}class v extends f{constructor(e){super("tabster:focusout",e)}}class b extends f{constructor(e){super(u,e)}}class y extends f{constructor(e){super("tabster:mover:state",e)}}class C extends f{constructor(e){super("tabster:modalizer:active",e)}}class S extends f{constructor(e){super("tabster:modalizer:inactive",e)}}class w extends f{constructor(){super(g)}}class k extends f{constructor(e){super("tabster:root:focus",e)}}class T extends f{constructor(e){super("tabster:root:blur",e)}}const x={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,o,i)=>e.createTreeWalker(t,o,i),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!(!t||!(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,o)=>e.insertBefore(t,o),getSelection:e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.getSelection())||null},getElementsByName:(e,t)=>e.ownerDocument.getElementsByName(t)};let I;const _="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,o,i){this.left=e||0,this.top=t||0,this.right=(e||0)+(o||0),this.bottom=(t||0)+(i||0)}};let E=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),I=!1}catch(e){I=!0}function A(e){const t=e();let o=t.__tabsterInstanceContext;return o||(o={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=o),o}class R{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&H(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class B{constructor(e,t,o){const i=A(e);let n;i.WeakRef?n=new i.WeakRef(t):(n=new R(t),i.fakeWeakRefs.push(n)),this._ref=n,this._data=o}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function M(e,t){const o=A(e);o.fakeWeakRefs=o.fakeWeakRefs.filter((e=>!R.cleanup(e,t)))}function D(e){const t=A(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout((()=>{t.fakeWeakRefsTimer=void 0,M(e),D(e)}),12e4))}function O(e,t,o){if(t.nodeType!==Node.ELEMENT_NODE)return;const i=I?o:{acceptNode:o};return x.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,i,!1)}function F(e,t){let o=t.__tabsterCacheId;const i=A(e),n=o?i.containerBoundingRectCache[o]:void 0;if(n)return n.rect;const r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new _;let s=0,a=0,l=r.clientWidth,c=r.clientHeight;if(t!==r){const e=t.getBoundingClientRect();s=Math.max(s,e.left),a=Math.max(a,e.top),l=Math.min(l,e.right),c=Math.min(c,e.bottom)}const u=new _(s<l?s:-1,a<c?a:-1,s<l?l-s:0,a<c?c-a:0);return o||(o="r-"+ ++i.lastContainerBoundingRectCacheId,t.__tabsterCacheId=o),i.containerBoundingRectCache[o]={rect:u,element:t},i.containerBoundingRectCacheTimer||(i.containerBoundingRectCacheTimer=window.setTimeout((()=>{i.containerBoundingRectCacheTimer=void 0;for(const e of Object.keys(i.containerBoundingRectCache))delete i.containerBoundingRectCache[e].element.__tabsterCacheId;i.containerBoundingRectCache={}}),50)),u}function P(e,t,o){const i=N(t);if(!i)return!1;const n=F(e,i),r=t.getBoundingClientRect(),s=r.height*(1-o),a=Math.max(0,n.top-r.top)+Math.max(0,r.bottom-n.bottom);return 0===a||a<=s}function N(e){const t=e.ownerDocument;if(t){for(let t=x.getParentElement(e);t;t=x.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function L(e){return!!e.__shouldIgnoreFocus}function j(e,t){const o=A(e);let i=t.__tabsterElementUID;return i||(i=t.__tabsterElementUID=function(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();const o=[];for(let e=0;e<t.length;e++)o.push(t[e].toString(36));return o.push("|"),o.push((++E).toString(36)),o.push("|"),o.push(Date.now().toString(36)),o.join("")}(e())),!o.elementByUId[i]&&H(t.ownerDocument,t)&&(o.elementByUId[i]=new B(e,t)),i}function q(e,t){const o=A(e);for(const e of Object.keys(o.elementByUId)){const i=o.elementByUId[e],n=i&&i.get();n&&t&&!x.nodeContains(t,n)||delete o.elementByUId[e]}}function H(e,t){return x.nodeContains(null==e?void 0:e.body,t)}function z(e,t){const o=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return o&&o.call(e,t)}let W=0;class G{constructor(e,t,o){const i=e.getWindow;this._tabster=e,this._element=new B(i,t),this._props={...o},this.id="i"+ ++W}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class U{constructor(e,t,o,n,r){var s;this._focusIn=e=>{if(this._fixedTarget){const e=this._fixedTarget.get();return void(e&&(0,i.kG)(e))}const t=this.input;if(this.onFocusIn&&t){const o=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,o),o)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const o=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,o),o)}};const a=e(),l=a.document.createElement("i");l.tabIndex=0,l.setAttribute("role","none"),l.setAttribute("data-tabster-dummy",""),l.setAttribute("aria-hidden","true");const c=l.style;c.position="fixed",c.width=c.height="1px",c.opacity="0.001",c.zIndex="-1",c.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(l),this.input=l,this.isFirst=o.isFirst,this.isOutside=t,this._isPhantom=null!==(s=o.isPhantom)&&void 0!==s&&s,this._fixedTarget=r,l.addEventListener("focusin",this._focusIn),l.addEventListener("focusout",this._focusOut),l.__tabsterDummyContainer=n,this._isPhantom&&(this._disposeTimer=a.setTimeout((()=>{delete this._disposeTimer,this.dispose()}),0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(a.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=x.getParentNode(t))||void 0===e||e.removeChild(t))}setTopLeft(e,t){var o;const i=null===(o=this.input)||void 0===o?void 0:o.style;i&&(i.top=`${e}px`,i.left=`${t}px`)}_isBackward(e,t,o){return e&&!o?!this.isFirst:!!(o&&t.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING)}}class V{constructor(e,t,o,i,n,r){this._element=t,this._instance=new K(e,t,this,o,i,n,r)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null===(t=this._instance)||void 0===t||t.moveOut(e)}moveOutWithDefaultAction(e,t){var o;null===(o=this._instance)||void 0===o||o.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,o,n,r){const s=new U(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(s){let a,l;if("BODY"===t.tagName)a=t,l=o&&n||!o&&!n?x.getFirstElementChild(t):null;else{let i,r;o&&(!n||n&&!e.focusable.isFocusable(t,!1,!0,!0))?(a=t,l=n?t.firstElementChild:null):(a=x.getParentElement(t),l=o&&n||!o&&!n?t:x.getNextElementSibling(t));do{i=o&&n||!o&&!n?x.getPreviousElementSibling(l):l,r=Z(i),r===t?l=o&&n||!o&&!n?i:x.getNextElementSibling(i):r=null}while(r)}(null==a?void 0:a.dispatchEvent(new b({by:"root",owner:a,next:null,relatedEvent:r})))&&(x.insertBefore(a,s,l),(0,i.kG)(s))}}static addPhantomDummyWithTarget(e,t,o,i){const n=new U(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new B(e.getWindow,i)).input;if(n){let e,i;t.querySelector(r)&&!o?(e=t,i=x.getFirstElementChild(t)):(e=x.getParentElement(t),i=o?t:x.getNextElementSibling(t)),e&&x.insertBefore(e,n,i)}}}class ${constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout((()=>{delete this._updateDummyInputsTimer;for(const e of this._dummyElements){const t=e.get();if(t){const e=this._dummyCallbacks.get(t);if(e){const o=x.getParentNode(t);o&&!this._changedParents.has(o)||e()}}}this._changedParents=new WeakSet}),100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new B(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter((t=>{const o=t.get();return o&&o!==e})),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null===(e=this._win)||void 0===e?void 0:e.call(this).setTimeout((()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){const e=new Map,t=[];for(const o of this._updateQueue)t.push(o(e));this._updateQueue.clear();for(const e of t)e();e.clear()}else this._scheduledUpdatePositions()}),100))}}class K{constructor(e,t,o,n,r,s,a){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,o)=>{this._onFocus(!0,e,t,o)},this._onFocusOut=(e,t,o)=>{this._onFocus(!1,e,t,o)},this.moveOut=e=>{var t;const o=this._firstDummy,n=this._lastDummy;if(o&&n){this._ensurePosition();const r=o.input,s=n.input,a=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&s&&a){let t;e?(r.tabIndex=0,t=r):(s.tabIndex=0,t=s),t&&(0,i.kG)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var o;const n=this._firstDummy,r=this._lastDummy;if(n&&r){this._ensurePosition();const s=n.input,a=r.input,l=null===(o=this._element)||void 0===o?void 0:o.get();if(s&&a&&l){let o;e?!n.isOutside&&this._tabster.focusable.isFocusable(l,!0,!0,!0)?o=l:(n.useDefaultAction=!0,s.tabIndex=0,o=s):(r.useDefaultAction=!0,a.tabIndex=0,o=a),o&&l.dispatchEvent(new b({by:"root",owner:l,next:null,relatedEvent:t}))&&(0,i.kG)(o)}}},this.setTabbable=(e,t)=>{var o,i;for(const o of this._wrappers)if(o.manager===e){o.tabbable=t;break}const n=this._getCurrent();if(n){const e=n.tabbable?0:-1;let t=null===(o=this._firstDummy)||void 0===o?void 0:o.input;t&&(t.tabIndex=e),t=null===(i=this._lastDummy)||void 0===i?void 0:i.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout((()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()}),0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,o;const i=(null===(t=this._firstDummy)||void 0===t?void 0:t.input)||(null===(o=this._lastDummy)||void 0===o?void 0:o.input),n=this._transformElements,r=new Set;let s=0,a=0;const l=this._getWindow();for(let t=i;t&&t.nodeType===Node.ELEMENT_NODE;t=x.getParentElement(t)){let o=e.get(t);if(void 0===o){const i=l.getComputedStyle(t).transform;i&&"none"!==i&&(o={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,o||null)}o&&(r.add(t),n.has(t)||t.addEventListener("scroll",this._addTransformOffsets),s+=o.scrollTop,a+=o.scrollLeft)}for(const e of n)r.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=r,()=>{var e,t;null===(e=this._firstDummy)||void 0===e||e.setTopLeft(s,a),null===(t=this._lastDummy)||void 0===t||t.setTopLeft(s,a)}};const l=t.get();if(!l)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=a;const c=l.__tabsterDummy;if((c||this)._wrappers.push({manager:o,priority:n,tabbable:!0}),c)return c;l.__tabsterDummy=this;const u=null==r?void 0:r.dummyInputsPosition,d=l.tagName;this._isOutside=u?2===u:(s||"UL"===d||"OL"===d||"TABLE"===d)&&!("LI"===d||"TD"===d||"TH"===d),this._firstDummy=new U(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new U(this._getWindow,this._isOutside,{isFirst:!1},t);const h=this._firstDummy.input;h&&e._dummyObserver.add(h,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var o,i,n,r;if(0===(this._wrappers=this._wrappers.filter((o=>o.manager!==e&&!t))).length){delete(null===(o=this._element)||void 0===o?void 0:o.get()).__tabsterDummy;for(const e of this._transformElements)e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();const e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(i=this._firstDummy)||void 0===i?void 0:i.input;t&&this._tabster._dummyObserver.remove(t),null===(n=this._firstDummy)||void 0===n||n.dispose(),null===(r=this._lastDummy)||void 0===r||r.dispose()}}_onFocus(e,t,o,i){var n;const r=this._getCurrent();!r||t.useDefaultAction&&!this._callForDefaultAction||null===(n=r.manager.getHandler(e))||void 0===n||n(t,o,i)}_getCurrent(){return this._wrappers.sort(((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority)),this._wrappers[0]}_ensurePosition(){var e,t,o;const i=null===(e=this._element)||void 0===e?void 0:e.get(),n=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(o=this._lastDummy)||void 0===o?void 0:o.input;if(i&&n&&r)if(this._isOutside){const e=x.getParentNode(i);if(e){const t=x.getNextSibling(i);t!==r&&x.insertBefore(e,r,t),x.getPreviousElementSibling(i)!==n&&x.insertBefore(e,n,i)}}else{x.getLastElementChild(i)!==r&&x.appendChild(i,r);const e=x.getFirstElementChild(i);e&&e!==n&&e.parentNode&&x.insertBefore(e.parentNode,n,e)}}}function Q(e){let t=null;for(let o=x.getLastElementChild(e);o;o=x.getLastElementChild(o))t=o;return t||void 0}function Y(e,t,o,i){const n=e.storageEntry(t,!0);let r=!1;if(!n.aug){if(void 0===i)return r;n.aug={}}if(void 0===i){if(o in n.aug){const e=n.aug[o];delete n.aug[o],null===e?t.removeAttribute(o):t.setAttribute(o,e),r=!0}}else{let e;o in n.aug||(e=t.getAttribute(o)),void 0!==e&&e!==i&&(n.aug[o]=e,null===i?t.removeAttribute(o):t.setAttribute(o,i),r=!0)}return void 0===i&&0===Object.keys(n.aug).length&&(delete n.aug,e.storageEntry(t,!1)),r}function J(e){return"INPUT"===e.tagName&&!!e.name&&"radio"===e.type}function Z(e){var t;return(null===(t=null==e?void 0:e.__tabsterDummyContainer)||void 0===t?void 0:t.get())||null}function X(e,t){const o=JSON.stringify(e);return!0===t?o:{[n]:o}}class ee extends V{constructor(e,t,o,n){super(e,t,1,n,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const o=this._element.get();if(o){this._setFocused(!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:o,ignoreAccessibility:!0});if(t)return void(0,i.kG)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=o}}class te extends G{constructor(e,t,o,n,r){super(e,t,n),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const o=this._element.get();o&&(e?(this._isFocused=!0,null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1),o.dispatchEvent(new k({element:o}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout((()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0),o.dispatchEvent(new T({element:o}))}),0))},this._onFocusIn=e=>{const t=this._tabster.getParent,o=this._element.get();let i=e.composedPath()[0];do{if(i===o)return void this._setFocused(!0);i=i&&t(i)}while(i)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=o;const s=e.getWindow;this.uid=j(s,t),this._sys=r,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();const a=s().document;a.addEventListener(i.Oy,this._onFocusIn),a.addEventListener(i.RY,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new ee(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow(),o=t.document;o.removeEventListener(i.Oy,this._onFocusIn),o.removeEventListener(i.RY,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){const o=this._dummyManager;if(o)o.moveOutWithDefaultAction(e,t);else{const o=this.getElement();o&&ee.moveWithPhantomDummy(this._tabster,o,!0,e,t)}}_add(){}_remove(){}}class oe{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;const t=this._win().document,o=t.body;if(o){this._autoRootUnwait(t);const i=this._autoRoot;if(i)return function(e,t,o){let i;if(o){const t=e.getAttribute(n);if(t)try{i=JSON.parse(t)}catch(e){}}i||(i={}),function(e,t){for(const o of Object.keys(t)){const i=t[o];i?e[o]=i:delete e[o]}}(i,t),Object.keys(i).length>0?e.setAttribute(n,X(i,!0)):e.removeAttribute(n)}(o,{root:i},!0),c(this._tabster,o),null===(e=l(this._tabster,o))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit((()=>{this._autoRoot&&this._autoRootCreate()}))}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach((e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])})),this.rootById={}}createRoot(e,t,o){const i=new te(this._tabster,e,this._onRootDispose,t,o);return this._roots[i.id]=i,this._forceDummy&&i.addDummyInputs(),i}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const o=e().__tabsterInstance;return o&&o.root.rootById[t]}static getTabsterContext(e,t,o){var i,n,r,s;if(void 0===o&&(o={}),!t.ownerDocument)return;const{checkRtl:a,referenceElement:c}=o,u=e.getParent;let d,h,g,p;e.drainInitQueue();let f,m,v,b,y=!1,C=c||t;const S={};for(;C&&(!d||a);){const o=l(e,C);if(a&&void 0===v){const e=C.dir;e&&(v="rtl"===e.toLowerCase())}if(!o){C=u(C);continue}const s=C.tagName;(o.uncontrolled||"IFRAME"===s||"WEBVIEW"===s)&&(b=C),p||!(null===(i=o.focusable)||void 0===i?void 0:i.excludeFromMover)||g||(y=!0);const c=o.modalizer,w=o.groupper,k=o.mover;!h&&c&&(h=c),g||!w||h&&!c||(h?(!w.isActive()&&w.getProps().tabbability&&h.userId!==(null===(n=e.modalizer)||void 0===n?void 0:n.activeId)&&(h=void 0,g=w),m=w):g=w),p||!k||h&&!c||w&&C===t||!C.contains(t)||(p=k,f=!!g&&g!==w),o.root&&(d=o.root),(null===(r=o.focusable)||void 0===r?void 0:r.ignoreKeydown)&&Object.assign(S,o.focusable.ignoreKeydown),C=u(C)}if(!d){const o=e.root;o._autoRoot&&(null===(s=t.ownerDocument)||void 0===s?void 0:s.body)&&(d=o._autoRootCreate())}return g&&!p&&(f=!0),d?{root:d,modalizer:h,groupper:g,mover:p,groupperBeforeMover:f,modalizerInGroupper:m,rtl:a?!!v:void 0,uncontrolled:b,excludedFromMover:y,ignoreKeydown:e=>!!S[e.key]}:void 0}static getRoot(e,t){var o;const i=e.getParent;for(let n=t;n;n=i(n)){const t=null===(o=l(e,n))||void 0===o?void 0:o.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class ie{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,o=t.indexOf(e);o>=0&&t.splice(o,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach((o=>o(e,t)))}}class ne{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=l(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,o,i){return!(!z(e,r)||!t&&-1===e.tabIndex)&&(o||this.isVisible(e))&&(i||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE)return!1;if(function(e){var t,o;const i=e.ownerDocument,n=null===(t=i.defaultView)||void 0===t?void 0:t.getComputedStyle(e);if(null===e.offsetParent&&i.body!==e&&"fixed"!==(null==n?void 0:n.position))return!0;if("hidden"===(null==n?void 0:n.visibility))return!0;if("fixed"===(null==n?void 0:n.position)){if("none"===n.display)return!0;if(null===(null===(o=e.parentElement)||void 0===o?void 0:o.offsetParent)&&i.body!==e.parentElement)return!0}return!1}(e))return!1;const t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let o=e;o;o=x.getParentElement(o)){const e=l(this._tabster,o);if(this._isHidden(o))return!1;if(!(null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(o))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const o=e.getAttribute("aria-hidden");return!(!o||"true"!==o.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){const o=this._findElements(!1,e,t);return o?o[0]:o}_findElements(e,t,o){var i,n,r;const{container:s,currentElement:a=null,includeProgrammaticallyFocusable:l,useActiveModalizer:c,ignoreAccessibility:u,modalizerId:d,isBackward:h,onElement:g}=t;o||(o={});const p=[];let{acceptCondition:f}=t;const m=!!f;if(!s)return null;f||(f=e=>this.isFocusable(e,l,!1,u));const v={container:s,modalizerUserId:void 0===d&&c?null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId:d||(null===(r=null===(n=oe.getTabsterContext(this._tabster,s))||void 0===n?void 0:n.modalizer)||void 0===r?void 0:r.userId),from:a||s,isBackward:h,isFindAll:e,acceptCondition:f,hasCustomCondition:m,includeProgrammaticallyFocusable:l,ignoreAccessibility:u,cachedGrouppers:{},cachedRadioGroups:{}},b=O(s.ownerDocument,s,(e=>this._acceptElement(e,v)));if(!b)return null;const y=t=>{var i,n;const r=null!==(i=v.foundElement)&&void 0!==i?i:v.foundBackward;return r&&p.push(r),e?!(r&&(v.found=!1,delete v.foundElement,delete v.foundBackward,delete v.fromCtx,v.from=r,g&&!g(r))||!r&&!t):(r&&o&&(o.uncontrolled=null===(n=oe.getTabsterContext(this._tabster,r))||void 0===n?void 0:n.uncontrolled),!(!t||r))};if(a||(o.outOfDOMOrder=!0),a&&x.nodeContains(s,a))b.currentNode=a;else if(h){const e=Q(s);if(!e)return null;if(this._acceptElement(e,v)===NodeFilter.FILTER_ACCEPT&&!y(!0))return v.skippedFocusable&&(o.outOfDOMOrder=!0),p;b.currentNode=e}do{h?b.previousNode():b.nextNode()}while(y());return v.skippedFocusable&&(o.outOfDOMOrder=!0),p.length?p:null}_acceptElement(e,t){var o,i,n;if(t.found)return NodeFilter.FILTER_ACCEPT;const r=t.foundBackward;if(r&&(e===r||!x.nodeContains(r,e)))return t.found=!0,t.foundElement=r,NodeFilter.FILTER_ACCEPT;const s=t.container;if(e===s)return NodeFilter.FILTER_SKIP;if(!x.nodeContains(s,e))return NodeFilter.FILTER_REJECT;if(Z(e))return NodeFilter.FILTER_REJECT;if(x.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;const a=t.currentCtx=oe.getTabsterContext(this._tabster,e);if(!a)return NodeFilter.FILTER_SKIP;if(L(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))return(null===(o=a.modalizer)||void 0===o?void 0:o.userId)===(null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId)?(t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let l,c=t.fromCtx;c||(c=t.fromCtx=oe.getTabsterContext(this._tabster,t.from));const u=null==c?void 0:c.mover;let d=a.groupper,h=a.mover;if(l=null===(n=this._tabster.modalizer)||void 0===n?void 0:n.acceptElement(e,t),void 0!==l&&(t.skippedFocusable=!0),void 0===l&&(d||h||u)){const o=null==d?void 0:d.getElement(),i=null==u?void 0:u.getElement();let n=null==h?void 0:h.getElement();n&&x.nodeContains(i,n)&&x.nodeContains(s,i)&&(!o||!h||x.nodeContains(i,o))&&(h=u,n=i),!o||o!==s&&x.nodeContains(s,o)||(d=void 0),n&&!x.nodeContains(s,n)&&(h=void 0),d&&h&&(n&&o&&!x.nodeContains(o,n)?h=void 0:d=void 0),d&&(l=d.acceptElement(e,t)),h&&(l=h.acceptElement(e,t))}if(void 0===l&&(l=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,l===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0)),l===NodeFilter.FILTER_ACCEPT&&!t.found){if(!t.isFindAll&&J(e)&&!e.checked){const o=e.name;let i=t.cachedRadioGroups[o];if(i||(i=function(e){if(!J(e))return;const t=e.name;let o,i=Array.from(x.getElementsByName(e,t));return i=i.filter((e=>!!J(e)&&(e.checked&&(o=e),!0))),{name:t,buttons:new Set(i),checked:o}}(e),i&&(t.cachedRadioGroups[o]=i)),(null==i?void 0:i.checked)&&i.checked!==e)return NodeFilter.FILTER_SKIP}t.isBackward?(t.foundBackward=e,l=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)}return l}}const re="Home",se="ArrowLeft",ae="ArrowUp",le="ArrowRight",ce="ArrowDown",ue={2:0,3:1,1:2};class de extends ie{constructor(e,t){super(),this._init=()=>{const e=this._win(),t=e.document;t.addEventListener(i.Oy,this._onFocusIn,!0),t.addEventListener(i.RY,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const o=x.getActiveElement(t);o&&o!==t.body&&this._setFocusedElement(o),this.subscribe(this._onChanged)},this._onFocusIn=e=>{const t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null===(t=e.detail)||void 0===t?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if("Tab"!==e.key||e.ctrlKey)return;const t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;const o=this._tabster,n=o.controlTab,r=oe.getTabsterContext(o,t);if(!r||r.ignoreKeydown(e))return;const s=e.shiftKey,a=de.findNextTabbable(o,r,void 0,t,void 0,s,!0),c=r.root.getElement();if(!c)return;const u=null==a?void 0:a.element,d=function(e,t){var o;const i=e.getParent;let n=t;do{const t=null===(o=l(e,n))||void 0===o?void 0:o.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(n,!!t.completely))return n;n=i(n)}while(n)}(o,t);if(u){const l=a.uncontrolled;if(r.uncontrolled||x.nodeContains(l,t)){if(!a.outOfDOMOrder&&l===r.uncontrolled||d&&!x.nodeContains(d,u))return;return void V.addPhantomDummyWithTarget(o,t,s,u)}if(l||"IFRAME"===u.tagName)return void(c.dispatchEvent(new b({by:"root",owner:c,next:u,relatedEvent:e}))&&V.moveWithPhantomDummy(this._tabster,null!=l?l:u,!1,s,e));(n||(null==a?void 0:a.outOfDOMOrder))&&c.dispatchEvent(new b({by:"root",owner:c,next:u,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,i.kG)(u))}else!d&&c.dispatchEvent(new b({by:"root",owner:c,next:null,relatedEvent:e}))&&r.root.moveOutWithDefaultAction(s,e)},this._onChanged=(e,t)=>{var o,i;if(e)e.dispatchEvent(new m(t));else{const e=null===(o=this._lastVal)||void 0===o?void 0:o.get();if(e){const o={...t},n=oe.getTabsterContext(this._tabster,e),r=null===(i=null==n?void 0:n.modalizer)||void 0===i?void 0:i.userId;r&&(o.modalizerId=r),e.dispatchEvent(new v(o))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();const e=this._win(),t=e.document;t.removeEventListener(i.Oy,this._onFocusIn,!0),t.removeEventListener(i.RY,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);const o=this._asyncFocus;o&&(e.clearTimeout(o.timeout),delete this._asyncFocus),delete de._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var o,i;let n=de._lastResetElement,r=n&&n.get();r&&x.nodeContains(t,r)&&delete de._lastResetElement,r=null===(i=null===(o=e._nextVal)||void 0===o?void 0:o.element)||void 0===i?void 0:i.get(),r&&x.nodeContains(t,r)&&delete e._nextVal,n=e._lastVal,r=n&&n.get(),r&&x.nodeContains(t,r)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!H(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,o){return!!this._tabster.focusable.isFocusable(e,t,!1,o)&&(e.focus(),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var o;const{container:i,ignoreAccessibility:n}=t;let r;if(i){const t=oe.getTabsterContext(this._tabster,i);t&&(r=null===(o=de.findNextTabbable(this._tabster,t,i,void 0,void 0,!e,n))||void 0===o?void 0:o.element)}return r&&!x.nodeContains(i,r)&&(r=void 0),r||void 0}_focusFirstOrLast(e,t){const o=this.getFirstOrLastTabbable(e,t);return!!o&&(this.focus(o,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),o=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),de._lastResetElement=new B(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",o)}return!0}requestAsyncFocus(e,t,o){const i=this._tabster.getWindow(),n=this._asyncFocus;if(n){if(ue[e]>ue[n.source])return;i.clearTimeout(n.timeout)}this._asyncFocus={source:e,callback:t,timeout:i.setTimeout((()=>{this._asyncFocus=void 0,t()}),o)}}cancelAsyncFocus(e){const t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,o){null===o?e.removeAttribute(t):e.setAttribute(t,o)}_setFocusedElement(e,t,o){var i,n;if(this._tabster._noop)return;const r={relatedTarget:t};if(e){const t=null===(i=de._lastResetElement)||void 0===i?void 0:i.get();if(de._lastResetElement=void 0,t===e||L(e))return;r.isFocusedProgrammatically=o;const s=oe.getTabsterContext(this._tabster,e),a=null===(n=null==s?void 0:s.modalizer)||void 0===n?void 0:n.userId;a&&(r.modalizerId=a)}const s=this._nextVal={element:e?new B(this._win,e):void 0,detail:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===s&&this.setVal(e,r),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new B(this._win,e))}static findNextTabbable(e,t,o,i,n,r,s){const a=o||t.root.getElement();if(!a)return null;let l=null;const c=de._isTabbingTimer,u=e.getWindow();c&&u.clearTimeout(c),de.isTabbing=!0,de._isTabbingTimer=u.setTimeout((()=>{delete de._isTabbingTimer,de.isTabbing=!1}),0);const d=t.modalizer,h=t.groupper,g=t.mover,p=t=>{if(l=t.findNextTabbable(i,n,r,s),i&&!(null==l?void 0:l.element)){const n=t!==d&&x.getParentElement(t.getElement());if(n){const a=oe.getTabsterContext(e,i,{referenceElement:n});if(a){const i=t.getElement(),c=r?i:i&&Q(i)||i;c&&(l=de.findNextTabbable(e,a,o,c,n,r,s),l&&(l.outOfDOMOrder=!0))}}}};if(h&&g)p(t.groupperBeforeMover?h:g);else if(h)p(h);else if(g)p(g);else if(d)p(d);else{const t={container:a,currentElement:i,referenceElement:n,ignoreAccessibility:s,useActiveModalizer:!0},o={},c=e.focusable[r?"findPrev":"findNext"](t,o);l={element:c,outOfDOMOrder:o.outOfDOMOrder,uncontrolled:o.uncontrolled}}return l}}de.isTabbing=!1;class he extends ie{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,i.SQ)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,i.bd)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let ge=0;const pe="aria-hidden";class fe extends V{constructor(e,t,o){super(t,e,2,o),this._setHandlers(((o,n)=>{var r,s;const a=e.get(),l=a&&(null===(r=oe.getRoot(t,a))||void 0===r?void 0:r.getElement()),c=o.input;let u;if(l&&c){const e=Z(c),o=oe.getTabsterContext(t,e||c);o&&(u=null===(s=de.findNextTabbable(t,o,l,c,void 0,n,!0))||void 0===s?void 0:s.element),u&&(0,i.kG)(u)}}))}}class me extends G{constructor(e,t,o,i,n,r){super(e,t,i),this._wasFocused=0,this.userId=i.id,this._onDispose=o,this._activeElements=r,e.controlTab||(this.dummyManager=new fe(this._element,e,n))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const o=this._activeElements,i=o.map((e=>e.get())).indexOf(t);e?i<0&&o.push(new B(this._tabster.getWindow,t)):i>=0&&o.splice(i,1)}this._dispatchEvent(e)}}focused(e){return e||(this._wasFocused=++ge),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){return x.nodeContains(this.getElement(),e)}findNextTabbable(e,t,o,i){var n,r;if(!this.getElement())return null;const s=this._tabster;let a,l=null,c=!1;const u=e&&(null===(n=oe.getRoot(s,e))||void 0===n?void 0:n.getElement());if(u){const n={container:u,currentElement:e,referenceElement:t,ignoreAccessibility:i,useActiveModalizer:!0},d={};l=s.focusable[o?"findPrev":"findNext"](n,d),!l&&this._props.isTrapped&&(null===(r=s.modalizer)||void 0===r?void 0:r.activeId)?(l=s.focusable[o?"findLast":"findFirst"]({container:u,ignoreAccessibility:i,useActiveModalizer:!0},d),c=!0):c=!!d.outOfDOMOrder,a=d.uncontrolled}return{element:l,uncontrolled:a,outOfDOMOrder:c}}_dispatchEvent(e,t){const o=this.getElement();let i=!1;if(o){const n=t?this._activeElements.map((e=>e.get())):[o];for(const t of n)if(t){const n={id:this.userId,element:o},r=e?new C(n):new S(n);t.dispatchEvent(r),r.defaultPrevented&&(i=!0)}}return i}_remove(){}}class ve{constructor(e,t,o){this._onModalizerDispose=e=>{const t=e.id,o=e.userId,i=this._parts[o];delete this._modalizers[t],i&&(delete i[t],0===Object.keys(i).length&&(delete this._parts[o],this.activeId===o&&this.setActive(void 0)))},this._onKeyDown=e=>{var t;if("Escape"!==e.key)return;const o=this._tabster,i=o.focusedElement.getFocusedElement();if(i){const n=oe.getTabsterContext(o,i),r=null==n?void 0:n.modalizer;if(n&&!n.groupper&&(null==r?void 0:r.isActive())&&!n.ignoreKeydown(e)){const i=r.userId;if(i){const n=this._parts[i];if(n){const i=Object.keys(n).map((e=>{var t;const o=n[e],i=o.getElement();let r;return i&&(r=null===(t=l(this._tabster,i))||void 0===t?void 0:t.groupper),o&&i&&r?{el:i,focusedSince:o.focused(!0)}:{focusedSince:0}})).filter((e=>e.focusedSince>0)).sort(((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0));if(i.length){const n=i[0].el;n&&(null===(t=o.groupper)||void 0===t||t.handleKeyPress(n,e,!0))}}}}}},this._onFocus=(e,t)=>{var o,i;const n=e&&oe.getTabsterContext(this._tabster,e);if(!n||!e)return;const r=this._augMap;for(let t=e;t;t=x.getParentElement(t))r.has(t)&&(r.delete(t),Y(this._tabster,t,pe));const s=n.modalizer;if(null===(i=s||(null===(o=l(this._tabster,e))||void 0===o?void 0:o.modalizer))||void 0===i||i.focused(),(null==s?void 0:s.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==s?void 0:s.getProps().isAlwaysAccessible))this.setActive(s);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout((()=>this._restoreModalizerFocus(e)),100)}else this.currentIsOthersAccessible=null==s?void 0:s.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=t,this._accessibleCheck=o,this.activeElements=[],e.controlTab||e.root.addDummyInputs(),this._win().addEventListener("keydown",this._onKeyDown,!0),e.queueInit((()=>{this._tabster.focusedElement.subscribe(this._onFocus)}))}dispose(){const e=this._win();e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach((e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])})),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,o){var i;const n=new me(this._tabster,e,this._onModalizerDispose,t,o,this.activeElements),r=n.id,s=t.id;this._modalizers[r]=n;let a=this._parts[s];return a||(a=this._parts[s]={}),a[r]=n,x.nodeContains(e,null!==(i=this._tabster.focusedElement.getFocusedElement())&&void 0!==i?i:null)&&(s!==this.activeId?this.setActive(n):n.makeActive(!0)),n}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout((()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()}),250))}setActive(e){const t=null==e?void 0:e.userId,o=this.activeId;if(o!==t){if(this.activeId=t,o){const e=this._parts[o];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null==e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate()}}focus(e,t,o){const i=oe.getTabsterContext(this._tabster,e),n=null==i?void 0:i.modalizer;if(n){this.setActive(n);const e=n.getProps(),i=n.getElement();if(i){if(void 0===t&&(t=e.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:i}))return!0;if(void 0===o&&(o=e.isNoFocusDefault),!o&&this._tabster.focusedElement.focusDefault(i))return!0;this._tabster.focusedElement.resetFocus(i)}}return!1}acceptElement(e,t){var o;const i=t.modalizerUserId,n=null===(o=t.currentCtx)||void 0===o?void 0:o.modalizer;if(i)for(const t of this.activeElements){const o=t.get();if(o&&(x.nodeContains(e,o)||o===e))return NodeFilter.FILTER_SKIP}const r=i===(null==n?void 0:n.userId)||!i&&(null==n?void 0:n.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==r&&(t.skippedFocusable=!0),r}_hiddenUpdate(){var e;const t=this._tabster,o=t.getWindow().document.body,i=this.activeId,n=this._parts,r=[],s=[],a=this._alwaysAccessibleSelector,l=a?Array.from(x.querySelectorAll(o,a)):[],c=[];for(const e of Object.keys(n)){const t=n[e];for(const o of Object.keys(t)){const n=t[o],a=n.getElement(),u=n.getProps().isAlwaysAccessible;a&&(e===i?(c.push(a),this.currentIsOthersAccessible||r.push(a)):u?l.push(a):s.push(a))}}const u=this._augMap,d=r.length>0?[...r,...l]:void 0,h=[],g=new WeakMap,p=(e,o)=>{var i;const n=e.tagName;if("SCRIPT"===n||"STYLE"===n)return;let r=!1;u.has(e)?o?r=!0:(u.delete(e),Y(t,e,pe)):o&&!(null===(i=this._accessibleCheck)||void 0===i?void 0:i.call(this,e,c))&&Y(t,e,pe,"true")&&(u.set(e,!0),r=!0),r&&(h.push(new B(t.getWindow,e)),g.set(e,!0))},f=e=>{var o;for(let i=x.getFirstElementChild(e);i;i=x.getNextElementSibling(i)){let e=!1,n=!1,r=!1;if(d){const s=t.getParent(i);for(const t of d){if(i===t){e=!0;break}if(x.nodeContains(i,t)){n=!0;break}x.nodeContains(t,s)&&(r=!0)}n||(null===(o=i.__tabsterElementFlags)||void 0===o?void 0:o.noDirectAriaHidden)?f(i):e||r||p(i,!0)}else p(i,!1)}};d||l.forEach((e=>p(e,!1))),s.forEach((e=>p(e,!0))),o&&f(o),null===(e=this._aug)||void 0===e||e.map((e=>e.get())).forEach((e=>{e&&!g.get(e)&&p(e,!1)})),this._aug=h,this._augMap=g}_restoreModalizerFocus(e){const t=null==e?void 0:e.ownerDocument;if(!e||!t)return;const o=oe.getTabsterContext(this._tabster,e),i=null==o?void 0:o.modalizer,n=this.activeId;if(!i&&!n||i&&n===i.userId)return;const r=null==o?void 0:o.root.getElement();if(r){let t=this._tabster.focusable.findFirst({container:r,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=this._tabster.focusable.findLast({container:r,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void this._tabster.focusedElement.focus(t)}}e.blur()}}const be=3023==o.j?["input","textarea","*[contenteditable]"].join(", "):null;class ye extends V{constructor(e,t,o,n){super(t,e,3,n),this._onFocusDummyInput=e=>{var t,o;const n=this._element.get(),r=e.input;if(n&&r){const s=oe.getTabsterContext(this._tabster,n);let a;s&&(a=null===(t=de.findNextTabbable(this._tabster,s,void 0,r,void 0,!e.isFirst,!0))||void 0===t?void 0:t.element);const l=null===(o=this._getMemorized())||void 0===o?void 0:o.get();l&&this._tabster.focusable.isFocusable(l)&&(a=l),a&&(0,i.kG)(a)}},this._tabster=t,this._getMemorized=o,this._setHandlers(this._onFocusDummyInput)}}class Ce extends G{constructor(e,t,o,i,n){var r;super(e,t,i),this._visible={},this._onIntersection=e=>{for(const t of e){const e=t.target,o=j(this._win,e);let i,n=this._fullyVisible;if(t.intersectionRatio>=.25?(i=t.intersectionRatio>=.75?2:1,2===i&&(n=o)):i=0,this._visible[o]!==i){void 0===i?(delete this._visible[o],n===o&&delete this._fullyVisible):(this._visible[o]=i,this._fullyVisible=n);const t=this.getState(e);t&&e.dispatchEvent(new y(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!==(r=i.visibilityTolerance)&&void 0!==r?r:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=o;e.controlTab||(this.dummyManager=new ye(this._element,e,(()=>i.memorizeCurrent?this._current:void 0),n))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);const t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager}setCurrent(e){this._current=e?new B(this._win,e):void 0,!this._props.trackState&&!this._props.visibilityAware||this._setCurrentTimer||(this._setCurrentTimer=this._win().setTimeout((()=>{var e;delete this._setCurrentTimer;const t=[];this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current);for(const o of t){const t=null==o?void 0:o.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){const e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){const e=this.getState(t);e&&t.dispatchEvent(new y(e))}}}})))}getCurrent(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null}findNextTabbable(e,t,o,i){const n=this.getElement(),r=n&&Z(e)===n;if(!n)return null;let s,a=null,l=!1;if(this._props.tabbable||r||e&&!x.nodeContains(n,e)){const r={currentElement:e,referenceElement:t,container:n,ignoreAccessibility:i,useActiveModalizer:!0},c={};a=this._tabster.focusable[o?"findPrev":"findNext"](r,c),l=!!c.outOfDOMOrder,s=c.uncontrolled}return{element:a,uncontrolled:s,outOfDOMOrder:l}}acceptElement(e,t){var o,i;if(!de.isTabbing)return(null===(o=t.currentCtx)||void 0===o?void 0:o.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;const{memorizeCurrent:n,visibilityAware:r,hasDefault:s=!0}=this._props,a=this.getElement();if(a&&(n||r||s)&&(!x.nodeContains(a,t.from)||Z(t.from)===a)){let e;if(n){const o=null===(i=this._current)||void 0===i?void 0:i.get();o&&t.acceptCondition(o)&&(e=o)}if(!e&&s&&(e=this._tabster.focusable.findDefault({container:a,useActiveModalizer:!0})),!e&&r&&(e=this._tabster.focusable.findElement({container:a,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var o;const i=j(this._win,e),n=this._visible[i];return a!==e&&!!(null===(o=this._allElements)||void 0===o?void 0:o.get(e))&&t.acceptCondition(e)&&(2===n||1===n&&(1===r||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=a,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){const e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;const t=this._win(),o=this._allElements=new WeakMap,i=this._tabster.focusable;let n=this._updateQueue=[];const r=x.createMutationObserver((e=>{for(const t of e){const e=t.target,o=t.removedNodes,i=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&n.push({element:e,type:2});else{for(let e=0;e<o.length;e++)n.push({element:o[e],type:3});for(let e=0;e<i.length;e++)n.push({element:i[e],type:1})}}d()})),s=(e,t)=>{var i,n;const r=o.get(e);r&&t&&(null===(i=this._intersectionObserver)||void 0===i||i.unobserve(e),o.delete(e)),r||t||(o.set(e,this),null===(n=this._intersectionObserver)||void 0===n||n.observe(e))},a=e=>{const t=i.isFocusable(e);o.get(e)?t||s(e,!0):t&&s(e)},c=e=>{const{mover:o}=h(e);if(o&&o!==this){if(o.getElement()!==e||!i.isFocusable(e))return;s(e)}const n=O(t.document,e,(e=>{const{mover:t,groupper:o}=h(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;const n=null==o?void 0:o.getFirst(!0);return o&&o.getElement()!==e&&n&&n!==e?NodeFilter.FILTER_REJECT:(i.isFocusable(e)&&s(e),NodeFilter.FILTER_SKIP)}));if(n)for(n.currentNode=e;n.nextNode(););},u=e=>{o.get(e)&&s(e,!0);for(let t=x.getFirstElementChild(e);t;t=x.getNextElementSibling(t))u(t)},d=()=>{!this._updateTimer&&n.length&&(this._updateTimer=t.setTimeout((()=>{delete this._updateTimer;for(const{element:e,type:t}of n)switch(t){case 2:a(e);break;case 1:c(e);break;case 3:u(e)}n=this._updateQueue=[]}),0))},h=e=>{const t={};for(let o=e;o;o=x.getParentElement(o)){const e=l(this._tabster,o);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};n.push({element:e,type:1}),d(),r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{r.disconnect()}}getState(e){const t=j(this._win,e);if(t in this._visible){const o=this._visible[t]||0;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:o}}}}class Se{constructor(e,t){this._init=()=>{const e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(d,this._onMoveFocus),e.addEventListener(h,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let o=e,i=e;for(let n=x.getParentElement(e);n;n=x.getParentElement(n)){const e=null===(t=l(this._tabster,n))||void 0===t?void 0:t.mover;e&&(e.setCurrent(i),o=void 0),!o&&this._tabster.focusable.isFocusable(n)&&(o=i=n)}},this._onKeyDown=async e=>{var t;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const o=e.key;let i;if(o===ce?i=2:o===le?i=4:o===ae?i=1:o===se?i=3:"PageDown"===o?i=6:"PageUp"===o?i=5:o===re?i=7:"End"===o&&(i=8),!i)return;const n=this._tabster.focusedElement.getFocusedElement();n&&!await this._isIgnoredInput(n,o)&&this._moveFocus(n,i,e)},this._onMoveFocus=e=>{var t;const o=e.composedPath()[0],i=null===(t=e.detail)||void 0===t?void 0:t.key;o&&void 0!==i&&!e.defaultPrevented&&(this._moveFocus(o,i),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;const o=e.composedPath()[0];let i=null===(t=e.detail)||void 0===t?void 0:t.memorizedElement;if(o){const t=oe.getTabsterContext(this._tabster,o),n=null==t?void 0:t.mover;n&&(i&&!x.nodeContains(n.getElement(),i)&&(i=void 0),n.setCurrent(i),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;const t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(d,this._onMoveFocus),t.removeEventListener(h,this._onMemorizedElement),Object.keys(this._movers).forEach((e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])}))}createMover(e,t,o){const i=new Ce(this._tabster,e,this._onMoverDispose,t,o);return this._movers[i.id]=i,i}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,o){var n,r;const s=this._tabster,c=oe.getTabsterContext(s,e,{checkRtl:!0});if(!c||!c.mover||c.excludedFromMover||o&&c.ignoreKeydown(o))return null;const u=c.mover,d=u.getElement();if(c.groupperBeforeMover){const e=c.groupper;if(!e||e.isActive(!0))return null;for(let t=x.getParentElement(e.getElement());t&&t!==d;t=x.getParentElement(t))if(null===(r=null===(n=l(s,t))||void 0===n?void 0:n.groupper)||void 0===r?void 0:r.isActive(!0))return null}if(!d)return null;const h=s.focusable,g=u.getProps(),p=g.direction||a.Both,f=p===a.Both,m=f||p===a.Vertical,v=f||p===a.Horizontal,y=p===a.GridLinear,C=y||p===a.Grid,S=g.cyclic;let w,k,T,I=0,_=0;if(C&&(T=e.getBoundingClientRect(),I=Math.ceil(T.left),_=Math.floor(T.right)),c.rtl&&(4===t?t=3:3===t&&(t=4)),2===t&&m||4===t&&(v||C))if(w=h.findNext({currentElement:e,container:d,useActiveModalizer:!0}),w&&C){const e=Math.ceil(w.getBoundingClientRect().left);!y&&_>e&&(w=void 0)}else!w&&S&&(w=h.findFirst({container:d,useActiveModalizer:!0}));else if(1===t&&m||3===t&&(v||C))if(w=h.findPrev({currentElement:e,container:d,useActiveModalizer:!0}),w&&C){const e=Math.floor(w.getBoundingClientRect().right);!y&&e>I&&(w=void 0)}else!w&&S&&(w=h.findLast({container:d,useActiveModalizer:!0}));else if(7===t)C?h.findElement({container:d,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var o;if(!h.isFocusable(t))return!1;const i=Math.ceil(null!==(o=t.getBoundingClientRect().left)&&void 0!==o?o:0);return t!==e&&I<=i||(w=t,!1)}}):w=h.findFirst({container:d,useActiveModalizer:!0});else if(8===t)C?h.findElement({container:d,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var o;if(!h.isFocusable(t))return!1;const i=Math.ceil(null!==(o=t.getBoundingClientRect().left)&&void 0!==o?o:0);return t!==e&&I>=i||(w=t,!1)}}):w=h.findLast({container:d,useActiveModalizer:!0});else if(5===t){if(h.findElement({currentElement:e,container:d,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!(!h.isFocusable(e)||P(this._win,e,u.visibilityTolerance)&&(w=e,1))}),C&&w){const e=Math.ceil(w.getBoundingClientRect().left);h.findElement({currentElement:w,container:d,useActiveModalizer:!0,acceptCondition:t=>{if(!h.isFocusable(t))return!1;const o=Math.ceil(t.getBoundingClientRect().left);return I<o||e>=o||(w=t,!1)}})}k=!1}else if(6===t){if(h.findElement({currentElement:e,container:d,useActiveModalizer:!0,acceptCondition:e=>!(!h.isFocusable(e)||P(this._win,e,u.visibilityTolerance)&&(w=e,1))}),C&&w){const e=Math.ceil(w.getBoundingClientRect().left);h.findElement({currentElement:w,container:d,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!h.isFocusable(t))return!1;const o=Math.ceil(t.getBoundingClientRect().left);return I>o||e<=o||(w=t,!1)}})}k=!0}else if(C){const o=1===t,i=I,n=Math.ceil(T.top),r=_,s=Math.floor(T.bottom);let a,l,c=0;h.findAll({container:d,currentElement:e,isBackward:o,onElement:e=>{const t=e.getBoundingClientRect(),u=Math.ceil(t.left),d=Math.ceil(t.top),h=Math.floor(t.right),g=Math.floor(t.bottom);if(o&&n<g||!o&&s>d)return!0;const p=Math.ceil(Math.min(r,h))-Math.floor(Math.max(i,u)),f=Math.ceil(Math.min(r-i,h-u));if(p>0&&f>=p){const t=p/f;t>c&&(a=e,c=t)}else if(0===c){const t=function(e,t,o,i,n,r,s,a){const l=o<n?n-o:s<e?e-s:0,c=i<r?r-i:a<t?t-a:0;return 0===l?c:0===c?l:Math.sqrt(l*l+c*c)}(i,n,r,s,u,d,h,g);(void 0===l||t<l)&&(l=t,a=e)}else if(c>0)return!1;return!0}}),w=a}return w&&(!o||o&&d.dispatchEvent(new b({by:"mover",owner:d,next:w,relatedEvent:o})))?(void 0!==k&&function(e,t,o){const i=N(t);if(i){const n=F(e,i),r=t.getBoundingClientRect();i.scrollTop+=o?r.top-n.top:r.bottom-n.bottom}}(this._win,w,k),o&&(o.preventDefault(),o.stopImmediatePropagation()),(0,i.kG)(w),w):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(z(e,be)){let o,i=0,n=0,r=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const o=e.type,s=e.value;if(r=(s||"").length,"email"===o||"number"===o){if(r){const o=x.getSelection(e);if(o){const e=o.toString().length,i=t===se||t===ae;if(o.modify("extend",i?"backward":"forward","character"),e!==o.toString().length)return o.modify("extend",i?"forward":"backward","character"),!0;r=0}}}else{const t=e.selectionStart;if(null===t)return"hidden"===o;i=t||0,n=e.selectionEnd||0}}else"true"===e.contentEditable&&(o=new(function(e){const t=A(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}(this._win))((t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};const o=this._win();this._ignoredInputTimer&&o.clearTimeout(this._ignoredInputTimer);const{anchorNode:s,focusNode:a,anchorOffset:l,focusOffset:c}=x.getSelection(e)||{};this._ignoredInputTimer=o.setTimeout((()=>{var t,o,u;delete this._ignoredInputTimer;const{anchorNode:d,focusNode:h,anchorOffset:g,focusOffset:p}=x.getSelection(e)||{};if(d===s&&h===a&&g===l&&p===c){if(i=g||0,n=p||0,r=(null===(o=e.textContent)||void 0===o?void 0:o.length)||0,d&&h&&x.nodeContains(e,d)&&x.nodeContains(e,h)&&d!==e){let t=!1;const o=e=>{if(e===d)t=!0;else if(e===h)return!0;const r=e.textContent;if(r&&!x.getFirstChild(e)){const e=r.length;t?h!==d&&(n+=e):(i+=e,n+=e)}let s=!1;for(let t=x.getFirstChild(e);t&&!s;t=t.nextSibling)s=o(t);return s};o(e)}null===(u=this._ignoredInputResolve)||void 0===u||u.call(this,!0)}else null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1)}),0)})));if(o&&!await o)return!0;if(i!==n)return!0;if(i>0&&(t===se||t===ae||t===re))return!0;if(i<r&&(t===le||t===ce||"End"===t))return!0}return!1}}class we{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var o;const i=null===(o=this._isUncontrolledCompletely)||void 0===o?void 0:o.call(this,e,t);return void 0===i?t:i}}class ke extends G{constructor(e,t,o){var i;if(super(e,t,o),this._hasFocus=!1,this._onFocusOut=e=>{var t;const o=null===(t=this._element)||void 0===t?void 0:t.get();o&&null===e.relatedTarget&&o.dispatchEvent(new w),o&&!x.nodeContains(o,e.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===s.Source){const e=null===(i=this._element)||void 0===i?void 0:i.get();null==e||e.addEventListener("focusout",this._onFocusOut),null==e||e.addEventListener("focusin",this._onFocusIn),this._hasFocus=x.nodeContains(e,e&&x.getActiveElement(e.ownerDocument))}}dispose(){var e;if(this._props.type===s.Source){const t=null===(e=this._element)||void 0===e?void 0:e.get();null==t||t.removeEventListener("focusout",this._onFocusOut),null==t||t.removeEventListener("focusin",this._onFocusIn),this._hasFocus&&this._tabster.getWindow().document.body.dispatchEvent(new w)}}}class Te{constructor(e){this._history=[],this._onRestoreFocus=e=>{this._focusedElementState.cancelAsyncFocus(2);const t=e.composedPath()[0];t&&this._focusedElementState.requestAsyncFocus(2,(()=>this._restoreFocus(t)),0)},this._onFocusIn=e=>{var t;if(!e)return;const o=l(this._tabster,e);(null===(t=null==o?void 0:o.restorer)||void 0===t?void 0:t.getProps().type)===s.Target&&this._addToHistory(e)},this._restoreFocus=e=>{var t;const o=this._getWindow().document;if(x.getActiveElement(o)!==o.body)return;if(!this._keyboardNavState.isNavigatingWithKeyboard()&&x.nodeContains(o.body,e))return;let i=this._history.pop();for(;i&&!x.nodeContains(o.body,x.getParentElement(i.get()));)i=this._history.pop();null===(t=null==i?void 0:i.get())||void 0===t||t.focus()},this._tabster=e,this._getWindow=e.getWindow,this._getWindow().addEventListener(g,this._onRestoreFocus),this._keyboardNavState=e.keyboardNavigation,this._focusedElementState=e.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){const e=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(2),e.removeEventListener(g,this._onRestoreFocus)}_addToHistory(e){var t;(null===(t=this._history[this._history.length-1])||void 0===t?void 0:t.get())!==e&&(this._history.length>10&&this._history.shift(),this._history.push(new B(this._getWindow,e)))}createRestorer(e,t){const o=new ke(this._tabster,e,t);return t.type===s.Target&&x.getActiveElement(e.ownerDocument)===e&&this._addToHistory(e),o}}class xe{static _overrideAttachShadow(e){const t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){const o=t.call(this,e);for(const e of xe._shadowObservers)e._addSubObserver(o);return o},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(const t of e)if("childList"===t.type){const e=t.removedNodes,o=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<o.length;e++)this._walkShadows(o[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(this._options&&this._callback&&!this._subObservers.has(e)&&this._options.subtree&&function(e,t){var o,i;if(!e||!t)return!1;let n=t;for(;n;){if(n===e)return!0;n="function"!=typeof n.assignedElements&&(null===(o=n.assignedSlot)||void 0===o?void 0:o.parentNode)?null===(i=n.assignedSlot)||void 0===i?void 0:i.parentNode:n.nodeType===document.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return!1}(this._root,e)){const t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){this._isObserving=!1,delete this._options,xe._shadowObservers.delete(this);for(const e of this._subObservers.values())e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){const o=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,i=null==o?void 0:o.defaultView;o&&i&&(xe._overrideAttachShadow(i),xe._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){const o=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(o){if(e===o)e=o.body;else{const t=e.shadowRoot;if(t)return void this._addSubObserver(t)}o.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){const t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{const t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){const e=this._observer.takeRecords();for(const t of this._subObservers.values())e.push(...t.takeRecords());return e}}xe._shadowObservers=new Set;class Ie{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class _e{constructor(e,t){var o,i;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.0.1",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const r=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(const t of Object.keys(e))x[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new he(r),this.focusedElement=new de(this,r),this.focusable=new ne(this),this.root=new oe(this,null==t?void 0:t.autoRoot),this.uncontrolled=new we((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null===(o=null==t?void 0:t.controlTab)||void 0===o||o,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new $(r),this.getParent=null!==(i=null==t?void 0:t.getParent)&&void 0!==i?i:x.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=r().document;this._unobserve=function(e,t,o,i){if("undefined"==typeof MutationObserver)return()=>{};const r=t.getWindow;let s;function a(t,o){s||(s=A(r).elementByUId),c(t,o);const i=O(e,t,(e=>c(e,o)));if(i)for(;i.nextNode(););}function c(e,i){var a;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const c=e.__tabsterElementUID;return c&&s&&(i?delete s[c]:null!==(a=s[c])&&void 0!==a||(s[c]=new B(r,e))),(l(t,e)||e.hasAttribute(n))&&o(t,e,i),NodeFilter.FILTER_SKIP}const u=x.createMutationObserver((e=>{var i,r,s,l,c;const u=new Set;for(const c of e){const e=c.target,d=c.removedNodes,h=c.addedNodes;if("attributes"===c.type)c.attributeName===n&&(u.has(e)||o(t,e));else{for(let o=0;o<d.length;o++){const n=d[o];u.add(n),a(n,!0),null===(r=(i=t._dummyObserver).domChanged)||void 0===r||r.call(i,e)}for(let o=0;o<h.length;o++)a(h[o]),null===(l=(s=t._dummyObserver).domChanged)||void 0===l||l.call(s,e)}}u.clear(),null===(c=t.modalizer)||void 0===c||c.hiddenUpdate()}));return i&&a(r().document.body),u.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[n]}),()=>{u.disconnect()}}(t,this,c,e)}}},D(r),this.queueInit((()=>{this.internal.resumeObserver(!0)}))}_mergeProps(e){var t;e&&(this.getParent=null!==(t=e.getParent)&&void 0!==t?t:this.getParent)}createTabster(e,t){const o=new Ie(this);return e||this._wrappers.add(o),this._mergeProps(t),o}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,o,i,n,r,s,a;this.internal.stopObserver();const l=this._win;null==l||l.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],l&&this._forgetMemorizedTimer&&(l.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(o=this.deloser)||void 0===o||o.dispose(),null===(i=this.groupper)||void 0===i||i.dispose(),null===(n=this.mover)||void 0===n||n.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(s=this.observedElement)||void 0===s||s.dispose(),null===(a=this.restorer)||void 0===a||a.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=A(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),q(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),l&&(function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(l),delete l.__tabsterInstance,delete this._win)}storageEntry(e,t){const o=this._storage;let i=o.get(e);return i?!1===t&&0===Object.keys(i).length&&o.delete(e):!0===t&&(i={},o.set(e,i)),i}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout((()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())q(this.getWindow,e),de.forgetMemorized(this.focusedElement,e)}),0),M(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null===(t=this._win)||void 0===t?void 0:t.setTimeout((()=>{delete this._initTimer,this.drainInitQueue()}),0)))}drainInitQueue(){if(!this._win)return;const e=this._initQueue;this._initQueue=[],e.forEach((e=>e()))}}function Ee(e,t){let o=function(e){return e.__tabsterInstance}(e);return o?o.createTabster(!1,t):(o=new _e(e,t),e.__tabsterInstance=o,o.createTabster())}function Ae(e){const t=e.core;return t.mover||(t.mover=new Se(t,t.getWindow)),t.mover}function Re(e,t,o){const i=e.core;return i.modalizer||(i.modalizer=new ve(i,t,o)),i.modalizer}function Be(e){const t=e.core;return t.restorer||(t.restorer=new Te(t)),t.restorer}function Me(e,t){e.core.disposeTabster(e,t)}},73811:(e,t,o)=>{"use strict";o.d(t,{K:()=>u});var i=o(56415),n=()=>i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner.current,r=(3023==o.j&&Symbol.for("react.strict_mode"),()=>!1),s=new WeakSet;function a(e,t){const o=n();i.useEffect((()=>s.has(o)?e():(s.add(o),void e())),t)}var l=new WeakSet;function c(e,t){return i.useMemo((()=>{const t=n();return l.has(t)?e():(l.add(t),null)}),t)}function u(e,t){var o;const n=r()&&!1,s=n?c:i.useMemo,l=n?a:i.useEffect,[u,d]=null!=(o=s((()=>e()),t))?o:[null,()=>null];return l((()=>d),t),u}},65787:e=>{"use strict";e.exports={r:"2.35.1335"}}}]);
//# sourceMappingURL=shared.js.map