/*! For license information please see taskpane.js.LICENSE.txt */
var TypeScriptModule;(()=>{var e,t,n,r,o,i={62449:(e,t,n)=>{"use strict";n.d(t,{f:()=>o});const r=e=>{var t,n,r,o,i,a,s,l,c,u;return{chatUiStack:null!==(t=e.chatUiStack)&&void 0!==t?t:{},chatFreStack:null!==(n=e.chatFreStack)&&void 0!==n?n:{},chatUiStackZoom:null!==(r=e.chatUiStackZoom)&&void 0!==r?r:{},chatFreStackZoom:null!==(o=e.chatFreStackZoom)&&void 0!==o?o:{},spinner:null!==(i=e.spinner)&&void 0!==i?i:{},headerElement:null!==(a=e.headerElement)&&void 0!==a?a:{},incomingShimmerCard:null!==(s=e.incomingShimmerCard)&&void 0!==s?s:{},outgoingShimmerCard:null!==(l=e.outgoingShimmerCard)&&void 0!==l?l:{},incomingShimmerCardWrapper:null!==(c=e.incomingShimmerCardWrapper)&&void 0!==c?c:{},outgoingShimmerCardWrapper:null!==(u=e.outgoingShimmerCardWrapper)&&void 0!==u?u:{}}};function o(e){return r(e)}},86887:(e,t,n)=>{"use strict";n.d(t,{W:()=>h});var r=n(23182),o=n(61780);class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_FeedbackDiagnosticDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};var a,s=n(40769),l=n(98483),c=n(73246),u=n(79855),d=n(57574),p=n(89573),g=n(41148),m=n(91387),f=n(67349);!function(e){e.INACCURATE_OR_IRRELEVANT="inaccurate or irrelevant",e.OFFENSIVE="offensive",e.OTHER="other"}(a||(a={}));var h=function(e,t,n){return(0,r.__awaiter)(void 0,void 0,void 0,(function(){var o,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,F,M,B,U,H,G;return(0,r.__generator)(this,(function(z){try{if(o=JSON.parse(e),h=(new Date).toISOString(),v=function(e){var t,n,o,i,s,l=null!==(i=null===(o=null==e?void 0:e.elements)||void 0===o?void 0:o.options)&&void 0!==i?i:[],c="CopilotChatFeedback",u=0;try{for(var d=(0,r.__values)(l),p=d.next();!p.done;p=d.next())switch(null===(s=p.value.displayedText)||void 0===s?void 0:s.toLowerCase()){case a.INACCURATE_OR_IRRELEVANT:u=33554432;break;case a.OFFENSIVE:c="CopilotChatReportHarm",u=32;break;case a.OTHER:u=64}}catch(e){t={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return{AnswerType:c,FeedbackReasonType:u}}(null==o?void 0:o.responseContent),y=v.AnswerType,C=v.FeedbackReasonType,S=(0,f.Rx)(),b=null!==(x=null===(P=null===(w=null==o?void 0:o.responseContent)||void 0===w?void 0:w.elements.find((function(e){return e.userVerbatim})))||void 0===P?void 0:P.userVerbatim)&&void 0!==x?x:(null==o?void 0:o.responseContent)?JSON.stringify(o.responseContent):"",E=function(e){var t,n;return(null===(t=null==e?void 0:e.contextData)||void 0===t?void 0:t.sydneyContextData)?null===(n=null==e?void 0:e.contextData)||void 0===n?void 0:n.sydneyContextData:{conversationId:m.Pl,feedbackMessageId:(0,f.Xf)(),locale:(0,f.Tw)(),sydneyEndpoint:(0,f.cy)(),utteranceTimeStamp:(new Date).toISOString()}}(S),T=(0,f.cy)(),!E.feedbackMessageId&&!n||!E.conversationId||!T&&!E.sydneyEndpoint)return g.j.getInstance().sendTelemetryChatEventData([{key:p.h3.ChatEventType,value:p.a5.FeedbackDataSydneyDataMissing},{key:p.h3.ChatEventParameters,value:(null!==(L=null===(A=null===(k=S.contextData)||void 0===k?void 0:k.feedbackContextData)||void 0===A?void 0:A.errorMessage)&&void 0!==L?L:"")+(null!==(N=null===(O=null===(D=S.contextData)||void 0===D?void 0:D.feedbackContextData)||void 0===O?void 0:O.errorType)&&void 0!==N?N:"")}]),[2];I=Object.assign(new i,{responseData:{AnswerType:y,ClientName:t+"CopilotOCV",CorrelationId:(0,l.A)(),Date:h,Description:b,FeedbackId:null!==(R=null==o?void 0:o.diagnosticsUploadId)&&void 0!==R?R:(0,l.A)(),FeedbackRating:"Frown"===(null==o?void 0:o.feedbackType)?1:2,FeedbackReasonType:C,UserConsentGiven:null===(F=null==o?void 0:o.hostManagedContextDataConsent)||void 0===F||F,OptionalFields:{ConvId:E.conversationId,Endpoint:null!==(M=E.sydneyEndpoint)&&void 0!==M?M:T,Locale:null!==(B=E.locale)&&void 0!==B?B:"en-us",TraceId:null!==(U=E.feedbackMessageId)&&void 0!==U?U:(null===(H=E.requestId)||void 0===H?void 0:H.length)?E.requestId:"!TRACE_ID_NA",FeedbackSourceType:"OCV",UtteranceHappenTime:null!==(G=E.utteranceTimeStamp)&&void 0!==G?G:h,ContactMe:!!(null==o?void 0:o.userEmail)}}}),_=new s.g0({parentPath:["Signal",i.getTypeName()],items:[{id:u.r.generateId(),body:I}]}),(0,d.cY)("Submitting FeedbackDiagnosticDataSignal to Augloop : ".concat(i.getTypeName()," with signal: ").concat(JSON.stringify(_))),c.E.getInstance().submitOperation(_,i.getTypeName()),g.j.getInstance().sendTelemetryChatEventData([{key:p.h3.ChatEventType,value:p.a5.FeedbackDataUploadOperationSubmitted}])}catch(e){(0,d.cY)("Error parsing feedback response data",e.message)}return[2]}))}))}},78052:(e,t,n)=>{"use strict";n.d(t,{h:()=>C});var r,o=n(23182),i=n(10851);!function(e){e.DEV="DEV",e.DOGFOOD="DOGFOOD",e.PRODUCTION="PRODUCTION"}(r||(r={}));var a=n(70200),s=n(52421),l=n(78126),c=n(78404),u=function(e){var t,n="inapp-feedback-element-id";return e&&(t=document.getElementById(e)),t||(t=document.getElementById(n)),t||((t=document.createElement("div")).id=n,document.body.appendChild(t)),t},d=function(e,t,n){if(e)return e;var r="".concat(t,"Web");switch(n){case"PC":r="".concat(t,"Win32");break;case"MAC":r="".concat(t,"Mac");break;case"IOS":r="".concat(t,"iOS")}return r},p=n(8234),g=n(57574),m=n(78986),f=n(89169),h=n(57057),v=n(86887),y=n(67349),C=function(){function e(){}return e.prototype.isFeatureGateEnabledFromClient=function(e){return(0,g.cY)("Feature gate: ",e),!1},e.prototype.getNumberFeatureGateValueFromClient=function(e){return(0,g.cY)("Feature gate: ",e),NaN},e.prototype.sendLoggingEventToClient=function(e,t){(0,g.cY)("sendLoggingEventToClient: ",e),(0,g.cY)("loggingEventArgs: ",t)},e.prototype.updateCopilotState=function(e){(0,g.cY)("updateCopilotState: "+e)},e.prototype.feedbackButtonClicked=function(e,t,n,C,S){var b,E,T=h.w.getFeedbackSettings(),I=p.U.getInstance().getIsFluxFlowEnabled(),_=S&&(null===(b=document.getElementById(S))||void 0===b?void 0:b.innerText)?document.getElementById(S).innerText:void 0;(0,y.$s)(t),T&&(null===(E=T.feedbackInitOptions)||void 0===E?void 0:E.appId)&&function(e){(0,o.__awaiter)(void 0,[e],void 0,(function(e){var t,n,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,F,M,B=e.appData,U=e.featureAreaName,H=void 0===U?"Copilot":U,G=e.inAppFeedbackRef,z=e.specificHvcVersion,q=e.majorVersion,W=e.feedbackInitOptions,j=e.ocvFeedbackHost,V=e.platform,Q=e.appEnvironment,J=void 0===Q?r.DEV:Q,K=e.language,X=void 0===K?"en":K,Z=e.feedbackType,Y=e.feedbackData,$=e.buttonTarget,ee=e.isSydneyEnabled,te=e.aiResponseMessage,ne=e.lightTheme,re=e.darkTheme,oe=e.createAndSubmitFeedbackDataUploadSignal;return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return t=(0,l.A)(),W=(0,o.__assign)((0,o.__assign)({},W),{authenticationType:null!==(f=null==W?void 0:W.authenticationType)&&void 0!==f?f:i.sO.Unauthenticated,clientFeedbackId:t,clientName:j}),ne&&re?(n=(0,c.$x)(),W.themeOptions=n===a.G.defaultWhite?ne:re):W.themeOptions||(W.themeOptions=null!=ne?ne:{baseTheme:"WindowsLight"}),void 0!==W.isProduction&&null!==W.isProduction||(W.isProduction=J===r.PRODUCTION),W.telemetry=(0,o.__assign)((0,o.__assign)({},W.telemetry),{featureArea:null!==(h=null==Y?void 0:Y.feedbackArea)&&void 0!==h?h:H,sourceContext:ee?"CopilotChatFeedback":null===(v=W.telemetry)||void 0===v?void 0:v.sourceContext,featureName:null===(y=null==Y?void 0:Y.contextData)||void 0===y?void 0:y.featureName,subFeatureName:null===(C=null==Y?void 0:Y.contextData)||void 0===C?void 0:C.subFeatureName,entryPoint:null===(S=null==Y?void 0:Y.contextData)||void 0===S?void 0:S.entryPoint,integrationSource:null===(b=null==Y?void 0:Y.contextData)||void 0===b?void 0:b.integrationSource}),p=(null===(E=null==Y?void 0:Y.contextData)||void 0===E?void 0:E.feedbackCategory)===s.E.Error?i.wd.AIError:Z==i.MW.Smile?i.wd.AIThumbsUp:i.wd.AIThumbsDown,W.feedbackConfig=(0,o.__assign)((0,o.__assign)({},W.feedbackConfig),{appData:null!==(I=null===(T=W.feedbackConfig)||void 0===T?void 0:T.appData)&&void 0!==I?I:JSON.stringify(B),calloutTarget:$,featureAreas:void 0,feedbackForumUrl:void 0,feedbackUiType:i.CS.CallOut,initialFeedbackType:Z,invocationTimeStamp:Date.now(),isDisplayed:!0,isFeedbackForumEnabled:void 0,isFileUploadEnabled:void 0,isMyFeedbackEnabled:void 0,isScreenRecordingEnabled:void 0,isThankYouPageDisabled:!0,maxHeight:600,maxWidth:320,minHeight:void 0,minWidth:void 0,myFeedbackUrl:void 0,privacyUrl:void 0,retentionDurationDays:void 0,scenarioConfig:{isScenarioEnabled:!0,scenarioType:p},supportUrl:void 0,width:void 0,msInternalTitleTarget:void 0}),W.userData=(0,o.__assign)((0,o.__assign)({},W.userData),{aiPrompt:null===(w=null===(_=null==Y?void 0:Y.contextData)||void 0===_?void 0:_.feedbackContextData)||void 0===w?void 0:w.prompt,aiPromptId:null===(x=null===(P=null==Y?void 0:Y.contextData)||void 0===P?void 0:P.feedbackContextData)||void 0===x?void 0:x.promptId,aiErrorType:null===(A=null===(k=null==Y?void 0:Y.contextData)||void 0===k?void 0:k.feedbackContextData)||void 0===A?void 0:A.errorType,aiInteractionId:null===(D=null===(L=null==Y?void 0:Y.contextData)||void 0===L?void 0:L.feedbackContextData)||void 0===D?void 0:D.interactionId,aiResponseMessage:null!==(R=null===(N=null===(O=null==Y?void 0:Y.contextData)||void 0===O?void 0:O.feedbackContextData)||void 0===N?void 0:N.errorMessage)&&void 0!==R?R:te}),g=function(){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,o.__generator)(this,(function(n){return e=new File([null===(t=null==Y?void 0:Y.contextData)||void 0===t?void 0:t.cardMetaData],"contextData.json",{type:"text/json"}),[2,new Promise((function(t){t([e])}))]}))}))},W.feedbackConfig.diagnosticsConfig=(0,o.__assign)((0,o.__assign)({},W.feedbackConfig.diagnosticsConfig),{diagnosticsEndPoint:"ODS",diagnosticsUploadId:t,waitForDiagnosticsUpload:void 0,isShareContextDataEnabled:!0,getContextData:null!==(M=null===(F=W.feedbackConfig.diagnosticsConfig)||void 0===F?void 0:F.getContextData)&&void 0!==M?M:g}),oe&&(W.feedbackConfig.diagnosticsConfig=(0,o.__assign)((0,o.__assign)({},W.feedbackConfig.diagnosticsConfig),{extractFeedbackDataForHost:function(e){var t;oe(JSON.stringify(e),d(null===(t=null==Y?void 0:Y.contextData)||void 0===t?void 0:t.feedbackClientAppName,j,V))},isHostManagedContextDataEnabled:!0,isRetrieveFormDataEnabled:!0})),W.performanceTimestamps={invocationTimestamp:null==Y?void 0:Y.invocationTimestamp,integrationInitTimestamp:Date.now()},m={hostName:"AppChatCopilot",locale:X,inAppFeedbackRef:u(G),specificHvcVersion:z,majorVersion:q},[4,(0,i.yq)(m)];case 1:return e.sent(),(0,i.A8)(W),[2]}}))}))}((0,o.__assign)((0,o.__assign)({},T),{feedbackData:t,ocvFeedbackHost:h.w.getAppName(),platform:h.w.getAppPlatform(),language:h.w.getLanguage(),appEnvironment:h.w.getEnvironment(),feedbackType:e==m.Gb.LIKE?i.MW.Smile:i.MW.Frown,appData:null!=n?n:T.appData,buttonTarget:C,isSydneyEnabled:I,aiResponseMessage:this.isFeatureGateEnabledFromClient(f.WT.ExtractContentFromCardForFeedback)?_:void 0,createAndSubmitFeedbackDataUploadSignal:this.isFeatureGateEnabledFromClient(f.WT.EnableSendTenantFeedback)?v.W:void 0})),(0,g.cY)("feedbackButtonClicked: "+e),(0,g.cY)("feedbackData: "+t),(0,g.cY)("telemetryData: "+n)},e.prototype.getALSession=function(){throw new Error("Method not implemented.")},e.prototype.getHostSettings=function(){throw new Error("Method not implemented.")},e.prototype.getAuthToken=function(){throw new Error("Method not implemented.")},e.prototype.getPythonMode=function(){return!1},e.prototype.shouldIgnoreResponse=function(e){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){return[2,!1]}))}))},e.prototype.shouldSendRequestToAugloop=function(e,t,n,r){return(0,o.__awaiter)(this,void 0,void 0,(function(){return(0,o.__generator)(this,(function(e){return(0,g.cY)("shouldSendRequestToAugloop"),[2,!0]}))}))},e.prototype.getFeedbackData=function(){return{}},e.prototype.getOnClickHandler=function(e){return function(){}},e}()},30160:(e,t,n)=>{"use strict";n.d(t,{dW:()=>a,eR:()=>i,iK:()=>o});var r=n(78185),o=function(e,t){return void 0===e&&(e=r.KJ.Production),void 0===t&&(t=!0),t?new URL("https://euc.designerapp.officeapps.live.com"):e===r.KJ.Dogfood?new URL("https://designerapp.edog.officeapps.live.com"):new URL("https://designerapp.officeapps.live.com")},i=function(e,t){return void 0===e&&(e=r.KJ.Production),void 0===t&&(t=!0),e===r.KJ.Dogfood?new URL('https://cdn.edog.designerapp.osi.office.net/mini-app/index.html?fgoverrideJSON={"Microsoft.Designer.MiniApp.WindowResizeThrottleIntervalInMS":20}'.concat(t?"&enableOnePrompt=true":"")):new URL("https://cdn.designerapp.osi.office.net/mini-app/index.html".concat(t?"?enableOnePrompt=true":""))},a="https://designerappservice.officeapps.live.com"},78185:(e,t,n)=>{"use strict";n.d(t,{FR:()=>m,EW:()=>f,KJ:()=>i,lt:()=>s,lc:()=>h,N_:()=>y,Hz:()=>b,yV:()=>S,C1:()=>C});var r,o,i,a,s,l=n(13400),c=n(6474),u=(0,l.Ex)("officeaicopilot-designer.DesignerStrings.DesignerPreviewLabel"),d=(0,l.Ex)("officeaicopilot-designer.DesignerStrings.ChatCardSourceStockContent"),p=(0,l.Ex)("officeaicopilot-designer.DesignerStrings.ChatCardSourceEnterprise"),g=(0,l.Ex)("officeaicopilot-designer.DesignerStrings.ChatCardSourceDALLE");!function(e){e.UploadImage="Upload an image",e.GenerateImage="Generate image"}(r||(r={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent"}(o||(o={})),function(e){e.Dogfood="dogfood",e.Production="production"}(i||(i={})),function(e){e.WordCopilotChat="WordCopilotChat",e.PowerPointCopilotChat="PowerPointCopilotChat",e.ExcelCopilotChat="ExcelCopilotChat",e.M365CopilotChat="M365CopilotChat",e.TestApp="MiniTestApp"}(a||(a={})),function(e){e.Web="Web",e.Android="Android",e.iOS="iOS",e.MacOS="MacOS",e.Win32="Win32",e.WinRT="WinRT"}(s||(s={}));var m,f,h,v=function(){return"undefined"!=typeof OfficeaicopilotStrings},y=function(){var e=(0,c.Lh)(u);return v()?OfficeaicopilotStrings.DesignerPreviewLabel:null!=e?e:"Designer Preview"},C=function(){var e=(0,c.Lh)(d);return v()?OfficeaicopilotStrings.ChatCardSourceStockContent:null!=e?e:"From Microsoft 365 content library"},S=function(){var e=(0,c.Lh)(p);return v()?OfficeaicopilotStrings.ChatCardSourceEnterprise:null!=e?e:"From %s brand library"},b=function(){var e=(0,c.Lh)(g);return v()?OfficeaicopilotStrings.ChatCardSourceDALLE:null!=e?e:"Powered by DALL-E 3"};!function(e){e.DallEImages="DallEImages",e.DesignSuggestions="DesignSuggestions"}(m||(m={})),function(e){e.Production="Production",e.Dogfood="Dogfood",e.Automation="Automation",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Other="Other"}(f||(f={})),function(e){e.CopilotMessage="fai-CopilotMessage",e.UserMessage="fai-UserMessage"}(h||(h={}))},24582:(e,t,n)=>{"use strict";var r,o,i,a;n.d(t,{lC:()=>r}),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.EnumValueNotInUse=12]="EnumValueNotInUse",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized",e[e.UserThrottled=23]="UserThrottled",e[e.ScenarioThrottled=24]="ScenarioThrottled",e[e.InvalidFormatting=25]="InvalidFormatting",e[e.WorkflowQuotaLimitExceeded=26]="WorkflowQuotaLimitExceeded",e[e.UnsupportedRequirement=27]="UnsupportedRequirement",e[e.UrlPresentInInput=28]="UrlPresentInInput",e[e.DocumentUrlChangeDetected=29]="DocumentUrlChangeDetected",e[e.ExpectedError=30]="ExpectedError",e[e.BlockedByUserPrompt=31]="BlockedByUserPrompt",e[e.PromptDefinedError=32]="PromptDefinedError",e[e.FailedToGetFileContents=33]="FailedToGetFileContents",e[e.OutputBlockedByDynamicBlockList=34]="OutputBlockedByDynamicBlockList",e[e.ProtectedMaterial=35]="ProtectedMaterial",e[e.Skipped=36]="Skipped",e[e.DeferredRaiFailure=37]="DeferredRaiFailure",e[e.OutOfCredits=38]="OutOfCredits",e[e.InputGroundingAttackDetected=39]="InputGroundingAttackDetected"}(r||(r={})),function(e){e.text="text",e.image="image"}(o||(o={})),function(e){e.System="system",e.User="user",e.Assistant="assistant"}(i||(i={})),function(e){e.NotStarted="NotStarted",e.Running="Running",e.Succeeded="Succeeded"}(a||(a={}))},15689:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});var r="https://res.cdn.office.net/files/fabric-cdn-prod_20240805.001"},39931:(e,t,n)=>{"use strict";n.d(t,{JV:()=>o.JV,Px:()=>r.Px,Rm:()=>i.Rm,n_:()=>r.n_,sz:()=>r.sz});var r=n(5507),o=(n(58498),n(56089),n(89685)),i=n(18975);n(29323)},83851:(e,t,n)=>{"use strict";n.d(t,{n:()=>u});var r=n(23182),o=n(58651);function i(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function a(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(r){return[2,new Promise((function(r,o){var a=t.createElement("script");(null==n?void 0:n.createScriptURL)?a.src=n.createScriptURL(e.content):a.src=e.content,a.onload=function(){r()},a.onerror=function(){o(new Error("Dynamically loading script "+e.content+" failed"))},i(a,e.attributes),t.body.appendChild(a)}))]}))}))}function s(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(n){return[2,new Promise((function(n){var r=t.createElement("script"),o=t.createTextNode(e.content);r.appendChild(o),i(r,e.attributes),t.body.appendChild(r),n()}))]}))}))}function l(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",r.href=e.content,r.onload=function(){t()},r.onerror=function(){n(new Error("Dynamically loading style "+e.content+" failed"))},i(r,e.attributes),document.head.appendChild(r)}))]}))}))}function c(e){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(t){return[2,new Promise((function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var r=document.createTextNode(e.content);n.appendChild(r),i(n,e.attributes),document.head.appendChild(n),t()}))]}))}))}function u(e,t,n){return void 0===n&&(n=document),(0,r.__awaiter)(this,void 0,void 0,(function(){var i,d,p,g,m,f,h;return(0,r.__generator)(this,(function(v){switch(v.label){case 0:switch(e.type){case"parallel":return[3,1];case"sequential":return[3,5];case"scriptUrl":return[3,16];case"script":return[3,18];case"styleUrl":return[3,20];case"style":return[3,22]}return[3,24];case 1:return v.trys.push([1,3,,4]),[4,Promise.all(e.children.map((function(e){return u(e,t)})))];case 2:return v.sent(),[3,4];case 3:if(i=v.sent(),!e.optional)throw i;return o.log("Dynamic loading of optional script failed",i),[3,4];case 4:return[2];case 5:v.trys.push([5,14,,15]),v.label=6;case 6:v.trys.push([6,11,12,13]),d=(0,r.__values)(e.children),p=d.next(),v.label=7;case 7:return p.done?[3,10]:[4,u(p.value,t)];case 8:v.sent(),v.label=9;case 9:return p=d.next(),[3,7];case 10:return[3,13];case 11:return g=v.sent(),f={error:g},[3,13];case 12:try{p&&!p.done&&(h=d.return)&&h.call(d)}finally{if(f)throw f.error}return[7];case 13:return[3,15];case 14:if(m=v.sent(),!e.optional)throw m;return o.log("Dynamic loading of optional script failed",m),[3,15];case 15:return[2];case 16:return[4,a(e,n,t)];case 17:return v.sent(),[2];case 18:return[4,s(e,n)];case 19:return v.sent(),[2];case 20:return[4,l(e)];case 21:return v.sent(),[2];case 22:return[4,c(e)];case 23:return v.sent(),[2];case 24:throw new Error("Invalid script loader object "+JSON.stringify(e))}}))}))}},70804:(e,t,n)=>{"use strict";n.d(t,{Kx:()=>d,J8:()=>p});var r=n(23182),o=(n(11753),void 0);var i=n(89685);n(18975);function a(e){var t=e;try{"string"==typeof e&&(t=(t=t.replaceAll(/[a-zA-Z0-9_\-'.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/g,"<upn>").replaceAll(/[a-zA-Z0-9_\-'.]+%40[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+/g,"<upn>")).replaceAll(/eyJ0eX[A-Za-z0-9-_]+\.+[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=/]+/g,"<token>").replaceAll(/eyJhbG[A-Za-z0-9-_]+\.+[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=/]+/g,"<token>"))}catch(e){}return t}var s,l=n(58651);!function(e){e[e.Trace=0]="Trace",e[e.Info=1]="Info",e[e.Comment=2]="Comment",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(s||(s={}));var c=526460,u=!0;function d(e,t,n,d){var p=[],g=Promise.resolve(),m=0,f=e,h=t,v=n,y=d,C=!1,S=function(){0===p.length||u?C=!1:(C=!0,setTimeout((function(){b().catch((function(){}))}),1e3))},b=function(){return 0===p.length||u?(S(),Promise.resolve()):(g=new Promise((function(e,t){var n=new XMLHttpRequest;n.open("POST",h,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("x-ms-mac-hostingapp",v),n.setRequestHeader("x-ms-mac-appid",f),n.setRequestHeader("x-ms-mac-version",y),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(204!==n.status){var r=new Error("Request to /api/instrument/logclient failed, server responseCode: "+n.status+" body: "+n.response);return l.log(r),void t(r)}e()}};var r=p.splice(0,p.length);n.send(JSON.stringify(r))}))).then(S)};S();var E=function(e){p.push(e),C||S()};return{logger:function(e){if(!((0,i.fs)(e)||(0,i.pi)(e)||(0,i.Rj)(e))){m+=1;var t="",n="";try{if(null!==(t=function(){if(void 0===o)throw new Error("History object has not been set");return o}().location.pathname)&&-1!==t.indexOf(":")){var r=t.split(":");t=r[0],n=r[1]}}catch(e){t="",n=""}if((0,i.lf)(e))E({TagId:c,LogLevel:s.Info,LogCategory:i.nh.ClientAnalytics,Message:"UI Flight: "+e.flightName,Adhoc0:e.flightName,Adhoc1:JSON.stringify(e.flightData),Adhoc2:a(JSON.stringify(e.data)),Adhoc3:m.toString(),Adhoc5:a(n),PageName:a(t)});else{var l=parseInt(e.id,10);if(E({TagId:l,LogLevel:s.Info,LogCategory:e.logCategory||i.nh.ClientInfo,Message:a(e.message||""),Adhoc0:f,Adhoc1:m.toString(),Adhoc2:a(JSON.stringify({data:e.data})),Adhoc5:a(n),PageName:a(t)}),(0,i.bJ)(e)){var u=e.error.stack||"";E({TagId:500781,LogLevel:s.Error,LogCategory:e.logCategory||i.nh.ClientError,Message:a("UI Exception: "+(e.error.message||"")),Adhoc0:f,Adhoc1:m.toString(),Adhoc2:a(JSON.stringify({version:y,stack:u})),Adhoc3:l.toString(),Adhoc5:a(n),PageName:a(t)})}}}},flush:function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){return(0,r.__generator)(this,(function(e){return[2,Promise.all([g,b()]).then((function(){}))]}))}))}}}function p(){u=!1}},77809:(e,t,n)=>{"use strict";n.d(t,{A8:()=>f,yq:()=>p});var r,o,i=n(23182),a=n(39931),s=n(10480),l=n(62307),c=n(58123),u=n(7184),d=(r={},o=[],{register:function(e){return e&&o.push(e),r},unregister:function(e){var t=o.indexOf(e);t>-1&&o.splice(t,1)},updateFeedbackObject:function(e){var t=s.merge({},r,e);t=(0,u.UZ)(t),o.forEach((function(e){return e(t)}))},openFeedbackObject:function(e){e.feedbackConfig.isDisplayed=!0,e=(0,u.UZ)(e),o.forEach((function(t){return t(e)}))}});function p(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n,r,o,a,s,d,p;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,(0,u.fi)(e)];case 1:return i.sent(),m(),(null===(o=window.__inappfeedback_centro_integration_config)||void 0===o?void 0:o.unmountFunction)&&window.__inappfeedback_centro_integration_config.unmountFunction(),[4,window.__inappfeedback_centro_integration_config.loadInAppFeedbackPackage(e)];case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,6,,7]),(0,c.fH)("532392","DOM Bootstrap Started."),[4,window.__inappfeedback_centro_integration_config.bootstrapFeature({featureName:l.Cw})];case 4:return t=i.sent(),n=window.__inappfeedback_centro_integration_config,[4,t.main(e.inAppFeedbackRef)];case 5:return n.unmountFunction=i.sent(),(0,c.fH)("532392","DOM Bootstrap Completed."),[3,7];case 6:return r=i.sent(),(0,c.vV)("532385","Centro DOM bootstrap failed",r,{hostName:e.hostName,locale:e.locale,inAppFeedbackRefAvailable:!!e.inAppFeedbackRef,specificHvcVersion:null!==(a=e.specificHvcVersion)&&void 0!==a?a:null,majorVersion:null!==(s=e.majorVersion)&&void 0!==s?s:null,centroUrl:null!==(d=e.centroUrl)&&void 0!==d?d:null,enableUxVersionQueryParam:null!==(p=e.enableUxVersionQueryParam)&&void 0!==p?p:null}),[3,7];case 7:return(0,c.fH)("532386","InAppFeedback Component Initialization Completed."),[2]}}))}))}function g(e){return(0,i.__awaiter)(this,void 0,void 0,(function(){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,a.n_)((0,u.s1)(e)).catch((function(t){var n,r,o,i;(0,c.vV)("532383","Centro initialize failed",t,{hostName:e.hostName,locale:e.locale,inAppFeedbackRefAvailable:!!e.inAppFeedbackRef,specificHvcVersion:null!==(n=e.specificHvcVersion)&&void 0!==n?n:null,majorVersion:null!==(r=e.majorVersion)&&void 0!==r?r:null,centroUrl:null!==(o=e.centroUrl)&&void 0!==o?o:null,enableUxVersionQueryParam:null!==(i=e.enableUxVersionQueryParam)&&void 0!==i?i:null})}))];case 1:return r.sent(),(0,c.fH)("532444","Centro Runtime Initialization Completed."),t={dataSources:function(e){e(l.xx,d)}},n={featureName:l.Cw,adapters:t},(0,c.fH)("532448","Centro preloadFeature Started."),[4,(0,a.sz)(n).catch((function(t){var n,r,o,i;(0,c.vV)("532384","centro preloadFeature failed",t,{hostName:e.hostName,locale:e.locale,inAppFeedbackRefAvailable:!!e.inAppFeedbackRef,specificHvcVersion:null!==(n=e.specificHvcVersion)&&void 0!==n?n:null,majorVersion:null!==(r=e.majorVersion)&&void 0!==r?r:null,centroUrl:null!==(o=e.centroUrl)&&void 0!==o?o:null,enableUxVersionQueryParam:null!==(i=e.enableUxVersionQueryParam)&&void 0!==i?i:null})}))];case 2:return r.sent(),(0,c.fH)("532449","Centro preloadFeature Completed."),[2]}}))}))}var m=function(){window.__inappfeedback_centro_integration_config||(window.__inappfeedback_centro_integration_config={updateFeedbackOptions:d.updateFeedbackObject,openFeedback:d.openFeedbackObject,logInfo:c.fH,logError:c.vV,unmountFunction:function(){},bootstrapFeature:a.Px,loadInAppFeedbackPackage:g})};var f=function(e){var t;(null===(t=window.__inappfeedback_centro_integration_config)||void 0===t?void 0:t.openFeedback)?window.__inappfeedback_centro_integration_config.openFeedback(e):(0,c.vV)("532389","openFeedback not added to config",new Error(JSON.stringify(window.__inappfeedback_centro_integration_config)))}},58123:(e,t,n)=>{"use strict";n.d(t,{fH:()=>l,vV:()=>s});var r,o=n(23182),i=n(39931),a=n(62307);function s(e,t,n,r){throw(0,i.Rm)({id:e,type:i.JV.Error,message:"".concat(a.Q3,": ").concat(t),error:n,data:(0,o.__assign)((0,o.__assign)({},r),{timestamp:Date.now()})}),n}function l(e,t,n){(0,i.Rm)({id:e,type:i.JV.Info,message:"".concat(a.Q3,": ").concat(t),data:(0,o.__assign)((0,o.__assign)({},n),{timestamp:Date.now()})})}!function(e){e.FeedbackInitDataValidationError="532379",e.FeedbackIFrameInitDataValidationError="533188",e.LogInfoUnavailable="532380",e.LogErrorUnavailable="532381",e.CentroInitializeFailed="532383",e.CentroPreloadFeatureFailed="532384",e.CentroBootstrapFailed="532385",e.UnmountFeedbackUnavailable="532387",e.UpdateFeedbackOptionsUnavailable="532388",e.OpenFeedbackunavailable="532389",e.OpenFeedbackInIFrameRequest="533041",e.OpenFeedbackInIFrameComplete="533042",e.FeedbackComponentInitializationCompleted="532386",e.OpenFeedbackFormRequested="532390",e.FeedbackInitiated="532392",e.CentroRuntimeInitializeCompleted="532444",e.CentroPreloadFeatureStarted="532448",e.CentroPreloadFeatureCompleted="532449"}(r||(r={}))},27639:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(73090),o=n.n(r),i=n(28354),a=n.n(i)()(o());a.push([e.id,":root {\n  --bgColor: transparent;\n}\nhtml,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n  -webkit-font-smoothing: antialiased;\n}\n","",{version:3,sources:["webpack://./src/frontend/pages/ChatUiLanding/ChatUi.css"],names:[],mappings:"AAAA;EACE,sBAAsB;AACxB;AACA;;EAEE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,gCAAgC;EAChC,mCAAmC;AACrC",sourcesContent:[":root {\r\n  --bgColor: transparent;\r\n}\r\nhtml,\r\nbody {\r\n  height: 100%;\r\n  width: 100%;\r\n  overflow: hidden;\r\n  background-color: var(--bgColor);\r\n  -webkit-font-smoothing: antialiased;\r\n}\r\n"],sourceRoot:""}]);const s=a},28354:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},73090:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},55203:(e,t,n)=>{var r,o=n(58651);e.exports=function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};t[a][0].call(c.exports,(function(e){var n=t[a][1][e];return o(n||e)}),c,c.exports,e,t,n,r)}return n[a].exports}for(var i=void 0,a=0;a<r.length;a++)o(r[a]);return o}({"./aesprim":[function(e,t,n){!function(e,t){"use strict";"function"==typeof r&&r.amd?r(["exports"],t):t(void 0!==n?n:e.esprima={})}(this,(function(e){"use strict";var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y;function C(e,t){if(!e)throw new Error("ASSERT: "+t)}function S(e){return e>=48&&e<=57}function b(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function E(e){return"01234567".indexOf(e)>=0}function T(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function I(e){return 10===e||13===e||8232===e||8233===e}function _(e){return 64==e||36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&s.NonAsciiIdentifierStart.test(String.fromCharCode(e))}function w(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&s.NonAsciiIdentifierPart.test(String.fromCharCode(e))}function P(e){switch(e){case"class":case"enum":case"export":case"extends":case"import":case"super":return!0;default:return!1}}function x(e){switch(e){case"implements":case"interface":case"package":case"private":case"protected":case"public":case"static":case"yield":case"let":return!0;default:return!1}}function k(e){return"eval"===e||"arguments"===e}function A(e){if(u&&x(e))return!0;switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1}}function L(e,t,n,r,o){var i;C("number"==typeof n,"Comment must have valid position"),v.lastCommentStart>=n||(v.lastCommentStart=n,i={type:e,value:t},y.range&&(i.range=[n,r]),y.loc&&(i.loc=o),y.comments.push(i),y.attachComment&&(y.leadingComments.push(i),y.trailingComments.push(i)))}function D(e){var t,n,r,o;for(t=d-e,n={start:{line:p,column:d-g-e}};d<m;)if(r=c.charCodeAt(d),++d,I(r))return y.comments&&(o=c.slice(t+e,d-1),n.end={line:p,column:d-g-1},L("Line",o,t,d-1,n)),13===r&&10===c.charCodeAt(d)&&++d,++p,void(g=d);y.comments&&(o=c.slice(t+e,d),n.end={line:p,column:d-g},L("Line",o,t,d,n))}function O(){var e,t,n,r;for(y.comments&&(e=d-2,t={start:{line:p,column:d-g-2}});d<m;)if(I(n=c.charCodeAt(d)))13===n&&10===c.charCodeAt(d+1)&&++d,++p,++d,g=d,d>=m&&oe({},a.UnexpectedToken,"ILLEGAL");else if(42===n){if(47===c.charCodeAt(d+1))return++d,++d,void(y.comments&&(r=c.slice(e+2,d-2),t.end={line:p,column:d-g},L("Block",r,e,d,t)));++d}else++d;oe({},a.UnexpectedToken,"ILLEGAL")}function N(){var e,t;for(t=0===d;d<m;)if(T(e=c.charCodeAt(d)))++d;else if(I(e))++d,13===e&&10===c.charCodeAt(d)&&++d,++p,g=d,t=!0;else if(47===e)if(47===(e=c.charCodeAt(d+1)))++d,++d,D(2),t=!0;else{if(42!==e)break;++d,++d,O()}else if(t&&45===e){if(45!==c.charCodeAt(d+1)||62!==c.charCodeAt(d+2))break;d+=3,D(3)}else{if(60!==e)break;if("!--"!==c.slice(d+1,d+4))break;++d,++d,++d,++d,D(4)}}function R(e){var t,n,r,o=0;for(n="u"===e?4:2,t=0;t<n;++t){if(!(d<m&&b(c[d])))return"";r=c[d++],o=16*o+"0123456789abcdef".indexOf(r.toLowerCase())}return String.fromCharCode(o)}function F(){var e,t;for(e=c.charCodeAt(d++),t=String.fromCharCode(e),92===e&&(117!==c.charCodeAt(d)&&oe({},a.UnexpectedToken,"ILLEGAL"),++d,(e=R("u"))&&"\\"!==e&&_(e.charCodeAt(0))||oe({},a.UnexpectedToken,"ILLEGAL"),t=e);d<m&&w(e=c.charCodeAt(d));)++d,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==c.charCodeAt(d)&&oe({},a.UnexpectedToken,"ILLEGAL"),++d,(e=R("u"))&&"\\"!==e&&w(e.charCodeAt(0))||oe({},a.UnexpectedToken,"ILLEGAL"),t+=e);return t}function M(){var e,t;for(e=d++;d<m;){if(92===(t=c.charCodeAt(d)))return d=e,F();if(!w(t))break;++d}return c.slice(e,d)}function B(){var e,n;return e=d,{type:1===(n=92===c.charCodeAt(d)?F():M()).length?t.Identifier:A(n)?t.Keyword:"null"===n?t.NullLiteral:"true"===n||"false"===n?t.BooleanLiteral:t.Identifier,value:n,lineNumber:p,lineStart:g,start:e,end:d}}function U(){var e,n,r,o,i=d,s=c.charCodeAt(d),l=c[d];switch(s){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++d,y.tokenize&&(40===s?y.openParenToken=y.tokens.length:123===s&&(y.openCurlyToken=y.tokens.length)),{type:t.Punctuator,value:String.fromCharCode(s),lineNumber:p,lineStart:g,start:i,end:d};default:if(61===(e=c.charCodeAt(d+1)))switch(s){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return d+=2,{type:t.Punctuator,value:String.fromCharCode(s)+String.fromCharCode(e),lineNumber:p,lineStart:g,start:i,end:d};case 33:case 61:return d+=2,61===c.charCodeAt(d)&&++d,{type:t.Punctuator,value:c.slice(i,d),lineNumber:p,lineStart:g,start:i,end:d}}}return">>>="===(o=c.substr(d,4))?(d+=4,{type:t.Punctuator,value:o,lineNumber:p,lineStart:g,start:i,end:d}):">>>"===(r=o.substr(0,3))||"<<="===r||">>="===r?(d+=3,{type:t.Punctuator,value:r,lineNumber:p,lineStart:g,start:i,end:d}):l===(n=r.substr(0,2))[1]&&"+-<>&|".indexOf(l)>=0||"=>"===n?(d+=2,{type:t.Punctuator,value:n,lineNumber:p,lineStart:g,start:i,end:d}):"<>=!+-*%&|^/".indexOf(l)>=0?(++d,{type:t.Punctuator,value:l,lineNumber:p,lineStart:g,start:i,end:d}):void oe({},a.UnexpectedToken,"ILLEGAL")}function H(e){for(var n="";d<m&&b(c[d]);)n+=c[d++];return 0===n.length&&oe({},a.UnexpectedToken,"ILLEGAL"),_(c.charCodeAt(d))&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt("0x"+n,16),lineNumber:p,lineStart:g,start:e,end:d}}function G(e){for(var n="0"+c[d++];d<m&&E(c[d]);)n+=c[d++];return(_(c.charCodeAt(d))||S(c.charCodeAt(d)))&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseInt(n,8),octal:!0,lineNumber:p,lineStart:g,start:e,end:d}}function z(){var e,n,r;if(C(S((r=c[d]).charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),n=d,e="","."!==r){if(e=c[d++],r=c[d],"0"===e){if("x"===r||"X"===r)return++d,H(n);if(E(r))return G(n);r&&S(r.charCodeAt(0))&&oe({},a.UnexpectedToken,"ILLEGAL")}for(;S(c.charCodeAt(d));)e+=c[d++];r=c[d]}if("."===r){for(e+=c[d++];S(c.charCodeAt(d));)e+=c[d++];r=c[d]}if("e"===r||"E"===r)if(e+=c[d++],"+"!==(r=c[d])&&"-"!==r||(e+=c[d++]),S(c.charCodeAt(d)))for(;S(c.charCodeAt(d));)e+=c[d++];else oe({},a.UnexpectedToken,"ILLEGAL");return _(c.charCodeAt(d))&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.NumericLiteral,value:parseFloat(e),lineNumber:p,lineStart:g,start:n,end:d}}function q(){var e,n,r,o,i,s,l,u,f="",h=!1;for(l=p,u=g,C("'"===(e=c[d])||'"'===e,"String literal must starts with a quote"),n=d,++d;d<m;){if((r=c[d++])===e){e="";break}if("\\"===r)if((r=c[d++])&&I(r.charCodeAt(0)))++p,"\r"===r&&"\n"===c[d]&&++d,g=d;else switch(r){case"u":case"x":s=d,(i=R(r))?f+=i:(d=s,f+=r);break;case"n":f+="\n";break;case"r":f+="\r";break;case"t":f+="\t";break;case"b":f+="\b";break;case"f":f+="\f";break;case"v":f+="\v";break;default:E(r)?(0!==(o="01234567".indexOf(r))&&(h=!0),d<m&&E(c[d])&&(h=!0,o=8*o+"01234567".indexOf(c[d++]),"0123".indexOf(r)>=0&&d<m&&E(c[d])&&(o=8*o+"01234567".indexOf(c[d++]))),f+=String.fromCharCode(o)):f+=r}else{if(I(r.charCodeAt(0)))break;f+=r}}return""!==e&&oe({},a.UnexpectedToken,"ILLEGAL"),{type:t.StringLiteral,value:f,octal:h,startLineNumber:l,startLineStart:u,lineNumber:p,lineStart:g,start:n,end:d}}function W(e,t){var n;try{n=new RegExp(e,t)}catch(e){oe({},a.InvalidRegExp)}return n}function j(){var e,t,n,r;for(C("/"===(e=c[d]),"Regular expression literal must start with a slash"),t=c[d++],n=!1,r=!1;d<m;)if(t+=e=c[d++],"\\"===e)I((e=c[d++]).charCodeAt(0))&&oe({},a.UnterminatedRegExp),t+=e;else if(I(e.charCodeAt(0)))oe({},a.UnterminatedRegExp);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||oe({},a.UnterminatedRegExp),{value:t.substr(1,t.length-2),literal:t}}function V(){var e,t,n,r;for(t="",n="";d<m&&w((e=c[d]).charCodeAt(0));)if(++d,"\\"===e&&d<m)if("u"===(e=c[d])){if(r=++d,e=R("u"))for(n+=e,t+="\\u";r<d;++r)t+=c[r];else d=r,n+="u",t+="\\u";ie({},a.UnexpectedToken,"ILLEGAL")}else t+="\\",ie({},a.UnexpectedToken,"ILLEGAL");else n+=e,t+=e;return{value:n,literal:t}}function Q(){var e,n,r,o;return h=null,N(),e=d,n=j(),r=V(),o=W(n.value,r.value),y.tokenize?{type:t.RegularExpression,value:o,lineNumber:p,lineStart:g,start:e,end:d}:{literal:n.literal+r.literal,value:o,start:e,end:d}}function J(){var e,t,n,r;return N(),e=d,t={start:{line:p,column:d-g}},n=Q(),t.end={line:p,column:d-g},y.tokenize||(y.tokens.length>0&&(r=y.tokens[y.tokens.length-1]).range[0]===e&&"Punctuator"===r.type&&("/"!==r.value&&"/="!==r.value||y.tokens.pop()),y.tokens.push({type:"RegularExpression",value:n.literal,range:[e,d],loc:t})),n}function K(e){return e.type===t.Identifier||e.type===t.Keyword||e.type===t.BooleanLiteral||e.type===t.NullLiteral}function X(){var e,t;if(!(e=y.tokens[y.tokens.length-1]))return J();if("Punctuator"===e.type){if("]"===e.value)return U();if(")"===e.value)return!(t=y.tokens[y.openParenToken-1])||"Keyword"!==t.type||"if"!==t.value&&"while"!==t.value&&"for"!==t.value&&"with"!==t.value?U():J();if("}"===e.value){if(y.tokens[y.openCurlyToken-3]&&"Keyword"===y.tokens[y.openCurlyToken-3].type){if(!(t=y.tokens[y.openCurlyToken-4]))return U()}else{if(!y.tokens[y.openCurlyToken-4]||"Keyword"!==y.tokens[y.openCurlyToken-4].type)return U();if(!(t=y.tokens[y.openCurlyToken-5]))return J()}return r.indexOf(t.value)>=0?U():J()}return J()}return"Keyword"===e.type?J():U()}function Z(){var e;return N(),d>=m?{type:t.EOF,lineNumber:p,lineStart:g,start:d,end:d}:_(e=c.charCodeAt(d))?B():40===e||41===e||59===e?U():39===e||34===e?q():46===e?S(c.charCodeAt(d+1))?z():U():S(e)?z():y.tokenize&&47===e?X():U()}function Y(){var e,r,o;return N(),e={start:{line:p,column:d-g}},r=Z(),e.end={line:p,column:d-g},r.type!==t.EOF&&(o=c.slice(r.start,r.end),y.tokens.push({type:n[r.type],value:o,range:[r.start,r.end],loc:e})),r}function $(){var e;return d=(e=h).end,p=e.lineNumber,g=e.lineStart,h=void 0!==y.tokens?Y():Z(),d=e.end,p=e.lineNumber,g=e.lineStart,e}function ee(){var e,t,n;e=d,t=p,n=g,h=void 0!==y.tokens?Y():Z(),d=e,p=t,g=n}function te(e,t){this.line=e,this.column=t}function ne(e,t,n,r){this.start=new te(e,t),this.end=new te(n,r)}function re(){var e,t,n,r;return e=d,t=p,n=g,N(),r=p!==t,d=e,p=t,g=n,r}function oe(e,t){var n,r=Array.prototype.slice.call(arguments,2),o=t.replace(/%(\d)/g,(function(e,t){return C(t<r.length,"Message reference must be in range"),r[t]}));throw"number"==typeof e.lineNumber?((n=new Error("Line "+e.lineNumber+": "+o)).index=e.start,n.lineNumber=e.lineNumber,n.column=e.start-g+1):((n=new Error("Line "+p+": "+o)).index=d,n.lineNumber=p,n.column=d-g+1),n.description=o,n}function ie(){try{oe.apply(null,arguments)}catch(e){if(!y.errors)throw e;y.errors.push(e)}}function ae(e){if(e.type===t.EOF&&oe(e,a.UnexpectedEOS),e.type===t.NumericLiteral&&oe(e,a.UnexpectedNumber),e.type===t.StringLiteral&&oe(e,a.UnexpectedString),e.type===t.Identifier&&oe(e,a.UnexpectedIdentifier),e.type===t.Keyword){if(P(e.value))oe(e,a.UnexpectedReserved);else if(u&&x(e.value))return void ie(e,a.StrictReservedWord);oe(e,a.UnexpectedToken,e.value)}oe(e,a.UnexpectedToken,e.value)}function se(e){var n=$();n.type===t.Punctuator&&n.value===e||ae(n)}function le(e){var n=$();n.type===t.Keyword&&n.value===e||ae(n)}function ce(e){return h.type===t.Punctuator&&h.value===e}function ue(e){return h.type===t.Keyword&&h.value===e}function de(){var e;return h.type===t.Punctuator&&("="===(e=h.value)||"*="===e||"/="===e||"%="===e||"+="===e||"-="===e||"<<="===e||">>="===e||">>>="===e||"&="===e||"^="===e||"|="===e)}function pe(){var e;59===c.charCodeAt(d)||ce(";")?$():(e=p,N(),p===e&&(h.type===t.EOF||ce("}")||ae(h)))}function ge(e){return e.type===o.Identifier||e.type===o.MemberExpression}function me(){var e,t=[];for(e=h,se("[");!ce("]");)ce(",")?($(),t.push(null)):(t.push(Oe()),ce("]")||se(","));return $(),f.markEnd(f.createArrayExpression(t),e)}function fe(e,t){var n,r,o;return n=u,o=h,r=at(),t&&u&&k(e[0].name)&&ie(t,a.StrictParamName),u=n,f.markEnd(f.createFunctionExpression(null,e,[],r),o)}function he(){var e,n;return n=h,(e=$()).type===t.StringLiteral||e.type===t.NumericLiteral?(u&&e.octal&&ie(e,a.StrictOctalLiteral),f.markEnd(f.createLiteral(e),n)):f.markEnd(f.createIdentifier(e.value),n)}function ve(){var e,n,r,o,i,s;return s=h,(e=h).type===t.Identifier?(r=he(),"get"!==e.value||ce(":")?"set"!==e.value||ce(":")?(se(":"),o=Oe(),f.markEnd(f.createProperty("init",r,o),s)):(n=he(),se("("),(e=h).type!==t.Identifier?(se(")"),ie(e,a.UnexpectedToken,e.value),o=fe([])):(i=[Me()],se(")"),o=fe(i,e)),f.markEnd(f.createProperty("set",n,o),s)):(n=he(),se("("),se(")"),o=fe([]),f.markEnd(f.createProperty("get",n,o),s))):e.type!==t.EOF&&e.type!==t.Punctuator?(n=he(),se(":"),o=Oe(),f.markEnd(f.createProperty("init",n,o),s)):void ae(e)}function ye(){var e,t,n,r,s,l=[],c={},d=String;for(s=h,se("{");!ce("}");)t=(e=ve()).key.type===o.Identifier?e.key.name:d(e.key.value),r="init"===e.kind?i.Data:"get"===e.kind?i.Get:i.Set,n="$"+t,Object.prototype.hasOwnProperty.call(c,n)?(c[n]===i.Data?u&&r===i.Data?ie({},a.StrictDuplicateProperty):r!==i.Data&&ie({},a.AccessorDataProperty):r===i.Data?ie({},a.AccessorDataProperty):c[n]&r&&ie({},a.AccessorGetSet),c[n]|=r):c[n]=r,l.push(e),ce("}")||se(",");return se("}"),f.markEnd(f.createObjectExpression(l),s)}function Ce(){var e;return se("("),e=Ne(),se(")"),e}function Se(){var e,n,r,o;if(ce("("))return Ce();if(ce("["))return me();if(ce("{"))return ye();if(e=h.type,o=h,e===t.Identifier)r=f.createIdentifier($().value);else if(e===t.StringLiteral||e===t.NumericLiteral)u&&h.octal&&ie(h,a.StrictOctalLiteral),r=f.createLiteral($());else if(e===t.Keyword){if(ue("function"))return ct();ue("this")?($(),r=f.createThisExpression()):ae($())}else e===t.BooleanLiteral?((n=$()).value="true"===n.value,r=f.createLiteral(n)):e===t.NullLiteral?((n=$()).value=null,r=f.createLiteral(n)):ce("/")||ce("/=")?(r=void 0!==y.tokens?f.createLiteral(J()):f.createLiteral(Q()),ee()):ae($());return f.markEnd(r,o)}function be(){var e=[];if(se("("),!ce(")"))for(;d<m&&(e.push(Oe()),!ce(")"));)se(",");return se(")"),e}function Ee(){var e,t;return t=h,K(e=$())||ae(e),f.markEnd(f.createIdentifier(e.value),t)}function Te(){return se("."),Ee()}function Ie(){var e;return se("["),e=Ne(),se("]"),e}function _e(){var e,t,n;return n=h,le("new"),e=Pe(),t=ce("(")?be():[],f.markEnd(f.createNewExpression(e,t),n)}function we(){var e,t,n,r,o;for(o=h,e=v.allowIn,v.allowIn=!0,t=ue("new")?_e():Se(),v.allowIn=e;;){if(ce("."))r=Te(),t=f.createMemberExpression(".",t,r);else if(ce("("))n=be(),t=f.createCallExpression(t,n);else{if(!ce("["))break;r=Ie(),t=f.createMemberExpression("[",t,r)}f.markEnd(t,o)}return t}function Pe(){var e,t,n,r;for(r=h,e=v.allowIn,t=ue("new")?_e():Se(),v.allowIn=e;ce(".")||ce("[");)ce("[")?(n=Ie(),t=f.createMemberExpression("[",t,n)):(n=Te(),t=f.createMemberExpression(".",t,n)),f.markEnd(t,r);return t}function xe(){var e,n,r=h;return e=we(),h.type===t.Punctuator&&(!ce("++")&&!ce("--")||re()||(u&&e.type===o.Identifier&&k(e.name)&&ie({},a.StrictLHSPostfix),ge(e)||ie({},a.InvalidLHSInAssignment),n=$(),e=f.markEnd(f.createPostfixExpression(n.value,e),r))),e}function ke(){var e,n,r;return h.type!==t.Punctuator&&h.type!==t.Keyword?n=xe():ce("++")||ce("--")?(r=h,e=$(),n=ke(),u&&n.type===o.Identifier&&k(n.name)&&ie({},a.StrictLHSPrefix),ge(n)||ie({},a.InvalidLHSInAssignment),n=f.createUnaryExpression(e.value,n),n=f.markEnd(n,r)):ce("+")||ce("-")||ce("~")||ce("!")?(r=h,e=$(),n=ke(),n=f.createUnaryExpression(e.value,n),n=f.markEnd(n,r)):ue("delete")||ue("void")||ue("typeof")?(r=h,e=$(),n=ke(),n=f.createUnaryExpression(e.value,n),n=f.markEnd(n,r),u&&"delete"===n.operator&&n.argument.type===o.Identifier&&ie({},a.StrictDelete)):n=xe(),n}function Ae(e,n){var r=0;if(e.type!==t.Punctuator&&e.type!==t.Keyword)return 0;switch(e.value){case"||":r=1;break;case"&&":r=2;break;case"|":r=3;break;case"^":r=4;break;case"&":r=5;break;case"==":case"!=":case"===":case"!==":r=6;break;case"<":case">":case"<=":case">=":case"instanceof":r=7;break;case"in":r=n?7:0;break;case"<<":case">>":case">>>":r=8;break;case"+":case"-":r=9;break;case"*":case"/":case"%":r=11}return r}function Le(){var e,t,n,r,o,i,a,s,l,c;if(e=h,l=ke(),0===(o=Ae(r=h,v.allowIn)))return l;for(r.prec=o,$(),t=[e,h],i=[l,r,a=ke()];(o=Ae(h,v.allowIn))>0;){for(;i.length>2&&o<=i[i.length-2].prec;)a=i.pop(),s=i.pop().value,l=i.pop(),n=f.createBinaryExpression(s,l,a),t.pop(),e=t[t.length-1],f.markEnd(n,e),i.push(n);(r=$()).prec=o,i.push(r),t.push(h),n=ke(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)n=f.createBinaryExpression(i[c-1].value,i[c-2],n),c-=2,e=t.pop(),f.markEnd(n,e);return n}function De(){var e,t,n,r,o;return o=h,e=Le(),ce("?")&&($(),t=v.allowIn,v.allowIn=!0,n=Oe(),v.allowIn=t,se(":"),r=Oe(),e=f.createConditionalExpression(e,n,r),f.markEnd(e,o)),e}function Oe(){var e,t,n,r,i;return e=h,i=h,r=t=De(),de()&&(ge(t)||ie({},a.InvalidLHSInAssignment),u&&t.type===o.Identifier&&k(t.name)&&ie(e,a.StrictLHSAssignment),e=$(),n=Oe(),r=f.markEnd(f.createAssignmentExpression(e.value,t,n),i)),r}function Ne(){var e,t=h;if(e=Oe(),ce(",")){for(e=f.createSequenceExpression([e]);d<m&&ce(",");)$(),e.expressions.push(Oe());f.markEnd(e,t)}return e}function Re(){for(var e,t=[];d<m&&!ce("}")&&void 0!==(e=ut());)t.push(e);return t}function Fe(){var e,t;return t=h,se("{"),e=Re(),se("}"),f.markEnd(f.createBlockStatement(e),t)}function Me(){var e,n;return n=h,(e=$()).type!==t.Identifier&&ae(e),f.markEnd(f.createIdentifier(e.value),n)}function Be(e){var t,n,r=null;return n=h,t=Me(),u&&k(t.name)&&ie({},a.StrictVarName),"const"===e?(se("="),r=Oe()):ce("=")&&($(),r=Oe()),f.markEnd(f.createVariableDeclarator(t,r),n)}function Ue(e){var t=[];do{if(t.push(Be(e)),!ce(","))break;$()}while(d<m);return t}function He(){var e;return le("var"),e=Ue(),pe(),f.createVariableDeclaration(e,"var")}function Ge(e){var t,n;return n=h,le(e),t=Ue(e),pe(),f.markEnd(f.createVariableDeclaration(t,e),n)}function ze(){return se(";"),f.createEmptyStatement()}function qe(){var e=Ne();return pe(),f.createExpressionStatement(e)}function We(){var e,t,n;return le("if"),se("("),e=Ne(),se(")"),t=it(),ue("else")?($(),n=it()):n=null,f.createIfStatement(e,t,n)}function je(){var e,t,n;return le("do"),n=v.inIteration,v.inIteration=!0,e=it(),v.inIteration=n,le("while"),se("("),t=Ne(),se(")"),ce(";")&&$(),f.createDoWhileStatement(e,t)}function Ve(){var e,t,n;return le("while"),se("("),e=Ne(),se(")"),n=v.inIteration,v.inIteration=!0,t=it(),v.inIteration=n,f.createWhileStatement(e,t)}function Qe(){var e,t,n;return n=h,e=$(),t=Ue(),f.markEnd(f.createVariableDeclaration(t,e.value),n)}function Je(){var e,t,n,r,o,i,s;return e=t=n=null,le("for"),se("("),ce(";")?$():(ue("var")||ue("let")?(v.allowIn=!1,e=Qe(),v.allowIn=!0,1===e.declarations.length&&ue("in")&&($(),r=e,o=Ne(),e=null)):(v.allowIn=!1,e=Ne(),v.allowIn=!0,ue("in")&&(ge(e)||ie({},a.InvalidLHSInForIn),$(),r=e,o=Ne(),e=null)),void 0===r&&se(";")),void 0===r&&(ce(";")||(t=Ne()),se(";"),ce(")")||(n=Ne())),se(")"),s=v.inIteration,v.inIteration=!0,i=it(),v.inIteration=s,void 0===r?f.createForStatement(e,t,n,i):f.createForInStatement(r,o,i)}function Ke(){var e,n=null;return le("continue"),59===c.charCodeAt(d)?($(),v.inIteration||oe({},a.IllegalContinue),f.createContinueStatement(null)):re()?(v.inIteration||oe({},a.IllegalContinue),f.createContinueStatement(null)):(h.type===t.Identifier&&(e="$"+(n=Me()).name,Object.prototype.hasOwnProperty.call(v.labelSet,e)||oe({},a.UnknownLabel,n.name)),pe(),null!==n||v.inIteration||oe({},a.IllegalContinue),f.createContinueStatement(n))}function Xe(){var e,n=null;return le("break"),59===c.charCodeAt(d)?($(),v.inIteration||v.inSwitch||oe({},a.IllegalBreak),f.createBreakStatement(null)):re()?(v.inIteration||v.inSwitch||oe({},a.IllegalBreak),f.createBreakStatement(null)):(h.type===t.Identifier&&(e="$"+(n=Me()).name,Object.prototype.hasOwnProperty.call(v.labelSet,e)||oe({},a.UnknownLabel,n.name)),pe(),null!==n||v.inIteration||v.inSwitch||oe({},a.IllegalBreak),f.createBreakStatement(n))}function Ze(){var e=null;return le("return"),v.inFunctionBody||ie({},a.IllegalReturn),32===c.charCodeAt(d)&&_(c.charCodeAt(d+1))?(e=Ne(),pe(),f.createReturnStatement(e)):re()?f.createReturnStatement(null):(ce(";")||ce("}")||h.type===t.EOF||(e=Ne()),pe(),f.createReturnStatement(e))}function Ye(){var e,t;return u&&(N(),ie({},a.StrictModeWith)),le("with"),se("("),e=Ne(),se(")"),t=it(),f.createWithStatement(e,t)}function $e(){var e,t,n,r=[];for(n=h,ue("default")?($(),e=null):(le("case"),e=Ne()),se(":");d<m&&!(ce("}")||ue("default")||ue("case"));)t=it(),r.push(t);return f.markEnd(f.createSwitchCase(e,r),n)}function et(){var e,t,n,r,o;if(le("switch"),se("("),e=Ne(),se(")"),se("{"),t=[],ce("}"))return $(),f.createSwitchStatement(e,t);for(r=v.inSwitch,v.inSwitch=!0,o=!1;d<m&&!ce("}");)null===(n=$e()).test&&(o&&oe({},a.MultipleDefaultsInSwitch),o=!0),t.push(n);return v.inSwitch=r,se("}"),f.createSwitchStatement(e,t)}function tt(){var e;return le("throw"),re()&&oe({},a.NewlineAfterThrow),e=Ne(),pe(),f.createThrowStatement(e)}function nt(){var e,t,n;return n=h,le("catch"),se("("),ce(")")&&ae(h),e=Me(),u&&k(e.name)&&ie({},a.StrictCatchVariable),se(")"),t=Fe(),f.markEnd(f.createCatchClause(e,t),n)}function rt(){var e,t=[],n=null;return le("try"),e=Fe(),ue("catch")&&t.push(nt()),ue("finally")&&($(),n=Fe()),0!==t.length||n||oe({},a.NoCatchOrFinally),f.createTryStatement(e,[],t,n)}function ot(){return le("debugger"),pe(),f.createDebuggerStatement()}function it(){var e,n,r,i,s=h.type;if(s===t.EOF&&ae(h),s===t.Punctuator&&"{"===h.value)return Fe();if(i=h,s===t.Punctuator)switch(h.value){case";":return f.markEnd(ze(),i);case"(":return f.markEnd(qe(),i)}if(s===t.Keyword)switch(h.value){case"break":return f.markEnd(Xe(),i);case"continue":return f.markEnd(Ke(),i);case"debugger":return f.markEnd(ot(),i);case"do":return f.markEnd(je(),i);case"for":return f.markEnd(Je(),i);case"function":return f.markEnd(lt(),i);case"if":return f.markEnd(We(),i);case"return":return f.markEnd(Ze(),i);case"switch":return f.markEnd(et(),i);case"throw":return f.markEnd(tt(),i);case"try":return f.markEnd(rt(),i);case"var":return f.markEnd(He(),i);case"while":return f.markEnd(Ve(),i);case"with":return f.markEnd(Ye(),i)}return(e=Ne()).type===o.Identifier&&ce(":")?($(),r="$"+e.name,Object.prototype.hasOwnProperty.call(v.labelSet,r)&&oe({},a.Redeclaration,"Label",e.name),v.labelSet[r]=!0,n=it(),delete v.labelSet[r],f.markEnd(f.createLabeledStatement(e,n),i)):(pe(),f.markEnd(f.createExpressionStatement(e),i))}function at(){var e,n,r,i,s,l,p,g,y=[];for(g=h,se("{");d<m&&h.type===t.StringLiteral&&(n=h,e=ut(),y.push(e),e.expression.type===o.Literal);)"use strict"===c.slice(n.start+1,n.end-1)?(u=!0,r&&ie(r,a.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(i=v.labelSet,s=v.inIteration,l=v.inSwitch,p=v.inFunctionBody,v.labelSet={},v.inIteration=!1,v.inSwitch=!1,v.inFunctionBody=!0;d<m&&!ce("}")&&void 0!==(e=ut());)y.push(e);return se("}"),v.labelSet=i,v.inIteration=s,v.inSwitch=l,v.inFunctionBody=p,f.markEnd(f.createBlockStatement(y),g)}function st(e){var t,n,r,o,i,s,l=[];if(se("("),!ce(")"))for(o={};d<m&&(n=h,t=Me(),i="$"+n.value,u?(k(n.value)&&(r=n,s=a.StrictParamName),Object.prototype.hasOwnProperty.call(o,i)&&(r=n,s=a.StrictParamDupe)):e||(k(n.value)?(e=n,s=a.StrictParamName):x(n.value)?(e=n,s=a.StrictReservedWord):Object.prototype.hasOwnProperty.call(o,i)&&(e=n,s=a.StrictParamDupe)),l.push(t),o[i]=!0,!ce(")"));)se(",");return se(")"),{params:l,stricted:r,firstRestricted:e,message:s}}function lt(){var e,t,n,r,o,i,s,l,c,d=[];return c=h,le("function"),n=h,e=Me(),u?k(n.value)&&ie(n,a.StrictFunctionName):k(n.value)?(i=n,s=a.StrictFunctionName):x(n.value)&&(i=n,s=a.StrictReservedWord),d=(o=st(i)).params,r=o.stricted,i=o.firstRestricted,o.message&&(s=o.message),l=u,t=at(),u&&i&&oe(i,s),u&&r&&ie(r,s),u=l,f.markEnd(f.createFunctionDeclaration(e,d,[],t),c)}function ct(){var e,t,n,r,o,i,s,l,c=null,d=[];return l=h,le("function"),ce("(")||(e=h,c=Me(),u?k(e.value)&&ie(e,a.StrictFunctionName):k(e.value)?(n=e,r=a.StrictFunctionName):x(e.value)&&(n=e,r=a.StrictReservedWord)),d=(o=st(n)).params,t=o.stricted,n=o.firstRestricted,o.message&&(r=o.message),s=u,i=at(),u&&n&&oe(n,r),u&&t&&ie(t,r),u=s,f.markEnd(f.createFunctionExpression(c,d,[],i),l)}function ut(){if(h.type===t.Keyword)switch(h.value){case"const":case"let":return Ge(h.value);case"function":return lt();default:return it()}if(h.type!==t.EOF)return it()}function dt(){for(var e,n,r,i=[];d<m&&(n=h).type===t.StringLiteral&&(e=ut(),i.push(e),e.expression.type===o.Literal);)"use strict"===c.slice(n.start+1,n.end-1)?(u=!0,r&&ie(r,a.StrictOctalLiteral)):!r&&n.octal&&(r=n);for(;d<m&&void 0!==(e=ut());)i.push(e);return i}function pt(){var e,t;return N(),ee(),t=h,u=!1,e=dt(),f.markEnd(f.createProgram(e),t)}function gt(){var e,t,n,r=[];for(e=0;e<y.tokens.length;++e)n={type:(t=y.tokens[e]).type,value:t.value},y.range&&(n.range=t.range),y.loc&&(n.loc=t.loc),r.push(n);y.tokens=r}function mt(e,n){var r;"string"==typeof e||e instanceof String||(e=String(e)),f=l,d=0,p=(c=e).length>0?1:0,g=0,m=c.length,h=null,v={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},y={},(n=n||{}).tokens=!0,y.tokens=[],y.tokenize=!0,y.openParenToken=-1,y.openCurlyToken=-1,y.range="boolean"==typeof n.range&&n.range,y.loc="boolean"==typeof n.loc&&n.loc,"boolean"==typeof n.comment&&n.comment&&(y.comments=[]),"boolean"==typeof n.tolerant&&n.tolerant&&(y.errors=[]);try{if(ee(),h.type===t.EOF)return y.tokens;for($();h.type!==t.EOF;)try{$()}catch(e){if(y.errors){y.errors.push(e);break}throw e}gt(),r=y.tokens,void 0!==y.comments&&(r.comments=y.comments),void 0!==y.errors&&(r.errors=y.errors)}catch(e){throw e}finally{y={}}return r}function ft(e,t){var n,r;r=String,"string"==typeof e||e instanceof String||(e=r(e)),f=l,d=0,p=(c=e).length>0?1:0,g=0,m=c.length,h=null,v={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},y={},void 0!==t&&(y.range="boolean"==typeof t.range&&t.range,y.loc="boolean"==typeof t.loc&&t.loc,y.attachComment="boolean"==typeof t.attachComment&&t.attachComment,y.loc&&null!==t.source&&void 0!==t.source&&(y.source=r(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(y.tokens=[]),"boolean"==typeof t.comment&&t.comment&&(y.comments=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(y.errors=[]),y.attachComment&&(y.range=!0,y.comments=[],y.bottomRightStack=[],y.trailingComments=[],y.leadingComments=[]));try{n=pt(),void 0!==y.comments&&(n.comments=y.comments),void 0!==y.tokens&&(gt(),n.tokens=y.tokens),void 0!==y.errors&&(n.errors=y.errors)}catch(e){throw e}finally{y={}}return n}(n={})[(t={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9}).BooleanLiteral]="Boolean",n[t.EOF]="<end>",n[t.Identifier]="Identifier",n[t.Keyword]="Keyword",n[t.NullLiteral]="Null",n[t.NumericLiteral]="Numeric",n[t.Punctuator]="Punctuator",n[t.StringLiteral]="String",n[t.RegularExpression]="RegularExpression",r=["(","{","[","in","typeof","instanceof","new","return","case","delete","throw","void","=","+=","-=","*=","/=","%=","<<=",">>=",">>>=","&=","|=","^=",",","+","-","*","/","%","++","--","<<",">>",">>>","&","|","^","!","~","&&","||","?",":","===","==",">=","<=","<",">","!=","!=="],o={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SwitchStatement:"SwitchStatement",SwitchCase:"SwitchCase",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement"},i={Data:1,Get:2,Set:4},a={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},s={NonAsciiIdentifierStart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]"),NonAsciiIdentifierPart:new RegExp("[------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]")},l={name:"SyntaxTree",processComment:function(e){var t,n;if(!(e.type===o.Program&&e.body.length>0)){for(y.trailingComments.length>0?y.trailingComments[0].range[0]>=e.range[1]?(n=y.trailingComments,y.trailingComments=[]):y.trailingComments.length=0:y.bottomRightStack.length>0&&y.bottomRightStack[y.bottomRightStack.length-1].trailingComments&&y.bottomRightStack[y.bottomRightStack.length-1].trailingComments[0].range[0]>=e.range[1]&&(n=y.bottomRightStack[y.bottomRightStack.length-1].trailingComments,delete y.bottomRightStack[y.bottomRightStack.length-1].trailingComments);y.bottomRightStack.length>0&&y.bottomRightStack[y.bottomRightStack.length-1].range[0]>=e.range[0];)t=y.bottomRightStack.pop();t?t.leadingComments&&t.leadingComments[t.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=t.leadingComments,delete t.leadingComments):y.leadingComments.length>0&&y.leadingComments[y.leadingComments.length-1].range[1]<=e.range[0]&&(e.leadingComments=y.leadingComments,y.leadingComments=[]),n&&(e.trailingComments=n),y.bottomRightStack.push(e)}},markEnd:function(e,t){return y.range&&(e.range=[t.start,d]),y.loc&&(e.loc=new ne(void 0===t.startLineNumber?t.lineNumber:t.startLineNumber,t.start-(void 0===t.startLineStart?t.lineStart:t.startLineStart),p,d-g),this.postProcess(e)),y.attachComment&&this.processComment(e),e},postProcess:function(e){return y.source&&(e.loc.source=y.source),e},createArrayExpression:function(e){return{type:o.ArrayExpression,elements:e}},createAssignmentExpression:function(e,t,n){return{type:o.AssignmentExpression,operator:e,left:t,right:n}},createBinaryExpression:function(e,t,n){return{type:"||"===e||"&&"===e?o.LogicalExpression:o.BinaryExpression,operator:e,left:t,right:n}},createBlockStatement:function(e){return{type:o.BlockStatement,body:e}},createBreakStatement:function(e){return{type:o.BreakStatement,label:e}},createCallExpression:function(e,t){return{type:o.CallExpression,callee:e,arguments:t}},createCatchClause:function(e,t){return{type:o.CatchClause,param:e,body:t}},createConditionalExpression:function(e,t,n){return{type:o.ConditionalExpression,test:e,consequent:t,alternate:n}},createContinueStatement:function(e){return{type:o.ContinueStatement,label:e}},createDebuggerStatement:function(){return{type:o.DebuggerStatement}},createDoWhileStatement:function(e,t){return{type:o.DoWhileStatement,body:e,test:t}},createEmptyStatement:function(){return{type:o.EmptyStatement}},createExpressionStatement:function(e){return{type:o.ExpressionStatement,expression:e}},createForStatement:function(e,t,n,r){return{type:o.ForStatement,init:e,test:t,update:n,body:r}},createForInStatement:function(e,t,n){return{type:o.ForInStatement,left:e,right:t,body:n,each:!1}},createFunctionDeclaration:function(e,t,n,r){return{type:o.FunctionDeclaration,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createFunctionExpression:function(e,t,n,r){return{type:o.FunctionExpression,id:e,params:t,defaults:n,body:r,rest:null,generator:!1,expression:!1}},createIdentifier:function(e){return{type:o.Identifier,name:e}},createIfStatement:function(e,t,n){return{type:o.IfStatement,test:e,consequent:t,alternate:n}},createLabeledStatement:function(e,t){return{type:o.LabeledStatement,label:e,body:t}},createLiteral:function(e){return{type:o.Literal,value:e.value,raw:c.slice(e.start,e.end)}},createMemberExpression:function(e,t,n){return{type:o.MemberExpression,computed:"["===e,object:t,property:n}},createNewExpression:function(e,t){return{type:o.NewExpression,callee:e,arguments:t}},createObjectExpression:function(e){return{type:o.ObjectExpression,properties:e}},createPostfixExpression:function(e,t){return{type:o.UpdateExpression,operator:e,argument:t,prefix:!1}},createProgram:function(e){return{type:o.Program,body:e}},createProperty:function(e,t,n){return{type:o.Property,key:t,value:n,kind:e}},createReturnStatement:function(e){return{type:o.ReturnStatement,argument:e}},createSequenceExpression:function(e){return{type:o.SequenceExpression,expressions:e}},createSwitchCase:function(e,t){return{type:o.SwitchCase,test:e,consequent:t}},createSwitchStatement:function(e,t){return{type:o.SwitchStatement,discriminant:e,cases:t}},createThisExpression:function(){return{type:o.ThisExpression}},createThrowStatement:function(e){return{type:o.ThrowStatement,argument:e}},createTryStatement:function(e,t,n,r){return{type:o.TryStatement,block:e,guardedHandlers:t,handlers:n,finalizer:r}},createUnaryExpression:function(e,t){return"++"===e||"--"===e?{type:o.UpdateExpression,operator:e,argument:t,prefix:!0}:{type:o.UnaryExpression,operator:e,argument:t,prefix:!0}},createVariableDeclaration:function(e,t){return{type:o.VariableDeclaration,declarations:e,kind:t}},createVariableDeclarator:function(e,t){return{type:o.VariableDeclarator,id:e,init:t}},createWhileStatement:function(e,t){return{type:o.WhileStatement,test:e,body:t}},createWithStatement:function(e,t){return{type:o.WithStatement,object:e,body:t}}},e.version="1.2.2",e.tokenize=mt,e.parse=ft,e.Syntax=function(){var e,t={};for(e in"function"==typeof Object.create&&(t=Object.create(null)),o)o.hasOwnProperty(e)&&(t[e]=o[e]);return"function"==typeof Object.freeze&&Object.freeze(t),t}()}))},{}],1:[function(e,t,n){(function(r){var i=function(){var e={trace:function(){},yy:{},symbols_:{error:2,JSON_PATH:3,DOLLAR:4,PATH_COMPONENTS:5,LEADING_CHILD_MEMBER_EXPRESSION:6,PATH_COMPONENT:7,MEMBER_COMPONENT:8,SUBSCRIPT_COMPONENT:9,CHILD_MEMBER_COMPONENT:10,DESCENDANT_MEMBER_COMPONENT:11,DOT:12,MEMBER_EXPRESSION:13,DOT_DOT:14,STAR:15,IDENTIFIER:16,SCRIPT_EXPRESSION:17,INTEGER:18,END:19,CHILD_SUBSCRIPT_COMPONENT:20,DESCENDANT_SUBSCRIPT_COMPONENT:21,"[":22,SUBSCRIPT:23,"]":24,SUBSCRIPT_EXPRESSION:25,SUBSCRIPT_EXPRESSION_LIST:26,SUBSCRIPT_EXPRESSION_LISTABLE:27,",":28,STRING_LITERAL:29,ARRAY_SLICE:30,FILTER_EXPRESSION:31,QQ_STRING:32,Q_STRING:33,$accept:0,$end:1},terminals_:{2:"error",4:"DOLLAR",12:"DOT",14:"DOT_DOT",15:"STAR",16:"IDENTIFIER",17:"SCRIPT_EXPRESSION",18:"INTEGER",19:"END",22:"[",24:"]",28:",",30:"ARRAY_SLICE",31:"FILTER_EXPRESSION",32:"QQ_STRING",33:"Q_STRING"},productions_:[0,[3,1],[3,2],[3,1],[3,2],[5,1],[5,2],[7,1],[7,1],[8,1],[8,1],[10,2],[6,1],[11,2],[13,1],[13,1],[13,1],[13,1],[13,1],[9,1],[9,1],[20,3],[21,4],[23,1],[23,1],[26,1],[26,3],[27,1],[27,1],[27,1],[25,1],[25,1],[25,1],[29,1],[29,1]],performAction:function(e,n,r,o,i,a,s){o.ast||(o.ast=t,t.initialize());var l=a.length-1;switch(i){case 1:return o.ast.set({expression:{type:"root",value:a[l]}}),o.ast.unshift(),o.ast.yield();case 2:return o.ast.set({expression:{type:"root",value:a[l-1]}}),o.ast.unshift(),o.ast.yield();case 3:return o.ast.unshift(),o.ast.yield();case 4:return o.ast.set({operation:"member",scope:"child",expression:{type:"identifier",value:a[l-1]}}),o.ast.unshift(),o.ast.yield();case 5:case 6:case 11:case 13:case 18:case 21:case 22:case 23:break;case 7:o.ast.set({operation:"member"}),o.ast.push();break;case 8:o.ast.set({operation:"subscript"}),o.ast.push();break;case 9:case 19:o.ast.set({scope:"child"});break;case 10:case 20:o.ast.set({scope:"descendant"});break;case 12:o.ast.set({scope:"child",operation:"member"});break;case 14:o.ast.set({expression:{type:"wildcard",value:a[l]}});break;case 15:o.ast.set({expression:{type:"identifier",value:a[l]}});break;case 16:o.ast.set({expression:{type:"script_expression",value:a[l]}});break;case 17:o.ast.set({expression:{type:"numeric_literal",value:parseInt(a[l])}});break;case 24:a[l].length>1?o.ast.set({expression:{type:"union",value:a[l]}}):this.$=a[l];break;case 25:this.$=[a[l]];break;case 26:this.$=a[l-2].concat(a[l]);break;case 27:this.$={expression:{type:"numeric_literal",value:parseInt(a[l])}},o.ast.set(this.$);break;case 28:this.$={expression:{type:"string_literal",value:a[l]}},o.ast.set(this.$);break;case 29:this.$={expression:{type:"slice",value:a[l]}},o.ast.set(this.$);break;case 30:this.$={expression:{type:"wildcard",value:a[l]}},o.ast.set(this.$);break;case 31:this.$={expression:{type:"script_expression",value:a[l]}},o.ast.set(this.$);break;case 32:this.$={expression:{type:"filter_expression",value:a[l]}},o.ast.set(this.$);break;case 33:case 34:this.$=a[l]}},table:[{3:1,4:[1,2],6:3,13:4,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{1:[3]},{1:[2,1],5:10,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,3],5:21,7:11,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,12],12:[2,12],14:[2,12],22:[2,12]},{1:[2,14],12:[2,14],14:[2,14],22:[2,14]},{1:[2,15],12:[2,15],14:[2,15],22:[2,15]},{1:[2,16],12:[2,16],14:[2,16],22:[2,16]},{1:[2,17],12:[2,17],14:[2,17],22:[2,17]},{1:[2,18],12:[2,18],14:[2,18],22:[2,18]},{1:[2,2],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,5],12:[2,5],14:[2,5],22:[2,5]},{1:[2,7],12:[2,7],14:[2,7],22:[2,7]},{1:[2,8],12:[2,8],14:[2,8],22:[2,8]},{1:[2,9],12:[2,9],14:[2,9],22:[2,9]},{1:[2,10],12:[2,10],14:[2,10],22:[2,10]},{1:[2,19],12:[2,19],14:[2,19],22:[2,19]},{1:[2,20],12:[2,20],14:[2,20],22:[2,20]},{13:23,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9]},{13:24,15:[1,5],16:[1,6],17:[1,7],18:[1,8],19:[1,9],22:[1,25]},{15:[1,29],17:[1,30],18:[1,33],23:26,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{1:[2,4],7:22,8:12,9:13,10:14,11:15,12:[1,18],14:[1,19],20:16,21:17,22:[1,20]},{1:[2,6],12:[2,6],14:[2,6],22:[2,6]},{1:[2,11],12:[2,11],14:[2,11],22:[2,11]},{1:[2,13],12:[2,13],14:[2,13],22:[2,13]},{15:[1,29],17:[1,30],18:[1,33],23:38,25:27,26:28,27:32,29:34,30:[1,35],31:[1,31],32:[1,36],33:[1,37]},{24:[1,39]},{24:[2,23]},{24:[2,24],28:[1,40]},{24:[2,30]},{24:[2,31]},{24:[2,32]},{24:[2,25],28:[2,25]},{24:[2,27],28:[2,27]},{24:[2,28],28:[2,28]},{24:[2,29],28:[2,29]},{24:[2,33],28:[2,33]},{24:[2,34],28:[2,34]},{24:[1,41]},{1:[2,21],12:[2,21],14:[2,21],22:[2,21]},{18:[1,33],27:42,29:34,30:[1,35],32:[1,36],33:[1,37]},{1:[2,22],12:[2,22],14:[2,22],22:[2,22]},{24:[2,26],28:[2,26]}],defaultActions:{27:[2,23],29:[2,30],30:[2,31],31:[2,32]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){var t=this,n=[0],r=[null],o=[],i=this.table,a="",s=0,l=0,c=0,u=2,d=1,p=o.slice.call(arguments,1);this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,void 0===this.lexer.yylloc&&(this.lexer.yylloc={});var g=this.lexer.yylloc;o.push(g);var m=this.lexer.options&&this.lexer.options.ranges;function f(){var e;return"number"!=typeof(e=t.lexer.lex()||d)&&(e=t.symbols_[e]||e),e}"function"==typeof this.yy.parseError?this.parseError=this.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var h,v,y,C,S,b,E,T,I,_={};;){if(y=n[n.length-1],this.defaultActions[y]?C=this.defaultActions[y]:(null==h&&(h=f()),C=i[y]&&i[y][h]),void 0===C||!C.length||!C[0]){var w="";for(b in I=[],i[y])this.terminals_[b]&&b>u&&I.push("'"+this.terminals_[b]+"'");w=this.lexer.showPosition?"Parse error on line "+(s+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+I.join(", ")+", got '"+(this.terminals_[h]||h)+"'":"Parse error on line "+(s+1)+": Unexpected "+(h==d?"end of input":"'"+(this.terminals_[h]||h)+"'"),this.parseError(w,{text:this.lexer.match,token:this.terminals_[h]||h,line:this.lexer.yylineno,loc:g,expected:I})}if(C[0]instanceof Array&&C.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+h);switch(C[0]){case 1:n.push(h),r.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(C[1]),h=null,v?(h=v,v=null):(l=this.lexer.yyleng,a=this.lexer.yytext,s=this.lexer.yylineno,g=this.lexer.yylloc,c>0&&c--);break;case 2:if(E=this.productions_[C[1]][1],_.$=r[r.length-E],_._$={first_line:o[o.length-(E||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(E||1)].first_column,last_column:o[o.length-1].last_column},m&&(_._$.range=[o[o.length-(E||1)].range[0],o[o.length-1].range[1]]),void 0!==(S=this.performAction.apply(_,[a,l,s,this.yy,C[1],r,o].concat(p))))return S;E&&(n=n.slice(0,-1*E*2),r=r.slice(0,-1*E),o=o.slice(0,-1*E)),n.push(this.productions_[C[1]][0]),r.push(_.$),o.push(_._$),T=i[n[n.length-2]][n[n.length-1]],n.push(T);break;case 3:return!0}}return!0}},t={initialize:function(){this._nodes=[],this._node={},this._stash=[]},set:function(e){for(var t in e)this._node[t]=e[t];return this._node},node:function(e){return arguments.length&&(this._node=e),this._node},push:function(){this._nodes.push(this._node),this._node={}},unshift:function(){this._nodes.unshift(this._node),this._node={}},yield:function(){var e=this._nodes;return this.initialize(),e}},n={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(r=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((n=this._input.match(this.rules[o[i]]))&&(!t||n[0].length>t[0].length)){if(t=n,r=i,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,o[i])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,o[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:return 4;case 1:return 14;case 2:return 12;case 3:return 15;case 4:return 16;case 5:return 22;case 6:return 24;case 7:return 28;case 8:return 30;case 9:return 18;case 10:return t.yytext=t.yytext.substr(1,t.yyleng-2),32;case 11:return t.yytext=t.yytext.substr(1,t.yyleng-2),33;case 12:return 17;case 13:return 31}},rules:[/^(?:\$)/,/^(?:\.\.)/,/^(?:\.)/,/^(?:\*)/,/^(?:[a-zA-Z_]+[a-zA-Z0-9_]*)/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?:((-?(?:0|[1-9][0-9]*)))?\:((-?(?:0|[1-9][0-9]*)))?(\:((-?(?:0|[1-9][0-9]*)))?)?)/,/^(?:(-?(?:0|[1-9][0-9]*)))/,/^(?:"(?:\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^"\\])*")/,/^(?:'(?:\\['bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^'\\])*')/,/^(?:\(.+?\)(?=\]))/,/^(?:\?\(.+?\)(?=\]))/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};function r(){this.yy={}}return e.lexer=n,r.prototype=e,e.Parser=r,new r}();void 0!==e&&void 0!==n&&(n.parser=i,n.Parser=i.Parser,n.parse=function(){return i.parse.apply(i,arguments)},n.main=function(t){t[1]||(o.log("Usage: "+t[0]+" FILE"),r.exit(1));var i=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(i)},void 0!==t&&e.main===t&&n.main(r.argv.slice(1)))}).call(this,e("_process"))},{_process:14,fs:12,path:13}],2:[function(e,t,n){t.exports={identifier:"[a-zA-Z_]+[a-zA-Z0-9_]*",integer:"-?(?:0|[1-9][0-9]*)",qq_string:'"(?:\\\\["bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^"\\\\])*"',q_string:"'(?:\\\\['bfnrt/\\\\]|\\\\u[a-fA-F0-9]{4}|[^'\\\\])*'"}},{}],3:[function(e,t,n){var r=e("./dict"),o=e("fs"),i={lex:{macros:{esc:"\\\\",int:r.integer},rules:[["\\$","return 'DOLLAR'"],["\\.\\.","return 'DOT_DOT'"],["\\.","return 'DOT'"],["\\*","return 'STAR'"],[r.identifier,"return 'IDENTIFIER'"],["\\[","return '['"],["\\]","return ']'"],[",","return ','"],["({int})?\\:({int})?(\\:({int})?)?","return 'ARRAY_SLICE'"],["{int}","return 'INTEGER'"],[r.qq_string,"yytext = yytext.substr(1,yyleng-2); return 'QQ_STRING';"],[r.q_string,"yytext = yytext.substr(1,yyleng-2); return 'Q_STRING';"],["\\(.+?\\)(?=\\])","return 'SCRIPT_EXPRESSION'"],["\\?\\(.+?\\)(?=\\])","return 'FILTER_EXPRESSION'"]]},start:"JSON_PATH",bnf:{JSON_PATH:[["DOLLAR",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["DOLLAR PATH_COMPONENTS",'yy.ast.set({ expression: { type: "root", value: $1 } }); yy.ast.unshift(); return yy.ast.yield()'],["LEADING_CHILD_MEMBER_EXPRESSION","yy.ast.unshift(); return yy.ast.yield()"],["LEADING_CHILD_MEMBER_EXPRESSION PATH_COMPONENTS",'yy.ast.set({ operation: "member", scope: "child", expression: { type: "identifier", value: $1 }}); yy.ast.unshift(); return yy.ast.yield()']],PATH_COMPONENTS:[["PATH_COMPONENT",""],["PATH_COMPONENTS PATH_COMPONENT",""]],PATH_COMPONENT:[["MEMBER_COMPONENT",'yy.ast.set({ operation: "member" }); yy.ast.push()'],["SUBSCRIPT_COMPONENT",'yy.ast.set({ operation: "subscript" }); yy.ast.push() ']],MEMBER_COMPONENT:[["CHILD_MEMBER_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_MEMBER_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_MEMBER_COMPONENT:[["DOT MEMBER_EXPRESSION",""]],LEADING_CHILD_MEMBER_EXPRESSION:[["MEMBER_EXPRESSION",'yy.ast.set({ scope: "child", operation: "member" })']],DESCENDANT_MEMBER_COMPONENT:[["DOT_DOT MEMBER_EXPRESSION",""]],MEMBER_EXPRESSION:[["STAR",'yy.ast.set({ expression: { type: "wildcard", value: $1 } })'],["IDENTIFIER",'yy.ast.set({ expression: { type: "identifier", value: $1 } })'],["SCRIPT_EXPRESSION",'yy.ast.set({ expression: { type: "script_expression", value: $1 } })'],["INTEGER",'yy.ast.set({ expression: { type: "numeric_literal", value: parseInt($1) } })'],["END",""]],SUBSCRIPT_COMPONENT:[["CHILD_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "child" })'],["DESCENDANT_SUBSCRIPT_COMPONENT",'yy.ast.set({ scope: "descendant" })']],CHILD_SUBSCRIPT_COMPONENT:[["[ SUBSCRIPT ]",""]],DESCENDANT_SUBSCRIPT_COMPONENT:[["DOT_DOT [ SUBSCRIPT ]",""]],SUBSCRIPT:[["SUBSCRIPT_EXPRESSION",""],["SUBSCRIPT_EXPRESSION_LIST",'$1.length > 1? yy.ast.set({ expression: { type: "union", value: $1 } }) : $$ = $1']],SUBSCRIPT_EXPRESSION_LIST:[["SUBSCRIPT_EXPRESSION_LISTABLE","$$ = [$1]"],["SUBSCRIPT_EXPRESSION_LIST , SUBSCRIPT_EXPRESSION_LISTABLE","$$ = $1.concat($3)"]],SUBSCRIPT_EXPRESSION_LISTABLE:[["INTEGER",'$$ = { expression: { type: "numeric_literal", value: parseInt($1) } }; yy.ast.set($$)'],["STRING_LITERAL",'$$ = { expression: { type: "string_literal", value: $1 } }; yy.ast.set($$)'],["ARRAY_SLICE",'$$ = { expression: { type: "slice", value: $1 } }; yy.ast.set($$)']],SUBSCRIPT_EXPRESSION:[["STAR",'$$ = { expression: { type: "wildcard", value: $1 } }; yy.ast.set($$)'],["SCRIPT_EXPRESSION",'$$ = { expression: { type: "script_expression", value: $1 } }; yy.ast.set($$)'],["FILTER_EXPRESSION",'$$ = { expression: { type: "filter_expression", value: $1 } }; yy.ast.set($$)']],STRING_LITERAL:[["QQ_STRING","$$ = $1"],["Q_STRING","$$ = $1"]]}};o.readFileSync&&(i.moduleInclude=o.readFileSync(e.resolve("../include/module.js")),i.actionInclude=o.readFileSync(e.resolve("../include/action.js"))),t.exports=i},{"./dict":2,fs:12}],4:[function(e,t,n){var r=e("./aesprim"),o=e("./slice"),i=e("static-eval"),a=e("underscore").uniq,s=function(){return this.initialize.apply(this,arguments)};function l(t,n,o){var i=e("./index"),a=m(r.parse(n).body[0].expression,{"@":t.value}),s=o.replace(/\{\{\s*value\s*\}\}/g,a),l=i.nodes(t.value,s);return l.forEach((function(e){e.path=t.path.concat(e.path.slice(1))})),l}function c(e){return Array.isArray(e)}function u(e){return e&&!(e instanceof Array)&&e instanceof Object}function d(e){return function(t,n,r,o){var i=t.value,a=t.path,s=[],l=function(t,i){c(t)?(t.forEach((function(e,t){s.length>=o||r(t,e,n)&&s.push({path:i.concat(t),value:e})})),t.forEach((function(t,n){s.length>=o||e&&l(t,i.concat(n))}))):u(t)&&(this.keys(t).forEach((function(e){s.length>=o||r(e,t[e],n)&&s.push({path:i.concat(e),value:t[e]})})),this.keys(t).forEach((function(n){s.length>=o||e&&l(t[n],i.concat(n))})))}.bind(this);return l(i,a),s}}function p(e){return function(t,n,r){return this.descend(n,t.expression.value,e,r)}}function g(e){return function(t,n,r){return this.traverse(n,t.expression.value,e,r)}}function m(){try{return i.apply(this,arguments)}catch(e){}}function f(e){return e=e.filter((function(e){return e})),a(e,(function(e){return e.path.map((function(e){return String(e).replace("-","--")})).join("-")}))}function h(e){var t=String(e);return t.match(/^-?[0-9]+$/)?parseInt(t):null}s.prototype.initialize=function(){this.traverse=d(!0),this.descend=d()},s.prototype.keys=Object.keys,s.prototype.resolve=function(e){var t=[e.operation,e.scope,e.expression.type].join("-"),n=this._fns[t];if(!n)throw new Error("couldn't resolve key: "+t);return n.bind(this)},s.prototype.register=function(e,t){if(!t instanceof Function)throw new Error("handler must be a function");this._fns[e]=t},s.prototype._fns={"member-child-identifier":function(e,t){var n=e.expression.value,r=t.value;if(r instanceof Object&&n in r)return[{value:r[n],path:t.path.concat(n)}]},"member-descendant-identifier":g((function(e,t,n){return e==n})),"subscript-child-numeric_literal":p((function(e,t,n){return e===n})),"member-child-numeric_literal":p((function(e,t,n){return String(e)===String(n)})),"subscript-descendant-numeric_literal":g((function(e,t,n){return e===n})),"member-child-wildcard":p((function(){return!0})),"member-descendant-wildcard":g((function(){return!0})),"subscript-descendant-wildcard":g((function(){return!0})),"subscript-child-wildcard":p((function(){return!0})),"subscript-child-slice":function(e,t){if(c(t.value)){var n=e.expression.value.split(":").map(h),r=t.value.map((function(e,n){return{value:e,path:t.path.concat(n)}}));return o.apply(null,[r].concat(n))}},"subscript-child-union":function(e,t){var n=[];return e.expression.value.forEach((function(e){var r={operation:"subscript",scope:"child",expression:e.expression},o=this.resolve(r)(r,t);o&&(n=n.concat(o))}),this),f(n)},"subscript-descendant-union":function(t,n,r){var o=e(".."),i=this,a=[];return o.nodes(n,"$..*").slice(1).forEach((function(e){a.length>=r||t.expression.value.forEach((function(t){var n={operation:"subscript",scope:"child",expression:t.expression},r=i.resolve(n)(n,e);a=a.concat(r)}))})),f(a)},"subscript-child-filter_expression":function(e,t,n){var o=e.expression.value.slice(2,-1),i=r.parse(o).body[0].expression,a=function(e,t){return m(i,{"@":t})};return this.descend(t,null,a,n)},"subscript-descendant-filter_expression":function(e,t,n){var o=e.expression.value.slice(2,-1),i=r.parse(o).body[0].expression,a=function(e,t){return m(i,{"@":t})};return this.traverse(t,null,a,n)},"subscript-child-script_expression":function(e,t){return l(t,e.expression.value.slice(1,-1),"$[{{value}}]")},"member-child-script_expression":function(e,t){return l(t,e.expression.value.slice(1,-1),"$.{{value}}")},"member-descendant-script_expression":function(e,t){return l(t,e.expression.value.slice(1,-1),"$..value")}},s.prototype._fns["subscript-child-string_literal"]=s.prototype._fns["member-child-identifier"],s.prototype._fns["member-descendant-numeric_literal"]=s.prototype._fns["subscript-descendant-string_literal"]=s.prototype._fns["member-descendant-identifier"],t.exports=s},{"..":"jsonpath","./aesprim":"./aesprim","./index":5,"./slice":7,"static-eval":15,underscore:12}],5:[function(e,t,n){var r=e("assert"),o=e("./dict"),i=e("./parser"),a=e("./handlers"),s=function(){this.initialize.apply(this,arguments)};function l(e){return"[object String]"==Object.prototype.toString.call(e)}s.prototype.initialize=function(){this.parser=new i,this.handlers=new a},s.prototype.parse=function(e){return r.ok(l(e),"we need a path"),this.parser.parse(e)},s.prototype.parent=function(e,t){r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path");var n=this.nodes(e,t)[0];return n.path.pop(),this.value(e,n.path)},s.prototype.apply=function(e,t,n){r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),r.equal(typeof n,"function","fn needs to be function");var o=this.nodes(e,t).sort((function(e,t){return t.path.length-e.path.length}));return o.forEach((function(t){var r=t.path.pop(),o=this.value(e,this.stringify(t.path)),i=t.value=n.call(e,o[r]);o[r]=i}),this),o},s.prototype.value=function(e,t,n){if(r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),arguments.length>=3){var o=this.nodes(e,t).shift();if(!o)return this._vivify(e,t,n);var i=o.path.slice(-1).shift();this.parent(e,this.stringify(o.path))[i]=n}return this.query(e,this.stringify(t),1).shift()},s.prototype._vivify=function(e,t,n){var o=this;r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path");var i=this.parser.parse(t).map((function(e){return e.expression.value})),a=function(t,n){var r=t.pop(),i=o.value(e,t);i||(a(t.concat(),"string"==typeof r?{}:[]),i=o.value(e,t)),i[r]=n};return a(i,n),this.query(e,t)[0]},s.prototype.query=function(e,t,n){return r.ok(e instanceof Object,"obj needs to be an object"),r.ok(l(t),"we need a path"),this.nodes(e,t,n).map((function(e){return e.value}))},s.prototype.paths=function(e,t,n){return r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),this.nodes(e,t,n).map((function(e){return e.path}))},s.prototype.nodes=function(e,t,n){if(r.ok(e instanceof Object,"obj needs to be an object"),r.ok(t,"we need a path"),0===n)return[];var o=this.parser.parse(t),i=this.handlers,a=[{path:["$"],value:e}],s=[];return o.length&&"root"==o[0].expression.type&&o.shift(),o.length?(o.forEach((function(e,t){if(!(s.length>=n)){var r=i.resolve(e),l=[];a.forEach((function(i){if(!(s.length>=n)){var a=r(e,i,n);t==o.length-1?s=s.concat(a||[]):l=l.concat(a||[])}})),a=l}})),n?s.slice(0,n):s):a},s.prototype.stringify=function(e){r.ok(e,"we need a path");var t="$",n={"descendant-member":"..{{value}}","child-member":".{{value}}","descendant-subscript":"..[{{value}}]","child-subscript":"[{{value}}]"};return(e=this._normalize(e)).forEach((function(e){if("root"!=e.expression.type){var r,o=[e.scope,e.operation].join("-"),i=n[o];if(r="string_literal"==e.expression.type?JSON.stringify(e.expression.value):e.expression.value,!i)throw new Error("couldn't find template "+o);t+=i.replace(/{{value}}/,r)}})),t},s.prototype._normalize=function(e){if(r.ok(e,"we need a path"),"string"==typeof e)return this.parser.parse(e);if(Array.isArray(e)&&"string"==typeof e[0]){var t=[{expression:{type:"root",value:"$"}}];return e.forEach((function(e,n){if("$"!=e||0!==n)if("string"==typeof e&&e.match("^"+o.identifier+"$"))t.push({operation:"member",scope:"child",expression:{value:e,type:"identifier"}});else{var r="number"==typeof e?"numeric_literal":"string_literal";t.push({operation:"subscript",scope:"child",expression:{value:e,type:r}})}})),t}if(Array.isArray(e)&&"object"==typeof e[0])return e;throw new Error("couldn't understand path "+e)},s.Handlers=a,s.Parser=i;var c=new s;c.JSONPath=s,t.exports=c},{"./dict":2,"./handlers":4,"./parser":6,assert:8}],6:[function(e,t,n){var r=e("./grammar"),o=e("../generated/parser"),i=function(){var e=new o.Parser,t=e.parseError;return e.yy.parseError=function(){e.yy.ast&&e.yy.ast.initialize(),t.apply(e,arguments)},e};i.grammar=r,t.exports=i},{"../generated/parser":1,"./grammar":3}],7:[function(e,t,n){function r(e){return String(e).match(/^[0-9]+$/)?parseInt(e):Number.isFinite(e)?parseInt(e,10):0}t.exports=function(e,t,n,o){if("string"==typeof t)throw new Error("start cannot be a string");if("string"==typeof n)throw new Error("end cannot be a string");if("string"==typeof o)throw new Error("step cannot be a string");var i=e.length;if(0===o)throw new Error("step cannot be zero");if(o=o?r(o):1,n=n<0?i+n:n,t=r(0===(t=t<0?i+t:t)?0:t||(o>0?0:i-1)),n=r(0===n?0:n||(o>0?i:-1)),t=o>0?Math.max(0,t):Math.min(i,t),n=o>0?Math.min(n,i):Math.max(-1,n),o>0&&n<=t)return[];if(o<0&&t<=n)return[];for(var a=[],s=t;s!=n&&!(o<0&&s<=n||o>0&&s>=n);s+=o)a.push(e[s]);return a}},{}],8:[function(e,t,n){var r=e("util/"),o=Array.prototype.slice,i=Object.prototype.hasOwnProperty,a=t.exports=d;function s(e,t){return r.isUndefined(t)?""+t:r.isNumber(t)&&!isFinite(t)||r.isFunction(t)||r.isRegExp(t)?t.toString():t}function l(e,t){return r.isString(e)?e.length<t?e:e.slice(0,t):e}function c(e){return l(JSON.stringify(e.actual,s),128)+" "+e.operator+" "+l(JSON.stringify(e.expected,s),128)}function u(e,t,n,r,o){throw new a.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:o})}function d(e,t){e||u(e,!0,t,"==",a.ok)}function p(e,t){if(e===t)return!0;if(r.isBuffer(e)&&r.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return r.isDate(e)&&r.isDate(t)?e.getTime()===t.getTime():r.isRegExp(e)&&r.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:r.isObject(e)||r.isObject(t)?m(e,t):e==t}function g(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function m(e,t){if(r.isNullOrUndefined(e)||r.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;if(r.isPrimitive(e)||r.isPrimitive(t))return e===t;var n=g(e),i=g(t);if(n&&!i||!n&&i)return!1;if(n)return p(e=o.call(e),t=o.call(t));var a,s,l=v(e),c=v(t);if(l.length!=c.length)return!1;for(l.sort(),c.sort(),s=l.length-1;s>=0;s--)if(l[s]!=c[s])return!1;for(s=l.length-1;s>=0;s--)if(!p(e[a=l[s]],t[a]))return!1;return!0}function f(e,t){return!(!e||!t)&&("[object RegExp]"==Object.prototype.toString.call(t)?t.test(e):e instanceof t||!0===t.call({},e))}function h(e,t,n,o){var i;r.isString(n)&&(o=n,n=null);try{t()}catch(e){i=e}if(o=(n&&n.name?" ("+n.name+").":".")+(o?" "+o:"."),e&&!i&&u(i,n,"Missing expected exception"+o),!e&&f(i,n)&&u(i,n,"Got unwanted exception"+o),e&&i&&n&&!f(i,n)||!e&&i)throw i}a.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=c(this),this.generatedMessage=!0);var t=e.stackStartFunction||u;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,o=t.name,i=r.indexOf("\n"+o);if(i>=0){var a=r.indexOf("\n",i+1);r=r.substring(a+1)}this.stack=r}}},r.inherits(a.AssertionError,Error),a.fail=u,a.ok=d,a.equal=function(e,t,n){e!=t&&u(e,t,n,"==",a.equal)},a.notEqual=function(e,t,n){e==t&&u(e,t,n,"!=",a.notEqual)},a.deepEqual=function(e,t,n){p(e,t)||u(e,t,n,"deepEqual",a.deepEqual)},a.notDeepEqual=function(e,t,n){p(e,t)&&u(e,t,n,"notDeepEqual",a.notDeepEqual)},a.strictEqual=function(e,t,n){e!==t&&u(e,t,n,"===",a.strictEqual)},a.notStrictEqual=function(e,t,n){e===t&&u(e,t,n,"!==",a.notStrictEqual)},a.throws=function(e,t,n){h.apply(this,[!0].concat(o.call(arguments)))},a.doesNotThrow=function(e,t){h.apply(this,[!1].concat(o.call(arguments)))},a.ifError=function(e){if(e)throw e};var v=Object.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t}},{"util/":11}],9:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],10:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],11:[function(e,t,r){(function(t,n){var i=/%[sdj%]/g;r.format=function(e){if(!T(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(l(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])S(s)||!P(s)?a+=" "+s:a+=" "+l(s);return a},r.deprecate=function(e,i){if(_(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(!0===t.noDeprecation)return e;var a=!1;function s(){if(!a){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?o.trace(i):o.error(i),a=!0}return e.apply(this,arguments)}return s};var a,s={};function l(e,t){var n={seen:[],stylize:u};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),C(t)?n.showHidden=t:t&&r._extend(n,t),_(n.showHidden)&&(n.showHidden=!1),_(n.depth)&&(n.depth=2),_(n.colors)&&(n.colors=!1),_(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),p(n,e,n.depth)}function c(e,t){var n=l.styles[t];return n?"["+l.colors[n][0]+"m"+e+"["+l.colors[n][1]+"m":e}function u(e,t){return e}function d(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}function p(e,t,n){if(e.customInspect&&t&&A(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(n,e);return T(o)||(o=p(e,o,n)),o}var i=g(e,t);if(i)return i;var a=Object.keys(t),s=d(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),k(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return m(t);if(0===a.length){if(A(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(w(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(x(t))return e.stylize(Date.prototype.toString.call(t),"date");if(k(t))return m(t)}var c,u="",C=!1,S=["{","}"];return y(t)&&(C=!0,S=["[","]"]),A(t)&&(u=" [Function"+(t.name?": "+t.name:"")+"]"),w(t)&&(u=" "+RegExp.prototype.toString.call(t)),x(t)&&(u=" "+Date.prototype.toUTCString.call(t)),k(t)&&(u=" "+m(t)),0!==a.length||C&&0!=t.length?n<0?w(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=C?f(e,t,n,s,a):a.map((function(r){return h(e,t,n,s,r,C)})),e.seen.pop(),v(c,u,S)):S[0]+u+S[1]}function g(e,t){if(_(t))return e.stylize("undefined","undefined");if(T(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return E(t)?e.stylize(""+t,"number"):C(t)?e.stylize(""+t,"boolean"):S(t)?e.stylize("null","null"):void 0}function m(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)F(t,String(a))?i.push(h(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(h(e,t,n,r,o,!0))})),i}function h(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),F(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=S(n)?p(e,l.value,null):p(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),_(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function v(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function y(e){return Array.isArray(e)}function C(e){return"boolean"==typeof e}function S(e){return null===e}function b(e){return null==e}function E(e){return"number"==typeof e}function T(e){return"string"==typeof e}function I(e){return"symbol"==typeof e}function _(e){return void 0===e}function w(e){return P(e)&&"[object RegExp]"===D(e)}function P(e){return"object"==typeof e&&null!==e}function x(e){return P(e)&&"[object Date]"===D(e)}function k(e){return P(e)&&("[object Error]"===D(e)||e instanceof Error)}function A(e){return"function"==typeof e}function L(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function D(e){return Object.prototype.toString.call(e)}function O(e){return e<10?"0"+e.toString(10):e.toString(10)}r.debuglog=function(e){if(_(a)&&(a=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!s[e])if(new RegExp("\\b"+e+"\\b","i").test(a)){var n=t.pid;s[e]=function(){var t=r.format.apply(r,arguments);o.error("%s %d: %s",e,n,t)}}else s[e]=function(){};return s[e]},r.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=y,r.isBoolean=C,r.isNull=S,r.isNullOrUndefined=b,r.isNumber=E,r.isString=T,r.isSymbol=I,r.isUndefined=_,r.isRegExp=w,r.isObject=P,r.isDate=x,r.isError=k,r.isFunction=A,r.isPrimitive=L,r.isBuffer=e("./support/isBuffer");var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var e=new Date,t=[O(e.getHours()),O(e.getMinutes()),O(e.getSeconds())].join(":");return[e.getDate(),N[e.getMonth()],t].join(" ")}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)}r.log=function(){o.log("%s - %s",R(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!P(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":10,_process:14,inherits:9}],12:[function(e,t,n){},{}],13:[function(e,t,n){(function(e){function t(e,t){for(var n=0,r=e.length-1;r>=0;r--){var o=e[r];"."===o?e.splice(r,1):".."===o?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,o=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!o){n=t+1;break}}else-1===r&&(o=!1,r=t+1);return-1===r?"":e.slice(n,r)}function o(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}n.resolve=function(){for(var n="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(n=a+"/"+n,r="/"===a.charAt(0))}return(r?"/":"")+(n=t(o(n.split("/"),(function(e){return!!e})),!r).join("/"))||"."},n.normalize=function(e){var r=n.isAbsolute(e),a="/"===i(e,-1);return(e=t(o(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&a&&(e+="/"),(r?"/":"")+e},n.isAbsolute=function(e){return"/"===e.charAt(0)},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(o(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},n.relative=function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var o=r(e.split("/")),i=r(t.split("/")),a=Math.min(o.length,i.length),s=a,l=0;l<a;l++)if(o[l]!==i[l]){s=l;break}var c=[];for(l=s;l<o.length;l++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,o=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!o){r=i;break}}else o=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},n.basename=function(e,t){var n=r(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,o=!0,i=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===r&&(o=!1,r=a+1),46===s?-1===t?t=a:1!==i&&(i=1):-1!==t&&(i=-1);else if(!o){n=a+1;break}}return-1===t||-1===r||0===i||1===i&&t===r-1&&t===n+1?"":e.slice(t,r)};var i=function(e,t,n){return e.substr(t,n)}}).call(this,e("_process"))},{_process:14}],14:[function(e,t,n){var r,o,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}function c(e){if(o===clearTimeout)return clearTimeout(e);if((o===s||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{return o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}}();var u,d=[],p=!1,g=-1;function m(){p&&u&&(p=!1,u.length?d=u.concat(d):g=-1,d.length&&f())}function f(){if(!p){var e=l(m);p=!0;for(var t=d.length;t;){for(u=d,d=[];++g<t;)u&&u[g].run();g=-1,t=d.length}u=null,p=!1,c(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new h(e,t)),1!==d.length||p||l(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],15:[function(e,t,n){var r=e("escodegen").generate;t.exports=function(e,t){t||(t={});var n={},o=function e(o,i){if("Literal"===o.type)return o.value;if("UnaryExpression"===o.type){var a=e(o.argument);return"+"===o.operator?+a:"-"===o.operator?-a:"~"===o.operator?~a:"!"===o.operator?!a:n}if("ArrayExpression"===o.type){for(var s=[],l=0,c=o.elements.length;l<c;l++){if((v=e(o.elements[l]))===n)return n;s.push(v)}return s}if("ObjectExpression"===o.type){var u={};for(l=0;l<o.properties.length;l++){var d=null===(y=o.properties[l]).value?y.value:e(y.value);if(d===n)return n;u[y.key.value||y.key.name]=d}return u}if("BinaryExpression"===o.type||"LogicalExpression"===o.type){if((c=e(o.left))===n)return n;var p=e(o.right);if(p===n)return n;var g=o.operator;return"=="===g?c==p:"==="===g?c===p:"!="===g?c!=p:"!=="===g?c!==p:"+"===g?c+p:"-"===g?c-p:"*"===g?c*p:"/"===g?c/p:"%"===g?c%p:"<"===g?c<p:"<="===g?c<=p:">"===g?c>p:">="===g?c>=p:"|"===g?c|p:"&"===g?c&p:"^"===g?c^p:"&&"===g?c&&p:"||"===g?c||p:n}if("Identifier"===o.type)return{}.hasOwnProperty.call(t,o.name)?t[o.name]:n;if("ThisExpression"===o.type)return{}.hasOwnProperty.call(t,"this")?t.this:n;if("CallExpression"===o.type){var m=e(o.callee);if(m===n)return n;if("function"!=typeof m)return n;var f=o.callee.object?e(o.callee.object):n;f===n&&(f=null);var h=[];for(l=0,c=o.arguments.length;l<c;l++){var v;if((v=e(o.arguments[l]))===n)return n;h.push(v)}return m.apply(f,h)}var y;if("MemberExpression"===o.type)return(u=e(o.object))===n||"function"==typeof u?n:"Identifier"===o.property.type?u[o.property.name]:(y=e(o.property))===n?n:u[y];if("ConditionalExpression"===o.type)return(a=e(o.test))===n?n:e(a?o.consequent:o.alternate);if("ExpressionStatement"===o.type)return(a=e(o.expression))===n?n:a;if("ReturnStatement"===o.type)return e(o.argument);if("FunctionExpression"===o.type){var C=o.body.body,S={};for(Object.keys(t).forEach((function(e){S[e]=t[e]})),l=0;l<o.params.length;l++){var b=o.params[l];if("Identifier"!=b.type)return n;t[b.name]=null}for(var l in C)if(e(C[l])===n)return n;t=S;var E=Object.keys(t),T=E.map((function(e){return t[e]}));return Function(E.join(", "),"return "+r(o)).apply(null,T)}if("TemplateLiteral"===o.type){var I="";for(l=0;l<o.expressions.length;l++)I+=e(o.quasis[l]),I+=e(o.expressions[l]);return I+=e(o.quasis[l])}if("TaggedTemplateExpression"===o.type){var _=e(o.tag),w=o.quasi,P=w.quasis.map(e),x=w.expressions.map(e);return _.apply(null,[P].concat(x))}return"TemplateElement"===o.type?o.value.cooked:n}(e);return o===n?void 0:o}},{escodegen:12}],jsonpath:[function(e,t,n){t.exports=e("./lib/index")},{"./lib/index":5}]},{},["jsonpath"])("jsonpath")},20378:(e,t,n)=>{var r=n(58651),o=function(e){return"string"==typeof e};function i(e,t,n){var i=0,a=0;if(""===e)return e;if(!e||!o(e))throw new TypeError("First argument to react-string-replace#replaceString must be a string");var s,l,c,u=t;(function(e){return e instanceof RegExp})(u)||(u=new RegExp("("+(s=u,l=/[\\^$.*+?()[\]{}|]/g,c=RegExp(l.source),(s&&c.test(s)?s.replace(l,"\\$&"):s)+")"),"gi"));for(var d=e.split(u),p=1,g=d.length;p<g;p+=2)void 0!==d[p]&&void 0!==d[p-1]?(a=d[p].length,i+=d[p-1].length,d[p]=n(d[p],p,i),i+=a):r.warn("reactStringReplace: Encountered undefined value during string replacement. Your RegExp may not be working the way you expect.");return d}e.exports=function(e,t,n){return Array.isArray(e)||(e=[e]),r=e.map((function(e){return o(e)?i(e,t,n):e})),a=[],r.forEach((function(e){Array.isArray(e)?a=a.concat(e):a.push(e)})),a;var r,a}},65227:(e,t,n)=>{var r=n(37542),o=r.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return o(e,t,n)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(i(r,t),t.Buffer=a),a.prototype=Object.create(o.prototype),i(o,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=o(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},98597:(e,t,n)=>{var r=n(65227).Buffer;function o(e,t){this._block=r.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}o.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=r.from(e,t));for(var n=this._block,o=this._blockSize,i=e.length,a=this._len,s=0;s<i;){for(var l=a%o,c=Math.min(i-s,o-l),u=0;u<c;u++)n[l+u]=e[s+u];s+=c,(a+=c)%o==0&&this._update(n)}return this._len+=i,this},o.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,o=(n-r)/4294967296;this._block.writeUInt32BE(o,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var i=this._hash();return e?i.toString(e):i},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=o},23909:(e,t,n)=>{var r=e.exports=function(e){e=e.toLowerCase();var t=r[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};r.sha=n(66403),r.sha1=n(87484),r.sha224=n(54811),r.sha256=n(5077),r.sha384=n(28618),r.sha512=n(28875)},66403:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function l(){this.init(),this._w=s,o.call(this,64,56)}function c(e){return e<<30|e>>>2}function u(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,o),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,l=0|this._e,d=0;d<16;++d)n[d]=e.readInt32BE(4*d);for(;d<80;++d)n[d]=n[d-3]^n[d-8]^n[d-14]^n[d-16];for(var p=0;p<80;++p){var g=~~(p/20),m=0|((t=r)<<5|t>>>27)+u(g,o,i,s)+l+n[p]+a[g];l=s,s=i,i=c(o),o=r,r=m}this._a=r+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},87484:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function l(){this.init(),this._w=s,o.call(this,64,56)}function c(e){return e<<5|e>>>27}function u(e){return e<<30|e>>>2}function d(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}r(l,o),l.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,l=0|this._e,p=0;p<16;++p)n[p]=e.readInt32BE(4*p);for(;p<80;++p)n[p]=(t=n[p-3]^n[p-8]^n[p-14]^n[p-16])<<1|t>>>31;for(var g=0;g<80;++g){var m=~~(g/20),f=c(r)+d(m,o,i,s)+l+n[g]+a[m]|0;l=s,s=i,i=u(o),o=r,r=f}this._a=r+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0},l.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=l},54811:(e,t,n)=>{var r=n(12523),o=n(5077),i=n(98597),a=n(65227).Buffer,s=new Array(64);function l(){this.init(),this._w=s,i.call(this,64,56)}r(l,o),l.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},l.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=l},5077:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function l(){this.init(),this._w=s,o.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function p(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function g(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}r(l,o),l.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},l.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,o=0|this._b,i=0|this._c,s=0|this._d,l=0|this._e,m=0|this._f,f=0|this._g,h=0|this._h,v=0;v<16;++v)n[v]=e.readInt32BE(4*v);for(;v<64;++v)n[v]=0|(((t=n[v-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[v-7]+g(n[v-15])+n[v-16];for(var y=0;y<64;++y){var C=h+p(l)+c(l,m,f)+a[y]+n[y]|0,S=d(r)+u(r,o,i)|0;h=f,f=m,m=l,l=s+C|0,s=i,i=o,o=r,r=C+S|0}this._a=r+this._a|0,this._b=o+this._b|0,this._c=i+this._c|0,this._d=s+this._d|0,this._e=l+this._e|0,this._f=m+this._f|0,this._g=f+this._g|0,this._h=h+this._h|0},l.prototype._hash=function(){var e=i.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=l},28618:(e,t,n)=>{var r=n(12523),o=n(28875),i=n(98597),a=n(65227).Buffer,s=new Array(160);function l(){this.init(),this._w=s,i.call(this,128,112)}r(l,o),l.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},l.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=l},28875:(e,t,n)=>{var r=n(12523),o=n(98597),i=n(65227).Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function l(){this.init(),this._w=s,o.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function u(e,t,n){return e&t|n&(e|t)}function d(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function p(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function g(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function m(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function f(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function h(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function v(e,t){return e>>>0<t>>>0?1:0}r(l,o),l.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},l.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,o=0|this._ch,i=0|this._dh,s=0|this._eh,l=0|this._fh,y=0|this._gh,C=0|this._hh,S=0|this._al,b=0|this._bl,E=0|this._cl,T=0|this._dl,I=0|this._el,_=0|this._fl,w=0|this._gl,P=0|this._hl,x=0;x<32;x+=2)t[x]=e.readInt32BE(4*x),t[x+1]=e.readInt32BE(4*x+4);for(;x<160;x+=2){var k=t[x-30],A=t[x-30+1],L=g(k,A),D=m(A,k),O=f(k=t[x-4],A=t[x-4+1]),N=h(A,k),R=t[x-14],F=t[x-14+1],M=t[x-32],B=t[x-32+1],U=D+F|0,H=L+R+v(U,D)|0;H=(H=H+O+v(U=U+N|0,N)|0)+M+v(U=U+B|0,B)|0,t[x]=H,t[x+1]=U}for(var G=0;G<160;G+=2){H=t[G],U=t[G+1];var z=u(n,r,o),q=u(S,b,E),W=d(n,S),j=d(S,n),V=p(s,I),Q=p(I,s),J=a[G],K=a[G+1],X=c(s,l,y),Z=c(I,_,w),Y=P+Q|0,$=C+V+v(Y,P)|0;$=($=($=$+X+v(Y=Y+Z|0,Z)|0)+J+v(Y=Y+K|0,K)|0)+H+v(Y=Y+U|0,U)|0;var ee=j+q|0,te=W+z+v(ee,j)|0;C=y,P=w,y=l,w=_,l=s,_=I,s=i+$+v(I=T+Y|0,T)|0,i=o,T=E,o=r,E=b,r=n,b=S,n=$+te+v(S=Y+ee|0,Y)|0}this._al=this._al+S|0,this._bl=this._bl+b|0,this._cl=this._cl+E|0,this._dl=this._dl+T|0,this._el=this._el+I|0,this._fl=this._fl+_|0,this._gl=this._gl+w|0,this._hl=this._hl+P|0,this._ah=this._ah+n+v(this._al,S)|0,this._bh=this._bh+r+v(this._bl,b)|0,this._ch=this._ch+o+v(this._cl,E)|0,this._dh=this._dh+i+v(this._dl,T)|0,this._eh=this._eh+s+v(this._el,I)|0,this._fh=this._fh+l+v(this._fl,_)|0,this._gh=this._gh+y+v(this._gl,w)|0,this._hh=this._hh+C+v(this._hl,P)|0},l.prototype._hash=function(){var e=i.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=l},28679:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},a=[],s=0;s<e.length;s++){var l=e[s],c=r.base?l[0]+r.base:l[0],u=i[c]||0,d="".concat(c," ").concat(u);i[c]=u+1;var p=n(d),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(g);else{var m=o(g,r);r.byIndex=s,t.splice(s,0,{identifier:d,updater:m,references:1})}a.push(d)}return a}function o(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=n(i[a]);t[s].references--}for(var l=r(e,o),c=0;c<i.length;c++){var u=n(i[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=l}}},87720:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},11843:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},34159:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},22180:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},79216:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},87469:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Basin=t.BasinCursor=void 0;var s=a(n(3110)),l=a(n(55203));t.BasinCursor=function e(t,n,o){r(this,e),i(this,"jsonPath",void 0),i(this,"position",void 0),i(this,"deleteCount",void 0),i(this,"j",void 0),i(this,"p",void 0),i(this,"d",void 0),this.jsonPath=t,this.position=n,this.deleteCount=o};var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;r(this,e),i(this,"items",void 0),i(this,"_cursor",void 0),i(this,"_currentKey",void 0),this.items=t,this._cursor=n,void 0!==n&&this.setCursor(n)}var t,n,a;return t=e,(n=[{key:"applyPatches",value:function(e){s.default.applyPatch(this.items,e);var t=new Set,n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value,u=c.path.indexOf("/",1);u=-1==u?c.path.length:u;var d=c.path.slice(1,u).replace(/~1/g,"/").replace(/~0/g,"~");t.has(d)||(n.push(this.items[d]),t.add(d))}}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}},{key:"setCursor",value:function(e){this._cursor=e,void 0!==e.j&&(e.jsonPath=e.j,delete e.j),void 0!==e.p&&(e.position=e.p,delete e.p),void 0!==e.d&&(e.deleteCount=e.d,delete e.d);var t=l.default.parse(e.jsonPath),n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if("root"!==s.expression.type){this._currentKey=s.expression.value;break}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"write",value:function(e){var t=this._cursor,n=t.position,r=t.jsonPath;return"number"!=typeof n?l.default.value(this.items,r,e):l.default.apply(this.items,r,(function(r){if(Array.isArray(r))return void 0!==t.deleteCount?r.splice(n,t.deleteCount):-1===n?r.push(e):r.splice(n,0,e),r;if(-1===n)return r+e;t.position+=e.length;var o=t.deleteCount||0;return r.slice(0,n)+e+r.slice(n+o)})),this.items[this._currentKey]}}])&&o(t.prototype,n),a&&o(t,a),e}();t.Basin=c},96461:(e,t,n)=>{"use strict";n.r(t),n.d(t,{OfficeAddinCalledTime:()=>cX,appLoadStartTime:()=>dX,isCopilotPreloaded:()=>mX,isSDXRenderingForPreload:()=>gX,officeOnReadyTime:()=>sX,pptTaskPaneStartTime:()=>uX,preloadCopilot:()=>lX,setPreloadedCopilotSessionObject:()=>hX,setPreloadedCopilotVisibility:()=>fX});var r={};n.r(r),n.d(r,{camelFromPascal:()=>sv,getDocumentAsCompressed:()=>ov,getSliceAsync:()=>iv,matchAll:()=>rv,onGotAllSlices:()=>av});var o={};n.r(o),n.d(o,{deleteFooters:()=>YD,deleteImages:()=>Ny,deleteShapes:()=>Iy,deleteSlides:()=>XD,deleteText:()=>WT,fns:()=>oO,formatImages:()=>Ay,formatList:()=>t_,formatShapes:()=>Ey,formatSlides:()=>qy,formatText:()=>VT,generateSlides:()=>VD,getSelectionContextTree:()=>b_,helper:()=>r,imageProvider:()=>rO,insertImages:()=>xy,insertList:()=>$I,insertSection:()=>Qy,insertShapes:()=>Sy,insertSlides:()=>Gy,insertTables:()=>__,insertText:()=>JT,moveSlides:()=>jy,selectImages:()=>Dy,selectIndicesShape:()=>yy,selectIndicesSlide:()=>Uy,selectIndicesText:()=>GT,selectShapes:()=>hy,selectSlides:()=>My,selectText:()=>MT,selectTextIndex:()=>qT,server:()=>nO,setFooters:()=>JD,transitionSlides:()=>eO,undoApplication:()=>xT});var i=n(90425),a=n(8520),s=n.t(a,2),l=n(94329),c=n(55695);function u(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('".concat(e,"fabric-icons-a13498cf.woff') format('woff')")},icons:{GlobalNavButton:"",ChevronDown:"",ChevronUp:"",Edit:"",Add:"",Cancel:"",More:"",Settings:"",Mail:"",Filter:"",Search:"",Share:"",BlockedSite:"",FavoriteStar:"",FavoriteStarFill:"",CheckMark:"",Delete:"",ChevronLeft:"",ChevronRight:"",Calendar:"",Megaphone:"",Undo:"",Flag:"",Page:"",Pinned:"",View:"",Clear:"",Download:"",Upload:"",Folder:"",Sort:"",AlignRight:"",AlignLeft:"",Tag:"",AddFriend:"",Info:"",SortLines:"",List:"",CircleRing:"",Heart:"",HeartFill:"",Tiles:"",Embed:"",Glimmer:"",Ascending:"",Descending:"",SortUp:"",SortDown:"",SyncToPC:"",LargeGrid:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",ClearFilter:"",Flow:"",StatusCircleCheckmark:"",MoreVertical:""}};(0,c.K1)(n,t)}function d(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('".concat(e,"fabric-icons-0-467ee27f.woff') format('woff')")},icons:{PageLink:"",CommentSolid:"",ChangeEntitlements:"",Installation:"",WebAppBuilderModule:"",WebAppBuilderFragment:"",WebAppBuilderSlot:"",BullseyeTargetEdit:"",WebAppBuilderFragmentCreate:"",PageData:"",PageHeaderEdit:"",ProductList:"",UnpublishContent:"",DependencyAdd:"",DependencyRemove:"",EntitlementPolicy:"",EntitlementRedemption:"",SchoolDataSyncLogo:"",PinSolid12:"",PinSolidOff12:"",AddLink:"",SharepointAppIcon16:"",DataflowsLink:"",TimePicker:"",UserWarning:"",ComplianceAudit:"",InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",People:"",Phone:"",Pin:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Attach:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Back:"",Refresh:"",Lock:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",RealEstate:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",EaseOfAccess:"",ContactInfo:"",Unpin:"",Contact:"",Memo:"",IncomingCall:""}};(0,c.K1)(n,t)}function p(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('".concat(e,"fabric-icons-1-4d521695.woff') format('woff')")},icons:{Paste:"",WindowsLogo:"",Error:"",GripperBarVertical:"",Unlock:"",Slideshow:"",Trim:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ViewOriginal:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",TVMonitor:"",Speakers:"",Game:"",HorizontalTabKey:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",History:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",USB:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:""}};(0,c.K1)(n,t)}function g(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('".concat(e,"fabric-icons-2-63c99abf.woff') format('woff')")},icons:{Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",Library:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",Comment:"",DockLeft:"",DockRight:"",Repair:"",Accounts:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",CompassNW:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorAddition:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",Health:"",Webcam2:"",FrontCamera:"",ChevronUpSmall:""}};(0,c.K1)(n,t)}function m(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('".concat(e,"fabric-icons-3-089e217a.woff') format('woff')")},icons:{ChevronDownSmall:"",ChevronLeftSmall:"",ChevronRightSmall:"",ChevronUpMed:"",ChevronDownMed:"",ChevronLeftMed:"",ChevronRightMed:"",Devices2:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Freezing:"",FunnelChart:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:""}};(0,c.K1)(n,t)}function f(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('".concat(e,"fabric-icons-4-a656cc0a.woff') format('woff')")},icons:{HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",Devices3:"",Focus:"",VideoLightOff:"",Lightbulb:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",Ringer:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",AddToShoppingList:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Market:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:""}};(0,c.K1)(n,t)}function h(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('".concat(e,"fabric-icons-5-f95ba260.woff') format('woff')")},icons:{Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",ReminderTime:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",HomeGroup:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",Calories:"",POI:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",Toolbox:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",Diamond:"",ScaleUp:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",OpenFolderHorizontal:"",CalendarMirrored:""}};(0,c.K1)(n,t)}function v(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('".concat(e,"fabric-icons-6-ef6fd590.woff') format('woff')")},icons:{SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",DelveLogoInverse:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:""}};(0,c.K1)(n,t)}function y(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('".concat(e,"fabric-icons-7-2b97bb99.woff') format('woff')")},icons:{SingleBookmark:"",SingleBookmarkSolid:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ProductionFloorManagement:"",ProductRelease:"",ProductVariant:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",GoToDashboard:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:""}};(0,c.K1)(n,t)}function C(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('".concat(e,"fabric-icons-8-6fdf1528.woff') format('woff')")},icons:{CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",RecycleBin:"",EmptyRecycleBin:"",Hide2:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",CRMProcesses:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",CRMServices:"",EditContact:"",ConnectContacts:"",AppIconDefaultAdd:"",AppIconDefaultList:"",ActivateOrders:"",DeactivateOrders:"",ProductCatalog:"",ScatterChart:"",AccountActivity:"",DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",PageShared:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",Compare:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",ChatBot:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolder:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",PhotoVideoMedia:"",AddFavorite:""}};(0,c.K1)(n,t)}function S(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('".concat(e,"fabric-icons-9-c6162b42.woff') format('woff')")},icons:{AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",GroupList:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",MuteChat:"",AddHome:"",AddWork:"",MobileReport:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",ToggleLeft:"",ToggleRight:"",TriangleShape:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogo:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:""}};(0,c.K1)(n,t)}function b(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('".concat(e,"fabric-icons-10-c4ded8e4.woff') format('woff')")},icons:{ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",Insert:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",Signin:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:""}};(0,c.K1)(n,t)}function E(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('".concat(e,"fabric-icons-11-2a8393d6.woff') format('woff')")},icons:{BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:""}};(0,c.K1)(n,t)}function T(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('".concat(e,"fabric-icons-12-7e945a1e.woff') format('woff')")},icons:{FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:"",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",CRMCustomerInsightsApp:"",EditCreate:"",PlayReverseResume:"",PlayReverse:"",SearchData:"",UnSetColor:"",DeclineCall:""}};(0,c.K1)(n,t)}function I(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('".concat(e,"fabric-icons-13-c3989a02.woff') format('woff')")},icons:{RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:""}};(0,c.K1)(n,t)}function _(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('".concat(e,"fabric-icons-14-5cf58db8.woff') format('woff')")},icons:{Snooze:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",GreetingCard:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:""}};(0,c.K1)(n,t)}function w(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('".concat(e,"fabric-icons-15-3807251b.woff') format('woff')")},icons:{CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",ReportWarning:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",BullseyeTarget:"",AnalyticsView:"",Video360Generic:"",Untag:"",Leave:"",Trending12:"",Blocked12:"",Warning12:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",VersionControlPush:"",StackedColumnChart2:"",TripleColumnWide:"",QuadColumn:"",WhiteBoardApp16:"",WhiteBoardApp32:"",PinnedSolid:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",TagUnknown12:"",TagUnknown12Mirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",BlockedSiteSolid12:"",TagSolid:"",OfficeChat:""}};(0,c.K1)(n,t)}function P(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('".concat(e,"fabric-icons-16-9cf93f3b.woff') format('woff')")},icons:{OfficeChatSolid:"",MailSchedule:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioOnlineLogoFill32:"",VisioOnlineLogo32:"",VisioOnlineLogoCloud32:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",GripperDotsVertical:"",MailAttached:"",AddIn:"",LinkedDatabase:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicOff2:"",MicrosoftTranslatorLogo:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",RemoveFromShoppingList:"",ShieldAlert:"",FabricTextHighlightComposite:"",Dataflows:"",GenericScanFilled:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",ShowGrid:"",SnapToGrid:"",ContactList:"",NewMail:"",EyeShadow:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:"",Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:""}};(0,c.K1)(n,t)}function x(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('".concat(e,"fabric-icons-17-0c4ed701.woff') format('woff')")},icons:{CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",MailOptions:"",Childof:"",Footer:"",Header:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",PlainText:"",AccessibiltyChecker:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",BulletedTreeList:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",AddReaction:"",ContactHeart:"",VisuallyImpaired:"",EventToDoLogo:"",Variable2:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2:"",Uneditable2Mirrored:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",PollResults:"",Rerun:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TrimStart:"",TrimEnd:"",TableComputed:"",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:""}};(0,c.K1)(n,t)}var k=function(){(0,c.aH)("trash","delete"),(0,c.aH)("onedrive","onedrivelogo"),(0,c.aH)("alertsolid12","eventdatemissed12"),(0,c.aH)("sixpointstar","6pointstar"),(0,c.aH)("twelvepointstar","12pointstar"),(0,c.aH)("toggleon","toggleleft"),(0,c.aH)("toggleoff","toggleright")};var A=n(84647);(0,n(9150).v)("@fluentui/font-icons-mdl2","8.5.50");var L="".concat(c.pD,"/assets/icons/"),D=(0,A.z)();const O=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},a.createElement("path",{d:"M1856 640q39 0 74 15t61 41 42 61 15 75q0 32-10 61l-256 768q-10 29-28 53t-42 42-52 26-60 10h-512q-179 0-345-69-72-29-144-44t-151-15H0V768h417q65 0 122-24t104-70l622-621q25-25 50-39t61-14q33 0 62 12t51 35 34 51 13 62q0 81-18 154t-53 146q-20 43-34 87t-19 93h444zm-256 1024q20 0 37-12t24-32q5-14 18-54t33-96 42-124 46-137 44-134 39-118 27-86 10-39q0-26-19-45t-45-19h-576q0-53 2-98t10-89 22-86 37-91q28-58 42-118t15-126q0-14-9-23t-23-9q-6 0-10 4t-9 9L734 765q-32 32-68 56t-78 41q-80 34-171 34H128v640h320q178 0 345 69 144 59 295 59h512z"})),N=()=>a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},a.createElement("path",{d:"M960 256q178 0 345 69 72 29 144 44t151 15h448v896h-417q-65 0-122 24t-104 70l-622 621q-25 25-50 39t-61 14q-33 0-62-12t-51-35-34-51-13-62q0-81 18-154t53-146q20-43 34-87t19-93H192q-39 0-74-15t-61-41-42-61-15-75q0-32 10-61l256-768q20-59 70-95t112-36h512zm960 256h-320q-179 0-345-69-144-59-295-59H448q-20 0-37 12t-24 32q-5 14-18 54t-33 96-42 124-46 137-44 134-39 118-27 86-10 39q0 26 19 45t45 19h576q0 53-2 98t-10 89-22 86-37 91q-28 58-42 118t-15 126q0 14 9 23t23 9q6 0 10-4t9-9l623-624q32-32 68-56t78-41q80-34 171-34h289V512z"}));var R=a.createContext(void 0),F=n(23182),M=n(36147),B=n(13074),U={yellowDark:"#d39300",yellow:"#fde300",yellowLight:"#fef7b2",orange:"#f7630c",orangeLight:"#f98845",orangeLighter:"#fdcfb4",redDark:"#750b1c",red:"#d13438",magentaDark:"#6b0043",magenta:"#bf0077",magentaLight:"#d957a8",purpleDark:"#401b6c",purple:"#5c2e91",purpleLight:"#c6b1de",blueDark:"#003966",blueMid:"#004e8c",blue:"#0078d4",blueLight:"#3a96dd",tealDark:"#006666",teal:"#038387",tealLight:"#00b7c3",greenDark:"#0b6a0b",green:"#107c10",greenLight:"#13a10e"},H="#BDBDBD",G=(0,F.__assign)({themeDarker:"#0c3b5e",themeDark:"#0f548c",themeDarkAlt:"#115ea3",themePrimary:"#0f6cbd",themeSecondary:"#2886de",themeTertiary:"#77b7f7",themeLight:"#b4d6fa",themeLighter:"#cfe4fa",themeLighterAlt:"#ebf3fc",black:"#000000",blackTranslucent40:"rgba(0, 0, 0, 0.4)",neutralDark:"#141414",neutralPrimary:"#242424",neutralPrimaryAlt:"#383838",neutralSecondary:"#5c5c5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#9e9e9e",neutralTertiaryAlt:"#c7c7c7",neutralQuaternary:"#d1d1d1",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#ebebeb",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",accent:"#0f6cbd",white:"#FFFFFF",whiteTranslucent40:"rgba(255 ,255 ,255 ,0.4)"},U),z=G,q={inputBottomBorderFocus:z.themePrimary,inputBottomBorderRest:z.neutralLighter,focusBorder:z.neutralTertiary,inputBorder:z.neutralQuaternary,inputBackgroundChecked:z.themePrimary,inputBackground:z.white,bodyTextChecked:z.neutralPrimary,inputBackgroundCheckedHovered:z.themeDarkAlt,warningText:z.neutralPrimary,messageText:z.neutralPrimary,messageLink:z.themeDarkAlt,messageLinkHovered:z.themeDarker,infoIcon:z.neutralSecondary,warningIcon:z.neutralPrimary,infoBackground:z.neutralLighter,inputIconHovered:"#424242",inputPlaceholderText:"#616161",disabledBorder:H,disabledText:H},W=(0,M.a)({palette:G,semanticColors:q,components:B.s,effects:{elevation4:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",elevation8:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",elevation16:"0px 8px 16px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",elevation64:"0px 32px 64px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px",roundedCorner8:"8px",roundedCornerCircle:"50%"}}),j=(0,F.__assign)({themeDarker:"#62abf5",themeDark:"#479ef5",themeDarkAlt:"#479ef5",themePrimary:"#2886de",themeSecondary:"#2886de",themeTertiary:"#0f548c",themeLight:"#0e4775",themeLighter:"#0c3b5e",themeLighterAlt:"#0A2E4A",black:"#ffffff",blackTranslucent40:"rgba(255 ,255 ,255 ,0.4)",neutralDark:"#fafafa",neutralPrimary:"#f5f5f5",neutralPrimaryAlt:"#d6d6d6",neutralSecondary:"#d1d1d1",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#707070",neutralTertiaryAlt:"#424242",neutralQuaternary:"#3d3d3d",neutralQuaternaryAlt:"#2e2e2e",neutralLight:"#292929",neutralLighter:"#242424",neutralLighterAlt:"#1a1a1a",accent:"#2886de",white:"#141414",whiteTranslucent40:"rgba(0, 0, 0, 0.4)"},U),V=j,Q="#5C5C5C",J={primaryButtonBackgroundHovered:W.palette.themePrimary,primaryButtonBackgroundPressed:W.palette.themeDarker,primaryButtonBackground:W.palette.themeDarkAlt,link:V.themeDark,inputBottomBorderFocus:V.themePrimary,inputBottomBorderRest:V.neutralLighter,primaryButtonText:V.black,primaryButtonTextHovered:V.black,primaryButtonTextPressed:V.black,primaryButtonTextDisabled:V.neutralTertiaryAlt,primaryButtonBackgroundDisabled:V.neutralLighter,accentButtonText:V.black,accentButtonBackground:V.themePrimary,inputPlaceholderText:V.neutralSecondaryAlt,inputForegroundChecked:V.black,inputFocusBorderAlt:V.neutralTertiary,inputBorder:V.neutralQuaternary,focusBorder:V.neutralTertiary,inputBackgroundChecked:V.themePrimary,inputBackground:V.white,bodyTextChecked:V.neutralPrimary,inputBackgroundCheckedHovered:V.themeDarkAlt,warningText:V.neutralPrimary,messageText:V.neutralPrimary,messageLink:V.themeDarkAlt,messageLinkHovered:V.themeDarker,infoIcon:V.neutralSecondary,warningIcon:V.neutralPrimary,infoBackground:V.neutralLighter,disabledBorder:Q,disabledText:Q,inputIconHovered:V.black},K=(0,M.a)({palette:j,semanticColors:J,components:B.s,effects:{elevation4:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",elevation8:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",elevation16:"0px 8px 16px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",elevation64:"0px 32px 64px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px",roundedCorner8:"8px",roundedCornerCircle:"50%"},isInverted:!0}),X=n(55828);const Z=(0,M.a)({palette:{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#C43E1C",black:"#000000"}}),Y=(0,M.a)({palette:{themePrimary:"#DC816A",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#CA5010",black:"#FFFFFF"}}),$=(0,X.z)(W,Z),ee=((0,X.z)(K,Y),function(){const e=a.useContext(R);return e||$});(0,c.K1)({icons:{thumbsUp:a.createElement(O,null),thumbsDown:a.createElement(N,null)}});var te;!function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(te||(te={}));te.defaultWhite;n(58651);const ne=function(){return"undefined"!=typeof OfficeaicopilotStrings};var re;!function(e){e.web="web",e.IOS="iOS",e.MACOS="Mac"}(re||(re={}));let oe=re.web;const ie=e=>{oe=e},ae=()=>oe,se=()=>oe===re.IOS;var le=n(96722);var ce=function(){var e=(0,a.useContext)(R),t=(0,le.m)(["theme"]).theme;return e||t||(0,M.a)({})};const ue=()=>{const e=ce();return a.createElement("svg",{width:"14",height:"13",viewBox:"0 0 14 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M3 0C1.61929 0 0.5 1.11929 0.5 2.5V9.5C0.5 10.8807 1.61929 12 3 12H4.75716C4.50353 11.6929 4.28261 11.3578 4.09971 11H3C2.17157 11 1.5 10.3284 1.5 9.5V2.5C1.5 1.67157 2.17157 1 3 1H10C10.8284 1 11.5 1.67157 11.5 2.5V3.59971C11.8578 3.78261 12.1929 4.00353 12.5 4.25716V2.5C12.5 1.11929 11.3807 0 10 0H3ZM9 13C11.4853 13 13.5 10.9853 13.5 8.5C13.5 6.01472 11.4853 4 9 4C6.51472 4 4.5 6.01472 4.5 8.5C4.5 10.9853 6.51472 13 9 13ZM10.8536 6.64645C11.0488 6.84171 11.0488 7.15829 10.8536 7.35355L9.70711 8.5L10.8536 9.64645C11.0488 9.84171 11.0488 10.1583 10.8536 10.3536C10.6583 10.5488 10.3417 10.5488 10.1464 10.3536L9 9.20711L7.85355 10.3536C7.65829 10.5488 7.34171 10.5488 7.14645 10.3536C6.95118 10.1583 6.95118 9.84171 7.14645 9.64645L8.29289 8.5L7.14645 7.35355C6.95118 7.15829 6.95118 6.84171 7.14645 6.64645C7.34171 6.45118 7.65829 6.45118 7.85355 6.64645L9 7.79289L10.1464 6.64645C10.3417 6.45118 10.6583 6.45118 10.8536 6.64645Z",fill:e.palette.neutralQuaternaryAlt}))},de=()=>a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5ZM15.4462 8.39705L15.5303 8.46967C15.7966 8.73594 15.8208 9.1526 15.6029 9.44621L15.5303 9.53033L13.061 12L15.5303 14.4697C15.7966 14.7359 15.8208 15.1526 15.6029 15.4462L15.5303 15.5303C15.2641 15.7966 14.8474 15.8208 14.5538 15.6029L14.4697 15.5303L12 13.061L9.53033 15.5303C9.26406 15.7966 8.8474 15.8208 8.55379 15.6029L8.46967 15.5303C8.2034 15.2641 8.1792 14.8474 8.39705 14.5538L8.46967 14.4697L10.939 12L8.46967 9.53033C8.2034 9.26406 8.1792 8.8474 8.39705 8.55379L8.46967 8.46967C8.73594 8.2034 9.1526 8.1792 9.44621 8.39705L9.53033 8.46967L12 10.939L14.4697 8.46967C14.7359 8.2034 15.1526 8.1792 15.4462 8.39705Z",fill:"#616161"}));(0,c.K1)({icons:{StopGeneratingIcon:a.createElement(ue,null),InlineStopIcon:a.createElement(de,null)}});(0,c.K1)({icons:{warningCardIcon:a.createElement((()=>a.createElement("svg",{width:"18",height:"15",viewBox:"0 0 18 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.56195 1.26181C8.75109 0.912709 9.2521 0.912735 9.44121 1.26186L15.9418 13.2628C16.1222 13.5959 15.881 14.0009 15.5021 14.0009H2.49942C2.12051 14.0009 1.8793 13.5959 2.0598 13.2627L8.56195 1.26181ZM10.3205 0.785573C9.75318 -0.261795 8.25014 -0.261875 7.68271 0.785435L1.18056 12.7864C0.639049 13.7858 1.3627 15.0009 2.49942 15.0009H15.5021C16.6388 15.0009 17.3624 13.786 16.821 12.7865L10.3205 0.785573ZM9.49996 5.50023C9.49996 5.22409 9.2761 5.00023 8.99996 5.00023C8.72382 5.00023 8.49996 5.22409 8.49996 5.50023V9.50022C8.49996 9.77637 8.72382 10.0002 8.99996 10.0002C9.2761 10.0002 9.49996 9.77637 9.49996 9.50022V5.50023ZM9.74996 11.7502C9.74996 12.1644 9.41417 12.5002 8.99996 12.5002C8.58575 12.5002 8.24996 12.1644 8.24996 11.7502C8.24996 11.336 8.58575 11.0002 8.99996 11.0002C9.41417 11.0002 9.74996 11.336 9.74996 11.7502Z",fill:"url(#paint0_linear_988_37732)"}),a.createElement("defs",null,a.createElement("linearGradient",{id:"paint0_linear_988_37732",x1:"0.997314",y1:"0",x2:"17.1435",y2:"0.151426",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{"stop-color":"#C43E1C"}),a.createElement("stop",{offset:"1","stop-color":"#FF5C39"}))))),null)}});var pe;!function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(pe||(pe={}));const ge=e=>{var t;return a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M9.14645 2.64645C9.34171 2.45118 9.65829 2.45118 9.85355 2.64645L11.3536 4.14645C11.5488 4.34171 11.5488 4.65829 11.3536 4.85355L9.85355 6.35355C9.65829 6.54882 9.34171 6.54882 9.14645 6.35355C8.95118 6.15829 8.95118 5.84171 9.14645 5.64645L9.7885 5.00439C7.12517 5.11522 5 7.30943 5 10C5 11.568 5.72118 12.9672 6.85185 13.8847C7.06627 14.0587 7.09904 14.3736 6.92503 14.588C6.75103 14.8024 6.43615 14.8352 6.22172 14.6612C4.86712 13.5619 4 11.882 4 10C4 6.75447 6.57689 4.1108 9.79629 4.00339L9.14645 3.35355C8.95118 3.15829 8.95118 2.84171 9.14645 2.64645ZM13.075 5.41199C13.249 5.19756 13.5639 5.1648 13.7783 5.3388C15.1329 6.43806 16 8.11795 16 10C16 13.2455 13.4231 15.8892 10.2037 15.9966L10.8536 16.6464C11.0488 16.8417 11.0488 17.1583 10.8536 17.3536C10.6583 17.5488 10.3417 17.5488 10.1464 17.3536L8.64645 15.8536C8.55268 15.7598 8.5 15.6326 8.5 15.5C8.5 15.3674 8.55268 15.2402 8.64645 15.1464L10.1464 13.6464C10.3417 13.4512 10.6583 13.4512 10.8536 13.6464C11.0488 13.8417 11.0488 14.1583 10.8536 14.3536L10.2115 14.9956C12.8748 14.8848 15 12.6906 15 10C15 8.43201 14.2788 7.03283 13.1482 6.1153C12.9337 5.94129 12.901 5.62641 13.075 5.41199Z",fill:null!==(t=null==e?void 0:e.fill)&&void 0!==t?t:"#242424"}))},me=e=>{var t;return a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.8639 3.65609C14.0533 3.85704 14.0439 4.17348 13.8429 4.36288L5.91309 11.8368C5.67573 12.0605 5.30311 12.0536 5.07417 11.8213L2.39384 9.10093C2.20003 8.90422 2.20237 8.58765 2.39907 8.39384C2.59578 8.20003 2.91235 8.20237 3.10616 8.39908L5.51192 10.8407L13.1571 3.63517C13.358 3.44577 13.6745 3.45513 13.8639 3.65609Z",fill:null!==(t=null==e?void 0:e.fill)&&void 0!==t?t:"white"}))},fe=()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M3.06573 9.04998C3.5904 5.21975 7.12074 2.54007 10.951 3.06475C12.8937 3.33087 14.5398 4.36951 15.6231 5.82964L15.7494 5.99997H12.5001C12.2239 5.99997 12.0001 6.22383 12.0001 6.49997C12.0001 6.77611 12.2239 6.99997 12.5001 6.99997H16.5001C16.7762 6.99997 17.0001 6.77611 17.0001 6.49997V2.49997C17.0001 2.22383 16.7762 1.99997 16.5001 1.99997C16.2239 1.99997 16.0001 2.22383 16.0001 2.49997V4.70729C14.7758 3.31847 13.0653 2.34504 11.0867 2.074C6.70929 1.47437 2.67461 4.53686 2.07498 8.91426C1.47535 13.2917 4.53784 17.3263 8.91524 17.926C13.2926 18.5256 17.3273 15.4631 17.9269 11.0857C18.0011 10.5444 18.0192 10.0079 17.9857 9.48208C17.9681 9.2065 17.7304 8.99737 17.4548 9.01497C17.1792 9.03258 16.9701 9.27025 16.9877 9.54583C17.017 10.0054 17.0012 10.4752 16.9362 10.95C16.4115 14.7802 12.8812 17.4599 9.05095 16.9352C5.22073 16.4105 2.54105 12.8802 3.06573 9.04998Z",fill:"#424242"})),he=e=>{const t=ee(),n=e.fill==$.palette.neutralPrimary?t.palette.neutralPrimary:t.palette.neutralQuaternary;return a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M5.00098 4.5C5.00098 4.22386 5.22483 4 5.50098 4C5.77712 4 6.00098 4.22386 6.00098 4.5V8.34262L9.17202 5.17157C10.7341 3.60948 13.2668 3.60948 14.8289 5.17157C16.391 6.73367 16.391 9.26633 14.8289 10.8284L9.80375 15.8536C9.60849 16.0488 9.2919 16.0488 9.09664 15.8536C8.90138 15.6583 8.90138 15.3417 9.09664 15.1464L14.1218 10.1213C15.2933 8.94975 15.2933 7.05025 14.1218 5.87868C12.9502 4.70711 11.0507 4.70711 9.87913 5.87868L6.75781 9H10.501C10.7771 9 11.001 9.22386 11.001 9.5C11.001 9.77614 10.7771 10 10.501 10H5.60098C5.26961 10 5.00098 9.73137 5.00098 9.4V4.5Z",fill:n}))},ve=()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M10 2.5C10 2.22386 9.77614 2 9.5 2C9.22386 2 9 2.22386 9 2.5V9H2.5C2.22386 9 2 9.22386 2 9.5C2 9.77614 2.22386 10 2.5 10H9V16.5C9 16.7761 9.22386 17 9.5 17C9.77614 17 10 16.7761 10 16.5V10H16.5C16.7761 10 17 9.77614 17 9.5C17 9.22386 16.7761 9 16.5 9H10V2.5Z",fill:"white"})),ye=e=>{const t=ee(),n=e.fill==$.palette.neutralPrimary?t.palette.neutralPrimary:t.palette.neutralLight;return a.createElement("svg",{width:"20",height:"20",viewBox:e.viewBox,fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M5.5028 4.62704L5.5 6.75V17.2542C5.5 19.0491 6.95507 20.5042 8.75 20.5042L17.3663 20.5045C17.0573 21.3782 16.224 22.0042 15.2444 22.0042H8.75C6.12665 22.0042 4 19.8776 4 17.2542V6.75C4 5.76929 4.62745 4.93512 5.5028 4.62704ZM17.75 2C18.9926 2 20 3.00736 20 4.25V17.25C20 18.4926 18.9926 19.5 17.75 19.5H8.75C7.50736 19.5 6.5 18.4926 6.5 17.25V4.25C6.5 3.00736 7.50736 2 8.75 2H17.75ZM17.75 3.5H8.75C8.33579 3.5 8 3.83579 8 4.25V17.25C8 17.6642 8.33579 18 8.75 18H17.75C18.1642 18 18.5 17.6642 18.5 17.25V4.25C18.5 3.83579 18.1642 3.5 17.75 3.5Z",fill:n}))},Ce=()=>{const e=ee();return a.createElement("svg",{width:"16",height:"18",viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.05198 16.7057C8.39129 17.683 9.68406 18.1333 10.4829 17.2962C10.6455 17.1257 10.8081 16.9416 10.9176 16.7774C11.2379 16.2968 11.3725 15.6641 11.4218 15.0477C11.4721 14.4196 11.438 13.7454 11.3738 13.1352C11.3093 12.5225 11.2129 11.9604 11.1328 11.5522C11.1294 11.5345 11.1259 11.5171 11.1225 11.5H12.006C13.8777 11.5 15.2924 9.80486 14.9576 7.96334L14.2737 4.20164C13.8017 1.60569 11.2078 -0.029048 8.66224 0.665189L3.06251 2.19239C2.14894 2.44154 1.45455 3.18547 1.26885 4.11401L0.915812 5.87918C0.638089 7.2678 1.69991 8.43756 2.82905 8.88388C3.15163 9.01139 3.44337 9.17322 3.66974 9.37403C5.37583 10.8875 5.99442 12.0971 7.05406 14.2231C7.4084 14.9339 7.77205 15.8995 8.05198 16.7057ZM10.0165 11.1214L10.0169 11.1229L10.0187 11.1303L10.0262 11.1614C10.0328 11.1892 10.0426 11.231 10.0549 11.2851C10.0793 11.3933 10.1135 11.5507 10.1515 11.7446C10.2277 12.1333 10.3188 12.665 10.3793 13.2398C10.4401 13.8171 10.4685 14.4242 10.425 14.9679C10.3806 15.5235 10.2652 15.9532 10.0855 16.2227C10.0264 16.3113 9.91385 16.444 9.75942 16.6058C9.56051 16.8142 9.13137 16.7657 8.99666 16.3777C8.71411 15.5639 8.33339 14.5481 7.94904 13.777C6.88216 11.6365 6.19326 10.2759 4.33336 8.62597C3.99304 8.32406 3.58878 8.1089 3.19665 7.9539C2.31631 7.60592 1.75035 6.80549 1.89639 6.0753L2.24943 4.31013C2.36085 3.753 2.77748 3.30665 3.32562 3.15715L8.92536 1.62995C10.9052 1.08999 12.9227 2.36145 13.2898 4.38053L13.9738 8.14223C14.197 9.36991 13.2538 10.5 12.006 10.5H10.5015C10.3476 10.5 10.2022 10.5709 10.1074 10.6923C10.0127 10.8136 9.97921 10.972 10.0165 11.1214C10.0165 11.1214 10.0165 11.1213 10.0165 11.1214Z",fill:e.palette.neutralPrimary}),a.createElement("path",{d:"M10.4829 17.2962C9.68406 18.1333 8.39129 17.683 8.05198 16.7057C7.77205 15.8995 7.4084 14.9339 7.05406 14.2231C5.99442 12.0971 5.37583 10.8875 3.66974 9.37403C3.44337 9.17322 3.15163 9.01139 2.82905 8.88388C1.69991 8.43756 0.638089 7.2678 0.915812 5.87918L1.26885 4.11401C1.45455 3.18547 2.14894 2.44154 3.06251 2.19239L8.66224 0.665189C11.2078 -0.0290479 13.8017 1.60569 14.2737 4.20164L14.9576 7.96334C15.2924 9.80486 13.8777 11.5 12.006 11.5H11.1225L11.1328 11.5522C11.2129 11.9604 11.3093 12.5225 11.3738 13.1352C11.438 13.7454 11.4721 14.4195 11.4218 15.0477C11.3725 15.6641 11.2379 16.2968 10.9176 16.7774C10.8081 16.9416 10.6455 17.1257 10.4829 17.2962Z",fill:"transparent"}))},Se=()=>{const e=ee();return a.createElement("svg",{width:"16",height:"18",viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.05198 1.29418C8.39129 0.316883 9.68406 -0.133389 10.4829 0.703737C10.6455 0.874162 10.8081 1.05832 10.9176 1.22254C11.2379 1.70305 11.3725 2.33584 11.4218 2.9522C11.4721 3.58034 11.438 4.25446 11.3738 4.86473C11.3093 5.47735 11.2129 6.03948 11.1328 6.44766C11.1294 6.46535 11.1259 6.48277 11.1225 6.49989H12.006C13.8777 6.49989 15.2924 8.19503 14.9576 10.0365L14.2737 13.7983C13.8017 16.3942 11.2078 18.0289 8.66224 17.3347L3.06251 15.8075C2.14894 15.5583 1.45455 14.8144 1.26885 13.8859L0.915812 12.1207C0.638089 10.7321 1.69991 9.56233 2.82905 9.11601C3.15163 8.9885 3.44337 8.82668 3.66974 8.62586C5.37583 7.11234 5.99442 5.90276 7.05406 3.77684C7.4084 3.06594 7.77205 2.10043 8.05198 1.29418ZM10.0165 6.87851L10.0169 6.87696L10.0187 6.86962L10.0262 6.83852C10.0328 6.81068 10.0426 6.76892 10.0549 6.71482C10.0793 6.60658 10.1135 6.44919 10.1515 6.25525C10.2277 5.86655 10.3188 5.33493 10.3793 4.76005C10.4401 4.18282 10.4685 3.57569 10.425 3.03195C10.3806 2.47644 10.2652 2.04673 10.0855 1.77724C10.0264 1.68859 9.91385 1.55593 9.75942 1.3941C9.56051 1.18565 9.13137 1.23417 8.99666 1.62217C8.71411 2.43598 8.33339 3.45183 7.94904 4.22294C6.88216 6.36338 6.19326 7.72396 4.33336 9.37392C3.99304 9.67583 3.58878 9.89099 3.19665 10.046C2.31631 10.394 1.75035 11.1944 1.89639 11.9246L2.24943 13.6898C2.36085 14.2469 2.77748 14.6932 3.32562 14.8427L8.92536 16.3699C10.9052 16.9099 12.9227 15.6384 13.2898 13.6194L13.9738 9.85766C14.197 8.62998 13.2538 7.49989 12.006 7.49989H10.5015C10.3476 7.49989 10.2022 7.42895 10.1074 7.3076C10.0127 7.18627 9.97921 7.02785 10.0165 6.87851C10.0165 6.87847 10.0165 6.87855 10.0165 6.87851Z",fill:e.palette.neutralPrimary}),a.createElement("path",{d:"M9.92039 0.703737C9.12156 -0.133389 7.82879 0.316883 7.48948 1.29418C7.20955 2.10043 6.8459 3.06594 6.49156 3.77684C5.43192 5.90276 4.81333 7.11234 3.10724 8.62586C2.88087 8.82668 2.58913 8.9885 2.26655 9.11601C1.13741 9.56233 0.075589 10.7321 0.353312 12.1207L0.706346 13.8859C0.892055 14.8144 1.58644 15.5583 2.50001 15.8075L8.09974 17.3347C10.6453 18.0289 13.2392 16.3942 13.7112 13.7983L14.3951 10.0365C14.7299 8.19503 13.3152 6.49989 11.4435 6.49989H10.56L10.5703 6.44766C10.6504 6.03948 10.7468 5.47735 10.8113 4.86473C10.8755 4.25446 10.9096 3.58034 10.8593 2.9522C10.81 2.33584 10.6754 1.70305 10.3551 1.22254C10.2456 1.05832 10.083 0.874161 9.92039 0.703737Z",fill:"transparent"}))},be=()=>(0,c.K1)({icons:{KeepItIcon:a.createElement(me,null),UndoIcon:a.createElement(he,{fill:$.palette.neutralPrimary}),UndoIconDisabled:a.createElement(he,{fill:$.palette.neutralQuaternary}),InsertIcon:a.createElement(ve,null),InlineCopyIcon:a.createElement(ye,{fill:$.palette.neutralPrimary,viewBox:"0 0 24 24"}),DefaultCopyIcon:a.createElement(ye,{fill:$.palette.neutralLight,viewBox:"0 0 32 32"}),RegenerateIcon:a.createElement(ge,{fill:$.palette.neutralQuaternary}),ThumbsUpChatCard:a.createElement(Se,null),ThumbsDownChatCard:a.createElement(Ce,null),RefreshIcon:a.createElement(fe,null)}});be();be();be();n(58651);be();n(58651);n(20378);var Ee;!function(e){e[e.Default=0]="Default",e[e.LinkEmbedded=1]="LinkEmbedded",e[e.ListEmbedded=2]="ListEmbedded",e[e.ListLinkEmbedded=3]="ListLinkEmbedded",e[e.AccordionCard=4]="AccordionCard",e[e.ContentCard=5]="ContentCard",e[e.ChatCardWrapper=6]="ChatCardWrapper",e[e.FeedbackNudge=7]="FeedbackNudge",e[e.MarkDownCard=8]="MarkDownCard",e[e.StreamingAdaptiveCard=9]="StreamingAdaptiveCard",e[e.WarningMessage=10]="WarningMessage"}(Ee||(Ee={}));var Te=n(27409),Ie=n(62614),_e=n.n(Ie);Te.AdaptiveCard.onProcessMarkdown=(e,t)=>{t.outputHtml=(new(_e())).render(e),t.didProcess=!0};n(74873);var we,Pe=n(27437),xe=n(29513);!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.Section=3]="Section"}(we||(we={}));var ke={topLeftEdge:0,topCenter:1,topRightEdge:2,topAutoEdge:3,bottomLeftEdge:4,bottomCenter:5,bottomRightEdge:6,bottomAutoEdge:7,leftTopEdge:8,leftCenter:9,leftBottomEdge:10,rightTopEdge:11,rightCenter:12,rightBottomEdge:13},Ae=n(32341),Le=n(68786),De=n(81478),Oe=n(70988),Ne=n(35386),Re=n(39209),Fe=n(61446),Me=n(18501),Be=n(99732),Ue=n(71770),He=n(69050),Ge=n(28834),ze=n(66705),qe=n(59855),We=n(41435),je=n(91292);function Ve(e){return e.canCheck?!(!e.isChecked&&!e.checked):"boolean"==typeof e.isChecked?e.isChecked:"boolean"==typeof e.checked?e.checked:null}function Qe(e){return!(!e.subMenuProps&&!e.items)}function Je(e){return!(!e.isDisabled&&!e.disabled)}function Ke(e){return null!==Ve(e)?"menuitemcheckbox":"menuitem"}var Xe,Ze,Ye=n(8587),$e=n(38514),et=n(75455);!function(e){e[e.top=1]="top",e[e.bottom=-1]="bottom",e[e.left=2]="left",e[e.right=-2]="right"}(Xe||(Xe={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.start=2]="start",e[e.end=3]="end"}(Ze||(Ze={}));var tt,nt=n(72677);function rt(e,t,n){return{targetEdge:e,alignmentEdge:t,isAuto:n}}var ot=((tt={})[ke.topLeftEdge]=rt(Xe.top,Xe.left),tt[ke.topCenter]=rt(Xe.top),tt[ke.topRightEdge]=rt(Xe.top,Xe.right),tt[ke.topAutoEdge]=rt(Xe.top,void 0,!0),tt[ke.bottomLeftEdge]=rt(Xe.bottom,Xe.left),tt[ke.bottomCenter]=rt(Xe.bottom),tt[ke.bottomRightEdge]=rt(Xe.bottom,Xe.right),tt[ke.bottomAutoEdge]=rt(Xe.bottom,void 0,!0),tt[ke.leftTopEdge]=rt(Xe.left,Xe.top),tt[ke.leftCenter]=rt(Xe.left),tt[ke.leftBottomEdge]=rt(Xe.left,Xe.bottom),tt[ke.rightTopEdge]=rt(Xe.right,Xe.top),tt[ke.rightCenter]=rt(Xe.right),tt[ke.rightBottomEdge]=rt(Xe.right,Xe.bottom),tt);function it(e,t){return!(e.top<t.top)&&(!(e.bottom>t.bottom)&&(!(e.left<t.left)&&!(e.right>t.right)))}function at(e,t){var n=[];return e.top<t.top&&n.push(Xe.top),e.bottom>t.bottom&&n.push(Xe.bottom),e.left<t.left&&n.push(Xe.left),e.right>t.right&&n.push(Xe.right),n}function st(e,t){return e[Xe[t]]}function lt(e,t,n){return e[Xe[t]]=n,e}function ct(e,t){var n=Et(t);return(st(e,n.positiveEdge)+st(e,n.negativeEdge))/2}function ut(e,t){return e>0?t:-1*t}function dt(e,t){return ut(e,st(t,e))}function pt(e,t,n){return ut(n,st(e,n)-st(t,n))}function gt(e,t,n,r){void 0===r&&(r=!0);var o=st(e,t)-n,i=lt(e,t,n);return r&&(i=lt(e,-1*t,st(e,-1*t)-o)),i}function mt(e,t,n,r){return void 0===r&&(r=0),gt(e,n,st(t,n)+ut(n,r))}function ft(e,t,n){return dt(n,e)>dt(n,t)}function ht(e,t){for(var n=0,r=0,o=at(e,t);r<o.length;r++){var i=o[r];n+=Math.pow(pt(e,t,i),2)}return n}function vt(e,t,n,r){return void 0===r&&(r=200),(n===Xe.bottom||n===Xe.top)&&pt(e,t,n)>=r}function yt(e,t,n,r,o,i,a,s,l){void 0===o&&(o=!1),void 0===a&&(a=0);var c=r.alignmentEdge,u=r.alignTargetEdge,d={elementRectangle:e,targetEdge:r.targetEdge,alignmentEdge:c};s||l||(d=function(e,t,n,r,o,i,a){void 0===o&&(o=!1),void 0===a&&(a=0);var s=[Xe.left,Xe.right,Xe.bottom,Xe.top];(0,Ne.jI)()&&(s[0]*=-1,s[1]*=-1);for(var l,c=e,u=r.targetEdge,d=r.alignmentEdge,p=u,g=d,m=0;m<4;m++){if(ft(c,n,u))return{elementRectangle:c,targetEdge:u,alignmentEdge:d};if(o&&vt(t,n,u,i)){switch(u){case Xe.bottom:c.bottom=n.bottom;break;case Xe.top:c.top=n.top}return{elementRectangle:c,targetEdge:u,alignmentEdge:d,forcedInBounds:!0}}var f=ht(c,n);(!l||f<l)&&(l=f,p=u,g=d),s.splice(s.indexOf(u),1),s.length>0&&(s.indexOf(-1*u)>-1?u*=-1:(d=u,u=s.slice(-1)[0]),c=bt(e,t,{targetEdge:u,alignmentEdge:d},a))}return{elementRectangle:c=bt(e,t,{targetEdge:p,alignmentEdge:g},a),targetEdge:p,alignmentEdge:g}}(e,t,n,r,o,i,a));var p=at(d.elementRectangle,n),g=s?-d.targetEdge:void 0;if(p.length>0)if(u)if(d.alignmentEdge&&p.indexOf(-1*d.alignmentEdge)>-1){var m=function(e,t,n,r){var o=e.alignmentEdge,i=e.targetEdge,a=-1*o;return{elementRectangle:bt(e.elementRectangle,t,{targetEdge:i,alignmentEdge:a},n,r),targetEdge:i,alignmentEdge:a}}(d,t,a,l);if(it(m.elementRectangle,n))return m;d=Ct(at(m.elementRectangle,n),d,n,g)}else d=Ct(p,d,n,g);else d=Ct(p,d,n,g);return d}function Ct(e,t,n,r){for(var o=0,i=e;o<i.length;o++){var a=i[o],s=void 0;if(r&&r===-1*a)s=gt(t.elementRectangle,a,st(n,a),!1),t.forcedInBounds=!0;else ft(s=mt(t.elementRectangle,n,a),n,-1*a)||(s=gt(s,-1*a,st(n,-1*a),!1),t.forcedInBounds=!0);t.elementRectangle=s}return t}function St(e,t,n){var r=Et(t).positiveEdge;return gt(e,r,n-(ct(e,t)-st(e,r)))}function bt(e,t,n,r,o){void 0===r&&(r=0);var i=new nt.M(e.left,e.right,e.top,e.bottom),a=n.alignmentEdge,s=n.targetEdge,l=o?s:-1*s;(i=o?mt(i,t,s,r):function(e,t,n,r){void 0===r&&(r=0);var o=ut(-1*n,r);return gt(e,-1*n,st(t,n)+o)}(i,t,s,r),a)?i=mt(i,t,a):i=St(i,l,ct(t,s));return i}function Et(e){return e===Xe.top||e===Xe.bottom?{positiveEdge:Xe.left,negativeEdge:Xe.right}:{positiveEdge:Xe.top,negativeEdge:Xe.bottom}}function Tt(e,t,n){return n&&Math.abs(pt(e,n,t))>Math.abs(pt(e,n,-1*t))?-1*t:t}function It(e,t,n,r,o,i,a,s){var l,c={},u=Lt(t),d=i?n:-1*n,p=o||Et(n).positiveEdge;return a&&!function(e,t,n){return void 0!==n&&st(e,t)===st(n,t)}(e,(l=p,-1*l),r)||(p=Tt(e,p,r)),c[Xe[d]]=pt(e,u,d),c[Xe[p]]=pt(e,u,p),s&&(c[Xe[-1*d]]=pt(e,u,-1*d),c[Xe[-1*p]]=pt(e,u,-1*p)),c}function _t(e){return Math.sqrt(e*e*2)}function wt(e,t,n){if(void 0===e&&(e=ke.bottomAutoEdge),n)return{alignmentEdge:n.alignmentEdge,isAuto:n.isAuto,targetEdge:n.targetEdge};var r=(0,F.__assign)({},ot[e]);return(0,Ne.jI)()?(r.alignmentEdge&&r.alignmentEdge%2==0&&(r.alignmentEdge=-1*r.alignmentEdge),void 0!==t?ot[t]:r):r}function Pt(e,t,n){var r=ct(t,e),o=ct(n,e),i=Et(e),a=i.positiveEdge,s=i.negativeEdge;return r<=o?a:s}function xt(e,t,n,r,o,i,a,s,l){void 0===i&&(i=!1);var c=bt(e,t,r,o,l);return it(c,n)?{elementRectangle:c,targetEdge:r.targetEdge,alignmentEdge:r.alignmentEdge}:yt(c,t,n,r,i,a,o,s,l)}function kt(e,t,n){var r=-1*e.targetEdge,o=new nt.M(0,e.elementRectangle.width,0,e.elementRectangle.height),i={},a=Tt(e.elementRectangle,e.alignmentEdge?e.alignmentEdge:Et(r).positiveEdge,n),s=pt(e.elementRectangle,e.targetRectangle,r)>Math.abs(st(t,r));return i[Xe[r]]=st(t,r),i[Xe[a]]=pt(t,o,a),{elementPosition:(0,F.__assign)({},i),closestEdge:Pt(e.targetEdge,t,o),targetEdge:r,hideBeak:!s}}function At(e,t){var n=t.targetRectangle,r=Et(t.targetEdge),o=r.positiveEdge,i=r.negativeEdge,a=ct(n,t.targetEdge),s=new nt.M(e/2,t.elementRectangle.width-e/2,e/2,t.elementRectangle.height-e/2),l=new nt.M(0,e,0,e);return ft(l=St(l=gt(l,-1*t.targetEdge,-e/2),-1*t.targetEdge,a-dt(o,t.elementRectangle)),s,o)?ft(l,s,i)||(l=mt(l,s,i)):l=mt(l,s,o),l}function Lt(e){var t=e.getBoundingClientRect();return new nt.M(t.left,t.right,t.top,t.bottom)}function Dt(e){return new nt.M(e.left,e.right,e.top,e.bottom)}function Ot(e,t,n,r,o,i){void 0===o&&(o=!1);var a=e.gapSpace?e.gapSpace:0,s=function(e,t){var n;if(t){if(t.preventDefault){var r=t;n=new nt.M(r.clientX,r.clientX,r.clientY,r.clientY)}else if(t.getBoundingClientRect)n=Lt(t);else{var o=t,i=o.left||o.x,a=o.top||o.y,s=o.right||i,l=o.bottom||a;n=new nt.M(i,s,a,l)}if(!it(n,e))for(var c=0,u=at(n,e);c<u.length;c++){var d=u[c];n[Xe[d]]=e[Xe[d]]}}else n=new nt.M(0,0,0,0);return n}(n,e.target),l=function(e,t,n,r,o){return e.isAuto&&(e.alignmentEdge=Pt(e.targetEdge,t,n)),e.alignTargetEdge=o,e}(wt(e.directionalHint,e.directionalHintForRTL,r),s,n,e.coverTarget,e.alignTargetEdge),c=xt(Lt(t),s,n,l,a,o,i,e.directionalHintFixed,e.coverTarget);return(0,F.__assign)((0,F.__assign)({},c),{targetRectangle:s})}function Nt(e,t,n,r,o){return{elementPosition:It(e.elementRectangle,t,e.targetEdge,n,e.alignmentEdge,r,o,e.forcedInBounds),targetEdge:e.targetEdge,alignmentEdge:e.alignmentEdge}}function Rt(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),_t(e?t:0)/2+n}function Ft(e,t,n,r,o,i,a,s){void 0===o&&(o=!1);var l=null!=s?s:(0,A.z)(),c=e.isBeakVisible&&e.beakWidth||0,u=Rt(e.isBeakVisible,e.beakWidth,e.gapSpace),d=e;d.gapSpace=u;var p=e.bounds?Dt(e.bounds):new nt.M(0,l.innerWidth-(0,et.XJ)(),0,l.innerHeight),g=Ot(d,n,p,r,o,i),m=kt(g,At(c,g),p);return(0,F.__assign)((0,F.__assign)({},Nt(g,t,p,e.coverTarget,a)),{beakPosition:m})}function Mt(e){var t,n,r,o,i=e,a=e,s=e,l=null!==(t=s.left)&&void 0!==t?t:s.x,c=null!==(n=s.top)&&void 0!==n?n:s.y,u=null!==(r=s.right)&&void 0!==r?r:l,d=null!==(o=s.bottom)&&void 0!==o?o:c;return i.stopPropagation?new nt.M(i.clientX,i.clientX,i.clientY,i.clientY):void 0!==l&&void 0!==c?new nt.M(l,u,c,d):Lt(a)}function Bt(e,t,n,r,o){return function(e,t,n,r,o){return Ft(e,t,n,r,!1,void 0,!0,null!=o?o:(0,A.z)())}(e,t,n,r,o)}var Ut=n(323),Ht=n(83942),Gt=n(81117),zt=n(30266),qt=n(97504);function Wt(e){var t=e.originalElement,n=e.containsFocus;t&&n&&t!==(0,A.z)()&&setTimeout((function(){var e;null===(e=t.focus)||void 0===e||e.call(t)}),0)}var jt=a.forwardRef((function(e,t){var n=(0,Ge.N)({shouldRestoreFocus:!0,enableAriaHiddenSiblings:!0},e),r=a.useRef(),o=(0,zt.a)(r,t);!function(e,t){var n="true"===String(e["aria-modal"]).toLowerCase()&&e.enableAriaHiddenSiblings;a.useEffect((function(){if(n&&t.current)return(0,Ut.q)(t.current)}),[t,n])}(n,r),function(e,t){var n=e.onRestoreFocus,r=void 0===n?Wt:n,o=a.useRef(),i=a.useRef(!1);a.useEffect((function(){return o.current=(0,Fe.Y)().activeElement,(0,Be.SE)(t.current)&&(i.current=!0),function(){var e;null==r||r({originalElement:o.current,containsFocus:i.current,documentContainsFocus:(null===(e=(0,Fe.Y)())||void 0===e?void 0:e.hasFocus())||!1}),o.current=void 0}}),[]),(0,Gt.x)(t,"focus",a.useCallback((function(){i.current=!0}),[]),!0),(0,Gt.x)(t,"blur",a.useCallback((function(e){t.current&&e.relatedTarget&&!t.current.contains(e.relatedTarget)&&(i.current=!1)}),[]),!0)}(n,r);var i=n.role,s=n.className,l=n.ariaLabel,c=n.ariaLabelledBy,u=n.ariaDescribedBy,d=n.style,p=n.children,g=n.onDismiss,m=function(e,t){var n=(0,Ht.Y)(),r=a.useState(!1),o=r[0],i=r[1];return a.useEffect((function(){return n.requestAnimationFrame((function(){var n;if(!e.style||!e.style.overflowY){var r=!1;if(t&&t.current&&(null===(n=t.current)||void 0===n?void 0:n.firstElementChild)){var a=t.current.clientHeight,s=t.current.firstElementChild.clientHeight;a>0&&s>a&&(r=s-a>1)}o!==r&&i(r)}})),function(){return n.dispose()}})),o}(n,r),f=a.useCallback((function(e){if(e.which===Me.c.escape)g&&(g(e),e.preventDefault(),e.stopPropagation())}),[g]),h=(0,qt.ox)();return(0,Gt.x)(h,"keydown",f),a.createElement("div",(0,F.__assign)({ref:o},(0,qe.G1)(n,qe.JM),{className:s,role:i,"aria-label":l,"aria-labelledby":c,"aria-describedby":u,onKeyDown:f,style:(0,F.__assign)({overflowY:m?"scroll":void 0,outline:"none"},d)}),p)}));jt.displayName="Popup";var Vt,Qt=n(25145),Jt=n(92897),Kt=function(){var e;return null!==(e=(0,qt.ox)())&&void 0!==e?e:"undefined"!=typeof window?window:void 0},Xt=function(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.document)&&void 0!==n?n:"undefined"!=typeof document?document:void 0},Zt=((Vt={})[Xe.top]=c.lw.slideUpIn10,Vt[Xe.bottom]=c.lw.slideDownIn10,Vt[Xe.left]=c.lw.slideLeftIn10,Vt[Xe.right]=c.lw.slideRightIn10,Vt),Yt=0,$t=0,en={opacity:0,filter:"opacity(0)",pointerEvents:"none"},tn=["role","aria-roledescription"],nn={preventDismissOnLostFocus:!1,preventDismissOnScroll:!1,preventDismissOnResize:!1,isBeakVisible:!0,beakWidth:16,gapSpace:0,minPagePadding:8,directionalHint:ke.bottomAutoEdge},rn=(0,De.Z)({disableCaching:!0});function on(e,t,n,r){var o,i=e.calloutMaxHeight,s=e.finalHeight,l=e.directionalHint,c=e.directionalHintFixed,u=e.hidden,d=e.gapSpace,p=e.beakWidth,g=e.isBeakVisible,m=e.coverTarget,f=a.useState(),h=f[0],v=f[1],y=null!==(o=null==r?void 0:r.elementPosition)&&void 0!==o?o:{},C=y.top,S=y.bottom,b=(null==n?void 0:n.current)?Mt(n.current):void 0;return a.useEffect((function(){var e,n,o=null!==(e=t())&&void 0!==e?e:{},a=o.top,s=o.bottom;(null==r?void 0:r.targetEdge)===Xe.top&&(null==b?void 0:b.top)&&!m&&(s=b.top-function(e,t,n){return Rt(e,t,n)}(g,p,d)),"number"==typeof C&&s?n=s-C:"number"==typeof S&&"number"==typeof a&&s&&(n=s-a-S),v(!i&&!u||i&&n&&i>n?n:i||void 0)}),[S,i,s,l,c,t,u,r,C,d,p,g,b,m]),h}function an(e,t,n,r,o,i){var s,l=a.useState(),c=l[0],u=l[1],d=a.useRef(0),p=a.useRef(),g=(0,Ht.Y)(),m=e.hidden,f=e.target,h=e.finalHeight,v=e.calloutMaxHeight,y=e.onPositioned,C=e.directionalHint,S=e.hideOverflow,b=e.preferScrollResizePositioning,E=Kt(),T=a.useRef();T.current!==i.current&&(T.current=i.current,s=i.current?null==E?void 0:E.getComputedStyle(i.current):void 0);var I=null==s?void 0:s.overflowY;return a.useEffect((function(){if(!m){var i=g.requestAnimationFrame((function(){var i,a,s,l;if(t.current&&n){var g=(0,F.__assign)((0,F.__assign)({},e),{target:r.current,bounds:o()}),m=n.cloneNode(!0);m.style.maxHeight=v?"".concat(v):"",m.style.visibility="hidden",null===(i=n.parentElement)||void 0===i||i.appendChild(m);var C=p.current===f?c:void 0,T=b&&!(S||"clip"===I||"hidden"===I),_=h?Bt(g,t.current,m,C,E):function(e,t,n,r,o,i,a){return Ft(e,t,n,r,o,i,void 0,a)}(g,t.current,m,C,T,void 0,E);null===(a=n.parentElement)||void 0===a||a.removeChild(m),!c&&_||c&&_&&(l=_,!cn((s=c).elementPosition,l.elementPosition)||!cn(s.beakPosition.elementPosition,l.beakPosition.elementPosition))&&d.current<5?(d.current++,u(_)):d.current>0&&(d.current=0,null==y||y(c))}}),n);return p.current=f,function(){g.cancelAnimationFrame(i),p.current=void 0}}u(void 0),d.current=0}),[m,C,g,n,v,t,r,h,o,y,c,e,f,S,b,I,E]),c}var sn=a.memo(a.forwardRef((function(e,t){var n=(0,Ge.N)(nn,e),r=n.styles,o=n.style,i=n.ariaLabel,s=n.ariaDescribedBy,l=n.ariaLabelledBy,c=n.className,u=n.isBeakVisible,d=n.children,p=n.beakWidth,g=n.calloutWidth,m=n.calloutMaxWidth,f=n.calloutMinWidth,h=n.doNotLayer,v=n.finalHeight,y=n.hideOverflow,C=void 0===y?!!v:y,S=n.backgroundColor,b=n.calloutMaxHeight,E=n.onScroll,T=n.shouldRestoreFocus,I=void 0===T||T,_=n.target,w=n.hidden,P=n.onLayerMounted,x=n.popupProps,k=a.useRef(null),A=a.useRef(null),L=(0,zt.a)(A,null==x?void 0:x.ref),D=a.useState(null),O=D[0],N=D[1],R=a.useCallback((function(e){N(e)}),[]),M=(0,zt.a)(k,t),B=(0,Jt.P)(n.target,{current:O}),U=B[0],H=B[1],G=function(e,t,n){var r=e.bounds,o=e.minPagePadding,i=void 0===o?nn.minPagePadding:o,s=e.target,l=a.useState(!1),c=l[0],u=l[1],d=a.useRef(),p=a.useCallback((function(){if(!d.current||c){var e="function"==typeof r?n?r(s,n):void 0:r;!e&&n&&(e=function(e,t){return function(e,t){var n=void 0;if(t.getWindowSegments&&(n=t.getWindowSegments()),void 0===n||n.length<=1)return{top:0,left:0,right:t.innerWidth,bottom:t.innerHeight,width:t.innerWidth,height:t.innerHeight};var r=0,o=0;if(null!==e&&e.getBoundingClientRect){var i=e.getBoundingClientRect();r=(i.left+i.right)/2,o=(i.top+i.bottom)/2}else null!==e&&(r=e.left||e.x,o=e.top||e.y);for(var a={top:0,left:0,right:0,bottom:0,width:0,height:0},s=0,l=n;s<l.length;s++){var c=l[s];r&&c.left<=r&&c.right>=r&&o&&c.top<=o&&c.bottom>=o&&(a={top:c.top,left:c.left,right:c.right,bottom:c.bottom,width:c.width,height:c.height})}return a}(e,t)}(t.current,n),e={top:e.top+i,left:e.left+i,right:e.right-i,bottom:e.bottom-i,width:e.width-2*i,height:e.height-2*i}),d.current=e,c&&u(!1)}return d.current}),[r,i,s,t,n,c]),g=(0,Ht.Y)();return(0,Gt.x)(n,"resize",g.debounce((function(){u(!0)}),500,{leading:!0})),p}(n,U,H),z=an(n,k,O,U,G,L),q=on(n,G,U,z),W=function(e,t,n,r,o){var i=e.hidden,s=e.onDismiss,l=e.preventDismissOnScroll,c=e.preventDismissOnResize,u=e.preventDismissOnLostFocus,d=e.dismissOnTargetClick,p=e.shouldDismissOnWindowFocus,g=e.preventDismissOnEvent,m=a.useRef(!1),f=(0,Ht.Y)(),h=(0,Qt.d)([function(){m.current=!0},function(){m.current=!1}]),v=!!t;return a.useEffect((function(){var e=function(e){v&&!l&&h(e)},t=function(e){c||g&&g(e)||null==s||s(e)},a=function(e){u||h(e)},h=function(e){var t=e.composedPath?e.composedPath():[],i=t.length>0?t[0]:e.target,a=n.current&&!(0,Ye.s)(n.current,i);if(a&&m.current)m.current=!1;else if(!r.current&&a||e.target!==o&&a&&(!r.current||"stopPropagation"in r.current||d||i!==r.current&&!(0,Ye.s)(r.current,i))){if(g&&g(e))return;null==s||s(e)}},y=function(e){p&&((!g||g(e))&&(g||u)||(null==o?void 0:o.document.hasFocus())||null!==e.relatedTarget||null==s||s(e))},C=new Promise((function(n){f.setTimeout((function(){if(!i&&o){var r=[(0,$e.on)(o,"scroll",e,!0),(0,$e.on)(o,"resize",t,!0),(0,$e.on)(o.document.documentElement,"focus",a,!0),(0,$e.on)(o.document.documentElement,"click",a,!0),(0,$e.on)(o,"blur",y,!0)];n((function(){r.forEach((function(e){return e()}))}))}}),0)}));return function(){C.then((function(e){return e()}))}}),[i,f,n,r,o,s,p,d,u,c,l,v,g]),h}(n,z,k,U,H),j=W[0],V=W[1],Q=(null==z?void 0:z.elementPosition.top)&&(null==z?void 0:z.elementPosition.bottom),J=(0,F.__assign)((0,F.__assign)({},null==z?void 0:z.elementPosition),{maxHeight:q});if(Q&&(J.bottom=void 0),function(e,t,n){var r=e.hidden,o=e.setInitialFocus,i=(0,Ht.Y)(),s=!!t;a.useEffect((function(){if(!r&&o&&s&&n){var e=i.requestAnimationFrame((function(){return(0,Be.vO)(n)}),n);return function(){return i.cancelAnimationFrame(e)}}}),[r,s,i,n,o])}(n,z,O),a.useEffect((function(){w||null==P||P()}),[w]),!H)return null;var K=C,X=u&&!!_,Z=rn(r,{theme:n.theme,className:c,overflowYHidden:K,calloutWidth:g,positions:z,beakWidth:p,backgroundColor:S,calloutMaxWidth:m,calloutMinWidth:f,doNotLayer:h}),Y=(0,F.__assign)((0,F.__assign)({maxHeight:b||"100%"},o),K&&{overflowY:"hidden"}),$=n.hidden?{visibility:"hidden"}:void 0;return a.createElement("div",{ref:M,className:Z.container,style:$},a.createElement("div",(0,F.__assign)({},(0,qe.G1)(n,qe.JM,tn),{className:(0,We.A)(Z.root,z&&z.targetEdge&&Zt[z.targetEdge]),style:z?(0,F.__assign)({},J):en,tabIndex:-1,ref:R}),X&&a.createElement("div",{className:Z.beak,style:ln(z)}),X&&a.createElement("div",{className:Z.beakCurtain}),a.createElement(jt,(0,F.__assign)({role:n.role,"aria-roledescription":n["aria-roledescription"],ariaDescribedBy:s,ariaLabel:i,ariaLabelledBy:l,className:Z.calloutMain,onDismiss:n.onDismiss,onMouseDown:j,onMouseUp:V,onRestoreFocus:n.onRestoreFocus,onScroll:E,shouldRestoreFocus:I,style:Y},x,{ref:L}),d)))})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,Re.ab)(e,t)}));function ln(e){var t,n,r=(0,F.__assign)((0,F.__assign)({},null===(t=null==e?void 0:e.beakPosition)||void 0===t?void 0:t.elementPosition),{display:(null===(n=null==e?void 0:e.beakPosition)||void 0===n?void 0:n.hideBeak)?"none":void 0});return r.top||r.bottom||r.left||r.right||(r.left=$t,r.top=Yt),r}function cn(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=e[n],o=t[n];if(void 0===r||void 0===o)return!1;if(r.toFixed(2)!==o.toFixed(2))return!1}return!0}function un(e){return{height:e,width:e}}sn.displayName="CalloutContentBase";var dn={container:"ms-Callout-container",root:"ms-Callout",beak:"ms-Callout-beak",beakCurtain:"ms-Callout-beakCurtain",calloutMain:"ms-Callout-main"},pn=(0,Pe.I)(sn,(function(e){var t,n=e.theme,r=e.className,o=e.overflowYHidden,i=e.calloutWidth,a=e.beakWidth,s=e.backgroundColor,l=e.calloutMaxWidth,u=e.calloutMinWidth,d=e.doNotLayer,p=(0,c.Km)(dn,n),g=n.semanticColors,m=n.effects;return{container:[p.container,{position:"relative"}],root:[p.root,n.fonts.medium,{position:"absolute",display:"flex",zIndex:d?c.nA.Layer:void 0,boxSizing:"border-box",borderRadius:m.roundedCorner2,boxShadow:m.elevation16,selectors:(t={},t[c.up]={borderWidth:1,borderStyle:"solid",borderColor:"WindowText"},t)},(0,c.QN)(),r,!!i&&{width:i},!!l&&{maxWidth:l},!!u&&{minWidth:u}],beak:[p.beak,{position:"absolute",backgroundColor:g.menuBackground,boxShadow:"inherit",border:"inherit",boxSizing:"border-box",transform:"rotate(45deg)"},un(a),s&&{backgroundColor:s}],beakCurtain:[p.beakCurtain,{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:g.menuBackground,borderRadius:m.roundedCorner2}],calloutMain:[p.calloutMain,{backgroundColor:g.menuBackground,overflowX:"hidden",overflowY:"auto",position:"relative",width:"100%",borderRadius:m.roundedCorner2},o&&{overflowY:"hidden"},s&&{backgroundColor:s}]}}),void 0,{scope:"CalloutContent"}),gn=n(63681),mn=n(21736),fn=n(45838),hn=(0,De.Z)(),vn=(0,Oe.J9)((function(e,t){return(0,M.a)((0,F.__assign)((0,F.__assign)({},e),{rtl:t}))})),yn=a.forwardRef((function(e,t){var n=e.className,r=e.theme,o=e.applyTheme,i=e.applyThemeToBody,s=e.styles,l=hn(s,{theme:r,applyTheme:o,className:n}),c=a.useRef(null);return function(e,t,n){var r=t.bodyThemed;a.useEffect((function(){if(e){var t=(0,Fe.Y)(n.current);if(t)return t.body.classList.add(r),function(){t.body.classList.remove(r)}}}),[r,e,n])}(i,l,c),a.createElement(a.Fragment,null,function(e,t,n,r){var o=t.root,i=e.as,s=void 0===i?"div":i,l=e.dir,c=e.theme,u=(0,qe.G1)(e,qe.JM,["dir"]),d=function(e){var t=e.theme,n=e.dir,r=(0,Ne.jI)(t)?"rtl":"ltr",o=(0,Ne.jI)()?"rtl":"ltr",i=n||r;return{rootDir:i!==r||i!==o?i:n,needsTheme:i!==r}}(e),p=d.rootDir,g=d.needsTheme,m=a.createElement(mn.N,{providerRef:n},a.createElement(s,(0,F.__assign)({dir:p},u,{className:o,ref:(0,zt.a)(n,r)})));g&&(m=a.createElement(fn.K,{settings:{theme:vn(c,"rtl"===l)}},m));return m}(e,l,c,t))}));yn.displayName="FabricBase";var Cn={fontFamily:"inherit"},Sn={root:"ms-Fabric",bodyThemed:"ms-Fabric-bodyThemed"},bn=(0,Pe.I)(yn,(function(e){var t=e.applyTheme,n=e.className,r=e.preventBlanketFontInheritance,o=e.theme;return{root:[(0,c.Km)(Sn,o).root,o.fonts.medium,{color:o.palette.neutralPrimary},!r&&{"& button":Cn,"& input":Cn,"& textarea":Cn},t&&{color:o.semanticColors.bodyText,backgroundColor:o.semanticColors.bodyBackground},n],bodyThemed:[{backgroundColor:o.semanticColors.bodyBackground}]}}),void 0,{scope:"Fabric"}),En=n(63794),Tn=n(46186),In=n(34163),_n={},wn={},Pn="fluent-default-layer-host",xn="#".concat(Pn);var kn,An=n(86389),Ln=(0,De.Z)(),Dn=a.forwardRef((function(e,t){var n=(0,gn.u)(),r=a.useRef(null),o=(0,zt.a)(r,t),i=a.useRef(),s=a.useRef(null),c=a.useContext(je.dM),u=a.useState(!1),d=u[0],p=u[1],g=a.useCallback((function(e){var t,n=!!(null==(t=null==c?void 0:c.providerRef)?void 0:t.current)&&t.current.classList.contains(En.Y2);e&&n&&e.classList.add(En.Y2)}),[c]),m=e.children,f=e.className,h=e.eventBubblingEnabled,v=e.fabricProps,y=e.hostId,C=e.insertFirst,S=e.onLayerDidMount,b=void 0===S?function(){}:S,E=e.onLayerMounted,T=void 0===E?function(){}:E,I=e.onLayerWillUnmount,_=e.styles,w=e.theme,P=(0,zt.a)(s,null==v?void 0:v.ref,g),x=Ln(_,{theme:w,className:f,isNotHost:!y}),k=function(e,t){var n,r;void 0===t&&(t=null);var o=null!=t?t:e;if(y){var i=function(e){var t=wn[e];return t&&t[0]||void 0}(y);return i?null!==(n=i.rootRef.current)&&void 0!==n?n:null:null!==(r=o.getElementById(y))&&void 0!==r?r:null}var a=xn,s=a?o.querySelector(a):null;return s||(s=function(e,t){void 0===t&&(t=null);var n=e.createElement("div");return n.setAttribute("id",Pn),n.style.cssText="position:fixed;z-index:1000000",t?t.appendChild(n):null==e||e.body.appendChild(n),n}(e,t)),s},A=function(){null==I||I();var e=i.current;i.current=void 0,e&&e.parentNode&&e.parentNode.removeChild(e)},L=function(){var e,t,n,o,a=(0,Fe.Y)(r.current),s=(null===(t=null===(e=r.current)||void 0===e?void 0:e.getRootNode())||void 0===t?void 0:t.host)?null===(n=null==r?void 0:r.current)||void 0===n?void 0:n.getRootNode():void 0;if(a&&(a||s)){var l=k(a,s);if(l){l.__tabsterElementFlags||(l.__tabsterElementFlags={}),l.__tabsterElementFlags.noDirectAriaHidden=!0,A();var c=(null!==(o=l.ownerDocument)&&void 0!==o?o:a).createElement("div");c.className=x.root,(0,Tn.V)(c),(0,In.g)(c,r.current),C?l.insertBefore(c,l.firstChild):l.appendChild(c),i.current=c,p(!0)}}};return(0,An.E)((function(){L(),y&&function(e,t){_n[e]||(_n[e]=[]),_n[e].push(t);var n=wn[e];if(n)for(var r=0,o=n;r<o.length;r++)o[r].notifyLayersChanged()}(y,L);var e=i.current?n(i.current):void 0;return function(){e&&e(),A(),y&&function(e,t){var n=_n[e];if(n){var r=n.indexOf(t);r>=0&&(n.splice(r,1),0===n.length&&delete _n[e])}var o=wn[e];if(o)for(var i=0,a=o;i<a.length;i++)a[i].notifyLayersChanged()}(y,L)}}),[y]),a.useEffect((function(){i.current&&d&&(null==T||T(),null==b||b(),p(!1))}),[d,T,b]),a.createElement("span",{className:"ms-layer",ref:o},i.current&&l.createPortal(a.createElement(mn.N,{layerRoot:!0,providerRef:P},a.createElement(bn,(0,F.__assign)({},!h&&function(){kn||(kn={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach((function(e){return kn[e]=On})));return kn}(),v,{className:(0,We.A)(x.content,null==v?void 0:v.className),ref:P}),m)),i.current))}));Dn.displayName="LayerBase";var On=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()};var Nn={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},Rn=(0,Pe.I)(Dn,(function(e){var t=e.className,n=e.isNotHost,r=e.theme,o=(0,c.Km)(Nn,r);return{root:[o.root,r.fonts.medium,n&&[o.rootNoHost,{position:"fixed",zIndex:c.nA.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[o.content,{visibility:"visible"}]}}),void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),Fn=a.forwardRef((function(e,t){var n=e.layerProps,r=e.doNotLayer,o=(0,F.__rest)(e,["layerProps","doNotLayer"]),i=a.createElement(pn,(0,F.__assign)({},o,{doNotLayer:r,ref:t}));return r?i:a.createElement(Rn,(0,F.__assign)({},n),i)}));Fn.displayName="Callout";var Mn,Bn,Un,Hn,Gn=n(72176);!function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(Mn||(Mn={})),function(e){e[e.center=0]="center",e[e.contain=1]="contain",e[e.cover=2]="cover",e[e.none=3]="none",e[e.centerCover=4]="centerCover",e[e.centerContain=5]="centerContain"}(Bn||(Bn={})),function(e){e[e.landscape=0]="landscape",e[e.portrait=1]="portrait"}(Un||(Un={})),function(e){e[e.notLoaded=0]="notLoaded",e[e.loaded=1]="loaded",e[e.error=2]="error",e[e.errorLoaded=3]="errorLoaded"}(Hn||(Hn={}));var zn=(0,De.Z)(),qn=/\.svg$/i;var Wn=a.forwardRef((function(e,t){var n=a.useRef(),r=a.useRef(),o=function(e,t){var n=e.onLoadingStateChange,r=e.onLoad,o=e.onError,i=e.src,s=a.useState(Hn.notLoaded),l=s[0],c=s[1];(0,An.E)((function(){c(Hn.notLoaded)}),[i]),a.useEffect((function(){l===Hn.notLoaded&&t.current&&(i&&t.current.naturalWidth>0&&t.current.naturalHeight>0||t.current.complete&&qn.test(i))&&c(Hn.loaded)})),a.useEffect((function(){null==n||n(l)}),[l]);var u=a.useCallback((function(e){null==r||r(e),i&&c(Hn.loaded)}),[i,r]),d=a.useCallback((function(e){null==o||o(e),c(Hn.error)}),[o]);return[l,u,d]}(e,r),i=o[0],s=o[1],l=o[2],c=(0,qe.G1)(e,qe.xM,["width","height"]),u=e.src,d=e.alt,p=e.width,g=e.height,m=e.shouldFadeIn,f=void 0===m||m,h=e.shouldStartVisible,v=e.className,y=e.imageFit,C=e.role,S=e.maximizeFrame,b=e.styles,E=e.theme,T=e.loading,I=function(e,t,n,r){var o=a.useRef(t),i=a.useRef();(void 0===i||o.current===Hn.notLoaded&&t===Hn.loaded)&&(i.current=function(e,t,n,r){var o=e.imageFit,i=e.width,a=e.height;if(void 0!==e.coverStyle)return e.coverStyle;if(t===Hn.loaded&&(o===Bn.cover||o===Bn.contain||o===Bn.centerContain||o===Bn.centerCover)&&n.current&&r.current){var s=void 0;if(s="number"==typeof i&&"number"==typeof a&&o!==Bn.centerContain&&o!==Bn.centerCover?i/a:r.current.clientWidth/r.current.clientHeight,n.current.naturalWidth/n.current.naturalHeight>s)return Un.landscape}return Un.portrait}(e,t,n,r));return o.current=t,i.current}(e,i,r,n),_=zn(b,{theme:E,className:v,width:p,height:g,maximizeFrame:S,shouldFadeIn:f,shouldStartVisible:h,isLoaded:i===Hn.loaded||i===Hn.notLoaded&&e.shouldStartVisible,isLandscape:I===Un.landscape,isCenter:y===Bn.center,isCenterContain:y===Bn.centerContain,isCenterCover:y===Bn.centerCover,isContain:y===Bn.contain,isCover:y===Bn.cover,isNone:y===Bn.none,isError:i===Hn.error,isNotImageFit:void 0===y});return a.createElement("div",{className:_.root,style:{width:p,height:g},ref:n},a.createElement("img",(0,F.__assign)({},c,{onLoad:s,onError:l,key:"fabricImage"+e.src||"",className:_.image,ref:(0,zt.a)(r,t),src:u,alt:d,role:C,loading:T})))}));Wn.displayName="ImageBase";var jn={root:"ms-Image",rootMaximizeFrame:"ms-Image--maximizeFrame",image:"ms-Image-image",imageCenter:"ms-Image-image--center",imageContain:"ms-Image-image--contain",imageCover:"ms-Image-image--cover",imageCenterContain:"ms-Image-image--centerContain",imageCenterCover:"ms-Image-image--centerCover",imageNone:"ms-Image-image--none",imageLandscape:"ms-Image-image--landscape",imagePortrait:"ms-Image-image--portrait"},Vn=(0,Pe.I)(Wn,(function(e){var t=e.className,n=e.width,r=e.height,o=e.maximizeFrame,i=e.isLoaded,a=e.shouldFadeIn,s=e.shouldStartVisible,l=e.isLandscape,u=e.isCenter,d=e.isContain,p=e.isCover,g=e.isCenterContain,m=e.isCenterCover,f=e.isNone,h=e.isError,v=e.isNotImageFit,y=e.theme,C=(0,c.Km)(jn,y),S={position:"absolute",left:"50% /* @noflip */",top:"50%",transform:"translate(-50%,-50%)"},b=(0,A.z)(),E=void 0!==b&&void 0===b.navigator.msMaxTouchPoints,T=d&&l||p&&!l?{width:"100%",height:"auto"}:{width:"auto",height:"100%"};return{root:[C.root,y.fonts.medium,{overflow:"hidden"},o&&[C.rootMaximizeFrame,{height:"100%",width:"100%"}],i&&a&&!s&&c.lw.fadeIn400,(u||d||p||g||m)&&{position:"relative"},t],image:[C.image,{display:"block",opacity:0},i&&["is-loaded",{opacity:1}],u&&[C.imageCenter,S],d&&[C.imageContain,E&&{width:"100%",height:"100%",objectFit:"contain"},!E&&T,!E&&S],p&&[C.imageCover,E&&{width:"100%",height:"100%",objectFit:"cover"},!E&&T,!E&&S],g&&[C.imageCenterContain,l&&{maxWidth:"100%"},!l&&{maxHeight:"100%"},S],m&&[C.imageCenterCover,l&&{maxHeight:"100%"},!l&&{maxWidth:"100%"},S],f&&[C.imageNone,{width:"auto",height:"auto"}],v&&[!!n&&!r&&{height:"auto",width:"100%"},!n&&!!r&&{height:"100%",width:"auto"},!!n&&!!r&&{height:"100%",width:"100%"}],l&&C.imageLandscape,!l&&C.imagePortrait,!i&&"is-notLoaded",a&&"is-fadeIn",h&&"is-error"]}}),void 0,{scope:"Image"},!0);Vn.displayName="Image";var Qn=(0,c.l8)({root:{display:"inline-block",textDecoration:"inherit"},placeholder:["ms-Icon-placeHolder",{width:"1em"}],image:["ms-Icon-imageContainer",{overflow:"hidden"}]}),Jn="ms-Icon",Kn=(0,Oe.J9)((function(e){var t=(0,c.sW)(e)||{subset:{},code:void 0},n=t.code,r=t.subset;return n?{children:n,iconClassName:r.className,fontFamily:r.fontFace&&r.fontFace.fontFamily,mergeImageProps:r.mergeImageProps}:null}),void 0,!0),Xn=function(e){var t=e.iconName,n=e.className,r=e.style,o=void 0===r?{}:r,i=Kn(t)||{},s=i.iconClassName,l=i.children,c=i.fontFamily,u=i.mergeImageProps,d=(0,qe.G1)(e,qe.vt),p=e["aria-label"]||e.title,g=e["aria-label"]||e["aria-labelledby"]||e.title?{role:u?void 0:"img"}:{"aria-hidden":!0},m=l;return u&&"object"==typeof l&&"object"==typeof l.props&&p&&(m=a.cloneElement(l,{alt:p})),a.createElement("i",(0,F.__assign)({"data-icon-name":t},g,d,u?{title:void 0,"aria-label":void 0}:{},{className:(0,We.A)(Jn,Qn.root,s,!t&&Qn.placeholder,n),style:(0,F.__assign)({fontFamily:c},o)}),m)},Zn=((0,Oe.J9)((function(e,t,n){return Xn({iconName:e,className:t,"aria-label":n})})),(0,De.Z)({cacheSize:100})),Yn=function(e){function t(t){var n=e.call(this,t)||this;return n._onImageLoadingStateChange=function(e){n.props.imageProps&&n.props.imageProps.onLoadingStateChange&&n.props.imageProps.onLoadingStateChange(e),e===Hn.error&&n.setState({imageLoadError:!0})},n.state={imageLoadError:!1},n}return(0,F.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.className,r=e.styles,o=e.iconName,i=e.imageErrorAs,s=e.theme,l="string"==typeof o&&0===o.length,c=!!this.props.imageProps||this.props.iconType===Mn.image||this.props.iconType===Mn.Image,u=Kn(o)||{},d=u.iconClassName,p=u.children,g=u.mergeImageProps,m=Zn(r,{theme:s,className:n,iconClassName:d,isImage:c,isPlaceholder:l}),f=c?"span":"i",h=(0,qe.G1)(this.props,qe.vt,["aria-label"]),v=this.state.imageLoadError,y=(0,F.__assign)((0,F.__assign)({},this.props.imageProps),{onLoadingStateChange:this._onImageLoadingStateChange}),C=v&&i||Vn,S=this.props["aria-label"]||this.props.ariaLabel,b=y.alt||S||this.props.title,E=!!(b||this.props["aria-labelledby"]||y["aria-label"]||y["aria-labelledby"])?{role:c||g?void 0:"img","aria-label":c||g?void 0:b}:{"aria-hidden":!0},T=p;return g&&p&&"object"==typeof p&&b&&(T=a.cloneElement(p,{alt:b})),a.createElement(f,(0,F.__assign)({"data-icon-name":o},E,h,g?{title:void 0,"aria-label":void 0}:{},{className:m.root}),c?a.createElement(C,(0,F.__assign)({},y)):t||T)},t}(a.Component),$n=(0,Pe.I)(Yn,(function(e){var t=e.className,n=e.iconClassName,r=e.isPlaceholder,o=e.isImage,i=e.styles;return{root:[r&&Qn.placeholder,Qn.root,o&&Qn.image,n,t,i&&i.root,i&&i.imageContainer]}}),void 0,{scope:"Icon"},!0);$n.displayName="Icon";var er,tr=function(e){var t=e.item,n=e.classNames,r=t.iconProps;return a.createElement($n,(0,F.__assign)({},r,{className:n.icon}))},nr=function(e){var t=e.item;return e.hasIcons?t.onRenderIcon?t.onRenderIcon(e,tr):tr(e):null},rr=function(e){var t=e.onCheckmarkClick,n=e.item,r=e.classNames,o=Ve(n);if(t){return a.createElement($n,{iconName:!1!==n.canCheck&&o?"CheckMark":"",className:r.checkmarkIcon,onClick:function(e){return t(n,e)}})}return null},or=function(e){var t=e.item,n=e.classNames;return t.text||t.name?a.createElement("span",{className:n.label},t.text||t.name):null},ir=function(e){var t=e.item,n=e.classNames;return t.secondaryText?a.createElement("span",{className:n.secondaryText},t.secondaryText):null},ar=function(e){var t=e.item,n=e.classNames,r=e.theme;return Qe(t)?a.createElement($n,(0,F.__assign)({iconName:(0,Ne.jI)(r)?"ChevronLeft":"ChevronRight"},t.submenuIconProps,{className:n.subMenuIcon})):null},sr=function(e){function t(t){var n=e.call(this,t)||this;return n.openSubMenu=function(){var e=n.props,t=e.item,r=e.openSubMenu,o=e.getSubmenuTarget;if(o){var i=o();Qe(t)&&r&&i&&r(t,i)}},n.dismissSubMenu=function(){var e=n.props,t=e.item,r=e.dismissSubMenu;Qe(t)&&r&&r()},n.dismissMenu=function(e){var t=n.props.dismissMenu;t&&t(void 0,e)},(0,Gn.f)(n),n}return(0,F.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,n=e.classNames,r=t.onRenderContent||this._renderLayout;return a.createElement("div",{className:t.split?n.linkContentMenu:n.linkContent},r(this.props,{renderCheckMarkIcon:rr,renderItemIcon:nr,renderItemName:or,renderSecondaryText:ir,renderSubMenuIcon:ar}))},t.prototype._renderLayout=function(e,t){return a.createElement(a.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),t.renderItemName(e),t.renderSecondaryText(e),t.renderSubMenuIcon(e))},t}(a.Component),lr=(0,Oe.J9)((function(e){return(0,c.l8)({wrapper:{display:"inline-flex",height:"100%",alignItems:"center"},divider:{width:1,height:"100%",backgroundColor:e.palette.neutralTertiaryAlt}})})),cr=36,ur=(0,c.L6)(0,c.mm),dr=(0,Oe.J9)((function(e){var t,n,r,o,i,a=e.semanticColors,s=e.fonts,l=e.palette,u=a.menuItemBackgroundHovered,d=a.menuItemTextHovered,p=a.menuItemBackgroundPressed,g=a.bodyDivider,m={item:[s.medium,{color:a.bodyText,position:"relative",boxSizing:"border-box"}],divider:{display:"block",height:"1px",backgroundColor:g,position:"relative"},root:[(0,c.gm)(e),s.medium,{color:a.bodyText,backgroundColor:"transparent",border:"none",width:"100%",height:cr,lineHeight:cr,display:"block",cursor:"pointer",padding:"0px 8px 0 4px",textAlign:"left"}],rootDisabled:{color:a.disabledBodyText,cursor:"default",pointerEvents:"none",selectors:(t={},t[c.up]={color:"GrayText",opacity:1},t)},rootHovered:{backgroundColor:u,color:d,selectors:{".ms-ContextualMenu-icon":{color:l.themeDarkAlt},".ms-ContextualMenu-submenuIcon":{color:l.neutralPrimary}}},rootFocused:{backgroundColor:l.white},rootChecked:{selectors:{".ms-ContextualMenu-checkmarkIcon":{color:l.neutralPrimary}}},rootPressed:{backgroundColor:p,selectors:{".ms-ContextualMenu-icon":{color:l.themeDark},".ms-ContextualMenu-submenuIcon":{color:l.neutralPrimary}}},rootExpanded:{backgroundColor:p,color:a.bodyTextChecked,selectors:(n={".ms-ContextualMenu-submenuIcon":(r={},r[c.up]={color:"inherit"},r)},n[c.up]=(0,F.__assign)({},(0,c.Qg)()),n)},linkContent:{whiteSpace:"nowrap",height:"inherit",display:"flex",alignItems:"center",maxWidth:"100%"},anchorLink:{padding:"0px 8px 0 4px",textRendering:"auto",color:"inherit",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",textDecoration:"none",boxSizing:"border-box"},label:{margin:"0 4px",verticalAlign:"middle",display:"inline-block",flexGrow:"1",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},secondaryText:{color:e.palette.neutralSecondary,paddingLeft:"20px",textAlign:"right"},icon:{display:"inline-block",minHeight:"1px",maxHeight:cr,fontSize:c.fF.medium,width:c.fF.medium,margin:"0 4px",verticalAlign:"middle",flexShrink:"0",selectors:(o={},o[ur]={fontSize:c.fF.large,width:c.fF.large},o)},iconColor:{color:a.menuIcon},iconDisabled:{color:a.disabledBodyText},checkmarkIcon:{color:a.bodySubtext},subMenuIcon:{height:cr,lineHeight:cr,color:l.neutralSecondary,textAlign:"center",display:"inline-block",verticalAlign:"middle",flexShrink:"0",fontSize:c.fF.small,selectors:(i={":hover":{color:l.neutralPrimary},":active":{color:l.neutralPrimary}},i[ur]={fontSize:c.fF.medium},i)},splitButtonFlexContainer:[(0,c.gm)(e),{display:"flex",height:cr,flexWrap:"nowrap",justifyContent:"center",alignItems:"flex-start"}]};return(0,c.TW)(m)})),pr="28px",gr=(0,c.L6)(0,c.mm),mr=(0,Oe.J9)((function(e){var t;return(0,c.l8)(lr(e),{wrapper:{position:"absolute",right:28,selectors:(t={},t[gr]={right:32},t)},divider:{height:16,width:1}})})),fr={item:"ms-ContextualMenu-item",divider:"ms-ContextualMenu-divider",root:"ms-ContextualMenu-link",isChecked:"is-checked",isExpanded:"is-expanded",isDisabled:"is-disabled",linkContent:"ms-ContextualMenu-linkContent",linkContentMenu:"ms-ContextualMenu-linkContent",icon:"ms-ContextualMenu-icon",iconColor:"ms-ContextualMenu-iconColor",checkmarkIcon:"ms-ContextualMenu-checkmarkIcon",subMenuIcon:"ms-ContextualMenu-submenuIcon",label:"ms-ContextualMenu-itemText",secondaryText:"ms-ContextualMenu-secondaryText",splitMenu:"ms-ContextualMenu-splitMenu",screenReaderText:"ms-ContextualMenu-screenReaderText"},hr=(0,Oe.J9)((function(e,t,n,r,o,i,a,s,l,u,d,p){var g,m,f,h,v=dr(e),y=(0,c.Km)(fr,e);return(0,c.l8)({item:[y.item,v.item,a],divider:[y.divider,v.divider,s],root:[y.root,v.root,r&&[y.isChecked,v.rootChecked],o&&v.anchorLink,n&&[y.isExpanded,v.rootExpanded],t&&[y.isDisabled,v.rootDisabled],!t&&!n&&[{selectors:(g={":hover":v.rootHovered,":active":v.rootPressed},g[".".concat(En.Y2," &:focus, .").concat(En.Y2," &:focus:hover, :host(.").concat(En.Y2,") &:focus, :host(.").concat(En.Y2,") &:focus:hover")]=v.rootFocused,g[".".concat(En.Y2," &:hover, :host(.").concat(En.Y2,") &:hover")]={background:"inherit;"},g)}],p],splitPrimary:[v.root,{width:"calc(100% - ".concat(pr,")")},r&&["is-checked",v.rootChecked],(t||d)&&["is-disabled",v.rootDisabled],!(t||d)&&!r&&[{selectors:(m={":hover":v.rootHovered},m[":hover ~ .".concat(y.splitMenu)]=v.rootHovered,m[":active"]=v.rootPressed,m[".".concat(En.Y2," &:focus, .").concat(En.Y2," &:focus:hover, :host(.").concat(En.Y2,") &:focus, :host(.").concat(En.Y2,") &:focus:hover")]=v.rootFocused,m[".".concat(En.Y2," &:hover, :host(.").concat(En.Y2,") &:hover")]={background:"inherit;"},m)}]],splitMenu:[y.splitMenu,v.root,{flexBasis:"0",padding:"0 8px",minWidth:pr},n&&["is-expanded",v.rootExpanded],t&&["is-disabled",v.rootDisabled],!t&&!n&&[{selectors:(f={":hover":v.rootHovered,":active":v.rootPressed},f[".".concat(En.Y2," &:focus, .").concat(En.Y2," &:focus:hover, :host(.").concat(En.Y2,") &:focus, :host(.").concat(En.Y2,") &:focus:hover")]=v.rootFocused,f[".".concat(En.Y2," &:hover, :host(.").concat(En.Y2,") &:hover")]={background:"inherit;"},f)}]],anchorLink:v.anchorLink,linkContent:[y.linkContent,v.linkContent],linkContentMenu:[y.linkContentMenu,v.linkContent,{justifyContent:"center"}],icon:[y.icon,i&&v.iconColor,v.icon,l,t&&[y.isDisabled,v.iconDisabled]],iconColor:v.iconColor,checkmarkIcon:[y.checkmarkIcon,i&&v.checkmarkIcon,v.icon,l],subMenuIcon:[y.subMenuIcon,v.subMenuIcon,u,n&&{color:e.palette.neutralPrimary},t&&[v.iconDisabled]],label:[y.label,v.label],secondaryText:[y.secondaryText,v.secondaryText],splitContainer:[v.splitButtonFlexContainer,!t&&!r&&[{selectors:(h={},h[".".concat(En.Y2," &:focus, .").concat(En.Y2," &:focus:hover, :host(.").concat(En.Y2,") &:focus, :host(.").concat(En.Y2,") &:focus:hover")]=v.rootFocused,h)}]],screenReaderText:[y.screenReaderText,v.screenReaderText,c.dX,{visibility:"hidden"}]})})),vr=function(e){var t=e.theme,n=e.disabled,r=e.expanded,o=e.checked,i=e.isAnchorLink,a=e.knownIcon,s=e.itemClassName,l=e.dividerClassName,c=e.iconClassName,u=e.subMenuClassName,d=e.primaryDisabled,p=e.className;return hr(t,n,r,o,i,a,s,l,c,u,d,p)},yr=(0,Pe.I)(sr,vr,void 0,{scope:"ContextualMenuItem"}),Cr=n(59273),Sr=n(12595),br=function(e){function t(t){var n=e.call(this,t)||this;return n._onItemMouseEnter=function(e){var t=n.props,r=t.item,o=t.onItemMouseEnter;o&&o(r,e,e.currentTarget)},n._onItemClick=function(e){var t=n.props,r=t.item,o=t.onItemClickBase;o&&o(r,e,e.currentTarget)},n._onItemMouseLeave=function(e){var t=n.props,r=t.item,o=t.onItemMouseLeave;o&&o(r,e)},n._onItemKeyDown=function(e){var t=n.props,r=t.item,o=t.onItemKeyDown;o&&o(r,e)},n._onItemMouseMove=function(e){var t=n.props,r=t.item,o=t.onItemMouseMove;o&&o(r,e,e.currentTarget)},n._getSubmenuTarget=function(){},(0,Gn.f)(n),n}return(0,F.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return!(0,Re.ab)(e,this.props)},t}(a.Component),Er="ktp",Tr="-",Ir="ktp-layer-id";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(er||(er={}));var _r=n(83553),wr=n(90845),Pr=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var n=e;t||(n=this.addParentOverflow(e),this.sequenceMapping[n.keySequences.toString()]=n);var r=this._getUniqueKtp(n);if(t?this.persistedKeytips[r.uniqueID]=r:this.keytips[r.uniqueID]=r,this.inKeytipMode||!this.delayUpdatingKeytipChange){var o=t?er.PERSISTED_KEYTIP_ADDED:er.KEYTIP_ADDED;wr.g.raise(this,o,{keytip:n,uniqueID:r.uniqueID})}return r.uniqueID},e.prototype.update=function(e,t){var n=this.addParentOverflow(e),r=this._getUniqueKtp(n,t),o=this.keytips[t];o&&(r.keytip.visible=o.keytip.visible,this.keytips[t]=r,delete this.sequenceMapping[o.keytip.keySequences.toString()],this.sequenceMapping[r.keytip.keySequences.toString()]=r.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||wr.g.raise(this,er.KEYTIP_UPDATED,{keytip:r.keytip,uniqueID:r.uniqueID}))},e.prototype.unregister=function(e,t,n){void 0===n&&(n=!1),n?delete this.persistedKeytips[t]:delete this.keytips[t],!n&&delete this.sequenceMapping[e.keySequences.toString()];var r=n?er.PERSISTED_KEYTIP_REMOVED:er.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||wr.g.raise(this,r,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){wr.g.raise(this,er.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){wr.g.raise(this,er.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=(0,F.__spreadArray)([],e.keySequences,!0);if(t.pop(),0!==t.length){var n=this.sequenceMapping[t.toString()];if(n&&n.overflowSetSequence)return(0,F.__assign)((0,F.__assign)({},e),{overflowSetSequence:n.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){wr.g.raise(this,er.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=(0,Cr.O)()),{keytip:(0,F.__assign)({},e),uniqueID:t}},e._instance=new e,e}(),xr=n(69341);function kr(e){return e.reduce((function(e,t){return e+Tr+t.split("").join(Tr)}),Er)}function Ar(e){var t=a.useRef(),n=e.keytipProps?(0,F.__assign)({disabled:e.disabled},e.keytipProps):void 0,r=(0,Qt.d)(Pr.getInstance()),o=(0,_r.Z)(e);(0,An.E)((function(){t.current&&n&&((null==o?void 0:o.keytipProps)!==e.keytipProps||(null==o?void 0:o.disabled)!==e.disabled)&&r.update(n,t.current)})),(0,An.E)((function(){return n&&(t.current=r.register(n)),function(){n&&r.unregister(n,t.current)}}),[]);var i={ariaDescribedBy:void 0,keytipId:void 0};return n&&(i=function(e,t,n){var r=e.addParentOverflow(t),o=(0,Sr._)(n,function(e){var t=" "+Ir;return e.length?t+" "+kr(e):t}(r.keySequences)),i=(0,F.__spreadArray)([],r.keySequences,!0);r.overflowSetSequence&&(i=function(e,t){var n=t.length,r=(0,F.__spreadArray)([],t,!0).pop(),o=(0,F.__spreadArray)([],e,!0);return(0,xr.Ty)(o,n-1,r)}(i,r.overflowSetSequence));var a=kr(i);return{ariaDescribedBy:o,keytipId:a}}(r,n,e.ariaDescribedBy)),i}var Lr=function(e){var t,n=e.children,r=Ar((0,F.__rest)(e,["children"])),o=r.keytipId,i=r.ariaDescribedBy;return n(((t={})["data-ktp-target"]=o,t["data-ktp-execute-target"]=o,t["aria-describedby"]=i,t))},Dr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._anchor=a.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,Oe.J9)((function(e){return(0,F.__assign)((0,F.__assign)({},e),{hasMenu:!0})})),t._getSubmenuTarget=function(){return t._anchor.current?t._anchor.current:void 0},t._onItemClick=function(e){var n=t.props,r=n.item,o=n.onItemClick;o&&o(r,e)},t._renderAriaDescription=function(e,n){return e?a.createElement("span",{id:t._ariaDescriptionId,className:n},e):null},t}return(0,F.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.item,r=t.classNames,o=t.index,i=t.focusableElementIndex,s=t.totalItemCount,l=t.hasCheckmarks,c=t.hasIcons,u=t.expandedMenuItemKey,d=t.onItemClick,p=t.openSubMenu,g=t.dismissSubMenu,m=t.dismissMenu,f=yr;this.props.item.contextualMenuItemAs&&(f=(0,ze.C)(this.props.item.contextualMenuItemAs,f)),this.props.contextualMenuItemAs&&(f=(0,ze.C)(this.props.contextualMenuItemAs,f));var h=n.rel;n.target&&"_blank"===n.target.toLowerCase()&&(h=h||"nofollow noopener noreferrer");var v=Qe(n),y=(0,qe.G1)(n,qe.t0),C=Je(n),S=n.itemProps,b=n.ariaDescription,E=n.keytipProps;E&&v&&(E=this._getMemoizedMenuButtonKeytipProps(E)),b&&(this._ariaDescriptionId=(0,Cr.O)());var T=(0,Sr._)(n.ariaDescribedBy,b?this._ariaDescriptionId:void 0,y["aria-describedby"]),I={"aria-describedby":T};return a.createElement("div",null,a.createElement(Lr,{keytipProps:n.keytipProps,ariaDescribedBy:T,disabled:C},(function(t){return a.createElement("a",(0,F.__assign)({},I,y,t,{ref:e._anchor,href:n.href,target:n.target,rel:h,className:r.root,role:"menuitem","aria-haspopup":v||void 0,"aria-expanded":v?n.key===u:void 0,"aria-posinset":i+1,"aria-setsize":s,"aria-disabled":Je(n),style:n.style,onClick:e._onItemClick,onMouseEnter:e._onItemMouseEnter,onMouseLeave:e._onItemMouseLeave,onMouseMove:e._onItemMouseMove,onKeyDown:v?e._onItemKeyDown:void 0}),a.createElement(f,(0,F.__assign)({componentRef:n.componentRef,item:n,classNames:r,index:o,onCheckmarkClick:l&&d?d:void 0,hasIcons:c,openSubMenu:p,dismissSubMenu:g,dismissMenu:m,getSubmenuTarget:e._getSubmenuTarget},S)),e._renderAriaDescription(b,r.screenReaderText))})))},t}(br),Or=n(39256),Nr=(0,De.Z)(),Rr=a.forwardRef((function(e,t){var n=e.styles,r=e.theme,o=e.getClassNames,i=e.className,s=Nr(n,{theme:r,getClassNames:o,className:i});return a.createElement("span",{className:s.wrapper,ref:t},a.createElement("span",{className:s.divider}))}));Rr.displayName="VerticalDividerBase";var Fr=(0,Pe.I)(Rr,(function(e){var t=e.theme,n=e.getClassNames,r=e.className;if(!t)throw new Error("Theme is undefined or null.");if(n){var o=n(t);return{wrapper:[o.wrapper],divider:[o.divider]}}return{wrapper:[{display:"inline-flex",height:"100%",alignItems:"center"},r],divider:[{width:1,height:"100%",backgroundColor:t.palette.neutralTertiaryAlt}]}}),void 0,{scope:"VerticalDivider"}),Mr=function(e){function t(t){var n=e.call(this,t)||this;return n._getMemoizedMenuButtonKeytipProps=(0,Oe.J9)((function(e){return(0,F.__assign)((0,F.__assign)({},e),{hasMenu:!0})})),n._onItemKeyDown=function(e){var t=n.props,r=t.item,o=t.onItemKeyDown;e.which===Me.c.enter?(n._executeItemClick(e),e.preventDefault(),e.stopPropagation()):o&&o(r,e)},n._getSubmenuTarget=function(){return n._splitButton},n._renderAriaDescription=function(e,t){return e?a.createElement("span",{id:n._ariaDescriptionId,className:t},e):null},n._onItemMouseEnterPrimary=function(e){var t=n.props,r=t.item,o=t.onItemMouseEnter;o&&o((0,F.__assign)((0,F.__assign)({},r),{subMenuProps:void 0,items:void 0}),e,n._splitButton)},n._onItemMouseEnterIcon=function(e){var t=n.props,r=t.item,o=t.onItemMouseEnter;o&&o(r,e,n._splitButton)},n._onItemMouseMovePrimary=function(e){var t=n.props,r=t.item,o=t.onItemMouseMove;o&&o((0,F.__assign)((0,F.__assign)({},r),{subMenuProps:void 0,items:void 0}),e,n._splitButton)},n._onItemMouseMoveIcon=function(e){var t=n.props,r=t.item,o=t.onItemMouseMove;o&&o(r,e,n._splitButton)},n._onIconItemClick=function(e){var t=n.props,r=t.item,o=t.onItemClickBase;o&&o(r,e,n._splitButton?n._splitButton:e.currentTarget)},n._executeItemClick=function(e){var t=n.props,r=t.item,o=t.executeItemClick,i=t.onItemClick;if(!r.disabled&&!r.isDisabled)return n._processingTouch&&!r.canCheck&&i?i(r,e):void(o&&o(r,e))},n._onTouchStart=function(e){n._splitButton&&!("onpointerdown"in n._splitButton)&&n._handleTouchAndPointerEvent(e)},n._onPointerDown=function(e){"touch"===e.pointerType&&(n._handleTouchAndPointerEvent(e),e.preventDefault(),e.stopImmediatePropagation())},n._async=new Or.j(n),n._events=new wr.g(n),n._dismissLabelId=(0,Cr.O)(),n}return(0,F.__extends)(t,e),t.prototype.componentDidMount=function(){this._splitButton&&"onpointerdown"in this._splitButton&&this._events.on(this._splitButton,"pointerdown",this._onPointerDown,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e,t=this,n=this.props,r=n.item,o=n.classNames,i=n.index,s=n.focusableElementIndex,l=n.totalItemCount,c=n.hasCheckmarks,u=n.hasIcons,d=n.onItemMouseLeave,p=n.expandedMenuItemKey,g=Qe(r),m=r.keytipProps;m&&(m=this._getMemoizedMenuButtonKeytipProps(m));var f=r.ariaDescription;f&&(this._ariaDescriptionId=(0,Cr.O)());var h=null!==(e=Ve(r))&&void 0!==e?e:void 0;return a.createElement(Lr,{keytipProps:m,disabled:Je(r)},(function(e){return a.createElement("div",{"data-ktp-target":e["data-ktp-target"],ref:function(e){return t._splitButton=e},role:Ke(r),"aria-label":r.ariaLabel,className:o.splitContainer,"aria-disabled":Je(r),"aria-expanded":g?r.key===p:void 0,"aria-haspopup":!0,"aria-describedby":(0,Sr._)(r.ariaDescribedBy,f?t._ariaDescriptionId:void 0,e["aria-describedby"]),"aria-checked":h,"aria-posinset":s+1,"aria-setsize":l,onMouseEnter:t._onItemMouseEnterPrimary,onMouseLeave:d?d.bind(t,(0,F.__assign)((0,F.__assign)({},r),{subMenuProps:null,items:null})):void 0,onMouseMove:t._onItemMouseMovePrimary,onKeyDown:t._onItemKeyDown,onClick:t._executeItemClick,onTouchStart:t._onTouchStart,tabIndex:0,"data-is-focusable":!0,"aria-roledescription":r["aria-roledescription"]},t._renderSplitPrimaryButton(r,o,i,c,u),t._renderSplitDivider(r),t._renderSplitIconButton(r,o,i,e),t._renderAriaDescription(f,o.screenReaderText))}))},t.prototype._renderSplitPrimaryButton=function(e,t,n,r,o){var i=this.props,s=i.contextualMenuItemAs,l=void 0===s?yr:s,c=i.onItemClick,u={key:e.key,disabled:Je(e)||e.primaryDisabled,name:e.name,text:e.text||e.name,secondaryText:e.secondaryText,className:t.splitPrimary,canCheck:e.canCheck,isChecked:e.isChecked,checked:e.checked,iconProps:e.iconProps,id:this._dismissLabelId,onClick:e.onClick,onRenderIcon:e.onRenderIcon,data:e.data,"data-is-focusable":!1},d=e.itemProps;return a.createElement("button",(0,F.__assign)({},(0,qe.G1)(u,qe.uw)),a.createElement(l,(0,F.__assign)({"data-is-focusable":!1,item:u,classNames:t,index:n,onCheckmarkClick:r&&c?c:void 0,hasIcons:o},d)))},t.prototype._renderSplitDivider=function(e){var t=e.getSplitButtonVerticalDividerClassNames||mr;return a.createElement(Fr,{getClassNames:t})},t.prototype._renderSplitIconButton=function(e,t,n,r){var o=this.props,i=o.onItemMouseLeave,s=o.onItemMouseDown,l=o.openSubMenu,c=o.dismissSubMenu,u=o.dismissMenu,d=yr;this.props.item.contextualMenuItemAs&&(d=(0,ze.C)(this.props.item.contextualMenuItemAs,d)),this.props.contextualMenuItemAs&&(d=(0,ze.C)(this.props.contextualMenuItemAs,d));var p={onClick:this._onIconItemClick,disabled:Je(e),className:t.splitMenu,subMenuProps:e.subMenuProps,submenuIconProps:e.submenuIconProps,split:!0,key:e.key,"aria-labelledby":this._dismissLabelId},g=(0,F.__assign)((0,F.__assign)({},(0,qe.G1)(p,qe.uw)),{onMouseEnter:this._onItemMouseEnterIcon,onMouseLeave:i?i.bind(this,e):void 0,onMouseDown:function(t){return s?s(e,t):void 0},onMouseMove:this._onItemMouseMoveIcon,"data-is-focusable":!1,"data-ktp-execute-target":r["data-ktp-execute-target"],"aria-haspopup":!0}),m=e.itemProps;return a.createElement("button",(0,F.__assign)({},g),a.createElement(d,(0,F.__assign)({componentRef:e.componentRef,item:p,classNames:t,index:n,hasIcons:!1,openSubMenu:l,dismissSubMenu:c,dismissMenu:u,getSubmenuTarget:this._getSubmenuTarget},m)))},t.prototype._handleTouchAndPointerEvent=function(e){var t=this,n=this.props.onTap;n&&n(e),this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){t._processingTouch=!1,t._lastTouchTimeoutId=void 0}),500)},t}(br),Br=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._btn=a.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,Oe.J9)((function(e){return(0,F.__assign)((0,F.__assign)({},e),{hasMenu:!0})})),t._renderAriaDescription=function(e,n){return e?a.createElement("span",{id:t._ariaDescriptionId,className:n},e):null},t._getSubmenuTarget=function(){return t._btn.current?t._btn.current:void 0},t}return(0,F.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.item,r=t.classNames,o=t.index,i=t.focusableElementIndex,s=t.totalItemCount,l=t.hasCheckmarks,c=t.hasIcons,u=t.contextualMenuItemAs,d=t.expandedMenuItemKey,p=t.onItemMouseDown,g=t.onItemClick,m=t.openSubMenu,f=t.dismissSubMenu,h=t.dismissMenu,v=yr;n.contextualMenuItemAs&&(v=(0,ze.C)(n.contextualMenuItemAs,v)),u&&(v=(0,ze.C)(u,v));var y=Ve(n),C=null!==y,S=Ke(n),b=Qe(n),E=n.itemProps,T=n.ariaLabel,I=n.ariaDescription,_=(0,qe.G1)(n,qe.uw);delete _.disabled;var w=n.role||S;I&&(this._ariaDescriptionId=(0,Cr.O)());var P=(0,Sr._)(n.ariaDescribedBy,I?this._ariaDescriptionId:void 0,_["aria-describedby"]),x={className:r.root,onClick:this._onItemClick,onKeyDown:b?this._onItemKeyDown:void 0,onMouseEnter:this._onItemMouseEnter,onMouseLeave:this._onItemMouseLeave,onMouseDown:function(e){return p?p(n,e):void 0},onMouseMove:this._onItemMouseMove,href:n.href,title:n.title,"aria-label":T,"aria-describedby":P,"aria-haspopup":b||void 0,"aria-expanded":b?n.key===d:void 0,"aria-posinset":i+1,"aria-setsize":s,"aria-disabled":Je(n),"aria-checked":"menuitemcheckbox"!==w&&"menuitemradio"!==w||!C?void 0:!!y,"aria-selected":"menuitem"===w&&C?!!y:void 0,role:w,style:n.style},k=n.keytipProps;return k&&b&&(k=this._getMemoizedMenuButtonKeytipProps(k)),a.createElement(Lr,{keytipProps:k,ariaDescribedBy:P,disabled:Je(n)},(function(t){return a.createElement("button",(0,F.__assign)({ref:e._btn},_,x,t),a.createElement(v,(0,F.__assign)({componentRef:n.componentRef,item:n,classNames:r,index:o,onCheckmarkClick:l&&g?g:void 0,hasIcons:c,openSubMenu:m,dismissSubMenu:f,dismissMenu:h,getSubmenuTarget:e._getSubmenuTarget},E)),e._renderAriaDescription(I,r.screenReaderText))}))},t}(br),Ur=n(40209),Hr=n(84229),Gr=["setState","render","componentWillMount","UNSAFE_componentWillMount","componentDidMount","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","getSnapshotBeforeUpdate","UNSAFE_componentWillUpdate","componentDidUpdate","componentWillUnmount"];var zr,qr=function(e){function t(t){var n=e.call(this,t)||this;return n._updateComposedComponentRef=n._updateComposedComponentRef.bind(n),n}return(0,F.__extends)(t,e),t.prototype._updateComposedComponentRef=function(e){var t;this._composedComponentInstance=e,e?this._hoisted=function(e,t,n){void 0===n&&(n=Gr);var r=[],o=function(o){"function"!=typeof t[o]||void 0!==e[o]||n&&-1!==n.indexOf(o)||(r.push(o),e[o]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t[o].apply(t,e)})};for(var i in t)o(i);return r}(this,e):this._hoisted&&(t=this,this._hoisted.forEach((function(e){return delete t[e]})))},t}(a.Component),Wr=n(61252);!function(e){e[e.small=0]="small",e[e.medium=1]="medium",e[e.large=2]="large",e[e.xLarge=3]="xLarge",e[e.xxLarge=4]="xxLarge",e[e.xxxLarge=5]="xxxLarge",e[e.unknown=999]="unknown"}(zr||(zr={}));var jr,Vr,Qr=[479,639,1023,1365,1919,99999999];function Jr(){var e;return null!==(e=null!=jr?jr:Vr)&&void 0!==e?e:zr.large}function Kr(e){var t,n=((t=function(t){function n(e){var n=t.call(this,e)||this;return n._onResize=function(){var e=Zr(n.context.window);e!==n.state.responsiveMode&&n.setState({responsiveMode:e})},n._events=new wr.g(n),n._updateComposedComponentRef=n._updateComposedComponentRef.bind(n),n.state={responsiveMode:Jr()},n}return(0,F.__extends)(n,t),n.prototype.componentDidMount=function(){this._events.on(this.context.window,"resize",this._onResize),this._onResize()},n.prototype.componentWillUnmount=function(){this._events.dispose()},n.prototype.render=function(){var t=this.state.responsiveMode;return t===zr.unknown?null:a.createElement(e,(0,F.__assign)({ref:this._updateComposedComponentRef,responsiveMode:t},this.props))},n}(qr)).contextType=qt._0,t);return(0,Wr.D)(e,n)}function Xr(e){try{return e.document.documentElement.clientWidth}catch(t){return e.innerWidth}}function Zr(e){var t=zr.small;if(e){try{for(;Xr(e)>Qr[t];)t++}catch(e){t=Jr()}Vr=t}else{if(void 0===jr)throw new Error("Content was rendered in a server environment without providing a default responsive mode. Call setResponsiveMode to define what the responsive mode is.");t=jr}return t}var Yr=function(e,t){var n=a.useState(Jr()),r=n[0],o=n[1],i=a.useCallback((function(){var t=Zr((0,A.z)(e.current));r!==t&&o(t)}),[e,r]),s=(0,qt.ox)();return(0,Gt.x)(s,"resize",i),a.useEffect((function(){void 0===t&&i()}),[t]),null!=t?t:r},$r=a.createContext({}),eo=(0,De.Z)(),to=(0,De.Z)(),no={items:[],shouldFocusOnMount:!0,gapSpace:0,directionalHint:ke.bottomAutoEdge,beakWidth:16};function ro(e){for(var t=0,n=0,r=e;n<r.length;n++){var o=r[n];if(o.itemType!==we.Divider&&o.itemType!==we.Header)t+=o.customOnRenderListLength?o.customOnRenderListLength:1}return t}function oo(e,t){var n=null==t?void 0:t.target,r=e.subMenuProps?e.subMenuProps.items:e.items;if(r){for(var o=[],i=0,a=r;i<a.length;i++){var s=a[i];if(s.preferMenuTargetAsEventTarget){var l=s.onClick,c=(0,F.__rest)(s,["onClick"]);o.push((0,F.__assign)((0,F.__assign)({},c),{onClick:fo(l,n)}))}else o.push(s)}return o}}var io="ContextualMenu",ao=(0,Oe.J9)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return c.pB.apply(void 0,(0,F.__spreadArray)([t,vr],e,!1))}}));function so(e,t){var n=e.hidden,r=e.items,o=e.theme,i=e.className,s=e.id,l=e.target,c=a.useState(),u=c[0],d=c[1],p=a.useState(),g=p[0],m=p[1],f=a.useState(),h=f[0],v=f[1],y=(0,Ur.B)(io,s),C=a.useCallback((function(){v(void 0),d(void 0),m(void 0)}),[]),S=a.useCallback((function(e,t,n){var r=e.key;u!==r&&(t.focus(),v(n),d(r),m(t))}),[u]);a.useEffect((function(){n&&C()}),[n,C]);var b=function(e,t){var n=a.useRef(!1);a.useEffect((function(){return n.current=!0,function(){n.current=!1}}),[]);var r=function(r,o){o?e(r,o):n.current&&t()};return r}(t,C);return[u,S,function(){var e=mo(u,r),t=null;if(e&&(t={items:oo(e,{target:l}),target:g,onDismiss:b,isSubMenu:!0,id:y,shouldFocusOnMount:!0,shouldFocusOnContainer:h,directionalHint:(0,Ne.jI)(o)?ke.leftTopEdge:ke.rightTopEdge,className:i,gapSpace:0,isBeakVisible:!1},e.subMenuProps&&(0,Re.kp)(t,e.subMenuProps),e.preferMenuTargetAsEventTarget)){var n=e.onItemClick;t.onItemClick=fo(n,l)}return t},b]}function lo(e,t,n,r){var o=e.theme,i=e.isSubMenu,s=e.focusZoneProps,l=void 0===s?{}:s,c=l.checkForNoWrap,u=l.direction,d=void 0===u?Ae.E.vertical:u,p=a.useRef(),g=function(e,n,r){var o=!1;return n(e)&&(t(e,r),e.preventDefault(),e.stopPropagation(),o=!0),o},m=function(e){return e.which===Me.c.escape||function(e){var t=(0,Ne.jI)(o)?Me.c.right:Me.c.left;return!(e.which!==t||!i||d!==Ae.E.vertical&&(!c||(0,Be._l)(e.target,"data-no-horizontal-wrap")))}(e)||e.which===Me.c.up&&(e.altKey||e.metaKey)},f=function(e){p.current=uo(e);var t=e.which===Me.c.escape&&((0,Ue.c)()||(0,He.u)());return g(e,m,t)},h=function(e){var t=p.current&&uo(e);return p.current=!1,!!t&&!((0,He.u)()||(0,Ue.c)())};return[f,function(e){return g(e,h,!0)},function(e){if(!f(e)&&n.current){var t=!(!e.altKey&&!e.metaKey),r=e.which===Me.c.up,o=e.which===Me.c.down;if(!t&&(r||o)){var i=r?(0,Be.dm)(n.current,n.current.lastChild,!0):(0,Be.j5)(n.current,n.current.firstChild,!0);i&&(i.focus(),e.preventDefault(),e.stopPropagation())}}},function(e,t){var n=(0,Ne.jI)(o)?Me.c.left:Me.c.right;e.disabled||t.which!==n&&t.which!==Me.c.enter&&(t.which!==Me.c.down||!t.altKey&&!t.metaKey)||(r(e,t.currentTarget),t.preventDefault())}]}var co=a.memo(a.forwardRef((function(e,t){var n,r=(0,Ge.N)(no,e),o=(r.ref,(0,F.__rest)(r,["ref"])),i=a.useRef(null),s=(0,Ht.Y)(),l=(0,Ur.B)(io,o.id);(0,Hr.j)({name:io,props:o,deprecations:{getMenuClassNames:"styles"}});var c=function(e,t){var n;return null===(n=o.onDismiss)||void 0===n?void 0:n.call(o,e,t)},u=(0,Jt.P)(o.target,i),d=u[0],p=u[1],g=function(e,t,n){var r=e.hidden,o=e.onRestoreFocus,i=a.useRef(),s=a.useCallback((function(e){var t,n;o?o(e):(null==e?void 0:e.documentContainsFocus)&&(null===(n=null===(t=i.current)||void 0===t?void 0:t.focus)||void 0===n||n.call(t))}),[o]);return(0,An.E)((function(){var e,o;if(r)i.current&&(s({originalElement:i.current,containsFocus:!0,documentContainsFocus:(null===(o=(0,Fe.Y)())||void 0===o?void 0:o.hasFocus())||!1}),i.current=void 0);else{var a=null==t?void 0:t.document.activeElement;(null===(e=n.current)||void 0===e?void 0:e.contains(a))||"BODY"===a.tagName||(i.current=a)}}),[r,null==t?void 0:t.document.activeElement,s,n]),[s]}(o,p,i)[0],m=so(o,c),f=m[0],h=m[1],v=m[2],y=m[3],C=function(e){var t=e.delayUpdateFocusOnHover,n=e.hidden,r=a.useRef(!t),o=a.useRef(!1);a.useEffect((function(){r.current=!t,o.current=!n&&!t&&o.current}),[t,n]);var i=a.useCallback((function(){t&&(r.current=!1)}),[t]);return[r,o,i]}(o),S=C[0],b=C[1],E=C[2],T=function(e){var t=a.useRef(!0),n=a.useRef();return[function(){t.current||void 0===n.current?t.current=!1:(e.clearTimeout(n.current),n.current=void 0),n.current=e.setTimeout((function(){t.current=!0}),250)},t]}(s),I=T[0],_=T[1],w=function(e,t){var n=e.subMenuHoverDelay,r=void 0===n?250:n,o=a.useRef(void 0),i=function(){void 0!==o.current&&(t.clearTimeout(o.current),o.current=void 0)};return[i,function(e){o.current=t.setTimeout((function(){e(),i()}),r)},o]}(o,s),P=w[0],x=w[1],k=w[2],A=Yr(i,o.responsiveMode);!function(e){var t=e.hidden,n=void 0!==t&&t,r=e.onMenuDismissed,o=e.onMenuOpened,i=(0,_r.Z)(n),s=a.useRef(o),l=a.useRef(r),c=a.useRef(e);s.current=o,l.current=r,c.current=e,a.useEffect((function(){var e,t;n&&!1===i?null===(e=l.current)||void 0===e||e.call(l,c.current):n||!1===i||null===(t=s.current)||void 0===t||t.call(s,c.current)}),[n,i]),a.useEffect((function(){return function(){var e;return null===(e=l.current)||void 0===e?void 0:e.call(l,c.current)}}),[])}(o);var L=lo(o,c,i,h),D=L[0],O=L[1],N=L[2],R=L[3],M=function(e,t,n,r,o,i,a,s,l,c,u,d,p){var g=e.target,m=function(){return!t.current||!i.current},f=function(e,t,n){var r=n||t.currentTarget;e.key!==a&&(c(),void 0===a&&r.focus(),Qe(e)?(t.stopPropagation(),l((function(){r.focus(),u(e,r,!0)}))):l((function(){d(t),r.focus()})))},h=function(t,n,r){var o=oo(t,{target:g});if(c(),Qe(t)||o&&o.length){if(t.key!==a){var i="boolean"==typeof e.shouldFocusOnContainer?e.shouldFocusOnContainer:"mouse"===n.nativeEvent.pointerType;u(t,r,i)}}else v(t,n);n.stopPropagation(),n.preventDefault()},v=function(t,n){if(!t.disabled&&!t.isDisabled){t.preferMenuTargetAsEventTarget&&ho(n,g);var r=!1;t.onClick?r=!!t.onClick(n,t):e.onItemClick&&(r=!!e.onItemClick(n,t)),!r&&n.defaultPrevented||p(n,!0)}};return[function(e,t,n){o.current&&(i.current=!0),m()||f(e,t,n)},function(e,a,s){var l=a.currentTarget;o.current&&(i.current=!0,t.current&&void 0===n.current&&l!==(null==r?void 0:r.document.activeElement)&&f(e,a,s))},function(e,t){var n;if(!m()&&(c(),void 0===a))if(s.current.setActive)try{s.current.setActive()}catch(e){}else null===(n=s.current)||void 0===n||n.focus()},function(e,t){h(e,t,t.currentTarget)},function(e,t){v(e,t),t.stopPropagation()},v,h]}(o,_,k,p,S,b,f,i,x,P,h,y,c),B=M[0],U=M[1],H=M[2],G=M[3],z=M[4],q=M[5],W=M[6],j=function(e,t,n){var r=0,o=e.items,i=e.totalItemCount,s=e.hasCheckmarks,l=e.hasIcons;return a.createElement("ul",{className:t.list,onKeyDown:D,onKeyUp:O,role:"presentation"},o.map((function(e,n){var o=V(e,n,r,i,s,l,t);if(e.itemType!==we.Divider&&e.itemType!==we.Header){var a=e.customOnRenderListLength?e.customOnRenderListLength:1;r+=a}return o})))},V=function(e,t,n,r,i,s,l){var c,u,d=[],p=e.iconProps||{iconName:"None"},g=e.getItemClassNames,m=e.itemProps,h=m?m.styles:void 0,v=e.itemType===we.Divider?e.className:void 0,y=e.submenuIconProps?e.submenuIconProps.className:"";if(g)u=g(o.theme,Je(e),f===e.key,!!Ve(e),!!e.href,"None"!==p.iconName,e.className,v,p.className,y,e.primaryDisabled);else{var C={theme:o.theme,disabled:Je(e),expanded:f===e.key,checked:!!Ve(e),isAnchorLink:!!e.href,knownIcon:"None"!==p.iconName,itemClassName:e.className,dividerClassName:v,iconClassName:p.className,subMenuClassName:y,primaryDisabled:e.primaryDisabled};u=to(ao(null===(c=l.subComponentStyles)||void 0===c?void 0:c.menuItem,h),C)}switch("-"!==e.text&&"-"!==e.name||(e.itemType=we.Divider),e.itemType){case we.Divider:d.push(K(t,u));break;case we.Header:d.push(K(t,u));var S=Z(e,u,l,t,i,s);d.push(J(S,e.key||t,u,e.title));break;case we.Section:d.push(Q(e,u,l,t,i,s));break;default:var b=function(){return X(e,u,t,n,r,i,s)},E=o.onRenderContextualMenuItem?o.onRenderContextualMenuItem(e,b):b();d.push(J(E,e.key||t,u,e.title))}return a.createElement(a.Fragment,{key:e.key},d)},Q=function(e,t,n,r,o,i){var s=e.sectionProps;if(s){var c,u;if(s.title){var d=void 0,p="";if("string"==typeof s.title){var g=l+s.title.replace(/\s/g,"");d={key:"section-".concat(s.title,"-title"),itemType:we.Header,text:s.title,id:g},p=g}else{var m=s.title.id||l+s.title.key.replace(/\s/g,"");d=(0,F.__assign)((0,F.__assign)({},s.title),{id:m}),p=m}d&&(u={role:"group","aria-labelledby":p},c=Z(d,t,n,r,o,i))}if(s.items&&s.items.length>0){var f=0;return a.createElement("li",{role:"presentation",key:s.key||e.key||"section-".concat(r)},a.createElement("div",(0,F.__assign)({},u),a.createElement("ul",{className:n.list,role:"presentation"},s.topDivider&&K(r,t,!0,!0),c&&J(c,e.key||r,t,e.title),s.items.map((function(e,t){var r=V(e,t,f,ro(s.items),o,i,n);if(e.itemType!==we.Divider&&e.itemType!==we.Header){var a=e.customOnRenderListLength?e.customOnRenderListLength:1;f+=a}return r})),s.bottomDivider&&K(r,t,!1,!0))))}}},J=function(e,t,n,r){return a.createElement("li",{role:"presentation",title:r,key:t,className:n.item},e)},K=function(e,t,n,r){return r||e>0?a.createElement("li",{role:"separator",key:"separator-"+e+(void 0===n?"":n?"-top":"-bottom"),className:t.divider,"aria-hidden":"true"}):null},X=function(e,t,n,r,i,s,l){if(e.onRender)return e.onRender((0,F.__assign)({"aria-posinset":r+1,"aria-setsize":i},e),c);var u={item:e,classNames:t,index:n,focusableElementIndex:r,totalItemCount:i,hasCheckmarks:s,hasIcons:l,contextualMenuItemAs:o.contextualMenuItemAs,onItemMouseEnter:B,onItemMouseLeave:H,onItemMouseMove:U,onItemMouseDown:po,executeItemClick:q,onItemKeyDown:R,expandedMenuItemKey:f,openSubMenu:h,dismissSubMenu:y,dismissMenu:c};if(e.href){var d=Dr;return e.contextualMenuItemWrapperAs&&(d=(0,ze.C)(e.contextualMenuItemWrapperAs,d)),a.createElement(d,(0,F.__assign)({},u,{onItemClick:z}))}if(e.split&&Qe(e)){var p=Mr;return e.contextualMenuItemWrapperAs&&(p=(0,ze.C)(e.contextualMenuItemWrapperAs,p)),a.createElement(p,(0,F.__assign)({},u,{onItemClick:G,onItemClickBase:W,onTap:P}))}var g=Br;return e.contextualMenuItemWrapperAs&&(g=(0,ze.C)(e.contextualMenuItemWrapperAs,g)),a.createElement(g,(0,F.__assign)({},u,{onItemClick:G,onItemClickBase:W}))},Z=function(e,t,n,r,i,s){var l=yr;e.contextualMenuItemAs&&(l=(0,ze.C)(e.contextualMenuItemAs,l)),o.contextualMenuItemAs&&(l=(0,ze.C)(o.contextualMenuItemAs,l));var c=e.itemProps,u=e.id,d=c&&(0,qe.G1)(c,qe.JM);return a.createElement("div",(0,F.__assign)({id:u,className:n.header},d,{style:e.style}),a.createElement(l,(0,F.__assign)({item:e,classNames:t,index:r,onCheckmarkClick:i?G:void 0,hasIcons:s},c)))},Y=o.isBeakVisible,$=o.items,ee=o.labelElementId,te=o.id,ne=o.className,re=o.beakWidth,oe=o.directionalHint,ie=o.directionalHintForRTL,ae=o.alignTargetEdge,se=o.gapSpace,le=o.coverTarget,ce=o.ariaLabel,ue=o.doNotLayer,de=o.target,pe=o.bounds,ge=o.useTargetWidth,me=o.useTargetAsMinWidth,fe=o.directionalHintFixed,he=o.shouldFocusOnMount,ve=o.shouldFocusOnContainer,ye=o.title,Ce=o.styles,Se=o.theme,be=o.calloutProps,Ee=o.onRenderSubMenu,Te=void 0===Ee?go:Ee,Ie=o.onRenderMenuList,_e=void 0===Ie?function(e,t){return j(e,ke)}:Ie,Pe=o.focusZoneProps,xe=o.getMenuClassNames,ke=xe?xe(Se,ne):eo(Ce,{theme:Se,className:ne}),De=function e(t){for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o.iconProps)return!0;if(o.itemType===we.Section&&o.sectionProps&&e(o.sectionProps.items))return!0}return!1}($);var Oe,Ne=(0,F.__assign)((0,F.__assign)({direction:Ae.E.vertical,handleTabKey:Ae.l.all,isCircularNavigation:!0,"data-tabster":'{"uncontrolled": {}, "focusable": { "excludeFromMover": true }}'},Pe),{className:(0,We.A)(ke.root,null===(n=o.focusZoneProps)||void 0===n?void 0:n.className)}),Re=function(e){return e.some((function(e){return!!e.canCheck||!(!e.sectionProps||!e.sectionProps.items.some((function(e){return!0===e.canCheck})))}))}($),Me=f&&!0!==o.hidden?v():null;Y=void 0===Y?A<=zr.medium:Y;var Be=d.current;if((ge||me)&&Be&&Be.offsetWidth){var Ue=Be.getBoundingClientRect().width-2;ge?Oe={width:Ue}:me&&(Oe={minWidth:Ue})}if($&&$.length>0){var He=ro($),Ke=ke.subComponentStyles?ke.subComponentStyles.callout:void 0;return a.createElement($r.Consumer,null,(function(e){return a.createElement(Fn,(0,F.__assign)({styles:Ke,onRestoreFocus:g},be,{target:de||e.target,isBeakVisible:Y,beakWidth:re,directionalHint:oe,directionalHintForRTL:ie,gapSpace:se,coverTarget:le,doNotLayer:ue,className:(0,We.A)("ms-ContextualMenu-Callout",be&&be.className),setInitialFocus:he,onDismiss:o.onDismiss||e.onDismiss,onScroll:I,bounds:pe,directionalHintFixed:fe,alignTargetEdge:ae,hidden:o.hidden||e.hidden,ref:t}),a.createElement("div",{style:Oe,ref:i,id:te,className:ke.container,tabIndex:ve?0:-1,onKeyDown:N,onKeyUp:O,onFocusCapture:E,"aria-label":ce,"aria-labelledby":ee,role:"menu"},ye&&a.createElement("div",{className:ke.title}," ",ye," "),$&&$.length?function(e,t){var n=o.focusZoneAs,r=void 0===n?Le.R:n;return a.createElement(r,(0,F.__assign)({},t),e)}(_e({ariaLabel:ce,items:$,totalItemCount:He,hasCheckmarks:Re,hasIcons:De,defaultMenuItemRenderer:function(e){return function(e,t){var n=e.index,r=e.focusableElementIndex,o=e.totalItemCount,i=e.hasCheckmarks,a=e.hasIcons;return V(e,n,r,o,i,a,t)}(e,ke)},labelElementId:ee},(function(e,t){return j(e,ke)})),Ne):null,Me&&Te(Me,go)),a.createElement(je.MO,null))}))}return null})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,Re.ab)(e,t)}));function uo(e){return e.which===Me.c.alt||"Meta"===e.key}function po(e,t){var n;null===(n=e.onMouseDown)||void 0===n||n.call(e,e,t)}function go(e,t){throw Error("ContextualMenuBase: onRenderSubMenu callback is null or undefined. Please ensure to set `onRenderSubMenu` property either manually or with `styled` helper.")}function mo(e,t){for(var n=0,r=t;n<r.length;n++){var o=r[n];if(o.itemType===we.Section&&o.sectionProps){var i=mo(e,o.sectionProps.items);if(i)return i}else if(o.key&&o.key===e)return o}}function fo(e,t){return e?function(n,r){return ho(n,t),e(n,r)}:e}function ho(e,t){e&&t&&(e.persist(),t instanceof Event?e.target=t.target:t instanceof Element&&(e.target=t))}co.displayName="ContextualMenuBase";var vo={root:"ms-ContextualMenu",container:"ms-ContextualMenu-container",list:"ms-ContextualMenu-list",header:"ms-ContextualMenu-header",title:"ms-ContextualMenu-title",isopen:"is-open"};function yo(e){return a.createElement(Co,(0,F.__assign)({},e))}var Co=(0,Pe.I)(co,(function(e){var t=e.className,n=e.theme,r=(0,c.Km)(vo,n),o=n.fonts,i=n.semanticColors,a=n.effects;return{root:[n.fonts.medium,r.root,r.isopen,{backgroundColor:i.menuBackground,minWidth:"180px"},t],container:[r.container,{selectors:{":focus":{outline:0}}}],list:[r.list,r.isopen,{listStyleType:"none",margin:"0",padding:"0"}],header:[r.header,o.small,{fontWeight:c.BO.semibold,color:i.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:cr,lineHeight:cr,cursor:"default",padding:"0px 6px",userSelect:"none",textAlign:"left"}],title:[r.title,{fontSize:o.mediumPlus.fontSize,paddingRight:"14px",paddingLeft:"14px",paddingBottom:"5px",paddingTop:"5px",backgroundColor:i.menuItemBackgroundPressed}],subComponentStyles:{callout:{root:{boxShadow:a.elevation8}},menuItem:{}}}}),(function(e){return{onRenderSubMenu:e.onRenderSubMenu?(0,xe.j)(e.onRenderSubMenu,yo):yo}}),{scope:"ContextualMenu"}),So=Co;So.displayName="ContextualMenu";var bo=n(1526),Eo=n(25832),To=n(10202),Io={root:"ms-StackItem"},_o={start:"flex-start",end:"flex-end"},wo=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},Po=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},xo=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?wo(e,t):n.reduce((function(e,n){return wo(e,t)+" "+wo(n,t)}))},ko={start:"flex-start",end:"flex-end"},Ao={root:"ms-Stack",inner:"ms-Stack-inner",child:"ms-Stack-child"},Lo=(0,Eo.a)((function(e){var t=e.children,n=(0,qe.G1)(e,qe.vt);if(null==t)return null;var r=(0,bo.Sk)(e,{root:"div"});return(0,bo.WL)(r.root,(0,F.__assign)({},n),t)}),{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,o=e.shrink,i=e.disableShrink,a=e.align,s=e.verticalFill,l=e.order,u=e.className,d=e.basis,p=void 0===d?"auto":d,g=(0,c.Km)(Io,t);return{root:[t.fonts.medium,g.root,{flexBasis:p,margin:n.margin,padding:n.padding,height:s?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(i||!r&&!o)&&{flexShrink:0},o&&!i&&{flexShrink:1},a&&{alignSelf:_o[a]||a},l&&{order:l},u]}}});function Do(e,t){var n=t.disableShrink,r=t.enableScopedSelectors,o=t.doNotRenderFalsyValues,i=a.Children.toArray(e);return i=a.Children.map(i,(function(e){if(!e)return o?null:e;if(!a.isValidElement(e))return e;if(e.type===a.Fragment)return e.props.children?Do(e.props.children,{disableShrink:n,enableScopedSelectors:r,doNotRenderFalsyValues:o}):null;var t,i=e,s={};(t=e)&&"object"==typeof t&&t.type&&t.type.displayName===Lo.displayName&&(s={shrink:!n});var l=i.props.className;return a.cloneElement(i,(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},s),i.props),l&&{className:l}),r&&{className:(0,We.A)(Ao.child,l)}))}))}var Oo={Item:Lo},No=(0,Eo.a)((function(e){var t=e.as,n=void 0===t?"div":t,r=e.disableShrink,o=void 0!==r&&r,i=e.doNotRenderFalsyValues,a=void 0!==i&&i,s=e.enableScopedSelectors,l=void 0!==s&&s,c=e.wrap,u=(0,F.__rest)(e,["as","disableShrink","doNotRenderFalsyValues","enableScopedSelectors","wrap"]);(0,To.A)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var d=Do(e.children,{disableShrink:o,enableScopedSelectors:l,doNotRenderFalsyValues:a}),p=(0,qe.G1)(u,qe.vt),g=(0,bo.Sk)(e,{root:n,inner:"div"});return c?(0,bo.WL)(g.root,(0,F.__assign)({},p),(0,bo.WL)(g.inner,null,d)):(0,bo.WL)(g.root,(0,F.__assign)({},p),d)}),{displayName:"Stack",styles:function(e,t,n){var r,o,i,a,s,l,u,d,p,g,m,f,h,v=e.className,y=e.disableShrink,C=e.enableScopedSelectors,S=e.grow,b=e.horizontal,E=e.horizontalAlign,T=e.reversed,I=e.verticalAlign,_=e.verticalFill,w=e.wrap,P=(0,c.Km)(Ao,t),x=n&&n.childrenGap?n.childrenGap:e.gap,k=n&&n.maxHeight?n.maxHeight:e.maxHeight,A=n&&n.maxWidth?n.maxWidth:e.maxWidth,L=n&&n.padding?n.padding:e.padding,D=function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:Po(wo(n[0],t)),columnGap:Po(wo(n[1],t))};var r=Po(wo(e,t));return{rowGap:r,columnGap:r}}(x,t),O=D.rowGap,N=D.columnGap,R="".concat(-.5*N.value).concat(N.unit),M="".concat(-.5*O.value).concat(O.unit),B={textOverflow:"ellipsis"},U="> "+(C?"."+Ao.child:"*"),H=((r={})["".concat(U,":not(.").concat(Io.root,")")]={flexShrink:0},r);return w?{root:[P.root,{flexWrap:"wrap",maxWidth:A,maxHeight:k,width:"auto",overflow:"visible",height:"100%"},E&&(o={},o[b?"justifyContent":"alignItems"]=ko[E]||E,o),I&&(i={},i[b?"alignItems":"justifyContent"]=ko[I]||I,i),v,{display:"flex"},b&&{height:_?"100%":"auto"}],inner:[P.inner,(a={display:"flex",flexWrap:"wrap",marginLeft:R,marginRight:R,marginTop:M,marginBottom:M,overflow:"visible",boxSizing:"border-box",padding:xo(L,t),width:0===N.value?"100%":"calc(100% + ".concat(N.value).concat(N.unit,")"),maxWidth:"100vw"},a[U]=(0,F.__assign)({margin:"".concat(.5*O.value).concat(O.unit," ").concat(.5*N.value).concat(N.unit)},B),a),y&&H,E&&(s={},s[b?"justifyContent":"alignItems"]=ko[E]||E,s),I&&(l={},l[b?"alignItems":"justifyContent"]=ko[I]||I,l),b&&(u={flexDirection:T?"row-reverse":"row",height:0===O.value?"100%":"calc(100% + ".concat(O.value).concat(O.unit,")")},u[U]={maxWidth:0===N.value?"100%":"calc(100% - ".concat(N.value).concat(N.unit,")")},u),!b&&(d={flexDirection:T?"column-reverse":"column",height:"calc(100% + ".concat(O.value).concat(O.unit,")")},d[U]={maxHeight:0===O.value?"100%":"calc(100% - ".concat(O.value).concat(O.unit,")")},d)]}:{root:[P.root,(p={display:"flex",flexDirection:b?T?"row-reverse":"row":T?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:_?"100%":"auto",maxWidth:A,maxHeight:k,padding:xo(L,t),boxSizing:"border-box"},p[U]=B,p),y&&H,S&&{flexGrow:!0===S?1:S},E&&(g={},g[b?"justifyContent":"alignItems"]=ko[E]||E,g),I&&(m={},m[b?"alignItems":"justifyContent"]=ko[I]||I,m),b&&N.value>0&&(f={},f["".concat(U,T?":not(:last-child)":":not(:first-child)")]={marginLeft:"".concat(N.value).concat(N.unit)},f),!b&&O.value>0&&(h={},h["".concat(U,T?":not(:last-child)":":not(:first-child)")]={marginTop:"".concat(O.value).concat(O.unit)},h),v]}},statics:Oo});var Ro=n(6269),Fo=n(92391),Mo=n(52825),Bo=n(69757),Uo=function(e){var t=e.className,n=e.imageProps,r=(0,qe.G1)(e,qe.vt,["aria-label","aria-labelledby","title","aria-describedby"]),o=n.alt||e["aria-label"],i=o||e["aria-labelledby"]||e.title||n["aria-label"]||n["aria-labelledby"]||n.title,s={"aria-labelledby":e["aria-labelledby"],"aria-describedby":e["aria-describedby"],title:e.title},l=i?{}:{"aria-hidden":!0};return a.createElement("div",(0,F.__assign)({},l,r,{className:(0,We.A)(Jn,Qn.root,Qn.image,t)}),a.createElement(Vn,(0,F.__assign)({},s,n,{alt:i?o:""})))},Ho={msButton:"ms-Button",msButtonHasMenu:"ms-Button--hasMenu",msButtonIcon:"ms-Button-icon",msButtonMenuIcon:"ms-Button-menuIcon",msButtonLabel:"ms-Button-label",msButtonDescription:"ms-Button-description",msButtonScreenReaderText:"ms-Button-screenReaderText",msButtonFlexContainer:"ms-Button-flexContainer",msButtonTextContainer:"ms-Button-textContainer"},Go=(0,Oe.J9)((function(e,t,n,r,o,i,a,s,l,u,d){var p,g,m=(0,c.Km)(Ho,e||{}),f=u&&!d;return(0,c.l8)(t.__shadowConfig__,{root:[m.msButton,t.root,r,l&&["is-checked",t.rootChecked],f&&["is-expanded",t.rootExpanded,(p={},p[":hover .".concat(m.msButtonIcon)]=t.iconExpandedHovered,p[":hover .".concat(m.msButtonMenuIcon)]=t.menuIconExpandedHovered||t.rootExpandedHovered,p[":hover"]=t.rootExpandedHovered,p)],s&&[Ho.msButtonHasMenu,t.rootHasMenu],a&&["is-disabled",t.rootDisabled],!a&&!f&&!l&&(g={":hover":t.rootHovered},g[":hover .".concat(m.msButtonLabel)]=t.labelHovered,g[":hover .".concat(m.msButtonIcon)]=t.iconHovered,g[":hover .".concat(m.msButtonDescription)]=t.descriptionHovered,g[":hover .".concat(m.msButtonMenuIcon)]=t.menuIconHovered,g[":focus"]=t.rootFocused,g[":active"]=t.rootPressed,g[":active .".concat(m.msButtonIcon)]=t.iconPressed,g[":active .".concat(m.msButtonDescription)]=t.descriptionPressed,g[":active .".concat(m.msButtonMenuIcon)]=t.menuIconPressed,g),a&&l&&[t.rootCheckedDisabled],!a&&l&&{":hover":t.rootCheckedHovered,":active":t.rootCheckedPressed},n],flexContainer:[m.msButtonFlexContainer,t.flexContainer],textContainer:[m.msButtonTextContainer,t.textContainer],icon:[m.msButtonIcon,o,t.icon,f&&t.iconExpanded,l&&t.iconChecked,a&&t.iconDisabled],label:[m.msButtonLabel,t.label,l&&t.labelChecked,a&&t.labelDisabled],menuIcon:[m.msButtonMenuIcon,i,t.menuIcon,l&&t.menuIconChecked,a&&!d&&t.menuIconDisabled,!a&&!f&&!l&&{":hover":t.menuIconHovered,":active":t.menuIconPressed},f&&["is-expanded",t.menuIconExpanded]],description:[m.msButtonDescription,t.description,l&&t.descriptionChecked,a&&t.descriptionDisabled],screenReaderText:[m.msButtonScreenReaderText,t.screenReaderText]})})),zo="ms-SplitButton-divider",qo=(0,Oe.J9)((function(e,t,n,r,o){return{root:(0,c.Zq)(e.splitButtonMenuButton,n&&[e.splitButtonMenuButtonExpanded],t&&[e.splitButtonMenuButtonDisabled],r&&!t&&[e.splitButtonMenuButtonChecked],o&&!t&&[{":focus":e.splitButtonMenuFocused}]),splitButtonContainer:(0,c.Zq)(e.splitButtonContainer,!t&&r&&[e.splitButtonContainerChecked,{":hover":e.splitButtonContainerCheckedHovered}],!t&&!r&&[{":hover":e.splitButtonContainerHovered,":focus":e.splitButtonContainerFocused}],t&&e.splitButtonContainerDisabled),icon:(0,c.Zq)(e.splitButtonMenuIcon,t&&e.splitButtonMenuIconDisabled,!t&&o&&e.splitButtonMenuIcon),flexContainer:(0,c.Zq)(e.splitButtonFlexContainer),divider:(0,c.Zq)(zo,e.splitButtonDivider,(o||t)&&e.splitButtonDividerDisabled)}})),Wo="BaseButton",jo=function(e){function t(t){var n=e.call(this,t)||this;return n._buttonElement=a.createRef(),n._splitButtonContainer=a.createRef(),n._mergedRef=(0,Ro.K)(),n._renderedVisibleMenu=!1,n._getMemoizedMenuButtonKeytipProps=(0,Oe.J9)((function(e){return(0,F.__assign)((0,F.__assign)({},e),{hasMenu:!0})})),n._onRenderIcon=function(e,t){var r=n.props.iconProps;if(r&&(void 0!==r.iconName||r.imageProps)){var o=r.className,i=r.imageProps,s=(0,F.__rest)(r,["className","imageProps"]);if(r.styles)return a.createElement($n,(0,F.__assign)({className:(0,We.A)(n._classNames.icon,o),imageProps:i},s));if(r.iconName)return a.createElement(Xn,(0,F.__assign)({className:(0,We.A)(n._classNames.icon,o)},s));if(i)return a.createElement(Uo,(0,F.__assign)({className:(0,We.A)(n._classNames.icon,o),imageProps:i},s))}return null},n._onRenderTextContents=function(){var e,t,r,o,i=(e=n.props).text,s=e.children,l=void 0===(t=e.secondaryText)?n.props.description:t,c=void 0===(r=e.onRenderText)?n._onRenderText:r,u=void 0===(o=e.onRenderDescription)?n._onRenderDescription:o;return i||"string"==typeof s||l?a.createElement("span",{className:n._classNames.textContainer},c(n.props,n._onRenderText),u(n.props,n._onRenderDescription)):[c(n.props,n._onRenderText),u(n.props,n._onRenderDescription)]},n._onRenderText=function(){var e=n.props.text,t=n.props.children;return void 0===e&&"string"==typeof t&&(e=t),n._hasText()?a.createElement("span",{key:n._labelId,className:n._classNames.label,id:n._labelId},e):null},n._onRenderChildren=function(){var e=n.props.children;return"string"==typeof e?null:e},n._onRenderDescription=function(e){var t,r=void 0===(t=e.secondaryText)?n.props.description:t;return r?a.createElement("span",{key:n._descriptionId,className:n._classNames.description,id:n._descriptionId},r):null},n._onRenderAriaDescription=function(){var e=n.props.ariaDescription;return e?a.createElement("span",{className:n._classNames.screenReaderText,id:n._ariaDescriptionId},e):null},n._onRenderMenuIcon=function(e){var t=n.props.menuIconProps;return a.createElement(Xn,(0,F.__assign)({iconName:"ChevronDown"},t,{className:n._classNames.menuIcon}))},n._onRenderMenu=function(e){var t=n.props.menuAs?(0,ze.C)(n.props.menuAs,So):So;return a.createElement(t,(0,F.__assign)({},e))},n._onDismissMenu=function(e){var t=n.props.menuProps;t&&t.onDismiss&&t.onDismiss(e),e&&e.defaultPrevented||n._dismissMenu()},n._dismissMenu=function(){n._menuShouldFocusOnMount=void 0,n._menuShouldFocusOnContainer=void 0,n.setState({menuHidden:!0})},n._openMenu=function(e,t){void 0===t&&(t=!0),n.props.menuProps&&(n._menuShouldFocusOnContainer=e,n._menuShouldFocusOnMount=t,n._renderedVisibleMenu=!0,n.setState({menuHidden:!1}))},n._onToggleMenu=function(e){var t=!0;n.props.menuProps&&!1===n.props.menuProps.shouldFocusOnMount&&(t=!1),n.state.menuHidden?n._openMenu(e,t):n._dismissMenu()},n._onSplitContainerFocusCapture=function(e){var t=n._splitButtonContainer.current;!t||e.target&&(0,Fo.s)(e.target,t)||t.focus()},n._onSplitButtonPrimaryClick=function(e){n.state.menuHidden||n._dismissMenu();var t=n._processingTouch&&!n.props.toggle;!t&&n.props.onClick?n.props.onClick(e):t&&n._onMenuClick(e)},n._onKeyDown=function(e){!n.props.disabled||e.which!==Me.c.enter&&e.which!==Me.c.space?n.props.disabled||(n.props.menuProps?n._onMenuKeyDown(e):void 0!==n.props.onKeyDown&&n.props.onKeyDown(e)):(e.preventDefault(),e.stopPropagation())},n._onKeyUp=function(e){n.props.disabled||void 0===n.props.onKeyUp||n.props.onKeyUp(e)},n._onKeyPress=function(e){n.props.disabled||void 0===n.props.onKeyPress||n.props.onKeyPress(e)},n._onMouseUp=function(e){n.props.disabled||void 0===n.props.onMouseUp||n.props.onMouseUp(e)},n._onMouseDown=function(e){n.props.disabled||void 0===n.props.onMouseDown||n.props.onMouseDown(e)},n._onClick=function(e){n.props.disabled||(n.props.menuProps?n._onMenuClick(e):void 0!==n.props.onClick&&n.props.onClick(e))},n._onSplitButtonContainerKeyDown=function(e){e.which===Me.c.enter||e.which===Me.c.space?n._buttonElement.current&&(n._buttonElement.current.click(),e.preventDefault(),e.stopPropagation()):n._onMenuKeyDown(e)},n._onMenuKeyDown=function(e){var t;if(!n.props.disabled){n.props.onKeyDown&&n.props.onKeyDown(e);var r=e.which===Me.c.up,o=e.which===Me.c.down;if(!e.defaultPrevented&&n._isValidMenuOpenKey(e)){var i=n.props.onMenuClick;i&&i(e,n.props),n._onToggleMenu(!1),e.preventDefault(),e.stopPropagation()}if(e.which!==Me.c.enter&&e.which!==Me.c.space||(0,En.Fy)(!0,e.target,null===(t=n.context)||void 0===t?void 0:t.registeredProviders),!e.altKey&&!e.metaKey&&(r||o))if(!n.state.menuHidden&&n.props.menuProps)(void 0!==n._menuShouldFocusOnMount?n._menuShouldFocusOnMount:n.props.menuProps.shouldFocusOnMount)||(e.preventDefault(),e.stopPropagation(),n._menuShouldFocusOnMount=!0,n.forceUpdate())}},n._onTouchStart=function(){n._isSplitButton&&n._splitButtonContainer.current&&!("onpointerdown"in n._splitButtonContainer.current)&&n._handleTouchAndPointerEvent()},n._onMenuClick=function(e){var t,r=(t=n.props).onMenuClick,o=t.menuProps;r&&r(e,n.props);var i="boolean"==typeof(null==o?void 0:o.shouldFocusOnContainer)?o.shouldFocusOnContainer:"mouse"===e.nativeEvent.pointerType;e.defaultPrevented||(n._onToggleMenu(i),e.preventDefault(),e.stopPropagation())},(0,Gn.f)(n),n._async=new Or.j(n),n._events=new wr.g(n),(0,Mo.J)(Wo,t,["menuProps","onClick"],"split",n.props.split),(0,To.A)(Wo,t,{rootProps:void 0,description:"secondaryText",toggled:"checked"}),n._labelId=(0,Cr.O)(),n._descriptionId=(0,Cr.O)(),n._ariaDescriptionId=(0,Cr.O)(),n.state={menuHidden:!0},n}return(0,F.__extends)(t,e),Object.defineProperty(t.prototype,"_isSplitButton",{get:function(){return!!this.props.menuProps&&!!this.props.onClick&&!0===this.props.split},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t,n,r,o,i=(e=this.props).ariaDescription,a=e.ariaLabel,s=e.ariaHidden,l=e.className,c=e.disabled,u=e.allowDisabledFocus,d=e.primaryDisabled,p=void 0===(t=e.secondaryText)?this.props.description:t,g=e.href,m=e.iconProps,f=e.menuIconProps,h=e.styles,v=e.checked,y=e.variantClassName,C=e.theme,S=e.toggle,b=e.getClassNames,E=e.role,T=this.state.menuHidden,I=c||d;this._classNames=b?b(C,l,y,m&&m.className,f&&f.className,I,v,!T,!!this.props.menuProps,this.props.split,!!u):Go(C,h,l,y,m&&m.className,f&&f.className,I,!!this.props.menuProps,v,!T,this.props.split);var _=(n=this)._ariaDescriptionId,w=n._labelId,P=n._descriptionId,x=!I&&!!g,k=x?"a":"button",A=(0,qe.G1)((0,Re.kp)(x?{}:{type:"button"},this.props.rootProps,this.props),x?qe.t0:qe.uw,["disabled"]),L=a||A["aria-label"],D=void 0;i?D=_:p&&this.props.onRenderDescription!==Bo.K?D=P:A["aria-describedby"]&&(D=A["aria-describedby"]);var O=void 0;A["aria-labelledby"]?O=A["aria-labelledby"]:D&&!L&&(O=this._hasText()?w:void 0);var N=!(!1===this.props["data-is-focusable"]||c&&!u||this._isSplitButton),R="menuitemcheckbox"===E||"checkbox"===E,F=R||!0===S?!!v:void 0,M=(0,Re.kp)(A,((r={className:this._classNames.root,ref:this._mergedRef(this.props.elementRef,this._buttonElement),disabled:I&&!u,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onClick:this._onClick,"aria-label":L,"aria-labelledby":O,"aria-describedby":D,"aria-disabled":I,"data-is-focusable":N})[R?"aria-checked":"aria-pressed"]=F,r));if(s&&(M["aria-hidden"]=!0),this._isSplitButton)return this._onRenderSplitButtonContent(k,M);if(this.props.menuProps){var B=void 0===(o=this.props.menuProps.id)?"".concat(this._labelId,"-menu"):o;(0,Re.kp)(M,{"aria-expanded":!T,"aria-controls":T?null:B,"aria-haspopup":!0})}return this._onRenderContent(k,M)},t.prototype.componentDidMount=function(){this._isSplitButton&&this._splitButtonContainer.current&&("onpointerdown"in this._splitButtonContainer.current&&this._events.on(this._splitButtonContainer.current,"pointerdown",this._onPointerDown,!0),"onpointerup"in this._splitButtonContainer.current&&this.props.onPointerUp&&this._events.on(this._splitButtonContainer.current,"pointerup",this.props.onPointerUp,!0))},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&!t.menuHidden&&this.state.menuHidden&&this.props.onAfterMenuDismiss()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.focus=function(){var e,t;this._isSplitButton&&this._splitButtonContainer.current?((0,En.Fy)(!0,void 0,null===(e=this.context)||void 0===e?void 0:e.registeredProviders),this._splitButtonContainer.current.focus()):this._buttonElement.current&&((0,En.Fy)(!0,void 0,null===(t=this.context)||void 0===t?void 0:t.registeredProviders),this._buttonElement.current.focus())},t.prototype.dismissMenu=function(){this._dismissMenu()},t.prototype.openMenu=function(e,t){this._openMenu(e,t)},t.prototype._onRenderContent=function(e,t){var n,r,o,i,s,l=this,c=this.props,u=e,d=c.menuIconProps,p=c.menuProps,g=void 0===(n=c.onRenderIcon)?this._onRenderIcon:n,m=void 0===(r=c.onRenderAriaDescription)?this._onRenderAriaDescription:r,f=void 0===(o=c.onRenderChildren)?this._onRenderChildren:o,h=void 0===(i=c.onRenderMenu)?this._onRenderMenu:i,v=void 0===(s=c.onRenderMenuIcon)?this._onRenderMenuIcon:s,y=c.disabled,C=c.keytipProps;C&&p&&(C=this._getMemoizedMenuButtonKeytipProps(C));var S=function(e){return a.createElement(u,(0,F.__assign)({},t,e),a.createElement("span",{className:l._classNames.flexContainer,"data-automationid":"splitbuttonprimary"},g(c,l._onRenderIcon),l._onRenderTextContents(),m(c,l._onRenderAriaDescription),f(c,l._onRenderChildren),!l._isSplitButton&&(p||d||l.props.onRenderMenuIcon)&&v(l.props,l._onRenderMenuIcon),p&&!p.doNotLayer&&l._shouldRenderMenu()&&h(l._getMenuProps(p),l._onRenderMenu)))},b=C?a.createElement(Lr,{keytipProps:this._isSplitButton?void 0:C,ariaDescribedBy:t["aria-describedby"],disabled:y},(function(e){return S(e)})):S();return p&&p.doNotLayer?a.createElement(a.Fragment,null,b,this._shouldRenderMenu()&&h(this._getMenuProps(p),this._onRenderMenu)):a.createElement(a.Fragment,null,b,a.createElement(je.MO,null))},t.prototype._shouldRenderMenu=function(){var e,t=this.state.menuHidden,n=(e=this.props).persistMenu,r=e.renderPersistedMenuHiddenOnMount;return!t||!(!n||!this._renderedVisibleMenu&&!r)},t.prototype._hasText=function(){return null!==this.props.text&&(void 0!==this.props.text||"string"==typeof this.props.children)},t.prototype._getMenuProps=function(e){var t=this.props.persistMenu,n=this.state.menuHidden;return e.ariaLabel||e.labelElementId||!this._hasText()||(e=(0,F.__assign)((0,F.__assign)({},e),{labelElementId:this._labelId})),(0,F.__assign)((0,F.__assign)({id:this._labelId+"-menu",directionalHint:ke.bottomLeftEdge},e),{shouldFocusOnContainer:this._menuShouldFocusOnContainer,shouldFocusOnMount:this._menuShouldFocusOnMount,hidden:t?n:void 0,className:(0,We.A)("ms-BaseButton-menuhost",e.className),target:this._isSplitButton?this._splitButtonContainer.current:this._buttonElement.current,onDismiss:this._onDismissMenu})},t.prototype._onRenderSplitButtonContent=function(e,t){var n,r,o=this,i=void 0===(r=(n=this.props).styles)?{}:r,s=n.disabled,l=n.allowDisabledFocus,c=n.checked,u=n.getSplitButtonClassNames,d=n.primaryDisabled,p=n.menuProps,g=n.toggle,m=n.role,f=n.primaryActionButtonProps,h=this.props.keytipProps,v=this.state.menuHidden,y=u?u(!!s,!v,!!c,!!l):i&&qo(i,!!s,!v,!!c,!!d);(0,Re.kp)(t,{onClick:void 0,onPointerDown:void 0,onPointerUp:void 0,tabIndex:-1,"data-is-focusable":!1}),h&&p&&(h=this._getMemoizedMenuButtonKeytipProps(h));var C=(0,qe.G1)(t,[],["disabled"]);f&&(0,Re.kp)(t,f);var S=function(n){return a.createElement("div",(0,F.__assign)({},C,{"data-ktp-target":n?n["data-ktp-target"]:void 0,role:m||"button","aria-disabled":s,"aria-haspopup":!0,"aria-expanded":!v,"aria-pressed":g?!!c:void 0,"aria-describedby":(0,Sr._)(t["aria-describedby"],n?n["aria-describedby"]:void 0),className:y&&y.splitButtonContainer,onKeyDown:o._onSplitButtonContainerKeyDown,onTouchStart:o._onTouchStart,ref:o._splitButtonContainer,"data-is-focusable":!0,onClick:s||d?void 0:o._onSplitButtonPrimaryClick,tabIndex:!s&&!d||l?0:void 0,"aria-roledescription":t["aria-roledescription"],onFocusCapture:o._onSplitContainerFocusCapture}),a.createElement("span",{style:{display:"flex",width:"100%"}},o._onRenderContent(e,t),o._onRenderSplitButtonMenuButton(y,n),o._onRenderSplitButtonDivider(y)))};return h?a.createElement(Lr,{keytipProps:h,disabled:s},(function(e){return S(e)})):S()},t.prototype._onRenderSplitButtonDivider=function(e){if(e&&e.divider){return a.createElement("span",{className:e.divider,"aria-hidden":!0,onClick:function(e){e.stopPropagation()}})}return null},t.prototype._onRenderSplitButtonMenuButton=function(e,n){var r,o=(r=this.props).allowDisabledFocus,i=r.checked,s=r.disabled,l=r.splitButtonMenuProps,c=r.splitButtonAriaLabel,u=r.primaryDisabled,d=this.state.menuHidden,p=this.props.menuIconProps;void 0===p&&(p={iconName:"ChevronDown"});var g=(0,F.__assign)((0,F.__assign)({},l),{styles:e,checked:i,disabled:s,allowDisabledFocus:o,onClick:this._onMenuClick,menuProps:void 0,iconProps:(0,F.__assign)((0,F.__assign)({},p),{className:this._classNames.menuIcon}),ariaLabel:c,"aria-haspopup":!0,"aria-expanded":!d,"data-is-focusable":!1});return a.createElement(t,(0,F.__assign)({},g,{"data-ktp-execute-target":n?n["data-ktp-execute-target"]:n,onMouseDown:this._onMouseDown,tabIndex:u&&!o?0:-1}))},t.prototype._onPointerDown=function(e){var t=this.props.onPointerDown;t&&t(e),"touch"===e.pointerType&&(this._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0,e.state.menuHidden&&e.focus()}),500)},t.prototype._isValidMenuOpenKey=function(e){return this.props.menuTriggerKeyCode?e.which===this.props.menuTriggerKeyCode:!!this.props.menuProps&&(e.which===Me.c.down&&(e.altKey||e.metaKey))},t.defaultProps={baseClassName:"ms-Button",styles:{},split:!1},t.contextType=je.dM,t}(a.Component),Vo=n(83455),Qo={outline:0},Jo=function(e){return{fontSize:e,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",flexShrink:0}},Ko=(0,Oe.J9)((function(e){var t,n,r=e.semanticColors,o=e.effects,i=e.fonts,a=r.buttonBorder,s=r.disabledBackground,l=r.disabledText,u={left:-2,top:-2,bottom:-2,right:-2,outlineColor:"ButtonText"};return{root:[(0,c.gm)(e,{inset:1,highContrastStyle:u,borderColor:"transparent"}),e.fonts.medium,{border:"1px solid "+a,borderRadius:o.roundedCorner2,boxSizing:"border-box",cursor:"pointer",display:"inline-block",padding:"0 16px",textDecoration:"none",textAlign:"center",userSelect:"none",":active > span":{position:"relative",left:0,top:0}}],rootDisabled:[(0,c.gm)(e,{inset:1,highContrastStyle:u,borderColor:"transparent"}),{backgroundColor:s,borderColor:s,color:l,cursor:"default",":hover":Qo,":focus":Qo}],iconDisabled:(t={color:l},t[c.up]={color:"GrayText"},t),menuIconDisabled:(n={color:l},n[c.up]={color:"GrayText"},n),flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},description:{display:"block"},textContainer:{flexGrow:1,display:"block"},icon:Jo(i.mediumPlus.fontSize),menuIcon:Jo(i.small.fontSize),label:{margin:"0 4px",lineHeight:"100%",display:"block"},screenReaderText:c.dX}})),Xo=(0,Oe.J9)((function(e,t){var n,r,o,i,a,s,l,u,d,p,g,m,f,h,v,y,C=e.effects,S=e.palette,b=e.semanticColors,E={left:-2,top:-2,bottom:-2,right:-2,border:"none"},T={position:"absolute",width:1,right:31,top:8,bottom:8},I={splitButtonContainer:[(0,c.gm)(e,{highContrastStyle:E,inset:2,pointerEvents:"none"}),{display:"inline-flex",".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none",flexGrow:"1"},".ms-Button--primary":(n={borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",flexGrow:"1",":hover":{border:"none"},":active":{border:"none"}},n[c.up]=(0,F.__assign)((0,F.__assign)({color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0"},(0,c.Qg)()),{":hover":{backgroundColor:"Highlight",border:"1px solid Highlight",borderRightWidth:"0",color:"HighlightText"},":active":{border:"1px solid Highlight"}}),n),".ms-Button--default + .ms-Button":(r={},r[c.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,F.__assign)({backgroundColor:"HighlightText",color:"Highlight"},(0,c.Qg)())}},r),'.ms-Button--default + .ms-Button[aria-expanded="true"]':(o={},o[c.up]={backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,F.__assign)({backgroundColor:"HighlightText",color:"Highlight"},(0,c.Qg)())},o),".ms-Button--primary + .ms-Button":(i={border:"none"},i[c.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{borderLeftWidth:"0",backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",".ms-Button-menuIcon":(0,F.__assign)((0,F.__assign)({},(0,c.Qg)()),{color:"HighlightText"})}},i),'.ms-Button--primary + .ms-Button[aria-expanded="true"]':(0,F.__assign)((0,F.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},(0,c.Qg)()),{".ms-Button-menuIcon":{color:"HighlightText"}}),".ms-Button.is-disabled":(a={},a[c.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},a)}],splitButtonContainerHovered:{".ms-Button--default.is-disabled":(s={backgroundColor:b.buttonBackgroundDisabled,color:b.buttonTextDisabled},s[c.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s),".ms-Button--primary.is-disabled":(l={backgroundColor:b.primaryButtonBackgroundDisabled,color:b.primaryButtonTextDisabled},l[c.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},l)},splitButtonContainerChecked:{".ms-Button--primary":(u={},u[c.up]=(0,F.__assign)({color:"Window",backgroundColor:"WindowText"},(0,c.Qg)()),u)},splitButtonContainerCheckedHovered:{".ms-Button--primary":(d={},d[c.up]=(0,F.__assign)({color:"Window",backgroundColor:"WindowText"},(0,c.Qg)()),d)},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:(p={padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:C.roundedCorner2,borderBottomRightRadius:C.roundedCorner2,border:"1px solid ".concat(S.neutralSecondaryAlt),borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},p[c.up]={".ms-Button-menuIcon":{color:"WindowText"}},p),splitButtonDivider:(0,F.__assign)((0,F.__assign)({},T),(g={},g[c.up]={backgroundColor:"WindowText"},g)),splitButtonDividerDisabled:(0,F.__assign)((0,F.__assign)({},T),(m={},m[c.up]={backgroundColor:"GrayText"},m)),splitButtonMenuButtonDisabled:(f={pointerEvents:"none",border:"none",":hover":{cursor:"default"},".ms-Button--primary":(h={},h[c.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},h),".ms-Button-menuIcon":(v={},v[c.up]={color:"GrayText"},v)},f[c.up]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},f),splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:(y={outline:"none",border:"none"},y[c.up]=(0,F.__assign)({color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},(0,c.Qg)()),y),splitButtonMenuFocused:(0,F.__assign)({},(0,c.gm)(e,{highContrastStyle:E,inset:2}))};return(0,c.TW)(I,t)})),Zo=(0,Oe.J9)((function(e,t){var n,r=Ko(e),o=Xo(e),i=e.palette,a={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:(n={color:i.themeDarkAlt,backgroundColor:i.neutralLighter},n[c.up]={borderColor:"Highlight",color:"Highlight"},n),rootHasMenu:{width:"auto"},rootPressed:{color:i.themeDark,backgroundColor:i.neutralLight},rootExpanded:{color:i.themeDark,backgroundColor:i.neutralLight},rootChecked:{color:i.themeDark,backgroundColor:i.neutralLight},rootCheckedHovered:{color:i.themeDark,backgroundColor:i.neutralQuaternaryAlt},rootDisabled:{color:i.neutralTertiaryAlt}};return(0,c.TW)(r,a,o,t)})),Yo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,F.__extends)(t,e),t.prototype.render=function(){var e,t=(e=this.props).styles,n=e.theme;return a.createElement(jo,(0,F.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:Zo(n,t),onRenderText:Bo.K,onRenderDescription:Bo.K}))},t=(0,F.__decorate)([(0,Vo.T)("IconButton",["theme","styles"],!0)],t)}(a.Component);const $o=e=>({root:{backgroundColor:e.palette.neutralTertiary,selectors:{":hover":{backgroundColor:e.palette.neutralTertiary},"svg > path":{fill:e.palette.neutralQuaternary}}}}),ei=e=>ae()===re.IOS?function(e){return(0,c.l8)({root:{width:"40px",height:"40px",backgroundColor:"transparent",selectors:{svg:{height:"24px",width:"24px"},":hover":{backgroundColor:"transparent"},"svg > path":{fill:e.palette.themePrimary}}}})}(e):{};(0,c.K1)({icons:{suggestionIcon:a.createElement((()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M7.39804 12.8085C7.57428 12.9328 7.78476 12.9994 8.00043 12.999C8.21633 12.9992 8.42686 12.9317 8.60243 12.806C8.77993 12.6755 8.91464 12.4952 8.98943 12.288L9.43643 10.915C9.55086 10.5707 9.74391 10.2578 10.0003 10.0011C10.2566 9.74436 10.5693 9.55089 10.9134 9.436L12.3044 8.98499C12.4564 8.93064 12.5936 8.84184 12.7055 8.72555C12.8174 8.60926 12.9008 8.46865 12.9492 8.31473C12.9977 8.1608 13.0098 7.99776 12.9847 7.83836C12.9596 7.67897 12.8979 7.52756 12.8044 7.396C12.6703 7.21007 12.4794 7.07283 12.2604 7.005L10.8854 6.558C10.5409 6.44377 10.2278 6.2508 9.97087 5.99441C9.71396 5.73803 9.52035 5.42528 9.40543 5.081L8.95343 3.693C8.88113 3.49069 8.74761 3.31593 8.57143 3.193C8.43877 3.09927 8.28607 3.03779 8.12548 3.01344C7.96489 2.9891 7.80083 3.00256 7.64636 3.05275C7.49188 3.10295 7.35125 3.1885 7.23564 3.3026C7.12004 3.41669 7.03265 3.55619 6.98043 3.71L6.52343 5.11C6.40884 5.44482 6.21967 5.74923 5.97022 6.00025C5.72076 6.25126 5.41753 6.44232 5.08343 6.559L3.69243 7.007C3.54065 7.06139 3.40352 7.15017 3.29177 7.26638C3.18001 7.3826 3.09666 7.5231 3.04824 7.67688C2.99982 7.83067 2.98764 7.99357 3.01265 8.15285C3.03767 8.31213 3.0992 8.46346 3.19243 8.595C3.32027 8.77445 3.50105 8.90942 3.70943 8.981L5.08343 9.42599C5.52354 9.57248 5.90999 9.84682 6.19343 10.214C6.35585 10.4246 6.4813 10.6613 6.56443 10.914L7.01643 12.305C7.08846 12.5083 7.22179 12.6842 7.39804 12.8085ZM7.48343 5.394L8.01043 4.017L8.44943 5.394C8.61312 5.88714 8.88991 6.33516 9.25767 6.70223C9.62544 7.06929 10.074 7.34524 10.5674 7.508L11.9734 8.03699L10.5914 8.48499C10.0987 8.64929 9.65095 8.92616 9.28382 9.29363C8.9167 9.6611 8.64026 10.1091 8.47643 10.602L7.95343 11.98L7.50443 10.601C7.34335 10.1077 7.06943 9.65883 6.70443 9.29C6.3356 8.92196 5.88653 8.64437 5.39243 8.479L4.01443 7.957L5.40043 7.507C5.88672 7.33836 6.32775 7.0602 6.68943 6.694C7.04901 6.32629 7.32049 5.8818 7.48343 5.394ZM13.5353 16.851C13.6713 16.9472 13.8337 16.9989 14.0003 16.999C14.1654 16.9991 14.3264 16.9481 14.4613 16.853C14.6008 16.7545 14.7058 16.6146 14.7613 16.453L15.0093 15.691C15.0625 15.5326 15.1515 15.3885 15.2693 15.27C15.3867 15.1515 15.5307 15.0627 15.6893 15.011L16.4613 14.759C16.619 14.7045 16.7557 14.6021 16.8523 14.466C16.9257 14.363 16.9736 14.2441 16.9921 14.119C17.0106 13.9939 16.9992 13.8662 16.9588 13.7463C16.9184 13.6265 16.8501 13.518 16.7597 13.4296C16.6692 13.3412 16.5591 13.2756 16.4383 13.238L15.6743 12.989C15.5162 12.9365 15.3724 12.8478 15.2544 12.7302C15.1364 12.6125 15.0473 12.469 14.9943 12.311L14.7423 11.538C14.6886 11.3802 14.586 11.2436 14.4493 11.148C14.3473 11.0751 14.2295 11.0271 14.1056 11.0081C13.9816 10.989 13.8549 10.9994 13.7357 11.0383C13.6164 11.0772 13.508 11.1436 13.4192 11.2322C13.3304 11.3207 13.2636 11.4289 13.2243 11.548L12.9773 12.31C12.925 12.4677 12.8375 12.6113 12.7213 12.73C12.6066 12.8465 12.4667 12.9351 12.3123 12.989L11.5393 13.241C11.3803 13.2949 11.2422 13.3975 11.1447 13.5343C11.0472 13.671 10.9952 13.835 10.9961 14.0029C10.997 14.1708 11.0507 14.3342 11.1496 14.47C11.2486 14.6057 11.3877 14.7068 11.5473 14.759L12.3103 15.006C12.4692 15.0594 12.6136 15.1487 12.7323 15.267C12.8505 15.3853 12.939 15.5299 12.9903 15.689L13.2433 16.463C13.2981 16.6195 13.4001 16.7551 13.5353 16.851ZM12.6223 14.058L12.4433 13.999L12.6273 13.935C12.9291 13.8301 13.2027 13.6573 13.4273 13.43C13.6537 13.201 13.8248 12.9233 13.9273 12.618L13.9853 12.44L14.0443 12.621C14.1463 12.9277 14.3185 13.2064 14.5471 13.4349C14.7757 13.6633 15.0545 13.8353 15.3613 13.937L15.5563 14L15.3763 14.059C15.0689 14.1612 14.7898 14.3339 14.5611 14.5633C14.3324 14.7927 14.1606 15.0724 14.0593 15.38L14.0003 15.561L13.9423 15.38C13.8409 15.0719 13.6687 14.7917 13.4394 14.5622C13.2102 14.3326 12.9303 14.1599 12.6223 14.058Z",fill:"#242424"}))),null),suggestionClickedIcon:a.createElement((()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.5353 16.8513C13.6713 16.9475 13.8337 16.9992 14.0003 16.9993C14.1654 16.9993 14.3264 16.9483 14.4613 16.8533C14.6008 16.7548 14.7058 16.6148 14.7613 16.4533L15.0093 15.6913C15.0625 15.5328 15.1515 15.3888 15.2693 15.2703C15.3867 15.1517 15.5307 15.0629 15.6893 15.0113L16.4613 14.7593C16.619 14.7048 16.7557 14.6023 16.8523 14.4663C16.9257 14.3633 16.9736 14.2443 16.9921 14.1192C17.0106 13.9941 16.9992 13.8664 16.9588 13.7466C16.9184 13.6268 16.8501 13.5182 16.7597 13.4298C16.6692 13.3415 16.5591 13.2758 16.4383 13.2383L15.6743 12.9893C15.5162 12.9367 15.3724 12.8481 15.2544 12.7304C15.1364 12.6127 15.0473 12.4693 14.9943 12.3113L14.7423 11.5383C14.6886 11.3804 14.586 11.2438 14.4493 11.1483C14.3473 11.0753 14.2295 11.0274 14.1056 11.0083C13.9816 10.9893 13.8549 10.9996 13.7357 11.0385C13.6164 11.0775 13.508 11.1439 13.4192 11.2324C13.3304 11.321 13.2636 11.4292 13.2243 11.5483L12.9773 12.3103C12.925 12.4679 12.8375 12.6116 12.7213 12.7303C12.6066 12.8467 12.4667 12.9353 12.3123 12.9893L11.5393 13.2413C11.3803 13.2952 11.2422 13.3978 11.1447 13.5345C11.0472 13.6713 10.9952 13.8352 10.9961 14.0032C10.997 14.1711 11.0507 14.3345 11.1496 14.4702C11.2486 14.6059 11.3877 14.707 11.5473 14.7593L12.3103 15.0063C12.4692 15.0597 12.6136 15.149 12.7323 15.2673C12.8505 15.3855 12.939 15.5301 12.9903 15.6893L13.2433 16.4633C13.2981 16.6197 13.4001 16.7553 13.5353 16.8513Z",fill:"url(#paint0_linear_423_27237)"}),a.createElement("path",{d:"M7.39804 12.8088C7.57428 12.9331 7.78476 12.9997 8.00043 12.9993C8.21633 12.9995 8.42686 12.932 8.60243 12.8063C8.77993 12.6758 8.91464 12.4955 8.98943 12.2883L9.43643 10.9153C9.55086 10.571 9.74391 10.2581 10.0003 10.0014C10.2566 9.74467 10.5693 9.5512 10.9134 9.4363L12.3044 8.9853C12.4564 8.93095 12.5936 8.84214 12.7055 8.72586C12.8174 8.60957 12.9008 8.46896 12.9492 8.31503C12.9977 8.16111 13.0098 7.99806 12.9847 7.83867C12.9596 7.67927 12.8979 7.52786 12.8044 7.3963C12.6703 7.21038 12.4794 7.07314 12.2604 7.0053L10.8854 6.5583C10.5409 6.44407 10.2278 6.25111 9.97087 5.99472C9.71396 5.73833 9.52035 5.42558 9.40543 5.0813L8.95343 3.6933C8.88113 3.491 8.74761 3.31624 8.57143 3.1933C8.43877 3.09957 8.28607 3.03809 8.12548 3.01375C7.96489 2.9894 7.80083 3.00286 7.64636 3.05306C7.49188 3.10326 7.35125 3.18881 7.23564 3.3029C7.12004 3.417 7.03265 3.5565 6.98043 3.7103L6.52343 5.1103C6.40884 5.44513 6.21967 5.74954 5.97022 6.00055C5.72076 6.25157 5.41753 6.44263 5.08343 6.5593L3.69243 7.0073C3.54065 7.0617 3.40352 7.15048 3.29177 7.26669C3.18001 7.3829 3.09666 7.5234 3.04824 7.67719C2.99982 7.83097 2.98764 7.99388 3.01265 8.15315C3.03767 8.31243 3.0992 8.46376 3.19243 8.5953C3.32027 8.77475 3.50105 8.90972 3.70943 8.9813L5.08343 9.4263C5.52354 9.57278 5.90999 9.84713 6.19343 10.2143C6.35585 10.4249 6.4813 10.6616 6.56443 10.9143L7.01643 12.3053C7.08846 12.5086 7.22179 12.6845 7.39804 12.8088Z",fill:"url(#paint1_linear_423_27237)"}),a.createElement("defs",null,a.createElement("linearGradient",{id:"paint0_linear_423_27237",x1:"10.9961",y1:"10.999",x2:"17.053",y2:"11.0523",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{className:"gradientPrimary",stopColor:"#C43E1C"}),a.createElement("stop",{className:"gradientSecondary",offset:"1",stopColor:"#FF5C39"})),a.createElement("linearGradient",{id:"paint1_linear_423_27237",x1:"3",y1:"3.00195",x2:"13.0845",y2:"3.09059",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{className:"gradientPrimary",stopColor:"#C43E1C"}),a.createElement("stop",{className:"gradientSecondary",offset:"1",stopColor:"#FF5C39"}))))),null)}});const ti=({title:e,isDisabled:t,isMenuOpen:n,handleClick:r})=>{const o=((e,t,n)=>(0,c.l8)({root:[{backgroundColor:e.palette.neutralLight,border:e.palette.neutralLight,borderRadius:"8px",backgroundRepeat:"no-repeat",backgroundPosition:"center",marginLeft:"4px",width:"32px",height:"32px",selectors:{":hover":{backgroundColor:e.palette.neutralTertiaryAlt}}},t?{backgroundColor:e.palette.neutralLighter,selectors:{"svg > defs > linearGradient > stop.gradientPrimary":{stopColor:e.palette.themePrimary},"svg > defs > linearGradient > stop.gradientSecondary":{stopColor:e.palette.themeSecondary}}}:n?"":{selectors:{"svg > path":{fill:e.palette.neutralPrimary}}}],"ms-ContextualMenu-Callout":{borderRadius:"8px",color:e.palette.black,display:"flex",flexDirection:"column",alignItems:"flex-start",gap:"4px",height:"auto",backgroundColor:"white",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",overflow:"hidden"},"ms-Callout-main":{borderRadius:"8px"},"ms-Icon-imageContainer":{marginTop:"0px !important",height:"auto !important",display:"flex",justifyContent:"space-around"}},ei(e),n?$o(e):{}))(ee(),n,t);return a.createElement(Yo,{className:o.root,title:e,"aria-haspopup":!0,"aria-expanded":n,role:"button",iconProps:n?{iconName:"suggestionClickedIcon"}:{iconName:"suggestionIcon"},disabled:t,onClick:r})};const ni=e=>({root:{backgroundColor:e.palette.neutralTertiary,selectors:{":hover":{cursor:"default",backgroundColor:e.palette.neutralTertiary,"svg > path#submitOutline":{fill:e.palette.neutralQuaternary},"svg > path#submitFilled":{fill:"transparent"}},"svg > path#submitOutline":{fill:e.palette.neutralQuaternary},"svg > path#submitFilled":{fill:"transparent"}}}}),ri=(e,t)=>ae()===re.IOS?function(e,t){return(0,c.l8)({root:{width:"40px",height:"40px",selectors:{svg:{height:"18px",width:"18px"}}}},t?{}:function(e){return{root:{"svg > path#submitOutline":{fill:"transparent"},"svg > path#submitFilled":{fill:e.palette.themePrimary}}}}(e))}(e,t):{};(0,c.K1)({icons:{submitButtonIcon:a.createElement((()=>{const e=ee();return a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{id:"submitOutline",d:"M0.18412 0.11244C0.336572 -0.0118225 0.547712 -0.0351664 0.723627 0.0527913L15.7236 7.55279C15.893 7.63749 16 7.81062 16 8C16 8.18939 15.893 8.36252 15.7236 8.44722L0.723627 15.9472C0.547712 16.0352 0.336572 16.0118 0.18412 15.8876C0.0316676 15.7633 -0.0337739 15.5612 0.0169031 15.3712L1.98255 8L0.0169031 0.628836C-0.0337739 0.438798 0.0316676 0.236702 0.18412 0.11244ZM2.88416 8.5L1.26911 14.5564L14.382 8L1.26911 1.44357L2.88416 7.5H9.50002C9.77616 7.5 10 7.72386 10 8C10 8.27615 9.77616 8.5 9.50002 8.5H2.88416Z",fill:e.palette.neutralPrimary}),a.createElement("path",{id:"submitFilled",d:"M0.723627 0.0527913C0.547712 -0.0351664 0.336572 -0.0118224 0.18412 0.11244C0.0316676 0.236702 -0.0337739 0.438798 0.0169031 0.628836L1.51498 6.24662C1.56554 6.43622 1.72234 6.57872 1.9159 6.61098L8.77041 7.7534C9.04894 7.79982 9.04894 8.20018 8.77041 8.2466L1.9159 9.38902C1.72234 9.42128 1.56554 9.56378 1.51498 9.75338L0.0169031 15.3712C-0.0337739 15.5612 0.0316676 15.7633 0.18412 15.8876C0.336572 16.0118 0.547712 16.0352 0.723627 15.9472L15.7236 8.44722C15.893 8.36252 16 8.18939 16 8C16 7.81062 15.893 7.63749 15.7236 7.55279L0.723627 0.0527913Z",fill:"transparent"}))}),null)}});const oi=({title:e,isDisabled:t,handleClick:n,handleKeyDown:r,isInputEmpty:o})=>{const i=((e,t,n)=>(0,c.l8)({root:{backgroundColor:e.palette.neutralLight,border:e.palette.neutralLight,borderRadius:"8px",backgroundRepeat:"no-repeat",backgroundPosition:"center",marginRight:"2px",width:"32px",height:"32px",selectors:{":hover":{cursor:"pointer",backgroundColor:e.palette.neutralTertiaryAlt,"svg > path#submitOutline":{fill:"transparent"},"svg > path#submitFilled":{fill:e.palette.themePrimary}}}}},ri(e,n),t?ni(e):{}))(ee(),t,o);return a.createElement(Yo,{className:i.root,title:e,"aria-label":e,iconProps:{iconName:"submitButtonIcon"},onClick:n,disabled:t,onKeyDown:r})},ii=e=>({color:e.palette.neutralSecondaryAlt,alignItems:"flex-start",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",gap:"1px",lineHeight:"20px","-webkit-user-select":"none","-ms-user-select":"none",userSelect:"none",content:"attr(title)"}),ai={paddingRight:"2px",fontSize:"15px",lineHeight:"inherit",alignItems:"flex-start",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",gap:"1px",display:"inline-block",width:"100%",whiteSpace:"pre-wrap",selectors:{":focus":{outline:"none"}}};const si=e=>({color:e.palette.neutralQuaternary});function li(e,t,n,r=!1){return(0,c.l8)({chatInput:{color:e.palette.neutralPrimary,borderWidth:"1px",borderColor:e.palette.neutralLighterAlt,borderStyle:"solid",borderRadius:"8px",background:e.palette.neutralLight,marginLeft:"16px",marginRight:"16px",marginBottom:"16px",padding:"4px",gap:"4px",position:"relative",zIndex:"1",transform:"none",transformOrigin:"bottom",overflowWrap:"break-word",selectors:{":focus-within":{"::after":t?{}:{position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''",borderRadius:"0px 0px 8px 8px",background:e.palette.themePrimary}}}},chatInputContainer:{margin:"12px 12px 4px 12px"},userInput:{alignItems:"flex-start",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",gap:"1px",lineHeight:"20px",whiteSpace:"pre-wrap",selectors:{":focus":{outline:"none"}}},ghostInput:{color:e.palette.neutralSecondaryAlt,alignItems:"flex-start",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",gap:"1px",lineHeight:"20px","-webkit-user-select":"none","-ms-user-select":"none",userSelect:"none"},chatInputButtons:{background:e.palette.neutralLight,width:"100%",flexFlow:"row wrap",gap:"2px",marginBottom:"12px",justifyContent:"space-between"},chatInputLeftButtons:{alignSelf:"flex-start"},chatInputRightButtons:{display:r?"contents":"flex",alignSelf:"flex-end"},contextualMenu:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"6px",background:e.palette.neutralLight,boxShadow:`0px 4px 8px ${e.palette.neutralLight}24, 0px 0px 2px ${e.palette.neutralLight}1F`,borderRadius:"8px",selectors:{"> .ms-ContextualMenu-list":{padding:"0px",width:"100%"},".ms-ContextualMenu-icon":{"svg > path":{fill:e.palette.neutralPrimary}},".ms-ContextualMenu-itemText":{color:e.palette.neutralPrimary},".ms-ContextualMenu-item":{"button.ms-ContextualMenu-link:focus":{backgroundColor:"inherit"},"button.ms-ContextualMenu-link:hover":{backgroundColor:e.palette.neutralTertiary}}}}},ui(e,t),t?ci(e):{},n)}const ci=e=>({chatInput:{background:e.palette.neutralTertiary},userInput:se()?{"&:focus::after":si(e),"&::after":si(e)}:{},ghostInput:{color:e.palette.neutralQuaternary},chatInputButtons:{background:e.palette.neutralTertiary}}),ui=(e,t)=>{switch(ae()){case re.IOS:return function(e,t){return(0,c.l8)({chatInput:{borderRadius:"12px",selectors:{":focus-within":{"::after":t?{}:{left:"2",width:"97%",height:"4px",borderRadius:"0px 0px 12px 12px"}}}},userInput:Object.assign(Object.assign({},ai),{"&:focus":{outline:"none"},"&:focus::after":ii(e),"&::after":ii(e)}),ghostInput:{fontSize:"15px",lineHeight:"inherit"},contextualMenu:{display:"flex",flexDirection:"column",alignItems:"flex-start",padding:"0px",maxWidth:"288px",background:e.palette.neutralLight,boxShadow:`0px 0px 2px 0px ${e.palette.black}1F, 0px 8px 16px 0px ${e.palette.black}24`,borderRadius:"12px",selectors:{"> .ms-ContextualMenu-list":{padding:"8px 0px 8px 0px",width:"100%"},"> .ms-ContextualMenu-item":{padding:"0px",height:"48px"},".ms-ContextualMenu-icon":{marginRight:"16px",svg:{width:"24px",height:"24px"}},"> .ms-ContextualMenu-itemText":{margin:"12px 16px 12px 8px",textColor:e.palette.neutralPrimary,fontStyle:"-apple-system",fontSize:"16px"},".ms-ContextualMenu-list > .ms-ContextualMenu-icon":{margin:"12px 0px 12px 16px",width:"24px",height:"24px"}}}})}(e,t);case re.MACOS:return(0,c.l8)({userInput:{fontSize:"13px",lineHeight:"16px"},ghostInput:{fontSize:"13px",lineHeight:"16px"}});default:return{}}},di=()=>ne()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area",pi=()=>ne()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide",gi=()=>ne()?OfficeaicopilotStrings.SubmitButtonTitle:"Send",mi=()=>ne()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own",fi="",hi="copilot-chat-input",vi=()=>ne()?OfficeaicopilotStrings.MicrophoneTooltip:"Microphone",yi=a.forwardRef((({styles:e,placeholderText:t,chatInputTabIndex:n,isDisabled:r,handleKeyDown:o,handleKeyUp:i,handleOnPaste:s,handleOnBeforeInput:l,handleOnInput:c,handleOnChatInputControlMount:u,handleOnChatInputControlUnmount:d},p)=>{const g=(0,a.useRef)();(0,a.useImperativeHandle)(p,(()=>({setInputText:e=>{m(e)},getInputText:()=>f(),getInputSpanElement:()=>g.current,setFocus:()=>{h()},getGhostText:()=>{var e,t;return null!==(t=null===(e=g.current)||void 0===e?void 0:e.getAttribute("title"))&&void 0!==t?t:""},setGhostText:e=>{var t;return null===(t=g.current)||void 0===t?void 0:t.setAttribute("title",e)}})));const m=e=>{const t=g.current;t&&(t.innerText=e)},f=()=>{let e=fi;const t=g.current;return t&&(e=t.innerText),e},h=()=>{if(r)return;const e=g.current;e&&(e.focus(),e.firstChild&&window.getSelection().setPosition(e.firstChild,e.innerText.length))};(0,a.useEffect)((()=>(u&&u(),()=>{d&&d()})),[]);const v=li(ce(),r,e);return a.createElement("span",{ref:g,className:v.userInput,title:t,"aria-label":t,role:"textbox",tabIndex:n,contentEditable:!r,suppressContentEditableWarning:!r,onKeyDown:o,onKeyUp:i,onPaste:s,onBeforeInput:l,onInput:c,spellCheck:!(oe===re.MACOS)})}));var Ci;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(Ci||(Ci={}));const Si=e=>{const t=(0,c.i7)({"0%":{boxShadow:`0 0 0 0 ${e.palette.themeLight}`},"60%":{boxShadow:`0 0 0 8px ${e.palette.themeLight}`},"100%":{boxShadow:`0 0 0 0 ${e.palette.themeLight}`}});return{root:{backgroundColor:e.palette.themePrimary,color:e.palette.white,borderRadius:"50%",animation:`${t} 2s ease-in-out infinite`,selectors:{":hover":{cursor:"pointer",backgroundColor:e.palette.themePrimary,"svg > path":{fill:e.palette.white}},"svg > path":{fill:e.palette.white}}}}},bi=e=>({root:{backgroundColor:e.palette.neutralTertiary,selectors:{":hover":{cursor:"default",backgroundColor:e.palette.neutralTertiary,"svg > path#microphoneOutline":{fill:e.palette.neutralQuaternary},"svg > path#microphoneFilled":{fill:"transparent"}},"svg > path#microphoneOutline":{fill:e.palette.neutralQuaternary},"svg > path#microphoneFilled":{fill:"transparent"}}}}),Ei=e=>{const t=(0,c.i7)({from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}});return{root:{backgroundColor:e.palette.neutralTertiaryAlt,color:e.palette.white,borderRadius:"50%",selectors:{":hover":{cursor:"pointer",backgroundColor:e.palette.neutralTertiaryAlt,"svg > path":{fill:e.palette.themePrimary}},"svg > path":{fill:e.palette.themePrimary}}},loader:{position:"absolute",top:"-1px",left:"-1px",right:"-1px",bottom:"-1px",borderRadius:"50%",borderTop:`2px solid ${e.palette.themePrimary}`,animation:`${t} 2s linear infinite`}}};var Ti,Ii=(0,De.Z)({cacheSize:100}),_i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,F.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,r=e.children,o=e.className,i=e.disabled,s=e.styles,l=e.required,c=e.theme,u=Ii(s,{className:o,disabled:i,required:l,theme:c});return a.createElement(n,(0,F.__assign)({},(0,qe.G1)(this.props,qe.JM),{className:u.root}),r)},t}(a.Component),wi=(0,Pe.I)(_i,(function(e){var t,n=e.theme,r=e.className,o=e.disabled,i=e.required,a=n.semanticColors,s=c.BO.semibold,l=a.bodyText,u=a.disabledBodyText,d=a.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:s,color:l,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},o&&{color:u,selectors:(t={},t[c.up]=(0,F.__assign)({color:"GrayText"},(0,c.Qg)()),t)},i&&{selectors:{"::after":{content:"' *'",color:d,paddingRight:12}}},r]}}),void 0,{scope:"Label"});!function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(Ti||(Ti={}));var Pi=n(43313),xi=n(17046),ki=n(46033),Ai=n(74773),Li=n(8762),Di={disabled:!1,disableFirstFocus:!1,forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!1,"data-tabster":'{"uncontrolled": {"completely": true}}'},Oi=a.forwardRef((function(e,t){var n,r=a.useRef(null),o=a.useRef(null),i=a.useRef(null),s=(0,zt.a)(r,t),l=(0,qt.ZY)(),c=Kt(),u=(0,Pi.h)(),d=null===(n=(0,_r.Z)(!1))||void 0===n||n,p=(0,Ge.N)(Di,e),g=(0,Qt.d)({hasFocus:!1,focusStackId:(0,Ur.B)("ftz-",p.id)}),m=p.children,f=p.componentRef,h=p.disabled,v=p.disableFirstFocus,y=p.forceFocusInsideTrap,C=p.focusPreviouslyFocusedInnerElement,S=p.firstFocusableSelector,b=p.firstFocusableTarget,E=p.disableRestoreFocus,T=void 0===E?p.ignoreExternalFocusing:E,I=p.isClickableOutsideFocusTrap,_=p.enableAriaHiddenSiblings,w={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:h?-1:0,"data-is-visible":!0,"data-is-focus-trap-zone-bumper":!0},P=a.useCallback((function(e){e!==o.current&&e!==i.current&&(0,Be.lo)(e)}),[]),x=(0,Ai.D)((function(){if(r.current){var e=g.previouslyFocusedElementInTrapZone;if(C&&e&&(0,Ye.s)(r.current,e))P(e);else{var t=null;if("string"==typeof b)t=r.current.querySelector(b);else if(b)t=b(r.current);else if(S){var n="string"==typeof S?S:S();t=r.current.querySelector("."+n)}t||(t=(0,Be.eX)(r.current,r.current.firstChild,!1,!1,!1,!0,void 0,void 0,void 0,u)),t&&P(t)}}})),k=function(e){if(!h&&r.current){var t=e===g.hasFocus?(0,Be.Cm)(r.current,i.current,!0,!1,u):(0,Be.oR)(r.current,o.current,!0,!1,u);t&&(t===o.current||t===i.current?x():t.focus())}},A=(0,Ai.D)((function(e){if(Oi.focusStack=Oi.focusStack.filter((function(e){return g.focusStackId!==e})),l){var t=l.activeElement;T||"function"!=typeof(null==e?void 0:e.focus)||!(0,Ye.s)(r.current,t)&&t!==l.body&&!t.shadowRoot||P(e)}})),L=(0,Ai.D)((function(e){if(!h&&g.focusStackId===Oi.focusStack.slice(-1)[0]){var t=(0,ki.w)(e);t&&!(0,Ye.s)(r.current,t)&&(l&&(0,xi.b)(l)===l.body?setTimeout((function(){l&&(0,xi.b)(l)===l.body&&(x(),g.hasFocus=!0)}),0):(x(),g.hasFocus=!0),e.preventDefault(),e.stopPropagation())}}));return a.useEffect((function(){var e=[];return y&&e.push((0,$e.on)(c,"focus",L,!0)),I||e.push((0,$e.on)(c,"click",L,!0)),function(){e.forEach((function(e){return e()}))}}),[y,I,c]),a.useEffect((function(){if(!h&&(d||y)&&r.current){Oi.focusStack.push(g.focusStackId);var e=p.elementToFocusOnDismiss||(0,xi.b)(l);return v||(0,Ye.s)(r.current,e)||x(),function(){return A(e)}}}),[y,h]),a.useEffect((function(){if(!h&&_)return(0,Ut.q)(r.current)}),[h,_,r]),(0,Li.i)((function(){delete g.previouslyFocusedElementInTrapZone})),function(e,t,n){a.useImperativeHandle(e,(function(){return{get previouslyFocusedElement(){return t},focus:n}}),[n,t])}(f,g.previouslyFocusedElementInTrapZone,x),a.createElement("div",(0,F.__assign)({"aria-labelledby":p.ariaLabelledBy},(0,qe.G1)(p,qe.JM),{ref:s,onFocusCapture:function(e){var t;null===(t=p.onFocusCapture)||void 0===t||t.call(p,e),e.target===o.current?k(!0):e.target===i.current&&k(!1),g.hasFocus=!0,e.target!==e.currentTarget&&e.target!==o.current&&e.target!==i.current&&(g.previouslyFocusedElementInTrapZone=(0,ki.w)(e.nativeEvent))},onBlurCapture:function(e){var t;null===(t=p.onBlurCapture)||void 0===t||t.call(p,e);var n=e.relatedTarget;null===e.relatedTarget&&(n=(0,xi.b)(l)),(0,Ye.s)(r.current,n)||(g.hasFocus=!1)}}),a.createElement("div",(0,F.__assign)({},w,{ref:o})),m,a.createElement("div",(0,F.__assign)({},w,{ref:i})))}));Oi.displayName="FocusTrapZone",Oi.focusStack=[];var Ni=c.cs.durationValue2,Ri={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},Fi=(0,De.Z)(),Mi=function(e){function t(t){var n=e.call(this,t)||this;(0,Gn.f)(n);var r=n.props.allowTouchBodyScroll,o=void 0!==r&&r;return n._allowTouchBodyScroll=o,n}return(0,F.__extends)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&(0,et.mh)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&(0,et.fY)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,r=e.theme,o=e.styles,i=(0,qe.G1)(this.props,qe.JM),s=Fi(o,{theme:r,className:n,isDark:t});return a.createElement("div",(0,F.__assign)({},i,{className:s.root}))},t}(a.Component),Bi={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},Ui=(0,Pe.I)(Mi,(function(e){var t,n=e.className,r=e.theme,o=e.isNone,i=e.isDark,a=r.palette,s=(0,c.Km)(Bi,r);return{root:[s.root,r.fonts.medium,{backgroundColor:a.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[c.up]={border:"1px solid WindowText",opacity:0},t)},o&&{visibility:"hidden"},i&&[s.rootDark,{backgroundColor:a.blackTranslucent40}],n]}}),void 0,{scope:"Overlay"}),Hi=(0,Oe.J9)((function(e,t){return{root:(0,c.Zq)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}})),Gi={start:"touchstart",move:"touchmove",stop:"touchend"},zi={start:"mousedown",move:"mousemove",stop:"mouseup"},qi=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=zi,n._events=[],n._onMouseDown=function(e){var t=a.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=zi,n._onDragStart(e)},n._onMouseUp=function(e){var t=a.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=zi,n._onDragStop(e)},n._onTouchStart=function(e){var t=a.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=Gi,n._onDragStart(e)},n._onTouchEnd=function(e){var t=a.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=Gi,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var r=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,r),n.setState({isDragging:!0,lastPosition:t});var o=Xt(n.context);n._events=[(0,$e.on)(o.body,n._currentEventType.move,n._onDrag,!0),(0,$e.on)(o.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var r=n._createUpdatedDragData(n._createDragDataFromPosition(t)),o=r.position;n.props.onDragChange&&n.props.onDragChange(e,r),n.setState({position:o,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var r=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,r),n.props.position&&n.setState({position:n.props.position}),n._events.forEach((function(e){return e()}))}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return(0,F.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach((function(e){return e()}))},t.prototype.render=function(){var e,t=a.Children.only(this.props.children),n=t.props,r=this.props.position,o=(e=this.state).position,i=e.isDragging,s=o.x,l=o.y;return r&&!i&&(s=r.x,l=r.y),a.cloneElement(t,{style:(0,F.__assign)((0,F.__assign)({},n.style),{transform:"translate(".concat(s,"px, ").concat(l,"px)")}),className:Hi(n.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){var n;if(!e||e===(null===(n=Xt(this.context))||void 0===n?void 0:n.body))return!1;var r=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!r&&(r.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t.contextType=qt._0,t}(a.Component),Wi=n(2643);var ji={x:0,y:0},Vi={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},Qi=(0,De.Z)(),Ji=a.forwardRef((function(e,t){var n,r,o,i,s,l=(0,Ge.N)(Vi,e),c=l.allowTouchBodyScroll,u=l.className,d=l.children,p=l.containerClassName,g=l.scrollableContentClassName,m=l.elementToFocusOnDismiss,f=l.firstFocusableSelector,h=l.focusTrapZoneProps,v=l.forceFocusInsideTrap,y=l.disableRestoreFocus,C=void 0===y?l.ignoreExternalFocusing:y,S=l.isBlocking,b=l.isAlert,E=l.isClickableOutsideFocusTrap,T=l.isDarkOverlay,I=l.onDismiss,_=l.layerProps,w=l.overlay,P=l.isOpen,x=l.titleAriaId,k=l.styles,A=l.subtitleAriaId,L=l.theme,D=l.topOffsetFixed,O=l.responsiveMode,N=l.onLayerDidMount,R=l.isModeless,M=l.dragOptions,B=l.onDismissed,U=l.enableAriaHiddenSiblings,H=l.popupProps,G=a.useRef(null),z=a.useRef(null),q=(0,zt.a)(z,null==h?void 0:h.componentRef),W=a.useRef(null),j=(0,zt.a)(G,t),V=Yr(j),Q=(0,Ur.B)("ModalFocusTrapZone",null==h?void 0:h.id),J=(0,qt.ox)(),K=(0,Wi.j)(),X=K.setTimeout,Z=K.clearTimeout,Y=a.useState(P),$=Y[0],ee=Y[1],te=a.useState(P),ne=te[0],re=te[1],oe=a.useState(ji),ie=oe[0],ae=oe[1],se=a.useState(),le=se[0],ce=se[1],ue=function(e){var t=a.useState(e),n=t[0],r=t[1];return[n,{setTrue:(0,Qt.d)((function(){return function(){r(!0)}})),setFalse:(0,Qt.d)((function(){return function(){r(!1)}})),toggle:(0,Qt.d)((function(){return function(){r((function(e){return!e}))}}))}]}(!1),de=ue[0],pe=ue[1],ge=pe.toggle,me=pe.setFalse,fe=(0,Qt.d)((function(){return{onModalCloseTimer:0,allowTouchBodyScroll:c,scrollableContent:null,lastSetCoordinates:ji,events:new wr.g({})}})),he=(M||{}).keepInBounds,ve=null!=b?b:S&&!R,ye=void 0===_?"":_.className,Ce=Qi(k,{theme:L,className:u,containerClassName:p,scrollableContentClassName:g,isOpen:P,isVisible:ne,hasBeenOpened:fe.hasBeenOpened,modalRectangleTop:le,topOffsetFixed:D,isModeless:R,layerClassName:ye,windowInnerHeight:null==J?void 0:J.innerHeight,isDefaultDragHandle:M&&!M.dragHandleSelector}),Se=(0,F.__assign)((0,F.__assign)({eventBubblingEnabled:!1},_),{onLayerDidMount:_&&_.onLayerDidMount?_.onLayerDidMount:N,insertFirst:(null==_?void 0:_.insertFirst)||R,className:Ce.layer}),be=a.useCallback((function(e){e?fe.allowTouchBodyScroll?(0,et.K0)(e,fe.events):(0,et.c8)(e,fe.events):fe.events.off(fe.scrollableContent),fe.scrollableContent=e}),[fe]),Ee=function(){var e=W.current,t=null==e?void 0:e.getBoundingClientRect();t&&(D&&ce(t.top),he&&(fe.minPosition={x:-t.left,y:-t.top},fe.maxPosition={x:t.left,y:t.top}))},Te=a.useCallback((function(e,t){var n=fe.minPosition,r=fe.maxPosition;return he&&n&&r&&(t=Math.max(n[e],t),t=Math.min(r[e],t)),t}),[he,fe]),Ie=function(){var e;fe.lastSetCoordinates=ji,me(),fe.isInKeyboardMoveMode=!1,ee(!1),ae(ji),null===(e=fe.disposeOnKeyUp)||void 0===e||e.call(fe),null==B||B()},_e=a.useCallback((function(){me(),fe.isInKeyboardMoveMode=!1}),[fe,me]),we=a.useCallback((function(e,t){ae((function(e){return{x:Te("x",e.x+t.delta.x),y:Te("y",e.y+t.delta.y)}}))}),[Te]),Pe=a.useCallback((function(){z.current&&z.current.focus()}),[]);a.useEffect((function(){var e;Z(fe.onModalCloseTimer),P&&(requestAnimationFrame((function(){return X(Ee,0)})),ee(!0),M&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===Me.c.space&&(0,Ye.s)(fe.scrollableContent,e.target)&&(ge(),e.preventDefault(),e.stopPropagation())},fe.disposeOnKeyUp||(fe.events.on(J,"keyup",e,!0),fe.disposeOnKeyUp=function(){fe.events.off(J,"keyup",e,!0),fe.disposeOnKeyUp=void 0})),fe.hasBeenOpened=!0,re(!0)),!P&&$&&(fe.onModalCloseTimer=X(Ie,1e3*parseFloat(Ni)),re(!1))}),[$,P]),(0,Li.i)((function(){fe.events.dispose()})),function(e,t){a.useImperativeHandle(e.componentRef,(function(){return{focus:function(){t.current&&t.current.focus()}}}),[t])}(l,z);var xe=a.createElement(Oi,(0,F.__assign)({},h,{id:Q,ref:W,componentRef:q,className:(0,We.A)(Ce.main,null==h?void 0:h.className),elementToFocusOnDismiss:null!==(n=null==h?void 0:h.elementToFocusOnDismiss)&&void 0!==n?n:m,isClickableOutsideFocusTrap:null!==(r=null==h?void 0:h.isClickableOutsideFocusTrap)&&void 0!==r?r:R||E||!S,disableRestoreFocus:null!==(o=null==h?void 0:h.disableRestoreFocus)&&void 0!==o?o:C,forceFocusInsideTrap:(null!==(i=null==h?void 0:h.forceFocusInsideTrap)&&void 0!==i?i:v)&&!R,firstFocusableSelector:(null==h?void 0:h.firstFocusableSelector)||f,focusPreviouslyFocusedInnerElement:null===(s=null==h?void 0:h.focusPreviouslyFocusedInnerElement)||void 0===s||s,onBlur:fe.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==h?void 0:h.onBlur)||void 0===t||t.call(h,e),fe.lastSetCoordinates=ji,fe.isInKeyboardMoveMode=!1,null===(n=fe.disposeOnKeyDown)||void 0===n||n.call(fe)}:void 0}),M&&fe.isInKeyboardMoveMode&&a.createElement("div",{className:Ce.keyboardMoveIconContainer},M.keyboardMoveIconProps?a.createElement($n,(0,F.__assign)({},M.keyboardMoveIconProps)):a.createElement($n,{iconName:"move",className:Ce.keyboardMoveIcon})),a.createElement("div",{ref:be,className:Ce.scrollableContent,"data-is-scrollable":!0},M&&de&&a.createElement(M.menu,{items:[{key:"move",text:M.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===Me.c.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===Me.c.escape;if(de&&t&&me(),!fe.isInKeyboardMoveMode||e.keyCode!==Me.c.escape&&e.keyCode!==Me.c.enter||(fe.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),fe.isInKeyboardMoveMode){var n=!0,r=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t}(e);switch(e.keyCode){case Me.c.escape:ae(fe.lastSetCoordinates);case Me.c.enter:fe.lastSetCoordinates=ji;break;case Me.c.up:ae((function(e){return{x:e.x,y:Te("y",e.y-r)}}));break;case Me.c.down:ae((function(e){return{x:e.x,y:Te("y",e.y+r)}}));break;case Me.c.left:ae((function(e){return{x:Te("x",e.x-r),y:e.y}}));break;case Me.c.right:ae((function(e){return{x:Te("x",e.x+r),y:e.y}}));break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}};fe.lastSetCoordinates=ie,me(),fe.isInKeyboardMoveMode=!0,fe.events.on(J,"keydown",e,!0),fe.disposeOnKeyDown=function(){fe.events.off(J,"keydown",e,!0),fe.disposeOnKeyDown=void 0}}},{key:"close",text:M.closeMenuItemText,onClick:Ie}],onDismiss:me,alignTargetEdge:!0,coverTarget:!0,directionalHint:ke.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:fe.scrollableContent}),d));return $&&V>=(O||zr.small)&&a.createElement(Rn,(0,F.__assign)({ref:j},Se),a.createElement(jt,(0,F.__assign)({role:ve?"alertdialog":"dialog",ariaLabelledBy:x,ariaDescribedBy:A,onDismiss:I,shouldRestoreFocus:!C,enableAriaHiddenSiblings:U,"aria-modal":!R},H),a.createElement("div",{className:Ce.root,role:R?void 0:"document"},!R&&a.createElement(Ui,(0,F.__assign)({"aria-hidden":!0,isDarkThemed:T,onClick:S?void 0:I,allowTouchBodyScroll:c},w)),M?a.createElement(qi,{handleSelector:M.dragHandleSelector||"#".concat(Q),preventDragSelector:"button",onStart:_e,onDragChange:we,onStop:Pe,position:ie},xe):xe)))||null}));Ji.displayName="Modal";var Ki=(0,Pe.I)(Ji,(function(e){var t,n=e.className,r=e.containerClassName,o=e.scrollableContentClassName,i=e.isOpen,a=e.isVisible,s=e.hasBeenOpened,l=e.modalRectangleTop,u=e.theme,d=e.topOffsetFixed,p=e.isModeless,g=e.layerClassName,m=e.isDefaultDragHandle,f=e.windowInnerHeight,h=u.palette,v=u.effects,y=u.fonts,C=(0,c.Km)(Ri,u);return{root:[C.root,y.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity ".concat(Ni)},d&&"number"==typeof l&&s&&{alignItems:"flex-start"},i&&C.isOpen,a&&{opacity:1},a&&!p&&{pointerEvents:"auto"},n],main:[C.main,{boxShadow:v.elevation64,borderRadius:v.roundedCorner2,backgroundColor:h.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:p?c.nA.Layer:void 0},p&&{pointerEvents:"auto"},d&&"number"==typeof l&&s&&{top:l},m&&{cursor:"move"},r],scrollableContent:[C.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:f},t)},o],layer:p&&[g,C.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:y.xLargePlus.fontSize,width:"24px"}}}),void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});Ki.displayName="Modal";var Xi=(0,De.Z)(),Zi=function(e){function t(t){var n=e.call(this,t)||this;return(0,Gn.f)(n),n}return(0,F.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return this._classNames=Xi(n,{theme:r,className:t}),a.createElement("div",{className:this._classNames.actions},a.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return a.Children.map(this.props.children,(function(t){return t?a.createElement("span",{className:e._classNames.action},t):null}))},t}(a.Component),Yi={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},$i=(0,Pe.I)(Zi,(function(e){var t=e.className,n=e.theme,r=(0,c.Km)(Yi,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal",verticalAlign:"middle"}}},t],action:[r.action,{margin:"0 4px"}],actionsRight:[r.actionsRight,{alignItems:"center",display:"flex",fontSize:"0",justifyContent:"flex-end",marginRight:"-4px"}]}}),void 0,{scope:"DialogFooter"});$i.displayName="DialogFooter";var ea=(0,De.Z)(),ta=a.createElement($i,null).type,na=function(e){function t(t){var n=e.call(this,t)||this;return(0,Gn.f)(n),(0,To.A)("DialogContent",t,{titleId:"titleProps.id"}),n}return(0,F.__extends)(t,e),t.prototype.render=function(){var e,t,n,r=(e=this.props).showCloseButton,o=e.className,i=e.closeButtonAriaLabel,s=e.onDismiss,l=e.subTextId,c=e.subText,u=void 0===(t=e.titleProps)?{}:t,d=e.titleId,p=e.title,g=e.type,m=e.styles,f=e.theme,h=e.draggableHeaderClassName,v=ea(m,{theme:f,className:o,isLargeHeader:g===Ti.largeHeader,isClose:g===Ti.close,draggableHeaderClassName:h}),y=this._groupChildren();return c&&(n=a.createElement("p",{className:v.subText,id:l},c)),a.createElement("div",{className:v.content},a.createElement("div",{className:v.header},a.createElement("div",(0,F.__assign)({id:d,role:"heading","aria-level":1},u,{className:(0,We.A)(v.title,u.className)}),p),a.createElement("div",{className:v.topButton},this.props.topButtonsProps.map((function(e,t){return a.createElement(Yo,(0,F.__assign)({key:e.uniqueId||t},e))})),(g===Ti.close||r&&g!==Ti.largeHeader)&&a.createElement(Yo,{className:v.button,iconProps:{iconName:"Cancel"},ariaLabel:i,onClick:s}))),a.createElement("div",{className:v.inner},a.createElement("div",{className:v.innerContent},n,y.contents),y.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return a.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===ta?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=(0,F.__decorate)([Kr],t)}(a.Component),ra={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},oa=(0,Pe.I)(na,(function(e){var t,n,r,o=e.className,i=e.theme,a=e.isLargeHeader,s=e.isClose,l=e.hidden,u=e.isMultiline,d=e.draggableHeaderClassName,p=i.palette,g=i.fonts,m=i.effects,f=i.semanticColors,h=(0,c.Km)(ra,i);return{content:[a&&[h.contentLgHeader,{borderTop:"4px solid ".concat(p.themePrimary)}],s&&h.close,{flexGrow:1,overflowY:"hidden"},o],subText:[h.subText,g.medium,{margin:"0 0 24px 0",color:f.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:c.BO.regular}],header:[h.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&h.close,d&&[d,{cursor:"move"}]],button:[h.button,l&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:f.buttonText,fontSize:c.fF.medium}}}],inner:[h.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: ".concat(c.Ip,"px) and (max-width: ").concat(c.iD,"px)")]={padding:"0 16px 16px"},t)}],innerContent:[h.content,{position:"relative",width:"100%"}],title:[h.title,g.xLarge,{color:f.bodyText,margin:"0",minHeight:g.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: ".concat(c.Ip,"px) and (max-width: ").concat(c.iD,"px)")]={padding:"16px 46px 16px 16px"},n)},a&&{color:f.menuHeader},u&&{fontSize:g.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(r={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:f.buttonText},".ms-Dialog-button:hover":{color:f.buttonTextHovered,borderRadius:m.roundedCorner2}},r["@media (min-width: ".concat(c.Ip,"px) and (max-width: ").concat(c.iD,"px)")]={padding:"15px 8px 0 0"},r)}]}}),void 0,{scope:"DialogContent"});oa.displayName="DialogContent";var ia=(0,De.Z)(),aa={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1,enableAriaHiddenSiblings:!0},sa={type:Ti.normal,className:"",topButtonsProps:[]},la=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e,t=(e=n.props).ariaDescribedById,r=e.modalProps,o=e.dialogContentProps,i=e.subText,a=r&&r.subtitleAriaId||t;return a||(a=(o&&o.subText||i)&&n._defaultSubTextId),a},n._getTitleTextId=function(){var e,t=(e=n.props).ariaLabelledById,r=e.modalProps,o=e.dialogContentProps,i=e.title,a=r&&r.titleAriaId||t;return a||(a=(o&&o.title||i)&&n._defaultTitleTextId),a},n._id=(0,Cr.O)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return(0,F.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,o,i,s,l=this.props,c=l.className,u=l.containerClassName,d=l.contentClassName,p=l.elementToFocusOnDismiss,g=l.firstFocusableSelector,m=l.forceFocusInsideTrap,f=l.styles,h=l.hidden,v=void 0===(e=l.disableRestoreFocus)?l.ignoreExternalFocusing:e,y=l.isBlocking,C=l.isClickableOutsideFocusTrap,S=l.isDarkOverlay,b=void 0===(t=l.isOpen)?!h:t,E=l.onDismiss,T=l.onDismissed,I=l.onLayerDidMount,_=l.responsiveMode,w=l.subText,P=l.theme,x=l.title,k=l.topButtonsProps,A=l.type,L=l.minWidth,D=l.maxWidth,O=l.modalProps,N=(0,F.__assign)({onLayerDidMount:I},null==O?void 0:O.layerProps);(null==O?void 0:O.dragOptions)&&!(null===(n=O.dragOptions)||void 0===n?void 0:n.dragHandleSelector)&&(i="ms-Dialog-draggable-header",(s=(0,F.__assign)({},O.dragOptions)).dragHandleSelector=".".concat(i));var R=(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},aa),{elementToFocusOnDismiss:p,firstFocusableSelector:g,forceFocusInsideTrap:m,disableRestoreFocus:v,isClickableOutsideFocusTrap:C,responsiveMode:_,className:c,containerClassName:u,isBlocking:y,isDarkOverlay:S,onDismissed:T}),O),{dragOptions:s,layerProps:N,isOpen:b}),M=(0,F.__assign)((0,F.__assign)((0,F.__assign)({className:d,subText:w,title:x,topButtonsProps:k,type:A},sa),l.dialogContentProps),{draggableHeaderClassName:i,titleProps:(0,F.__assign)({id:(null===(r=l.dialogContentProps)||void 0===r?void 0:r.titleId)||this._defaultTitleTextId},null===(o=l.dialogContentProps)||void 0===o?void 0:o.titleProps)}),B=ia(f,{theme:P,className:R.className,containerClassName:R.containerClassName,hidden:h,dialogDefaultMinWidth:L,dialogDefaultMaxWidth:D});return a.createElement(Ki,(0,F.__assign)({},R,{className:B.root,containerClassName:B.main,onDismiss:E||R.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),a.createElement(oa,(0,F.__assign)({subTextId:this._defaultSubTextId,showCloseButton:R.isBlocking,onDismiss:E},M),l.children))},t.defaultProps={hidden:!0},t=(0,F.__decorate)([Kr],t)}(a.Component),ca={root:"ms-Dialog"},ua=(0,Pe.I)(la,(function(e){var t,n=e.className,r=e.containerClassName,o=e.dialogDefaultMinWidth,i=void 0===o?"288px":o,a=e.dialogDefaultMaxWidth,s=void 0===a?"340px":a,l=e.hidden,u=e.theme;return{root:[(0,c.Km)(ca,u).root,u.fonts.medium,n],main:[{width:i,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: ".concat(c.O7,"px)")]={width:"auto",maxWidth:s,minWidth:i},t)},!l&&{display:"flex"},r]}}),void 0,{scope:"Dialog"});ua.displayName="Dialog";var da=(0,De.Z)(),pa=function(e,t){a.useImperativeHandle(e.componentRef,(function(){return{focus:function(){t.current&&t.current.focus()}}}),[t])},ga=function(e,t){t.as;var n=t.disabled,r=t.target,o=t.href,i=(t.theme,t.getStyles,t.styles,t.componentRef,t.underline,(0,F.__rest)(t,["as","disabled","target","href","theme","getStyles","styles","componentRef","underline"]));return"string"==typeof e?"a"===e?(0,F.__assign)({target:r,href:n?void 0:o},i):"button"===e?(0,F.__assign)({type:"button",disabled:n},i):(0,F.__assign)((0,F.__assign)({},i),{disabled:n}):(0,F.__assign)({target:r,href:o,disabled:n},i)},ma=a.forwardRef((function(e,t){var n=function(e,t){var n=e.as,r=e.className,o=e.disabled,i=e.href,s=e.onClick,l=e.styles,c=e.theme,u=e.underline,d=a.useRef(null),p=(0,zt.a)(d,t);pa(e,d),(0,je.vk)(d);var g=da(l,{className:r,isButton:!i,isDisabled:o,isUnderlined:u,theme:c}),m=n||(i?"a":"button");return{state:{},slots:{root:m},slotProps:{root:(0,F.__assign)((0,F.__assign)({},ga(m,e)),{"aria-disabled":o,className:g.root,onClick:function(e){o?e.preventDefault():s&&s(e)},ref:p})}}}(e,t),r=n.slots,o=n.slotProps;return a.createElement(r.root,(0,F.__assign)({},o.root))}));ma.displayName="LinkBase";var fa={root:"ms-Link"},ha=(0,Pe.I)(ma,(function(e){var t,n,r,o,i,a,s,l=e.className,u=e.isButton,d=e.isDisabled,p=e.isUnderlined,g=e.theme,m=g.semanticColors,f=m.link,h=m.linkHovered,v=m.disabledText,y=m.focusBorder,C=(0,c.Km)(fa,g);return{root:[C.root,g.fonts.medium,{color:f,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:p?"underline":"none",selectors:(t={},t[".".concat(En.Y2," &:focus, :host(.").concat(En.Y2,") &:focus")]={boxShadow:"0 0 0 1px ".concat(y," inset"),outline:"1px auto ".concat(y),selectors:(n={},n[c.up]={outline:"1px solid WindowText"},n)},t[c.up]={borderBottom:"none"},t)},u&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(r={},r[c.up]={color:"LinkText",forcedColorAdjust:"none"},r)},!u&&{selectors:(o={},o[c.up]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},o)},d&&["is-disabled",{color:v,cursor:"default"},{selectors:(i={"&:link, &:visited":{pointerEvents:"none"}},i[c.up]={color:"GrayText"},i)}],!d&&{selectors:{"&:active, &:hover, &:active:hover":{color:h,textDecoration:"underline",selectors:(a={},a[c.up]={color:"LinkText"},a)},"&:focus":{color:f,selectors:(s={},s[c.up]={color:"LinkText"},s)}}},C.root,l]}}),void 0,{scope:"Link"});var va=(0,Oe.J9)((function(e,t,n){var r=Ko(e),o=Xo(e),i={root:{minWidth:"80px",minHeight:"32px"},label:{fontWeight:c.BO.semibold}};return(0,c.TW)(r,i,n?function(e){var t,n,r,o,i,a,s,l,u,d=e.palette,p=e.semanticColors;return{root:(t={backgroundColor:p.primaryButtonBackground,border:"1px solid ".concat(p.primaryButtonBackground),color:p.primaryButtonText},t[c.up]=(0,F.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,c.Qg)()),t[".".concat(En.Y2," &:focus, :host(.").concat(En.Y2,") &:focus")]={":after":{border:"none",outlineColor:d.white}},t),rootHovered:(n={backgroundColor:p.primaryButtonBackgroundHovered,border:"1px solid ".concat(p.primaryButtonBackgroundHovered),color:p.primaryButtonTextHovered},n[c.up]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},n),rootPressed:(r={backgroundColor:p.primaryButtonBackgroundPressed,border:"1px solid ".concat(p.primaryButtonBackgroundPressed),color:p.primaryButtonTextPressed},r[c.up]=(0,F.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,c.Qg)()),r),rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:(o={color:p.primaryButtonTextDisabled,backgroundColor:p.primaryButtonBackgroundDisabled},o[c.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},o),splitButtonContainer:(i={},i[c.up]={border:"none"},i),splitButtonDivider:(0,F.__assign)((0,F.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(a={backgroundColor:d.white},a[c.up]={backgroundColor:"Window"},a)),splitButtonMenuButton:(s={backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText},s[c.up]={backgroundColor:"Canvas"},s[":hover"]=(l={backgroundColor:p.primaryButtonBackgroundHovered},l[c.up]={color:"Highlight"},l),s),splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,":hover":{backgroundColor:p.primaryButtonBackgroundPressed}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,":hover":{backgroundColor:p.primaryButtonBackgroundPressed}},splitButtonMenuIcon:{color:p.primaryButtonText},splitButtonMenuIconDisabled:(u={color:d.neutralTertiary},u[c.up]={color:"GrayText"},u)}}(e):function(e){var t,n,r,o,i,a=e.semanticColors,s=e.palette,l=a.buttonBackground,u=a.buttonBackgroundPressed,d=a.buttonBackgroundHovered,p=a.buttonBackgroundDisabled,g=a.buttonText,m=a.buttonTextHovered,f=a.buttonTextDisabled,h=a.buttonTextChecked,v=a.buttonTextCheckedHovered;return{root:{backgroundColor:l,color:g},rootHovered:(t={backgroundColor:d,color:m},t[c.up]={borderColor:"Highlight",color:"Highlight"},t),rootPressed:{backgroundColor:u,color:h},rootExpanded:{backgroundColor:u,color:h},rootChecked:{backgroundColor:u,color:h},rootCheckedHovered:{backgroundColor:u,color:v},rootDisabled:(n={color:f,backgroundColor:p},n[c.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},n),splitButtonContainer:(r={},r[c.up]={border:"none"},r),splitButtonMenuButton:{color:s.white,backgroundColor:"transparent",":hover":(o={backgroundColor:s.neutralLight},o[c.up]={color:"Highlight"},o)},splitButtonMenuButtonDisabled:{backgroundColor:a.buttonBackgroundDisabled,":hover":{backgroundColor:a.buttonBackgroundDisabled}},splitButtonDivider:(0,F.__assign)((0,F.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(i={backgroundColor:s.neutralTertiaryAlt},i[c.up]={backgroundColor:"WindowText"},i)),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:s.neutralQuaternaryAlt,":hover":{backgroundColor:s.neutralQuaternaryAlt}},splitButtonMenuButtonExpanded:{backgroundColor:s.neutralQuaternaryAlt,":hover":{backgroundColor:s.neutralQuaternaryAlt}},splitButtonMenuIcon:{color:a.buttonText},splitButtonMenuIconDisabled:{color:a.buttonTextDisabled}}}(e),o,t)})),ya=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,F.__extends)(t,e),t.prototype.render=function(){var e,t,n=void 0!==(t=(e=this.props).primary)&&t,r=e.styles,o=e.theme;return a.createElement(jo,(0,F.__assign)({},this.props,{variantClassName:n?"ms-Button--primary":"ms-Button--default",styles:va(o,r,n),onRenderDescription:Bo.K}))},t=(0,F.__decorate)([(0,Vo.T)("DefaultButton",["theme","styles"],!0)],t)}(a.Component),Ca=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,F.__extends)(t,e),t.prototype.render=function(){return a.createElement(ya,(0,F.__assign)({},this.props,{primary:!0,onRenderDescription:Bo.K}))},t=(0,F.__decorate)([(0,Vo.T)("PrimaryButton",["theme","styles"],!0)],t)}(a.Component);const Sa=(e,t="140px")=>({main:{marginTop:window.innerHeight/3,position:"relative",backgroundColor:e.palette.neutralTertiaryAlt,minHeight:t}}),ba=(e,t=!1)=>({type:Ti.normal,showCloseButton:t,title:e}),Ea=e=>({rootHovered:{backgroundColor:e.palette.white,border:`1px solid ${e.palette.black}`},rootPressed:{backgroundColor:e.palette.white},root:{backgroundColor:e.palette.white,color:e.palette.black,border:`1px solid ${e.palette.themePrimary}`,borderRadius:"2px",height:"26px",whiteSpace:"nowrap",marginBottom:"8px",":hover":{border:`1px solid ${e.palette.black}`}},label:{fontSize:"12px",fontWeight:c.BO.semibold,textAlign:"center"},labelHovered:{color:e.palette.black}}),Ta=e=>({rootHovered:{backgroundColor:e.palette.themePrimary,outlineColor:e.palette.black,border:`1px solid ${e.palette.black}`},rootPressed:{backgroundColor:e.palette.themePrimary},labelHovered:{color:"white"},root:{backgroundColor:e.palette.themePrimary,color:"white",border:`1px solid ${e.palette.themePrimary}`,borderRadius:"2px",height:"26px",whiteSpace:"nowrap",marginBottom:"8px",selectors:{":focus":{outline:"1px solid",outlineColor:e.palette.themePrimary}}}}),Ia=e=>({color:e.palette.themePrimary,fontSize:"12px",textDecoration:"underline"}),_a=()=>{const e={moveMenuItemText:"Move",closeMenuItemText:"CloseLabel",menu:So};return{isBlocking:!0,styles:{root:wa()},dragOptions:e}},wa=()=>({position:"initial"}),Pa=e=>{const t=xa("12px",e.palette.neutralQuaternaryAlt),n={root:{marginTop:"12px",paddingTop:"0px",whiteSpace:"pre-wrap",color:e.palette.neutralQuaternaryAlt}};return(0,c.TW)(t,n)},xa=(e,t)=>{const n=ka(e,t),r={root:{fontWeight:c.BO.regular}};return(0,c.TW)(n,r)},ka=(e,t)=>({root:{fontSize:e,color:t}}),Aa=e=>{const t=Pa(e),n={root:{fontWeight:"bold",color:e.palette.black}};return{root:(0,c.Zq)(t.root,n.root)}},La=e=>e?ne()?OfficeaicopilotStrings.MicrophonPermissionErrorTitleWin32:"Oops, unable to capture your audio":ne()?OfficeaicopilotStrings.MicrophonPermissionErrorTitle:"No Microphone Permission",Da=e=>e?ne()?OfficeaicopilotStrings.MicrophonPermissionErrorTextWin32:"There is a problem with your microphone. Please check your microphone permission settings.":ne()?OfficeaicopilotStrings.MicrophonPermissionErrorText:"Copilot can't access your microphone. Click the lock icon in the browser address bar above, set your permissions to allow microphone access, and then try again.",Oa=({micPermissionErrorImage:e,shouldShowMicPermissionRetryDialog:t,isWin32:n,tryAgainOnClickHandler:r,notNowOnClickHandler:o})=>{const i=ee(),s=a.createElement(wi,{styles:Aa(i)},La(n));return a.createElement(ua,{dialogContentProps:ba(s),modalProps:_a(),hidden:!t,styles:Sa(i)},a.createElement(Vn,{alt:"",src:e,width:"252px",height:"51px"}),a.createElement(wi,{styles:Pa(i)},Da(n)),a.createElement(ha,{style:Ia(i),target:"_blank",href:"https://support.microsoft.com/en-us/office/troubleshoot-dictation-issues-in-microsoft-365-for-the-web-5e69be5f-4357-43f0-a99a-ed903443cd9b"},ne()?OfficeaicopilotStrings.NeedHelpLink:"Need Help?"),a.createElement($i,null,a.createElement(Ca,{id:"MicPermissionNotNowButtonID",text:ne()?OfficeaicopilotStrings.NotNowMicrophoneButton:"Not Now",onClick:o,styles:Ea(i)}),a.createElement(Ca,{id:"MicPermissionTryAgainButtonID",text:ne()?OfficeaicopilotStrings.TryAgainMicrophoneButton:"Try Again",onClick:r,styles:Ta(i)})))};var Na=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};(0,c.K1)({icons:{microphoneButtonIcon:a.createElement((()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{id:"microphoneOutline",d:"M10 13C11.6569 13 13 11.6569 13 10V5.00002C13 3.34316 11.6569 2.00002 10 2.00002C8.34315 2.00002 7 3.34316 7 5.00001V10C7 11.6569 8.34315 13 10 13ZM10 12C8.89543 12 8 11.1046 8 10V5.00001C8 3.89545 8.89543 3.00001 10 3.00002C11.1046 3.00002 12 3.89545 12 5.00002V10C12 11.1046 11.1046 12 10 12ZM5 9.5C5.27614 9.5 5.5 9.72386 5.5 10C5.5 12.4853 7.51472 14.5 10 14.5C12.4853 14.5 14.5 12.4853 14.5 10C14.5 9.72386 14.7239 9.5 15 9.5C15.2761 9.5 15.5 9.72386 15.5 10C15.5 12.869 13.3033 15.225 10.5 15.4776V17.5C10.5 17.7761 10.2761 18 10 18C9.72386 18 9.5 17.7761 9.5 17.5V15.4776C6.69675 15.225 4.5 12.869 4.5 10C4.5 9.72386 4.72386 9.5 5 9.5Z",fill:"#424242"}),a.createElement("path",{id:"microphoneFilled",d:"M5.5 10C5.5 9.72386 5.27614 9.5 5 9.5C4.72386 9.5 4.5 9.72386 4.5 10C4.5 12.869 6.69675 15.225 9.5 15.4776V17.5C9.5 17.7761 9.72386 18 10 18C10.2761 18 10.5 17.7761 10.5 17.5V15.4776C13.3033 15.225 15.5 12.869 15.5 10C15.5 9.72386 15.2761 9.5 15 9.5C14.7239 9.5 14.5 9.72386 14.5 10C14.5 12.4853 12.4853 14.5 10 14.5C7.51472 14.5 5.5 12.4853 5.5 10ZM13 10.0008C12.9996 11.6573 11.6566 13 10 13C8.34315 13 7 11.6569 7 10V5.00002C7 3.34316 8.34315 2.00002 10 2.00002C11.6569 2.00002 13 3.34316 13 5.00002V10.0008Z",fill:"transparent"}))),null),microphoneButtonSolidIcon:a.createElement((()=>a.createElement("svg",{width:"12",height:"16",viewBox:"0 0 12 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M1.5 8C1.5 7.72386 1.27614 7.5 1 7.5C0.723858 7.5 0.5 7.72386 0.5 8C0.5 10.869 2.69675 13.225 5.5 13.4776V15.5C5.5 15.7761 5.72386 16 6 16C6.27614 16 6.5 15.7761 6.5 15.5V13.4776C9.30325 13.225 11.5 10.869 11.5 8C11.5 7.72386 11.2761 7.5 11 7.5C10.7239 7.5 10.5 7.72386 10.5 8C10.5 10.4853 8.48528 12.5 6 12.5C3.51472 12.5 1.5 10.4853 1.5 8ZM9 8.00076C8.99959 9.65727 7.6566 11 6 11C4.34315 11 3 9.65685 3 8V3.00002C3 1.34316 4.34315 1.52588e-05 6 1.52588e-05C7.65686 1.52588e-05 9 1.34316 9 3.00002V8.00076Z",fill:"white"}))),null)}});const Ra=({title:e,isDisabled:t,isMicrophoneListening:n,microphoneState:r,handleMicrophoneButtonOnClick:o,micPermissionRetryDialogProps:i})=>{const[s,l]=(0,a.useState)(!1);(0,a.useEffect)((()=>{n&&l(!1)}),[n]),(0,a.useEffect)((()=>{r==Ci.Loading?l(!0):l(!1)}),[r]);const u=((e,t,n,r)=>(0,c.l8)({root:{backgroundColor:e.palette.neutralLight,backgroundPosition:"center",borderRadius:"8px",border:e.palette.neutralLight,backgroundRepeat:"no-repeat",marginRight:"8px",width:"32px",height:"32px","svg > path#microphoneOutline":{fill:e.palette.neutralPrimary},selectors:{":hover":{cursor:"pointer",backgroundColor:e.palette.neutralTertiaryAlt,"svg > path#microphoneOutline":{fill:"transparent"},"svg > path#microphoneFilled":{fill:e.palette.themePrimary}}}},loader:{}},t?Si(e):{},n?bi(e):{},r?Ei(e):{}))(ee(),n,t,s);return a.createElement(a.Fragment,null,a.createElement(Yo,{className:u.root,title:e,"aria-label":e,iconProps:{iconName:n||s?"microphoneButtonSolidIcon":"microphoneButtonIcon"},onClick:()=>Na(void 0,void 0,void 0,(function*(){o(event)})),disabled:t},s&&a.createElement("div",{className:u.loader})),a.createElement(Oa,{micPermissionErrorImage:i.micPermissionErrorImage,shouldShowMicPermissionRetryDialog:i.shouldShowMicPermissionRetryDialog,isWin32:i.isWin32,tryAgainOnClickHandler:i.tryAgainOnClickHandler,notNowOnClickHandler:i.notNowOnClickHandler}))};var Fa=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};a.forwardRef((({isDisabled:e,styles:t={},chatInputTabIndex:n=0,chatInputContainerTabIndex:r=-1,chatInputContainerTitle:o=di(),placeholderText:i=mi(),maxInputCharLimit:s=300,handleKeyDown:l,handleKeyUp:c,handleOnPaste:u,handleOnBeforeInput:d,handleOnInput:p,submitButtonTitle:g=gi(),handleSubmitButtonClick:m,isMenuButtonEnabled:f=!1,shouldOpenMenuOnEmptyInput:h=!1,menuButtonTitle:v=pi(),handleMenuButtonClick:y,handleOnOpenMenu:C,getContextualMenuHandlerProps:S,handleOnChatInputControlMount:b,handleOnChatInputControlUnmount:E,handleOnBlur:T,microphoneButtonTitle:I=vi(),isVoiceCopilotEnabled:_=!1,handleMicrophoneButtonOnClick:w,isMicrophoneListening:P,microphoneState:x,micPermissionRetryDialogProps:k,SetMicrophoneState:A},L)=>{const D=(0,a.useRef)(),O=(0,a.useRef)(),N=(0,a.useRef)(!1);let R=S();(0,a.useImperativeHandle)(L,(()=>({setInputText:e=>{var t;null===(t=D.current)||void 0===t||t.setInputText(e)},getInputText:()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:e=>{q(e)},getGhostText:()=>H(),setFocus:()=>{var e;null===(e=D.current)||void 0===e||e.setFocus()},closeMenu:()=>{f&&F&&M(!1)}})));const[F,M]=(0,a.useState)(!1),[B,U]=(0,a.useState)(!0),H=()=>se()?z():G(),G=()=>{let e=fi;const t=O.current;return t&&(e=t.innerText),e},z=()=>{var e;return null===(e=D.current)||void 0===e?void 0:e.getGhostText()},q=(0,a.useCallback)((e=>{se()?j(e):W(e)}),[]),W=e=>{const t=O.current;t&&(t.innerText=e)},j=e=>{var t;null===(t=D.current)||void 0===t||t.setGhostText(e)},V=()=>Fa(void 0,void 0,void 0,(function*(){y&&y(),F?M(!1):(C&&(yield C()),M(!0))}));(0,a.useEffect)((()=>{q(i)}),[i,q]);const Q=li(ee(),e,t,P),J={styles:{root:{visibility:"visible",height:"fit-content"}}};return a.createElement("div",null,f&&F&&a.createElement(So,Object.assign({},(R=S(),{items:R.items,hidden:!F||e,shouldFocusOnMount:!0,isBeakVisible:!1,target:`#${hi}`,className:Q.contextualMenu,useTargetAsMinWidth:!0,gapSpace:1,calloutProps:{layerProps:J},onMenuOpened:()=>{var e;null===(e=R.onMenuOpened)||void 0===e||e.call(R)},onDismiss:e=>{var t;se()||(M(!1),null===(t=R.onDismiss)||void 0===t||t.call(R,e))},onItemClick:(e,t)=>{var n;return M(!1),null===(n=R.onItemClick)||void 0===n||n.call(R,t),!0},onMenuDismissed:()=>{var e;null===(e=R.onMenuDismissed)||void 0===e||e.call(R)},onRestoreFocus:e=>{var t;null===(t=R.onRestoreFocus)||void 0===t||t.call(R,e)}}))),a.createElement("div",{id:hi,className:Q.chatInput,title:o,tabIndex:r,onClick:()=>Fa(void 0,void 0,void 0,(function*(){var t,n,r;e||document.activeElement===(null===(t=D.current)||void 0===t?void 0:t.getInputSpanElement())&&!F||N.current?N.current=!1:(N.current=!1,h&&f&&(null===(n=D.current)||void 0===n?void 0:n.getInputText())==fi&&!F?(C&&(yield C()),M(!0)):F&&M(!1),null===(r=D.current)||void 0===r||r.setFocus())}))},a.createElement("div",{className:Q.chatInputContainer},a.createElement(yi,{ref:D,styles:t,placeholderText:i,chatInputTabIndex:n,isDisabled:e,handleKeyDown:e=>{var t,n,r;l&&!l(e)||(se()&&("Backspace"===e.key?U((null===(t=D.current)||void 0===t?void 0:t.getInputText().length)<=1):U(!1)),"Enter"===e.key&&(e.preventDefault(),m(null===(n=D.current)||void 0===n?void 0:n.getInputText()),null===(r=D.current)||void 0===r||r.setInputText(fi),q(i)))},handleKeyUp:e=>{var t;c&&!c(e)||((null===(t=D.current)||void 0===t?void 0:t.getInputText())===fi?q(i):H()===i&&q(fi))},handleOnPaste:e=>{var t;if(u&&!u(e))return;q(fi);const n=e.clipboardData.getData("Text");e.preventDefault();const r=n.length||0,o=null===(t=D.current)||void 0===t?void 0:t.getInputText(),i=window.getSelection();if(!i.rangeCount)return;const a=i.toString(),l=o.length-a.length,c=n.substring(0,s-l);i.deleteFromDocument(),l+r>=s?i.getRangeAt(0).insertNode(document.createTextNode(c)):i.getRangeAt(0).insertNode(document.createTextNode(n)),i.collapseToEnd()},handleOnBeforeInput:e=>{d&&!d(e)||(M(!1),q(fi))},handleOnInput:e=>{!p||p(e)},handleOnChatInputControlMount:b,handleOnChatInputControlUnmount:E}),!se()&&a.createElement("span",{role:"textbox",ref:O,className:Q.ghostInput}),a.createElement("span",{"aria-hidden":!0},"")),a.createElement(No,{className:Q.chatInputButtons},a.createElement("div",{className:Q.chatInputLeftButtons},f&&a.createElement(ti,{title:v,isDisabled:e||0===R.items.length,isMenuOpen:F,handleClick:()=>Fa(void 0,void 0,void 0,(function*(){F||(N.current=!0),se()?setTimeout((()=>Fa(void 0,void 0,void 0,(function*(){V()}))),200):V()}))})),a.createElement("div",{className:Q.chatInputRightButtons},_&&a.createElement("div",{"aria-live":"assertive",role:"alert",title:(()=>{switch(x){case Ci.Enabled:return P?"Microphone Listening":"Microphone Paused";case Ci.Disabled:case Ci.Uninitialized:return"Microphone Disabled";case Ci.Loading:return"Microphone Loading"}return""})()},a.createElement(Ra,{title:I,isDisabled:e,isMicrophoneListening:P,microphoneState:x,handleMicrophoneButtonOnClick:w,micPermissionRetryDialogProps:k})),a.createElement(oi,{title:g,isDisabled:e,handleClick:e=>{var t,n;e.stopPropagation();const r=null===(t=D.current)||void 0===t?void 0:t.getInputText();r.trimStart()!==fi&&(m(r),null===(n=D.current)||void 0===n||n.setInputText(fi),q(i))},handleKeyDown:e=>{"Tab"===e.key&&P&&A&&A(!1)},isInputEmpty:B})))))}));var Ma;!function(e){e.RestShy="RestShy",e.Expanded="Expanded"}(Ma||(Ma={}));var Ba;!function(e){e[e.TEXT=0]="TEXT",e[e.BULLETED_LIST=1]="BULLETED_LIST"}(Ba||(Ba={}));n(58651);const Ua=(()=>{const e={},t=[];return{register:n=>(n&&t.push(n),e),unregister:e=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},updateFeedbackObject:n=>{Object.assign(e,n),t.forEach((t=>t(e)))}}})();Ua.updateFeedbackObject;var Ha,Ga,za,qa,Wa,ja,Va,Qa,Ja,Ka;!function(e){e.DropDown="DropDown",e.MultiSelect="MultiSelect",e.Rating="Rating",e.SingleSelect="SingleSelect"}(Ha||(Ha={})),function(e){e.QuestionNotRequired="QuestionNotRequired",e.CommentNotRequired="CommentNotRequired",e.CommentRequiredWithLastOption="CommentRequiredWithLastOption"}(Ga||(Ga={})),function(e){e.FeatureArea="FeatureArea",e.ResponsibleAI="ResponsibleAI",e.Experience="Experience",e.ProductSatisfaction="ProductSatisfaction",e.CrashImpact="CrashImpact",e.Custom="Custom",e.AIThumbsDown="AIThumbsDown"}(za||(za={})),function(e){e.Smile="Smile",e.Frown="Frown",e.Idea="Idea",e.Unclassified="Unclassified"}(qa||(qa={})),function(e){e.Undefined="Undefined",e.MinorWithoutParentalConsent="MinorWithoutParentalConsent",e.MinorWithParentalConsent="MinorWithParentalConsent",e.NotAdult="NotAdult",e.Adult="Adult",e.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired"}(Wa||(Wa={})),function(e){e.MSA="MSA",e.AAD="AAD",e.Unauthenticated="Unauthenticated"}(ja||(ja={})),function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.NotConfigured="Not Configured"}(Va||(Va={})),function(e){e.JPEG="jpeg",e.PNG="png"}(Qa||(Qa={})),function(e){e.AutoCapture="AutoCapture",e.AutoCaptureWithHtml2Canvas="AutoCaptureWithHtml2Canvas",e.ProvidedAtInitialization="ProvidedAtInitialization",e.DynamicallyProvided="DynamicallyProvided"}(Ja||(Ja={})),function(e){e.SidePane="SidePane",e.Modal="Modal",e.NoSurface="NoSurface",e.CallOut="CallOut"}(Ka||(Ka={}));n(58651);var Xa=n(91108),Za=n(3471);const Ya={root:{paddingTop:"5px",backgroundColor:"transparent",marginBottom:"5px",marginTop:"auto"},elementStack:Object.assign({verticalAlign:"end"},Xa.Pt.gap("10px")),chatCardsStack:Object.assign(Object.assign({verticalAlign:"end"},Xa.Pt.padding("0px","20px","0px","15px")),Xa.Pt.gap("10px"))};(0,Za.n)(Ya),(0,Za.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}});var $a;!function(e){e.None="None",e.Header="Header",e.Footer="Footer"}($a||($a={}));var es=n(96590),ts=n(69532),ns=n(43338),rs=n(91050);const os=Object.assign(Object.assign({},ns.o),{themePrimary:"#C43E1C",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#F6DBD4",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",themeMedium:"#EDBCB0",neutralPrimary:"#242424",neutralLight:"#FFFFFF",neutralLighter:"#EDEBE9",neutralLighterAlt:"#D1D1D1",neutralSecondary:"#616161",neutralSecondaryAlt:"#707070",neutralTertiary:"#F0F0F0",neutralTertiaryAlt:"#F2F2F2",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#424242",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#C43E1C",black:"#000000"}),is=(Object.assign(Object.assign({},rs.C),{themePrimary:"#CA5010",themeSecondary:"#FF5C39",themeDark:"#DB2A82",themeDarker:"#D67540",themeTertiary:"#B1470E",themeLight:"#6E220F",themeDarkAlt:"#C43E1C",themeLighter:"#F558A6",themeLighterAlt:"#FFB700",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondary:"#616161",neutralSecondaryAlt:"#999999",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternary:"#BDBDBD",neutralQuaternaryAlt:"#FFFFFF",neutralPrimaryAlt:"#E0E0E0",neutralDark:"#CA5010",black:"#FFFFFF"}),(0,es.Q)(os)),as={buttonBarRoot:{width:"100%",columnGap:"8px",flexDirection:"row",marginTop:"12px"},primaryButton:Object.assign(Object.assign(Object.assign({backgroundColor:is.themePrimary},Xa.Pt.border("1px","solid",is.themePrimary)),Xa.Pt.borderRadius(is.borderRadiusMedium)),{"&:hover":Object.assign({backgroundColor:is.themePrimary},Xa.Pt.border("1px","solid",is.themePrimary)),"&:active":Object.assign({backgroundColor:is.themePrimary},Xa.Pt.border("1px","solid",is.themePrimary)),"&:disabled":Object.assign({backgroundColor:is.themePrimary},Xa.Pt.border("1px","solid",is.themePrimary))}),defaultButton:Object.assign(Object.assign({backgroundColor:is.neutralLight},Xa.Pt.border("1px","solid",is.neutralLighterAlt)),Xa.Pt.borderRadius(is.borderRadiusMedium)),icon:Object.assign(Object.assign({height:"24px",width:"24px"},Xa.Pt.padding(0)),{"& svg":{height:"20px",width:"20px"}}),combinedButtonIcon:Object.assign(Object.assign({height:"16px",width:"16px"},Xa.Pt.padding(0)),{"& svg":{height:"16px",width:"16px"}}),iconButton:Object.assign({height:"24px",width:"24px",minWidth:"20px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},Xa.Pt.padding("2px")),combinedButton:Object.assign(Object.assign({height:"24px",minWidth:"20px"},Xa.Pt.padding("4px","8px")),ts.g.caption1),minifiedButton:{height:"40px",width:"44px",minWidth:"44px","& svg":{height:"24px",width:"24px"}}},ss=((0,Za.n)(as),(0,Za.n)({emptyIcon:{height:"0px",width:"0px"}}),(0,es.Q)(os)),ls={footerBar:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},headerBar:Object.assign({},Xa.Pt.padding("0px","4px")),feedbackText:Object.assign(Object.assign({},ts.g.caption2),{color:ss.neutralSecondaryAlt}),feedbackTextMinified:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Xa.Pt.border("1px","solid",ss.neutralPrimaryAlt)),Xa.Pt.borderRadius("12px")),Xa.Pt.padding("4px","8px")),ts.g.caption1),{color:ss.neutralSecondaryAlt}),feedbackButtonsStack:Object.assign({alignItems:"center"},Xa.Pt.gap("2px")),feedbackButton:{backgroundColor:"transparent","&:hover":{cursor:"pointer","& svg > path":{fill:ss.themePrimary}}}},cs=((0,Za.n)(ls),(0,es.Q)(os)),us=((0,c.i7)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),Object.assign(Object.assign({defaultRoot:Object.assign(Object.assign(Object.assign(Object.assign({},Xa.Pt.borderRadius("8px")),Xa.Pt.padding("12px")),Xa.Pt.gap("4px")),{alignItems:"flex-start",zIndex:"1",overflowWrap:"anywhere"}),loader:{},human:{alignSelf:"flex-end",color:cs.black,backgroundColor:cs.themeLight,maxWidth:"70%"},chat:{width:"100%",alignSelf:"flex-start",backgroundColor:cs.neutralLight,boxShadow:cs.shadow2},text:Object.assign({},ts.g.body1),strikeThroughText:{textDecorationLine:"line-through"},cardHighContrast:Object.assign({},Xa.Pt.border("1px","solid",cs.neutralLighterAlt))},as),ls)),ds=()=>us,ps=((0,Za.n)(us),()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M9.14645 2.64645C9.34171 2.45118 9.65829 2.45118 9.85355 2.64645L11.3536 4.14645C11.5488 4.34171 11.5488 4.65829 11.3536 4.85355L9.85355 6.35355C9.65829 6.54882 9.34171 6.54882 9.14645 6.35355C8.95118 6.15829 8.95118 5.84171 9.14645 5.64645L9.7885 5.00439C7.12517 5.11522 5 7.30943 5 10C5 11.568 5.72118 12.9672 6.85185 13.8847C7.06627 14.0587 7.09904 14.3736 6.92503 14.588C6.75103 14.8024 6.43615 14.8352 6.22172 14.6612C4.86712 13.5619 4 11.882 4 10C4 6.75447 6.57689 4.1108 9.79629 4.00339L9.14645 3.35355C8.95118 3.15829 8.95118 2.84171 9.14645 2.64645ZM13.075 5.41199C13.249 5.19756 13.5639 5.1648 13.7783 5.3388C15.1329 6.43806 16 8.11795 16 10C16 13.2455 13.4231 15.8892 10.2037 15.9966L10.8536 16.6464C11.0488 16.8417 11.0488 17.1583 10.8536 17.3536C10.6583 17.5488 10.3417 17.5488 10.1464 17.3536L8.64645 15.8536C8.55268 15.7598 8.5 15.6326 8.5 15.5C8.5 15.3674 8.55268 15.2402 8.64645 15.1464L10.1464 13.6464C10.3417 13.4512 10.6583 13.4512 10.8536 13.6464C11.0488 13.8417 11.0488 14.1583 10.8536 14.3536L10.2115 14.9956C12.8748 14.8848 15 12.6906 15 10C15 8.43201 14.2788 7.03283 13.1482 6.1153C12.9337 5.94129 12.901 5.62641 13.075 5.41199Z",fill:"#242424"}))),gs=()=>a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.8639 3.65609C14.0533 3.85704 14.0439 4.17348 13.8429 4.36288L5.91309 11.8368C5.67573 12.0605 5.30311 12.0536 5.07417 11.8213L2.39384 9.10093C2.20003 8.90422 2.20237 8.58765 2.39907 8.39384C2.59578 8.20003 2.91235 8.20237 3.10616 8.39908L5.51192 10.8407L13.1571 3.63517C13.358 3.44577 13.6745 3.45513 13.8639 3.65609Z",fill:"white"})),ms=e=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M5.00098 4.5C5.00098 4.22386 5.22483 4 5.50098 4C5.77712 4 6.00098 4.22386 6.00098 4.5V8.34262L9.17202 5.17157C10.7341 3.60948 13.2668 3.60948 14.8289 5.17157C16.391 6.73367 16.391 9.26633 14.8289 10.8284L9.80375 15.8536C9.60849 16.0488 9.2919 16.0488 9.09664 15.8536C8.90138 15.6583 8.90138 15.3417 9.09664 15.1464L14.1218 10.1213C15.2933 8.94975 15.2933 7.05025 14.1218 5.87868C12.9502 4.70711 11.0507 4.70711 9.87913 5.87868L6.75781 9H10.501C10.7771 9 11.001 9.22386 11.001 9.5C11.001 9.77614 10.7771 10 10.501 10H5.60098C5.26961 10 5.00098 9.73137 5.00098 9.4V4.5Z",fill:e.fill})),fs=()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M10 2.5C10 2.22386 9.77614 2 9.5 2C9.22386 2 9 2.22386 9 2.5V9H2.5C2.22386 9 2 9.22386 2 9.5C2 9.77614 2.22386 10 2.5 10H9V16.5C9 16.7761 9.22386 17 9.5 17C9.77614 17 10 16.7761 10 16.5V10H16.5C16.7761 10 17 9.77614 17 9.5C17 9.22386 16.7761 9 16.5 9H10V2.5Z",fill:"white"})),hs=()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M5.5028 4.62704L5.5 6.75V17.2542C5.5 19.0491 6.95507 20.5042 8.75 20.5042L17.3663 20.5045C17.0573 21.3782 16.224 22.0042 15.2444 22.0042H8.75C6.12665 22.0042 4 19.8776 4 17.2542V6.75C4 5.76929 4.62745 4.93512 5.5028 4.62704ZM17.75 2C18.9926 2 20 3.00736 20 4.25V17.25C20 18.4926 18.9926 19.5 17.75 19.5H8.75C7.50736 19.5 6.5 18.4926 6.5 17.25V4.25C6.5 3.00736 7.50736 2 8.75 2H17.75ZM17.75 3.5H8.75C8.33579 3.5 8 3.83579 8 4.25V17.25C8 17.6642 8.33579 18 8.75 18H17.75C18.1642 18 18.5 17.6642 18.5 17.25V4.25C18.5 3.83579 18.1642 3.5 17.75 3.5Z",fill:"#242424"})),vs=e=>{var t;const n=ee();return a.createElement("svg",{width:"12",height:"14",viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.05198 16.7057C8.39129 17.683 9.68406 18.1333 10.4829 17.2962C10.6455 17.1257 10.8081 16.9416 10.9176 16.7774C11.2379 16.2968 11.3725 15.6641 11.4218 15.0477C11.4721 14.4196 11.438 13.7454 11.3738 13.1352C11.3093 12.5225 11.2129 11.9604 11.1328 11.5522C11.1294 11.5345 11.1259 11.5171 11.1225 11.5H12.006C13.8777 11.5 15.2924 9.80486 14.9576 7.96334L14.2737 4.20164C13.8017 1.60569 11.2078 -0.029048 8.66224 0.665189L3.06251 2.19239C2.14894 2.44154 1.45455 3.18547 1.26885 4.11401L0.915812 5.87918C0.638089 7.2678 1.69991 8.43756 2.82905 8.88388C3.15163 9.01139 3.44337 9.17322 3.66974 9.37403C5.37583 10.8875 5.99442 12.0971 7.05406 14.2231C7.4084 14.9339 7.77205 15.8995 8.05198 16.7057ZM10.0165 11.1214L10.0169 11.1229L10.0187 11.1303L10.0262 11.1614C10.0328 11.1892 10.0426 11.231 10.0549 11.2851C10.0793 11.3933 10.1135 11.5507 10.1515 11.7446C10.2277 12.1333 10.3188 12.665 10.3793 13.2398C10.4401 13.8171 10.4685 14.4242 10.425 14.9679C10.3806 15.5235 10.2652 15.9532 10.0855 16.2227C10.0264 16.3113 9.91385 16.444 9.75942 16.6058C9.56051 16.8142 9.13137 16.7657 8.99666 16.3777C8.71411 15.5639 8.33339 14.5481 7.94904 13.777C6.88216 11.6365 6.19326 10.2759 4.33336 8.62597C3.99304 8.32406 3.58878 8.1089 3.19665 7.9539C2.31631 7.60592 1.75035 6.80549 1.89639 6.0753L2.24943 4.31013C2.36085 3.753 2.77748 3.30665 3.32562 3.15715L8.92536 1.62995C10.9052 1.08999 12.9227 2.36145 13.2898 4.38053L13.9738 8.14223C14.197 9.36991 13.2538 10.5 12.006 10.5H10.5015C10.3476 10.5 10.2022 10.5709 10.1074 10.6923C10.0127 10.8136 9.97921 10.972 10.0165 11.1214C10.0165 11.1214 10.0165 11.1213 10.0165 11.1214Z",fill:n.palette.neutralPrimary}),a.createElement("path",{d:"M10.4829 17.2962C9.68406 18.1333 8.39129 17.683 8.05198 16.7057C7.77205 15.8995 7.4084 14.9339 7.05406 14.2231C5.99442 12.0971 5.37583 10.8875 3.66974 9.37403C3.44337 9.17322 3.15163 9.01139 2.82905 8.88388C1.69991 8.43756 0.638089 7.2678 0.915812 5.87918L1.26885 4.11401C1.45455 3.18547 2.14894 2.44154 3.06251 2.19239L8.66224 0.665189C11.2078 -0.0290479 13.8017 1.60569 14.2737 4.20164L14.9576 7.96334C15.2924 9.80486 13.8777 11.5 12.006 11.5H11.1225L11.1328 11.5522C11.2129 11.9604 11.3093 12.5225 11.3738 13.1352C11.438 13.7454 11.4721 14.4195 11.4218 15.0477C11.3725 15.6641 11.2379 16.2968 10.9176 16.7774C10.8081 16.9416 10.6455 17.1257 10.4829 17.2962Z",fill:null!==(t=null==e?void 0:e.fill)&&void 0!==t?t:"transparent"}))},ys=e=>{var t;const n=ee();return a.createElement("svg",{width:"12",height:"14",viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.05198 1.29418C8.39129 0.316883 9.68406 -0.133389 10.4829 0.703737C10.6455 0.874162 10.8081 1.05832 10.9176 1.22254C11.2379 1.70305 11.3725 2.33584 11.4218 2.9522C11.4721 3.58034 11.438 4.25446 11.3738 4.86473C11.3093 5.47735 11.2129 6.03948 11.1328 6.44766C11.1294 6.46535 11.1259 6.48277 11.1225 6.49989H12.006C13.8777 6.49989 15.2924 8.19503 14.9576 10.0365L14.2737 13.7983C13.8017 16.3942 11.2078 18.0289 8.66224 17.3347L3.06251 15.8075C2.14894 15.5583 1.45455 14.8144 1.26885 13.8859L0.915812 12.1207C0.638089 10.7321 1.69991 9.56233 2.82905 9.11601C3.15163 8.9885 3.44337 8.82668 3.66974 8.62586C5.37583 7.11234 5.99442 5.90276 7.05406 3.77684C7.4084 3.06594 7.77205 2.10043 8.05198 1.29418ZM10.0165 6.87851L10.0169 6.87696L10.0187 6.86962L10.0262 6.83852C10.0328 6.81068 10.0426 6.76892 10.0549 6.71482C10.0793 6.60658 10.1135 6.44919 10.1515 6.25525C10.2277 5.86655 10.3188 5.33493 10.3793 4.76005C10.4401 4.18282 10.4685 3.57569 10.425 3.03195C10.3806 2.47644 10.2652 2.04673 10.0855 1.77724C10.0264 1.68859 9.91385 1.55593 9.75942 1.3941C9.56051 1.18565 9.13137 1.23417 8.99666 1.62217C8.71411 2.43598 8.33339 3.45183 7.94904 4.22294C6.88216 6.36338 6.19326 7.72396 4.33336 9.37392C3.99304 9.67583 3.58878 9.89099 3.19665 10.046C2.31631 10.394 1.75035 11.1944 1.89639 11.9246L2.24943 13.6898C2.36085 14.2469 2.77748 14.6932 3.32562 14.8427L8.92536 16.3699C10.9052 16.9099 12.9227 15.6384 13.2898 13.6194L13.9738 9.85766C14.197 8.62998 13.2538 7.49989 12.006 7.49989H10.5015C10.3476 7.49989 10.2022 7.42895 10.1074 7.3076C10.0127 7.18627 9.97921 7.02785 10.0165 6.87851C10.0165 6.87847 10.0165 6.87855 10.0165 6.87851Z",fill:n.palette.neutralPrimary}),a.createElement("path",{d:"M9.92039 0.703737C9.12156 -0.133389 7.82879 0.316883 7.48948 1.29418C7.20955 2.10043 6.8459 3.06594 6.49156 3.77684C5.43192 5.90276 4.81333 7.11234 3.10724 8.62586C2.88087 8.82668 2.58913 8.9885 2.26655 9.11601C1.13741 9.56233 0.075589 10.7321 0.353312 12.1207L0.706346 13.8859C0.892055 14.8144 1.58644 15.5583 2.50001 15.8075L8.09974 17.3347C10.6453 18.0289 13.2392 16.3942 13.7112 13.7983L14.3951 10.0365C14.7299 8.19503 13.3152 6.49989 11.4435 6.49989H10.56L10.5703 6.44766C10.6504 6.03948 10.7468 5.47735 10.8113 4.86473C10.8755 4.25446 10.9096 3.58034 10.8593 2.9522C10.81 2.33584 10.6754 1.70305 10.3551 1.22254C10.2456 1.05832 10.083 0.874161 9.92039 0.703737Z",fill:null!==(t=null==e?void 0:e.fill)&&void 0!==t?t:"transparent"}))},Cs=()=>(0,c.K1)({icons:{KeepItIcon:a.createElement(gs,null),UndoIcon:a.createElement(ms,{fill:$.palette.neutralPrimary}),UndoIconDisabled:a.createElement(ms,{fill:$.palette.neutralQuaternary}),InsertIcon:a.createElement(fs,null),CopyIcon:a.createElement(hs,null),RegenerateIcon:a.createElement(ps,null),ThumbsUpChatCard:a.createElement(ys,null),ThumbsDownChatCard:a.createElement(vs,null)}});(0,Za.n)({item:{height:"auto",width:"auto",flexShrink:1}});Cs();var Ss;!function(e){e.Primary="Primary",e.Default="Default"}(Ss||(Ss={}));Cs();var bs;!function(e){e[e.Default=0]="Default",e[e.LinkEmbedded=1]="LinkEmbedded",e[e.ListEmbedded=2]="ListEmbedded",e[e.ListLinkEmbedded=3]="ListLinkEmbedded",e[e.AccordionCard=4]="AccordionCard",e[e.ContentCard=5]="ContentCard",e[e.ChatCardWrapper=6]="ChatCardWrapper",e[e.FeedbackNudge=7]="FeedbackNudge",e[e.MarkDownCard=8]="MarkDownCard",e[e.StreamingAdaptiveCard=9]="StreamingAdaptiveCard",e[e.WarningMessage=10]="WarningMessage"}(bs||(bs={}));const Es=(0,es.Q)(os),Ts=Object.assign({rootStack:{textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},messageHeader:{},messageFooter:{marginTop:"12px"},listStackStyle:Object.assign(Object.assign({},Xa.Pt.gap("4px")),{marginTop:"12px"}),list:Object.assign(Object.assign({},Xa.Pt.margin("0px")),Xa.Pt.gap("4px")),listHeader:{marginBottom:"12px",fontWeight:600},listFooter:Object.assign({},Xa.Pt.margin("12px","0px","0px")),linkText:Object.assign(Object.assign({},ts.g.body1),{color:Es.themeTertiary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:Es.themeTertiary}}}),linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"}},ds()),Is=((0,Za.n)(Ts),(0,es.Q)(os)),_s={stack:{"> *":{marginBottom:"12px"}},contentCard:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Xa.Pt.border("1px","solid",Is.neutralLighterAlt)),Xa.Pt.margin("8px","20px","8px","15px")),Xa.Pt.padding("8px")),{boxShadow:Is.shadow4}),Xa.Pt.borderRadius(Is.borderRadiusXLarge)),{overflowWrap:"anywhere"}),contentHeader:Object.assign(Object.assign({},ts.g.body1),{marginTop:"8px",marginBottom:"12px"})},ws=((0,Za.n)(_s),(0,es.Q)(os)),Ps=Object.assign({feedbackNudgeRootStack:Object.assign({alignItems:"center"},Xa.Pt.gap("4px")),msInternalContainer:{alignItems:"center",width:"100%"},msInternalHeader:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({height:"16px"},Xa.Pt.borderRadius(ws.borderRadiusXLarge)),{backgroundColor:ws.neutralTertiary}),Xa.Pt.padding("0px","12px")),ts.g.caption2Strong),{display:"flex",justifyContent:"center",alignItems:"center"}),feedbackCardHeader:Object.assign(Object.assign({marginTop:"12px",width:"100%",textAlign:"center"},ts.g.subtitle2),{color:ws.themePrimary}),feedbackCardContent:{marginTop:"12px"},cardIllustration:{}},ds()),xs=((0,Za.n)(Ps),(0,es.Q)(os)),ks=Object.assign({markdownRoot:Object.assign(Object.assign({},ts.g.body1),{color:xs.black,"& pre":{whiteSpace:"pre-wrap"},"& table,tr,td,th":Object.assign({},Xa.Pt.border("1px","solid",xs.neutralQuaternaryAlt))})},ds());(0,Za.n)(ks);Te.AdaptiveCard.onProcessMarkdown=(e,t)=>{t.outputHtml=(new(_e())).render(e),t.didProcess=!0};const As=(0,es.Q)(os),Ls=(0,Za.n)({root:Object.assign(Object.assign(Object.assign({backgroundColor:As.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},Xa.Pt.borderColor(As.neutralLight)),Xa.Pt.borderRadius(As.borderRadiusXLarge)),{marginLeft:"4px",width:"32px",height:"32px","&:hover":{backgroundColor:As.neutralTertiaryAlt}})}),Ds=(0,Za.n)({root:{backgroundColor:As.neutralLighter}}),Os=(0,Za.n)({root:Object.assign(Object.assign({backgroundColor:As.neutralTertiary},Xa.Pt.borderColor(As.neutralQuaternary)),{"&:hover":{backgroundColor:As.neutralTertiary}})}),Ns=(0,Za.n)({root:{"& svg > path":{fill:As.neutralPrimary}}}),Rs=(0,Za.n)({root:{"& svg > defs > linearGradient > stop.gradientPrimary":{stopColor:As.themePrimary},"& svg > defs > linearGradient > stop.gradientSecondary":{stopColor:As.themeSecondary}}}),Fs=(0,Za.n)({root:{"& svg > path":{fill:As.neutralQuaternary}}});var Ms=n(76035),Bs=n(98110),Us=n(82455);var Hs=n(98869),Gs=n(37984);function zs(e,t){const{disabled:n,disabledFocusable:r=!1,"aria-disabled":o,onClick:i,onKeyDown:a,onKeyUp:s,...l}=null!=t?t:{},c="string"==typeof o?"true"===o:o,u=n||r||c,d=(0,Gs.D)((e=>{u?(e.preventDefault(),e.stopPropagation()):null==i||i(e)})),p=(0,Gs.D)((e=>{if(null==a||a(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===Hs.xyI||t===Hs.$xS))return e.preventDefault(),void e.stopPropagation();t!==Hs.$xS?t===Hs.xyI&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()})),g=(0,Gs.D)((e=>{if(null==s||s(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===Hs.xyI||t===Hs.$xS))return e.preventDefault(),void e.stopPropagation();t===Hs.$xS&&(e.preventDefault(),e.currentTarget.click())}));if("button"===e||void 0===e)return{...l,disabled:n&&!r,"aria-disabled":!!r||c,onClick:r?void 0:d,onKeyUp:r?void 0:s,onKeyDown:r?void 0:a};{const t={role:"button",tabIndex:n&&!r?void 0:0,...l,onClick:d,onKeyUp:g,onKeyDown:p,"aria-disabled":n||r||c};return"a"===e&&u&&(t.href=void 0),t}}var qs=n(59534),Ws=n(67083);const js=a.createContext(void 0),Vs={},Qs=(js.Provider,(e,t)=>{const{size:n}=null!==(r=a.useContext(js))&&void 0!==r?r:Vs;var r;const{appearance:o="secondary",as:i="button",disabled:s=!1,disabledFocusable:l=!1,icon:c,iconPosition:u="before",shape:d="rounded",size:p=(null!=n?n:"medium")}=e,g=qs.lq(c,{elementType:"span"});return{appearance:o,disabled:s,disabledFocusable:l,iconPosition:u,shape:d,size:p,iconOnly:Boolean((null==g?void 0:g.children)&&!e.children),components:{root:"button",icon:"span"},root:qs.Gk((0,Ws.g)(i,zs(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"}}),icon:g}});var Js=n(77118),Ks=n(42891);const Xs="fui-Button",Zs="fui-Button__icon",Ys=(0,Js.y)("r1alrhcs",null,{r:[".r1alrhcs{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1alrhcs:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1alrhcs:hover:active{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1alrhcs[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1alrhcs{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1alrhcs:focus{border-color:ButtonText;}.r1alrhcs:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1alrhcs:hover:active{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1alrhcs[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),$s=(0,Js.y)("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]),el=(0,Ks.X)({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",iro3zm:"fwiml72"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",iro3zm:"fnp9lpt",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1d6v5y2",Bsw6fvg:"f1rirnrt",Bjwas2f:"f1uu00uk",Bn1d65q:["fkvaka8","f9a0qzu"],Bxeuatn:"f1ux7til",n51gp8:["f9a0qzu","fkvaka8"],Bbusuzp:"f1lkg8j3",ycbfsm:"fkc42ay",Bqrx1nm:"fq7113v",pgvf35:"ff1wgvm",Bh7lczh:["fiob0tu","f1x4h75k"],dpv3f4:"f1j6scgf",Bpnjhaq:["f1x4h75k","fiob0tu"],ze5xyy:"f4xjyn1",g2kj27:"fbgcvur",Bf756sw:"f1ks1yx8",Bow2dr7:["f1o6qegi","fmxjhhp"],Bvhedfk:"fcnxywj",Gye4lf:["fmxjhhp","f1o6qegi"],pc6evw:"f9ddjv3"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",iro3zm:"fsv2rcd",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1omzyqd",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",x3br3k:"fj8yq94",ze5xyy:"f4xjyn1",Bx3q9su:"f1et0tmh",pc6evw:"f9ddjv3",xd2cci:"f1wi8ngl"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",iro3zm:"fwiml72",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1fg1p5m",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",Bqrx1nm:"f1tme0vf",ze5xyy:"f4xjyn1",g2kj27:"f18onu3q",pc6evw:"f9ddjv3"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fwiml72:hover:active{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".fnp9lpt:hover:active{background-color:var(--colorBrandBackgroundPressed);}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}",".f1d6v5y2:hover:active{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".fsv2rcd:hover:active{background-color:var(--colorSubtleBackgroundPressed);}",".f1omzyqd:hover:active{color:var(--colorNeutralForeground2Pressed);}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}",".fj8yq94:hover:active .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1fg1p5m:hover:active{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1rirnrt{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1uu00uk{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9a0qzu{border-left-color:HighlightText;}.fkvaka8{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ux7til{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lkg8j3{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkc42ay{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fq7113v:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff1wgvm:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1x4h75k:hover{border-left-color:Highlight;}.fiob0tu:hover{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1j6scgf:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbgcvur:hover:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ks1yx8:hover:active{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o6qegi:hover:active{border-right-color:Highlight;}.fmxjhhp:hover:active{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcnxywj:hover:active{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9ddjv3:hover:active{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1et0tmh:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wi8ngl:hover:active .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tme0vf:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18onu3q:hover:active{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),tl=(0,Ks.X)({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",iro3zm:"f1t6o4dc",b661bw:"f10ztigi",Bk6r4ia:["f1ft5sdu","f1gzf82w"],B9zn80p:"f12zbtn2",Bpld233:["f1gzf82w","f1ft5sdu"],B2d53fq:"fcvwxyo",c3iz72:"f8w4c43",em6i61:"f1ol4fw6",vm6p8p:"f1q1lw4e",x3br3k:"f1dwjv2g"},highContrast:{Bsw6fvg:"f4lkoma",Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bbusuzp:"f1dcs8yz",G867l3:"fjwq6ea",gdbnj:["f1lr3nhc","f1mbxvi6"],mxns5l:"fn5gmvv",o3nasb:["f1mbxvi6","f1lr3nhc"],Bqrx1nm:"f1vmkb5g",pgvf35:"f53ppgq",Bh7lczh:["f1663y11","f80fkiy"],dpv3f4:"f18v5270",Bpnjhaq:["f80fkiy","f1663y11"],ze5xyy:"f1kc2mi9",g2kj27:"f1y0svfh",Bf756sw:"fihuait",Bow2dr7:["fnxhupq","fyd6l6x"],Bvhedfk:"fx507ft",Gye4lf:["fyd6l6x","fnxhupq"],pc6evw:"fb3rf2x"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",iro3zm:"f3h1zc4"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1t6o4dc:hover:active{background-color:var(--colorNeutralBackgroundDisabled);}",".f10ztigi:hover:active{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ft5sdu:hover:active{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1gzf82w:hover:active{border-left-color:var(--colorNeutralStrokeDisabled);}",".f12zbtn2:hover:active{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f8w4c43:hover:active{cursor:not-allowed;}",".f1ol4fw6:hover:active .fui-Icon-filled{display:none;}",".f1q1lw4e:hover:active .fui-Icon-regular{display:inline;}",".f1dwjv2g:hover:active .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f3h1zc4:hover:active{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f4lkoma{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjwq6ea:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lr3nhc:focus{border-right-color:GrayText;}.f1mbxvi6:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn5gmvv:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1vmkb5g:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f53ppgq:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1663y11:hover{border-right-color:GrayText;}.f80fkiy:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18v5270:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1y0svfh:hover:active{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fihuait:hover:active{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fnxhupq:hover:active{border-right-color:GrayText;}.fyd6l6x:hover:active{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fx507ft:hover:active{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fb3rf2x:hover:active{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),nl=(0,Ks.X)({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Boium3a:["f12k37oa","fdnykm2"],tm8e47:"fr96u23"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f12k37oa[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fdnykm2[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.fr96u23[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),rl=(0,Ks.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),ol=(0,Ks.X)({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]});var il=n(4988);const al=a.forwardRef(((e,t)=>{const n=Qs(e,t);return(e=>{const t=Ys(),n=$s(),r=el(),o=tl(),i=nl(),a=rl(),s=ol(),{appearance:l,disabled:c,disabledFocusable:u,icon:d,iconOnly:p,iconPosition:g,shape:m,size:f}=e;e.root.className=(0,Ms.z)(Xs,t,l&&r[l],r[f],d&&"small"===f&&r.smallWithIcon,d&&"large"===f&&r.largeWithIcon,r[m],(c||u)&&o.base,(c||u)&&o.highContrast,l&&(c||u)&&o[l],"primary"===l&&i.primary,i[f],i[m],p&&a[f],e.root.className),e.icon&&(e.icon.className=(0,Ms.z)(Zs,n,!!e.root.children&&s[g],s[f],e.icon.className))})(n),(0,il.$e)("useButtonStyles_unstable")(n),(e=>{(0,Us.C)(e);const{iconOnly:t,iconPosition:n}=e;return(0,Bs.FD)(e.root,{children:["after"!==n&&e.icon&&(0,Bs.Y)(e.icon,{}),!t&&e.root.children,"after"===n&&e.icon&&(0,Bs.Y)(e.icon,{})]})})(n)}));al.displayName="Button";const sl={above:{position:"above",align:"center"},"above-start":{position:"above",align:"start"},"above-end":{position:"above",align:"end"},below:{position:"below",align:"center"},"below-start":{position:"below",align:"start"},"below-end":{position:"below",align:"end"},before:{position:"before",align:"center"},"before-top":{position:"before",align:"top"},"before-bottom":{position:"before",align:"bottom"},after:{position:"after",align:"center"},"after-top":{position:"after",align:"top"},"after-bottom":{position:"after",align:"bottom"}};function ll(e){return null==e?{}:"string"==typeof e?sl[e]:e}var cl=n(83777),ul=n(44848),dl=n(76155),pl=n(15333);function gl(e,t,n){const r=a.useRef(!0),[o]=a.useState((()=>({value:e,callback:t,facade:{get current(){return o.value},set current(e){const t=o.value;if(t!==e){if(o.value=e,n&&r.current)return;o.callback(e,t)}}}})));return(0,pl.E)((()=>{r.current=!1}),[]),o.callback=t,o.facade}const ml=e=>{switch(e){case"always":case!0:return{applyMaxWidth:!0,applyMaxHeight:!0};case"width-always":case"width":return{applyMaxWidth:!0,applyMaxHeight:!1};case"height-always":case"height":return{applyMaxWidth:!1,applyMaxHeight:!0};default:return!1}},fl=e=>{const t=e&&(e=>"HTML"===e.nodeName?e:e.parentNode||e.host)(e);if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:n,overflowX:r,overflowY:o}=(e=>{var t;return 1!==e.nodeType?{}:(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView).getComputedStyle(e,null)})(t);return/(auto|scroll|overlay)/.test(n+o+r)?t:fl(t)},hl=e=>{var t;const n=fl(e);return!!n&&n!==(null===(t=n.ownerDocument)||void 0===t?void 0:t.body)},vl=(e,t,n)=>{const r=((e,t)=>{const n="above"===e||"below"===e,r="top"===t||"bottom"===t;return n&&r||!n&&!r})(t,e)?"center":e,o=t&&(e=>({above:"top",below:"bottom",before:e?"right":"left",after:e?"left":"right"}))(n)[t],i=r&&{start:"start",end:"end",top:"start",bottom:"end",center:void 0}[r];return o&&i?`${o}-${i}`:o};function yl(e,t){if("window"===t)return null==e?void 0:e.ownerDocument.documentElement;if("clippingParents"===t)return"clippingAncestors";if("scrollParent"===t){let t=fl(e);return"BODY"===t.nodeName&&(t=null==e?void 0:e.ownerDocument.documentElement),t}return t}const Cl=e=>({name:"resetMaxSize",fn({middlewareData:t,elements:n}){var r;if(null===(r=t.resetMaxSize)||void 0===r?void 0:r.maxSizeAlreadyReset)return{};const{applyMaxWidth:o,applyMaxHeight:i}=e;return o&&(n.floating.style.removeProperty("box-sizing"),n.floating.style.removeProperty("max-width"),n.floating.style.removeProperty("width")),i&&(n.floating.style.removeProperty("box-sizing"),n.floating.style.removeProperty("max-height"),n.floating.style.removeProperty("height")),{data:{maxSizeAlreadyReset:!0},reset:{rects:!0}}}});function Sl(e,t){const{container:n,overflowBoundary:r}=t;return(0,cl.Ej)({...r&&{altBoundary:!0,boundary:yl(n,r)},apply({availableHeight:t,availableWidth:n,elements:r,rects:o}){const i=(e,t,n)=>{if(e&&(r.floating.style.setProperty("box-sizing","border-box"),r.floating.style.setProperty(`max-${t}`,`${n}px`),o.floating[t]>n)){r.floating.style.setProperty(t,`${n}px`);const e="width"===t?"x":"y";r.floating.style.getPropertyValue(`overflow-${e}`)||r.floating.style.setProperty(`overflow-${e}`,"auto")}},{applyMaxWidth:a,applyMaxHeight:s}=e;i(a,"width",n),i(s,"height",t)}})}function bl(e){const t=e.split("-");return{side:t[0],alignment:t[1]}}const El=e=>{const{side:t,alignment:n}=bl(e),r={top:"above",bottom:"below",right:"after",left:"before"}[t],o=n&&(e=>"above"===e||"below"===e?{start:"start",end:"end"}:{start:"top",end:"bottom"})(r)[n];return{position:r,alignment:o}};function Tl(e){const t=(n=e)?"number"==typeof n||"object"==typeof n?n:({rects:{floating:e,reference:t},placement:r})=>{const{position:o,alignment:i}=El(r);return n({positionedRect:e,targetRect:t,position:o,alignment:i})}:n;var n;return(0,cl.cY)(t)}function Il(){return{name:"coverTarget",fn:e=>{const{placement:t,rects:n,x:r,y:o}=e,i={x:r,y:o};switch(bl(t).side){case"bottom":i.y-=n.reference.height;break;case"top":i.y+=n.reference.height;break;case"left":i.x+=n.reference.width;break;case"right":i.x-=n.reference.width}return i}}}function _l(e){const{hasScrollableElement:t,flipBoundary:n,container:r,fallbackPositions:o=[],isRtl:i}=e,a=o.reduce(((e,t)=>{const{position:n,align:r}=ll(t),o=vl(r,n,i);return o&&e.push(o),e}),[]);return(0,cl.UU)({...t&&{boundary:"clippingAncestors"},...n&&{altBoundary:!0,boundary:yl(r,n)},fallbackStrategy:"bestFit",...a.length&&{fallbackPlacements:a}})}function wl(e,t){if("number"==typeof e)return e;const{start:n,end:r,...o}=e,i=o,a=t?"end":"start",s=t?"start":"end";return e[a]&&(i.left=e[a]),e[s]&&(i.right=e[s]),i}function Pl(e){const{hasScrollableElement:t,disableTether:n,overflowBoundary:r,container:o,overflowBoundaryPadding:i,isRtl:a}=e;return(0,cl.BN)({...t&&{boundary:"clippingAncestors"},...n&&{crossAxis:"all"===n,limiter:(0,cl.ER)({crossAxis:"all"!==n,mainAxis:!1})},...i&&{padding:wl(i,a)},...r&&{altBoundary:!0,boundary:yl(o,r)}})}function xl(){return{name:"intersectionObserver",fn:async e=>{const t=e.rects.floating,n=await(0,cl.__)(e,{altBoundary:!0}),r=n.top<t.height&&n.top>0,o=n.bottom<t.height&&n.bottom>0;return{data:{intersecting:r||o}}}}}var kl=n(50962);const Al="data-popper-is-intersecting",Ll="data-popper-escaped",Dl="data-popper-reference-hidden",Ol="data-popper-placement";var Nl=n(30602);function Rl(e){const t=[];let n=e;for(;n;){const r=fl(n);if(e.ownerDocument.body===r){t.push(r);break}t.push(r),n=r}return t}function Fl(e){const{container:t,target:n,arrow:r,strategy:o,middleware:i,placement:a,useTransform:s=!0}=e;let l=!1;if(!n||!t)return{updatePosition:()=>{},dispose:()=>{}};let c=!0;const u=new Set,d=t.ownerDocument.defaultView;Object.assign(t.style,{position:"fixed",left:0,top:0,margin:0});const p=()=>{l||(c&&(Rl(t).forEach((e=>u.add(e))),(0,Nl.s)(n)&&Rl(n).forEach((e=>u.add(e))),u.forEach((e=>{e.addEventListener("scroll",g,{passive:!0})})),c=!1),Object.assign(t.style,{position:o}),(0,kl.rD)(n,t,{placement:a,middleware:i,strategy:o}).then((({x:e,y:n,middlewareData:i,placement:a})=>{l||(function(e){const{arrow:t,middlewareData:n}=e;if(!n.arrow||!t)return;const{x:r,y:o}=n.arrow;Object.assign(t.style,{left:`${r}px`,top:`${o}px`})}({arrow:r,middlewareData:i}),function(e){var t,n,r;const{container:o,placement:i,middlewareData:a,strategy:s,lowPPI:l,coordinates:c,useTransform:u=!0}=e;if(!o)return;o.setAttribute(Ol,i),o.removeAttribute(Al),a.intersectionObserver.intersecting&&o.setAttribute(Al,""),o.removeAttribute(Ll),(null===(t=a.hide)||void 0===t?void 0:t.escaped)&&o.setAttribute(Ll,""),o.removeAttribute(Dl),(null===(n=a.hide)||void 0===n?void 0:n.referenceHidden)&&o.setAttribute(Dl,"");const d=(null===(r=o.ownerDocument.defaultView)||void 0===r?void 0:r.devicePixelRatio)||1,p=Math.round(c.x*d)/d,g=Math.round(c.y*d)/d;Object.assign(o.style,{position:s}),u?Object.assign(o.style,{transform:l?`translate(${p}px, ${g}px)`:`translate3d(${p}px, ${g}px, 0)`}):Object.assign(o.style,{left:`${p}px`,top:`${g}px`})}({container:t,middlewareData:i,placement:a,coordinates:{x:e,y:n},lowPPI:((null==d?void 0:d.devicePixelRatio)||1)<=1,strategy:o,useTransform:s}))})).catch((e=>{0})))},g=function(e){let t;return()=>(t||(t=new Promise((n=>{Promise.resolve().then((()=>{t=void 0,n(e())}))}))),t)}((()=>p()));return d&&(d.addEventListener("scroll",g,{passive:!0}),d.addEventListener("resize",g)),g(),{updatePosition:g,dispose:()=>{l=!0,d&&(d.removeEventListener("scroll",g),d.removeEventListener("resize",g)),u.forEach((e=>{e.removeEventListener("scroll",g)})),u.clear()}}}function Ml(e){const t=a.useRef(null),n=a.useRef(null),r=a.useRef(null),o=a.useRef(null),i=a.useRef(null),{enabled:s=!0}=e,l=function(e){const{align:t,arrowPadding:n,autoSize:r,coverTarget:o,flipBoundary:i,offset:s,overflowBoundary:l,pinned:c,position:u,unstable_disableTether:d,positionFixed:p,strategy:g,overflowBoundaryPadding:m,fallbackPositions:f,useTransform:h,matchTargetSize:v}=e,{dir:y,targetDocument:C}=(0,ul.Y)(),S="rtl"===y,b=(null!=g?g:p)?"fixed":"absolute",E=ml(r);return a.useCallback(((e,r)=>{const a=hl(e),p=[E&&Cl(E),v&&{name:"matchTargetSize",fn:async e=>{const{rects:{reference:t,floating:n},elements:{floating:r},middlewareData:{matchTargetSize:{matchTargetSizeAttempt:o=!1}={}}}=e;if(t.width===n.width||o)return{};const{width:i}=t;return r.style.width=`${i}px`,r.style.boxSizing="border-box",{data:{matchTargetSizeAttempt:!0},reset:{rects:!0}}}},s&&Tl(s),o&&Il(),!c&&_l({container:e,flipBoundary:i,hasScrollableElement:a,isRtl:S,fallbackPositions:f}),Pl({container:e,hasScrollableElement:a,overflowBoundary:l,disableTether:d,overflowBoundaryPadding:m,isRtl:S}),E&&Sl(E,{container:e,overflowBoundary:l}),xl(),r&&(0,cl.UE)({element:r,padding:n}),(0,cl.jD)({strategy:"referenceHidden"}),(0,cl.jD)({strategy:"escaped"}),!1].filter(Boolean);return{placement:vl(t,u,S),middleware:p,strategy:b,useTransform:h}}),[t,n,E,o,d,i,S,s,l,c,u,b,m,f,h,v,C])}(e),c=a.useCallback((()=>{var e;t.current&&t.current.dispose(),t.current=null;const a=null!==(e=r.current)&&void 0!==e?e:n.current;s&&(0,dl.S)()&&a&&o.current&&(t.current=Fl({container:o.current,target:a,arrow:i.current,...l(o.current,i.current)}))}),[s,l]),u=(0,Gs.D)((e=>{r.current=e,c()}));a.useImperativeHandle(e.positioningRef,(()=>({updatePosition:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.updatePosition()},setTarget:t=>{e.target,u(t)}})),[e.target,u]),(0,pl.E)((()=>{var t;u(null!==(t=e.target)&&void 0!==t?t:null)}),[e.target,u]),(0,pl.E)((()=>{c()}),[c]);return{targetRef:gl(null,(e=>{n.current!==e&&(n.current=e,c())})),containerRef:gl(null,(e=>{o.current!==e&&(o.current=e,c())})),arrowRef:gl(null,(e=>{i.current!==e&&(i.current=e,c())}))}}var Bl=n(95694),Ul=n(80175),Hl=n(64776),Gl=n(8881),zl=n(57622),ql=n(74308),Wl=n(14508),jl=n(9785),Vl=n(36162);const Ql=()=>{const{targetDocument:e}=(0,ul.Y)(),t=(null==e?void 0:e.defaultView)||void 0,n=null==t?void 0:t.__tabsterShadowDOMAPI,r=a.useMemo((()=>t?(0,jl._A)(t,{autoRoot:{},controlTab:!1,getParent:Vl.P,checkUncontrolledTrappingFocus:e=>{var t;return!!(null===(t=e.firstElementChild)||void 0===t?void 0:t.hasAttribute("data-is-focus-trap-zone-bumper"))},DOMAPI:n}):null),[t,n]);return(0,pl.E)((()=>()=>{r&&(0,jl.hC)(r)}),[r]),r},Jl=()=>{const e=Ql(),{targetDocument:t}=(0,ul.Y)(),n=a.useCallback(((t,n)=>(null==e?void 0:e.focusable.findAll({container:t,acceptCondition:n}))||[]),[e]),r=a.useCallback((t=>null==e?void 0:e.focusable.findFirst({container:t})),[e]),o=a.useCallback((t=>null==e?void 0:e.focusable.findLast({container:t})),[e]),i=a.useCallback(((n,r={})=>{if(!e||!t)return null;const{container:o=t.body}=r;return e.focusable.findNext({currentElement:n,container:o})}),[e,t]),s=a.useCallback(((n,r={})=>{if(!e||!t)return null;const{container:o=t.body}=r;return e.focusable.findPrev({currentElement:n,container:o})}),[e,t]);return{findAllFocusable:n,findFirstFocusable:r,findLastFocusable:o,findNextFocusable:i,findPrevFocusable:s}};var Kl=n(40847);const Xl=e=>{const t=a.createContext({value:{current:e},version:{current:-1},listeners:[]});var n;return t.Provider=(n=t.Provider,e=>{const t=a.useRef(e.value),r=a.useRef(0),o=a.useRef();return o.current||(o.current={value:t,version:r,listeners:[]}),(0,pl.E)((()=>{t.current=e.value,r.current+=1,(0,Kl.unstable_runWithPriority)(Kl.unstable_NormalPriority,(()=>{o.current.listeners.forEach((t=>{t([r.current,e.value])}))}))}),[e.value]),a.createElement(n,{value:o.current},e.children)}),delete t.Consumer,t},Zl=(e,t)=>{const n=a.useContext(e),{value:{current:r},version:{current:o},listeners:i}=n,s=t(r),[l,c]=a.useState([r,s]),u=e=>{c((n=>{if(!e)return[r,s];if(e[0]<=o)return Object.is(n[1],s)?n:[r,s];try{if(Object.is(n[0],e[1]))return n;const r=t(e[1]);return Object.is(n[1],r)?n:[e[1],r]}catch(e){}return[n[0],n[1]]}))};Object.is(l[1],s)||u(void 0);const d=(0,Gs.D)(u);return(0,pl.E)((()=>(i.push(d),()=>{const e=i.indexOf(d);i.splice(e,1)})),[d,i]),l[1]},Yl=Xl(void 0),$l={open:!1,setOpen:()=>!1,checkedValues:{},onCheckedValueChange:()=>null,isSubmenu:!1,triggerRef:{current:null},menuPopoverRef:{current:null},mountNode:null,triggerId:"",openOnContext:!1,openOnHover:!1,hasIcons:!1,hasCheckmarks:!1,inline:!1,persistOnItemClick:!1},ec=Yl.Provider,tc=e=>Zl(Yl,((t=$l)=>e(t))),nc="fuimenuenter";function rc(e){const t=a.useContext(e);return!!t.version&&-1!==t.version.current}const oc=Xl(void 0),ic={checkedValues:{},setFocusByFirstCharacter:()=>null,toggleCheckbox:()=>null,selectRadio:()=>null,hasIcons:!1,hasCheckmarks:!1},ac=oc.Provider,sc=e=>Zl(oc,((t=ic)=>e(t)));function lc(){const e=tc((e=>e.isSubmenu)),t=rc(oc);return e||t}const cc=["after","after-bottom","before-top","before","before-bottom","above"],uc=e=>{const t=lc(),{hoverDelay:n=500,inline:r=!1,hasCheckmarks:o=!1,hasIcons:i=!1,closeOnScroll:s=!1,openOnContext:l=!1,persistOnItemClick:c=!1,openOnHover:u=t,defaultCheckedValues:d,mountNode:p=null}=e,g=(0,Bl.Bi)("menu"),[m,f]=(e=>{const[t,n]=a.useState(e);return[t,e=>{if(null==e)return void n(void 0);let t;t=e instanceof MouseEvent?e:e.nativeEvent,MouseEvent;const r=function(e){const t=e.clientX,n=e.clientY,r=t+1,o=n+1;return{getBoundingClientRect:function(){return{left:t,top:n,right:r,bottom:o,x:t,y:n,height:1,width:1}}}}(t);n(r)}]})(),h={position:t?"after":"below",align:t?"top":"start",target:e.openOnContext?m:void 0,fallbackPositions:t?cc:void 0,...ll(e.positioning)},v=a.Children.toArray(e.children);let y,C;2===v.length?(y=v[0],C=v[1]):1===v.length&&(C=v[0]);const{targetRef:S,containerRef:b}=Ml(h),[E,T]=pc({hoverDelay:n,isSubmenu:t,setContextTarget:f,closeOnScroll:s,menuPopoverRef:b,triggerRef:S,open:e.open,defaultOpen:e.defaultOpen,onOpenChange:e.onOpenChange,openOnContext:l}),[I,_]=dc({checkedValues:e.checkedValues,defaultCheckedValues:d,onCheckedValueChange:e.onCheckedValueChange});return{inline:r,hoverDelay:n,triggerId:g,isSubmenu:t,openOnHover:u,contextTarget:m,setContextTarget:f,hasCheckmarks:o,hasIcons:i,closeOnScroll:s,menuTrigger:y,menuPopover:C,mountNode:p,triggerRef:S,menuPopoverRef:b,components:{},openOnContext:l,open:E,setOpen:T,checkedValues:I,onCheckedValueChange:_,persistOnItemClick:c}},dc=e=>{const[t,n]=(0,Ul.i)({state:e.checkedValues,defaultState:e.defaultCheckedValues,initialState:{}});return[t,(0,Gs.D)(((t,{name:r,checkedItems:o})=>{var i;null===(i=e.onCheckedValueChange)||void 0===i||i.call(e,t,{name:r,checkedItems:o}),n((e=>({...e,[r]:o})))}))]},pc=e=>{const{targetDocument:t}=(0,ul.Y)(),n=tc((e=>e.setOpen)),r=(0,Gs.D)(((t,n)=>{var r;return null===(r=e.onOpenChange)||void 0===r?void 0:r.call(e,t,n)})),o=a.useRef(!1),[i,s]=(0,Ul.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1}),l=(0,Gs.D)(((t,o)=>{const i=t instanceof CustomEvent&&t.type===nc?t.detail.nativeEvent:t;null==r||r(i,{...o}),o.open&&"contextmenu"===t.type&&e.setContextTarget(t),o.open||e.setContextTarget(void 0),o.bubble&&n(t,{...o}),s(o.open)})),[c,u]=(0,Hl.Z)(),d=(0,Gs.D)(((t,n)=>{var r;(u(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type||"mouseenter"===t.type||"mousemove"===t.type||t.type===nc)?((null===(r=e.triggerRef.current)||void 0===r?void 0:r.contains(t.target))&&(o.current="mouseenter"===t.type||"mousemove"===t.type),c((()=>l(t,n)),e.hoverDelay)):l(t,n)}));(0,Gl.W)({contains:zl.s,disabled:!i,element:t,refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),callback:e=>d(e,{open:!1,type:"clickOutside",event:e})});const p=e.openOnContext||e.closeOnScroll;(0,ql.z)({contains:zl.s,element:t,callback:e=>d(e,{open:!1,type:"scrollOutside",event:e}),refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),disabled:!i||!p}),(e=>{const{refs:t,callback:n,element:r,disabled:o}=e,i=(0,Gs.D)((e=>{const r=t[0],i=e.target;var a;!(0,zl.s)(null!==(a=r.current)&&void 0!==a?a:null,i)&&!o&&n(e)}));a.useEffect((()=>{if(null!=r)return o||r.addEventListener(nc,i),()=>{r.removeEventListener(nc,i)}}),[i,r,o])})({element:t,callback:e=>{o.current||d(e,{open:!1,type:"menuMouseEnter",event:e})},disabled:!i,refs:[e.menuPopoverRef]});const{findFirstFocusable:g}=Jl(),m=a.useCallback((()=>{const t=g(e.menuPopoverRef.current);null==t||t.focus()}),[g,e.menuPopoverRef]),f=(0,Wl.t)();return a.useEffect((()=>{var n;i?m():f||(null==t?void 0:t.activeElement)===(null==t?void 0:t.body)&&(null===(n=e.triggerRef.current)||void 0===n||n.focus())}),[e.triggerRef,e.isSubmenu,i,m,t,e.menuPopoverRef]),[i,d]};const gc=e=>{const t=uc(e),n=function(e){const{checkedValues:t,hasCheckmarks:n,hasIcons:r,inline:o,isSubmenu:i,menuPopoverRef:a,mountNode:s,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:p,setOpen:g,triggerId:m,triggerRef:f}=e;return{menu:{checkedValues:t,hasCheckmarks:n,hasIcons:r,inline:o,isSubmenu:i,menuPopoverRef:a,mountNode:s,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:p,setOpen:g,triggerId:m,triggerRef:f}}}(t);return((e,t)=>a.createElement(ec,{value:t.menu},e.menuTrigger,e.open&&e.menuPopover))(t,n)};gc.displayName="Menu";const mc=()=>a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M0.723627 0.0527913C0.547712 -0.0351664 0.336572 -0.0118224 0.18412 0.11244C0.0316676 0.236702 -0.0337739 0.438798 0.0169031 0.628836L1.51498 6.24662C1.56554 6.43622 1.72234 6.57872 1.9159 6.61098L8.77041 7.7534C9.04894 7.79982 9.04894 8.20018 8.77041 8.2466L1.9159 9.38902C1.72234 9.42128 1.56554 9.56378 1.51498 9.75338L0.0169031 15.3712C-0.0337739 15.5612 0.0316676 15.7633 0.18412 15.8876C0.336572 16.0118 0.547712 16.0352 0.723627 15.9472L15.7236 8.44722C15.893 8.36252 16 8.18939 16 8C16 7.81062 15.893 7.63749 15.7236 7.55279L0.723627 0.0527913Z",fill:"#C43E1C"})),fc=()=>a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M0.18412 0.11244C0.336572 -0.0118225 0.547712 -0.0351664 0.723627 0.0527913L15.7236 7.55279C15.893 7.63749 16 7.81062 16 8C16 8.18939 15.893 8.36252 15.7236 8.44722L0.723627 15.9472C0.547712 16.0352 0.336572 16.0118 0.18412 15.8876C0.0316676 15.7633 -0.0337739 15.5612 0.0169031 15.3712L1.98255 8L0.0169031 0.628836C-0.0337739 0.438798 0.0316676 0.236702 0.18412 0.11244ZM2.88416 8.5L1.26911 14.5564L14.382 8L1.26911 1.44357L2.88416 7.5H9.50002C9.77616 7.5 10 7.72386 10 8C10 8.27615 9.77616 8.5 9.50002 8.5H2.88416Z",fill:"#242424"})),hc=()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.5353 16.8513C13.6713 16.9475 13.8337 16.9992 14.0003 16.9993C14.1654 16.9993 14.3264 16.9483 14.4613 16.8533C14.6008 16.7548 14.7058 16.6148 14.7613 16.4533L15.0093 15.6913C15.0625 15.5328 15.1515 15.3888 15.2693 15.2703C15.3867 15.1517 15.5307 15.0629 15.6893 15.0113L16.4613 14.7593C16.619 14.7048 16.7557 14.6023 16.8523 14.4663C16.9257 14.3633 16.9736 14.2443 16.9921 14.1192C17.0106 13.9941 16.9992 13.8664 16.9588 13.7466C16.9184 13.6268 16.8501 13.5182 16.7597 13.4298C16.6692 13.3415 16.5591 13.2758 16.4383 13.2383L15.6743 12.9893C15.5162 12.9367 15.3724 12.8481 15.2544 12.7304C15.1364 12.6127 15.0473 12.4693 14.9943 12.3113L14.7423 11.5383C14.6886 11.3804 14.586 11.2438 14.4493 11.1483C14.3473 11.0753 14.2295 11.0274 14.1056 11.0083C13.9816 10.9893 13.8549 10.9996 13.7357 11.0385C13.6164 11.0775 13.508 11.1439 13.4192 11.2324C13.3304 11.321 13.2636 11.4292 13.2243 11.5483L12.9773 12.3103C12.925 12.4679 12.8375 12.6116 12.7213 12.7303C12.6066 12.8467 12.4667 12.9353 12.3123 12.9893L11.5393 13.2413C11.3803 13.2952 11.2422 13.3978 11.1447 13.5345C11.0472 13.6713 10.9952 13.8352 10.9961 14.0032C10.997 14.1711 11.0507 14.3345 11.1496 14.4702C11.2486 14.6059 11.3877 14.707 11.5473 14.7593L12.3103 15.0063C12.4692 15.0597 12.6136 15.149 12.7323 15.2673C12.8505 15.3855 12.939 15.5301 12.9903 15.6893L13.2433 16.4633C13.2981 16.6197 13.4001 16.7553 13.5353 16.8513Z",fill:"url(#paint0_linear_423_27237)"}),a.createElement("path",{d:"M7.39804 12.8088C7.57428 12.9331 7.78476 12.9997 8.00043 12.9993C8.21633 12.9995 8.42686 12.932 8.60243 12.8063C8.77993 12.6758 8.91464 12.4955 8.98943 12.2883L9.43643 10.9153C9.55086 10.571 9.74391 10.2581 10.0003 10.0014C10.2566 9.74467 10.5693 9.5512 10.9134 9.4363L12.3044 8.9853C12.4564 8.93095 12.5936 8.84214 12.7055 8.72586C12.8174 8.60957 12.9008 8.46896 12.9492 8.31503C12.9977 8.16111 13.0098 7.99806 12.9847 7.83867C12.9596 7.67927 12.8979 7.52786 12.8044 7.3963C12.6703 7.21038 12.4794 7.07314 12.2604 7.0053L10.8854 6.5583C10.5409 6.44407 10.2278 6.25111 9.97087 5.99472C9.71396 5.73833 9.52035 5.42558 9.40543 5.0813L8.95343 3.6933C8.88113 3.491 8.74761 3.31624 8.57143 3.1933C8.43877 3.09957 8.28607 3.03809 8.12548 3.01375C7.96489 2.9894 7.80083 3.00286 7.64636 3.05306C7.49188 3.10326 7.35125 3.18881 7.23564 3.3029C7.12004 3.417 7.03265 3.5565 6.98043 3.7103L6.52343 5.1103C6.40884 5.44513 6.21967 5.74954 5.97022 6.00055C5.72076 6.25157 5.41753 6.44263 5.08343 6.5593L3.69243 7.0073C3.54065 7.0617 3.40352 7.15048 3.29177 7.26669C3.18001 7.3829 3.09666 7.5234 3.04824 7.67719C2.99982 7.83097 2.98764 7.99388 3.01265 8.15315C3.03767 8.31243 3.0992 8.46376 3.19243 8.5953C3.32027 8.77475 3.50105 8.90972 3.70943 8.9813L5.08343 9.4263C5.52354 9.57278 5.90999 9.84713 6.19343 10.2143C6.35585 10.4249 6.4813 10.6616 6.56443 10.9143L7.01643 12.3053C7.08846 12.5086 7.22179 12.6845 7.39804 12.8088Z",fill:"url(#paint1_linear_423_27237)"}),a.createElement("defs",null,a.createElement("linearGradient",{id:"paint0_linear_423_27237",x1:"10.9961",y1:"10.999",x2:"17.053",y2:"11.0523",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{className:"gradientPrimary",stopColor:"#C43E1C"}),a.createElement("stop",{className:"gradientSecondary",offset:"1",stopColor:"#FF5C39"})),a.createElement("linearGradient",{id:"paint1_linear_423_27237",x1:"3",y1:"3.00195",x2:"13.0845",y2:"3.09059",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{className:"gradientPrimary",stopColor:"#C43E1C"}),a.createElement("stop",{className:"gradientSecondary",offset:"1",stopColor:"#FF5C39"})))),vc=()=>a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M7.39804 12.8085C7.57428 12.9328 7.78476 12.9994 8.00043 12.999C8.21633 12.9992 8.42686 12.9317 8.60243 12.806C8.77993 12.6755 8.91464 12.4952 8.98943 12.288L9.43643 10.915C9.55086 10.5707 9.74391 10.2578 10.0003 10.0011C10.2566 9.74436 10.5693 9.55089 10.9134 9.436L12.3044 8.98499C12.4564 8.93064 12.5936 8.84184 12.7055 8.72555C12.8174 8.60926 12.9008 8.46865 12.9492 8.31473C12.9977 8.1608 13.0098 7.99776 12.9847 7.83836C12.9596 7.67897 12.8979 7.52756 12.8044 7.396C12.6703 7.21007 12.4794 7.07283 12.2604 7.005L10.8854 6.558C10.5409 6.44377 10.2278 6.2508 9.97087 5.99441C9.71396 5.73803 9.52035 5.42528 9.40543 5.081L8.95343 3.693C8.88113 3.49069 8.74761 3.31593 8.57143 3.193C8.43877 3.09927 8.28607 3.03779 8.12548 3.01344C7.96489 2.9891 7.80083 3.00256 7.64636 3.05275C7.49188 3.10295 7.35125 3.1885 7.23564 3.3026C7.12004 3.41669 7.03265 3.55619 6.98043 3.71L6.52343 5.11C6.40884 5.44482 6.21967 5.74923 5.97022 6.00025C5.72076 6.25126 5.41753 6.44232 5.08343 6.559L3.69243 7.007C3.54065 7.06139 3.40352 7.15017 3.29177 7.26638C3.18001 7.3826 3.09666 7.5231 3.04824 7.67688C2.99982 7.83067 2.98764 7.99357 3.01265 8.15285C3.03767 8.31213 3.0992 8.46346 3.19243 8.595C3.32027 8.77445 3.50105 8.90942 3.70943 8.981L5.08343 9.42599C5.52354 9.57248 5.90999 9.84682 6.19343 10.214C6.35585 10.4246 6.4813 10.6613 6.56443 10.914L7.01643 12.305C7.08846 12.5083 7.22179 12.6842 7.39804 12.8085ZM7.48343 5.394L8.01043 4.017L8.44943 5.394C8.61312 5.88714 8.88991 6.33516 9.25767 6.70223C9.62544 7.06929 10.074 7.34524 10.5674 7.508L11.9734 8.03699L10.5914 8.48499C10.0987 8.64929 9.65095 8.92616 9.28382 9.29363C8.9167 9.6611 8.64026 10.1091 8.47643 10.602L7.95343 11.98L7.50443 10.601C7.34335 10.1077 7.06943 9.65883 6.70443 9.29C6.3356 8.92196 5.88653 8.64437 5.39243 8.479L4.01443 7.957L5.40043 7.507C5.88672 7.33836 6.32775 7.0602 6.68943 6.694C7.04901 6.32629 7.32049 5.8818 7.48343 5.394ZM13.5353 16.851C13.6713 16.9472 13.8337 16.9989 14.0003 16.999C14.1654 16.9991 14.3264 16.9481 14.4613 16.853C14.6008 16.7545 14.7058 16.6146 14.7613 16.453L15.0093 15.691C15.0625 15.5326 15.1515 15.3885 15.2693 15.27C15.3867 15.1515 15.5307 15.0627 15.6893 15.011L16.4613 14.759C16.619 14.7045 16.7557 14.6021 16.8523 14.466C16.9257 14.363 16.9736 14.2441 16.9921 14.119C17.0106 13.9939 16.9992 13.8662 16.9588 13.7463C16.9184 13.6265 16.8501 13.518 16.7597 13.4296C16.6692 13.3412 16.5591 13.2756 16.4383 13.238L15.6743 12.989C15.5162 12.9365 15.3724 12.8478 15.2544 12.7302C15.1364 12.6125 15.0473 12.469 14.9943 12.311L14.7423 11.538C14.6886 11.3802 14.586 11.2436 14.4493 11.148C14.3473 11.0751 14.2295 11.0271 14.1056 11.0081C13.9816 10.989 13.8549 10.9994 13.7357 11.0383C13.6164 11.0772 13.508 11.1436 13.4192 11.2322C13.3304 11.3207 13.2636 11.4289 13.2243 11.548L12.9773 12.31C12.925 12.4677 12.8375 12.6113 12.7213 12.73C12.6066 12.8465 12.4667 12.9351 12.3123 12.989L11.5393 13.241C11.3803 13.2949 11.2422 13.3975 11.1447 13.5343C11.0472 13.671 10.9952 13.835 10.9961 14.0029C10.997 14.1708 11.0507 14.3342 11.1496 14.47C11.2486 14.6057 11.3877 14.7068 11.5473 14.759L12.3103 15.006C12.4692 15.0594 12.6136 15.1487 12.7323 15.267C12.8505 15.3853 12.939 15.5299 12.9903 15.689L13.2433 16.463C13.2981 16.6195 13.4001 16.7551 13.5353 16.851ZM12.6223 14.058L12.4433 13.999L12.6273 13.935C12.9291 13.8301 13.2027 13.6573 13.4273 13.43C13.6537 13.201 13.8248 12.9233 13.9273 12.618L13.9853 12.44L14.0443 12.621C14.1463 12.9277 14.3185 13.2064 14.5471 13.4349C14.7757 13.6633 15.0545 13.8353 15.3613 13.937L15.5563 14L15.3763 14.059C15.0689 14.1612 14.7898 14.3339 14.5611 14.5633C14.3324 14.7927 14.1606 15.0724 14.0593 15.38L14.0003 15.561L13.9423 15.38C13.8409 15.0719 13.6687 14.7917 13.4394 14.5622C13.2102 14.3326 12.9303 14.1599 12.6223 14.058Z",fill:"#242424"})),yc=()=>a.createElement("svg",{width:"12",height:"16",viewBox:"0 0 12 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M6 11C7.65685 11 9 9.65685 9 8V3.00002C9 1.34316 7.65685 1.52588e-05 6 1.52588e-05C4.34315 1.52588e-05 3 1.34316 3 3.00001V8C3 9.65685 4.34315 11 6 11ZM6 10C4.89543 10 4 9.10457 4 8V3.00001C4 1.89545 4.89543 1.00001 6 1.00002C7.10457 1.00002 8 1.89545 8 3.00002V8C8 9.10457 7.10457 10 6 10ZM1 7.5C1.27614 7.5 1.5 7.72386 1.5 8C1.5 10.4853 3.51472 12.5 6 12.5C8.48528 12.5 10.5 10.4853 10.5 8C10.5 7.72386 10.7239 7.5 11 7.5C11.2761 7.5 11.5 7.72386 11.5 8C11.5 10.869 9.30325 13.225 6.5 13.4776V15.5C6.5 15.7761 6.27614 16 6 16C5.72386 16 5.5 15.7761 5.5 15.5V13.4776C2.69675 13.225 0.5 10.869 0.5 8C0.5 7.72386 0.723858 7.5 1 7.5Z",fill:"#424242"})),Cc=()=>a.createElement("svg",{width:"12",height:"16",viewBox:"0 0 12 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M1.5 8C1.5 7.72386 1.27614 7.5 1 7.5C0.723858 7.5 0.5 7.72386 0.5 8C0.5 10.869 2.69675 13.225 5.5 13.4776V15.5C5.5 15.7761 5.72386 16 6 16C6.27614 16 6.5 15.7761 6.5 15.5V13.4776C9.30325 13.225 11.5 10.869 11.5 8C11.5 7.72386 11.2761 7.5 11 7.5C10.7239 7.5 10.5 7.72386 10.5 8C10.5 10.4853 8.48528 12.5 6 12.5C3.51472 12.5 1.5 10.4853 1.5 8ZM9 8.00076C8.99959 9.65727 7.6566 11 6 11C4.34315 11 3 9.65685 3 8V3.00002C3 1.34316 4.34315 1.52588e-05 6 1.52588e-05C7.65686 1.52588e-05 9 1.34316 9 3.00002V8.00076Z",fill:"white"})),Sc=()=>(0,c.K1)({icons:{suggestionIcon:a.createElement(vc,null),suggestionClickedIcon:a.createElement(hc,null),submitButtonIcon:a.createElement(fc,null),submitButtonHoverIcon:a.createElement(mc,null),microphoneButtonIcon:a.createElement(yc,null),microphoneButtonSolidIcon:a.createElement(Cc,null)}});var bc=n(56501);const Ec=(e,t)=>{const n=tc((e=>e.menuPopoverRef)),r=tc((e=>e.setOpen)),o=tc((e=>e.open)),i=tc((e=>e.openOnHover)),s=tc((e=>e.triggerRef)),l=lc(),c=a.useRef(!0),u=function(){const e=Ql();return e&&(0,jl.mz)(e),(0,jl.U6)({restorer:{type:jl.CP.Source}})}(),[d,p]=(0,Hl.Z)(),{dir:g}=(0,ul.Y)(),m="ltr"===g?Hs.nkM:Hs.Qpb,f=a.useCallback((e=>{e&&e.addEventListener("mouseover",(e=>{var t,r;c.current&&(c.current=!1,t=n.current,r=e,t.dispatchEvent(new CustomEvent(nc,{bubbles:!0,detail:{nativeEvent:r}})),d((()=>c.current=!0),250))}))}),[n,d]);var h;a.useEffect((()=>{}),[p]);const v=null!==(h=tc((e=>e.inline)))&&void 0!==h&&h,y=tc((e=>e.mountNode)),C=qs.Gk((0,Ws.g)("div",{role:"presentation",...u,...e,ref:(0,bc.a)(t,n,f)}),{elementType:"div"}),{onMouseEnter:S,onKeyDown:b}=C;return C.onMouseEnter=(0,Gs.D)((e=>{(i||l)&&r(e,{open:!0,keyboard:!1,type:"menuPopoverMouseEnter",event:e}),null==S||S(e)})),C.onKeyDown=(0,Gs.D)((e=>{const t=e.key;var i,a;(t===Hs.uf9||l&&t===m)&&(o&&(null===(i=n.current)||void 0===i?void 0:i.contains(e.target))&&!e.isDefaultPrevented()&&(r(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),e.preventDefault()));t===Hs.ozo&&(r(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),l||null===(a=s.current)||void 0===a||a.focus());null==b||b(e)})),{inline:v,mountNode:y,components:{root:"div"},root:C}},Tc="fui-MenuPopover",Ic=(0,Ks.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",De3pzq:"fxugw4r",sj55zd:"f19n0e5",B7ck84d:"f1ewtqcl",Bf4jedk:"fl8fusi",B2u0y6b:"f1kaai3v",B68tc82:"f1p9o1ba",a9b677:"f1ahpp82",E5pizo:"f1hg901r",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fd3pd8h",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f18k4bn6",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",Bvtglag:"fjp4h9y"}},{d:[[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1ewtqcl{box-sizing:border-box;}",".fl8fusi{min-width:138px;}",".f1kaai3v{max-width:300px;}",".f1p9o1ba{overflow-x:hidden;}",".f1ahpp82{width:max-content;}",".f1hg901r{box-shadow:var(--shadow16);}",[".fd3pd8h{padding:4px;}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f18k4bn6{animation-composition:accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}"],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]});var _c=n(79556);var wc=n(68833),Pc=n(75164),xc=n(76423);const kc=(0,Ks.X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]}),Ac=s.useInsertionEffect,Lc=e=>{const{targetDocument:t,dir:n}=(0,ul.Y)(),r=(0,wc.v)(),o=(0,xc.Y)(),i=kc(),s=(0,Pc.q)(),l=(0,Ms.z)(s,i.root,e.className),c=null!=r?r:null==t?void 0:t.body,u=function(e,t){var n;const r=a.useMemo,o=a.useEffect,[i,s]=null!=(n=r((()=>e()),t))?n:[null,()=>null];return o((()=>s),t),i}((()=>{if(void 0===c||e.disabled)return[null,()=>null];const t=c.ownerDocument.createElement("div");return c.appendChild(t),[t,()=>t.remove()]}),[c]);return Ac?Ac((()=>{if(!u)return;const e=l.split(" ").filter(Boolean);return u.classList.add(...e),u.setAttribute("dir",n),u.setAttribute("data-portal-node","true"),o.current=u,()=>{u.classList.remove(...e),u.removeAttribute("dir")}}),[l,n,u,o]):a.useMemo((()=>{u&&(u.className=l,u.setAttribute("dir",n),u.setAttribute("data-portal-node","true"),o.current=u)}),[l,n,u,o]),u},Dc=e=>{const{element:t,className:n}=function(e){return(0,Nl.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}(e.mountNode),r=a.useRef(null),o=Lc({disabled:!!t,className:n}),i=null!=t?t:o,s={children:e.children,mountNode:i,virtualParentRootRef:r};return a.useEffect((()=>{if(!i)return;const e=r.current,t=i.contains(e);return e&&!t?((0,_c.g)(i,e),()=>{(0,_c.g)(i,void 0)}):void 0}),[r,i]),s},Oc=e=>(e=>a.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&l.createPortal(e.children,e.mountNode)))(Dc(e));Oc.displayName="Portal";const Nc=a.forwardRef(((e,t)=>{const n=Ec(e,t);return(e=>{const t=Ic();e.root.className=(0,Ms.z)(Tc,t.root,e.root.className)})(n),(0,il.$e)("useMenuPopoverStyles_unstable")(n),(e=>((0,Us.C)(e),e.inline?(0,Bs.Y)(e.root,{}):(0,Bs.Y)(Oc,{mountNode:e.mountNode,children:(0,Bs.Y)(e.root,{})})))(n)}));Nc.displayName="MenuPopover";const Rc=(e={})=>{const{circular:t,axis:n,memorizeCurrent:r=!0,tabbable:o,ignoreDefaultKeydown:i,unstable_hasDefault:s}=e,l=Ql();return l&&(0,jl.S)(l),(e=>{Ql();const t=(0,jl.U6)(e,!0);return a.useMemo((()=>({[jl.h7]:t})),[t])})({mover:{cyclic:!!t,direction:Fc(null!=n?n:"vertical"),memorizeCurrent:r,tabbable:o,hasDefault:s},...i&&{focusable:{ignoreKeydown:i}}})};function Fc(e){switch(e){case"horizontal":return jl.iA.Horizontal;case"grid":return jl.iA.Grid;case"grid-linear":return jl.iA.GridLinear;case"both":return jl.iA.Both;default:return jl.iA.Vertical}}var Mc=n(58651);const Bc=()=>({checkedValues:tc((e=>e.checkedValues)),onCheckedValueChange:tc((e=>e.onCheckedValueChange)),triggerId:tc((e=>e.triggerId)),hasIcons:tc((e=>e.hasIcons)),hasCheckmarks:tc((e=>e.hasCheckmarks))}),Uc=(e,t,n)=>{let r=!1;for(const n in t)e[n]&&(r=!0);return n&&r};const Hc="fui-MenuList",Gc=(0,Ks.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",i8kkvl:0,Belr9w4:0,rmohyg:"f1t6b6ee"},hasMenuContext:{Bqenvij:"f1l02sjl"}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",[".f1t6b6ee{gap:2px;}",{p:-1}],".f1l02sjl{height:100%;}"]}),zc=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{findAllFocusable:n}=Jl(),{targetDocument:r}=(0,ul.Y)(),o=Bc(),i=rc(Yl),s=Rc({circular:!0});Uc(e,o,i)&&Mc.warn("You are using both MenuList and Menu props, we recommend you to use Menu props when available");const l=a.useRef(null);a.useEffect((()=>{const e=l.current;if(i&&r&&e){const t=t=>{const n=t.detail.next;n&&e.contains(r.activeElement)&&!e.contains(n)&&t.preventDefault()};return r.addEventListener(jl.GD,t),()=>{r.removeEventListener(jl.GD,t)}}}),[l,r,i]);const c=a.useCallback(((e,t)=>{const r=["menuitem","menuitemcheckbox","menuitemradio"];if(!l.current)return;const o=n(l.current,(e=>e.hasAttribute("role")&&-1!==r.indexOf(e.getAttribute("role"))));let i=o.indexOf(t)+1;i===o.length&&(i=0);const a=o.map((e=>{var t;return null===(t=e.textContent)||void 0===t?void 0:t.charAt(0).toLowerCase()})),s=e.key.toLowerCase(),c=(e,t)=>{for(let t=e;t<a.length;t++)if(s===a[t])return t;return-1};let u=c(i);-1===u&&(u=c(0)),u>-1&&o[u].focus()}),[n]);var u;const[d,p]=(0,Ul.i)({state:null!==(u=e.checkedValues)&&void 0!==u?u:i?o.checkedValues:void 0,defaultState:e.defaultCheckedValues,initialState:{}});var g;const m=null!==(g=e.onCheckedValueChange)&&void 0!==g?g:i?o.onCheckedValueChange:void 0,f=(0,Gs.D)(((e,t,n,r)=>{const o=[...(null==d?void 0:d[t])||[]];r?o.splice(o.indexOf(n),1):o.push(n),null==m||m(e,{name:t,checkedItems:o}),p((e=>({...e,[t]:o})))})),h=(0,Gs.D)(((e,t,n)=>{const r=[n];p((e=>({...e,[t]:r}))),null==m||m(e,{name:t,checkedItems:r})}));return{components:{root:"div"},root:qs.Gk((0,Ws.g)("div",{ref:(0,bc.a)(t,l),role:"menu","aria-labelledby":o.triggerId,...s,...e}),{elementType:"div"}),hasIcons:o.hasIcons||!1,hasCheckmarks:o.hasCheckmarks||!1,checkedValues:d,hasMenuContext:i,setFocusByFirstCharacter:c,selectRadio:h,toggleCheckbox:f}})(e,t),r=function(e){const{checkedValues:t,hasCheckmarks:n,hasIcons:r,selectRadio:o,setFocusByFirstCharacter:i,toggleCheckbox:a}=e;return{menuList:{checkedValues:t,hasCheckmarks:n,hasIcons:r,selectRadio:o,setFocusByFirstCharacter:i,toggleCheckbox:a}}}(n);return(e=>{const t=Gc();e.root.className=(0,Ms.z)(Hc,t.root,e.hasMenuContext&&t.hasMenuContext,e.root.className)})(n),(0,il.$e)("useMenuListStyles_unstable")(n),((e,t)=>((0,Us.C)(e),(0,Bs.Y)(ac,{value:t.menuList,children:(0,Bs.Y)(e.root,{})})))(n,r)}));zc.displayName="MenuList";const qc=a.createContext(void 0),Wc={headerId:""},jc=qc.Provider;const Vc="fui-MenuGroup",Qc=a.forwardRef(((e,t)=>{const n=function(e,t){const n=(0,Bl.Bi)("menu-group");return{components:{root:"div"},root:qs.Gk((0,Ws.g)("div",{ref:t,"aria-labelledby":n,role:"group",...e}),{elementType:"div"}),headerId:n}}(e,t),r=function(e){const{headerId:t}=e;return{menuGroup:a.useMemo((()=>({headerId:t})),[t])}}(n);return(e=>{e.root.className=(0,Ms.z)(Vc,e.root.className)})(n),(0,il.$e)("useMenuGroupStyles_unstable")(n),((e,t)=>((0,Us.C)(e),(0,Bs.Y)(jc,{value:t.menuGroup,children:(0,Bs.Y)(e.root,{})})))(n,r)}));Qc.displayName="MenuGroup";const Jc="fui-MenuDivider",Kc=(0,Ks.X)({root:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f8dz51a",a9b677:"f14z66ap",B9xav0g:0,oivjwe:0,Bn0qgzm:0,Bgfg5da:"f1facbz3"}},{d:[[".f8dz51a{margin:4px -5px 4px -5px;}",{p:-1}],".f14z66ap{width:auto;}",[".f1facbz3{border-bottom:var(--strokeWidthThin) solid var(--colorNeutralStroke2);}",{p:-1}]]}),Xc=a.forwardRef(((e,t)=>{const n=((e,t)=>({components:{root:"div"},root:qs.Gk((0,Ws.g)("div",{role:"presentation","aria-hidden":!0,...e,ref:t}),{elementType:"div"})}))(e,t);return(e=>{const t=Kc();e.root.className=(0,Ms.z)(Jc,t.root,e.root.className)})(n),(0,il.$e)("useMenuDividerStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.Y)(e.root,{})))(n)}));function Zc(e,t){const{headerId:n}=null!==(r=a.useContext(qc))&&void 0!==r?r:Wc;var r;return{components:{root:"div"},root:qs.Gk((0,Ws.g)("div",{ref:t,id:n,...e}),{elementType:"div"})}}Xc.displayName="MenuDivider";const Yc="fui-MenuGroupHeader",$c=(0,Ks.X)({root:{Be2twd7:"fy9rknc",sj55zd:"f11d4kpn",uwmqm3:["f177v4lu","f19lj068"],z189sj:["f19lj068","f177v4lu"],Bhrd7zp:"fl43uef",Bqenvij:"f1d2rq10",mc9l5x:"f22iagw",Bt984gj:"f122n59"}},{d:[".fy9rknc{font-size:var(--fontSizeBase200);}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f177v4lu{padding-left:8px;}",".f19lj068{padding-right:8px;}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".f1d2rq10{height:32px;}",".f22iagw{display:flex;}",".f122n59{align-items:center;}"]}),eu=a.forwardRef(((e,t)=>{const n=Zc(e,t);return(e=>{const t=$c();e.root.className=(0,Ms.z)(Yc,t.root,e.root.className)})(n),(0,il.$e)("useMenuGroupHeaderStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.Y)(e.root,{})))(n)}));eu.displayName="MenuGroupHeader";const tu=a.createContext(void 0);tu.Provider;var nu=n(28678),ru=n(88179);const ou=(0,nu.A)(ru.oAB,ru.Crl),iu=(0,nu.A)(ru.NGN,ru.nUb),au=(e,t)=>{const n=null!==(r=a.useContext(tu))&&void 0!==r&&r;var r;const o=tc((e=>e.persistOnItemClick)),{as:i="div",disabled:s=!1,hasSubmenu:l=n,persistOnClick:c=o}=e,u=sc((e=>e.hasIcons)),d=sc((e=>e.hasCheckmarks)),p=tc((e=>e.setOpen)),{dir:g}=(0,ul.Y)(),m=a.useRef(null),f=a.useRef(!1),h={hasSubmenu:l,disabled:s,persistOnClick:c,components:{root:"div",icon:"span",checkmark:"span",submenuIndicator:"span",content:"span",secondaryContent:"span"},root:qs.Gk((0,Ws.g)(i,zs(i,{role:"menuitem",...e,disabled:!1,disabledFocusable:s,ref:(0,bc.a)(t,m),onKeyDown:(0,Gs.D)((t=>{var n;null===(n=e.onKeyDown)||void 0===n||n.call(e,t),t.isDefaultPrevented()||t.key!==Hs.$xS&&t.key!==Hs.xyI||(f.current=!0)})),onMouseEnter:(0,Gs.D)((t=>{var n,r;null===(n=m.current)||void 0===n||n.focus(),null===(r=e.onMouseEnter)||void 0===r||r.call(e,t)})),onClick:(0,Gs.D)((t=>{var n;l||c||(p(t,{open:!1,keyboard:f.current,bubble:!0,type:"menuItemClick",event:t}),f.current=!1),null===(n=e.onClick)||void 0===n||n.call(e,t)}))})),{elementType:"div"}),icon:qs.lq(e.icon,{renderByDefault:u,elementType:"span"}),checkmark:qs.lq(e.checkmark,{renderByDefault:d,elementType:"span"}),submenuIndicator:qs.lq(e.submenuIndicator,{renderByDefault:l,defaultProps:{children:"ltr"===g?a.createElement(ou,null):a.createElement(iu,null)},elementType:"span"}),content:qs.lq(e.content,{renderByDefault:!!e.children,defaultProps:{children:e.children},elementType:"span"}),secondaryContent:qs.lq(e.secondaryContent,{elementType:"span"})};return((e,t)=>{const n=sc((e=>e.setFocusByFirstCharacter)),{onKeyDown:r}=e.root;e.root.onKeyDown=e=>{var o;null==r||r(e),(null===(o=e.key)||void 0===o?void 0:o.length)>1||t.current&&(null==n||n(e,t.current))}})(h,m),h},su=(0,Ks.X)({root:{a9b677:"fjw5fx7",Bqenvij:"fd461yt",Bcdw1i0:"fd7fpy0"},rootChecked:{Bcdw1i0:"f1022m68"}},{d:[".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".fd7fpy0{visibility:hidden;}",".f1022m68{visibility:visible;}"]}),lu="fui-MenuItem",cu="fui-MenuItem__icon",uu="fui-MenuItem__checkmark",du="fui-MenuItem__submenuIndicator",pu="fui-MenuItem__content",gu="fui-MenuItem__secondaryContent",mu=(0,Js.y)("r11normc","r1lnj0i0",{r:[".r11normc{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-right:var(--spacingVerticalSNudge);padding-left:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r11normc:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r11normc:hover .fui-Icon-filled{display:inline;}",".r11normc:hover .fui-Icon-regular{display:none;}",".r11normc:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r11normc:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r11normc:focus{outline-style:none;}",".r11normc:focus-visible{outline-style:none;}",".r11normc[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.r11normc[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".r1lnj0i0{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-left:var(--spacingVerticalSNudge);padding-right:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r1lnj0i0:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r1lnj0i0:hover .fui-Icon-filled{display:inline;}",".r1lnj0i0:hover .fui-Icon-regular{display:none;}",".r1lnj0i0:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r1lnj0i0:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r1lnj0i0:focus{outline-style:none;}",".r1lnj0i0:focus-visible{outline-style:none;}",".r1lnj0i0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.r1lnj0i0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:['@media (forced-colors: active){.r11normc:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r11normc:focus{outline-style:none;}.r11normc:focus-visible{outline-style:none;}.r11normc[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}@media (forced-colors: active){.r11normc[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}.r11normc[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}}',"@media (forced-colors: active){.r11normc[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}",'@media (forced-colors: active){.r1lnj0i0:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r1lnj0i0:focus{outline-style:none;}.r1lnj0i0:focus-visible{outline-style:none;}.r1lnj0i0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}@media (forced-colors: active){.r1lnj0i0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}.r1lnj0i0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}}',"@media (forced-colors: active){.r1lnj0i0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),fu=(0,Js.y)("r1ls86vo","rpbc5dr",[".r1ls86vo{padding-left:2px;padding-right:2px;background-color:transparent;flex-grow:1;}",".rpbc5dr{padding-right:2px;padding-left:2px;background-color:transparent;flex-grow:1;}"]),hu=(0,Js.y)("r12mwwux","r1ewgu5j",[".r12mwwux{padding-left:2px;padding-right:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r12mwwux:hover{color:var(--colorNeutralForeground3Hover);}",".r12mwwux:focus{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j{padding-right:2px;padding-left:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r1ewgu5j:hover{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j:focus{color:var(--colorNeutralForeground3Hover);}"]),vu=(0,Js.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),yu=(0,Js.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),Cu=(0,Ks.X)({checkmark:{B6of3ja:"fmnzpld"},splitItemMain:{Bh6795r:"fqerorx"},splitItemTrigger:{Btl43ni:["f1ozlkrg","f10ostut"],Beyfa6y:["f1deotkl","f1krrbdw"],uwmqm3:["f1cnd47f","fhxju0i"],Ftih45:"f1wl9k8s",Ccq8qp:"f1yn80uh",Baz25je:"f68mna0",cmx5o7:"f1p5zmk"},disabled:{sj55zd:"f1s2aq7o",Bi91k9c:"fvgxktp",Jwef8y:"f1ijtazh",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bg7n49j:"f1q1x1ba",B2d53fq:"fcvwxyo",iro3zm:"f1to34ca",t0hwav:"ft33916",Bbusuzp:"f1dcs8yz",ze5xyy:"f1kc2mi9",Bqrx1nm:"fkavljg",Bctn1xl:"fk56vqo",h5esng:"ff3wi9b",Bh6z0a4:"f1ikwg0d",Bh953qp:"f10l1t5h"}},{d:[".fmnzpld{margin-top:2px;}",".fqerorx{flex-grow:1;}",".f1ozlkrg{border-top-left-radius:0;}",".f10ostut{border-top-right-radius:0;}",".f1deotkl{border-bottom-left-radius:0;}",".f1krrbdw{border-bottom-right-radius:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}",'.f1wl9k8s::before{content:"";}',".f1yn80uh::before{width:var(--strokeWidthThin);}",".f68mna0::before{height:24px;}",".f1p5zmk::before{background-color:var(--colorNeutralStroke1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"],h:[".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1ijtazh:hover{background-color:var(--colorNeutralBackground1);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1q1x1ba:hover .fui-MenuItem__icon{color:var(--colorNeutralForegroundDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f1to34ca:hover:active{background-color:var(--colorNeutralBackground1);}"],f:[".ft33916:focus{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkavljg:hover{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fk56vqo:hover .fui-MenuItem__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff3wi9b:hover .fui-MenuItem__icon{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ikwg0d:focus{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f10l1t5h:focus{background-color:Canvas;}}",{m:"(forced-colors: active)"}]]}),Su=e=>{const t=Cu(),n=mu(),r=fu(),o=hu(),i=vu(),a=yu();return e.root.className=(0,Ms.z)(lu,n,e.disabled&&t.disabled,e.root.className),e.content&&(e.content.className=(0,Ms.z)(pu,r,e.content.className)),e.checkmark&&(e.checkmark.className=(0,Ms.z)(uu,t.checkmark,e.checkmark.className)),e.secondaryContent&&(e.secondaryContent.className=(0,Ms.z)(gu,!e.disabled&&o,e.secondaryContent.className)),e.icon&&(e.icon.className=(0,Ms.z)(cu,i,e.icon.className)),e.submenuIndicator&&(e.submenuIndicator.className=(0,Ms.z)(du,a,e.submenuIndicator.className)),(e=>{const t=su();e.checkmark&&(e.checkmark.className=(0,Ms.z)(t.root,e.checked&&t.rootChecked,e.checkmark.className))})(e),e},bu=a.forwardRef(((e,t)=>{const n=au(e,t);return Su(n),(0,il.$e)("useMenuItemStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.FD)(e.root,{children:[e.checkmark&&(0,Bs.Y)(e.checkmark,{}),e.icon&&(0,Bs.Y)(e.icon,{}),e.content&&(0,Bs.Y)(e.content,{}),e.secondaryContent&&(0,Bs.Y)(e.secondaryContent,{}),e.submenuIndicator&&(0,Bs.Y)(e.submenuIndicator,{})]})))(n)}));bu.displayName="MenuItem";const Eu=()=>ne()?OfficeaicopilotStrings.ChatInputTitle:"Prompt area",Tu=()=>ne()?OfficeaicopilotStrings.StarterPromptMenuTitle:"Prompt Guide",Iu=()=>ne()?OfficeaicopilotStrings.SubmitButtonTitle:"Send",_u=()=>ne()?OfficeaicopilotStrings.ChatInputDefaultPlaceholder:"Choose a starter prompt or type your own",wu="",Pu=(0,es.Q)(os),xu=(0,Za.n)({item:{[`&:hover .${cu}`]:{color:Pu.themePrimary}},menuParent:{width:"100%"}});let ku;const Au=e=>a.createElement(Qc,null,e.showSectionTopDivider&&a.createElement(Xc,null),e.sectionHeader!==wu&&a.createElement(eu,null,e.sectionHeader),e.starterPrompts.map((e=>Lu(e)))),Lu=e=>{const t=(0,nu.A)(e.iconHover,e.iconRegular);return a.createElement(bu,{className:xu().item,icon:a.createElement(t,null),onClick:()=>Du(e.text)},e.text)},Du=e=>{ku.handleOnClickStarterPromptMenuItem&&ku.handleOnClickStarterPromptMenuItem(e)},Ou=({title:e,isDisabled:t,isMenuOpen:n,setMenuOpen:r,handleClick:o,positioningRef:i,menuProps:s})=>{const l=(0,a.useRef)(Ls()),c=(0,a.useRef)((0,Ms.z)(l.current.root,Ds().root)),u=(0,a.useRef)((0,Ms.z)(l.current.root,Os().root)),d=(0,a.useRef)(Ns()),p=(0,a.useRef)(Rs().root),g=(0,a.useRef)(Fs().root),[m,f]=(0,a.useState)(l.current.root),[h,v]=(0,a.useState)(d.current.root);(0,a.useEffect)((()=>{t?(f(u.current),v(g.current)):n?(f(c.current),v(p.current)):(f(l.current.root),v(d.current.root))}),[t,n]);return a.createElement(a.Fragment,null,a.createElement(al,{className:m,title:e,"aria-haspopup":!0,"aria-expanded":n,role:"button",icon:{className:h,children:n?a.createElement(hc,null):a.createElement(vc,null)},disabled:t,onClick:()=>r(!n)}),a.createElement(gc,{open:n,onOpenChange:(e,t)=>{r(t.open)},positioning:{positioningRef:i}},(ku=s,a.createElement(Nc,{className:xu().menuParent},a.createElement(zc,null,ku.sections.map((e=>Au(e))))))))},Nu=(0,es.Q)(os),Ru=(0,Za.n)({root:Object.assign(Object.assign(Object.assign({backgroundColor:Nu.neutralLight,backgroundRepeat:"no-repeat",backgroundPositionX:"center",backgroundPositionY:"center"},Xa.Pt.borderColor(Nu.neutralLight)),Xa.Pt.borderRadius(Nu.borderRadiusXLarge)),{marginRight:"2px",width:"32px",height:"32px","&:hover":{backgroundColor:Nu.neutralTertiaryAlt}})}),Fu=(0,Za.n)({root:Object.assign(Object.assign({backgroundColor:Nu.neutralTertiary},Xa.Pt.borderColor(Nu.neutralQuaternary)),{"&:hover":{backgroundColor:Nu.neutralTertiary}})}),Mu=(0,Za.n)({root:{"& svg > path":{fill:Nu.neutralPrimary}}}),Bu=(0,Za.n)({root:{"& svg > path":{fill:Nu.themePrimary}}}),Uu=(0,Za.n)({root:{"& svg > path":{fill:Nu.neutralQuaternary}}}),Hu=({title:e,isDisabled:t,handleClick:n})=>{const[r,o]=a.useState(!1),i=(0,a.useRef)(Ru()),s=(0,a.useRef)((0,Ms.z)(i.current.root,Fu().root)),l=(0,a.useRef)(Mu()),c=(0,a.useRef)(Bu().root),u=(0,a.useRef)(Uu().root),[d,p]=(0,a.useState)(i.current.root),[g,m]=(0,a.useState)(l.current.root);return(0,a.useEffect)((()=>{t?(p(s.current),m(u.current)):(m(r?c.current:l.current.root),p(i.current.root))}),[t,r]),a.createElement(al,{className:d,title:e,"aria-label":e,role:"button",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),icon:{className:g,children:r?a.createElement(mc,null):a.createElement(fc,null)},onClick:n,disabled:t})},Gu=a.forwardRef((({inputStyles:e,placeholderText:t,chatInputTabIndex:n,isDisabled:r,handleKeyDown:o,handleKeyUp:i,handleOnPaste:s,handleOnBeforeInput:l,handleOnInput:c,handleOnChatInputControlMount:u,handleOnChatInputControlUnmount:d},p)=>{const g=(0,a.useRef)();(0,a.useImperativeHandle)(p,(()=>({setInputText:e=>{m(e)},getInputText:()=>f(),getInputSpanElement:()=>g.current,setFocus:()=>{h()}})));const m=e=>{const t=g.current;t&&(t.innerText=e)},f=()=>{let e=wu;const t=g.current;return t&&(e=t.innerText),e},h=()=>{if(r)return;const e=g.current;e&&(e.focus(),e.firstChild&&window.getSelection().setPosition(e.firstChild,e.innerText.length))};return(0,a.useEffect)((()=>(u&&u(),()=>{d&&d()})),[]),a.createElement("span",{ref:g,className:e,title:t,"aria-label":t,role:"textbox",tabIndex:n,contentEditable:!r,suppressContentEditableWarning:!r,onKeyDown:o,onKeyUp:i,onPaste:s,onBeforeInput:l,onInput:c})})),zu=(0,es.Q)(os),qu={chatInput:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:zu.neutralPrimary,backgroundColor:zu.neutralLight},Xa.Pt.border("1px","solid",zu.neutralLighterAlt)),Xa.Pt.borderRadius(zu.borderRadiusXLarge)),Xa.Pt.margin(0,"16px","16px","16px")),Xa.Pt.padding("4px")),Xa.Pt.gap("4px")),{position:"relative",zIndex:"1"}),chatInputContainer:Object.assign({},Xa.Pt.margin("12px","12px","4px","12px")),userInput:Object.assign(Object.assign(Object.assign(Object.assign({},ts.g.body1),{alignItems:"flex-start",fontStyle:"normal"}),Xa.Pt.gap("1px")),{whiteSpace:"pre-wrap","&:focus":Object.assign({},Xa.Pt.outline(0))}),ghostInput:Object.assign(Object.assign(Object.assign(Object.assign({color:zu.neutralSecondaryAlt,alignItems:"flex-start"},ts.g.body1),{fontStyle:"normal"}),Xa.Pt.gap("1px")),{"-webkit-user-select":"none","-ms-user-select":"none",userSelect:"none"}),chatInputButtons:Object.assign(Object.assign({backgroundColor:zu.neutralLight,width:"100%",flexDirection:"row",flexWrap:"wrap"},Xa.Pt.gap("2px")),{marginBottom:"12px",justifyContent:"space-between"}),chatInputLeftButtons:{alignSelf:"flex-start"},chatInputRightButtons:{alignSelf:"flex-end"},contextualMenu:Object.assign(Object.assign(Object.assign({display:"flex",flexDirection:"column",alignItems:"flex-start"},Xa.Pt.padding("6px")),{backgroundColor:zu.neutralLight,boxShadow:zu.shadow4}),Xa.Pt.borderRadius("8px"))},Wu=(0,Za.n)(qu),ju=(0,Za.n)({chatInput:{":focus-within":{"::after":Object.assign(Object.assign({position:"absolute",zIndex:"-1",bottom:"0",left:"0",width:"100%",height:"5px",content:"''"},Xa.Pt.borderRadius(0,0,"8px","8px")),{backgroundImage:`linear-gradient(to right, ${zu.themePrimary}, ${zu.themeSecondary})`})}}}),Vu=(0,Za.n)({chatInput:{backgroundColor:zu.neutralTertiary},ghostInput:{color:zu.neutralQuaternary},chatInputButtons:{backgroundColor:zu.neutralTertiary}});const Qu=(0,es.Q)(os),Ju=function(e){var t,n,r,o,i,a,s,l;const c={chatInput:null!==(t=e.chatInput)&&void 0!==t?t:{},chatInputContainer:null!==(n=e.chatInputContainer)&&void 0!==n?n:{},userInput:null!==(r=e.userInput)&&void 0!==r?r:{},ghostInput:null!==(o=e.ghostInput)&&void 0!==o?o:{},chatInputButtons:null!==(i=e.chatInputButtons)&&void 0!==i?i:{},chatInputLeftButtons:null!==(a=e.chatInputLeftButtons)&&void 0!==a?a:{},chatInputRightButtons:null!==(s=e.chatInputRightButtons)&&void 0!==s?s:{},contextualMenu:null!==(l=e.contextualMenu)&&void 0!==l?l:{}};return(0,Za.n)(c)}({userInput:{paddingRight:"2px"},contextualMenu:Object.assign(Object.assign(Object.assign({display:"flex",flexDirection:"column",alignItems:"flex-start"},Xa.Pt.padding(0)),{maxWidth:"288px",backgroundColor:Qu.neutralLight,boxShadow:`0px 0px 2px 0px ${Qu.black}1F, 0px 8px 16px 0px ${Qu.black}24`}),Xa.Pt.borderRadius("12px"))});var Ku=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))};Sc();a.forwardRef((({isDisabled:e,overrideStyles:t,chatInputTabIndex:n=0,chatInputContainerTabIndex:r=-1,chatInputContainerTitle:o=Eu(),placeholderText:i=_u(),maxInputCharLimit:s=300,handleKeyDown:l,handleKeyUp:c,handleOnPaste:u,handleOnBeforeInput:d,handleOnInput:p,submitButtonTitle:g=Iu(),handleSubmitButtonClick:m,isMenuButtonEnabled:f=!1,shouldOpenMenuOnEmptyInput:h=!1,menuButtonTitle:v=Tu(),handleMenuButtonClick:y,handleOnOpenMenu:C,contextualMenuHandlerProps:S,handleOnChatInputControlMount:b,handleOnChatInputControlUnmount:E,handleOnBlur:T,menuProps:I},_)=>{var w;const P=(0,a.useRef)(),x=(0,a.useRef)(),k=(0,a.useRef)(),A=(0,a.useRef)(null);(0,a.useImperativeHandle)(_,(()=>({setInputText:e=>{var t;null===(t=P.current)||void 0===t||t.setInputText(e)},getInputText:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.getInputText()},getInputSpanElement:()=>{var e;return null===(e=P.current)||void 0===e?void 0:e.getInputSpanElement()},setGhostText:e=>{N(e)},getGhostText:()=>O(),setFocus:()=>{var e;null===(e=P.current)||void 0===e||e.setFocus()},closeMenu:()=>{f&&L&&D(!1)}})));const[L,D]=(0,a.useState)(!1),O=()=>{let e=wu;const t=k.current;return t&&(e=t.innerText),e},N=(0,a.useCallback)((e=>{const t=k.current;t&&(t.innerText=e)}),[]);(0,a.useEffect)((()=>{N(i)}),[i,N]),a.useEffect((()=>{var e;x.current&&(null===(e=A.current)||void 0===e||e.setTarget(x.current))}),[A,x]);const R=Wu(),F=Ju(),M=ju(),B=Vu(),U=(0,a.useRef)({chatInput:"",chatInputContainer:"",userInput:"",ghostInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),H=(0,a.useRef)({chatInput:"",chatInputContainer:"",userInput:"",ghostInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),G=(0,a.useRef)({chatInput:"",chatInputContainer:"",userInput:"",ghostInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""}),[z,q]=(0,a.useState)(R);return(0,a.useEffect)((()=>{let e={chatInput:"",chatInputContainer:"",userInput:"",ghostInput:"",chatInputButtons:"",chatInputLeftButtons:"",chatInputRightButtons:"",contextualMenu:""};if(ae()===re.IOS)e=F;for(const t in R)U.current[t]=(0,Ms.z)(R[t],e[t]);for(const e in R)H.current[e]=(0,Ms.z)(U.current[e],M[e]);for(const e in R)G.current[e]=(0,Ms.z)(U.current[e],B[e])}),[]),(0,a.useEffect)((()=>{if(t)for(const e in R)H.current[e]=(0,Ms.z)(R[e],t[e])}),[t]),(0,a.useEffect)((()=>{q(e?G.current:H.current)}),[e,t]),a.createElement("div",null,a.createElement("div",{id:"copilot-chat-input",className:z.chatInput,title:o,tabIndex:r,onClick:()=>Ku(void 0,void 0,void 0,(function*(){var t,n,r;e||document.activeElement===(null===(t=P.current)||void 0===t?void 0:t.getInputSpanElement())||(h&&f&&(null===(n=P.current)||void 0===n?void 0:n.getInputText())==wu&&!L?(C&&(yield C()),D(!0)):L&&D(!1),null===(r=P.current)||void 0===r||r.setFocus())})),onMouseDown:e=>{se()&&e.preventDefault()},onBlur:()=>{var e;se()&&!L&&(null===(e=P.current)||void 0===e?void 0:e.getInputText())===wu&&T()},ref:x},a.createElement("div",{className:z.chatInputContainer},a.createElement(Gu,{ref:P,inputStyles:z.userInput,placeholderText:i,chatInputTabIndex:n,isDisabled:e,handleKeyDown:e=>{var t,n;l&&!l(e)||"Enter"===e.key&&(e.preventDefault(),m(null===(t=P.current)||void 0===t?void 0:t.getInputText()),null===(n=P.current)||void 0===n||n.setInputText(wu),N(i))},handleKeyUp:e=>{var t;c&&!c(e)||((null===(t=P.current)||void 0===t?void 0:t.getInputText())===wu?N(i):O()===i&&N(wu))},handleOnPaste:e=>{var t;if(u&&!u(e))return;e.preventDefault();const n=e.clipboardData.getData("Text"),r=n.length||0,o=null===(t=P.current)||void 0===t?void 0:t.getInputText(),i=window.getSelection();if(!i.rangeCount)return;const a=i.toString(),l=o.length-a.length,c=n.substring(0,s-l);i.deleteFromDocument(),l+r>=s?i.getRangeAt(0).insertNode(document.createTextNode(c)):i.getRangeAt(0).insertNode(document.createTextNode(n)),i.collapseToEnd()},handleOnBeforeInput:e=>{d&&!d(e)||(D(!1),N(wu))},handleOnInput:e=>{!p||p(e)},handleOnChatInputControlMount:b,handleOnChatInputControlUnmount:E}),a.createElement("span",{role:"textbox",ref:k,className:z.ghostInput}),a.createElement("span",{"aria-hidden":!0},"")),a.createElement(No,{className:z.chatInputButtons},a.createElement("div",{className:z.chatInputLeftButtons},f&&a.createElement(Ou,{title:v,isDisabled:e||0===(null===(w=null==I?void 0:I.sections)||void 0===w?void 0:w.length),isMenuOpen:L,setMenuOpen:D,handleClick:()=>Ku(void 0,void 0,void 0,(function*(){y&&y(),L?D(!1):(C&&(yield C()),D(!0))})),positioningRef:A,menuProps:I})),a.createElement("div",{className:z.chatInputRightButtons},a.createElement(Hu,{title:g,isDisabled:e,handleClick:e=>{var t,n;e.stopPropagation();const r=null===(t=P.current)||void 0===t?void 0:t.getInputText();r.trimStart()!==wu&&(m(r),null===(n=P.current)||void 0===n||n.setInputText(wu),N(i))}})))))}));Sc();var Xu;!function(e){e.RestShy="RestShy",e.Expanded="Expanded"}(Xu||(Xu={}));const Zu=(0,es.Q)(os),Yu={freCard:{},root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Xa.Pt.padding("12px","16px")),{alignItems:"center",textAlign:"center",color:Zu.neutralPrimary,backgroundColor:Zu.neutralLight,boxShadow:`0px 1px 2px ${Zu.black}24 , 0px 0px 2px ${Zu.black}1f`}),Xa.Pt.margin("1px","16px","none","16px")),Xa.Pt.border("1px","solid",Zu.neutralLight)),Xa.Pt.borderRadius("8px")),freImage:{height:"64px",width:"64px"},freHeaderText:{marginTop:"8px"},freDescriptionText:Object.assign(Object.assign({textAlign:"center",whiteSpace:"pre-wrap"},Xa.Pt.padding("1px")),Xa.Pt.margin("20px","0px","0px")),freButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:Zu.neutralLight,backgroundColor:Zu.themePrimary,width:"100%"},Xa.Pt.padding("5px","12px")),Xa.Pt.margin("20px","0px","0px")),Xa.Pt.borderRadius("4px")),Xa.Pt.border("none")),{":hover":Object.assign({cursor:"pointer",backgroundColor:Zu.themePrimary},Xa.Pt.border("none")),":active":Object.assign({backgroundColor:Zu.themePrimary},Xa.Pt.border("none"))})},$u=((0,Za.n)(Yu),()=>a.createElement("svg",{width:"18",height:"15",viewBox:"0 0 18 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.56195 1.26181C8.75109 0.912709 9.2521 0.912735 9.44121 1.26186L15.9418 13.2628C16.1222 13.5959 15.881 14.0009 15.5021 14.0009H2.49942C2.12051 14.0009 1.8793 13.5959 2.0598 13.2627L8.56195 1.26181ZM10.3205 0.785573C9.75318 -0.261795 8.25014 -0.261875 7.68271 0.785435L1.18056 12.7864C0.639049 13.7858 1.3627 15.0009 2.49942 15.0009H15.5021C16.6388 15.0009 17.3624 13.786 16.821 12.7865L10.3205 0.785573ZM9.49996 5.50023C9.49996 5.22409 9.2761 5.00023 8.99996 5.00023C8.72382 5.00023 8.49996 5.22409 8.49996 5.50023V9.50022C8.49996 9.77637 8.72382 10.0002 8.99996 10.0002C9.2761 10.0002 9.49996 9.77637 9.49996 9.50022V5.50023ZM9.74996 11.7502C9.74996 12.1644 9.41417 12.5002 8.99996 12.5002C8.58575 12.5002 8.24996 12.1644 8.24996 11.7502C8.24996 11.336 8.58575 11.0002 8.99996 11.0002C9.41417 11.0002 9.74996 11.336 9.74996 11.7502Z",fill:"url(#paint0_linear_988_37732)"}),a.createElement("defs",null,a.createElement("linearGradient",{id:"paint0_linear_988_37732",x1:"0.997314",y1:"0",x2:"17.1435",y2:"0.151426",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#C43E1C"}),a.createElement("stop",{offset:"1",stopColor:"#FF5C39"})))));(0,c.K1)({icons:{warningCardIcon:a.createElement($u,null)}});const ed=(0,es.Q)(os),td={root:Object.assign(Object.assign(Object.assign({boxShadow:ed.shadow4,backgroundColor:ed.neutralLight},Xa.Pt.borderRadius(ed.borderRadiusXLarge)),Xa.Pt.margin(ed.spacingVerticalNone,ed.spacingHorizontalL,ed.spacingVerticalXXS)),Xa.Pt.padding(ed.spacingVerticalM)),rootHighContrast:Object.assign({},Xa.Pt.border("1px","solid",ed.neutralLighterAlt)),headerText:{fontWeight:ed.fontWeightSemibold,color:ed.themePrimary},descriptionText:{color:ed.neutralQuaternaryAlt}},nd=((0,Za.n)(td),()=>a.createElement("svg",{width:"14",height:"13",viewBox:"0 0 14 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M3 0C1.61929 0 0.5 1.11929 0.5 2.5V9.5C0.5 10.8807 1.61929 12 3 12H4.75716C4.50353 11.6929 4.28261 11.3578 4.09971 11H3C2.17157 11 1.5 10.3284 1.5 9.5V2.5C1.5 1.67157 2.17157 1 3 1H10C10.8284 1 11.5 1.67157 11.5 2.5V3.59971C11.8578 3.78261 12.1929 4.00353 12.5 4.25716V2.5C12.5 1.11929 11.3807 0 10 0H3ZM9 13C11.4853 13 13.5 10.9853 13.5 8.5C13.5 6.01472 11.4853 4 9 4C6.51472 4 4.5 6.01472 4.5 8.5C4.5 10.9853 6.51472 13 9 13ZM10.8536 6.64645C11.0488 6.84171 11.0488 7.15829 10.8536 7.35355L9.70711 8.5L10.8536 9.64645C11.0488 9.84171 11.0488 10.1583 10.8536 10.3536C10.6583 10.5488 10.3417 10.5488 10.1464 10.3536L9 9.20711L7.85355 10.3536C7.65829 10.5488 7.34171 10.5488 7.14645 10.3536C6.95118 10.1583 6.95118 9.84171 7.14645 9.64645L8.29289 8.5L7.14645 7.35355C6.95118 7.15829 6.95118 6.84171 7.14645 6.64645C7.34171 6.45118 7.65829 6.45118 7.85355 6.64645L9 7.79289L10.1464 6.64645C10.3417 6.45118 10.6583 6.45118 10.8536 6.64645Z",fill:"#424242"}))),rd=()=>a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5ZM15.4462 8.39705L15.5303 8.46967C15.7966 8.73594 15.8208 9.1526 15.6029 9.44621L15.5303 9.53033L13.061 12L15.5303 14.4697C15.7966 14.7359 15.8208 15.1526 15.6029 15.4462L15.5303 15.5303C15.2641 15.7966 14.8474 15.8208 14.5538 15.6029L14.4697 15.5303L12 13.061L9.53033 15.5303C9.26406 15.7966 8.8474 15.8208 8.55379 15.6029L8.46967 15.5303C8.2034 15.2641 8.1792 14.8474 8.39705 14.5538L8.46967 14.4697L10.939 12L8.46967 9.53033C8.2034 9.26406 8.1792 8.8474 8.39705 8.55379L8.46967 8.46967C8.73594 8.2034 9.1526 8.1792 9.44621 8.39705L9.53033 8.46967L12 10.939L14.4697 8.46967C14.7359 8.2034 15.1526 8.1792 15.4462 8.39705Z",fill:"#616161"})),od=(0,es.Q)(os),id={root:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Xa.Pt.margin(od.spacingVerticalNone,od.spacingHorizontalXL,od.spacingVerticalL,"15px")),{minHeight:"48px"}),Xa.Pt.borderRadius(od.borderRadiusXLarge)),{backgroundColor:od.neutralLight,boxShadow:od.shadow4}),Xa.Pt.overflow("hidden")),{transformOrigin:"bottom",verticalAlign:"center"}),rootHighContrast:Object.assign({},Xa.Pt.border("1px","solid",od.neutralLighterAlt)),progressBarStyle:{backgroundImage:`linear-gradient(90.5deg, ${od.themeLight} 10%, ${od.themeDarkAlt} 32%, ${od.themeLighterAlt} 55%, ${od.themeLighter} 72%, ${od.neutralLighter} 100%)`,width:"192px",maxWidth:"100%"},headerStyle:Object.assign(Object.assign({fontWeight:od.fontWeightSemibold},Xa.Pt.padding(od.spacingVerticalM)),{lineHeight:"143%",color:od.neutralPrimary}),stopButtonStyle:Object.assign(Object.assign({height:"16px",display:"flex",alignItems:"center",alignContent:"center"},Xa.Pt.padding(od.spacingVerticalM)),{fontFamily:od.fontFamilyBase,fontSize:od.fontSizeBase200}),stopButtonTextStyle:Object.assign(Object.assign({},Xa.Pt.padding("7px")),ts.g.caption1),inlineStopIcon:Object.assign(Object.assign(Object.assign(Object.assign({},Xa.Pt.padding("10px")),Xa.Pt.margin(od.spacingVerticalNone,od.spacingHorizontalNone,od.spacingVerticalNone,od.spacingHorizontalS)),Xa.Pt.border("0px")),{height:"44px",width:"44px",selectors:{"svg > path":{fill:od.neutralPrimary},":hover":{backgroundColor:"transparent",color:od.black},":focus":{backgroundColor:"transparent",color:od.black}}})};(0,Za.n)(id);(0,c.K1)({icons:{StopGeneratingIcon:a.createElement(nd,null),InlineStopIcon:a.createElement(rd,null)}});const ad=(0,es.Q)(os),sd={root:Object.assign({justifyContent:"flex-end",flexWrap:"wrap"},Xa.Pt.margin(ad.spacingHorizontalNone,ad.spacingHorizontalS,ad.spacingHorizontalNone,"15px")),button:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({textAlign:"start",color:ad.neutralPrimary,backgroundColor:"transparent"},ts.g.caption1),Xa.Pt.borderRadius(ad.borderRadiusXLarge)),Xa.Pt.border("1px","solid",ad.themeMedium)),Xa.Pt.padding(ad.spacingVerticalSNudge,ad.spacingHorizontalS)),Xa.Pt.margin(ad.spacingVerticalXS)),{"&:hover":Object.assign({backgroundColor:ad.themeLight},Xa.Pt.border("1px","solid",ad.themeDarker))}),refreshButton:{minWidth:"fit-content"},refreshButtonIcon:{width:"14px",height:"14px"}},ld=((0,Za.n)(sd),(0,es.Q)(os)),cd={root:Object.assign(Object.assign(Object.assign(Object.assign({"> :not(:first-child)":{marginTop:"0px"},marginBottom:"16px"},Xa.Pt.padding("12px")),{boxShadow:ld.shadow4,marginLeft:"16px",marginRight:"16px"}),Xa.Pt.borderRadius("8px")),{color:ld.neutralPrimary,backgroundColor:ld.neutralLight}),buttonStack:{"> *":{marginTop:"8px"}},cardHeader:Object.assign({},ts.g.body1),zeroQueryButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({flexWrap:"wrap",color:ld.black},ts.g.body1),{backgroundColor:ld.neutralLight}),Xa.Pt.border("1px","solid",ld.neutralLighterAlt)),Xa.Pt.gap("4px")),{paddingBottom:"4px"}),Xa.Pt.borderRadius("4px")),Xa.Pt.padding("0px","12px","4px","12px")),{justifyContent:"flex-start",shape:"rounded",height:"40px"}),buttonIcon:{height:"14px",width:"14px",marginRight:"11px",marginLeft:"5px","& svg":{height:"14px",width:"14px"},"& svg > path":{fill:ld.neutralPrimary}},zeroQueryButtonDisabled:{color:ld.neutralQuaternary,"& svg":{filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"}}};(0,Za.n)(cd);n(58651);var ud=n(58651);var dd=function(){return Office.context.platform===Office.PlatformType.iOS||Office.context.platform===Office.PlatformType.Mac},pd=function(){return Office.context.platform===Office.PlatformType.iOS},gd=n(21116);function md(e){if(Array.isArray(e))return e}function fd(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vd(e,t){if(e){if("string"==typeof e)return hd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hd(e,t):void 0}}function yd(e,t){return md(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||vd(e,t)||fd()}function Cd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){(0,i.t)(e,t,n[t])}))}return e}function Sd(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function bd(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ed(e){return function(e){if(Array.isArray(e))return hd(e)}(e)||bd(e)||vd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Td=n(28679),Id=n.n(Td),_d=n(22180),wd=n.n(_d),Pd=n(87720),xd=n.n(Pd),kd=n(34159),Ad=n.n(kd),Ld=n(11843),Dd=n.n(Ld),Od=n(79216),Nd=n.n(Od),Rd=n(27639),Fd={};Fd.styleTagTransform=Nd(),Fd.setAttributes=Ad(),Fd.insert=xd().bind(null,"head"),Fd.domAPI=wd(),Fd.insertStyleElement=Dd();Id()(Rd.A,Fd);Rd.A&&Rd.A.locals&&Rd.A.locals;var Md,Bd,Ud,Hd,Gd,zd,qd,Wd,jd,Vd,Qd,Jd,Kd,Xd,Zd,Yd,$d,ep,tp,np,rp,op,ip,ap,sp,lp,cp,up,dp,pp,gp,mp,fp,hp,vp,yp,Cp;function Sp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ep(e,t,n){return t&&bp(e.prototype,t),n&&bp(e,n),e}!function(e){e[e.FAILED=0]="FAILED",e[e.BLOCKED=1]="BLOCKED",e[e.SUCCESS=2]="SUCCESS",e[e.DISMISSED=3]="DISMISSED",e[e.PARTIAL_SUCCESS=4]="PARTIAL_SUCCESS",e[e.UNSUPPORTED=5]="UNSUPPORTED",e[e.UNEXPECTED_VERSION=6]="UNEXPECTED_VERSION",e[e.USER_ABORTED=7]="USER_ABORTED",e[e.CONTENT_GENERATION_DISABLED=8]="CONTENT_GENERATION_DISABLED",e[e.PAUSED_ON_WARNING=9]="PAUSED_ON_WARNING"}(Md||(Md={})),function(e){e[e.NONE=0]="NONE",e[e.DESIGNER_FAILED=1]="DESIGNER_FAILED",e[e.DESIGNER_DISABLED=2]="DESIGNER_DISABLED",e[e.CREATE_PRESENTATION_BLOCKED=3]="CREATE_PRESENTATION_BLOCKED",e[e.ADD_SLIDE_BLOCKED=4]="ADD_SLIDE_BLOCKED",e[e.CREATE_PRESENTATION_BLOCKED_ON_WARNING=5]="CREATE_PRESENTATION_BLOCKED_ON_WARNING",e[e.STRUCTURE_PRESENTATION_BLOCKED=6]="STRUCTURE_PRESENTATION_BLOCKED",e[e.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING=7]="STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING",e[e.SEGMENT_TO_SLIDE_SERVER_ERROR=8]="SEGMENT_TO_SLIDE_SERVER_ERROR",e[e.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS=9]="DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS",e[e.APPLY_CLP_LABEL_FAILED=10]="APPLY_CLP_LABEL_FAILED",e[e.COMMANDING_DISABLED=11]="COMMANDING_DISABLED",e[e.UNEXPECTED_VERSION=12]="UNEXPECTED_VERSION",e[e.CONTENT_INSERTION_FAILED=13]="CONTENT_INSERTION_FAILED",e[e.DESIGNER_FAILED_ALREADY_HAS_ANIMATION=14]="DESIGNER_FAILED_ALREADY_HAS_ANIMATION",e[e.DOCUMENT_CHANGED_BEFORE_COMMAND_EXECUTION=15]="DOCUMENT_CHANGED_BEFORE_COMMAND_EXECUTION",e[e.COMMAND_HAD_NO_EFFECT=16]="COMMAND_HAD_NO_EFFECT",e[e.PARSE_DESIGNER_OPTIONS_FAILED=17]="PARSE_DESIGNER_OPTIONS_FAILED",e[e.FETCH_DESIGN_SUGGESTION_FAILED=18]="FETCH_DESIGN_SUGGESTION_FAILED",e[e.APPLY_DESIGN_SUGGESTION_FAILED=19]="APPLY_DESIGN_SUGGESTION_FAILED",e[e.PREP_DESIGN_INPUT_FAILED=20]="PREP_DESIGN_INPUT_FAILED",e[e.DOC_CLOSING_WITH_INCOMPLETE_PROTOCOL=21]="DOC_CLOSING_WITH_INCOMPLETE_PROTOCOL",e[e.FETCH_DESIGN_SUGGESTION_PARTIAL_SUCCESS=22]="FETCH_DESIGN_SUGGESTION_PARTIAL_SUCCESS",e[e.PREPARE_STAGE_TIMED_OUT=23]="PREPARE_STAGE_TIMED_OUT",e[e.EMPTY_JOFC_CMD_RESULT_ID=24]="EMPTY_JOFC_CMD_RESULT_ID",e[e.JOFC_EXCEPTION=25]="JOFC_EXCEPTION",e[e.MULTIPLE_GENERATE_IN_ODSL=26]="MULTIPLE_GENERATE_IN_ODSL",e[e.IMAGE_INVALID_ODSL=27]="IMAGE_INVALID_ODSL",e[e.UNKNOWN_ERROR=100]="UNKNOWN_ERROR"}(Bd||(Bd={})),function(e){e.Text="text",e.Shape="shape",e.Presentation="presentation",e.Slide="slide",e.Image="image"}(Ud||(Ud={})),function(e){e.CreatePresentation="CreatePresentation",e.AddSlides="AddSlides",e.AddImage="AddImage",e.AddText="AddText",e.RewriteText="RewriteText",e.ChangeStyle="ChangeStyle",e.PresentationSummary="PresentationSummary",e.PresentationSummaryWithVisual="PresentationSummaryWithVisual",e.ImportantSlides="ImportantSlides",e.CallToAction="CallToAction",e.TransformDocument="TransformDocument",e.OrganizePresentation="OrganizePresentation",e.UserCancellation="UserCancellation",e.Default="Default"}(Hd||(Hd={})),function(e){e.Cancelled="cancelled",e.Failure="fail",e.NotHandled="nothandled",e.Success="success"}(Gd||(Gd={})),function(e){e.Chat="chat",e.Human="human"}(zd||(zd={})),function(e){e.Animation="Animation",e.Transition="Transition",e.SmartArt="Smartart",e.Table="Table",e.Background="Background",e.Audio="Audio",e.Video="Video",e.Theme="Theme",e.Shapes="Shapes",e.TextBox="TextBox"}(qd||(qd={})),function(e){e.CHATPPT="Chat PPT",e.COPILOTSTART="Copilot Start",e.DECKSUMMARY="Deck Summary",e.COPILOTLAB="Copilot Lab",e.SELFHELPSEARCH="SelfHelpSearch",e.DESIGNERCARD="Designer-Card",e.SKETCHTOIMAGE="SketchToImage",e.OCV_FEATURE_AREA="PowerPoint\\Copilot"}(Wd||(Wd={})),function(e){e.AIThumbsDown="AIThumbsDown",e.AIThumbsUp="AIThumbsUp"}(jd||(jd={})),function(e){e.BLANK="Blank",e.LESS_WORD_COUNT="LessWordCount",e.USED="Used"}(Vd||(Vd={})),function(e){e.IDLE="idle",e.QUERY_PROCESSING="query processing",e.EXECUTING="executing",e.STREAMING="streaming",e.WAITING_FOR_COPILOT_WF_RESPONSE="waiting for copilot workflow response",e.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE="waiting for content processing workflow response",e.WAITING_FOR_SEGMENT_TO_SLIDE_WF_RESPONSE="waiting for segment to slide workflow response",e.WAITING_FOR_SUMMARY_WF_RESPONSE="waiting for summary workflow response",e.WAITING_FOR_ORGANIZE_WF_RESPONSE="waiting for organize workflow response",e.WAITING_FOR_ACTION_AI_WF_RESPONSE="waiting for action ai workflow response",e.WAITING_FOR_STORY_TELLER_WF_RESPONSE="waiting for story teller workflow response",e.WAITING_FOR_PRESENTATIONTRANSFORM_WF_RESPONSE="waiting presentation-transform workflow response",e.WAITING_FOR_PRESENTATION_RECOMMENDATION_WF_RESPONSE="waiting for presentation-recommendation workflow response",e.WAITING_FOR_CONTENT_VALIDATOR_WF_RESPONSE="waiting for content validator workflow response",e.EXECUTING_APPLYJOFC_PROTOCOL="executing apply jofc protocol",e.WAITING_FOR_USER_PROFILE_WF_RESPONSE="waiting for user profile workflow response"}(Qd||(Qd={})),function(e){e.EXPLANATIONS="explanations",e.SUGGESTIONS="suggestions",e.DISAMBIGUATIONS="disambiguations"}(Jd||(Jd={})),function(e){e.ModalDialog="ModalDialog",e.Taskpane="Taskpane"}(Kd||(Kd={})),function(e){e.Like="Like",e.Dislike="Dislike",e.Idea="Idea",e.Unclassified="Unclassified"}(Xd||(Xd={})),function(e){e.notSet="NotSet",e.true="True",e.false="False"}(Zd||(Zd={})),function(e){e.Command="command",e.Summarize="summarize",e.ImportantSlide="importantslide",e.ActionItem="actionitem",e.SegmentSummarize="segmentsummarize",e.StyleSummarize="stylesummarize",e.Help="help",e.Undo="undo",e.Icon="icon",e.Invalid="invalid",e.OutOfScope="out of scope",e.ImageOutOfScope="imageoutofscope"}(Yd||(Yd={})),function(e){e.Slide="slide",e.Text="text",e.Image="image"}($d||($d={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(ep||(ep={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.PromptOnClick="Prompt on Click",e.PromptFavoriteClick="Prompt Favicon",e.FavoriteFilterClick="Favorite Filter Click",e.FliterChange="Filter Change"}(tp||(tp={})),function(e){e[e.None=0]="None",e[e.CreateNewPresentationFromExisting=1]="CreateNewPresentationFromExisting",e[e.OrganizeStructuredPresentation=2]="OrganizeStructuredPresentation"}(np||(np={})),function(e){e.CatchUp="Catch Up",e.Create="Create",e.Ask="Ask",e.Understand="Understand",e.Edit="Edit",e.Customize="Customize"}(rp||(rp={})),function(e){e.XClientFlights="X-Client-Flights",e.XClientLanguage="X-Client-Language",e.ClientRequestId="Client-Request-Id"}(op||(op={})),function(e){e.OffensiveContent="OffensiveContent",e.UnsupportedLanguageError="UnsupportedLanguageError",e.InferenceAPIError="InferenceAPIError",e.LicensingError="LicensingError",e.InputQueryError="InputQueryError",e.InvalidInputError="InvalidInputError",e.PostProcessProgramError="PostProcessProgramError",e.ResolveDelegationsError="ResolveDelegationsError",e.ODSLSyntaxError="ODSLSyntaxError",e.SydneyCancelledError="SydneyCancelledError",e.DisambiguationError="DisambiguationError",e.DisengagedError="DisengagedError",e.TokenCountError="TokenCountError",e.VisualDescriptionGeneration="VisualDescriptionGeneration",e.InvalidLanguageError="InvalidLanguageError",e.InvalidIntentError="InvalidIntentError",e.InvalidSignalError="InvalidSignalError",e.Text2ImageError="Text2ImageError",e.ODSLParseError="ODSLParseError",e.OffensiveContentError="OffensiveContentError",e.ClientProgramResponseError="ClientProgramResponseError",e.SkillFailedError="SkillFailedError"}(ip||(ip={})),function(e){e.Input_query="input-query",e.Input_content="input-content",e.Generated_sydney_output="generated-sydney-output",e.Generated_output="generated-output",e.Too_long="too-long",e.Too_short="too-short",e.Invalid="invalid",e.OutOfScope="out-of-scope",e.UnsupportedMultiAgent="unsupported-multi-agent",e.DocumentProcessingDenied="document-processing-denied",e.Unsupported_language="unsupported-lang",e.Throttled="throttled",e.Timeout="timeout",e.User_throttled="user-throttled",e.Scenario_throttled="scenario-throttled",e.Missing_Service_Plan="missing-service-plan",e.Bad_Token="bad-token",e.Token="token",e.Unsupported_Program="unsupported-program",e.InvalidSource="invalid-source",e.Unknown="unknown",e.BadResponse="bad-response",e.NotAvailable="not-available",e.BadValue="bad-value",e.Cancelled="cancelled",e.DisambiguationRequired="disambiguation-required",e.DismissedInvalidRequiredArguments="dismissed-invalid-required-arguments",e.EmptyGeneratePrompt="empty-generate-prompt",e.EmptyGenerateSource="empty-generate-source",e.EmptyResponse="empty-response",e.ExcessTokensRequest="excess-tokens-request",e.ExcessTokensResponse="excess-tokens-response",e.FailedToGenerateVisualDescription="failed-to-generate-visual-description",e.FailedToGetInputLanguage="failed-to-get-input-language",e.GenericError="GenericError",e.GetImageDetailsFailed="get-image-details-failed",e.GetProgramFailed="get-program-failed",e.ProgramFailed="program-failed",e.InvalidPrompt="invalid-prompt",e.InvalidReplaceTextResponse="invalid-replace-text-response",e.InvalidRewriteResponse="invalid-rewrite-response",e.InvalidGenerateSource="invalid-generate-source",e.LowScore="low-score",e.Missing="missing",e.MissingRequiredArguments="missing-required-arguments",e.NoImages="no-images",e.NoOp="no-op",e.NotSupported="not-supported",e.OutputRAIDependency="output-rai-dependency",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.ParseJsonFailed="parse-json-failed",e.PerpetualDisambiguationLoop="perpetual-disambiguation-loop",e.ResponseFailed="response-failed",e.SkillFailedError="skill-failed-error",e.SydneyUnsupportedLang="sydney-unsupported-lang",e.Truncated="Truncated",e.TimeOut="time-out",e.Unexpected="unexpected",e.UnknownOpenAI="UnknownOpenAI",e.UnknownLang="unknown-lang",e.UnknownStatement="unknown-statement",e.UnrecognizedBaseUrl="unrecognized-base-url",e.Unsupported="unsupported",e.UnsupportedByAdmin="unsupported-by-admin",e.VariableUnknownName="variable-unknown-name",e.VariableWrongType="variable-wrong-type",e.WrongType="wrong-type",e.ZeroParsed="zero-parsed"}(ap||(ap={})),function(e){e.SydneyError="SydneyError",e.DisengagedError="DisengagedError"}(sp||(sp={})),function(e){e.InvalidConversationId="bad-conversation-id",e.InvalidRequest="sydney-invalid-request",e.SydneyValidationFailed="sydney-validation-failed",e.ConnectionNotConnected="connection-not-in-connected-state",e.InvocationCanceled="invocation-canceled",e.CannotProvideToken="cannot-provide-token",e.ServerTimeout="server-timeout",e.WebsocketFailedToConnect="websocket-failed-to-connect",e.WebsocketClosed="websocket-closed-with-1006",e.ServerOnClose="server-on-close",e.InvalidMsgType="invalid-msg-type",e.UserThrottled="user-throttled",e.Ic3="ic3",e.SubstrateSearch="substrate-search",e.PolymerLLM="polymer-llm",e.RequestTooBig="request-too-big",e.Unknown="unknown",e.OutOfCredits="out-of-credits"}(lp||(lp={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidIntent="InvalidIntentError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPIError="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjection",e.LicensingError="LicensingError",e.InputQueryError="InputQueryError",e.VisualDescriptionGeneration="VisualDescriptionGeneration"}(cp||(cp={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooShort="too-short",e.MissingPPTContent="missing-ppt-content",e.TooLong="too-long",e.Invalid="invalid",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.EmptyResponse="empty-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.Bad_Token="bad-token",e.FailedToGetInputLanguage="failed-to-get-input-language",e.InputRAIDependency="input-rai-dependency",e.OutputRAIDependency="output-rai-dependency",e.FailedToGenerateVisualDescription="failed-to-generate-visual-description"}(up||(up={})),function(e){e.Nudge_UserQuery="Nudge_UserQuery",e.AppChat_PreFetchQuery="AppChat_PreFetchQuery",e.AppChat_UserQuery="AppChat_UserQuery"}(dp||(dp={})),function(e){e.HelpResponse="HelpResponse",e.DesignerCard="DesignerCard",e.SketchCard="SketchCard"}(pp||(pp={})),function(e){e.RTL="rtl",e.LTR="ltr"}(gp||(gp={})),function(e){e.Summary="Summary",e.BasicChat="BasicChat",e.Commanding="Commanding",e.Designer="Designer",e.AddSlide="AddSlide",e.CreatePresentation="CreatePresentation",e.ContentTransform="ContentTransform",e.OrganizePresentation="OrganizePresentation",e.SelfHelp="SelfHelp",e.Personalization="Personalization",e.SearchDocument="SearchDocument",e.Sydney="Sydney",e.Unset=""}(mp||(mp={})),function(e){e.APOLOGY="apology",e.BASIC_CHAT="generate_response",e.CANNED_RESPONSE="annrules",e.DEBUG_COMMAND="debug_command",e.DEEPLEO_SYDNEY="deepleo",e.EDIT_DOCUMENT="edit_document",e.DESIGNER_INSERT_GRAPHIC="insert_graphic",e.PERSONALIZATION_END="personalize_end",e.PERSONALIZATION_EXPLAIN="personalize_explain",e.PERSONALIZATION_START="personalize_start",e.PERSONALIZATION_UPDATE="personalize_update",e.PERSONALIZATION_FORCED_DELETE="personalize_forced_delete",e.SEARCH_DOC="search_document",e.SELF_HELP_SEARCH="self_help_search",e.SUMMARIZE="summarize",e.COPILOT_POWERPOINT_SUMMARY="copilotpowerpointsummary",e.TRANSFORM_CONTENT="transform_content",e.COPILOT_USER_PROFILE_LAMBDA="CopilotUserProfileWorkflowLambda",e.IMAGE_CHAT="image-chat",e.UNKNOWN="Unknown"}(fp||(fp={})),function(e){e.Processing="Processing",e.Success="Success",e.Failed="Failed"}(hp||(hp={})),function(e){e[e.IMAGE_INVALID=0]="IMAGE_INVALID",e[e.DISMISSED_ARGUMENTS=1]="DISMISSED_ARGUMENTS"}(vp||(vp={})),function(e){e.ParseSummaryError="ParseSummaryError",e.TooLargeContentToSummarizeError="TooLargeContentToSummarizeError",e.SummaryNoActionItemsIdentified="SummaryNoActionItemsIdentified",e.ODSLServerErrorMessage="ODSLServerErrorMessage",e.AddSlideBlocked="ADD_SLIDE_BLOCKED",e.RequireDeleteIntentResponse="RequireDeleteIntentResponse",e.UnsupportedAction_Undo="UnsupportedAction_Undo",e.UnsupportedAction_Icon="UnsupportedAction_Icon",e.UnsupportedAction_ImageOutOfScope="UnsupportedAction_ImageOutOfScope",e.ErrorFetchingImages="ErrorFetchingImages",e.PowerPointALServerError="PowerPointALServerError",e.SummaryErrorRequestTimedOut="SummaryErrorRequestTimedOut",e.SummaryUnsupportedSummaryError="SummaryUnsupportedSummaryError",e.CommandNotSupported="CommandNotSupported",e.UnexpectedVersionErrorMessage="UnexpectedVersionErrorMessage",e.StopGeneratingResponseMessage="StopGeneratingResponseMessage",e.UserCancelledExecutionMessage="UserCancelledExecutionMessage",e.ActionOnlySupportedInRibbonMessage="ActionOnlySupportedInRibbonMessage",e.ServerErrorMessage="ServerErrorMessage",e.ResponseDelayedOrTimedOut="ResponseDelayedOrTimedOut",e.ChatHistoryHydrationError="ChatHistoryHydrationError",e.StorytellerFailureMessage="StorytellerFailureMessage",e.DocumentUrlEmptyError="DocumentUrlEmptyError",e.ErrorSlideAlreadyAnimated="ErrorSlideAlreadyAnimated",e.SketchToImageError="SketchToImageError"}(yp||(yp={})),function(e){e.TRIGGERING_VISUALS_FLOW="TRIGGERING_VISUALS_FLOW",e.GRAPH_API_SUCCEED="GRAPH_API_SUCCEED",e.THUMBNAILS_DOWNLOADED="THUMBNAILS_DOWNLOADED",e.VD_GENERATION_ONGOING="VD_GENERATION_ONGOING",e.VD_GENERATION_COMPLETED="VD_GENERATION_COMPLETED",e.SUMMARY_SIGNAL_TRIGGERED="SUMMARY_SIGNAL_TRIGGERED",e.VISUAL_SUMMARY_GENERATING="VISUAL_SUMMARY_GENERATING",e.VISUAL_SUMMARY_FIRST_STREAMING_CHUNK="VISUAL_SUMMARY_FIRST_STREAMING_CHUNK",e.VISUAL_SUMMARY_GENERATED="VISUAL_SUMMARY_GENERATED",e.VISUAL_DESCRIPTION_FAILURE="VISUAL_DESCRIPTION_FAILURE",e.THUMBNAIL_API_FAILURE="THUMBNAIL_API_FAILURE",e.SUMMARY_SIGNAL_NOT_TRIGGERED="SUMMARY_SIGNAL_NOT_TRIGGERED",e.GRAPH_API_FAILED="GRAPH_API_FAILED",e.NO_THUMBNAILS_FOUND="NO_THUMBNAILS_FOUND",e.VISUAL_SUMMARY_GENERATION_FAILED="VISUAL_SUMMARY_GENERATION_FAILED"}(Cp||(Cp={}));var Tp,Ip,_p=function(){function e(){Sp(this,e)}return Ep(e,null,[{key:"GetHostAppContentLaguage",value:function(){return Office.context.contentLanguage}},{key:"GetHostAppDisplayLanguage",value:function(){return Office.context.displayLanguage}},{key:"GetHostAppPlatform",value:function(){return Office.context.diagnostics.platform.toString().toUpperCase()}},{key:"isWin32Platform",value:function(){return"PC"===e.GetHostAppPlatform()}},{key:"isWebPlatform",value:function(){return Office.context.platform===Office.PlatformType.OfficeOnline}},{key:"isMacPlatform",value:function(){return Office.context.platform===Office.PlatformType.Mac}},{key:"isIOSPlatform",value:function(){return Office.context.platform===Office.PlatformType.iOS}},{key:"getDocumentUrlAsync",value:function(){return new Promise((function(e){Office.context.document.getFilePropertiesAsync((function(t){e(t.value.url)}))}))}}]),e}();!function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(Tp||(Tp={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(Ip||(Ip={}));var wp,Pp,xp,kp,Ap,Lp,Dp,Op,Np,Rp,Fp,Mp,Bp,Up,Hp=void 0,Gp=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]};!function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(xp||(xp={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.MsgExtTaskModule="MsgExtTaskModule"}(kp||(kp={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(Ap||(Ap={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened"}(Lp||(Lp={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode"}(Dp||(Dp={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat"}(Op||(Op={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(Np||(Np={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile"}(Rp||(Rp={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(Fp||(Fp={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(Mp||(Mp={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(Bp||(Bp={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(Up||(Up={}));var zp,qp=n(84443),Wp=function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}return e.getInstance=function(){return pm(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=(0,qp.WU)(this.personalizationHITLCardActivationTime)},e}(),jp=n(36072),Vp=n(40769),Qp=n(61780);class Jp{constructor(e){Qp.h.assign(Jp,this,e)}static getTypeName(){return"AugLoop_UserStore_UserProfileSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Jp.getTypeName()])}}Jp.H_={T_:Jp.getTypeName(),B_:Jp.getBaseTypes()};class Kp{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(Kp,this,e)}static getTypeName(){return"AugLoop_UserStore_UserProfileResponseAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Kp.getTypeName()])}}Kp.H_={T_:Kp.getTypeName(),B_:Kp.getBaseTypes()},function(e){e.TURN_OFF_PERSONALIZATION="0",e.TURN_ON_PERSONALIZATION="1",e.TOGGLE_PERSONALIZATION="2",e.SET_PROFILE="3",e.GET_PROFILE="4",e.DELETE_PROFILE="5"}(zp||(zp={}));var Xp,Zp,Yp,$p,eg,tg,ng="AugLoopChat".concat(Hp),rg=function(){function e(){}return e.generateId=function(){return e.operationId++,ng+e.operationId.toString()},e.operationId=0,e}(),og=n(21063),ig=n(89169),ag=n(52421);!function(e){e.None="None",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.DataVerse="DataVerse",e.OpenAIPlugin="OpenAIPlugin"}(Xp||(Xp={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Excel=1]="Excel",e[e.Word=2]="Word",e[e.OneNote=3]="OneNote",e[e.Outlook=4]="Outlook",e[e.Teams=5]="Teams",e[e.Event=6]="Event",e[e.Meeting=7]="Meeting",e[e.TeamsMeeting=8]="TeamsMeeting",e[e.SharePoint=9]="SharePoint",e[e.Web=10]="Web",e[e.PDF=11]="PDF",e[e.Zip=12]="Zip",e[e.HTML=13]="HTML",e[e.Visio=14]="Visio",e[e.Image=15]="Image",e[e.Fluid=16]="Fluid",e[e.Video=17]="Video",e[e.Vector=18]="Vector",e[e.Txt=19]="Txt",e[e.ThirdParty=20]="ThirdParty",e[e.Loop=21]="Loop",e[e.Planner=22]="Planner"}(Zp||(Zp={})),function(e){e.Word="Word",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Excel="Excel",e.Outlook="Outlook",e.Web="Web",e.Pdf="Pdf",e.Planner="Planner",e.Loop="Loop"}(Yp||(Yp={})),function(e){e.BodyText="BodyText",e.Title="Title",e.SubTitle="SubTitle",e.Heading="Heading",e.Table="Table",e.ImageAltText="ImageAltText",e.SmartArtText="SmartArtText",e.Comment="Comment",e.VisualDescription="VisualDescription",e.SlideText="SlideText",e.InkHandwriting="Ink Handwriting"}($p||($p={})),function(e){e[e.Personalization_Indicator=1]="Personalization_Indicator"}(eg||(eg={})),function(e){e[e.Confirm_Set_Personalization_Profile=1]="Confirm_Set_Personalization_Profile",e[e.Confirm_Delete_Personalization_Profile=2]="Confirm_Delete_Personalization_Profile",e[e.Visual_Summary=3]="Visual_Summary"}(tg||(tg={}));var sg,lg=n(42400),cg=n(73590),ug=n(82549),dg=n(98483),pg=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},gg=function(e,t,n){var r;(void 0===n&&(n=!1),n)?Wp.getInstance().resetPersonalizationHITLActionState():(void 0===(r=e)&&(r=[]),(null==r?void 0:r.length)>0&&(null==r?void 0:r.some((function(e){return e.responseType===tg.Confirm_Set_Personalization_Profile||e.responseType===tg.Confirm_Delete_Personalization_Profile})))&&(Wp.getInstance().setIsPersonalizationHITLResponseCardActive(!0),Wp.getInstance().setPersonalizationHITLActionButtonList(vg(e,t))))},mg=function(){return Wp.getInstance().getIsPersonalizationHITLResponseCardActive()?Wp.getInstance().getPersonalizationHITLActionButtonList():[]},fg=function(){return Wp.getInstance().getIsPersonalizationHITLResponseCardActive()},hg=function(e){Wp.getInstance().setPersonalizationHITLCardActivationTime(e)},vg=function(e,t){var n,r=[],o="";return null==e||e.forEach((function(e){switch(e.responseType){case tg.Confirm_Set_Personalization_Profile:r.push(yg(e,t)),o=tg.Confirm_Delete_Personalization_Profile.toString();break;case tg.Confirm_Delete_Personalization_Profile:r.push(Sg(e,t)),o=tg.Confirm_Delete_Personalization_Profile.toString()}})),wp.sendChatEventTelemetry(Ng(((n={})[Ap.ChatEventType]=Lp.PersonalizationHITLCardShown,n[Ap.ChatEventParameters]=o,n))),r},yg=function(e,t){return{type:og.j.Default,title:Hm(),text:Hm(),iconRegular:lg.N5_,iconHover:lg.FUA,handleButtonOnClick:function(n,r,o){Cg(t,e,Hm(),o)},isDisabled:!0}},Cg=function(e,t,n,r){var o,i;void 0===r&&(r=Fm),Eg(e,n);var a=Mg(r).correlationId;void 0===a&&(Gp("Invalid correlationId from original profile update query."),wp.sendChatEventTelemetry(Ng(((o={})[Ap.ChatEventType]=Lp.UndefinedQueryIDInHITLCard,o))),a=(0,dg.A)()),pm(wp.setQueryGuid)||wp.setQueryGuid(a),pm(wp.logKeptEvent)||wp.logKeptEvent(Op.Customize,Op.Customize);var s=t.argumentKeys.findIndex((function(e){return e===Um}));if(-1===s)return Gp("Failed to find profile ID in required action parameters for personalization confirm button."),void(null===(i=e.current)||void 0===i||i.addResponseMessage(_g()));var l=t.argumentValues[s],c=t.queryLanguage;kg(e,a,zp.SET_PROFILE,l,c),Wp.getInstance().resetPersonalizationHITLActionState()},Sg=function(e,t){return{type:og.j.Default,title:Gm(),text:Gm(),iconRegular:cg.va_,iconHover:ug.TTy,handleButtonOnClick:function(n,r,o){bg(t,e,Gm(),o)},isDisabled:!0}},bg=function(e,t,n,r){var o;void 0===r&&(r=Fm),Eg(e,n);var i=Mg(r).correlationId;void 0===i&&(Gp("Failed to find correlation ID in required action parameters for personalization delete button."),wp.sendChatEventTelemetry(Ng(((o={})[Ap.ChatEventType]=Lp.UndefinedQueryIDInHITLCard,o))),i=(0,dg.A)()),pm(wp.setQueryGuid)||wp.setQueryGuid(i);var a=t.queryLanguage;kg(e,i,zp.DELETE_PROFILE,Fm,a),Wp.getInstance().resetPersonalizationHITLActionState()},Eg=function(e,t){var n,r,o;Tg(e),Wp.getInstance().setPersonalizationHITLUserInteractionTime(),wp.sendLatencyTelemetry(Ng(((n={})[xp.PersonalizationCardUserInteractionTime]=Wp.getInstance().getPersonalizationHITLUserInteractionTime(),n))),null===(r=e.current)||void 0===r||r.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Human,messageHeader:{text:t}}}}),null===(o=e.current)||void 0===o||o.startLoadingUi()},Tg=function(e){for(var t,n,r,o,i,a=null===(t=e.current)||void 0===t?void 0:t.getLastMessage(!0),s=null!==(n=null==a?void 0:a.messageType)&&void 0!==n?n:jp._.MarkdownCard,l=null!==(o=null===(r=null==a?void 0:a.actionBarButtons)||void 0===r?void 0:r.slice())&&void 0!==o?o:[],c=0,u=l;c<u.length;c++){var d=u[c];d.text!==Hm()&&d.text!==Gm()||(d.isDisabled=!0)}null===(i=e.current)||void 0===i||i.updateLastMessage({chatCardType:s,chatMessageBodyData:{actionButtonList:pg([],l,!0)}})},Ig=function(e){var t={correlationId:e,featureName:Op.Customize},n=Fm;try{n=JSON.stringify(t)}catch(e){Gp("Failed to stringify telemetry data for Personalization ",e)}return n},_g=function(e,t,n){var r={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:Ig(n),feedbackData:pm(Pp.getFeedbackData)?void 0:Pp.getFeedbackData(void 0,t)};return{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:null!=e?e:Bm()}}},chatMessageBodyData:r,stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0}},wg=function(e){var t,n,r,o,i=null===(t=e.current)||void 0===t?void 0:t.getLastMessage(!0),a=null!==(n=i.actionBarButtons)&&void 0!==n?n:[];if(Wp.getInstance().getIsPersonalizationHITLResponseCardActive()){for(var s=null!==(o=null===(r=null==i?void 0:i.actionBarButtons)||void 0===r?void 0:r.slice())&&void 0!==o?o:[],l=0,c=s;l<c.length;l++){var u=c[l];u.text!==Hm()&&u.text!==Gm()||(u.isDisabled=!1)}a=s}return a},Pg=function(){return{featureName:Op.Customize,subFeatureName:Rp.PersonalizationHITL}},xg=function(){return xg=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xg.apply(this,arguments)},kg=function(e,t,n,r,o){var i,a;void 0===o&&(o=Fm);var s={profileOperation:n,queryId:t,profileId:r,queryLanguage:o};sg=(new Date).getTime();var l=new Vp.Xr({parentPath:["Signal",Jp.getTypeName()],items:[{id:rg.generateId(),body:new Jp(s)}]});null===(a=e.current)||void 0===a||a.submitOperation({operation:l,workflowAnnotationType:Kp.getTypeName()}),Gp("Sending User Profile Signal: ",l),wp.sendChatEventTelemetry(Ng(((i={})[Ap.ChatEventType]=Lp.UserProfileOperationSubmitted,i[Ap.ChatEventParameters]=zp[n],i[Ap.UserQueryGuid]=t,i)))},Ag=function(e){return"bot"===e.author&&"Chat"===e.messageType},Lg=function(e,t,n,r,o){var i,a,s,l=null==e?void 0:e.body,c=l.queryId;c&&!pm(wp.setQueryGuid)&&wp.setQueryGuid(c),wp.updateTelemetryOnAnnotationReceived(Kp.getTypeName(),c,xp.UserProfileResponseTime,Op.Customize,void 0,sg,o);var u=!1,d={featureName:Op.Customize,subFeatureName:Rp.PersonalizationUserProfile};if(l.error){var p=function(e,t,n){var r,o,i;void 0===n&&(n=Fm);var a,s=e.category,l=e.message,c=null!==(o=e.json)&&void 0!==o?o:Fm,u=Fm;try{pm(c)||(a=JSON.parse(c))}catch(e){Gp("Exception occured during parsing of json Data for User profile annotation error : ".concat(e))}Gp("UserProfile Annotation Error Detected, Category: ".concat(s,", ErrorMessage: ").concat(l,", JsonData: ").concat(c)),void 0!==a&&(u=a.code),wp.sendErrorTelemetry(Ng(((r={})[Dp.ErrorMessage]="User Profile Annotation Error Detected, Category: ".concat(s,", ErrorCode: ").concat(u),r[Dp.ErrorCategory]=kp.Personalization,r)));var d=Mp.Unknown,p=Fp.UnclassifiedError,g=Bm();switch(s){case Vg.InvalidSignal:u===Qg.MissingProfileId&&(d=Mp.MissingProfileId,p=Fp.LLMIssue);break;case Vg.InvalidInput:switch(u){case Qg.StaleProfileId:d=Mp.StaleProfileId,p=Fp.UserInputIssue;break;case Qg.NotSupportedProfileOperation:d=Mp.NotSupportedProfileOperation,p=Fp.UnsupportedFunctionality;break;case Qg.InvalidUserQuery:d=Mp.InvalidUserQuery,p=Fp.UserInputIssue}break;case Vg.RoamingServiceError:switch(u){case Qg.FailedToRead:d=Mp.FailedToRead,p=Fp.LLMIssue;break;case Qg.FailedToWrite:d=Mp.FailedToWrite,p=Fp.LLMIssue;break;case Qg.UninitializedUserStoreEntities:d=Mp.UninitializedUserStoreEntities,p=Fp.LLMIssue;break;case Qg.UndefinedUserStoreEntities:d=Mp.UndefinedUserStoreEntities,p=Fp.LLMIssue}break;case Vg.OpenAITextClientError:case Vg.OpenAIChatClientError:switch(u){case Qg.BadResponse:d=Mp.BadResponse,p=Fp.LLMIssue;break;case Qg.Timeout:d=Mp.Timeout,p=Fp.TimedOut;break;case Qg.Throttled:d=Mp.Throttled,p=Fp.CapacityIssue;break;case Qg.UserThrottled:d=Mp.UserThrottled,p=Fp.CapacityIssue;break;case Qg.ScenarioThrottled:d=Mp.ScenarioThrottled,p=Fp.CapacityIssue;break;case Qg.Token:d=Mp.Token,p=Fp.UserAccessIssue;break;case Qg.Unknown:d=Mp.Unknown,p=Fp.UnclassifiedError;break;case Qg.NotAvailable:d=Mp.NotAvailable,p=Fp.LLMIssue;break;case Qg.EmptyResponse:d=Mp.EmptyResponse,p=Fp.LLMIssue}break;case Vg.SkillExecutionError:switch(u){case Qg.Unknown:d=Mp.SkillFailed,p=Fp.LLMIssue;break;case Qg.NotAvailable:d=Mp.IncorrectServiceResponse,p=Fp.LLMIssue}}var m={errorType:"".concat(s,"-").concat(u),featureName:Op.Customize,errorMessage:g,subFeatureName:Rp.PersonalizationUserProfile};null===(i=t.current)||void 0===i||i.addResponseMessage(_g(g,m,n));var f=Fg(Bp.Customize,p);return pm(wp.logAshaErrorEvent)||wp.logAshaErrorEvent(f,d,Op.Customize),u}(l.error,r,c);return Rg(t,"".concat(Kp.getTypeName(),"_Error"),l.error.category.concat(function(e){return""===e}(p)?Fm:"_".concat(p)),Np.Server),void n(c)}if(l.chatResponse&&0===l.chatResponse.status){var g=l.chatResponse.messagesToAddOrReplace;if(!pm(g)&&g.length>0)for(var m=0,f=g;m<f.length;m++){var h=f[m];Ag(h)&&h.text&&(Gp("rendered user Profile Annotation response:  ",h.text),null===(a=r.current)||void 0===a||a.addResponseMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:h.text}},chatMessageBodyData:xg(xg({},hm(d)),{telemetryData:Ig(c)}),addCardToChatHistory:!0}),u=!0)}}u?wp.sendChatEventTelemetry(Ng(((i={})[Ap.ChatEventType]=Lp.QuerySuccessful,i[Ap.ChatEventParameters]=Op.Customize,i))):(Gp("Error in User Profile Annotation response, showing default error message"),null===(s=r.current)||void 0===s||s.addResponseMessage(_g(void 0,xg(xg({},d),{errorType:Lp.IncompleteUserProfileResponse}),c))),Rg(t,u?void 0:Lp.IncompleteUserProfileResponse,void 0,u?void 0:Np.Server),n(c)},Dg=function(e,t){var n;wp.sendErrorTelemetry(Ng(((n={})[Dp.ErrorMessage]="".concat(e),n[Dp.ErrorCategory]=kp.CLP,n[Dp.ErrorCode]=t,n)))},Og=function(e){var t;wp.sendChatEventTelemetry(Ng(((t={})[Ap.ChatEventType]=Lp.OfficeJsApiCallForCLP,t[Ap.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},Ng=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};var Rg=function(e,t,n,r,o,i){var a,s;t&&""!==t&&wp.sendChatEventTelemetry(Ng(((a={})[Ap.ChatEventType]=t,a[Ap.ChatEventParameters]=n||"",a[Ap.ChatErrorType]=r||"",a)));var l=Wp.getInstance().shouldConsiderPersonalizationHITLUserInteractionLatency()?Wp.getInstance().getPersonalizationHITLUserInteractionTime():0;wp.sendLatencyTelemetry(Ng(((s={})[xp.UserPerceivedLatency]=(0,qp.WU)(e)-l,s[xp.IsQuerySuccess]=void 0===t,s[xp.ErrorType]=r||"",s[xp.ErrorParameter]=(!0===o?t:n)||"",s[xp.ErrorChatEventType]=t&&""!==t?t:"",s[xp.ErrorChatEventParameter]=t&&""!==t&&n||"",s)),null==i||i),wp.setQueryGuid(Fm),Wp.getInstance().resetPersonalizationLatencyState()},Fg=function(e,t){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.join(" ")}(e,t)},Mg=function(e){var t={};try{t=JSON.parse(e)}catch(e){Gp("Error parsing telemetry data ",e.message)}return t},Bg=function(e){return e||(e=Op.CopilotChat),JSON.stringify({featureName:e})};function Ug(e){wp.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function Hg(e,t){return e+" "+t}var Gg,zg,qg,Wg,jg,Vg,Qg,Jg,Kg,Xg,Zg=function(e){var t;wp.sendChatEventTelemetry(Ng(((t={})[Ap.ChatEventType]=Lp.ApiPluginDataReceived,t[Ap.ChatEventParameters]=e.toString(),t)))},Yg=function(e){var t;wp.sendChatEventTelemetry(Ng(((t={})[Ap.ChatEventType]=Lp.MsgExtDataReceived,t[Ap.ChatEventParameters]=e.toString(),t)))},$g="d2eb9fef-f34c-40ec-b6a3-4bf524065158",em="https://graph.microsoft.com",tm="https://microsoft-my.sharepoint-df.com",nm=n(58651),rm=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},om=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},im=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return rm(this,void 0,void 0,(function(){var e,t,r;return om(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,89761))];case 3:return t.msalModule=o.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(r=o.sent(),nm.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),r),3===e)throw r;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createPublicClientApplication=function(e){var t,n;return rm(this,void 0,void 0,(function(){var r,o;return om(this,(function(i){return r=null!==(n=null===(t=this.params)||void 0===t?void 0:t.clientId)&&void 0!==n?n:"6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",o=this.params.redirectUri,[2,new e({auth:{clientId:r,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47",redirectUri:new URL(o,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})]}))}))},e.prototype.getToken=function(e,t){var n;return rm(this,void 0,void 0,(function(){var t,r,o,i,a;return om(this,(function(s){switch(s.label){case 0:return Gp("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:s.sent(),s.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=s.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&wp.sendChatEventTelemetry(Ng(((a={})[Ap.ChatEventType]=Lp.MSALTokenRequested,a))),r=void 0,s.label=4;case 4:return s.trys.push([4,9,,10]),[4,t.initialize()];case 5:return s.sent(),0!==(null==(o=t.getAllAccounts())?void 0:o.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,s.sent()];case 7:return[4,this.getSelectedAccount(o,t)];case 8:if(!(r=s.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[2,this.acquireTokenSilent(e,r,t)];case 9:if(i=s.sent(),Gp("Failed to get access token: ".concat(null==i?void 0:i.message)),this.msalModule&&i instanceof this.msalModule.InteractionRequiredAuthError)return[2,this.acquireTokenPopup(e,r,t)];throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),i;case 10:return[2]}}))}))},e.prototype.getSelectedAccount=function(e,t){var n;return rm(this,void 0,void 0,(function(){var r,o,i,a=this;return om(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(i=s.sent())?void 0:i.account];case 2:if(!e||0===e.length)return[2,null];if(r=this.params?null!==(n=e.find((function(e){var t,n,r;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(r=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===r?void 0:r.toLowerCase())})))&&void 0!==n?n:null:e[0],r)return[2,r];o=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(o),[4,this.loginPopupPromise];case 4:return[2,null==(i=s.sent())?void 0:i.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){var n;return rm(this,void 0,void 0,(function(){var r,o;return om(this,(function(i){switch(i.label){case 0:return r={scopes:["".concat(e,"/.default")],loginHint:null===(n=this.params)||void 0===n?void 0:n.userPrincipalName},[4,t.ssoSilent(r)];case 1:return(o=i.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n){return rm(this,void 0,void 0,(function(){var r,o;return om(this,(function(i){switch(i.label){case 0:return r={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(r)];case 1:return(o=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return rm(this,void 0,void 0,(function(){var r,o;return om(this,(function(i){switch(i.label){case 0:return r={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(r)];case 1:return(o=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,o]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&wp.sendErrorTelemetry(Ng(((t={})[Dp.ErrorCategory]=kp.MSAL,t[Dp.ErrorMessage]=e,t)))},e}(),am=n(94209);!function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(Gg||(Gg={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(zg||(zg={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(qg||(qg={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(Wg||(Wg={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(jg||(jg={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(Vg||(Vg={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(Qg||(Qg={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(Jg||(Jg={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(Kg||(Kg={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(Xg||(Xg={}));var sm=n(59664),lm=n(82772),cm=function(){return cm=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},cm.apply(this,arguments)},um=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},dm=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function pm(e){return null==e}var gm=function(e,t,n){return t!==Wg.defaultWhite?cm({isDarkModeEnabled:!0,isHighContrastModeEnabled:n},(0,sm.W)(e)):cm({isDarkModeEnabled:!1,isHighContrastModeEnabled:n},(0,lm.a)(e))},mm=function(e){return{displayCategory:e.map((function(e){return{value:e}}))}};var fm=function(){return"undefined"!=typeof OfficeaicopilotStrings};function hm(e,t){return{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:ag.O.Footer,showAnimation:!0,isFailure:!1,feedbackData:pm(Pp.getFeedbackData)?void 0:Pp.getFeedbackData(t,e)}}var vm,ym,Cm=function(e,t,n,r){return um(void 0,void 0,void 0,(function(){var o;return dm(this,(function(i){switch(i.label){case 0:return[4,e(lf,["ResourceConstrainedToken.PAC"])];case 1:return o=i.sent(),[2,fetch(t,cm(cm({},r),{headers:cm(cm({},null==r?void 0:r.headers),{Authorization:o.token,"X-SPOPacToken":n})}))]}}))}))},Sm=function(){var e,t=cf;null===(e=null===window||void 0===window?void 0:window.open)||void 0===e||e.call(window,t,"_blank","noopener,noreferrer")},bm=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Em=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Tm=function(){return bm(void 0,void 0,void 0,(function(){return Em(this,(function(e){switch(e.label){case 0:return[4,Office.license.launchUpsellExperience("copilotsidepanel_creditlimit")];case 1:return e.sent(),[2]}}))}))};!function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Jpg=2]="Jpg",e[e.Png=3]="Png",e[e.Bmp=4]="Bmp"}(vm||(vm={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(ym||(ym={}));var Im,_m,wm=function(e){if(/^data:image\/[a-zA-Z]+;base64,/.test(e)){for(var t=e.split(",")[1],n=atob(t),r=new Uint8Array(new ArrayBuffer(n.length)),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=function(e){return e.startsWith("data:image/png")?{format:vm.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:vm.Jpg}:e.startsWith("data:image/bmp")?{format:vm.Bmp}:{format:vm.Other,otherFormat:e.split(";")[0].split(":")[1]}}(e),a=i.format,s=i.otherFormat;return{contents:[{id:(0,dg.A)(),size:ym.Unspecified,format:a,otherFormat:s,data:Array.from(r),sizeBytes:r.length}],widthPx:0,heightPx:0}}},Pm=(Im=function(e,t){return Im=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Im(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Im(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),xm=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Pm(t,e),t}(function(e){function t(t,n){var r=e.call(this,n)||this;return r.name=t,r}return Pm(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(_m||(_m={}));var km=["ar-SA","he-IL"],Am=["ar-SA","fa-IR","he-IL","ug-CN","ur-PK"],Lm=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","ru-RU","sv-SE","th-TH","tr-TR","uk-UA"],Dm=["bg-BG","el-GR","et-EE","hr-HR","lt-LT","lv-LV","id-ID","ro-RO","sk-SK","sl-SI","sr-latn-RS","vi-VN","de-CH","nl-BE"],Om=["ca-ES","cy-GB"],Nm=function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.supportedLanguages=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","pt-PT","zh-CN","zh-TW"]}return Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var r=this.supportedLanguages[n];if(t[0]===r.split("-")[0])return r}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new xm(_m.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(Lm),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(km))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(Dm)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(Om))},e}(),Rm=n(58651);new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0});var Fm="",Mm="shimmer",Bm=function(){return fm()?OfficeaicopilotStrings.PersonalizationProfileErrorResponse:"Sorry, something went wrong. Please try again in a moment or ask me to help with something else."},Um="ProfileId",Hm=function(){return fm()?OfficeaicopilotStrings.ConfirmButtonLabel:"Confirm"},Gm=function(){return fm()?OfficeaicopilotStrings.DeleteButtonLabel:"Delete"},zm="3068386c-7a16-4f6a-a664-043b6b232816",qm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},Wm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that cant be applied when a file is read-only."},jm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},Vm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},Qm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},Jm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},Km=function(){return fm()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},Xm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},Zm=function(){return fm()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},Ym=function(){return fm()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},$m=function(){return fm()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},ef=function(){return fm()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},tf=function(){return fm()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},nf=function(){return fm()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},rf=function(){return fm()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},of=function(){return fm()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},af=function(){return fm()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},sf=function(){return fm()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},lf="00000003-0000-0ff1-ce00-000000000000",cf="https://go.microsoft.com/fwlink/?linkid=2271054",uf=n(74576),df=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},pf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},gf=!1,mf=function(e){Gp("setting ClpOfficeJSApiError to ".concat(e)),gf=e},ff=!1;function hf(){return df(this,void 0,void 0,(function(){var e;return pf(this,(function(t){switch(t.label){case 0:return Pp.IsClpEnabledInEnterpriseForSydney()?(ff=!0,[4,_f.getInstance().getInDocSensitiveLabelUsingOfcJs()]):[3,3];case 1:return e=t.sent(),[4,_f.getInstance().getHighestDocumentSensitivityInfo([_f.getInstance().getInDocSensitiveLabelInfo(),e])];case 2:if(t.sent(),gf)return mf(!1),ff=!1,[2,!1];t.label=3;case 3:return ff=!1,[2,!0]}}))}))}var vf="2147205115";function yf(e,t,n,r,o){void 0===o&&(o=!0);var i={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:r?Bg(r):void 0},a=!0,s=_f.getInstance();(null==s?void 0:s.getShouldStopLoadingUi)&&(a=s.getShouldStopLoadingUi());var l={chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:i,stopLoadingUi:a,startAugloopTimerForStreaming:!1,addCardToChatHistory:o};return function(e,t,n){var r,o;void 0===n&&(n=!0);var i={};if(t){wp.sendChatEventTelemetry(Ng(((r={})[Ap.ChatEventType]=t.chatEventType,r[Ap.ChatEventParameters]=t.chatEventParam,r[Ap.ChatErrorType]=t.chatErrorType,r))),(o={})[xp.ErrorType]=Np.Client,o[xp.ErrorParameter]=t.chatEventType,o[xp.ErrorChatEventType]=t.chatEventType,o[xp.ErrorChatEventParameter]=t.chatEventParam,i=o;var a=t.ashaErrorDetails;a&&Ug(a)}e&&(Gp("User Perceived Latency :  ".concat((0,qp.WU)(qp.qD)," sec")),i[xp.UserPerceivedLatency]=(0,qp.WU)(qp.qD),i[xp.IsQuerySuccess]=!1,wp.sendLatencyTelemetry(Ng(i),n))}(t,n,!0),Gp("CLP error response message: ".concat(l)),l}function Cf(e,t,n,r){var o,i,a;if(null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getIsExecuting()){var s=function(e,t){switch(e){case Kg.ApplyLabelUnsupportedCrossTenantErrorCode:return t===Jg.CLP_Get?Fm:qm();case Kg.ApplyLabelDocumentReadOnlyErrorCode:return t===Jg.CLP_Get?Fm:Wm();case Kg.ApplyLabelInsufficientPermissionErrorCode:return t===Jg.CLP_Get?Fm:jm();case Kg.ApplyLabelLabelDisabledErrorCode:return t===Jg.CLP_Get?Fm:Vm();case Kg.ApplyLabelUnsupportedUdpErrorCode:return t===Jg.CLP_Get?Fm:Qm();case Kg.ApplyLabelLabelingDisabledErrorCode:return t===Jg.CLP_Get?Fm:Jm();case Kg.ApplyLabelUnsupportedContentTypeErrorCode:return t===Jg.CLP_Get?Fm:Km();case Kg.ApplyLabelUnsupportedDkeErrorCode:return t===Jg.CLP_Get?Fm:Xm();case Kg.ApplyLabelLabelNotFoundErrorCode:case Kg.ErrorCode2147647531:return t===Jg.CLP_Get?Fm:Zm();case Kg.OsfControlContainerErrorCode:case Kg.OfficeSolutionFrameworkHostErrorCode:case Kg.DocCookieErrorCode:case Kg.HostIntegrationManagerErrorCode:case Kg.MsoOLDocumentErrorCode:case Kg.ClpSessionErrorCode:return Ym();case Kg.OMWorkflowUserNotFoundErrorCode:return $m();case Kg.OMOfficePerpetualNotSupportedErrorCode:return ef();case Kg.LabelingDisabledProtectedViewErrorCode:return tf();case Kg.LabelingDisabledAppguardErrorCode:return nf();case Kg.LabelingDisabledPrivacySettingsErrorCode:return t===Jg.CLP_Get?Fm:rf();case Kg.LabelingDisabledUnsupportedLabelClientErrorCode:return t===Jg.CLP_Get?Fm:of();case Kg.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===Jg.CLP_Get?Fm:af();case Kg.OMOfficeClientNotLicensedForLabelingErrorCode:return t===Jg.CLP_Get?Fm:sf();case Kg.PolicyManagerUnavailableErrorCode:return t===Jg.CLP_Get?Fm:Ym();case Kg.ApplyLabelNewLabelSensitivityOrderErrorCode:return Fm;case Kg.ErrorCode2147500033:default:return t===Jg.CLP_Get?Fm:Ym()}}(t,n);if(s){ff&&mf(!0),Gp("clp error: ".concat(s)),function(e,t){var n,r={chatEventType:Lp.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:Np.Client,ashaErrorDetails:{vetoName:Hg(Bp.UnclearIntent,Fp.UserInputIssue),errorString:Up.SensitivityExecutionFailed,featureName:Op.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(yf(t,!0,r))}(e,s);var l=!0,c=_f.getInstance();(null==c?void 0:c.getShouldStopLoadingUi)&&(l=c.getShouldStopLoadingUi()),r&&l&&r(),wp.sendChatEventTelemetry(Ng(((o={})[Ap.ChatEventType]=Lp.CLPErrorShown,o[Ap.ChatEventParameters]=n+"_"+t,o)))}else Gp("clp error string is empty"),wp.sendChatEventTelemetry(Ng(((i={})[Ap.ChatEventType]=Lp.CLPErrorIgnored,i[Ap.ChatEventParameters]=n+"_"+t,i)));return s}return Fm}var Sf=function(){return Sf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Sf.apply(this,arguments)},bf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ef=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Tf=null,If=(0,dg.A)(),_f=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:Fm,tenantId:Fm},this.externalDocLabelInfo={labelId:Fm,tenantId:Fm},this.inDocLabelInfo.labelId=Fm,this.inDocLabelInfo.tenantId=Fm,this.externalDocLabelInfo.labelId=Fm,this.externalDocLabelInfo.tenantId=Fm}return e.getInstance=function(t,n,r,o){return pm(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),pm(t)||(e.clpSensitivityHandler.setBasicChatProps=t),pm(n)||(e.clpSensitivityHandler.copilotChatRef=n),pm(r)||(e.clpSensitivityHandler.removeCurrentContextId=r),pm(o)||(e.clpSensitivityHandler.getShouldStopLoadingUi=o),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return bf(this,void 0,void 0,(function(){var e,t;return Ef(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 1:return e=n.sent(),this.setInDocSensitivityLabelInfo(e),Og("setInDocSensitiveLabelInfoUsingOfcJs"),[3,3];case 2:return t=n.sent(),Dg("error in getLabel Api: ".concat(t.message),t.code),Cf(this.copilotChatRef,t.code,Jg.CLP_Get,this.removeCurrentContextId),Gp("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,3];case 3:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return bf(this,void 0,void 0,(function(){var e,t;return Ef(this,(function(n){switch(n.label){case 0:Gp("Getting label"),e={labelId:Fm,tenantId:Fm},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=n.sent(),Og("getLabel"),[3,4];case 3:return t=n.sent(),Dg("error in getLabel Api : ".concat(t.message),t.code),Cf(this.copilotChatRef,t.code,Jg.CLP_Get,this.removeCurrentContextId),Gp("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return Gp("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;Gp("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var r,o;return Sf(Sf({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(r=e.description)&&void 0!==r?r:"",badgeText:null!==(o=e.displayName)&&void 0!==o?o:"",iconType:e.encryptionType!==Tp.None?uf.JF.Encryption:uf.JF.NonEncryption}:void 0})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return bf(this,void 0,void 0,(function(){var t;return Ef(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:Fm}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):(Gp("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?(Gp("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){var t;return bf(this,void 0,void 0,(function(){var n,r,o,i,a,s,l=this;return Ef(this,(function(c){switch(c.label){case 0:Og("tryUpgradeLabel"),Gp("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=Ip[Ip.S_APPLYLABEL_OK],r=Fm,c.label=1;case 1:return c.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,If)];case 2:return c.sent(),[2,{status:Ip[Ip.S_APPLYLABEL_OK]}];case 3:return o=function(){return bf(l,void 0,void 0,(function(){return Ef(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,If)]}catch(e){Dg("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code),r=Cf(this.copilotChatRef,e.code,Jg.CLP_Upgrade,this.removeCurrentContextId),Gp("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},i=new Promise((function(e){Tf=e})),a=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([i,o()]),a])];case 4:c.sent(),c.label=5;case 5:return[3,7];case 6:return s=c.sent(),Dg("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(s.message),s.code),Cf(this.copilotChatRef,s.code,Jg.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===s.message?Gp("Callback Timeout"):Gp("Exception while upgrading sensitivity label: ".concat(s.message,", error code: ").concat(s.code)),n=null!==(t=Ip[s.message])&&void 0!==t?t:s.message,[3,7];case 7:return Tf=null,[2,{status:n,errorMessage:r}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:wf),Og("Label Change Event Listener"),Gp("Sensitivity Label Change Event Listener Set")}catch(e){Dg("error in setting listener for CLP : ".concat(e.message),e.code),Cf(this.copilotChatRef,e.code,Jg.CLP_Upgrade,this.removeCurrentContextId),Gp("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return bf(this,void 0,void 0,(function(){var t,n;return Ef(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 1:return t=r.sent(),Gp("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),Og("External Doc HighestSensitivityLabel"),[3,3];case 2:return n=r.sent(),Dg("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),Cf(this.copilotChatRef,n.code,Jg.CLP_Get,this.removeCurrentContextId),Gp("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,3];case 3:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return bf(this,void 0,void 0,(function(){return Ef(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return bf(this,void 0,void 0,(function(){var t,n;return Ef(this,(function(r){switch(r.label){case 0:t={labelId:Fm,tenantId:Fm},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=r.sent(),Gp("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),Og("HighestSensitivityLabel"),[3,4];case 3:return n=r.sent(),Dg("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),Cf(this.copilotChatRef,n.code,Jg.CLP_Get,this.removeCurrentContextId),Gp("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return bf(this,void 0,void 0,(function(){var t;return Ef(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==Tp.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){Gp("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return Og("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===Fm)),this.externalDocLabelInfo.labelId!==Fm&&Pp.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return Og("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===Fm)),this.inDocLabelInfo.labelId!==Fm&&Pp.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==Tp.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==Tp.None},e}();function wf(e,t,n,r){return bf(this,void 0,void 0,(function(){return Ef(this,(function(o){switch(o.label){case 0:return Gp("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(r)),Og("Label change callback received, context:  ".concat(n)),Tf&&n===If&&(Tf("ignore"),Tf=null),r!==Ip.S_APPLYLABEL_OK?(Dg("error in upgrading label : ".concat(r),r.code),[2]):Pp.IsClpEnabledInEnterpriseForSydney()&&(_f.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,_f.getInstance().setSensitivityLabelToHighestSensitivity([_f.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return o.sent(),[2];case 2:return Pp.IsApplyLabelUsingTryUpgradeLabelEnabled(),_f.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}var Pf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},xf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};var kf,Af=function(e,t){return Pf(void 0,void 0,void 0,(function(){var n,r,o,i,a,s,l,c,u,d,p,g;return xf(this,(function(m){switch(m.label){case 0:return n=_f.getInstance().getInDocSensitiveLabelInfo(),Pp.IsClpEnabledInEnterpriseForSydney()?[4,_f.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return r=m.sent(),[4,_f.getInstance().getHighestDocumentSensitivityInfo([_f.getInstance().getInDocSensitiveLabelInfo(),r])];case 2:(n=m.sent()).isDke=r.isDke,n.hasExtractForUser=r.hasExtractForUser,m.label=3;case 3:return o={id:n.labelId,displayName:null!==(p=n.displayName)&&void 0!==p?p:"",tooltip:n.description,color:n.color,isEncrypted:n.encryptionType!==Tp.None,priority:null!==(g=n.order)&&void 0!==g?g:0},c={documentSensitivity:o},null==t?[3,4]:(a=t,[3,6]);case 4:return[4,Pp.getOfficeJSDocumentURL()];case 5:a=m.sent(),m.label=6;case 6:return c.documentURL=a,c.hasExtract=n.labelId===Fm||n.hasExtractForUser,c.isDKE=n.labelId!==Fm&&n.isDke,i=c,(s={copilotConfig:e(),documentConfig:i}).copilotConfig&&wp.sendChatEventTelemetry(Ng(((u={})[Ap.ChatEventType]=Lp.CopilotConfig,u[Ap.ChatEventParameters]=JSON.stringify(s.copilotConfig),u))),l=void 0===i.hasExtract&&void 0===i.isDKE,wp.sendChatEventTelemetry(Ng(((d={})[Ap.ChatEventType]=Lp.IsDocumentProtected,d[Ap.ChatEventParameters]=!!l||!(!i.hasExtract||i.isDKE),d))),[2,s]}}))}))};!function(e){e.AugloopSharedSessionID="AugloopSharedSessionID",e.HandoffMessageId="HandoffMessageId"}(kf||(kf={}));var Lf=function(){function e(){}return e.getSettingAsString=function(e){var t=Office.context.document.settings.get(e.toString());return pm(t)?t:t.toString()},e}();var Df=n(3421),Of=n(60160),Nf=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ff=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Mf=function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return Rf(n,void 0,void 0,(function(){var e,t,n,r,o,i,a,s;return Ff(this,(function(l){switch(l.label){case 0:e=null!==(i=null===(o=this.state.error)||void 0===o?void 0:o.message)&&void 0!==i?i:"No error message",t=null!==(s=null===(a=this.state.error)||void 0===a?void 0:a.stack)&&void 0!==s?s:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return l.sent(),[3,4];case 3:return r=l.sent(),Gp("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",r),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}return Nf(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){Gp("ErrorBoundary caught an error ",e),function(){var e;null===(e=window.document.getElementById(Mm))||void 0===e||e.style.setProperty("display","none")}(),function(e){var t;wp.sendChatEventTelemetry(Ng(((t={})[Ap.ChatEventType]=Lp.ErrorBoundaryCaughtError,t[Ap.ChatEventParameters]=e,t))),Ug({vetoName:Hg(Bp.UnclearIntent,Fp.UnclassifiedError),errorString:Up.UnexpectedFailure,featureName:Op.CopilotChat})}(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?a.createElement(Of.L,{theme:this.props.copilotChatTheme,shouldUseFluentV9Tokens:!0},a.createElement(Df.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children},t}(a.Component);const Bf=Mf;var Uf=n(57177),Hf=n(30974),Gf=n(47316),zf=n(48636),qf=n(1857),Wf=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},jf=function(e){var t={appId:"",botId:"",cardId:""};try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){Gp("msgExtension Utils: Failed to extract cardId from cardData")}return t},Vf=function(){return Vf=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Vf.apply(this,arguments)},Qf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Jf=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Kf=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},Gp("MsgExtDialogLauncher : Task Module dialog closed")},this.onMessageCallback=function(e){return Qf(t,void 0,void 0,(function(){var t,n,r,o,i,a,s,l,c,u;return Jf(this,(function(d){switch(d.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(e)).type!==zf.o.Ack?[3,1]:(n=jf(this.taskModuleProps),o={dialogContent:this.taskModuleProps.dialogContent,appDefinition:this.taskModuleProps.appDefinition,clientInfo:this.taskModuleProps.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:n},this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),[3,6]):[2];case 1:return t.type!==zf.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==zf.o.onServiceRequest)return[3,6];null===(u=wp.setQueryGuid)||void 0===u||u.call(wp,t.requestId),Gp("MsgExtDialogLauncher : Received service request from dialog",t),r={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},wp.sendChatEventTelemetry(Ng(((s={})[Ap.ChatEventType]=Lp.TaskModuleServiceRequest,s[Ap.ChatEventParameters]=JSON.stringify(r),s))),o={requestId:t.requestId,messageType:zf.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},d.label=3;case 3:return d.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(i=d.sent())&&(o.result=i),Gp("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),wp.sendChatEventTelemetry(Ng(((l={})[Ap.ChatEventType]=Lp.TaskModuleServiceResponse,l[Ap.ChatEventParameters]=JSON.stringify(r),l))),this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),[3,6];case 5:return a=d.sent(),Gp("MsgExtDialogLauncher : Error executing plugin operation",a),wp.sendErrorTelemetry(Ng(((c={})[Dp.ErrorMessage]=JSON.stringify(Vf(Vf({},r),{error:a})),c[Dp.ErrorCategory]=kp.MsgExtTaskModule,c[Dp.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),c))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return Qf(t,void 0,void 0,(function(){var t,r,o=this;return Jf(this,(function(i){switch(i.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=jf(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return r=Wf(),[4,Office.context.ui.displayDialogAsync(r,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return Qf(o,void 0,void 0,(function(){var n=this;return Jf(this,(function(r){return this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:this.taskModuleProps.triggeringActionTitle},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return Qf(n,void 0,void 0,(function(){return Jf(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return Qf(n,void 0,void 0,(function(){return Jf(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2]}))}))}))];case 1:return i.sent(),[2]}}))}))},this.openDialogForWebPlatformAsIframe=function(e,n){return Qf(t,void 0,void 0,(function(){var t,r=this;return Jf(this,(function(o){switch(o.label){case 0:return t=Wf(),[4,Office.context.ui.displayDialogAsync(t,{displayInIframe:!0,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return Qf(r,void 0,void 0,(function(){var t=this;return Jf(this,(function(n){return this.openedDialog.dialog=e.value,this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return Qf(t,void 0,void 0,(function(){return Jf(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),[2]}))}))}))];case 1:return o.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return Qf(t,void 0,void 0,(function(){var t,r,o,i=this;return Jf(this,(function(a){return this.shouldDisplayDismissIcon=!1,t=Wf(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(o=null===(r=this.taskModuleProps)||void 0===r?void 0:r.dialogTitle)&&void 0!==o?o:"Copilot Extensions Dialog",hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){i.openedDialog.dialog=e})).catch((function(e){Gp("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e,n){return Qf(t,void 0,void 0,(function(){var t,r,o,i,a,s;return Jf(this,(function(l){return this.taskModuleProps=n,t=null===(a=n.clientInfo)||void 0===a?void 0:a.clientType,r=e&&t===qf.WK.web?function(e){var t,n;if(e.viewMode===jp.S.TaskViewMode){var r=null===(t=e.dialogContent)||void 0===t?void 0:t.height,o=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!r||!o||"number"!=typeof o||"number"!=typeof r)return{dialogHeight:55,dialogWidth:50};var i=screen.width,a=screen.height;return{dialogHeight:Math.floor(r/a*100),dialogWidth:Math.floor(o/i*100)}}return{dialogHeight:80,dialogWidth:80}}(n):function(e){var t,n,r,o,i=e.viewMode,a=i===jp.S.TaskViewMode?window.outerWidth:window.innerWidth,s=i===jp.S.TaskViewMode?window.outerHeight:window.innerHeight,l=i===jp.S.TaskViewMode?5:0,c=i===jp.S.TaskViewMode?2:0,u=null===(t=e.dialogContent)||void 0===t?void 0:t.height,d=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof d&&"number"==typeof u&&d<=a&&u<=s){var p=Math.floor(u/s*100),g=Math.floor(d/a*100);r=p+l,o=g+c}else r=55,o=50}catch(e){r=55,o=50}return{dialogHeight:r,dialogWidth:o}}(n),o=r.dialogHeight,i=r.dialogWidth,(null===(s=n.clientInfo)||void 0===s?void 0:s.clientType)===qf.WK.web?e?this.openDialogForWebPlatformAsNewWindow(o,i):this.openDialogForWebPlatformAsIframe(o,i):this.openDialogForNativePlatform(o,i),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e}(),Xf=n(64147),Zf=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),Yf=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},$f=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},eh=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return Yf(this,void 0,void 0,(function(){var t,n,r;return $f(this,(function(o){switch(o.label){case 0:return t=(0,dg.A)(),oh(t,Xf.o.AuthService,Xf.L.GetToken,{request:e}),n=new Zf,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return r=o.sent(),[2,JSON.parse(r)]}}))}))},e}(),th=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},nh=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},rh=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return th(this,void 0,void 0,(function(){var t,n,r;return nh(this,(function(o){switch(o.label){case 0:return t=(0,dg.A)(),oh(t,Xf.o.ChannelService,Xf.L.BotInvoke,{request:e}),n=new Zf,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return r=o.sent(),[2,JSON.parse(r)]}}))}))},e}(),oh=function(e,t,n,r){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:zf.o.onServiceRequest,serviceName:t,apiName:n,requestData:r}),{targetOrigin:window.location.origin})},ih=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},ah=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},sh=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return ih(this,void 0,void 0,(function(){var t,n,r;return ah(this,(function(o){switch(o.label){case 0:return t=(0,dg.A)(),oh(t,Xf.o.AppService,Xf.L.GetApp,{request:e}),n=new Zf,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return r=o.sent(),[2,JSON.parse(r)]}}))}))},e.prototype.getApps=function(){return ih(this,void 0,void 0,(function(){var e,t,n;return ah(this,(function(r){switch(r.label){case 0:return e=(0,dg.A)(),oh(e,Xf.o.AppService,Xf.L.GetApps),t=new Zf,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=r.sent(),[2,JSON.parse(n)]}}))}))},e}(),lh=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,dg.A)();oh(t,Xf.o.TelemetryService,Xf.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,dg.A)();oh(t,Xf.o.TelemetryService,Xf.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,dg.A)();oh(t,Xf.o.TelemetryService,Xf.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,dg.A)();oh(t,Xf.o.TelemetryService,Xf.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,dg.A)();oh(t,Xf.o.TelemetryService,Xf.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,dg.A)();oh(t,Xf.o.TelemetryService,Xf.L.LogMetric,{request:e})},e}();a.memo((function(e){var t=e.dialogContent,n=e.appDefinition,r=e.userContext,o=e.hostContext,i=e.clientInfo,s=e.handleCloseButtonClick,l=e.shouldShowDismissIcon,c=e.copilotChatThemeV2,u=e.shouldDisplayInNewWindow,d=e.cardInfo,p=a.useMemo((function(){return sh.getInstance()}),[]),g=a.useMemo((function(){return eh.getInstance()}),[]),m=a.useMemo((function(){return rh.getInstance()}),[]),f=a.useMemo((function(){return lh.getInstance()}),[]),h=a.useMemo((function(){return new Hf.R}),[]);return a.createElement(Uf.q,{theme:c},a.createElement(Gf.K,{dialogContent:t,botService:m,appDefinition:n,tokenService:g,telemetryService:f,userContext:r,hostContext:o,appService:p,externalAuthService:h,clientInfo:i,isCardRenderingInTaskModuleEnabled:!0,handleCloseButtonClick:s,taskModuleLauncher:Kf.getInstance().launchTaskModule.bind(null,u),shouldShowDismissIcon:l,cardInfo:d,isDialogAcRendererEnabledForTaskModule:!0}))}));function ch(e,t,n,r){var o;void 0===r&&(r=!1);var i=function(e){return 0===(e||[]).length?0:e.filter((function(e){return!!e.cardJson})).length}(e);return i>0?(Gp("Getting msgExtProp for MsgExtCard here.."),o={attributions:e,clientInfo:t,hideSingleCitation:n},r&&Yg(i)):Gp("No data(cardJson) found for MsgExtCard."),o}function uh(e,t,n,r){var o;void 0===r&&(r=!1);var i=function(e){return 0===(e||[]).length?0:e.filter((function(e){return!!e.adaptiveCardJson})).length}(e);return i>0?(Gp("Getting apiPluginProp for ApiPluginCard here.."),o={attributions:e,clientInfo:t,hideSingleCitation:n},r&&Zg(i)):Gp("No data(adaptiveCardJson) found for ApiPluginCard."),o}var dh=function(e){var t,n=null===(t=null==e?void 0:e.adaptiveCards)||void 0===t?void 0:t[0];return n?{body:n}:null},ph=function(e){return"bot"===e.author&&"ConfirmationCard"===e.messageType},gh=n(13400),mh=n(55538),fh=function(e){},hh=(0,gh.mL)(mh.N,{currentLocale:void 0,strings:{},errorHandler:fh,loaders:[],stringMapInitialized:!1});var vh=n(58246);function yh(e){var t=e.lookupString,n=e.children,r=(0,vh.eO)(),o=a.useMemo((function(){return{lookupString:(e=t,n=r.lookupString,function(t){return function(r){var o=e(t)(r);if(o!==t)return o;var i=n(t)(r);return i!==t?i:t}})};var e,n}),[t,r]);return a.createElement(vh.d7,{value:o},n)}var Ch,Sh=n(70200),bh=function(e){var t,n=e.clientInfoRef,r=e.theme,o=e.locale,i=e.clientId,s=e.redirectUri,l=e.isWebPlatform,c=a.useRef(void 0),u=function(){t&&t.close(),t=void 0},d=a.useCallback((function(e){c.current=e;var a=window.location.href.replace("taskpane.html","CloudFilePickerDialog.html"),d=r===Sh.G.defaultBlack,p=function(e){var r,a,l,p,g,m,f=JSON.parse(e);switch(f.type){case Xg.Ack:var h={userPrincipalName:null!==(l=null===(a=n.current)||void 0===a?void 0:a.userPrincipalName)&&void 0!==l?l:"",clientId:i,redirectUri:s,locale:o,isDarkMode:d};wp.sendChatEventTelemetry(Ng(((r={})[Ap.ChatEventType]=Lp.CloudFilesDialogOpened,r))),t&&t.messageChild(JSON.stringify(h),{targetOrigin:"*"});break;case Xg.CloseEvent:u(),null===(p=c.current)||void 0===p||p.closeCiqCallback();break;case Xg.OnItemSelected:u();var v=f.files;null===(g=c.current)||void 0===g||g.onItemSelected(v);break;case Xg.OnErrorInLoading:u(),null===(m=c.current)||void 0===m||m.onErrorInLoading()}};l?Office.context.ui.displayDialogAsync(a,{displayInIframe:!0,hideTitle:!0,height:65,width:60},(function(e){null==(t=e.value)||t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){var t;p(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"")}))})):OfficeFirstPartyDialog.displayWebDialog(a,{displayInIframe:!0,dialogTitle:"",hideTitle:!0,height:65,width:60,onMessage:p,onClose:function(){var e;null===(e=c.current)||void 0===e||e.closeCiqCallback()}}).then((function(e){t=e}))}),[n,r,c]);return{onAttachCloudFiles:d}},Eh=function(){return a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),a.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),a.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),a.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),a.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),a.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),a.createElement("defs",null,a.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},a.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),a.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),a.createElement("stop",{offset:"1",stopColor:"#0736C4"})),a.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},a.createElement("stop",{stopColor:"#FFB657"}),a.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),a.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),a.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),a.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),a.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),a.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),a.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#3DCBFF"}),a.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},a.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),a.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),a.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),a.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),a.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))},Th=function(){return a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),a.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),a.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),a.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),a.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),a.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),a.createElement("defs",null,a.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},a.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),a.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),a.createElement("stop",{offset:"1",stopColor:"#0736C4"})),a.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},a.createElement("stop",{stopColor:"#FFB657"}),a.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),a.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),a.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),a.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),a.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),a.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),a.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#3DCBFF"}),a.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},a.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),a.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),a.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),a.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),a.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))};!function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(Ch||(Ch={}));var Ih,_h=n(92776),wh=n(26586),Ph=n(76558),xh=n(58651),kh=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Ah=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};(function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return kh(t,void 0,void 0,(function(){var e;return Ah(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){xh.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===qg.win32?this.handleDefaultThemeChange():this.platform===qg.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}})(),(0,a.createContext)({officePlatform:qg.web,officeTheme:void 0});!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(Ih||(Ih={}));var Lh,Dh,Oh="I ran into a problem while completing your request. Please try again.",Nh=function(){function e(e){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set;var t=this.getDocumentHandoffMessageId();t&&this.pendingHandoffMessageIds.add(t)}return e.prototype.getDocumentHandoffMessageId=function(){var e=Lf.getSettingAsString(kf.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,dg.A)(),r=this.getHandoffMessageIdSignal(n,t,e),o=new Vp.g0({parentPath:["Signal",_h.uC.getTypeName()],items:[{id:rg.generateId(),body:r}]});e===wh.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(r.H_.T_,{operation:o,workflowAnnotationType:_h.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(r)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.handleHandoffMessage=function(e,t){try{if(!(null==e?void 0:e.body)||!_h.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var n=e.body;if(this.HandoffOperations.onAnnotationReceived(_h.uC.getTypeName(),n,this.handoffMessageIdRequestSubmitTime,t),n.scenarioName===Ph.Cu.INAPP)return void this.processHandoffMessage(n);if(!this.isHandoffMessageIdSignalTracked(n.queryId))return;if(n.error){if(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+n.error),n.error.includes("Unable to download content. The specified blob does not exist")||n.error.includes("Unable to download content. Request failed with status code 500"))return;return void this.HandoffOperations.onError(Ih.HandoffMessageResponse,Oh)}var r=this.getHandoffMessageIdFromSignal(n.queryId);return this.sendHandoffMessageId(wh.Q.PROCESSED,r),this.completeTrackedHandoffMessageIdSignal(n.queryId),this.processHandoffMessage(n),r}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)},e}(),Rh=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Fh=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Mh=(function(){function e(e){this.HandoffOperations=e}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e),n=new Vp.Xr({parentPath:["session","doc"],items:[{id:rg.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:_h.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return Rh(this,void 0,void 0,(function(){var n,r;return Fh(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),!_h.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return n=e.body,this.HandoffOperations.onAnnotationReceived(_h.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(Ih.OutboundMessageResponse,n.error),[3,5]):[3,1];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(Ih.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:return o.sent(),[3,5];case 4:this.HandoffOperations.onError(Ih.NoGeneratedLinks),o.label=5;case 5:return[3,7];case 6:throw r=o.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+r.message),r;case 7:return[2]}}))}))}}(),function(e){var t,n;return{accessToken:e.accessToken,expirationTime:null!==(n=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0}}),Bh=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Uh=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Hh=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},Gh=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function zh(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FA000000129."+e,t)||OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.PowerPoint.fa000000129."+e,t)}function qh(e,t){return OfficeRuntime.experimentation.getIntFeatureGate("Microsoft.Office.PowerPointOnline.FA000000129."+e,t)||OfficeRuntime.experimentation.getIntFeatureGate("Microsoft.Office.PowerPoint.fa000000129."+e,t)}function Wh(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FA000000129."+e,t)&&OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.PowerPoint.fa000000129."+e,t)}function jh(e,t){var n=OfficeRuntime.experimentation.getStringFeatureGate("Microsoft.Office.PowerPointOnline.FA000000129."+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getStringFeatureGate("Microsoft.Office.PowerPoint.fa000000129."+e);return void 0!==r?r:t}function Vh(e){return zh(e)}function Qh(){return zh("IsReviewerAgentEnabled",!1)}function Jh(e){return Wh(e)}function Kh(){return Wh("IncrementalAshaTelemetryLoggingEnabled")}function Xh(){return Wh("LogChatPaneLoadTelemetryEventEnabled")}function Zh(){return Wh("LogAuthFlowForDesignerTelemetryEnabled")}function Yh(){return zh("EnableSendTenantFeedback",!1)}function $h(){return Wh("IsGroundingPhase2UxEnabled")}function ev(){return Wh("IsSydneyWorkflowForConsumerUserEnabled")}function tv(){return Wh("showUpdatedAshaStrings")}function nv(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function rv(e,t){for(var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?"g":"gi",o=nv(t,RegExp)?t:new RegExp(t,r),i=[];null!==(n=o.exec(e));)i.push(n);return i}function ov(){return new OfficeExtension.Promise((function(e,t){var n;Office.context.document.getFileAsync(Office.FileType.Compressed,{sliceSize:4194304},(n=(0,gd._)((function(n){var r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:if(n.status!=Office.AsyncResultStatus.Succeeded)return[3,4];r=n.value,o=r.sliceCount,iv(r,0,o,!0,[],0,i=[]),a.label=1;case 1:return 0!=i.length?[3,3]:[4,lF(100)];case 2:return a.sent(),[3,1];case 3:return e(i[0]),[3,5];case 4:t(ZR("Get Document as compressed failed "+n.error.message)),a.label=5;case 5:return[2]}}))})),function(e){return n.apply(this,arguments)}))}))}function iv(e,t,n,r,o,i,a){e.getSliceAsync(t,(function(s){if("succeeded"==s.status){if(!r)return void ZR("Failed to get all slices, no need to continue.");o[s.value.index]=s.value.data,++i==n?(ZR("All slices have been received."),e.closeAsync(),av(o,a)):iv(e,++t,n,r,o,i,a)}else r=!1,e.closeAsync()}))}function av(e,t){for(var n=[],r=0;r<e.length;r++)n=n.concat(e[r]);for(var o=new String,i=0;i<n.length;i++)o+=String.fromCharCode(n[i]);t.push(btoa(o))}function sv(e){return e.charAt(0).toLowerCase()+e.slice(1)}!function(e){e.HandoffEnabled="HandoffEnabled",e.InAppHandoffEnabled="InAppHandoffEnabled",e.TryNewDesignOptionInMenuEnabled="TryNewDesignOptionInMenuEnabled",e.LearnMoreOptionInMenuEnabled="LearnMoreOptionInMenuEnabled",e.ChatHistoryTimeoutRetryFix="ChatHistoryTimeoutRetryFix",e.IsHardcodedClientErrorMessagingEnabled="IsHardcodedClientErrorMessagingEnabled",e.IsSuggestionsForCommandingEnabled="IsSuggestionsForCommandingEnabled",e.isNetworkCheckEnabled="isNetworkCheckEnabled",e.IsHubbleEnterpriseEnabled="EnableHubbleEnterprise",e.IsCommandingWorkflowEnabled="EnableCommandingWorkflow",e.IsjOFCCommandingWorkflowEnabled="EnablejOFCCommandingWorkflow",e.IsCommandingScopeAppChatV2Enabled="EnableCommandingScopeAppChatV2",e.ShouldEnableTryNewDesign="EnableTryNewDesign",e.Tier3LanguageSupport="Tier3LanguageSupport",e.Tier2Point5LanguageSupport="Tier2Point5LanguageSupport",e.EnableSendTenantFeedback="EnableSendTenantFeedback",e.IsInputV2Enabled="IsInputV2Enabled",e.UseOfficeJSDocumentURL="UseOfficeJSDocumentURL",e.IsAllEntitiesSupported="IsAllEntitiesSupported",e.IsClpSensitivityInChatInputEnabled="IsClpSensitivityInChatInputEnabled",e.IsCopilotPromptLabEnabled="IsCopilotPromptLabEnabled",e.IsSharedCopilotLabEnabled="IsSharedCopilotLabEnabled",e.IsPresentationTransformerWFEnabled="IsPresentationTransformerWFEnabled",e.IsQnASuggestionPillCachingEnabled="IsQnASuggestionPillCachingEnabled",e.IsPreTriggerContentProcessingWorkflowEnabled="IsPreTriggerContentProcessingWorkflowEnabled",e.UseAIResponsesInODSLForSydney="UseAIResponsesInODSLForSydney",e.IsSelfHelpSearchRenderingEnabled="SelfHelpSearchRenderingEnabled",e.IsApplyLabelUsingTryUpgradeLabelEnabled="IsApplyLabelUsingTryUpgradeLabelEnabled",e.ShouldSendTelemetrySink="ShouldSendTelemetrySink",e.IsSydneyDebugToggleEnabled="IsSydneyDebugToggleEnabled",e.IsPresentationRecommendationEnabled="IsPresentationRecommendationEnabled",e.IsVisualSummarizationEnabled="IsVisualSummarizationEnabled",e.IsCopilotThemeForWebEnabled="IsCopilotThemeForWebEnabled",e.IsDesignerCopilotEnabled="IsDesignerCopilotEnabled",e.IsEnterpriseBase64ImageEnabled="IsEnterpriseBase64ImageEnabled",e.EnableSemanticSelectionWithPaginatedCards="EnableSemanticSelectionWithPaginatedCards",e.IsCreateJsonCmdListForBumbleBeeEnabled="IsCreateJsonCmdListForBumbleBeeEnabled",e.IsCIQPaperClipButtonEnabled="IsCIQPaperClipButtonEnabled",e.IsZQMV2Enabled="IsZQMV2Enabled",e.EnableEnterpriseToggleInPhase2Ux="EnableEnterpriseToggleInPhase2Ux",e.IsDesignerDogfoodEndpointEnabled="IsDesignerDogfoodEndpointEnabled",e.RedirectURLEndpointOverride="RedirectURLEndpointOverride",e.TriggerPresentationRecommendationWithBeautify="TriggerPresentationRecommendationWithBeautify",e.DisableXPIAMitigationFix="DisableXPIAMitigationFix",e.UseUpdatedZQMV2PromptString="UseUpdatedZQMV2PromptString",e.EnableFluent2Tokens="EnableFluent2Tokens",e.RehydrateMessagesConsumer="RehydrateMessagesConsumer",e.IsChatHistoryHydrationErrorEnabled="IsChatHistoryHydrationErrorEnabled",e.IsPersistentChatHistoryEnabledForConsumer="IsPersistentChatHistoryEnabledForConsumer",e.RemoveContextFromInputSignalEnabled="RemoveContextFromInputSignalEnabled",e.IsBumbleBeeEnabledForConsumer="IsBumbleBeeEnabledForConsumer",e.IsContentValidatorWorkflowEnabled="IsContentValidatorWorkflowEnabled",e.ExcelAsInput="ExcelAsInput",e.EnableMultiDocumentsTransformation="EnableMultiDocumentsTransformation",e.IsLicenseAnnotationEnabled="IsLicenseAnnotationEnabled",e.IsFeedbackAppChatIntegrationEnabled="IsFeedbackAppChatIntegrationEnabled",e.IsImageInputEnabled="IsImageInputEnabled",e.IsSketchToImageEnabled="IsSketchToImageEnabled",e.ImageSizeLimitInMB="ImageSizeLimitInMB",e.ImageSizeLimitInKB="ImageSizeLimitInKB",e.UseImageSizeLimitInKB="UseImageSizeLimitInKB",e.ImageSizeLimitInMBWhenResizing="ImageSizeLimitInMBWhenResizing",e.ImageResizedSizeInKB="ImageResizedSizeInKB",e.ImageResizeCompressionQuality="ImageResizeCompressionQuality",e.ImageResizePreferredSizeInPx="ImageResizePreferredSizeInPx",e.IsVisualSummaryUIEnabled="IsVisualSummaryUIEnabled",e.UseDesignerChatCardWrapper="UseDesignerChatCardWrapper",e.IsCitationSupportForAvalonEnabled="IsCitationSupportForAvalonEnabled",e.IsBumbleBeeZQMVisibleForConsumer="IsBumbleBeeZQMVisibleForConsumer",e.ShowPersonalizationSuggestionPill="ShowPersonalizationSuggestionPill",e.IsDebugSectionV2Enabled="IsDebugSectionV2Enabled",e.IsCIQEnabledForConsumerAccount="IsCIQEnabledForConsumerAccount",e.IsMarkdownSummarizationEnabled="IsMarkdownSummarizationEnabled",e.IsPersonalizationUXEnabled="IsPersonalizationUXEnabled",e.IsMsgExtEnabled="IsMsgExtEnabled",e.IsApiPluginsEnabled="IsApiPluginsEnabled",e.IsApiPluginsCardsEnabled="IsApiPluginsCardsEnabled",e.LogMSALTokenRequestTelemetry="LogMSALTokenRequestTelemetry",e.EnableCreatePpcConnections="EnableCreatePpcConnections",e.IsPowerPlatformPluginsEnabled="IsPowerPlatformPluginsEnabled",e.IsSccVoiceEnabled="IsSccVoiceEnabled",e.IsSccCiqEnabled="IsSccCiqEnabled",e.IsCustomGPTsEnabled="IsCustomGPTsEnabled",e.IsPersonalizationConfirmationResponseEnabled="IsPersonalizationConfirmationResponseEnabled",e.IsErrorBoundaryEnabled="IsErrorBoundaryEnabled",e.IsMultiFileURLScreenFeatureEnabled="IsMultiFileURLScreenFeatureEnabled",e.AugloopResponseTimeoutDuration="AugloopResponseTimeoutDuration",e.StorytellerOutlineResponseTimeoutDuration="StorytellerOutlineResponseTimeoutDuration",e.IsMidgardComponentsLocalizationEnabled="IsMidgardComponentsLocalizationEnabled",e.AreCannedQueriesEnabledForAvalon="AreCannedQueriesEnabledForAvalon",e.EnableDesignerFeedbackDataForDebugMode="EnableDesignerFeedbackDataForDebugMode",e.IsWikipediaTransformFeatureEnabled="IsWikipediaTransformFeatureEnabled",e.IsEmptyLabelFixForCLPv2FeatureEnabled="IsEmptyLabelFixForCLPv2FeatureEnabled",e.IsSwitcherMenuContainerEnabled="IsSwitcherMenuContainerEnabled",e.UseCopilotActionCommands="UseCopilotActionCommands",e.IsNotificationEnabledForSummary="IsNotificationEnabledForSummary",e.UseDesignerPromptForDalle="UseDesignerPromptForDalle",e.IsReviewerAgentEnabled="IsReviewerAgentEnabled",e.IsReviewerAgentToggleEnabled="IsReviewerAgentToggleEnabled",e.isViewActionForCopilotActionAsyncAPIEnabled="isViewActionForCopilotActionAsyncAPIEnabled",e.IsUseStoryTellerJsonCmdEnabled="IsUseStoryTellerJsonCmdEnabled",e.IsCopilotPlayKeySlidesEnabled="IsCopilotPlayKeySlidesEnabled",e.IsClickableCopilotKeySlidesEnabled="IsClickableCopilotKeySlidesEnabled",e.EnableAnchorTagOverrideForKeySlides="EnableAnchorTagOverrideForKeySlides",e.IsCopilotSharedHeaderEnabled="IsCopilotSharedHeaderEnabled",e.EditorFluentV9SettingEnabled="EditorFluentV9SettingEnabled",e.IsCustomHandlingForChatHistoryEnabled="IsCustomHandlingForChatHistoryEnabled",e.UseCanCollectCopilotFeedbackAPI="UseCanCollectCopilotFeedbackAPI",e.ShowPluginFlyoutTeachingPopoverEnabled="ShowPluginFlyoutTeachingPopoverEnabled",e.UseSketchImageCardForBeautifyingInk="UseSketchImageCardForBeautifyingInk",e.IsChatHistoryOnSwitcherMenuEnabled="IsChatHistoryOnSwitcherMenuEnabled",e.ShouldRenderAllHyperLinks="ShouldRenderAllHyperLinks",e.IsPasteUnfurlingEnabled="IsPasteUnfurlingEnabled",e.ShouldLaunchTaskModuleInNewWindow="ShouldLaunchTaskModuleInNewWindow",e.IsCreditsUIInternalEnabled="IsCreditsUIInternalEnabled",e.IsQueryWarmupSignalEnabled="IsQueryWarmupSignalEnabled",e.IsQueryWarmupSignalEnabledOnChatPaneOpens="IsQueryWarmupSignalEnabledOnChatPaneOpens",e.UrlDetailedErrorEnabled="UrlDetailedErrorEnabled",e.DisableSuggestionOnImageInsert="DisableSuggestionOnImageInsert",e.IsPluginStatePersistEnabled="IsPluginStatePersistEnabled",e.UseDisengagedMessageType="UseDisengagedMessageType",e.IsEnableAppGptsInCIQ="IsEnableAppGptsInCIQ",e.IsEnableAppPluginsInCIQ="IsEnableAppPluginsInCIQ",e.IsEnableTopicECC="IsEnableTopicECC",e.IsCopilotCommandingSteerabilityEnabled="IsCopilotCommandingSteerabilityEnabled",e.IsDesignerShownInZQM="IsDesignerShownInZQM",e.IsViewMorePromptsIconV2Enabled="IsViewMorePromptsIconV2Enabled",e.IsViewMorePromptsOneClickEnabled="IsViewMorePromptsOneClickEnabled",e.IsEnableAppMsgExtInCIQ="IsEnableAppMsgExtInCIQ",e.IsEnableAppPPInCIQ="IsEnableAppPPInCIQ",e.IsEnableAppTypeBInCIQ="IsEnableAppTypeBInCIQ",e.IsChatClickForGPTsEnabled="IsChatClickForGPTsEnabled",e.IsNewChatOnCopilotGPTItemEnabled="IsNewChatOnCopilotGPTItemEnabled",e.IsNewChatOnGPTItemsEnabled="IsNewChatOnGPTItemsEnabled",e.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled="IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled",e.EnableQueryBeforeAnnotationLoad="EnableQueryBeforeAnnotationLoad",e.IsCloudFileUploadEnabled="IsCloudFileUploadEnabled",e.IsAttachmentListEnabled="IsAttachmentListEnabled",e.IsTriggerPptVisualOperationEnabled="IsTriggerPptVisualOperationEnabled",e.IsPluginToolboxEnabledForPlugins="IsPluginToolboxEnabledForPlugins",e.PromptInputLength="PromptInputLength"}(Lh||(Lh={})),function(e){e.AddSlideParseLayout="AddSlideParseLayout",e.CreatePresentationInMenuEnabled="CreatePresentationInMenuEnabled",e.TransformFileInMenuEnabled="TransformFileInMenuEnabled",e.AddSlideInMenuEnabled="AddSlideInMenuEnabled",e.AddImageInMenuEnabled="AddImageInMenuEnabled",e.ChangeTextFormatInMenuEnabled="ChangeTextFormatInMenuEnabled",e.StructurePresentationInMenuEnabled="StructurePresentationInMenuEnabled",e.AnimateInMenuEnabled="AnimateInMenuEnabled",e.SummarizeInMenuEnabled="SummarizeInMenuEnabled",e.LearnMoreOptionInMenuEnabled="LearnMoreOptionInMenuEnabled",e.ScreenshotInFeedbackEnabled="ScreenshotInFeedbackEnabled",e.UseApplyJOfcCommandsAsyncForiOS="UseApplyJOfcCommandsAsyncForiOS",e.ShouldCheckJOFCCommandAPIVersion="CheckJOFCCommandAPIVersion",e.ShouldForceOfficeJSImplementationForCommanding="ForceOfficeJSImplementationForCommanding",e.ShouldEnableCommandingErrorCard="EnableCommandingErrorCard",e.ShouldEnableTextRangeInJOFCCommands="EnableTextRangeInJOFCCommands",e.ShouldSupportHVCDetectionOnClientSide="SupportHVCDetectionOnClientSide",e.IsCardSpanWrappingEnabled="CardSpanWrappingEnabled",e.IsSpaceRequiredAfterInput="IsSpaceRequiredAfterInput",e.isClaimsChallengeMessageInAnnotationEnabled="isClaimsChallengeMessageInAnnotationEnabled",e.ShouldSupportLastSlideSelection="SupportLastSlideSelection",e.UseCorrectSlideIndexInPPTOdslSignal="UseCorrectSlideIndexInPPTOdslSignal",e.HandleCommandingFailuresWithoutShowMe="HandleCommandingFailuresWithoutShowMe",e.LogChatEventWhenMakingAJOFCCall="LogChatEventWhenMakingAJOFCCall",e.LogChatEventWhenPromptAndSourceInSingleGenerateSlides="LogChatEventWhenPromptAndSourceInSingleGenerateSlides",e.LogChatEventWhenAnimationIsFalse="LogChatEventWhenAnimationIsFalse",e.HandleUnsupportedCommandErrorCode="HandleUnsupportedCommandErrorCode",e.HandleResolveDelegationInvalidSourceErrorCode="HandleResolveDelegationInvalidSourceErrorCode",e.IsHandoffAutoSubmitPromptsEnabled="isHandoffAutoSubmitPromptsEnabled",e.IsNoFeedbackInUnsupportedCommanding="NoFeedbackInUnsupportedCommanding",e.IsStoryTellerBlockedWithEmptyPrompt="IsStoryTellerBlockedWithEmptyPrompt",e.ShowErrorIfContentInsertionFailed="ShowErrorIfContentInsertionFailed",e.IsCreatePresentationEnabled="IsCreatePresentationEnabled",e.ShouldDisableAllCommandsAfterGenerateSlides="DisableAllCommandsAfterGenerateSlides",e.IsAddSlideEnabled="IsAddSlideEnabled",e.IsAddTextEnabled="IsAddTextEnabled",e.IsFormatTextEnabled="IsFormatTextEnabled",e.IsAddImageEnabled="IsAddImageEnabled",e.IsCommandingBlockedWithDismissedArgument="IsCommandingBlockedWithDismissedArgument",e.IsEntitiesLogRemovedFromChatEventParameters="IsEntitiesLogRemovedFromChatEventParameters",e.IsBumbleBeeWhenSourcePresent="IsBumbleBeeWhenSourcePresent",e.IsScenarioErrorTelemetryEnabled="IsScenarioErrorTelemetryEnabled",e.IsSendSlideMonikerEnabled="IsSendSlideMonikerEnabled",e.ShowErrorIfAnimationAlreadyExists="ShowErrorIfAnimationAlreadyExists",e.IsUserTypeFromHostSettingsEnabled="IsUserTypeFromHostSettingsEnabled",e.UseOrganizePresentationJOfcCmds="UseOrganizePresentationJOfcCmds",e.StorytellerLogDebugDataEnabled="StorytellerLogDebugDataEnabled",e.ShouldStorytellerSetScenarioFromAddSlideParam="ShouldStorytellerSetScenarioFromAddSlideParam",e.ShouldUseNewStorytellerErrors="ShouldUseNewStorytellerErrors",e.IsSegmentToSlideSendTemplateIdEnabled="IsSegmentToSlideSendTemplateIdEnabled",e.IsNewPptCopilotWorkflowIntegrationEnabled="IsNewPptCopilotWorkflowIntegrationEnabled",e.IsGroundingPhase2UxEnabled="IsGroundingPhase2UxEnabled",e.IsGroundingPhase2UxEnabledForConsumer="IsGroundingPhase2UxEnabledForConsumer",e.IsEnterpriseSearchDefaultOn="IsEnterpriseSearchDefaultOn",e.IsWebSearchDefaultOn="IsWebSearchDefaultOn",e.ShowLoadingMessagesFromSydney="ShowLoadingMessagesFromSydney",e.IsPersistanceInPhase2UxEnabled="IsPersistanceInPhase2UxEnabled",e.IsClpEnabledInEnterpriseForSydney="IsClpEnabledInEnterpriseForSydney",e.ShouldSendALConfigForRAI="ShouldSendALConfigForRAI",e.isODSLResponseCheckEnabled="IsODSLResponseCheckEnabled",e.ShouldInsertedShapeAutoFitToText="EnableInsertedShapeAutoFitToText",e.ShouldEnableCommandingTelemetry="EnableCommandingTelemetry",e.IsErrorMessageLogAllowedForCommanding="EnableErrorMessageLogForCommanding",e.IsCitationsEnabled="IsCitationsEnabled",e.ShouldRenderErrorResponseFromFinalAnnotation="ShouldRenderErrorResponseFromFinalAnnotation",e.ShouldUseCreationIdsForShapeCommands="UseCreationIdsForShapeCommands",e.EnableGetJsonCmdVersion="EnableGetJsonCmdVersion",e.ShouldUseSeparateHorizontalVerticalCommands="UseSeparateHorizontalVerticalCommands",e.ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion="ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion",e.IsCreatePresentaionCIQAppScenarioEnabled="IsCreatePresentaionCIQAppScenarioEnabled",e.EnableCheckBeforeSplit="EnableCheckBeforeSplit",e.IsTransformFileSensitivityLabelErrorMessageEnabled="IsTransformFileSensitivityLabelErrorMessageEnabled",e.IsCommandingUserPerceivedLatencyTelemetryEnabled="IsCommandingUserPerceivedLatencyTelemetryEnabled",e.IsASHATelemetryToBeLoggedAtStreamEndOnce="IsASHATelemetryToBeLoggedAtStreamEndOnce",e.IsTelemetryEnabledForCommandingFailureCases="IsTelemetryEnabledForCommandingFailureCases",e.ShouldStoreNonStreamingSydneyMessageInChatHistory="ShouldStoreNonStreamingSydneyMessageInChatHistory",e.ChooseGenerateWithSourceOverPrompt="ChooseGenerateWithSourceOverPrompt",e.IsApplyCLPLabelErrorChangeEnabled="IsApplyCLPLabelErrorChangeEnabled",e.IsAllPptCommandErrorLogEnabled="IsAllPptCommandErrorLogEnabled",e.IsMultipleGenerateSlidesCommandDisabled="IsMultipleGenerateSlidesCommandDisabled",e.ErrorMessageInAIContextEnabledPPT="ErrorMessageInAIContextEnabledPPT",e.UseImageOutOfScopeIntentErrorForImageInvalid="UseImageOutOfScopeIntentErrorForImageInvalid",e.IsJofcCommandErrorTelemetryEnabled="IsJofcCommandErrorTelemetryEnabled",e.IsCommandingScopeAppChatV2EnabledCG="EnableCommandingScopeAppChatV2CG",e.LogOrganizeWorkflowDuration="LogOrganizeWorkflowDurations",e.LogTimeToIntentDetectionDuration="LogTimeToIntentDetectionDuration",e.ShouldReturnCustomStringForNoTopic="ShouldReturnCustomStringForNoTopic",e.LogQuerySubmitTime="LogQuerySubmitTime",e.ShouldAddLinkSuffixForErrorMessage="ShouldAddLinkSuffixForErrorMessage",e.IsCreatePresentationWarningTypeLogEnabled="IsCreatePresentationWarningTypeLogEnabled",e.UseNewCopilotSharedPackage="UseNewCopilotSharedPackage",e.IgnoreMarkerForHvcPrefixFinding="IgnoreMarkerForHvcPrefixFinding",e.UseSortedHVCTokenList="UseSortedHVCTokenList",e.ShouldAddFeatureNameInLatencyTableIfEmpty="AddFeatureNameInLatencyTableIfEmpty",e.IsNERBlockingUIEnabled="IsNERBlockingUIEnabled",e.IsFeedbackAIThumbsUpScenarioEnabled="IsFeedbackAIThumbsUpScenarioEnabled",e.OrganizeDesignerOptions="OrganizeDesignerOptions",e.EnableALCorrelationLogs="EnableALCorrelationLogs",e.EnableZQMQuerySubmissionThroughChatInputBox="EnableZQMQuerySubmissionThroughChatInputBox",e.EnableCIQWithUserTypeCheck="EnableCIQWithUserTypeCheck",e.ShowSpecificErrorsForEncryptedFiles="ShowSpecificErrorsForEncryptedFiles",e.IsPersonalizationEntryPointInPromptMenuEnabled="IsPersonalizationEntryPointInPromptMenuEnabled",e.ShouldCLPExceptionDisableEnterpriseSearch="ShouldCLPExceptionDisableEnterpriseSearch",e.LogRestrictedInfo="LogRestrictedInfo",e.IsUpdatedCannedStringsEnabled="IsUpdatedCannedStringsEnabled",e.IsPersonalizationIndicatorHeaderEnabled="IsPersonalizationIndicatorHeaderEnabled",e.SetScenarioNameEnabled="SetScenarioNameEnabled",e.DifferentiateCancelFromWarningCard="DifferentiateCancelFromWarningCard",e.IsExtraStopGenLogEnabled="IsExtraStopGenLogEnabled",e.IsInitiatorViewTelemetryFieldAdded="IsInitiatorViewTelemetryFieldAdded",e.isMSAAuthWorkaroundEnabled="isMSAAuthWorkaroundEnabled",e.IsUnsupportedEntitiesEnabled="IsUnsupportedEntitiesEnabled",e.CustomerOneDriveOnlyUrlChange="CustomerOneDriveOnlyUrlChange",e.ShouldSendCopilotLabCategories="ShouldSendCopilotLabCategories",e.IsShouldSendStopGeneratingSignaltoALEnabled="IsShouldSendStopGeneratingSignaltoALEnabled",e.IsGroupedCopilotPluginEnabled="IsGroupedCopilotPluginEnabled",e.useFreFlagRoamingService="useFreFlagRoamingService",e.IsSketchImageCardEnabled="IsSketchImageCardEnabled",e.IsImageResizeEnabled="IsImageResizeEnabled",e.IsSketchImageResizeEnabled="IsSketchImageResizeEnabled",e.IsNoopOnSameSensitivityLabel="IsNoopOnSameSensitivityLabel",e.IsPACTokenEnabled="IsPACTokenEnabled",e.UseDataURIToImageTileShared="UseDataURIToImageTileShared",e.IsFeedbackAppChatThemingEnabled="IsFeedbackAppChatThemingEnabled",e.IsDalleImageRehydrationEnabled="IsDalleImageRehydrationEnabled",e.IsAtMentionRedirectURLSetup="IsAtMentionRedirectURLSetup",e.IsMsgExtTelemetryEnabled="IsMsgExtTelemetryEnabled",e.IsCopilotExtTelemetryEnabled="IsCopilotExtTelemetryEnabled",e.GetUserPresentationDetails="GetUserPresentationDetails",e.IsAriaAnnouncerEnabled="IsAriaAnnouncerEnabled",e.IsStringReplacementAnchorTagOverrideEnabled="IsStringReplacementAnchorTagOverrideEnabled",e.ShouldUseMsalSsoSilentLogin="ShouldUseMsalSsoSilentLogin",e.IsClickableCopilotKeySlidesDependentOnSlideIds="IsClickableCopilotKeySlidesDependentOnSlideIds",e.IsHideSingleCitationEnabled="IsHideSingleCitationEnabled",e.SendFeedbackClientAppName="sendFeedbackClientAppName",e.ShowPluginReferencesV3="ShowPluginReferencesV3",e.ShouldUseOfficeHubName="ShouldUseOfficeHubName",e.EnablePluginSearchInFlyout="EnablePluginSearchInFlyout",e.EnableMorePluginHyperLinkInFlyout="EnableMorePluginHyperLinkInFlyout",e.UseUpdatedGroundingButtonTitle="UseUpdatedGroundingButtonTitle",e.EnableQueryEndOnGptSwitch="EnableQueryEndOnGptSwitch",e.EnableMorePlugins="EnableMorePlugins",e.UseExternalAuthService="UseExternalAuthService",e.ShowSystemMessageOnPluginToggle="ShowSystemMessageOnPluginToggle"}(Dh||(Dh={}));var lv,cv,uv,dv,pv,gv=function(){function e(){Sp(this,e)}return Ep(e,null,[{key:"addImage",value:function(t){e.images.push(t)}},{key:"findImageDataArrayFromDescription",value:function(t,n){return(0,gd._)((function(){return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return ZR("findImageDataArrayFromDescription: "+t+" "+n),[4,dF((function(){var r=e.images.filter((function(e){return e.description===t}));return r.length>=n?(e.images=e.images.filter((function(e){return e.description!==t})),Promise.resolve(r)):Promise.reject(new Error("Image not found"))}),15,200)];case 1:return[2,r.sent()]}}))}))()}},{key:"findImageDataFromDescription",value:function(t){return(0,gd._)((function(){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,dF((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!==n){var r=e.images.splice(n,1);return Promise.resolve(r[0])}return Promise.reject(new Error("Image not found"))}),15,200)];case 1:return[2,n.sent()]}}))}))()}},{key:"findImageUrlFromDescription",value:function(t){return(0,gd._)((function(){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,dF((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!==n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return[2,n.sent()]}}))}))()}},{key:"insertImage",value:function(t){return(0,gd._)((function(){var n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,6,,7]),[4,dF((function(){var n=e.images.findIndex((function(e){return e.description===t}));if(-1!==n){var r=e.images.splice(n,1);return Promise.resolve(r[0].url)}return Promise.reject()}),15,200)];case 1:return(n=o.sent())?[3,2]:(ZR("insertImageFromAl: Could not find image matching description"),[2,void 0]);case 2:return o.trys.push([2,4,,5]),[4,YR(n)];case 3:return[2,o.sent()];case 4:return o.sent(),ZR("failed to fetch image from url and encode it as base64"),[2,void 0];case 5:return[3,7];case 6:return r=o.sent(),ZR("insertImageFromAl: Could not find image matching description error: "+r+":"+(null==r?void 0:r.message)),[2,void 0];case 7:return[2]}}))}))()}}]),e}();(0,i._)(gv,"images",[]),function(e){e[e.Presentation=0]="Presentation",e[e.Slide=1]="Slide",e[e.DrawingElement=2]="DrawingElement",e[e.Table=3]="Table",e[e.Section=4]="Section",e[e.Other=100]="Other"}(lv||(lv={})),function(e){e[e.Slide=0]="Slide",e[e.Shape=1]="Shape",e[e.Text=2]="Text"}(cv||(cv={})),function(e){e[e.Title=0]="Title",e[e.Subtitle=1]="Subtitle",e[e.Content=2]="Content",e[e.Note=3]="Note",e[e.SmartArt=4]="SmartArt",e[e.Image=5]="Image",e[e.TextBox=6]="TextBox",e[e.Table=7]="Table",e[e.Chart=8]="Chart",e[e.Cameo=9]="Cameo",e[e.Other=100]="Other"}(uv||(uv={})),function(e){e[e.Link=0]="Link",e[e.Raw64=1]="Raw64"}(dv||(dv={})),function(e){e[e.String=0]="String",e[e.HTML=1]="HTML"}(pv||(pv={}));var mv,fv,hv,vv,yv,Cv,Sv,bv,Ev,Tv,Iv,_v,wv,Pv,xv,kv,Av,Lv,Dv="1.0.0",Ov="1.1.0.0",Nv="1.2.0.0",Rv="jOFC command version not supported";!function(e){e.CreatePresentationCmd="CreatePresentationCmd",e.AddSlidesCmd="AddSlidesCmd",e.AddPictureCmd="AddPictureCmd",e.MoveSlideCmd="MoveSlideCmd",e.AddSectionCmd="AddSectionCmd",e.ModifyTextPropsCmd="ModifyTextPropsCmd",e.ModifyParaPropsCmd="ModifyParaPropsCmd",e.ReplaceTextCmd="ReplaceTextCmd",e.TransformElementCmd="TransformElementCmd",e.ModifyOrderCmd="ModifyOrderCmd",e.DeleteSlidesCmd="DeleteSlidesCmd",e.SetSlidesFooterCmd="SetSlidesFooterCmd",e.ModifyShapePropsCmd="ModifyShapePropsCmd",e.AddShapeCmd="AddShapeCmd",e.ModifyTransitionPropsCmd="ModifyTransitionPropsCmd",e.ResetTransitionPropsCmd="ResetTransitionPropsCmd",e.HideSlidesCmd="HideSlidesCmd",e.DistributeShapesCmd="DistributeShapesCmd",e.ModifyAlignmentCmd="ModifyAlignmentCmd",e.NewAnimationEffectCmd="NewAnimationEffectCmd",e.DeleteAllDrawingElementAnimationEffectsCmd="DeleteAllDrawingElementAnimationEffectsCmd",e.AddTableCmd="AddTableCmd"}(mv||(mv={})),function(e){e[e.None=0]="None",e[e.DocumentChanges=1]="DocumentChanges",e[e.AllSlides=2]="AllSlides"}(fv||(fv={})),function(e){e.OrganizeSlide="organize",e.BeautifySlide="beautify",e.DesignerSlide="designer",e.ThemeIdeas="ThemeIdeas",e.TransformSlide="transform"}(hv||(hv={})),function(e){e.RunDesigner="RunDesigner",e.AddSlideAnimation="AddSlideAnimation",e.CanReplaceImageWithLoopingVideo="CanReplaceImageWithLoopingVideo",e.TryNewTheme="TryNewTheme"}(vv||(vv={})),function(e){e.KeySlideShow="KeySlideShow"}(yv||(yv={})),function(e){e.CreatePresentation="CreatePresentation",e.CreatePresentationFromDoc="CreatePresentationFromDoc",e.AddSlide="AddSlide",e.InsertImage="InsertImage",e.Organize="Organize",e.Beautify="Beautify",e.Animate="Animate",e.BasicChat="BasicChat",e.CopilotChat="CopilotChat",e.Summary="Summary",e.FormatText="FormatText",e.FormatShape="FormatShape",e.ReplaceText="ReplaceText",e.SetFooters="SetFooters",e.SlideTransition="SlideTransition",e.HideSlide="HideSlide",e.PresentationTransform="PresentationTransform",e.PresentationRecommendation="PresentationRecommendation",e.AddSection="AddSection",e.CreateTable="CreateTable",e.DeleteSlide="DeleteSlide",e.InsertShape="InsertShape",e.MoveSlide="MoveSlide",e.SlideFooter="SlideFooter",e.FormatList="FormatList",e.InsertList="InsertList",e.InsertImageDesignerMini="InsertImageDesignerMini",e.Unset=""}(Cv||(Cv={})),function(e){e.IntentDetectionFailure="intent-detection-failure",e.Cancelled="cancelled",e.CancelledFromWarningCard="cancelledFromWarningCard"}(Sv||(Sv={})),function(e){e[e.None=0]="None",e[e.UnexpectedVersion=1]="UnexpectedVersion",e[e.DesignerFailed_Deprecated=2]="DesignerFailed_Deprecated",e[e.ContentInsertionFailed=3]="ContentInsertionFailed",e[e.ApplyCLPLabelFailed=4]="ApplyCLPLabelFailed",e[e.DesignerFailedAlreadyHasAnimation=5]="DesignerFailedAlreadyHasAnimation",e[e.DocumentChangedBeforeCommandExecution=6]="DocumentChangedBeforeCommandExecution",e[e.CommandHadNoEffect=7]="CommandHadNoEffect",e[e.Unknown=8]="Unknown",e[e.ParseDesignerOptionsFailed=9]="ParseDesignerOptionsFailed",e[e.FetchDesignSuggestionFailed=10]="FetchDesignSuggestionFailed",e[e.ApplyDesignSuggestionFailed=11]="ApplyDesignSuggestionFailed",e[e.PrepDesignInputFailed=12]="PrepDesignInputFailed",e[e.DocClosingWithIncompleteProtocol=13]="DocClosingWithIncompleteProtocol",e[e.FetchDesignSuggestionPartialSuccess=14]="FetchDesignSuggestionPartialSuccess",e[e.PrepareStageTimedOut=100]="PrepareStageTimedOut",e[e.EmptyJOfcCmdResultId=101]="EmptyJOfcCmdResultId"}(bv||(bv={})),function(e){e[e.None=0]="None",e[e.CompletedStatusCode=1]="CompletedStatusCode",e[e.DisabledStatusCode=2]="DisabledStatusCode",e[e.ErrorStatusCode=3]="ErrorStatusCode",e[e.CompletedWithErrorsStatusCode=4]="CompletedWithErrorsStatusCode",e[e.UserAbortedStatusCode=5]="UserAbortedStatusCode"}(Ev||(Ev={})),function(e){e[e.Title=0]="Title",e[e.CenterTitle=2]="CenterTitle",e[e.Subtitle=3]="Subtitle",e[e.Object=8]="Object"}(Tv||(Tv={})),function(e){e.CreatePresentation="Create Presentation",e.AddContent="Add Content",e.Organize="Organize",e.BasicCommand="Basic Command",e.CopilotChat="Copilot Chat",e.Summarize="Summarize",e.DocumentQnA="Document QnA",e.ChatQnA="Chat QnA",e.Commanding="Commanding",e.Customize="Customize",e.DesignerVisuals="Designer Visuals",e.Unset=""}(Iv||(Iv={})),function(e){e.CreateAPresentation="Create a presentation",e.CreateAPresentationFromFile="Create a presentation from file",e.AddASlide="Add a slide",e.AddAnImage="Add an image",e.OrganizePresentation="Organize this presentation",e.ChangeTextFormat="Change text format to",e.AnimateSlides="Animate my slides",e.DesignPresentation="Design my presentation",e.SummarizePresentation="Summarize the presentation",e.ProactiveRecommendation="Proactive Recommendation",e.ShowKeySlides="Show the key slides",e.ShowActionItems="Show action items",e.AddDesignerImage="Add an image from Designer",e.Unset="Unset"}(_v||(_v={})),function(e){e[e.AlignLeft=0]="AlignLeft",e[e.AlignCenter=1]="AlignCenter",e[e.AlignRight=2]="AlignRight",e[e.AlignJustify=3]="AlignJustify",e[e.AlignJustifyLow=4]="AlignJustifyLow",e[e.AlignDistributed=5]="AlignDistributed",e[e.AlignThaiDistributed=6]="AlignThaiDistributed",e[e.TextAlignType_MaxEnumIDs=7]="TextAlignType_MaxEnumIDs"}(wv||(wv={})),function(e){e[e.BringToFront=0]="BringToFront",e[e.BringForward=1]="BringForward",e[e.SendToBack=2]="SendToBack",e[e.SendBackward=3]="SendBackward"}(Pv||(Pv={})),function(e){e[e.noUnderline=0]="noUnderline",e[e.words=1]="words",e[e.singleLine=2]="singleLine",e[e.doubleLine=3]="doubleLine",e[e.heavyLine=4]="heavyLine",e[e.dottedLine=5]="dottedLine",e[e.dottedHeavyLine=6]="dottedHeavyLine",e[e.dashLine=7]="dashLine",e[e.dashHeavyLine=8]="dashHeavyLine",e[e.dashLongLine=9]="dashLongLine",e[e.dashLongHeavyLine=10]="dashLongHeavyLine",e[e.dotDashLine=11]="dotDashLine",e[e.dotDashHeavyLine=12]="dotDashHeavyLine",e[e.dotDotDashLine=13]="dotDotDashLine",e[e.dotDotDashHeavyLine=14]="dotDotDashHeavyLine",e[e.wavyLine=15]="wavyLine",e[e.wavyHeavyLine=16]="wavyHeavyLine",e[e.wavyDoubleLine=17]="wavyDoubleLine",e[e.TextUnderlineType_MaxEnumIDs=18]="TextUnderlineType_MaxEnumIDs"}(xv||(xv={})),function(e){e[e.FX_FIRST=0]="FX_FIRST",e[e.FX_CUT=0]="FX_CUT",e[e.FX_NONE=0]="FX_NONE",e[e.FX_RANDOM=1]="FX_RANDOM",e[e.FX_BLINDS=2]="FX_BLINDS",e[e.FX_CHECKER=3]="FX_CHECKER",e[e.FX_COVER=4]="FX_COVER",e[e.FX_DISSOLVE=5]="FX_DISSOLVE",e[e.FX_FADE=6]="FX_FADE",e[e.FX_PULL=7]="FX_PULL",e[e.FX_RANDOMBAR=8]="FX_RANDOMBAR",e[e.FX_RANDOMBARS=8]="FX_RANDOMBARS",e[e.FX_STRIPS=9]="FX_STRIPS",e[e.FX_WIPE=10]="FX_WIPE",e[e.FX_ZOOM=11]="FX_ZOOM",e[e.FX_FLY=12]="FX_FLY",e[e.FX_SPLIT=13]="FX_SPLIT",e[e.FX_FLASH=14]="FX_FLASH",e[e.FX_PP9=14]="FX_PP9",e[e.DEP_FX_WHEEL=15]="DEP_FX_WHEEL",e[e.DEP_FX_CIRCLE=16]="DEP_FX_CIRCLE",e[e.FX_DIAMOND=17]="FX_DIAMOND",e[e.FX_PLUS=18]="FX_PLUS",e[e.FX_WEDGE=19]="FX_WEDGE",e[e.FX_PUSH=20]="FX_PUSH",e[e.FX_COMB=21]="FX_COMB",e[e.FX_NEWSFLASH=22]="FX_NEWSFLASH",e[e.FX_ALPHAFADE=23]="FX_ALPHAFADE",e[e.FX_BLUR=24]="FX_BLUR",e[e.FX_PUSHELEM=25]="FX_PUSHELEM",e[e.FX_WHEEL=26]="FX_WHEEL",e[e.FX_CIRCLE=27]="FX_CIRCLE",e[e.FX_PPT12_COMPATIBILITY=27]="FX_PPT12_COMPATIBILITY",e[e.FX_VORTEX=28]="FX_VORTEX",e[e.FX_RIPPLE=29]="FX_RIPPLE",e[e.FX_GLITTER=30]="FX_GLITTER",e[e.FX_FLYTHROUGH=31]="FX_FLYTHROUGH",e[e.FX_FLYTHROUGH_CONTENT=32]="FX_FLYTHROUGH_CONTENT",e[e.FX_DOORS=33]="FX_DOORS",e[e.FX_DOORS_CONTENT=34]="FX_DOORS_CONTENT",e[e.FX_PANBOUNCE_CONTENT=36]="FX_PANBOUNCE_CONTENT",e[e.FX_PAN3D_CONTENT=37]="FX_PAN3D_CONTENT",e[e.FX_CONVEYOR=37]="FX_CONVEYOR",e[e.FX_GALLERY=38]="FX_GALLERY",e[e.FX_PAN3D=38]="FX_PAN3D",e[e.FX_CROSSZOOM=39]="FX_CROSSZOOM",e[e.FX_REVEAL=39]="FX_REVEAL",e[e.FX_HONEYCOMB=40]="FX_HONEYCOMB",e[e.FX_FERRIS_CONTENT=41]="FX_FERRIS_CONTENT",e[e.FX_FERRISWHEEL=41]="FX_FERRISWHEEL",e[e.FX_SWITCH=42]="FX_SWITCH",e[e.FX_FLIP=43]="FX_FLIP",e[e.FX_PRISM=44]="FX_PRISM",e[e.FX_FLASHBULB=45]="FX_FLASHBULB",e[e.FX_SHRED=46]="FX_SHRED",e[e.FX_WHEELREVERSE=47]="FX_WHEELREVERSE",e[e.FX_PPT15_PRESET_FIRST=48]="FX_PPT15_PRESET_FIRST",e[e.FX_FALLOVER=48]="FX_FALLOVER",e[e.FX_DRAPE=49]="FX_DRAPE",e[e.FX_CURTAINS=50]="FX_CURTAINS",e[e.FX_WIND=51]="FX_WIND",e[e.FX_PRESTIGE=52]="FX_PRESTIGE",e[e.FX_FRACTURE=53]="FX_FRACTURE",e[e.FX_CRUSH=54]="FX_CRUSH",e[e.FX_PEELOFF=55]="FX_PEELOFF",e[e.FX_PAGECURLSINGLE=56]="FX_PAGECURLSINGLE",e[e.FX_PAGECURLDOUBLE=57]="FX_PAGECURLDOUBLE",e[e.FX_AIRPLANE=58]="FX_AIRPLANE",e[e.FX_ORIGAMI=59]="FX_ORIGAMI",e[e.FX_PPT15_PRESET_LAST=59]="FX_PPT15_PRESET_LAST",e[e.FX_MORPH=60]="FX_MORPH",e[e.FX_CUSTOM=61]="FX_CUSTOM",e[e.FX_LAST=61]="FX_LAST"}(kv||(kv={})),function(e){e[e.oartsptLine=0]="oartsptLine",e[e.oartsptLineInverse=1]="oartsptLineInverse",e[e.oartsptTriangle=2]="oartsptTriangle",e[e.oartsptRightTriangle=3]="oartsptRightTriangle",e[e.oartsptRectangle=4]="oartsptRectangle",e[e.oartsptDiamond=5]="oartsptDiamond",e[e.oartsptParallelogram=6]="oartsptParallelogram",e[e.oartsptTrapezoid=7]="oartsptTrapezoid",e[e.oartsptNonIsoscelesTrapezoid=8]="oartsptNonIsoscelesTrapezoid",e[e.oartsptPentagon=9]="oartsptPentagon",e[e.oartsptHexagon=10]="oartsptHexagon",e[e.oartsptHeptagon=11]="oartsptHeptagon",e[e.oartsptOctagon=12]="oartsptOctagon",e[e.oartsptDecagon=13]="oartsptDecagon",e[e.oartsptDodecagon=14]="oartsptDodecagon",e[e.oartsptStar4=15]="oartsptStar4",e[e.oartsptStar5=16]="oartsptStar5",e[e.oartsptStar6=17]="oartsptStar6",e[e.oartsptStar7=18]="oartsptStar7",e[e.oartsptStar8=19]="oartsptStar8",e[e.oartsptStar10=20]="oartsptStar10",e[e.oartsptStar12=21]="oartsptStar12",e[e.oartsptStar16=22]="oartsptStar16",e[e.oartsptStar24=23]="oartsptStar24",e[e.oartsptStar32=24]="oartsptStar32",e[e.oartsptRoundRectangle=25]="oartsptRoundRectangle",e[e.oartsptRound1Rectangle=26]="oartsptRound1Rectangle",e[e.oartsptRound2SameRectangle=27]="oartsptRound2SameRectangle",e[e.oartsptRound2DiagonalRectangle=28]="oartsptRound2DiagonalRectangle",e[e.oartsptSnipRoundRectangle=29]="oartsptSnipRoundRectangle",e[e.oartsptSnip1Rectangle=30]="oartsptSnip1Rectangle",e[e.oartsptSnip2SameRectangle=31]="oartsptSnip2SameRectangle",e[e.oartsptSnip2DiagonalRectangle=32]="oartsptSnip2DiagonalRectangle",e[e.oartsptPlaque=33]="oartsptPlaque",e[e.oartsptEllipse=34]="oartsptEllipse",e[e.oartsptTeardrop=35]="oartsptTeardrop",e[e.oartsptHomePlate=36]="oartsptHomePlate",e[e.oartsptChevron=37]="oartsptChevron",e[e.oartsptPieWedge=38]="oartsptPieWedge",e[e.oartsptPie=39]="oartsptPie",e[e.oartsptBlockArc=40]="oartsptBlockArc",e[e.oartsptDonut=41]="oartsptDonut",e[e.oartsptNoSmoking=42]="oartsptNoSmoking",e[e.oartsptRightArrow=43]="oartsptRightArrow",e[e.oartsptLeftArrow=44]="oartsptLeftArrow",e[e.oartsptUpArrow=45]="oartsptUpArrow",e[e.oartsptDownArrow=46]="oartsptDownArrow",e[e.oartsptStripedRightArrow=47]="oartsptStripedRightArrow",e[e.oartsptNotchedRightArrow=48]="oartsptNotchedRightArrow",e[e.oartsptBentUpArrow=49]="oartsptBentUpArrow",e[e.oartsptLeftRightArrow=50]="oartsptLeftRightArrow",e[e.oartsptUpDownArrow=51]="oartsptUpDownArrow",e[e.oartsptLeftUpArrow=52]="oartsptLeftUpArrow",e[e.oartsptLeftRightUpArrow=53]="oartsptLeftRightUpArrow",e[e.oartsptQuadArrow=54]="oartsptQuadArrow",e[e.oartsptLeftArrowCallout=55]="oartsptLeftArrowCallout",e[e.oartsptRightArrowCallout=56]="oartsptRightArrowCallout",e[e.oartsptUpArrowCallout=57]="oartsptUpArrowCallout",e[e.oartsptDownArrowCallout=58]="oartsptDownArrowCallout",e[e.oartsptLeftRightArrowCallout=59]="oartsptLeftRightArrowCallout",e[e.oartsptUpDownArrowCallout=60]="oartsptUpDownArrowCallout",e[e.oartsptQuadArrowCallout=61]="oartsptQuadArrowCallout",e[e.oartsptBentArrow=62]="oartsptBentArrow",e[e.oartsptUturnArrow=63]="oartsptUturnArrow",e[e.oartsptCircularArrow=64]="oartsptCircularArrow",e[e.oartsptLeftCircularArrow=65]="oartsptLeftCircularArrow",e[e.oartsptLeftRightCircularArrow=66]="oartsptLeftRightCircularArrow",e[e.oartsptCurvedRightArrow=67]="oartsptCurvedRightArrow",e[e.oartsptCurvedLeftArrow=68]="oartsptCurvedLeftArrow",e[e.oartsptCurvedUpArrow=69]="oartsptCurvedUpArrow",e[e.oartsptCurvedDownArrow=70]="oartsptCurvedDownArrow",e[e.oartsptSwooshArrow=71]="oartsptSwooshArrow",e[e.oartsptCube=72]="oartsptCube",e[e.oartsptCan=73]="oartsptCan",e[e.oartsptLightningBolt=74]="oartsptLightningBolt",e[e.oartsptHeart=75]="oartsptHeart",e[e.oartsptSun=76]="oartsptSun",e[e.oartsptMoon=77]="oartsptMoon",e[e.oartsptSmileyFace=78]="oartsptSmileyFace",e[e.oartsptIrregularSeal1=79]="oartsptIrregularSeal1",e[e.oartsptIrregularSeal2=80]="oartsptIrregularSeal2",e[e.oartsptFoldedCorner=81]="oartsptFoldedCorner",e[e.oartsptBevel=82]="oartsptBevel",e[e.oartsptFrame=83]="oartsptFrame",e[e.oartsptHalfFrame=84]="oartsptHalfFrame",e[e.oartsptCorner=85]="oartsptCorner",e[e.oartsptDiagonalStripe=86]="oartsptDiagonalStripe",e[e.oartsptChord=87]="oartsptChord",e[e.oartsptArc=88]="oartsptArc",e[e.oartsptLeftBracket=89]="oartsptLeftBracket",e[e.oartsptRightBracket=90]="oartsptRightBracket",e[e.oartsptLeftBrace=91]="oartsptLeftBrace",e[e.oartsptRightBrace=92]="oartsptRightBrace",e[e.oartsptBracketPair=93]="oartsptBracketPair",e[e.oartsptBracePair=94]="oartsptBracePair",e[e.oartsptStraightConnector1=95]="oartsptStraightConnector1",e[e.oartsptBentConnector2=96]="oartsptBentConnector2",e[e.oartsptBentConnector3=97]="oartsptBentConnector3",e[e.oartsptBentConnector4=98]="oartsptBentConnector4",e[e.oartsptBentConnector5=99]="oartsptBentConnector5",e[e.oartsptCurvedConnector2=100]="oartsptCurvedConnector2",e[e.oartsptCurvedConnector3=101]="oartsptCurvedConnector3",e[e.oartsptCurvedConnector4=102]="oartsptCurvedConnector4",e[e.oartsptCurvedConnector5=103]="oartsptCurvedConnector5",e[e.oartsptCallout1=104]="oartsptCallout1",e[e.oartsptCallout2=105]="oartsptCallout2",e[e.oartsptCallout3=106]="oartsptCallout3",e[e.oartsptAccentCallout1=107]="oartsptAccentCallout1",e[e.oartsptAccentCallout2=108]="oartsptAccentCallout2",e[e.oartsptAccentCallout3=109]="oartsptAccentCallout3",e[e.oartsptBorderCallout1=110]="oartsptBorderCallout1",e[e.oartsptBorderCallout2=111]="oartsptBorderCallout2",e[e.oartsptBorderCallout3=112]="oartsptBorderCallout3",e[e.oartsptAccentBorderCallout1=113]="oartsptAccentBorderCallout1",e[e.oartsptAccentBorderCallout2=114]="oartsptAccentBorderCallout2",e[e.oartsptAccentBorderCallout3=115]="oartsptAccentBorderCallout3",e[e.oartsptWedgeRectCallout=116]="oartsptWedgeRectCallout",e[e.oartsptWedgeRRectCallout=117]="oartsptWedgeRRectCallout",e[e.oartsptWedgeEllipseCallout=118]="oartsptWedgeEllipseCallout",e[e.oartsptCloudCallout=119]="oartsptCloudCallout",e[e.oartsptCloud=120]="oartsptCloud",e[e.oartsptRibbon=121]="oartsptRibbon",e[e.oartsptRibbon2=122]="oartsptRibbon2",e[e.oartsptEllipseRibbon=123]="oartsptEllipseRibbon",e[e.oartsptEllipseRibbon2=124]="oartsptEllipseRibbon2",e[e.oartsptLeftRightRibbon=125]="oartsptLeftRightRibbon",e[e.oartsptVerticalScroll=126]="oartsptVerticalScroll",e[e.oartsptHorizontalScroll=127]="oartsptHorizontalScroll",e[e.oartsptWave=128]="oartsptWave",e[e.oartsptDoubleWave=129]="oartsptDoubleWave",e[e.oartsptPlus=130]="oartsptPlus",e[e.oartsptFlowChartProcess=131]="oartsptFlowChartProcess",e[e.oartsptFlowChartDecision=132]="oartsptFlowChartDecision",e[e.oartsptFlowChartInputOutput=133]="oartsptFlowChartInputOutput",e[e.oartsptFlowChartPredefinedProcess=134]="oartsptFlowChartPredefinedProcess",e[e.oartsptFlowChartInternalStorage=135]="oartsptFlowChartInternalStorage",e[e.oartsptFlowChartDocument=136]="oartsptFlowChartDocument",e[e.oartsptFlowChartMultidocument=137]="oartsptFlowChartMultidocument",e[e.oartsptFlowChartTerminator=138]="oartsptFlowChartTerminator",e[e.oartsptFlowChartPreparation=139]="oartsptFlowChartPreparation",e[e.oartsptFlowChartManualInput=140]="oartsptFlowChartManualInput",e[e.oartsptFlowChartManualOperation=141]="oartsptFlowChartManualOperation",e[e.oartsptFlowChartConnector=142]="oartsptFlowChartConnector",e[e.oartsptFlowChartPunchedCard=143]="oartsptFlowChartPunchedCard",e[e.oartsptFlowChartPunchedTape=144]="oartsptFlowChartPunchedTape",e[e.oartsptFlowChartSummingJunction=145]="oartsptFlowChartSummingJunction",e[e.oartsptFlowChartOr=146]="oartsptFlowChartOr",e[e.oartsptFlowChartCollate=147]="oartsptFlowChartCollate",e[e.oartsptFlowChartSort=148]="oartsptFlowChartSort",e[e.oartsptFlowChartExtract=149]="oartsptFlowChartExtract",e[e.oartsptFlowChartMerge=150]="oartsptFlowChartMerge",e[e.oartsptFlowChartOfflineStorage=151]="oartsptFlowChartOfflineStorage",e[e.oartsptFlowChartOnlineStorage=152]="oartsptFlowChartOnlineStorage",e[e.oartsptFlowChartMagneticTape=153]="oartsptFlowChartMagneticTape",e[e.oartsptFlowChartMagneticDisk=154]="oartsptFlowChartMagneticDisk",e[e.oartsptFlowChartMagneticDrum=155]="oartsptFlowChartMagneticDrum",e[e.oartsptFlowChartDisplay=156]="oartsptFlowChartDisplay",e[e.oartsptFlowChartDelay=157]="oartsptFlowChartDelay",e[e.oartsptFlowChartAlternateProcess=158]="oartsptFlowChartAlternateProcess",e[e.oartsptFlowChartOffpageConnector=159]="oartsptFlowChartOffpageConnector",e[e.oartsptActionButtonBlank=160]="oartsptActionButtonBlank",e[e.oartsptActionButtonHome=161]="oartsptActionButtonHome",e[e.oartsptActionButtonHelp=162]="oartsptActionButtonHelp",e[e.oartsptActionButtonInformation=163]="oartsptActionButtonInformation",e[e.oartsptActionButtonForwardNext=164]="oartsptActionButtonForwardNext",e[e.oartsptActionButtonBackPrevious=165]="oartsptActionButtonBackPrevious",e[e.oartsptActionButtonEnd=166]="oartsptActionButtonEnd",e[e.oartsptActionButtonBeginning=167]="oartsptActionButtonBeginning",e[e.oartsptActionButtonReturn=168]="oartsptActionButtonReturn",e[e.oartsptActionButtonDocument=169]="oartsptActionButtonDocument",e[e.oartsptActionButtonSound=170]="oartsptActionButtonSound",e[e.oartsptActionButtonMovie=171]="oartsptActionButtonMovie",e[e.oartsptGear6=172]="oartsptGear6",e[e.oartsptGear9=173]="oartsptGear9",e[e.oartsptFunnel=174]="oartsptFunnel",e[e.oartsptMathPlus=175]="oartsptMathPlus",e[e.oartsptMathMinus=176]="oartsptMathMinus",e[e.oartsptMathMultiply=177]="oartsptMathMultiply",e[e.oartsptMathDivide=178]="oartsptMathDivide",e[e.oartsptMathEqual=179]="oartsptMathEqual",e[e.oartsptMathNotEqual=180]="oartsptMathNotEqual",e[e.oartsptCornerTabs=181]="oartsptCornerTabs",e[e.oartsptSquareTabs=182]="oartsptSquareTabs",e[e.oartsptPlaqueTabs=183]="oartsptPlaqueTabs",e[e.oartsptChartX=184]="oartsptChartX",e[e.oartsptChartStar=185]="oartsptChartStar",e[e.oartsptChartPlus=186]="oartsptChartPlus",e[e.ShapeType_MaxEnumIDs=187]="ShapeType_MaxEnumIDs"}(uv||(uv={})),function(e){e[e.oartalignTopLeft=0]="oartalignTopLeft",e[e.oartalignTop=1]="oartalignTop",e[e.oartalignTopRight=2]="oartalignTopRight",e[e.oartalignLeft=3]="oartalignLeft",e[e.oartalignCenter=4]="oartalignCenter",e[e.oartalignRight=5]="oartalignRight",e[e.oartalignBottomLeft=6]="oartalignBottomLeft",e[e.oartalignBottom=7]="oartalignBottom",e[e.oartalignBottomRight=8]="oartalignBottomRight",e[e.RectAlignment_MaxEnumIDs=9]="RectAlignment_MaxEnumIDs"}(Av||(Av={})),function(e){e[e.oartshadow1=0]="oartshadow1",e[e.oartshadow2=1]="oartshadow2",e[e.oartshadow3=2]="oartshadow3",e[e.oartshadow4=3]="oartshadow4",e[e.oartshadow5=4]="oartshadow5",e[e.oartshadow6=5]="oartshadow6",e[e.oartshadow7=6]="oartshadow7",e[e.oartshadow8=7]="oartshadow8",e[e.oartshadow9=8]="oartshadow9",e[e.oartshadow10=9]="oartshadow10",e[e.oartshadow11=10]="oartshadow11",e[e.oartshadow12=11]="oartshadow12",e[e.oartshadow13=12]="oartshadow13",e[e.oartshadow14=13]="oartshadow14",e[e.oartshadow15=14]="oartshadow15",e[e.oartshadow16=15]="oartshadow16",e[e.oartshadow17=16]="oartshadow17",e[e.oartshadow18=17]="oartshadow18",e[e.oartshadow19=18]="oartshadow19",e[e.oartshadow20=19]="oartshadow20",e[e.PresetShadowVal_MaxEnumIDs=20]="PresetShadowVal_MaxEnumIDs"}(Lv||(Lv={}));var Fv,Mv,Bv,Uv,Hv,Gv,zv,qv,Wv=new Map([["Left",0],["Center",1],["Right",2],["Top",3],["Middle",4],["Bottom",5]]),jv=new Map([["Vertical",0],["Horizontal",1]]),Vv=new Map([["LowerLetter",4],["UpperLetter",5],["Arabic",8],["LowerRoman",14],["UpperRoman",15],["Circlular",16],["EastAsian",21],["Hebrew",30],["ThaiAlpha",31],["ThaiNum",34],["HindiAlpha",37],["HindiNum",38]]);function Qv(e){return null==e}!function(e){e[e.noCaps=0]="noCaps",e[e.smallCaps=1]="smallCaps",e[e.allCaps=2]="allCaps"}(Fv||(Fv={})),function(e){e[e.fxtypeUnknown=0]="fxtypeUnknown",e[e.fxtypeEntrance=1]="fxtypeEntrance",e[e.fxtypeExit=2]="fxtypeExit",e[e.fxtypeEmphasis=3]="fxtypeEmphasis",e[e.fxtypeMotionPath=4]="fxtypeMotionPath",e[e.fxtypeActionVerb=5]="fxtypeActionVerb",e[e.fxtypeMediaCommand=6]="fxtypeMediaCommand",e[e.fxtypeHostCommand=7]="fxtypeHostCommand"}(Mv||(Mv={})),function(e){e[e.fxidCustomEntrance=0]="fxidCustomEntrance",e[e.fxidCustomExit=0]="fxidCustomExit",e[e.fxid_ENTRANCEEXIT_FIRST=1]="fxid_ENTRANCEEXIT_FIRST",e[e.fxidAppear=1]="fxidAppear",e[e.fxidFly=2]="fxidFly",e[e.fxidBlinds=3]="fxidBlinds",e[e.fxidBox=4]="fxidBox",e[e.fxidCheckerboard=5]="fxidCheckerboard",e[e.fxidCircle=6]="fxidCircle",e[e.fxidCrawl=7]="fxidCrawl",e[e.fxidDiamond=8]="fxidDiamond",e[e.fxidDissolve=9]="fxidDissolve",e[e.fxidFade=10]="fxidFade",e[e.fxidFlashOnce=11]="fxidFlashOnce",e[e.fxidPeek=12]="fxidPeek",e[e.fxidPlus=13]="fxidPlus",e[e.fxidRandomBars=14]="fxidRandomBars",e[e.fxidSpiral=15]="fxidSpiral",e[e.fxidSplit=16]="fxidSplit",e[e.fxidStretch=17]="fxidStretch",e[e.fxidCollapse=17]="fxidCollapse",e[e.fxidStrips=18]="fxidStrips",e[e.fxidSwivel=19]="fxidSwivel",e[e.fxidWedge=20]="fxidWedge",e[e.fxidWheel=21]="fxidWheel",e[e.fxidWipe=22]="fxidWipe",e[e.fxidZoom=23]="fxidZoom",e[e.fxidRandomEffects=24]="fxidRandomEffects",e[e.fxidBoomerang=25]="fxidBoomerang",e[e.fxidBounce=26]="fxidBounce",e[e.fxidColorReveal=27]="fxidColorReveal",e[e.fxidCredits=28]="fxidCredits",e[e.fxidEaseIn=29]="fxidEaseIn",e[e.fxidFloat=30]="fxidFloat",e[e.fxidGrowAndTurn=31]="fxidGrowAndTurn",e[e.OBSOLETE_fxidImpact=32]="OBSOLETE_fxidImpact",e[e.OBSOLETE_fxidIris=33]="OBSOLETE_fxidIris",e[e.fxidLightSpeed=34]="fxidLightSpeed",e[e.fxidPinwheel=35]="fxidPinwheel",e[e.OBSOLETE_fxidPulse=36]="OBSOLETE_fxidPulse",e[e.fxidRiseUp=37]="fxidRiseUp",e[e.fxidSinkDown=37]="fxidSinkDown",e[e.fxidSwish=38]="fxidSwish",e[e.fxidThinLine=39]="fxidThinLine",e[e.fxidUnfold=40]="fxidUnfold",e[e.fxidWhip=41]="fxidWhip",e[e.fxidAscend=42]="fxidAscend",e[e.fxidCenterRevolve=43]="fxidCenterRevolve",e[e.OBSOLETE_fxidFadedAscend=44]="OBSOLETE_fxidFadedAscend",e[e.fxidFadedSwivel=45]="fxidFadedSwivel",e[e.OBSOLETE_fxidFadedWipe=46]="OBSOLETE_fxidFadedWipe",e[e.fxidDescend=47]="fxidDescend",e[e.fxidSling=48]="fxidSling",e[e.fxidSpinner=49]="fxidSpinner",e[e.fxidCompress=50]="fxidCompress",e[e.fxidStretchy=50]="fxidStretchy",e[e.fxidZip=51]="fxidZip",e[e.fxidArcUp=52]="fxidArcUp",e[e.fxidFadedZoom=53]="fxidFadedZoom",e[e.fxidGlide=54]="fxidGlide",e[e.fxidExpand=55]="fxidExpand",e[e.fxidContract=55]="fxidContract",e[e.fxidFlip=56]="fxidFlip",e[e.OBSOLETE_fxidShimmer=57]="OBSOLETE_fxidShimmer",e[e.fxidFold=58]="fxidFold",e[e.fxidAppearAndPlay=59]="fxidAppearAndPlay",e[e.fxid3DArrive=60]="fxid3DArrive",e[e.fxid3DFlyIn=61]="fxid3DFlyIn",e[e.fxid3DRollIn=62]="fxid3DRollIn",e[e.fxidDraw=63]="fxidDraw"}(Bv||(Bv={})),function(e){e[e.fxidCustomEmphasis=0]="fxidCustomEmphasis",e[e.fxid_EMPHASIS_FIRST=1]="fxid_EMPHASIS_FIRST",e[e.fxidChangeFillColor=1]="fxidChangeFillColor",e[e.fxidChangeFont=2]="fxidChangeFont",e[e.fxidChangeFontColor=3]="fxidChangeFontColor",e[e.fxidChangeFontSize=4]="fxidChangeFontSize",e[e.fxidChangeFontStyle=5]="fxidChangeFontStyle",e[e.fxidGrowShrink=6]="fxidGrowShrink",e[e.fxidChangeLineColor=7]="fxidChangeLineColor",e[e.fxidSpin=8]="fxidSpin",e[e.fxidTransparency=9]="fxidTransparency",e[e.fxidBoldFlash=10]="fxidBoldFlash",e[e.OBSOLETE_fxidFall=11]="OBSOLETE_fxidFall",e[e.OBSOLETE_fxidPinch=12]="OBSOLETE_fxidPinch",e[e.OBSOLETE_fxidAllCaps=13]="OBSOLETE_fxidAllCaps",e[e.fxidBlast=14]="fxidBlast",e[e.fxidBoldReveal=15]="fxidBoldReveal",e[e.fxidBrushOnColor=16]="fxidBrushOnColor",e[e.OBSOLETE_fxidBrushOnHighlight=17]="OBSOLETE_fxidBrushOnHighlight",e[e.fxidBrushOnUnderline=18]="fxidBrushOnUnderline",e[e.fxidColorBlend=19]="fxidColorBlend",e[e.fxidColorWave=20]="fxidColorWave",e[e.fxidComplementaryColor=21]="fxidComplementaryColor",e[e.fxidComplementaryColor2=22]="fxidComplementaryColor2",e[e.fxidContrastingColor=23]="fxidContrastingColor",e[e.fxidDarken=24]="fxidDarken",e[e.fxidDesaturate=25]="fxidDesaturate",e[e.fxidFlashBulb=26]="fxidFlashBulb",e[e.fxidFlicker=27]="fxidFlicker",e[e.fxidGrowWithColor=28]="fxidGrowWithColor",e[e.OBSOLETE_fxidHighlight=29]="OBSOLETE_fxidHighlight",e[e.fxidLighten=30]="fxidLighten",e[e.fxidStyleEmphasis=31]="fxidStyleEmphasis",e[e.fxidTeeter=32]="fxidTeeter",e[e.fxidVerticalGrow=33]="fxidVerticalGrow",e[e.fxidWave=34]="fxidWave",e[e.fxidBlink=35]="fxidBlink",e[e.fxidShimmer=36]="fxidShimmer",e[e.fxid3DTurntable=37]="fxid3DTurntable",e[e.fxid3DSwing=38]="fxid3DSwing",e[e.fxid3DJumpAndTurn=39]="fxid3DJumpAndTurn",e[e.fxid3DFly=40]="fxid3DFly",e[e.fxid3DHover=41]="fxid3DHover",e[e.fxid_EMPHASIS_COUNT_GENERIC=42]="fxid_EMPHASIS_COUNT_GENERIC",e[e.fxid_EMPHASIS_FIRST_EMBEDDED=100]="fxid_EMPHASIS_FIRST_EMBEDDED",e[e.fxidEmbedded1=100]="fxidEmbedded1",e[e.fxidEmbedded2=101]="fxidEmbedded2",e[e.fxidEmbedded3=102]="fxidEmbedded3",e[e.fxidEmbedded4=103]="fxidEmbedded4",e[e.fxidEmbedded5=104]="fxidEmbedded5",e[e.fxidEmbedded6=105]="fxidEmbedded6",e[e.fxidEmbedded7=106]="fxidEmbedded7",e[e.fxidEmbedded8=107]="fxidEmbedded8",e[e.fxidEmbedded9=108]="fxidEmbedded9",e[e.fxidEmbedded10=109]="fxidEmbedded10",e[e.fxidEmbedded11=110]="fxidEmbedded11",e[e.fxidEmbedded12=111]="fxidEmbedded12",e[e.fxidEmbedded13=112]="fxidEmbedded13",e[e.fxidEmbedded14=113]="fxidEmbedded14",e[e.fxidEmbedded15=114]="fxidEmbedded15",e[e.fxidEmbedded16=115]="fxidEmbedded16",e[e.fxidEmbedded17=116]="fxidEmbedded17",e[e.fxidEmbedded18=117]="fxidEmbedded18",e[e.fxid_EMPHASIS_COUNT_EMBEDDED=18]="fxid_EMPHASIS_COUNT_EMBEDDED",e[e.fxid_EMPHASIS_LAST_EMBEDDED=117]="fxid_EMPHASIS_LAST_EMBEDDED",e[e.fxid_EMPHASIS_LAST=117]="fxid_EMPHASIS_LAST"}(Uv||(Uv={})),function(e){e[e.fxidCustomMotionPath=0]="fxidCustomMotionPath",e[e.fxid_MOTIONPATH_FIRST=1]="fxid_MOTIONPATH_FIRST",e[e.fxidPathCircle=1]="fxidPathCircle",e[e.fxidPathRightTriangle=2]="fxidPathRightTriangle",e[e.fxidPathDiamond=3]="fxidPathDiamond",e[e.fxidPathHexagon=4]="fxidPathHexagon",e[e.fxidPath5PointStar=5]="fxidPath5PointStar",e[e.fxidPathCrescentMoon=6]="fxidPathCrescentMoon",e[e.fxidPathSquare=7]="fxidPathSquare",e[e.fxidPathTrapezoid=8]="fxidPathTrapezoid",e[e.fxidPathHeart=9]="fxidPathHeart",e[e.fxidPathOctagon=10]="fxidPathOctagon",e[e.fxidPath6PointStar=11]="fxidPath6PointStar",e[e.fxidPathFootball=12]="fxidPathFootball",e[e.fxidPathEqualTriangle=13]="fxidPathEqualTriangle",e[e.fxidPathParallelogram=14]="fxidPathParallelogram",e[e.fxidPathPentagon=15]="fxidPathPentagon",e[e.fxidPath4PointStar=16]="fxidPath4PointStar",e[e.fxidPath8PointStar=17]="fxidPath8PointStar",e[e.fxidPathTeardrop=18]="fxidPathTeardrop",e[e.fxidPathPointyStar=19]="fxidPathPointyStar",e[e.fxidPathCurvedSquare=20]="fxidPathCurvedSquare",e[e.fxidPathCurvedX=21]="fxidPathCurvedX",e[e.fxidPathVerticalFigure8=22]="fxidPathVerticalFigure8",e[e.fxidPathCurvyStar=23]="fxidPathCurvyStar",e[e.fxidPathLoopdeLoop=24]="fxidPathLoopdeLoop",e[e.fxidPathBuzzsaw=25]="fxidPathBuzzsaw",e[e.fxidPathHorizontalFigure8=26]="fxidPathHorizontalFigure8",e[e.fxidPathPeanut=27]="fxidPathPeanut",e[e.fxidPathFigure8Four=28]="fxidPathFigure8Four",e[e.fxidPathNeutron=29]="fxidPathNeutron",e[e.fxidPathSwoosh=30]="fxidPathSwoosh",e[e.fxidPathBean=31]="fxidPathBean",e[e.fxidPathPlus=32]="fxidPathPlus",e[e.fxidPathInvertedTriangle=33]="fxidPathInvertedTriangle",e[e.fxidPathInvertedSquare=34]="fxidPathInvertedSquare",e[e.fxidPathLeft=35]="fxidPathLeft",e[e.fxidPathTurnRight=36]="fxidPathTurnRight",e[e.fxidPathArcDown=37]="fxidPathArcDown",e[e.fxidPathZigzag=38]="fxidPathZigzag",e[e.fxidPathSCurve2=39]="fxidPathSCurve2",e[e.fxidPathSineWave=40]="fxidPathSineWave",e[e.fxidPathBounceLeft=41]="fxidPathBounceLeft",e[e.fxidPathDown=42]="fxidPathDown",e[e.fxidPathTurnUp=43]="fxidPathTurnUp",e[e.fxidPathArcUp=44]="fxidPathArcUp",e[e.fxidPathHeartbeat=45]="fxidPathHeartbeat",e[e.fxidPathSpiralRight=46]="fxidPathSpiralRight",e[e.fxidPathWave=47]="fxidPathWave",e[e.fxidPathCurvyLeft=48]="fxidPathCurvyLeft",e[e.fxidPathDiagonalDownRight=49]="fxidPathDiagonalDownRight",e[e.fxidPathTurnDown=50]="fxidPathTurnDown",e[e.fxidPathArcLeft=51]="fxidPathArcLeft",e[e.fxidPathFunnel=52]="fxidPathFunnel",e[e.fxidPathSpring=53]="fxidPathSpring",e[e.fxidPathBounceRight=54]="fxidPathBounceRight",e[e.fxidPathSpiralLeft=55]="fxidPathSpiralLeft",e[e.fxidPathDiagonalUpRight=56]="fxidPathDiagonalUpRight",e[e.fxidPathTurnUpRight=57]="fxidPathTurnUpRight",e[e.fxidPathArcRight=58]="fxidPathArcRight",e[e.fxidPathSCurve1=59]="fxidPathSCurve1",e[e.fxidPathDecayingWave=60]="fxidPathDecayingWave",e[e.fxidPathCurvyRight=61]="fxidPathCurvyRight",e[e.fxidPathStairsDown=62]="fxidPathStairsDown",e[e.fxidPathRight=63]="fxidPathRight",e[e.fxidPathUp=64]="fxidPathUp",e[e.fxid_MOTIONPATH_COUNT=65]="fxid_MOTIONPATH_COUNT"}(Hv||(Hv={})),function(e){e[e.fxidCustomMediaCommand=0]="fxidCustomMediaCommand",e[e.fxid_MEDIA_FIRST=1]="fxid_MEDIA_FIRST",e[e.fxidMediaPlay=1]="fxidMediaPlay",e[e.fxidMediaPause=2]="fxidMediaPause",e[e.fxidMediaStop=3]="fxidMediaStop",e[e.fxidMediaPlayFromBookmark=4]="fxidMediaPlayFromBookmark",e[e.fxid_MEDIA_COUNT=5]="fxid_MEDIA_COUNT"}(Gv||(Gv={})),function(e){e[e.fxidCustomHostCommand=0]="fxidCustomHostCommand",e[e.fxid_HOSTCOMMAND_FIRST=1]="fxid_HOSTCOMMAND_FIRST",e[e.fxidHostGoNextSlide=1]="fxidHostGoNextSlide",e[e.fxid_HOSTCOMMAND_COUNT=2]="fxid_HOSTCOMMAND_COUNT"}(zv||(zv={})),function(e){e[e.noStrike=0]="noStrike",e[e.singleStrike=1]="singleStrike",e[e.doubleStrike=2]="doubleStrike"}(qv||(qv={}));var Jv,Kv=(Jv=(0,gd._)((function(e,t){var n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return n="",t.length>0?(t[0].load("id"),[4,e.sync()]):[3,2];case 1:r.sent(),n=t[0].id,r.label=2;case 2:return[2,n]}}))})),function(e,t){return Jv.apply(this,arguments)}),Xv=function(){var e=(0,gd._)((function(e,t){var n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return n="",t.length>0?(t[t.length-1].load("id"),[4,e.sync()]):[3,2];case 1:r.sent(),n=t[t.length-1].id,r.label=2;case 2:return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Zv=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c;return(0,F.__generator)(this,(function(u){switch(u.label){case 0:n=[],r=!0,o=!1,i=void 0,u.label=1;case 1:u.trys.push([1,6,7,8]),a=t[Symbol.iterator](),u.label=2;case 2:return(r=(s=a.next()).done)?[3,5]:((l=s.value).load("id"),[4,e.sync()]);case 3:u.sent(),n.push(l.id),u.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return c=u.sent(),o=!0,i=c,[3,8];case 7:try{r||null==a.return||a.return()}finally{if(o)throw i}return[7];case 8:return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Yv=function(){var e=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.presentation.getSelectedSlides()).load({select:"id,items"}),[4,e.sync()];case 1:return n.sent(),[2,t.items]}}))}));return function(t){return e.apply(this,arguments)}}(),$v=function(){var e=(0,gd._)((function(e){var t,n,r,o,i,a=arguments;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return Qv(t=a.length>1&&void 0!==a[1]?a[1]:[])||0===t.length?[3,1]:(r=t,[3,3]);case 1:return[4,Yv(e)];case 2:r=s.sent(),s.label=3;case 3:return 0!==(n=r).length&&(o=n[0])&&(i=o.id?o.id.split("#"):void 0)?[2,{type:lv.Slide,id:Number(i[0]),cId:2===i.length?Number(i[1]):void 0}]:[2,void 0]}}))}));return function(t){return e.apply(this,arguments)}}(),ey=function(){var e=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:return(t=e.presentation).load("slides,id,slides/items"),[4,e.sync()];case 1:return d.sent(),n=t.slides.items,[4,Yv(e)];case 2:r=d.sent(),o=[],i=!0,a=!1,s=void 0;try{for(l=function(){var e=u.value,t=n.findIndex((function(t){return t.id===e.id}));o.push(t)},c=r[Symbol.iterator]();!(i=(u=c.next()).done);i=!0)l()}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return[2,o]}}))}));return function(t){return e.apply(this,arguments)}}();function ty(e,t){return ny.apply(this,arguments)}function ny(){return(ny=(0,gd._)((function(e,t){var n,r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(n=t.getParentSlide()).load("id"),[4,e.sync()];case 1:return i.sent(),r=n.id.split("#"),[2,{id:+r[0],cId:+r[1]}];case 2:throw o=i.sent(),ZR("Error in getSlideIdObjectFromShape",o),new Error("".concat(o.message));case 3:return[2]}}))}))).apply(this,arguments)}function ry(e,t){return oy.apply(this,arguments)}function oy(){return oy=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c,u;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:n=[],r=!0,o=!1,i=void 0,d.label=1;case 1:d.trys.push([1,6,7,8]),a=t[Symbol.iterator](),d.label=2;case 2:return(r=(s=a.next()).done)?[3,5]:((l=s.value).load("id"),[4,e.sync()]);case 3:d.sent(),c={id:+l.id},n.push(c),d.label=4;case 4:return r=!0,[3,2];case 5:return[3,8];case 6:return u=d.sent(),o=!0,i=u,[3,8];case 7:try{r||null==a.return||a.return()}finally{if(o)throw i}return[7];case 8:return[2,n]}}))})),oy.apply(this,arguments)}function iy(e,t){return ay.apply(this,arguments)}function ay(){return(ay=(0,gd._)((function(e,t){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return t.load("id"),[4,e.sync()];case 1:return n.sent(),[2,{id:+t.id}]}}))}))).apply(this,arguments)}var sy=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:return n=[],Qv(t)?((r=e.presentation.slides).load("items"),[4,e.sync()]):[3,3];case 1:return g.sent(),r.items.forEach((function(e){return e.load("id")})),[4,e.sync()];case 2:return g.sent(),t=r.items,[3,5];case 3:return t.forEach((function(e){return e.load("id")})),[4,e.sync()];case 4:g.sent(),g.label=5;case 5:o=!0,i=!1,a=void 0;try{for(s=t[Symbol.iterator]();!(o=(l=s.next()).done);o=!0)c=l.value,Jh(Dh.EnableCheckBeforeSplit)&&Qv(c.id)||(u=c.id.split("#"),d=+u[0],p=+u[1],n.push({id:d,cId:p}))}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}();function ly(e,t){return cy.apply(this,arguments)}function cy(){return cy=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c,u,d,p,g,m;return(0,F.__generator)(this,(function(f){switch(f.label){case 0:n=[],r=!0,o=!1,i=void 0,f.label=1;case 1:f.trys.push([1,8,9,10]),a=e[Symbol.iterator](),f.label=2;case 2:if(r=(s=a.next()).done)return[3,7];l=s.value,f.label=3;case 3:return f.trys.push([3,5,,6]),(c=l.getParentTextFrame().getParentShape()).load("id"),(u=c.getParentSlide()).load("id"),[4,t.sync()];case 4:return f.sent(),d=u.id.split("#"),p={shapeId:{id:+c.id},slideId:{id:+d[0],cId:+d[1]}},n.push(p),[3,6];case 5:return g=f.sent(),ZR("Error in parseTextRangeAndGetIds",g),[3,6];case 6:return r=!0,[3,2];case 7:return[3,10];case 8:return m=f.sent(),o=!0,i=m,[3,10];case 9:try{r||null==a.return||a.return()}finally{if(o)throw i}return[7];case 10:return[2,n]}}))})),cy.apply(this,arguments)}function uy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(e))return ZR("Invalid hex color format for formatText"),null;e=e.replace(/^#/,"");var n=parseInt(e,16);return{r:n>>16&255,g:n>>8&255,b:255&n,a:t=Math.min(1,Math.max(0,t))}}function dy(){return(0,dg.A)()}function py(e){return Jh(Dh.ShouldCheckJOFCCommandAPIVersion),function(e,t){if(Jh(Dh.EnableCheckBeforeSplit)&&(Qv(e)||Qv(t)||0===e.length||0===t.length))return ZR("Error in JSON version check"),!1;for(var n=e.split(".").map((function(e){return parseInt(e)})),r=t.split(".").map((function(e){return parseInt(e)})),o=0;o<n.length;o++){if(n[o]>r[o])return!0;if(n[o]<r[o])return!1}return!0}(zR.getSettingAsString(DR.PPTJsonCmdAPIVersion),e)}function gy(e,t){return Jh(Dh.ShouldUseCreationIdsForShapeCommands)?{shapes:e,shapeIds:t}:e}function my(e,t,n){return fy.apply(this,arguments)}function fy(){return(fy=(0,gd._)((function(e,t,n){var r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),nv(t,PowerPoint.SlideCollection)||nv(t,PowerPoint.SlideScopedCollection)?(t=t.items,[3,3]):[3,1];case 1:return t.forEach((function(e){return e.load({expand:"shapes"})})),[4,e.sync()];case 2:a.sent(),a.label=3;case 3:for(r=0;r<t.length;r++)(o=n).push.apply(o,Ed(t[r].shapes.items));return[3,5];case 4:return i=a.sent(),ZR("Exception in _selectShapesFromSlides:"+i.message),[3,5];case 5:return[2]}}))}))).apply(this,arguments)}function hy(e){return vy.apply(this,arguments)}function vy(){return(vy=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E;return(0,F.__generator)(this,(function(T){switch(T.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,o=e.slides,i=e.index,a=void 0===i?-1:i,s=e.shapeType,l=void 0===s?null:s,c=e.name,u=void 0===c?null:c,d=e.shapeIds,p=void 0===d?null:d,g=[],null==(m=r)&&(m="Selection"),"Selection"!=m?[3,5]:((f=t.presentation.getSelectedShapes()).load("items"),(h=t.presentation.getSelectedSlides()).load({select:"items",expand:"shapes"}),[4,t.sync()]);case 1:return T.sent(),0!=f.items.length?[3,3]:[4,my(t,h,g)];case 2:return T.sent(),[3,4];case 3:(v=g).push.apply(v,Ed(f.items)),T.label=4;case 4:0==g.length&&null==r&&(m="Presentation"),T.label=5;case 5:return"Presentation"!=m?[3,8]:((y=t.presentation).load({expand:"slides, slides/shapes"}),[4,t.sync()]);case 6:return T.sent(),[4,my(t,y.slides.items,g)];case 7:return T.sent(),[3,14];case 8:return Array.isArray(m)&&m.length>0&&nv(m[0],PowerPoint.Slide)?[4,my(t,m,g)]:[3,10];case 9:return T.sent(),[3,14];case 10:return"slides"!==m?[3,14]:cF(o)?(C=t.presentation,(S=C.getSelectedSlides()).load("id,items"),[4,t.sync()]):[3,12];case 11:T.sent(),o=S.items,T.label=12;case 12:return[4,my(t,o,g)];case 13:T.sent(),T.label=14;case 14:if(null==l&&null==u||(null!=l&&(l=sv(l)),b=l?l.toLowerCase():"",E=u?u.toLowerCase():"",g=g.filter((function(e){return l&&(e.type.toLowerCase()===b||e.name.toLowerCase().includes(b)||e.name.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join(" ").includes(b))||u&&e.name.toLowerCase().startsWith(E)}))),-1===a)return[2,gy(g,p)];try{if(g.length>a)return[2,gy([g[a]],p)];throw Error("Index value:"+a+" Out of bounds for Occurences length:"+g.length)}catch(e){return ZR("Exception in selectShapes:"+e.message),[2,gy(new Array,p)]}return[2]}}))}))).apply(this,arguments)}function yy(e){return Cy.apply(this,arguments)}function Cy(){return Cy=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:return t=e.context,n=e.indices,(r=t.presentation).load({expand:"slides, slides/shapes"}),[4,t.sync()];case 1:g.sent(),o=n.split(","),i=[],a=!0,s=!1,l=void 0,g.label=2;case 2:g.trys.push([2,7,8,9]),c=function(){var e,n,o,a,s,l;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:return e=d.value,(n=e.match(/(\d+#\d+):(\d+)/))?(o=r.slides.items.find((function(e){return e.id===n[1]})))?[4,my(t,[o],a=[])]:[3,2]:[3,2];case 1:c.sent(),(s=a.filter((function(e){return e.id===n[2]}))).length>0&&(l=i).push.apply(l,Ed(s)),c.label=2;case 2:return[2]}}))},u=o[Symbol.iterator](),g.label=3;case 3:return(a=(d=u.next()).done)?[3,6]:[5,(0,F.__values)(c())];case 4:g.sent(),g.label=5;case 5:return a=!0,[3,3];case 6:return[3,9];case 7:return p=g.sent(),s=!0,l=p,[3,9];case 8:try{a||null==u.return||u.return()}finally{if(s)throw l}return[7];case 9:return[2,i]}}))})),Cy.apply(this,arguments)}function Sy(e){return by.apply(this,arguments)}function by(){return by=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(h){switch(h.label){case 0:return t=e.context,n=e.shapeType,r=e.slides,n=sv(n),o="",i=[],"textbox"==n?o="TextBox":Object.values(PowerPoint.GeometricShapeType).some((function(e){return sv(e)===n}))?o="Geometric":Object.values(PowerPoint.ConnectorType).some((function(e){return sv(e)===n}))&&(o="Connector"),r.forEach((function(e){return e.load("shapes")})),[4,t.sync()];case 1:h.sent(),a=!0,s=!1,l=void 0;try{for(c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)d=u.value,"Geometric"===o?((p=d.shapes.addGeometricShape(n)).name=n,p.load("textFrame"),(g=p.textFrame).autoSizeSetting=PowerPoint.ShapeAutoSize.autoSizeNone,Jh(Dh.ShouldInsertedShapeAutoFitToText)||(g.autoSizeSetting=PowerPoint.ShapeAutoSize.autoSizeShapeToFitText),i.push(p)):"Connector"===o?((m=d.shapes.addLine(n)).name=n,i.push(m)):"TextBox"===o&&((f=d.shapes.addTextBox("")).name=n,i.push(f))}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return[4,t.sync()];case 2:return h.sent(),[2,i]}}))})),by.apply(this,arguments)}function Ey(e){return Ty.apply(this,arguments)}function Ty(){return Ty=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:if(t=e.context,n=e.shapes,r=e.left,o=e.top,i=e.height,a=e.width,s=e.lineColor,l=e.lineDashStyle,c=e.lineWeight,u=e.lineTransparency,d=e.fillColor,p=e.fillTransparency,0==n.length)throw Error("formatShapes: shapes array is empty");return n.forEach((function(e){return function(e){e.load("type,\n    lineFormat/color,\n    lineFormat/visible,\n    lineFormat/dashStyle,\n    lineFormat/weight,\n    lineFormat/transparency,\n    fill/foregroundColor,\n    fill/transparency")}(e)})),[4,t.sync()];case 1:return g.sent(),n.forEach((function(e){null!=r&&(e.left=r),null!=o&&(e.top=o),null!=i&&(e.height=i),null!=a&&(e.width=a),null!=s&&(e.lineFormat.color=s,"Image"==e.type&&(e.lineFormat.visible=!0)),null!=l&&(e.lineFormat.dashStyle=l),null!=c&&null!=e.lineFormat.weight&&("Image"==e.type&&(e.lineFormat.visible=!0),e.lineFormat.weight=c),null!=u&&(e.lineFormat.transparency=u),null!=d&&(e.fill.foregroundColor=d),null!=p&&(e.fill.transparency=p)})),[4,t.sync()];case 2:return g.sent(),[2]}}))})),Ty.apply(this,arguments)}function Iy(e){return _y.apply(this,arguments)}function _y(){return(_y=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return t=e.context,e.shapes.forEach((function(e){e.delete()})),[4,t.sync()];case 1:return n.sent(),[2]}}))}))).apply(this,arguments)}function wy(e){return Py.apply(this,arguments)}function Py(){return Py=(0,gd._)((function(e){var t,n,r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:return[4,eF(e)];case 1:return t=i.sent(),n=t.height,r=t.width,o=$R(e),[2,new OfficeExtension.Promise((function(e,t){Office.context.document.setSelectedDataAsync(o,{coercionType:Office.CoercionType.Image,imageLeft:530,imageTop:70,imageWidth:r/5,imageHeight:n/5},(function(n){ZR("Office.context.document.setSelectedDataAsync callback result: "+JSON.stringify(n)),n.status===Office.AsyncResultStatus.Failed?t(ZR(n.error.message)):e(n)}))}))]}}))})),Py.apply(this,arguments)}function xy(e){return ky.apply(this,arguments)}function ky(){return ky=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:return t=function(e){o[e].shapes.items.forEach((function(t){s[e].includes(t.id)||i.push(t)}))},n=e.context,r=e.description,o=e.slides,i=[],[4,gv.insertImage(r)];case 1:if(!(a=v.sent()))throw new Error("Could not find image matching description");return s=[],o.forEach((function(e){return e.load("id, shapes ,shapes/id, shapes/items")})),[4,n.sync()];case 2:v.sent(),l=!0,c=!1,u=void 0,v.label=3;case 3:v.trys.push([3,9,10,11]),d=o[Symbol.iterator](),v.label=4;case 4:return(l=(p=d.next()).done)?[3,8]:(g=p.value,[],m=g.shapes.items.map((function(e){return e.id})),s.push(m),n.presentation.setSelectedSlides([g.id]),[4,n.sync()]);case 5:return v.sent(),[4,wy(a)];case 6:v.sent(),g.load("shapes ,shapes/id, shapes/items"),v.label=7;case 7:return l=!0,[3,4];case 8:return[3,11];case 9:return f=v.sent(),c=!0,u=f,[3,11];case 10:try{l||null==d.return||d.return()}finally{if(c)throw u}return[7];case 11:return n.presentation.getSelectedTextRangeOrNullObject(),[4,n.sync()];case 12:for(v.sent(),h=0;h<o.length;h++)t(h);return n.presentation.setSelectedSlides(o.map((function(e){return e.id}))),[4,n.sync()];case 13:return v.sent(),[2,i]}}))})),ky.apply(this,arguments)}function Ay(e){return Ly.apply(this,arguments)}function Ly(){return Ly=(0,gd._)((function(e){var t,n,r,o,i,a,s,l;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:return t=e.context,n=e.images,r=e.height,o=e.width,i=e.top,a=e.left,s=e.borderColor,l=e.borderWeight,n.forEach((function(e){null!=a&&(e.left=a),null!=i&&(e.top=i),null!=r&&(e.height=r),null!=o&&(e.width=o),null!=s&&(e.lineFormat.visible=!0,e.lineFormat.color=s),null!=l&&(e.lineFormat.visible=!0,e.lineFormat.weight=l)})),[4,t.sync()];case 1:return c.sent(),[2]}}))})),Ly.apply(this,arguments)}function Dy(e){return Oy.apply(this,arguments)}function Oy(){return(Oy=(0,gd._)((function(e){var t,n,r,o,i,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,o=e.index,[4,hy({context:t,scope:r,index:void 0===o?-1:o})];case 1:return i=l.sent(),a=[],a=Jh(Dh.ShouldUseCreationIdsForShapeCommands)?i.shapes:i,s=[],a.forEach((function(e){return e.load("type")})),[4,t.sync()];case 2:return l.sent(),a.forEach((function(e){"Image"==e.type&&s.push(e)})),[2,s]}}))}))).apply(this,arguments)}function Ny(e){return Ry.apply(this,arguments)}function Ry(){return(Ry=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){return t=e.context,e.images.forEach((function(e){e.delete()})),t.sync(),[2]}))}))).apply(this,arguments)}function Fy(e,t){var n;!Qv(e)&&e.length>0&&((n=e).push.apply(n,Ed(t)),t=e);return t}function My(e){return By.apply(this,arguments)}function By(){return(By=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,o=e.index,i=void 0===o?Jh(Dh.ShouldSupportLastSlideSelection)?void 0:-1:o,a=e.id,s=void 0===a?void 0:a,l=e.slides,c=void 0===l?void 0:l,u=t.presentation,d=[],null==(p=r)&&(p="Selection"),"Selection"!=p?[3,2]:(g=u.getSelectedSlides(),Qv(i)||-1===i||(g=u.slides),g.load("id,items"),[4,t.sync()]);case 1:v.sent(),0==(d=g.items).length&&null==r&&(p="Presentation"),v.label=2;case 2:return"Presentation"!=p?[3,4]:(u.load("slides, id,slides/items"),[4,t.sync()]);case 3:v.sent(),d=u.slides.items,v.label=4;case 4:if(m=Jh(Dh.ShouldSupportLastSlideSelection),f=-1===i,m&&(f=Qv(i)),f&&!s)return[2,Fy(c,d)];try{return s&&(h=d.find((function(e){return e.id===s})))?[2,Fy(c,[h])]:-1===i&&Jh(Dh.ShouldSupportLastSlideSelection)?[2,Fy(c,[d[d.length-1]])]:[2,Fy(c,[d[i]])]}catch(e){return[2,new Array]}return[2]}}))}))).apply(this,arguments)}function Uy(e){return Hy.apply(this,arguments)}function Hy(){return Hy=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:t=e.context,n=e.indices,r=n.split(","),o=[],i=!0,a=!1,s=void 0,g.label=1;case 1:g.trys.push([1,6,7,8]),l=r[Symbol.iterator](),g.label=2;case 2:return(i=(c=l.next()).done)?[3,5]:(u=c.value,[4,My({context:t,scope:"Presentation",id:u})]);case 3:(d=g.sent()).length>0&&d[0]&&o.push(d[0]),g.label=4;case 4:return i=!0,[3,2];case 5:return[3,8];case 6:return p=g.sent(),a=!0,s=p,[3,8];case 7:try{i||null==l.return||l.return()}finally{if(a)throw s}return[7];case 8:return[2,o]}}))})),Hy.apply(this,arguments)}function Gy(e){return zy.apply(this,arguments)}function zy(){return(zy=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O;return(0,F.__generator)(this,(function(N){switch(N.label){case 0:return t=e.context,n=e.precededBy,r=void 0===n?[]:n,o=e.layout,i=void 0===o?"Title and Content":o,a=[],0!=r.length?[3,3]:(t.presentation.getSelectedTextRangeOrNullObject(),t.presentation.slides.add(),[4,t.sync()]);case 1:return N.sent(),t.presentation.load("slides, slides/items,slides/id"),s=t.presentation.slides.getCount(),[4,t.sync()];case 2:return N.sent(),l=t.presentation.slides.items[s.value-1],a.push(l),[2,a];case 3:return(c=t.presentation).load({select:"slides/id,slides/slideMaster/id",expand:"slides,slides/slideMaster/layouts/items"}),r.forEach((function(e){return e.load("id")})),u=t.presentation.slides.getCount(),[4,t.sync()];case 4:for(N.sent(),d=c.slides.items[0],p=d.slideMaster.layouts.items,g=[],r.forEach((function(e){return g.push(e.id)})),m="",f="",h=!1,v=0;v<p.length;v++)if((y=p[v]).name.toLowerCase()==i.toLowerCase()){m=y.id,f=d.slideMaster.id,h=!0;break}if(!h&&i.toLowerCase().includes("content"))for(C=0;C<p.length;C++)if((S=p[C]).name.toLowerCase().includes("introduction")){m=S.id,f=d.slideMaster.id,h=!0;break}if(!h&&i.toLowerCase().includes("content"))for(b=0;b<p.length;b++)if((E=p[b]).name.toLowerCase().includes("content")){m=E.id,f=d.slideMaster.id,h=!0;break}if(!h&&!i.toLowerCase().includes("content"))for(T=0;T<p.length;T++)if((I=p[T]).name.toLowerCase().startsWith("title")){m=I.id,f=d.slideMaster.id,h=!0;break}return h||(i.toLowerCase().includes("content")?(m=d.slideMaster.layouts.items[1].id,f=d.slideMaster.id):(m=d.slideMaster.layouts.items[0].id,f=d.slideMaster.id)),t.presentation.slides.add({slideMasterId:f,layoutId:m}),[4,t.sync()];case 5:return N.sent(),[4,ov()];case 6:return _=N.sent(),t.presentation.load("slides"),w=t.presentation.slides.getItemAt(u.value).load("id"),[4,t.sync()];case 7:for(N.sent(),P=u.value+1,x=0;x<r.length;x++)t.presentation.insertSlidesFromBase64(_,{formatting:PowerPoint.InsertSlideFormatting.keepSourceFormatting,targetSlideId:g[x],sourceSlideIds:[w.id]}),P++;return t.presentation.slides.getItemAt(P-1).delete(),k=[],t.presentation.load("slides, slides/items,slides/id"),[4,t.sync()];case 8:for(N.sent(),A=!1,L=0,D=t.presentation.slides.items,O=0;O<t.presentation.slides.items.length&&(!A||(a.push(D[O]),k.push(D[O].id),A=!1,a.length!=r.length));O++)D[O].id==g[L]&&(L++,A=!0);return t.presentation.setSelectedSlides(k),[4,t.sync()];case 9:return N.sent(),[2,a]}}))}))).apply(this,arguments)}function qy(e){return Wy.apply(this,arguments)}function Wy(){return(Wy=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){return e.context,e.slides,t=e.strategy,n=e.animation,[2,[]]}))}))).apply(this,arguments)}function jy(e){return Vy.apply(this,arguments)}function Vy(){return(Vy=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return e.context,e.slides,e.slideIds,e.precededBy,e.precededById,[2]}))}))).apply(this,arguments)}function Qy(e){return Jy.apply(this,arguments)}function Jy(){return(Jy=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return e.context,e.slides,e.slideIds,e.name,e.id,[2]}))}))).apply(this,arguments)}function Ky(e){return Xy.apply(this,arguments)}function Xy(){return(Xy=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return t=e.context,0===(n=e.slides).length&&ZR("Deleting "+n.length+" slides"),n.forEach((function(e){e.delete()})),[4,t.sync()];case 1:return r.sent(),[2]}}))}))).apply(this,arguments)}var Zy=function(){function e(){Sp(this,e),(0,i._)(this,"isWarningMessageActive",!1),(0,i._)(this,"warningCardDisplayTimeInMs",void 0),(0,i._)(this,"warningCardUserInteractionTimeInSec",void 0),(0,i._)(this,"shouldAccountForWarningCardUserInteractionLatency",!1),(0,i._)(this,"cachedRequestParameters",{prompt:"",sources:[],groundingInfo:""}),this.isWarningMessageActive=!1,this.shouldAccountForWarningCardUserInteractionLatency=!1,this.warningCardDisplayTimeInMs=0,this.warningCardUserInteractionTimeInSec=0}return Ep(e,[{key:"setWarningMessageActive",value:function(e){this.isWarningMessageActive=e}},{key:"getIsWarningMessageActive",value:function(){return this.isWarningMessageActive}},{key:"setCachedRequestParameters",value:function(e,t,n){this.cachedRequestParameters.prompt=null!=e?e:rM,this.cachedRequestParameters.sources=null!=t?t:[],this.cachedRequestParameters.groundingInfo=null!=n?n:rM}},{key:"getCachedRequestParameters",value:function(){return this.cachedRequestParameters}},{key:"resetCachedRequestParameters",value:function(){this.cachedRequestParameters.prompt=rM,this.cachedRequestParameters.sources=[],this.cachedRequestParameters.groundingInfo=rM}},{key:"setWarningCardDisplayTimeInMs",value:function(){this.warningCardDisplayTimeInMs=(new Date).getTime()}},{key:"getWarningCardDisplayTimeInMs",value:function(){return this.warningCardDisplayTimeInMs}},{key:"getWarningCardUserInteractionTimeInSec",value:function(){return this.warningCardUserInteractionTimeInSec}},{key:"setWarningCardUserInteractionTimeInSec",value:function(){this.warningCardUserInteractionTimeInSec=(0,qp.WU)(this.warningCardDisplayTimeInMs)}},{key:"getShouldAccountForWarningCardUserInteractionLatency",value:function(){return this.shouldAccountForWarningCardUserInteractionLatency}},{key:"setShouldAccountForWarningCardUserInteractionLatency",value:function(e){this.shouldAccountForWarningCardUserInteractionLatency=e}},{key:"resetWarningCardLatencyParameters",value:function(){this.shouldAccountForWarningCardUserInteractionLatency=!1,this.warningCardDisplayTimeInMs=0,this.warningCardUserInteractionTimeInSec=0}}],[{key:"getInstance",value:function(){return cF(e.warningMessageStateHandler)&&(e.warningMessageStateHandler=new e),e.warningMessageStateHandler}}]),e}();function Yy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $y(e,t){return $y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$y(e,t)}function eC(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$y(e,t)}function tC(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function nC(e,t,n){return nC=tC()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&$y(o,n.prototype),o},nC.apply(null,arguments)}function rC(e){return rC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rC(e)}function oC(e){var t="function"==typeof Map?new Map:void 0;return oC=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return nC(e,arguments,rC(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),$y(r,e)},oC(e)}function iC(e,t){return!t||"object"!=((n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n)&&"function"!=typeof t?Yy(e):t;var n}function aC(e){var t=tC();return function(){var n,r=rC(e);if(t){var o=rC(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return iC(this,n)}}(0,i._)(Zy,"warningMessageStateHandler",void 0);var sC,lC,cC,uC,dC,pC,gC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),mC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),fC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),hC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),vC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),yC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),CC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),SC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),bC=function(e){eC(n,e);var t=aC(n);function n(e){var r;return Sp(this,n),r=t.call(this,e),Object.setPrototypeOf(Yy(r),n.prototype),r}return n}(oC(Error)),EC=n(99911),TC=n(58728);!function(e){e.AnnotationActivationTime="AnnotationActivationTime",e.AnnotationType="AnnotationType",e.AugloopInitializationTime="AugloopInitializationTime",e.AugloopResponseTime="AugloopResponseTime",e.AugloopSessionGuid="AugloopSessionGuid",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.ChatPPTSessionId="ChatPPTSessionId",e.CheckPoints="CheckPoints",e.ContentOrigin="ContentOrigin",e.ContentProcessingResponseTime="ContentProcessingResponseTime",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.CopilotChatSessionId="CopilotChatSessionId",e.CopilotODSLImageResponseTime="CopilotODSLImageResponseTime",e.CopilotODSLResponseTime="CopilotODSLResponseTime",e.CopilotUserQueryGuid="CopilotUserQueryGuid",e.ContextTreeBuildTime="ContextTreeBuildTime",e.ErrorChatEventParameter="ErrorChatEventParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorParameter="ErrorParameter",e.ErrorType="ErrorType",e.FeatureName="FeatureName",e.FirstServiceResponse="FirstServiceResponse",e.HandoffMessageResponseTime="HandoffMessageResponseTime",e.ImageInsertionTime="ImageInsertionTime",e.ImageResponseTime="ImageResponseTime",e.IsDevBuild="IsDevBuild",e.IsFluxEnabled="IsFluxEnabled",e.IsFluxUsed="IsFluxUsed",e.IsFromCache="IsFromCache",e.IsImageInsertionSuccess="IsImageInsertionSuccess",e.IsQuerySuccess="IsQuerySuccess",e.LocalizationStringsLoadTime="LocalizationStringsLoadTime",e.NotificationResponseTime="NotificationResponseTime",e.OrganizePresentationResponseTime="OrganizePresentationResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.PersonalizationResponseTime="PersonalizationResponseTime",e.PresentationRecommendationWorkflowResponseTime="PresentationRecommendationWorkflowResponseTime",e.PresentationTransformerResponseTime="PresentationTransformerResponseTime",e.PPTUserCopilotPaneLoadTime="PPTUserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime_PreloadTime="UserCopilotPaneLoadTime_PreloadTime",e.QueryExecutionTime="QueryExecutionTime",e.QnAChunkInfo="QnAChunkInfo",e.QnAResponseTime="QnAResponseTime",e.RequestSignalType="RequestSignalType",e.SDXResourcesLoadTime="SDXResourcesLoadTime",e.SegmentToSlideResponseTime="SegmentToSlideResponseTime",e.StopGeneratingTime="StopGeneratingTime",e.StoryTellerWorkflowResponseTime="StoryTellerWorkflowResponseTime",e.SubFeatureName="SubFeatureName",e.SubstrateAPIResponseTime="SubstrateAPIResponseTime",e.SummaryChunkInfo="SummaryChunkInfo",e.SummaryResponseTime="SummaryResponseTime",e.SydneyChunkInfoJson="SydneyChunkInfoJson",e.SydneyResponseTime="SydneyResponseTime",e.UserIdentityTypeResponseTime="UserIdentityTypeResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.UserProfileResponseTime="UserProfileResponseTime",e.UserQueryGuid="UserQueryGuid",e.VisualSummaryResponseTime="VisualSummaryResponseTime",e.WarningMessageUserInteractionTime="WarningMessageUserInteractionTime",e.WordCountResponseTime="WordCountResponseTime",e.UniqueActionId="UniqueActionId",e.FirstNotificationReceivedTime="FirstNotificationReceivedTime",e.LastNotificationReceivedTime="LastNotificationReceivedTime",e.SharedHeaderLoadTimeInMs="SharedHeaderLoadTimeInMs",e.StaticSharedHeaderLoadTimeInMs="StaticSharedHeaderLoadTimeInMs"}(sC||(sC={})),function(e){e.UserQueryGuid="UserQueryGuid",e.ChatPPTSessionId="ChatPPTSessionId",e.EventState="EventState",e.OperationOrder="OperationOrder",e.OperationType="OperationType",e.TimeDurationInMs="TimeDurationInMs",e.OperationParameters="OperationParameters",e.UserQueryOrder="UserQueryOrder",e.OfficeJSApi="OfficeJsAPI",e.ReturnedItems="ReturnedItems",e.SlideHints="SlideHints"}(lC||(lC={})),function(e){e.IsDevBuild="IsDevBuild",e.UserQueryGuid="UserQueryGuid",e.ChatPPTSessionId="ChatPPTSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.UserQueryOrder="UserQueryOrder",e.ALSessionKey="ALSessionKey",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.ChatErrorParameters="ChatErrorParameters",e.IsFromCache="IsFromCache",e.IsVisual="IsVisual",e.RequestSignalSource="RequestSignalSource",e.IsAnalyzingVisual="IsAnalyzingVisual",e.CopilotChatSessionId="CopilotChatSessionId",e.Cv="Cv",e.NotificationType="NotificationType",e.NotificationState="NotificationState",e.ImageType="ImageType",e.UniqueActionId="UniqueActionId"}(cC||(cC={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.UniqueActionId="UniqueActionId"}(uC||(uC={})),function(e){e.DesignerLinkClicked="Designer_Link_Clicked",e.FailureType2Message="Failure_Type_2_Message",e.FailureType3Message="Failure_Type_3_Message",e.FailureType4Message="Failure_Type_4_Message",e.FailureType5Message="Failure_Type_5_Message",e.FailureType6Message="Failure_Type_6_Message",e.FailureType7Message="Failure_Type_7_Message",e.LongMessageLength="Long_Message_Length",e.JunkPhraseDetected="Junk_Phrase_Detected",e.LicensingError="Licensing_Error",e.ContextTreeBuildError="Context_Tree_Build_Error",e.SlideFetchError="Slide_Fetch_Error",e.ContextTreeBuildCompleted="Context_Tree_Build_Completed",e.ContextTreeBuildSkipped="Context_Tree_Build_Skipped",e.ContextTreeBuildTimeout="Context_Tree_Build_Timeout",e.FinalMessageTextNotFound="Final_MessageText_Not_Found",e.PPTCopilotIntentDetected="PPT_Copilot_Intent_Detected",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.OrganizePresentationOperationSubmitted="Organize_Presentation_Operation_Submitted",e.PresentationTransformerOperationSubmitted="Presentation_Transformer_Operation_Submitted",e.AugloopResponseFailure="Augloop_Response_Failure",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.FirstResponseReceivedFromAL="First_Response_Received_From_Augloop",e.FirstChunkReceivedFromSydney="First_Chunk_Received_From_Sydney",e.SummaryIntentDetectedFromAL="Summary_Intent_Detected_From_Augloop",e.QueryExecutionFailed="Query_Execution_Failed",e.QueryExecutionBlocked="Query_Execution_Blocked",e.QueryExecutionPausedOnWarning="Query_Execution_Paused_On_Warning",e.QueryExecutionSuccessful="Query_Execution_Successful",e.QueryExecutionPartiallySuccessful="Query_Execution_Partial_Success_Failure",e.QueryExecutionNotSupported="Query_Execution_Not_Supported_Failure",e.QueryExecutionAbortedForMultiGenerateSlides="Query_Execution_Aborted_For_Multi_Generate_Slides_Failure",e.QueryExecutionAbortedByUser="Query_Execution_Aborted_By_User_Failure",e.QueryExecutionUnexpectedVersionError="Query_Execution_Unexpected_Version_Failure",e.ContentGenerationDisabledByAdmin="Content_Generation_Disabled_By_Admin_Failure",e.StorytellerQuerySent="Storyteller_Query_Sent",e.StorytellerQuerySuccess="Storyteller_Query_Success",e.StorytellerQueryFailure="Storyteller_Query_Failure",e.StorytellerInsertSlideCompleted="Storyteller_Insert_Slide_Completed",e.StorytellerInitialSlideCount="Storyteller_Initial_Slide_Count",e.StorytellerUpdatedSlideCount="Storyteller_Updated_Slide_Count",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.SummarizationOperationSubmitted="Summarization_Operation_Submitted",e.SummaryResponseShown="Summary_Response_Shown",e.CallsToActionResponseShown="Calls_To_Action_Response_Shown",e.ImportantSlidesResponseShown="Important_Slides_Response_Shown",e.LessWordCount="Less_Word_Count",e.MoreWordCount="More_Word_Count",e.SummaryStreamingResponseTimeout="Summary_Streaming_Response_Timeout",e.WordCountOperationSubmitted="Word_Count_Operation_Submitted",e.UserTypeOperationSubmitted="User_Type_Operation_Submitted",e.InternetReconnected="Internet_Reconnected",e.ThumbsUpButtonClicked="Thumbs_Up_Button_Clicked",e.ThumbsDownButtonClicked="Thumbs_Down_Button_Clicked",e.SegmentToSlideOperationSubmitted="Segment_To_Slide_Operation_Submitted",e.ContentProcessingOperationSubmitted="Content_Processing_Operation_Submitted",e.ContentValidatorOperationSubmitted="Content_Validator_Operation_Submitted",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.PPTCopilotOperationSubmitted="PPT_Copilot_Operation_Submitted",e.PPTCopilotFluxOperationSubmitted="PPT_Copilot_Flux_Operation_Submitted",e.PPTCopilotSketchOperationSubmitted="PPT_Copilot_Sketch_Operation_Submitted",e.PPTCopilotSketchOperationCompleted="PPT_Copilot_Sketch_Operation_Completed",e.PPTCopilotSketchInsertImageCompleted="PPT_Copilot_Sketch_Insert_Image_Completed",e.ChatIntentDetected="Chat_Intent_Detected",e.FluxChatIntentDetected="Flux_Chat_Intent_Detected",e.UnsupportedActionDetected="Unsupported_Action_Detected",e.StoryTellerOperationSubmitted="StoryTeller_Operation_Submitted",e.CopilotChatHistoryOperationSubmitted="Copilot_Chat_History_Operation_Submitted",e.CopyButtonClicked="Copy_Button_Clicked",e.DocumentUrlEmptyError="Document_Url_Empty_Error",e.DocumentUrlInvalidError="Document_Url_Invalid_Error",e.CIQLinkUsed="CIQ_Link_Used",e.MessageHasLocalFileLink="Message_Has_Local_File_Link",e.PrimaryUserType="Primary_User_Type",e.ContentValidatorURLValidationFailed="Content_Validator_URL_Validation_Failed",e.CommandingSourceAndPromptInGenerates="Commanding_Source_And_Prompt_In_Generates",e.PlayKeySlidesButtonAdded="Play_Key_Slides_Button_Added",e.PlayKeySlidesButtonClicked="Play_Key_Slides_Button_Clicked",e.ClickableKeySlidesEnabled="Clickable_Key_Slides_Enabled",e.ClickableKeySlidesClicked="Clickable_Key_Slides_Clicked",e.JOFCCommandExecuted="JOFC_Command_Executed",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.AppExecutionStart="App_Execution_Start",e.StringLocalizationStart="String_Localization_Start",e.CIQLoadStart="CIQ_Load_Start",e.CIQLoadEnd="CIQ_Load_End",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatPaneInitialized="Chat_Pane_Initialized",e.ChatHistoryTimedOut="Chat_History_Timeout",e.AugloopReconnected="Augloop_Reconnected",e.AugloopDisconnected="Augloop_Disconnected",e.AugloopServerAuthStateChanged="Augloop_Server_Auth_State_Changed",e.InvalidContextIdResponse="Invalid_Context_Id_Response",e.StopGeneratingButtonClicked="Stop_Generating_Button_Clicked",e.QueryEndOnGptSwitch="Query_End_On_Gpt_Switch",e.ContextIDListEmptied="Context_ID_List_Emptied",e.IsContextIDValid="Is_Context_ID_Valid",e.StopGeneratingSignalSentToAL="Stop_Generating_Signal_Sent_To_AL",e.ODSLResponseReceivedFromSydney="ODSL_Response_Received_From_Sydney",e.SummaryResponseReceivedFromSydney="Summary_Response_Received_From_Sydney",e.SummaryResponseReceivedFromSkill="Summary_Response_Received_From_Skill",e.QnAResponseReceivedFromSydney="QnA_Response_Received_From_Sydney",e.FinalValidMessageReceivedFromSydney="Final_Valid_Message_Received_From_Sydney",e.LastChatMessageUserType="Last_Chat_Message_User_Type",e.EmptyMessageReceivedFromSydney="Empty_Message_Received_From_Sydney",e.EmptyMessageReceivedFromSummarySkill="Empty_Message_Received_From_SummarySkill",e.DesignerGraphicsResponseReceivedFromSydney="Designer_Graphics_Response_Received_From_Sydney",e.ODSLExecutionTimeout="ODSL_Execution_Timeout",e.RaiErrorMessage="Rai_Error_Message",e.ErrorResponseSignalSent="Error_Response_Signal_Sent",e.NoChatResponseRenderedFromSydney="No_Chat_Response_Rendered_From_Sydney",e.ContentOriginUnhandled="Content_Origin_Unhandled_Treated_As_Error",e.ContentOriginUnknown="Content_Origin_Unknown",e.UnexpectedErrorObjectReceived="Unexpected_Error_Obj_Received",e.GroundingSourceUpdated="Grounding_Source_Updated",e.CopilotConfig="Copilot_Config",e.DesignerImageInsertStart="Designer_Image_Insert_Start",e.DesignerImageInsertEnd="Designer_Image_Insert_End",e.DesignerImageInsertError="Designer_Image_Insert_Error",e.DesignerResponseShown="Designer_Shown",e.EmptyDesignerResponse="Empty_Designer_Response",e.DesignerDuplicateResponse="Designer_Duplicate_Response",e.DesignerAuthTokenFetchStart="Designer_Auth_Token_Fetch_Start",e.DesignerAuthTokenFetchRetry="Designer_Auth_Token_Fetch_Retry",e.DesignerAuthTokenFetchEnd="Designer_Auth_Token_Fetch_End",e.DesignerBase64ImagesReceived="Designer_Base64_Images_Received",e.DesignerSkillResponseParseError="Designer_Skill_Response_Parse_Error",e.DesignerMiniEvent="Designer_Mini_Event",e.DesignerDiscountedError="Designer_Discounted_Error",e.DesignerSkillError="Designer_Skill_Error",e.ImagePickerClicked="ImagePicker_Clicked",e.ImagePickerShown="ImagePicker_Shown",e.DocumentStateReceived="Document_State_Received",e.TriggerSummaryCalled="Trigger_Summary_Called",e.TriggerCreatePresentationAboutCalled="Trigger_CreatePresentationAbout_Called",e.TriggerCreatePresentationFromFileCalled="Trigger_CreatePresentationFromFile_Called",e.TriggerAddASlideCalled="Trigger_AddASlide_Called",e.TriggerCreatePresentationAboutCalledViaInAppHandOffMessage="Trigger_CreatePresentationAbout_Called_ViaInAppHandOffMessage",e.TriggerCreatePresentationFromFileCalledViaInAppHandOffMessage="Trigger_CreatePresentationFromFile_Called_ViaInAppHandOffMessage",e.TriggerSummaryCalledViaInAppHandOffMessage="Trigger_Summary_Called_ViaInAppHandOffMessage",e.TriggerAskCopilotCalledViaInAppHandOffMessage="Trigger_AskCopilot_Called_ViaInAppHandOffMessage",e.StoryTellerResponseInChat="StoryTeller_Response_In_Chat",e.InternetDisconnected="Internet_Disconnected",e.LearnMoreOptionClicked="Learn_More_Option_Clicked",e.PretriggerContentProcessing="Pretrigger_Content_Processing",e.ContentProcessingProgress="Content_Processing_Progress",e.SegmentToSlideProgress="Segment_To_Slide_Progress",e.SubstrateAPIOperationSubmitted="Substrate_API_Operation_Submitted",e.CopilotLabDialogLaunched="Copilot_Lab_Dialog_Launched",e.CopilotLabDialogClosed="Copilot_Lab_Dialog_Closed",e.CopilotLabPromptItemClicked="Copilot_Lab_Prompt_Item_Clicked",e.CopilotLabSavedPromptClicked="Copilot_Lab_Saved_Prompt_Clicked",e.CopilotLabPromptSubmitted="Copilot_Lab_Prompt_Submitted",e.ImageOutOfScopeError="Image_Out_Of_Scope_Error",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.IsVoiceCopilotFGEnabled="Is_VoiceCopilot_FG_Enabled",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.WarningMessageCardShown="Warning_Message_Shown",e.OrganizePresentationButtonClicked="Organize_Presentation_Button_Clicked",e.CancelButtonClicked="Cancel_Button_Clicked",e.CreatePresentationButtonClicked="Create_Presentation_Button_Clicked",e.CreatePresentationWarningType="Create_Presentation_Warning_Type",e.QuerySuccessful="Query_Successful",e.TransformFileUsedWithCLP="TransformFile_Used_With_CLP",e.IsDocumentProtected="Is_Document_Protected",e.TransformFileUsedWithCLPForOutline="TransformFile_Used_With_CLP_For_Outline",e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.CLPUpgradeLabelStart="CLP_Upgrade_Label_Start",e.CLPUpgradeLabelAborted="CLP_Upgrade_Label_Aborted",e.CLPUpgradeLabelStatus="CLP_Upgrade_Label_Status",e.CLPEmptySourceLabel="CLP_Empty_Source_Label",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.ConversationSensitivityLabelNotFound="Conversation_Sensitivity_Not_Found",e.HandoffMessageIdGetOperationSubmitted="Handoff_Message_Id_Get_Operation_Submitted",e.HandoffMessageIdProcessedOperationSubmitted="Handoff_Message_Id_Processed_Operation_Submitted",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffQuerySubmittedByUser="Handoff_Query_Submitted_By_User",e.SelfHelpContentShown="SelfHelp_Content_Shown",e.SelfHelpActionClicked="SelfHelp_Action_Clicked",e.ZQMV2Loaded="ZQMV2_Loaded",e.ZQMV2CardClicked="ZQMV2_Card_Clicked",e.CommandingErrorCardLoaded="Commanding_Error_Card_Loaded",e.CommandingErrorCardClicked="Commanding_Error_Card_Clicked",e.PresentationRecommendationOperationSubmitted="PresentationRecommendationOperationSubmitted",e.PresentationRecommendationThumbnailNotReceived="PresentationRecommendationThumbnailNotReceived",e.AddEnterpriseImageClicked="Add_Enterprise_Image_Clicked",e.PptCopilotEditScn="PptCopilotEditScn",e.SegmentToSlideJOfcCommandsError="Segment_To_Slide_JOfc_Commands_Error",e.CopilotODSLJOfcCommandsError="Copilot_ODSL_JOfc_Commands_Error",e.OrganizePresentationJOfcCommandsError="Organize_Presentation_JOfc_Commands_Error",e.PresentationRecommendationJOfcCommandsError="Presentation_Recommendation_JOfc_Commands_Error",e.StoryTellerJOfcCommandsError="StoryTeller_JOfc_Commands_Error",e.ImagePickerJOfcCommandsError="ImagePicker_JOfc_Commands_Error",e.DesignerImageInsertJOfcCommandsError="Designer_Image_Insert_JOfc_Commands_Error",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.MultipleFileSourcesDetected="Multiple_File_Sources_Detected",e.RetryingContentProcessingAnnotationCall="Retrying_Content_Processing_Annotation_Call",e.NotificationCardUpdated="Notification_Card_Updated",e.NotificationError="Notification_Error",e.StaleNotificationReceived="Stale_Notification_Received",e.CheckNotification="Check_Notification",e.VisualSummaryShownAfterNotification="Visual_Summary_Shown_After_Notification",e.CshCopilotLinkClicked="Help_CSH_Copilot_Link_Clicked",e.TaskModuleLaunched="Task_Module_Launched",e.TaskModuleClosed="Task_Module_Closed",e.MsgExtDataReceived="MsgExt_Data_Received",e.EnabledPlugins="Enabled_Plugins",e.GptIdForBranding="Gpt_Id_For_Branding",e.InputSignalSwitcherMenuGptId="Input_Signal_Switcher_Menu_Gpt_Id",e.InputSignalAtMentionGptId="Input_Signal_At_Mention_Gpt_Id",e.InputSignalAtMentionPlugin="Input_Signal_At_Mention_Plugin",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.OfficeAddinCalledTime="OfficeAddinCalledTime",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.PreloadCopilot="PreloadCopilot",e.TriggerPptVisualOperation="Trigger_Ppt_Visual_Operation"}(dC||(dC={})),function(e){e.ErrorRequestTimedOut="ErrorRequestTimedOut",e.DeckTooLargeToSummarizeError="DeckTooLargeToSummarizeError",e.SummaryNoActionItemsIdentified="SummaryNoActionItemsIdentified",e.ServerErrorMessage="ServerErrorMessage",e.StorytellerFailureMessage="StorytellerFailureMessage",e.ActionOnlySupportedInRibbonMessage="ActionOnlySupportedInRibbonMessage",e.ImageOutOfScopeIntentError="ImageOutOfScopeIntentError",e.CommandNotSupportedMessage="CommandNotSupportedMessage",e.StopGeneratingResponseMessage="StopGeneratingResponseMessage",e.UserCancelledExecutionMessage="UserCancelledExecutionMessage",e.AssistantCreatePresentationResponseHeaderMessage="AssistantCreatePresentationResponseHeaderMessage",e.DesignerDisabledErrorMessage="DesignerDisabledErrorMessage",e.ErrorPresentationAlreadyStructured="ErrorPresentationAlreadyStructured",e.ErrorSlideAlreadyAnimated="ErrorSlideAlreadyAnimated",e.CLPUnableToApplySensitivityLabel="CLPUnableToApplySensitivityLabel",e.ErrorGenericFallback="ErrorGenericFallback",e.UnexpectedVersionErrorMessage="UnexpectedVersionErrorMessage",e.DisabledFeatureErrorMessagePrefix="DisabledFeatureErrorMessagePrefix",e.PartialSuccessErrorMessage="PartialSuccessErrorMessage",e.LessContentToSummarizeError="LessContentToSummarizeError",e.OffensiveContentToSummarizeError="OffensiveContentToSummarizeError",e.LicenseValidationErrorMessage="LicenseValidationErrorMessage",e.DocumentPasswordProtectedOrEncrypted="DocumentPasswordProtectedOrEncrypted",e.DocumentTooLargeToDownloadError="DocumentTooLargeToDownloadError",e.DocumentNotFoundToTransformError="DocumentNotFoundToTransformError",e.DocumentTooShortToTransformError="DocumentTooShortToTransformError",e.DocumentDownloadFailedError="DocumentDownloadFailedError",e.CLPNoAccessPermission="CLPNoAccessPermission",e.ErrorConsumerQueryTranformFile="ErrorConsumerQueryTranformFile",e.CLPGeneralSensitivityLabelError="CLPGeneralSensitivityLabelError",e.RMSDisabled="RMSDisabled",e.DocumentAccessPermissionError="DocumentAccessPermissionError",e.ErrorServerBusy="ErrorServerBusy",e.ThrottlingErrorMessage="ThrottlingErrorMessage",e.ErrorDetectedOtherLanguage="ErrorDetectedOtherLanguage",e.ErrorOffensiveContentBlocked="ErrorOffensiveContentBlocked",e.ErrorQueryTooLarge="ErrorQueryTooLarge",e.ErrorQueryTooSmall="ErrorQueryTooSmall",e.DKEAndNotExtractLabelErrorString="DKEAndNotExtractLabelErrorString",e.CopilotUnsupportedlanguageMessage="CopilotUnsupportedlanguageMessage",e.CopilotUnsupportedLanguageError="CopilotUnsupportedLanguageError",e.DisengagedError="DisengagedError",e.OrganizePresentationRAIError="OrganizePresentationRAIError",e.OrganizePresentationTooLargeFile="OrganizePresentationTooLargeFile",e.OrganizePresentationInsufficientSlideContent="OrganizePresentationInsufficientSlideContent",e.OrganizePresentationInvalidLanguaguage="OrganizePresentationInvalidLanguaguage",e.OrganizePresentationUnsupportedLanguage="OrganizePresentationUnsupportedLanguage",e.OrganizePresentationServiceUnavailable="OrganizePresentationServiceUnavailable",e.TransformFileGeneralError="TransformFileGeneralError",e.StorytellerRaiBlockedMessage="StorytellerRaiBlockedMessage",e.StorytellerNoTopicSpecifiedMessage="StorytellerNoTopicSpecifiedMessage",e.StorytellerInvalidSlidesTopicMessage="StorytellerInvalidSlidesTopicMessage",e.StorytellerInvalidPresentationTopicMessage="StorytellerInvalidPresentationTopicMessage",e.StorytellerErrorMessage="StorytellerErrorMessage",e.EmptySummaryResponseMessage="EmptySummaryResponseMessage",e.NoActionItemsFoundMessage="NoActionItemsFoundMessage",e.EmptyKeySlidesResponseMessage="EmptyKeySlidesResponseMessage",e.TransformFileCLPProtectedErrorMessage="TransformFileCLPProtectedErrorMessage",e.TransformFileCLPSensitivityLabelErrorMessage="TransformFileCLPSensitivityLabelErrorMessage",e.CLPNoUserPermissionForSensitivityLabel="CLPNoUserPermissionForSensitivityLabel",e.UnsupportedExcelFileError="UnsupportedExcelFileError",e.UnsupportedPptFileError="UnsupportedPptFileError",e.UnsupportedPdfFileError="UnsupportedPdfFileError",e.UnsupportedWordFileError="UnsupportedWordFileError",e.UnsupportedFileError="UnsupportedFileError",e.DocumentUrlInvalidError="DocumentUrlInvalidError",e.DocumentUrlEmptyError="DocumentUrlEmptyError",e.UnsupportedSummaryError="UnsupportedSummaryError",e.DocumentUrlNotFromSharePoint="DocumentUrlNotFromSharePoint",e.ErrorInExecution="ErrorInExecution",e.ErrorNotEnoughContent="ErrorNotEnoughContent",e.HandoffMessageIdResponseError="Handoff_MessageIdResponse_Error",e.HandoffMessageFromHostAppSettingsError="HandoffMessageFromHostAppSettingsError",e.DesignerVisualsEmptyResponse="DesignerVisualsEmptyResponse",e.DesignerVisualsSkillResponseParseError="DesignerVisualsSkillResponseParseError",e.DesignerVisualsInsertError="DesignerVisualsInsertError",e.DesignerVisualsInsertJOfcCommandsError="DesignerVisualsInsertJOfcCommandsError",e.DesignerVisualsText2ImageError="DesignerVisualsText2ImageError",e.DesignerVisualsLLMError="DesignerVisualsLLMError",e.DesignerVisualsUnsupportedImageTypeError="DesignerVisualsUnsupportedImageTypeError",e.DesignerVisualsStockRAIError="DesignerVisualsStockRAIError",e.DesignerVisualsUnknownError="DesignerVisualsUnknownError",e.OutOfCreditsError="OutOfCreditsError"}(pC||(pC={}));var IC,_C,wC,PC,xC,kC=Sd(Cd({},dC,sC,uC),{UserQueryOrder:"UserQueryOrder",ALSessionKey:"ALSessionKey",HostSDXSessionID:"HostSDXSessionID"});!function(e){e.Augloop="Augloop",e.ContextIQ="ContextIQ",e.WordCount="WordCount",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.StoryTeller="StoryTeller",e.StoryTellerWorkflow="StoryTellerWorkflow",e.QueryDetails="QueryDetails",e.OfficeJsApi="OfficeJsApi",e.Summary="Summary",e.SearchQuery="SearchQuery",e.SharedAugloop="SharedAugloop",e.SegmentToSlide="SegmentToSlide",e.OrganizePresentation="OrganizePresentation",e.PresentationTransformer="PresentationTransformer",e.CopilotODSL="CopilotODSL",e.BasicChat="BasicChat",e.ChatHistory="ChatHistory",e.FluxCopilot="FluxCopilot",e.Microphone="Microphone",e.Chat="Chat",e.Commanding="Commanding",e.ImagePicker="ImagePicker",e.PresentationRecommendation="PresentationRecommendation",e.Designer="Designer",e.CLP="CLP",e.SketchToImage="SketchToImage",e.Notification="Notification",e.PlayKeySlides="PlayKeySlides",e.ClickableKeySlides="ClickableKeySlides"}(IC||(IC={})),function(e){e.ChatPaneLoad="ChatPaneLoad",e.Preload_ChatPaneLoad="Preload_ChatPaneLoad",e.CopilotChat="CopilotChat",e.Summary="Summary",e.BasicChat="BasicChat",e.Commanding="Commanding",e.Sydney="Sydney",e.CreatePresentation="CreatePresentation",e.CreatePresentationFromDoc="CreatePresentationFromDoc",e.AddSlide="AddSlide",e.InsertImage="InsertImage",e.Organize="Organize",e.Beautify="Beautify",e.Animate="Animate",e.CopilotLab="CopilotLab",e.AddText="AddText",e.Handoff="Handoff",e.PresentationRecommendation="PresentationRecommendation",e.Customize="Customize",e.Notification="Notification",e.DesignerVisuals="DesignerVisuals",e.ShowPreloadedCopilot="ShowPreloadedCopilot"}(_C||(_C={})),function(e){e.CommandName="CommandName",e.IsCommandSuccessString="IsCommandSuccessString",e.UserQueryGuid="UserQueryGuid",e.HostSDXSessionID="HostSDXSessionID",e.Status="Status",e.EventOrder="EventOrder",e.ErrorCategory="ErrorCategory",e.ScenarioString="ScenarioString",e.IsLastStatement="IsLastStatement",e.Message="Message",e.TranspilationLatencyMSec="TranspilationLatencyMSec"}(wC||(wC={})),function(e){e.Initialize="Initialize",e.Executed="Executed"}(PC||(PC={})),function(e){e.Unsupported="Unsupported",e.Blocked="Blocked",e.Failed="Failed",e.ContentGenerationDisabled="ContentGenerationDisabled",e.UserAborted="UserAborted",e.PartialSuccess="PartialSuccess",e.DismissedCommand="DismissedCommand",e.None="None"}(xC||(xC={}));var AC,LC,DC,OC,NC,RC,FC;!function(e){e.SummarizeNotPerformed="CopilotDidNotPerformSummarize",e.CommandNotExecuted="CopilotCommandDidNotExecute",e.UnableToCompleteTask="Unable to Complete Task",e.CommandNotGeneratedForOrganize="CopilotDidNotGenerateCommandDuringOrganize",e.ContentGeneration="Error encountered using CopilotChat under Content Generation capability",e.SummarizeTimedOut="Summarize Summarize Response Delayed or Timed Out",e.SummarizeUnsupportedFunctionality="Summarize Summarize Unsupported Copilot Functionality",e.SummarizeUnableToComplete="Summarize Summarize Unable to Complete Task",e.SummarizeLLMServiceSideIssue="Summarize Summarize LLM Service Side Issue Prevents Output",e.SummarizeUserAccessIssue="Summarize Summarize User Access Issue for Copilot",e.UnclassifiedAshaError="Unclassified ASHA Error",e.SummarizeCapacityIssue="Summarize Summarize Unable to Generate Response Due to Capacity Issue",e.SummarizeBlockedResponse="Summarize Summarize Responsible AI Filter Blocked Response",e.SummarizeMissingFunctionality="Summarize Summarize Missing Copilot Functionality",e.UserCancelledResponse="User Rejected or Cancelled Response",e.ResponseDelayedOrTimedOut="Response Delayed or Timed Out",e.CommandCapacityIssue="Command Basic Command Unable to Generate Response Due to Capacity Issue",e.CommandInputCouldNotBeProcessed="Command Basic Command User Input Could Not Be Processed",e.CommandFileReferencingFailed="Command Basic Command Referencing a File Failed",e.CommandBlockedResponse="Command Basic Command Responsible AI Filter Blocked Response",e.CommandUnableToCompleteTask="Command Basic Command Unable to Complete Task",e.RAIError="Responsible AI Filter Blocked Response",e.SummarizeRAIError="Summarize Summarize Responsible AI Filter Blocked Response",e.ServiceSideIssuePreventsOutput="LLM Service Side Issue Prevents Output",e.UserInputCouldNotBeProcessed="User Input Could Not Be Processed",e.Unset="",e.UnsupportedCopilotFunctionality="Unsupported Copilot Functionality",e.UserAccessIssueForCopilot="User Access Issue for Copilot",e.UnableToGenerateResponseDueToCapacityIssue="Unable to Generate Response Due to Capacity Issue",e.Text2ImageError="Text2Image Error"}(AC||(AC={})),function(e){e.Fallback="Error occurred because of an unclassifed issue",e.Timeout="Timeout waiting for server",e.LessContent="Error occurred because document length is too short",e.InvalidInput="Error occurred because the deck is blank",e.OffensiveContent="Error occurred because of offensive content",e.NoActionItems="Error occurred because no action items can be found on this deck",e.NoImportantSlides="Error occurred because no important slides can be found on this deck",e.NoSummaryPoints="Error occurred because no summary points can be found on this deck",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.InvalidLanguage="Error occurred because language is not supported",e.InvalidInputLanguage="Input language is not supported",e.InvalidOutputLanguage="Output language is not supported",e.FailedToGetInputLanguage="Failed to get input language",e.LicensingOld="Error occurred because copilot license couldn't be validated",e.TooShort="Error occurred because content is too short",e.MissingPPTContent="Error occurred because content is missing",e.BadResponse="Error occurred because of bad response",e.BadRequest="Error occurred because of bad request",e.Token="Error occurred because of token",e.Unknown="Error is unknown",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.PromptInjection="Error occurred because prompt injection is detected",e.InvalidSignal="Error occurred because signal is invalid.",e.MissingSignal="Error occurred because signal is missing in workflow",e.InvalidIntent="Error occurred because intent is invalid/missing",e.InvalidSubIntent="Error occurred because sub-intent is invalid",e.MissingSubIntent="Error occurred because sub-intent is missing",e.APIUnavailable="Error occurred because API is not available",e.RAIOnInputError="Error occurred while checking RAI on input query",e.RAIOnOutputError="Error occurred while checking RAI on generated answer",e.OutputBlockedByFilters="Error occurred because output is blocked by filters",e.OffensiveOutputBlockedByContentModerator="Output blocked by content moderator for being offensive",e.VisualDescriptionGenerationUnknownError="Unknown error occurred while generating visual descriptions.",e.VisualDescriptionGenerationError="Error occurred while generating visual descriptions.",e.Licensing="AugLoop failed to validate the user's Copilot entitlement",e.InvalidTokens="AugLoop failed to validate the Copilot user token"}(LC||(LC={})),function(e){e.OffensiveContent="Command didn't execute because of offensive content",e.Fallback="Command didn't execute due to service side error",e.InvalidInput="Command didn't execute because input query is invalid",e.Licensing="Command didn't execute because copilot license couldn't be validated",e.IncorrectODSLVersion="Command didn't execute because ODSL version is not supported",e.UnexpectedVersion="Command didn't execute because Host version is not supported",e.InvalidLanguage="Command didn't execute because language is not supported",e.ServiceBusy="Command didn't execute because service is busy",e.Throttled="Command didn't execute because number of requests per hour limit exceeded",e.Disengaged="Command didn't execute because of harmful user query",e.UserThrottled="Command didn't execute because user has issued too many requests",e.ScenarioThrottled="Command didn't execute because scenario has issued too many requests",e.TooLong="Command didn't execute because input is too long",e.DocumentPermission="Command didn't execute because of document permission error",e.InputQuery="Command didn't execute because input query is offensive",e.GeneratedOutput="Command didn't execute because generated output is offensive",e.OutOfCredits="Command didn't execute because user is out of credits"}(DC||(DC={})),function(e){e.InternetDisconnected="Error occurred because internet was disconnected",e.UserAbortedQueryExecution="User aborted query execution",e.RAI="Error occurred because of offensive content",e.NoResponseFromSydney="Error occurred because no chat response/error rendered by sydney",e.UnknownError="Error occurred because of an unclassifed issue",e.GptSwitchAbortedQueryExecution="Gpt switch aborted query execution"}(OC||(OC={})),function(e){e.DocumentUrlInvalidError="Document URL is invalid",e.DocumentUrlEmptyError="Document URL is empty",e.BadResponse="Error occurred because of bad response",e.InvalidTokensOld="Input query contains invalid tokens",e.ODSLArgumentTypeMismatch="ODSL argument value does not match the type",e.SydneyConnectionCancelled="Connection to Sydney is cancelled",e.DisambiguationRequired="Disambiguation is required",e.SydneyDisengagement="Sydney disengagement error",e.ODSLBadArgumentValue="ODSL required argument has a bad value",e.DocumentProcessingDenied="Processing the document associated with the query is denied",e.ODSLMissingRequiredArgument="ODSL for slide generation failed because it's missing a required argument",e.EmptyGeneratedResponse="Error occurred because generated response is empty",e.ExcessTokensRequest="Excess tokens in the request",e.ExcessTokensResponse="Excess tokens in the response",e.VisualDescriptionsGenerationError="Error occurred while generating visual descriptions.",e.FailedToGetInputLanguage="Failed to get input language",e.Fallback="Failed due to service side error",e.OffensiveGeneratedOutput="Offensive content detected in generated output",e.OffensiveGeneratedSydneyOutput="Offensive content detected in generated Sydney output",e.OperationNotPerformable="Error occurred because copilot cannot perform the operation",e.LLMImageDetailsGenerationFailed="LLM call failed when generating image details for slide JSON.",e.LLMSlideJSONGenerationFailed="LLM call failed to generate slide JSON",e.OffensiveInputContent="Offensive content detected in input content",e.OffensiveInputQuery="Offensive content detected in input query",e.RAIInputQueryCheckError="Error occurred while checking RAI on input query",e.InvalidInputQuery="Input query is invalid",e.InvalidSubIntent="Error occurred because sub-intent is invalid",e.UnparsableODSL="ODSL contained a generate_slides statement that can't parsed",e.UserAbortedQueryExecution="User aborted query execution",e.IncorrectlyFormattedODSL="ODSL for slide generation failed because it's not formatted correctly",e.LLMContentGenerationFailed="LLM call failed when trying to generate content for replacing text on a slide",e.LLMContentRewritingFailed="LLM call failed when trying to generate content for rewriting a slide",e.InvalidFileURL="Input query has a invalid file URL",e.LicenseValidationFailedOld="Error occurred because copilot license couldn't be validated",e.LowLanguageScore="Language score is too low",e.MissingSignalInWorkflow="Error occurred because signal is missing in workflow",e.MissingSubIntent="Error occurred because sub-intent is missing",e.MissingODSLArgument="ODSL is missing a required argument",e.MissingServicePlan="Required service plan is missing",e.NoImagesGenerated="No images generated by Text2Image model",e.NoEffectProgram="The program returned would have no effect",e.NoResponseFromSydney="Error occurred because no chat response/error rendered by sydney",e.APIUnavailable="Error occurred because API is not available",e.UnsupportedInputLanguage="Input language is not supported",e.UnsupportedOutputLanguage="Output language is not supported",e.OffensiveContentError="Error occurred because of offensive content",e.OffensiveOutputBlocked="Output blocked by content moderator for being offensive",e.InputOutOfScope="Input query is out of scope of system",e.OutputBlockedByFilters="Error occurred because output is blocked by filters",e.RAIGeneratedOutputCheckError="Error occurred while checking RAI on generated output",e.RAIGeneratedAnswerCheckError="Error occurred while checking RAI on generated answer",e.SlideJSONParsingFailure="Failure when parsing slide JSON returned from LLM",e.PerpetualDisambiguationLoop="Perpetual disambiguation loop detected",e.ODSLExecutionFailure="ODSL was successfully returned, but the client failed to execute it",e.Text2ImageModelResponseFailure="Failure in receiving response from Text2Image model",e.SameSlotDisambiguationLoop="Disambiguation loop detected with the same slot",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.SkillsFailed="Skills failed",e.UnsupportedSydneyLanguage="Unsupported language for Sydney",e.UnclassifiedIssue="Error occurred because of an unclassified issue",e.Unset="",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.ProgramExecutionTimeout="Timeout occurred during program execution",e.ServerTimeout="Timeout waiting for server",e.TokenError="Error occurred because of token",e.InputTooLong="Input query is too long",e.InputTooShort="Input query is too short",e.TruncatedODSL="ODSL returned by LLM was truncated",e.ODSLParsingError="Unhandled error while parsing ODSL",e.ODSLSyntaxValidationError="Unhandled error when validating ODSL syntax",e.UnknownError="Error is unknown",e.VisualDescriptionsGenerationUnknownError="Unknown error occurred while generating visual descriptions.",e.ModelUnknownError="Unknown error from model",e.UnknownDetectedLanguage="Detected language is unknown",e.ODSLStatementSchemaMismatch="ODSL statement does not belong to the schema",e.UnrecognizedText2ImageModelBaseURL="Base URL for Text2Image model is unrecognized",e.ODSLValueOutOfRange="Value in ODSL is outside range of allowed values",e.ODSLStatementBlocked="ODSL statement is blocked by administrator",e.UnsupportedLanguage="Language is unsupported",e.UnsupportedMultiAgent="Input query involves multiple agents which is unsupported",e.UnsupportedInputQuery="Input query is not supported",e.UserThrottled="Error occurred because user has issued too many requests",e.UndefinedODSLVariableReference="ODSL contains reference to a variable that is not defined",e.ODSLArgumentWrongType="ODSL argument has a wrong type",e.InvalidSignal="Error occurred because signal is invalid.",e.EmptyODSLCreation="LLM call to create ODSL did not have any ODSL in it",e.UnsupportedVersion="Error occurred because version is not supported",e.ServiceBusy="Error occurred because service is busy",e.InputContentTooShort="Error occurred because input content is too short",e.LicenseValidationFailed="AugLoop failed to validate the user's Copilot entitlement",e.InvalidTokens="AugLoop failed to validate the Copilot user token",e.PartialSuccessErrorMessage="Partial success message displayed",e.Text2ImageGenericError="Text2Image failed to return requested image(s)",e.DesignerVisualsInferenceAPIError="Skill failed to properly generate entire response",e.DesignerVisualsUnsupportedImageType="Unsupported image type requested"}(NC||(NC={})),function(e){e.UnclearIntent="Unclear Intent CopilotChat",e.BasicChat="Ask Chat QnA",e.Summarize="Summarize Summarize",e.Command="Command Basic Command",e.AddContent="Create Add Content",e.DesignerVisuals="Create Designer Visuals"}(RC||(RC={})),function(e){e.Disabled="Error occurred because content generation is disabled by admin"}(FC||(FC={}));var MC,BC;!function(e){e.CreatePresentation="Create a presentation",e.CreateFromFile="Create a presentation from file",e.AddSlide="Add a slide",e.AddImage="Add an image",e.AddEnterpriseImage="Add an enterprise image",e.Organize="Organize this presentation",e.Summarize="Summarize the presentation",e.VisualSummary="Visual Summary",e.KeySlides="Show the key slides",e.ShowActionItems="Show action items",e.Animate="Animate my slides",e.Beautify="Design my presentation",e.ProactiveRecommendation="Proactive Recommendation",e.Help="Help",e.BasicChat="Basic Chat",e.Sydney="Sydney",e.Unset="",e.SelfHelpSearch="Self-Help Search",e.AddDesignerImage="Add an image from Designer",e.CannedResponse="Canned Response",e.SegmentedSummary="Segmented Summary",e.StyledSummary="Styled Summary",e.HandOff="Hand-Off",e.Customize="Customize",e.SketchToImage="SketchToImage",e.InsertImage="Insert Image"}(MC||(MC={})),function(e){e.InitiatorView="InitiatorView"}(BC||(BC={}));var UC,HC,GC="UserQueryGuid";!function(e){e.HandoffStart="Handoff_Start",e.AppStart="App_Start",e.CopilotPaneStart="Copilot_Pane_Start",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.ChatPaneLoaded="Chat_Pane_Loaded",e.HandoffMessageIdSent="Handoff_Message_Id_Sent",e.HandoffMessageIdProcessed="Handoff_Message_Id_Processed",e.HandoffMessageReceived="Handoff_Message_Received",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted"}(UC||(UC={})),function(e){e.PromptType="promptType",e.SourceApp="sourceApp",e.IsModified="isModified",e.ScenarioName="scenarioName"}(HC||(HC={}));var zC=n(68274),qC=n(4317),WC=n(40668),jC=n(17997),VC=n(14483),QC=n(86360),JC=n(60581),KC=n(60150);class XC{constructor(){this.messageCallbackRegistrationReady=void 0}sendMessage(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(!this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback not registered");this.messageCallbackRegistrationReady.then((()=>{OfficeFirstParty.AugLoop.SendMessage(e)})).catch((e=>{throw e}))}registerMessageReceivedCallback(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback already registered");this.messageCallbackRegistrationReady=OfficeFirstParty.AugLoop.onHostMessageReceived((t=>e(t)))}}class ZC{sendTelemetryEvent(e){if("undefined"==typeof Office)throw new Error("Office global not available in SDX running AL");Office.sendTelemetryEvent(e)}}class YC{constructor(){this.telemetryLogger=new KC.M,this.telemetryLogger.addSink(new ZC)}convertTelemetryEvent(e,t,n,r,o,i,a){const s={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:this.convertDataFields(n),eventFlags:{dataCategories:6,diagnosticLevel:110,samplingPolicy:1}};return r&&(s.eventContract={name:r,dataFields:this.convertDataFields(o,r.split(".").slice(-1)[0])}),s}convertDataFields(e,t){const n=[];for(const r of Object.keys(e)){if(void 0===e[r]||null===e[r])continue;const o={name:t?`${t}.${r}`:r,dataType:this.getDataFieldType(e[r]),value:e[r],classification:4};n.push(o)}return n}getDataFieldType(e){return"string"==typeof e?0:"boolean"==typeof e?1:"number"==typeof e?2:void 0}sendTelemetryEvent(e,t,n,r,o,i,a,s){this.telemetryLogger.sendTelemetryEvent(this.convertTelemetryEvent(e,t,n,r,o,a,s))}sendDiagnosticTrace(e,t,n){}addCustomSync(e){this.telemetryLogger.addSink(e)}}var $C=n(6633),eS=n(18133),tS=n(88347),nS=n(19603),rS=n(93440),oS=n.n(rS);class iS{constructor(e){this.queue=void 0,this.options={},this.maxSize=void 0,this.options=e,this.maxSize=this.options&&this.options.maxSize?this.options.maxSize:void 0,this.queue=new(oS())}push(e){this.queue.push(e),this.maxSize&&this.queue.length>this.maxSize&&this.queue.shift()(new Error("TaskQueue Max size reached."))}processAll(){for(;this.queue.length>0;)this.queue.shift()(void 0)}}var aS=n(66597),sS=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function s(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((r=r.apply(e,t||[])).next())}))},lS=function(e){return this instanceof lS?(this.v=e,this):new lS(e)},cS=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=o[e](t)).value instanceof lS?Promise.resolve(n.value.v).then(l,c):u(i[0][2],n)}catch(e){u(i[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}};const uS="cst-";let dS=(0,$C.v4)(),pS=!1,gS=null;const mS=(e,t)=>{var n;return n=new YC,pS||(gS=new zC.MP(n),eS.tG.addLogger(gS),pS=!0),new hS(e,new XC,t)};let fS=!1;class hS{constructor(e,t,n){this.sessionOptions=void 0,this.docSessionId="",this.messageBridge=void 0,this.activationsMapTypeToTokens=new Map,this.activationsMapTokenToCallback=new Map,this.waitingForResponse=new Map,this.messageId=0,this.customMessageSeq=0,this.activationToken=0,this.sessionClosed=!1,this.connectParams=void 0,this.seedGroupSize=0,this.connectionPendingTaskQueue=new iS({maxSize:1e4}),this.sessionCloseMessages=[],this.sessionCloseCallbacks=new Map,this.sessionConnectCallbacks=new Map,this.sessionReconnectCallbacks=new Map,this.sessionDisconnectCallbacks=new Map,this.sessionCallbackToken=0,this.currentAuthenticationState=WC.f.Pending,this.serverAuthenticationStateChangeCallbacks=[],this.claimsChallengeCallbacks=new Map,this.internalSessionNumber=0,this.getAnnotationsResponseQueue=[],hS.internalSessionCounter++,this.internalSessionNumber=hS.internalSessionCounter,this.sessionOptions=n,fS||(eS.tG.addAggregator((0,zC.cS)("Operation","operationName",["ProcessMessage","SubmitOperations","SubmitCustomMessage","SendLargeBinaryDataMessage","SendBinaryStreamUploadMessage","RequestBinaryData"],30)),fS=!0),this.docSessionId=e,this.messageBridge=t,this.prevMessageInfo={sequenceId:-1},t.registerMessageReceivedCallback((e=>{const t=JSON.parse(e),n=this.createLoggingOperation("ProcessMessage",!0);if(!t)return n.dimension2="ParseFailed",n.success=!1,void eS.tG.info(509088289,eS.nh.CoreDefault,n.stop());const r=t.message||t.response;if(this.verifyMessageOrder(t,r),!(t.bridgeId!=dS&&"*"!=t.bridgeId||t.docSessionId!=this.docSessionId&&"*"!=t.docSessionId)){if(!r)return n.dimension2="NoMessageOrResponse",n.success=!1,void eS.tG.info(509088288,eS.nh.CoreDefault,n.stop());jC.uN.typeGuard(r)?this.handleSessionInitResponse(r):jC.B_.typeGuard(r)?this.handleAnnotationResults(r,n):jC.w9.typeGuard(r)?this.handleSessionCloseMessage(r):jC.gy.typeGuard(r)?this.handleSessionConnectMessage(r):jC.lj.typeGuard(r)?this.handleSessionReconnectMessage(r):jC.eG.typeGuard(r)?this.handleSessionDisconnectMessage(r):jC.wU.typeGuard(r)?this.handleServerAuthenticationStateChange(r):VC.Td.typeGuard(r)?this.handleFireClaimsChallengeCallback(r):VC.wR.typeGuard(r)?this.handleGetAnnotationsResponse(r,n):jC.YK.typeGuard(r)?this.handleResponse(r,n):n.dimension2="UnknownType",n.resourceId=Qp.h.getTypeNameFor(r),eS.tG.info(509088287,eS.nh.CoreDefault,n.stop())}}));const r=new jC.eE({bridgeId:dS,clientMetadata:void 0,protocolVersion:2,messageId:this.getMessageId()});this.sendMessageWithOp("SessionInit",r)}getCallbackToken(e){return e+"-callback-"+this.internalSessionNumber+"-"+this.sessionCallbackToken++}createLoggingOperation(e,t){const n=new tS.I({operationName:e,ariaNamespace:"Office_AugLoop_Client_SDX",clientDocSessionId:this.docSessionId,dimension0:dS}).start();return n.success=t,n}handleFireClaimsChallengeCallback(e){if(!e.messageId||!e.claimsChallengeMessage)return;const t=this.claimsChallengeCallbacks.get(e.messageId);t&&t(e.claimsChallengeMessage)}handleSessionInitResponse(e){if(this.connectParams={authToken:e.anonymousToken,origin:e.origin,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,isSeedingRequired:!1},gS){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);gS.setServerSessionKey(e)}this.connectionPendingTaskQueue.processAll()}handleGetAnnotationsResponse(e,t){var n;if(!e.messageId)return t.resultDescription="NoMessageId",void(t.success=!1);const r=JSON.parse(e.serverResponse);this.getAnnotationsResponseQueue.push({content:r.content,error:{serviceError:r.errorInfo,clientError:e.clientError},finalResponse:e.finalResponse}),null===(n=this.responseReceived)||void 0===n||n.call(this,!0),t.dimension1=`Streaming. Final response: ${e.finalResponse}`,t.success=!0}handleResponse(e,t){return e.messageId?this.waitingForResponse.has(e.messageId)?(this.waitingForResponse.get(e.messageId)(e),this.waitingForResponse.delete(e.messageId),void(t.success=!0)):(t.resultDescription="NoResponseCallback",void(t.success=!1)):(t.resultDescription="NoMessageId",void(t.success=!1))}handleAnnotationResults(e,t){let n=0;t.resultSignature=e.annotationType;const r=this.activationsMapTypeToTokens.get(e.annotationType);if(t.dimension1=e.ops.length.toString(),r)for(const t of r)for(let r=0;r<e.ops.length;r++){const o=this.activationsMapTokenToCallback.get(t);o&&(o.callback(e.ops[r],e.cv),n++)}t.success=!0,t.dimension2=n.toString()}handleSessionCloseMessage(e){this.sessionClosed=!0,this.sessionCloseMessages.push(e),this.sessionCloseCallbacks.forEach(((t,n)=>{t(e)}))}handleSessionConnectMessage(e){if(this.connectParams={authToken:e.authToken,origin:e.origin,sessionUrl:e.sessionUrl,isSeedingRequired:e.isSeedingRequired},gS){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);gS.setServerSessionKey(e)}e.isSeedingRequired&&(this.seedGroupSize=0),this.sessionConnectCallbacks.forEach(((t,n)=>{t(e.isSeedingRequired,e.sessionUrl,e.origin,e.authToken)})),this.connectionPendingTaskQueue.processAll()}handleSessionReconnectMessage(e){this.sessionReconnectCallbacks.forEach(((e,t)=>{e()}))}handleSessionDisconnectMessage(e){this.connectParams=void 0,this.sessionDisconnectCallbacks.forEach(((t,n)=>{t(e.error)}))}handleServerAuthenticationStateChange(e){this.currentAuthenticationState!=e.serverAuthenticationState&&(this.currentAuthenticationState=e.serverAuthenticationState,this.serverAuthenticationStateChangeCallbacks.forEach((t=>{t(e.serverAuthenticationState)})))}getMessageId(){return"cl-"+this.internalSessionNumber+"-"+this.messageId++}getNextCustomMessageSeq(){return this.internalSessionNumber+"-"+this.customMessageSeq++}getNextActivationToken(){return"ac-"+dS+"-"+this.internalSessionNumber+"-"+this.activationToken++}getServerAuthenticationState(){throw new Error("Method not implemented.")}registerLocalWorkflow(e){throw new Error("Method not implemented.")}registerLocalWorkflows(e){throw new Error("Method not implemented.")}isLocalWorkflowRegistered(e){throw new Error("Method not implemented.")}activateAnnotation(e,t,n){const r=this.getMessageId(),o=this.getNextActivationToken(),i=this.createLoggingOperation("ActivateAnnotation",!0);i.resourceId=e;const a=new Promise(((n,a)=>{this.waitingForResponse.set(r,(r=>jC.PY.typeGuard(r)?(t&&(this.activationsMapTypeToTokens.has(e)||this.activationsMapTypeToTokens.set(e,new Set),t.callback&&(this.activationsMapTokenToCallback.set(r.token,{annotationType:e,callback:t.callback}),this.activationsMapTypeToTokens.get(e).add(r.token))),i.resultDescription=`Activated annotation with token ${r.token}`,eS.tG.info(509088286,eS.nh.CoreDefault,i.stop()),void n(new jC.PY({token:r.token}))):jC._p.typeGuard(r)?(this.activationsMapTypeToTokens.get(e).delete(o),this.activationsMapTokenToCallback.delete(o),i.success=!1,i.resultDescription=r.error,eS.tG.error(509088285,eS.nh.CoreDefault,i.stop()),void a(new Error(r.error))):(i.success=!1,i.resultDescription="Unknown Response",eS.tG.error(509088284,eS.nh.CoreDefault,i.stop()),void a(new Error("Unknown Response")))))})),s=new jC.n4({annotationType:e,token:o,config:t?t.config:void 0,bridgeId:dS,messageId:r,forceReturnCachedAnnotations:t?t.forceReturnCachedAnnotations:void 0});return this.sendMessage(s,{hostConfig:n}),a}updateAnnotationConfig(e,t){throw new Error("Method not implemented.")}releaseAnnotation(e){const t=this.createLoggingOperation("ReleaseAnnotation",!0);if(t.dimension2=e,!this.activationsMapTokenToCallback.has(e)){const n="AnnotationActivation already released:"+e;return t.success=!1,t.resultDescription=n,eS.tG.info(508937629,eS.nh.CoreDefault,t.stop()),Promise.reject(new Error(n))}const n=this.activationsMapTokenToCallback.get(e);n&&this.activationsMapTypeToTokens.get(n.annotationType).delete(e),this.activationsMapTokenToCallback.delete(e);const r=this.getMessageId(),o=new jC.GA({token:e,messageId:r}),i=new Promise(((e,n)=>{this.waitingForResponse.set(r,(r=>jC.Qq.typeGuard(r)?(eS.tG.info(508937628,eS.nh.CoreDefault,t.stop()),void e(r.lastRelease)):jC._p.typeGuard(r)?(t.success=!1,t.resultDescription=r.error,eS.tG.error(508937627,eS.nh.CoreDefault,t.stop()),void n(new Error(r.error))):(t.success=!1,t.resultDescription="Unknown Response",eS.tG.error(508937626,eS.nh.CoreDefault,t.stop()),void n(new Error("Unknown Response")))))}));return this.sendMessage(o),i}setAnnotationState(e,t,n){throw new Error("Method not implemented.")}setAnnotationMetadata(e,t,n){throw new Error("Method not implemented.")}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){const n=new jC.Tb({bridgeId:dS,ops:e,messageId:this.getMessageId(),cv:t});this.sendMessageWithOpAsync("SubmitOperations",n).catch((e=>{}))}submitSeedOperations(e,t){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");const n=new jC.Tb({bridgeId:dS,ops:e,messageId:this.getMessageId(),cv:t,seq:0});this.sendMessageWithOpAsync("SubmitSeedOperations",n).catch((e=>{}))}submitSeedGroupOperations(e,t,n){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");this.seedGroupSize++;const r=new jC.Tb({bridgeId:dS,ops:e,messageId:this.getMessageId(),groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0,cv:n,seq:0});this.sendMessageWithOpAsync("SubmitSeedGroupOperations",r).catch((e=>{}))}submitCustomMessage(e){const t=this.createLoggingOperation("SubmitCustomMessage",!0),n=e.messageId;e.messageId=e.messageId?uS+e.messageId:uS+this.getNextCustomMessageSeq();const r=this.getMessageId(),o=new Promise(((e,o)=>{this.waitingForResponse.set(r,(r=>jC.YK.typeGuard(r)?(t.resultDescription="Got response for submitted custom message",eS.tG.info(508420945,eS.nh.CoreDefault,t.stop()),r.messageId=n,void e(r)):jC._p.typeGuard(r)?(t.success=!1,t.resultDescription=r.error,eS.tG.error(508420944,eS.nh.CoreDefault,t.stop()),void o(new Error(r.error))):(t.success=!1,t.resultDescription="Unknown Response",eS.tG.error(508420943,eS.nh.CoreDefault,t.stop()),void o(new Error("Unknown Response")))))}));let i;Qp.h.matchesTypesFor(e,[jC.VR.getTypeName()])&&(i=nS.r.serialize(e));const a=new jC.g$({messageId:r,customMessage:e,binaryMessage:i?Array.from(i):void 0});return this.sendMessage(a),eS.tG.info(508436875,eS.nh.CoreDefault,t.stop()),o}sendLargeBinaryDataMessageInternal(e,t,n,r){(0,qC.A2)(e,t,n,r)}sendBlobUploadStreamMessageInternal(e,t,n,r){(0,qC.wM)(e,t,n,r)}submitLargeBinaryDataMessage(e){const t=this.createLoggingOperation("SendLargeBinaryDataMessage",!0),n=new Promise(((n,r)=>{this.connectionPendingTaskQueue.push((o=>{o?r(o):this.sendLargeBinaryDataMessageInternal(this.connectParams,e,t,((e,t)=>{e?r(new Error(e.error)):n(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),n}submitBinaryStreamUploadMessage(e){const t=this.createLoggingOperation("sendBinaryStreamUploadMessage",!0),n=new Promise(((n,r)=>{this.connectionPendingTaskQueue.push((o=>{o?r(o):this.sendBlobUploadStreamMessageInternal(this.connectParams,e,t,((e,t)=>{e?r(new Error(e.error)):n(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),n}fetchBlobFromRefInternal(e,t,n,r){(0,qC.ZC)(e,t,n,r)}requestBinaryDataForBlob(e){const t=this.createLoggingOperation("RequestBinaryData",!0);if(e.data)return eS.tG.info(507646876,eS.nh.CoreDefault,t.stop()),Promise.resolve(e.data);if(!e.dataPointer||e.dataPointer.refType===JC.J1.None){const e="Blob does not have a data pointer";return t.success=!1,t.resultDescription=e,eS.tG.error(507646875,eS.nh.CoreDefault,t.stop()),Promise.reject(new Error(e))}const n=new Promise(((n,r)=>{this.connectionPendingTaskQueue.push((o=>{o?r(o):this.fetchBlobFromRefInternal(this.connectParams,e.dataPointer,((e,t)=>{e?r(e):n(t)}),t)}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),n}requestCacheDump(e){throw new Error("Method not implemented.")}forceReconnect(e){throw new Error("Method not implemented.")}close(){const e=this.createLoggingOperation("CloseSession",!0);this.activationsMapTokenToCallback.forEach(((t,n)=>{this.releaseAnnotation(n).catch((t=>{e.resultDescription+=" "+t.message,e.success=!1}))})),eS.tG.info(508937625,eS.nh.CoreDefault,e.stop()),eS.tG.flushAggregators(!0)}authenticateInteractive(){return sS(this,void 0,void 0,(function*(){const e=new VC.i2({messageId:this.getMessageId()});yield this.sendMessageWithOpAsync("AuthenticateInteractive",e)}))}setConnectCallback(e){const t=this.getCallbackToken("connect");return e&&this.sessionConnectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getCallbackToken("disconnect");return e&&this.sessionDisconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getCallbackToken("reconnect");return e&&this.sessionReconnectCallbacks.set(t,e),t}setSessionCloseCallback(e){const t=this.getCallbackToken("close");return e&&(this.sessionCloseCallbacks.set(t,e),this.sessionClosed&&this.sessionCloseMessages.forEach((t=>{e(t)}))),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.sessionReconnectCallbacks)||t(this.sessionDisconnectCallbacks)||t(this.sessionConnectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallbacks.push(e),e(this.currentAuthenticationState)}setClaimsChallengeCallback(e){if(!e)return;const t=this.getCallbackToken("claimsChallenge");this.claimsChallengeCallbacks.set(t,e);const n=new VC.tj({messageId:t});this.sendMessageWithOp("SetClaimsChallengeCallback",n)}getConnectParams(){return this.connectParams}setOfflineMode(){throw new Error("Method not available.")}getAnnotations(e,t){var n,r;const o=this.createLoggingOperation("GetAnnotations",!0);o.dimension1=null===(n=e.annotationType)||void 0===n?void 0:n.toString(),o.dimension2=null===(r=e.maxDelayMs)||void 0===r?void 0:r.toString(),o.cv=e.cv;const i=new aS.x5({annotationTypes:e.annotationType,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:e.cv},messageId:this.getMessageId(),sourceInfo:e.sourceInfo});this.sendMessage(i);const a=this;let s=!1;const l=new Promise(((e,n)=>{if(t){const r=t.cancel.bind(t);t.cancel=()=>{s?e():(r(),n(new Error(hS.requestCancelledError)))}}}));return{[Symbol.asyncIterator](){return cS(this,arguments,(function*(){for(;!s;)try{0===a.getAnnotationsResponseQueue.length&&(yield lS(Promise.race([new Promise((e=>a.responseReceived=e)),l])));const e=a.getAnnotationsResponseQueue.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(hS.requestCancelledError);s=null==e?void 0:e.finalResponse,o.resultDescription="OK",eS.tG.info(506575007,eS.nh.CoreDefault,o.stop()),yield yield lS(e)}catch(e){const t=e.message===hS.requestCancelledError?QC.zy.RequestCancelled:QC.zy.Unknown;o.dimension0=`Error code: ${t}`,o.resultDescription=null==e?void 0:e.message,eS.tG.info(506575006,eS.nh.CoreDefault,o.stop()),yield yield lS({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),s=!0;break}}))}}}sendMessage(e,t){const n=new jC.vG(Object.assign({bridgeId:dS,docSessionId:this.docSessionId,messageType:Qp.h.getTypeNameFor(e),message:e},t));this.messageBridge.sendMessage(JSON.stringify(n))}sendMessageAsync(e,t){const n=new Promise(((t,n)=>{this.waitingForResponse.set(e.messageId,(e=>{jC._p.typeGuard(e)?n(new Error(e.error)):t(e)}))}));return this.sendMessage(e,t),n}sendMessageWithOp(e,t,n){const r=this.createLoggingOperation(e,!0);this.sendMessage(t,n),eS.tG.info(507105996,eS.nh.CoreDefault,r.stop())}sendMessageWithOpAsync(e,t,n){return sS(this,void 0,void 0,(function*(){const r=this.createLoggingOperation(e,!0);try{return yield this.sendMessageAsync(t,n)}catch(e){throw r.success=!1,r.resultDescription=e.message,e}finally{r.success?eS.tG.info(507105995,eS.nh.CoreDefault,r.stop()):eS.tG.error(507105994,eS.nh.CoreDefault,r.stop())}}))}verifyMessageOrder(e,t){if(void 0===e.seq)return;const n={sequenceId:e.seq};if(t&&(n.messageType=Qp.h.getTypeNameFor(t),n.annotationCv=t.cv,jC.B_.typeGuard(t))){const e=t;n.annotationType=e.annotationType}if(this.prevMessageInfo.sequenceId>n.sequenceId){const e=this.createLoggingOperation("OutOfOrderBridgeMessage",!1);e.setDataField("prevSeqId",this.prevMessageInfo.sequenceId),e.setDataField("prevMessageType",this.prevMessageInfo.messageType),e.setDataField("prevAnnotation",this.prevMessageInfo.annotationType),e.setDataField("prevAnnotationCv",this.prevMessageInfo.annotationCv),e.setDataField("currSeqId",n.sequenceId),e.setDataField("currMessageType",n.messageType),e.setDataField("currAnnotation",n.annotationType),e.setDataField("currAnnotationCv",n.annotationCv),eS.tG.info(506799568,eS.nh.CoreUnsampled,e.stop())}this.prevMessageInfo=n}}hS.internalSessionCounter=0,hS.requestCancelledError="Request cancelled";var vS,yS,CS=(0,dg.A)(),SS="ALDummySession",bS=SS,ES=function(){return cF(bS)?SS:bS};function TS(e){return _S()}function IS(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e,ZR("Loading Localized strings for Language: "+e+"Z"+t);var r=new Promise((function(e,r){n.onload=function(){e()},n.onerror=n.onabort=function(){var e=_p.GetHostAppDisplayLanguage();r(new xm(_m.FailedToLoadStrings,"Failed to load strings with mapped language = "+t+" and display language = "+e))}}));return document.head.appendChild(n),r}function _S(){var e=_p.GetHostAppDisplayLanguage(),t=new Nm;return t.IsTier2LanguageSupportEnabled=!0,t.IsTier2RTLLanguageEnabled=!0,t.IsTier3LanguagesEnabled=Vh(Lh.Tier3LanguageSupport),t.IsTier2Point5LanguagesEnabled=Vh(Lh.Tier2Point5LanguageSupport),t.getUserLanguage(e)}function wS(){return PS.apply(this,arguments)}function PS(){return(PS=(0,gd._)((function(){var e,t,n,r,o;return(0,F.__generator)(this,(function(i){e=_S(),n=(t="office-online-strings")+"/"+e+"/powerpoint-copilot-strings.min.js",r=t+"/"+e+"/officeaicopilot-strings.min.js";try{return[2,Promise.all([IS(n,e),IS(r,e)])]}catch(t){throw o=_p.GetHostAppDisplayLanguage(),new xm(_m.FailedToLoadStrings,"Failed to load strings with mapped language = "+e+" and display language = "+o)}return[2]}))}))).apply(this,arguments)}var xS=rM;function kS(){return(kS=(0,gd._)((function(e){var t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=(new Date).getTime(),[4,wS()];case 1:return o.sent(),yS=((new Date).getTime()-t)/1e3,ZR("LoadCopilotStringsTask completed in : ".concat(yS," sec")),[3,3];case 2:return nv(n=o.sent(),xm)&&ZR(n.message),[3,3];case 3:return o.trys.push([3,6,,7]),Vh(Lh.IsFeedbackAppChatIntegrationEnabled)?[4,OfficeFirstParty.UserFeedback.GetInitializationData()]:[3,5];case 4:xS=o.sent(),o.label=5;case 5:return[3,7];case 6:return r=o.sent(),ZR("Error in OfficeFirstParty UserFeedback GetInitializationData ",r),[3,7];case 7:return e(!0),[2]}}))}))).apply(this,arguments)}var AS=!1;function LS(){return AS}function DS(e){AS=e}var OS=!1;function NS(){return OS}var RS=!0;var FS=function(e,t){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(" ")}(e,t)},MS=function(e,t,n,r,o,a,s,l){var c,u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=Zy.getInstance();n&&""!==n&&e.sendChatEventTelemetry(HS((c={},(0,i._)(c,cC.ChatEventType,n),(0,i._)(c,cC.ChatEventParameters,r||""),(0,i._)(c,cC.ChatErrorType,o||""),(0,i._)(c,cC.ChatErrorKey,l||""),c)));var p,g=d.getShouldAccountForWarningCardUserInteractionLatency()?d.getWarningCardUserInteractionTimeInSec():0;u||e.sendLatencyTelemetry(HS((p={},(0,i._)(p,sC.UserPerceivedLatency,(0,qp.WU)(t)-g),(0,i._)(p,sC.IsQuerySuccess,void 0===n),(0,i._)(p,sC.ErrorType,o||""),(0,i._)(p,sC.ErrorParameter,(!0===a?n:r)||""),(0,i._)(p,sC.ErrorChatEventType,n&&""!==n?n:""),(0,i._)(p,sC.ErrorChatEventParameter,n&&""!==n&&r||""),p)),null==s||s);d.resetWarningCardLatencyParameters()},BS=function(e,t,n,r,o,a,s,l,c,u){var d,p,g=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],m=arguments.length>11?arguments[11]:void 0,f=arguments.length>12?arguments[12]:void 0;s?e.sendChatEventTelemetry(HS((d={},(0,i._)(d,cC.ChatEventType,s),(0,i._)(d,cC.ChatEventParameters,l||""),(0,i._)(d,cC.ChatErrorType,c||""),(0,i._)(d,cC.ChatErrorKey,f||""),d))):e.sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.ChatEventType,dC.QuerySuccessful),(0,i._)(p,cC.ChatEventParameters,a),p)));var h,v,y=[];g?y=HS((h={},(0,i._)(h,n,(0,qp.WU)(t)),(0,i._)(h,r,JSON.stringify(o)),(0,i._)(h,sC.IsQuerySuccess,void 0===s),(0,i._)(h,sC.ErrorType,c||""),(0,i._)(h,sC.ErrorParameter,l||""),h)):y=HS((v={},(0,i._)(v,n,(0,qp.WU)(t)),(0,i._)(v,r,JSON.stringify(o)),(0,i._)(v,sC.ErrorType,c||""),(0,i._)(v,sC.ErrorParameter,l||""),(0,i._)(v,sC.ErrorChatEventType,s||""),(0,i._)(v,sC.ErrorChatEventParameter,l||""),v));m&&e.logAshaErrorEvent(m.vetoName,m.errorString,m.featureName),e.sendLatencyTelemetry(y,null==u||u)},US=function(e,t,n,r,o,a,s){var l,c,u,d=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],p=null!==(l=null!=s?s:e.getQueryGuid())&&void 0!==l?l:"";e.sendChatEventTelemetry(HS((c={},(0,i._)(c,cC.UserQueryGuid,p),(0,i._)(c,cC.ChatEventType,dC.ResponseReceivedFromAL),(0,i._)(c,cC.ChatEventParameters,t),(0,i._)(c,cC.Cv,null!=a?a:""),c)),void 0);var g=(u={},(0,i._)(u,cC.UserQueryGuid,p),(0,i._)(u,sC.FeatureName,null!=o?o:_C.CopilotChat),u);d&&p&&(g[sC.AnnotationType]=t),r&&(g[r]=(0,qp.WU)(n)),e.sendLatencyTelemetry(HS(g),void 0)},HS=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))},GS=function(e){ob.getInstance().setQueryGuid(e)},zS=function(e,t,n,r){var o;Jh(Dh.IsCommandingUserPerceivedLatencyTelemetryEnabled)&&e.sendLatencyTelemetry(HS((o={},(0,i._)(o,sC.UserPerceivedLatency,t),(0,i._)(o,sC.IsQuerySuccess,n),(0,i._)(o,sC.QueryExecutionTime,(0,qp.WU)(r)),o)))},qS=function(e){var t;ob.getInstance().sendErrorTelemetry(HS((t={},(0,i._)(t,uC.ErrorMessage,"".concat(e)),(0,i._)(t,uC.ErrorCategory,IC.CLP),t)))},WS=function(e){var t;ob.getInstance().sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.OfficeJsApiCallForCLP),(0,i._)(t,cC.ChatEventParameters,"CLP_OfficeJsApi : ".concat(e)),t)))},jS=function(e){var t;RS&&Jh(Dh.ShouldCLPExceptionDisableEnterpriseSearch)&&(DS(!1),1)&&(ZR("Disabled enterprise search after hitting CLP exception"),ob.getInstance().sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.EnterpriseGroundingDisabled),(0,i._)(t,cC.ChatEventParameters,null!=e?e:""),t))))},VS=function(e,t){var n,r;e.manualSendPrompt?(n=dC.HandoffQueryPerceivedByUser,r=UC.HandoffQueryPerceivedByUser,e.query&&ob.getInstance().setInitialHandoffQuery(e.query)):(n=dC.HandoffQueryAutoSubmitted,r=UC.HandoffQueryAutoSubmitted),ob.getInstance().sendLatencyTelemetry(HS((0,i._)({},sC.UserPerceivedLatency,(0,qp.WU)(t))));var o,a={};if(e.sourceApp&&(a[HC.SourceApp]=e.sourceApp),e.context){var s=JSON.parse(e.context).promptType;s&&(a[HC.PromptType]=s)}e.scenarioName&&(a[HC.ScenarioName]=e.scenarioName),ZR("Handoff query perceived by user: ",a),ob.getInstance().sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,n),(0,i._)(o,cC.ChatEventParameters,JSON.stringify(a)),o))),e.handoffStartTime&&ob.getInstance().recordCheckPoint(UC.HandoffStart,e.handoffStartTime),ob.getInstance().recordCheckPoint(r),ob.getInstance().sendLatencyTelemetryForCheckPoints(!0)},QS=function(){function e(t){Sp(this,e),(0,i._)(this,"telemetryLatencyObject",void 0),(0,i._)(this,"telemetryChatEventObject",void 0),(0,i._)(this,"telemetryOfficeJsOperationObject",void 0),(0,i._)(this,"telemetryMicrophoneObject",void 0),(0,i._)(this,"telemetryQueryDetailsObject",void 0),(0,i._)(this,"chatHistoryLog",void 0),(0,i._)(this,"telemetryLogger",void 0),(0,i._)(this,"telemetryCommandingObject",void 0),this.telemetryLatencyObject=null,this.telemetryChatEventObject=null,this.telemetryOfficeJsOperationObject=null,this.telemetryQueryDetailsObject={},this.telemetryLogger=t,this.telemetryMicrophoneObject=null,this.telemetryCommandingObject=null,this.chatHistoryLog={chatHistoryTelemetryInfo:[]}}return Ep(e,[{key:"initTelemetryLatencyObject",value:function(){var e;this.telemetryLatencyObject=(e={},Object.keys(sC).forEach((function(t){e[t]=0})),e),this.chatHistoryLog.chatHistoryTelemetryInfo=[]}},{key:"initTelemetryChatEventObject",value:function(){var e;this.telemetryChatEventObject=(e={},Object.keys(cC).forEach((function(t){e[t]=""})),e)}},{key:"initTelemetryOfficeJSOperationObject",value:function(){var e;this.telemetryOfficeJsOperationObject=(e={},Object.keys(lC).forEach((function(t){e[t]=""})),e)}},{key:"initTelemetryCommandingObject",value:function(){var e;this.telemetryCommandingObject=(e={},Object.keys(wC).forEach((function(t){e[t]=0})),e)}},{key:"updateChatHistoryLog",value:function(e){this.chatHistoryLog.chatHistoryTelemetryInfo.push(e)}},{key:"updateTelemetryLatencyData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null!=this.telemetryLatencyObject&&(Object.keys(e).forEach((function(n){t.telemetryLatencyObject[n]=e[n],t.telemetryQueryDetailsObject[n]=e[n]})),n&&this.sendTelemetryLatencyData(this.telemetryLogger))}},{key:"updateTelemetryOfficeJSOperationData",value:function(e){var t=this;null===this.telemetryOfficeJsOperationObject&&this.initTelemetryOfficeJSOperationObject(),Object.keys(e).forEach((function(n){t.telemetryOfficeJsOperationObject[n]=e[n]})),this.sendTelemetryOfficeJSOperationData(this.telemetryLogger)}},{key:"updateTelemetryChatEventData",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===this.telemetryChatEventObject&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(n){t.telemetryChatEventObject[n]=e[n]})),n&&this.sendTelemetryChatEventData(this.telemetryLogger)}},{key:"updateTelemetryQueryDetailsEventData",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.telemetryQueryDetailsObject[n]=e[n]}))}},{key:"updateTelemetryCommandingData",value:function(e){var t=this;null===this.telemetryCommandingObject&&this.initTelemetryCommandingObject(),Object.keys(e).forEach((function(n){t.telemetryCommandingObject[n]=e[n]})),this.sendTelemetryCommandingData(this.telemetryLogger)}},{key:"sendTelemetryLatencyData",value:function(e){if(!cF(this.telemetryLatencyObject)&&!cF(e)){var t,n=JSON.stringify(this.chatHistoryLog.chatHistoryTelemetryInfo);this.telemetryLatencyObject[sC.CopilotChatHistoryInfoJson]=n,e.logEvent(((t=this.telemetryLatencyObject)[sC.UserQueryGuid]||(t[sC.UserQueryGuid]=ob.getInstance().getQueryGuid()),t[sC.AugloopSessionGuid]=CS,t[sC.ChatPPTSessionId]=zR.getSettingAsString(DR.ChatPPTSessionID),t[sC.IsDevBuild]=TF,{eventType:IC.Latency,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),this.initTelemetryLatencyObject(),this.sendTelemetryQueryDetailsObject(e)}}},{key:"sendTelemetryQueryDetailsObject",value:function(e){var t;cF(e)||cF(this.telemetryQueryDetailsObject)||(e.logEvent(((t=this.telemetryQueryDetailsObject)[kC.UserQueryGuid]||(t[kC.UserQueryGuid]=ob.getInstance().getQueryGuid()),t[kC.HostSDXSessionID]=zR.getSettingAsString(DR.ChatPPTSessionID),t[kC.UserQueryOrder]=qp.EU,t[kC.ALSessionKey]="",t[kC.AugloopSessionGuid]=CS,t[kC.IsDevBuild]=TF,{eventType:IC.QueryDetails,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),this.telemetryQueryDetailsObject={})}},{key:"sendTelemetryOfficeJSOperationData",value:function(e){var t;cF(e)||cF(this.telemetryOfficeJsOperationObject)||(e.logEvent(((t=this.telemetryOfficeJsOperationObject)[lC.UserQueryGuid]||(t[lC.UserQueryGuid]=ob.getInstance().getQueryGuid()),t[lC.ChatPPTSessionId]=zR.getSettingAsString(DR.ChatPPTSessionID),t[lC.UserQueryOrder]=qp.EU,{eventType:IC.OfficeJsOperations,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),this.initTelemetryOfficeJSOperationObject())}},{key:"sendTelemetryChatEventData",value:function(e){if(!cF(e)&&!cF(this.telemetryChatEventObject)){if(e.logEvent(((r=this.telemetryChatEventObject)[cC.UserQueryGuid]||(r[cC.UserQueryGuid]=ob.getInstance().getQueryGuid()),r[cC.ChatPPTSessionId]=zR.getSettingAsString(DR.ChatPPTSessionID),r[cC.UserQueryOrder]=qp.EU,r[cC.ALSessionKey]="",r[cC.IsDevBuild]=TF,{eventType:IC.ChatEvents,eventData:Object.keys(r).map((function(e){return{key:e,value:r[e]}}))})),this.telemetryChatEventObject[cC.ChatEventType]){var t,n=Object.keys(dC)[Object.values(dC).indexOf(this.telemetryChatEventObject[cC.ChatEventType])];this.telemetryQueryDetailsObject[n]=this.telemetryChatEventObject[cC.ChatEventParameters]&&0===(null===(t=this.telemetryChatEventObject[cC.ChatEventParameters])||void 0===t?void 0:t.length)?"true":this.telemetryChatEventObject[cC.ChatEventParameters]}this.initTelemetryChatEventObject()}var r}},{key:"sendTelemetryCommandingData",value:function(e){var t;cF(e)||cF(this.telemetryCommandingObject)||(e.logEvent(((t=this.telemetryCommandingObject)[wC.UserQueryGuid]||(t[wC.UserQueryGuid]=ob.getInstance().getQueryGuid()),t[wC.HostSDXSessionID]=zR.getSettingAsString(DR.ChatPPTSessionID),{eventType:IC.Commanding,eventData:Object.keys(t).map((function(e){return{key:e,value:t[e]}}))})),this.initTelemetryCommandingObject())}}],[{key:"getInstance",value:function(t){return cF(e.telemetryEventHandler)&&(e.telemetryEventHandler=new e(t)),e.telemetryEventHandler}}]),e}();(0,i._)(QS,"telemetryEventHandler",void 0);var JS=n(51199),KS="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",XS=1763,ZS=function(){function e(){Sp(this,e)}return Ep(e,[{key:"sendTelemetryEvent",value:function(e){Office.sendTelemetryEvent(e)}}]),e}(),YS=function(){function e(){Sp(this,e),(0,i._)(this,"oTelLogger",void 0),(0,i._)(this,"telemSink",void 0),this.oTelLogger=new KC.M,this.setupTelemetryLogger(this.oTelLogger)}return Ep(e,[{key:"getDefaultEventFlags",value:function(){return{dataCategories:JS.o.DataCategories.ProductServicePerformance|JS.o.DataCategories.ProductServiceUsage,diagnosticLevel:JS.o.DiagnosticLevel.Optional}}},{key:"logEvent",value:function(e,t){this.logTelemetryEvent(e,t)}},{key:"logError",value:function(e,t){this.logTelemetryErrorEvent(e,t)}},{key:"getTelemetrySink",value:function(){return this.telemSink}},{key:"getTelemetryProperties",value:function(){return{ariaTenantToken:KS,nexusTenantToken:XS}}},{key:"logTelemetryEvent",value:function(e,t){var n={telemetryProperties:{ariaTenantToken:KS,nexusTenantToken:XS},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?Cd({},t,this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)};this.oTelLogger.sendTelemetryEvent(n)}},{key:"logTelemetryErrorEvent",value:function(e,t){var n={eventName:"Office.Voice.ActionAI."+IC.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?Cd({},t,this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"Message",value:e.errorMessage},{key:GC,value:ob.getInstance().getQueryGuid()},{key:"ChatPPTSessionId",value:zR.getSettingAsString(DR.ChatPPTSessionID)},{key:"ALSessionKey",value:""}])};this.oTelLogger.sendError(n)}},{key:"getCopilotDataFields",value:function(e,t){return Ed(EC.TA.getFields({featureActionType:EC.TA.FeatureActionType[e],isUserInitiated:!0,capability:cF(t)?"":EC.TA.Capability[t],featureName:"PPTCopilotChat"})).concat(Ed(this.getDataFields([{key:GC,value:ob.getInstance().getQueryGuid()},{key:"HostSDXSessionId",value:zR.getSettingAsString(DR.ChatPPTSessionID)}])))}},{key:"logSharedTelemetryEvent",value:function(e){if(e.GetEventName()===IC.Error)return this.logSharedErrorEvent(e);var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.GetEventName(),eventFlags:e.IsRequired()?{dataCategories:JS.o.DataCategories.ProductServiceUsage|JS.o.DataCategories.ProductServicePerformance,diagnosticLevel:JS.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:JS.o.SamplingPolicy.CriticalUsage}:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:JS.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logSharedErrorEvent",value:function(e){var t,n={eventName:"Office.Voice.ActionAI."+IC.Error,error:{errorGroup:null===(t=e.GetLogs().find((function(e){return e.name===uC.ErrorCategory})))||void 0===t?void 0:t.value,tag:0},eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?JS.o.SamplingPolicy.CriticalUsage:JS.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendError(n)}},{key:"logSharedTelemetrySTKEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:e.IsRequired()&&!t?{dataCategories:JS.o.DataCategories.ProductServiceUsage|JS.o.DataCategories.ProductServicePerformance,diagnosticLevel:JS.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:JS.o.SamplingPolicy.CriticalUsage}:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?JS.o.SamplingPolicy.CriticalUsage:JS.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendTelemetryEvent(n)}},{key:"getCopilotEventFlags",value:function(){return{dataCategories:JS.o.DataCategories.ProductServiceUsage,diagnosticLevel:JS.o.DiagnosticLevel.RequiredServiceData}}},{key:"logSeenEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(EC.TA.FeatureActionType.IsSeen,e)};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logTriedEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(EC.TA.FeatureActionType.IsTried,e)};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logKeptEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(EC.TA.FeatureActionType.IsKept,e)};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logEnabledEvent",value:function(){var e={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(EC.TA.FeatureActionType.IsEnabled)};this.oTelLogger.sendTelemetryEvent(e)}},{key:"getDataFields",value:function(e){return e.map((function(e){return"number"==typeof e.value?TC.ip(e.key,e.value):"string"==typeof e.value?TC.m9(e.key,e.value):"boolean"==typeof e.value?TC.LK(e.key,e.value):TC.m9(e.key,e.value)}),[])}},{key:"setupTelemetryLogger",value:function(e){e.setTenantToken("Office.Voice.ActionAI",KS,XS),e.setTenantToken("Office.Voice.Copilot",KS,XS),this.telemSink=new ZS,e.addSink(this.telemSink)}}],[{key:"getInstance",value:function(){return cF(e.telemetryLogger)&&(e.telemetryLogger=new e),e.telemetryLogger}}]),e}();(0,i._)(YS,"telemetryLogger",void 0);var $S,eb=n(41148),tb=n(33491),nb=n(54858),rb=n(65065);!function(e){e.Seen="Seen",e.Tried="Tried"}($S||($S={}));var ob=function(e){eC(n,e);var t=aC(n);function n(){var e;return Sp(this,n),e=t.call(this),(0,i._)(Yy(e),"telemetryLatencyObject",void 0),(0,i._)(Yy(e),"telemetryLatencyObjectMap",void 0),(0,i._)(Yy(e),"telemetryChatEventObject",void 0),(0,i._)(Yy(e),"chatHistoryLog",[]),(0,i._)(Yy(e),"telemetryLogger",void 0),(0,i._)(Yy(e),"telemetryLoggerUtils",void 0),(0,i._)(Yy(e),"userQueryGuid",""),(0,i._)(Yy(e),"isFluxEnabled",!1),(0,i._)(Yy(e),"entryPoint",EC.TA.EntryPoint.Chat),(0,i._)(Yy(e),"copilotChatSharedSessionId",""),(0,i._)(Yy(e),"querySubmitTime",0),(0,i._)(Yy(e),"checkPoints",void 0),(0,i._)(Yy(e),"checkPointStartTime",void 0),(0,i._)(Yy(e),"initialHandoffQuery",void 0),(0,i._)(Yy(e),"heldTelemetryEvents",[]),(0,i._)(Yy(e),"heldStkTelemetryEvents",[]),e.telemetryLogger=YS.getInstance(),eb.j.setTelemetryHandler(n.instance),e.telemetryLoggerUtils=eb.j.getInstance(),e.telemetryLatencyObject={},e.telemetryLatencyObjectMap=new Map,e.telemetryChatEventObject={},e.userQueryGuid="",e.querySubmitTime=0,e.checkPoints={},e.checkPointStartTime=0,e.recordCheckPoint(UC.TaskPaneStart,Number(uX)),e.recordCheckPoint(UC.AppLoadStart,Number(dX)),e}return Ep(n,[{key:"getDataFields",value:function(e){return e.map((function(e){return"number"==typeof e.value?TC.ip(e.key,e.value):"string"==typeof e.value?TC.m9(e.key,e.value):"boolean"==typeof e.value?TC.LK(e.key,e.value):TC.m9(e.key,e.value)}),[])}},{key:"getCopilotScorecardData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Iv.CopilotChat,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MC.Unset,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5?arguments[5]:void 0;return i=i.concat(Ed(EC.TA.getFields({featureActionType:e,isUserInitiated:!0,capability:"",verb:cF(o)?rM:EC.TA.Verb[o],featureName:n,entryPoint:EC.TA.EntryPoint.Chat,isThumbsUp:a,subFeatureName:r})).concat(Ed(this.getDataFields([{key:"SpecificFeatureName",value:r}])))),(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!i.some((function(e){return e.name===GC&&e.value}))?i=i.concat(this.getDataFields([{key:GC,value:this.userQueryGuid}])):i.some((function(e){return e.name===GC&&e.value}))||(i=i.concat(this.getDataFields([{key:GC,value:qp.dB}]))),new tb.Q(nb.S2.Chat,nb.lr.Chat,i,n,rM,o,!0,!0,nb.uk.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,nb.PM.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)}},{key:"logSharedTelemetrySTKEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];gX?this.heldStkTelemetryEvents.push({telemetryLog:e,isSeen:t}):this.telemetryLogger.logSharedTelemetrySTKEvent(e,t)}},{key:"releaseHeldTelemetryEvents",value:function(){var e=this;this.heldTelemetryEvents.forEach((function(t){var n=t.eventType,r=t.telemetryData,o=t.entryPoint,i=t.featureName,a=t.capability,s=t.isThumbsUp,l=t.verb,c=t.subFeatureName;"Seen"===n?e.telemetryLoggerUtils.logSeenEvent(r,o,i,a,l,c):"Tried"===n&&e.telemetryLoggerUtils.logTriedEvent(r,o,i,a,s,l,c)})),this.heldStkTelemetryEvents.forEach((function(t){var n=t.telemetryLog,r=t.isSeen;e.telemetryLogger.logSharedTelemetrySTKEvent(n,r)})),this.heldTelemetryEvents=[],this.heldStkTelemetryEvents=[]}},{key:"logSeenEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Iv.CopilotChat,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC.Unset,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((o=o||[]).some((function(e){return e.key===GC&&e.value}))||o.push({key:GC,value:this.userQueryGuid})),gX?this.heldTelemetryEvents.push({eventType:"Seen",telemetryData:o||[],entryPoint:this.entryPoint,featureName:t,capability:void 0,verb:r,subFeatureName:n}):this.telemetryLoggerUtils.logSeenEvent(o||[],this.entryPoint,t,void 0,r,n)}},{key:"logTriedEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Iv.CopilotChat,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC.Unset,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((o=o||[]).some((function(e){return e.key===GC&&e.value}))||o.push({key:GC,value:this.userQueryGuid})),gX?this.heldTelemetryEvents.push({eventType:"Tried",telemetryData:o||[],entryPoint:this.entryPoint,featureName:t,capability:void 0,isThumbsUp:void 0,verb:r,subFeatureName:n}):this.telemetryLoggerUtils.logTriedEvent(o||[],this.entryPoint,t,void 0,void 0,r,n)}},{key:"updateTelemetryOnAnnotationReceived",value:function(e,t,r,o,i,a,s){US(n.instance,e,null!=a?a:this.querySubmitTime,r||void 0,o||void 0,s)}},{key:"logKeptEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Iv.CopilotChat,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC.Unset,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;gX||((null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((o=o||[]).some((function(e){return e.key===GC&&e.value}))||o.push({key:GC,value:this.userQueryGuid})),this.telemetryLoggerUtils.logKeptEvent(o||[],this.entryPoint,t,void 0,void 0,r,n))}},{key:"logFeedbackEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Iv.CopilotChat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:MC.Unset,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;this.LogTelemetryEvent(this.getCopilotScorecardData(rM,t,n,r,(o||[]).length>0?this.getDataFields(o):void 0,e))}},{key:"setQueryGuid",value:function(e){this.userQueryGuid=cF(e)?rM:e}},{key:"getQueryGuid",value:function(){var e;return(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0?this.userQueryGuid:qp.dB}},{key:"setIsFluxEnabled",value:function(e){this.isFluxEnabled=e}},{key:"setCopilotChatSessionId",value:function(e){this.copilotChatSharedSessionId=e}},{key:"getCopilotChatSessionId",value:function(){return this.copilotChatSharedSessionId}},{key:"setQuerySubmitTime",value:function(e){this.querySubmitTime=e}},{key:"getQuerySubmitTime",value:function(){return this.querySubmitTime}},{key:"recordCheckPoint",value:function(e,t){t&&0!==t&&!Number.isNaN(t)||(t=(new Date).getTime()),0===this.checkPointStartTime?(this.checkPointStartTime=t,this.checkPoints[e]=0):this.checkPoints[e]=t-this.checkPointStartTime}},{key:"sendLatencyTelemetryForCheckPoints",value:function(e){var t=JSON.stringify(this.checkPoints);Gp("sendLatencyTelemetryForCheckPoints: ",t),this.sendLatencyTelemetry(HS((0,i._)({},sC.CheckPoints,t)),e)}},{key:"setInitialHandoffQuery",value:function(e){Gp("setInitialHandoffQuery: ",e),this.initialHandoffQuery=e}},{key:"sendHandoffQuerySubmittedEvent",value:function(e){if(this.initialHandoffQuery){e=e.trim();var t=this.initialHandoffQuery.trim(),r=!(e===t||e.includes(t));Gp("Handoff query is submitted. IsModified: "+r),n.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.HandoffQuerySubmittedByUser},{key:cC.ChatEventParameters,value:"".concat(HC.IsModified,":").concat(r)}]),this.initialHandoffQuery=void 0}}},{key:"sendChatEventTelemetry",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===GC&&e.value}))&&e.push({key:cC.UserQueryGuid,value:this.userQueryGuid}),this.telemetryLoggerUtils.sendTelemetryChatEventData(e,n)}},{key:"sendLatencyTelemetry",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===GC&&e.value}))&&e.push({key:cC.UserQueryGuid,value:this.userQueryGuid}),this.telemetryLoggerUtils.sendTelemetryLatencyData(e,n)}},{key:"sendErrorTelemetry",value:function(e){var t;(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===GC&&e.value}))&&e.push({key:cC.UserQueryGuid,value:this.userQueryGuid}),this.telemetryLoggerUtils.sendTelemetryErrorData(e)}},{key:"sendLatencyTelemetryForNotifications",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((null==t?void 0:t.length)>0){var r=e.findIndex((function(e){return e.key===GC}));-1===r?e.push({key:cC.UserQueryGuid,value:t}):e[r].value=t}this.telemetryLoggerUtils.sendTelemetryLatencyDataForNotification(e,n)}},{key:"logAshaErrorEvent",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Iv.CopilotChat,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(null===(n=this.userQueryGuid)||void 0===n?void 0:n.length)>0&&!i.some((function(e){return e.key===GC&&e.value}))&&i.push({key:GC,value:this.userQueryGuid}),void 0!==r&&i.push({key:"AshaScenarioName",value:r}),this.telemetryLoggerUtils.logErrorWithAshaVetoAndError(i,r,"",e,t,o)}},{key:"logAshaEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!n.some((function(e){return e.key===GC&&e.value}))&&n.push({key:GC,value:this.userQueryGuid}),this.telemetryLoggerUtils.logEventWithAshaPillar(n,"","",e)}},{key:"LogTelemetryEvent",value:function(e){var t=this;switch(e.GetEventName()){case nb.lr.ChatEvents:if(!e.GetShouldLog()){var n=!0,r=!1,o=void 0;try{for(var i,a=e.GetLogs()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.name!==cC.UserQueryGuid&&(this.telemetryChatEventObject[s.name]=s.value)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}break}e.SetIsRequired(!0),e.SetLogs(Ed(e.GetLogs()).concat(Ed(this.getDataFields([{key:cC.ChatPPTSessionId,value:zR.getSettingAsString(DR.ChatPPTSessionID)},{key:cC.IsDevBuild,value:TF},{key:cC.CopilotChatSessionId,value:this.copilotChatSharedSessionId}].concat(Ed(Object.keys(this.telemetryChatEventObject).map((function(e){return{key:e,value:t.telemetryChatEventObject[e]}})))))))),this.telemetryLogger.logSharedTelemetryEvent(e),this.telemetryChatEventObject={};break;case nb.lr.Chat:if(!e.GetShouldLog())break;e.SetIsRequired(!0),Jh(Dh.IsInitiatorViewTelemetryFieldAdded)&&zR.getSettingAsString(DR.InitiatorView)&&e.SetLogs(Ed(e.GetLogs()).concat(Ed(this.getDataFields([{key:BC.InitiatorView,value:zR.getSettingAsString(DR.InitiatorView)}])))),this.logSharedTelemetrySTKEvent(e,e.GetLogs().some((function(e){return"Copilot.FeatureActionType"===e.name&&e.value===EC.TA.FeatureActionType.IsSeen})));break;case nb.lr.Latency:e.GetEventType()===nb.S2.Latency?this.logLatencyForEventTypeLatency(e):e.GetEventType()===nb.S2.NotificationLatency&&this.logLatencyForEventTypeNotificationLatency(e);break;case nb.lr.Error:if(!e.GetShouldLog())break;e.SetLogs(Ed(e.GetLogs()).concat(Ed(this.getDataFields([{key:cC.ChatPPTSessionId,value:zR.getSettingAsString(DR.ChatPPTSessionID)},{key:cC.IsDevBuild,value:TF}])))),this.telemetryLogger.logSharedErrorEvent(e);break;case nb.lr.AshaError:if(!e.GetShouldLog())break;e.SetIsRequired(!0),this.logSharedTelemetrySTKEvent(e)}}},{key:"logLatencyForEventTypeLatency",value:function(e){var t=this;if(e.GetShouldLog()){e.SetIsRequired(!0);var n=[{key:sC.ChatPPTSessionId,value:zR.getSettingAsString(DR.ChatPPTSessionID)},{key:sC.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryLog)},{key:sC.IsDevBuild,value:TF},{key:sC.IsFluxEnabled,value:this.isFluxEnabled},{key:sC.CopilotChatSessionId,value:this.copilotChatSharedSessionId}];Xh()?e.SetLogs(Ed(this.getDataFields(Ed(Object.keys(this.telemetryLatencyObject).map((function(e){return{key:e,value:t.telemetryLatencyObject[e]}}))).concat(Ed(n)))).concat(Ed(e.GetLogs().filter((function(e){return e.name!==sC.CopilotChatHistoryInfoJson}))))):e.SetLogs(Ed(e.GetLogs().filter((function(e){return e.name!==sC.CopilotChatHistoryInfoJson}))).concat(Ed(this.getDataFields(Ed(n).concat(Ed(Object.keys(this.telemetryLatencyObject).map((function(e){return{key:e,value:t.telemetryLatencyObject[e]}})))))))),Jh(Dh.ShouldAddFeatureNameInLatencyTableIfEmpty)&&!e.GetLogs().some((function(e){return e.name==sC.FeatureName&&!!e.value}))&&e.SetLogs(Ed(e.GetLogs()).concat(Ed(this.getDataFields([{key:sC.FeatureName,value:_C.CopilotChat}])))),this.telemetryLogger.logSharedTelemetryEvent(e),this.chatHistoryLog=[],this.telemetryLatencyObject={},this.userQueryGuid="",this.querySubmitTime=0}else{var r=!0,o=!1,i=void 0;try{for(var a,s=e.GetLogs()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;l.name===sC.CopilotChatHistoryInfoJson?this.chatHistoryLog=this.chatHistoryLog.concat(JSON.parse(l.value)):l.name!==cC.UserQueryGuid&&(this.telemetryLatencyObject[l.name]=l.value)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}}},{key:"logLatencyForEventTypeNotificationLatency",value:function(e){var t="";if(e.GetShouldLog()){var n=!0,r=!1,o=void 0;try{for(var i,a=e.GetLogs()[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;s.name===cC.UserQueryGuid&&(t=s.value)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}e.SetIsRequired(!0);var l,c=[{key:sC.ChatPPTSessionId,value:zR.getSettingAsString(DR.ChatPPTSessionID)},{key:sC.IsDevBuild,value:TF},{key:sC.IsFluxEnabled,value:this.isFluxEnabled},{key:sC.CopilotChatSessionId,value:this.copilotChatSharedSessionId}],u=null!==(l=this.telemetryLatencyObjectMap.get(t))&&void 0!==l?l:{};e.SetLogs(Ed(this.getDataFields(Ed(Object.keys(u).map((function(e){return{key:e,value:u[e]}}))).concat(Ed(c)))).concat(Ed(e.GetLogs()))),Jh(Dh.ShouldAddFeatureNameInLatencyTableIfEmpty)&&!e.GetLogs().some((function(e){return e.name==sC.FeatureName&&!!e.value}))&&e.SetLogs(Ed(e.GetLogs()).concat(Ed(this.getDataFields([{key:sC.FeatureName,value:_C.CopilotChat}])))),this.telemetryLogger.logSharedTelemetryEvent(e),this.telemetryLatencyObjectMap.delete(t)}else{var d=!0,p=!1,g=void 0;try{for(var m,f=e.GetLogs()[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var h=m.value;h.name===cC.UserQueryGuid&&(t=h.value)}}catch(e){p=!0,g=e}finally{try{d||null==f.return||f.return()}finally{if(p)throw g}}this.telemetryLatencyObjectMap.has(t)||this.telemetryLatencyObjectMap.set(t,{});var v=!0,y=!1,C=void 0;try{for(var S,b=e.GetLogs()[Symbol.iterator]();!(v=(S=b.next()).done);v=!0){var E=S.value;this.telemetryLatencyObjectMap.get(t)[E.name]=E.value}}catch(e){y=!0,C=e}finally{try{v||null==b.return||b.return()}finally{if(y)throw C}}}}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),eb.j.setTelemetryHandler(n.instance),n.instance}}]),n}(rb.M);(0,i._)(ob,"instance",void 0);var ib=function(){function e(){Sp(this,e),(0,i._)(this,"lastSlideCountUpdateTime",-1),(0,i._)(this,"lastHasSectionUpdateTime",-1),(0,i._)(this,"documentState",{isCreateNew:!1,isDocDirty:!1,isIrm:!1,slideCount:0,hasSection:!1,themeId:"",isCreateNewFromBlank:!1}),(0,i._)(this,"cachedDocumentState",{isCreateNew:!1,isDocDirty:!1,isIrm:!1,slideCount:0,hasSection:!1,themeId:"",isCreateNewFromBlank:!1}),this.documentState.isDocDirty=!1,this.documentState.isIrm=!1,this.documentState.isCreateNew=!1,this.documentState.slideCount=0,this.documentState.hasSection=!1,this.documentState.themeId="",this.documentState.isCreateNewFromBlank=!1,this.cachedDocumentState.isDocDirty=!1,this.cachedDocumentState.isIrm=!1,this.cachedDocumentState.isCreateNew=!1,this.cachedDocumentState.slideCount=0,this.cachedDocumentState.hasSection=!1,this.cachedDocumentState.themeId="",this.cachedDocumentState.isCreateNewFromBlank=!1}return Ep(e,[{key:"powerpointDocumentStateAnnotationProcessor",value:function(e,t){var n=e.body;this.documentState.isDocDirty=null==n?void 0:n.isDocDirty,this.documentState.isIrm=null==n?void 0:n.isIrm,this.documentState.isCreateNew=null==n?void 0:n.isCreateNew;var r=this.documentState.slideCount;this.documentState.slideCount=null==n?void 0:n.slideCount,this.documentState.slideCount!==r&&(this.lastSlideCountUpdateTime=Date.now());var o=this.documentState.hasSection;this.documentState.hasSection=null==n?void 0:n.hasSection,this.documentState.hasSection!==o&&(this.lastHasSectionUpdateTime=Date.now()),this.documentState.themeId=null==n?void 0:n.themeId,this.documentState.isCreateNewFromBlank=(null==n?void 0:n.isCreateNewFromBlank)||!1,this.documentState.latestDownloadUrl=null==n?void 0:n.latestDownloadUrl,ob.getInstance().sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.DocumentStateReceived))),t(),ZR("Document state received from Document State Powerpoint Workflow ".concat(JSON.stringify(this.documentState)))}},{key:"getDocumentState",value:function(){return this.documentState}},{key:"setDocumentState",value:function(e){this.documentState.isDocDirty=e.isDocDirty,this.documentState.isIrm=e.isIrm,this.documentState.isCreateNew=e.isCreateNew,this.documentState.slideCount=e.slideCount,this.documentState.hasSection=e.hasSection,this.documentState.themeId=e.themeId,this.documentState.isCreateNewFromBlank=e.isCreateNewFromBlank,this.documentState.latestDownloadUrl=e.latestDownloadUrl}},{key:"getCachedDocumentState",value:function(){return this.cachedDocumentState}},{key:"setCachedDocumentState",value:function(){this.cachedDocumentState.isDocDirty=this.documentState.isDocDirty,this.cachedDocumentState.isIrm=this.documentState.isIrm,this.cachedDocumentState.isCreateNew=this.documentState.isCreateNew,this.cachedDocumentState.slideCount=this.documentState.slideCount,this.cachedDocumentState.hasSection=this.documentState.hasSection,this.cachedDocumentState.themeId=this.documentState.themeId,this.cachedDocumentState.isCreateNewFromBlank=this.documentState.isCreateNewFromBlank,this.cachedDocumentState.latestDownloadUrl=this.documentState.latestDownloadUrl}},{key:"getSlideCount",value:function(){return this.documentState.slideCount}},{key:"getLastSlideCountUpdateTime",value:function(){return this.lastSlideCountUpdateTime}},{key:"getLastHasSectionUpdateTime",value:function(){return this.lastHasSectionUpdateTime}},{key:"isCreatePresentationEnabled",value:function(){return!(!this.documentState.isCreateNew||this.documentState.isIrm||this.documentState.isDocDirty)}},{key:"isCreatePresentationEnabledCached",value:function(){return!(!this.cachedDocumentState.isCreateNew||this.cachedDocumentState.isIrm||this.cachedDocumentState.isDocDirty)}},{key:"isDocumentIrm",value:function(){return!!this.documentState.isIrm}},{key:"isDocumentIrmCached",value:function(){return!!this.cachedDocumentState.isIrm}},{key:"getSlideCountCached",value:function(){return this.cachedDocumentState.slideCount}},{key:"isCreateNewFromBlank",value:function(){return this.documentState.isCreateNewFromBlank}}],[{key:"getInstance",value:function(){return cF(e.documentStateHandler)&&(e.documentStateHandler=new e),e.documentStateHandler}}]),e}();(0,i._)(ib,"documentStateHandler",void 0);var ab=YS.getInstance(),sb=(QS.getInstance(ab),function(){function e(){Sp(this,e),(0,i._)(this,"scenarioName",void 0),(0,i._)(this,"ashaErrorString",void 0),(0,i._)(this,"ashaVetoString",void 0),(0,i._)(this,"responseTime",void 0),(0,i._)(this,"userQueryGuid",void 0),(0,i._)(this,"startTime",void 0),(0,i._)(this,"scenarioErrors",void 0),(0,i._)(this,"timeToIntentDetection",void 0),(0,i._)(this,"timeToIntentDetectionOverTheWireTime",void 0),(0,i._)(this,"telemetryHandler",void 0),this.scenarioName=Cv.Unset,this.responseTime=0,this.userQueryGuid="",this.scenarioErrors=[],this.ashaErrorString=NC.Unset,this.ashaVetoString=AC.Unset}return Ep(e,[{key:"resetData",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scenarioName=Cv.Unset,this.responseTime=0,this.userQueryGuid="",this.scenarioErrors=[],e&&(this.ashaErrorString=NC.Unset,this.ashaVetoString=AC.Unset)}},{key:"setUserQueryGuid",value:function(e){this.userQueryGuid!==e&&(this.resetData(),this.userQueryGuid=e,ZR("ScenarioOptionsManager userQueryGuid set: ".concat(e)))}},{key:"getUserQueryGuid",value:function(){return this.userQueryGuid}},{key:"setAshaErrorString",value:function(e){this.ashaErrorString=e}},{key:"getAshaErrorString",value:function(){return this.ashaErrorString}},{key:"setAshaVetoString",value:function(e){this.ashaVetoString=e}},{key:"getAshaVetoString",value:function(){return this.ashaVetoString}},{key:"addScenarioError",value:function(e){ZR("Scenario error added: ".concat(e)),this.scenarioErrors.push(e)}},{key:"getScenarioErrors",value:function(){return this.scenarioErrors}},{key:"setTelemetryHandler",value:function(e){this.telemetryHandler=e}},{key:"setScenarioName",value:function(e){var t,n,r;this.scenarioName!==e&&(null===(t=this.telemetryHandler)||void 0===t||t.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.ChatIntentDetected),(0,i._)(r,cC.ChatEventParameters,e),r))),ZR("Scenario name set: ".concat(e)),this.scenarioName=e,null===(n=this.telemetryHandler)||void 0===n||n.sendLatencyTelemetry(HS((0,i._)({},sC.FeatureName,this.getFeatureName()))))}},{key:"getScenarioName",value:function(){return this.scenarioName}},{key:"setResponseTime",value:function(e){this.responseTime=e}},{key:"getResponseTime",value:function(){return this.responseTime}},{key:"setTimeToIntentDetection",value:function(e){this.timeToIntentDetection=e}},{key:"getTimeToIntentDetection",value:function(){return this.timeToIntentDetection}},{key:"setTimeToIntentDetectionOverTheWireTime",value:function(e){this.timeToIntentDetectionOverTheWireTime=e}},{key:"getTimeToIntentDetectionOverTheWireTime",value:function(){return this.timeToIntentDetectionOverTheWireTime}},{key:"setStartTime",value:function(e){this.startTime=e}},{key:"getStartTime",value:function(){return this.startTime}},{key:"getCapability",value:function(){switch(this.scenarioName){case Cv.Organize:case Cv.Beautify:case Cv.Animate:case Cv.FormatText:case Cv.FormatShape:case Cv.ReplaceText:case Cv.SetFooters:case Cv.SlideTransition:case Cv.HideSlide:case Cv.PresentationRecommendation:return EC.TA.Capability.Commanding;case Cv.Summary:case Cv.BasicChat:return EC.TA.Capability.QAandSummaries;default:return EC.TA.Capability.ContentGeneration}}},{key:"getFeatureName",value:function(){switch(this.scenarioName){case Cv.CreatePresentation:case Cv.CreatePresentationFromDoc:return Iv.CreatePresentation;case Cv.AddSlide:case Cv.InsertImage:return Iv.AddContent;case Cv.InsertImageDesignerMini:return Iv.DesignerVisuals;case Cv.Organize:return Iv.Organize;case Cv.Beautify:case Cv.Animate:case Cv.FormatText:case Cv.FormatShape:case Cv.ReplaceText:case Cv.SetFooters:case Cv.SlideTransition:case Cv.HideSlide:case Cv.PresentationRecommendation:return Iv.BasicCommand;case Cv.Summary:return Iv.Summarize;case Cv.BasicChat:return Iv.ChatQnA;default:return Iv.CopilotChat}}},{key:"getSubFeatureName",value:function(){switch(this.scenarioName){case Cv.CreatePresentation:return _v.CreateAPresentation;case Cv.CreatePresentationFromDoc:return _v.CreateAPresentationFromFile;case Cv.AddSlide:return _v.AddASlide;case Cv.InsertImage:return _v.AddAnImage;case Cv.InsertImageDesignerMini:return _v.AddDesignerImage;case Cv.Organize:return _v.OrganizePresentation;case Cv.Beautify:case Cv.PresentationRecommendation:return _v.DesignPresentation;case Cv.Animate:return _v.AnimateSlides;case Cv.Summary:return _v.SummarizePresentation;case Cv.PresentationRecommendation:return _v.ProactiveRecommendation;default:return _v.Unset}}}],[{key:"getInstance",value:function(){return cF(e.scenarioOptionsManager)&&(e.scenarioOptionsManager=new e),e.scenarioOptionsManager}}]),e}());(0,i._)(sb,"scenarioOptionsManager",void 0);var lb,cb,ub,db,pb,gb=ob.getInstance(),mb=function(){function e(){Sp(this,e),(0,i._)(this,"contextIdList",void 0),(0,i._)(this,"cleanupCallback",void 0),this.contextIdList=new Set,this.cleanupCallback=new Set}return Ep(e,[{key:"addContextId",value:function(e){this.contextIdList.add(e)}},{key:"removeContextId",value:function(e){this.contextIdList.delete(e)}},{key:"isValidAnnotationResponse",value:function(e){var t,n=this.contextIdList.has(e);Jh(Dh.IsExtraStopGenLogEnabled)&&gb.sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.IsContextIDValid),(0,i._)(t,cC.ChatEventParameters,n),(0,i._)(t,cC.UserQueryGuid,(null==e?void 0:e.toString())||""),t)));return n}},{key:"emptyContextIdListandCleanup",value:function(){this.contextIdList.clear(),Jh(Dh.IsExtraStopGenLogEnabled)&&gb.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.ContextIDListEmptied}]),this.cleanupCallback.forEach((function(e){return e()}))}},{key:"addHandlerCleanup",value:function(e){this.cleanupCallback.add(e)}},{key:"isRequestPending",value:function(){return this.contextIdList.size>0}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(mb,"instance",void 0);class fb{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(fb,this,e)}static getTypeName(){return"AugLoop_ContentProcessing_ContentProcessingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[fb.getTypeName()])}}fb.H_={T_:fb.getTypeName(),B_:fb.getBaseTypes()};class hb{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(hb,this,e)}static getTypeName(){return"AugLoop_ContentProcessing_ContentProcessingProgressAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[hb.getTypeName()])}}hb.H_={T_:hb.getTypeName(),B_:hb.getBaseTypes()};class vb{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(vb,this,e)}static getTypeName(){return"AugLoop_ContentProcessing_TransformToPPTAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[vb.getTypeName()])}}vb.H_={T_:vb.getTypeName(),B_:vb.getBaseTypes()},function(e){e.DocumentDownloadFailed="DocumentDownloadFailed",e.Error="Error",e.SegmentationError="SegmentationError",e.Unauthorized="Unauthorized",e.InvalidInput="InvalidInput",e.DocumentTooLarge="DocumentTooLarge",e.DocumentIrmProtected="DocumentIrmProtected",e.DocumentNotFound="DocumentNotFound",e.ContentTooShort="ContentTooShort",e.Consumer="Consumer",e.UnsupportedFileType="UnsupportedFileType",e.Encrypted="Encrypted",e.FailedToGetSensitivityLabels="FailedToGetSensitivityLabels",e.UserTokenUnavailable="UserTokenUnavailable",e.CopilotLicensingError="CopilotLicensingError",e.Timeout="Timeout"}(lb||(lb={})),function(e){e.DocumentDownloadStart="DocumentDownloadStart",e.SegmentationStart="SegmentationStart",e.SlideOutlineGenerated="SlideOutlineGenerated",e.SlideOutlineStreaming="SlideOutlineStreaming",e.SlideOutlineStreamingCompleted="SlideOutlineStreamingCompleted"}(cb||(cb={})),function(e){e.Web="web",e.Pdf="pdf",e.Html="html",e.Mhtml="mhtml",e.FileUrl="fileurl",e.FileBinary="filebinary",e.INode="inode"}(ub||(ub={})),function(e){e.Doc2PPT="Doc2PPT",e.KeyHighlight="KeyHighlight"}(db||(db={})),function(e){e[e.NoError=0]="NoError",e[e.DocumentRetrievalFailureAccessDenied=1]="DocumentRetrievalFailureAccessDenied",e[e.DocumentRetrievalFailureNotFound=2]="DocumentRetrievalFailureNotFound",e[e.DocumentRetrievalFailureUnknownFailure=3]="DocumentRetrievalFailureUnknownFailure",e[e.DocumentParsingFailureMalformedDocument=4]="DocumentParsingFailureMalformedDocument",e[e.DocumentParsingFailureUnknownFailure=5]="DocumentParsingFailureUnknownFailure",e[e.InputDataFailureDocumentKeyInvalid=6]="InputDataFailureDocumentKeyInvalid",e[e.DocumentPackagingFailureTimeout=7]="DocumentPackagingFailureTimeout",e[e.DocumentParsingFailureDocumentTooBig=8]="DocumentParsingFailureDocumentTooBig",e[e.InputDataFailureUnknownDocumentType=9]="InputDataFailureUnknownDocumentType",e[e.InputDataFailureDocumentURLEmpty=10]="InputDataFailureDocumentURLEmpty",e[e.InputDataFailureInvalidDocumentType=11]="InputDataFailureInvalidDocumentType",e[e.InputDataFailureUnableToGenerateToken=12]="InputDataFailureUnableToGenerateToken",e[e.DocumentParsingFailureAllObjectsFailExtraction=13]="DocumentParsingFailureAllObjectsFailExtraction",e[e.DocumentParsingFailureAllObjectsTooBig=14]="DocumentParsingFailureAllObjectsTooBig",e[e.DocumentConversionFailurePdfToDocConversionError=15]="DocumentConversionFailurePdfToDocConversionError",e[e.DocumentConversionFailureDocumentIsIRMProtected=16]="DocumentConversionFailureDocumentIsIRMProtected",e[e.DocumentConversionFailureUnknownHtmlConversionError=17]="DocumentConversionFailureUnknownHtmlConversionError",e[e.DocumentConversionFailureUnknownConversionError=18]="DocumentConversionFailureUnknownConversionError",e[e.Timeout=19]="Timeout",e[e.InputDataFailureDocumentURLInvalid=20]="InputDataFailureDocumentURLInvalid",e[e.InputDataFailureDocumentStreamEmpty=21]="InputDataFailureDocumentStreamEmpty",e[e.OtherError=22]="OtherError",e[e.DocumentConversionFailureDocumentIsEncrypted=23]="DocumentConversionFailureDocumentIsEncrypted",e[e.DocumentUrlConversionFailure=24]="DocumentUrlConversionFailure",e[e.AppIdDoesNotHaveDecryptedFileAccess=25]="AppIdDoesNotHaveDecryptedFileAccess",e[e.ScenarioDoesNotHaveDecryptedFileAccess=26]="ScenarioDoesNotHaveDecryptedFileAccess",e[e.UserDoesNotHaveAccessToFile=27]="UserDoesNotHaveAccessToFile",e[e.CheckUserAccessInternalFailure=28]="CheckUserAccessInternalFailure",e[e.DocumentHasUDPLabel=29]="DocumentHasUDPLabel",e[e.DocumentHasUnsupportedLabelType=30]="DocumentHasUnsupportedLabelType",e[e.DocumentHasOtherExpectedProtection=31]="DocumentHasOtherExpectedProtection",e[e.DocumentIsPasswordProtected=32]="DocumentIsPasswordProtected",e[e.UserHasNoRightsInLabel=33]="UserHasNoRightsInLabel",e[e.UserHasNoExtractRightsInLabel=34]="UserHasNoExtractRightsInLabel",e[e.DocumentIsIRMProtected=35]="DocumentIsIRMProtected",e[e.DocumentConversionFailureMHTMLConversionNotSupported=36]="DocumentConversionFailureMHTMLConversionNotSupported"}(pb||(pb={}));pb.NoError,pb.DocumentRetrievalFailureAccessDenied,pb.DocumentRetrievalFailureNotFound,pb.DocumentRetrievalFailureUnknownFailure,pb.DocumentParsingFailureMalformedDocument,pb.DocumentParsingFailureUnknownFailure,pb.InputDataFailureDocumentKeyInvalid,pb.DocumentPackagingFailureTimeout,pb.DocumentParsingFailureDocumentTooBig,pb.InputDataFailureUnknownDocumentType,pb.InputDataFailureDocumentURLEmpty,pb.InputDataFailureInvalidDocumentType,pb.InputDataFailureUnableToGenerateToken,pb.DocumentParsingFailureAllObjectsFailExtraction,pb.DocumentParsingFailureAllObjectsTooBig,pb.DocumentConversionFailurePdfToDocConversionError,pb.DocumentConversionFailureDocumentIsIRMProtected,pb.DocumentConversionFailureUnknownHtmlConversionError,pb.DocumentConversionFailureUnknownConversionError,pb.Timeout,pb.InputDataFailureDocumentURLInvalid,pb.InputDataFailureDocumentStreamEmpty,pb.OtherError,pb.DocumentConversionFailureDocumentIsEncrypted,pb.DocumentUrlConversionFailure,pb.AppIdDoesNotHaveDecryptedFileAccess,pb.ScenarioDoesNotHaveDecryptedFileAccess,pb.UserDoesNotHaveAccessToFile,pb.CheckUserAccessInternalFailure,pb.DocumentHasUDPLabel,pb.DocumentHasUnsupportedLabelType,pb.DocumentHasOtherExpectedProtection,pb.DocumentIsPasswordProtected,pb.UserHasNoRightsInLabel,pb.UserHasNoExtractRightsInLabel,pb.DocumentIsIRMProtected,pb.DocumentConversionFailureMHTMLConversionNotSupported;class yb{constructor(e){Qp.h.assign(yb,this,e)}static getTypeName(){return"AugLoop_ContentProcessing_ContentProcessingSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[yb.getTypeName()])}}yb.H_={T_:yb.getTypeName(),B_:yb.getBaseTypes()};class Cb{constructor(e){Qp.h.assign(Cb,this,e)}static getTypeName(){return"AugLoop_ContentProcessing_TransformToPPTSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Cb.getTypeName()])}}Cb.H_={T_:Cb.getTypeName(),B_:Cb.getBaseTypes()};var Sb=function(){function e(){if(Sp(this,e),(0,i._)(this,"chatRef",void 0),e._instance)throw new Error("Error: Instantiation failed: Use CopilotChatRefSingleton.getInstance() instead of new.");e._instance=this}return Ep(e,[{key:"getChatRef",value:function(){return this.chatRef}},{key:"setChatRef",value:function(e){this.chatRef=e}}],[{key:"getInstance",value:function(){return e._instance}}]),e}();(0,i._)(Sb,"_instance",new Sb);var bb=null,Eb=(0,dg.A)(),Tb=function(){function e(){Sp(this,e),(0,i._)(this,"setBasicChatProps",void 0),(0,i._)(this,"inDocLabelInfo",{labelId:rM,tenantId:rM}),(0,i._)(this,"externalDocLabelInfo",{labelId:rM,tenantId:rM}),this.inDocLabelInfo.labelId=rM,this.inDocLabelInfo.tenantId=rM,this.externalDocLabelInfo.labelId=rM,this.externalDocLabelInfo.tenantId=rM}return Ep(e,[{key:"setInDocSensitiveLabelInfoUsingOfcJs",value:function(){var t=this;return(0,gd._)((function(){var n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.setInDocSensitiveLabelInfoUsingOfcJs()];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return n=o.sent(),t.setInDocSensitivityLabelInfo(n),WS("getLabel"),[3,4];case 3:return r=o.sent(),qS("error in getLabel Api : ".concat(r.message)),r.code!==vf&&jS("getLabel"),ZR("Error while fetching In Doc sensitivity label: ".concat(r.message)),[3,4];case 4:return[2]}}))}))()}},{key:"getInDocSensitiveLabelUsingOfcJs",value:function(){return(0,gd._)((function(){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.getInDocSensitiveLabelUsingOfcJs()];ZR("Getting label"),t={labelId:rM,tenantId:rM},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return t=r.sent(),WS("getLabel"),[3,4];case 3:return n=r.sent(),qS("error in getLabel Api : ".concat(n.message)),n.code!==vf&&jS("getLabel"),ZR("Error while fetching In Doc sensitivity label: ".concat(n.message)),[3,4];case 4:return ZR("Label is : ",t),[2,t]}}))}))()}},{key:"setInDocSensitivityLabelInfo",value:function(t){var n=this;if(e.clpSensitivityHandlerSharedInstance)return e.clpSensitivityHandlerSharedInstance.setInDocSensitivityLabelInfo(t);ZR("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(t))),this.inDocLabelInfo.version=t.version,this.inDocLabelInfo.labelId=t.labelId,this.inDocLabelInfo.tenantId=t.tenantId,this.inDocLabelInfo.isEnabled=t.isEnabled,this.inDocLabelInfo.encryptionType=t.encryptionType,this.inDocLabelInfo.isDke=t.isDke,this.inDocLabelInfo.hasExtractForUser=t.hasExtractForUser,this.inDocLabelInfo.order=t.order,this.inDocLabelInfo.displayName=t.displayName,this.inDocLabelInfo.description=t.description,this.inDocLabelInfo.parentName=t.parentName,this.inDocLabelInfo.color=t.color,this.setBasicChatProps&&this.setBasicChatProps((function(e){var r,o;return Sd(Cd({},e),{sensitivityIndicatorData:n.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(r=t.description)&&void 0!==r?r:"",badgeText:null!==(o=t.displayName)&&void 0!==o?o:"",iconType:t.encryptionType!==Tp.None?uf.JF.Encryption:uf.JF.NonEncryption}:void 0})}))}},{key:"upgradeSensitivityLabelUsingOfcJs",value:function(t){var n=this;return(0,gd._)((function(){var r,o,i,a,s,l,c;return(0,F.__generator)(this,(function(u){switch(u.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.upgradeSensitivityLabelUsingOfcJs(t)];if(WS("tryUpgradeLabel"),r=Ip[Ip.S_APPLYLABEL_OK],(o=Vh(Lh.IsEmptyLabelFixForCLPv2FeatureEnabled))&&!(null==t?void 0:t.labelId))return[2,{status:r,errorMessage:rM}];u.label=1;case 1:return u.trys.push([1,7,,8]),o||n.inDocLabelInfo.tenantId!==t.tenantId||n.inDocLabelInfo.labelId!==t.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(t,Eb)];case 2:return u.sent(),[2,{status:Ip[Ip.S_APPLYLABEL_OK]}];case 3:return Jh(Dh.IsNoopOnSameSensitivityLabel)&&n.inDocLabelInfo.labelId===t.labelId?[2,{status:r,errorMessage:rM}]:[3,4];case 4:return i=function(){var e=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(t,Eb)]}catch(e){qS("error while calling tryUpgradeLabel() Api : ".concat(e.message)),jS("tryUpgradeLabel"),ZR("Error while upgrading sensitivity label: ".concat(e.message)),r=e.message}return[2]}))}));return function(){return e.apply(this,arguments)}}(),a=new Promise((function(e){bb=e})),s=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([a,i()]),s])];case 5:u.sent(),u.label=6;case 6:return[3,8];case 7:return l=u.sent(),qS("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(l.message)),"CallbackTimeout"===l.message?ZR("Callback Timeout"):ZR("Exception while upgrading sensitivity label: ".concat(l.message)),r=null!==(c=Ip[l.message])&&void 0!==c?c:l.message,[3,8];case 8:return bb=null,[2,{status:r,errorMessage:r}]}}))}))()}},{key:"setLabelChangeEventListener",value:function(){if(e.clpSensitivityHandlerSharedInstance)return e.clpSensitivityHandlerSharedInstance.setLabelChangeEventListener();try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(Ib),WS("Label Change Event Listener"),ZR("Sensitivity Label Change Event Listener Set")}catch(e){qS("error in setting listener for CLP : ".concat(e.message)),jS("onLabelChangedEvent"),ZR("Error while setting sensitivity label change event listener: ".concat(e.message))}}},{key:"updateExternalDocSensitivityLabelUsingOfsJs",value:function(t){var n=this;return(0,gd._)((function(){var r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.updateExternalDocSensitivityLabelUsingOfsJs(t)];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(t)];case 2:return r=i.sent(),ZR("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(r))),n.setExternalDocSensitivityLabelInfo(r),WS("External Doc HighestSensitivityLabel"),[3,4];case 3:return o=i.sent(),qS("error in HighestSensitivityLabel Api : ".concat(o.message)),o.code!==vf&&jS("External Doc HighestSensitivityLabel"),ZR("Error while updating external doc sensitivity label: ".concat(o.message)),[3,4];case 4:return[2]}}))}))()}},{key:"getHighestDocumentSensitivityInfo",value:function(t){return(0,gd._)((function(){var n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:if(e.clpSensitivityHandlerSharedInstance)return[2,e.clpSensitivityHandlerSharedInstance.getHighestDocumentSensitivityInfo(t)];n={labelId:rM,tenantId:rM},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(t)];case 2:return n=o.sent(),ZR("Sensitivity info fetched for label ".concat(JSON.stringify(t),": ").concat(JSON.stringify(n))),WS("HighestSensitivityLabel"),[3,4];case 3:return r=o.sent(),qS("error in HighestSensitivityLabel Api : ".concat(r.message)),r.code!==vf&&jS("HighestSensitivityLabel"),ZR("Error while fetching highest sensitivity label: ".concat(r.message)),[3,4];case 4:return[2,n]}}))}))()}},{key:"setSensitivityLabelToHighestSensitivity",value:function(t){var n=this;return(0,gd._)((function(){var r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return e.clpSensitivityHandlerSharedInstance?[2,e.clpSensitivityHandlerSharedInstance.setSensitivityLabelToHighestSensitivity(t)]:[4,n.getHighestDocumentSensitivityInfo(t)];case 1:return r=o.sent(),n.setInDocSensitivityLabelInfo(r),[2]}}))}))()}},{key:"getSensitivity",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.getSensitivity():{id:this.inDocLabelInfo.labelId,displayName:null!==(t=this.inDocLabelInfo.displayName)&&void 0!==t?t:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==Tp.None,priority:null!==(n=this.inDocLabelInfo.order)&&void 0!==n?n:0};var t,n}},{key:"setExternalDocSensitivityLabelInfo",value:function(t){if(e.clpSensitivityHandlerSharedInstance)return e.clpSensitivityHandlerSharedInstance.setExternalDocSensitivityLabelInfo(t);ZR("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(t))),this.externalDocLabelInfo.version=t.version,this.externalDocLabelInfo.labelId=t.labelId,this.externalDocLabelInfo.tenantId=t.tenantId,this.externalDocLabelInfo.isEnabled=t.isEnabled,this.externalDocLabelInfo.encryptionType=t.encryptionType,this.externalDocLabelInfo.isDke=t.isDke,this.externalDocLabelInfo.hasExtractForUser=t.hasExtractForUser,this.externalDocLabelInfo.order=t.order,this.externalDocLabelInfo.displayName=t.displayName,this.externalDocLabelInfo.description=t.description,this.externalDocLabelInfo.parentName=t.parentName,this.externalDocLabelInfo.color=t.color}},{key:"getInDocSensitiveLabelInfo",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.getInDocSensitiveLabelInfo():this.inDocLabelInfo}},{key:"getExternalDocSensitivityLabelInfo",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.getExternalDocSensitivityLabelInfo():this.externalDocLabelInfo}},{key:"shouldShowExternalDocSensitivityLabel",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.shouldShowExternalDocSensitivityLabel():(WS("Empty External Doc Label : ".concat(this.externalDocLabelInfo.labelId===rM)),this.externalDocLabelInfo.labelId!==rM&&oF(WK()))}},{key:"shouldShowInDocSensitivityLabel",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.shouldShowInDocSensitivityLabel():(WS("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===rM)),this.inDocLabelInfo.labelId!==rM&&oF(WK()))}},{key:"isInDocSensitivityLabelEncrypted",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.isInDocSensitivityLabelEncrypted():this.inDocLabelInfo.encryptionType!==Tp.None}},{key:"isExternalDocSensitivityLabelEncrypted",value:function(){return e.clpSensitivityHandlerSharedInstance?e.clpSensitivityHandlerSharedInstance.isExternalDocSensitivityLabelEncrypted():this.externalDocLabelInfo.encryptionType!==Tp.None}}],[{key:"getInstance",value:function(t){var n=Sb.getInstance().getChatRef();return(Jh(Dh.UseNewCopilotSharedPackage)&&cF(e.clpSensitivityHandlerSharedInstance)||!cF(t))&&(e.clpSensitivityHandlerSharedInstance=_f.getInstance(t,n,MR,UR)),cF(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),cF(t)||(e.clpSensitivityHandler.setBasicChatProps=t),e.clpSensitivityHandler}}]),e}();function Ib(e,t,n,r){return _b.apply(this,arguments)}function _b(){return(_b=(0,gd._)((function(e,t,n,r){return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return ZR("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(r)),WS("Label change callback received, context:  ".concat(n)),bb&&n===Eb&&(bb("ignore"),bb=null),r!==Ip.S_APPLYLABEL_OK?(qS("error in upgrading label : ".concat(r)),[2]):Jh(Dh.IsClpEnabledInEnterpriseForSydney)&&(Tb.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,Tb.getInstance().setSensitivityLabelToHighestSensitivity([Tb.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return o.sent(),[2];case 2:return!Vh(Lh.IsEmptyLabelFixForCLPv2FeatureEnabled)&&Vh(Lh.IsApplyLabelUsingTryUpgradeLabelEnabled),Tb.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))).apply(this,arguments)}(0,i._)(Tb,"clpSensitivityHandler",void 0),(0,i._)(Tb,"clpSensitivityHandlerSharedInstance",void 0);var wb=n(65438),Pb=n(30951),xb=n(50952),kb=n(49619),Ab=n(5101),Lb=n(93675);const Db=(0,Za.n)({item:{height:"auto",width:"auto",flexShrink:1}}),Ob=({children:e,style:t})=>{const n=(0,Ms.z)(Db().item,t);return a.createElement("div",{className:n},e)},Nb=(0,Za.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),Rb=({children:e,style:t,horizontal:n=!1,reverse:r=!1,customProperties:o})=>{const i=((e,t,n,r)=>{let o=e.root;return t&&(o=(0,Ms.z)(o,t)),n?o=r?(0,Ms.z)(o,e.horizontalReverse):(0,Ms.z)(o,e.horizontal):r&&(o=(0,Ms.z)(o,e.verticalReverse)),o})(Nb(),t,n,r);return a.createElement("div",Object.assign({className:i},o),e)};var Fb,Mb=n(58651);class Bb{constructor(){this.isDevBuild=!1}static getInstance(){return Bb.instance||(Bb.instance=new Bb),Bb.instance}setDevBuild(e){this.isDevBuild=e}debugLog(e,...t){this.isDevBuild&&Mb.log(e,t)}}!function(e){e.File="File",e.Event="Event",e.Message="Message"}(Fb||(Fb={}));n(58651);function Ub(e){const t=e.lastIndexOf(".");if(-1===t||0===t)return{name:e,extension:""};return{name:e.slice(0,t),extension:e.slice(t+1).toLowerCase()}}const Hb=()=>a.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg",alt:"Word",height:20,width:20}),Gb=()=>a.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg",alt:"Excel",height:20,width:20}),zb=()=>a.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg",alt:"PowerPoint",height:20,width:20}),qb=(new Map([["docx",a.createElement(Hb,{key:"docx"})],["doc",a.createElement(Hb,{key:"doc"})],["pptx",a.createElement(zb,{key:"pptx"})],["ppt",a.createElement(zb,{key:"ppt"})],["xlsx",a.createElement(Gb,{key:"xlsx"})],["xls",a.createElement(Gb,{key:"xls"})],["pdf",a.createElement((()=>a.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg",alt:"PDF",height:20,width:20})),{key:"pdf"})],["people",a.createElement((()=>a.createElement("img",{src:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/contact.svg",alt:"People",height:20,width:20})),{key:"people"})]]),new Map([["docx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg"],["pptx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg"],["xlsx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg"],["pdf","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg"],["txt","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg"],["html","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/html.svg"],["people","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/contact.svg"],["eml","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/outlook_24x1.svg"],["teams","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/teams_24x1.svg"]]));var Wb=n(36733),jb=n(79520),Vb=n(81715);const Qb=(0,Za.n)({row:Object.assign({display:"flex"},Xa.Pt.gap(Wb.L.spacingHorizontalXL)),contentStyle:Object.assign(Object.assign({},Xa.Pt.gap(Wb.L.spacingVerticalL)),{background:Wb.L.colorNeutralBackground1})}),Jb=({numberOfItems:e=1,headerDescription:t})=>{const n=Qb();return a.createElement(Rb,{style:n.contentStyle},t&&a.createElement(xb.c,null,t),(r=e,Array.from(Array(r).keys()).map((e=>a.createElement(kb.Z,{size:"small",key:e},a.createElement(jb.E,{className:n.row,"aria-label":"Loading Content"},a.createElement(Vb.H,{size:24,shape:"square"}),a.createElement(Vb.H,{size:24,shape:"square"}),a.createElement(Vb.H,{size:24,shape:"rectangle"}),a.createElement(Vb.H,{size:24,shape:"square"})))))));var r},Kb={entityPickerChildGap:Object.assign({},Xa.Pt.gap("12px")),entityCard:{display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-between",width:"100%"},authorAndDateGap:{},authorGap:{marginLeft:"16px",flexGrow:1,textAlign:"left",minWidth:"200px"},dateModified:{minWidth:"150px",flexGrow:1,textAlign:"left"},authorName:{paddingLeft:"5px"},authorImg:{borderRadius:"50%"},elementGap:Object.assign(Object.assign({},Xa.Pt.gap("8px")),{justifyContent:"left",overflow:"auto"}),submitButtonStyle:{width:"fit-content"},deleteButtonStyle:{marginTop:"auto",marginBottom:"auto",cursor:"pointer"},listCardStyle:Object.assign(Object.assign({padding:"4px 6px",boxShadow:"none",border:"1px solid",borderRadius:"4px"},Xa.Pt.borderColor(Wb.L.colorNeutralStroke1)),{justifyContent:"space-between"}),checkbox:{justifyContent:"space-between"},checkboxLabelWithAuthor:{justifyContent:"left",minWidth:"100px"},checkboxLabel:{justifyContent:"left"},fileLabel:{paddingLeft:"5px"},onHoverUI:{display:"block",position:"absolute",top:"100%",left:"0",backgroundColor:"white",border:"1px solid #ccc",padding:"10px",zIndex:1,width:"100px",height:"100px"},authorImage:{borderRadius:"50%",paddingRight:"5px"},entityHoverCard:{borderRadius:"10px"},entityName:{color:Wb.L.colorNeutralForeground2},addEntityButtonStyle:{paddingTop:"4px",paddingBottom:"4px"}},Xb=(0,Za.n)(Kb);var Zb=n(3146),Yb=n(52191),$b=n(9717);const eE=({list:e,headerDescription:t,addEntityButtonText:r,addAnotherEntityProps:o,entityInteractionDisabled:i=!1,dataAvailable:s=!0,allowEntityDeletion:l=!1,openEntityInputPickerOnStartup:c=!1,onEntityChange:u})=>{const[d,p]=a.useState(null!=e?e:[]),[g,m]=a.useState(c),[f,h]=a.useState(d.some((e=>e.author||e.dateModified||e.authorIconUrl))),v=Xb();a.useEffect((()=>{e&&e.length>0&&(p(e),h(e.some((e=>e.author||e.dateModified||e.authorIconUrl)))),((e,...t)=>{Bb.getInstance().debugLog(e,t)})("EntityPicker:: list: ",e)}),[e]);const y=(e,t)=>{const n={onRenderPlainCard:()=>{return t={onHoverUI:e.onHoverUI},a.createElement(Rb,null,t.onHoverUI);var t}};return a.createElement(Zb.j,{cardDismissDelay:200,type:Yb.F.plain,plainCardProps:n,className:v.entityHoverCard,style:{borderRadius:"8px"}},a.createElement(Rb,{horizontal:!0,style:f?v.checkboxLabelWithAuthor:v.checkboxLabel},a.createElement("img",{src:e.iconUrl,alt:e.text,height:20,width:20}),a.createElement(Ob,{key:t,style:v.fileLabel},e.url&&e.url.length>0?a.createElement(wb.N,{href:e.url,target:"_blank"},a.createElement(Pb.V,{className:v.entityName},e.text)):a.createElement(Pb.V,{className:v.entityName},e.text))))};return s?a.createElement(Rb,{style:v.entityPickerChildGap},t&&a.createElement(xb.c,null,t),a.createElement(Rb,{style:v.elementGap},null==d?void 0:d.map(((e,t)=>a.createElement(a.Fragment,{key:t},a.createElement(kb.Z,{key:t,size:"small",className:v.listCardStyle},a.createElement(Rb,{horizontal:!0,style:v.entityCard},a.createElement(Ab.S,{key:t,className:v.checkbox,checked:e.checked,disabled:i,onChange:(t,n)=>{((e,t)=>{const n=[...d];n.forEach((n=>{n.text===e.text&&n.url===e.url&&n.id===e.id&&(n.checked=t)})),u(n),p(n)})(e,n.checked)},label:y(e,t)}),f&&a.createElement(Rb,{horizontal:!0,style:v.authorAndDateGap},a.createElement(Ob,{style:v.dateModified},a.createElement(xb.c,null,e.dateModified)),a.createElement(Rb,{horizontal:!0,style:v.authorGap},e.authorIconUrl&&a.createElement("img",{src:e.authorIconUrl,alt:e.author,height:20,width:20,style:{borderRadius:"50%",paddingRight:"5px"}}),e.author&&a.createElement(Ob,null,a.createElement(xb.c,null,e.author)))),l&&a.createElement($b.K,{"aria-label":"Delete",title:"Remove",onClick:()=>(e=>{p((t=>{const n=[...t];return n.splice(e,1),u(n),n}))})(t)},a.createElement(cg.va_,{style:{color:Wb.L.colorNeutralForeground2}})))))))),a.createElement(a.Fragment,null,a.createElement("div",null,r&&!g&&a.createElement(Lb.$,{size:"small",icon:a.createElement(cg.Ibn,null),className:v.addEntityButtonStyle,onClick:()=>m(!0)},"Add another file"),(!r||g&&!i)&&o&&a.createElement(a.Fragment,null,((e,t,r,o)=>{const i=a.lazy((()=>n.e(3935).then(n.bind(n,89680)))),s=r;return s.onItemSelected=(e,n,r)=>{switch(e.type){case"File":t({text:e.FileName,url:e.AccessUrl,id:e.Id,supportedEntityType:Fb.File});break;case"Event":t({text:e.Subject,url:e.WebLink,id:e.Id,supportedEntityType:Fb.Event});break;case"Message":t({text:e.Subject,url:e.Subject,id:e.Id,supportedEntityType:Fb.Message})}},a.createElement(a.Suspense,{fallback:a.createElement("div",null,"Loading...")},a.createElement(i,{alSession:e,editorConfigProps:s,onCIQOutOfFocus:o}))})(o.alSession,(e=>{p((t=>{if(null==t?void 0:t.some((t=>t.text===e.text&&t.url===e.url&&t.id===e.id)))return t;let{extension:n}=Ub(e.text);null!=n&&0!==n.length||(n=function(e){switch(e){case Fb.Event:return"teams";case Fb.Message:return"eml";default:return""}}(e.supportedEntityType));const r=[...t];return r.push({text:e.text,url:e.url||"",id:e.id,checked:!0,iconUrl:qb.get(n)}),u(r),r}))}),o.editorConfiguration,(()=>{m(!1)})))))):a.createElement(Jb,{numberOfItems:5})};var tE,nE=n(26711),rE=n(32119),oE=n(82529);function iE(){return[{data:fm()?PowerpointCopilotStrings.PromptMenuItemCreatePresentationFromHVCV2:hB,commandCategory:tE.CreatePresentationFrom,isCiq:!0},{data:fm()?PowerpointCopilotStrings.PromptMenuItemCreatePresentationAboutHVCV2:vB,commandCategory:tE.CreatePresentationAbout},{data:fm()?PowerpointCopilotStrings.PromptMenuItemAddSlideHVCV2:yB,commandCategory:tE.AddSlide},{data:fm()?PowerpointCopilotStrings.PromptGuideMenuItemOrganizePresentation:CB,commandCategory:tE.Organize},{data:fm()?PowerpointCopilotStrings.PromptMenuItemAddImageHVCV2:SB,commandCategory:tE.AddImage},{data:fm()?PowerpointCopilotStrings.PromptGuideMenuItemAddAgendaSlide:bB,commandCategory:tE.Agenda},{data:fm()?PowerpointCopilotStrings.PromptMenuItemAnimate:EB,commandCategory:tE.Animate}]}!function(e){e.AddImage="AddImage",e.AddSlide="AddSlide",e.CreatePresentationAbout="CreatePresentationAbout",e.CreatePresentationFrom="CreatePresentationFrom",e.Organize="Organize",e.Animate="Animate",e.Agenda="Agenda",e.NotACommand="NotACommand"}(tE||(tE={}));function aE(e){var t=[],n="",r=0,o=e().replace(/{|}/g,""),i=!0,a=!1,s=void 0;try{for(var l,c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;if("("===u||"["===u)n.trim().length>0&&t.push(n.trim()),n="",r++;else{if(r>0){")"!==u&&"]"!==u||r--;continue}0===r&&(n+=u)}}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return n.trim().length>0&&t.push(n.trim()),t}function sE(e){var t=function(e){var t={createPresentationFrom:tE.CreatePresentationFrom,createFromFile:tE.CreatePresentationFrom,createPresentationAbout:tE.CreatePresentationAbout,createPresentationAboutContoso:tE.CreatePresentationAbout,createPresentationConsumer:tE.CreatePresentationAbout,addSlideWithFAQ:tE.AddSlide,addSlideAbout:tE.AddSlide,organizePresentation:tE.Organize,addImage:tE.AddImage,addAnImage:tE.AddImage};return Object.keys(e).map((function(n){var r=t[n]||tE.NotACommand;return{promptItemAPI:e[n],commandCategory:r}}))}(e),n=null==t?void 0:t.filter((function(e){return e.commandCategory!==tE.NotACommand}));return null==n?void 0:n.map((function(e){return{hvcPromptList:aE(e.promptItemAPI),hvcCategory:e.commandCategory}}))}var lE=null;function cE(e){if(lE)return lE;try{var t=Ed(sE(tM)).concat(Ed(sE(eM)),Ed(iE().filter((function(e){return e.commandCategory!==tE.NotACommand})).map((function(e){return{hvcPromptList:aE((function(){return e.data})),hvcCategory:e.commandCategory}}))));return(t=t.filter((function(e,t,n){return t===n.findIndex((function(t){return JSON.stringify(t.hvcPromptList)===JSON.stringify(e.hvcPromptList)}))&&0!==e.hvcPromptList.length}))).length>0&&(lE=t),t}catch(t){var n;lE=null,ZR("Error in getFilteredHVCPromptItems:",t),null==e||e.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"Error parsing high value commanding prompt items, ".concat(t.message)),(0,i._)(n,uC.ErrorCategory,nb.S2.Error),n)))}return[]}var uE=function(e,t){var n=e.toLocaleLowerCase();return t&&t[n]?t[n]:tE.NotACommand},dE=function(){return Vh(Lh.IsCommandingScopeAppChatV2Enabled)&&Jh(Dh.IsCommandingScopeAppChatV2EnabledCG)};function pE(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var gE,mE,fE,hE,vE=n(87469),yE=n(89573);!function(e){e.Insertion="Insertion",e.Deletion="Deletion",e.Formatting="Formatting"}(gE||(gE={}));class CE{constructor(e){Qp.h.assign(CE,this,e)}static getTypeName(){return"AugLoop_Copilot_SignalWithQueryId"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[CE.getTypeName()])}}CE.H_={T_:CE.getTypeName(),B_:CE.getBaseTypes()};class SE{constructor(e){Qp.h.assign(SE,this,e)}static getTypeName(){return"AugLoop_Copilot_CopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[SE.getTypeName()])}}SE.H_={T_:SE.getTypeName(),B_:SE.getBaseTypes()};class bE{constructor(e){Qp.h.assign(bE,this,e)}static getTypeName(){return"AugLoop_Copilot_CopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[bE.getTypeName()])}}bE.H_={T_:bE.getTypeName(),B_:bE.getBaseTypes()},function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(mE||(mE={})),function(e){e.failed="failed",e.success="success"}(fE||(fE={})),function(e){e.Summary="Summary",e.CallsForAction="CallsForAction",e.ImportantSlides="ImportantSlides",e.SegmentedSummary="SegmentedSummary",e.StyledSummary="StyledSummary",e.Unknown="Unknown"}(hE||(hE={}));class EE{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(EE,this,e)}static getTypeName(){return"AugLoop_ComprehensionSummary_ComprehensionSummaryOutput"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[EE.getTypeName()])}}EE.H_={T_:EE.getTypeName(),B_:EE.getBaseTypes()};class TE{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(TE,this,e)}static getTypeName(){return"AugLoop_ComprehensionSummary_ComprehensionSummaryStreamingOutput"}static getBaseTypes(){return["AugLoop_ComprehensionSummary_ComprehensionSummaryOutput","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[TE.getTypeName()])}}TE.H_={T_:TE.getTypeName(),B_:TE.getBaseTypes()};class IE{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(IE,this,e)}static getTypeName(){return"AugLoop_ComprehensionSummary_ComprehensionSummaryStreamingCompletionOutput"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[IE.getTypeName()])}}IE.H_={T_:IE.getTypeName(),B_:IE.getBaseTypes()};var _E,wE,PE,xE,kE,AE,LE,DE,OE,NE,RE,FE,ME,BE,UE,HE,GE,zE,qE,WE,jE=function(){function e(){Sp(this,e),(0,i._)(this,"executionState",void 0),this.executionState=Qd.IDLE}return Ep(e,[{key:"setState",value:function(e){ZR("Execution state set: ".concat(e)),this.executionState=e}},{key:"getState",value:function(){return this.executionState}}],[{key:"getInstance",value:function(){return e.executionStateManager||(e.executionStateManager=new e),e.executionStateManager}}]),e}();(0,i._)(jE,"executionStateManager",void 0);class VE{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(VE,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[VE.getTypeName()])}}VE.H_={T_:VE.getTypeName(),B_:VE.getBaseTypes()};class QE{constructor(e){Qp.h.assign(QE,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffInternalMessage","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[QE.getTypeName()])}}QE.H_={T_:QE.getTypeName(),B_:QE.getBaseTypes()},function(e){e.Submit="Action.Submit"}(_E||(_E={})),function(e){e.ChoiceSet="Input.ChoiceSet",e.Table="Table",e.TableCell="TableCell",e.TableRow="TableRow",e.TextBlock="TextBlock",e.RichTextBlock="RichTextBlock",e.TextRun="TextRun",e.Image="Image",e.ColumnSet="ColumnSet",e.Column="Column"}(wE||(wE={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.TeamsMeeting="TeamsMeeting",e.SharePoint="SharePoint",e.Web="Web",e.PDF="PDF",e.Zip="Zip",e.HTML="HTML",e.Visio="Visio",e.Image="Image",e.Fluid="Fluid",e.Video="Video",e.Vector="Vector",e.Txt="Txt",e.ThirdParty="ThirdParty",e.Topic="Topic",e.Loop="Loop",e.Planner="Planner"}(PE||(PE={})),function(e){e[e.ChatResponse=0]="ChatResponse",e[e.GetMessagesResponse=1]="GetMessagesResponse",e[e.GetConversationResponse=2]="GetConversationResponse",e[e.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",e[e.CopyConversationResponse=4]="CopyConversationResponse",e[e.SerpCachedResponse=5]="SerpCachedResponse",e[e.CaptchaResponse=6]="CaptchaResponse"}(xE||(xE={})),function(e){e.Default="Default",e.Early="Early",e.OnUse="OnUse",e.Never="Never"}(kE||(kE={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(AE||(AE={})),function(e){e.SharePoint="SharePoint",e.OneDrive="OneDrive",e.OneDriveAndSharePoint="OneDriveAndSharePoint"}(LE||(LE={})),function(e){e.Unknown="Unknown",e.Success="Success",e.InternalError="InternalError",e.InvalidSession="InvalidSession",e.ConfigurationError="ConfigurationError",e.InvalidRequest="InvalidRequest",e.ProcessingMessage="ProcessingMessage",e.UnauthorizedRequest="UnauthorizedRequest",e.Canceled="Canceled",e.CaptchaChallenge="CaptchaChallenge",e.Throttled="Throttled",e.NotFound="NotFound",e.NoResponseReturned="NoResponseReturned",e.ThrottledByLLM="ThrottledByLLM",e.NoResponseText="NoResponseText",e.ApologyResponseReturned="ApologyResponseReturned",e.NoValidMessageTypePresentInBotResponse="NoValidMessageTypePresentInBotResponse",e.ServiceNotEnabled="ServiceNotEnabled",e.ContentForbidden="ContentForbidden",e.ContentNotFound="ContentNotFound",e.InvalidLicense="InvalidLicense",e.NotEnoughContext="NotEnoughContext",e.OutOfCredits="OutOfCredits"}(DE||(DE={})),function(e){e.Success="Success",e.Failure="Failure",e.Pending="Pending",e.BotTurnStarting="BotTurnStarting"}(OE||(OE={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(NE||(NE={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(RE||(RE={})),function(e){e.Active="Active",e.Draft="Draft",e.Deleted="Deleted",e.Blocked="Blocked"}(FE||(FE={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(ME||(ME={})),function(e){e.AnnRules="AnnRules",e.Apology="Apology",e.BingContent="Bing Content",e.Chitchat="Chitchat",e.NluDirectResponse="NluDirectResponse",e.Qna="Qna",e.TopicChanger="TopicChanger",e.Delighterdluni="Delighterdluni",e.DeepLeo="DeepLeo",e.TransformContent="transform_content",e.LocalPluginRunner="local-plugin-runner",e.ImageChat="image-chat"}(BE||(BE={})),function(e){e.Image="IMAGE"}(UE||(UE={})),function(e){e.WebPage="WebPage",e.ClientApp="ClientApp"}(HE||(HE={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(GE||(GE={})),function(e){e.Keyboard="Keyboard",e.Speech="Speech"}(zE||(zE={})),function(e){e.AudioUrl="AudioUrl",e.None="None",e.Simple="Simple",e.Ssml="Ssml"}(qE||(qE={})),function(e){e.ActionRequest="ActionRequest",e.Ads="Ads",e.AdsQuery="AdsQuery",e.Any="Any",e.AuthError="AuthError",e.ChatCompleted="ChatCompleted",e.CaptchaChallenge="CaptchaChallenge",e.Chat="Chat",e.ChatName="ChatName",e.ConfirmationCard="ConfirmationCard",e.Context="Context",e.Disengaged="Disengaged",e.SearchQuery="SearchQuery",e.Internal="Internal",e.InvokeAction="InvokeAction",e.Suggestion="Suggestion",e.InternalSuggestions="InternalSuggestions",e.InternalSearchResult="InternalSearchResult",e.InternalSearchQuery="InternalSearchQuery",e.InternalReasoningSearchResult="InternalReasoningSearchResult",e.InternalActionMarker="InternalActionMarker",e.InternalStateMarker="InternalStateMarker",e.InternalLoaderMessage="InternalLoaderMessage",e.Progress="Progress",e.GenerateContentQuery="GenerateContentQuery",e.RenderCardRequest="RenderCardRequest",e.RequireHumanInTheLoop="RequireHumanInTheLoop",e.SemanticSerp="SemanticSerp",e.ResumePluginAuth="ResumePluginAuth",e.TriggerPluginAuth="TriggerPluginAuth",e.ResumeInvokeAction="ResumeInvokeAction",e.TriggerConfirmation="TriggerConfirmation"}(WE||(WE={}));new Set([WE.Chat,WE.ChatCompleted,WE.Disengaged,WE.RenderCardRequest,WE.RequireHumanInTheLoop]);var JE,KE,XE,ZE,YE,$E,eT,tT,nT,rT,oT,iT;!function(e){e.IncomingBotResponse=void 0}(WE||(WE={})),function(e){e.Blank="BLANK",e.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",e.BingSkill="BING_SKILL",e.Chitchat="CHITCHAT",e.Infoseeking="INFOSEEKING",e.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",e.InitialQNA="INITIAL_QNA",e.InitialVideos="INITIAL_VIDEOS",e.InitialWebpages="INITIAL_WEBPAGES",e.MedicalHealth="MEDICAL_HEALTH",e.MicrosoftBrands="MICROSOFT_BRANDS",e.NeedEmpathy="NEED_EMPATHY",e.Offensive="OFFENSIVE",e.OpinionGiving="OPINION_GIVING",e.OpinionSeeking="OPINION_SEEKING",e.OUTOFDomain="OUT_OF_DOMAIN",e.QNA="QNA",e.SettingsChange="SETTINGS_CHANGE",e.SettingsCheck="SETTINGS_CHECK",e.SuicideHelp="SUICIDE_HELP",e.TuringBOTSafe="TURING_BOT_SAFE",e.Unhandled="UNHANDLED",e.Videos="VIDEOS",e.Webpages="WEBPAGES"}(JE||(JE={})),function(e){e.Amount="AMOUNT",e.Setting="SETTING",e.Type="TYPE",e.Unknown="UNKNOWN",e.Unit="UNIT",e.Value="VALUE"}(KE||(KE={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(XE||(XE={})),function(e){e.Finished="FINISHED",e.Intermediate="INTERMEDIATE",e.FinishedAwaitingCommit="FINISHED_AWAITING_COMMIT"}(ZE||(ZE={})),function(e){e.General="General",e.Internal="Internal"}(YE||(YE={})),function(e){e.Testing="Testing",e.AdminCenterCopilot="AdminCenterCopilot",e.Assist365Copilot="Assist365Copilot",e.ExcelCopilot="ExcelCopilot",e.ExcelCopilotConsumer="ExcelCopilotConsumer",e.ExcelCopilotConsumerOSv2="ExcelCopilotConsumerOSv2",e.LoopCopilot="LoopCopilot",e.LoopCopilotOnCanvas="LoopCopilotOnCanvas",e.ODSPCopilot="ODSPCopilot",e.OfficeAiAppIncubation="OfficeAiAppIncubation",e.OneNoteCopilot="OneNoteCopilot",e.OneNoteCopilotConsumer="OneNoteCopilotConsumer",e.OneNoteCopilotConsumerOSv2="OneNoteCopilotConsumerOSv2",e.OperaWordCopilot="OperaWordCopilot",e.OutlookCopilot="OutlookCopilot",e.PPTCopilot="PPTCopilot",e.PPTCopilotConsumer="PPTCopilotConsumer",e.PPTCopilotConsumerOSv2="PPTCopilotConsumerOSv2",e.PlannerCopilot="PlannerCopilot",e.StreamCopilot="StreamCopilot",e.TeamsChatCopilot="TeamsChatCopilot",e.TeamsGroupCopilot="TeamsGroupCopilot",e.TeamsMeetingCopilot="teamsmeetingcp",e.VivaCopilot="VivaCopilot",e.VivaEngageCopilot="VivaEngageCopilot",e.VivaGoalsCopilot="VivaGoalsCopilot",e.WhiteboardCopilotOnCanvas="WhiteboardCopilotOnCanvas",e.WordCopilot="WordCopilot",e.WordCopilotConsumer="WordCopilotConsumer",e.WordCopilotConsumerOsv2="WordCopilotConsumerOSv2",e.LegacyDefault="Default"}($E||($E={}));!function(e){e.Creative="Creative",e.Balanced="Balanced",e.Precise="Precise"}(eT||(eT={})),function(e){e.AppChat="appchat"}(tT||(tT={})),function(e){e.Default="Default",e.Reasoning="Reasoning",e.Responding="Responding"}(nT||(nT={})),function(e){e.AdaptiveCard="AdaptiveCard"}(rT||(rT={})),function(e){e[e.InternalError=-32603]="InternalError",e[e.InvalidParams=-32602]="InvalidParams",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.InvocationError=-32e3]="InvocationError",e[e.InvocationErrorWithException=-32004]="InvocationErrorWithException",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.NoMarshaledObjectFound=-32001]="NoMarshaledObjectFound",e[e.ParseError=-32700]="ParseError",e[e.RequestCanceled=-32800]="RequestCanceled",e[e.ResponseSerializationFailure=-32003]="ResponseSerializationFailure"}(oT||(oT={})),function(e){e.SUCCESS="success",e.FAILURE="failure"}(iT||(iT={}));var aT=function(){function e(){Sp(this,e)}return Ep(e,null,[{key:"generateId",value:function(){return e.operationId++,"AugLoopChatPPT"+e.operationId.toString()}}]),e}();(0,i._)(aT,"operationId",0);class sT{constructor(e){Qp.h.assign(sT,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[sT.getTypeName()])}}sT.H_={T_:sT.getTypeName(),B_:sT.getBaseTypes()};class lT{constructor(e){Qp.h.assign(lT,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[lT.getTypeName()])}}lT.H_={T_:lT.getTypeName(),B_:lT.getBaseTypes()};class cT{constructor(e){Qp.h.assign(cT,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointCopilotOdslSignal"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[cT.getTypeName()])}}cT.H_={T_:cT.getTypeName(),B_:cT.getBaseTypes()};class uT{constructor(e){Qp.h.assign(uT,this,e)}static getTypeName(){return"AugLoop_PowerpointCopilot_PowerPointHandoffMessageId"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffMessageId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[uT.getTypeName()])}}function dT(e){return pT.apply(this,arguments)}function pT(){return(pT=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:t=e.context,n=e.slides,r=e.description;try{sb.getInstance().setScenarioName(Cv.InsertImage)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}o={version:Dv,name:mv.AddPictureCmd,data:"",sourceType:dv.Link,altText:"",target:{type:1,id:0,cId:0}},d.label=1;case 1:return d.trys.push([1,3,,4]),[4,gv.findImageDataFromDescription(r)];case 2:return i=d.sent(),[3,4];case 3:throw a=d.sent(),ZR("Error while fetching url for image with description - "+r),a;case 4:return o.data=i.url,o.altText=null!==(s=i.altText)&&void 0!==s?s:"",0!==n.length?[3,6]:[4,Yv(t)];case 5:n=d.sent(),d.label=6;case 6:return l={},0!==n.length?[3,8]:[4,Kv(t,n)];case 7:return c=d.sent().split("#"),l={type:1,id:+c[0],cId:+c[1]},[3,9];case 8:u=n[0].id.split("#"),l={type:1,id:+u[0],cId:+u[1]},d.label=9;case 9:return o.target=l,[2,o]}}))}))).apply(this,arguments)}function gT(e){return mT.apply(this,arguments)}function mT(){return(mT=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d;return(0,F.__generator)(this,(function(p){switch(p.label){case 0:t=e.context,n=e.slides,r=e.imageData,p.label=1;case 1:if(p.trys.push([1,9,,10]),!r.url)throw ZR(o="Invalid url for image data"),new Error(o);return Jh(Dh.IsPACTokenEnabled)&&r.pac?[4,YR(r.url,r.pac)]:[3,3];case 2:(i=p.sent())?r.url=i:ZR("Failed to download image with PAC"),p.label=3;case 3:return s={version:Dv,name:mv.AddPictureCmd,data:r.url,sourceType:"data:"===r.url.substring(0,5)?dv.Raw64:dv.Link,altText:null!==(a=r.altText)&&void 0!==a?a:"",target:{type:1,id:0,cId:0}},0!==n.length?[3,5]:[4,Yv(t)];case 4:n=p.sent(),p.label=5;case 5:return l={},0!==n.length?[3,7]:[4,Kv(t,n)];case 6:return c=p.sent().split("#"),l={type:1,id:+c[0],cId:+c[1]},[3,8];case 7:u=n[0].id.split("#"),l={type:1,id:+u[0],cId:+u[1]},p.label=8;case 8:return s.target=l,[2,s];case 9:throw d=p.sent(),ZR("Error while creating insert image object from image data"),d;case 10:return[2]}}))}))).apply(this,arguments)}uT.H_={T_:uT.getTypeName(),B_:uT.getBaseTypes()};var fT,hT=["deleteFooters","deleteShapes","deleteSlides","deleteText","formatShapes","formatSlides","formatText","generateSlides","insertImages","insertSection","insertShapes","insertSlides","insertText","moveSlides","selectIndicesShape","selectIndicesSlide","selectIndicesText","selectTextIndex","selectShapes","selectSlides","selectText","setFooters","transitionSlides","undoApplication","insertList","formatList","insertTables"],vT=function(){function e(){Sp(this,e)}return Ep(e,null,[{key:"generateNewSlideMoniker",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=Math.floor(Math.random()*e.maxCId),r={type:lv.Slide,cId:n};if(t){var o=Math.floor(Math.random()*(e.maxId-e.minId))+e.minId;r.id=o}if(!e.isValidSlideMoniker(r))throw new Error("Invalid slide moniker generated");return r}},{key:"isValidSlideMoniker",value:function(t){return t.type===lv.Slide&&(void 0===t.id||t.id>=e.minId&&t.id<e.maxId)&&void 0!==t.cId&&t.cId>=0&&t.cId<=e.maxCId}}]),e}();(0,i._)(vT,"minId",256),(0,i._)(vT,"maxId",2147483648),(0,i._)(vT,"maxCId",4294967295);var yT,CT=0,ST=!1,bT=function(){var e=(0,gd._)((function(e,t,n,r){var o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return fT={FSuccess:!0},CT=0,ST=!1,Vh(Lh.UseCopilotActionCommands)&&Office.context.requirements.isSetSupported(kB,AB)?(ZR("CopilotAction API supported and using : "+Office.context.requirements.isSetSupported(kB,AB)),yT=e.presentation.onCopilotActionCompleted.add(ET)):yT=e.presentation.onApplyJOfcCommandsCompleted.add(ET),[4,e.sync()];case 1:return s.sent(),ZR("applyJOfcCommands Payload string: "+t),Vh(Lh.UseCopilotActionCommands)&&Office.context.requirements.isSetSupported(kB,AB)?(ZR("CopilotAction API supported and using : "+Office.context.requirements.isSetSupported(kB,AB)),i={scenarioOptions:n.scenarioOptions?JSON.parse(n.scenarioOptions):void 0,designerOptions:n.designerOptions?JSON.parse(n.designerOptions):void 0,selectionOptions:n.selectionOptions?JSON.parse(n.selectionOptions):void 0},t&&t.length>0&&(i.jOfcCommands=JSON.parse(t)),Vh(Lh.isViewActionForCopilotActionAsyncAPIEnabled)&&Office.context.requirements.isSetSupported(kB,LB)&&r&&(i.viewAction=r),[4,e.presentation.copilotActionAsync(PB,JSON.stringify(i))]):[3,3];case 2:return o=s.sent(),[3,5];case 3:return[4,e.presentation.applyJOfcCommandsAsync(t,n)];case 4:o=s.sent(),s.label=5;case 5:return[4,e.sync()];case 6:s.sent(),CT=o.m_value,s.label=7;case 7:return s.trys.push([7,9,,10]),[4,IT()];case 8:return s.sent(),[3,10];case 9:return a=s.sent(),ZR("ApplyJOfcCommands: ",JSON.stringify(a)),fT.FSuccess=!1,[3,10];case 10:return ZR("applyJOfcCommands result: "+fT),null==yT?[3,12]:(yT.remove(),[4,e.sync()]);case 11:s.sent(),yT=null,s.label=12;case 12:return[2,fT]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}();function ET(e){return TT.apply(this,arguments)}function TT(){return TT=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,PowerPoint.run(function(){var t=(0,gd._)((function(t){var n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.sync()];case 1:if(r.sent(),e.requestId!==CT)return[2];ST=!0,ZR("Event Fired: Result: "+e.result+" RequestId: "+e.requestId),n={FSuccess:!1};try{n=JSON.parse(e.result)}catch(e){ZR("Error in parsing result event from applyJOfcCommandsAsync api",e.message),YS.getInstance().logError({eventType:IC.ChatEvents,errorMessage:"Error in parsing result event from applyJOfcCommandsAsync api, ".concat(e.message)})}return fT=n,[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return t.sent(),[2]}}))})),TT.apply(this,arguments)}function IT(){return _T.apply(this,arguments)}function _T(){return(_T=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,dF((function(){return!1!==ST?Promise.resolve():Promise.reject("Result event didn't received")}),fM,1e3)];case 1:return e.sent(),[2]}}))}))).apply(this,arguments)}var wT,PT=function(e,t){var n;if("object"==typeof e){switch(e.type){case"regex":return new RegExp(e.regex);case"var":return t[e.name];case"scope":return e.name;case"string":case"color":case"enum":n=e.string;break;case"number":n=e.number;break;case"boolean":n=e.boolean;break;default:throw new Error("Unexpected complex type: ".concat(e.name))}if(void 0===n)throw new Error("Argument ".concat(e.toString()," not found"));return n}return e};function xT(e){return kT.apply(this,arguments)}function kT(){return(kT=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){switch(t=e.context,_p.GetHostAppPlatform()){case CM:Office.context.ui.executeFeature(WM),ZR("UndoApplication: Executed CMD_UNDO_WEB with Id: "+WM);break;case SM:case bM:case yM:Office.context.ui.executeFeature(jM),ZR("UndoApplication: Executed CMD_UNDO_DESKTOP with Id: "+jM)}return[2]}))}))).apply(this,arguments)}function AT(e){return md(e)||bd(e)||vd(e)||fd()}function LT(e,t){return DT.apply(this,arguments)}function DT(){return(DT=(0,gd._)((function(e,t){var n;return(0,F.__generator)(this,(function(r){for(n=0;n<e.length;n++)e[n].type==PowerPoint.ShapeType.geometricShape&&t.push(e[n].textFrame.textRange);return[2]}))}))).apply(this,arguments)}function OT(e,t,n){return NT.apply(this,arguments)}function NT(){return(NT=(0,gd._)((function(e,t,n){var r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:return nv(t,PowerPoint.SlideCollection)||nv(t,PowerPoint.SlideScopedCollection)?(t=t.items,[3,3]):[3,1];case 1:return t.forEach((function(e){return e.load({expand:"shapes"})})),[4,e.sync()];case 2:i.sent(),i.label=3;case 3:return o=[],t.forEach((function(e){return(r=o).push.apply(r,Ed(e.shapes.items))})),[4,LT(o,n)];case 4:return i.sent(),[2]}}))}))).apply(this,arguments)}function RT(e,t){return FT.apply(this,arguments)}function FT(){return(FT=(0,gd._)((function(e,t){var n,r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:for(n=[],r=[],o=0;o<t.length;o++)(i=t[o].getParentTextFrame().getParentShape()).load("name"),r.push(i);return[4,e.sync()];case 1:for(s.sent(),a=0;a<t.length;a++)n.push(r[a].name.toLowerCase());return[2,n]}}))}))).apply(this,arguments)}function MT(e){return BT.apply(this,arguments)}function BT(){return(BT=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A;return(0,F.__generator)(this,(function(L){switch(L.label){case 0:return t=e.context,n=void 0===t?null:t,r=e.scope,o=void 0===r?null:r,i=e.text,a=void 0===i?null:i,s=e.index,l=void 0===s?-1:s,c=e.name,d=[],p=[],wT=u=void 0===c?null:c,null==(g=o)&&(g="Selection"),"Selection"!==g?[3,8]:((m=n.presentation.getSelectedTextRangeOrNullObject()).load("isNullObject,text"),(f=n.presentation.getSelectedShapes()).load({select:"items,type"}),(h=n.presentation.getSelectedSlides()).load({select:"items",expand:"shapes"}),[4,n.sync()]);case 1:for(L.sent(),v=0;v<f.items.length;v++)f.items[v].type==PowerPoint.ShapeType.geometricShape&&f.items[v].load("textFrame");return[4,n.sync()];case 2:return L.sent(),0!=m.isNullObject||""==m.text?[3,3]:(d.push(m),[3,7]);case 3:return f.items.length>0&&null==u?[4,LT(f.items,d)]:[3,5];case 4:return L.sent(),[3,7];case 5:return[4,OT(n,h,d)];case 6:L.sent(),L.label=7;case 7:0==d.length&&null==o&&(g="Presentation"),L.label=8;case 8:return Array.isArray(g)&&g.length>0&&nv(g[0],PowerPoint.Slide)?[4,OT(n,g,d)]:[3,10];case 9:return L.sent(),[3,17];case 10:return Array.isArray(g)&&g.length>0&&nv(g[0],PowerPoint.Shape)?((y=g).forEach((function(e){return e.load({select:"type"})})),[4,n.sync()]):[3,14];case 11:for(L.sent(),C=0;C<y.length;C++)y[C].type==PowerPoint.ShapeType.geometricShape&&y[C].load("textFrame");return[4,n.sync()];case 12:return L.sent(),[4,LT(g,d)];case 13:return L.sent(),[3,17];case 14:return"Presentation"!==g?[3,17]:((S=n.presentation).load({expand:"slides,slides/shapes"}),[4,n.sync()]);case 15:return L.sent(),[4,OT(n,S.slides,d)];case 16:L.sent(),L.label=17;case 17:return null!=a?[3,18]:(p=d,[3,20]);case 18:for(b=[],E=0;E<d.length;E++)(T=d[E]).load("text"),b.push(T);return[4,n.sync()];case 19:for(L.sent(),I=0;I<d.length;I++)for(_=b[I].text,w=rv(_,a,!1),P=0;P<w.length;P++)x=w[P],p.push(b[I].getSubstring(x.index,null!=x[0]?x[0].length:0));L.label=20;case 20:return null==u?[3,22]:(k=[],[4,RT(n,p)]);case 21:A=L.sent(),k=p.filter((function(e,t){var n;return null===(n=A[t])||void 0===n?void 0:n.toLowerCase().startsWith(u.toLowerCase())})),0==k.length&&(k=p.filter((function(e,t){return"content"===u.toLowerCase()&&(A[t].includes("text")||A[t].includes("subtitle")||A[t].includes("body")||A[t].includes("placeholder"))}))),0==k.length&&(k=p.filter((function(e,t){return u.toLowerCase().startsWith("title")&&A[t].startsWith("title")}))),0==k.length&&(k=p.filter((function(e,t){return A[t].includes(u.toLowerCase())}))),p=k,L.label=22;case 22:if(-1===l)return[2,p];try{if(p.length>l)return[2,[p[l]]];throw Error("Index value:"+l+" Out of bounds for Occurences length:"+p.length)}catch(e){throw ZR("Exception in selectText:"+e.message),Error("Exception in selectText:"+e.message)}return[2]}}))}))).apply(this,arguments)}var UT=function(e){var t=[],n=[];return e.split(",").map((function(e,r,o){e.match(/^\d+#\d+:\d+:/)?(n.length>0&&t.push(n.join(",")),n=[e]):n.push(e),r===o.length-1&&t.push(n.join(","))})),t},HT=function(){var e=(0,gd._)((function(e,t,n){var r,o,i,a,s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(h){switch(h.label){case 0:r=AT(t.split(":")),o=r[0],i=r[1],a=r.slice(2),s=[],h.label=1;case 1:return h.trys.push([1,4,,5]),(l=n.slides.items.find((function(e){return e.id===o})))?(l.load({select:"shapes, id, shapes/items",expand:"textFrame"}),[4,e.sync()]):[2,[]];case 2:return h.sent(),(c=l.shapes.items.find((function(e){return e.id===i})))?(c.load("textFrame, textFrame/textRange, textFrame/textRange/text"),[4,e.sync()]):[2,[]];case 3:for(h.sent(),u=c.textFrame.textRange,d=a.join(":"),p=1,g=0;g<u.text.length;g=p)(m=u.text.indexOf(d,g))>=0?(s.push(u.getSubstring(m,d.length)),p=m+d.length):p=u.text.length;return[3,5];case 4:return f=h.sent(),ZR("Exception in searchTextRangeWithTextIndex:"+f.message+"with id:"+t),[2,[]];case 5:return[2,s]}}))}));return function(t,n,r){return e.apply(this,arguments)}}();function GT(e){return zT.apply(this,arguments)}function zT(){return zT=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(h){switch(h.label){case 0:t=e.context,n=e.indices,h.label=1;case 1:return h.trys.push([1,11,,12]),(r=t.presentation).load({select:"slides, id, slides/items",expand:"shapes"}),[4,t.sync()];case 2:h.sent(),o=UT(n),i=[],a=!0,s=!1,l=void 0,h.label=3;case 3:h.trys.push([3,8,9,10]),c=o[Symbol.iterator](),h.label=4;case 4:return(a=(u=c.next()).done)?[3,7]:(d=u.value,[4,HT(t,d,r)]);case 5:g=h.sent(),(p=i).push.apply(p,Ed(g)),h.label=6;case 6:return a=!0,[3,4];case 7:return[3,10];case 8:return m=h.sent(),s=!0,l=m,[3,10];case 9:try{a||null==c.return||c.return()}finally{if(s)throw l}return[7];case 10:return[2,i];case 11:throw f=h.sent(),ZR("Exception in selectIndicesText:"+f.message),Error("Exception in selectIndicesText:"+f.message);case 12:return[2]}}))})),zT.apply(this,arguments)}var qT=function(){var e=(0,gd._)((function(e){var t,n,r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.index,i.label=1;case 1:return i.trys.push([1,4,,5]),(r=t.presentation).load({select:"slides, id, slides/items",expand:"shapes"}),[4,t.sync()];case 2:return i.sent(),[4,HT(t,n,r)];case 3:return[2,i.sent()];case 4:throw o=i.sent(),ZR("selectTextIndex: Unable to select text range for textIndex: "+n+" due to "+o.message),Error("Unable to select textRange"+o.message);case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();function WT(e){return jT.apply(this,arguments)}function jT(){return(jT=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:if(t=e.context,0===(n=e.textRanges).length)throw ZR("No text ranges to delete"),Error("No text ranges to delete");return n.reverse().forEach((function(e){e&&(e.text="")})),[4,t.sync()];case 1:return r.sent(),[2]}}))}))).apply(this,arguments)}function VT(e){return QT.apply(this,arguments)}function QT(){return QT=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R;return(0,F.__generator)(this,(function(F){switch(F.label){case 0:for(t=e.context,n=e.textRanges,r=e.color,o=void 0===r?null:r,i=e.bold,a=void 0===i?null:i,s=e.italic,l=void 0===s?null:s,c=e.underline,u=void 0===c?null:c,d=e.fontName,p=void 0===d?null:d,g=e.size,m=void 0===g?null:g,f=e.bulleted,h=void 0===f?null:f,v=e.horizontalAlignment,y=void 0===v?null:v,C=e.verticalAlignment,S=void 0===C?null:C,b=[],E=0;E<n.length;E++)T=n[E],(I=T.getParentTextFrame().getParentShape().getParentSlide()).load("id"),b.push(I);return[4,t.sync()];case 1:for(F.sent(),_=new Map,w=0;w<n.length;w++)_.has(b[w].id)?_.get(b[w].id).push(n[w]):_.set(b[w].id,[n[w]]);P=!0,x=!1,k=void 0,F.label=2;case 2:F.trys.push([2,7,8,9]),A=_.entries()[Symbol.iterator](),F.label=3;case 3:if(P=(L=A.next()).done)return[3,6];for(D=L.value,O=0;O<D[1].length;O++)N=D[1][O],null!=o&&(N.font.color=o),null!=a&&(N.font.bold=a),null!=l&&(N.font.italic=l),null!=u&&(N.font.underline=u),null!=p&&(N.font.name=p),null!=m&&(N.font.size=m),null!=h&&(N.paragraphFormat.bulletFormat.visible=h),null!=y&&(N.paragraphFormat.horizontalAlignment=y),null!=S&&(N.getParentTextFrame().verticalAlignment=S);return[4,t.sync()];case 4:F.sent(),F.label=5;case 5:return P=!0,[3,3];case 6:return[3,9];case 7:return R=F.sent(),x=!0,k=R,[3,9];case 8:try{P||null==A.return||A.return()}finally{if(x)throw k}return[7];case 9:return[2]}}))})),QT.apply(this,arguments)}function JT(e){return KT.apply(this,arguments)}function KT(){return(KT=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A;return(0,F.__generator)(this,(function(L){switch(L.label){case 0:t=e.context,n=e.precededBy,r=e.text,o=e.insertBeforeSelection,i=[],r=gF(r),a=/(?:^)\d*\.(?=\s)|^[>\*-](?=\s)/gm,s=[],XT(n,l=[],c=[],u=[]),L.label=1;case 1:return L.trys.push([1,3,,6]),[4,t.sync()];case 2:return L.sent(),[3,6];case 3:return L.sent(),[4,MT({context:t,name:wT})];case 4:return XT(n=L.sent(),l=[],c=[],u=[]),[4,t.sync()];case 5:return L.sent(),[3,6];case 6:for(d={},p=0;p<n.length;p++)(g=l[p].id)in d?d[g]+=1:d[g]=0,s.push(l[p].id);for(m=[],f=0;f<c.length;f++)h=Ed(r.matchAll(a)),h.length>=r.split("\n").length&&!c[f].text.trim()&&(r=r.replace(a,""),c[f].paragraphFormat.bulletFormat.visible||(c[f].paragraphFormat.bulletFormat.visible=!0)),v=s[f],y=c[f].start,C=y+d[v]*r.length,(S=u[f].textRange.getSubstring(C,c[f].text.length)).load("text"),m.push(S);return[4,t.sync()];case 7:for(L.sent(),b=[],E=[],T=0;T<c.length;T++)I=m[T].text,b.push(m[T].text),m[T].text=o?r+I:I+r,u[T].load("textRange, textRange/text"),E.push(u[T]);return[4,t.sync()];case 8:for(L.sent(),_=0;_<c.length;_++)w=s[_],P=c[_].start,x=P+d[w]*r.length,k=b[_].length+r.length,A=E[_].textRange.getSubstring(x,k),i.push(A);return[2,i]}}))}))).apply(this,arguments)}function XT(e,t,n,r){return ZT.apply(this,arguments)}function ZT(){return(ZT=(0,gd._)((function(e,t,n,r){var o,i,a,s;return(0,F.__generator)(this,(function(l){for(o=0;o<e.length;o++)try{(i=e[o].getParentTextFrame().getParentShape()).load("id"),t.push(i),(a=e[o]).load("text, start, paragraphFormat/bulletFormat/visible"),n.push(a),(s=e[o].getParentTextFrame()).load("textRange"),r.push(s)}catch(e){ZR("Exception in readPropertiesForInsertText:"+e.message);continue}return[2]}))}))).apply(this,arguments)}var YT={first:kv.FX_FIRST,cut:kv.FX_CUT,none:kv.FX_NONE,random:kv.FX_RANDOM,blinds:kv.FX_BLINDS,checker:kv.FX_CHECKER,checkerboard:kv.FX_CHECKER,cover:kv.FX_COVER,dissolve:kv.FX_DISSOLVE,fade:kv.FX_FADE,pull:kv.FX_PULL,randombar:kv.FX_RANDOMBAR,randombars:kv.FX_RANDOMBARS,strips:kv.FX_STRIPS,wipe:kv.FX_WIPE,zoom:kv.FX_ZOOM,fly:kv.FX_FLY,split:kv.FX_SPLIT,flash:kv.FX_FLASH,pp9:kv.FX_PP9,DEP_wheel:kv.FX_WHEEL,DEP_circle:kv.FX_CIRCLE,diamond:kv.FX_DIAMOND,plus:kv.FX_PLUS,wedge:kv.FX_WEDGE,push:kv.FX_PUSH,comb:kv.FX_COMB,newsflash:kv.FX_NEWSFLASH,alphafade:kv.FX_ALPHAFADE,blur:kv.FX_BLUR,pushelem:kv.FX_PUSHELEM,wheel:kv.FX_WHEEL,circle:kv.FX_CIRCLE,ppt12_compatibility:kv.FX_PPT12_COMPATIBILITY,vortex:kv.FX_VORTEX,ripple:kv.FX_RIPPLE,glitter:kv.FX_GLITTER,flythrough:kv.FX_FLYTHROUGH,flythrough_content:kv.FX_FLYTHROUGH_CONTENT,doors:kv.FX_DOORS,doors_content:kv.FX_DOORS_CONTENT,panbounce_content:kv.FX_PANBOUNCE_CONTENT,pan3d_content:kv.FX_PAN3D_CONTENT,conveyor:kv.FX_CONVEYOR,pan3d:kv.FX_PAN3D,gallery:kv.FX_GALLERY,crosszoom:kv.FX_CROSSZOOM,reveal:kv.FX_REVEAL,honeycomb:kv.FX_HONEYCOMB,ferris_content:kv.FX_FERRIS_CONTENT,ferriswheel:kv.FX_FERRISWHEEL,switch:kv.FX_SWITCH,flip:kv.FX_FLIP,prism:kv.FX_PRISM,flashbulb:kv.FX_FLASHBULB,shred:kv.FX_SHRED,wheelreverse:kv.FX_WHEELREVERSE,ppt15_preset_first:kv.FX_PPT15_PRESET_FIRST,fallover:kv.FX_FALLOVER,drape:kv.FX_DRAPE,curtains:kv.FX_CURTAINS,wind:kv.FX_WIND,prestige:kv.FX_PRESTIGE,fracture:kv.FX_FRACTURE,crush:kv.FX_CRUSH,peeloff:kv.FX_PEELOFF,pagecurl:kv.FX_PAGECURLSINGLE,pagecurlsingle:kv.FX_PAGECURLSINGLE,pagecurldouble:kv.FX_PAGECURLDOUBLE,airplane:kv.FX_AIRPLANE,origami:kv.FX_ORIGAMI,ppt15_preset_last:kv.FX_PPT15_PRESET_LAST,morph:kv.FX_MORPH,custom:kv.FX_CUSTOM},$T={line:uv.oartsptLine,lineinverse:uv.oartsptLineInverse,triangle:uv.oartsptTriangle,righttriangle:uv.oartsptRightTriangle,rectangle:uv.oartsptRectangle,diamond:uv.oartsptDiamond,parallelogram:uv.oartsptParallelogram,trapezoid:uv.oartsptTrapezoid,nonisoscelestrapezoid:uv.oartsptNonIsoscelesTrapezoid,pentagon:uv.oartsptPentagon,hexagon:uv.oartsptHexagon,heptagon:uv.oartsptHeptagon,octagon:uv.oartsptOctagon,decagon:uv.oartsptDecagon,dodecagon:uv.oartsptDodecagon,star4:uv.oartsptStar4,star5:uv.oartsptStar5,star6:uv.oartsptStar6,star7:uv.oartsptStar7,star8:uv.oartsptStar8,star10:uv.oartsptStar10,star12:uv.oartsptStar12,star16:uv.oartsptStar16,star24:uv.oartsptStar24,star32:uv.oartsptStar32,roundrectangle:uv.oartsptRoundRectangle,round1rectangle:uv.oartsptRound1Rectangle,round2samerectangle:uv.oartsptRound2SameRectangle,round2diagonalrectangle:uv.oartsptRound2DiagonalRectangle,sniproundrectangle:uv.oartsptSnipRoundRectangle,snip1rectangle:uv.oartsptSnip1Rectangle,snip2samerectangle:uv.oartsptSnip2SameRectangle,snip2diagonalrectangle:uv.oartsptSnip2DiagonalRectangle,plaque:uv.oartsptPlaque,ellipse:uv.oartsptEllipse,teardrop:uv.oartsptTeardrop,homeplate:uv.oartsptHomePlate,chevron:uv.oartsptChevron,piewedge:uv.oartsptPieWedge,pie:uv.oartsptPie,blockarc:uv.oartsptBlockArc,donut:uv.oartsptDonut,nosmoking:uv.oartsptNoSmoking,rightarrow:uv.oartsptRightArrow,leftarrow:uv.oartsptLeftArrow,uparrow:uv.oartsptUpArrow,downarrow:uv.oartsptDownArrow,stripedrightarrow:uv.oartsptStripedRightArrow,notchedrightarrow:uv.oartsptNotchedRightArrow,bentuparrow:uv.oartsptBentUpArrow,leftrightarrow:uv.oartsptLeftRightArrow,updownarrow:uv.oartsptUpDownArrow,leftuparrow:uv.oartsptLeftUpArrow,leftrightuparrow:uv.oartsptLeftRightUpArrow,quadarrow:uv.oartsptQuadArrow,leftarrowcallout:uv.oartsptLeftArrowCallout,rightarrowcallout:uv.oartsptRightArrowCallout,uparrowcallout:uv.oartsptUpArrowCallout,downarrowcallout:uv.oartsptDownArrowCallout,leftrightarrowcallout:uv.oartsptLeftRightArrowCallout,updownarrowcallout:uv.oartsptUpDownArrowCallout,quadarrowcallout:uv.oartsptQuadArrowCallout,bentarrow:uv.oartsptBentArrow,uturnarrow:uv.oartsptUturnArrow,circulararrow:uv.oartsptCircularArrow,leftcirculararrow:uv.oartsptLeftCircularArrow,leftrightcirculararrow:uv.oartsptLeftRightCircularArrow,curvedrightarrow:uv.oartsptCurvedRightArrow,curvedleftarrow:uv.oartsptCurvedLeftArrow,curveduparrow:uv.oartsptCurvedUpArrow,curveddownarrow:uv.oartsptCurvedDownArrow,swoosharrow:uv.oartsptSwooshArrow,cube:uv.oartsptCube,can:uv.oartsptCan,lightningbolt:uv.oartsptLightningBolt,heart:uv.oartsptHeart,sun:uv.oartsptSun,moon:uv.oartsptMoon,smileyface:uv.oartsptSmileyFace,irregularseal1:uv.oartsptIrregularSeal1,irregularseal2:uv.oartsptIrregularSeal2,foldedcorner:uv.oartsptFoldedCorner,bevel:uv.oartsptBevel,frame:uv.oartsptFrame,halfframe:uv.oartsptHalfFrame,corner:uv.oartsptCorner,diagonalstripe:uv.oartsptDiagonalStripe,chord:uv.oartsptChord,arc:uv.oartsptArc,leftbracket:uv.oartsptLeftBracket,rightbracket:uv.oartsptRightBracket,leftbrace:uv.oartsptLeftBrace,rightbrace:uv.oartsptRightBrace,bracketpair:uv.oartsptBracketPair,bracepair:uv.oartsptBracePair,straightconnector1:uv.oartsptStraightConnector1,bentconnector2:uv.oartsptBentConnector2,bentconnector3:uv.oartsptBentConnector3,bentconnector4:uv.oartsptBentConnector4,bentconnector5:uv.oartsptBentConnector5,curvedconnector2:uv.oartsptCurvedConnector2,curvedconnector3:uv.oartsptCurvedConnector3,curvedconnector4:uv.oartsptCurvedConnector4,curvedconnector5:uv.oartsptCurvedConnector5,callout1:uv.oartsptCallout1,callout2:uv.oartsptCallout2,callout3:uv.oartsptCallout3,accentcallout1:uv.oartsptAccentCallout1,accentcallout2:uv.oartsptAccentCallout2,accentcallout3:uv.oartsptAccentCallout3,bordercallout1:uv.oartsptBorderCallout1,bordercallout2:uv.oartsptBorderCallout2,bordercallout3:uv.oartsptBorderCallout3,accentbordercallout1:uv.oartsptAccentBorderCallout1,accentbordercallout2:uv.oartsptAccentBorderCallout2,accentbordercallout3:uv.oartsptAccentBorderCallout3,wedgerectcallout:uv.oartsptWedgeRectCallout,wedgerrectcallout:uv.oartsptWedgeRRectCallout,wedgeellipsecallout:uv.oartsptWedgeEllipseCallout,cloudcallout:uv.oartsptCloudCallout,cloud:uv.oartsptCloud,ribbon:uv.oartsptRibbon,ribbon2:uv.oartsptRibbon2,ellipseribbon:uv.oartsptEllipseRibbon,ellipseribbon2:uv.oartsptEllipseRibbon2,leftrightribbon:uv.oartsptLeftRightRibbon,verticalscroll:uv.oartsptVerticalScroll,horizontalscroll:uv.oartsptHorizontalScroll,wave:uv.oartsptWave,doublewave:uv.oartsptDoubleWave,plus:uv.oartsptPlus,flowchartprocess:uv.oartsptFlowChartProcess,flowchartdecision:uv.oartsptFlowChartDecision,flowchartinputoutput:uv.oartsptFlowChartInputOutput,flowchartpredefinedprocess:uv.oartsptFlowChartPredefinedProcess,flowchartinternalstorage:uv.oartsptFlowChartInternalStorage,flowchartdocument:uv.oartsptFlowChartDocument,flowchartmultidocument:uv.oartsptFlowChartMultidocument,flowchartterminator:uv.oartsptFlowChartTerminator,flowchartpreparation:uv.oartsptFlowChartPreparation,flowchartmanualinput:uv.oartsptFlowChartManualInput,flowchartmanualoperation:uv.oartsptFlowChartManualOperation,flowchartconnector:uv.oartsptFlowChartConnector,flowchartpunchedcard:uv.oartsptFlowChartPunchedCard,flowchartpunchedtape:uv.oartsptFlowChartPunchedTape,flowchartsummingjunction:uv.oartsptFlowChartSummingJunction,flowchartor:uv.oartsptFlowChartOr,flowchartcollate:uv.oartsptFlowChartCollate,flowchartsort:uv.oartsptFlowChartSort,flowchartextract:uv.oartsptFlowChartExtract,flowchartmerge:uv.oartsptFlowChartMerge,flowchartofflinestorage:uv.oartsptFlowChartOfflineStorage,flowchartonlinestorage:uv.oartsptFlowChartOnlineStorage,flowchartmagnetictape:uv.oartsptFlowChartMagneticTape,flowchartmagneticdisk:uv.oartsptFlowChartMagneticDisk,flowchartmagneticdrum:uv.oartsptFlowChartMagneticDrum,flowchartdisplay:uv.oartsptFlowChartDisplay,flowchartdelay:uv.oartsptFlowChartDelay,flowchartalternateprocess:uv.oartsptFlowChartAlternateProcess,flowchartoffpageconnector:uv.oartsptFlowChartOffpageConnector,actionbuttonblank:uv.oartsptActionButtonBlank,actionbuttonhome:uv.oartsptActionButtonHome,actionbuttonhelp:uv.oartsptActionButtonHelp,actionbuttoninformation:uv.oartsptActionButtonInformation,actionbuttonforwardnext:uv.oartsptActionButtonForwardNext,actionbuttonbackprevious:uv.oartsptActionButtonBackPrevious,actionbuttonend:uv.oartsptActionButtonEnd,actionbuttonbeginning:uv.oartsptActionButtonBeginning,actionbuttonreturn:uv.oartsptActionButtonReturn,actionbuttondocument:uv.oartsptActionButtonDocument,actionbuttonsound:uv.oartsptActionButtonSound,actionbuttonmovie:uv.oartsptActionButtonMovie,gear6:uv.oartsptGear6,gear9:uv.oartsptGear9,funnel:uv.oartsptFunnel,mathplus:uv.oartsptMathPlus,mathminus:uv.oartsptMathMinus,mathmultiply:uv.oartsptMathMultiply,mathdivide:uv.oartsptMathDivide,mathequal:uv.oartsptMathEqual,mathnotequal:uv.oartsptMathNotEqual,cornertabs:uv.oartsptCornerTabs,squaretabs:uv.oartsptSquareTabs,plaquetabs:uv.oartsptPlaqueTabs,chartx:uv.oartsptChartX,chartstar:uv.oartsptChartStar,chartplus:uv.oartsptChartPlus},eI={shadow1:Lv.oartshadow1,shadow2:Lv.oartshadow2,shadow3:Lv.oartshadow3,shadow4:Lv.oartshadow4,shadow5:Lv.oartshadow5,shadow6:Lv.oartshadow6,shadow7:Lv.oartshadow7,shadow8:Lv.oartshadow8,shadow9:Lv.oartshadow9,shadow10:Lv.oartshadow10,shadow11:Lv.oartshadow11,shadow12:Lv.oartshadow12,shadow13:Lv.oartshadow13,shadow14:Lv.oartshadow14,shadow15:Lv.oartshadow15,shadow16:Lv.oartshadow16,shadow17:Lv.oartshadow17,shadow18:Lv.oartshadow18,shadow19:Lv.oartshadow19,shadow20:Lv.oartshadow20},tI={TopLeft:Av.oartalignTopLeft,Top:Av.oartalignTop,TopRight:Av.oartalignTopRight,Left:Av.oartalignLeft,Center:Av.oartalignCenter,Right:Av.oartalignRight,BottomLeft:Av.oartalignBottomLeft,Bottom:Av.oartalignBottom,BottomRight:Av.oartalignBottomRight},nI={lowercase:Fv.smallCaps,uppercase:Fv.allCaps},rI={unknown:Mv.fxtypeUnknown,entrance:Mv.fxtypeEntrance,exit:Mv.fxtypeExit,emphasis:Mv.fxtypeEmphasis,motionpath:Mv.fxtypeMotionPath,actionverb:Mv.fxtypeActionVerb,mediacommand:Mv.fxtypeMediaCommand,hostcommand:Mv.fxtypeHostCommand},oI={customentrance:Bv.fxidCustomEntrance,customexit:Bv.fxidCustomExit,_entranceexit_first:Bv.fxid_ENTRANCEEXIT_FIRST,appear:Bv.fxidAppear,disappear:Bv.fxidAppear,fly:Bv.fxidFly,flyin:Bv.fxidFly,flyout:Bv.fxidFly,blinds:Bv.fxidBlinds,box:Bv.fxidBox,checkerboard:Bv.fxidCheckerboard,circle:Bv.fxidCircle,shape:Bv.fxidCircle,crawl:Bv.fxidCrawl,diamond:Bv.fxidDiamond,dissolve:Bv.fxidDissolve,fade:Bv.fxidFade,flashonce:Bv.fxidFlashOnce,peek:Bv.fxidPeek,plus:Bv.fxidPlus,randombars:Bv.fxidRandomBars,spiral:Bv.fxidSpiral,split:Bv.fxidSplit,stretch:Bv.fxidStretch,collapse:Bv.fxidCollapse,strips:Bv.fxidStrips,swivel:Bv.fxidSwivel,wedge:Bv.fxidWedge,wheel:Bv.fxidWheel,wipe:Bv.fxidWipe,zoom:Bv.fxidZoom,randomeffects:Bv.fxidRandomEffects,boomerang:Bv.fxidBoomerang,bounce:Bv.fxidBounce,colorreveal:Bv.fxidColorReveal,credits:Bv.fxidCredits,easein:Bv.fxidEaseIn,float:Bv.fxidFloat,growandturn:Bv.fxidGrowAndTurn,shrinkandturn:Bv.fxidGrowAndTurn,impact:Bv.OBSOLETE_fxidImpact,iris:Bv.OBSOLETE_fxidIris,lightspeed:Bv.fxidLightSpeed,pinwheel:Bv.fxidPinwheel,pulse:Bv.OBSOLETE_fxidPulse,riseup:Bv.fxidRiseUp,sinkdown:Bv.fxidSinkDown,swish:Bv.fxidSwish,thinline:Bv.fxidThinLine,unfold:Bv.fxidUnfold,whip:Bv.fxidWhip,ascend:Bv.fxidAscend,floatout:Bv.fxidAscend,centerrevolve:Bv.fxidCenterRevolve,fadedascend:Bv.OBSOLETE_fxidFadedAscend,fadedswivel:Bv.fxidFadedSwivel,fadedwipe:Bv.OBSOLETE_fxidFadedWipe,descend:Bv.fxidDescend,sling:Bv.fxidSling,spinner:Bv.fxidSpinner,spin:Bv.fxidSpinner,compress:Bv.fxidCompress,stretchy:Bv.fxidStretchy,zip:Bv.fxidZip,arcup:Bv.fxidArcUp,fadedzoom:Bv.fxidFadedZoom,glide:Bv.fxidGlide,expand:Bv.fxidExpand,contract:Bv.fxidContract,flip:Bv.fxidFlip,shimmer:Bv.OBSOLETE_fxidShimmer,fold:Bv.fxidFold,appearandplay:Bv.fxidAppearAndPlay,draw:Bv.fxidDraw,"3darrive":Bv.fxid3DArrive,"3dflyin":Bv.fxid3DFlyIn,"3drollin":Bv.fxid3DRollIn},iI={customemphasis:Uv.fxidCustomEmphasis,_emphasis_first:Uv.fxid_EMPHASIS_FIRST,changefillcolor:Uv.fxidChangeFillColor,changefont:Uv.fxidChangeFont,changefontcolor:Uv.fxidChangeFontColor,changefontsize:Uv.fxidChangeFontSize,changefontstyle:Uv.fxidChangeFontStyle,growshrink:Uv.fxidGrowShrink,changelinecolor:Uv.fxidChangeLineColor,spin:Uv.fxidSpin,transparency:Uv.fxidTransparency,boldflash:Uv.fxidBoldFlash,fall:Uv.OBSOLETE_fxidFall,pinch:Uv.OBSOLETE_fxidPinch,allcaps:Uv.OBSOLETE_fxidAllCaps,blast:Uv.fxidBlast,boldreveal:Uv.fxidBoldReveal,brushoncolor:Uv.fxidBrushOnColor,brushonhighlight:Uv.OBSOLETE_fxidBrushOnHighlight,brushonunderline:Uv.fxidBrushOnUnderline,colorblend:Uv.fxidColorBlend,objectcolor:Uv.fxidColorBlend,colorwave:Uv.fxidColorWave,complementarycolor:Uv.fxidComplementaryColor,complementarycolor2:Uv.fxidComplementaryColor2,contrastingcolor:Uv.fxidContrastingColor,darken:Uv.fxidDarken,desaturate:Uv.fxidDesaturate,flashbulb:Uv.fxidFlashBulb,flicker:Uv.fxidFlicker,colorpulse:Uv.fxidFlicker,growwithcolor:Uv.fxidGrowWithColor,highlight:Uv.OBSOLETE_fxidHighlight,lighten:Uv.fxidLighten,styleemphasis:Uv.fxidStyleEmphasis,teeter:Uv.fxidTeeter,verticalgrow:Uv.fxidVerticalGrow,wave:Uv.fxidWave,blink:Uv.fxidBlink,shimmer:Uv.fxidShimmer,"3dturntable":Uv.fxid3DTurntable,"3dswing":Uv.fxid3DSwing,"3djumpandturn":Uv.fxid3DJumpAndTurn,"3dfly":Uv.fxid3DFly,"3dhover":Uv.fxid3DHover,_emphasis_count_generic:Uv.fxid_EMPHASIS_COUNT_GENERIC,_emphasis_first_embedded:Uv.fxid_EMPHASIS_FIRST_EMBEDDED,fxidEmbedded1:Uv.fxid_EMPHASIS_FIRST_EMBEDDED,embedded2:Uv.fxidEmbedded2,embedded3:Uv.fxidEmbedded3,embedded4:Uv.fxidEmbedded4,embedded5:Uv.fxidEmbedded5,embedded6:Uv.fxidEmbedded6,embedded7:Uv.fxidEmbedded7,embedded8:Uv.fxidEmbedded8,embedded9:Uv.fxidEmbedded9,embedded10:Uv.fxidEmbedded10,embedded11:Uv.fxidEmbedded11,embedded12:Uv.fxidEmbedded12,embedded13:Uv.fxidEmbedded13,embedded14:Uv.fxidEmbedded14,embedded15:Uv.fxidEmbedded15,embedded16:Uv.fxidEmbedded16,embedded17:Uv.fxidEmbedded17,embedded18:Uv.fxidEmbedded18},aI={custommotionpath:Hv.fxidCustomMotionPath,_motionpath_first:Hv.fxid_MOTIONPATH_FIRST,pathcircle:Hv.fxidPathCircle,pathrighttriangle:Hv.fxidPathRightTriangle,pathdiamond:Hv.fxidPathDiamond,pathhexagon:Hv.fxidPathHexagon,path5pointstar:Hv.fxidPath5PointStar,pathcrescentmoon:Hv.fxidPathCrescentMoon,pathsquare:Hv.fxidPathSquare,pathtrapezoid:Hv.fxidPathTrapezoid,pathheart:Hv.fxidPathHeart,pathoctagon:Hv.fxidPathOctagon,path6pointstar:Hv.fxidPath6PointStar,pathfootball:Hv.fxidPathFootball,pathequaltriangle:Hv.fxidPathEqualTriangle,pathparallelogram:Hv.fxidPathParallelogram,pathpentagon:Hv.fxidPathPentagon,path4pointstar:Hv.fxidPath4PointStar,path8pointstar:Hv.fxidPath8PointStar,pathteardrop:Hv.fxidPathTeardrop,pathpointystar:Hv.fxidPathPointyStar,pathcurvedsquare:Hv.fxidPathCurvedSquare,pathcurvedx:Hv.fxidPathCurvedX,pathverticalfigure8:Hv.fxidPathVerticalFigure8,pathcurvystar:Hv.fxidPathCurvyStar,pathloopdeloop:Hv.fxidPathLoopdeLoop,pathbuzzsaw:Hv.fxidPathBuzzsaw,pathhorizontalfigure8:Hv.fxidPathHorizontalFigure8,pathpeanut:Hv.fxidPathPeanut,pathfigure8four:Hv.fxidPathFigure8Four,pathneutron:Hv.fxidPathNeutron,pathswoosh:Hv.fxidPathSwoosh,pathbean:Hv.fxidPathBean,pathplus:Hv.fxidPathPlus,pathinvertedtriangle:Hv.fxidPathInvertedTriangle,pathinvertedsquare:Hv.fxidPathInvertedSquare,pathleft:Hv.fxidPathLeft,pathturnright:Hv.fxidPathTurnRight,patharcdown:Hv.fxidPathArcDown,pathzigzag:Hv.fxidPathZigzag,pathscurve2:Hv.fxidPathSCurve2,pathsinewave:Hv.fxidPathSineWave,pathbounceleft:Hv.fxidPathBounceLeft,pathdown:Hv.fxidPathDown,pathturnup:Hv.fxidPathTurnUp,patharcup:Hv.fxidPathArcUp,pathheartbeat:Hv.fxidPathHeartbeat,pathspiralright:Hv.fxidPathSpiralRight,pathwave:Hv.fxidPathWave,pathcurvyleft:Hv.fxidPathCurvyLeft,pathdiagonaldownright:Hv.fxidPathDiagonalDownRight,pathturndown:Hv.fxidPathTurnDown,patharcleft:Hv.fxidPathArcLeft,pathfunnel:Hv.fxidPathFunnel,pathspring:Hv.fxidPathSpring,pathbounceright:Hv.fxidPathBounceRight,pathspiralleft:Hv.fxidPathSpiralLeft,pathdiagonalupright:Hv.fxidPathDiagonalUpRight,pathturnupright:Hv.fxidPathTurnUpRight,patharcright:Hv.fxidPathArcRight,pathscurve1:Hv.fxidPathSCurve1,pathdecayingwave:Hv.fxidPathDecayingWave,pathcurvyright:Hv.fxidPathCurvyRight,pathstairsdown:Hv.fxidPathStairsDown,pathright:Hv.fxidPathRight,pathup:Hv.fxidPathUp,_motionpath_count:Hv.fxid_MOTIONPATH_COUNT},sI={nostrike:qv.noStrike,singlestrike:qv.singleStrike,doublestike:qv.doubleStrike};function lI(e,t){return(e<<5>>>0)+e+t.charCodeAt(0)>>>0}function cI(e,t){return uI.apply(this,arguments)}function uI(){return uI=(0,gd._)((function(e,t){var n,r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),n=e.getParentTextFrame(),(r=n.textRange).load("text"),[4,t.sync()];case 1:return s.sent(),o=r.text+"\r",i=function(e){var t=0;if(e.length){var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)t=lI(t,i.value)}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}}return t}(o),[2,i];case 2:return a=s.sent(),ZR("Exception while computing hash for text range - "+a.toString()),[2,-1];case 3:return[2]}}))})),uI.apply(this,arguments)}function dI(e,t){return pI.apply(this,arguments)}function pI(){return pI=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S;return(0,F.__generator)(this,(function(b){switch(b.label){case 0:n=[],r=!0,o=!1,i=void 0,b.label=1;case 1:b.trys.push([1,10,11,12]),a=e[Symbol.iterator](),b.label=2;case 2:return(r=(s=a.next()).done)?[3,9]:(l=s.value,(c=l.getParentTextFrame().getParentShape()).load("id"),(u=c.getParentSlide()).load("id"),[4,t.sync()]);case 3:return b.sent(),d=u.id.split("#"),p=+d[0],g=+d[1],l.load("start"),l.load("length"),[4,t.sync()];case 4:return b.sent(),m=l.start,-1!==(f=l.length)?[3,6]:(h=l.getParentTextFrame(),(v=h.textRange).load("text"),[4,t.sync()]);case 5:b.sent(),f=v.text.length-m,b.label=6;case 6:return[4,cI(l,t)];case 7:if(-1===(y=b.sent()))return[3,8];C={slideId:{id:p,cId:g},shapeId:{id:+c.id},start:m,length:f,hash:y},n.push(C),b.label=8;case 8:return r=!0,[3,2];case 9:return[3,12];case 10:return S=b.sent(),o=!0,i=S,[3,12];case 11:try{r||null==a.return||a.return()}finally{if(o)throw i}return[7];case 12:return[2,n]}}))})),pI.apply(this,arguments)}function gI(e,t,n,r,o,i,a,s,l,c,u,d){var p={};try{if(cF(e)||(p.bold=e),cF(t)||(p.italic=t),cF(n)||(p.normalize=n),cF(r)||(p.underline=function(e){switch(e){case"None":default:return xv.noUnderline;case"Single":return xv.singleLine;case"Words":return xv.words;case"Double":return xv.doubleLine;case"Heavy":return xv.heavyLine;case"Dotted":return xv.dottedLine;case"DottedHeavy":return xv.dottedHeavyLine;case"Dash":return xv.dashLine;case"DashHeavy":return xv.dashHeavyLine;case"DashLong":return xv.dashLongLine;case"DotDash":return xv.dotDashLine;case"DotDashHeavy":return xv.dotDashHeavyLine;case"DashLongHeavy":return xv.dashLongHeavyLine;case"Wavy":return xv.wavyLine;case"WavyHeavy":return xv.wavyHeavyLine;case"WavyDouble":return xv.wavyDoubleLine;case"DotDotDash":return xv.dotDotDashLine;case"DotDotDashHeavy":return xv.dotDotDashHeavyLine}}(r)),!cF(o))if(!0===o||!1===o)p.strike=Number(o);else{var g=o.toLowerCase();g in sI&&(p.strike=sI[g])}if(!cF(i)){var m=i.toLowerCase();m in nI&&(p.caps=nI[m])}if(cF(a)||(p.fontSize=a),cF(s)||(p.spacing=s),cF(l)||(p.lang=l),cF(c)||(p.font=c),!cF(u)){var f=uy(u);cF(f)||(p.fill={solid:f})}if(!cF(d)){var h=uy(d);cF(h)||(p.highlight=h)}return p}catch(e){throw ZR("Exception while parsing the program for OfficeJsPayload Json - "+e.toString()),new Error("Exception while parsing the program for OfficeJsPayload Json ")}}function mI(e,t,n){if(Jh(Dh.ShouldEnableTextRangeInJOFCCommands))return function(e,t,n){var r={range:{pos:t.start,len:t.length},hash:t.hash},o={slideId:t.slideId,shapeId:t.shapeId,stableRange:r};return{name:e,version:Dv,data:{target:o,props:n}}}(e,t,n);var r={slideId:t.slideId,shapeId:t.shapeId,props:n};return{name:e,version:Dv,data:r}}function fI(e){return hI.apply(this,arguments)}function hI(){return hI=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L;return(0,F.__generator)(this,(function(D){switch(D.label){case 0:t=e.textRanges,n=e.context,r=e.bold,o=e.italic,i=e.normalize,a=e.underline,s=e.strike,l=e.caps,c=e.fontSize,u=e.spacing,d=e.lang,p=e.fontName,g=e.color,m=e.bulleted,f=e.horizontalAlignment,e.verticalAlignment,h=e.highlight,D.label=1;case 1:return D.trys.push([1,3,,4]),v=[],[4,dI(t,n)];case 2:y=D.sent(),C=gI(r,o,i,a,s,l,c,u,d,p,g,h),S=function(e){var t={};if(!cF(e))switch(e){case"Left":t.align=wv.AlignLeft;break;case"Center":t.align=wv.AlignCenter;break;case"Right":t.align=wv.AlignRight;break;case"Justify":t.align=wv.AlignJustify;break;case"JustifyLow":t.align=wv.AlignJustifyLow;break;case"Distributed":t.align=wv.AlignDistributed;break;case"ThaiDistributed":t.align=wv.AlignThaiDistributed}return t}(f),b=!0,E=!1,T=void 0;try{for(I=y[Symbol.iterator]();!(b=(_=I.next()).done);b=!0)w=_.value,Object.keys(C).length>0&&(P=mI(mv.ModifyTextPropsCmd,w,C),v.push(P)),Object.keys(S).length>0&&(x=mI(mv.ModifyParaPropsCmd,w,S),v.push(x)),cF(m)||((k={}).bulletSize=YM,k.bulletProp=m?{char:ZM}:{},A=mI(mv.ModifyParaPropsCmd,w,k),v.push(A))}catch(e){E=!0,T=e}finally{try{b||null==I.return||I.return()}finally{if(E)throw T}}return[2,v];case 3:throw L=D.sent(),ZR("Exception while parsing the program for format_text OfficeJsPayload Json - "+L.toString()),new Error("Exception while parsing the program for format_text OfficeJsPayload Json ");case 4:return[2]}}))})),hI.apply(this,arguments)}var vI=sb.getInstance();function yI(e){return CI.apply(this,arguments)}function CI(){return(CI=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C;return(0,F.__generator)(this,(function(S){switch(S.label){case 0:t=e.context,n=e.textRanges,r=e.bold,o=e.italic,i=e.normalize,a=e.underline,s=e.strike,l=e.caps,c=e.fontSize,u=e.spacing,d=e.lang,p=e.fontName,g=e.color,m=e.bulleted,f=e.horizontalAlignment,h=e.verticalAlignment,v=e.highlight,S.label=1;case 1:return S.trys.push([1,3,,4]),[4,fI({context:t,textRanges:n,bold:r,italic:o,normalize:i,underline:a,strike:s,caps:l,fontSize:c,spacing:u,lang:d,fontName:p,color:g,bulleted:m,horizontalAlignment:f,verticalAlignment:h,highlight:v})];case 2:return y=S.sent(),vI.setScenarioName(Cv.FormatText),[2,y];case 3:throw C=S.sent(),ZR("Exception while parsing the program for format_text OfficeJsPayload Json - "+C.toString()),new Error("Exception while parsing the program for format_text OfficeJsPayload Json ");case 4:return[2]}}))}))).apply(this,arguments)}var SI=sb.getInstance();function bI(e){return EI.apply(this,arguments)}function EI(){return EI=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(h){switch(h.label){case 0:t=e.context,n=e.textRanges,r=e.text,o=e.textFormat,i=void 0===o?0:o,h.label=1;case 1:return h.trys.push([1,3,,4]),a=[],[4,ly(n,t)];case 2:s=h.sent(),r=gF(r),l=!0,c=!1,u=void 0;try{for(d=s[Symbol.iterator]();!(l=(p=d.next()).done);l=!0)cF((g=p.value).shapeId)||cF(g.slideId)||(m={version:Dv,name:mv.ReplaceTextCmd,data:{text:r,textFormat:i,shapeId:g.shapeId,slideId:g.slideId}},a.push(m))}catch(e){c=!0,u=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw u}}return SI.setScenarioName(Cv.ReplaceText),[2,a];case 3:throw f=h.sent(),ZR("Exception while parsing the program for OfficeJsPayload Json - "+f.toString()),new Error("Exception while parsing the program for OfficeJsPayload Json ");case 4:return[2]}}))})),EI.apply(this,arguments)}function TI(e){return II.apply(this,arguments)}function II(){return(II=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k;return(0,F.__generator)(this,(function(A){switch(A.label){case 0:if(t=e.context,n=e.textRanges,r=e.color,o=void 0===r?null:r,i=e.bold,a=void 0===i?null:i,s=e.italic,l=void 0===s?null:s,c=e.strikethrough,u=void 0===c?null:c,d=e.underline,p=void 0===d?null:d,g=e.fontName,m=void 0===g?null:g,f=e.size,h=void 0===f?null:f,v=e.bulleted,y=void 0===v?null:v,C=e.horizontalAlignment,S=void 0===C?null:C,b=e.verticalAlignment,E=void 0===b?null:b,T=e.casing,I=void 0===T?null:T,_=e.highlightColor,w=void 0===_?null:_,P=e.useOfficeJS,x=void 0!==P&&P,cF(n)||0===n.length)throw Gp("No text range found format text"),new Error("No text range found for format text");return k=py(Nv),sb.getInstance().setScenarioName(Cv.FormatText),Vh(Lh.IsjOFCCommandingWorkflowEnabled)&&(cF(x)||!0!==x)&&k?[3,2]:[4,VT({context:t,textRanges:n,color:o,bold:a,italic:l,underline:p,fontName:m,size:h,bulleted:y,horizontalAlignment:S,verticalAlignment:E})];case 1:return A.sent(),[2,[]];case 2:return[4,yI({context:t,textRanges:n,bold:a,italic:l,normalize:null,underline:p,strike:u,caps:I,fontSize:h,spacing:null,lang:null,fontName:m,horizontalAlignment:S,verticalAlignment:E,bulleted:y,color:o,highlight:w})];case 3:return[2,A.sent()]}}))}))).apply(this,arguments)}function _I(e){return wI.apply(this,arguments)}function wI(){return(wI=(0,gd._)((function(e){var t,n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.precededBy,r=e.text,o=e.isReplaceTextCmd,i=e.insertBeforeSelection,Vh(Lh.IsjOFCCommandingWorkflowEnabled)&&!cF(o)&&o?[3,2]:[4,JT({context:t,precededBy:n,text:r,insertBeforeSelection:i})];case 1:return[2,a.sent()];case 2:if(!py(Ov))throw new gC("Unsupported jOFC command");return[4,bI({context:t,textRanges:n,text:r,textFormat:0})];case 3:return[2,a.sent()]}}))}))).apply(this,arguments)}var PI=n(10480),xI=n(58651),kI=12700;function AI(e,t,n,r,o,i,a){return LI.apply(this,arguments)}function LI(){return LI=(0,gd._)((function(e,t,n,r,o,i,a){var s,l,c,u;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:return[4,ty(e,t)];case 1:return s=d.sent(),[4,iy(e,t)];case 2:return l=d.sent(),c=function(e,t,n,r){var o={};return cF(e)||(o.x=(null!=e?e:0)*kI),cF(t)||(o.y=(null!=t?t:0)*kI),cF(n)||(o.cy=(null!=n?n:0)*kI),cF(r)||(o.cx=(null!=r?r:0)*kI),o}(r,o,i,a),0===Object.keys(c).length?[2,null]:(u={shapeId:{id:+l.id},slideId:{id:+s.id,cId:+s.cId},props:c},Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&+s.id in n&&+l.id in n[+s.id]&&u.shapeId&&(u.shapeId.cId=n[+s.id][+l.id]),[2,u])}}))})),LI.apply(this,arguments)}function DI(e){switch(e){case"Front":default:return Pv.BringToFront;case"Back":return Pv.SendToBack;case"Forward":return Pv.BringForward;case"Backward":return Pv.SendBackward}}function OI(e,t,n,r){return NI.apply(this,arguments)}function NI(){return(NI=(0,gd._)((function(e,t,n,r){var o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return[4,ty(e,t)];case 1:return o=s.sent(),[4,iy(e,t)];case 2:return i=s.sent(),a={shapeId:{id:+i.id},slideId:{id:+o.id,cId:+o.cId},orderMode:DI(r)},Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&+o.id in n&&+i.id in n[+o.id]&&(a.shapeId.cId=n[+o.id][+i.id]),[2,a]}}))}))).apply(this,arguments)}function RI(e,t,n,r,o,i){return FI.apply(this,arguments)}function FI(){return(FI=(0,gd._)((function(e,t,n,r,o,i){var a,s,l;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:if(0===t.length)throw xI.error("No shapes selected"),new Error("No shapes selected");return[4,ty(e,t[0])];case 1:return a=i.sent(),[4,ry(e,t)];case 2:return s=i.sent(),l={slideId:{id:+a.id,cId:+a.cId},shapeIds:s},cF(n)?cF(r)||(l.alignMode=Wv.has(r)?Wv.get(r):4):l.alignMode=Wv.has(n)?Wv.get(n):0,cF(o)||(l.distributeMode=jv.has(o)?jv.get(o):0),l.relativeToSelection=s.length>=2,[2,l]}}))}))).apply(this,arguments)}function MI(e,t){var n=1;return cF(t)||(n=1-(null!=t?t:0)/100),uy(e,n)}function BI(e,t,n,r,o,i,a,s,l,c,u){var d={};if(cF(e)||(d.rad=(null!=e?e:0)*kI),!cF(t)){var p=MI(t,o);cF(p)||(d.clr=p)}return cF(n)||(d.dis=(null!=n?n:0)*kI),cF(r)||(d.dir={deg:r}),cF(i)||(d.sx=i),cF(a)||(d.sy=a),cF(s)||(d.kx=s),cF(l)||(d.ky=l),cF(c)?d.align=void 0:(null!=c?c:"")in tI&&(d.align=tI[null!=c?c:""]),cF(u)||(d.rotWithShape=u),d}function UI(e,t,n,r,o,i,a,s,l,c,u,d){var p={},g={};switch(null==e?void 0:e.toLowerCase()){case"inner":g=function(e,t,n,r,o){var i={};if(cF(e)||(i.rad=(null!=e?e:0)*kI),!cF(t)){var a=MI(t,o);cF(a)||(i.clr=a)}return cF(n)||(i.dis=(null!=n?n:0)*kI),cF(r)||(i.dir={deg:r}),i}(s,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0),0!==Object.keys(g).length&&(p.inShdw=g);break;case"outer":g=BI(s,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0,null!=o?o:void 0,i,a,void 0,void 0,n,!0),0!==Object.keys(g).length&&(p.outShdw=g);break;case"perspective":g=function(e,t,n,r,o){var i={};if(cF(e)||(null!=e?e:"")in eI&&(i.prst=eI[null!=e?e:""]),!cF(t)){var a=MI(t,o);cF(a)||(i.clr=a)}return cF(n)||(i.dis=(null!=n?n:0)*kI),cF(r)||(i.dir={deg:r}),i}(null!=t?t:void 0,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0),0!==Object.keys(g).length&&(p.prstShdw=g);break;default:g=BI(s,null!=r?r:void 0,null!=d?d:void 0,null!=u?u:void 0),0!==Object.keys(g).length&&(p.outShdw=g)}return p}function HI(e,t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T){return GI.apply(this,arguments)}function GI(){return(GI=(0,gd._)((function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T){var I,_,w,P,x;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return I={},t.load("type"),[4,e.sync()];case 1:return n.sent(),_=function(e){var t={};if(!cF(e)){var n=e.toLowerCase();n in $T&&(t.prst=$T[n])}return t}(t.type),0!==Object.keys(_).length&&(I.geo=_),w=function(e,t){var n={};if(!cF(e)){var r=MI(e,t);cF(r)||(n.solid=r)}return n}(u,d),0!==Object.keys(w).length&&(I.fill=w),P=function(e,t,n,r){var o={};if(!cF(e)){var i=MI(e,r);if(!cF(i)){var a={solid:i};o.fill=a}}return cF(n)||(o.width=n*kI),o}(a,0,l,c),0!==Object.keys(P).length&&(I.line=P),x=UI(p,g,m,f,h,v,y,C,0,0,E,T),0!==Object.keys(x).length&&(I.fx=x),[2,I]}}))}))).apply(this,arguments)}function zI(e,t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I){return qI.apply(this,arguments)}function qI(){return qI=(0,gd._)((function(e,t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I){var _,w,P,x;return(0,F.__generator)(this,(function(k){switch(k.label){case 0:return[4,HI(e,t,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I)];case 1:return _=k.sent(),0===Object.keys(_).length?[2,{}]:[4,ty(e,t)];case 2:return w=k.sent(),[4,iy(e,t)];case 3:return P=k.sent(),x={shapeId:{id:+P.id},slideId:{id:+w.id,cId:+w.cId}},0!==Object.keys(_).length&&(x.props=_),Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&+w.id in n&&+P.id in n[+w.id]&&x.shapeId&&(x.shapeId.cId=n[+w.id][+P.id]),[2,x]}}))})),qI.apply(this,arguments)}function WI(e,t){return jI.apply(this,arguments)}function jI(){return jI=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:n={},r=!0,o=!1,i=void 0,g.label=1;case 1:g.trys.push([1,7,8,9]),a=t[Symbol.iterator](),g.label=2;case 2:return(r=(s=a.next()).done)?[3,6]:(l=s.value,[4,ty(e,l)]);case 3:return c=g.sent(),[4,iy(e,l)];case 4:u=g.sent(),c.id in n?n[c.id].shapeIds.push(u):n[c.id]={slideId:c,shapeIds:[u]},g.label=5;case 5:return r=!0,[3,2];case 6:return[3,9];case 7:return d=g.sent(),o=!0,i=d,[3,9];case 8:try{r||null==a.return||a.return()}finally{if(o)throw i}return[7];case 9:for(var m in p=[],n)p.push(n[m]);return[2,p]}}))})),jI.apply(this,arguments)}function VI(e,t,n,r,o,i,a){return QI.apply(this,arguments)}function QI(){return QI=(0,gd._)((function(e,t,n,r,o,i,a){var s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(e){if(s=function(e,t,n,r){var o={};if(cF(e))o.effectType=Mv.fxtypeEntrance,o.effectId=Bv.fxidFade;else{var i=null==e?void 0:e.toLowerCase();if((null!=i?i:"")in rI&&(o.effectType=rI[null!=i?i:""]),!cF(t)){var a,s=null!==(a=null==t?void 0:t.toLowerCase())&&void 0!==a?a:"";switch(o.effectType){case Mv.fxtypeEntrance:case Mv.fxtypeExit:s in oI&&(o.effectId=oI[s]);break;case Mv.fxtypeEmphasis:s in iI&&(o.effectId=iI[s]);break;case Mv.fxtypeMotionPath:s in aI&&(o.effectId=aI[s])}}}return cF(n)||(o.duration=n),cF(r)||(o.delay=r),o}(r,o,i,a),l={slideId:t.slideId,shapeIds:t.shapeIds},cF(s)||0===Object.keys(s).length||(l.props=s),Jh(Dh.ShouldUseCreationIdsForShapeCommands)){u=!0,d=!1,p=void 0;try{for(g=(null!==(c=l.shapeIds)&&void 0!==c?c:[])[Symbol.iterator]();!(u=(m=g.next()).done);u=!0)f=m.value,+t.slideId.id in n&&+f.id in n[+t.slideId.id]&&(f.cId=n[+t.slideId.id][+f.id])}catch(e){d=!0,p=e}finally{try{u||null==g.return||g.return()}finally{if(d)throw p}}}return[2,l]}))})),QI.apply(this,arguments)}function JI(e){return KI.apply(this,arguments)}function KI(){return KI=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,ge,me,fe,he,ve;return(0,F.__generator)(this,(function(F){switch(F.label){case 0:t=e.context,n=e.shapes,r=e.shapeIds,o=e.left,i=e.top,a=e.height,s=e.width,l=e.lineColor,c=e.lineDashStyle,e.lineStyle,u=e.lineWeight,d=e.lineTransparency,p=e.fillColor,g=e.fillTransparency,m=e.shadowType,f=e.shadowPreset,h=e.shadowAlign,v=e.shadowColor,y=e.shadowTransparency,C=e.shadowScaleX,S=e.shadowScaleY,b=e.shadowRadius,E=e.shadowSize,T=e.shadowBlur,I=e.shadowAngle,_=e.shadowDistance,w=e.alignHorizontal,P=e.alignVertical,x=e.distribute,k=e.alignRelative,A=e.animation,L=e.animationType,D=e.animationName,O=e.animationDuration,N=e.animationDelay,R=e.zOrder,F.label=1;case 1:F.trys.push([1,33,,34]),M=[],B={},Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&!cF(r)&&(B=function(e){var t={},n=e.split(","),r=!0,o=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value.split(":");if(2===l.length){var c=l[0],u=l[1],d=c.split("#"),p=u.split("#");if(!(d.length<1)){var g=+d[0],m=+p[0];if(2===p.length){var f=p[1].replace("{","").replace("}","");g in t||(t[g]={}),t[g][m]=f}}}}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return t}(null!=r?r:"")),U=!0,H=!1,G=void 0,F.label=2;case 2:F.trys.push([2,10,11,12]),z=n[Symbol.iterator](),F.label=3;case 3:return(U=(q=z.next()).done)?[3,9]:(W=q.value,[4,AI(t,W,B,null!=o?o:void 0,null!=i?i:void 0,null!=a?a:void 0,null!=s?s:void 0)]);case 4:return cF(j=F.sent())||(V={name:mv.TransformElementCmd,version:Dv,data:j},M.push(V)),cF(R)?[3,6]:[4,OI(t,W,B,R)];case 5:Q=F.sent(),J={name:mv.ModifyOrderCmd,version:Dv,data:Q},M.push(J),F.label=6;case 6:return[4,zI(t,W,B,null!=o?o:void 0,null!=i?i:void 0,null!=a?a:void 0,null!=s?s:void 0,null!=l?l:void 0,c,null!=u?u:void 0,null!=d?d:void 0,null!=p?p:void 0,null!=g?g:void 0,m,f,h,v,y,C,S,b,E,T,I,_)];case 7:cF(K=F.sent())||0===Object.keys(K).length||(X={name:mv.ModifyShapePropsCmd,version:Dv,data:K},M.push(X)),F.label=8;case 8:return U=!0,[3,3];case 9:return[3,12];case 10:return he=F.sent(),H=!0,G=he,[3,12];case 11:try{U||null==z.return||z.return()}finally{if(H)throw G}return[7];case 12:return cF(w)&&cF(P)&&cF(x)?[3,21]:Jh(Dh.ShouldUseSeparateHorizontalVerticalCommands)?cF(w)?[3,14]:[4,RI(t,n,null!=w?w:void 0,void 0,null!=x?x:void 0)]:[3,19];case 13:Z=F.sent(),Y={name:x?mv.DistributeShapesCmd:mv.ModifyAlignmentCmd,version:Dv,data:Z},M.push(Y),F.label=14;case 14:return cF(P)?[3,16]:[4,RI(t,n,void 0,null!=P?P:void 0,null!=x?x:void 0)];case 15:$=F.sent(),ee={name:x?mv.DistributeShapesCmd:mv.ModifyAlignmentCmd,version:Dv,data:$},M.push(ee),F.label=16;case 16:return cF(w)&&cF(P)&&!cF(x)?[4,RI(t,n,void 0,void 0,null!=x?x:void 0)]:[3,18];case 17:te=F.sent(),ne={name:x?mv.DistributeShapesCmd:mv.ModifyAlignmentCmd,version:Dv,data:te},M.push(ne),F.label=18;case 18:return[3,21];case 19:return[4,RI(t,n,null!=w?w:void 0,null!=P?P:void 0,null!=x?x:void 0,null!=k?k:void 0)];case 20:re=F.sent(),oe={name:x?mv.DistributeShapesCmd:mv.ModifyAlignmentCmd,version:Dv,data:re},M.push(oe),F.label=21;case 21:return cF(A)?[3,32]:[4,WI(t,n)];case 22:ie=F.sent(),ae=!0,se=!1,le=void 0,F.label=23;case 23:F.trys.push([23,30,31,32]),ce=ie[Symbol.iterator](),F.label=24;case 24:return(ae=(ue=ce.next()).done)?[3,29]:(de=ue.value,A?[4,VI(t,de,B,L,D,O,N)]:[3,26]);case 25:return pe=F.sent(),(0,PI.isNull)(pe)||0===Object.keys(pe).length||(ge={name:mv.NewAnimationEffectCmd,data:pe},M.push(ge)),[3,28];case 26:return[4,VI(t,de,B)];case 27:me=F.sent(),(0,PI.isNull)(me)||0===Object.keys(me).length||(fe={name:mv.DeleteAllDrawingElementAnimationEffectsCmd,data:me},M.push(fe)),F.label=28;case 28:return ae=!0,[3,24];case 29:return[3,32];case 30:return he=F.sent(),se=!0,le=he,[3,32];case 31:try{ae||null==ce.return||ce.return()}finally{if(se)throw le}return[7];case 32:return sb.getInstance().setScenarioName(Cv.FormatShape),[2,M];case 33:throw ve=F.sent(),ZR("Exception while parsing the program for OfficeJsPayload Json for format_shape - "+ve.toString()),new Error("Exception while parsing the program for OfficeJsPayload Json ");case 34:return[2]}}))})),KI.apply(this,arguments)}function XI(e){return ZI.apply(this,arguments)}function ZI(){return ZI=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H;return(0,F.__generator)(this,(function(F){switch(F.label){case 0:if(t=e.context,n=e.shapes,r=e.shapeIds,o=e.left,i=e.top,a=e.height,s=e.width,l=e.lineColor,c=e.lineDashStyle,u=e.lineStyle,d=e.lineWeight,p=e.lineTransparency,g=e.fillColor,m=e.fillTransparency,f=e.shadowType,h=e.shadowPreset,v=e.shadowAlign,y=e.shadowColor,C=e.shadowTransparency,S=e.shadowScaleX,b=e.shadowScaleY,E=e.shadowRadius,T=e.shadowSize,I=e.shadowBlur,_=e.shadowAngle,w=e.shadowDistance,P=e.alignHorizontal,x=e.alignVertical,k=e.distribute,A=e.alignRelative,L=e.zOrder,D=e.animation,O=e.animationType,N=e.animationName,R=e.animationDuration,M=e.animationDelay,B=e.useOfficeJS,!((U=py(Nv))||(Qv(D)||!0!==D)&&Qv(O)&&Qv(N)&&Qv(R)&&Qv(f)&&Qv(h)&&Qv(y)&&Qv(C)&&Qv(v)&&Qv(S)&&Qv(b)&&Qv(E)&&Qv(T)&&Qv(I)&&Qv(_)&&Qv(w)&&Qv(P)&&Qv(x)&&Qv(k)&&Qv(A)&&Qv(L)))throw new gC(Rv);if(H=Jh(Dh.ShouldForceOfficeJSImplementationForCommanding)&&!Qv(B)&&!0===B,!Vh(Lh.IsjOFCCommandingWorkflowEnabled)||!U||H)return[2,Ey({context:t,shapes:n,left:o,top:i,height:a,width:s,lineColor:l,lineDashStyle:c,lineWeight:d,lineTransparency:p,fillColor:g,fillTransparency:m})];if(0===n.length)throw Error("formatShapes: shapes array is empty");return[4,JI({context:t,shapes:n,shapeIds:r,left:o,top:i,height:a,width:s,lineColor:l,lineDashStyle:c,lineStyle:u,lineWeight:d,lineTransparency:p,fillColor:g,fillTransparency:m,shadowType:f,shadowPreset:h,shadowAlign:v,shadowColor:y,shadowTransparency:C,shadowScaleX:S,shadowScaleY:b,shadowRadius:E,shadowSize:T,shadowBlur:I,shadowAngle:_,shadowDistance:w,alignHorizontal:P,alignVertical:x,distribute:k,alignRelative:A,animation:D,animationType:O,animationName:N,animationDuration:R,animationDelay:M,zOrder:L})];case 1:return[2,F.sent()]}}))})),ZI.apply(this,arguments)}function YI(e,t,n,r){return{name:e,version:Dv,data:{slideId:t,shapeId:n,props:r}}}function $I(e){return e_.apply(this,arguments)}function e_(){return(e_=(0,gd._)((function(e){var t,n,r,o,i,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:try{sb.getInstance().setScenarioName(Cv.InsertList)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}if(!py(Nv))throw new gC(Rv);return t=e.context,n=e.textRanges,e.paragraphText,e.insertLocation,[4,ly(n,t)];case 1:if(r=l.sent(),o=[],(i={}).bulletSize=100,i.bulletProp={char:""},Object.keys(r).length>0)for(a=0;a<r.length;a++)Object.keys(i).length>0&&(s=YI(mv.ModifyParaPropsCmd,r[a].slideId,r[a].shapeId,i),o.push(s));return[2,o]}}))}))).apply(this,arguments)}function t_(e){return n_.apply(this,arguments)}function n_(){return(n_=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:try{sb.getInstance().setScenarioName(Cv.FormatList)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}if(!py(Nv))throw new gC(Rv);return t=e.context,n=e.textRanges,r=e.listLevel,o=e.listLevelBullet,i=e.listLevelNumbering,[4,ly(n,t)];case 1:if(a=g.sent(),s=[],(l={}).bulletSize=100,l.bulletProp={char:""},null!=o&&"None"===o?l.bulletProp={}:null!=o&&(c=String.fromCharCode(parseInt(o,16)),l.bulletProp={char:c}),null!=i&&(u=Vv.has(i)?Vv.get(i):Vv.get("arabicPeriod"),l.bulletProp={autoNum:{scheme:u,start:1}}),null!=r&&(l.indentLv=r),Object.keys(a).length>0)for(d=0;d<a.length;d++)Object.keys(l).length>0&&(p=YI(mv.ModifyParaPropsCmd,a[d].slideId,a[d].shapeId,l),s.push(p));return[2,s]}}))}))).apply(this,arguments)}var r_=sb.getInstance();function o_(e){return i_.apply(this,arguments)}function i_(){return(i_=(0,gd._)((function(e){var t,n,r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return t=e.context,n=e.description,r=e.slides,o=e.useOfficeJS,i=void 0!==o&&o,!py(Ov)||Jh(Dh.ShouldForceOfficeJSImplementationForCommanding)&&!Qv(i)&&i?[2,xy({context:t,description:n,slides:r})]:[4,dT({context:t,slides:r,description:n})];case 1:return a=s.sent(),r_.setScenarioName(Cv.InsertImage),[2,a]}}))}))).apply(this,arguments)}function a_(e){return s_.apply(this,arguments)}function s_(){return(s_=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:t=e.context,n=e.slides,r=void 0===n?null:n,o=e.slideIds,i=void 0===o?null:o,a=e.name,s=void 0===a?null:a,l=e.id,c=void 0===l?null:l,u=void 0;try{sb.getInstance().setScenarioName(Cv.AddSection)}catch(e){Gp("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return sb.getInstance().setScenarioName(Cv.AddSection),cF(i)?[3,1]:((p=null!==(d=null==i?void 0:i.split("#"))&&void 0!==d?d:[]).length>=2&&(u={type:lv.Slide,id:+p[0],cId:+p[1]}),[3,3]);case 1:return!cF(r)&&(null!=r?r:[]).length>0?[4,Kv(t,null!=r?r:[])]:[3,3];case 2:g=v.sent(),(m=g.split("#")).length>=2&&(u={type:lv.Slide,id:+m[0],cId:+m[1]}),v.label=3;case 3:return f={},cF(c)?f.guid=dy():f.guid=null!=c?c:"",cF(s)||(f.title=null!=s?s:""),h={name:mv.AddSectionCmd,data:f},cF(u)||(h.after=u),[2,h]}}))}))).apply(this,arguments)}function l_(e){return c_.apply(this,arguments)}function c_(){return(c_=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c;return(0,F.__generator)(this,(function(u){switch(u.label){case 0:if(t=e.context,n=e.slides,r=void 0===n?null:n,o=e.slideIds,i=void 0===o?null:o,a=e.name,s=void 0===a?null:a,l=e.id,c=void 0===l?null:l,!py(Ov))throw new gC(Rv);return[4,a_({context:t,slides:r,slideIds:i,name:s,id:c})];case 1:return[2,u.sent()]}}))}))).apply(this,arguments)}function u_(e,t){return d_.apply(this,arguments)}function d_(){return(d_=(0,gd._)((function(e,t){return(0,F.__generator)(this,(function(e){return[2,{text:t.text,color:t.font.color,bold:t.font.bold,italic:t.font.italic,underline:t.font.underline,fontName:t.font.name,size:t.font.size,bulleted:t.paragraphFormat.bulletFormat.visible}]}))}))).apply(this,arguments)}function p_(e,t,n){return g_.apply(this,arguments)}function g_(){return g_=(0,gd._)((function(e,t,n){var r,o,i,a,s=arguments;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:return null==(r=s.length>3&&void 0!==s[3]?s[3]:null)||""==r.text?t.type==PowerPoint.ShapeType.geometricShape&&(o=t.textFrame.textRange):o=r,i={index:n,id:t.id},t.type!=PowerPoint.ShapeType.geometricShape?[3,2]:[4,u_(e,o)];case 1:return a=l.sent(),[3,3];case 2:a=null,l.label=3;case 3:return i.textRange=a,i.type=t.type,i.name=t.name,i.left=t.left,i.top=t.top,i.height=t.height,i.width=t.width,i.area=t.height*t.width,i.lineColor=t.lineFormat.color,i.lineDashStyle=t.lineFormat.dashStyle,i.lineWeight=t.lineFormat.weight,i.lineTransparency=t.lineFormat.transparency,i.fillColor=t.fill.foregroundColor,i.fillTransparency=t.fill.transparency,[2,i]}}))})),g_.apply(this,arguments)}function m_(e,t,n){return f_.apply(this,arguments)}function f_(){return f_=(0,gd._)((function(e,t,n){var r,o,i,a,s,l,c,u=arguments;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:o=u.length>4&&void 0!==u[4]?u[4]:null,i=null==(r=u.length>3&&void 0!==u[3]?u[3]:null)?t.shapes.items:r,a={index:n,id:t.id,shapes:[]},s=0,d.label=1;case 1:return s<i.length?(c=(l=a.shapes).push,[4,p_(e,i[s],s,o)]):[3,4];case 2:c.apply(l,[d.sent()]),d.label=3;case 3:return s++,[3,1];case 4:return[2,a]}}))})),f_.apply(this,arguments)}function h_(e){return v_.apply(this,arguments)}function v_(){return(v_=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return e.load("type,\n    name,\n    left,\n    top,\n    height,\n    width,\n    lineFormat/color,\n    lineFormat/dashStyle,\n    lineFormat/weight,\n    lineFormat/transparency,\n    fill/foregroundColor,\n    fill/transparency"),[2]}))}))).apply(this,arguments)}function y_(e){return C_.apply(this,arguments)}function C_(){return(C_=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return e.load("textFrame,\n    textFrame/textRange,\n    textFrame/textRange/text,\n    textFrame/textRange/font/color,\n    textFrame/textRange/font/bold,\n    textFrame/textRange/font/italic,\n    textFrame/textRange/font/underline,\n    textFrame/textRange/font/name,\n    textFrame/textRange/font/size,\n    textFrame/textRange/paragraphFormat/bulletFormat/visible"),[2]}))}))).apply(this,arguments)}function S_(){return(S_=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E;return(0,F.__generator)(this,(function(T){switch(T.label){case 0:t={slides:[]},T.label=1;case 1:return T.trys.push([1,33,,34]),(n=e.presentation.getSelectedTextRangeOrNullObject()).load("isNullObject"),(r=e.presentation.getSelectedShapes()).load("items,\n       items/id"),(o=e.presentation.slides).load("items, items/id"),(i=e.presentation.getSelectedSlides()).load("items,\n      items/id"),[4,e.sync()];case 2:if(T.sent(),a=[],s=[],l=[],Jh(Dh.UseCorrectSlideIndexInPPTOdslSignal)&&(a=o.items.map((function(e){return e.id})),s=i.items.map((function(e){return e.id})),l=s.map((function(e){return a.indexOf(e)}))),n.isNullObject&&(n=null),0==r.items.length&&(r=null),null!=r)return[3,17];for(c=0;c<i.items.length;c++)i.items[c].load("Shapes, Shapes/items");return[4,e.sync()];case 3:T.sent(),u=0,T.label=4;case 4:if(!(u<i.items.length))return[3,9];d=i.items[u],p=0,T.label=5;case 5:return p<d.shapes.items.length?[4,h_(d.shapes.items[p])]:[3,8];case 6:T.sent(),T.label=7;case 7:return p++,[3,5];case 8:return u++,[3,4];case 9:return[4,e.sync()];case 10:T.sent(),g=0,T.label=11;case 11:if(!(g<i.items.length))return[3,16];m=i.items[g],f=0,T.label=12;case 12:return f<m.shapes.items.length?m.shapes.items[f].type!=PowerPoint.ShapeType.geometricShape?[3,14]:[4,y_(m.shapes.items[f])]:[3,15];case 13:T.sent(),T.label=14;case 14:return f++,[3,12];case 15:return g++,[3,11];case 16:return[3,27];case 17:h=0,T.label=18;case 18:return h<r.items.length?[4,h_(r.items[h])]:[3,21];case 19:T.sent(),T.label=20;case 20:return h++,[3,18];case 21:return[4,e.sync()];case 22:T.sent(),v=0,T.label=23;case 23:return v<r.items.length?r.items[v].type!=PowerPoint.ShapeType.geometricShape?[3,25]:[4,y_(r.items[v])]:[3,26];case 24:T.sent(),T.label=25;case 25:return v++,[3,23];case 26:null!=n&&n.load("text,\n        font/color,\n        font/bold,\n        font/italic,\n        font/underline,\n        font/name,\n        font/size,\n        paragraphFormat/bulletFormat/visible"),T.label=27;case 27:return[4,e.sync()];case 28:T.sent(),y=0,T.label=29;case 29:return y<i.items.length?(b=(S=t.slides).push,[4,m_(e,i.items[y],Jh(Dh.UseCorrectSlideIndexInPPTOdslSignal)&&null!==(C=l[y])&&void 0!==C?C:y,null==r?null:r.items,n)]):[3,32];case 30:b.apply(S,[T.sent()]),T.label=31;case 31:return y++,[3,29];case 32:return[3,34];case 33:throw E=T.sent(),ZR("exception in getSelectionContextTree: ",E.message+"\n"+E.stack),E;case 34:return[2,t]}}))}))).apply(this,arguments)}const b_=function(e){return S_.apply(this,arguments)};function E_(e,t,n,r){var o=function(e,t){for(var n="<html><table><tbody>",r=0;r<e;r++){n+="<tr>";for(var o=0;o<t;o++)n+="<td></td>";n+="</tr>"}return n+"</tbody></table></html>"}(e,t);return{shapeGuid:dy(),tableHtml:o}}function T_(e){return I_.apply(this,arguments)}function I_(){return I_=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y;return(0,F.__generator)(this,(function(C){switch(C.label){case 0:t=e.context,n=e.slides,r=e.rows,o=void 0===r?2:r,i=e.columns,a=void 0===i?5:i,e.insertLocation,e.value;try{sb.getInstance().setScenarioName(Cv.CreateTable)}catch(e){Gp("Exception while setting the scenario name for create_table OfficeJsPayload Json "+e.toString())}if(!py(Nv))throw new gC(Rv);C.label=1;case 1:return C.trys.push([1,7,,8]),s=[],l=[],Qv(n)?[3,3]:[4,sy(t,n)];case 2:return l=C.sent(),[3,6];case 3:return[4,Yv(t)];case 4:return c=C.sent(),[4,sy(t,c)];case 5:if(0===(l=C.sent()).length)throw new Error("No slides selected");l=[l[0]],C.label=6;case 6:u=!0,d=!1,p=void 0;try{for(g=l[Symbol.iterator]();!(u=(m=g.next()).done);u=!0)f=m.value,h=E_(o,a),v={name:mv.AddTableCmd,slideId:f,data:h},s.push(v)}catch(e){d=!0,p=e}finally{try{u||null==g.return||g.return()}finally{if(d)throw p}}return[2,s];case 7:throw y=C.sent(),Gp("Exception while parsing the program for create_table OfficeJsPayload Json "+y.toString()),new Error("Exception while parsing the program for create_table OfficeJsPayload Json ");case 8:return[2]}}))})),I_.apply(this,arguments)}function __(e){return w_.apply(this,arguments)}function w_(){return(w_=(0,gd._)((function(e){var t,n,r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return t=e.context,n=e.slides,r=e.rows,o=e.columns,i=e.insertLocation,a=e.value,[4,T_({context:t,slides:n,rows:r,columns:o,insertLocation:i,value:a})];case 1:return[2,s.sent()]}}))}))).apply(this,arguments)}var P_={selectSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,My(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,HD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,zD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),moveSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,WD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),undoApplication:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,xT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertSection:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,l_(e)]}))}));return function(t){return e.apply(this,arguments)}}(),generateSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,VD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,XD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,MT(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,_I(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,TI(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,WT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesShape:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,yy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesSlide:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,Uy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,GT(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectTextIndex:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,qT(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,hy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,Sy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,XI(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Iy(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertImages:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,o_(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteFooters:function(e){return YD(e)},setFooters:function(e){return JD(e)},transitionSlides:function(e){return eO(e)},insertList:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,$I(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatList:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,t_(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertTables:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,__(e)]}))}));return function(t){return e.apply(this,arguments)}}()};function x_(e,t,n){return t<e.length-1&&e[t+1].name===n}function k_(e,t,n){return t>0&&e[t-1].name===n}function A_(e,t,n){return!cF(n)&&0!==n.length&&(t<e.length&&"generateSlides"===e[t].name&&n in e[t].arguments)}function L_(e,t,n){return!(!Vh(Lh.IsjOFCCommandingWorkflowEnabled)||"deleteText"!==e||!x_(t,n,"insertText"))||!!(Jh(Dh.ChooseGenerateWithSourceOverPrompt)&&"generateSlides"===e&&(Jh(Dh.LogChatEventWhenPromptAndSourceInSingleGenerateSlides)&&A_(t,n,"prompt")||!Jh(Dh.LogChatEventWhenPromptAndSourceInSingleGenerateSlides)&&function(e,t){return t<e.length&&"generateSlides"===e[t].name&&"prompt"in e[t].arguments}(t,n))&&function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if("generateSlides"===a.name&&"source"in a.arguments)return!0}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return!1}(t))}function D_(e){return"context"===e||"slides"===e||"shapes"===e||"images"===e||"textRanges"===e}function O_(e){var t=e.telemetryEventHandler,n=e.commands,r=e.error,o=e.scenario,a=e.success,s=e.errorMessage,l=e.TranspilationLatencyMSec;if(!cF(t)){var c=0,u=!0,d=!1,p=void 0;try{for(var g,m=n[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var f=g.value,h="None";!cF(o)&&f in o&&o[f]&&(h=o[f]);var v,y=c===n.length-1;t.updateTelemetryCommandingData((v={},(0,i._)(v,wC.EventOrder,c),(0,i._)(v,wC.CommandName,f),(0,i._)(v,wC.Status,PC.Executed),(0,i._)(v,wC.IsCommandSuccessString,!cF(a)&&a?"true":"false"),(0,i._)(v,wC.ErrorCategory,r),(0,i._)(v,wC.ScenarioString,h),(0,i._)(v,wC.IsLastStatement,y?"true":"false"),(0,i._)(v,wC.Message,s||"NA"),(0,i._)(v,wC.TranspilationLatencyMSec,l||0),v)),++c}}catch(e){d=!0,p=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw p}}}}function N_(e,t,n,r,o){Jh(Dh.ShouldEnableCommandingTelemetry)&&(cF(e)||(Jh(Dh.IsErrorMessageLogAllowedForCommanding)||(o="LogNotEnabled"),O_({telemetryEventHandler:e,commands:t,error:n,scenario:r,success:!1,errorMessage:o})))}function R_(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0;Jh(Dh.ShouldEnableCommandingTelemetry)&&(cF(e)||O_({telemetryEventHandler:e,commands:t,error:o?xC.PartialSuccess:xC.None,scenario:n,success:!0,TranspilationLatencyMSec:r}))}var F_=function(e,t,n,r){if(Jh(Dh.IsTelemetryEnabledForCommandingFailureCases)){var o=[],i={},a=QS.getInstance(YS.getInstance());if(null!=e&&"function"==typeof e[Symbol.iterator]){var s=!0,l=!1,c=void 0;try{for(var u,d=e[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var p=u.value,g=p.name;o.push(g);var m="";for(var f in p.arguments)D_(f)||(m+=f+",");i[g]=m.slice(0,-1)}}catch(e){l=!0,c=e}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}else o.push("NoCommand");t?R_(a,o,i,0,!1):N_(a,o,null!=n?n:xC.None,i,r)}};function M_(e,t,n,r,o){return B_.apply(this,arguments)}function B_(){return B_=(0,gd._)((function(e,t,n,r,o){var a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:if(!zR.IsSettingTrue(DR.PPTCopilotUseScenarioOptionsTelemetry))return[2];a=sb.getInstance(),s=void 0,(l=Jh(Dh.IsScenarioErrorTelemetryEnabled))&&(t&&a.addScenarioError(t),(c=a.getScenarioErrors())&&(s=c.join(","))),n&&n!==a.getScenarioName()&&a.setScenarioName(n),u=a.getUserQueryGuid().length>0?a.getUserQueryGuid():ob.getInstance().getQueryGuid(),d={scenarioName:a.getScenarioName(),startTime:a.getStartTime(),entryPoint:XM.Chat,correlationId:u,timeToODSLMS:1e3*a.getResponseTime(),timeODSLToJOfcMS:-1,copilotScenarioResult:{Success:e,ErrorReason:l?s:t},capability:a.getCapability(),featureName:a.getFeatureName(),subFeatureName:a.getSubFeatureName(),querySubmitTime:qp.qD,additionalSystemMetadataInfo:r,additionalComponentDataInfo:o},ZR("reportCopilotResultToHostApp with scenarioOption: ".concat(JSON.stringify(d))),(p={}).scenarioOptions=JSON.stringify(d),v.label=1;case 1:return v.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return _p.GetHostAppPlatform()!==SM&&_p.GetHostAppPlatform()!==yM?[3,2]:(Vh(Lh.UseCopilotActionCommands)&&Office.context.requirements.isSetSupported(kB,AB)?(ZR("CopilotAction API supported and using : "+Office.context.requirements.isSetSupported(kB,AB)),t={scenarioOptions:p.scenarioOptions?JSON.parse(p.scenarioOptions):void 0,designerOptions:p.designerOptions?JSON.parse(p.designerOptions):void 0,selectionOptions:p.selectionOptions?JSON.parse(p.selectionOptions):void 0},e.presentation.copilotActionAsync(xB,JSON.stringify(t))):e.presentation.applyJOfcCommandsAsync("",p),[4,e.sync()]);case 1:return r.sent(),[3,4];case 2:return Vh(Lh.UseCopilotActionCommands)?(ZR("CopilotAction API supported and using : true"),n={scenarioOptions:p.scenarioOptions?JSON.parse(p.scenarioOptions):void 0,designerOptions:p.designerOptions?JSON.parse(p.designerOptions):void 0,selectionOptions:p.selectionOptions?JSON.parse(p.selectionOptions):void 0},e.presentation.copilotAction(xB,JSON.stringify(n))):e.presentation.applyJOfcCommands("",p),[4,e.sync()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return v.sent(),Jh(Dh.SetScenarioNameEnabled)?Jh(Dh.LogChatEventWhenMakingAJOFCCall)&&ob.getInstance().sendChatEventTelemetry(HS((g={},(0,i._)(g,cC.ChatEventType,dC.JOFCCommandExecuted),(0,i._)(g,cC.ChatEventParameters,"reportCopilotResultToHostApp"),(0,i._)(g,cC.UserQueryGuid,u),g))):Jh(Dh.LogChatEventWhenMakingAJOFCCall)&&ob.getInstance().sendChatEventTelemetry(HS((m={},(0,i._)(m,cC.ChatEventType,dC.JOFCCommandExecuted),(0,i._)(m,cC.ChatEventParameters,"reportCopilotResultToHostApp"),m))),[3,4];case 3:return f=v.sent(),h="reportCopilotResultToHostApp applyJOfcCommandsAsync Execution failed: ".concat(null==f?void 0:f.message),ZR(h),YS.getInstance().logError({eventType:IC.ChatEvents,errorMessage:h}),[3,4];case 4:return a.resetData(),[2]}}))})),B_.apply(this,arguments)}function U_(e){return H_.apply(this,arguments)}function H_(){return(H_=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){return(t=sb.getInstance().getScenarioName())!==Cv.CreatePresentation&&t!==Cv.CreatePresentationFromDoc&&t!==Cv.AddSlide&&t!==Cv.InsertImage&&t!==Cv.Beautify&&t!==Cv.Animate||M_(!1,e),[2]}))}))).apply(this,arguments)}var G_=null,z_=null,q_="JOfcCommands",W_=sb.getInstance(),j_=0,V_=ob.getInstance();function Q_(e,t,n,r,o,i){return J_.apply(this,arguments)}function J_(){return J_=(0,gd._)((function(e,t,n,r,o,a){var s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,ge,me,fe,he,ve;return(0,F.__generator)(this,(function(F){switch(F.label){case 0:G_=YS.getInstance(),z_=QS.getInstance(G_),s=1,l=!1,c=!1,u=[],d=[],p=null,g={},m={},f=-1,h=!1,v=!1,y=!1,C=[],S={},b=void 0,F.label=1;case 1:if(F.trys.push([1,17,,18]),Jh(Dh.IsMultipleGenerateSlidesCommandDisabled)&&function(e){var t=0,n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0)if("generateSlides"===i.value.name&&++t>1)return!0}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return!1}(t))throw new mC("Multiple generateSlides is not supported");E=!0,T=!1,I=void 0,F.label=2;case 2:F.trys.push([2,14,15,16]),_=t[Symbol.iterator](),F.label=3;case 3:if(E=(w=_.next()).done)return[3,13];if(P=w.value,++f,x="",k=P.name,Jh(Dh.ShouldEnableCommandingTelemetry)&&(C.push(k),function(e,t,n){var r;Jh(Dh.ShouldEnableCommandingTelemetry)&&(cF(e)||Jh(Dh.ShouldEnableCommandingTelemetry)&&e.updateTelemetryCommandingData((r={},(0,i._)(r,wC.EventOrder,n),(0,i._)(r,wC.CommandName,t),(0,i._)(r,wC.Status,PC.Initialize),(0,i._)(r,wC.IsCommandSuccessString,"false"),(0,i._)(r,wC.ErrorCategory,xC.None),(0,i._)(r,wC.ScenarioString,"None"),(0,i._)(r,wC.Message,"NA"),r)))}(z_,k,s)),"imageInvalid"===P.name)throw b=vp.IMAGE_INVALID,new fC("Image is invalid");if(Jh(Dh.HandleUnsupportedCommandErrorCode)&&"invalidRequest"===P.name)throw new gC("Command is not supported");if(!hT.includes(k))throw new Error("Unexpected function name: ".concat(k));if(!P_[k])throw new Error("Function not implemented: ".concat(k));if("formatText"===k&&!Jh(Dh.IsFormatTextEnabled))throw new gC("Format Text is not supported");if("insertText"===k&&!Jh(Dh.IsAddTextEnabled))throw new gC("Insert Text is not supported");if("insertImages"===k&&!Jh(Dh.IsAddImageEnabled))throw new gC("Insert image is not supported");if(Jh(Dh.LogChatEventWhenPromptAndSourceInSingleGenerateSlides)&&"generateSlides"===k&&(A=A_(t,f,"source"),L=A_(t,f,"prompt"),A&&L))throw ob.getInstance().sendChatEventTelemetry(HS((D={},(0,i._)(D,cC.ChatEventType,dC.CommandingSourceAndPromptInGenerates),(0,i._)(D,cC.ChatEventParameters,"SameGenerateStatement"),D))),new gC("GenerateSlides with prompt and source in single generate statement is not supported.");if(Jh(Dh.ShouldDisableAllCommandsAfterGenerateSlides))if("generateSlides"===k)y=!0;else if(y)return[3,12];if("insertText"===k&&!r&&zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin))throw new yC("Content generation is disabled by admin");if(void 0!==P.dismissedArguments&&(l=!0,Jh(Dh.IsCommandingBlockedWithDismissedArgument)))throw b=vp.DISMISSED_ARGUMENTS,new fC("Dismissed Arguments");if(O={},L_(k,t,f))return[3,12];for(var ye in O.context=e,N="",P.arguments)x+=ye+",",Jh(Dh.ShouldEnableCommandingTelemetry)&&!D_(ye)&&(N+=ye+","),O[ye]=PT(P.arguments[ye],m);return R=function(e,t,n,r,o,i){if(Vh(Lh.IsjOFCCommandingWorkflowEnabled)&&("insertText"===t&&k_(n,r,"deleteText")?(e.isReplaceTextCmd=!0,i=!0):"formatText"===t&&k_(n,r,"selectIndicesText")&&(e.useOfficeJS=!0)),Jh(Dh.ShouldForceOfficeJSImplementationForCommanding)){var a=("insertImages"===t||"insertShapes"===t)&&x_(n,r,"formatShapes"),s="formatShapes"===t&&(k_(n,r,"insertImages")||k_(n,r,"insertShapes")),l=!i&&"formatText"===t&&k_(n,r,"insertText");(a||s||l)&&(e.useOfficeJS=!0)}return"insertText"===t&&k_(n,r,"deleteText")&&(e.insertBeforeSelection=!0),"slides"in o&&("selectShapes"!==t||"slides"in e?"selectSlides"===t&&(k_(n,r,"selectSlides")?e.slides=o.slides:delete e.slides):e.slides=o.slides),Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&"shapeIds"in o&&(e.shapeIds=o.shapeIds),{args:e,isTextReplaceCmd:i}}(O,k,t,f,m,v),O=R.args,v=R.isTextReplaceCmd,x=x.slice(0,-1),Jh(Dh.ShouldEnableCommandingTelemetry)&&(S[k]=N.slice(0,-1)),O.isFromOrganizePresentation=r,o&&(O.groundingInfo=o),a&&(O.chatConversations=a),M=P_[k],B=(new Date).getTime(),[4,M(O)];case 4:return U=F.sent(),function(e){return"setFooters"===e||"insertTables"===e}(k)&&(h=!0),"insertSlides"!==k&&"insertImages"!==k&&"moveSlides"!==k&&"insertSection"!==k?[3,11]:zR.IsSettingTrue(DR.PPTCopilotScnCreatePresFromPrompt)&&U.name===mv.CreatePresentationCmd?[4,$_(U,g)]:[3,6];case 5:U=F.sent(),F.label=6;case 6:return U.name!==mv.CreatePresentationCmd?[3,8]:[4,tw(U)];case 7:U=F.sent(),F.label=8;case 8:return c||U.name!==mv.AddSlidesCmd?[3,10]:(c=!0,[4,rw(U,g)]);case 9:U=F.sent(),F.label=10;case 10:if("moveSlides"===k&&nv(U,Array)){H=!0,G=!1,z=void 0;try{for(q=U[Symbol.iterator]();!(H=(W=q.next()).done);H=!0)j=W.value,u.push(j)}catch(e){G=!0,z=e}finally{try{H||null==q.return||q.return()}finally{if(G)throw z}}}else"insertImages"===k&&"useOfficeJS"in O&&!0===O.useOfficeJS||u.push(U);F.label=11;case 11:if("selectShapes"===k&&Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&(U=(V=U).shapes,O.shapeIds=V.shapeIds),u=function(e,t,n,r){if(Vh(Lh.IsjOFCCommandingWorkflowEnabled)||"insertTables"===n)switch(n){case"formatText":var o=!0,i=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;e.push(c)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}break;case"formatSlides":"isVisible"in r&&e.push(t);break;case"deleteSlides":case"setFooters":case"transitionSlides":e.push(t);break;case"insertText":if("isReplaceTextCmd"in r){var u=!0,d=!1,p=void 0;try{for(var g,m=t[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var f=g.value;e.push(f)}}catch(e){d=!0,p=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw p}}}break;case"formatList":case"insertList":case"insertTables":var h=!0,v=!1,y=void 0;try{for(var C,S=t[Symbol.iterator]();!(h=(C=S.next()).done);h=!0){var b=C.value;e.push(b)}}catch(e){v=!0,y=e}finally{try{h||null==S.return||S.return()}finally{if(v)throw y}}}return e}(u,U,k,O),"formatSlides"!==k||null===U||"isVisible"in O||("trigger"in U?p=U:d.push(U)),Vh(Lh.IsjOFCCommandingWorkflowEnabled)&&"formatShapes"===k&&null!==U&&Array.isArray(U)){Q=!0,J=!1,K=void 0;try{for(X=U[Symbol.iterator]();!(Q=(Z=X.next()).done);Q=!0)Y=Z.value,u.push(Y)}catch(e){J=!0,K=e}finally{try{Q||null==X.return||X.return()}finally{if(J)throw K}}}ZR("Execution Completed "+k+" Time Taken : "+(0,qp.xJ)(B)+" sec.  with args: ",O),U&&Array.isArray(U)&&ZR(k+" returned "+U.length+" items"),z_.updateTelemetryOfficeJSOperationData(($={},(0,i._)($,lC.OperationOrder,s),(0,i._)($,lC.EventState,"Success"),(0,i._)($,lC.OperationType,k),(0,i._)($,lC.OperationParameters,x),(0,i._)($,lC.TimeDurationInMs,(0,qp.xJ)(B)),(0,i._)($,lC.OfficeJSApi,q_),$)),ee=Jh(Dh.ShouldForceOfficeJSImplementationForCommanding),P.returns&&"formatSlides"!==k&&"insertSlides"!==k&&("insertImages"!==k||ee)&&(m[P.returns]=U),"selectShapes"===k&&Jh(Dh.ShouldUseCreationIdsForShapeCommands)&&"shapeIds"in O&&(m.shapeIds=O.shapeIds),s++,j_+=(0,qp.xJ)(B),F.label=12;case 12:return E=!0,[3,3];case 13:return[3,16];case 14:return te=F.sent(),T=!0,I=te,[3,16];case 15:try{E||null==_.return||_.return()}finally{if(T)throw I}return[7];case 16:return[3,18];case 17:return ne=F.sent(),re=null==ne?void 0:ne.message,ZR("Execute statements failed:"+JSON.stringify(ne)+" Error message: "+re),G_.logError({eventType:IC.ChatEvents,errorMessage:"Execute statements failed Error message: "+re}),nv(ne,gC)?(N_(z_,C,xC.Unsupported,S,re),U_("UnsupportedCommandError"),Jh(Dh.HandleUnsupportedCommandErrorCode)?[2,{status:Md.UNSUPPORTED,error:Bd.COMMANDING_DISABLED}]:[2,{status:Md.UNSUPPORTED}]):nv(ne,hC)?(N_(z_,C,xC.Blocked,S,re),U_("CreatePresentationBlockedError"),[2,{status:Md.BLOCKED,error:Bd.CREATE_PRESENTATION_BLOCKED}]):nv(ne,vC)?(N_(z_,C,xC.Blocked,S,re),U_("StructurePresentationBlockedError"),[2,{status:Md.BLOCKED,error:Bd.STRUCTURE_PRESENTATION_BLOCKED}]):nv(ne,yC)?(N_(z_,C,xC.ContentGenerationDisabled,S,re),U_("DisableContentGenerationError"),[2,{status:Md.CONTENT_GENERATION_DISABLED}]):nv(ne,CC)?(N_(z_,C,xC.Failed,S,re),[2,{status:Md.PAUSED_ON_WARNING,error:Bd.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING}]):nv(ne,SC)?(N_(z_,C,xC.Failed,S,re),[2,{status:Md.PAUSED_ON_WARNING,error:Bd.CREATE_PRESENTATION_BLOCKED_ON_WARNING}]):nv(ne,fC)?(N_(z_,C,xC.DismissedCommand,S,re),U_("CommandExecutionDismissedError"),b===vp.IMAGE_INVALID?[2,{status:Md.DISMISSED,error:Bd.IMAGE_INVALID_ODSL}]:[2,{status:Md.DISMISSED}]):Jh(Dh.IsStoryTellerBlockedWithEmptyPrompt)&&nv(ne,bC)?(N_(z_,C,xC.Unsupported,S,re),U_("AddSlidePromptUndefinedButSourceDefinedError"),[2,{status:Md.BLOCKED,error:Bd.ADD_SLIDE_BLOCKED}]):nv(ne,mC)?(N_(z_,C,xC.Unsupported,S,re),U_("UnsupportedCommandError"),[2,{status:Md.UNSUPPORTED,error:Bd.MULTIPLE_GENERATE_IN_ODSL}]):(N_(z_,C,xC.Failed,S,re),U_("ODSLExecution_Unknown"),[2,{status:Md.FAILED}]);case 18:oe=(new Date).getTime(),F.label=19;case 19:return F.trys.push([19,22,,23]),0===u.length&&0===d.length&&null===p?[3,21]:(d.length>0?(ie={trigger:fv.None,slideHints:d},g.designerOptions=JSON.stringify(ie)):null!==p?g.designerOptions=JSON.stringify(p):!0===h&&(ae={trigger:fv.None},g.designerOptions=JSON.stringify(ae)),se={scenarioName:W_.getScenarioName(),startTime:W_.getStartTime(),entryPoint:XM.Chat,correlationId:V_.getQueryGuid(),timeToODSLMS:1e3*W_.getResponseTime(),timeODSLToJOfcMS:j_,capability:W_.getCapability(),featureName:W_.getFeatureName(),subFeatureName:W_.getSubFeatureName()},g.scenarioOptions=JSON.stringify(se),pd()?n(!0):n(!1),[4,X_(e,u,g)]);case 20:return le=F.sent(),ce=(0,qp.xJ)(oe),function(e,t,n,r,o){if(Jh(Dh.ShouldEnableCommandingTelemetry))if(n===Md.SUCCESS||n===Md.PARTIAL_SUCCESS)R_(e,t,r,o);else if(!cF(e)){var i=xC.Failed;switch(n){case Md.FAILED:i=xC.Failed;break;case Md.BLOCKED:i=xC.Blocked;break;case Md.UNSUPPORTED:case Md.UNEXPECTED_VERSION:i=xC.Unsupported;break;case Md.USER_ABORTED:i=xC.UserAborted;break;case Md.CONTENT_GENERATION_DISABLED:i=xC.Unsupported;break;case Md.PAUSED_ON_WARNING:default:i=xC.Failed}N_(e,t,i,r)}}(z_,C,le.status,S,j_+ce),Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&le.status!==Md.SUCCESS&&V_.sendChatEventTelemetry(HS((de={},(0,i._)(de,cC.ChatEventType,dC.CopilotODSLJOfcCommandsError),(0,i._)(de,cC.ChatEventParameters,Bd[null!==(ue=le.error)&&void 0!==ue?ue:Bd.UNKNOWN_ERROR]),de))),[2,le];case 21:return[3,23];case 22:return pe=F.sent(),ge=null==pe?void 0:pe.message,ZR("callApplyJOfcCommandsApi failed:"+JSON.stringify(pe)+" Error message: "+ge),G_.logError({eventType:IC.ChatEvents,errorMessage:"Execute statements callApplyJOfcCommandsApi failed Error message: "+ge}),N_(z_,C,xC.Failed,S,ge),me={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&me.status!==Md.SUCCESS&&V_.sendChatEventTelemetry(HS((he={},(0,i._)(he,cC.ChatEventType,dC.CopilotODSLJOfcCommandsError),(0,i._)(he,cC.ChatEventParameters,Bd[null!==(fe=me.error)&&void 0!==fe?fe:Bd.UNKNOWN_ERROR]),he))),[2,me];case 23:return ve=(0,qp.xJ)(oe),l?(R_(z_,C,S,j_+ve,!0),[2,{status:Md.PARTIAL_SUCCESS}]):(R_(z_,C,S,j_+ve,!1),[2,{status:Md.SUCCESS}])}}))})),J_.apply(this,arguments)}var K_=function(){var e=(0,gd._)((function(e,t,n,r){var o,a,s,l,c,u;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:return o=(new Date).getTime(),pd()&&jE.getInstance().setState(Qd.EXECUTING_APPLYJOFC_PROTOCOL),ZR("officeJsPayload for applyJOfcCommands API",t),ZR("designerOptions for applyJOfcCommands API",n.designerOptions),ZR("scenarioOptions for applyJOfcCommands API",n.scenarioOptions),ZR("selectionOptions for applyJOfcCommands API",n.selectionOptions),ZR("viewActions for applyJOfcCommands API",r),_p.GetHostAppPlatform()===SM||_p.GetHostAppPlatform()===yM||Jh(Dh.UseApplyJOfcCommandsAsyncForiOS)&&_p.GetHostAppPlatform()===bM?[4,bT(e,t,n,r)]:[3,2];case 1:return a=d.sent(),[3,4];case 2:return[4,Z_(Y_(e,t,n,r),gM)];case 3:a=d.sent(),d.label=4;case 4:return ZR("Execution Completed applyJOfcCommands Time Taken : "+(0,qp.WU)(o)+" sec. return result: ",JSON.stringify(a)),Jh(Dh.LogChatEventWhenMakingAJOFCCall)&&(s="applyJOfcCommand_".concat(a.FSuccess?"Success":"Failure"),ob.getInstance().sendChatEventTelemetry(HS((l={},(0,i._)(l,cC.ChatEventType,dC.JOFCCommandExecuted),(0,i._)(l,cC.ChatEventParameters,s),l)))),null==z_||z_.updateTelemetryOfficeJSOperationData((c={},(0,i._)(c,lC.EventState,a.FSuccess?"Success":"Failure"),(0,i._)(c,lC.OperationType,"applyJOfcCommands"),(0,i._)(c,lC.OperationParameters,""),(0,i._)(c,lC.TimeDurationInMs,(0,qp.xJ)(o)),(0,i._)(c,lC.OfficeJSApi,q_),c)),u=function(e){return iw.apply(this,arguments)}(a),[2,u]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),X_=function(){var e=(0,gd._)((function(e,t,n,r){var o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return i={cmds:t},o=t.length>0?JSON.stringify(i):"",[4,K_(e,o,n,r)];case 1:return[2,a.sent()]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),Z_=function(){var e=(0,gd._)((function(e,t){var n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:r=new Promise((function(e,r){n=setTimeout((function(){r("Timeout after ".concat(t," ms}"))}),t)})),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.race([e,r])];case 2:return o=a.sent(),clearTimeout(n),[2,o];case 3:return i=a.sent(),clearTimeout(n),ZR("execution of applyJOfcCommands",i),[2,{FSuccess:!1}];case 4:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Y_=function(){var e=(0,gd._)((function(e,t,n,r){var o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return ZR("applyJOfcCommands Payload string: "+t),Vh(Lh.UseCopilotActionCommands)?(ZR("CopilotAction API supported and using : true"),i={scenarioOptions:n.scenarioOptions?JSON.parse(n.scenarioOptions):void 0,designerOptions:n.designerOptions?JSON.parse(n.designerOptions):void 0,selectionOptions:n.selectionOptions?JSON.parse(n.selectionOptions):void 0},t&&t.length>0&&(i.jOfcCommands=JSON.parse(t)),Vh(Lh.isViewActionForCopilotActionAsyncAPIEnabled)&&r&&(i.viewAction=r),o=e.presentation.copilotAction(PB,JSON.stringify(i))):o=e.presentation.applyJOfcCommands(t,n),[4,e.sync()];case 1:s.sent(),ZR("applyJOfcCommands Result: "+JSON.stringify(o.value)),a={FSuccess:!1};try{a=JSON.parse(o.value)}catch(e){ZR("Error while parsing applyJOfcCommands Result: ",e.message),G_.logError({eventType:IC.ChatEvents,errorMessage:"Error while parsing applyJOfcCommands Result, ".concat(e.message)})}return[2,a]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}();function $_(e,t){return ew.apply(this,arguments)}function ew(){return(ew=(0,gd._)((function(e,t){var n,r,o,i,a,s,l;return(0,F.__generator)(this,(function(c){return i=[],(null===(r=e.data)||void 0===r||null===(n=r.slides)||void 0===n?void 0:n.length)>0&&(e.data.slides[0].slideMoniker?o=e.data.slides[0].slideMoniker:((o=vT.generateNewSlideMoniker()).id=vT.minId,e.data.slides[0].slideMoniker=o),(a={})[vv.CanReplaceImageWithLoopingVideo]="true",s={target:o,hints:a},i.push(s),l={trigger:fv.DocumentChanges,slideHints:i},t.designerOptions=JSON.stringify(l)),[2,e]}))}))).apply(this,arguments)}function tw(e){return nw.apply(this,arguments)}function nw(){return(nw=(0,gd._)((function(e){var t,n,r;return(0,F.__generator)(this,(function(o){return(null===(n=e.data)||void 0===n||null===(t=n.slides)||void 0===t?void 0:t.length)>0&&(r={isTitleLayout:!0},e.data.slides[0].layoutInfo=r),[2,e]}))}))).apply(this,arguments)}function rw(e,t){return ow.apply(this,arguments)}function ow(){return(ow=(0,gd._)((function(e,t){var n,r,o,i,a;return(0,F.__generator)(this,(function(s){return(null===(r=e.data)||void 0===r||null===(n=r.slides)||void 0===n?void 0:n.length)>0&&(e.data.slides[0].slideMoniker?o=e.data.slides[0].slideMoniker:(o=vT.generateNewSlideMoniker(!1),e.data.slides[0].slideMoniker=o),i={slideMonikerList:[o]},a={selectionType:cv.Slide,data:i},t.selectionOptions=JSON.stringify(a)),[2,e]}))}))).apply(this,arguments)}function iw(){return(iw=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){if(t={status:Md.FAILED},!e.JOfcCommandStatusCode)return t.status=e.FSuccess?Md.SUCCESS:Md.FAILED,[2,t];switch(e.JOfcCommandStatusCode){case Ev.CompletedStatusCode:t.status=Md.SUCCESS,e.Thumbnails&&(t.payload={jOfcApiResult:e});break;case Ev.DisabledStatusCode:t.status=Md.BLOCKED,t.error=Bd.DESIGNER_DISABLED;break;case Ev.ErrorStatusCode:e.JOfcCommandErrorReason&&e.JOfcCommandErrorReason===bv.UnexpectedVersion?t.status=Md.UNEXPECTED_VERSION:(t.status=Md.FAILED,e.JOfcCommandErrorReason&&(t.error=aw(e.JOfcCommandErrorReason)));break;case Ev.CompletedWithErrorsStatusCode:e.JOfcCommandErrorReason&&e.JOfcCommandErrorReason===bv.UnexpectedVersion?t.status=Md.UNEXPECTED_VERSION:(t.status=Md.PARTIAL_SUCCESS,e.JOfcCommandErrorReason&&(t.error=aw(e.JOfcCommandErrorReason)));break;case Ev.UserAbortedStatusCode:t.status=Md.USER_ABORTED}return[2,t]}))}))).apply(this,arguments)}function aw(e){var t=Bd.UNKNOWN_ERROR;switch(e){case bv.DesignerFailed_Deprecated:t=Bd.DESIGNER_FAILED;break;case bv.ContentInsertionFailed:Jh(Dh.ShowErrorIfContentInsertionFailed)&&(t=Bd.CREATE_PRESENTATION_BLOCKED);break;case bv.DesignerFailedAlreadyHasAnimation:Jh(Dh.ShowErrorIfAnimationAlreadyExists)&&(t=Bd.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS);break;case bv.ApplyCLPLabelFailed:Jh(Dh.IsApplyCLPLabelErrorChangeEnabled)&&(t=Bd.APPLY_CLP_LABEL_FAILED);break;case bv.UnexpectedVersion:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.UNEXPECTED_VERSION);break;case bv.DocumentChangedBeforeCommandExecution:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.DOCUMENT_CHANGED_BEFORE_COMMAND_EXECUTION);break;case bv.CommandHadNoEffect:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.COMMAND_HAD_NO_EFFECT);break;case bv.ParseDesignerOptionsFailed:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.PARSE_DESIGNER_OPTIONS_FAILED);break;case bv.FetchDesignSuggestionFailed:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.FETCH_DESIGN_SUGGESTION_FAILED);break;case bv.ApplyDesignSuggestionFailed:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.APPLY_DESIGN_SUGGESTION_FAILED);break;case bv.PrepDesignInputFailed:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.PREP_DESIGN_INPUT_FAILED);break;case bv.DocClosingWithIncompleteProtocol:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.DOC_CLOSING_WITH_INCOMPLETE_PROTOCOL);break;case bv.FetchDesignSuggestionPartialSuccess:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.FETCH_DESIGN_SUGGESTION_PARTIAL_SUCCESS);break;case bv.PrepareStageTimedOut:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.PREPARE_STAGE_TIMED_OUT);break;case bv.EmptyJOfcCmdResultId:Jh(Dh.IsAllPptCommandErrorLogEnabled)&&(t=Bd.EMPTY_JOFC_CMD_RESULT_ID);case bv.Unknown:}return t}var sw,lw=function(){function e(){Sp(this,e),(0,i._)(this,"skillName",void 0),this.skillName=mp.Unset}return Ep(e,[{key:"resetData",value:function(){this.skillName=mp.Unset}},{key:"setSkillName",value:function(e){var t;this.skillName!==e&&this.skillName!==mp.CreatePresentation&&this.skillName!=mp.AddSlide&&this.skillName!==mp.ContentTransform&&(ob.getInstance().sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.FluxChatIntentDetected),(0,i._)(t,cC.ChatEventParameters,e),t))),ZR("Skill name set: ".concat(e)),this.skillName=e)}},{key:"getSkillName",value:function(){return this.skillName}}],[{key:"getInstance",value:function(){return cF(e.FluxSkillHandler)&&(e.FluxSkillHandler=new e),e.FluxSkillHandler}}]),e}();(0,i._)(lw,"FluxSkillHandler",void 0),function(e){e.Designer="designer",e.StockImage="stockImage",e.Icon="icon",e.Enterprise="enterprise",e.Banner="banner"}(sw||(sw={}));var cw=n(78404),uw=n(54761);class dw{constructor(e){Qp.h.assign(dw,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_OrganizePresentation_OrganizePresentationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[dw.getTypeName()])}}dw.H_={T_:dw.getTypeName(),B_:dw.getBaseTypes()};class pw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(pw,this,e)}static getTypeName(){return"AugLoop_Storyteller_StorytellerAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[pw.getTypeName()])}}pw.H_={T_:pw.getTypeName(),B_:pw.getBaseTypes()};class gw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(gw,this,e)}static getTypeName(){return"AugLoop_Storyteller_PresentationOutlineResponse"}static getBaseTypes(){return["AugLoop_Storyteller_StorytellerAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[gw.getTypeName()])}}gw.H_={T_:gw.getTypeName(),B_:gw.getBaseTypes()};class mw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(mw,this,e)}static getTypeName(){return"AugLoop_Storyteller_StorytellerQuestionsResponse"}static getBaseTypes(){return["AugLoop_Storyteller_StorytellerAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[mw.getTypeName()])}}mw.H_={T_:mw.getTypeName(),B_:mw.getBaseTypes()};class fw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(fw,this,e)}static getTypeName(){return"AugLoop_Storyteller_StorytellerOutlineResponse"}static getBaseTypes(){return["AugLoop_Storyteller_StorytellerAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[fw.getTypeName()])}}fw.H_={T_:fw.getTypeName(),B_:fw.getBaseTypes()};class hw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(hw,this,e)}static getTypeName(){return"AugLoop_Storyteller_StorytellerColorsResponse"}static getBaseTypes(){return["AugLoop_Storyteller_StorytellerAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[hw.getTypeName()])}}hw.H_={T_:hw.getTypeName(),B_:hw.getBaseTypes()};class vw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(vw,this,e)}static getTypeName(){return"AugLoop_Storyteller_StorytellerTemplatesResponse"}static getBaseTypes(){return["AugLoop_Storyteller_StorytellerAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[vw.getTypeName()])}}vw.H_={T_:vw.getTypeName(),B_:vw.getBaseTypes()};class yw{constructor(e){Qp.h.assign(yw,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_SegmentToSlide_SegmentToSlideAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[yw.getTypeName()])}}yw.H_={T_:yw.getTypeName(),B_:yw.getBaseTypes()};class Cw{constructor(e){Qp.h.assign(Cw,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_SegmentToSlide_SegmentToSlideProgressAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Cw.getTypeName()])}}Cw.H_={T_:Cw.getTypeName(),B_:Cw.getBaseTypes()};var Sw,bw=n(50707),Ew=n(98817),Tw=n(27936),Iw=n(78986);class _w{constructor(e){Qp.h.assign(_w,this,e)}static getTypeName(){return"AugLoop_PptInsights_PptInsightsSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[_w.getTypeName()])}}_w.H_={T_:_w.getTypeName(),B_:_w.getBaseTypes()};class ww{constructor(e){Qp.h.assign(ww,this,e)}static getTypeName(){return"AugLoop_PptInsights_PptInsightsPostSeedingSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[ww.getTypeName()])}}ww.H_={T_:ww.getTypeName(),B_:ww.getBaseTypes()};class Pw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(Pw,this,e)}static getTypeName(){return"AugLoop_PptInsights_PptAnalyticsData"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Pw.getTypeName()])}}Pw.H_={T_:Pw.getTypeName(),B_:Pw.getBaseTypes()};class xw{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(xw,this,e)}static getTypeName(){return"AugLoop_PptInsights_WordCount"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[xw.getTypeName()])}}xw.H_={T_:xw.getTypeName(),B_:xw.getBaseTypes()};var kw=ob.getInstance(),Aw=50,Lw=2e4;function Dw(){return Aw}function Ow(){return Lw}var Nw=function(){var e=(0,gd._)((function(e){var t,n,r,o,a;return(0,F.__generator)(this,(function(s){return n=(0,dg.A)(),r={allowedShapeTypes:[],queryId:n},o=new Vp.Xr({parentPath:["Signal",_w.getTypeName()],items:[{id:aT.generateId(),body:new _w(r)}]}),Sw=(new Date).getTime(),null===(t=e.current)||void 0===t||t.submitOperation({operation:o,workflowAnnotationType:xw.getTypeName()}),kw.sendChatEventTelemetry(HS((a={},(0,i._)(a,cC.ChatEventType,dC.WordCountOperationSubmitted),(0,i._)(a,cC.UserQueryGuid,n),a))),ZR("successfully submitted operation to AL : \n\n\n"+JSON.stringify(o)+"\nat Time : "+new Date+"\n\n\n"),[2]}))}));return function(t){return e.apply(this,arguments)}}(),Rw=function(){var e=(0,gd._)((function(e,t,n){var r,o,a,s,l,c,u,d,p,g,m;return(0,F.__generator)(this,(function(f){return r=null==e?void 0:e.body,o=null==r?void 0:r.error,a=null==r?void 0:r.wordNumber,s=null==r?void 0:r.numberOfTokens,l=null==r?void 0:r.minTokensRequiredToGenerateSummary,c=null==r?void 0:r.maxTokensRequiredToGenerateSummary,US(kw,xw.getTypeName(),Sw,sC.WordCountResponseTime,_C.CopilotChat,n,void 0,!1),ZR("".concat(xw.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(Sw)," sec \n, WordCount : ").concat(a," , NumberOfTokens : ").concat(s,", minValue : ").concat(l,", maxValue : ").concat(c," \n\n\n")),void 0!==l?Aw=l:kw.sendErrorTelemetry(HS((u={},(0,i._)(u,uC.ErrorMessage,"Undefined minTokenValue received"),(0,i._)(u,uC.ErrorCategory,IC.WordCount),u))),void 0!==c?Lw=c:kw.sendErrorTelemetry(HS((d={},(0,i._)(d,uC.ErrorMessage,"Undefined maxTokenValue received"),(0,i._)(d,uC.ErrorCategory,IC.WordCount),d))),void 0!==(null==o?void 0:o.category)&&(ZR("Error detected in Word count annotation response: ".concat(o.category,", message : ").concat(o.message)),kw.sendErrorTelemetry(HS((p={},(0,i._)(p,uC.ErrorMessage,"".concat(o.category,"_").concat(o.message)),(0,i._)(p,uC.ErrorCategory,IC.WordCount),p)))),void 0!==s?(t(s),void 0!==l&&s<l&&kw.sendChatEventTelemetry(HS((g={},(0,i._)(g,cC.ChatEventType,dC.LessWordCount),(0,i._)(g,cC.ChatEventParameters,"Less Word Count than Min received"),g)))):kw.sendErrorTelemetry(HS((m={},(0,i._)(m,uC.ErrorMessage,"Undefined Word count received_".concat(null==o?void 0:o.message)),(0,i._)(m,uC.ErrorCategory,IC.WordCount),m))),[2]}))}));return function(t,n,r){return e.apply(this,arguments)}}(),Fw=function(e,t){var n,r=[],o=Mw(e,t,(n=[],zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)||(n.push({nodeType:"ActionSet",text:eM.createPresentationFrom(),data:{ciqEntity:"File",unSupportedEntities:iF()?OR([Iw.ck.Event,Iw.ck.People,Iw.ck.Message]):void 0}}),n.push({nodeType:"ActionSet",text:eM.createPresentationAboutContoso()}),n.push({nodeType:"ActionSet",text:eM.addSlideAbout()})),n));o.length>0&&r.push({nodeType:"Category",text:$F.menuSectionCreate(),promptCategory:"Create",iconRegular:bw.vfO,iconHover:bw.Dal,children:o});var i,a=((i=[]).push({nodeType:"ActionSet",text:eM.summarize(),data:{shouldSubmitQueryOnClick:!0}}),i.push({nodeType:"ActionSet",text:eM.datesAndDeadLines()}),i.push({nodeType:"ActionSet",text:eM.showActionItems(),data:{shouldSubmitQueryOnClick:!0}}),i.push({nodeType:"ActionSet",text:eM.showKeySlides(),data:{shouldSubmitQueryOnClick:!0}}),i);e>=Dw()&&a.length>0&&r.push({nodeType:"Category",text:$F.menuSectionUnderstand(),promptCategory:"Understand",iconRegular:Ew.uJg,iconHover:Ew._38,children:a});var s,l=Mw(e,t,(s=[],Vh(Lh.TryNewDesignOptionInMenuEnabled)&&s.push({nodeType:"ActionSet",text:eM.tryNewDesign()}),s.push({nodeType:"ActionSet",text:eM.addImage()}),Vh(Lh.IsHubbleEnterpriseEnabled)&&s.push({nodeType:"ActionSet",text:eM.addEnterpriseImage()}),s.push({nodeType:"ActionSet",text:eM.organizePresentation(),data:{shouldSubmitQueryOnClick:!0}}),s));l.length>0&&r.push({nodeType:"Category",text:$F.menuSectionEdit(),promptCategory:"Edit",iconRegular:bw.RIf,iconHover:bw.FBb,children:l});var c,u,d=((c=[]).push({nodeType:"ActionSet",text:eM.help(),data:{shouldSubmitQueryOnClick:!0}}),c.push({nodeType:"ActionSet",text:eM.improvePresentation()}),c);if(r.push({nodeType:"Category",text:$F.menuSectionAsk(),promptCategory:"Ask",iconRegular:lg.I11,iconHover:lg.kNP,children:d}),Vh(Lh.IsPersonalizationUXEnabled)&&Jh(Dh.IsPersonalizationEntryPointInPromptMenuEnabled)){var p=((u=[]).push({nodeType:"ActionSet",text:eM.whatCanCopilotProfileDo(),data:{shouldSubmitQueryOnClick:!0}}),u.push({nodeType:"ActionSet",text:eM.createMyCopilotProfile()}),u);r.push({nodeType:"Category",text:$F.menuSectionCustomize(),promptCategory:"Customize",iconRegular:Tw.afj,iconHover:Tw.MOA,children:p})}return r},Mw=function(e,t,n){var r=[],o=ib.getInstance().getSlideCount(),i=ib.getInstance().isCreatePresentationEnabled(),a=!0,s=!1,l=void 0;try{for(var c,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;switch(d.text){case eM.organizePresentation():if(!aF(o,e))continue;break;case eM.createPresentationFrom():if(rF(t)&&!1===rR())continue;break;case eM.createPresentationAbout():break;case eM.tryNewDesign():case eM.changeBodyText():if(o<2||i)continue}r.push(d)}}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}return r},Bw=function(e){switch(e){case vM.addSlide():case vM.addEnterpriseImage():case eM.addEnterpriseImage():case eM.addSlideAbout():case eM.addAgendaSlide():case vM.addImage():case eM.addImage():case tM.addAgendaSlide():case tM.addAnImageOfCake():case tM.addSlideAboutMeeting():return Iv.AddContent;case tM.generateImage():return Iv.DesignerVisuals;case vM.createPresentation():case eM.createPresentationFrom():case eM.createPresentationAbout():case eM.createPresentationAboutContoso():case vM.transformFile():case tM.createFromFile():case tM.createPresentationAbout():case tM.createPresentationConsumer():case tM.createPresentationAboutCollaboration():case tM.createPresentationAboutNationalPark():return Iv.CreatePresentation;case vM.structurePresentation():case eM.organizePresentation():return Iv.Organize;case vM.summarizePresentation():case vM.showActionItems():case vM.showKeySlides():case eM.showKeySlides():case eM.summarize():case eM.datesAndDeadLines():case eM.showActionItems():case tM.summarize():case tM.datesAndDeadlines():case tM.showKeySlidesFromThisPresentation():return Iv.Summarize;case vM.animate():case vM.tryNewDesign():case vM.showHelpLink():case vM.changeTextFormat():case vM.addText():case eM.tryNewDesign():case eM.changeBodyText():return Iv.BasicCommand;case eM.improvePresentation():case eM.help():return Iv.DocumentQnA;case vM.askAQuestion():case tM.fontSize():return Iv.ChatQnA;case eM.whatCanCopilotProfileDo():case eM.createMyCopilotProfile():case eM.createCopilotProfile():return Iv.Customize}return Iv.CopilotChat},Uw=function(e){switch(e){case vM.addImage():case eM.addImage():case tM.addAnImageOfCake():return MC.AddImage;case eM.addEnterpriseImage():case vM.addEnterpriseImage():return MC.AddEnterpriseImage;case vM.addSlide():case eM.addSlideAbout():case eM.addAgendaSlide():case tM.addAgendaSlide():case tM.addSlideAboutMeeting():return MC.AddSlide;case vM.createPresentation():case eM.createPresentationAbout():case eM.createPresentationAboutContoso():case tM.createPresentationAbout():case tM.createPresentationConsumer():case tM.createPresentationAboutCollaboration():case tM.createPresentationAboutNationalPark():return MC.CreatePresentation;case vM.transformFile():case eM.createPresentationFrom():case tM.createFromFile():return MC.CreateFromFile;case vM.structurePresentation():case eM.organizePresentation():return MC.Organize;case vM.summarizePresentation():case eM.summarize():case tM.summarize():return MC.Summarize;case vM.showActionItems():case eM.datesAndDeadLines():case tM.datesAndDeadlines():return MC.ShowActionItems;case vM.showKeySlides():case eM.showKeySlides():case tM.showKeySlidesFromThisPresentation():return MC.KeySlides;case vM.animate():case eM.animateBulletedList():return MC.Animate;case vM.tryNewDesign():case eM.tryNewDesign():return MC.Beautify;case eM.help():return MC.Help;case eM.improvePresentation():case tM.fontSize():return MC.BasicChat;case eM.whatCanCopilotProfileDo():case eM.createMyCopilotProfile():case eM.createCopilotProfile():return MC.Customize}return MC.Unset},Hw=function(e){if(e!==Iv.CopilotChat)switch(e){case Iv.BasicCommand:case Iv.Organize:return yE.RX.Command;case Iv.Summarize:return yE.RX.Summarize;case Iv.ChatQnA:case Iv.DocumentQnA:return yE.RX.Ask;case Iv.Customize:return;default:return yE.RX.Create}},Gw=function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value,s=Bw(a.suggestionText),l=Uw(a.suggestionText),c=Hw(s);ob.getInstance().logSeenEvent(s,l,c)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}};function zw(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null==e?void 0:e.contentOrigin;if(!n||!n.length)return{featureName:Iv.CopilotChat};var r=n.toLowerCase();switch(r){case fp.APOLOGY:case fp.DEEPLEO_SYDNEY:return{capability:yE.rf.QAandSummaries,featureName:Iv.ChatQnA,verb:yE.RX.Ask,subFeature:MC.Sydney};case fp.BASIC_CHAT:return{capability:yE.rf.QAandSummaries,featureName:Iv.ChatQnA,verb:yE.RX.Ask,subFeature:MC.BasicChat};case fp.SELF_HELP_SEARCH:return{capability:yE.rf.QAandSummaries,featureName:Iv.ChatQnA,verb:yE.RX.Ask,subFeature:MC.SelfHelpSearch};case fp.CANNED_RESPONSE:return{capability:yE.rf.QAandSummaries,featureName:Iv.ChatQnA,verb:yE.RX.Ask,subFeature:MC.CannedResponse};case fp.DESIGNER_INSERT_GRAPHIC:return{capability:yE.rf.ContentGeneration,featureName:Iv.DesignerVisuals,verb:yE.RX.Create,subFeature:MC.AddDesignerImage};case fp.TRANSFORM_CONTENT:return{capability:yE.rf.ContentGeneration,featureName:Iv.CreatePresentation,verb:yE.RX.Create,subFeature:MC.CreateFromFile};case fp.SUMMARIZE:case fp.COPILOT_POWERPOINT_SUMMARY:return{capability:yE.rf.QAandSummaries,featureName:Iv.Summarize,verb:yE.RX.Summarize};case fp.PERSONALIZATION_END:case fp.PERSONALIZATION_START:case fp.PERSONALIZATION_EXPLAIN:case fp.PERSONALIZATION_UPDATE:case fp.PERSONALIZATION_FORCED_DELETE:return{featureName:Iv.Customize,subFeature:MC.Customize};case fp.EDIT_DOCUMENT:return lw.getInstance().getSkillName()===mp.AddSlide?{capability:yE.rf.ContentGeneration,featureName:Iv.AddContent,verb:yE.RX.Create,subFeature:MC.AddSlide}:lw.getInstance().getSkillName()===mp.CreatePresentation?{capability:yE.rf.ContentGeneration,featureName:Iv.CreatePresentation,verb:yE.RX.Create,subFeature:MC.CreatePresentation}:lw.getInstance().getSkillName()===mp.ContentTransform?{capability:yE.rf.ContentGeneration,featureName:Iv.CreatePresentation,verb:yE.RX.Create,subFeature:MC.CreateFromFile}:lw.getInstance().getSkillName()===mp.OrganizePresentation?{capability:yE.rf.Commanding,featureName:Iv.Organize,verb:yE.RX.Command,subFeature:MC.Organize}:{capability:yE.rf.Commanding,featureName:Iv.Commanding,verb:yE.RX.Command};case fp.IMAGE_CHAT:return{capability:yE.rf.ContentGeneration,featureName:Iv.AddContent,verb:yE.RX.Create,subFeature:MC.InsertImage}}return t&&ob.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.ContentOriginUnknown},{key:cC.ChatEventParameters,value:r}]),{featureName:Iv.CopilotChat}}function qw(e,t){var n=lw.getInstance().getSkillName(),r=_C.CopilotChat,o=RC.UnclearIntent;switch(n){case mp.Summary:r=_C.Summary,o=RC.Summarize;break;case mp.BasicChat:r=_C.BasicChat,o=RC.BasicChat;break;case mp.SearchDocument:case mp.Sydney:r=_C.Sydney,o=RC.BasicChat;break;case mp.Commanding:r=_C.Commanding,o=RC.Command;break;case mp.Designer:r=_C.DesignerVisuals,o=RC.DesignerVisuals;break;case mp.ContentTransform:r=_C.CreatePresentationFromDoc,o=RC.AddContent}return{vetoName:FS(o,e),errorString:t,featureName:r}}var Ww,jw,Vw="",Qw={};function Jw(){try{var e=window.location.href.match(/\/([0-9.]+)\/en-us_web\//);return null==e||e.length<2?"":e[1]}catch(e){return ZR("Error in getting pane build number, message: ".concat(e.message)),""}}!function(e){e.Text2ImageError="SkillFailedError:Text2ImageError_insert_graphic",e.InputQueryError="SkillFailedError:InputQueryError_insert_graphic",e.InferenceAPIError="SkillFailedError:InferenceAPIError_insert_graphic",e.OffensiveContent="SkillFailedError:OffensiveContent_insert_graphic",e.DesignerBrandImagesNotFound="SkillFailedError:DesignerBrandImagesNotFound_insert_graphic",e.DesignerBrandLibraryNotConfigured="SkillFailedError:DesignerBrandLibraryNotConfigured_insert_graphic",e.UnknownError="SkillFailedError:Error_insert_graphic"}(Ww||(Ww={})),function(e){e.Text2ImageError="Text2ImageError",e.InputQueryError="InputQueryError",e.InferenceAPIError="InferenceAPIError",e.OffensiveContent="OffensiveContent",e.ByDesign="ByDesign",e.Unknown="Unknown"}(jw||(jw={}));var Kw=function(){switch(_p.GetHostAppPlatform()){case SM:return"MacOS";case bM:return"iOS";case yM:return"Win32";default:return"Web"}},Xw=function(e,t){return e===Wg.defaultBlack||e===Wg.defaultDarkGrey?t?"highContrast":"dark":e===Wg.defaultWhite?"light":"auto"},Zw=function(e){ob.getInstance().logTriedEvent(Iv.DesignerVisuals,MC.AddDesignerImage,yE.RX.Create,e)},Yw=function(e){var t;ob.getInstance().sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.PptCopilotEditScn),(0,i._)(t,cC.ChatEventParameters,"isSuccess, + ".concat(e)),t)))},$w=function(e){return"bot"===e.author&&e.messageType===WE.RenderCardRequest&&e.contentOrigin===fp.DESIGNER_INSERT_GRAPHIC},eP=function(e){var t="";switch(e){case sw.Designer:t=fm()?OfficeaicopilotStrings.DesignerFallbackToDalleApologyMessage:"Apologies, I can't do this yet. Here are some generated images that match your search and may be useful.";break;case sw.StockImage:default:t=fm()?OfficeaicopilotStrings.DesignerFallbackToStockApologyMessage:"Apologies, I can't do this yet. Here are some stock images that match your search that may be useful."}return t},tP=function(e,t){lw.getInstance().setSkillName(mp.Designer);var n=ob.getInstance().getQueryGuid(),r=cP(n);try{if((null==e?void 0:e.text)&&Vh(Lh.IsDesignerCopilotEnabled)){var o,i,a,s,l,c,u,d,p,g,m,f,h,v;ZR("Trigger Designer Graphics...");var y=JSON.parse(e.text),C=null===(o=y.payload)||void 0===o?void 0:o.imageType,S=null===(i=y.payload)||void 0===i?void 0:i.isFallbackScenario,b=null===(s=y.payload)||void 0===s||null===(a=s.images)||void 0===a?void 0:a.map((function(e){return{url:e.imageId,description:e.description,altText:e.altText,license:e.license,thumbnail:e.thumbnail,pac:e.pac}})),E=null===(l=y.payload)||void 0===l?void 0:l.clientSessionId,T=null===(u=y.payload)||void 0===u||null===(c=u.images[0])||void 0===c?void 0:c.companyName,I=null===(d=y.payload)||void 0===d?void 0:d.objectId,_=null===(p=y.payload)||void 0===p?void 0:p.tenantId;S&&function(e,t){var n,r=eP(e);null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:r}}}})}(C,t);var w={width:1317,height:366};Vw=(0,dg.A)();var P,x=C===sw.Banner?null===(g=y.payload)||void 0===g?void 0:g.designerPrompt:null===(m=y.payload)||void 0===m?void 0:m.stockQuery,k=Vh(Lh.IsEnterpriseBase64ImageEnabled)&&!(null===(h=b[0])||void 0===h||null===(f=h.url)||void 0===f?void 0:f.startsWith("https")),A=[sw.StockImage,sw.Icon,!k&&sw.Enterprise].includes(C),L=k&&C===sw.Enterprise;if(Vh(Lh.UseDesignerPromptForDalle)&&C===sw.Designer)x=null===(P=y.payload)||void 0===P?void 0:P.designerPrompt;var D=NN(Wd.DESIGNERCARD,{featureName:Iv.DesignerVisuals,subFeatureName:MC.AddDesignerImage}),O=D.contextData,N=Sd(Cd({},D),{contextData:Sd(Cd({},O),{feedbackContextData:Sd(Cd({},null==O?void 0:O.feedbackContextData),{ALGeneratedPrompt:x,imageType:C}),cardMetaData:JSON.stringify(Sd(Cd({},JSON.parse((null==O?void 0:O.cardMetaData)||"{}")),{ALGeneratedPrompt:x,imageType:C}))})});Qw=Vh(Lh.EnableDesignerFeedbackDataForDebugMode)?N:D,null===(v=t.current)||void 0===v||v.addResponseMessage({chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:x,renderData:{component:pp.DesignerCard,props:{user:ig.Q9.Chat,message:x,turnId:n,isStockQuery:A,stockImages:L?void 0:b,base64ImageData:L?b.map((function(e){return e.url})):void 0,imageType:C,isAuthEnabled:C!==sw.Banner,bannerWidth:C===sw.Banner?w.width:void 0,bannerHeight:C===sw.Banner?w.height:void 0,clientSessionId:E,objectId:I,tenantId:_,companyName:T}}}},chatMessageBodyData:{feedbackSectionPosition:ag.O.Footer,feedbackData:Qw,shouldShowAIPoweredIndicator:A||L,messageId:Vw},addCardToChatHistory:A||L}),function(e,t,n){try{HA(new lT({status:fE.success,error:"",queryId:e}),t,n)}catch(e){ZR("Error in submitting operation, message: ".concat(e.message," at stack ").concat(e.stack))}}(n,t,r),ob.getInstance().sendChatEventTelemetry(Ed(r).concat([{key:cC.ChatEventType,value:dC.DesignerResponseShown},{key:cC.ImageType,value:C}]))}else{var R;null===(R=t.current)||void 0===R||R.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.CommandNotSupportedMessage}}},chatMessageBodyData:{messageId:Vw,feedbackSectionPosition:ag.O.Footer,feedbackData:NN(Wd.DESIGNERCARD)},addCardToChatHistory:!0}),ZR("Triggered Designer Graphics: Empty message text"),ob.getInstance().sendChatEventTelemetry(Ed(r).concat([{key:cC.ChatEventType,value:dC.EmptyDesignerResponse},{key:cC.ChatErrorType,value:ep.Server},{key:cC.ChatErrorKey,value:pC.DesignerVisualsEmptyResponse}]))}return}catch(e){return ZR("Error parsing Designer Graphics response message"),ob.getInstance().sendErrorTelemetry(Ed(r).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Error parsing Designer Graphics response message: "+e.message}])),void ob.getInstance().sendChatEventTelemetry(Ed(r).concat([{key:cC.ChatEventType,value:dC.DesignerSkillResponseParseError},{key:cC.ChatEventParameters,value:"Error parsing Designer Graphics response message: ".concat(e.message)},{key:cC.ChatErrorType,value:ep.Server},{key:cC.ChatErrorKey,value:pC.DesignerVisualsSkillResponseParseError}]))}},nP=function(e){(null==e?void 0:e.current)&&(e.current.removeAttribute("aria-label"),setTimeout((function(){var t;null==e||null===(t=e.current)||void 0===t||t.setAttribute("aria-label",fm()?OfficeaicopilotStrings.ImageInsertionSuccessAnnouncement:"Your image has been inserted.")}),1))},rP=function(){var e=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b=arguments;return(0,F.__generator)(this,(function(E){switch(E.label){case 0:if(t=b.length>1&&void 0!==b[1]?b[1]:"",n=b.length>2&&void 0!==b[2]?b[2]:"",r=b.length>3&&void 0!==b[3]?b[3]:"",o=b.length>4?b[4]:void 0,i=b.length>6&&void 0!==b[6]?b[6]:"",a=b.length>7?b[7]:void 0,s=b.length>8&&void 0!==b[8]?b[8]:"",l=b.length>9&&void 0!==b[9]?b[9]:"",c=b.length>10?b[10]:void 0,jE.getInstance().getState()!==Qd.IDLE)return ZR("Designer Mini insertion triggered while in a non-idle execution state"),[2];jE.getInstance().setState(Qd.EXECUTING),u=new Date,o.setScenarioName(Cv.InsertImageDesignerMini),o.setStartTime(u.toISOString()),d=(0,dg.A)(),p=Ed(cP(s)).concat([{key:cC.UniqueActionId,value:d},{key:cC.ImageType,value:l}]),ob.getInstance().sendChatEventTelemetry(Ed(p).concat([{key:cC.ChatEventType,value:dC.DesignerImageInsertStart}])),g={status:Md.FAILED},E.label=1;case 1:return E.trys.push([1,3,,4]),ZR("Inserting Image from Designer Mini"),m=[],f={},h={trigger:Vh(Lh.DisableSuggestionOnImageInsert)?fv.None:fv.DocumentChanges},f.designerOptions=JSON.stringify(h),v={scenarioName:o.getScenarioName(),featureName:o.getFeatureName(),subFeatureName:o.getSubFeatureName(),capability:o.getCapability(),startTime:o.getStartTime(),entryPoint:"Chat",correlationId:d,uniqueActionId:s,timeToODSLMS:-1,timeODSLToJOfcMS:-1},f.scenarioOptions=JSON.stringify(v),[4,PowerPoint.run(function(){var o=(0,gd._)((function(o){var a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return[4,gT({context:o,slides:m,imageData:{url:e,description:t,altText:n,license:r,pac:i}})];case 1:return a=s.sent(),[4,X_(o,[a],f)];case 2:return g=s.sent(),ZR("Log result : ",JSON.stringify(g)),[2]}}))}));return function(e){return o.apply(this,arguments)}}())];case 2:return E.sent(),[3,4];case 3:return y=E.sent(),ZR("Execute failed:"+JSON.stringify(y)),ob.getInstance().sendErrorTelemetry(Ed(p).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Error thrown during image insertion via AddPictureCmd. Message=".concat(y.message)}])),ob.getInstance().sendChatEventTelemetry(Ed(p).concat([{key:cC.ChatEventType,value:dC.DesignerImageInsertError},{key:cC.ChatEventParameters,value:"Error thrown during image insertion via AddPictureCmd. Message=".concat(y.message)},{key:cC.ChatErrorType,value:ep.Client},{key:cC.ChatErrorKey,value:pC.DesignerVisualsInsertError}])),g={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},[3,4];case 4:return ob.getInstance().sendLatencyTelemetry(Ed(p).concat([{key:sC.RequestSignalType,value:"DesignerImageInsertion"},{key:sC.ImageInsertionTime,value:(0,qp.WU)(u.getTime())},{key:sC.IsImageInsertionSuccess,value:g.status===Md.SUCCESS||g.status===Md.PARTIAL_SUCCESS}]),!0),T=p,ob.getInstance().logKeptEvent(Iv.DesignerVisuals,MC.AddDesignerImage,yE.RX.Create,T),g.status===Md.SUCCESS?(nP(c),ob.getInstance().sendChatEventTelemetry(Ed(p).concat([{key:cC.ChatEventType,value:dC.DesignerImageInsertEnd}]))):(Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&ob.getInstance().sendChatEventTelemetry(Ed(p).concat([{key:cC.ChatEventType,value:dC.DesignerImageInsertJOfcCommandsError},{key:cC.ChatEventParameters,value:Bd[null!==(C=g.error)&&void 0!==C?C:Bd.UNKNOWN_ERROR]},{key:cC.ChatErrorType,value:ep.Client},{key:cC.ChatErrorKey,value:pC.DesignerVisualsInsertJOfcCommandsError}])),S=new lT({status:fE.failed,queryId:s,error:PowerpointCopilotStrings.ErrorInExecution}),a(g,S,IC.Designer)),o.resetData(),jE.getInstance().setState(Qd.IDLE),[2]}var T}))}));return function(t){return e.apply(this,arguments)}}(),oP=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,a,s,l;return(0,F.__generator)(this,(function(c){return(r=null===(n=t.current)||void 0===n?void 0:n.getLastMessage())&&r.messageType===jp._.ChatCardWrapper&&e.dcHint&&(i=r.body,(null===(o=i.renderData)||void 0===o?void 0:o.component)===pp.DesignerCard&&(ZR("Updating DesignerMini file cache info:"+JSON.stringify(e)),(s=null===(a=i.renderData)||void 0===a?void 0:a.props).fileCacheInfo||s.isStockQuery||null===(l=t.current)||void 0===l||l.updateLastMessage({chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:pp.DesignerCard,props:Sd(Cd({},s),{fileCacheInfo:e})}}}}))),[2]}))}));return function(t,n){return e.apply(this,arguments)}}(),iP=function(e){var t,n;try{t=sP(e.message,"hostCorrelationId"),n=sP(e.message,"imageType"),ob.getInstance().sendErrorTelemetry(Ed(cP(t)).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Designer Mini Error=".concat(e.message)},{key:cC.ImageType,value:n}]))}catch(e){ZR("Error parsing Designer Mini error message"),ob.getInstance().sendErrorTelemetry(Ed(cP(null!=t?t:"")).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Error parsing Designer Mini error message: "+e.message},{key:cC.ImageType,value:n}]))}},aP=function(e){try{ob.getInstance().sendChatEventTelemetry(Ed(lP).concat([{key:cC.ChatEventType,value:dC.DesignerMiniEvent},{key:cC.ChatEventParameters,value:JSON.stringify(e.data)}]))}catch(e){ZR("Error parsing Designer Mini telemetry message"),ob.getInstance().sendErrorTelemetry(Ed(lP).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Error parsing Designer Mini telemetry message: "+e.message}]))}};function sP(e,t){t+=":";var n=e.indexOf("".concat(t));return n<0?"":e.substring(n+t.length).split(";")[0]}var lP=[{key:sC.FeatureName,value:Iv.DesignerVisuals},{key:sC.SubFeatureName,value:MC.AddDesignerImage}],cP=function(e){return void 0===e&&(e=ob.getInstance().getQueryGuid()),Ed(lP).concat([{key:cC.UserQueryGuid,value:e}])},uP=function(e){var t,n="Unknown",r=pC.DesignerVisualsUnknownError,o=ep.Server,i=dC.ErrorResponseSignalSent;switch(e){case"SkillFailedError:Text2ImageError_insert_graphic":n="Text2ImageError",r=pC.DesignerVisualsText2ImageError,t=qw(AC.Text2ImageError,NC.Text2ImageGenericError);break;case"SkillFailedError:InputQueryError_insert_graphic":n="InputQueryError",o=ep.UnsupportedAction,r=pC.DesignerVisualsUnsupportedImageTypeError,t=qw(AC.UnsupportedCopilotFunctionality,NC.DesignerVisualsUnsupportedImageType);break;case"SkillFailedError:InferenceAPIError_insert_graphic":n="InferenceAPIError",r=pC.DesignerVisualsLLMError,t=qw(AC.ServiceSideIssuePreventsOutput,NC.DesignerVisualsInferenceAPIError);break;case"SkillFailedError:OffensiveContent_insert_graphic":n="OffensiveContent",r=pC.DesignerVisualsStockRAIError;break;case"SkillFailedError:DesignerBrandImagesNotFound_insert_graphic":case"SkillFailedError:DesignerBrandLibraryNotConfigured_insert_graphic":n="ByDesign",i=dC.DesignerDiscountedError;break;default:t=qw(AC.UnclassifiedAshaError,NC.UnknownError)}return"ByDesign"===n?ob.getInstance().sendChatEventTelemetry(Ed(cP()).concat([{key:cC.ChatEventType,value:dC.DesignerDiscountedError},{key:cC.ChatEventParameters,value:e}])):ob.getInstance().sendChatEventTelemetry(Ed(cP()).concat([{key:cC.ChatEventType,value:dC.DesignerSkillError},{key:cC.ChatEventParameters,value:n},{key:cC.ChatErrorType,value:o},{key:cC.ChatErrorKey,value:r}])),{designerVisualsErrorResultType:i,designerVisualsASHAErrorDetails:t}},dP=n(80493),pP=ob.getInstance();function gP(e){return!!Vh(Lh.IsSelfHelpSearchRenderingEnabled)&&("bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===fp.SELF_HELP_SEARCH)}function mP(e,t){var n=e.adaptiveCards&&e.adaptiveCards.length>0,r=[],o="";lw.getInstance().setSkillName(mp.SelfHelp);var i={featureName:_C.CopilotChat,subFeatureName:MC.SelfHelpSearch},a=lB();if(n&&e.hiddenText===pM.QuickAnswer){o=pM.QuickAnswer;var s=e.adaptiveCards[0],l=fP(s,a,e.messageId,i);r.push(l)}else if(n&&e.hiddenText===pM.HelpArticle)if(o=pM.HelpArticle,1===e.adaptiveCards.length){var c=e.adaptiveCards[0],u=fP(c,a,e.messageId,i);r.push(u)}else{var d,p={chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:sB()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.None,isFailure:!1,messageId:e.messageId,telemetryData:RN(Iv.ChatQnA)},addCardToChatHistory:!0},g=e.adaptiveCards.map((function(t){return fP(t,a,e.messageId,i)}));(d=r).push.apply(d,[p].concat(Ed(g)))}else{o="N/A";var m={chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:cB()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.None,isFailure:!0,messageId:e.messageId,telemetryData:RN(Iv.ChatQnA),feedbackData:NN(Wd.SELFHELPSEARCH,i)},addCardToChatHistory:!0};r.push(m)}hP(o);var f=!0,h=!1,v=void 0;try{for(var y,C=r[Symbol.iterator]();!(f=(y=C.next()).done);f=!0){var S,b=y.value;null===(S=t.current)||void 0===S||S.addResponseMessage(b)}}catch(e){h=!0,v=e}finally{try{f||null==C.return||C.return()}finally{if(h)throw v}}}var fP=function(e,t,n,r){var o;return{chatCardType:jp._.SelfHelpAdaptiveCard,chatMessageData:{selfHelpAdaptiveCardProps:{user:"chat",headerText:t,sourceLabel:{iconName:"unknown",text:uB()},cardData:e,customActions:(o={},(0,i._)(o,yP.JsonTypeName,yP),(0,i._)(o,SP.JsonTypeName,SP),(0,i._)(o,bP.JsonTypeName,bP),(0,i._)(o,CP.JsonTypeName,CP),o)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.Footer,feedbackData:NN(Wd.SELFHELPSEARCH,r),isFailure:!1,messageId:n,telemetryData:RN(Iv.ChatQnA)},addCardToChatHistory:!0}},hP=function(e){var t;pP.sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.SelfHelpContentShown),(0,i._)(t,cC.ChatEventParameters,JSON.stringify({ContentType:e})),t))),pP.logTriedEvent(Iv.ChatQnA,MC.SelfHelpSearch,yE.RX.Ask)},vP=function(e,t){var n,r=pP.getQueryGuid();if(t){var o=vR(t),a=o.correlationId;o.featureName;void 0!==a&&pP.setQueryGuid(a)}pP.sendChatEventTelemetry(HS((n={},(0,i._)(n,cC.ChatEventType,dC.SelfHelpActionClicked),(0,i._)(n,cC.ChatEventParameters,JSON.stringify({ActionType:e})),n))),pP.logKeptEvent(Iv.ChatQnA,MC.SelfHelpSearch,yE.RX.Ask),t&&pP.setQueryGuid(r)},yP=function(e){eC(n,e);var t=aC(n);function n(){var e;return Sp(this,n),e=t.apply(this,arguments),(0,i._)(Yy(e),"tcid",void 0),e}return Ep(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){vP("ExecuteTCID",e),this.tcid&&Office.context.ui.executeFeature(this.tcid)}}]),n}(dP.Y);(0,i._)(yP,"JsonTypeName","SelfHelpAction.ExecuteTCID"),(0,i._)(yP,"tcidProperty",new Te.NumProperty(Te.Versions.v1_0,"tcid")),(0,F.__decorate)([Te.property(yP.tcidProperty)],yP.prototype,"tcid",void 0);var CP=function(e){eC(n,e);var t=aC(n);function n(){var e;return Sp(this,n),e=t.apply(this,arguments),(0,i._)(Yy(e),"tabId",void 0),(0,i._)(Yy(e),"anchorId",void 0),(0,i._)(Yy(e),"calloutTitle",void 0),(0,i._)(Yy(e),"calloutText",void 0),(0,i._)(Yy(e),"delay",void 0),e}return Ep(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){vP("ShowTeachingCallout",e),this.tabId&&this.anchorId&&this.calloutTitle&&this.calloutText&&OfficeFirstParty.Notification.addNotification(OfficeFirstParty.Notification.callout({target:this.tabId,title:this.calloutTitle,content:this.calloutText,useTeachingStyles:!0}),{navigationalOptions:{controlToFind:this.anchorId}})}}]),n}(dP.Y);(0,i._)(CP,"JsonTypeName","SelfHelpAction.ShowTeachingCallout"),(0,i._)(CP,"tabIdProperty",new Te.NumProperty(Te.Versions.v1_0,"tabId")),(0,i._)(CP,"anchorIdProperty",new Te.NumProperty(Te.Versions.v1_0,"anchorId")),(0,i._)(CP,"calloutTitleProperty",new Te.StringProperty(Te.Versions.v1_0,"calloutTitle")),(0,i._)(CP,"calloutTextProperty",new Te.StringProperty(Te.Versions.v1_0,"calloutText")),(0,i._)(CP,"delayProperty",new Te.NumProperty(Te.Versions.v1_0,"delay")),(0,F.__decorate)([Te.property(CP.tabIdProperty)],CP.prototype,"tabId",void 0),(0,F.__decorate)([Te.property(CP.anchorIdProperty)],CP.prototype,"anchorId",void 0),(0,F.__decorate)([Te.property(CP.calloutTitleProperty)],CP.prototype,"calloutTitle",void 0),(0,F.__decorate)([Te.property(CP.calloutTextProperty)],CP.prototype,"calloutText",void 0),(0,F.__decorate)([Te.property(CP.delayProperty)],CP.prototype,"delay",void 0);var SP=function(e){eC(n,e);var t=aC(n);function n(){var e;return Sp(this,n),e=t.apply(this,arguments),(0,i._)(Yy(e),"url",void 0),e}return Ep(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){var t;(vP("OpenUrl",e),this.url)&&(null===(t=window)||void 0===t||t.open(this.url))}}]),n}(dP.Y);(0,i._)(SP,"JsonTypeName","SelfHelpAction.OpenUrl"),(0,i._)(SP,"urlProperty",new Te.StringProperty(Te.Versions.v1_0,"url")),(0,F.__decorate)([Te.property(SP.urlProperty)],SP.prototype,"url",void 0);var bP=function(e){eC(n,e);var t=aC(n);function n(){var e;return Sp(this,n),e=t.apply(this,arguments),(0,i._)(Yy(e),"articleId",void 0),e}return Ep(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){vP("ShowHelpPane",e),this.articleId&&OfficeFirstParty.Copilot.launchHelpPaneByArticleIdString(this.articleId)}}]),n}(dP.Y);(0,i._)(bP,"JsonTypeName","SelfHelpAction.ShowHelpPane"),(0,i._)(bP,"articleIdProperty",new Te.StringProperty(Te.Versions.v1_0,"articleId")),(0,F.__decorate)([Te.property(bP.articleIdProperty)],bP.prototype,"articleId",void 0);class EP{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(EP,this,e)}static getTypeName(){return"AugLoop_CopilotOdsl_CopilotOdslAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[EP.getTypeName()])}}EP.H_={T_:EP.getTypeName(),B_:EP.getBaseTypes()};class TP{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(TP,this,e)}static getTypeName(){return"AugLoop_CopilotOdsl_CopilotOdslImageAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[TP.getTypeName()])}}TP.H_={T_:TP.getTypeName(),B_:TP.getBaseTypes()};class IP{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(IP,this,e)}static getTypeName(){return"AugLoop_CopilotOdsl_CopilotOdslIntentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[IP.getTypeName()])}}IP.H_={T_:IP.getTypeName(),B_:IP.getBaseTypes()};class _P{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(_P,this,e)}static getTypeName(){return"AugLoop_CopilotOdsl_AdminControlAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[_P.getTypeName()])}}_P.H_={T_:_P.getTypeName(),B_:_P.getBaseTypes()};var wP,PP=ob.getInstance(),xP=sb.getInstance(),kP=function(e,t,n,r,o,a,s,l){var c,u,d=l?sp.DisengagedError:null==e?void 0:e.category,p=null==e?void 0:e.message,g=null==e?void 0:e.json,m=rM;try{cF(g)||(c=JSON.parse(g))}catch(e){ZR("Exception occred during parsing of json Data for ODSL Error : ".concat(e))}ZR("CopilotODSL Annotation Error Detected, Category: ".concat(d,", ErrorMessage: ").concat(p,", JsonData: ").concat(g)),void 0!==c&&(u=c.code);var f,h=DC.Fallback,v=AC.CommandNotExecuted,y={errorType:"".concat(d,"-").concat(u),featureName:_C.Commanding};switch(Kh()&&function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=o?sp.DisengagedError:null==e?void 0:e.category,a=null==e?void 0:e.json,s=NC.NoResponseFromSydney,l=AC.UnclassifiedAshaError;try{cF(a)||(t=JSON.parse(a))}catch(e){ZR("Exception occured during parsing of json Data for ODSL Error : ".concat(e))}void 0!==t&&(n=t.code);var c=null==n?void 0:n.toLowerCase();switch(i.toLowerCase()){case ip.ClientProgramResponseError.toLowerCase():switch(c){case ap.ProgramFailed.toLowerCase():s=NC.ODSLExecutionFailure,l=AC.UnclassifiedAshaError;break;case ap.Timeout.toLowerCase():s=NC.ProgramExecutionTimeout,l=AC.ResponseDelayedOrTimedOut}break;case ip.DisambiguationError.toLowerCase():switch(c){case ap.DisambiguationRequired.toLowerCase():s=NC.DisambiguationRequired,l=AC.ServiceSideIssuePreventsOutput;break;case ap.PerpetualDisambiguationLoop.toLowerCase():s=NC.PerpetualDisambiguationLoop,l=AC.ServiceSideIssuePreventsOutput}break;case ip.DisengagedError.toLowerCase():s=NC.SydneyDisengagement,l=AC.UnableToCompleteTask;break;case ip.InferenceAPIError.toLowerCase():switch(c){case ap.BadResponse.toLowerCase():s=NC.BadResponse,l=AC.ServiceSideIssuePreventsOutput;break;case ap.EmptyResponse.toLowerCase():s=NC.EmptyGeneratedResponse,l=AC.ServiceSideIssuePreventsOutput;break;case ap.NotAvailable.toLowerCase():s=NC.APIUnavailable,l=AC.UnclassifiedAshaError;break;case ap.OutputRAIDependency.toLowerCase():s=NC.RAIGeneratedAnswerCheckError,l=AC.RAIError;break;case ap.Scenario_throttled.toLowerCase():s=NC.ScenarioThrottled,l=AC.UnableToGenerateResponseDueToCapacityIssue;break;case ap.Throttled.toLowerCase():s=NC.Throttled,l=AC.UnableToGenerateResponseDueToCapacityIssue;break;case ap.TimeOut.toLowerCase():s=NC.ServerTimeout,l=AC.ResponseDelayedOrTimedOut;break;case ap.Token.toLowerCase():s=NC.TokenError,l=AC.UserAccessIssueForCopilot;break;case ap.Unknown.toLowerCase():s=NC.UnknownError,l=AC.ServiceSideIssuePreventsOutput;break;case ap.User_throttled.toLowerCase():s=NC.UserThrottled,l=AC.UnableToGenerateResponseDueToCapacityIssue}break;case ip.InputQueryError.toLowerCase():switch(s=NC.InvalidInputQuery,l=AC.UserInputCouldNotBeProcessed,c){case ap.Bad_Token.toLowerCase():s=tv()?NC.InvalidTokens:NC.InvalidTokensOld;break;case ap.DocumentProcessingDenied.toLowerCase():s=NC.DocumentProcessingDenied;break;case ap.Invalid.toLowerCase():s=NC.InvalidInputQuery;break;case ap.OutOfScope.toLowerCase():s=NC.InputOutOfScope;break;case ap.Too_long.toLowerCase():s=NC.InputTooLong;break;case ap.Too_short.toLowerCase():s=NC.InputTooShort;break;case ap.UnsupportedMultiAgent.toLowerCase():s=NC.UnsupportedMultiAgent}break;case ip.InvalidInputError.toLowerCase():if(l=AC.CommandUnableToCompleteTask,c===ap.Too_short.toLowerCase())s=NC.InputContentTooShort;break;case ip.InvalidIntentError.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.Invalid.toLowerCase():s=NC.InvalidSubIntent;break;case ap.Missing.toLowerCase():s=NC.MissingSubIntent}break;case ip.InvalidLanguageError.toLowerCase():switch(l=AC.UnsupportedCopilotFunctionality,c){case ap.FailedToGetInputLanguage.toLowerCase():s=NC.FailedToGetInputLanguage;break;case ap.NotSupported.toLowerCase():s=NC.UnsupportedInputLanguage}break;case ip.InvalidSignalError.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.Missing.toLowerCase():s=NC.MissingSignalInWorkflow;break;case ap.WrongType.toLowerCase():s=NC.InvalidSignal}break;case ip.LicensingError.toLowerCase():if(l=AC.UserAccessIssueForCopilot,c===ap.Missing_Service_Plan.toLowerCase())s=NC.MissingServicePlan;else s=tv()?NC.LicenseValidationFailed:NC.LicenseValidationFailedOld;break;case ip.ODSLParseError.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.NoOp.toLowerCase():s=NC.NoEffectProgram;break;case ap.Truncated.toLowerCase():s=NC.TruncatedODSL;break;case ap.Unexpected.toLowerCase():s=NC.ODSLParsingError;break;case ap.ZeroParsed.toLowerCase():s=NC.EmptyODSLCreation}break;case ip.ODSLSyntaxError.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.BadValue.toLowerCase():s=NC.ODSLArgumentTypeMismatch;break;case ap.DismissedInvalidRequiredArguments.toLowerCase():s=NC.ODSLBadArgumentValue;break;case ap.MissingRequiredArguments.toLowerCase():s=NC.MissingODSLArgument;break;case ap.Unexpected.toLowerCase():s=NC.ODSLSyntaxValidationError;break;case ap.UnknownStatement.toLowerCase():s=NC.ODSLStatementSchemaMismatch;break;case ap.Unsupported.toLowerCase():s=NC.ODSLValueOutOfRange;break;case ap.UnsupportedByAdmin.toLowerCase():s=NC.ODSLStatementBlocked;break;case ap.VariableUnknownName.toLowerCase():s=NC.UndefinedODSLVariableReference;break;case ap.VariableWrongType.toLowerCase():s=NC.ODSLArgumentWrongType}break;case ip.OffensiveContent.toLowerCase():switch(s=NC.OffensiveContentError,l=AC.RAIError,c){case ap.Generated_output.toLowerCase():s=NC.OffensiveGeneratedOutput;break;case ap.Generated_sydney_output.toLowerCase():s=NC.OffensiveGeneratedSydneyOutput;break;case ap.Input_content.toLowerCase():s=NC.OffensiveInputContent;break;case ap.Input_query.toLowerCase():s=NC.OffensiveInputQuery}break;case ip.OffensiveContentError.toLowerCase():switch(l=AC.RAIError,c){case ap.OffensiveOutputContent.toLowerCase():s=NC.OffensiveOutputBlocked;break;case ap.OutputBlockedByDynamicGuardList.toLowerCase():s=NC.OutputBlockedByFilters}break;case ip.PostProcessProgramError.toLowerCase():if(c===ap.Unsupported_Program.toLowerCase())s=NC.UnsupportedInputQuery,l=AC.UnsupportedCopilotFunctionality;break;case ip.ResolveDelegationsError.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.EmptyGeneratePrompt.toLowerCase():case ap.EmptyGenerateSource.toLowerCase():s=NC.ODSLMissingRequiredArgument;break;case ap.GetProgramFailed.toLowerCase():s=NC.LLMSlideJSONGenerationFailed;break;case ap.GetImageDetailsFailed.toLowerCase():s=NC.LLMImageDetailsGenerationFailed;break;case ap.InvalidPrompt.toLowerCase():s=NC.IncorrectlyFormattedODSL;break;case ap.InvalidReplaceTextResponse.toLowerCase():s=NC.LLMContentGenerationFailed;break;case ap.InvalidGenerateSource.toLowerCase():s=NC.UnparsableODSL;break;case ap.InvalidRewriteResponse.toLowerCase():s=NC.LLMContentRewritingFailed;break;case ap.ParseJsonFailed.toLowerCase():s=NC.SlideJSONParsingFailure;break;case ap.InvalidSource.toLowerCase():s=NC.InvalidFileURL,l=AC.UserInputCouldNotBeProcessed}break;case ip.SkillFailedError.toLowerCase():s=NC.SkillsFailed,l=AC.UnclassifiedAshaError;break;case ip.SydneyCancelledError.toLowerCase():if(c===ap.Cancelled.toLowerCase())s=NC.SydneyConnectionCancelled,l=AC.UserCancelledResponse;break;case ip.Text2ImageError.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.NoImages.toLowerCase():s=NC.NoImagesGenerated;break;case ap.UnrecognizedBaseUrl.toLowerCase():s=NC.UnrecognizedText2ImageModelBaseURL;break;case ap.ResponseFailed.toLowerCase():s=NC.Text2ImageModelResponseFailure}break;case ip.TokenCountError.toLowerCase():switch(c){case ap.ExcessTokensRequest.toLowerCase():s=NC.ExcessTokensRequest,l=AC.UserInputCouldNotBeProcessed;break;case ap.ExcessTokensResponse.toLowerCase():s=NC.ExcessTokensResponse,l=AC.UnableToCompleteTask}break;case ip.UnsupportedLanguageError.toLowerCase():switch(s=NC.UnsupportedLanguage,l=AC.UnsupportedCopilotFunctionality,c){case ap.LowScore.toLowerCase():s=NC.LowLanguageScore;break;case ap.SydneyUnsupportedLang.toLowerCase():s=NC.UnsupportedSydneyLanguage;break;case ap.UnknownLang.toLowerCase():s=NC.UnknownDetectedLanguage;break;case ap.Unsupported_language.toLowerCase():s=NC.UnsupportedLanguage}break;case ip.VisualDescriptionGeneration.toLowerCase():switch(l=AC.ServiceSideIssuePreventsOutput,c){case ap.Unknown.toLowerCase():s=NC.VisualDescriptionsGenerationUnknownError;break;case ap.FailedToGenerateVisualDescription.toLowerCase():s=NC.VisualDescriptionsGenerationError}break;case lp.UserThrottled:if(c===lp.UserThrottled)s=NC.Throttled}if(r)return xP.setAshaErrorString(s),void xP.setAshaVetoString(l);var u=_C.CopilotChat,d=RC.UnclearIntent,p=FS(d,l);PP.logAshaErrorEvent(p,s,u)}(e,r,l),d){case ip.InferenceAPIError:if(h=DC.ServiceBusy,u)switch(u){case ap.Throttled:y.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,wL(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,y),f=pC.ErrorServerBusy;break;case ap.Timeout:h="No response as service timed out",y.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(t,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,!0,y),f=pC.ErrorRequestTimedOut;break;case ap.User_throttled:h=DC.UserThrottled,v=AC.CommandCapacityIssue,y.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,y),f=pC.ThrottlingErrorMessage;break;case ap.Scenario_throttled:h=DC.ScenarioThrottled,v=AC.CommandCapacityIssue,y.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,y),f=pC.ThrottlingErrorMessage;break;default:y.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,wL(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,y),f=pC.ErrorServerBusy}else y.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,wL(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,y),f=pC.ErrorServerBusy;break;case ip.OffensiveContent:if(h=DC.OffensiveContent,void 0!==c)switch(u=c.source){case ap.Input_query:h=DC.InputQuery,v=AC.CommandBlockedResponse,y.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,wL(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,y),f=pC.ErrorOffensiveContentBlocked;break;case ap.Generated_output:v=AC.CommandBlockedResponse,h=DC.GeneratedOutput,y.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,wL(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,y),f=pC.ErrorOffensiveContentBlocked;break;default:y.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,wL(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,y),f=pC.ErrorOffensiveContentBlocked}else y.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,wL(t,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,!0,y),f=pC.ErrorOffensiveContentBlocked;break;case ip.InputQueryError:if(h=DC.InvalidInput,u)switch(u){case ap.Too_long:h=DC.TooLong,v=AC.CommandInputCouldNotBeProcessed,y.errorMessage=PowerpointCopilotStrings.ErrorQueryTooLarge,wL(t,PowerpointCopilotStrings.ErrorQueryTooLarge,void 0,void 0,!0,y),f=pC.ErrorQueryTooLarge;break;case ap.Too_short:y.errorMessage=PowerpointCopilotStrings.ErrorQueryTooSmall,wL(t,PowerpointCopilotStrings.ErrorQueryTooSmall,void 0,void 0,!0,y),f=pC.ErrorQueryTooSmall;break;case ap.DocumentProcessingDenied:h=DC.DocumentPermission,v=AC.CommandFileReferencingFailed,y.errorMessage=OfficeaicopilotStrings.DKEAndNotExtractLabelErrorString,wL(t,OfficeaicopilotStrings.DKEAndNotExtractLabelErrorString,void 0,void 0,!0,y),f=pC.DKEAndNotExtractLabelErrorString;break;case ap.Bad_Token:h=tv()?NC.InvalidTokens:DC.Licensing,y.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,wL(t,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,!0,y),f=pC.LicenseValidationErrorMessage;break;default:y.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,wL(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,y),f=pC.ErrorServerBusy}else y.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,wL(t,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,y),f=pC.ErrorServerBusy;break;case ip.UnsupportedLanguageError:var C,S,b;if(h=DC.InvalidLanguage,o&&(b=EF(o,PowerpointCopilotStrings.CopilotUnsupportedLanguageError,wF)),b){y.errorMessage=b;var E=Jh(Dh.ShouldAddLinkSuffixForErrorMessage)?"\n\n"+PowerpointCopilotStrings.FeedbackPrompt:"";S={linkText:PowerpointCopilotStrings.CopilotSupportedLanguagesLearnMoreLink,linkPrefix:b,linkSuffix:E},f=pC.CopilotUnsupportedLanguageError}else y.errorMessage=PowerpointCopilotStrings.CopilotUnsupportedlanguageMessage,S={linkText:PowerpointCopilotStrings.LeanMoreHyperlinkText,linkPrefix:PowerpointCopilotStrings.CopilotUnsupportedlanguageMessage,linkSuffix:""},f=pC.CopilotUnsupportedlanguageMessage;null===(C=t.current)||void 0===C||C.addResponseMessage(_L(S,n,PM,fL,!0,Wd.CHATPPT,void 0,void 0,y));break;case ip.InvalidInputError:if(void 0!==u)if(u===ap.Too_short)y.errorMessage=PowerpointCopilotStrings.ErrorNotEnoughContent,wL(t,PowerpointCopilotStrings.ErrorNotEnoughContent,void 0,void 0,!0,y),f=pC.ErrorNotEnoughContent;else y.errorMessage=PowerpointCopilotStrings.ErrorInExecution,wL(t,PowerpointCopilotStrings.ErrorInExecution,void 0,void 0,!0,y),f=pC.ErrorInExecution;else y.errorMessage=PowerpointCopilotStrings.ErrorInExecution,wL(t,PowerpointCopilotStrings.ErrorInExecution,void 0,void 0,!0,y),f=pC.ErrorInExecution;break;case ip.LicensingError:h=tv()?NC.LicenseValidationFailed:DC.Licensing,y.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,wL(t,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,!0,y),f=pC.LicenseValidationErrorMessage;break;case sp.SydneyError:if(u)switch(u){case lp.UserThrottled:h=DC.Throttled,y.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,y),f=pC.ThrottlingErrorMessage;break;case lp.OutOfCredits:h=DC.OutOfCredits,y.errorMessage=RF(),wL(t,RF(),void 0,void 0,!0,y),f=pC.OutOfCreditsError;break;default:y.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,wL(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,y),f=pC.ServerErrorMessage}else y.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,wL(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,y),f=pC.ServerErrorMessage;break;case sp.DisengagedError:h=DC.Disengaged,y.errorMessage=PowerpointCopilotStrings.DisengagedError,wL(t,OfficeaicopilotStrings.DisengagedError,void 0,void 0,!0,y),f=pC.DisengagedError;break;case ip.PostProcessProgramError:var T;if(Jh(Dh.HandleUnsupportedCommandErrorCode))if(u)if(u===ap.Unsupported_Program)ZR("User requested command is not supported"),Jh(Dh.IsNoFeedbackInUnsupportedCommanding)?(null===(T=t.current)||void 0===T||T.addResponseMessage(PL(!0,!1)),f=pC.CommandNotSupportedMessage):(y.errorMessage=PowerpointCopilotStrings.CommandNotSupportedMessage,wL(t,PowerpointCopilotStrings.CommandNotSupportedMessage,void 0,void 0,!0,y),f=pC.CommandNotSupportedMessage);else y.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,wL(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,y),f=pC.ServerErrorMessage;else y.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,wL(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,y),f=pC.ServerErrorMessage;break;case ip.ResolveDelegationsError:if(Jh(Dh.HandleResolveDelegationInvalidSourceErrorCode)&&u)if(u===ap.InvalidSource)ZR("Invalid source detected"),y.errorMessage=oF(WK())?PowerpointCopilotStrings.DocumentUrlNotFromSharePoint:PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError,wL(t,y.errorMessage,void 0,void 0,!0,y),f=pC.DocumentUrlNotFromSharePoint;else y.errorMessage=PowerpointCopilotStrings.ServerErrorMessage,wL(t,PowerpointCopilotStrings.ServerErrorMessage,void 0,void 0,!0,y),f=pC.ServerErrorMessage;break;default:var I=tF(e.message);if(I.actionFound){var _,w;m="UnsupportedActionDetected".concat(cF(I.actionType)?rM:"_".concat(I.actionType)),ZR("Action only supported in ribbon detected. Action type: "+I.actionType);var P={errorMessage:PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,errorType:yp.ActionOnlySupportedInRibbonMessage,featureName:_C.Commanding};null===(_=t.current)||void 0===_||_.addResponseMessage(TL(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,hL,!1,Wd.CHATPPT,void 0,!1,!0,void 0,P)),null===(w=t.current)||void 0===w||w.addResponseMessage(xL(I.responseHeader,I.response,hL,!0,Wd.CHATPPT,void 0,void 0,P)),f=pC.ActionOnlySupportedInRibbonMessage}else{var x,k={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:yp.ServerErrorMessage,featureName:_C.Commanding};null===(x=t.current)||void 0===x||x.addResponseMessage(TL(PowerpointCopilotStrings.ServerErrorMessage,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,k)),f=pC.ServerErrorMessage}}if(Vh(Lh.IsDebugSectionV2Enabled)&&s&&a){var A,L=[],D=null===(A=t.current)||void 0===A?void 0:A.getLastMessage(!1);(null==D?void 0:D.body.user)===ig.Q9.Chat&&(EL(L,xA,s,a),D.actionBarButtons=L)}var O,N=RK,R="".concat(N?VE.getTypeName():EP.getTypeName(),"_Error");MS(PP,qp.qD,R,m===rM?null==e?void 0:e.category.concat(cF(u)?rM:"_".concat(u)):m,m===rM?ep.Server:ep.UnsupportedAction,void 0,void 0,f),PP.sendErrorTelemetry(HS((O={},(0,i._)(O,uC.ErrorCategory,N?IC.FluxCopilot:IC.CopilotODSL),(0,i._)(O,uC.ErrorMessage,N?"Failure Received From PPT Flux Copilot Workflow":"Failure Received From CopilotODSL Workflow"),O))),Kh()||PP.logAshaErrorEvent(v,h,Iv.BasicCommand)};function AP(e){return(null==e?void 0:e.locale)&&(wP=e.locale),zh("IsFinalResponseFromALEnabled",!0)?"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType||e.messageType===WE.RenderCardRequest||e.messageType===WE.RequireHumanInTheLoop)||!1:"bot"===e.author&&e.adaptiveCards&&(void 0===e.messageType||"Chat"===e.messageType||e.messageType===WE.RenderCardRequest||e.messageType===WE.RequireHumanInTheLoop)||!1}function LP(e){return"bot"===e.author&&e.messageType===WE.Disengaged}function DP(e){var t;return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&(null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase())===fp.COPILOT_POWERPOINT_SUMMARY}function OP(e){return e===fp.PERSONALIZATION_START||e===fp.PERSONALIZATION_END||e===fp.PERSONALIZATION_EXPLAIN||e===fp.PERSONALIZATION_UPDATE||e===fp.PERSONALIZATION_FORCED_DELETE}function NP(e){var t;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return function(e){return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===fp.BASIC_CHAT}(e)}))}function RP(e){var t;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return function(e){return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===fp.SUMMARIZE}(e)}))}function FP(e){return e.messageType===WE.InternalSearchQuery||e.messageType===WE.InternalLoaderMessage}function MP(e){e.conversationId&&ZR("conversation id from PowerPoint Flux Copilot: "+e.conversationId)}var BP=new Map([[PE.PowerPoint,uf._R.PowerPoint],[PE.Excel,uf._R.Excel],[PE.Word,uf._R.Word],[PE.OneNote,uf._R.OneNote],[PE.Outlook,uf._R.Outlook],[PE.Teams,uf._R.Teams],[PE.Event,uf._R.Event],[PE.Meeting,uf._R.Meeting],[PE.TeamsMeeting,uf._R.Meeting],[PE.SharePoint,uf._R.SharePoint],[PE.PDF,uf._R.Pdf],[PE.Zip,uf._R.Pdf],[PE.Visio,uf._R.Visio],[PE.Fluid,uf._R.Loop],[PE.Txt,uf._R.Txt]]);function UP(e){if(void 0!==e)return BP.has(e)?BP.get(e):void 0}function HP(e){if(void 0!==e)return Object.values(uf._R).includes(e)?e:void 0}var GP;class zP{constructor(e){Qp.h.assign(zP,this,e)}static getTypeName(){return"AugLoop_OrganizePresentation_OrganizePresentationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[zP.getTypeName()])}}zP.H_={T_:zP.getTypeName(),B_:zP.getBaseTypes()},function(e){e[e.Success=0]="Success",e[e.Unknown=1]="Unknown",e[e.RaiErrorInputContent=2]="RaiErrorInputContent",e[e.RaiErrorOrganizeOutput=3]="RaiErrorOrganizeOutput",e[e.FailedToFindCachedSlides=4]="FailedToFindCachedSlides",e[e.SlideParserError=5]="SlideParserError",e[e.OdslGenerationError=6]="OdslGenerationError",e[e.SectionCreationError=7]="SectionCreationError",e[e.SectionValidationError=8]="SectionValidationError",e[e.SlideOrderGenerationError=9]="SlideOrderGenerationError",e[e.InvalidPresentationLanguage=10]="InvalidPresentationLanguage",e[e.AgendaSlideTitleCreationError=11]="AgendaSlideTitleCreationError",e[e.ExplanationGenerationError=12]="ExplanationGenerationError",e[e.FileTooLarge=13]="FileTooLarge",e[e.PromptInjectionAttackDetected=14]="PromptInjectionAttackDetected",e[e.InsufficientSlideContent=15]="InsufficientSlideContent",e[e.TranslationError=16]="TranslationError",e[e.NoGeneratedAgendaSlideInfo=17]="NoGeneratedAgendaSlideInfo",e[e.HasExistingSections=18]="HasExistingSections",e[e.SlideCountMismatch=19]="SlideCountMismatch",e[e.UserThrottled=20]="UserThrottled",e[e.ScenarioThrottled=21]="ScenarioThrottled",e[e.ResourceThrottled=22]="ResourceThrottled"}(GP||(GP={}));var qP,WP=n(52338),jP=ob.getInstance();function VP(e,t,n,r,o,i,a,s,l){return QP.apply(this,arguments)}function QP(){return QP=(0,gd._)((function(e,t,n,r,o,i,a,s,l){var c,u=arguments;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:switch(c=!(u.length>9&&void 0!==u[9])||u[9],e.status){case Md.BLOCKED:case Md.PAUSED_ON_WARNING:case Md.UNSUPPORTED:case Md.FAILED:case Md.UNEXPECTED_VERSION:case Md.USER_ABORTED:case Md.PARTIAL_SUCCESS:case Md.CONTENT_GENERATION_DISABLED:return[3,1];case Md.SUCCESS:return[3,2]}return[3,4];case 1:return ZP(e,t,l,r,void 0,c),[3,4];case 2:return[4,JP(t,n,r,o,i,a,s)];case 3:return d.sent(),[3,4];case 4:return[2]}}))})),QP.apply(this,arguments)}function JP(e,t,n,r,o,i,a){return KP.apply(this,arguments)}function KP(){return KP=(0,gd._)((function(e,t,n,r,o,a,s){var l;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:return RK&&!Vh(Lh.UseAIResponsesInODSLForSydney)||(l={featureName:_C.CopilotChat},function(e,t,n,r,o,i,a){var s=!Vh(Lh.UseAIResponsesInODSLForSydney)||!ZA();if(n.includes("insertImages")){var l,c=PowerpointCopilotStrings.AssistantResponseLoadingImageLine1Option1;r&&(c=o.filter((function(e){return e})).join(" ")+" "),a&&(a.subFeatureName=MC.AddImage),null===(l=e.current)||void 0===l||l.addResponseMessage(TL(c+"\n\n"+PowerpointCopilotStrings.AssistantResponseLoadingImageLine2,mL,s,Wd.CHATPPT,void 0,!1,!0,void 0,a))}else if(n.includes("insertSlides")){var u,d;d=i.getScenarioName()===Cv.AddSlide?GF()[1]:GF()[2],r&&(d.linkPrefix=o.filter((function(e){return e})).join(" ")+" "),a&&(a.subFeatureName=MC.AddSlide),null===(u=e.current)||void 0===u||u.addResponseMessage(_L(d,t,void 0,mL,s,Wd.CHATPPT,void 0,void 0,a))}else if(n.includes("formatSlides")){var p,g;g=i.getScenarioName()===Cv.Beautify?{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseNewDesignPrefix,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseToUseDesignerOption1}:i.getScenarioName()===Cv.Animate?{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseAnimatingOption1,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseToUseDesignerOption1}:GF()[2],r&&(g.linkPrefix=o.filter((function(e){return e})).join(" ")+" "),null===(p=e.current)||void 0===p||p.addResponseMessage(_L(g,t,void 0,mL,s,Wd.CHATPPT,void 0,void 0,a))}else{var m;null===(m=e.current)||void 0===m||m.addResponseMessage(Cd({},TL(r?o[0]:JR(),mL,s,Wd.CHATPPT,void 0,!1,!0,void 0,a)))}}(e,t,r,o,a,s,l)),n.status=fE.success,[4,zA(Md.SUCCESS)];case 1:return c.sent(),jP.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.QuerySuccessful)),!1),[2]}}))})),KP.apply(this,arguments)}function XP(e,t,n,r,o){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6?arguments[6]:void 0;return cF(e.error)&&(e.error=Bd.NONE),YP(e,t,r,n,o,i,a)}function ZP(e,t,n,r,o){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];cF(e.error)&&(e.error=Bd.NONE),!RK||RK&&Vh(Lh.IsHardcodedClientErrorMessagingEnabled)?YP(e,t,null!=o?o:IC.CopilotODSL,n,r,a,void 0,s):function(e,t){switch(e.status){case Md.UNSUPPORTED:var n;jP.sendChatEventTelemetry(HS((n={},(0,i._)(n,cC.ChatEventType,dC.QueryExecutionNotSupported),(0,i._)(n,cC.ChatErrorType,ep.Client),(0,i._)(n,cC.ChatErrorKey,pC.ServerErrorMessage),n)),!1),cF(t)||(t.error=PowerpointCopilotStrings.ServerErrorMessage);break;case Md.FAILED:var r,o=ex(e,t),a=o.chatErrorType,s=o.errorKey;jP.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.QueryExecutionFailed),(0,i._)(r,cC.ChatErrorType,""===a?ep.Client:a),(0,i._)(r,cC.ChatErrorKey,s),r)),!1);break;case Md.BLOCKED:var l,c,u=ex(e,t),d=u.chatErrorType,p=u.errorKey;jP.sendChatEventTelemetry(HS((c={},(0,i._)(c,cC.ChatEventType,dC.QueryExecutionBlocked),(0,i._)(c,cC.ChatErrorType,""===d?ep.UnsupportedAction:d),(0,i._)(c,cC.ChatErrorParameters,null!==(l=e.error)&&void 0!==l?l:""),(0,i._)(c,cC.ChatErrorKey,p),c)),!1);break;case Md.PAUSED_ON_WARNING:var g,m,f=ex(e,t),h=f.chatErrorType,v=f.errorKey;jP.sendChatEventTelemetry(HS((m={},(0,i._)(m,cC.ChatEventType,dC.QueryExecutionPausedOnWarning),(0,i._)(m,cC.ChatErrorType,""===h?ep.UnsupportedAction:h),(0,i._)(m,cC.ChatErrorParameters,null!==(g=e.error)&&void 0!==g?g:""),(0,i._)(m,cC.ChatErrorKey,v),m)),!1);break;case Md.UNEXPECTED_VERSION:var y;jP.sendChatEventTelemetry(HS((y={},(0,i._)(y,cC.ChatEventType,dC.QueryExecutionUnexpectedVersionError),(0,i._)(y,cC.ChatErrorType,ep.Client),(0,i._)(y,cC.ChatErrorKey,pC.UnexpectedVersionErrorMessage),y)),!1),cF(t)||(t.error=PowerpointCopilotStrings.UnexpectedVersionErrorMessage);break;case Md.USER_ABORTED:var C;jP.sendChatEventTelemetry(HS((C={},(0,i._)(C,cC.ChatEventType,dC.QueryExecutionAbortedByUser),(0,i._)(C,cC.ChatErrorType,ep.Client),(0,i._)(C,cC.ChatErrorKey,pC.UserCancelledExecutionMessage),C)),!1),cF(t)||(t.error=PowerpointCopilotStrings.UserCancelledExecutionMessage);break;case Md.PARTIAL_SUCCESS:var S,b=function(e,t){if(e.error===Bd.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS)return cF(t)||(t.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:ep.UnsupportedAction,errorKey:pC.ErrorSlideAlreadyAnimated};return cF(t)||(t.error=KR()),{chatErrorType:ep.Server,errorKey:pC.PartialSuccessErrorMessage}}(e,t),E=b.chatErrorType,T=b.errorKey;jP.sendChatEventTelemetry(HS((S={},(0,i._)(S,cC.ChatEventType,dC.QueryExecutionPartiallySuccessful),(0,i._)(S,cC.ChatErrorType,E),(0,i._)(S,cC.ChatErrorKey,T),S)),!1);break;case Md.CONTENT_GENERATION_DISABLED:var I;jP.sendChatEventTelemetry(HS((I={},(0,i._)(I,cC.ChatEventType,dC.ContentGenerationDisabledByAdmin),(0,i._)(I,cC.ChatErrorType,ep.Client),(0,i._)(I,cC.ChatErrorKey,pC.DisabledFeatureErrorMessagePrefix),I)),!1),cF(t)||(t.error=PowerpointCopilotStrings.DisabledFeatureErrorMessagePrefix)}}(e,r)}function YP(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=arguments.length>6?arguments[6]:void 0,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=!ZA();switch(jP.sendChatEventTelemetry(HS((0,i._)({},cC.ChatErrorParameters,null!==(n=e.error)&&void 0!==n?n:"")),!1),e.status){case Md.UNSUPPORTED:var d,p,g;if(e.error===Bd.COMMANDING_DISABLED){if(Jh(Dh.IsNoFeedbackInUnsupportedCommanding))PL(s,!1);else{var m,f={errorMessage:PowerpointCopilotStrings.CommandNotSupportedMessage,errorType:yp.CommandNotSupported,featureName:_C.Commanding,subFeatureName:void 0};null===(m=t.current)||void 0===m||m.addResponseMessage(PL(s,!0,f))}p=PowerpointCopilotStrings.CommandNotSupportedMessage,d=dC.QueryExecutionNotSupported,g=pC.CommandNotSupportedMessage}else if(e.error===Bd.MULTIPLE_GENERATE_IN_ODSL){var h,v={errorMessage:PowerpointCopilotStrings.CommandNotSupportedMessage,errorType:yp.CommandNotSupported,featureName:_C.Commanding,subFeatureName:void 0};null===(h=t.current)||void 0===h||h.addResponseMessage(TL(PowerpointCopilotStrings.CommandNotSupportedMessage,hL,s,Wd.CHATPPT,void 0,!1,!0,void 0,v)),p=PowerpointCopilotStrings.CommandNotSupportedMessage,d=dC.QueryExecutionAbortedForMultiGenerateSlides,g=pC.CommandNotSupportedMessage}else{var y,C={errorMessage:PowerpointCopilotStrings.CommandNotSupportedMessage,errorType:yp.CommandNotSupported,featureName:_C.Commanding};null===(y=t.current)||void 0===y||y.addResponseMessage(TL(PowerpointCopilotStrings.ServerErrorMessage,hL,s,Wd.CHATPPT,void 0,!1,!0,void 0,C)),p=PowerpointCopilotStrings.ServerErrorMessage,d=dC.QueryExecutionNotSupported,g=pC.ServerErrorMessage}cF(a)||(a.error=p),MS(jP,qp.qD,d,r,ep.Client,!0,u,g,c);break;case Md.FAILED:var S=$P(e,t,a,s),b=S.chatErrorType,E=S.errorKey;MS(jP,qp.qD,dC.QueryExecutionFailed,r,""===b?ep.Client:b,!0,u,E,c);break;case Md.BLOCKED:var T=$P(e,t,a,s),I=T.chatErrorType,_=T.errorKey;MS(jP,qp.qD,dC.QueryExecutionBlocked,r,""===I?ep.UnsupportedAction:I,!0,u,_,c);break;case Md.PAUSED_ON_WARNING:var w=$P(e,t,a),P=w.chatErrorType,x=w.errorKey;MS(jP,qp.qD,dC.QueryExecutionPausedOnWarning,r,""===P?ep.UnsupportedAction:P,!0,u,x,c);break;case Md.UNEXPECTED_VERSION:var k,A={errorMessage:PowerpointCopilotStrings.UnexpectedVersionErrorMessage,errorType:yp.UnexpectedVersionErrorMessage,featureName:_C.Commanding,subFeatureName:void 0};null===(k=t.current)||void 0===k||k.addResponseMessage(TL(PowerpointCopilotStrings.UnexpectedVersionErrorMessage,hL,s,Wd.CHATPPT,void 0,!1,!0,void 0,A)),cF(a)||(a.error=PowerpointCopilotStrings.UnexpectedVersionErrorMessage),MS(jP,qp.qD,dC.QueryExecutionUnexpectedVersionError,r,ep.Client,!0,u,pC.UnexpectedVersionErrorMessage,c);break;case Md.USER_ABORTED:var L;if(pd()&&!0===o.current){var D,O={errorMessage:PowerpointCopilotStrings.StopGeneratingResponseMessage,errorType:yp.StopGeneratingResponseMessage,featureName:_C.Commanding,subFeatureName:void 0};null===(D=t.current)||void 0===D||D.addResponseMessage(TL(PowerpointCopilotStrings.StopGeneratingResponseMessage,hL,s,Wd.CHATPPT,void 0,!1,!0,void 0,O)),L=pC.StopGeneratingResponseMessage}else{var N,R={errorMessage:PowerpointCopilotStrings.UserCancelledExecutionMessage,errorType:yp.UserCancelledExecutionMessage,featureName:_C.Commanding,subFeatureName:void 0};null===(N=t.current)||void 0===N||N.addResponseMessage(TL(PowerpointCopilotStrings.UserCancelledExecutionMessage,hL,s,Wd.CHATPPT,void 0,!1,!0,void 0,R)),L=pC.UserCancelledExecutionMessage}MS(jP,qp.qD,dC.QueryExecutionAbortedByUser,r,ep.Client,!0,u,L,c);var F=qw(AC.UserCancelledResponse,NC.UserAbortedQueryExecution);jP.logAshaErrorEvent(F.vetoName,F.errorString,F.featureName),cF(a)||(a.error=PowerpointCopilotStrings.UserCancelledExecutionMessage);break;case Md.PARTIAL_SUCCESS:var M=function(e,t,n,r,o,i){var a=null==r||r;var s;if(e.error===Bd.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS)return o&&(o.errorMessage=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,o.errorType=yp.ErrorSlideAlreadyAnimated),null===(s=t.current)||void 0===s||s.addResponseMessage(TL(PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,hL,a,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:ep.UnsupportedAction,errorKey:pC.ErrorSlideAlreadyAnimated};var l,c=null!=i?i:KR();return o&&(o.errorMessage=c,o.errorType=void 0),null===(l=t.current)||void 0===l||l.addResponseMessage(TL(c,hL,a,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=c),{chatErrorType:ep.Server,errorKey:pC.ErrorGenericFallback}}(e,t,a,s,{errorMessage:PowerpointCopilotStrings.UserCancelledExecutionMessage,errorType:yp.UserCancelledExecutionMessage,featureName:_C.Commanding,subFeatureName:void 0},l),B=M.chatErrorType,U=M.errorKey;MS(jP,qp.qD,dC.QueryExecutionPartiallySuccessful,r,B,!0,u,U,c);var H=qw(AC.ServiceSideIssuePreventsOutput,NC.PartialSuccessErrorMessage);jP.logAshaErrorEvent(H.vetoName,H.errorString,H.featureName);break;case Md.CONTENT_GENERATION_DISABLED:var G,z={errorMessage:PowerpointCopilotStrings.UserCancelledExecutionMessage,errorType:yp.UserCancelledExecutionMessage,featureName:_C.Commanding,subFeatureName:void 0};null===(G=t.current)||void 0===G||G.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:PowerpointCopilotStrings.DisabledFeatureErrorMessagePrefix},messageFooter:{linkText:{text:PowerpointCopilotStrings.DisabledFeatureErrorMessageLinkText,linkOnClick:hF,linkUrl:_M}}}},chatMessageBodyData:Sd(Cd({},hL),{feedbackData:NN(void 0,z)}),stopLoadingUi:s}),cF(a)||(a.error=PowerpointCopilotStrings.DisabledFeatureErrorMessagePrefix),MS(jP,qp.qD,dC.ContentGenerationDisabledByAdmin,r,ep.Client,!0,u,pC.DisabledFeatureErrorMessagePrefix,c)}}function $P(e,t,n,r,o){var i=null==r||r,a=!1;switch(e.error){case Bd.CREATE_PRESENTATION_BLOCKED:case Bd.CREATE_PRESENTATION_BLOCKED_ON_WARNING:var s;return o&&(o.errorMessage=PowerpointCopilotStrings.AssistantCreatePresentationResponseHeaderMessage,o.errorType=pC.AssistantCreatePresentationResponseHeaderMessage),null===(s=t.current)||void 0===s||s.addResponseMessage(xL(PowerpointCopilotStrings.AssistantCreatePresentationResponseHeaderMessage,KF(),hL,!0,Wd.CHATPPT,void 0,void 0,o)),{chatErrorType:ep.UnsupportedAction,errorKey:pC.AssistantCreatePresentationResponseHeaderMessage};case Bd.DESIGNER_DISABLED:var l;return o&&(o.errorMessage=PowerpointCopilotStrings.DesignerDisabledErrorMessage,o.errorType=pC.DesignerDisabledErrorMessage),null===(l=t.current)||void 0===l||l.addResponseMessage(TL(PowerpointCopilotStrings.DesignerDisabledErrorMessage,hL,r,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.DesignerDisabledErrorMessage),{chatErrorType:ep.UnsupportedAction,errorKey:pC.DesignerDisabledErrorMessage};case Bd.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING:a=!0;case Bd.STRUCTURE_PRESENTATION_BLOCKED:var c,u=a||i;return o&&(o.errorMessage=PowerpointCopilotStrings.ErrorPresentationAlreadyStructured,o.errorType=void 0),null===(c=t.current)||void 0===c||c.addResponseMessage(TL(PowerpointCopilotStrings.ErrorPresentationAlreadyStructured,hL,u,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.ErrorPresentationAlreadyStructured),{chatErrorType:ep.UnsupportedAction,errorKey:pC.ErrorPresentationAlreadyStructured};case Bd.SEGMENT_TO_SLIDE_SERVER_ERROR:var d;return o&&(o.errorMessage=PowerpointCopilotStrings.StorytellerErrorMessage,o.errorType=pC.StorytellerErrorMessage),null===(d=t.current)||void 0===d||d.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerErrorMessage,hL,i,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:ep.Server,errorKey:pC.StorytellerErrorMessage};case Bd.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS:var p;return o&&(o.errorMessage=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,o.errorType=void 0),null===(p=t.current)||void 0===p||p.addResponseMessage(TL(PowerpointCopilotStrings.ErrorSlideAlreadyAnimated,hL,i,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:ep.UnsupportedAction,errorKey:pC.ErrorSlideAlreadyAnimated};case Bd.APPLY_CLP_LABEL_FAILED:if(Jh(Dh.IsApplyCLPLabelErrorChangeEnabled)){o&&(o.errorMessage=PowerpointCopilotStrings.CLPUnableToApplySensitivityLabel,o.errorType=void 0);var g,m=PowerpointCopilotStrings.CLPUnableToApplySensitivityLabel;if(e.errorMessage&&(m=e.errorMessage),Jh(Dh.UseNewCopilotSharedPackage))ZR("Error while applying clp label");else null===(g=t.current)||void 0===g||g.addResponseMessage(TL(m,hL,i,Wd.CHATPPT,void 0,!1,!0,void 0,o));return cF(n)||(n.error=m),{chatErrorType:ep.UnsupportedAction,errorKey:pC.CLPUnableToApplySensitivityLabel}}var f;return o&&(o.errorMessage=PowerpointCopilotStrings.StorytellerErrorMessage,o.errorType=void 0),null===(f=t.current)||void 0===f||f.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerErrorMessage,hL,i,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:"",errorKey:pC.StorytellerErrorMessage};case Bd.IMAGE_INVALID_ODSL:var h,v=Jh(Dh.UseImageOutOfScopeIntentErrorForImageInvalid)?PowerpointCopilotStrings.ImageOutOfScopeIntentError:PowerpointCopilotStrings.StorytellerErrorMessage;return o&&(o.errorMessage=v,o.errorType=void 0),null===(h=t.current)||void 0===h||h.addResponseMessage(TL(v,hL,i,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=v),{chatErrorType:ep.UnsupportedAction,errorKey:Jh(Dh.UseImageOutOfScopeIntentErrorForImageInvalid)?pC.ImageOutOfScopeIntentError:pC.StorytellerErrorMessage};default:var y;return o&&(o.errorMessage=PowerpointCopilotStrings.StorytellerErrorMessage,o.errorType=void 0),null===(y=t.current)||void 0===y||y.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerErrorMessage,hL,i,Wd.CHATPPT,void 0,!1,!0,void 0,o)),cF(n)||(n.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:"",errorKey:pC.StorytellerErrorMessage}}}function ex(e,t){switch(e.error){case Bd.CREATE_PRESENTATION_BLOCKED:case Bd.CREATE_PRESENTATION_BLOCKED_ON_WARNING:return cF(t)||(t.error=function(e,t){var n=e,r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){n=n+" "+a.value}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(PowerpointCopilotStrings.AssistantCreatePresentationResponseHeaderMessage,KF())),{chatErrorType:ep.UnsupportedAction,errorKey:pC.AssistantCreatePresentationResponseHeaderMessage};case Bd.DESIGNER_DISABLED:return cF(t)||(t.error=PowerpointCopilotStrings.DesignerDisabledErrorMessage),{chatErrorType:ep.UnsupportedAction,errorKey:pC.DesignerDisabledErrorMessage};case Bd.STRUCTURE_PRESENTATION_BLOCKED:case Bd.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING:return cF(t)||(t.error=PowerpointCopilotStrings.ErrorPresentationAlreadyStructured),{chatErrorType:ep.UnsupportedAction,errorKey:pC.ErrorPresentationAlreadyStructured};case Bd.SEGMENT_TO_SLIDE_SERVER_ERROR:return cF(t)||(t.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:ep.Server,errorKey:pC.StorytellerErrorMessage};case Bd.DESIGNER_FAILURE_ANIMATION_ALREADY_EXISTS:return cF(t)||(t.error=PowerpointCopilotStrings.ErrorSlideAlreadyAnimated),{chatErrorType:ep.UnsupportedAction,errorKey:pC.ErrorSlideAlreadyAnimated};default:return cF(t)||(t.error=PowerpointCopilotStrings.StorytellerErrorMessage),{chatErrorType:"",errorKey:pC.StorytellerErrorMessage}}}var tx=sb.getInstance(),nx=ob.getInstance(),rx=function(){var e=(0,gd._)((function(e){var t,n,r,o,a,s,l;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:return n=Sb.getInstance(),r=n.getChatRef(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(qp.dB),Jh(Dh.IsSendSlideMonikerEnabled)?[4,$v(e)]:[3,2];case 1:return a=c.sent(),[3,3];case 2:a=void 0,c.label=3;case 3:return o=a,s={outputExplanationLanguage:Dx,correlationId:qp.dB,hasSections:ib.getInstance().getDocumentState().hasSection,slideCount:ib.getInstance().getSlideCount(),jsonCmdApiVersion:zR.getSettingAsString(DR.PPTJsonCmdAPIVersion),selectedSlide:o},l=new Vp.Xr({parentPath:["Signal",zP.getTypeName()],items:[{id:aT.generateId(),body:new zP(s)}]}),qP=(new Date).getTime(),null===(t=r.current)||void 0===t||t.submitOperation({operation:l,workflowAnnotationType:dw.getTypeName()}),lw.getInstance().setSkillName(mp.OrganizePresentation),nx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.OrganizePresentationOperationSubmitted))),ZR("successfully submitted operation to AL : \n\n\n"+JSON.stringify(l)+"\nat Time : "+new Date+"\nSessionKey: "+(0,WP.Dt)()+"\n\n\n"),jE.getInstance().setState(Qd.WAITING_FOR_ORGANIZE_WF_RESPONSE),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),ox=function(){var e=(0,gd._)((function(e,t,n,r,o,a){var s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B;return(0,F.__generator)(this,(function(U){switch(U.label){case 0:if(jE.getInstance().setState(Qd.EXECUTING),ZR("".concat(dw.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(qP)," sec \n")),d=e.body,p=null==d?void 0:d.status,g=null==d?void 0:d.error,m=null==d||null===(s=d.odsl)||void 0===s?void 0:s.statements,f=null==d||null===(l=d.explanation)||void 0===l?void 0:l.embeddedLists,h=null==d?void 0:d.jofcPayload,v=null==d?void 0:d.jofcOptions,y=null==d?void 0:d.usage,C=null==d?void 0:d.documentLanguage,S=null==d?void 0:d.additionalSystemMetadataInfo,Jh(Dh.LogRestrictedInfo)){try{u=JSON.stringify({OrgRestrictedInfo:null==d?void 0:d.restrictedLoggingInfo,DocumentLanguage:C})}catch(e){ZR("Parsing restrictedInfo failed: ".concat(e))}Qv(u)||ZR("Organize restrictedInfo: ".concat(u))}if(Jh(Dh.LogOrganizeWorkflowDuration))try{c=JSON.stringify({Usage:y,OrgAdditionalInfo:S,TimeToIntentDetection:tx.getTimeToIntentDetection(),TimeToIntentDetectionOverTheWireTime:tx.getTimeToIntentDetectionOverTheWireTime()})}catch(e){ZR("Parsing additionalInfo failed: ".concat(e))}return void 0!==d.correlationId&&GS(d.correlationId),b=nx.getQueryGuid(),US(nx,dw.getTypeName(),qP,sC.OrganizePresentationResponseTime,_C.Organize,a),tx.setResponseTime((0,qp.WU)(qp.qD)),E=new lT({status:fE.failed,queryId:b,error:void 0}),g&&0!==g.errorCode?(ZR("Error received from ODSL for Organize Presentation :"+JSON.stringify(g)),T=function(e,t,n,r,o){var a,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6?arguments[6]:void 0;ZR("Error in OrganizePresentation, Type : ".concat(e.errorCode,", Message : ").concat(e.message,"\n")),ob.getInstance().sendErrorTelemetry(HS((a={},(0,i._)(a,uC.ErrorMessage,"Error in OrganizePresentation Workflow , Code: ".concat(GP[e.errorCode],", SignalSubmitTime: ").concat(r,", LastSlideCountUpdateTime: ").concat(ib.getInstance().getLastSlideCountUpdateTime(),", LastHasSectionUpdateTime: ").concat(ib.getInstance().getLastHasSectionUpdateTime())),(0,i._)(a,uC.ErrorCategory,IC.OrganizePresentation),a)));var c,u={errorType:"".concat(e.errorCode),featureName:_C.Organize};switch(e.errorCode){case GP.RaiErrorInputContent:case GP.RaiErrorOrganizeOutput:case GP.PromptInjectionAttackDetected:u.errorMessage=PowerpointCopilotStrings.OrganizePresentationRAIError,wL(t,PowerpointCopilotStrings.OrganizePresentationRAIError,void 0,void 0,s,u),cF(o)||(o.error=PowerpointCopilotStrings.OrganizePresentationRAIError),c=pC.OrganizePresentationRAIError;break;case GP.FileTooLarge:u.errorMessage=PowerpointCopilotStrings.OrganizePresentationTooLargeFile,wL(t,PowerpointCopilotStrings.OrganizePresentationTooLargeFile,void 0,void 0,s,u),cF(o)||(o.error=PowerpointCopilotStrings.OrganizePresentationTooLargeFile),c=pC.OrganizePresentationTooLargeFile;break;case GP.InsufficientSlideContent:u.errorMessage=PowerpointCopilotStrings.OrganizePresentationInsufficientSlideContent,wL(t,PowerpointCopilotStrings.OrganizePresentationInsufficientSlideContent,void 0,void 0,s,u),cF(o)||(o.error=PowerpointCopilotStrings.OrganizePresentationInsufficientSlideContent),c=pC.OrganizePresentationInsufficientSlideContent;break;case GP.InvalidPresentationLanguage:var d;if(l&&(d=EF(l,PowerpointCopilotStrings.OrganizePresentationUnsupportedLanguage,_F)),d){var p;u.errorMessage=d;var g=Jh(Dh.ShouldAddLinkSuffixForErrorMessage)?"\n\n"+PowerpointCopilotStrings.FeedbackPrompt:"",m={linkText:PowerpointCopilotStrings.CopilotSupportedLanguagesLearnMoreLink,linkPrefix:d,linkSuffix:g};null===(p=t.current)||void 0===p||p.addResponseMessage(_L(m,n,PM,fL,!0,Wd.CHATPPT,void 0,void 0,u)),cF(o)||(o.error=d),c=pC.OrganizePresentationUnsupportedLanguage}else u.errorMessage=PowerpointCopilotStrings.OrganizePresentationInvalidLanguaguage,wL(t,PowerpointCopilotStrings.OrganizePresentationInvalidLanguaguage,void 0,void 0,s,u),cF(o)||(o.error=PowerpointCopilotStrings.OrganizePresentationInvalidLanguaguage),c=pC.OrganizePresentationInvalidLanguaguage;break;case GP.UserThrottled:case GP.ScenarioThrottled:case GP.ResourceThrottled:u.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(t,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,s,u),cF(o)||(o.error=PowerpointCopilotStrings.ThrottlingErrorMessage),c=pC.ThrottlingErrorMessage;break;case GP.Unknown:case GP.FailedToFindCachedSlides:case GP.SlideParserError:case GP.OdslGenerationError:case GP.SectionCreationError:case GP.SectionValidationError:case GP.SlideOrderGenerationError:case GP.AgendaSlideTitleCreationError:case GP.ExplanationGenerationError:default:u.errorMessage=PowerpointCopilotStrings.OrganizePresentationServiceUnavailable,wL(t,PowerpointCopilotStrings.OrganizePresentationServiceUnavailable,void 0,void 0,s,u),cF(o)||(o.error=PowerpointCopilotStrings.OrganizePresentationServiceUnavailable),c=pC.OrganizePresentationServiceUnavailable}return c}(g,t,n,qP,E,!ZA(),C),UA()?[3,1]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,3])):[3,4];case 1:return[4,HA(E,t)];case 2:U.sent(),U.label=3;case 3:return MS(nx,qp.qD,"".concat(dw.getTypeName(),"_Error"),GP[g.errorCode],ep.Server,void 0,!ZA(),T),M_(!1,"OrganizePresentationWorkflow_".concat(GP[g.errorCode]),Cv.Organize,c,u),[2];case 4:ZR("Statements received from ODSL for organize Presentation :"+JSON.stringify(m)+"status: "+p),I={status:Md.SUCCESS},_=!0,w=(new Date).getTime(),tx.setScenarioName(Cv.Organize),U.label=5;case 5:return U.trys.push([5,10,,11]),Jh(Dh.UseOrganizePresentationJOfcCmds)&&(null==h||null===(P=h.cmds)||void 0===P?void 0:P.length)?(r(!1),ZR("jOfcPayload received from Organize Presentation :"+JSON.stringify(h)),x=Jh(Dh.LogQuerySubmitTime)?{scenarioName:Cv.Organize,startTime:tx.getStartTime(),entryPoint:XM.Chat,correlationId:b,timeToODSLMS:1e3*tx.getResponseTime(),timeODSLToJOfcMS:0,capability:tx.getCapability(),featureName:tx.getFeatureName(),subFeatureName:tx.getSubFeatureName(),querySubmitTime:qp.qD,additionalSystemMetadataInfo:c,additionalComponentDataInfo:u}:{scenarioName:Cv.Organize,startTime:tx.getStartTime(),entryPoint:XM.Chat,correlationId:b,timeToODSLMS:1e3*tx.getResponseTime(),timeODSLToJOfcMS:0,capability:tx.getCapability(),featureName:tx.getFeatureName(),subFeatureName:tx.getSubFeatureName(),additionalSystemMetadataInfo:c,additionalComponentDataInfo:u},ZR("scenarioOptions : ",JSON.stringify(x)),k={scenarioOptions:JSON.stringify(x)},Jh(Dh.OrganizeDesignerOptions)&&v&&(A=v.designerOptions?JSON.stringify(v.designerOptions):void 0,ZR("designerOptions : ",A),k.designerOptions=A),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,X_(e,h.cmds,k)];case 1:return I=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())]):[3,7];case 6:return U.sent(),[3,9];case 7:return[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q_(e,m,r,_)];case 1:return I=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 8:U.sent(),U.label=9;case 9:return ZR("log result : ",JSON.stringify(I)),[3,11];case 10:return L=U.sent(),ZR("Execute failed:"+JSON.stringify(L)),I={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},[3,11];case 11:switch(nx.sendLatencyTelemetry(HS((0,i._)({},sC.QueryExecutionTime,(0,qp.WU)(w)))),Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&I.status!==Md.SUCCESS&&nx.sendChatEventTelemetry(HS((O={},(0,i._)(O,cC.ChatEventType,dC.OrganizePresentationJOfcCommandsError),(0,i._)(O,cC.ChatEventParameters,Bd[null!==(D=I.error)&&void 0!==D?D:Bd.UNKNOWN_ERROR]),O))),I.status){case Md.BLOCKED:case Md.UNSUPPORTED:case Md.FAILED:case Md.UNEXPECTED_VERSION:case Md.USER_ABORTED:case Md.PARTIAL_SUCCESS:XP(I,t,o,dw.getTypeName(),E,!ZA());break;case Md.SUCCESS:E.status=fE.success,R=!ZA(),M={featureName:_C.Organize,subFeatureName:MC.Organize},null===(N=t.current)||void 0===N||N.addResponseMessage(LL(f,PowerpointCopilotStrings.AssistantResponseOrganizePrefix,void 0,mL,R,void 0,Iv.Organize,void 0,M)),nx.sendChatEventTelemetry(HS((B={},(0,i._)(B,cC.ChatEventType,dC.QuerySuccessful),(0,i._)(B,cC.ChatEventParameters,dw.getTypeName()),B))),MS(nx,qp.qD,void 0,void 0,void 0,void 0,R)}return UA()?[4,HA(E,t)]:[3,13];case 12:return U.sent(),[3,14];case 13:jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),U.label=14;case 14:return tx.resetData(),[2]}}))}));return function(t,n,r,o,i,a){return e.apply(this,arguments)}}(),ix=n(24582);class ax{constructor(e){Qp.h.assign(ax,this,e)}static getTypeName(){return"AugLoop_Storyteller_StorytellerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[ax.getTypeName()])}}ax.H_={T_:ax.getTypeName(),B_:ax.getBaseTypes()};var sx,lx=n(79855);!function(e){e.LLMOutput_NotJSON="LLM output response is not JSON",e.LLMOutput_NotJSONButHasOutlineKeys="LLM output is non-JSON format presentation",e.LLMOutput_NoPresentation="LLM output response has no Presentation",e.LLMOutput_NoSlides="LLM output response has no Slides",e.LLMOutput_MalformedSlidesArray="LLM output response of Slides is not Array",e.LLMOutput_MalformedSlideTitle="LLM output response of Slide.title is not string",e.LLMOutput_MalformedKeyPointsArray="LLM output response of Slide.keyPoints is not Array",e.LLMOutput_MalformedImagesArray="LLM output response of Slide.images is not Array",e.LLMOutput_MalformedKeyPoint="LLM output response of a keyPoint is not string",e.LLMOutput_MalformedImage="LLM output response of a image is not string",e.LLMOutput_FailedToParseResponse="LLM output response was not able to be parsed.",e.LLMOutput_OutlineJSONSyntaxError="Outline JSON syntax error",e.LLMOutput_ModuleSlideJSONSyntaxError="Module slide JSON parse syntax error",e.LLMOutput_EmptyResponse="LLM output response empty",e.LLMOutput_NoTopicSpecified="LLM Input: No Topic Specified",e.LLMOutput_RAIBlocked="LLM RAI blocked",e.LLMOutput_InvalidTopic="LLM Input: Invalid Topic",e.LLMOutput_PrivateUrl="LLM Input: Contains inaccessible URL",e.LLMOutput_TooManySlides="LLM Input: Too many slides requested",e.LLMOutput_TooManyOutputSlides="LLM Output: Too many slides generated",e.LLMOutput_UnknownErrorReason="LLM output contains unknown error reason",e.RegexError="Regex Error"}(sx||(sx={}));var cx,ux=n(58651),dx=sb.getInstance(),px=ob.getInstance(),gx=function(){var e=(0,gd._)((function(){var e,t,n,r,o,a,s,l,c,u,d,p,g,m,f,h=arguments;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:null,t=h.length>1&&void 0!==h[1]&&h[1],n=h.length>2?h[2]:void 0,r=h.length>3?h[3]:void 0,o=h.length>4?h[4]:void 0,a=h.length>5?h[5]:void 0,l=Sb.getInstance().getChatRef(),cx=(new Date).getTime(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(qp.dB),c=6,u=ib.getInstance().isCreateNewFromBlank()?"":"NonEmptyTemplateId",Jh(Dh.IsSendSlideMonikerEnabled)?[4,$v(n)]:[3,2];case 1:return p=v.sent(),[3,3];case 2:p=void 0,v.label=3;case 3:return d=p,[4,$v(n,a)];case 4:return g=v.sent(),m=Object.assign(new ax,{prompt:null!==e?e:"",numSlides:c,contextId:qp.dB,groundingData:r,chatConversations:o,debugParams:{debugMetadataEnabled:!0,outlinePromptTemplate:"instructions3PlusWithOutline"},settingParams:{textToImageEnabled:!1,hubbleEnabled:!0,hubbleAggregateApiEnabled:!0,templateId:u,fCreateJsonCmdList:Vh(Lh.IsUseStoryTellerJsonCmdEnabled),entryPoint:XM.Chat},fAddSlidesToExistingPres:t,outputLanguage:Dx,selectedSlide:d,after:g,jsonCmdApiVersion:zR.getSettingAsString(DR.PPTJsonCmdAPIVersion)}),f=new Vp.Xr({parentPath:["Signal",ax.getTypeName()],items:[{id:lx.r.generateId(),body:m}]}),jE.getInstance().getState()===Qd.IDLE?[2]:(null===(s=l.current)||void 0===s||s.submitOperation({operation:f,workflowAnnotationType:gw.getTypeName()}),px.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.StoryTellerOperationSubmitted))),jE.getInstance().setState(Qd.WAITING_FOR_STORY_TELLER_WF_RESPONSE),[2])}}))}));return function(){return e.apply(this,arguments)}}(),mx=function(){var e=(0,gd._)((function(e,t,n,r,o,a,s){var l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee;return(0,F.__generator)(this,(function(te){switch(te.label){case 0:if(ZR("".concat(gw.getTypeName()," response received\n Time Taken: ").concat((0,qp.WU)(cx),"s ")),jE.getInstance().getState()===Qd.IDLE)return ZR("CopilotODSLAnnotationProcessor: ExecutionStateManager is in IDLE state. Returning"),[2];if(dx.setResponseTime((0,qp.WU)(qp.qD)),jE.getInstance().setState(Qd.EXECUTING),l=e.body,c=null==l?void 0:l.slides,u=null==l?void 0:l.after,d=null==l?void 0:l.presentationOutline,p=null==l?void 0:l.imageTelemetry,g=null==l?void 0:l.status,m=null==l?void 0:l.designerOptions,f=null==l?void 0:l.selectionOptions,h=null==l?void 0:l.fAddSlidesToExistingPres,v=h?Cv.AddSlide:Cv.CreatePresentation,y=null==l?void 0:l.additionalSystemMetadataInfo,C=null==l?void 0:l.jsonCmdPayload,Jh(Dh.LogRestrictedInfo)){try{S=JSON.stringify({STRestrictedInfo:null==l?void 0:l.restrictedLoggingInfo})}catch(e){ZR("Parsing restrictedInfo failed: ".concat(e))}cF(S)||ZR("Storyteller restrictedInfo: ".concat(S))}try{b=Jh(Dh.LogTimeToIntentDetectionDuration)?JSON.stringify({STAdditionalInfo:y,TimeToIntentDetection:dx.getTimeToIntentDetection(),TimeToIntentDetectionOverTheWireTime:dx.getTimeToIntentDetectionOverTheWireTime()}):JSON.stringify({STAdditionalInfo:y})}catch(e){ZR("Parsing additionalInfo failed")}return E={status:Md.SUCCESS},T=!0,I=[],void 0!==l.contextId&&GS(l.contextId),_=px.getQueryGuid(),US(px,gw.getTypeName(),cx,sC.StoryTellerWorkflowResponseTime,cF(d)?_C.AddSlide:_C.CreatePresentation,s),Jh(Dh.StorytellerLogDebugDataEnabled)&&(cF(w=null==l?void 0:l.debugMetadata)||ZR("Storyteller debugData: ".concat(JSON.stringify(w)))),Jh(Dh.ShouldStorytellerSetScenarioFromAddSlideParam)?(dx.setScenarioName(v),lw.getInstance().setSkillName(v===Cv.AddSlide?mp.AddSlide:mp.CreatePresentation)):dx.setScenarioName(cF(d)?Cv.AddSlide:Cv.CreatePresentation),P=new lT({status:fE.failed,queryId:_,error:void 0}),g.code===ix.lC.Success?[3,4]:(ZR("Error from Storyteller WF status code : ".concat(g.code,"\n error response : ").concat(g.errorMessage)),x=function(e,t,n,r,o){var a,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];ob.getInstance().sendErrorTelemetry(HS((a={},(0,i._)(a,uC.ErrorMessage,"Error in StoryTeller Workflow , Code : ".concat(ix.lC[n],", ErrorMsg: ").concat(r,", Scenario: ").concat(t)),(0,i._)(a,uC.ErrorCategory,IC.StoryTellerWorkflow),a)));var l,c={errorType:"".concat(ix.lC[n]),featureName:t===Cv.AddSlide?_C.AddSlide:_C.CreatePresentationFromDoc};switch(n){case ix.lC.ModelContentFilter:Jh(Dh.ShouldUseNewStorytellerErrors)&&(c.errorMessage=PowerpointCopilotStrings.StorytellerRaiBlockedMessage,wL(e,PowerpointCopilotStrings.StorytellerRaiBlockedMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.StorytellerRaiBlockedMessage),l=pC.StorytellerRaiBlockedMessage);break;case ix.lC.RaiUnsupportedLanguageInContentInput:case ix.lC.RaiUnsupportedLanguageInContentOutput:c.errorMessage=PowerpointCopilotStrings.ErrorOffensiveContentBlocked,wL(e,PowerpointCopilotStrings.ErrorOffensiveContentBlocked,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.ErrorOffensiveContentBlocked),l=pC.ErrorOffensiveContentBlocked;break;case ix.lC.Overloaded:case ix.lC.UserThrottled:case ix.lC.ScenarioThrottled:c.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(e,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.ThrottlingErrorMessage),l=pC.ThrottlingErrorMessage;break;case ix.lC.BadRequest:Jh(Dh.ShouldUseNewStorytellerErrors)&&(r===sx.LLMOutput_NoTopicSpecified?(c.errorMessage=PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage,wL(e,PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.StorytellerNoTopicSpecifiedMessage),l=pC.StorytellerNoTopicSpecifiedMessage):r===sx.LLMOutput_InvalidTopic?t===Cv.AddSlide?(c.errorMessage=PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage,wL(e,PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.StorytellerInvalidSlidesTopicMessage),l=pC.StorytellerInvalidSlidesTopicMessage):(c.errorMessage=PowerpointCopilotStrings.StorytellerInvalidPresentationTopicMessage,wL(e,PowerpointCopilotStrings.StorytellerInvalidPresentationTopicMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.StorytellerInvalidPresentationTopicMessage),l=pC.StorytellerInvalidPresentationTopicMessage):(c.errorMessage=PowerpointCopilotStrings.StorytellerFailureMessage,wL(e,PowerpointCopilotStrings.StorytellerFailureMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.StorytellerFailureMessage)));break;default:c.errorMessage=PowerpointCopilotStrings.StorytellerFailureMessage,wL(e,PowerpointCopilotStrings.StorytellerFailureMessage,void 0,void 0,s,c),cF(o)||(o.error=PowerpointCopilotStrings.StorytellerFailureMessage),l=pC.StorytellerFailureMessage}return l}(t,v,g.code,g.errorMessage,P,!ZA()),MS(px,qp.qD,"".concat(gw.getTypeName(),"_Error"),ix.lC[g.code],ep.Server,void 0,!ZA(),x),UA()?[3,1]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,3]));case 1:return[4,HA(P,t)];case 2:te.sent(),te.label=3;case 3:return M_(!1,"StoryTellerWorkflow_".concat(ix.lC[g.code]),dx.getScenarioName(),b,S),dx.resetData(),[2];case 4:if(k=(new Date).getTime(),Vh(Lh.IsUseStoryTellerJsonCmdEnabled)&&C?(I=C.cmds,ZR("JSON commands generated from Augloop")):cF(d)?cF(c)?(ZR("Response is undefined"),E={status:Md.FAILED}):(T=!1,L={name:mv.AddSlidesCmd,version:Dv,data:{slides:c}},I.push(L)):(A={name:mv.CreatePresentationCmd,version:Dv,data:d},I.push(A)),!(I.length>0))return[3,9];D={},O=Jh(Dh.LogQuerySubmitTime)?{scenarioName:dx.getScenarioName(),startTime:dx.getStartTime(),entryPoint:XM.Chat,correlationId:_,timeToODSLMS:1e3*dx.getResponseTime(),timeODSLToJOfcMS:0,capability:dx.getCapability(),featureName:dx.getFeatureName(),subFeatureName:dx.getSubFeatureName(),querySubmitTime:qp.qD,additionalSystemMetadataInfo:b,additionalComponentDataInfo:S}:{scenarioName:dx.getScenarioName(),startTime:dx.getStartTime(),entryPoint:XM.Chat,correlationId:_,timeToODSLMS:1e3*dx.getResponseTime(),timeODSLToJOfcMS:0,capability:dx.getCapability(),featureName:dx.getFeatureName(),subFeatureName:dx.getSubFeatureName(),additionalSystemMetadataInfo:b,additionalComponentDataInfo:S},D.scenarioOptions=JSON.stringify(O),ZR("scenarioOptions : ",JSON.stringify(O)),cF(m)||(D.designerOptions=JSON.stringify(m)),cF(f)||(D.selectionOptions=JSON.stringify(f)),te.label=5;case 5:return te.trys.push([5,7,,8]),pd()?r(!0):r(!1),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){var t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return[4,Yv(e)];case 1:return t=o.sent(),I[0].name!==mv.AddSlidesCmd||0===t.length?[3,4]:cF(n=u)?[4,Xv(e,t)]:[3,3];case 2:r=o.sent().split("#"),n={type:lv.Slide,id:+r[0],cId:+r[1]},o.label=3;case 3:I[0].after=n,o.label=4;case 4:return[4,X_(e,I,D)];case 5:return E=o.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 6:return te.sent(),ZR("log result : ",JSON.stringify(E)),[3,8];case 7:return N=te.sent(),ZR("Execution failed"+JSON.stringify(N)),E={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},[3,8];case 8:return Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&E.status!==Md.SUCCESS&&px.sendChatEventTelemetry(HS((M={},(0,i._)(M,cC.ChatEventType,dC.StoryTellerJOfcCommandsError),(0,i._)(M,cC.ChatEventParameters,Bd[null!==(R=E.error)&&void 0!==R?R:Bd.UNKNOWN_ERROR]),M))),[3,10];case 9:M_(!1,"StoryTellerWorkflow_NoCmdsGenerated",dx.getScenarioName(),b),te.label=10;case 10:switch(px.sendLatencyTelemetry(HS((0,i._)({},sC.QueryExecutionTime,(0,qp.WU)(k)))),B=Lx.length>0&&""!==Lx[0]&&fF(Dx),U=!(!Jh(Dh.ShouldReturnCustomStringForNoTopic)||!g.isNoTopicPresentation)&&!cF(d),E.status){case Md.BLOCKED:case Md.UNSUPPORTED:case Md.FAILED:case Md.UNEXPECTED_VERSION:case Md.USER_ABORTED:case Md.PARTIAL_SUCCESS:return[3,11];case Md.SUCCESS:return[3,12]}return[3,14];case 11:return H=void 0,Jh(Dh.IsUpdatedCannedStringsEnabled)&&U&&E.status==Md.PARTIAL_SUCCESS&&(H=PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateMessageNew+"\n\n"+PowerpointCopilotStrings.StorytellerNoTopicAutoGeneratePartialMessage),XP(E,t,a,gw.getTypeName(),P,!ZA(),H),[3,14];case 12:return P.status=fE.success,[4,zA(Md.SUCCESS)];case 13:if(te.sent(),G={linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseContentCreationLine1Option1,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseAddSlideLine2},T||(G.linkPrefix=PowerpointCopilotStrings.AssistantResponseAddSlidePrefix),B&&(G.linkPrefix=Lx.filter((function(e){return e})).join(" ")+" "),cF(d)||o(),z=!ZA(),q={},q=Jh(Dh.GetUserPresentationDetails)&&(null==I?void 0:I.length)&&I[0].name===mv.CreatePresentationCmd?fx(p,I,dx.getFeatureName()):{featureName:dx.getFeatureName()},U)Jh(Dh.IsUpdatedCannedStringsEnabled)?null===(W=t.current)||void 0===W||W.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateMessageNew+"\n\n"+PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateSecondLineMessage,mL,z,Wd.CHATPPT,void 0,!1,!0,void 0,q)):null===(j=t.current)||void 0===j||j.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerNoTopicAutoGenerateMessage,mL,z,Wd.CHATPPT,void 0,!1,!0,void 0,q));else{if(V=[],Jh(Dh.IsNERBlockingUIEnabled))try{Q=null==l?void 0:l.featuresDataDictionary,void 0!==(J=null==Q?void 0:Q.NERDroppedSlideIndices)&&""!==J&&(K=J.split(","),X=K.map(Number),Z=X.map((function(e){return e+1})),V=Z.map(String).sort())}catch(e){ZR("StoryTellerAnnotationHandler - error parsing nerDroppedSlideIndicesArray: ".concat(e))}Jh(Dh.IsNERBlockingUIEnabled)&&V.length>0?null===(Y=t.current)||void 0===Y||Y.addResponseMessage({chatCardType:jp._.SlideLinksCard,chatMessageData:{slideLinksCardProps:{user:"chat",aIExplanationMessage:B?Lx.filter((function(e){return e})).join(" "):"",slideIndices:V,handleSlideLinkClicked:function(){var e=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:t=e-1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){var n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return(n=e.presentation.slides).load("items, items/id"),[4,e.sync()];case 1:return o.sent(),t>=0&&t<n.items.length?(void 0!==(r=n.items[t].id)&&e.presentation.setSelectedSlides([r]),[4,e.sync()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),ZR("StoryTellerAnnotationHandler::SlideLinksCard failed to select slide link for index: "+t+" error :"+n),[3,4];case 4:return[2,Promise.resolve(ZR("StoryTellerAnnotationHandler::SlideLinksCard slide link clicked"))]}}))}));return function(t){return e.apply(this,arguments)}}()}},chatMessageBodyData:Sd(Cd({},mL),{feedbackData:NN(Wd.CHATPPT,q),telemetryData:RN(void 0,void 0)}),stopLoadingUi:z}):null===($=t.current)||void 0===$||$.addResponseMessage(_L(G,n,void 0,mL,z,Wd.CHATPPT,void 0,void 0,q))}return px.sendChatEventTelemetry(HS((ee={},(0,i._)(ee,cC.ChatEventType,dC.QuerySuccessful),(0,i._)(ee,cC.ChatEventParameters,gw.getTypeName()),ee))),MS(px,qp.qD,void 0,void 0,void 0,void 0,z),[3,14];case 14:return dx.resetData(),UA()?[3,15]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,17]);case 15:return[4,HA(P,t)];case 16:te.sent(),te.label=17;case 17:return[4,Nw(t)];case 18:return te.sent(),[2]}}))}));return function(t,n,r,o,i,a,s){return e.apply(this,arguments)}}(),fx=function(e,t,n){try{if(!(null==e?void 0:e.length)||!(null==t?void 0:t.length))return{featureName:n};var r=JSON.parse(e),o=JSON.stringify(t),i=!0,a=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;if(null==u?void 0:u.imageResults){var d=!0,p=!1,g=void 0;try{for(var m,f=u.imageResults[Symbol.iterator]();!(d=(m=f.next()).done);d=!0){var h=m.value,v=!0,y=!1,C=void 0;try{for(var S,b=h.images[Symbol.iterator]();!(v=(S=b.next()).done);v=!0){var E=S.value,T=E.url;T&&(E.url="",o=o.replace(T,""))}}catch(e){y=!0,C=e}finally{try{v||null==b.return||b.return()}finally{if(y)throw C}}}}catch(e){p=!0,g=e}finally{try{d||null==f.return||f.return()}finally{if(p)throw g}}}}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return{featureName:n,featureContent:hx(o),featureAdditionalTelemetry:hx(JSON.stringify(r))}}catch(e){throw ux.error("Error in getOCVContextData: ",e),e}},hx=function(e){var t=(new DOMParser).parseFromString(e,"text/html").body.textContent||"";return JSON.parse(t.trim())},vx=sb.getInstance(),yx=ob.getInstance(),Cx=Zy.getInstance(),Sx=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4?arguments[4]:void 0;switch(t){case np.OrganizeStructuredPresentation:return Jh(Dh.SetScenarioNameEnabled)&&vx.setScenarioName(Cv.Organize),o&&(o.featureName=_C.Organize,o.subFeatureName=MC.Organize),{chatCardType:jp._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:ig.Q9.Chat,warningPrefix:PowerpointCopilotStrings.WarningAlreadyStructuredPresentation}},chatMessageBodyData:{feedbackSectionPosition:ag.O.None,feedbackData:NN(Wd.CHATPPT,o),warningActionButtons:[{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelYesPlease,buttonText:PowerpointCopilotStrings.WarningButtonLabelYesPlease,handleButtonOnClick:(0,gd._)((function(){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return bx(PowerpointCopilotStrings.WarningButtonLabelYesPlease,e,!1,n),yx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.OrganizePresentationButtonClicked))),jE.getInstance().setState(Qd.EXECUTING),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,rx(e)];case 1:return t.sent(),Jh(Dh.SetScenarioNameEnabled)||vx.setScenarioName(Cv.Organize),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return t.sent(),Cx.resetCachedRequestParameters(),[2]}}))})),isDisabled:r},{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelNoThanks,buttonText:PowerpointCopilotStrings.WarningButtonLabelNoThanks,handleButtonOnClick:(0,gd._)((function(){return(0,F.__generator)(this,(function(t){return bx(PowerpointCopilotStrings.WarningButtonLabelNoThanks,e,!0,n),Tx(Iv.Organize,MC.Organize),mb.getInstance().emptyContextIdListandCleanup(),jE.getInstance().setState(Qd.IDLE),Cx.resetCachedRequestParameters(),M_(!1,Jh(Dh.DifferentiateCancelFromWarningCard)?Sv.CancelledFromWarningCard:Sv.Cancelled),[2]}))})),isDisabled:r}]},stopLoadingUi:!1};case np.CreateNewPresentationFromExisting:var a=Cx.getCachedRequestParameters();return Jh(Dh.SetScenarioNameEnabled)&&(a.sources&&a.sources.length>0?vx.setScenarioName(Cv.CreatePresentationFromDoc):vx.setScenarioName(Cv.CreatePresentation)),o&&(o.featureName=_C.CreatePresentationFromDoc,o.subFeatureName=MC.CreateFromFile),{chatCardType:jp._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:ig.Q9.Chat,warningPrefix:PowerpointCopilotStrings.WarningCreateNewPresentation}},chatMessageBodyData:{feedbackSectionPosition:ag.O.None,feedbackData:NN(Wd.CHATPPT,o),warningActionButtons:[{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelYesPlease,buttonText:PowerpointCopilotStrings.WarningButtonLabelYesPlease,handleButtonOnClick:(0,gd._)((function(){var t;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return bx(PowerpointCopilotStrings.WarningButtonLabelYesPlease,e,!1,n),null===(t=e.current)||void 0===t||t.startLoadingUi(),yx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CreatePresentationButtonClicked))),jE.getInstance().setState(Qd.EXECUTING),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return a.sources&&a.sources.length>0?(ZR("generateSlides call callContentProcessingAnnotationWorkflow with source:",a.sources.join(", ")),[4,sD(a.sources,a.prompt)]):[3,2];case 1:return t.sent(),Jh(Dh.SetScenarioNameEnabled)||vx.setScenarioName(Cv.CreatePresentationFromDoc),[3,4];case 2:return ZR("generateSlides call storyTellerWorkflow with prompt:",prompt),[4,gx(a.prompt,!1,e,a.groundingInfo)];case 3:t.sent(),Jh(Dh.SetScenarioNameEnabled)||vx.setScenarioName(Cv.CreatePresentation),t.label=4;case 4:return Cx.resetCachedRequestParameters(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return r.sent(),[2]}}))})),isDisabled:r},{buttonTitle:PowerpointCopilotStrings.WarningButtonLabelNoThanks,buttonText:PowerpointCopilotStrings.WarningButtonLabelNoThanks,handleButtonOnClick:(0,gd._)((function(){return(0,F.__generator)(this,(function(t){return bx(PowerpointCopilotStrings.WarningButtonLabelNoThanks,e,!0,n),Tx(Iv.CreatePresentation,vx.getScenarioName()==Cv.CreatePresentationFromDoc?MC.CreateFromFile:MC.CreatePresentation),mb.getInstance().emptyContextIdListandCleanup(),jE.getInstance().setState(Qd.IDLE),Cx.resetCachedRequestParameters(),M_(!1,Jh(Dh.DifferentiateCancelFromWarningCard)?Sv.CancelledFromWarningCard:Sv.Cancelled),[2]}))})),isDisabled:r}]},stopLoadingUi:!1}}return{}},bx=function(e,t,n,r){var o,a;Ex(t),r(!1),null==t||null===(o=t.current)||void 0===o||o.updateLoadingComponentProps({shouldShowLoadingUi:!0}),null==t||null===(a=t.current)||void 0===a||a.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Human,messageHeader:{text:e}}},stopLoadingUi:n}),Cx.setWarningMessageActive(!1),Cx.setWarningCardUserInteractionTimeInSec(),yx.sendLatencyTelemetry(HS((0,i._)({},sC.WarningMessageUserInteractionTime,Cx.getWarningCardUserInteractionTimeInSec())),!1),ZR("Warning Message action button clicked - ",e)},Ex=function(e){null==e||e.current.updateLastMessage({chatCardType:jp._.WarningMessage,chatMessageBodyData:{warningActionButtons:[]},stopLoadingUi:!1,addCardToChatHistory:!1})},Tx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Iv.CopilotChat,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC.Unset;yx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CancelButtonClicked)));var n,r=qw(AC.UserCancelledResponse,NC.UserAbortedQueryExecution);yx.logAshaErrorEvent(r.vetoName,r.errorString,r.featureName),yx.logTriedEvent(e,t,Hw(e)),yx.sendLatencyTelemetry(HS((n={},(0,i._)(n,sC.AnnotationType,dC.CancelButtonClicked),(0,i._)(n,sC.FeatureName,e),(0,i._)(n,sC.SubFeatureName,t),n))),MS(yx,qp.qD)},Ix=function(){return function(e,t){for(var n=e.split(".").map(Number),r=t.split(".").map(Number),o=0;o<Math.max(n.length,r.length);o++){var i=n[o]||0,a=r[o]||0;if(i>a)return 1;if(i<a)return-1}return 0}(zR.getSettingAsString(DR.PPTJsonCmdAPIVersion),VM)>=0};var _x=function(e){switch(e){case Bd.STRUCTURE_PRESENTATION_BLOCKED_ON_WARNING:return np.OrganizeStructuredPresentation;case Bd.CREATE_PRESENTATION_BLOCKED_ON_WARNING:return np.CreateNewPresentationFromExisting;default:return np.None}},wx=function(e){return AT(e.split(":")).slice(2).join(":")},Px=function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,PowerPoint.run(function(){var t=(0,gd._)((function(t){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,Q_(t,e,(function(e){}),!1,!1,!1)];case 1:return n.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),xx=function(){var e=(0,gd._)((function(e,t){var n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return ZR("Preparing modified ODSL program for semantic selection of textIndex: ".concat(t)),n=function(e,t){return[{name:"selectTextIndex",returns:"textRanges",arguments:{index:{type:"string",string:t}},argumentsArray:[{key:"index",value:{type:"string",string:t}}]}].concat(Ed(e))}(e,t),[4,Px(n)];case 1:return r.sent(),ZR("Finished executing modified ODSL program for semantic selection textIndex: ".concat(t)),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),kx=function(){var e=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return t=yd(e.split(":"),1),n=t[0],[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return void 0!==n&&e.presentation.setSelectedSlides([n]),[4,e.sync()];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return r.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),Ax=function(){var e=(0,gd._)((function(e,t){var n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return ZR("Preparing modified ODSL program for semantic selection of all textIndices"),n=function(e,t){var n=t.join(",");return[{name:"selectIndicesText",returns:"textRanges",arguments:{indices:{type:"string",string:n}},argumentsArray:[{key:"indices",value:{type:"string",string:n}}]}].concat(Ed(e))}(e,t),[4,Px(n)];case 1:return r.sent(),ZR("Finished executing modified ODSL program for semantic selection of all textIndices"),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Lx=[],Dx="",Ox=sb.getInstance(),Nx=ob.getInstance(),Rx=Zy.getInstance(),Fx=function(){var e=(0,gd._)((function(e,t,n,r,o,i,a,s){var l,c;return(0,F.__generator)(this,(function(u){switch(u.label){case 0:return l=0===o?qp.qD:o,ZR("".concat(EP.getTypeName()," response. Time Taken :\n      ").concat((0,qp.WU)(l)," sec \n")),US(Nx,EP.getTypeName(),l,sC.CopilotODSLResponseTime,_C.Commanding,s),void 0!==(null==(c=null==e?void 0:e.body)?void 0:c.queryId)&&GS(null==c?void 0:c.queryId),Ox.setResponseTime((0,qp.WU)(qp.qD)),[4,Mx(c,t,n,r,i,a)];case 1:return u.sent(),[2]}}))}));return function(t,n,r,o,i,a,s,l){return e.apply(this,arguments)}}(),Mx=function(){var e=(0,gd._)((function(e,t,n,r,o,a,s,l,c){var u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X;return(0,F.__generator)(this,(function(Z){switch(Z.label){case 0:if(Jh(Dh.LogTimeToIntentDetectionDuration)&&(null==c?void 0:c.timeToIntentDetectionMs)&&(Ox.setTimeToIntentDetection(c.timeToIntentDetectionMs),d=(new Date).getTime()-qp.qD,Ox.setTimeToIntentDetectionOverTheWireTime(d-Ox.getTimeToIntentDetection())),jE.getInstance().setState(Qd.EXECUTING),p={status:Md.SUCCESS},g=null==e?void 0:e.prompt,m=null==e?void 0:e.raw,f=null==e?void 0:e.entities,h=null==e?void 0:e.error,v=null==e||null===(u=e.odsl)||void 0===u?void 0:u.statements,y=null==e?void 0:e.intent,Dx=null==e?void 0:e.outputAnswerLanguage,C=(new Date).getTime(),lw.getInstance().setSkillName(mp.Commanding),S=[],(null==(b=null==e?void 0:e.aiResponses)?void 0:b.length)>0){E=!0,T=!1,I=void 0;try{for(_=b[Symbol.iterator]();!(E=(w=_.next()).done);E=!0)(P=w.value).type===Jd.EXPLANATIONS&&(null===(x=P.value)||void 0===x?void 0:x.explanations)?Lx=null===(L=P.value)||void 0===L?void 0:L.explanations:P.type===Jd.SUGGESTIONS&&(null===(A=P.value)||void 0===A||null===(k=A.suggestions)||void 0===k?void 0:k.length)>0&&(S=null===(O=P.value)||void 0===O||null===(D=O.suggestions)||void 0===D?void 0:D.slice(0,3))}catch(e){T=!0,I=e}finally{try{E||null==_.return||_.return()}finally{if(T)throw I}}}return g&&ZR("Prompt:\n".concat(g)),m&&ZR("ODSL:\n".concat(m)),f&&ZR("Entities:\n".concat(f)),y&&ZR("Intent:\n".concat(y)),y===Yd.Help||y===Yd.Icon||y===Yd.Undo||y===Yd.ImageOutOfScope?(function(e,t){switch(Nx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.PPTCopilotIntentDetected)),!1),e){case Yd.Help:var n,r={featureName:_C.Commanding,subFeatureName:MC.Help};Nx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,Yd.Help))),null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:PowerpointCopilotStrings.AssistantChatHelpSuggestion,renderData:{component:pp.HelpResponse,props:{}}}},chatMessageBodyData:Sd(Cd({},hL),{feedbackData:NN(void 0,r),telemetryData:RN()}),addCardToChatHistory:!0});break;case Yd.Undo:var o,a,s,l={featureName:_C.Commanding,errorMessage:PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,errorType:yp.UnsupportedAction_Undo};Nx.sendChatEventTelemetry(HS((s={},(0,i._)(s,cC.ChatEventParameters,Yd.Undo),(0,i._)(s,cC.ChatErrorType,ep.UnsupportedAction),(0,i._)(s,cC.ChatErrorKey,pC.ActionOnlySupportedInRibbonMessage),s)));var c=PowerpointCopilotStrings.UndoPhraseResponseHeader,u=[PowerpointCopilotStrings.UndoPhraseResponseInstruction1,PowerpointCopilotStrings.UndoPhraseResponseInstruction2];null===(o=t.current)||void 0===o||o.addResponseMessage(TL(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,hL,!1,Wd.CHATPPT,void 0,!1,!0,void 0,l)),null===(a=t.current)||void 0===a||a.addResponseMessage(xL(c,u,hL,!0,Wd.CHATPPT,void 0,void 0,l));break;case Yd.Icon:var d,p,g;Nx.sendChatEventTelemetry(HS((g={},(0,i._)(g,cC.ChatEventParameters,Yd.Icon),(0,i._)(g,cC.ChatErrorType,ep.UnsupportedAction),(0,i._)(g,cC.ChatErrorKey,pC.ActionOnlySupportedInRibbonMessage),g)));var m=PowerpointCopilotStrings.RibbonOnlyActionInsertIconInstructionsHeader,f=[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),mF(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonIcon),PowerpointCopilotStrings.RibbonOnlyActionInsertIconInstruction3,PowerpointCopilotStrings.RibbonOnlyActionInsertIconInstruction4],h={featureName:_C.Commanding,errorMessage:PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,errorType:yp.UnsupportedAction_Icon};null===(d=t.current)||void 0===d||d.addResponseMessage(TL(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,hL,!1,Wd.CHATPPT,void 0,!1,!0,void 0,h)),null===(p=t.current)||void 0===p||p.addResponseMessage(xL(m,f,hL,!0,Wd.CHATPPT,void 0,void 0,h));break;case Yd.ImageOutOfScope:var v,y;Nx.sendChatEventTelemetry(HS((y={},(0,i._)(y,cC.ChatEventParameters,Yd.ImageOutOfScope),(0,i._)(y,cC.ChatErrorType,ep.UnsupportedAction),(0,i._)(y,cC.ChatErrorKey,pC.ImageOutOfScopeIntentError),y)));var C={featureName:_C.Commanding,errorMessage:PowerpointCopilotStrings.ImageOutOfScopeIntentError,errorType:yp.UnsupportedAction_ImageOutOfScope};null===(v=t.current)||void 0===v||v.addResponseMessage(TL(PowerpointCopilotStrings.ImageOutOfScopeIntentError,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,C))}}(y,t),y===Yd.Help?(MS(Nx,qp.qD),M_(!0,void 0,Cv.CopilotChat)):(MS(Nx,qp.qD,"","CopilotODSLWorkflow_UnsupportedIntent_".concat(y),ep.UnsupportedAction),M_(!1,"CopilotODSLWorkflow_UnsupportedIntent_".concat(y),Cv.CopilotChat)),jE.getInstance().setState(Qd.IDLE),y==Yd.ImageOutOfScope&&F_(v,!1,xC.DismissedCommand,"Image Out of Scope"),[2]):(N=Lx.length>0&&""!==Lx[0]&&fF(Dx),R=new lT({status:fE.failed,queryId:qp.dB,error:void 0}),h?(ZR("AL Error:\n".concat(h.message," Error category : ").concat(h.category)),kP(h,t,r,!1),UA()||jE.getInstance().setState(Qd.IDLE),F_(v,!1,xC.Failed,h.message.length?"Error from AL":"No Error from AL"),zS(Nx,(0,qp.WU)(qp.qD),!1,C),M_(!1,"CopilotODSLWorkflow_".concat(h.category),Cv.CopilotChat),[2]):v?(U=JSON.stringify(v),ZR("Program:\n".concat(U)),[4,Ux(U,t,R)]):(B={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:yp.ODSLServerErrorMessage,featureName:_C.Commanding},null===(M=t.current)||void 0===M||M.addResponseMessage(TL(PowerpointCopilotStrings.ServerErrorMessage,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,B)),MS(Nx,qp.qD,"".concat(EP.getTypeName(),"_Error"),"Undefined_Program",ep.Server,void 0,!ZA(),pC.ServerErrorMessage),jE.getInstance().setState(Qd.IDLE),F_(v,!1,xC.Failed,"No Program Present"),Nx.sendLatencyTelemetry(HS((0,i._)({},sC.QueryExecutionTime,(0,qp.WU)(C)))),M_(!1,"CopilotODSLWorkflow_UndefinedProgram",Cv.CopilotChat),[2]));case 1:return Z.sent()?(jE.getInstance().setState(Qd.IDLE),UA()?[4,HA(R,t)]:[3,3]):[3,4];case 2:Z.sent(),Z.label=3;case 3:return zS(Nx,(0,qp.WU)(qp.qD),!1,C),[2];case 4:return v&&Vh(Lh.EnableSemanticSelectionWithPaginatedCards)&&((ee=v).length>0&&"selectIndicesText"===ee[0].name)?(Y=v[0],$=Y.arguments.indices.string,H=UT($),G=v.slice(1),function(e,t,n,r){var o;null===(o=e.current)||void 0===o||o.addResponseMessage({chatCardType:jp._.PaginatedCard,chatMessageData:{paginatedCardProps:{user:"chat",textIndices:t,extractTextToDisplay:wx,handleApplyOnClick:n,locateTextIndex:kx,handleApplyAllOnClick:r}},addCardToChatHistory:!1})}(t,H,xx.bind(null,G),Ax.bind(null,G)),UA()?[4,HA(R,t)]:[3,6]):[3,7];case 5:Z.sent(),Z.label=6;case 6:return[2];case 7:return Z.trys.push([7,9,,10]),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Q_(e,v,n,!1,s,l)];case 1:return p=t.sent(),Jh(Dh.HandleCommandingFailuresWithoutShowMe)&&p.status==Md.DISMISSED&&(p.status=Md.FAILED),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 8:return Z.sent(),ZR("log result : ",JSON.stringify(p)),v.some((function(e){return"selectText"===e.name&&e.dismissedArguments&&'"Presentation"'===e.dismissedArguments.scope.string}))&&ZR("Known ODSL issue detected: selectText with scope Presentation causes issues. (BUG 9341634)\n        Until resolved, avoid calling the selectText statement with scope Presentation.\n        To debug this issue or to develop a patch, refer to the validateArgument function in utils\\copilot-odsl-generator\\src\\odslProgramValidator.ts (augloop-workflows repo)."),[3,10];case 9:return z=Z.sent(),ZR("Execute failed:"+JSON.stringify(z)),p={status:Md.FAILED},[3,10];case 10:return p.status!==Md.PAUSED_ON_WARNING?[3,14]:cF(p.error)?[3,13]:(j={featureName:_C.Commanding,subFeatureName:void 0},V=Sx(t,_x(p.error),o,ZA(),j),Rx.setWarningMessageActive(!0),null==t||null===(q=t.current)||void 0===q||q.addResponseMessage(V),jE.getInstance().setState(Qd.IDLE),null==t||null===(W=t.current)||void 0===W||W.updateLoadingComponentProps({shouldShowLoadingUi:ZA()}),RK||(Rx.setWarningCardDisplayTimeInMs(),Rx.setShouldAccountForWarningCardUserInteractionLatency(!0)),Nx.sendChatEventTelemetry(HS((Q={},(0,i._)(Q,cC.ChatEventType,dC.WarningMessageCardShown),(0,i._)(Q,cC.ChatEventParameters,np[_x(p.error)]),Q))),UA()?(R.status=fE.success,[4,HA(R,t)]):[3,12]);case 11:Z.sent(),Z.label=12;case 12:return zS(Nx,(0,qp.WU)(qp.qD),!1,C),[2];case 13:return[3,17];case 14:return Jh(Dh.IsStoryTellerBlockedWithEmptyPrompt)&&p.status==Md.BLOCKED&&p.error==Bd.ADD_SLIDE_BLOCKED?(K={errorMessage:PowerpointCopilotStrings.StorytellerFailureMessage,errorType:yp.AddSlideBlocked,featureName:_C.Commanding},null===(J=t.current)||void 0===J||J.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerFailureMessage,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,K)),jE.getInstance().setState(Qd.IDLE),MS(Nx,qp.qD,"StorytellerInvocationBlocked","",ep.UnsupportedAction,void 0,!ZA(),pC.StorytellerFailureMessage),UA()?(R.status=fE.failed,[4,HA(R,t)]):[3,16]):[3,17];case 15:Z.sent(),Z.label=16;case 16:return zS(Nx,(0,qp.WU)(qp.qD),!1,C),[2];case 17:return S.length>0&&ZR("updating actionai suggestion pills in chat"),jE.getInstance().getState()===Qd.EXECUTING||pd()&&jE.getInstance().getState()===Qd.EXECUTING_APPLYJOFC_PROTOCOL?[4,VP(p,t,r,R,U,N,Lx,Ox,a,!ZA())]:(zS(Nx,(0,qp.WU)(qp.qD),p.status===Md.SUCCESS,C),[2]);case 18:return Z.sent(),UA()?[4,HA(R,t)]:[3,20];case 19:return Z.sent(),[3,21];case 20:mb.getInstance().emptyContextIdListandCleanup(),jE.getInstance().setState(Qd.IDLE),Z.label=21;case 21:return p.status===Md.SUCCESS?(Nx.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,EP.getTypeName()))),MS(Nx,qp.qD,void 0,void 0,void 0,void 0,!ZA()),Nx.sendLatencyTelemetry(HS((0,i._)({},sC.QueryExecutionTime,(0,qp.WU)(C))))):(Nx.sendLatencyTelemetry(HS((X={},(0,i._)(X,sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),(0,i._)(X,sC.IsQuerySuccess,p.status===Md.PARTIAL_SUCCESS),(0,i._)(X,sC.QueryExecutionTime,(0,qp.WU)(C)),X))),ZR("User Perceived Latency :  ".concat((0,qp.WU)(qp.qD)," sec"))),Bx(Nx,p.status),[4,Nw(t)];case 22:return Z.sent(),Ox.resetData(!Jh(Dh.IsASHATelemetryToBeLoggedAtStreamEndOnce)),jE.getInstance().setState(Qd.IDLE),[2]}var Y,$,ee}))}));return function(t,n,r,o,i,a,s,l,c){return e.apply(this,arguments)}}(),Bx=function(e,t){if(Jh(Dh.IsASHATelemetryToBeLoggedAtStreamEndOnce)){var n=AC.Unset,r=NC.Unset;t===Md.UNSUPPORTED?(n=AC.UnsupportedCopilotFunctionality,r=NC.UnsupportedInputQuery):t===Md.UNEXPECTED_VERSION?(n=AC.CommandNotExecuted,r=DC.UnexpectedVersion):t===Md.CONTENT_GENERATION_DISABLED&&(n=AC.ContentGeneration,r=FC.Disabled),Ox.setAshaErrorString(r),Ox.setAshaVetoString(n)}else t===Md.UNSUPPORTED?e.logAshaErrorEvent(AC.CommandNotExecuted,DC.IncorrectODSLVersion):t===Md.UNEXPECTED_VERSION?e.logAshaErrorEvent(AC.CommandNotExecuted,DC.UnexpectedVersion):t===Md.CONTENT_GENERATION_DISABLED&&e.logAshaErrorEvent(AC.ContentGeneration,FC.Disabled)},Ux=function(){var e=(0,gd._)((function(e,t,n){var r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:return e.includes("formatShapes")&&e.includes("insertImages")||e.includes("insertShapes")&&e.includes('"shapeType":{"type":"string","string":"Textbox"')?(ZR("Allowed case of shape detection , insert formatted image or insert textbox"),[2,!1]):(r=Vh(Lh.IsjOFCCommandingWorkflowEnabled),o=e.includes("formatShapes"),i=e.includes("insertShapes"),a=e.includes("deleteSlides"),s=a&&!r,(o||i)&&!r?(ZR("Shape intent action detected"),RK||(u={errorMessage:PowerpointCopilotStrings.StorytellerFailureMessage,errorType:yp.AddSlideBlocked,featureName:_C.Commanding},null===(l=t.current)||void 0===l||l.addResponseMessage(TL(PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage,hL,!1,Wd.CHATPPT,void 0,!1,!0,void 0,u)),null===(c=t.current)||void 0===c||c.addResponseMessage(xL(ZF(),YF(),hL,!0,Wd.CHATPPT,void 0,void 0,u))),cF(n)||(n.error=PowerpointCopilotStrings.ActionOnlySupportedInRibbonMessage),MS(Nx,qp.qD,dC.UnsupportedActionDetected,"ShapeOperation",ep.UnsupportedAction,void 0,void 0,pC.ActionOnlySupportedInRibbonMessage),[4,Nw(t)]):[3,2]);case 1:case 3:return g.sent(),[2,!0];case 2:return s?(ZR("Delete intent action detected"),d={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:yp.RequireDeleteIntentResponse,featureName:_C.Commanding},RK||null===(p=t.current)||void 0===p||p.addResponseMessage(TL(PowerpointCopilotStrings.ServerErrorMessage,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,d)),cF(n)||(n.error=PowerpointCopilotStrings.ServerErrorMessage),MS(Nx,qp.qD,dC.UnsupportedActionDetected,"DeleteOperation",ep.UnsupportedAction,void 0,void 0,pC.ServerErrorMessage),[4,Nw(t)]):[3,4];case 4:return[2,!1]}}))}));return function(t,n,r){return e.apply(this,arguments)}}();class Hx{constructor(e){Qp.h.assign(Hx,this,e)}static getTypeName(){return"AugLoop_ComprehensionSummary_ComprehensionSummarySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Hx.getTypeName()])}}Hx.H_={T_:Hx.getTypeName(),B_:Hx.getBaseTypes()};var Gx=function(){return new Map([[Hd.CreatePresentation,[PowerpointCopilotStrings.LoadingUIGettingEverythingReadyStep,PowerpointCopilotStrings.LoadingUIAddingTextStep2,PowerpointCopilotStrings.LoadingUITextIntentStep2,PowerpointCopilotStrings.LoadingUISlideIntentStep4,PowerpointCopilotStrings.LoadingUISlideIntentStep3,PowerpointCopilotStrings.LoadingUiFinishingUpStep]],[Hd.AddSlides,[PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.AddImage,[PowerpointCopilotStrings.LoadingUISearchingImages,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIMakingChanges,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.AddText,[PowerpointCopilotStrings.LoadingUICreatingADraft,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.RewriteText,[PowerpointCopilotStrings.LoadingUIRewritingTextStep1,PowerpointCopilotStrings.LoadingUIRewritingTextStep2,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.ChangeStyle,[PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIMakingChanges,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.PresentationSummary,[PowerpointCopilotStrings.LoadingUIWorkingOnIt,PowerpointCopilotStrings.LoadingUIScanningTheDeck,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUIGeneratingTheSummary,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.PresentationSummaryWithVisual,[nB,rB,oB,iB,aB]],[Hd.ImportantSlides,[PowerpointCopilotStrings.LoadingUIWorkingOnIt,PowerpointCopilotStrings.LoadingUIScanningTheDeck,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.CallToAction,[PowerpointCopilotStrings.LoadingUIWorkingOnIt,PowerpointCopilotStrings.LoadingUIScanningTheDeck,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUISlideIntentStep4]],[Hd.TransformDocument,[PowerpointCopilotStrings.LoadingUITransformingDocumentStep1,PowerpointCopilotStrings.LoadingUITransformingDocumentStep2,PowerpointCopilotStrings.LoadingUITransformingDocumentStep3,PowerpointCopilotStrings.LoadingUITransformingDocumentStep4]],[Hd.OrganizePresentation,[PowerpointCopilotStrings.LoadingUIOrganizePresentationStep1,PowerpointCopilotStrings.LoadingUIOrganizePresentationStep2,PowerpointCopilotStrings.LoadingUIOrganizePresentationStep3,PowerpointCopilotStrings.LoadingUIOrganizePresentationStep4]],[Hd.UserCancellation,[PowerpointCopilotStrings.CancellingLabel]],[Hd.Default,[PowerpointCopilotStrings.LoadingUIWorkingOnResponseForYou,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIAlmostThere,PowerpointCopilotStrings.LoadingUIPullingThingsTogether,PowerpointCopilotStrings.LoadingUISlideIntentStep4]]])},zx=ob.getInstance();function qx(e,t,n){var r,o,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=e.category,l=rM;try{l=JSON.parse(e.json).code}catch(e){var c;return ZR("Error parsing error code from summary error",e.message),wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a),zx.sendErrorTelemetry(HS((c={},(0,i._)(c,uC.ErrorMessage,"Error parsing error code from summary error, ".concat(e.message)),(0,i._)(c,uC.ErrorCategory,IC.Summary),c))),{errorCode:l,errorKey:pC.ErrorRequestTimedOut}}ZR("Summary Error Detected, Category: ".concat(s,", ErrorCode: ").concat(l,", ErrorMessage: ").concat(e.message)),zx.sendErrorTelemetry(HS((o={},(0,i._)(o,uC.ErrorMessage,"Summary Workflow Error Detected, Category: ".concat(s,", ErrorCode: ").concat(l)),(0,i._)(o,uC.ErrorCategory,IC.Summary),o)));var u=FS(RC.Summarize,AC.UnclassifiedAshaError),d=LC.Fallback,p=u,g={errorType:"".concat(s,"-").concat(l),featureName:_C.Summary};switch(s){case cp.InvalidInput:switch(d=LC.InvalidInput,p=AC.SummarizeUnableToComplete,l){case up.TooShort:d=LC.TooShort,p=AC.SummarizeUnableToComplete,g.errorMessage=PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",Dw().toString()),wL(n,PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",Dw().toString()),void 0,void 0,a,g),r=pC.LessContentToSummarizeError;break;case up.MissingPPTContent:d=LC.MissingPPTContent,p=AC.SummarizeUnableToComplete,g.errorMessage=PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",Dw().toString()),wL(n,PowerpointCopilotStrings.LessContentToSummarizeError.replace("%s",Dw().toString()),void 0,void 0,a,g),r=pC.LessContentToSummarizeError;break;default:g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut}break;case cp.OffensiveContent:switch(d=LC.OffensiveContent,p=AC.SummarizeBlockedResponse,g.errorMessage=PowerpointCopilotStrings.OffensiveContentToSummarizeError,l){case up.OutputBlockedByDynamicGuardList:d=LC.OutputBlockedByFilters,p=AC.SummarizeRAIError;break;case up.OffensiveOutputContent:d=LC.OffensiveOutputBlockedByContentModerator,p=AC.SummarizeRAIError}wL(n,PowerpointCopilotStrings.OffensiveContentToSummarizeError,void 0,void 0,a,g),r=pC.OffensiveContentToSummarizeError;break;case cp.InferenceAPIError:switch(l){case up.BadResponse:d=LC.BadResponse,p=AC.SummarizeLLMServiceSideIssue,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.BadRequest:d=LC.BadRequest,p=u,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.Token:d=LC.Token,p=AC.SummarizeUserAccessIssue,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.Unknown:d=LC.Unknown,p=u,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.EmptyResponse:if(t!==hE.Unknown){var m=PowerpointCopilotStrings.ErrorRequestTimedOut;t===hE.Summary||t===hE.SegmentedSummary||t===hE.StyledSummary?(d=LC.NoSummaryPoints,m=PowerpointCopilotStrings.EmptySummaryResponseMessage,r=pC.EmptySummaryResponseMessage):t===hE.CallsForAction?(d=LC.NoActionItems,m=PowerpointCopilotStrings.NoActionItemsFoundMessage,r=pC.NoActionItemsFoundMessage):(d=LC.NoImportantSlides,m=PowerpointCopilotStrings.EmptyKeySlidesResponseMessage,r=pC.EmptyKeySlidesResponseMessage),g.errorMessage=m,p=AC.SummarizeUnableToComplete,wL(n,m,void 0,void 0,a,g)}else g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.Timeout:d=LC.Timeout,p=AC.SummarizeTimedOut,g.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,wL(n,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,!0,g),r=pC.ErrorServerBusy;break;case up.NotAvailable:g.errorMessage=PowerpointCopilotStrings.ErrorServerBusy,d=LC.APIUnavailable,p=AC.SummarizeLLMServiceSideIssue,wL(n,PowerpointCopilotStrings.ErrorServerBusy,void 0,void 0,a,g),r=pC.ErrorServerBusy;break;case up.InputRAIDependency:g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,d=LC.RAIOnInputError,p=AC.SummarizeBlockedResponse,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.OutputRAIDependency:g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,d=LC.RAIOnOutputError,p=AC.SummarizeBlockedResponse,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.Throttled:d=LC.Throttled,p=AC.SummarizeCapacityIssue,g.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(n,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,!0,g),r=pC.ThrottlingErrorMessage;break;case up.UserThrottled:d=LC.UserThrottled,p=AC.SummarizeCapacityIssue,g.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(n,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,a,g),r=pC.ThrottlingErrorMessage;break;case up.ScenarioThrottled:d=LC.ScenarioThrottled,p=AC.SummarizeCapacityIssue,g.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(n,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,a,g),r=pC.ThrottlingErrorMessage;break;default:g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut}break;case cp.InvalidLanguage:switch(l){case up.NotSupported:d=LC.InvalidInputLanguage,p=AC.SummarizeUnsupportedFunctionality,g.errorMessage=PowerpointCopilotStrings.ErrorDetectedOtherLanguage,wL(n,PowerpointCopilotStrings.ErrorDetectedOtherLanguage,void 0,void 0,a,g),r=pC.ErrorDetectedOtherLanguage;break;case up.FailedToGetInputLanguage:d=LC.FailedToGetInputLanguage,p=AC.SummarizeUnsupportedFunctionality,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;default:wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut}break;case cp.VisualDescriptionGeneration:switch(l){case up.Unknown:d=LC.VisualDescriptionGenerationUnknownError,p=AC.SummarizeLLMServiceSideIssue,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case up.FailedToGenerateVisualDescription:d=LC.VisualDescriptionGenerationError,p=AC.SummarizeLLMServiceSideIssue,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;default:g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut}break;case cp.InputQueryError:if(l===up.Bad_Token)d=tv()?LC.InvalidTokens:LC.Token,p=AC.SummarizeUserAccessIssue,g.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,wL(n,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,a,g),r=pC.LicenseValidationErrorMessage;else g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case cp.LicensingError:d=tv()?LC.Licensing:LC.LicensingOld,p=AC.SummarizeUserAccessIssue,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,a,g),r=pC.LicenseValidationErrorMessage;break;case cp.PromptInjection:d=LC.PromptInjection,p=AC.SummarizeBlockedResponse,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case cp.InvalidSignal:switch(d=LC.InvalidSignal,p=u,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,l){case up.Missing:d=LC.MissingSignal,p=AC.SummarizeLLMServiceSideIssue;break;case up.WrongType:p=AC.SummarizeLLMServiceSideIssue}wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;case cp.InvalidIntent:switch(d=LC.InvalidIntent,p=u,g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,l){case up.Missing:d=LC.MissingSubIntent,p=AC.SummarizeLLMServiceSideIssue;break;case up.Invalid:d=LC.InvalidSubIntent,p=AC.SummarizeLLMServiceSideIssue}wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut;break;default:g.errorMessage=PowerpointCopilotStrings.ErrorRequestTimedOut,wL(n,PowerpointCopilotStrings.ErrorRequestTimedOut,void 0,void 0,a,g),r=pC.ErrorRequestTimedOut}return zx.logAshaErrorEvent(p,d,Iv.Summarize),{errorCode:l,errorKey:r}}var Wx=ob.getInstance(),jx=!1,Vx=!1,Qx=function(){var e=(0,gd._)((function(e,t,n,r,o){var a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E;return(0,F.__generator)(this,(function(T){switch(T.label){case 0:return a=null==e?void 0:e.body,s=null==a?void 0:a.intent,l=null==a?void 0:a.summary,c=null==a?void 0:a.error,u=null==a?void 0:a.queryId,jx=null!==(d=null==a?void 0:a.isVisual)&&void 0!==d&&d,Vx=null!==(p=null==a?void 0:a.analyzingVisuals)&&void 0!==p&&p,m=null!==(g=null==a?void 0:a.chatMessageHeader)&&void 0!==g?g:void 0,ZR("".concat(EE.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(qp.qD)," sec \n, intent: ").concat(s," \n, Summary : ").concat(l)),void 0!==u&&GS(u),ZA()||(!Vh(Lh.IsVisualSummaryUIEnabled)||SR(s)&&Xx()||!SR(s))&&mb.getInstance().removeContextId(null===(f=e.body)||void 0===f?void 0:f.queryId),lw.getInstance().setSkillName(mp.Summary),US(Wx,EE.getTypeName(),0===r?qp.qD:r,sC.SummaryResponseTime,_C.Summary,o),Wx.logTriedEvent(Iv.Summarize,Yx(s),yE.RX.Summarize),Wx.sendChatEventTelemetry(HS((C={},(0,i._)(C,cC.ChatEventType,dC.ResponseReceivedFromAL),(0,i._)(C,cC.ChatEventParameters,EE.getTypeName()),(0,i._)(C,cC.IsFromCache,null!==(h=null==a?void 0:a.fromCache)&&void 0!==h&&h),(0,i._)(C,cC.IsVisual,null!==(v=null==a?void 0:a.isVisual)&&void 0!==v&&v),(0,i._)(C,cC.IsAnalyzingVisual,null!==(y=null==a?void 0:a.analyzingVisuals)&&void 0!==y&&y),C))),Wx.sendChatEventTelemetry(HS((S={},(0,i._)(S,cC.ChatEventType,dC.SummaryIntentDetectedFromAL),(0,i._)(S,cC.ChatEventParameters,s),S))),b=!ZA(),void 0!==(null==c?void 0:c.category)?(E=qx(c,s,t,!ZA()).errorCode,MS(Wx,qp.qD,"".concat(EE.getTypeName(),"_Error"),c.category.concat(uF(E)?rM:"_".concat(E)),ep.Server,void 0,b),M_(!1,"SummaryWorkflow_".concat(c.category),Cv.Summary),[2]):[4,Jx(l,s,n,t,m)];case 1:return T.sent()?M_(!0,void 0,Cv.Summary):(MS(Wx,qp.qD,"".concat(EE.getTypeName(),"_Error"),"IncorrectResponse",ep.Server,void 0,b),M_(!1,"SummaryWorkflow_IncorrectResponse",Cv.Summary)),[2]}}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),Jx=function(){var e=(0,gd._)((function(e,t,n,r,o){var a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee,te,ne;return(0,F.__generator)(this,(function(F){a=[],s={featureName:_C.Summary,subFeatureName:SR(t)&&Xx()?MC.VisualSummary:MC.Summarize};try{a=JSON.parse(e)}catch(e){return ZR("Error in parsing summary response",e.message),c=Sd(Cd({},s),{errorMessage:PowerpointCopilotStrings.ErrorRequestTimedOut,errorType:yp.ParseSummaryError}),null===(l=r.current)||void 0===l||l.addResponseMessage(TL(PowerpointCopilotStrings.ErrorRequestTimedOut,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,c)),Wx.sendErrorTelemetry(HS((u={},(0,i._)(u,uC.ErrorMessage,"Error parsing summary response, ".concat(e.message)),(0,i._)(u,uC.ErrorCategory,IC.Summary),u))),[2,!1]}if(d=!ZA(),p=[],t===hE.Summary||t===hE.SegmentedSummary||t===hE.StyledSummary){m=[],f=!0,h=!1,v=void 0;try{for(y=a[Symbol.iterator]();!(f=(C=y.next()).done);f=!0)S=C.value,(b={title:"",text:""}).title=S.topic+": ",b.text=mk(S)?hk(S.keyPoint,p,S.citations):S.keyPoint,m.push(b)}catch(e){h=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(h)throw v}}t!==hE.SegmentedSummary&&t!==hE.StyledSummary||(s.subFeatureName=t===hE.SegmentedSummary?MC.SegmentedSummary:MC.StyledSummary,null===(E=r.current)||void 0===E||E.addResponseMessage(TL(PowerpointCopilotStrings.UnsupportedSummaryError,mL,!1,Wd.DECKSUMMARY,Iv.Summarize,!1,!0,void 0,s))),n>Ow()&&(I=Sd(Cd({},s),{errorMessage:PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",Ow().toString()),errorType:yp.TooLargeContentToSummarizeError}),null===(T=r.current)||void 0===T||T.addResponseMessage(TL(PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",Ow().toString()),mL,!1,Wd.DECKSUMMARY,Iv.Summarize,!1,!0,void 0,I)),Wx.sendErrorTelemetry(HS((_={},(0,i._)(_,uC.ErrorMessage,"Word Count does not meet max bar requirement"),(0,i._)(_,uC.ErrorCategory,IC.Summary),_))),Wx.sendChatEventTelemetry(HS((w={},(0,i._)(w,cC.ChatEventType,dC.MoreWordCount),(0,i._)(w,cC.ChatEventParameters,"WordCountError"),w)))),P=SR(t)&&Xx()?MC.VisualSummary:MC.Summarize,s.subFeatureName=P,x=AL(m,Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&Xx()?tB:PowerpointCopilotStrings.AssistantResponseSummarizePrefix,Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&Xx()?PowerpointCopilotStrings.AssistantResponseSummarizeSuffix:Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&Zx()?eB:PowerpointCopilotStrings.AssistantResponseSummarizeSuffix,PowerpointCopilotStrings.SummaryMainIdeas,Sd(Cd({},mL),{chatMessageHeaderData:OL(o)}),!(SR(t)&&Zx()),Wd.DECKSUMMARY,Iv.Summarize,P,s),p.length>0&&(x.chatMessageBodyData=Sd(Cd({},x.chatMessageBodyData),{references:p})),x.startAugloopTimerForStreaming=Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&Zx(),null===(g=r.current)||void 0===g||g.addResponseMessage(x),Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&Zx()&&(null===(k=r.current)||void 0===k||k.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(A=Gx().get(Hd.PresentationSummaryWithVisual))&&void 0!==A?A:[]},FN())))}else if(t===hE.CallsForAction){D={listItems:[],listHeader:""},O=[],N=[],R=!0,M=!1,B=void 0;try{for(U=a[Symbol.iterator]();!(R=(H=U.next()).done);R=!0)G=H.value,z=G.action,mk(G)&&(z=hk(z,p,G.citations)),"inferred"===(q=G.source)?N.push({text:z}):"explicit"===q&&O.push({text:z})}catch(e){M=!0,B=e}finally{try{R||null==U.return||U.return()}finally{if(M)throw B}}if(O.length>0)D.listHeader=PowerpointCopilotStrings.SummaryActionItems,D.listItems=O;else{if(!(N.length>0))return j=Sd(Cd({},s),{errorMessage:PowerpointCopilotStrings.SummaryNoActionItemsIdentified,errorType:yp.SummaryNoActionItemsIdentified}),null===(W=r.current)||void 0===W||W.addResponseMessage(TL(PowerpointCopilotStrings.SummaryNoActionItemsIdentified,mL,!ZA(),Wd.DECKSUMMARY,Iv.Summarize,!1,!0,void 0,j)),Wx.sendChatEventTelemetry(HS((V={},(0,i._)(V,cC.ChatEventType,dC.CallsToActionResponseShown),(0,i._)(V,cC.ChatEventParameters,"NO_ACTION_ITEMS"),V))),MS(Wx,qp.qD,void 0,void 0,void 0,void 0,d),[2,!0];D.listHeader=PowerpointCopilotStrings.SummaryActionItemsInferred,D.listItems=N}null===(L=r.current)||void 0===L||L.addResponseMessage(AL(D.listItems,void 0,void 0,D.listHeader,Sd(Cd({},mL),{chatMessageHeaderData:OL(o),references:p}),!0,Wd.DECKSUMMARY,Iv.Summarize,void 0,s))}else if(t===hE.ImportantSlides){J=[],K=!0,X=!1,Z=void 0;try{for(Y=a[Symbol.iterator]();!(K=($=Y.next()).done);K=!0)ee=$.value,(te={text:"",title:""}).title=ee.slideTitle+": ",te.text="Slide ".concat(ee.slideNumber),J.push(te)}catch(e){X=!0,Z=e}finally{try{K||null==Y.return||Y.return()}finally{if(X)throw Z}}null===(Q=r.current)||void 0===Q||Q.addResponseMessage(AL(J,PowerpointCopilotStrings.SummaryImportantSlides,void 0,void 0,Sd(Cd({},mL),{chatMessageHeaderData:OL(o)}),!ZA(),Wd.DECKSUMMARY,Iv.Summarize,void 0,s))}return YA(EE.getTypeName(),(0,qp.WU)(qp.qD),!1),Wx.sendChatEventTelemetry(HS((ne={},(0,i._)(ne,cC.ChatEventType,dC.QuerySuccessful),(0,i._)(ne,cC.ChatEventParameters,IC.Summary),ne))),MS(Wx,qp.qD,void 0,void 0,void 0,void 0,d),[2,!0]}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}(),Kx=function(){var e=(0,gd._)((function(){var e,t,n,r,o,a,s;return(0,F.__generator)(this,(function(l){return t=Sb.getInstance(),n=t.getChatRef(),r=(0,dg.A)(),o={intent:hE.Summary,queryLanguage:nF(TS(_p.GetHostAppDisplayLanguage())),queryId:r,isStreaming:!1,source:dp.AppChat_PreFetchQuery},a=new Vp.Xr({parentPath:["Signal",Hx.getTypeName()],items:[{id:aT.generateId(),body:new Hx(o)}]}),Wx.sendChatEventTelemetry(HS((s={},(0,i._)(s,cC.ChatEventType,dC.SummarizationOperationSubmitted),(0,i._)(s,cC.UserQueryGuid,r),(0,i._)(s,cC.RequestSignalSource,dp.AppChat_PreFetchQuery),s))),null===(e=n.current)||void 0===e||e.submitOperation({operation:a,workflowAnnotationType:EE.getTypeName()}),[2]}))}));return function(){return e.apply(this,arguments)}}(),Xx=function(){return jx},Zx=function(){return!!Vh(Lh.IsVisualSummaryUIEnabled)&&Vx},Yx=function(e){switch(e){case hE.Summary:case hE.SegmentedSummary:case hE.StyledSummary:return MC.Summarize;case hE.CallsForAction:return MC.ShowActionItems;case hE.ImportantSlides:return MC.KeySlides}return MC.Unset},$x=!0,ek=[],tk=new Map,nk=sb.getInstance(),rk=ob.getInstance(),ok=[],ik=Tb.getInstance(),ak=!1,sk=!1,lk=!1,ck=!1,uk=!1,dk=function(){var e=(0,gd._)((function(e,t,n,r){var o,a,s,l,c,u,d,p,g,m,f,h,v,y,C;return(0,F.__generator)(this,(function(S){switch(S.label){case 0:return o=null==e?void 0:e.body,a=null==o?void 0:o.intent,s=null==o?void 0:o.summary,l=null==o?void 0:o.error,ck=null==o?void 0:o.isVisual,uk=null==o?void 0:o.analyzingVisuals,c=null==o?void 0:o.chatMessageHeader,ZR("".concat(TE.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(qp.qD)," sec \n, intent: ").concat(a," \n, Summary : ").concat(s)),void 0!==o.queryId&&(nk.setUserQueryGuid(o.queryId),GS(o.queryId)),sk=!0,$x&&(rk.logTriedEvent(Iv.Summarize,Yx(a),yE.RX.Summarize),lw.getInstance().setSkillName(mp.Summary),Jh(Dh.IsScenarioErrorTelemetryEnabled)&&nk.setScenarioName(Cv.Summary),rk.sendLatencyTelemetry(HS((u={},(0,i._)(u,sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),(0,i._)(u,sC.AnnotationType,TE.getTypeName()),(0,i._)(u,sC.FeatureName,_C.Summary),u)))),rk.sendChatEventTelemetry(HS((d={},(0,i._)(d,cC.ChatEventType,dC.ResponseReceivedFromAL),(0,i._)(d,cC.ChatEventParameters,TE.getTypeName()),(0,i._)(d,cC.Cv,null!=r?r:""),d))),rk.sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.ChatEventType,dC.SummaryIntentDetectedFromAL),(0,i._)(p,cC.ChatEventParameters,a),p))),ok.push({augloopResponseTime:(0,qp.WU)(qp.qD)}),g=!ZA(),void 0!==(null==l?void 0:l.category)?($x||pk(t,Sk(hL,!0),!0,c),m=qx(l,a,t,g),f=m.errorCode,h=m.errorKey,BS(rk,qp.qD,sC.SummaryResponseTime,sC.SummaryChunkInfo,ok,IC.Summary,"".concat(TE.getTypeName(),"_Error"),l.category.concat(uF(f)?rM:"_".concat(f)),ep.Server,g,void 0,void 0,h),gk(),nk.setResponseTime((0,qp.WU)(qp.qD)),M_(!1,"SummaryStreamingWorkflow_".concat(l.category),Cv.Summary),[2]):[4,fk(s,a,n,t)];case 1:return v=S.sent(),y=v.result,C=v.errorKey,y?[2]:(BS(rk,qp.qD,sC.SummaryResponseTime,sC.SummaryChunkInfo,ok,IC.Summary,"".concat(TE.getTypeName(),"_Error"),"IncorrectResponse",ep.Server,g,void 0,void 0,C),nk.setResponseTime((0,qp.WU)(qp.qD)),gk(),M_(!1,"SummaryStreamingWorkflow_IncorrectResponse",Cv.Summary),[2])}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),pk=function(e,t,n,r,o){if(t.chatMessageBodyData=Sd(Cd({},t.chatMessageBodyData),{chatMessageHeaderData:OL(o),feedbackSectionPosition:ag.O.Footer,feedbackData:NN(Wd.DECKSUMMARY,r),clpSensitivityIndicatorData:ik.shouldShowInDocSensitivityLabel()?ML():void 0,telemetryData:JSON.stringify({correlationId:rk.getQueryGuid(),featureName:Iv.Summarize,subFeatureName:ck?MC.VisualSummary:MC.Summarize})}),n){var i;t.chatMessageBodyData=Sd(Cd({},t.chatMessageBodyData),{actionButtonList:(null!==(i=t.chatMessageBodyData.actionButtonList)&&void 0!==i?i:[]).concat(CL())}),t.addCardToChatHistory=!0,t.stopLoadingUi=!ZA(),ak=!0,t.startAugloopTimerForStreaming=!1}else{var a;if(lk)t.chatMessageBodyData=Sd(Cd({},t.chatMessageBodyData),{actionButtonList:(null!==(a=t.chatMessageBodyData.actionButtonList)&&void 0!==a?a:[]).concat(CL())}),t.addCardToChatHistory=!0;else t.addCardToChatHistory=!1;t.startAugloopTimerForStreaming=!0,t.workflowAnnotationTypeForAugloopTimer=TE.getTypeName()}var s,l;(r&&(t.chatMessageBodyData=Sd(Cd({},t.chatMessageBodyData),{feedbackData:NN(void 0,r)})),$x)?(null===(s=e.current)||void 0===s||s.addResponseMessage(t),$x=!1):null===(l=e.current)||void 0===l||l.updateLastMessage(t)},gk=function(){ek=[],ok=[],$x=!0,ak=!1,sk=!1,lk=!1,(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(ck=!1,uk=!1)},mk=function(e){var t;return Jh(Dh.IsCitationsEnabled)&&e.citations&&(null===(t=e.citations)||void 0===t?void 0:t.length)>0},fk=function(){var e=(0,gd._)((function(e,t,n,r){var o,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee,te,ne=arguments;return(0,F.__generator)(this,(function(F){o=ne.length>4&&void 0!==ne[4]&&ne[4],a=ne.length>5?ne[5]:void 0,ZR("parseSummary called ".concat(e," intent: ").concat(t," deckTokenCount ").concat(n," isStreamEnd ").concat(o)),s=[],l={featureName:_C.Summary,subFeatureName:SR(t)&&bk()?MC.VisualSummary:MC.Summarize};try{s=JSON.parse(e)}catch(e){return ZR("Error in parsing summary response",e.message),gk(),u=Sd(Cd({},l),{errorMessage:PowerpointCopilotStrings.ErrorRequestTimedOut,errorType:yp.SummaryErrorRequestTimedOut}),null===(c=r.current)||void 0===c||c.addResponseMessage(TL(PowerpointCopilotStrings.ErrorRequestTimedOut,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,u)),rk.sendErrorTelemetry(HS((d={},(0,i._)(d,uC.ErrorMessage,"Error parsing summary response, ".concat(e.message)),(0,i._)(d,uC.ErrorCategory,IC.Summary),d))),[2,{result:!1,errorKey:pC.ErrorRequestTimedOut}]}if(p=[],t===hE.Summary||t===hE.SegmentedSummary||t===hE.StyledSummary){g=!0,m=!1,f=void 0;try{for(h=s[Symbol.iterator]();!(g=(v=h.next()).done);g=!0)y=v.value,(C={title:"",text:""}).title=y.topic+": ",C.text=mk(y)?hk(y.keyPoint,p,y.citations):y.keyPoint,ek.push(C)}catch(e){m=!0,f=e}finally{try{g||null==h.return||h.return()}finally{if(m)throw f}}S=AL(ek,Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&bk()?tB:PowerpointCopilotStrings.AssistantResponseSummarizePrefix,Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&bk()?PowerpointCopilotStrings.AssistantResponseSummarizeSuffix:Vh(Lh.IsVisualSummaryUIEnabled)&&SR(t)&&Ek()?eB:PowerpointCopilotStrings.AssistantResponseSummarizeSuffix,PowerpointCopilotStrings.SummaryMainIdeas,Sd(Cd({},mL),{chatMessageHeaderData:OL(a)}),!1,Wd.DECKSUMMARY,Iv.Summarize,SR(t)&&bk()?MC.VisualSummary:MC.Summarize,l),t!==hE.SegmentedSummary&&t!==hE.StyledSummary||!$x||(l.subFeatureName=t===hE.SegmentedSummary?MC.SegmentedSummary:MC.StyledSummary,E=Sd(Cd({},l),{errorMessage:PowerpointCopilotStrings.UnsupportedSummaryError,errorType:yp.SummaryUnsupportedSummaryError}),null===(b=r.current)||void 0===b||b.addResponseMessage(TL(PowerpointCopilotStrings.UnsupportedSummaryError,mL,!1,Wd.DECKSUMMARY,void 0,!1,!0,void 0,E))),n>Ow()&&$x&&(I=Sd(Cd({},l),{errorMessage:PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",Ow().toString()),errorType:yp.TooLargeContentToSummarizeError}),null===(T=r.current)||void 0===T||T.addResponseMessage(TL(PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",Ow().toString()),mL,!1,Wd.DECKSUMMARY,void 0,!1,!0,void 0,I)),rk.sendErrorTelemetry(HS((_={},(0,i._)(_,uC.ErrorMessage,"Word Count does not meet max bar requirement"),(0,i._)(_,uC.ErrorCategory,IC.Summary),_))),rk.sendChatEventTelemetry(HS((w={},(0,i._)(w,cC.ChatEventType,dC.MoreWordCount),(0,i._)(w,cC.ChatEventParameters,"WordCountError"),(0,i._)(w,cC.ChatErrorKey,pC.DeckTooLargeToSummarizeError),w)))),p.length>0&&(S.chatMessageBodyData=Sd(Cd({},S.chatMessageBodyData),{references:p})),pk(r,S,o,l,a)}else if(t===hE.CallsForAction){P={listItems:[],listHeader:""},x=[],k=[],A=!0,L=!1,D=void 0;try{for(O=s[Symbol.iterator]();!(A=(N=O.next()).done);A=!0)R=N.value,M=R.action,mk(R)&&(M=hk(M,p,R.citations)),"inferred"===(B=R.source)?k.push({text:M}):"explicit"===B&&x.push({text:M}),ek.push({text:M})}catch(e){L=!0,D=e}finally{try{A||null==O.return||O.return()}finally{if(L)throw D}}if(x.length>0)P.listHeader=PowerpointCopilotStrings.SummaryActionItems;else{if(!(k.length>0))return H=Sd(Cd({},l),{errorMessage:PowerpointCopilotStrings.SummaryNoActionItemsIdentified,errorType:yp.SummaryNoActionItemsIdentified}),null===(U=r.current)||void 0===U||U.addResponseMessage(TL(PowerpointCopilotStrings.SummaryNoActionItemsIdentified,mL,!1,Wd.DECKSUMMARY,void 0,!1,!0,void 0,H)),rk.sendChatEventTelemetry(HS((G={},(0,i._)(G,cC.ChatEventType,dC.CallsToActionResponseShown),(0,i._)(G,cC.ChatEventParameters,"NO_ACTION_ITEMS"),(0,i._)(G,cC.ChatErrorKey,pC.SummaryNoActionItemsIdentified),G))),[2,{result:!0,errorKey:void 0}];P.listHeader=PowerpointCopilotStrings.SummaryActionItemsInferred}pk(r,AL(ek,void 0,void 0,P.listHeader,Sd(Cd({},mL),{references:p}),!1,Wd.DECKSUMMARY,void 0,void 0,l),o,void 0,a)}else if(t===hE.ImportantSlides){z=!0,q=!1,W=void 0;try{for(j=s[Symbol.iterator]();!(z=(V=j.next()).done);z=!0)Q=V.value,(J={text:"",title:""}).title=Q.slideTitle+": ",J.text="".concat(PowerpointCopilotStrings.AssistantResponseSlide," ").concat(Q.slideNumber),ek.push(J)}catch(e){q=!0,W=e}finally{try{z||null==j.return||j.return()}finally{if(q)throw W}}K=AL(ek,PowerpointCopilotStrings.SummaryImportantSlides,void 0,void 0,Cd({},mL),!1,Wd.DECKSUMMARY,void 0,void 0,l);try{o&&Vh(Lh.IsCopilotPlayKeySlidesEnabled)&&(void 0===K.chatMessageBodyData&&(K.chatMessageBodyData={}),void 0===K.chatMessageBodyData.actionButtonList&&(K.chatMessageBodyData=Sd(Cd({},K.chatMessageBodyData),{actionButtonList:[]})),(X=SL(e))&&(null===(Z=K.chatMessageBodyData.actionButtonList)||void 0===Z||Z.push(X),rk.sendChatEventTelemetry(HS((Y={},(0,i._)(Y,cC.ChatEventType,dC.PlayKeySlidesButtonAdded),(0,i._)(Y,cC.ChatEventParameters,JSON.stringify({handler:"SummaryStreamingAnnotationHandler"})),Y)))))}catch(e){ZR("Failed to add PlayKeySlides button: "+(null==e?void 0:e.message)),rk.sendErrorTelemetry(HS(($={},(0,i._)($,uC.ErrorMessage,"Exception while adding PlayKeySlides button from Summary Streaming: "+(null==e?void 0:e.message)),(0,i._)($,uC.ErrorCategory,IC.PlayKeySlides),$)))}pk(r,K,o,void 0,a)}return p.length>0&&rk.sendChatEventTelemetry(HS((ee={},(0,i._)(ee,cC.ChatEventType,dC.CitationReceived),(0,i._)(ee,cC.ChatEventParameters,p.length),ee))),o&&(te=!ZA(),BS(rk,qp.qD,Vh(Lh.IsVisualSummarizationEnabled)&&ck?sC.VisualSummaryResponseTime:sC.SummaryResponseTime,sC.SummaryChunkInfo,ok,IC.Summary,void 0,void 0,void 0,te)),[2,{result:!0,errorKey:void 0}]}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),hk=function(e,t,n){var r=e.toString();if(n.length>0)try{n.sort((function(e,t){return e.position-t.position}));var o=0,a=!0,s=!1,l=void 0;try{for(var c,u=n[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value,p="%c"+d.contentIndex.toString()+"%c";r=r.slice(0,d.position+o)+p+r.slice(d.position+o),o+=p.length,t.push(vk(d))}}catch(e){s=!0,l=e}finally{try{a||null==u.return||u.return()}finally{if(s)throw l}}}catch(n){var g;return ZR("Error in parsing citations in summary response",n.message),t=[],rk.sendErrorTelemetry(HS((g={},(0,i._)(g,uC.ErrorMessage,"Error parsing citations in summary response, ".concat(n.message)),(0,i._)(g,uC.ErrorCategory,IC.Summary),g))),e}return r},vk=function(e){return tk.set(e.contentIndex,e.path),{referenceIndex:e.contentIndex,referenceProps:{title:'"'+(e.content.length>18?e.content.slice(0,18).trim():e.content)+oM+'"',primarySubtitle:lM(),snippet:QN(e.content),referenceType:uf._2.Internal,path:e.path,iconAppName:e.type,onClickCitationLink:yk,sensitivityLabel:ik.shouldShowInDocSensitivityLabel()?ik.getInDocSensitiveLabelInfo().displayName:void 0}}},yk=function(){var e=(0,gd._)((function(e,t,n){var r,o,a,s,l;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:return r=MC.Unset,n&&(o=vR(n),a=o.correlationId,o.featureName,(s=o.subFeatureName)&&(r=s),void 0!==a&&rk.setQueryGuid(a)),rk.sendChatEventTelemetry(HS((l={},(0,i._)(l,cC.ChatEventType,dC.CitationClicked),(0,i._)(l,cC.ChatEventParameters,r),l))),n&&rk.setQueryGuid(""),t=null!=t?t:tk.get(e),[4,jN(t)];case 1:return c.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),Ck=function(){var e=(0,gd._)((function(e,t,n,r,o,a,s){var l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U;return(0,F.__generator)(this,(function(F){switch(F.label){case 0:return l=null==e?void 0:e.body,c=null==l?void 0:l.summary,u=null==l?void 0:l.intent,d=null==l?void 0:l.error,ck=null!==(p=null==l?void 0:l.isVisual)&&void 0!==p&&p,uk=null!==(g=null==l?void 0:l.analyzingVisuals)&&void 0!==g&&g,f=null!==(m=null==l?void 0:l.chatMessageHeader)&&void 0!==m?m:void 0,void 0!==(null==l?void 0:l.queryId)&&(ZA()||(!Vh(Lh.IsVisualSummaryUIEnabled)||SR(u)&&bk()||!SR(u))&&mb.getInstance().removeContextId(null==l?void 0:l.queryId),nk.setUserQueryGuid(l.queryId),GS(l.queryId)),(null==l?void 0:l.fromCache)&&rk.sendLatencyTelemetry(HS((0,i._)({},sC.IsFromCache,!0))),$x&&(rk.logTriedEvent(Iv.Summarize,Yx(u),yE.RX.Summarize),lw.getInstance().setSkillName(mp.Summary),Jh(Dh.IsScenarioErrorTelemetryEnabled)&&nk.setScenarioName(Cv.Summary),rk.sendLatencyTelemetry(HS((h={},(0,i._)(h,sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),(0,i._)(h,sC.AnnotationType,TE.getTypeName()),(0,i._)(h,sC.FeatureName,_C.Summary),h)))),ZR("".concat(IE.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(qp.qD)," sec \n, intent: ").concat(u," \n, Summary : ").concat(c," \n, Error : ").concat(JSON.stringify(d))),v=!ZA(),y=!(!SR(u)||!bk())||!(SR(u)&&Ek()),lk=!0,Vh(Lh.IsDebugSectionV2Enabled)&&(YA(IE.getTypeName(),(0,qp.WU)(qp.qD),!1,null==l?void 0:l.status),nL(l,qp.qD,void 0,!0,!0),C=Cd({},xA),IA.push(C),s()),void 0!==(null==d?void 0:d.category)?(S=qx(d,u,t,!ZA()),b=S.errorCode,E=S.errorKey,BS(rk,qp.qD,Vh(Lh.IsVisualSummarizationEnabled)&&ck?sC.VisualSummaryResponseTime:sC.SummaryResponseTime,sC.SummaryChunkInfo,ok,IC.Summary,"".concat(IE.getTypeName(),"_Error"),d.category.concat(uF(b)?rM:"_".concat(b)),ep.Server,v,void 0,void 0,E),gk(y),nk.setResponseTime((0,qp.WU)(qp.qD)),M_(!1,"SummaryStreamingWorkflow_".concat(d.category),Cv.Summary),[2]):(rk.sendChatEventTelemetry(HS((w={},(0,i._)(w,cC.ChatEventType,dC.ResponseReceivedFromAL),(0,i._)(w,cC.ChatEventParameters,IE.getTypeName()),(0,i._)(w,cC.IsFromCache,null!==(T=null==l?void 0:l.fromCache)&&void 0!==T&&T),(0,i._)(w,cC.IsVisual,null!==(I=null==l?void 0:l.isVisual)&&void 0!==I&&I),(0,i._)(w,cC.IsAnalyzingVisual,null!==(_=null==l?void 0:l.analyzingVisuals)&&void 0!==_&&_),(0,i._)(w,cC.Cv,null!=r?r:""),w))),rk.sendChatEventTelemetry(HS((P={},(0,i._)(P,cC.ChatEventType,dC.SummaryIntentDetectedFromAL),(0,i._)(P,cC.ChatEventParameters,u),P))),ek=[],tk.clear(),y||rk.sendLatencyTelemetry(HS((0,i._)({},sC.SummaryResponseTime,(0,qp.WU)(qp.qD)))),[4,fk(c,u,n,t,y,f)]);case 1:switch(x=F.sent(),k=x.result,A=x.errorKey,SR(u)&&Ek()&&(null===(L=t.current)||void 0===L||L.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(D=Gx().get(Hd.PresentationSummaryWithVisual))&&void 0!==D?D:[]},FN()))),O=null,u){case hE.CallsForAction:O=dC.CallsToActionResponseShown;break;case hE.ImportantSlides:O=dC.ImportantSlidesResponseShown;break;case hE.Summary:case hE.SegmentedSummary:case hE.StyledSummary:O=dC.SummaryResponseShown}return null!==O&&rk.sendChatEventTelemetry(HS((N={},(0,i._)(N,cC.ChatEventType,O),(0,i._)(N,cC.UserQueryGuid,(null==l?void 0:l.queryId)||""),N))),k||BS(rk,qp.qD,Vh(Lh.IsVisualSummarizationEnabled)&&ck?sC.VisualSummaryResponseTime:sC.SummaryResponseTime,sC.SummaryChunkInfo,ok,IC.Summary,"".concat(IE.getTypeName(),"_Error"),"IncorrectResponse",ep.Server,v,void 0,void 0,A),Vh(Lh.IsDebugSectionV2Enabled)&&(null==(M=null===(R=t.current)||void 0===R?void 0:R.getLastMessage(!1))?void 0:M.body.user)===ig.Q9.Chat&&(U=null===(B=M.actionBarButtons)||void 0===B?void 0:B.slice(),ZA()||(EL(U,xA,o,a),M.actionBarButtons=U)),gk(y),nk.setResponseTime((0,qp.WU)(qp.qD)),y&&M_(k,k?void 0:"SummaryStreamingWorkflow_IncorrectResponse",Cv.Summary),[2]}}))}));return function(t,n,r,o,i,a,s){return e.apply(this,arguments)}}(),Sk=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{chatCardType:jp._.Default,chatMessageData:void 0,chatMessageBodyData:e,stopLoadingUi:t}},bk=function(){return ck},Ek=function(){return!!Vh(Lh.IsVisualSummaryUIEnabled)&&uk};function Tk(){return oF(WK())&&Jh(Dh.IsNewPptCopilotWorkflowIntegrationEnabled)||Ik()}function Ik(){return rF(WK())&&ev()}function _k(e){return e&&(oF(WK())||Ik())}function wk(){return oF(WK())||rF(WK())&&Vh(Lh.IsPersistentChatHistoryEnabledForConsumer)}var Pk=function(){return Vh("HideChangeTopicButton")||rF(WK())&&!ev()};function xk(){return oF(WK())&&$h()||rF(WK())&&Jh(Dh.IsGroundingPhase2UxEnabledForConsumer)}function kk(){return Vh("enableChatHistoryV2ForEnterprise")&&oF(WK())||Vh("enableChatHistoryV2ForConsumer")&&rF(WK())}function Ak(){return kk()&&(Vh("enableChatHistoryLocalStorageForEnterprise")&&oF(WK())||Vh("enableChatHistoryLocalStorageForConsumer")&&rF(WK()))}function Lk(){return oF(WK())||rF(WK())&&Vh(Lh.IsCIQEnabledForConsumerAccount)}var Dk=n(972),Ok=ob.getInstance(),Nk=new Map,Rk=function(e,t){var n=Nk.get(e);if(n){var r=Cd({},n,t);Nk.set(e,r)}else ZR("Notification with key ".concat(e," does not exist."))},Fk=function(e){Nk.has(e)?Nk.delete(e):ZR("Notification with key ".concat(e," does not exist."))},Mk=function(e){return Nk.get(e)},Bk=function(e){var t,n,r;ZR("completionNotificationSuccessButtonClick, telemetryData: ".concat(e));var o,a,s=vR(null!=e?e:rM).correlationId;qk.disableSuccessButton(s,Sb.getInstance().getChatRef()),Ok.sendChatEventTelemetry(HS((a={},(0,i._)(a,cC.UserQueryGuid,null!=s?s:rM),(0,i._)(a,cC.ChatEventType,dC.NotificationCardUpdated),(0,i._)(a,cC.ChatEventParameters,ZB),(0,i._)(a,cC.UniqueActionId,null!==(o=null===(t=Mk(null!=s?s:rM))||void 0===t?void 0:t.uniqueActionID)&&void 0!==o?o:rM),a)),void 0);var l=null===(r=Mk(null!=s?s:rM))||void 0===r||null===(n=r.NotificationAnnotation)||void 0===n?void 0:n.actionParameters;if(void 0!==l){var c=l[0].annotations;if(void 0!==c&&c.length>0)!function(e,t){Uk.apply(this,arguments)}(c[0].type,c[0].value)}else{var u,d,p;ZR("success Button clicked with undefined actionParameters"),Ok.sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.UserQueryGuid,null!=s?s:rM),(0,i._)(p,cC.ChatEventType,dC.NotificationCardUpdated),(0,i._)(p,cC.ChatEventParameters,YB),(0,i._)(p,cC.ChatErrorType,ep.Server),(0,i._)(p,cC.UniqueActionId,null!==(d=null===(u=Mk(null!=s?s:rM))||void 0===u?void 0:u.uniqueActionID)&&void 0!==d?d:rM),p)),void 0)}Fk(null!=s?s:rM)};function Uk(){return(Uk=(0,gd._)((function(e,t){return(0,F.__generator)(this,(function(n){switch(ZR("handleVisualSummaryNotification Response, type: ".concat(e)),e){case VE.getTypeName():Hk(t);break;case IE.getTypeName():break;default:ZR("Unknown type received for Visual Summary Response: ".concat(e))}return[2]}))}))).apply(this,arguments)}var Hk=function(e){var t,n,r=null==e?void 0:e.body;ZR("PowerPointCopilotOutputAnnotation Notification: ".concat(JSON.stringify(r)));var o,a,s,l,c,u,d,p,g,m,f,h,v=null==r||null===(n=r.chatResponse)||void 0===n||null===(t=n.messages)||void 0===t?void 0:t.find((function(e){return AP(e)}));if(cF(r)||cF(v))return ZR("finalMessage is undefined for Notification Response"),Ok.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.UserQueryGuid,null!==(s=null==r?void 0:r.queryId)&&void 0!==s?s:rM),(0,i._)(u,cC.ChatEventType,dC.EmptyMessageReceivedFromSummarySkill),(0,i._)(u,cC.ChatEventParameters,XB),(0,i._)(u,cC.ChatErrorType,ep.Server),(0,i._)(u,cC.UniqueActionId,null!==(c=null===(o=Mk(null!==(l=r.queryId)&&void 0!==l?l:rM))||void 0===o?void 0:o.uniqueActionID)&&void 0!==c?c:rM),u)),void 0),void Ok.sendErrorTelemetry(HS((m={},(0,i._)(m,cC.UserQueryGuid,null!==(d=null==r?void 0:r.queryId)&&void 0!==d?d:rM),(0,i._)(m,uC.ErrorMessage,XB),(0,i._)(m,uC.ErrorCategory,IC.Notification),(0,i._)(m,sC.ErrorType,ep.Server),(0,i._)(m,uC.UniqueActionId,null!==(g=null===(a=Mk(null!==(p=r.queryId)&&void 0!==p?p:rM))||void 0===a?void 0:a.uniqueActionID)&&void 0!==g?g:rM),m)));null===(f=Sb.getInstance().getChatRef().current)||void 0===f||f.addResponseMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:ig.Q9.Human,message:NB()}}});var y,C,S,b,E,T,I=null!==(h=null==r?void 0:r.chatMessageHeader)&&void 0!==h?h:void 0;if(!(null==v?void 0:v.text))return ZR("Empty message received from PowerPointCopilotOutputAnnotation"),void Ok.sendChatEventTelemetry(HS((E={},(0,i._)(E,cC.UserQueryGuid,null!==(C=null==r?void 0:r.queryId)&&void 0!==C?C:rM),(0,i._)(E,cC.ChatEventType,dC.EmptyMessageReceivedFromSummarySkill),(0,i._)(E,cC.ChatEventParameters,KB),(0,i._)(E,cC.ChatErrorType,ep.Server),(0,i._)(E,cC.UniqueActionId,null!==(b=null===(y=Mk(null!==(S=r.queryId)&&void 0!==S?S:rM))||void 0===y?void 0:y.uniqueActionID)&&void 0!==b?b:rM),E)),void 0);!function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=null!==(r=null==e?void 0:e.text)&&void 0!==r?r:rM,a=CL(),s=[];if(Jh(Dh.IsCitationsEnabled))if(((null==e?void 0:e.citations)||[]).length>0){var l=null==e?void 0:e.citations,c=!0,u=!1,d=void 0;try{for(var p,g=l[Symbol.iterator]();!(c=(p=g.next()).done);c=!0){var m=p.value;s.push(rL(m))}}catch(e){u=!0,d=e}finally{try{c||null==g.return||g.return()}finally{if(u)throw d}}}else if(void 0!==e&&(e.sourceAttributions||[]).length>0){var f;s=aL(null!==(f=e.sourceAttributions)&&void 0!==f?f:[])}null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:ig.Q9.Chat,message:i}},chatMessageBodyData:{actionButtonList:a,shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:Tb.getInstance().shouldShowInDocSensitivityLabel()?ML():void 0,feedbackSectionPosition:ag.O.Footer,feedbackData:NN(Wd.CHATPPT),telemetryData:RN(Iv.Summarize,MC.VisualSummary),showAnimation:!0,references:s,isFailure:!1,messageId:null==e?void 0:e.messageId,chatMessageHeaderData:OL(o)},workflowAnnotationTypeForAugloopTimer:VE.getTypeName(),addCardToChatHistory:!0})}(v,Sb.getInstance().getChatRef(),I);var _,w,P,x,k,A,L=(T={},(0,i._)(T,cC.ChatEventType,dC.VisualSummaryShownAfterNotification),(0,i._)(T,cC.ChatEventParameters,VE.getTypeName()),T);(null==r?void 0:r.queryId)&&(L[cC.UserQueryGuid]=null==r?void 0:r.queryId,L[cC.UniqueActionId]=null!==(P=null===(_=Mk(null!==(w=null==r?void 0:r.queryId)&&void 0!==w?w:rM))||void 0===_?void 0:_.uniqueActionID)&&void 0!==P?P:rM),Ok.sendChatEventTelemetry(HS(L),void 0),Ok.sendLatencyTelemetry(HS((A={},(0,i._)(A,cC.UserQueryGuid,null!==(x=null==r?void 0:r.queryId)&&void 0!==x?x:rM),(0,i._)(A,sC.ContentOrigin,null!==(k=null==v?void 0:v.contentOrigin)&&void 0!==k?k:fp.UNKNOWN),A)))};var Gk=ob.getInstance(),zk=function(){function e(){Sp(this,e)}return Ep(e,[{key:"updateActiveCardForInProgressNotification",value:function(e,t,n){var r,o,a,s,l,c=this,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=null!==(o=null===(r=Mk(e))||void 0===r?void 0:r.messageID)&&void 0!==o?o:rM;if(cF(d)||d===rM)return ZR("No message Id to update card for inprogressNotification, queryId: ".concat(e)),Gk.sendErrorTelemetry(HS((l={},(0,i._)(l,cC.UserQueryGuid,e),(0,i._)(l,uC.ErrorMessage,qB),(0,i._)(l,uC.ErrorCategory,IC.Notification),(0,i._)(l,sC.ErrorType,ep.Client),(0,i._)(l,uC.UniqueActionId,null!==(s=null===(a=Mk(e))||void 0===a?void 0:a.uniqueActionID)&&void 0!==s?s:rM),l))),null;ZR("updating card for in progress Notification");var p={loadingMessage:OB(),loadingSpinnerLabel:this.getLabelFromPreviewMessage(n),loadingState:uf.Kg.InProgress};this.updateMessageForNotification(t,p,d);var g,m,f,h,v=(g=e,setTimeout((function(){ZR("Timer expired for updatingCardForNotification"),ZR("queryId: ".concat(g,", value : ").concat(Mk(g))),c.updateActiveCardForInFailureNotification(g,t,QB)}),JF));u&&Gk.sendChatEventTelemetry(HS((h={},(0,i._)(h,cC.UserQueryGuid,e),(0,i._)(h,cC.ChatEventType,dC.NotificationCardUpdated),(0,i._)(h,cC.ChatEventParameters,null!=n?n:rM),(0,i._)(h,cC.NotificationState,jg.IN_PROGRESS),(0,i._)(h,cC.UniqueActionId,null!==(f=null===(m=Mk(e))||void 0===m?void 0:m.uniqueActionID)&&void 0!==f?f:rM),h)),void 0);return v}},{key:"updateActiveCardForCompleteNotification",value:function(e,t,n){var r,o,a,s,l,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=null!==(o=null===(r=Mk(e))||void 0===r?void 0:r.messageID)&&void 0!==o?o:rM;if(cF(u)||u===rM)return ZR("No message Id to update card for completeNotification, messgaeId: ".concat(u)),Gk.sendErrorTelemetry(HS((l={},(0,i._)(l,cC.UserQueryGuid,e),(0,i._)(l,uC.ErrorMessage,WB),(0,i._)(l,uC.ErrorCategory,IC.Notification),(0,i._)(l,sC.ErrorType,ep.Client),(0,i._)(l,uC.UniqueActionId,null!==(s=null===(a=Mk(e))||void 0===a?void 0:a.uniqueActionID)&&void 0!==s?s:rM),l))),null;ZR("updating card for complete Notification");var d,p,g,m,f,h,v,y={loadingMessage:OB(),successButtonProps:{successButtonIconRegular:Dk.P60,successButtonIconHover:Dk.P60,successButtonText:null!=n?n:NB(),successButtonOnClick:Bk},loadingState:uf.Kg.Success};(this.updateMessageForNotification(t,y,u),c)&&(Gk.sendChatEventTelemetry(HS((f={},(0,i._)(f,cC.UserQueryGuid,e),(0,i._)(f,cC.ChatEventType,dC.NotificationCardUpdated),(0,i._)(f,cC.ChatEventParameters,JB),(0,i._)(f,cC.NotificationState,jg.COMPLETED),(0,i._)(f,cC.UniqueActionId,null!==(m=null===(d=Mk(e))||void 0===d?void 0:d.uniqueActionID)&&void 0!==m?m:rM),f)),void 0),Gk.sendLatencyTelemetryForNotifications(HS((v={},(0,i._)(v,sC.LastNotificationReceivedTime,(0,qp.WU)(null===(p=Mk(e))||void 0===p?void 0:p.querySubmissionTime)),(0,i._)(v,sC.FeatureName,IC.Notification),(0,i._)(v,sC.SubFeatureName,MC.VisualSummary),(0,i._)(v,sC.UniqueActionId,null!==(h=null===(g=Mk(e))||void 0===g?void 0:g.uniqueActionID)&&void 0!==h?h:rM),v)),e,c))}},{key:"disableSuccessButton",value:function(){var e,t,n,r,o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rM,s=arguments.length>1?arguments[1]:void 0,l=null!==(t=null===(e=Mk(a))||void 0===e?void 0:e.messageID)&&void 0!==t?t:rM;if(cF(l)||l===rM)return ZR("No message Id to disable success button, queryId: ".concat(a)),Gk.sendErrorTelemetry(HS((o={},(0,i._)(o,cC.UserQueryGuid,a),(0,i._)(o,uC.ErrorMessage,jB),(0,i._)(o,uC.ErrorCategory,IC.Notification),(0,i._)(o,sC.ErrorType,ep.Client),(0,i._)(o,uC.UniqueActionId,null!==(r=null===(n=Mk(a))||void 0===n?void 0:n.uniqueActionID)&&void 0!==r?r:rM),o))),null;ZR("disabling success button");var c={loadingMessage:OB(),successButtonProps:{isDisabled:!0,successButtonIconRegular:Dk.P60,successButtonIconHover:Dk.P60,successButtonText:NB()},loadingState:uf.Kg.Success};this.updateMessageForNotification(s,c,l)}},{key:"updateActiveCardForInFailureNotification",value:function(e,t,n){var r,o,a,s,l,c,u,d,p,g=null!==(c=null===(r=Mk(e))||void 0===r?void 0:r.messageID)&&void 0!==c?c:rM;if(cF(g)||g===rM)return ZR("No message Id to update card for completeNotification, queryId: ".concat(e)),Gk.sendErrorTelemetry(HS((p={},(0,i._)(p,cC.UserQueryGuid,e),(0,i._)(p,uC.ErrorMessage,VB),(0,i._)(p,uC.ErrorCategory,IC.Notification),(0,i._)(p,sC.ErrorType,ep.Client),(0,i._)(p,uC.UniqueActionId,null!==(d=null===(u=Mk(e))||void 0===u?void 0:u.uniqueActionID)&&void 0!==d?d:rM),p))),null;ZR("updating card for failure Notification");var m,f,h,v,y,C,S={loadingMessage:OB(),failureText:RB(),loadingState:uf.Kg.Failure};this.updateMessageForNotification(t,S,g),Gk.sendChatEventTelemetry(HS((f={},(0,i._)(f,cC.UserQueryGuid,e),(0,i._)(f,cC.ChatEventType,dC.NotificationError),(0,i._)(f,cC.ChatEventParameters,null!=n?n:rM),(0,i._)(f,cC.UniqueActionId,null!==(m=null===(o=Mk(e))||void 0===o?void 0:o.uniqueActionID)&&void 0!==m?m:rM),(0,i._)(f,cC.NotificationState,"".concat(jg.FAILED)),(0,i._)(f,cC.ChatErrorType,ep.Server),f)),void 0),Gk.sendErrorTelemetry(HS((v={},(0,i._)(v,cC.UserQueryGuid,e),(0,i._)(v,uC.ErrorMessage,null!=n?n:rM),(0,i._)(v,uC.ErrorCategory,IC.Notification),(0,i._)(v,sC.ErrorType,ep.Server),(0,i._)(v,uC.UniqueActionId,null!==(h=null===(a=Mk(e))||void 0===a?void 0:a.uniqueActionID)&&void 0!==h?h:rM),v))),Gk.sendLatencyTelemetryForNotifications(HS((C={},(0,i._)(C,sC.LastNotificationReceivedTime,(0,qp.WU)(null===(s=Mk(e))||void 0===s?void 0:s.querySubmissionTime)),(0,i._)(C,sC.FeatureName,IC.Notification),(0,i._)(C,sC.SubFeatureName,MC.VisualSummary),(0,i._)(C,sC.UniqueActionId,null!==(y=null===(l=Mk(e))||void 0===l?void 0:l.uniqueActionID)&&void 0!==y?y:rM),C)),e,!0),Fk(e)}},{key:"updateMessageForNotification",value:function(e,t,n){var r;null===(r=e.current)||void 0===r||r.updateMessage({chatCardType:Vh(Lh.IsMarkdownSummarizationEnabled)?jp._.MarkdownCard:jp._.Default,chatMessageBodyData:{progressSpinnerData:t,messageId:n},addCardToChatHistory:!1})}},{key:"getLabelFromPreviewMessage",value:function(e){var t=DB().find((function(t){return t.key===e}));return t?t.value:MB()}},{key:"clearTimerForNotification",value:function(e){null!==e?(ZR("clearing timer for Notification: ".concat(e)),clearTimeout(e)):ZR("timer id is null")}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(zk,"instance",void 0);const qk=zk.getInstance();class Wk{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(Wk,this,e)}static getTypeName(){return"AugLoop_NotificationCopilot_NotificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[Wk.getTypeName()])}}var jk,Vk,Qk,Jk;Wk.H_={T_:Wk.getTypeName(),B_:Wk.getBaseTypes()},function(e){e.STATE="STATE"}(jk||(jk={})),function(e){e[e.PROGRESS=1]="PROGRESS"}(Vk||(Vk={})),function(e){e.VISUAL_SUMMARY="VISUAL_SUMMARY"}(Qk||(Qk={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.STARTED="STARTED",e.COMPLETED="COMPLETED",e.FAILED="FAILED"}(Jk||(Jk={}));var Kk,Xk,Zk,Yk=ob.getInstance(),$k=function(){var e=(0,gd._)((function(e,t,n){var r,o,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N;return(0,F.__generator)(this,(function(n){return l=null==e?void 0:e.body,u=null!==(c=null==l?void 0:l.queryId)&&void 0!==c?c:rM,d=null==l?void 0:l.notificationType,p=null==l?void 0:l.previewMessage,g=null==l?void 0:l.attributes,m=null==l?void 0:l.actionParameters,ZR("NotificationAnnotationProcessor: queryId: ".concat(u,", notificationType: ").concat(d,", previewMessage: ").concat(p,", Time: ").concat((new Date).toLocaleTimeString(),", attributes ").concat(JSON.stringify(null!=g?g:rM),", actionParameters ").concat(JSON.stringify(null!=m?m:rM))),Yk.sendChatEventTelemetry(HS((h={},(0,i._)(h,cC.UserQueryGuid,u),(0,i._)(h,cC.ChatEventType,dC.ResponseReceivedFromAL),(0,i._)(h,cC.ChatEventParameters,Wk.getTypeName()),(0,i._)(h,cC.UniqueActionId,null!==(f=null===(r=Mk(u))||void 0===r?void 0:r.uniqueActionID)&&void 0!==f?f:rM),h)),void 0),cF(l)?(ZR("NotificationAnnotationProcessor: body is null or undefined"),Yk.sendErrorTelemetry(HS((v={},(0,i._)(v,cC.UserQueryGuid,u),(0,i._)(v,uC.ErrorMessage,UB),(0,i._)(v,uC.ErrorCategory,IC.Notification),(0,i._)(v,sC.ErrorType,ep.Server),v))),Yk.sendChatEventTelemetry(HS((y={},(0,i._)(y,cC.UserQueryGuid,u),(0,i._)(y,cC.NotificationType,d),(0,i._)(y,cC.ChatEventType,dC.CheckNotification),(0,i._)(y,cC.ChatEventParameters,UB),(0,i._)(y,cC.ChatErrorType,ep.Server),y)),void 0),[2]):cF(u)||u===rM?(ZR("Received Notification for null queryID, ignoring"),Yk.sendErrorTelemetry(HS((C={},(0,i._)(C,cC.UserQueryGuid,u),(0,i._)(C,uC.ErrorMessage,HB),(0,i._)(C,uC.ErrorCategory,IC.Notification),(0,i._)(C,sC.ErrorType,ep.Server),C))),Yk.sendChatEventTelemetry(HS((S={},(0,i._)(S,cC.UserQueryGuid,u),(0,i._)(S,cC.NotificationType,d),(0,i._)(S,cC.ChatEventType,dC.CheckNotification),(0,i._)(S,cC.ChatEventParameters,HB),(0,i._)(S,cC.ChatErrorType,ep.Server),S)),void 0),[2]):(R=u,Nk.has(R)?(cF(null===(o=Mk(u))||void 0===o?void 0:o.NotificationAnnotation)&&Yk.sendLatencyTelemetryForNotifications(HS((A={},(0,i._)(A,sC.FirstNotificationReceivedTime,(0,qp.WU)(null===(P=Mk(u))||void 0===P?void 0:P.querySubmissionTime)),(0,i._)(A,sC.UniqueActionId,null!==(k=null===(x=Mk(u))||void 0===x?void 0:x.uniqueActionID)&&void 0!==k?k:rM),(0,i._)(A,sC.FeatureName,IC.Notification),(0,i._)(A,sC.SubFeatureName,MC.VisualSummary),A)),u,!1),Rk(u,{NotificationAnnotation:l}),(null===(a=Mk(u))||void 0===a?void 0:a.startShowingNotification)?(qk.clearTimerForNotification(null!==(N=null===(s=Mk(u))||void 0===s?void 0:s.timerId)&&void 0!==N?N:null),d===Vk.PROGRESS?(ZR("NotificationAnnotationProcessor: Progress Notification received"),eA(u,g,t,p)):ZR("NotificationAnnotationProcessor: Unknown Notification Type: ".concat(d)),[2]):(ZR("Final Chunk Not received for card content, ignoring notification, queryId: ".concat(u)),Yk.sendChatEventTelemetry(HS((O={},(0,i._)(O,cC.UserQueryGuid,u),(0,i._)(O,cC.ChatEventParameters,zB),(0,i._)(O,cC.ChatEventType,dC.CheckNotification),(0,i._)(O,cC.UniqueActionId,null!==(D=null===(L=Mk(u))||void 0===L?void 0:L.uniqueActionID)&&void 0!==D?D:rM),O)),void 0),[2])):(ZR("Received Notification for stale queryID, ignoring, queryId: ".concat(u)),Yk.sendChatEventTelemetry(HS((I={},(0,i._)(I,cC.UserQueryGuid,u),(0,i._)(I,cC.NotificationType,d),(0,i._)(I,cC.ChatEventType,dC.CheckNotification),(0,i._)(I,cC.ChatEventParameters,GB),(0,i._)(I,cC.ChatErrorType,ep.Client),(0,i._)(I,cC.UniqueActionId,null!==(T=null===(b=Mk(u))||void 0===b?void 0:b.uniqueActionID)&&void 0!==T?T:rM),I)),void 0),Yk.sendErrorTelemetry(HS((w={},(0,i._)(w,cC.UserQueryGuid,u),(0,i._)(w,uC.ErrorMessage,GB),(0,i._)(w,uC.ErrorCategory,IC.Notification),(0,i._)(w,sC.ErrorType,ep.Client),(0,i._)(w,uC.UniqueActionId,null!==(_=null===(E=Mk(u))||void 0===E?void 0:E.uniqueActionID)&&void 0!==_?_:rM),w))),[2]));var R}))}));return function(t,n,r){return e.apply(this,arguments)}}(),eA=function(e,t,n,r){cF(t)?ZR("NotificationAnnotationProcessor: Progress Notification attributes are null or undefined"):null==t||t.forEach((function(t){var o=t.name,i=t.value;if(ZR("NotificationAnnotationProcessor: Progress Notification attribute: ".concat(o," - ").concat(i)),o===jk.STATE)switch(i){case jg.STARTED:case jg.IN_PROGRESS:var a=qk.updateActiveCardForInProgressNotification(e,n,r,!0);Rk(e,{timerId:a});break;case jg.COMPLETED:var s;qk.updateActiveCardForCompleteNotification(e,n,void 0,!0),(null==n||null===(s=n.current)||void 0===s?void 0:s.getIsExecuting())&&qk.disableSuccessButton(e,n);break;case jg.FAILED:qk.updateActiveCardForInFailureNotification(e,n,r);break;default:ZR("Unknown State Received for Notification: ".concat(i," for attribute: ").concat(o))}}))},tA=function(e){var t=Mk(e),n=null==t?void 0:t.NotificationAnnotation,r=null==n?void 0:n.attributes;if(void 0!==r&&r.length>0){var o,i,a=null===(o=r[0])||void 0===o?void 0:o.name,s=null===(i=r[0])||void 0===i?void 0:i.value;return a===jk.STATE&&s===jg.IN_PROGRESS}return!1},nA=function(e){var t=Mk(e),n=null==t?void 0:t.NotificationAnnotation,r=null==n?void 0:n.attributes;if(void 0!==r&&r.length>0){var o,i,a=null===(o=r[0])||void 0===o?void 0:o.name,s=null===(i=r[0])||void 0===i?void 0:i.value;return a===jk.STATE&&s===jg.COMPLETED}return!1},rA=function(e,t,n){var r=!1,o=-1,s=void 0;try{var l,c=null===(l=e.children)||void 0===l?void 0:l[0];o=Number(c),r=Number.isInteger(o)&&o>0}catch(e){var u;return t.sendErrorTelemetry(HS((u={},(0,i._)(u,uC.ErrorMessage,rU),(0,i._)(u,uC.ErrorCategory,IC.ClickableKeySlides),(0,i._)(u,sC.ErrorType,ep.Client),u))),a.createElement(a.Fragment,null)}if(r&&o>=0){if(Vh(Lh.IsClickableCopilotKeySlidesEnabled)){if(Jh(Dh.IsClickableCopilotKeySlidesDependentOnSlideIds))try{s=function(e,t){if(void 0===t)throw new Error("Hidden text not found");if(0===t.length)throw new Error("Hidden text is empty");var n=JSON.parse(t).find((function(t){return(null==t?void 0:t.slideNumber)===e}));if(void 0===(null==n?void 0:n.mappedId))throw new Error("Key slide id not found");var r=NL(n.mappedId);if(!r||2!==r.length)throw new Error("Key slide id is not in the correct format");if(r[0]<0||r[1]<0)throw new Error("Slide Ids not valid");return n.mappedId}(o,n)}catch(e){var d;t.sendErrorTelemetry(HS((d={},(0,i._)(d,uC.ErrorMessage,nU),(0,i._)(d,uC.ErrorCategory,IC.ClickableKeySlides),(0,i._)(d,sC.ErrorType,ep.Client),d)))}var p=function(){var e=(0,gd._)((function(e){var n,r,o,a,s,l=arguments;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:n=l.length>1&&void 0!==l[1]?l[1]:void 0;try{t.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.ClickableKeySlidesClicked),(0,i._)(r,cC.ChatEventParameters,JSON.stringify({isClickableKeySlidesEnabled:Vh(Lh.IsClickableCopilotKeySlidesEnabled),isClickableCopilotKeySlidesDependentOnSlideIds:Jh(Dh.IsClickableCopilotKeySlidesDependentOnSlideIds)})),r)))}catch(e){t.sendErrorTelemetry(HS((o={},(0,i._)(o,uC.ErrorMessage,eU),(0,i._)(o,uC.ErrorCategory,IC.ClickableKeySlides),(0,i._)(o,sC.ErrorType,ep.Client),o)))}a=e-1,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){var t,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return Jh(Dh.IsClickableCopilotKeySlidesDependentOnSlideIds)?(n&&e.presentation.setSelectedSlides([n]),[4,e.sync()]):[3,2];case 1:return o.sent(),[3,5];case 2:return(t=e.presentation.slides).load("items, items/id"),[4,e.sync()];case 3:return o.sent(),a>=0&&a<t.items.length?(void 0!==(r=t.items[a].id)&&e.presentation.setSelectedSlides([r]),[4,e.sync()]):[3,5];case 4:o.sent(),o.label=5;case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return c.sent(),[3,4];case 3:return c.sent(),t.sendErrorTelemetry(HS((s={},(0,i._)(s,uC.ErrorMessage,tU),(0,i._)(s,uC.ErrorCategory,IC.ClickableKeySlides),(0,i._)(s,sC.ErrorType,ep.Server),s))),[3,4];case 4:return[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}();return a.createElement("div",{style:{display:"contents",cursor:"pointer"},onClick:function(){return p(o,s)},role:"button",onKeyDown:function(e){"Enter"===e.key&&p(o,s)},tabIndex:0},a.createElement("u",null,UM(o)))}return a.createElement("div",{style:{display:"contents"}},UM(o))}return a.createElement(a.Fragment,null)},oA=new vE.Basin,iA=!0,aA=rM,sA=rM,lA=!1,cA=!0,uA=!0,dA=!0,pA=new Map,gA=ob.getInstance(),mA=sb.getInstance(),fA=!1,hA=!1,vA=!1,yA=!1,CA=Tb.getInstance(),SA=[],bA=Zy.getInstance(),EA=[],TA=[],IA=[],_A=[],wA=[],PA=[],xA={},kA="",AA=hE.Unknown,LA=!1,DA=!1,OA=!1,NA=void 0,RA=void 0,FA=!1,MA=function(){var e=(0,gd._)((function(e,t,n,r,o,a,s,l,c,u,d){var p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y=arguments;return(0,F.__generator)(this,(function(F){switch(F.label){case 0:return p=Y.length>11&&void 0!==Y[11]&&Y[11],g=Y.length>12?Y[12]:void 0,m=Y.length>13&&void 0!==Y[13]?Y[13]:0,f=Y.length>14?Y[14]:void 0,h=Y.length>15?Y[15]:void 0,v=Y.length>16?Y[16]:void 0,y=0===a?qp.qD:a,(C=null==e?void 0:e.body)?(Vh(Lh.IsMarkdownSummarizationEnabled)&&!cF(C.comprehensionSummaryConfig)&&(b=null!==(S=C.comprehensionSummaryConfig)&&void 0!==S?S:{intent:hE.Unknown,isVisual:!1,cache:!1},AA=null!==(T=hE[null!==(E=b.intent)&&void 0!==E?E:"Unknown"])&&void 0!==T?T:hE.Unknown,DA=null!==(I=b.isVisual)&&void 0!==I&&I,OA=null!==(_=b.analyzingVisuals)&&void 0!==_&&_,LA=null!==(w=b.cache)&&void 0!==w&&w,ZR("Summary Intent: ".concat(AA,", isVisualSummary: ").concat(DA,", summaryFromCache: ").concat(LA,", analyzingVisuals: ").concat(OA))),x=null!==(P=C.requiredActionParameters)&&void 0!==P?P:[],Vh(Lh.IsPersonalizationUXEnabled)&&Vh(Lh.IsPersonalizationConfirmationResponseEnabled)&&gg(x,t),(k=C.queryId)&&gA.setQueryGuid(k),jE.getInstance().setState(Qd.EXECUTING),A=[{key:cC.ChatEventType,value:dC.ResponseReceivedFromAL},{key:cC.ChatEventParameters,value:VE.getTypeName()},{key:cC.Cv,value:null!=g?g:""}],gA.sendChatEventTelemetry(A),dA&&(L=[{key:sC.FirstServiceResponse,value:(0,qp.WU)(y)},{key:sC.AnnotationType,value:VE.getTypeName()},{key:sC.IsFluxUsed,value:!cF(C.sydneyEndpoint)}],D=[{key:cC.ChatEventType,value:dC.FirstResponseReceivedFromAL},{key:cC.ChatEventParameters,value:VE.getTypeName()}],gA.sendLatencyTelemetry(L),gA.sendChatEventTelemetry(D),Kk=null!==(O=C.conversationId)&&void 0!==O?O:"",Xk=null!==(N=C.sydneyEndpoint)&&void 0!==N?N:"",dA=!1),C.chatResponse?(R=Vh(Lh.IsMarkdownSummarizationEnabled)&&void 0!==function(e){var t,n;return e.chatResponse.messages?null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return DP(e)})):e.chatResponse.messagesToAddOrReplace?null===(n=e.chatResponse.messagesToAddOrReplace)||void 0===n?void 0:n.find((function(e){return DP(e)})):void 0}(C),ZR("MarkDown Summary FG Enabled : ".concat(Vh(Lh.IsMarkdownSummarizationEnabled),", isSkillResponse : ").concat(R)),pL(R,C.chatResponse.status),0!==C.chatResponse.status?[3,2]:(R?gA.sendChatEventTelemetry(HS((q={},(0,i._)(q,cC.ChatEventType,dC.SummaryIntentDetectedFromAL),(0,i._)(q,cC.ChatEventParameters,AA),q))):(ZR("PowerPoint Flux Copilot streaming ended."),Vh(Lh.IsDebugSectionV2Enabled)&&nL(C,qp.qD),(null==C?void 0:C.conversationId)&&l(null==C?void 0:C.conversationId),B=null==C||null===(M=C.chatResponse)||void 0===M?void 0:M.telemetry,k&&B&&B.metrics&&(z=null!==(G=null==C||null===(H=C.chatResponse)||void 0===H?void 0:H.messages)&&void 0!==G?G:[],(U=_A).push.apply(U,Ed(z)),c(k,B))),[4,VA(C,t,o,R,d,h,f,v)])):[3,3]):(ZR("Empty body in flux response. Returning"),gA.sendErrorTelemetry([{key:uC.ErrorCategory,value:IC.FluxCopilot},{key:uC.ErrorMessage,value:"Empty body in PPT Copilot annotation received"}]),jE.getInstance().setState(Qd.IDLE),[2]);case 1:return F.sent(),[2];case 2:return function(e,t,n,r,o,i){JA.apply(this,arguments)}(C,t,p,R,m,d),[3,6];case 3:return C.odslResponse?(pL(!1),US(gA,VE.getTypeName(),null!=y?y:0,sC.CopilotODSLResponseTime,_C.Commanding),hA=!0,gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.ODSLResponseReceivedFromSydney},{key:cC.ChatEventParameters,value:VE.getTypeName()}]),Jh(Dh.IsClpEnabledInEnterpriseForSydney)&&(vA=e.body.odslResponse.odslAction===gE.Insertion),Zk=null!==(j=null===(W=C.odslResponse.odsl)||void 0===W?void 0:W.responseRequired)&&void 0!==j&&j,(V=C.odslResponse.images)&&V.length>0&&C.odslResponse.imageBaseUrl&&(gA.logTriedEvent(Iv.AddContent,MC.AddImage,yE.RX.Create),V.forEach((function(e){var t;gv.addImage({url:(null===(t=C.odslResponse)||void 0===t?void 0:t.imageBaseUrl)+e.imageId,description:e.description,altText:e.altText,license:e.license,companyName:e.companyName})}))),[4,Mx(Sd(Cd({},C.odslResponse),{queryId:k}),t,n,r,s,u,C.odslResponse.groundingInfo,C.odslResponse.chatConversations,C.odslResponseExtension)]):[3,5];case 4:return F.sent(),iA=Vh(Lh.IsSuggestionsForCommandingEnabled),jE.getInstance().setState(Qd.WAITING_FOR_COPILOT_WF_RESPONSE),[3,6];case 5:C.error?(Vh(Lh.IsDebugSectionV2Enabled)&&(nL(C,qp.qD,void 0,!0),Q=Cd({},xA),IA.push(Q),v()),J=!1,Vh(Lh.IsMarkdownSummarizationEnabled)&&C.comprehensionSummaryConfig&&(J=!0),ZR("PPT Flux copilot Error:\n".concat(C.error.message," Error category : ").concat(C.error.category,", From Summary Skill: ").concat(J)),pL(J),K=!ZA(),X=!J||J&&K,J?(Vh(Lh.IsNotificationEnabledForSummary)&&Fk(mA.getUserQueryGuid()),function(e,t,n){BA.apply(this,arguments)}(C.error,t,X)):(gA.sendLatencyTelemetry(HS((Z={},(0,i._)(Z,sC.FeatureName,_C.CopilotChat),(0,i._)(Z,sC.SydneyResponseTime,(0,qp.WU)(qp.qD)),Z))),bA.getIsWarningMessageActive()&&Ex(t),kP(C.error,t,r,!0,C.outputAnswerLanguage,h,f)),X&&(mb.getInstance().removeContextId(null==C?void 0:C.queryId),tL(),jE.getInstance().setState(Qd.IDLE))):(pL(Lh.IsMarkdownSummarizationEnabled&&void 0!==C.comprehensionSummaryConfig),ZR("ChatResponse, odslResponse, and error not present in PPT Copilot annotation received"),gA.sendErrorTelemetry([{key:uC.ErrorCategory,value:IC.FluxCopilot},{key:uC.ErrorMessage,value:"ChatResponse, odslResponse, and error not present in PPT Copilot annotation received"}]),tL(),jE.getInstance().setState(Qd.IDLE),mb.getInstance().removeContextId(null==C?void 0:C.queryId)),F.label=6;case 6:return[2]}}))}));return function(t,n,r,o,i,a,s,l,c,u,d){return e.apply(this,arguments)}}();function BA(){return(BA=(0,gd._)((function(e,t,n){var r,o,i;return(0,F.__generator)(this,(function(a){return r=qx(e,AA,t,n),o=r.errorCode,i=r.errorKey,BS(gA,qp.qD,sC.SummaryResponseTime,sC.SummaryChunkInfo,SA,IC.Summary,"".concat(VE.getTypeName(),"_Error"),e.category.concat(uF(o)?rM:"_".concat(o)),ep.Server,n,void 0,void 0,i),mA.setResponseTime((0,qp.WU)(qp.qD)),M_(!1,"PowerPointCopilotWorkflow_".concat(e.category),Cv.Summary),[2]}))}))).apply(this,arguments)}function UA(){return _k(RK)&&lA&&Zk}function HA(e,t,n){return GA.apply(this,arguments)}function GA(){return GA=(0,gd._)((function(e,t,n){var r,o;return(0,F.__generator)(this,(function(i){return mb.getInstance().isValidAnnotationResponse(e.queryId)?(o=new Vp.g0({parentPath:["Signal",bE.getTypeName()],items:[{id:aT.generateId(),body:e}]}),fA=e.status===fE.failed,null===(r=t.current)||void 0===r||r.submitOperation({operation:o,workflowAnnotationType:VE.getTypeName()})):(ZR("ODSL Execution Timeout for PPT Flux Copilot workflow."),gA.sendChatEventTelemetry(Ed(n||[]).concat([{key:cC.ChatEventType,value:dC.ODSLExecutionTimeout},{key:cC.ChatEventParameters,value:VE.getTypeName()},{key:cC.ChatErrorType,value:ep.Client}]))),[2]}))})),GA.apply(this,arguments)}function zA(e){return qA.apply(this,arguments)}function qA(){return(qA=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return RK&&Jh(Dh.IsClpEnabledInEnterpriseForSydney)&&vA&&e===Md.SUCCESS?CA.shouldShowInDocSensitivityLabel()?(ZR("Insertion scenario, updating document sensitivity"),[4,CA.upgradeSensitivityLabelUsingOfcJs(CA.getInDocSensitiveLabelInfo())]):[3,2]:[3,3];case 1:t.sent(),t.label=2;case 2:yA=Jh(Dh.ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion),t.label=3;case 3:return[2]}}))}))).apply(this,arguments)}function WA(e){var t=e.adaptiveCards?e.adaptiveCards[0]:null,n="";if(t){var r=t.body,o=!0,i=!1,a=void 0;try{for(var s,l=r[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;"TextBlock"===c.type&&(n+=c.text)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}return n}function jA(e){var t,n,r=null==e||null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase();return!!(r===fp.CANNED_RESPONSE||r===fp.TRANSFORM_CONTENT||r===fp.COPILOT_POWERPOINT_SUMMARY.toLowerCase()||r===fp.IMAGE_CHAT||Vh(Lh.AreCannedQueriesEnabledForAvalon)&&r===fp.DESIGNER_INSERT_GRAPHIC)||jh("SingleShotAllowedContentOrigins","").split("@").includes(null!==(n=null==e?void 0:e.contentOrigin)&&void 0!==n?n:"")}function VA(e,t,n,r,o,i,a,s){return QA.apply(this,arguments)}function QA(){return QA=(0,gd._)((function(e,t,n,r,o,a,s,l){var c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee,te,ne,re,oe,ie,ae,se,le,ce,ue,de,pe,ge,me,fe,he,ve,ye,Ce,Se,be,Ee,Te,Ie,_e,we,Pe,xe,ke,Ae,Le,De,Oe,Ne,Re,Fe,Me,Be,Ue,He,Ge,ze,qe,We,je,Ve,Qe,Je,Ke,Xe,Ze,Ye,$e,et,tt,nt;return(0,F.__generator)(this,(function(rt){switch(rt.label){case 0:MP(e),p=!0,g=!1,m=void 0;try{for(f=SA[Symbol.iterator]();!(p=(h=f.next()).done);p=!0)v=h.value,YA(VE.getTypeName(),v.augloopResponseTime,!0,v.status)}catch(e){g=!0,m=e}finally{try{p||null==f.return||f.return()}finally{if(g)throw m}}return YA(VE.getTypeName(),(0,qp.WU)(qp.qD),!1,e.chatResponse.status),r||(null==Kk?void 0:Kk.length)||(Kk=e.conversationId),(null==Xk?void 0:Xk.length)||(Xk=e.sydneyEndpoint),y=null===(c=e.chatResponse.messages)||void 0===c?void 0:c.find((function(e){return $w(e)})),C=null===(u=e.chatResponse.messages)||void 0===u?void 0:u.find((function(e){return AP(e)})),S=RP(e),b=(null==C?void 0:C.contentOrigin)===fp.EDIT_DOCUMENT,E=NP(e),function(e){var t=null==e?void 0:e.contentOrigin;if(lw.getInstance().getSkillName()===mp.Unset&&t&&t.length)switch(t.toLowerCase()){case fp.APOLOGY:case fp.CANNED_RESPONSE:case fp.DEEPLEO_SYDNEY:return void lw.getInstance().setSkillName(mp.Sydney);case fp.BASIC_CHAT:return void lw.getInstance().setSkillName(mp.BasicChat);case fp.DESIGNER_INSERT_GRAPHIC:return void lw.getInstance().setSkillName(mp.Designer);case fp.TRANSFORM_CONTENT:return void lw.getInstance().setSkillName(mp.ContentTransform);case fp.SUMMARIZE:case fp.COPILOT_POWERPOINT_SUMMARY:return void lw.getInstance().setSkillName(mp.Summary);case fp.EDIT_DOCUMENT:return void lw.getInstance().setSkillName(mp.Commanding);case fp.SELF_HELP_SEARCH:return void lw.getInstance().setSkillName(mp.SelfHelp);case fp.SEARCH_DOC:return void lw.getInstance().setSkillName(mp.SearchDocument);case fp.PERSONALIZATION_START:case fp.PERSONALIZATION_EXPLAIN:case fp.PERSONALIZATION_UPDATE:case fp.PERSONALIZATION_END:lw.getInstance().setSkillName(mp.Personalization)}}(C),Kh()&&!Jh(Dh.IsASHATelemetryToBeLoggedAtStreamEndOnce)&&mA.getAshaErrorString()!=NC.Unset&&(T=qw(mA.getAshaVetoString(),mA.getAshaErrorString()),gA.logAshaErrorEvent(T.vetoName,T.errorString,T.featureName)),gA.sendLatencyTelemetry(HS((0,i._)({},sC.ContentOrigin,null!==(I=null==C?void 0:C.contentOrigin)&&void 0!==I?I:fp.UNKNOWN))),_=lw.getInstance().getSkillName(),xA.skill=_,Vh(Lh.UseDisengagedMessageType)&&FA?(kP(e.error,t,(0,gd._)((function(){return(0,F.__generator)(this,(function(e){return[2]}))})),!0,e.outputAnswerLanguage,a,s,FA),mb.getInstance().removeContextId(null==e?void 0:e.queryId),jE.getInstance().setState(Qd.IDLE),tL(),[2]):((y||S||_===mp.Designer||_===mp.Summary||_===mp.Sydney)&&(w={},(0,i._)(w,cC.ChatEventType,dC.QnAResponseReceivedFromSydney),(0,i._)(w,cC.ChatEventParameters,VE.getTypeName()),P=w,(null==e?void 0:e.queryId)&&(xA.queryId=e.queryId,P[cC.UserQueryGuid]=e.queryId),y||_===mp.Designer?(Zw(cP(P[cC.UserQueryGuid])),Yw(!0),P[cC.ChatEventType]=dC.DesignerGraphicsResponseReceivedFromSydney,P[sC.FeatureName]=Iv.DesignerVisuals,P[sC.SubFeatureName]=MC.AddDesignerImage):(S||_===mp.Summary)&&(P[cC.ChatEventType]=r?dC.SummaryResponseReceivedFromSkill:dC.SummaryResponseReceivedFromSydney),gA.sendChatEventTelemetry(HS(P))),k=null!==(x=null==e?void 0:e.chatMessageHeader)&&void 0!==x?x:void 0,A=zw(C,!0),L=null==C||null===(d=C.contentOrigin)||void 0===d?void 0:d.toLowerCase(),(_===mp.Sydney||OP(L)||L===fp.CANNED_RESPONSE)&&gA.logTriedEvent(A.featureName,A.subFeature,A.verb),Vh(Lh.IsPersonalizationUXEnabled)&&OP(L)&&(gA.sendLatencyTelemetry([{key:sC.PersonalizationResponseTime,value:(0,qp.WU)(gA.getQuerySubmitTime())},{key:sC.FeatureName,value:_C.Customize}]),fg()&&hg((new Date).getTime())),[4,KA(e)]);case 1:if(rt.sent(),ZR("Final message: ".concat(JSON.stringify(C)," and message id: ").concat(aA," and isSkillResponse ").concat(r)),C&&(Vh(Lh.IsDebugSectionV2Enabled)&&nL(e,qp.qD,C),gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.FinalValidMessageReceivedFromSydney},{key:cC.ChatEventParameters,value:"messageIds_".concat(C.messageId,", ").concat(aA,"; ContentOrigin: ").concat(null==C?void 0:C.contentOrigin)}]),fA=null!=fA?fA:void 0!==(null==C?void 0:C.error)||(null==C?void 0:C.resultType)===DE.ApologyResponseReturned),D=!1,O=!ZA(),N=!r||r&&O,aA||r)C&&!gP(C)&&!$w(C)&&(C.messageId===aA||b&&Jh(Dh.isODSLResponseCheckEnabled))?(ZR("Updating last rendered message with final message"),ge=CA.shouldShowInDocSensitivityLabel()?CA.getInDocSensitiveLabelInfo():void 0,XA(t,C,n,b,o,ge,N,s,a,l,k,e.comprehensionSummaryConfig,r)):Vh(Lh.IsMarkdownSummarizationEnabled)&&!r?(ZR("Stopping loading ui with last Sydney message after Skill final response"),null===(me=t.current)||void 0===me||me.updateLastMessage({chatCardType:jp._.MarkdownCard,stopLoadingUi:N,addCardToChatHistory:N,startAugloopTimerForStreaming:N})):D=!0;else if(M=null===(R=t.current)||void 0===R?void 0:R.getLastMessage(!1),B=null==M?void 0:M.body.user,ZR("Message Id does not exist, ChatUser: ".concat(B)),gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.LastChatMessageUserType},{key:cC.ChatEventParameters,value:"MessageUserType_".concat(B)}]),M&&B===ig.Q9.Chat){if(Vh(Lh.IsDebugSectionV2Enabled)&&(H=Cd({},xA),IA.push(H),l(),z=null!==(G=null===(U=M.actionBarButtons)||void 0===U?void 0:U.slice())&&void 0!==G?G:[],EL(z,H,s,a),M.actionBarButtons=z),fg()){V=null!==(j=null==M?void 0:M.messageType)&&void 0!==j?j:jp._.MarkdownCard,J=null!==(Q=null==M||null===(q=M.actionBarButtons)||void 0===q?void 0:q.slice())&&void 0!==Q?Q:[],K=!0,X=!1,Z=void 0;try{for(Y=J[Symbol.iterator]();!(K=($=Y.next()).done);K=!0)$.value.isDisabled=!1}catch(e){X=!0,Z=e}finally{try{K||null==Y.return||Y.return()}finally{if(X)throw Z}}null==t||null===(W=t.current)||void 0===W||W.updateLastMessage({chatCardType:V,chatMessageBodyData:{actionButtonList:Ed(wg(t)),feedbackData:NN(void 0,Pg())},stopLoadingUi:!0,addCardToChatHistory:!1})}if(bA.getIsWarningMessageActive()){if(ZR("Keep chat input disabled because warning message is active. Enable action buttons now that streaming is done."),ie=null===(re=t.current)||void 0===re?void 0:re.getLastMessage(),ae=null==ie?void 0:ie.warningActionButtons){le=!0,ce=!1,ue=void 0;try{for(de=ae[Symbol.iterator]();!(le=(pe=de.next()).done);le=!0)pe.value.isDisabled=!1}catch(e){ce=!0,ue=e}finally{try{le||null==de.return||de.return()}finally{if(ce)throw ue}}null==t||null===(se=t.current)||void 0===se||se.updateLastMessage({chatCardType:jp._.WarningMessage,chatMessageBodyData:{warningActionButtons:Ed(ae)},addCardToChatHistory:!1})}null==t||null===(oe=t.current)||void 0===oe||oe.updateLoadingComponentProps({shouldShowLoadingUi:!1}),bA.setWarningCardDisplayTimeInMs(),bA.setShouldAccountForWarningCardUserInteractionLatency(!0)}else uk||Vx?(ZR("Not stopping loading UI as waiting for Visual Summary from Summary Skill"),D=!0):(ne=null!==(te=null==M?void 0:M.messageType)&&void 0!==te?te:jp._.MarkdownCard,ZR("Stopping loading ui with last message"),null===(ee=t.current)||void 0===ee||ee.updateLastMessage({chatCardType:ne,stopLoadingUi:!0,addCardToChatHistory:!1}))}else D=!0;if(gA.sendLatencyTelemetry(HS((0,i._)({},sC.AnnotationType,VE.getTypeName()))),fe=fA?dC.ErrorResponseSignalSent:void 0,ve=D&&jA(C),ZR("Single shot response message: ".concat(ve,", checkContentOrigin: ").concat(D)),ve&&(null==C?void 0:C.text))ye=!1,$w(C)?!(be=null===(Ce=t.current)||void 0===Ce?void 0:Ce.getLastMessage(!1))||be.messageType===jp._.ChatCardWrapper&&(null===(Se=be.body.renderData)||void 0===Se?void 0:Se.component)===pp.DesignerCard||(tP(C,t),ye=!0):(Ee=BR(C),lL(C.text,t,C.messageId,N,!1,C.contentOrigin,Ee,r,k),ye=!0,XA(t,C,n,b,o,void 0,N,s,a,l,k,e.comprehensionSummaryConfig)),ye&&(Te=zw(C),gA.sendLatencyTelemetry(HS((_e={},(0,i._)(_e,sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),(0,i._)(_e,sC.FeatureName,Te.featureName),(0,i._)(_e,sC.SubFeatureName,null!==(Ie=Te.subFeature)&&void 0!==Ie?Ie:""),_e))));else if(Jh(Dh.ShouldRenderErrorResponseFromFinalAnnotation)){if(Pe=!0,null==e?void 0:e.error){xe="";try{De=(null==e||null===(ke=e.error)||void 0===ke?void 0:ke.json)?JSON.parse(null==e||null===(Ae=e.error)||void 0===Ae?void 0:Ae.json):void 0,xe=(null!==(Oe=null==e||null===(Le=e.error)||void 0===Le?void 0:Le.category)&&void 0!==Oe?Oe:"")+"_"+(De?De.code:"")}catch(e){ZR("failed to parse error object on the Final Message"),gA.sendErrorTelemetry(HS((Ne={},(0,i._)(Ne,uC.ErrorMessage,"failed to parse error object on the Final Message"),(0,i._)(Ne,uC.ErrorCategory,IC.FluxCopilot),Ne)))}(null==xe?void 0:xe.includes("insert_graphic"))?(Re=uP(xe),Fe=Re.designerVisualsErrorResultType,Me=Re.designerVisualsASHAErrorDetails,fe=Fe,he=Me):(gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.UnexpectedErrorObjectReceived},{key:cC.ChatEventParameters,value:xe}]),Jh(Dh.IsASHATelemetryToBeLoggedAtStreamEndOnce)?mA.getAshaErrorString()==NC.Unset&&(mA.setAshaErrorString(NC.UnclassifiedIssue),mA.setAshaVetoString(AC.UnclassifiedAshaError)):he=qw(AC.UnclassifiedAshaError,NC.UnclassifiedIssue)),Pe=!1}else(null==C?void 0:C.offense)&&C.offense!==XE.None&&C.offense!==XE.Unknown&&(dL(C.offense),fe=dC.RaiErrorMessage,Pe=!1);(Be=null===(we=t.current)||void 0===we?void 0:we.getLastMessage(!1))&&Be.body.user===ig.Q9.Human&&(gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.ContentOriginUnhandled},{key:cC.ChatEventParameters,value:null!==(Ue=null==C?void 0:C.contentOrigin)&&void 0!==Ue?Ue:fp.UNKNOWN}]),gA.sendLatencyTelemetry(HS((0,i._)({},sC.UserQueryGuid,null==e?void 0:e.queryId))),ZR("No chat message has been rendered. Rendering error response from final annotation if any."),He=zw(C,!0),Ge={featureName:He.featureName,subFeatureName:He.subFeature},(null==C?void 0:C.text)?lL(C.text,t,C.messageId,N,N,C.contentOrigin,Ge,r,k):(qe={errorMessage:PowerpointCopilotStrings.ServerErrorMessage,errorType:yp.PowerPointALServerError,featureName:He.featureName,subFeatureName:He.subFeature},gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.FinalMessageTextNotFound},{key:cC.ChatErrorKey,value:pC.ServerErrorMessage}]),null===(ze=t.current)||void 0===ze||ze.addResponseMessage(TL(PowerpointCopilotStrings.ServerErrorMessage,hL,N,Wd.CHATPPT,void 0,!1,N,void 0,qe))),gA.sendLatencyTelemetry(HS((je={},(0,i._)(je,sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),(0,i._)(je,sC.FeatureName,He.featureName),(0,i._)(je,sC.SubFeatureName,null!==(We=He.subFeature)&&void 0!==We?We:""),je))),fA=!0,Pe&&(Jh(Dh.IsASHATelemetryToBeLoggedAtStreamEndOnce)?mA.getAshaErrorString()==NC.Unset&&(mA.setAshaErrorString(NC.NoResponseFromSydney),mA.setAshaVetoString(AC.UnclassifiedAshaError)):he=qw(AC.UnclassifiedAshaError,NC.NoResponseFromSydney),fe=dC.NoChatResponseRenderedFromSydney))}return Ve=void 0!==fe||!hA&&!S&&!E&&!fg(),r?BS(gA,qp.qD,Vh(Lh.IsVisualSummarizationEnabled)&&DA?sC.VisualSummaryResponseTime:sC.SummaryResponseTime,sC.SummaryChunkInfo,SA,IC.Summary,void 0,void 0,void 0,N):(Jh(Dh.IsASHATelemetryToBeLoggedAtStreamEndOnce)&&mA.getAshaErrorString()!=NC.Unset&&(he=qw(mA.getAshaVetoString(),mA.getAshaErrorString())),BS(gA,qp.qD,sC.SydneyResponseTime,sC.SydneyChunkInfoJson,SA,IC.FluxCopilot,fe,void 0,fA?ep.Client:void 0,!uk&&!Vx&&!bA.getIsWarningMessageActive()&&!fg()&&N,Ve,he)),fA=!1,fe=void 0,r&&(gA.sendChatEventTelemetry(HS((Qe={},(0,i._)(Qe,cC.IsFromCache,LA),(0,i._)(Qe,cC.IsVisual,DA),(0,i._)(Qe,cC.IsAnalyzingVisual,OA),Qe))),gA.sendLatencyTelemetry(HS((0,i._)({},sC.IsFromCache,LA))),uA&&(gA.logTriedEvent(Iv.Summarize,Yx(AA),yE.RX.Summarize),uA=!1,Vh(Lh.IsNotificationEnabledForSummary)&&Rk(mA.getUserQueryGuid(),{messageID:null==C?void 0:C.messageId}))),N&&Vh(Lh.IsNotificationEnabledForSummary)&&(Rk(mA.getUserQueryGuid(),{startShowingNotification:!0}),tA(mA.getUserQueryGuid())?(Ze=qk.updateActiveCardForInProgressNotification(mA.getUserQueryGuid(),t,null!==(Xe=null===(Ke=Mk(mA.getUserQueryGuid()))||void 0===Ke||null===(Je=Ke.NotificationAnnotation)||void 0===Je?void 0:Je.previewMessage)&&void 0!==Xe?Xe:Cp.THUMBNAILS_DOWNLOADED,!0),Rk(mA.getUserQueryGuid(),{timerId:Ze})):nA(mA.getUserQueryGuid())&&qk.updateActiveCardForCompleteNotification(mA.getUserQueryGuid(),t,void 0,!0)),ZR("Final Annotation : isAnalyzingForVisualSummary: ".concat(uk,", isAnalyzingForVisualSummaryNonStreaming : ").concat(Vx," ,stopLoadingUI: ").concat(N)),uk||Vx||!N?r||(et=null===(Ye=t.current)||void 0===Ye?void 0:Ye.getLastMessage(!1),null===($e=t.current)||void 0===$e||$e.updateLastMessage({chatCardType:null!==(tt=null==et?void 0:et.messageType)&&void 0!==tt?tt:jp._.Default,startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:TE.getTypeName(),stopLoadingUi:!1,addCardToChatHistory:!1})):(mb.getInstance().removeContextId(null==e?void 0:e.queryId),jE.getInstance().setState(Qd.IDLE),tL()),Jh(Dh.ShowLoadingMessagesFromSydney)&&(null===(nt=t.current)||void 0===nt||nt.updateLoadingComponentProps({loadingUiStringList:Gx().get(Hd.Default)})),[2]}}))})),QA.apply(this,arguments)}function JA(){return JA=(0,gd._)((function(e,t,n,r,o,a){var s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K,X,Z,Y,$,ee,te,ne,re,oe,ie,ae;return(0,F.__generator)(this,(function(F){if(s=e.chatResponse.basinCursor,l=e.chatResponse.basinWrite,c=e.chatResponse.messagesToAddOrReplace,u=e.chatResponse.messagesToDelete,d=e.chatResponse.messagesToUpdate,g=null!==(p=e.chatMessageHeader)&&void 0!==p?p:void 0,!cF(u)){m=!0,f=!1,h=void 0;try{for(v=u[Symbol.iterator]();!(m=(y=v.next()).done);m=!0)C=y.value,ZR("Deleting message id: ",C),null===(S=t.current)||void 0===S||S.deleteMessage({chatCardType:jp._.MarkdownCard,messageIdToDelete:C}),delete oA.items[C]}catch(e){f=!0,h=e}finally{try{m||null==v.return||v.return()}finally{if(f)throw h}}}if(cF(s)||(b=JSON.parse(s),ZR("Setting basin cursor: ",b),oA.setCursor(b)),!cF(c)&&c.length>0){E=!0,T=!1,I=void 0;try{for(_=c[Symbol.iterator]();!(E=(w=_.next()).done);E=!0){if(P=w.value,Vh(Lh.UseDisengagedMessageType)&&(LP(P)||FA))return FA=!0,[2];AP(P)?(P.messageId!==aA?(cA&&(A=n?(0,i._)({},sC.FeatureName,_C.BasicChat):{},gA.sendLatencyTelemetry(HS(Cd((0,i._)({},sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),A))),P.contentOrigin==fp.DESIGNER_INSERT_GRAPHIC&&lw.getInstance().setSkillName(mp.Designer),cA=!1),r&&uA&&(ZR("Summary Skill First chunk received"),gA.logTriedEvent(Iv.Summarize,Yx(AA),yE.RX.Summarize),Vh(Lh.IsNotificationEnabledForSummary)&&Rk(mA.getUserQueryGuid(),{messageID:null==P?void 0:P.messageId}),lw.getInstance().setSkillName(mp.Summary),Jh(Dh.IsScenarioErrorTelemetryEnabled)&&mA.setScenarioName(Cv.Summary),gA.sendLatencyTelemetry(HS((L={},(0,i._)(L,sC.UserPerceivedLatency,(0,qp.WU)(qp.qD)),(0,i._)(L,sC.AnnotationType,VE.getTypeName()),(0,i._)(L,sC.FeatureName,_C.Summary),L))),D={featureName:_C.Summary,subFeatureName:SR(AA)&&DA?MC.VisualSummary:MC.Summarize},AA!==hE.SegmentedSummary&&AA!==hE.StyledSummary||(D.subFeatureName=AA===hE.SegmentedSummary?MC.SegmentedSummary:MC.StyledSummary,N=Sd(Cd({},D),{errorMessage:PowerpointCopilotStrings.UnsupportedSummaryError,errorType:yp.SummaryUnsupportedSummaryError}),null===(O=t.current)||void 0===O||O.addResponseMessage(TL(PowerpointCopilotStrings.UnsupportedSummaryError,mL,!1,Wd.DECKSUMMARY,void 0,!1,!0,void 0,N))),o>Ow()&&(M=Sd(Cd({},D),{errorMessage:PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",Ow().toString()),errorType:yp.TooLargeContentToSummarizeError}),null===(R=t.current)||void 0===R||R.addResponseMessage(TL(PowerpointCopilotStrings.TooLargeContentToSummarizeError.replace("%s",Ow().toString()),mL,!1,Wd.DECKSUMMARY,void 0,!1,!0,void 0,M)),gA.sendErrorTelemetry(HS((B={},(0,i._)(B,uC.ErrorMessage,"Word Count does not meet max bar requirement"),(0,i._)(B,uC.ErrorCategory,IC.Summary),B))),gA.sendChatEventTelemetry(HS((U={},(0,i._)(U,cC.ChatEventType,dC.MoreWordCount),(0,i._)(U,cC.ChatEventParameters,"WordCountError"),(0,i._)(U,cC.ChatErrorKey,pC.DeckTooLargeToSummarizeError),U)))),H=WA(P),ZR("Full text: ",H),lL(H||P.text,t,P.messageId,!1,!0,fp.COPILOT_POWERPOINT_SUMMARY,D,r,g)),aA=P.messageId,gA.sendChatEventTelemetry(HS((G={},(0,i._)(G,cC.ChatEventType,dC.FirstChunkReceivedFromSydney),(0,i._)(G,cC.ChatEventParameters,aA),G))),$w(P)?tP(P,t):gP(P)?mP(P,t):(r&&!uA||!r)&&(z=WA(P),ZR("Full text: ",z),lL(z||P.text,t,P.messageId,void 0,void 0,void 0,void 0,void 0,g)),r&&(uA=!1)):$w(P)?(ZR("Duplicate message id received for Designer response"),gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.DesignerDuplicateResponse}])):(ZR("Adding Response Card for messagesToAddOrReplace:",P),q=WA(P),ZR("Full text: ",q),W=P.sourceAttributions,EA=W?aL(W):[],TA=W?aL(W,!0):[],j=Vh(Lh.IsMsgExtEnabled)?ch(P.sourceAttributions,a,Jh(Dh.IsHideSingleCitationEnabled)):void 0,V=Vh(Lh.IsApiPluginsCardsEnabled)?uh(P.sourceAttributions,a,Jh(Dh.IsHideSingleCitationEnabled)):void 0,r?(Q={featureName:_C.Summary,subFeatureName:SR(AA)&&DA?MC.VisualSummary:MC.Summarize},uL(q||P.text,t,{references:EA,annotationReferences:TA,msgExtCardProps:1===(null==j?void 0:j.attributions.length)?void 0:j,apiPluginCardProps:1===(null==V?void 0:V.attributions.length)?void 0:V,messageAttributionProps:RL(P)},!0,r,Q,g)):uL(q||P.text,t,{references:EA,annotationReferences:TA,msgExtCardProps:1===(null==j?void 0:j.attributions.length)?void 0:j,apiPluginCardProps:1===(null==V?void 0:V.attributions.length)?void 0:V,messageAttributionProps:RL(P)},!0,void 0,void 0,g)),dL(P.offense),oA.items[P.messageId]=P):Jh(Dh.ShowLoadingMessagesFromSydney)&&FP(P)?null===(J=t.current)||void 0===J||J.updateLoadingComponentProps({loadingUiStringList:[P.text]}):ph(P)?RA=dh(P):(null===(x=P.authErrors)||void 0===x?void 0:x.length)&&(null===(k=P.authErrors)||void 0===k?void 0:k[0])&&(NA=P.authErrors[0],ZR("Plugin Auth Error received"),Jh(Dh.IsMsgExtTelemetryEnabled)&&ob.getInstance().sendErrorTelemetry(HS((K={},(0,i._)(K,uC.ErrorCategory,IC.Error),(0,i._)(K,uC.ErrorMessage,"Plugin Auth Error Received"),K))))}}catch(e){T=!0,I=e}finally{try{E||null==_.return||_.return()}finally{if(T)throw I}}}if(cF(l)||FA||(X=JSON.parse(l),ZR("Basin write received: ",X),oA.write(X),Z=WA(oA.items[aA]),ZR("Full text from Adaptive Card: ",Z),uL(Z||X,t,{references:EA,annotationReferences:TA},!0,void 0,void 0,g)),!cF(d)&&d.length>0){Y=!0,$=!1,ee=void 0;try{for(te=d[Symbol.iterator]();!(Y=(ne=te.next()).done);Y=!0){if(re=ne.value,Vh(Lh.UseDisengagedMessageType)&&(LP(re)||FA))return FA=!0,[2];aA=uF(aA)||cF(aA)?re.messageId:aA,oe=re.sourceAttributions,EA=oe?aL(oe):[],TA=oe?aL(oe,!0):[],ie=Vh(Lh.IsMsgExtEnabled)?ch(re.sourceAttributions,a,Jh(Dh.IsHideSingleCitationEnabled)):void 0,ae=Vh(Lh.IsApiPluginsCardsEnabled)?uh(re.sourceAttributions,a,Jh(Dh.IsHideSingleCitationEnabled)):void 0,re.messageId===aA&&uL(re.appendText,t,{references:EA,annotationReferences:TA,msgExtCardProps:1===(null==ie?void 0:ie.attributions.length)?void 0:ie,apiPluginCardProps:1===(null==ae?void 0:ae.attributions.length)?void 0:ae,messageAttributionProps:RL(re)},void 0,r,void 0,g)}}catch(e){$=!0,ee=e}finally{try{Y||null==te.return||te.return()}finally{if($)throw ee}}}return[2]}))})),JA.apply(this,arguments)}var KA=function(){var e=(0,gd._)((function(e){var t,n,r,o,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:if(!(t=LS()&&Jh(Dh.IsClpEnabledInEnterpriseForSydney)?e.chatResponse.conversationSensitivityLabel:void 0))return ZR("conversationSensitivityLabel is undefined or not applicable"),LS()&&gA.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ConversationSensitivityLabelNotFound))),[2];if(ZR("Enterprise search"),Jh(Dh.UseNewCopilotSharedPackage)?!1:RS=!1,n={labelId:t.id,tenantId:"",encryptionType:t.isEncrypted?Tp.IRMTemplate:Tp.None,displayName:t.displayName,description:t.tooltip,color:t.color,order:t.priority},!t.labelId&&!CA.shouldShowInDocSensitivityLabel())return[3,7];l.label=1;case 1:return l.trys.push([1,6,,7]),[4,CA.getHighestDocumentSensitivityInfo([CA.getInDocSensitiveLabelInfo(),n])];case 2:return r=l.sent(),[4,CA.getInDocSensitiveLabelUsingOfcJs()];case 3:return o=l.sent(),r.isDke=o.isDke,r.hasExtractForUser=o.hasExtractForUser,ZR("Enterprise search: setting sensitivity to "+r),CA.setInDocSensitivityLabelInfo(r),yA?(ZR("Handling end of stream. Odsl executed successfully and and odsl program is insertion scenario, updating document sensitivity"),[4,CA.upgradeSensitivityLabelUsingOfcJs(CA.getInDocSensitiveLabelInfo())]):[3,5];case 4:l.sent(),l.label=5;case 5:return[3,7];case 6:return a=l.sent(),ZR("Enterprise search: Office JS sensitivity api failed: "+a.message),gA.sendErrorTelemetry(HS((s={},(0,i._)(s,uC.ErrorMessage,"Exception while calling Office JS sensitivity api in Flux Copilot Workflow: "+a.message),(0,i._)(s,uC.ErrorCategory,IC.OfficeJsApi),s))),[3,7];case 7:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),XA=function(e,t,n,r,o,a){var s,l,c=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0,p=arguments.length>9?arguments[9]:void 0,g=arguments.length>10&&void 0!==arguments[10]?arguments[10]:void 0,m=arguments.length>11&&void 0!==arguments[11]?arguments[11]:void 0,f=arguments.length>12&&void 0!==arguments[12]&&arguments[12],h=a?a.displayName:void 0;if(pA.clear(),EA=[],TA=[],Jh(Dh.IsCitationsEnabled))if((t.citations||[]).length>0){var v=t.citations,y=!0,C=!1,S=void 0;try{for(var b,E=v[Symbol.iterator]();!(y=(b=E.next()).done);y=!0){var T=b.value;EA.push(rL(T,h))}}catch(e){C=!0,S=e}finally{try{y||null==E.return||E.return()}finally{if(C)throw S}}}else(t.sourceAttributions||[]).length>0&&(EA=aL(t.sourceAttributions),TA=aL(t.sourceAttributions,!0));var I=!(r||RA)?CL():[];try{if(!r&&Vh(Lh.IsCopilotPlayKeySlidesEnabled)&&(null==m?void 0:m.intent)===hE.ImportantSlides){var _,w=SL(null==t?void 0:t.hiddenText);if(w)I.push(w),gA.sendChatEventTelemetry(HS((_={},(0,i._)(_,cC.ChatEventType,dC.PlayKeySlidesButtonAdded),(0,i._)(_,cC.ChatEventParameters,JSON.stringify({handler:"PowerpointFluxCopilotAnnotationHandler"})),_)))}}catch(e){var P;ZR("Failed to add PlayKeySlides button: "+(null==e?void 0:e.message)),gA.sendErrorTelemetry(HS((P={},(0,i._)(P,uC.ErrorMessage,"Exception while adding PlayKeySlides button from Powerpoint flux: "+(null==e?void 0:e.message)),(0,i._)(P,uC.ErrorCategory,IC.PlayKeySlides),P)))}if(Vh(Lh.IsDebugSectionV2Enabled)){var x=Cd({},xA);IA.push(x),p(),EL(I,x,u,d)}var k=Vh(Lh.IsMsgExtEnabled)?ch(t.sourceAttributions,o,Jh(Dh.IsHideSingleCitationEnabled),!0):void 0,A=Vh(Lh.IsApiPluginsCardsEnabled)?uh(t.sourceAttributions,o,Jh(Dh.IsHideSingleCitationEnabled),!0):void 0,L=Vh(Lh.EnableAnchorTagOverrideForKeySlides)&&(null==m?void 0:m.intent)===hE.ImportantSlides&&!r;try{var D;if((null==m?void 0:m.intent)===hE.ImportantSlides)gA.sendChatEventTelemetry(HS((D={},(0,i._)(D,cC.ChatEventType,dC.ClickableKeySlidesEnabled),(0,i._)(D,cC.ChatEventParameters,JSON.stringify({isClickableKeySlidesEnabled:L,anchorTagOverrideEnabled:Vh(Lh.EnableAnchorTagOverrideForKeySlides)})),D)))}catch(e){var O;gA.sendErrorTelemetry(HS((O={},(0,i._)(O,uC.ErrorMessage,$B),(0,i._)(O,uC.ErrorCategory,IC.ClickableKeySlides),(0,i._)(O,sC.ErrorType,ep.Client),O)))}null===(l=e.current)||void 0===l||l.updateLastMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:t.text,disableLinksProcessing:(null===(s=t.contentOrigin)||void 0===s?void 0:s.toLowerCase())===fp.CANNED_RESPONSE,componentsOverride:L?{a:function(e){e.node;var n=pE(e,["node"]);return rA(n,gA,null==t?void 0:t.hiddenText)}}:void 0,stringReplacementAnchorComponentOverride:L&&Jh(Dh.IsStringReplacementAnchorTagOverrideEnabled)?PowerpointCopilotStrings.SlideN:void 0}},chatMessageBodyData:Sd(Cd({},mL),{telemetryData:f?RN(Iv.Summarize,SR(AA)&&DA?MC.VisualSummary:MC.Summarize):RN(Iv.CopilotChat),actionButtonList:I,references:EA,annotationReferences:TA,clpSensitivityIndicatorData:a?ML():void 0,msgExtCardProps:k,apiPluginCardProps:A,confirmationCardProps:RA,pluginAuthError:NA,chatMessageHeaderData:OL(g),messageAttributionProps:RL(t)}),stopLoadingUi:c,addCardToChatHistory:c});var N=t.suggestedResponses;if(iA&&N&&N.length>0){var R=function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;"Suggestion"===s.messageType&&t.push(s.text)}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}(N);ZR("updating suggestion pills from Powerpoint Flux Copilot. Suggestions received in response: "+R),n(R,MC.Sydney)}},ZA=function(){return lA},YA=function(e,t,n,r){var o={annotationType:e,isStreamingAnnotation:n,responseTime:t,status:r};wA.push(o)},$A=function(){return IA},eL=function(e){PA.push(e)},tL=function(){oA=new vE.Basin,iA=!0,lA=!1,Zk=!1,aA="",sA="",dA=!0,cA=!0,uA=!0,fA=!1,hA=!1,vA=!1,yA=!1,SA=[],lw.getInstance().resetData(),EA=[],AA=hE.Unknown,DA=!1,LA=!1,NA=void 0,RA=void 0,wA=[],PA=[],xA={},FA=!1},nL=function(e,t,n,r,o){var i,a,s,l,c,u,d;(o?xA.skill=mp.Summary:xA.skill||(xA.skill=mp.Sydney),kA)||(kA=null===(l=e.chatResponse)||void 0===l?void 0:l.sessionKey);if(xA.sessionId=kA,xA.status=null!==(c=null===(i=e.chatResponse)||void 0===i?void 0:i.status)&&void 0!==c?c:e.status,xA.queryId=null!==(u=xA.queryId)&&void 0!==u?u:e.queryId,xA.timestamp=e.timestamp,r)YA(VE.getTypeName(),(0,qp.WU)(t),!1,e.status),xA.messageType=null!==(d=xA.messageType)&&void 0!==d?d:"null",xA.error=e.error,xA.FCFR=(0,qp.WU)(t),xA.LCFR=(0,qp.WU)(t);else if(n){var p,g,m;xA.queryId=null!==(g=xA.queryId)&&void 0!==g?g:n.queryId,xA.messageType=n.messageType,xA.LCFR=(0,qp.WU)(t),xA.FCFR=null!==(m=xA.FCFR)&&void 0!==m?m:xA.LCFR,xA.timestamp=n.timestamp,xA.sensitivity=null===(p=n.sensitivityLabel)||void 0===p?void 0:p.displayName,xA.groundingDataCount=n.groundingDataCount}xA.resultType=null===(a=e.chatResponse)||void 0===a?void 0:a.resultType,xA.optionSets=null===(s=e.chatResponse)||void 0===s?void 0:s.optionsSets,xA.annotationResponses=wA,xA.signals=PA},rL=function(e,t){var n;return pA.set(e.contentIndex,e.path),{referenceIndex:e.contentIndex,referenceProps:{title:null!==(n=oL(e.content))&&void 0!==n?n:rM,primarySubtitle:lM(),snippet:QN(e.content),referenceType:uf._2.Internal,iconAppName:e.type,citationPosition:e.position,onClickCitationLink:iL,path:e.path,sensitivityLabel:t}}},oL=function(e){return e?'"'+(e.length>18?e.slice(0,18).trim():e)+oM+'"':null},iL=function(){var e=(0,gd._)((function(e,t,n){var r,o;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return t=null!=t?t:pA.get(e),n&&(r=vR(n),o=r.correlationId,r.featureName,void 0!==o&&gA.setQueryGuid(o)),gA.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CitationClicked))),n&&gA.setQueryGuid(""),[4,jN(null!=t?t:[])];case 1:return a.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),aL=function(e,t){return e.filter((function(e){return t?e.sourceType===iM:e.sourceType!==iM})).map((function(e,t){var n,r,o=void 0;e.referenceMetadata&&(o=JSON.parse(e.referenceMetadata));var i,a,s,l,c,u,d=function(e,t,n){return Vh(Lh.IsCitationSupportForAvalonEnabled)?(null==n?void 0:n.path)?uf._2.Internal:e===PE.Web||void 0===e?uf._2.External:void 0!==e&&Object.values(uf._R).includes(e)?uf._2.CrossApp:uf._2.External:void 0===t?uf._2.External:(null==n?void 0:n.path)&&!(null==n?void 0:n.seeMoreUrl)?uf._2.Internal:BP.has(t)?uf._2.CrossApp:uf._2.External}(null==o?void 0:o.type,null==o?void 0:o.referenceType,e),p=d===uf._2.Internal?oL(null!==(i=null==o?void 0:o.snippet)&&void 0!==i?i:""):null!==(a=oL(e.providerDisplayName))&&void 0!==a?a:d,g=d===uf._2.Internal?lM():null!==(s=null==o?void 0:o.typeDescription)&&void 0!==s?s:rM,m=null==o||null===(n=o.iconUrl)||void 0===n?void 0:n.replace(/\/$/,""),f=function(e){return e.sourceType===iM?uf.GH.Annotation:uf.GH.Citation}(e);return{referenceIndex:t+1,referenceProps:{title:p,primarySubtitle:g,secondarySubtitle:null!==(l=null==o?void 0:o.context)&&void 0!==l?l:sL(e),snippet:(u=null!==(c=null==o?void 0:o.snippet)&&void 0!==c?c:rM,u.length>150?u.substring(0,150)+'..."':u),referenceType:d,iconAppName:d===uf._2.CrossApp||d===uf._2.Internal?Vh(Lh.IsCitationSupportForAvalonEnabled)?HP(null==o?void 0:o.type):UP(null==o?void 0:o.referenceType):void 0,url:sL(e),path:[e.path],onClickCitationLink:iL,sensitivityLabel:Jh(Dh.IsClpEnabledInEnterpriseForSydney)?null==o||null===(r=o.sensitivityLabel)||void 0===r?void 0:r.displayName:void 0,iconUrl:m,linkType:f},isFlux:!0}}))};function sL(e){return Vh(Lh.IsCitationSupportForAvalonEnabled)?cF(e.path)?e.seeMoreUrl:void 0:cF(e.seeMoreUrl)?void 0:e.seeMoreUrl}function lL(e,t,n,r,o,a,s,l){var c,u,d,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0;cF(e)?(ZR("Returning as message is empty"),l?gA.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.EmptyMessageReceivedFromSummarySkill),(0,i._)(u,cC.ChatEventParameters,"Empty Markdown message card"),u))):gA.sendChatEventTelemetry(HS((d={},(0,i._)(d,cC.ChatEventType,dC.EmptyMessageReceivedFromSydney),(0,i._)(d,cC.ChatEventParameters,"Empty Markdown message card"),d)))):(sA=e,null===(c=t.current)||void 0===c||c.addResponseMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:sA,disableLinksProcessing:(null==a?void 0:a.toLowerCase())===fp.CANNED_RESPONSE}},chatMessageBodyData:{actionButtonList:fg()?mg():[],shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:l&&CA.shouldShowInDocSensitivityLabel()?ML():void 0,feedbackSectionPosition:$a.Footer,feedbackData:NN(Wd.CHATPPT,s),telemetryData:cL(a,s,l),showAnimation:!0,isFailure:!1,messageId:n,chatMessageHeaderData:OL(p)},stopLoadingUi:!!r,startAugloopTimerForStreaming:null==o||o,workflowAnnotationTypeForAugloopTimer:VE.getTypeName(),addCardToChatHistory:!1}))}function cL(e,t,n){return n?RN(Iv.Summarize,SR(AA)&&DA?MC.VisualSummary:MC.Summarize):e===fp.IMAGE_CHAT&&(null==t?void 0:t.featureName)===Iv.AddContent?RN(Iv.AddContent,t.subFeatureName):RN(Iv.CopilotChat)}function uL(e,t,n,r,o,a){var s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;if(cF(e))ZR("Returning as message is undefined");else{var c,u,d,p=e;if(p=p.replace("\\n","\n"),sA=r?p:sA+p,((null==n?void 0:n.references)||[]).length>0)gA.sendChatEventTelemetry(HS((d={},(0,i._)(d,cC.ChatEventType,dC.CitationReceived),(0,i._)(d,cC.ChatEventParameters,null!==(u=null==n||null===(c=n.references)||void 0===c?void 0:c.length)&&void 0!==u?u:0),d)));null===(s=t.current)||void 0===s||s.updateLastMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:sA}},chatMessageBodyData:Sd(Cd({},n),{chatMessageHeaderData:OL(l),actionButtonList:fg()?mg():[],feedbackData:o?NN(Wd.DECKSUMMARY,a):void 0,telemetryData:o?RN(Iv.Summarize,SR(AA)&&DA?MC.VisualSummary:MC.Summarize):RN(Iv.CopilotChat)}),startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:VE.getTypeName(),stopLoadingUi:!1,addCardToChatHistory:!1})}}var dL=function(e){if(e!==XE.None&&e!==XE.Unknown){gA.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.RaiErrorMessage},{key:cC.ChatEventParameters,value:e}]);var t=qw(AC.RAIError,NC.OffensiveContentError);gA.logAshaErrorEvent(t.vetoName,t.errorString,t.featureName)}};function pL(e,t){SA.push({augloopResponseTime:(0,qp.WU)(qp.qD),isSkillResponse:e,status:t})}var gL=ob.getInstance(),mL={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:ag.O.Footer,showAnimation:!0,isFailure:!1},fL={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.Footer,showAnimation:!0,isFailure:!1},hL={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.Footer,showAnimation:!1,isFailure:!0},vL={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.None,showAnimation:!1,isFailure:!0},yL={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:ag.O.None,showAnimation:!1},CL=function(){return[{type:og.j.Default,title:FM(),text:pd()?void 0:FM(),iconRegular:pd()?ug.c2D:ug.Jg_,iconHover:pd()?ug.cAv:ug.Z1B,position:pd()?og.S.FeedbackSection:og.S.ActionButtonBar,popoverProps:{popoverTitle:MM()},handleButtonOnClick:ON}]},SL=function(e){try{if(_p.GetHostAppPlatform()!==CM&&!Office.context.requirements.isSetSupported(kB,LB))throw new Error("CopilotAction viewAction API v".concat(LB," is not supported"));var t=[];if(void 0===e)throw new Error("Hidden text not found");if(0===e.length)throw new Error("Hidden text is empty");if(JSON.parse(e).forEach((function(e){if(void 0===(null==e?void 0:e.mappedId))throw new Error("Key slide id not found");var n=NL(e.mappedId);if(null===n||2!==n.length)throw new Error("Key slide id is not in the correct format");t.push({sid:n[0],cid:n[1]})})),t.length>0)return{type:og.j.Default,title:BM(),text:pd()?void 0:BM(),iconRegular:pd()?nE.V$h:nE.M1N,iconHover:pd()?nE.lwq:nE.yGi,position:pd()?og.S.FeedbackSection:og.S.ActionButtonBar,handleButtonOnClick:function(e){VN(t)}};throw new Error("Key slides is empty")}catch(e){var n;Gp("Error parsing key slides",e),gL.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"Error in getViewActionKeySlidesButton method: ".concat(null==e?void 0:e.message)),(0,i._)(n,uC.ErrorCategory,IC.PlayKeySlides),n)))}},bL=function(e,t,n){var r=[{type:og.j.Default,title:AF,text:AF,tooltip:AF,handleButtonOnClick:function(){t(!0),n(e)}},{type:og.j.Default,title:LF,tooltip:LF,iconRegular:rE.gip,iconHover:rE.gip,handleButtonOnClick:function(){window.open("https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[PowerPoint+Copilot]:&[System.Description]="+function(e){var t,n=$A().length>0&&$A()[0].optionSets?$A()[0].optionSets:[],r="<ul> <li><strong>SessionId:</strong> "+e.sessionId+"</li><li><strong>AL inspector link:</strong> https://web.augloop-tools.officeppe.com/inspector/"+e.sessionId+"</li><li><strong>appName:</strong> Powerpoint </li>"+"<li><strong>appPlatform:</strong> ".concat((0,oE.xp)(),"</li>")+"<li><strong>sdxVersion: </strong>"+vF()+"</li><li><strong>optionSets: </strong>"+n+"</li></ul>",o=r+"<br/> Please upload console and sydney logs from debug panel<br/><br/>";return o+="<strong>Skill Name:</strong> ".concat(null!==(t=e.skill)&&void 0!==t?t:"Sydney"," <br/> <strong>Error:</strong> ").concat(JSON.stringify(e.error)," <br/> <strong>FCFR:</strong> ").concat(e.FCFR," <br/> <strong>LCFR:</strong> ").concat(e.LCFR),o}(e)+"&[System.Area]=OCOffice+AI+ExpChat&[System.Tags]=UserFeedback","_blank")}}];return Vh(Lh.IsDebugSectionV2Enabled)&&e?r:void 0};var EL=function(e,t,n,r){var o=!0,i=!1,a=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;if(c.title===AF||c.title===LF)return}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}var u,d=bL(t,n,r);d&&(null==e||(u=e).push.apply(u,Ed(d)))},TL=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Wd.CHATPPT,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;return void 0!==t&&(t=Sd(Cd({},t),{feedbackData:NN(r,l),telemetryData:RN(o,s)})),{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:t,stopLoadingUi:n,startAugloopTimerForStreaming:i,addCardToChatHistory:a}},IL=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return void 0!==t&&(t=Sd(Cd({},t),{feedbackData:NN(Wd.CHATPPT,r)})),{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Human,messageHeader:{text:e}}},chatMessageBodyData:t,stopLoadingUi:n}},_L=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Wd.CHATPPT,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;return void 0!==r&&(r=Sd(Cd({},r),{feedbackData:NN(i,l),telemetryData:RN(a,s)})),{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:e.linkPrefix,linkText:{text:e.linkText,linkOnClick:t,linkUrl:n,linkSuffix:e.linkSuffix}}}},chatMessageBodyData:r,stopLoadingUi:o}},wL=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5?arguments[5]:void 0;if(Jh(Dh.ErrorMessageInAIContextEnabledPPT)&&void 0!==hL){var a,s=NN(Wd.CHATPPT,i);if(s.contextData&&s.contextData.cardMetaData){var l=JSON.parse(s.contextData.cardMetaData);if(l){var c=Sd(Cd({},l),{errorMessage:t,errorType:null==i?void 0:i.errorType,featureName:null==i?void 0:i.featureName,entryPoint:"".concat(oN.Chat)});s.contextData.cardMetaData=JSON.stringify(c)}}var u=Sd(Cd({},hL),{feedbackData:s,telemetryData:RN(n,r)}),d={chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:t}}},chatMessageBodyData:u,stopLoadingUi:o,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0};null===(a=e.current)||void 0===a||a.addResponseMessage(d)}else{var p;null===(p=e.current)||void 0===p||p.addResponseMessage(TL(t,hL,o,void 0,n,!1,!0,r,i))}},PL=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=Jh(Dh.ShouldEnableCommandingErrorCard)&&dE(),o=t?hL:vL,a=r?function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;return gL.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CommandingErrorCardLoaded))),e=void 0!==e?Sd(Cd({},e),{pillsList:iE(),feedbackData:NN(n?Wd.CHATPPT:void 0,r),telemetryData:RN(sb.getInstance().getFeatureName(),MC.Unset)}):{pillsList:iE()},{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:fm()?PowerpointCopilotStrings.HVCV2CommandingErrorCardMessage:TB}}},chatMessageBodyData:e,stopLoadingUi:t,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0}}(o,e,!0,n):TL(PowerpointCopilotStrings.CommandNotSupportedMessage,o,e,void 0,void 0,!1,!0,void 0,n);return a},xL=function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Wd.CHATPPT;return kL(t,e,void 0,n,r,o,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0)},kL=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Wd.CHATPPT,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=[{listItems:e.map((function(e){return{text:e}}))}];return LL(c,t,n,r,o,i,a,s,l)},AL=function(e,t,n,r,o){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Wd.CHATPPT;return LL([{listHeader:r,listItems:e}],t,n,o,i,a,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0)},LL=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Wd.CHATPPT,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0;return void 0!==r&&(r=Sd(Cd({},r),{feedbackData:NN(i,l),telemetryData:RN(a,s)})),{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:t},embeddedLists:e,messageFooter:{text:n}}},chatMessageBodyData:r,stopLoadingUi:o}},DL=function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Wd.CHATPPT,a=arguments.length>6?arguments[6]:void 0;return void 0!==r&&(r=Sd(Cd({},r),{feedbackData:NN(i,a),telemetryData:RN()})),{chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:t,embeddedLists:e,messageFooter:n}},chatMessageBodyData:r,stopLoadingUi:o}},OL=function(e){if(Vh(Lh.IsPersonalizationUXEnabled)&&Jh(Dh.IsPersonalizationIndicatorHeaderEnabled)&&!cF(e))return function(e){var t,n,r,o;if(!pm(e))return Gp("Chat Message header received in response chatMessageHeaderType: ",e.chatMessageHeaderType),e.chatMessageHeaderType===eg.Personalization_Indicator&&(Gp("Personalization header received in response"),wp.sendChatEventTelemetry(Ng(((t={})[Ap.ChatEventType]=Lp.PersonalizationIndicatorShown,t[Ap.IsPersonalizedResponse]=!0,t))),wp.sendLatencyTelemetry(Ng(((n={})[xp.IsPersonalizedResponse]=!0,n)))),{titleText:null!==(r=null==e?void 0:e.title)&&void 0!==r?r:"",popoverText:null!==(o=null==e?void 0:e.expandedTitle)&&void 0!==o?o:void 0}}(e)},NL=function(e){var t=e.split("#");if(2!==t.length)return null;var n=parseInt(t[0],10),r=parseInt(t[1],10);return isNaN(n)||isNaN(r)?null:[n,r]},RL=function(e){if((e.gptIdentifiers||[]).length>0){var t,n=e.gptIdentifiers[0].id;if(n)Gp("Rendering branding header for response received with GPT ID: ".concat(n)),ob.getInstance().sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.GptIdForBranding),(0,i._)(t,cC.ChatEventParameters,n),t)));return n?{id:n,name:""}:void 0}},FL=Tb.getInstance(),ML=function(){var e,t;return{iconType:FL.isInDocSensitivityLabelEncrypted()?uf.JF.Encryption:uf.JF.NonEncryption,tooltipText:null!==(e=FL.getInDocSensitiveLabelInfo().description)&&void 0!==e?e:"",badgeText:null!==(t=FL.getInDocSensitiveLabelInfo().displayName)&&void 0!==t?t:""}},BL=function(){var e,t;return{iconType:FL.isExternalDocSensitivityLabelEncrypted()?uf.JF.Encryption:uf.JF.NonEncryption,tooltipText:null!==(e=FL.getExternalDocSensitivityLabelInfo().description)&&void 0!==e?e:"",badgeText:null!==(t=FL.getExternalDocSensitivityLabelInfo().displayName)&&void 0!==t?t:""}},UL=function(){var e=(0,gd._)((function(e){var t,n,r,o,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:return t=FL.getInDocSensitiveLabelInfo(),Jh(Dh.IsClpEnabledInEnterpriseForSydney)?[4,FL.getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return n=g.sent(),[4,FL.getHighestDocumentSensitivityInfo([FL.getInDocSensitiveLabelInfo(),n])];case 2:(t=g.sent()).isDke=n.isDke,t.hasExtractForUser=n.hasExtractForUser,g.label=3;case 3:return a={id:t.labelId,displayName:null!==(r=t.displayName)&&void 0!==r?r:"",tooltip:t.description,color:t.color,isEncrypted:t.encryptionType!==Tp.None,priority:null!==(o=t.order)&&void 0!==o?o:0},l={documentSensitivity:a},[4,dR()];case 4:return l.documentURL=g.sent(),l.hasExtract=t.labelId===rM||t.hasExtractForUser,l.isDKE=t.labelId!==rM&&t.isDke,s=l,c={copilotConfig:e(),documentConfig:s},ob.getInstance().sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.CopilotConfig),(0,i._)(u,cC.ChatEventParameters,JSON.stringify(c.copilotConfig)),u))),d=void 0===s.hasExtract&&void 0===s.isDKE,ob.getInstance().sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.ChatEventType,dC.IsDocumentProtected),(0,i._)(p,cC.ChatEventParameters,!!d||!(!s.hasExtract||s.isDKE)),p))),[2,c]}}))}));return function(t){return e.apply(this,arguments)}}();var HL=function(){var e=(0,gd._)((function(e){var t,n,r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:return e?(t={labelId:e.id,tenantId:e.tenantId},[4,FL.getHighestDocumentSensitivityInfo([t])]):[3,2];case 1:return[2,{iconType:(n=i.sent()).encryptionType!==Tp.None?uf.JF.Encryption:uf.JF.NonEncryption,tooltipText:null!==(r=n.description)&&void 0!==r?r:"",badgeText:null!==(o=n.displayName)&&void 0!==o?o:""}];case 2:return[2,{tooltipText:PowerpointCopilotStrings.CLPGeneralSensitivityLabelError,iconType:uf.JF.Warning}];case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),GL=function(){var e=!0,t=_p.GetHostAppPlatform();return t!==yM&&t!==SM&&t!==bM||(e=Office.context.requirements.isSetSupported("SensitivityAPI","1.1")),ZR("isV2ClpPipelineEnabled: ".concat(e,", platform: ").concat(t)),e},zL=function(){var e,t;if(Jh(Dh.IsTransformFileSensitivityLabelErrorMessageEnabled)){t=PowerpointCopilotStrings.TransformFileCLPProtectedErrorMessage,e=pC.TransformFileCLPProtectedErrorMessage;var n=FL.getExternalDocSensitivityLabelInfo().displayName;n&&(t=PowerpointCopilotStrings.TransformFileCLPSensitivityLabelErrorMessage.replace("%s",n),e=pC.TransformFileCLPSensitivityLabelErrorMessage)}else t=PowerpointCopilotStrings.CLPNoUserPermissionForSensitivityLabel,e=pC.CLPNoUserPermissionForSensitivityLabel;return{errorString:t,errorKey:e}};function qL(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,a=e[0];if(!cF(a)){var s;ZR("Error in contentProcessing, Type : ".concat(a.errorType,", Message : ").concat(a.message,"\n")),ob.getInstance().sendErrorTelemetry(HS((s={},(0,i._)(s,uC.ErrorMessage,"Error in contentProcessing Workflow , Type : ".concat(a.errorType)),(0,i._)(s,uC.ErrorCategory,IC.ContextIQ),s)));var l={errorType:"".concat(a.errorType),featureName:_C.CreatePresentationFromDoc};if(Jh(Dh.ShowSpecificErrorsForEncryptedFiles)){var c=new Map([[kM,PowerpointCopilotStrings.TransformFileDocumentHasUDPLabelError],[AM,PowerpointCopilotStrings.TransformFileDocumentHasUnsupportedLabelTypeError],[LM,PowerpointCopilotStrings.TransformFileDocumentHasOtherExpectedProtectionError],[OM,PowerpointCopilotStrings.TransformFileUserHasNoRightsInLabelError],[NM,PowerpointCopilotStrings.TransformFileUserHasNoExtractRightsInLabelError],[RM,zL().errorString],[DM,PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted]]),u=!0,d=!1,p=void 0;try{for(var g,m=c.keys()[Symbol.iterator]();!(u=(g=m.next()).done);u=!0){var f=g.value;if(a.message.includes(f)){var h=c.get(f);return l.errorMessage=h,wL(t,h,void 0,void 0,r,l),cF(o)||(o.error=h),pC.DocumentPasswordProtectedOrEncrypted}}}catch(e){d=!0,p=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw p}}}switch(a.errorType){case lb.Encrypted:l.errorMessage=PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted,wL(t,PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.DocumentPasswordProtectedOrEncrypted),n=pC.DocumentPasswordProtectedOrEncrypted;break;case lb.DocumentTooLarge:l.errorMessage=PowerpointCopilotStrings.DocumentTooLargeToDownloadError,wL(t,PowerpointCopilotStrings.DocumentTooLargeToDownloadError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.DocumentTooLargeToDownloadError),n=pC.DocumentTooLargeToDownloadError;break;case lb.DocumentIrmProtected:var v=zL(),y=v.errorString;n=v.errorKey||n,l.errorMessage=y,wL(t,y,void 0,void 0,r,l),cF(o)||(o.error=y);break;case lb.DocumentNotFound:l.errorMessage=oF(WK())?PowerpointCopilotStrings.DocumentNotFoundToTransformError:PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError,wL(t,l.errorMessage,void 0,void 0,r,l),cF(o)||(o.error=l.errorMessage),n=pC.DocumentNotFoundToTransformError;break;case lb.ContentTooShort:l.errorMessage=PowerpointCopilotStrings.DocumentTooShortToTransformError,wL(t,PowerpointCopilotStrings.DocumentTooShortToTransformError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.DocumentTooShortToTransformError),n=pC.DocumentTooShortToTransformError;break;case lb.DocumentDownloadFailed:l.errorMessage=PowerpointCopilotStrings.DocumentDownloadFailedError,wL(t,PowerpointCopilotStrings.DocumentDownloadFailedError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.DocumentDownloadFailedError),n=pC.DocumentDownloadFailedError;break;case lb.Unauthorized:l.errorMessage=PowerpointCopilotStrings.CLPNoAccessPermission,wL(t,PowerpointCopilotStrings.CLPNoAccessPermission,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.CLPNoAccessPermission),n=pC.CLPNoAccessPermission;break;case lb.RMSDisabled:l.errorMessage=PowerpointCopilotStrings.TransformFileSPSensitivityLabelsDisabledError,wL(t,PowerpointCopilotStrings.TransformFileSPSensitivityLabelsDisabledError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.TransformFileSPSensitivityLabelsDisabledError),n=pC.RMSDisabled;break;case lb.UnsupportedFileType:var C=function(e,t){var n,r;if(t)switch(t){case"Excel":case"ExcelXls":r=PowerpointCopilotStrings.UnsupportedExcelFileError,n=pC.UnsupportedExcelFileError;break;case"PowerPoint":case"PowerPointPpt":r=PowerpointCopilotStrings.UnsupportedPptFileError,n=pC.UnsupportedPptFileError;break;case"Pdf":r=PowerpointCopilotStrings.UnsupportedPdfFileError,n=pC.UnsupportedPdfFileError;break;case"WordDoc":r=PowerpointCopilotStrings.UnsupportedWordFileError,n=pC.UnsupportedWordFileError;break;default:e.includes(PF)?(r=PowerpointCopilotStrings.UnsupportedWordFileError,n=pC.UnsupportedWordFileError):(r=PowerpointCopilotStrings.UnsupportedFileError,n=pC.UnsupportedFileError)}else r=PowerpointCopilotStrings.UnsupportedFileError,n=pC.UnsupportedFileError;return{errorString:r,errorKey:n}}(a.message,a.customErrorData),S=C.errorString,b=C.errorKey;l.errorMessage=S,wL(t,S,void 0,void 0,r,l),n=b||n,cF(o)||(o.error=S);break;case lb.InvalidInput:var E=PowerpointCopilotStrings.DocumentUrlInvalidError;n=pC.DocumentUrlInvalidError,a.message.includes(xM)&&(E=PowerpointCopilotStrings.DocumentUrlEmptyError,n=pC.DocumentUrlEmptyError),l.errorMessage=E,wL(t,E,void 0,void 0,r,l),cF(o)||(o.error=E);break;case lb.Consumer:l.errorMessage=PowerpointCopilotStrings.ErrorConsumerQueryTranformFile,wL(t,PowerpointCopilotStrings.ErrorConsumerQueryTranformFile,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.ErrorConsumerQueryTranformFile),n=pC.ErrorConsumerQueryTranformFile;break;case lb.FailedToGetSensitivityLabels:l.errorMessage=PowerpointCopilotStrings.CLPGeneralSensitivityLabelError,wL(t,PowerpointCopilotStrings.CLPGeneralSensitivityLabelError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.CLPGeneralSensitivityLabelError),n=pC.CLPGeneralSensitivityLabelError;break;case lb.UserTokenUnavailable:l.errorMessage=PowerpointCopilotStrings.DocumentAccessPermissionError,wL(t,PowerpointCopilotStrings.DocumentAccessPermissionError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.DocumentAccessPermissionError),n=pC.DocumentAccessPermissionError;break;case lb.CopilotLicensingError:l.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,wL(t,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,r,l),cF(o)||(o.error=OfficeaicopilotStrings.LicenseValidationErrorMessage),n=pC.LicenseValidationErrorMessage;break;case lb.SegmentationError:case lb.Error:default:l.errorMessage=PowerpointCopilotStrings.TransformFileGeneralError,wL(t,PowerpointCopilotStrings.TransformFileGeneralError,void 0,void 0,r,l),cF(o)||(o.error=PowerpointCopilotStrings.TransformFileGeneralError),n=pC.TransformFileGeneralError}}return n}class WL{constructor(e){Qp.h.assign(WL,this,e)}static getTypeName(){return"AugLoop_ContentValidator_ContentValidatorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[WL.getTypeName()])}}WL.H_={T_:WL.getTypeName(),B_:WL.getBaseTypes()};class jL{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(jL,this,e)}static getTypeName(){return"AugLoop_ContentValidator_ContentValidatorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[jL.getTypeName()])}}jL.H_={T_:jL.getTypeName(),B_:jL.getBaseTypes()};var VL,QL,JL,KL,XL=["docx","pdf"],ZL=ob.getInstance(),YL=new Map,$L=function(){var e=(0,gd._)((function(e,t){var n,r,o,a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){if(!(r=tD(e,t))||0===r.length)return[2];jE.getInstance().setState(Qd.EXECUTING),o=qp.dB===rM?(0,dg.A)():qp.dB,QL=e,a=!0,s=!1,l=void 0;try{for(c=r[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)d=u.value,p=qp.dB+bR(d),g={state:hp.Processing,errors:[],sensitivityLabel:""},YL.set(p,g)}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return VL=(new Date).getTime(),m=Sb.getInstance().getChatRef(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(o),f={correlationId:o,fileURLs:r,validateCLP:!0},h=new Vp.Xr({parentPath:["Signal",WL.getTypeName()],items:[{id:lx.r.generateId(),body:new WL(f)}]}),jE.getInstance().getState()===Qd.IDLE||(null===(n=m.current)||void 0===n||n.submitOperation({operation:h,workflowAnnotationType:WL.getTypeName()}),ZL.logTriedEvent(Iv.CreatePresentation,MC.CreateFromFile,yE.RX.Create),ZL.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ContentValidatorOperationSubmitted))),jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_VALIDATOR_WF_RESPONSE)),[2]}))}));return function(t,n){return e.apply(this,arguments)}}(),eD=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return jE.getInstance().getState()===Qd.IDLE?(ZR("ContentValidatorWorkflowHandler: ExecutionStateManager is in IDLE state. Returning \n"),[2]):(ZR("".concat(jL.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(VL)," sec \n,")),jE.getInstance().setState(Qd.EXECUTING),Vh(Lh.ExcelAsInput)&&XL.push("xlsx"),n=e.body,(r=null==n?void 0:n.correlationId)&&GS(r),o=null==n?void 0:n.errors,i=null==n?void 0:n.validationResults,o&&o.length>0?QL&&(UN(QL)||HN(QL))?[4,nD("ContentValidatorWorkflow_".concat(o[0].errorType),dC.ContentValidatorURLValidationFailed)]:[3,2]:[3,3]);case 1:t.sent(),t.label=2;case 2:return[2];case 3:a=!0,s=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0)d=u.value,p=qp.dB+bR(d.fileURL),d.errors&&d.errors.length>0?YL.set(p,{state:hp.Failed,errors:d.errors,sensitivityLabel:d.documentSensitivityLabel}):XL.includes(d.fileExtension)?YL.set(p,{state:hp.Success,errors:[],sensitivityLabel:d.documentSensitivityLabel}):YL.set(p,{state:hp.Failed,errors:[{errorType:lb.UnsupportedFileType,message:"Transformation is not supported for file with extension ".concat(d.fileExtension)}],sensitivityLabel:d.documentSensitivityLabel})}catch(e){s=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw l}}return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),tD=function(e,t){var n=[];if(t&&t.length>0){var r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value;n.push(l.value)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}if(e){var c,u=new RegExp("https://[^\\s]*","gi"),d=e.match(u)||[];(c=n).push.apply(c,Ed(d))}return n},nD=function(){var e=(0,gd._)((function(e,t){return(0,F.__generator)(this,(function(n){return ZL.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,t))),M_(!1,e,Cv.CreatePresentationFromDoc),[2]}))}));return function(t,n){return e.apply(this,arguments)}}(),rD=n(37542).Buffer,oD=ob.getInstance(),iD=Tb.getInstance(),aD=new Map,sD=function(){var e=(0,gd._)((function(){var e,t,n,r,o,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N=arguments;return(0,F.__generator)(this,(function(R){switch(R.label){case 0:if(e=N.length>0&&void 0!==N[0]?N[0]:[],t=N.length>1?N[1]:void 0,KL=!1,jE.getInstance().getState()===Qd.IDLE)return[2];if(oD.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.MultipleFileSourcesDetected),(0,i._)(r,cC.ChatEventParameters,e.length>1),r))),o=qp.dB===rM?(0,dg.A)():qp.dB,a=Sb.getInstance().getChatRef(),!Vh(Lh.IsContentValidatorWorkflowEnabled))return[3,17];s=Vh(Lh.IsEmptyLabelFixForCLPv2FeatureEnabled),l=!1,c=o+bR(e.join("")),u=!0,d=!1,p=void 0,R.label=1;case 1:R.trys.push([1,9,10,11]),g=e[Symbol.iterator](),R.label=2;case 2:return(u=(m=g.next()).done)?[3,8]:(f=m.value,nR(f)?[3,7]:(M=o+bR(f),(h=YL.get(M))&&h.state===hp.Processing?(null!==(v=aD.get(c))&&void 0!==v?v:0)<VF?(jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),ZR("ContentProcessing retrying because content validator is still processing \n"),y=1,aD&&aD.has(c)&&(y+=aD.get(c)),aD.set(c,y),oD.sendChatEventTelemetry(HS((C={},(0,i._)(C,cC.ChatEventType,dC.RetryingContentProcessingAnnotationCall),(0,i._)(C,cC.ChatEventParameters,y),C))),setTimeout((0,gd._)((function(){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,sD(e,t)];case 1:return n.sent(),[2]}}))})),QF),[2]):[3,7]:[3,3]));case 3:return h&&h.state===hp.Failed?(jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[4,gD(h.errors,a)]):[3,5];case 4:return R.sent(),[2];case 5:return h&&h.state===hp.Success&&(Jh(Dh.IsTransformFileSensitivityLabelErrorMessageEnabled)&&h.sensitivityLabel)?[4,pD(h.sensitivityLabel)]:[3,7];case 6:R.sent(),l=!0,R.label=7;case 7:return u=!0,[3,2];case 8:return[3,11];case 9:return L=R.sent(),d=!0,p=L,[3,11];case 10:try{u||null==g.return||g.return()}finally{if(d)throw p}return[7];case 11:return Vh(Lh.IsApplyLabelUsingTryUpgradeLabelEnabled)&&GL()&&(s||!PR(iD))&&l?s&&PR(iD)?[3,17]:(S={status:Md.SUCCESS},[4,xR(iD,S)]):[3,17];case 12:return R.sent()?[3,16]:(S=Sd(Cd({},S),{status:Md.FAILED,error:Bd.APPLY_CLP_LABEL_FAILED}),b=new lT({status:fE.failed,queryId:qp.dB,error:void 0}),XP(S,a,!1,fb.getTypeName(),b,!ZA()),jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),UA()?[3,13]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,15]));case 13:return[4,HA(b,a)];case 14:R.sent(),R.label=15;case 15:return ZR("Early label application failed"),[2];case 16:KL=!0,R.label=17;case 17:JL=(new Date).getTime(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(o),E=[],T=!0,I=!1,_=void 0,R.label=18;case 18:R.trys.push([18,24,25,26]),w=e[Symbol.iterator](),R.label=19;case 19:return(T=(P=w.next()).done)?[3,23]:(x=P.value,k=nR(x),A="",k?[4,ZN(x)]:[3,21]);case 20:A=R.sent(),R.label=21;case 21:E.push({contentType:k?ub.Web:ub.FileUrl,sourceBuffer:new Uint8Array(A?rD.from(A,"utf8"):[]),fileType:k?"html":"docx",url:null!==x?x:"",lastModified:""}),R.label=22;case 22:return T=!0,[3,19];case 23:return[3,26];case 24:return L=R.sent(),I=!0,_=L,[3,26];case 25:try{T||null==w.return||w.return()}finally{if(I)throw _}return[7];case 26:return D={correlationId:o,sourceContent:E,entryPoint:XM.Chat,userPrompt:t,language:_p.GetHostAppDisplayLanguage(),fCreateNewPresentation:zR.IsSettingTrue(DR.PPTBBPresOutlineEnabled),templateId:CR(),jsonCmdApiVersion:yR(),fCreateJsonCmdList:Vh(Lh.IsCreateJsonCmdListForBumbleBeeEnabled)},O=new Vp.Xr({parentPath:["Signal",yb.getTypeName()],items:[{id:aT.generateId(),body:new yb(D)}]}),jE.getInstance().getState()===Qd.IDLE?[2]:(null===(n=a.current)||void 0===n||n.submitOperation({operation:O,workflowAnnotationType:fb.getTypeName()}),lw.getInstance().setSkillName(mp.ContentTransform),oD.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ContentProcessingOperationSubmitted))),jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[2])}var M}))}));return function(){return e.apply(this,arguments)}}();function lD(){return null!=KL&&KL}var cD,uD,dD=function(){var e=(0,gd._)((function(e,t,n){var r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return jE.getInstance().getState()===Qd.IDLE?(ZR("ContentProcessingWorkflowHandler: ExecutionStateManager is in IDLE state. Returning \n"),[2]):(ZR("".concat(fb.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(JL)," sec \n,")),jE.getInstance().setState(Qd.EXECUTING),r=null==e?void 0:e.body,o=null==r?void 0:r.segmentBlobs,i=null==r?void 0:r.errors,a=null==r?void 0:r.sourceDocumentSensitivityLabels,!lD()&&Jh(Dh.IsTransformFileSensitivityLabelErrorMessageEnabled)&&a&&null!=i&&i.length>0?[4,pD(a)]:[3,2]);case 1:s.sent(),s.label=2;case 2:return void 0!==r.correlationId&&GS(r.correlationId),ZR("Segments received : "+o),US(oD,fb.getTypeName(),JL,sC.ContentProcessingResponseTime,_C.CreatePresentationFromDoc,n),[4,gD(i,t)];case 3:return s.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),pD=function(){var e=(0,gd._)((function(e){var t,n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),t=JSON.parse(e),n=t.id,r=t.tenantId,n?(o={labelId:n,tenantId:r},[4,iD.updateExternalDocSensitivityLabelUsingOfsJs([o])]):[3,2];case 1:a.sent(),a.label=2;case 2:return[3,4];case 3:return i=a.sent(),ZR("Getting error while parsing sourceDocumentSensitivityLabels: ".concat(i.message)),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),gD=function(){var e=(0,gd._)((function(e,t){var n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return null==e||0===e.length?[2]:(n=new lT({status:fE.failed,queryId:qp.dB,error:void 0}),r=qL(e,t,!ZA(),n),MS(oD,qp.qD,"".concat(fb.getTypeName(),"_Error"),e[0].errorType+((i=e[0].customErrorData)&&/[a-zA-Z0-9_]+/.test(i)?"_".concat(i):""),ep.Server,void 0,!ZA(),r),UA()?[3,1]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,3]));case 1:return[4,HA(n,t)];case 2:o.sent(),o.label=3;case 3:return M_(!1,"ContentProcessingWorkflow_".concat(e[0].errorType),Cv.CreatePresentationFromDoc),[2]}var i}))}));return function(t,n){return e.apply(this,arguments)}}();class mD{constructor(e){Qp.h.assign(mD,this,e)}static getTypeName(){return"AugLoop_PresentationRecommendation_PresentationRecommendationSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[mD.getTypeName()])}}mD.H_={T_:mD.getTypeName(),B_:mD.getBaseTypes()},function(e){e[e.SlideNav=0]="SlideNav"}(cD||(cD={}));class fD{constructor(e){Qp.h.assign(fD,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_PresentationRecommendation_PresentationRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[fD.getTypeName()])}}fD.H_={T_:fD.getTypeName(),B_:fD.getBaseTypes()};var hD,vD=sb.getInstance(),yD=ob.getInstance(),CD=function(){var e=(0,gd._)((function(e){var t,n,r,o,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:return uD=(new Date).getTime(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(qp.dB),Jh(Dh.IsSendSlideMonikerEnabled)?[4,$v(e)]:[3,2];case 1:return r=l.sent(),[3,3];case 2:r=void 0,l.label=3;case 3:return n=r,o=Object.assign(new mD,{targetSlides:[n],trigger:cD.SlideNav,correlationId:qp.dB,jsonCmdApiVersion:zR.getSettingAsString(DR.PPTJsonCmdAPIVersion)}),a=new Vp.Xr({parentPath:["Signal",mD.getTypeName()],items:[{id:aT.generateId(),body:o}]}),s=Sb.getInstance().getChatRef(),null===(t=s.current)||void 0===t||t.submitOperation({operation:a,workflowAnnotationType:fD.getTypeName()}),ZR("successfully submitted operation to AL : \n\n\n"+JSON.stringify(a)+"\nat Time : "+new Date+"\nSessionKey: \n\n\n"),yD.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.PresentationRecommendationOperationSubmitted))),jE.getInstance().setState(Qd.WAITING_FOR_PRESENTATION_RECOMMENDATION_WF_RESPONSE),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),SD=function(){var e=(0,gd._)((function(e,t,n,r,o){var a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j;return(0,F.__generator)(this,(function(V){switch(V.label){case 0:return ZR("".concat(fD.getTypeName()," response received\n Time Taken: ").concat((0,qp.WU)(uD),"s ")),l=jE.getInstance().getState(),Vh(Lh.TriggerPresentationRecommendationWithBeautify)||l===Qd.IDLE||l===Qd.WAITING_FOR_PRESENTATION_RECOMMENDATION_WF_RESPONSE?(vD.setResponseTime((0,qp.WU)(qp.qD)),jE.getInstance().setState(Qd.EXECUTING),c=null==e?void 0:e.body,u=null==c?void 0:c.presentationRecommendations,d=null==c?void 0:c.loggableSkillResults,ZR("PresentationRecommendation received recommendations: ".concat(JSON.stringify(u))),ZR("PresentationRecommendation received loggableSkillResults: ".concat(JSON.stringify(d))),p=null==c?void 0:c.error,g=null==c?void 0:c.correlationId,m={status:Md.SUCCESS},void 0!==g&&GS(c.correlationId),f=new lT({status:fE.failed,queryId:qp.dB,error:void 0}),p&&0!==p.code?(ZR("Error code received from PresentationRecommendation:"+JSON.stringify(p.code)),ZR("Error message received from PresentationRecommendation:"+JSON.stringify(p.message)),MS(yD,qp.qD,"".concat(fD.getTypeName(),"_Error"),JSON.stringify(p.code),ep.Server,void 0,!ZA()),UA()?[3,1]:(jE.getInstance().setState(Qd.IDLE),[3,3])):[3,4]):(ZR("presentationRecommendationAnnotationProcessor: Invalid ExecutionState: ".concat(l,". Expected idle or waiting for presentation recommendation workflow response. Returning")),[2]);case 1:return[4,HA(f,t)];case 2:V.sent(),V.label=3;case 3:return M_(!1,"PresentationRecommendationWorkflow_".concat(JSON.stringify(p.code))),vD.resetData(),[2];case 4:if(US(yD,fD.getTypeName(),uD,sC.PresentationRecommendationWorkflowResponseTime,_C.PresentationRecommendation,o),h=(new Date).getTime(),vD.setScenarioName(Cv.PresentationRecommendation),v=(null===(a=u[0])||void 0===a?void 0:a.jsonCmds)?JSON.parse(u[0].jsonCmds).cmds:[],y=(null===(s=u[0])||void 0===s?void 0:s.jsonCmdOptions)?JSON.parse(u[0].jsonCmdOptions):{},C={designerOptions:(null==y?void 0:y.designerOptions)?JSON.stringify(y.designerOptions):void 0,selectionOptions:(null==y?void 0:y.selectionOptions)?JSON.stringify(y.selectionOptions):void 0},S=vD.getStartTime(),!(v.length>0))return[3,9];b={scenarioName:vD.getScenarioName(),startTime:S||(new Date).toISOString(),entryPoint:XM.Chat,correlationId:g||(0,dg.A)(),timeToODSLMS:1e3*vD.getResponseTime(),timeODSLToJOfcMS:0,capability:vD.getCapability(),featureName:vD.getFeatureName(),subFeatureName:vD.getSubFeatureName(),fGeneratePreviews:!0},C.scenarioOptions=JSON.stringify(b),V.label=5;case 5:return V.trys.push([5,7,,8]),n(!1),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,X_(e,v,C)];case 1:return m=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 6:return V.sent(),ZR("log result : ",JSON.stringify(m)),[3,8];case 7:return E=V.sent(),ZR("Execution failed"+JSON.stringify(E)),m={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},[3,8];case 8:return Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&m.status!==Md.SUCCESS&&yD.sendChatEventTelemetry(HS((I={},(0,i._)(I,cC.ChatEventType,dC.PresentationRecommendationJOfcCommandsError),(0,i._)(I,cC.ChatEventParameters,Bd[null!==(T=m.error)&&void 0!==T?T:Bd.UNKNOWN_ERROR]),I))),[3,10];case 9:M_(!1,"PresentationRecommendationWorkflow_NoCmdsGenerated"),V.label=10;case 10:switch(yD.sendLatencyTelemetry(HS((0,i._)({},sC.QueryExecutionTime,(0,qp.WU)(h)))),m.status){case Md.BLOCKED:case Md.UNSUPPORTED:case Md.FAILED:case Md.UNEXPECTED_VERSION:case Md.USER_ABORTED:case Md.PARTIAL_SUCCESS:return[3,11];case Md.SUCCESS:return[3,12]}return[3,14];case 11:return XP(m,t,fD.getTypeName(),r,f),[3,14];case 12:return f.status=fE.success,[4,zA(Md.SUCCESS)];case 13:return V.sent(),(H=(null==m||null===(P=m.payload)||void 0===P||null===(w=P.jOfcApiResult)||void 0===w||null===(_=w.Thumbnails)||void 0===_?void 0:_.length)>0)?(z={featureName:_C.PresentationRecommendation,subFeatureName:MC.ProactiveRecommendation},null===(G=t.current)||void 0===G||G.addResponseMessage({chatCardType:jp._.ProactiveSuggestionCard,chatMessageData:{proactiveSuggestionCardProps:{user:"chat",skillType:"",imageSrc:m.payload.jOfcApiResult.Thumbnails[0],handleApplyClicked:(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,X_(e,v,C)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),ZR("PresentationRecommendation: Continuing protocol execution failed"+JSON.stringify(e)),[3,3];case 3:return jE.getInstance().setState(Qd.IDLE),[2,Promise.resolve(ZR("ProactiveSuggestionCard Apply Clicked"))]}}))})),handleMouseOver:function(){return Promise.resolve(ZR("ProactiveSuggestionCard Mouse Over"))},handleMouseLeave:function(){return Promise.resolve(ZR("ProactiveSuggestionCard Mouse Leave"))}}},chatMessageBodyData:{feedbackData:NN(Wd.CHATPPT,z)}})):ZR("PresentationRecommendation: No thumbnail received. Preview card will not be shown."),q={FSuccess:null==m||null===(k=m.payload)||void 0===k||null===(x=k.jOfcApiResult)||void 0===x?void 0:x.FSuccess,JOfcCommandStatusCode:null==m||null===(L=m.payload)||void 0===L||null===(A=L.jOfcApiResult)||void 0===A?void 0:A.JOfcCommandStatusCode,JOfcCommandErrorReason:null==m||null===(O=m.payload)||void 0===O||null===(D=O.jOfcApiResult)||void 0===D?void 0:D.JOfcCommandErrorReason,JOfcCmdResultId:null==m||null===(R=m.payload)||void 0===R||null===(N=R.jOfcApiResult)||void 0===N?void 0:N.JOfcCmdResultId,NumThumbnails:(null==m||null===(U=m.payload)||void 0===U||null===(B=U.jOfcApiResult)||void 0===B||null===(M=B.Thumbnails)||void 0===M?void 0:M.length)||0},yD.sendChatEventTelemetry(HS((W={},(0,i._)(W,cC.ChatEventType,fD.getTypeName()),(0,i._)(W,cC.ChatEventParameters,JSON.stringify(q)),W))),j=!ZA(),MS(yD,qp.qD,H?void 0:dC.PresentationRecommendationThumbnailNotReceived,void 0,void 0,void 0,j),[3,14];case 14:return vD.resetData(),UA()?[4,HA(f,t)]:[3,16];case 15:V.sent(),V.label=16;case 16:return jE.getInstance().setState(Qd.IDLE),[2]}}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}();class bD{constructor(e){Qp.h.assign(bD,this,e)}static getTypeName(){return"AugLoop_PresentationTransformer_PresentationTransformerSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[bD.getTypeName()])}}bD.H_={T_:bD.getTypeName(),B_:bD.getBaseTypes()};class ED{constructor(e){Qp.h.assign(ED,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_PresentationTransformer_PresentationTransformerAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[ED.getTypeName()])}}ED.H_={T_:ED.getTypeName(),B_:ED.getBaseTypes()};var TD=sb.getInstance(),ID=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:return r=Sb.getInstance().getChatRef(),hD=(new Date).getTime(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(qp.dB),[4,ey(e)];case 1:return o=l.sent(),a={targetFileDownloadUrl:null!==(i=ib.getInstance().getCachedDocumentState().latestDownloadUrl)&&void 0!==i?i:"",targetSlideIndexList:t,transformSlideIndexList:o},s=new Vp.Xr({parentPath:["Signal",bD.getTypeName()],items:[{id:aT.generateId(),body:new bD(a)}]}),null===(n=r.current)||void 0===n||n.submitOperation({operation:s,workflowAnnotationType:ED.getTypeName()}),ZR("successfully submitted operation to AL : \n\n\n"+JSON.stringify(s)+"\nat Time : "+new Date+"\nSessionKey: "+(0,WP.Dt)()+"\n\n\n"),jE.getInstance().setState(Qd.WAITING_FOR_PRESENTATIONTRANSFORM_WF_RESPONSE),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),_D=function(){var e=(0,gd._)((function(e,t,n,r,o){var i,a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:ZR("".concat(ED.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(hD)," sec \n")),TD.setResponseTime((0,qp.WU)(qp.qD)),TD.setScenarioName(Cv.PresentationTransform),jE.getInstance().setState(Qd.EXECUTING),i=null==e?void 0:e.body,a=null==i?void 0:i.jofcCommandsString,s=new lT({status:fE.failed,queryId:qp.dB,error:void 0}),ZR("Statements received from ODSL for organize Presentation :"+a),l={status:Md.SUCCESS},v.label=1;case 1:return v.trys.push([1,3,,4]),r(!1),c={scenarioName:TD.getScenarioName(),startTime:TD.getStartTime(),entryPoint:XM.Chat,correlationId:qp.dB,timeToODSLMS:1e3*TD.getResponseTime(),timeODSLToJOfcMS:0,capability:TD.getCapability(),featureName:TD.getFeatureName(),subFeatureName:TD.getSubFeatureName()},u={scenarioOptions:JSON.stringify(c)},[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,K_(e,a,u)];case 1:return l=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return v.sent(),ZR("log result : ",JSON.stringify(l)),[3,4];case 3:return d=v.sent(),ZR("Execute failed:"+JSON.stringify(d)),l={status:Md.FAILED},[3,4];case 4:switch(p=Lx.length>0&&""!==Lx[0]&&fF(Dx),l.status){case Md.BLOCKED:case Md.UNSUPPORTED:case Md.FAILED:case Md.UNEXPECTED_VERSION:case Md.USER_ABORTED:case Md.PARTIAL_SUCCESS:XP(l,t,o,bD.getTypeName(),s);break;case Md.SUCCESS:s.status=fE.success,m={linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantResponseContentCreationLine1Option1,linkSuffix:"\n\n"+PowerpointCopilotStrings.AssistantResponseContentCreationLine2},p&&(m.linkPrefix=Lx.filter((function(e){return e})).join(" ")+" "),f=!ZA(),h={featureName:TD.getFeatureName()},null===(g=t.current)||void 0===g||g.addResponseMessage(_L(m,n,void 0,mL,f,Wd.CHATPPT,void 0,void 0,h))}return TD.resetData(),UA()?[4,HA(s,t)]:[3,6];case 5:v.sent(),v.label=6;case 6:return[2]}}))}));return function(t,n,r,o,i){return e.apply(this,arguments)}}();function wD(e){return PD.apply(this,arguments)}function PD(){return PD=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P;return(0,F.__generator)(this,(function(x){try{if(t=[],cF(e))return t.push({shapes:[]}),[2,t];n=JSON.parse(e),o=!0,i=!1,a=void 0;try{for(s=n.slides[Symbol.iterator]();!(o=(l=s.next()).done);o=!0){if(c=l.value,r={shapes:[]},c.title&&((d={shapeType:uv.Title,text:"",textFormat:pv.String}).text=c.title,null===(u=r.shapes)||void 0===u||u.push(d)),c.content&&(g={shapeType:uv.Content,text:"",textFormat:pv.String},m=(m=c.content).trimStart(),f=m.replace(/\\n/g,"\n").replace(/\n- /g,"\n"),(f=gF(f)).length>0&&"-"===f[0]?g.text=f.substring(2):g.text=f,null===(p=r.shapes)||void 0===p||p.push(g)),c.image){h=!0,v=!1,y=void 0;try{for(C=c.image[Symbol.iterator]();!(h=(S=C.next()).done);h=!0)b=S.value,(T={shapeType:uv.Image,sourceType:dv.Link,image:"",alt:""}).alt=b.altText,T.image=b.imageUrl,null===(E=r.shapes)||void 0===E||E.push(T)}catch(e){v=!0,y=e}finally{try{h||null==C.return||C.return()}finally{if(v)throw y}}}c.id&&(I=c.id.split("#"),_={type:lv.Slide,id:+I[0],cId:+I[1]},r.slideMoniker=_),Jh("addSlideParseLayout")&&c.layoutInfo?r.layoutInfo=c.layoutInfo:(w={type:Tv.Object,minCnt:2},P={phs:[w]},r.layoutInfo=P),t.push(r)}}catch(e){i=!0,a=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return[2,t]}catch(e){throw ZR("Exception while parsing the program for add_slide OfficeJsPayload Json - "+e.toString()),new Error("Exception while parsing the program for add_slide OfficeJsPayload Json ")}return[2]}))})),PD.apply(this,arguments)}function xD(e){return kD.apply(this,arguments)}function kD(){return(kD=(0,gd._)((function(e){var t,n,r,o,i,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:t=e.context,n=e.slides,r=e.content;try{sb.getInstance().setScenarioName(Cv.AddSlide)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}o={name:mv.AddSlidesCmd,data:{slides:[]}},l.label=1;case 1:return l.trys.push([1,3,,4]),i=o.data,[4,wD(r)];case 2:return i.slides=l.sent(),[3,4];case 3:throw l.sent();case 4:return 0===n.length?[3,6]:[4,Xv(t,n)];case 5:a=l.sent().split("#"),s={type:lv.Slide,id:+a[0],cId:+a[1]},o.after=s,l.label=6;case 6:return[2,o]}}))}))).apply(this,arguments)}function AD(e){return LD.apply(this,arguments)}function LD(){return(LD=(0,gd._)((function(e){var t,n,r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:e.slides,t=e.content,n=e.slideResponseFromSegmentWF,r=void 0===n?null:n;try{sb.getInstance().setScenarioName(null===r?Cv.CreatePresentation:Cv.CreatePresentationFromDoc)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}(o={name:mv.CreatePresentationCmd,version:Dv,data:{version:Dv,slides:[]}}).name=mv.CreatePresentationCmd,s.label=1;case 1:return s.trys.push([1,5,,6]),i=o.data,null===r?[3,2]:(a=r,[3,4]);case 2:return[4,wD(t)];case 3:a=s.sent(),s.label=4;case 4:return i.slides=a,[3,6];case 5:throw s.sent();case 6:return[2,o]}}))}))).apply(this,arguments)}function DD(){return(DD=(0,gd._)((function(e){var t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:t=e.context,n=e.slides;try{sb.getInstance().setScenarioName(Cv.DeleteSlide)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return[4,sy(t,n)];case 1:return r=o.sent(),[2,{name:mv.DeleteSlidesCmd,version:Dv,slides:r}]}}))}))).apply(this,arguments)}function OD(){return(OD=(0,gd._)((function(e){var t,n,r,o;return(0,F.__generator)(this,(function(i){switch(i.label){case 0:t=e.context,n=e.slides,r=e.hide;try{sb.getInstance().setScenarioName(Cv.HideSlide)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return[4,sy(t,n)];case 1:return o=i.sent(),[2,{name:mv.HideSlidesCmd,slides:o,hide:r}]}}))}))).apply(this,arguments)}function ND(e){return RD.apply(this,arguments)}function RD(){return RD=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L;return(0,F.__generator)(this,(function(D){switch(D.label){case 0:t=e.context,n=e.slides,r=e.slideIds,o=e.precededBy,i=e.precededById;try{sb.getInstance().setScenarioName(Cv.MoveSlide)}catch(e){ZR("Exception while setting the scenario name for OfficeJsPayload Json "+e.toString())}return a={},Qv(i)?[3,1]:((l=null!==(s=null==i?void 0:i.split("#"))&&void 0!==s?s:[]).length>=2&&(a={type:lv.Slide,id:+l[0],cId:+l[1]}),[3,3]);case 1:return Qv(o)||0===(null==o?void 0:o.length)?[3,3]:[4,Xv(t,null!=o?o:[])];case 2:c=D.sent(),(u=c.split("#")).length>=2&&(a={type:lv.Slide,id:+u[0],cId:+u[1]}),D.label=3;case 3:return d=[],Qv(r)?[3,4]:((g=null!==(p=null==r?void 0:r.split("#"))&&void 0!==p?p:[]).length>=2&&(m={type:lv.Slide,id:+g[0],cId:+g[1]},d.push(m)),[3,6]);case 4:return[4,Zv(t,null!=n?n:[])];case 5:f=D.sent(),h=!0,v=!1,y=void 0;try{for(C=f[Symbol.iterator]();!(h=(S=C.next()).done);h=!0)b=S.value,(E=b.split("#")).length>=2&&(T={type:lv.Slide,id:+E[0],cId:+E[1]},d.push(T))}catch(e){v=!0,y=e}finally{try{h||null==C.return||C.return()}finally{if(v)throw y}}D.label=6;case 6:I=[],_=!0,w=!1,P=void 0;try{for(x=d[Symbol.iterator]();!(_=(k=x.next()).done);_=!0)A=k.value,L={name:mv.MoveSlideCmd,target:A},0!==Object.keys(a).length&&(L.after=a),I.push(L)}catch(e){w=!0,P=e}finally{try{_||null==x.return||x.return()}finally{if(w)throw P}}return[2,I]}}))})),RD.apply(this,arguments)}function FD(){return(FD=(0,gd._)((function(e){var t,n,r,o,i,a,s;return(0,F.__generator)(this,(function(l){switch(l.label){case 0:return t=e.context,n=e.slides,r=e.footer,o=e.includeDateTime,i=e.includeSlideNumber,[4,sy(t,n)];case 1:return a=l.sent(),s={name:mv.SetSlidesFooterCmd,slides:a,showFooter:!Qv(r)},Qv(r)||(s.footerText=r),Qv(o)||(s.showDate=o),Qv(i)||(s.showSlideNumber=i),sb.getInstance().setScenarioName(Cv.SetFooters),[2,s]}}))}))).apply(this,arguments)}function MD(e){return BD.apply(this,arguments)}function BD(){return BD=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c;return(0,F.__generator)(this,(function(u){switch(u.label){case 0:t=e.context,n=e.slides,r=e.type,o=e.time,i=e.delay,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,sy(t,n)];case 2:return a=u.sent(),(s=sb.getInstance()).setScenarioName(Cv.SlideTransition),"None"===r?[2,{name:mv.ResetTransitionPropsCmd,version:Dv,slides:a,props:["transition","duration","advanceTime","autoAdvance","manualAdvance"]}]:(s.setScenarioName(Cv.SlideTransition),l=function(e,t,n){var r={},o=!1;if(!Qv(e)){var i=null==e?void 0:e.toLowerCase();i&&i in YT&&(r.transition=YT[i],o=!0)}return!1===o&&(r.transition=kv.FX_MORPH),Qv(n)?r.manualAdvance=!0:(r.duration=n,r.autoAdvance=!0),Qv(t)||(r.advanceTime=t),r}(r,o,i),[2,{name:mv.ModifyTransitionPropsCmd,version:Dv,slides:a,props:l}]);case 3:throw c=u.sent(),ZR("Error in parsing json content for add slide command"+c.toString()),new Error("Error in parsing json content for add slide command");case 4:return[2]}}))})),BD.apply(this,arguments)}var UD=sb.getInstance();function HD(e){return GD.apply(this,arguments)}function GD(){return(GD=(0,gd._)((function(e){var t,n,r,o,i,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:if(t=e.context,n=e.precededBy,r=void 0===n?[]:n,o=e.layout,i=e.content,a=void 0===i?null:i,s=e.createPresentation,l=void 0===s?null:s,c=e.isFromOrganizePresentation,u=void 0===c?null:c,!py(Ov))throw new gC(Rv);if(!u&&zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin))throw new yC("Content generation is disabled by admin");if(!Jh(Dh.IsAddSlideEnabled))throw new gC("Content generation is not supported");if(!0!==l)return[3,2];if((p=ib.getInstance()).getSlideCountCached()>1&&!p.isCreatePresentationEnabledCached())throw new hC("Create presentation is not supported as required conditions do not meet");return[4,AD({slides:r,content:a})];case 1:return d=g.sent(),UD.setScenarioName(Cv.CreatePresentation),[3,4];case 2:return[4,xD({context:t,slides:r,content:a})];case 3:d=g.sent(),UD.setScenarioName(Cv.AddSlide),g.label=4;case 4:return[2,d]}}))}))).apply(this,arguments)}function zD(e){return qD.apply(this,arguments)}function qD(){return qD=(0,gd._)((function(e){var t,n,r,o,a,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:if(t=e.context,n=e.slides,r=e.strategy,o=void 0===r?null:r,a=e.animation,s=void 0===a?null:a,l=e.isVisible,c=void 0===l?null:l,u=e.targetFormatSlideByIndex,d=void 0===u?null:u,o&&!Object.values(hv).includes(o))throw ZR("Strategy ".concat(o," is not supported")),new gC("formatSlides : Strategy ".concat(o," is not supported"));if(!cF(c)&&Vh(Lh.IsjOFCCommandingWorkflowEnabled)){if(!py(Nv))throw new gC(Rv);return p=function(e){return OD.apply(this,arguments)}({context:t,slides:n,hide:!c}),[2,p]}return g={},o!==hv.OrganizeSlide?[3,4]:ib.getInstance().getCachedDocumentState().hasSection?[3,2]:[4,rx(t)];case 1:return v.sent(),UD.setScenarioName(Cv.Organize),[3,3];case 2:throw Ix()?(Jh("DoNotSendTelemetryForOrganizeWarning")||M_(!1,"StructurePresentationShowWarningError_DocumentHasSection_ShowingWarning",Cv.Organize),new CC("Organize Presentation command - presentation already has sections show user warning")):(M_(!1,"StructurePresentationBlockedError_DocumentHasSection",Cv.Organize),new vC("Organize Presentation command is not supported"));case 3:return[3,11];case 4:return o!==hv.BeautifySlide&&o!==hv.DesignerSlide?[3,8]:Vh(Lh.TriggerPresentationRecommendationWithBeautify)?(ZR("Overriding beautify trigger to send PresentationRecommendation signal"),UD.setScenarioName(Cv.PresentationRecommendation),[4,CD(t)]):[3,6];case 5:return v.sent(),[3,7];case 6:g[vv.RunDesigner]="true",UD.setScenarioName(Cv.Beautify),v.label=7;case 7:return[3,11];case 8:if(o!==hv.ThemeIdeas)return[3,9];if(!Vh(Lh.ShouldEnableTryNewDesign))throw new gC("Theme ideas command is not supported");return g[vv.TryNewTheme]="true",UD.setScenarioName(Cv.Beautify),[2,{trigger:fv.AllSlides,presentationHints:g}];case 9:return Vh(Lh.IsPresentationTransformerWFEnabled)&&o===hv.TransformSlide&&d?[4,ID(t,[d])]:[3,11];case 10:v.sent(),UD.setScenarioName(Cv.PresentationTransform),v.label=11;case 11:if(!0===s){if(!zR.IsSettingTrue(DR.PPTCopilotScnAnimate))throw M_(!1,"UnsupportedCommandError",Cv.Animate),new gC("Add slide Animation command is not supported");g[vv.AddSlideAnimation]="true",UD.setScenarioName(Cv.Animate)}else if(Jh(Dh.LogChatEventWhenAnimationIsFalse)&&!1===s)throw ob.getInstance().sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,"AnimationPresentButFalse"))),new gC("Removing animation is not supported");return Object.keys(g).length>0?n&&1===n.length&&Array.isArray(n)?[3,13]:[4,Yv(t)]:[3,15];case 12:n=v.sent(),v.label=13;case 13:return[4,Kv(t,n)];case 14:return m=v.sent(),Jh(Dh.EnableCheckBeforeSplit)&&cF(m)?[2,null]:(f=m.split("#"),Jh(Dh.EnableCheckBeforeSplit)&&f.length<2?[2,null]:(h={type:1,id:+f[0],cId:+f[1]},[2,{target:h,hints:g}]));case 15:return[2,null]}}))})),qD.apply(this,arguments)}function WD(e){return jD.apply(this,arguments)}function jD(){return(jD=(0,gd._)((function(e){var t,n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:if(t=e.context,n=e.slides,r=e.slideIds,o=e.precededBy,i=e.precededById,!py(Ov))throw new gC(Rv);return[4,ND({context:t,slides:n,slideIds:r,precededBy:o,precededById:i})];case 1:return[2,a.sent()]}}))}))).apply(this,arguments)}function VD(e){return QD.apply(this,arguments)}function QD(){return(QD=(0,gd._)((function(e){var t,n,r,o,a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:if(t=e.context,n=e.precededBy,r=e.prompt,o=e.source,a=e.createPresentation,s=e.groundingInfo,l=e.chatConversations,c=[],o)if(Vh(Lh.EnableMultiDocumentsTransformation))try{c=JSON.parse(o)}catch(e){ZR("Error parsing sources in ODSL statement: ".concat(e.message))}else c.push(o);if(!py(Ov))throw new gC(Rv);if(u=ib.getInstance(),!r||!zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin))return[3,1];throw new yC("Content generation is disabled by admin");case 1:if(!Jh(Dh.IsStoryTellerBlockedWithEmptyPrompt)||0!=a||0===c.length||!cF(r)&&0!=r.length)return[3,2];throw ZR("AddSlide- Avoiding storyteller call since prompt is undefined, but source is defined"),UD.setScenarioName(Cv.AddSlide),new bC("AddSlide- Avoiding storyteller call since prompt is undefined, but source is defined");case 2:return(void 0!==a||Jh(Dh.IsBumbleBeeWhenSourcePresent)&&0!==c.length)&&!1!==a?[3,4]:(ZR("generateSlides call storyTellerWorkflow with prompt:",r),[4,gx(r,!0,t,s,l,n)]);case 3:return g.sent(),UD.setScenarioName(Cv.AddSlide),[3,13];case 4:if(!(u.getSlideCountCached()>1&&0===c.length))return[3,5];throw Zy.getInstance().setCachedRequestParameters(r,c,s),Jh(Dh.IsCreatePresentationWarningTypeLogEnabled)&&ob.getInstance().sendChatEventTelemetry(HS((d={},(0,i._)(d,cC.ChatEventType,dC.CreatePresentationWarningType),(0,i._)(d,cC.ChatEventParameters,_C.CreatePresentation),d))),new SC("Create presentation - Slides already present - show the user warning");case 5:if(!(u.getSlideCountCached()>1&&c.length>0))return[3,6];throw Zy.getInstance().setCachedRequestParameters(r,c,s),Jh(Dh.IsCreatePresentationWarningTypeLogEnabled)&&ob.getInstance().sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.ChatEventType,dC.CreatePresentationWarningType),(0,i._)(p,cC.ChatEventParameters,_C.CreatePresentationFromDoc),p))),new SC("Create presentation - Slides already present - show the user warning");case 6:if(0===c.length||Jh(Dh.IsCreatePresentationEnabled))return[3,7];throw new gC("Content generation is not supported");case 7:if(!(u.getSlideCountCached()>1)||u.isCreatePresentationEnabledCached())return[3,8];throw M_(!1,"CreatePresentationBlockedError",Cv.CreatePresentation),new hC("Create presentation is not supported as required conditions do not meet");case 8:return c.length>0?(UD.setScenarioName(Cv.CreatePresentationFromDoc),ZR("generateSlides call contentProcessingWorkflow with source:",c.join(", ")),[4,sD(c,r)]):[3,10];case 9:return g.sent(),[3,13];case 10:return r?(ZR("generateSlides call storyTellerWorkflow with prompt:",r),[4,gx(r,!1,t,s,l)]):[3,12];case 11:return g.sent(),UD.setScenarioName(Cv.CreatePresentation),[3,13];case 12:throw new Error("no source or prompt provided");case 13:return[2]}}))}))).apply(this,arguments)}function JD(e){return KD.apply(this,arguments)}function KD(){return KD=(0,gd._)((function(e){var t,n,r,o,i,a;return(0,F.__generator)(this,(function(s){if(t=e.context,n=e.slides,r=e.footer,o=e.includeDateTime,i=e.includeSlideNumber,!Vh(Lh.IsjOFCCommandingWorkflowEnabled)||!py(Nv))throw new gC("slideFooter command is not supported");return a=function(e){return FD.apply(this,arguments)}({context:t,slides:n,footer:r,includeDateTime:o,includeSlideNumber:i}),[2,a]}))})),KD.apply(this,arguments)}function XD(e){return ZD.apply(this,arguments)}function ZD(){return ZD=(0,gd._)((function(e){var t,n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.slides,r=py(Nv),Vh(Lh.IsjOFCCommandingWorkflowEnabled)&&r?[3,2]:(o={},[4,Ky({context:t,slides:n})]);case 1:return a.sent(),[2,o];case 2:return i=function(e){return DD.apply(this,arguments)}({context:t,slides:n}),[2,i]}}))})),ZD.apply(this,arguments)}function YD(e){return $D.apply(this,arguments)}function $D(){return($D=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){throw e.context,e.slides,new gC("deleteFooter command is not supported")}))}))).apply(this,arguments)}function eO(e){return tO.apply(this,arguments)}function tO(){return(tO=(0,gd._)((function(e){var t,n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:if(t=e.context,n=e.slides,r=e.type,o=e.time,i=e.delay,!Vh(Lh.IsjOFCCommandingWorkflowEnabled)||!py(Nv))throw new gC("transitionSlides command is not supported");return[4,MD({context:t,slides:n,type:r,time:o,delay:i})];case 1:return[2,a.sent()]}}))}))).apply(this,arguments)}var nO="https://pptcopilotserver.azurewebsites.net",rO="sd",oO={selectSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,My(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,Gy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,qy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),moveSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,jy(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),undoApplication:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,xT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertSection:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Qy(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),generateSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,VD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteSlides:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,XD(e)]}))}));return function(t){return e.apply(this,arguments)}}(),selectText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,MT(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,JT(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,VT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,WT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesShape:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,yy(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesSlide:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Uy(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectIndicesText:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,GT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectTextIndex:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,qT(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,hy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),insertShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,Sy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ey(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteShapes:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,Iy(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertImages:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,xy(e)]}))}));return function(t){return e.apply(this,arguments)}}(),deleteFooters:function(e){return YD(e)},setFooters:function(e){return JD(e)},transitionSlides:function(e){return eO(e)},insertList:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,$I(e)]}))}));return function(t){return e.apply(this,arguments)}}(),formatList:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,t_(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertTables:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,__(e)]}))}));return function(t){return e.apply(this,arguments)}}()};class iO{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(iO,this,e)}static getTypeName(){return"AugLoop_PptVisuals_PPTVisualsCompleteOutput"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[iO.getTypeName()])}}iO.H_={T_:iO.getTypeName(),B_:iO.getBaseTypes()};class aO{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(aO,this,e)}static getTypeName(){return"AugLoop_PptVisuals_PPTSlideVisualDescription"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[aO.getTypeName()])}}aO.H_={T_:aO.getTypeName(),B_:aO.getBaseTypes()};class sO{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(sO,this,e)}static getTypeName(){return"AugLoop_PptVisuals_TriggerPptVisualOperationOnPaneLaunch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[sO.getTypeName()])}}sO.H_={T_:sO.getTypeName(),B_:sO.getBaseTypes()};class lO{constructor(e){Qp.h.assign(lO,this,e)}static getTypeName(){return"AugLoop_Sketch_SketchSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[lO.getTypeName()])}}lO.H_={T_:lO.getTypeName(),B_:lO.getBaseTypes()};class cO{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(cO,this,e)}static getTypeName(){return"AugLoop_Sketch_SketchAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[cO.getTypeName()])}}cO.H_={T_:cO.getTypeName(),B_:cO.getBaseTypes()};var uO,dO=n(6474),pO=(0,gh.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatLoadErrorHeader"),gO=(0,gh.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatLoadErrorText"),mO=(0,gh.Ex)("officeaicopilot-copilot-gpts.CopilotGPTStrings.CopilotChatGPTListLoadErrorText");!function(e){e.Default="Default",e.CustomGPT="CustomGPT",e.Agent="Agent",e.ClientProvided="ClientProvided"}(uO||(uO={}));const fO={[uO.Default]:0,[uO.ClientProvided]:1,[uO.CustomGPT]:2,[uO.Agent]:3};var hO=[uO.ClientProvided,uO.Agent],vO="copilotChat",yO=16,CO=function(e){var t=(0,dO.Lh)(pO),n=null!=e?e:"this agent";return t?"".concat(t," ").concat(n):"Unable to load ".concat(n)},SO=function(){var e=(0,dO.Lh)(gO);return e||"Please try reopening via the menu or switch to a different agent"},bO=function(){var e=(0,dO.Lh)(mO);return e||"Some extensions failed to load. Try relaunching Copilot."},EO=n(10271),TO=n(67349),IO=n(37025),_O=function(){function e(){var t=this;Sp(this,e),(0,i._)(this,"connectedToInternet",navigator.onLine),(0,i._)(this,"onOnline",(function(){t.connectedToInternet=!0,mb.getInstance().isRequestPending()&&ob.getInstance().sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.InternetReconnected)))})),(0,i._)(this,"onOffline",(function(){t.connectedToInternet=!1})),(0,i._)(this,"IsConnectedToNetwork",(function(){return navigator.onLine&&e.getInstance().connectedToInternet})),this.connectedToInternet=navigator.onLine,window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)}return Ep(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(_O,"instance",void 0);var wO,PO=[],xO=!0,kO=ob.getInstance(),AO=Tb.getInstance(),LO=rM,DO=rM,OO=!1,NO=!1,RO=function(){var e=(0,gd._)((function(e,t,n){var r,o,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I;return(0,F.__generator)(this,(function(_){switch(_.label){case 0:if(!e.body||!hb.typeGuard(e.body))return[2];if(r={featureName:_C.CreatePresentationFromDoc,subFeatureName:MC.CreateFromFile},o=e.body,a=o.correlationId,!mb.getInstance().isValidAnnotationResponse(a))return ZR("Ignoring contentProcessingProgressAnnotationProcessor for correlationId: ".concat(a)),kO.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.InvalidContextIdResponse),(0,i._)(u,cC.ChatEventParameters,null!==(c=null===(l=e.body)||void 0===l||null===(s=l.H_)||void 0===s?void 0:s.T_)&&void 0!==c?c:""),(0,i._)(u,cC.Cv,null!=n?n:""),(0,i._)(u,cC.UserQueryGuid,a),u))),[2];if(d=o.progress,p=o.jsonData,kO.sendChatEventTelemetry(HS((g={},(0,i._)(g,cC.ChatEventType,dC.ContentProcessingProgress),(0,i._)(g,cC.ChatEventParameters,d),(0,i._)(g,cC.Cv,null!=n?n:""),(0,i._)(g,cC.UserQueryGuid,a),g))),m=o.sourceDocumentSensitivityLabels,lD()||void 0===m||""!==LO||""!==DO)return[3,2];try{f=JSON.parse(m),LO=f.id,DO=f.tenantId}catch(e){ZR("Getting error while parsing sourceDocumentSensitivityLabels: ".concat(e.message)),kO.sendErrorTelemetry(HS((h={},(0,i._)(h,uC.ErrorMessage,"Getting error while parsing sourceDocumentSensitivityLabels: ".concat(e.message)),(0,i._)(h,uC.ErrorCategory,IC.ContextIQ),h)))}return v={labelId:LO,tenantId:DO},[4,AO.updateExternalDocSensitivityLabelUsingOfsJs([v])];case 1:_.sent(),_.label=2;case 2:switch(ZR("".concat(hb.getTypeName()," response. correlationId: ").concat(a,", progress: ").concat(d,", jsonData: ").concat(JSON.stringify(p),", sourceDocumentSensitivityLabels: ").concat(m)),d){case cb.DocumentDownloadStart:null===(y=t.current)||void 0===y||y.updateLoadingComponentProps(Cd({loadingUiStringList:[PowerpointCopilotStrings.LoadingUIDocumentDownloadStarted]},FN()));break;case cb.SegmentationStart:null===(C=t.current)||void 0===C||C.updateLoadingComponentProps(Cd({loadingUiStringList:[PowerpointCopilotStrings.LoadingUIDraftingAPresentation]},FN()));break;case cb.SlideOutlineGenerated:if(p&&FO(p))return null===(S=t.current)||void 0===S||S.addResponseMessage(xL(PowerpointCopilotStrings.OutlineStreamingHeader,PO,Sd(Cd({},mL),{clpSensitivityIndicatorData:AO.shouldShowExternalDocSensitivityLabel()?BL():void 0}),!1,Wd.CHATPPT,Iv.CreatePresentation,MC.CreateFromFile,r)),AO.shouldShowExternalDocSensitivityLabel()&&kO.sendChatEventTelemetry(HS((b={},(0,i._)(b,cC.ChatEventType,dC.TransformFileUsedWithCLPForOutline),(0,i._)(b,cC.ChatEventParameters,"IsEncrypted_".concat(AO.isExternalDocSensitivityLabelEncrypted())),(0,i._)(b,cC.UserQueryGuid,a),b))),[2];break;case cb.SlideOutlineStreaming:if(p&&FO(p))return E=kL(PO,PowerpointCopilotStrings.OutlineStreamingHeader,o.isContentShort?PowerpointCopilotStrings.ContentTransformShortContentMessage:void 0,Sd(Cd({},mL),{clpSensitivityIndicatorData:AO.shouldShowExternalDocSensitivityLabel()?BL():void 0}),!1,Wd.CHATPPT,Iv.CreatePresentation,MC.CreateFromFile,r),NO=!0,MO(t,E,!1),[2];break;case cb.SlideOutlineStreamingCompleted:T=Sd(Cd({},mL),{feedbackData:NN(Wd.CHATPPT,r)}),MO(t,UO(Sd(Cd({},T),{clpSensitivityIndicatorData:AO.shouldShowExternalDocSensitivityLabel()?BL():void 0}),!1),!0),AO.shouldShowExternalDocSensitivityLabel()&&kO.sendChatEventTelemetry(HS((I={},(0,i._)(I,cC.ChatEventType,dC.TransformFileUsedWithCLPForOutline),(0,i._)(I,cC.ChatEventParameters,"IsEncrypted_".concat(AO.isExternalDocSensitivityLabelEncrypted())),(0,i._)(I,cC.UserQueryGuid,a),I))),BO()}return[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),FO=function(e){var t=[];try{t=JSON.parse(e).slideOutlineList}catch(e){var n;return ZR("Error in parsing outline response for bumblebee",e.message),kO.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"Error in parsing outline response for bumblebee: ".concat(e.message)),(0,i._)(n,uC.ErrorCategory,IC.ContextIQ),n))),!1}var r=!0,o=!1,a=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;PO.push(c.topic)}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return ZR("outlineTopicPoint: ".concat(JSON.stringify(t))),!0},MO=function(e,t,n){if(n?(t.addCardToChatHistory=!0,OO=!0):t.addCardToChatHistory=!1,xO){var r;kO.logTriedEvent(Iv.CreatePresentation,MC.CreateFromFile,yE.RX.Create);var o=Sd(Cd({},t.chatMessageBodyData),{feedbackData:NN(),telemetryData:RN(Iv.CreatePresentation)});t.chatMessageBodyData=o,null===(r=e.current)||void 0===r||r.addResponseMessage(t),xO=!1}else{var i;null===(i=e.current)||void 0===i||i.updateLastMessage(t)}},BO=function(){PO=[],xO=!0,LO=rM,DO=rM,OO=!1,NO=!1},UO=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{chatCardType:jp._.Default,chatMessageData:void 0,chatMessageBodyData:e,stopLoadingUi:t}},HO=n(86887);function GO(e,t,n,r){var o=RK&&Yh()&&oF(WK())?n+$M:n;OfficeFirstParty.UserFeedback.CollectUserFeedback(e,t,o,r)}var zO,qO=function(){wO=document.activeElement},WO=function(e){if(RK&&e.length){var t="PPTWeb";switch(_p.GetHostAppPlatform()){case yM:t="PPTWin32";break;case SM:t="PPTMac";break;case bM:t="PPTiOS"}ZR("initiating feedback signal for "+t),(0,HO.W)(e,t).finally((function(){ZR("Feedback diagnostic data upload signal called")}))}},jO=function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return ZR("Feedback was ".concat(e?"sent":"not sent",".")),ZR("Adding delay of 2 sec before setting focus"),[4,lF(2e3)];case 1:return t.sent(),wO&&wO.focus(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),VO=function(){var e=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return RK&&Yh()&&oF(WK())?(ZR("Register OfficeFirstParty On Submit feedback response event"),[4,OfficeFirstParty.UserFeedback.onUserFeedbackResponse(WO)]):[3,2];case 1:e.sent(),e.label=2;case 2:return ZR("Register OfficeFirstParty feedback dismissed event"),[4,OfficeFirstParty.UserFeedback.onUserFeedbackUIDismissed(jO)];case 3:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),QO=n(23909),JO=n.n(QO);function KO(){return XO.apply(this,arguments)}function XO(){return XO=(0,gd._)((function(){var e,t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:e=Gg.Unknown,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:switch(t=r.sent(),ZR("Primary Identity Info is : ",JSON.stringify(t)),t.identityType){case"OrganizationAccount":e=Gg.Enterprise;break;case"MicrosoftAccount":e=Gg.Consumer;break;default:e=Gg.Unknown}return[3,4];case 3:return n=r.sent(),ZR("Error fetching Identity Info :",n),[3,4];case 4:return[2,e]}}))})),XO.apply(this,arguments)}!function(e){e.ODP="MicrosoftAccount",e.ODB="OrganizationAccount",e.Unsupported="Unsupported"}(zO||(zO={}));var ZO,YO=9;!function(e){e.webUrl="https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.5008/en-us_web/login.html",e.spaUrl="https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.9008/en-us_web/login.html"}(ZO||(ZO={}));var $O=function(e){return 1===e?"https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.5008/en-us_web/login.html":"https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.9008/en-us_web/login.html"};function eN(){return tN.apply(this,arguments)}function tN(){return(tN=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){return e=$O(qh(Lh.RedirectURLEndpointOverride,0)),ZR("Loading auth with reply URL: ".concat(e)),[2,OfficeFirstPartyAuth.load(e)]}))}))).apply(this,arguments)}function nN(e,t,n){return rN.apply(this,arguments)}function rN(){return(rN=(0,gd._)((function(e,t,n){var r,o,i,a,s,l,c;return(0,F.__generator)(this,(function(u){switch(u.label){case 0:return[4,KO()];case 1:o=u.sent(),i=0,u.label=2;case 2:if(!(i<=YO))return[3,7];i>0&&Zh()&&ob.getInstance().sendChatEventTelemetry(Ed(cP(n)).concat([{key:cC.ChatEventType,value:dC.DesignerAuthTokenFetchRetry}])),u.label=3;case 3:return u.trys.push([3,5,,6]),a={resource:e,scope:t.length>0?t.join(" "):void 0,silentLogin:!0},s=o===Gg.Unknown?rF(WK()):o===Gg.Consumer,Jh(Dh.isMSAAuthWorkaroundEnabled)&&!_p.isWebPlatform()&&s&&(a.policy="DELEGATED",ZR("Using DELEGATED policy for MSA token retrieval.")),[4,OfficeFirstPartyAuth.getAccessToken(a)];case 4:return l=u.sent(),ZR("Auth token successfully retrieved."),[2,l.accessToken];case 5:return c=u.sent(),r=c,[3,6];case 6:return i++,[3,2];case 7:throw r}}))}))).apply(this,arguments)}var oN,iN,aN=function(){var e=(0,gd._)((function(e,t){var n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:n="",o=cP(r="00000000-0000-0000-0000-000000000000"),a.label=1;case 1:return a.trys.push([1,3,,4]),Zh()&&ob.getInstance().sendChatEventTelemetry(Ed(o).concat([{key:cC.ChatEventType,value:dC.DesignerAuthTokenFetchStart}])),[4,nN(e,t,r)];case 2:return n=a.sent(),Zh()&&ob.getInstance().sendChatEventTelemetry(Ed(o).concat([{key:cC.ChatEventType,value:dC.DesignerAuthTokenFetchEnd}])),[3,4];case 3:throw i=a.sent(),ZR("Failed to get access token: ".concat(i.message)),Zh()&&ob.getInstance().sendErrorTelemetry(Ed(o).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Error getting auth token: "+i.message},{key:uC.ErrorCode,value:"".concat(i.code)}])),i;case 4:return[2,{token:n}]}}))}));return function(t,n){return e.apply(this,arguments)}}(),sN=function(){return new URL("https://fa000000129.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.9008/en-us_web/login.html").pathname},lN={10:"#200D03",20:"#3C1805",30:"#6E220F",40:"#79310A",50:"#952F15",60:"#B13719",70:"#B1470E",80:"#C43E1C",90:"#CB5031",100:"#CA5010",110:"#CF6024",120:"#D67540",130:"#DC816A",140:"#E1966D",150:"#EDBCB0",160:"#F6DBD4"},cN=n(58651),uN=n(37542).Buffer;!function(e){e.Header="Header",e.Footer="Footer",e.Backstage="Backstage",e.HelpMenu="Help Menu",e.Canvas="Canvas",e.Chat="Chat"}(oN||(oN={})),function(e){e.Https="Https",e.Https_OneDrive="Https_OneDrive",e.Https_DropBox="Https_DropBox",e.Https_GoogleDrive="Https_GoogleDrive",e.Https_Wikipedia="Https_Wikipedia",e.Http="Http",e.Unclean="Unclean",e.Empty="Empty",e.Email="Email",e.Calendar="Calendar",e.Invalid="Invalid"}(iN||(iN={}));var dN=o,pN=ob.getInstance(),gN=rM,mN=rM,fN=rM,hN=rM,vN=Wd.CHATPPT,yN=rM,CN=rM,SN=Vh(Lh.ShowPersonalizationSuggestionPill),bN=function(e){vN=e},EN=function(e){yN=e},TN=function(){return yN},IN=function(){var e=(0,gd._)((function(e,t,n){var r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return r=Jh(Dh.UseNewCopilotSharedPackage)?Af:UL,o=[Cd({},e)],i={queryId:t,slides:n},oF(WK())?[4,r((function(){return PN()}))]:[3,2];case 1:return a=s.sent(),[3,3];case 2:a=void 0,s.label=3;case 3:return[2,Sd.apply(void 0,o.concat([(i.config=a,i)]))]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),_N=function(e){for(var t=e.split(",")[1],n=atob(t),r=new Uint8Array(new ArrayBuffer(n.length)),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);var i=function(e){var t;return e.startsWith("data:image/png")?{format:vm.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:vm.Jpg}:e.startsWith("data:image/bmp")?{format:vm.Bmp}:{format:vm.Other,otherFormat:null===(t=e.split(";")[0])||void 0===t?void 0:t.split(":")[1]}}(e),a=i.format,s=i.otherFormat;return{contents:[{id:(0,dg.A)(),size:ym.Unspecified,format:a,otherFormat:s,data:Array.from(r),sizeBytes:r.length}],widthPx:0,heightPx:0}},wN=function(){var e=(0,gd._)((function(e,t,n,r,o,a,s,l,c,u,d,p){var g,m,f,h,v,y,C,S,b,E,T,I,_,w;return(0,F.__generator)(this,(function(P){switch(P.label){case 0:return cF(g=Jh(Dh.UseDataURIToImageTileShared)?wm:_N)||(m=null==s?void 0:s.map(g)[0]),void 0===m&&s&&s.length>0&&(ZR("Bad image data URI in image chat: ".concat(s[0])),pN.sendErrorTelemetry(HS((f={},(0,i._)(f,uC.ErrorMessage,"Image chat bad image data URI in getFluxInputSignal"),(0,i._)(f,uC.ErrorCategory,IC.Error),f)))),a&&Jh(Dh.IsMsgExtTelemetryEnabled)&&(h=(null==a?void 0:a.map((function(e){return e.id})))||[],v=h.length>0?JSON.stringify(h):"",ZR("Enabled Plugins: ",v),ob.getInstance().sendChatEventTelemetry(HS((y={},(0,i._)(y,cC.UserQueryGuid,n),(0,i._)(y,cC.ChatEventType,dC.EnabledPlugins),(0,i._)(y,cC.ChatEventParameters,v),y)))),C=null!=r?r:Kk,S=Jh(Dh.UseNewCopilotSharedPackage)?Af:UL,b=l==vO?void 0:l,E=function(e){if(e&&e.appType===am.b.GPT)return e.appId}(d),T=function(e){if(e&&e.appType===am.b.MessageExtension)return[{id:"CopilotPlugins.".concat(e.appType,".").concat(e.appId),source:"MOS3"}]}(d),I=null!=E?E:b,_=Ed(null!=a?a:[]).concat(Ed(null!=T?T:[])).some((function(e){return"MOS3"===e.source})),CN=null!=I?I:rM,function(e,t,n,r){var o,a;if(t&&ob.getInstance().sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.UserQueryGuid,e),(0,i._)(o,cC.ChatEventType,dC.InputSignalSwitcherMenuGptId),(0,i._)(o,cC.ChatEventParameters,t),o))),n&&ob.getInstance().sendChatEventTelemetry(HS((a={},(0,i._)(a,cC.UserQueryGuid,e),(0,i._)(a,cC.ChatEventType,dC.InputSignalAtMentionGptId),(0,i._)(a,cC.ChatEventParameters,n),a))),r){var s,l=(null==r?void 0:r.map((function(e){return e.id})))||[],c=l.length>0?JSON.stringify(l):"";ob.getInstance().sendChatEventTelemetry(HS((s={},(0,i._)(s,cC.UserQueryGuid,e),(0,i._)(s,cC.ChatEventType,dC.InputSignalAtMentionPlugin),(0,i._)(s,cC.ChatEventParameters,c),s)))}}(n,b,E,T),[4,S((function(){return PN(a)}))];case 1:return w=P.sent(),ZR("AtMentioned Plugins/GPT: ",T||E),ZR("Selected menu GPT: ",b),[2,Sd(Cd({},e),{queryId:n,gptId:I,mentionedPlugins:T,conversationId:wk()?C:Kk,slides:t,config:Sd(Cd({},w),{isToolboxEnabled:!!I||_&&Vh(Lh.IsPluginToolboxEnabledForPlugins)}),queryAnnotations:o,clientUILanguageAndLocale:TS(_p.GetHostAppDisplayLanguage()),createJsonCmdList:Vh(Lh.IsCreateJsonCmdListForBumbleBeeEnabled),jsonCmdApiVersion:yR(),templateId:CR(),createNewPresentation:zR.IsSettingTrue(DR.PPTBBPresOutlineEnabled),images:m,commandCategory:c,invokeActionConfirmation:u,isWarmUp:p})]}}))}));return function(t,n,r,o,i,a,s,l,c,u,d,p){return e.apply(this,arguments)}}();function PN(e){return{webGroundingEnabled:!(null==e?void 0:e.length)&&(xk()&&NS()),enterpriseGroundingEnabled:LS(),requireExplicitPlugins:xk(),searchOnlyMode:!1,pluginInfo:null!=e?e:[]}}var xN=function(){var e=(0,gd._)((function(e,t){var n,r,o;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return r=TF||VR(),t&&(e=kN(e,t)),Vh(Lh.RemoveContextFromInputSignalEnabled)?(n={query:e,raw:r,links:t,isStreaming:!0},pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ContextTreeBuildSkipped))),[3,3]):[3,1];case 1:return[4,AN()];case 2:o=a.sent(),n={query:e,context:o,raw:r,links:t,isStreaming:!0},pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ContextTreeBuildCompleted))),a.label=3;case 3:return[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),kN=function(e,t){t.sort((function(e,t){return e.range[0]-t.range[0]}));var n=0,r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var l=a.value,c=yd(l.range,2),u=c[0],d=c[1];u+=n,d+=n,n+=4;var p="{{"+e.slice(u,d+1)+"}}",g=e.slice(0,u),m=e.slice(d+1);e=g+p+m,l.range=[u,d+4]}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return e},AN=function(){var e=(0,gd._)((function(){var e,t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:ZR("updateContextTree called"),e="",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,PowerPoint.run(function(){var t=(0,gd._)((function(t){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,LN(t)];case 1:return e=n.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 2:return o.sent(),[3,4];case 3:return t=o.sent(),ZR("Exception in updateContextTree: ".concat(t)),pN.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"Exception in updateContextTree ".concat(t.message)),(0,i._)(n,uC.ErrorCategory,IC.Error),n))),pN.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.ContextTreeBuildError),(0,i._)(r,cC.ChatErrorType,ep.Client),r))),[3,4];case 4:return[2,e]}}))}));return function(){return e.apply(this,arguments)}}();function LN(e){return DN.apply(this,arguments)}function DN(){return(DN=(0,gd._)((function(e){var t,n,r,o;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:t=new Promise((function(e,t){var n=setTimeout((function(){clearTimeout(n),t(new Error("Timed out for context tree build"))}),mM)})),n=dN.getSelectionContextTree(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.race([n,t])];case 2:return r=a.sent(),[2,JSON.stringify(r)];case 3:return o=a.sent(),ZR("Timeout occurred for context tree build: ".concat(o)),pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ContextTreeBuildTimeout))),[2,rM];case 4:return[2]}}))}))).apply(this,arguments)}var ON=function(){var e=(0,gd._)((function(e,t,n){var r,o,a,s;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return n&&(r=vR(n),o=r.correlationId,a=r.featureName,s=r.subFeatureName,void 0!==o&&pN.setQueryGuid(o),void 0!==a?pN.logKeptEvent(a,s||MC.Unset,Hw(a)):pN.logKeptEvent(Iv.CopilotChat)),pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CopyButtonClicked))),n&&pN.setQueryGuid(""),[4,(0,EO.Cu)(e)];case 1:return t.sent(),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}();var NN=function(e,t){e=e&&e!==Wd.CHATPPT?e:vN;var n=function(){if($h()){var e="CurrentContext";return LS()&&(e+="+Work"),NS()&&(e+="+Web"),e}return LS()?"Work":"CurrentContext"}(),r=(new Date).toISOString(),o=pN.getQueryGuid()===rM?hN:pN.getQueryGuid(),i={feedbackContextData:{prompt:gN,promptId:o,errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType},sydneyContextData:{requestId:o,utteranceTimeStamp:r,feedbackMessageId:(0,TO.Xf)(),conversationId:Kk,sydneyEndpoint:Xk,locale:wP},groundingSource:n,featureName:null==t?void 0:t.featureName,subFeatureName:null==t?void 0:t.subFeatureName,entryPoint:"Chat"};return{feedbackArea:Vh(Lh.IsFeedbackAppChatIntegrationEnabled)?Wd.OCV_FEATURE_AREA:e,contextData:e===Wd.COPILOTSTART?Sd(Cd({},i),{cardMetaData:JSON.stringify({prompt:gN,status:mN,contextMetaData:fN,copilotExtensionId:CN})}):Sd(Cd({},i),{cardMetaData:yN===rM?JSON.stringify({prompt:gN,promptId:o,featureContent:null==t?void 0:t.featureContent,featureAdditionalTelemetry:null==t?void 0:t.featureAdditionalTelemetry,errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType,copilotExtensionId:CN}):JSON.stringify({prompt:gN,promptId:o,copilotLabPromptId:yN,errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType,copilotExtensionId:CN})})}},RN=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC.Unset,n=null!=e?e:sb.getInstance().getFeatureName();return n===Iv.Unset&&(n=Iv.CopilotChat),JSON.stringify({featureName:n,correlationId:pN.getQueryGuid()===rM?void 0:pN.getQueryGuid(),subFeatureName:t})},FN=function(){return _p.GetHostAppPlatform()===bM?{showInlineStopGeneratingButton:!0}:{showStopGeneratingButton:!0}},MN=function(){var e=(0,gd._)((function(e,t,n,r,o,a,s,l,c,u,d,p,g){var m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q,W,j,V,Q,J,K;return(0,F.__generator)(this,(function(X){switch(X.label){case 0:if(ZR("getDefaultSignalOperation called: ".concat(t)),Vh(Lh.IsNotificationEnabledForSummary)){m=(0,dg.A)(),function(e,t){Nk.set(e,t)}(n,{querySubmissionTime:qp.qD,uniqueActionID:m}),f=!0,h=!1,v=void 0;try{for(y=Nk.entries()[Symbol.iterator]();!(f=(C=y.next()).done);f=!0)S=yd(C.value,2),b=S[0],S[1],nA(b)&&qk.disableSuccessButton(b,e)}catch(e){h=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(h)throw v}}}return E=void 0!==c&&""!==c,lw.getInstance().resetData(),T=function(e,t){var n,r,o,i,a,s,l,c;return t===PowerpointCopilotStrings.PromptMenuItemSummarize?(null===(n=e.current)||void 0===n||n.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(r=Gx().get(Hd.PresentationSummary))&&void 0!==r?r:[]},FN())),hE.Summary):t===PowerpointCopilotStrings.PromptGuideMenuItemShowKeySlides?(null===(o=e.current)||void 0===o||o.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(i=Gx().get(Hd.ImportantSlides))&&void 0!==i?i:[]},FN())),hE.ImportantSlides):t===PowerpointCopilotStrings.PromptMenuItemShowActionItems?(null===(a=e.current)||void 0===a||a.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(s=Gx().get(Hd.CallToAction))&&void 0!==s?s:[]},FN())),hE.CallsForAction):(null===(l=e.current)||void 0===l||l.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(c=Gx().get(Hd.Default))&&void 0!==c?c:[]},FN())),hE.Unknown)}(e,t),hN=n,(gN=t).toLowerCase().includes(xF)&&gN.toLowerCase().includes(kF)&&!E&&(I=Jh(Dh.UseDataURIToImageTileShared)?wm:_N,void 0===(_=null==l?void 0:l.map(I)[0])&&l&&l.length>0&&(ZR("Bad image data URI in sketch to image: ".concat(l[0])),pN.sendErrorTelemetry(HS((w={},(0,i._)(w,uC.ErrorMessage,"Bad image data URI in sketch to image"),(0,i._)(w,uC.ErrorCategory,IC.Error),w)))),Vh(Lh.IsImageInputEnabled)&&Vh(Lh.IsSketchToImageEnabled)&&_)?(ZR("Sketch to Image Intent Detected"),eL(lO.getTypeName()),P={imageTile:_,userPrompt:gN},x=new Vp.Xr({parentPath:["Signal",lO.getTypeName()],items:[{id:lx.r.generateId(),body:new lO(P)}]}),ob.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.PPTCopilotSketchOperationSubmitted}]),[2,{operation:x,workflowAnnotationType:cO.getTypeName()}]):(k=Vh(Lh.IsPreTriggerContentProcessingWorkflowEnabled),pN.sendChatEventTelemetry(HS((A={},(0,i._)(A,cC.ChatEventType,dC.PretriggerContentProcessing),(0,i._)(A,cC.ChatEventParameters,k),A))),T===hE.Unknown||E?[3,1]:(ZR("Summary Intent Detected: ",T),eL(Hx.getTypeName()),L={intent:T,queryLanguage:nF(TS(_p.GetHostAppDisplayLanguage())),queryId:n,isStreaming:!0,source:zR.IsSettingTrue(DR.TriggerSummary)?dp.Nudge_UserQuery:dp.AppChat_UserQuery},D=new Vp.Xr({parentPath:["Signal",Hx.getTypeName()],items:[{id:lx.r.generateId(),body:new Hx(L)}]}),lw.getInstance().setSkillName(mp.Summary),jE.getInstance().setState(Qd.WAITING_FOR_SUMMARY_WF_RESPONSE),pN.sendChatEventTelemetry(HS((O={},(0,i._)(O,cC.ChatEventType,dC.SummarizationOperationSubmitted),(0,i._)(O,cC.UserQueryGuid,n),(0,i._)(O,cC.RequestSignalSource,zR.IsSettingTrue(DR.TriggerSummary)?dp.Nudge_UserQuery:dp.AppChat_UserQuery),O))),[2,{operation:D,workflowAnnotationType:Vh(Lh.IsMarkdownSummarizationEnabled)?VE.getTypeName():TE.getTypeName()}]));case 1:return a&&"File"===a[0].QueryAnnotationType&&!E&&pR(t.toLowerCase(),r)?(ZR("Content Transformation Intent Detected"),null===(N=e.current)||void 0===N||N.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(R=Gx().get(Hd.CreatePresentation))&&void 0!==R?R:[]},FN())),M={contentType:ub.FileUrl,sourceBuffer:new Uint8Array([]),fileType:"docx",url:mR(t,r),lastModified:""},eL(yb.getTypeName()),B={correlationId:n,sourceContent:[M],entryPoint:XM.Chat,language:_p.GetHostAppDisplayLanguage(),fCreateNewPresentation:zR.IsSettingTrue(DR.PPTBBPresOutlineEnabled),templateId:CR(),jsonCmdApiVersion:yR(),fCreateJsonCmdList:Vh(Lh.IsCreateJsonCmdListForBumbleBeeEnabled)},U=new Vp.Xr({parentPath:["Signal",yb.getTypeName()],items:[{id:lx.r.generateId(),body:new yb(B)}]}),lw.getInstance().setSkillName(mp.ContentTransform),sb.getInstance().setScenarioName(Cv.CreatePresentationFromDoc),jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[2,{operation:U,workflowAnnotationType:fb.getTypeName()}]):[3,2];case 2:return H=(new Date).getTime(),[4,xN(t,r)];case 3:G=X.sent(),ZR("textTile Created: ".concat(JSON.stringify(G))),pN.sendLatencyTelemetry(HS((0,i._)({},sC.ContextTreeBuildTime,(0,qp.WU)(H)))),z=void 0,X.label=4;case 4:return X.trys.push([4,6,,7]),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.presentation.slides).load("item/id"),[4,e.sync()];case 1:return n.sent(),[2,t.items.map((function(e){return{id:e.id}}))]}}))}));return function(t){return e.apply(this,arguments)}}())];case 5:return z=X.sent(),[3,7];case 6:return q=X.sent(),ZR("Error while getting slide IDs for presentation: ".concat(q.message)),pN.sendErrorTelemetry(HS((W={},(0,i._)(W,uC.ErrorMessage,"Error while getting slide IDs for presentation: ".concat(q.message)),(0,i._)(W,uC.ErrorCategory,IC.Error),W))),pN.sendChatEventTelemetry(HS((j={},(0,i._)(j,cC.ChatEventType,dC.SlideFetchError),(0,i._)(j,cC.ChatErrorType,ep.Client),j))),[3,7];case 7:return ZR("Retrieved slide IDs for presentation.\n"+JSON.stringify(z)),_k(RK)?[4,wN(G,z,n,o,a,s,l,c,u,d,p,g)]:[3,9];case 8:return V=X.sent(),eL(sT.getTypeName()),Q=new Vp.g0({parentPath:["Signal",sT.getTypeName()],items:[{id:lx.r.generateId(),body:new sT(V)}]}),g||(lA=!0),ob.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.PPTCopilotFluxOperationSubmitted}]),[2,{operation:Q,workflowAnnotationType:VE.getTypeName()}];case 9:return eL(cT.getTypeName()),[4,IN(G,n,z)];case 10:return J=X.sent(),K=new Vp.Xr({parentPath:["Signal",cT.getTypeName()],items:[{id:lx.r.generateId(),body:new cT(J)}]}),pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.PPTCopilotOperationSubmitted))),[2,{operation:K,workflowAnnotationType:EP.getTypeName()}];case 11:return[2]}}))}));return function(t,n,r,o,i,a,s,l,c,u,d,p,g){return e.apply(this,arguments)}}(),BN=function(e){if(!(null==e?void 0:e.length))return null;var t=["Empty","Http","Unclean","Https_DropBox","Https_GoogleDrive","Email","Calendar"];Jh(Dh.CustomerOneDriveOnlyUrlChange)&&rR()&&!oF(WK())?t.push("Https"):t.push("Https_OneDrive"),oR()||t.push("Https_Wikipedia");var n=e.filter((function(e){return t.includes(e)}));return n.length>0?n[0]:null},UN=function(e){return aM.test(e)},HN=function(e){return sM.test(e)},GN=function(){var e=(0,gd._)((function(e,t,n,r,o,a){var s,l,c,u,d,p,g,m,f,h,v,y,C;return(0,F.__generator)(this,(function(S){switch(S.label){case 0:if(Vh(Lh.IsPersonalizationUXEnabled)&&Vh(Lh.IsPersonalizationConfirmationResponseEnabled)&&function(e){var t;Wp.getInstance().getIsPersonalizationHITLResponseCardActive()&&(Tg(e),wp.sendChatEventTelemetry(Ng(((t={})[Ap.ChatEventType]=Lp.UserOverridedPersonalizationHITL,t))),wp.sendLatencyTelemetry([],!0),Wp.getInstance().resetPersonalizationHITLActionState())}(e),pN.setQuerySubmitTime(qp.qD),pN.setQueryGuid(rM),pN.sendChatEventTelemetry(HS((s={},(0,i._)(s,cC.ChatEventType,dC.CIQLinkUsed),(0,i._)(s,cC.ChatEventParameters,!0===(o&&o.length>0&&o[0].value.length>0)),s))),l=lR(t,o),Vh(Lh.IsContentValidatorWorkflowEnabled)&&null===BN(l)&&$L(t,o),ib.getInstance().setCachedDocumentState(),Vh(Lh.isNetworkCheckEnabled)&&!_O.getInstance().IsConnectedToNetwork())return wL(e,PowerpointCopilotStrings.InternetNotAvailableErrorMessage),pN.logAshaErrorEvent(FS(RC.UnclearIntent,AC.UnableToCompleteTask),OC.InternetDisconnected),MS(pN,qp.qD,dC.InternetDisconnected,"",ep.Client),[2,!1];if(t.length>XF&&!Vh(Lh.IsInputV2Enabled))return ZR("ChatPPT: Query length is more than maximum allowable limit of "+XF+" characters."),wL(e,PowerpointCopilotStrings.ErrorQueryTooLarge),MS(pN,qp.qD,dC.LongMessageLength,"TokenCountError",ep.UnsupportedAction),[2,!1];if(Jh(Dh.LearnMoreOptionInMenuEnabled)&&t===vM.showHelpLink())return pN.sendChatEventTelemetry(HS((c={},(0,i._)(c,cC.ChatEventType,dC.LearnMoreOptionClicked),(0,i._)(c,cC.ChatEventParameters,"Help_Message"),c))),MS(pN,qp.qD),WN(e),[2,!1];if(!Vh(Lh.UrlDetailedErrorEnabled)&&JN(t))return d={errorMessage:PowerpointCopilotStrings.DocumentUrlEmptyError,errorType:yp.DocumentUrlEmptyError,featureName:_C.CreatePresentation,subFeatureName:MC.CreateFromFile},null===(u=e.current)||void 0===u||u.addResponseMessage(TL(PowerpointCopilotStrings.DocumentUrlEmptyError,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,d)),MS(pN,qp.qD,dC.DocumentUrlEmptyError,"TransformFile_DocumentURLEmpty",ep.UnsupportedAction),p=qw(AC.UserInputCouldNotBeProcessed,NC.DocumentUrlEmptyError),pN.logAshaErrorEvent(p.vetoName,p.errorString,p.featureName),[2,!1];if(Vh(Lh.UrlDetailedErrorEnabled)&&aR(t)&&(null==l?void 0:l.length)&&null!==BN(l)){switch(m=PowerpointCopilotStrings.DocumentUrlInvalidError,BN(l)){case"Empty":m=PowerpointCopilotStrings.DocumentUrlEmptyError;break;case"Http":case"Https_OneDrive":case"Https_DropBox":case"Https_GoogleDrive":case"Https_Wikipedia":m=Jh(Dh.CustomerOneDriveOnlyUrlChange)&&rR()&&!oF(WK())?PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError:PowerpointCopilotStrings.DocumentUrlNotFromSharePoint;break;case"Unclean":m=PowerpointCopilotStrings.DocumentUrlExtraChars;break;case"Email":m=PowerpointCopilotStrings.UnsupportedPersonUrlError;break;case"Calendar":m=PowerpointCopilotStrings.UnsupportedMeetingUrlError;break;case"Https":if(Jh(Dh.CustomerOneDriveOnlyUrlChange)&&rR()&&!oF(WK())){m=PowerpointCopilotStrings.TransformFileConsumerOneDriveOnlySupportedError;break}default:m=PowerpointCopilotStrings.DocumentUrlInvalidError}return f={errorMessage:m,errorType:void 0,featureName:_C.CreatePresentation,subFeatureName:MC.CreateFromFile},null===(g=e.current)||void 0===g||g.addResponseMessage(TL(m,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,f)),MS(pN,qp.qD,dC.DocumentUrlInvalidError,"TransformFile_DocumentURL"+BN(l),ep.UnsupportedAction),h=qw(AC.UserInputCouldNotBeProcessed,NC.DocumentUrlInvalidError),pN.logAshaErrorEvent(h.vetoName,h.errorString,h.featureName),[2,!1]}return pR(t.toLowerCase(),o)&&ib.getInstance().getSlideCountCached()>1?(y={errorMessage:"CreateNewPresentationFromExisting",errorType:void 0,featureName:_C.CopilotChat,subFeatureName:void 0},C=Sx(e,np.CreateNewPresentationFromExisting,r,!1,y),Zy.getInstance().setCachedRequestParameters(void 0,mR(t,o),void 0),Zy.getInstance().setWarningMessageActive(!0),null==e||null===(v=e.current)||void 0===v||v.addResponseMessage(C),jE.getInstance().setState(Qd.IDLE),r(!0),[2,!1]):t===FF()&&SN?(qN(e),SN=!1,a([]),[2,!1]):[4,hf()];case 1:return S.sent()?(HN(t)&&!ib.getInstance().isDocumentIrm()||UN(t)&&!ib.getInstance().isDocumentIrm()||(t.startsWith(vM.createPresentation().slice(0,-3))||t.startsWith(vM.transformFile().slice(0,-3))?(n(vM.createPresentation()),n(vM.transformFile())):t===vM.structurePresentation()&&n(vM.structurePresentation())),[2,!0]):(ZR("Sensitivity Label APIs failed, not sending request to AL"),[2,Promise.resolve(!1)])}}))}));return function(t,n,r,o,i,a){return e.apply(this,arguments)}}(),zN=function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return e&&window.open(e,"_blank"),[2]}))}));return function(t){return e.apply(this,arguments)}}(),qN=function(e){var t,n=MF()+BF()+UF()+HF(),r={chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:zd.Chat,message:n}},chatMessageBodyData:mL};null===(t=e.current)||void 0===t||t.addResponseMessage(r)},WN=function(e){var t,n={text:PowerpointCopilotStrings.LearnMoreAssistantResponsePrefix},r={linkText:{text:PowerpointCopilotStrings.LearnMoreAssistantResponseSuffix,linkOnClick:zN,linkUrl:IM}},o=[{listItems:TM().map((function(e){return{text:e}}))}],i={featureName:_C.CopilotChat,subFeatureName:void 0};null===(t=e.current)||void 0===t||t.addResponseMessage(DL(o,n,r,fL,!0,Wd.CHATPPT,i))},jN=function(){var e=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return t=e[0].split("doc\\"),n=t[t.length-1],[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return void 0!==n&&e.presentation.setSelectedSlides([n]),[4,e.sync()];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return r.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),VN=function(){var e=(0,gd._)((function(e){var t,n,r,o,a,s,l,c,u;return(0,F.__generator)(this,(function(d){switch(d.label){case 0:t={status:Md.SUCCESS},d.label=1;case 1:return d.trys.push([1,3,,4]),ZR("Triggering Play Key Slides Click for Slide Ids: ",e),pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.PlayKeySlidesButtonClicked))),r=(null!==(n=null==pN?void 0:pN.getQueryGuid())&&void 0!==n?n:"").length>0?pN.getQueryGuid():(0,dg.A)(),o=sb.getInstance(),a={scenarioName:o.getScenarioName(),startTime:o.getStartTime(),entryPoint:XM.Chat,correlationId:r,timeToODSLMS:1e3*o.getResponseTime(),timeODSLToJOfcMS:0,capability:o.getCapability(),featureName:o.getFeatureName(),subFeatureName:o.getSubFeatureName()},s={scenarioOptions:JSON.stringify(a)},l={actionName:yv.KeySlideShow,actionData:JSON.stringify(e),correlationId:r},[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,X_(e,[],s,l)];case 1:return t=n.sent(),e.sync(),ZR("Log result : ",JSON.stringify(t)),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return d.sent(),[3,4];case 3:return c=d.sent(),ZR("Execute failed:"+JSON.stringify(c)),t={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},pN.sendErrorTelemetry(HS((u={},(0,i._)(u,uC.ErrorMessage,"Error in handlePlayKeySlidesClick method: ".concat(null==c?void 0:c.message)),(0,i._)(u,uC.ErrorCategory,IC.PlayKeySlides),u))),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),QN=function(e){return'"'+(e.length>150?e.slice(0,150)+"...":e)+'"'},JN=function(e){return vM.transformFile().slice(0,-3).trim()===e.trim()||eM.createPresentationFrom().slice(0,-6).trim()===e.trim()||vM.transformFile().slice(0,-3).trim()+" ".concat(hM)===e.trim()||eM.createPresentationFrom().slice(0,-6).trim()+" ".concat(hM)===e.trim()||vM.transformFile().slice(0,-3).trim()+hM===e.trim()||eM.createPresentationFrom().slice(0,-6).trim()+hM===e.trim()},KN=function(e){try{return new RegExp("(".concat(["\\bdrive\\.google\\.com\\b"].join("|"),")"),"i").test(e)}catch(e){return ZR("Error during Google Drive pattern matching ",e.message),!1}},XN=function(e){try{return new RegExp("(".concat(["\\bhttps://[\\S]+\\.wikipedia\\.org/wiki/\\b"].join("|"),")"),"i").test(e)}catch(e){return ZR("Error during Wikipedia pattern matching ",e.message),!1}};function ZN(e){return YN.apply(this,arguments)}function YN(){return(YN=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return oR()&&null!==e&&XN(e)?[2,$N(e)]:[2,""]}))}))).apply(this,arguments)}function $N(e){return eR.apply(this,arguments)}function eR(){return eR=(0,gd._)((function(e){var t,n,r,o,a,s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(h){switch(h.label){case 0:t=e,h.label=1;case 1:if(h.trys.push([1,6,,7]),XN(e)&&(t=function(e){var t=e.match(/\/wiki\/([^\/?#]+)(?:[\/?#]|$)/i);return t?decodeURIComponent(t[1]):null}(e),!t))throw new Error("Empty Search Term");return n="https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=".concat(encodeURIComponent(t),"&format=json&origin=*"),[4,fetch(n)];case 2:if(!(r=h.sent()).ok)throw new Error("API Error");return[4,r.json()];case 3:if(0===(o=h.sent()).query.search)throw new Error("Empty Result");if(!(a=o.query.search[0].pageid))throw new Error("No PageId");return s="https://en.wikipedia.org/w/api.php?action=query&prop=extracts&exintro=&format=json&origin=*&pageids=".concat(encodeURIComponent(a)),[4,fetch(s)];case 4:if(!(l=h.sent()).ok)throw new Error("Cannot Retrieve Page");return[4,l.json()];case 5:if(c=h.sent(),u=c.query.pages,d=Object.keys(u)[0],!(p=u[d].extract)||p.includes("NewPP limit report"))throw new Error("Empty Page");return[2,p];case 6:return g=h.sent(),m="Error fetching Wikipedia page: ".concat(g.message),cN.error(m),pN.sendErrorTelemetry(HS((f={},(0,i._)(f,uC.ErrorMessage,m),(0,i._)(f,uC.ErrorCategory,IC.Error),f))),[3,7];case 7:return[2,""]}}))})),eR.apply(this,arguments)}var tR=function(e){try{return new RegExp("(".concat(["\\bwww\\.dropbox\\.com\\b"].join("|"),")"),"i").test(e)}catch(e){return ZR("Error during DropBox pattern matching ",e.message),!1}},nR=function(e){return e&&oR()&&XN(e)},rR=function(){return Vh(Lh.IsBumbleBeeEnabledForConsumer)},oR=function(){return Vh(Lh.IsWikipediaTransformFeatureEnabled)},iR=function(e){try{return new RegExp("(".concat(["\\b1drv-int\\.com\\b","\\b1drv\\.com\\b","\\badjust\\.com\\b","\\bapi\\.live\\.net\\b","\\bapis\\.live\\.net\\b","\\baria\\.microsoft\\.com\\b","\\bbranch\\.io\\b","\\bcrashlytics\\.com\\b","\\bdocs\\.live\\.net\\b","\\bfabric\\.io\\b","\\bfavorites\\.live\\.com\\b","\\bg\\.live\\.com\\b","\\bgroups\\.office\\.live\\.com\\b","\\bgroups\\.photos\\.live\\.com\\b","\\bgroups\\.skydrive\\.live\\.com\\b","\\blive\\.com\\b","\\blivefilestore\\.com\\b","\\blogin\\.live\\.com\\b","\\blogin\\.microsoftonline\\.com\\b","\\blogin\\.windows\\.net\\b","\\bmesh\\.com\\b","\\bmicrosoft\\.com\\b","\\bmobileengagement\\.windows\\.net\\b","\\boauth\\.live\\.com\\b","\\bodc\\.officeapps\\.live\\.com\\b","\\boffice\\.com\\b","\\bofficeapps\\.live\\.com\\b","\\boneclient\\.sfx\\.ms\\b","\\bonedrive\\.com\\b","\\bonedrive\\.live\\.com\\b","\\bp\\.sfx\\.ms\\b","\\bphotos\\.live\\.com\\b","\\bpolicies\\.live\\.net\\b","\\bposarprodcssservice\\.accesscontrol\\.windows\\.net\\b","\\bredemptionservices\\.accesscontrol\\.windows\\.net\\b","\\bservicebus\\.windows\\.net\\b","\\bsettings\\.live\\.net\\b","\\bskyapi\\.live\\.net\\b","\\bskydrive\\.live\\.com\\b","\\bsnapi\\.live\\.net\\b","\\bspoprod-a\\.akamaihd\\.net\\b","\\bstorage\\.live\\.com\\b","\\bstorage\\.msn\\.com\\b","\\btoken\\.cp\\.microsoft\\.com\\b","\\btokensit\\.cp\\.microsoft-tst\\.com\\b","\\bvas\\.samsungapps\\.com\\b","\\bvortex\\.data\\.microsoft\\.com\\b","\\b1drv\\.ms\\b","\\bsdrv\\.ms\\b","\\bdf\\.api\\.onedrive\\.com\\b","\\bdf\\.storage\\.live\\.com\\b","\\bdf\\.storage\\.msn\\.com\\b","\\bdf\\.livefilestore\\.com\\b","\\bfiles-df\\.1drv\\.com\\b","\\bdf\\.settings\\.live\\.net\\b","\\bdf\\.settings\\.live\\.net\\b","\\bdocs-df\\.live\\.net\\b","\\bdocs-df\\.live\\.net\\b"].join("|"),")"),"i").test(e)}catch(e){return ZR("Error during OneDrive pattern matching ",e.message),!1}},aR=function(e){return e.toLowerCase().startsWith(vM.transformFile().slice(0,-3).toLowerCase())||e.toLowerCase().startsWith(eM.createPresentationFrom().slice(0,-7).toLowerCase())},sR=function(e,t){if(!aR(e))return"Https";var n=new RegExp("".concat("https://[^\\s]*$"),"i"),r=new RegExp("".concat("https://outlook.office365.com/owa/[^\\s]*path=/calendar/item[^\\s]*$"),"i");if(t&&t.length>0&&t[0].value.length>0)try{var o=new RegExp("^mailto:[^\\s]*$","i");if(t[0].value.match(o))return"Email";if(t[0].value.match(n)){return t[0].value.match(r)?"Calendar":"Https"}return"Invalid"}catch(e){return ZR("Error during URL pattern matching ",e.message),"Https"}try{var i=vM.transformFile().slice(0,-3).trim()+"\\s*".concat(hM,"?"),a=eM.createPresentationFrom().slice(0,-6).trim()+"\\s*".concat(hM,"?"),s=new RegExp("(".concat(i,"|").concat(a,")$"),"i");if(e.match(s))return"Empty";if(e.match(n))return iR(e)?"Https_OneDrive":tR(e)?"Https_DropBox":KN(e)?"Https_GoogleDrive":e.match(r)?"Calendar":XN(e)?"Https_Wikipedia":"Https";var l=new RegExp("".concat("http://[^\\s]*$"),"i");if(e.match(l))return"Http";var c=new RegExp("".concat("['\"/]+(https|http)://[^\\s]*$"),"i");if(e.match(c))return"Unclean"}catch(e){return ZR("Error during URL pattern matching ",e.message),"Https"}return"Invalid"},lR=function(e,t){if(!aR(e))return["Https"];if(!Vh(Lh.IsMultiFileURLScreenFeatureEnabled))return[sR(e,t)];var n=new RegExp("".concat("https://[^\\s]*"),"i"),r=new RegExp("".concat("https://outlook.office365.com/owa/[^\\s]*path=/calendar/item[^\\s]*$"),"i"),o=[];if(t){var i=!0,a=!1,s=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;try{var d=new RegExp("^mailto:[^\\s]*$","i");if(u.value.match(d)&&o.push("Email"),u.value.match(n)){u.value.match(r)?o.push("Calendar"):o.push("Https")}}catch(e){ZR("Error during URL pattern matching ",e.message),o.push("Https")}}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}}try{var p=vM.transformFile().slice(0,-3).trim()+"\\s*".concat(hM,"?"),g=eM.createPresentationFrom().slice(0,-6).trim()+"\\s*".concat(hM,"?"),m=new RegExp("(".concat(p,"|").concat(g,")$"),"i");e.match(m)&&o.push("Empty"),e.match(n)&&(iR(e)&&o.push("Https_OneDrive"),tR(e)&&o.push("Https_DropBox"),KN(e)&&o.push("Https_GoogleDrive"),XN(e)&&o.push("Https_Wikipedia"),e.match(r)&&o.push("Calendar"));var f=new RegExp("".concat("http://[^\\s]"),"i");e.match(f)&&o.push("Http");var h=new RegExp("".concat("['\"/](https|http)://[^\\s]"),"i");e.match(h)&&o.push("Unclean")}catch(e){ZR("Error during URL pattern matching ",e.message),o.push("Https")}return o},cR=function(){var e=(0,gd._)((function(e){var t,n,r,o,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I;return(0,F.__generator)(this,(function(_){if(null===(t=e.body)||void 0===t?void 0:t.H_){if(a=null===(n=e.body)||void 0===n?void 0:n.queryId,!mb.getInstance().isValidAnnotationResponse(a))switch(e.body.H_.T_){case VE.getTypeName():return pN.setQueryGuid(a),MP(e.body),pN.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.InvalidContextIdResponse),(0,i._)(u,cC.ChatEventParameters,null!==(c=null===(l=e.body)||void 0===l||null===(s=l.H_)||void 0===s?void 0:s.T_)&&void 0!==c?c:""),u))),pN.setQueryGuid(rM),[2,!0];case EP.getTypeName():case EE.getTypeName():case TE.getTypeName():case IE.getTypeName():case uw.Ob.getTypeName():case uw.KJ.getTypeName():return pN.setQueryGuid(a),pN.sendChatEventTelemetry(HS((m={},(0,i._)(m,cC.ChatEventType,dC.InvalidContextIdResponse),(0,i._)(m,cC.ChatEventParameters,null!==(g=null===(p=e.body)||void 0===p||null===(d=p.H_)||void 0===d?void 0:d.T_)&&void 0!==g?g:""),m))),pN.setQueryGuid(rM),[2,!0]}if(f=null===(r=e.body)||void 0===r?void 0:r.correlationId,!mb.getInstance().isValidAnnotationResponse(f))switch(e.body.H_.T_){case fb.getTypeName():case Cw.getTypeName():case yw.getTypeName():case dw.getTypeName():return pN.setQueryGuid(f),pN.sendChatEventTelemetry(HS((C={},(0,i._)(C,cC.ChatEventType,dC.InvalidContextIdResponse),(0,i._)(C,cC.ChatEventParameters,null!==(y=null===(v=e.body)||void 0===v||null===(h=v.H_)||void 0===h?void 0:h.T_)&&void 0!==y?y:""),C))),pN.setQueryGuid(rM),[2,!0]}return S=null===(o=e.body)||void 0===o?void 0:o.contextId,mb.getInstance().isValidAnnotationResponse(S)||e.body.H_.T_!==gw.getTypeName()?[2,!1]:(pN.setQueryGuid(S),pN.sendChatEventTelemetry(HS((I={},(0,i._)(I,cC.ChatEventType,dC.InvalidContextIdResponse),(0,i._)(I,cC.ChatEventParameters,null!==(T=null===(E=e.body)||void 0===E||null===(b=E.H_)||void 0===b?void 0:b.T_)&&void 0!==T?T:""),I))),pN.setQueryGuid(rM),[2,!0])}return[2,!1]}))}));return function(t){return e.apply(this,arguments)}}(),uR=function(e,t){var n={},r={isEmailCollectionEnabled:Zd.false,isFileUploadEnabled:Zd.false,isScreenshotEnabled:Zd.false,isThankYouPageDisabled:Zd.true},o={isScenarioEnabled:!1,question:{questionUIType:"DropDown",questionInstruction:{displayedString:" ",displayedStringInEnglish:" "},questionOptions:[{displayedString:" ",displayedStringInEnglish:" "}]}};if(t&&(o.isScenarioEnabled=!0,o.scenarioType=t),void 0!==(null==e?void 0:e.cardMetaData)){var i={fileType:"text/plain; charset=utf-8",fileName:"contextData.txt",base64Data:uN.from(e.cardMetaData,"utf8").toString("base64")};r.contextDataFiles=[i]}return Jh(Dh.ScreenshotInFeedbackEnabled)&&(r.isScreenshotEnabled=Zd.true),RK&&Yh()&&(r.isEmailCollectionEnabled=Zd.false,r.isFileUploadEnabled=Zd.false,r.isScreenshotEnabled=Zd.false,r.isScreenRecordingEnabled=Zd.false,r.isHostManagedContextDataEnabled=Zd.true,r.hostManagedContextDataExplanationUrl=wM,r.isRetrieveFormDataEnabled=Zd.true),r.scenarioConfig=o,n.v2Config=r,n},dR=function(){var e=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){return[2,Vh(Lh.UseOfficeJSDocumentURL)?_p.getDocumentUrlAsync():void 0]}))}));return function(){return e.apply(this,arguments)}}(),pR=function(e,t){return Vh(Lh.IsPreTriggerContentProcessingWorkflowEnabled)&&!fR()&&gR(e,t)&&aR(e)},gR=function(e,t){if(Vh(Lh.UrlDetailedErrorEnabled)){var n=sR(e,t);return Jh(Dh.CustomerOneDriveOnlyUrlChange)?rR()&&!oF(WK())?"Https_OneDrive"===n:"Https"===n:"Https"===n||rR()&&"Https_OneDrive"===n}return""!==mR(e,t)},mR=function(e,t){if(t&&t.length>0)return t[0].value;var n="https://",r=e.indexOf(n);return-1!==r&&-1===e.indexOf(" ",r)?n+e.substring(r+8):""},fR=function(){return zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)};function hR(){switch(_p.GetHostAppPlatform()){case yM:return IO.Y.web;case SM:return IO.Y.MACOS;case bM:return IO.Y.IOS;default:return IO.Y.web}}var vR=function(e){var t={};try{t=JSON.parse(e)}catch(e){ZR("Error parsing telemetry data ",e.message)}return t};function yR(){return Jh(Dh.EnableGetJsonCmdVersion)?zR.getSettingAsString(DR.PPTJsonCmdAPIVersion):void 0}function CR(){return Jh(Dh.IsSegmentToSlideSendTemplateIdEnabled)&&ib.getInstance().isCreateNewFromBlank()?"":"NonEmptyTemplateId"}function SR(e){return ZR("isVisualSummaryFeatureEnabled: ".concat(Vh(Lh.IsVisualSummarizationEnabled),", intent: ").concat(e)),Vh(Lh.IsVisualSummarizationEnabled)&&e===hE.Summary}var bR=function(e){return e&&e.length>0?JO()("sha256").update(e).digest("hex"):null};function ER(){return TR.apply(this,arguments)}function TR(){return(TR=(0,gd._)((function(){var e,t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:e={},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.UserFeedback.GetHostScreenshot()];case 2:return e=r.sent(),[3,4];case 3:return t=r.sent(),pN.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"Error in OfficeFirstParty UserFeedback GetHostScreenshot: ".concat(t.message)),(0,i._)(n,uC.ErrorCategory,IC.Error),n))),ZR("Error in OfficeFirstParty UserFeedback GetHostScreenshot ",t),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function IR(){return _R.apply(this,arguments)}function _R(){return(_R=(0,gd._)((function(){var e,t,n,r,o,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:e=!1,s.label=1;case 1:return s.trys.push([1,3,,8]),[4,OfficeFirstParty.UserFeedback.CanCollectCopilotFeedback()];case 2:return e=s.sent(),ZR("OfficeFirstParty CanCollectCopilotFeedback : "+e),[3,8];case 3:t=s.sent(),s.label=4;case 4:return s.trys.push([4,6,,7]),pN.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"error in CanCollectCopilotFeedback Api : ".concat(t.message)),(0,i._)(n,uC.ErrorCategory,IC.Error),n))),ZR("Error in UserFeedback CanCollectCopilotFeedback : ",t),[4,OfficeFirstParty.UserFeedback.CanCollectUserFeedback()];case 5:return e=s.sent(),ZR("OfficeFirstParty CanCollectUserFeedback : ",e),[3,7];case 6:return r=s.sent(),pN.sendErrorTelemetry(HS((o={},(0,i._)(o,uC.ErrorMessage,"error in CanCollectUserFeedback Api : ".concat(r.message)),(0,i._)(o,uC.ErrorCategory,IC.Error),o))),ZR("Error in UserFeedback CanCollectUserFeedback : ",r),(a=zR.getSettingAsString(DR.FeedbackEnabled))&&(e="true"===a.toLowerCase(),ZR("HostAppSetting Feedbackenabled : ",e)),[3,7];case 7:return[3,8];case 8:return[2,e]}}))}))).apply(this,arguments)}var wR=function(e,t){try{OfficeFirstParty.UserFeedback.InvokeDiagnosticsLogsUpload(e)}catch(e){var n;pN.sendErrorTelemetry(HS((n={},(0,i._)(n,uC.ErrorMessage,"Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload: ".concat(e.message)),(0,i._)(n,uC.ErrorCategory,IC.Error),n))),ZR("Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload ",e)}},PR=function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e.getExternalDocSensitivityLabelInfo(),a=(t=o)?Vh(Lh.IsEmptyLabelFixForCLPv2FeatureEnabled)||t.tenantId?t.labelId?"":"labelId":"tenantId":"labelInfo";r&&a&&pN.sendChatEventTelemetry(HS((n={},(0,i._)(n,cC.ChatEventType,dC.CLPEmptySourceLabel),(0,i._)(n,cC.ChatEventParameters,a),n)));return""!==a},xR=function(){var e=(0,gd._)((function(e,t){var n,r,o;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:return ZR("Applying label using tryUpgradeLabel API"),pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CLPUpgradeLabelStart))),PR(e)?(pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CLPUpgradeLabelAborted))),[2,!0]):(n=e.getExternalDocSensitivityLabelInfo(),[4,e.upgradeSensitivityLabelUsingOfcJs(n)]);case 1:return r=a.sent(),pN.sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,dC.CLPUpgradeLabelStatus),(0,i._)(o,cC.ChatEventParameters,r.status),o))),t.payload=r.status,t.errorMessage=r.errorMessage,r.status!==Ip[Ip.S_APPLYLABEL_OK]&&r.status!==Ip[Ip.E_APPLYLABEL_NEWLABELSENSITIVITYORDER]?(t={status:Md.FAILED,error:Bd.APPLY_CLP_LABEL_FAILED,errorMessage:r.errorMessage},[2,!1]):[2,!0]}}))}));return function(t,n){return e.apply(this,arguments)}}();function kR(e,t){return t?qf.BD.highContrast:e!==Sh.G.defaultWhite?qf.BD.dark:qf.BD.default}function AR(){return LR.apply(this,arguments)}function LR(){return LR=(0,gd._)((function(){var e,t,n,r,o,i,a,s,l=arguments;return(0,F.__generator)(this,(function(c){switch(c.label){case 0:e=l.length>0&&void 0!==l[0]?l[0]:Sh.G.defaultWhite,t=l.length>1&&void 0!==l[1]&&l[1],n={locale:TS(_p.GetHostAppDisplayLanguage()),sessionId:zR.getSettingAsString(DR.ChatPPTSessionID),physicalRing:VR()?"Dogfood":"Prod",clientType:_p.isWebPlatform()?qf.WK.web:qf.WK.desktop,hubName:Jh(Dh.ShouldUseOfficeHubName)?qf.UH.office:qf.UH.orange,theme:kR(e,t),redirectUri:sN(),clientId:zm,aadUserId:"",userName:"",userPrincipalName:"",copilotChatThemev2:gm(lN,e,t)},r="",o="",c.label=1;case 1:return c.trys.push([1,3,,4]),[4,new Promise((function(e){return Office.context.auth.getAuthContextAsync(e)}))];case 2:return"succeeded"===(i=c.sent()).status?(a=i.value,r=a.userObjectId,o=a.userPrincipalName):ZR("Failed to fetch user id from OfficeJS"),[3,4];case 3:return s=c.sent(),ZR("Error getting user info: "+s),[2,n];case 4:return[2,Sd(Cd({},n),{aadUserId:o,userName:r,userPrincipalName:o})]}}))})),LR.apply(this,arguments)}var DR,OR=function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value,l="";switch(s){case Iw.ck.File:l=pB();break;case Iw.ck.Event:l=dB();break;case Iw.ck.People:l=gB();break;case Iw.ck.Message:l=mB()}t.push({entityType:s,message:l})}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t},NR=function(){var e=[rp.Ask,rp.Create,rp.Edit,rp.Understand];return Vh(Lh.IsPersonalizationUXEnabled)&&e.push(rp.Customize),e},RR=function(e,t,n,r,o,a,s,l,c){var u=sb.getInstance(),d=mb.getInstance(),p=AC.UserCancelledResponse,g=RC.UnclearIntent,m=u.getFeatureName();ZR("Stop Generation Clicked.");var f,h=sk&&!ak;if((h||NO&&!OO)&&!a){var v,y,C,S=null===(v=e.current)||void 0===v?void 0:v.getLastMessage(),b=null!==(C=null==S?void 0:S.messageType)&&void 0!==C?C:jp._.MarkdownCard;null===(y=e.current)||void 0===y||y.updateLastMessage({chatCardType:b,stopLoadingUi:!0}),h&&(m=Iv.Summarize,g=RC.Summarize)}if(pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,n))),Jh(Dh.IsShouldSendStopGeneratingSignaltoALEnabled)&&function(e,t){var n,r={query:rM,queryId:e,stopResponding:!0},o=new Vp.g0({parentPath:["Signal",sT.getTypeName()],items:[{id:lx.r.generateId(),body:new sT(r)}]});null===(n=t.current)||void 0===n||n.submitOperation({operation:o,workflowAnnotationType:VE.getTypeName()}),pN.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.StopGeneratingSignalSentToAL))),ZR("Stop Generating Signal Sent to AL")}(o,e),pN.logAshaErrorEvent(FS(g,p),r,m),pN.sendLatencyTelemetry(HS((f={},(0,i._)(f,sC.StopGeneratingTime,(0,qp.WU)(qp.qD)),(0,i._)(f,sC.AnnotationType,n),(0,i._)(f,sC.FeatureName,m),f)),!0),Vh(Lh.IsNotificationEnabledForSummary)&&Fk(u.getUserQueryGuid()),d.emptyContextIdListandCleanup(),Zy.getInstance().getIsWarningMessageActive()&&Ex(e),t)if(s.current=!0,pd()&&jE.getInstance().getState()===Qd.EXECUTING_APPLYJOFC_PROTOCOL){var E,T,I;null===(E=e.current)||void 0===E||E.startLoadingUi(),Office.context.ui.executeFeature(EM),null===(T=e.current)||void 0===T||T.updateLoadingComponentProps({loadingUiStringList:null!==(I=Gx().get(Hd.UserCancellation))&&void 0!==I?I:[]}),l(!1)}else{var _;jE.getInstance().setState(Qd.IDLE);var w={errorMessage:PowerpointCopilotStrings.StopGeneratingResponseMessage,errorType:yp.StopGeneratingResponseMessage,featureName:m,subFeatureName:void 0};null===(_=e.current)||void 0===_||_.addResponseMessage(TL(PowerpointCopilotStrings.StopGeneratingResponseMessage,mL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,w))}M_(!1,Sv.Cancelled),c(!1)},FR=function(e){mb.getInstance().removeContextId(e)},MR=function(){mb.getInstance().removeContextId(pN.getQueryGuid())},BR=function(e){if(function(e){return"bot"===e.author&&e.messageType===WE.Chat&&e.contentOrigin===fp.IMAGE_CHAT}(e)){var t=zw(e,!0);return{featureName:t.featureName,subFeatureName:t.subFeature}}};function UR(){return!ZA()}function HR(){return(HR=(0,gd._)((function(){var e,t;return(0,F.__generator)(this,(function(n){return e={triggeredPptVisualOperation:!0},t=new Vp.Xr({parentPath:["session","doc"],items:[{id:"triggeredPptVisualOperation",body:new sO(e)}]}),cF(vS)?pN.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerPptVisualOperation},{key:cC.ChatEventParameters,value:"Augloop Session undefined"}]):(ZR("Triggering PPT Visual Operation on Pane Launch"),pN.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerPptVisualOperation},{key:cC.ChatEventParameters,value:"Triggered PPT Visual Operation on Pane Launch"}]),vS.submitOperation(t)),[2]}))}))).apply(this,arguments)}!function(e){e.AugLoopCloudALServiceUrl="AugloopClouldALServiceUrl",e.ChatPPTSessionID="ChatPPTSessionID",e.AugloopSharedSessionID="AugloopSharedSessionID",e.PPTCreatorEnabled="PPTCreatorEnabled",e.PPTClientOrigin="PPTClientOrigin",e.PPTHandoffMessageId="HandoffMessageId",e.PPTHandoffMessage="HandoffMessage",e.PPTCopilotSearchEnabled="PPTCopilotSearchEnabled",e.PPTShowSuggestionsPill="PPTShowSuggestionsPill",e.PPTCIQDocMenuEnabled="PPTCIQDocMenuEnabled",e.PPTCopilotScnInsertImage="PPTCopilotScnInsertImage",e.PPTCopilotTextToImageEnabled="PPTCopilotEnableTextToImage",e.PPTStoryTellerExecutionResponse="PPTStoryTellerExecutionResponse",e.PPTEnableFluentVisualRefresh="PPTEnableFluentVisualRefresh",e.PPTCopilotScnCreatePresFromDoc="PPTCopilotScnCreatePresFromDoc",e.PPTCopilotScnCreatePresFromPrompt="PPTCopilotScnCreatePresFromPrompt",e.PPTCopilotScnAddSlide="PPTCopilotScnAddSlide",e.PPTCopilotScnAnimate="PPTCopilotScnAnimate",e.PPTCopilotScnOrganize="PPTCopilotScnOrganize",e.PPTCopilotDebugJOfcPayload="PPTCopilotDebugJOfcPayload",e.PPTCopilotScnBeautify="PPTCopilotScnBeautify",e.PPTCopilotScnCreatePresQueryAppState="PPTCopilotScnCreatePresQueryAppState",e.PPTDocumentState="PPTDocumentState",e.PPTBBPresOutlineEnabled="PPTBBPresOutlineEnabled",e.PPTContentGenerationDisabledByAdmin="PPTContentGenerationDisabledByAdmin",e.PPTCopilotUseScenarioOptionsTelemetry="PPTCopilotUseScenarioOptionsTelemetry",e.PPTJsonCmdAPIVersion="PPTJsonCmdAPIVersion",e.PPTIsConsumerUserAndLicensed="PPTIsConsumerUserAndLicensed",e.TriggerSummary="triggerSummary",e.TriggerCreatePresentationAbout="TriggerCreatePresentationAbout",e.TriggerCreatePresentationFromFile="TriggerCreatePresentationFromFile",e.TriggerAddASlide="TriggerAddASlide",e.TriggerCshCopilot="TriggerCshCopilot",e.FeedbackEnabled="FeedbackEnabled",e.InitiatorView="InitiatorView",e.AppStartTimestamp="AppStartTimestamp",e.CopilotPaneStartTimestamp="copilotPaneStartTimestamp"}(DR||(DR={}));var GR=!1,zR=function(){function e(){Sp(this,e)}return Ep(e,null,[{key:"getSettingAsString",value:function(e){var t=Office.context.hostSettings.get(e.toString());return cF(t)?t:"object"==typeof t?JSON.stringify(t):t.toString()}},{key:"getSetting",value:function(e){var t;return null===(t=Office.context.hostSettings)||void 0===t?void 0:t.get(e.toString())}},{key:"set",value:function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))}},{key:"IsSettingTrue",value:function(e){var t=this.getSettingAsString(e);return!!t&&"true"===t.toLowerCase()}}]),e}();function qR(){return(qR=(0,gd._)((function(){var e,t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return zh(Lh.UseCanCollectCopilotFeedbackAPI)?[2,IR()]:[3,1];case 1:return e=!0,(t=zR.getSettingAsString("FeedbackEnabled"))?(e="true"===t.toLowerCase(),[3,4]):[3,2];case 2:return[4,WR()];case 3:e=n.sent(),n.label=4;case 4:return ZR("Feedback Button View Enabled: "+e),[2,e];case 5:return[2]}}))}))).apply(this,arguments)}function WR(){return jR.apply(this,arguments)}function jR(){return(jR=(0,gd._)((function(){var e,t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:e=!0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.UserFeedback.CanCollectUserFeedback()];case 2:return e=n.sent(),ZR("OfficeFirstParty CanCollectUserFeedback : "+e),[3,4];case 3:return t=n.sent(),ZR("Error in OfficeFirstParty CanCollectUserFeedback : ",t),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function VR(){return!!GR||!(cF(zR.getSettingAsString("AugloopClouldALServiceUrl"))||!zR.getSettingAsString("AugloopClouldALServiceUrl").includes("dogfood"))&&(GR=!0,!0)}var QR=n(58651),JR=function(){var e,t=qF();return t[(e=t.length,Math.floor(Math.random()*e))]},KR=function(){return PowerpointCopilotStrings.PartialSuccessErrorMessage},XR=function(e){for(var t,n=e.length;0!==n;){var r;t=Math.floor(Math.random()*n),n--,r=[e[t],e[n]],e[n]=r[0],e[t]=r[1]}return e},ZR=function(e,t){(TF||VR())&&(null==t?QR.log("ChatPPT Log:",e):QR.log("ChatPPT Log:",e,t))},YR=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return t?[3,2]:[4,fetch(e)];case 1:return r=s.sent(),[3,4];case 2:return[4,Cm(aN,e,t)];case 3:r=s.sent(),s.label=4;case 4:if(!(n=r)||n&&!n.ok)throw o="toDataUrl: Could not fetch image at ".concat(e),ZR(o),new Error(o);s.label=5;case 5:return s.trys.push([5,7,,8]),[4,n.blob()];case 6:return i=s.sent(),[2,new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result.toString())},n.onerror=function(){return t()},n.readAsDataURL(i)}))];case 7:throw s.sent(),a="toDataUrl: Could not get base64 encoding of image at ".concat(e),ZR(a),new Error(a);case 8:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),$R=function(e){var t=e.match(/^data:image\/([a-zA-Z]+);base64,/);if(t&&2===t.length){var n=t[1];if(["jpeg","png"].includes(n))return e.replace(t[0],"")}return""},eF=function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,new Promise((function(t,n){var r=new Image;r.onload=function(){t({height:r.height,width:r.width})},r.onerror=function(){n("Could not load image to calculate size")},r.src=e}))]}))}));return function(t){return e.apply(this,arguments)}}(),tF=function(e){var t={actionFound:!1};return e=e.toLowerCase(),nM().some((function(n){return n.phrases.some((function(t){return t.split(",").every((function(t){return e.includes(t)}))}))&&(t={actionFound:!0,actionType:n.actionType,responseHeader:n.responseHeader,response:n.response}),t.actionFound})),t},nF=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en";return e.toLowerCase().includes("zh")?"zh-Hans":e.includes("-")?e.split("-")[0]:e};!function(){var e=(0,gd._)((function(e){var t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),(n=null===(t=document.getElementById(e))||void 0===t?void 0:t.textContent)?[4,navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([n],{type:"text/plain"})})])]:[3,2];case 1:o.sent(),o.label=2;case 2:return[3,4];case 3:return r=o.sent(),ZR("An error occurred while copying text to clipboard:",r.message),[3,4];case 4:return[2]}}))}))}();function rF(e){return ZR("UserType: ".concat(e,", ").concat(zR.getSettingAsString(DR.PPTIsConsumerUserAndLicensed))),cF(e)||e===Gg.Unknown?!(!cF(zR.getSettingAsString(DR.PPTIsConsumerUserAndLicensed))&&Jh(Dh.IsUserTypeFromHostSettingsEnabled))||"false"!==zR.getSettingAsString(DR.PPTIsConsumerUserAndLicensed).toLowerCase():e===Gg.Consumer}function oF(e){return e===Gg.Enterprise||!rF(e)}function iF(){return Lk()&&Vh(Lh.IsAllEntitiesSupported)&&Jh(Dh.IsUnsupportedEntitiesEnabled)}function aF(e,t){if(e<1||t<Dw())return!1;var n=ib.getInstance().getDocumentState().hasSection;return!(!Ix()&&n)}function sF(){var e;null===(e=window.document.getElementById(IF))||void 0===e||e.style.setProperty("display","none")}function lF(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function cF(e){return null==e}function uF(e){return""===e}function dF(e,t,n){return pF.apply(this,arguments)}function pF(){return pF=(0,gd._)((function(e,t,n){var r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:o=0,a.label=1;case 1:if(!(o<t))return[3,8];a.label=2;case 2:return a.trys.push([2,6,,7]),o>0?[4,lF(n)]:[3,4];case 3:a.sent(),a.label=4;case 4:return[4,e(o)];case 5:return[2,a.sent()];case 6:return i=a.sent(),r=i,[3,7];case 7:return o++,[3,1];case 8:throw r}}))})),pF.apply(this,arguments)}var gF=function(e){return e.replace(/\\u([\da-fA-F]{4})|\\b|\\n|\\r|\\t|\\'|\\"/g,(function(e,t){switch(e){case"\\u"+t:return String.fromCharCode(parseInt(t,16));case"\\b":return"\b";case"\\n":case"\\r":return"\r";case"\\t":return"\t";case"\\'":return"'";case'\\"':return'"';default:return""}}))},mF=function(e,t){return e.replace("%s",t)},fF=function(e){return!!_p.GetHostAppDisplayLanguage().startsWith(e)},hF=function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return ZR("Link clicked: "+e),window.open(e),[2]}))}));return function(t){return e.apply(this,arguments)}}(),vF=function(){return window.location.href.split("/")[4]};function yF(){return QM+JM[_p.GetHostAppPlatform()]}var CF,SF,bF,EF=function(e,t,n){var r=new Intl.DisplayNames([Office.context.displayLanguage],{type:"language"}),o=new Intl.DisplayNames(["en"],{type:"language"}),i=r.of(e),a=o.of(e);if(i&&a)return n===t&&(i=a),mF(null!=t?t:"",i.toLocaleLowerCase(e))},TF=!1,IF="shimmer",_F="I can't organize your presentation because it's in %s. For a list of supported languages, please visit ",wF="I don't yet support %s. For a list of supported languages, please visit ",PF="Conversion is not supported for file with extension .doc",xF="beautify",kF="sketch",AF="Debug",LF="Report Bug",DF="Hidden",OF=function(){switch(hR()){case IO.Y.web:return"cmmkg7c4w5f";case IO.Y.MACOS:return"cmm56zgpa3b";default:return"cmmt6q114wy"}},NF=function(){return hR()===IO.Y.MACOS?"pptmac":"ppt"},RF=function(){return fm()&&OfficeaicopilotStrings.OutOfCreditsError?OfficeaicopilotStrings.OutOfCreditsError:"Unfortunately, I can't complete that request because you're out of AI credits this month. Your credits will refill at the start of the next month."},FF=function(){return fm()&&OfficeaicopilotStrings.PersonalizationSuggestionText?OfficeaicopilotStrings.PersonalizationSuggestionText:"I want to get better responses by creating my Copilot profile."},MF=function(){return fm()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse1?OfficeaicopilotStrings.PersonalizationSuggestionResponse1:"Your Copilot profile should include your instructions to me about how you want me to answer. To create it, type: 'Create my Copilot profile: [followed by your instructions].'\n\n"},BF=function(){return fm()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse2?OfficeaicopilotStrings.PersonalizationSuggestionResponse2:"**For example:** \n\n**Create my Copilot profile: Include key people, numbers, and dates when answering a question or summarizing a document.**\n\n"},UF=function(){return fm()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse3?OfficeaicopilotStrings.PersonalizationSuggestionResponse3:"Once you create your profile, I'll be able to tailor my responses to you and generate personalized summaries and answers. To update your profile, type 'Update my Copilot profile: [followed by your instructions].' You can always ask me to delete your profile.\n\n"},HF=function(){return fm()&&OfficeaicopilotStrings.PersonalizationSuggestionResponse4?OfficeaicopilotStrings.PersonalizationSuggestionResponse4:"This feature is available in Word and PowerPoint in the Inner Ring (Dogfood) environment. Use thumbs up/down to send feedback to Feature Crew."},GF=function(){return[{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantSuggestionPrefixToUseDesignerOption1,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption1},{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantSuggestionPrefixToUseDesignerOption2,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption2},{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantSuggestionPrefixToUseDesignerOption3,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption3},{linkText:PowerpointCopilotStrings.RibbonButtonDesigner,linkPrefix:PowerpointCopilotStrings.AssistantStorytellerPromptResponseMessage,linkSuffix:PowerpointCopilotStrings.AssistantSuggestionToUseDesignerOption1}]},zF="<%ic>",qF=function(){return[PowerpointCopilotStrings.AssistantResponseMessage1,PowerpointCopilotStrings.AssistantResponseMessage2,PowerpointCopilotStrings.AssistantResponseMessage3,PowerpointCopilotStrings.AssistantResponseMessage4,PowerpointCopilotStrings.AssistantResponseMessage5,PowerpointCopilotStrings.AssistantResponseMessage6,PowerpointCopilotStrings.AssistantResponseMessage7]},WF=18e4,jF=3e5,VF=3,QF=1e3,JF=18e4,KF=function(){return[PowerpointCopilotStrings.AssistantCreatePresentationResponseMessageLine1,PowerpointCopilotStrings.AssistantCreatePresentationResponseMessageLine2,PowerpointCopilotStrings.AssistantCreatePresentationResponseMessageLine3]},XF=500,ZF=function(){return PowerpointCopilotStrings.RibbonOnlyActionInsertShapeInstructionsHeader},YF=function(){return[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),mF(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonShapes),PowerpointCopilotStrings.RibbonOnlyActionInsertShapeInstructions3,PowerpointCopilotStrings.RibbonOnlyActionInsertShapeInstructions4]},$F={menuTitle:function(){return PowerpointCopilotStrings.PromptGuideMenuTitlePrompts},menuSectionCreate:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionCreate},menuSectionUnderstand:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionUnderstand},menuSectionEdit:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionEdit},menuSectionAsk:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionAsk},menuSectionCustomize:function(){return OfficeaicopilotStrings.PromptGuideMenuSectionCustomize},menuSectionCreateImage:function(){return PowerpointCopilotStrings.PromptGuideMenuSectionCreateAnImage}},eM={createPresentationFrom:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreatePresentationFrom},addAgendaSlide:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddAgendaSlide},createPresentationAbout:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreatePresentationAbout},createPresentationAboutContoso:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreatePresentationAboutContoso},addSlideWithFAQ:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSlideWithFAQ},gatherRelatedFiles:function(){return PowerpointCopilotStrings.PromptGuideMenuItemGatherRelatedFiles},addSlideAbout:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSlideAbout},addSummarySlide:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSummarySlide},summarize:function(){return PowerpointCopilotStrings.PromptGuideMenuItemSummarize},datesAndDeadLines:function(){return PowerpointCopilotStrings.PromptGuideMenuItemDatesAndDeadLines},nextSteps:function(){return PowerpointCopilotStrings.PromptGuideMenuItemNextSteps},showActionItems:function(){return PowerpointCopilotStrings.PromptMenuItemShowActionItems},showKeySlides:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowKeySlides},showFiles:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowFiles},listProsAndCons:function(){return PowerpointCopilotStrings.PromptGuideMenuItemListProsAndCons},tellMeMore:function(){return PowerpointCopilotStrings.PromptGuideMenuItemTellMeMore},changeBodyText:function(){return PowerpointCopilotStrings.PromptGuideMenuItemChangeBodyText},tryNewDesign:function(){return PowerpointCopilotStrings.PromptGuideMenuItemTryNewDesign},addImage:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddImage},addEnterpriseImage:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddEnterpriseImage},rewriteSlide:function(){return PowerpointCopilotStrings.PromptGuideMenuItemRewriteSlide},organizePresentation:function(){return PowerpointCopilotStrings.PromptGuideMenuItemOrganizePresentation},includePageNumbers:function(){return PowerpointCopilotStrings.PromptGuideMenuItemIncludePageNumbers},rewriteBodyText:function(){return PowerpointCopilotStrings.PromptGuideMenuItemRewriteBodyText},showSelectedTextAsTable:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowSelectedTextAsTable},createCopilotProfile:function(){return PowerpointCopilotStrings.PromptGuideMenuItemCreateCopilotProfile},help:function(){return PowerpointCopilotStrings.PromptGuideMenuItemHelp},bestPracticesForPresentation:function(){return PowerpointCopilotStrings.PromptGuideMenuItemBestPracticesForPresentation},improvePresentation:function(){return PowerpointCopilotStrings.PromptGuideMenuItemImprovePresentation},animateBulletedList:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAnimateBulletedList},viewMorePrompts:function(){return OfficeaicopilotStrings.CopilotLabMenuSubItem},whatCanCopilotProfileDo:function(){return OfficeaicopilotStrings.PromptGuideMenuItemWhatCanCopilotProfileDo},createMyCopilotProfile:function(){return OfficeaicopilotStrings.PromptGuideMenuItemCreateMyCopilotProfile}},tM={createFromFile:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationFromFilePrompt},summarize:function(){return PowerpointCopilotStrings.PromptGuideMenuItemSummarize},addAgendaSlide:function(){return PowerpointCopilotStrings.ZQMV2AddASlidePrompt},fontSize:function(){return PowerpointCopilotStrings.ZQMV2FontSizePrompt},createPresentationConsumer:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationPrompt},datesAndDeadlines:function(){return PowerpointCopilotStrings.ZQMV2DatesAndDeadlinesPrompt},addAnImage:function(){return PowerpointCopilotStrings.ZQMV2AddAnImagePrompt},tableOfContent:function(){return PowerpointCopilotStrings.ZQMV2AddTableOfContents},addSlideAbout:function(){return PowerpointCopilotStrings.ZQMV2AddSlideAbout},showKeySlides:function(){return PowerpointCopilotStrings.PromptGuideMenuItemShowKeySlides},createPresentationAbout:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationPrompt},createPresentationAboutNationalPark:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationAboutNationalParkPrompt},createPresentationAboutCollaboration:function(){return PowerpointCopilotStrings.ZQMV2CreatePresentationAboutCollaborationPrompt},addAnImageOfCake:function(){return PowerpointCopilotStrings.ZQMV2AddAnImageOfCakePrompt},addSlideAboutMeeting:function(){return PowerpointCopilotStrings.PromptGuideMenuItemAddSlideAbout},showKeySlidesFromThisPresentation:function(){return PowerpointCopilotStrings.ZQMV2ShowKeySlidesPrompt},generateImage:function(){return PowerpointCopilotStrings.PromptGuideMenuItemGenerateImage}},nM=function(){return[{actionType:qd.Animation,phrases:["animate","animation"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionAddAnimationInstructionsHeader,response:[PowerpointCopilotStrings.RibbonOnlyActionAddAnimationInstructions1,mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabAnimations),PowerpointCopilotStrings.RibbonOnlyActionAddAnimationInstructions3]},{actionType:qd.SmartArt,phrases:["smartart","designer"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructionsHeader,response:[PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructions1,PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructions2,PowerpointCopilotStrings.RibbonOnlyActionUseDesignerInstructions3]},{actionType:qd.Transition,phrases:["morph","transition","format_slide,entranceeffect"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionTransitionsInstructionsHeader,response:[PowerpointCopilotStrings.RibbonOnlyActionTransitionsInstructions1,mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabTransitions),PowerpointCopilotStrings.RibbonOnlyActionTransitionsInstructions3]},{actionType:qd.Table,phrases:["table","create_chart","insert_chart","add_chart"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertTableInstructionsHeader,response:[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),PowerpointCopilotStrings.RibbonOnlyActionInsertTableInstructions2]},{actionType:qd.Background,phrases:["background","format_slides,backgroundcolor"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionFormatBackgroundInstructionsHeader,response:[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabDesign),mF(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonBackground),PowerpointCopilotStrings.RibbonOnlyActionFormatBackgroundInstruction3,PowerpointCopilotStrings.RibbonOnlyActionFormatBackgroundInstruction4]},{actionType:qd.Audio,phrases:["audio","music","add_sound","insert_sound","upload_sound"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertAudioInstructionsHeader,response:[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),PowerpointCopilotStrings.RibbonOnlyActionInsertAudioInstruction2]},{actionType:qd.Video,phrases:["video"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertVideoInstructionsHeader,response:[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),mF(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonVideo),PowerpointCopilotStrings.RibbonOnlyActionInsertVideoInstruction3]},{actionType:qd.Shapes,phrases:["shape"],responseHeader:ZF(),response:YF()},{actionType:qd.TextBox,phrases:["textbox","text boxes","text box"],responseHeader:PowerpointCopilotStrings.RibbonOnlyActionInsertTextBoxInstructionsHeader,response:[mF(PowerpointCopilotStrings.RibbonOnlyActionClickTabInstruction,PowerpointCopilotStrings.RibbonTabInsert),mF(PowerpointCopilotStrings.RibbonOnlyActionClickButtonInstruction,PowerpointCopilotStrings.RibbonButtonTextBox),PowerpointCopilotStrings.RibbonOnlyActionInsertTextBoxInstructions3]}]},rM="",oM="...",iM="ANNOTATION",aM=/(Create|Transform).*?(document|file)\s*(.*)\.docx/i,sM=/(Create|Make|Build|Construct|Generate|Produce|Start)(?:(?!\bthe\b).)*(presentation|deck)/i,lM=function(){return PowerpointCopilotStrings.InDocCitationTitle};!function(e){e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.ContextSensitiveHelpClickAction="ContextSensitiveHelpClickAction"}(CF||(CF={})),function(e){e.Missing="missing",e.WrongType="wrong-type",e.TooLong="too-long",e.NotSupported="not-supported",e.CouldNotDetect="could-not-detect",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.Unknown="unknown",e.BadResponse="bad-response",e.BadRequest="bad-request",e.InputBlockedByDynamicGuardList="input-blocked-by-guardlist",e.OffensiveInputContent="offensive-input-content",e.OutputBlockedByDynamicGuardList="output-blocked-by-guardlist",e.OffensiveOutputContent="offensive-output-content",e.Detected="detected",e.InputRaiDependency="input-rai-dependency",e.OutputRaiDependency="output-rai-dependency"}(SF||(SF={})),function(e){e.InvalidSignal="InvalidSignalError",e.InvalidInput="InvalidInputError",e.InvalidLanguage="InvalidLanguageError",e.InferenceAPI="InferenceAPIError",e.OffensiveContent="OffensiveContentError",e.PromptInjection="PromptInjectionError"}(bF||(bF={}));var cM,uM="Copilot Chat Pane UI Experience Degraded",dM="There was an error while trying to register the theme for the Copilot Chat pane";!function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized"}(cM||(cM={}));var pM,gM=7e4,mM=3e4,fM=60,hM="/",vM={addSlide:function(){return PowerpointCopilotStrings.PromptMenuItemAddSlide},addText:function(){return PowerpointCopilotStrings.PromptMenuItemAddText},changeTextFormat:function(){return PowerpointCopilotStrings.PromptMenuItemTextFormat},addImage:function(){return PowerpointCopilotStrings.PromptMenuItemAddImage},addEnterpriseImage:function(){return PowerpointCopilotStrings.PromptMenuItemAddEnterpriseImage},transformFile:function(){return PowerpointCopilotStrings.PromptMenuItemHumbleTransformFileAlt.trim()},animate:function(){return PowerpointCopilotStrings.PromptMenuItemAnimate},structurePresentation:function(){return pd()?PowerpointCopilotStrings.PromptMenuItemOrganize:PowerpointCopilotStrings.PromptMenuItemOrganizePresentation},createPresentation:function(){return PowerpointCopilotStrings.PromptMenuItemCreatePresentation},tryNewDesign:function(){return PowerpointCopilotStrings.PromptMenuItemTryNewDesign},summarizePresentation:function(){return pd()?PowerpointCopilotStrings.ZQMPromptItemSummarize:PowerpointCopilotStrings.PromptMenuItemSummarize},showKeySlides:function(){return PowerpointCopilotStrings.PromptMenuItemShowKeySlides},showActionItems:function(){return PowerpointCopilotStrings.PromptMenuItemShowActionItems},askAQuestion:function(){return pd()?PowerpointCopilotStrings.ZQMPromptItemAsk+oM:PowerpointCopilotStrings.PromptMenuItemAskAQuestion},showHelpLink:function(){return PowerpointCopilotStrings.PromptGuideMenuItemHelp},viewMorePrompts:function(){return OfficeaicopilotStrings.CopilotLabMenuSubItem}},yM="PC",CM="OFFICEONLINE",SM="MAC",bM="IOS",EM=34918,TM=function(){return[PowerpointCopilotStrings.LearnMoreAssistantResponseListItem1,PowerpointCopilotStrings.LearnMoreAssistantResponseListItem2,PowerpointCopilotStrings.LearnMoreAssistantResponseListItem3,PowerpointCopilotStrings.LearnMoreAssistantResponseListItem4]},IM="https://go.microsoft.com/fwlink/?linkid=2246424",_M="https://go.microsoft.com/fwlink/?linkid=2239972",wM="https://go.microsoft.com/fwlink/?linkid=2250136",PM="https://go.microsoft.com/fwlink/?linkid=2247343",xM="File url is null or empty.",kM="Document has UDP label",AM="Document has unsupported label type",LM="Document has other expected protection",DM="Document is password protected",OM="User has no rights in the file's label",NM="User has no extraction rights in the file's label",RM="Document is IRM Protected",FM=function(){return fm()?OfficeaicopilotStrings.CopyButtonLabel:"Copy"},MM=function(){return fm()?OfficeaicopilotStrings.CopyButtonPopover:"Copied to clipboard"},BM=function(){return fm()?PowerpointCopilotStrings.PlayKeySlidesButtonLabel:"Play Key Slides"},UM=function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return fm()&&null!=e?e:t}(mF(PowerpointCopilotStrings.SlideN,e.toString()),"Slide ".concat(e))},HM=function(){return _p.GetHostAppPlatform()===yM?OfficeaicopilotStrings.MicrophonPermissionErrorTitleWin32:OfficeaicopilotStrings.MicrophonPermissionErrorTitle},GM=function(){return _p.GetHostAppPlatform()===yM?OfficeaicopilotStrings.MicrophonPermissionErrorTextWin32:OfficeaicopilotStrings.MicrophonPermissionErrorText},zM=function(){return _p.GetHostAppPlatform()===CM},qM=function(){return fm()?PowerpointCopilotStrings.ChatPlaceholderMessageUpdated:"Ask me anything about this presentation"},WM=1624461388,jM=128,VM="1.2.0.0",QM="https://copilot.cloud.microsoft/prompts?ocid=",JM={OFFICEONLINE:"copilotlab_powerpointchatweb",PC:"copilotlab_powerpointchatwin32",MAC:"copilotlab_powerpointchatmac",IOS:"copilotlab_powerpointchatios"},KM={OFFICEONLINE:"PowerPoint.Web.Copilot_Lib",PC:"PowerPoint.Win32.Copilot_Lib",MAC:"PowerPoint.Mac.Copilot_Lib",IOS:"PowerPoint.iPad.Copilot_Lib"};!function(e){e.QuickAnswer="QuickAnswer",e.HelpArticle="HelpArticle"}(pM||(pM={}));var XM,ZM="",YM=100,$M="/Sydney",eB="This summary is based on the textual content of presentation. You can read it while your full summary with text and visuals (images, charts, etc.) is being generated.",tB="Here's a summary of the presentation based on text and visuals:",nB="Generating full summary...",rB="Including summary from visuals...",oB="Analysing images...",iB="Synthesizing text and visuals...",aB="Almost there...",sB=function(){return fm()?OfficeaicopilotStrings.CseSelfHelpSkillContentRetrievedQuickAnswer:"Here's what I found:"},lB=function(){return fm()?OfficeaicopilotStrings.CseSelfHelpSkillContentRetrievedSingleArticle:"Here's what I found:"},cB=function(){return fm()?OfficeaicopilotStrings.CseSelfHelpSkillErrorOrNoContentRetrieved:"Sorry, I'm having trouble finding information about that. Please rephrase your request and try again."},uB=function(){return fm()?PowerpointCopilotStrings.CseSelfHelpSkillSourceLabel:"PowerPoint Help"},dB=function(){return fm()?OfficeaicopilotStrings.MeetingSuggestionNotAvailable:"Meeting suggestions aren't available"},pB=function(){return fm()?OfficeaicopilotStrings.FileSuggestionNotAvailable:"File suggestions aren't available"},gB=function(){return fm()?OfficeaicopilotStrings.PeopleSuggestionNotAvailable:"People suggestions aren't available"},mB=function(){return fm()?OfficeaicopilotStrings.EmailSuggestionNotAvailable:"Email suggestions aren't available"};!function(e){e.Chat="Chat"}(XM||(XM={}));var fB,hB="Create presentation from",vB="Create presentation about",yB="Add a slide",CB="Organize this presentation",SB="Add an image of",bB="Add an agenda slide",EB="Animate this slide",TB="I don't recognize that wording as something I can do. Here are some examples of ways I can help, with the exact words to use:",IB="copilotChat",_B="reviewerAgent",wB="Reviewer",PB="execute",xB="telemetry",kB="PptCopilotActionApi",AB="1.4",LB="1.5",DB=function(){return[{key:Cp.TRIGGERING_VISUALS_FLOW,value:fm()?PowerpointCopilotStrings.SummaryProgressStage1:"Scanning presentation again..."},{key:Cp.GRAPH_API_SUCCEED,value:fm()?PowerpointCopilotStrings.SummaryProgressStage1:"Scanning presentation again..."},{key:Cp.THUMBNAILS_DOWNLOADED,value:fm()?PowerpointCopilotStrings.SummaryProgressImprovementStage:"Checking for any improvement..."},{key:Cp.VD_GENERATION_ONGOING,value:fm()?PowerpointCopilotStrings.SummaryProgressImprovementStage:"Checking for any improvement..."},{key:Cp.VD_GENERATION_COMPLETED,value:fm()?PowerpointCopilotStrings.LoadingUIWorkingOnItStep:"Working on it..."},{key:Cp.SUMMARY_SIGNAL_TRIGGERED,value:fm()?PowerpointCopilotStrings.LoadingUILookingThingsOver:"Looking things over..."},{key:Cp.VISUAL_SUMMARY_GENERATING,value:fm()?PowerpointCopilotStrings.LoadingUIAlmostThere:"Almost there..."},{key:Cp.VISUAL_SUMMARY_FIRST_STREAMING_CHUNK,value:fm()?PowerpointCopilotStrings.LoadingUiFinishingUpStep:"Finishing up..."},{key:Cp.VISUAL_SUMMARY_GENERATED,value:fm()?PowerpointCopilotStrings.LoadingUiFinishingUpStep:"Finishing up..."},{key:Cp.VISUAL_DESCRIPTION_FAILURE,value:RB()},{key:Cp.THUMBNAIL_API_FAILURE,value:RB()},{key:Cp.SUMMARY_SIGNAL_NOT_TRIGGERED,value:RB()},{key:Cp.GRAPH_API_FAILED,value:RB()},{key:Cp.NO_THUMBNAILS_FOUND,value:RB()},{key:Cp.VISUAL_SUMMARY_GENERATION_FAILED,value:RB()}]},OB=function(){return fm()?PowerpointCopilotStrings.SummaryProgressGenericMessageHeader:"Working on your summary to improve it"},NB=function(){return fm()?PowerpointCopilotStrings.SummaryGenericSuccessButtonText:"Show improved summary"},RB=function(){return fm()?PowerpointCopilotStrings.SummaryProgressGenericFailureMessage:"No improvements in the summary as of now. Feel free to ask me a question about this deck"},FB=function(){return fm()?OfficeaicopilotStrings.ChatContainerInsertActionButtonText:"Insert"},MB=function(){return fm()?PowerpointCopilotStrings.LoadingUIWorkingOnItStep:"Working on it..."},BB=function(){return"How do I insert a shape?"},UB="Empty body in notification",HB="Empty query in notification",GB="Stale query in notification",zB="Ignore notification for incomplete card content",qB="Empty message id for inprogress notification",WB="Empty message id for completed notification",jB="Empty message id for disable button notification",VB="Empty message id for failed notification",QB="Timeout occurred for notification",JB="Completed notification received",KB="Empty visual summary response",XB="No body in visual summary response",ZB="Notification success button clicked",YB="Empty action parameter in notification",$B="Exception while logging ClickableKeySlidesEnabled event",eU="Exception onLinkClick for clickable key slides: Error while sending telemetry",tU="Exception onLinkClick for clickable key slides: Error while running setSelectedSlides",nU="Exception in getKeySlidesClickableElement: Error while getting slideId",rU="Exception in getKeySlidesClickableElement: Parsing error";!function(e){e[e.pptChat=0]="pptChat",e[e.wordChat=1]="wordChat"}(fB||(fB={}));var oU,iU=n(62059),aU=n(18263);!function(e){e.Close="close",e.Move="move",e.Resize="resize",e.Help="help",e.ExpandOrCollapse="expandOrCollapse"}(oU||(oU={}));var sU,lU=Cd({},{isSpaceRequiredAfterInput:Jh(Dh.IsSpaceRequiredAfterInput),isChatCardFactoryMemoizationEnabled:!0,isSccVoiceEnabled:Vh(Lh.IsSccVoiceEnabled),isSccCiqEnabled:Vh(Lh.IsSccCiqEnabled),isCustomGPTsEnabled:Vh(Lh.IsCustomGPTsEnabled),isClaimsChallengeMessageInAnnotationEnabled:Jh(Dh.isClaimsChallengeMessageInAnnotationEnabled),isGroupedCopilotPluginEnabled:Jh(Dh.IsGroupedCopilotPluginEnabled),isCustomHandlingForChatHistoryEnabled:Vh(Lh.IsCustomHandlingForChatHistoryEnabled),isApiPluginsEnabled:Vh(Lh.IsApiPluginsEnabled),useFreFlagRoamingService:Jh(Dh.useFreFlagRoamingService),showPluginFlyoutTeachingPopoverEnabled:Vh(Lh.ShowPluginFlyoutTeachingPopoverEnabled),isSketchImageCardEnabled:Jh(Dh.IsSketchImageCardEnabled),isSketchImageResizeEnabled:Jh(Dh.IsSketchImageResizeEnabled),shouldRenderAllHyperLinks:Vh(Lh.ShouldRenderAllHyperLinks),isPasteUnfurlingEnabled:Vh(Lh.IsPasteUnfurlingEnabled),enableMorePlugins:Jh(Dh.EnableMorePlugins),useExternalAuthService:Jh(Dh.UseExternalAuthService),showSystemMessageOnPluginToggle:Jh(Dh.ShowSystemMessageOnPluginToggle),isStringReplacementAnchorTagOverrideEnabled:Jh(Dh.IsStringReplacementAnchorTagOverrideEnabled),isViewMorePromptsIconV2Enabled:Vh(Lh.IsViewMorePromptsIconV2Enabled),isViewMorePromptsOneClickEnabled:Vh(Lh.IsViewMorePromptsOneClickEnabled),enableCreatePpcConnections:Vh(Lh.EnableCreatePpcConnections),isQueryWarmupSignalEnabled:Vh(Lh.IsQueryWarmupSignalEnabled),isQueryWarmupSignalEnabledOnChatPaneOpens:Vh(Lh.IsQueryWarmupSignalEnabledOnChatPaneOpens),isCreditsUIEnabled:Vh(Lh.IsCreditsUIInternalEnabled),isPluginStatePersist:Vh(Lh.IsPluginStatePersistEnabled),isPowerPlatformPluginsEnabled:Vh(Lh.IsPowerPlatformPluginsEnabled),shouldUseMsalSsoSilentLogin:Vh(Dh.ShouldUseMsalSsoSilentLogin),isChatClickForGPTsEnabled:Vh(Lh.IsChatClickForGPTsEnabled),showNewChatOnGPTItem:Vh(Lh.IsNewChatOnGPTItemsEnabled),enableNewChatOnlyOnCopilot:Vh(Lh.IsNewChatOnCopilotGPTItemEnabled),showPluginReferencesV3:Jh(Dh.ShowPluginReferencesV3),isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:Vh(Lh.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled),enableQueryBeforeAnnotationLoad:Vh(Lh.EnableQueryBeforeAnnotationLoad),isCloudFileUploadEnabled:Vh(Lh.IsCloudFileUploadEnabled),enablePluginSearchInFlyout:Jh(Dh.EnablePluginSearchInFlyout),enableMorePluginHyperLinkInFlyout:Jh(Dh.EnableMorePluginHyperLinkInFlyout),isAttachmentListEnabled:Vh(Lh.IsAttachmentListEnabled),useUpdatedGroundingButtonTitle:Jh(Dh.UseUpdatedGroundingButtonTitle),enableQueryEndOnGptSwitch:Jh(Dh.EnableQueryEndOnGptSwitch),promptInputLength:qh(Lh.PromptInputLength,2e3)});!function(e){e.ChatPPTExitClicked="ChatPPTExitClicked",e.ChatPPTLikeClicked="ChatPPTLikeClicked",e.ChatPPTDislikeClicked="ChatPPTDislikeClicked",e.ChatPPTSuggestionClicked="ChatPPTSuggestionClicked",e.ChatPPTShowDesigner="ChatPPTShowDesigner",e.ChatPPTQueryExecutionStart="ChatPPTQueryExecutionStart",e.ChatPPTQueryExecutionComplete="ChatPPTQueryExecutionComplete",e.ChatPPTExecuteInsertSlideOperation="ChatPPTExecuteInsertSlideOperation",e.ChatPPTSearchClicked="ChatPPTSearchClicked",e.ChatPPTSlideUpdateCheckSuccessful="ChatPPTSlideUpdateCheckSuccessful",e.ChatPPTInsertImageSuccessful="ChatPPTInsertImageSuccessful",e.ChatPPTTriggerCommentHighlight="ChatPPTTriggerCommentHighlight"}(sU||(sU={}));class cU{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(cU,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotWarmupAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[cU.getTypeName()])}}cU.H_={T_:cU.getTypeName(),B_:cU.getBaseTypes()};class uU{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(uU,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[uU.getTypeName()])}}uU.H_={T_:uU.getTypeName(),B_:uU.getBaseTypes()};class dU{constructor(e){Qp.h.assign(dU,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_Powerpoint_PowerPointDocumentStateAnnotations"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[dU.getTypeName()])}}function pU(e){try{var t="";cF(zR.getSettingAsString(DR.PPTClientOrigin))||zR.getSettingAsString(DR.PPTClientOrigin)==rM||(t=zR.getSettingAsString(DR.PPTClientOrigin)),window.parent.postMessage(e,t)}catch(t){ZR(" SendMessageToHost failed with exception: "+t.message+" for event: "+JSON.stringify(e))}}dU.H_={T_:dU.getTypeName(),B_:dU.getBaseTypes()};var gU=n(34778),mU=n(22164);function fU(e,t,n){return fU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rC(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n||e):o.value}},fU(e,t,n||e)}var hU=n(78052),vU=n(49605);class yU{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(yU,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_DiagnosticUploadResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[yU.getTypeName()])}}yU.H_={T_:yU.getTypeName(),B_:yU.getBaseTypes()};var CU,SU=n(14419),bU=n(21612),EU=function(){var e=[],t={staticStrings:[{key:"raiError",value:PowerpointCopilotStrings.ErrorOffensiveContentBlocked},{key:"genericError",value:PowerpointCopilotStrings.ServerErrorMessage},{key:"designerMsg",value:PowerpointCopilotStrings.AssistantResponseInsertLine2}]},n=qh(Lh.AugloopResponseTimeoutDuration,65e3),r=qh(Lh.StorytellerOutlineResponseTimeoutDuration,6e4);return Vh(Lh.IsNotificationEnabledForSummary)&&e.push({workflowAnnotationType:Wk.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:uU.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:xw.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:uw.KJ.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),e.push({workflowAnnotationType:uw.Ob.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),Vh(Lh.IsMarkdownSummarizationEnabled)||(e.push({workflowAnnotationType:TE.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:Vh(Lh.IsVisualSummarizationEnabled)?WF:n}),e.push({workflowAnnotationType:IE.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:Vh(Lh.IsVisualSummarizationEnabled)?WF:n})),e.push({workflowAnnotationType:EP.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),e.push({workflowAnnotationType:TP.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:IP.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:fb.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:jF}),e.push({workflowAnnotationType:yw.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:jF}),e.push({workflowAnnotationType:hb.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:Cw.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),Vh(Lh.IsContentValidatorWorkflowEnabled)&&e.push({workflowAnnotationType:jL.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),e.push({workflowAnnotationType:dw.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),e.push({workflowAnnotationType:dU.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:gw.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:r}),Vh(Lh.IsPresentationTransformerWFEnabled)&&e.push({workflowAnnotationType:ED.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),(Jh(Dh.IsNewPptCopilotWorkflowIntegrationEnabled)||ev())&&(e.push({workflowAnnotationType:VE.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n,config:Jh(Dh.ShouldSendALConfigForRAI)?t:void 0}),e.push({workflowAnnotationType:SU.Pd.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:5e3}),Vh(Lh.IsPresentationRecommendationEnabled)&&e.push({workflowAnnotationType:fD.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n})),Jh(Dh.IsNewPptCopilotWorkflowIntegrationEnabled)||ev()||e.push({workflowAnnotationType:SU.tP.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:5e3}),Vh(Lh.IsCopilotPromptLabEnabled)&&e.push({workflowAnnotationType:gU.x.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),Yh()&&e.push({workflowAnnotationType:yU.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}),(Vh(Lh.HandoffEnabled)||Vh(Lh.InAppHandoffEnabled))&&(e.push({workflowAnnotationType:_h.uC.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),e.push({workflowAnnotationType:_h.dF.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),e.push({workflowAnnotationType:_h.kp.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n})),e.push({workflowAnnotationType:_P.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),zh("IsLicenseAnnotationEnabled",!1)&&e.push({workflowAnnotationType:vU.Ml.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,forceReturnCachedAnnotations:!0}),Vh(Lh.IsPersonalizationUXEnabled)&&Vh(Lh.IsPersonalizationConfirmationResponseEnabled)&&e.push({workflowAnnotationType:Kp.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),Vh(Lh.IsImageInputEnabled)&&Vh(Lh.IsSketchToImageEnabled)&&e.push({workflowAnnotationType:cO.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),Vh(Lh.IsCreditsUIInternalEnabled)&&e.push({workflowAnnotationType:bU.d.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),e},TU=function(e){eC(n,e);var t=aC(n);function n(e,r,o,a,s,l,c,u){var d;return Sp(this,n),d=t.call(this),(0,i._)(Yy(d),"handleResponseItem",void 0),(0,i._)(Yy(d),"sharedCopilotEventHandler",void 0),(0,i._)(Yy(d),"sharedCopilotLoggingEventHandler",void 0),(0,i._)(Yy(d),"copilotChatRef",void 0),(0,i._)(Yy(d),"disableMenuOptions",void 0),(0,i._)(Yy(d),"setIsGeneratingResponse",void 0),(0,i._)(Yy(d),"setDisableChatInput",void 0),(0,i._)(Yy(d),"signalSubmitTime",void 0),(0,i._)(Yy(d),"hvcPromptDetected",tE.NotACommand),(0,i._)(Yy(d),"hvcPromptStringsList",[]),(0,i._)(Yy(d),"hvcPromptToHVCCategoryMap",{}),(0,i._)(Yy(d),"setSuggestionListPool",void 0),d.handleResponseItem=e,d.sharedCopilotEventHandler=r,d.copilotChatRef=o,d.disableMenuOptions=a,d.sharedCopilotLoggingEventHandler=s,d.signalSubmitTime=0,d.setIsGeneratingResponse=l,d.setDisableChatInput=c,d.setSuggestionListPool=u,d}return Ep(n,[{key:"sendResponseToClient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rM;ZR("Item: ",e),ZR("Cv: ",t),this.handleResponseItem(e,this.signalSubmitTime,t)}},{key:"sendEventToClient",value:function(e,t){var n=this;return(0,gd._)((function(){return(0,F.__generator)(this,(function(r){return n.sharedCopilotEventHandler(e,t),[2]}))}))()}},{key:"sendLoggingEventToClient",value:function(e,t){var n=this;return(0,gd._)((function(){return(0,F.__generator)(this,(function(r){return n.sharedCopilotLoggingEventHandler(e,t),[2]}))}))()}},{key:"isFeatureGateEnabledFromClient",value:function(e){return e===ig.WT.IsClpSensitivityInChatInputEnabled?Vh(Lh.IsClpSensitivityInChatInputEnabled):e===ig.WT.EnableALCorrelationLogs?Jh(Dh.EnableALCorrelationLogs):e===ig.WT.EnableMsgExtCardTelemetry?Jh(Dh.IsMsgExtTelemetryEnabled):e===ig.WT.IsWebSearchDefaultOn?Jh(Dh.IsWebSearchDefaultOn):e===ig.WT.IsPersistanceInPhase2UxEnabled?oF(WK())&&Jh(Dh.IsPersistanceInPhase2UxEnabled):e===ig.WT.EnableCopilotExtTelemetry?Jh(Dh.IsCopilotExtTelemetryEnabled):Vh(e)}},{key:"getNumberFeatureGateValueFromClient",value:function(e){return qh(e,NaN)}},{key:"getWorkflowsToRegister",value:function(){return EU()}},{key:"getALSession",value:function(){return(0,gd._)((function(){return(0,F.__generator)(this,(function(e){return function(e){ZR("setting doc session id:",e),cF(e)||(bS=e)}(zR.getSettingAsString(DR.AugloopSharedSessionID)),(cF(vS)||vS.isClosed)&&(ZR("getting AL session for doc session id:",ES()),vS=mS(ES())),[2,vS]}))}))()}},{key:"getHostSettings",value:function(){var e={appName:"PowerPoint",appPlatform:_p.GetHostAppPlatform(),devBuild:TF||VR(),environment:Iw.DF.DOGFOOD,sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com",getDocumentUrlAsync:Vh(Lh.UseOfficeJSDocumentURL)?_p.getDocumentUrlAsync:void 0,language:TS(_p.GetHostAppDisplayLanguage()),substrateScenarioName:KM[_p.GetHostAppPlatform()],sessionStorageKey:this.getSessionStorageKey()};return Vh(Lh.IsFeedbackAppChatIntegrationEnabled)&&(e.feedbackSettings=function(){if(xS)try{var e=JSON.parse(xS);return e&&(e=Sd(Cd({},e),{callbackFunctions:Sd(Cd({},e.callbackFunctions),{provideDynamicScreenshot:ER}),feedbackConfig:Sd(Cd({},e.feedbackConfig),{diagnosticsConfig:Sd(Cd({},e.feedbackConfig.diagnosticsConfig),{attachDiagnostics:wR})})})),Jh(Dh.IsFeedbackAppChatThemingEnabled)?{feedbackInitOptions:e,lightTheme:{baseTheme:"PowerPointLightTheme"},darkTheme:{baseTheme:"PowerPointDarkTheme"}}:{feedbackInitOptions:e}}catch(e){var t;return pN.sendErrorTelemetry(HS((t={},(0,i._)(t,uC.ErrorMessage,"Error in parsing feedbackInitializationData to JSON: ".concat(e.message)),(0,i._)(t,uC.ErrorCategory,IC.Error),t))),void ZR("Error in parsing feedbackInitializationData to JSON ",e)}}()),e}},{key:"getSessionStorageKey",value:function(){var e,t,n,r=window.Office.context,o=null==r?void 0:r.platform,i=null==r||null===(e=r.hostSettings)||void 0===e?void 0:e["_settings?.IsCopilotPreloaded"];if(o===window.Office.PlatformType.OfficeOnline)t=null==r||null===(n=r.hostSettings)||void 0===n?void 0:n.get("AppStartTimestamp");else if(i){var a,s,l,c=null==r||null===(l=r.document)||void 0===l||null===(s=l.settings)||void 0===s||null===(a=s._clientSettingsManager)||void 0===a?void 0:a._osfClientContext,u=null==c?void 0:c.GetCorrelationId(),d=null==c?void 0:c.GetDocUrl();u&&(u=u.replace(/[{}]/g,"")),d&&u&&(t="".concat(u).concat("string"==typeof d?btoa(d):""))}return t}},{key:"handleHVCPromptDetection",value:function(e){var t=this;return(0,gd._)((function(){var n,r;return(0,F.__generator)(this,(function(o){try{(n=function(e,t){return function(e,t){var n=t.find((function(t){return t.tokenPhrases.every((function(t){return e.includes(t())}))}));return null!=n?n:[]}(e,t).reduce((function(e,t){return e+t()}),"")}(e,t.hvcPromptStringsList)).length>0?(r=uE(n,t.hvcPromptToHVCCategoryMap),t.hvcPromptDetected=r):t.hvcPromptDetected=tE.NotACommand}catch(e){ZR("An error occurred while checking for hvc prompt. "+e),t.hvcPromptDetected=tE.NotACommand}return[2]}))}))()}},{key:"getDefaultSignalOperation",value:function(e,t,n,r,o,i,a,s,l,c,u){var d=this;return(0,gd._)((function(){var p,g,m,f,h,v,y;return(0,F.__generator)(this,(function(C){switch(C.label){case 0:return Jh(Dh.ShouldSupportHVCDetectionOnClientSide)&&d.handleHVCPromptDetection(e),ZR("HVC Prompt sent to AL: ",d.hvcPromptDetected),[4,MN(d.copilotChatRef,e,t,r,n,o,i,a,s,d.hvcPromptDetected,c,l,u)];case 1:return f=C.sent(),h=f.operation.items.length>0?null===(m=f.operation.items[0])||void 0===m||null===(g=m.body)||void 0===g||null===(p=g.H_)||void 0===p?void 0:p.T_:"",ob.getInstance().sendLatencyTelemetry([{key:sC.RequestSignalType,value:h}]),ZR("getDefaultSignalOperation: ".concat(JSON.stringify(f))),f.workflowAnnotationType!==EE.getTypeName()&&f.workflowAnnotationType!==TE.getTypeName()&&(null===(v=d.copilotChatRef.current)||void 0===v||v.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(y=Gx().get(Hd.Default))&&void 0!==y?y:[]},FN()))),d.setIsGeneratingResponse(!0),d.signalSubmitTime=(new Date).getTime(),mb.getInstance().addContextId(t),[2,f]}}))}))()}},{key:"shouldSendRequestToAugloop",value:function(e,t,n){Jh(Dh.IsScenarioErrorTelemetryEnabled)&&(sb.getInstance().setStartTime((new Date).toISOString()),sb.getInstance().setUserQueryGuid(qp.dB)),TN()!==rM&&ob.getInstance().sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CopilotLabPromptSubmitted))),(Vh(Lh.HandoffEnabled)||Vh(Lh.InAppHandoffEnabled))&&ob.getInstance().sendHandoffQuerySubmittedEvent(e);var r=GN(this.copilotChatRef,e,this.disableMenuOptions,this.setDisableChatInput,t,this.setSuggestionListPool);return Promise.resolve(r)}},{key:"shouldIgnoreResponse",value:function(e){var t=cR(e);return ZR("shouldIgnoreResponse: ",t),t}},{key:"feedbackButtonClicked",value:function(e,t,r,o,a){if(Vh(Lh.IsFeedbackAppChatIntegrationEnabled))return Jh(Dh.SendFeedbackClientAppName)&&(t.contextData=Sd(Cd({},t.contextData),{feedbackClientAppName:this.getfeedbackCientAppName()})),function(e,t,n){var r,o,a,s,l,c=null!==(s=null==t?void 0:t.feedbackArea)&&void 0!==s?s:Wd.CHATPPT,u=MC.Unset,d=void 0;if(n){var p=vR(n),g=p.correlationId,m=p.featureName,f=p.subFeatureName;f&&(u=f),g&&(d=g,pN.setQueryGuid(d)),m&&pN.logFeedbackEvent(e===Iw.Gb.LIKE,m,u,Hw(m))}var h,v={groundingSource:null!==(l=null==t||null===(r=t.contextData)||void 0===r?void 0:r.groundingSource)&&void 0!==l?l:"CurrentContext",queryId:null==t||null===(a=t.contextData)||void 0===a||null===(o=a.feedbackContextData)||void 0===o?void 0:o.promptId,feedbackArea:c,subFeatureName:u},y=e===Iw.Gb.LIKE?dC.ThumbsUpButtonClicked:dC.ThumbsDownButtonClicked;pN.sendChatEventTelemetry(HS((h={},(0,i._)(h,cC.ChatEventType,y),(0,i._)(h,cC.ChatEventParameters,JSON.stringify(v)),h))),d&&pN.setQueryGuid("")}(e,t,r),void fU(rC(n.prototype),"feedbackButtonClicked",this).call(this,e,t,r,o,a);e===Iw.Gb.LIKE?function(e,t){var n,r,o,a,s,l=null!==(a=null==e?void 0:e.feedbackArea)&&void 0!==a?a:Wd.CHATPPT;s=Jh(Dh.IsFeedbackAIThumbsUpScenarioEnabled)?uR(null==e?void 0:e.contextData,jd.AIThumbsUp):uR(null==e?void 0:e.contextData);var c=Xd.Like,u=Kd.ModalDialog;_p.GetHostAppPlatform()===yM&&(u=Kd.Taskpane);var d,p=MC.Unset;if(t){var g=vR(t),m=g.correlationId,f=g.featureName,h=g.subFeatureName;h&&(p=h),m&&pN.setQueryGuid(m),f&&pN.logFeedbackEvent(!0,f,p,Hw(f))}var v,y={groundingSource:null!==(d=null==e||null===(n=e.contextData)||void 0===n?void 0:n.groundingSource)&&void 0!==d?d:"CurrentContext",queryId:null==e||null===(o=e.contextData)||void 0===o||null===(r=o.feedbackContextData)||void 0===r?void 0:r.promptId,feedbackArea:l,subFeatureName:p};pN.sendChatEventTelemetry(HS((v={},(0,i._)(v,cC.ChatEventType,dC.ThumbsUpButtonClicked),(0,i._)(v,cC.ChatEventParameters,JSON.stringify(y)),v))),t&&pN.setQueryGuid(""),qO(),GO(c,u,l,s)}(t,r):function(e,t){var n,r,o,a,s=null!==(a=null==e?void 0:e.feedbackArea)&&void 0!==a?a:Wd.CHATPPT,l=uR(null==e?void 0:e.contextData,jd.AIThumbsDown),c=Xd.Dislike,u=Kd.ModalDialog;_p.GetHostAppPlatform()===yM&&(u=Kd.Taskpane);var d,p=MC.Unset;if(t){var g=vR(t),m=g.correlationId,f=g.featureName,h=g.subFeatureName;h&&(p=h),m&&pN.setQueryGuid(m),f&&pN.logFeedbackEvent(!1,f,p,Hw(f))}var v,y={groundingSource:null!==(d=null==e||null===(n=e.contextData)||void 0===n?void 0:n.groundingSource)&&void 0!==d?d:"CurrentContext",queryId:null==e||null===(o=e.contextData)||void 0===o||null===(r=o.feedbackContextData)||void 0===r?void 0:r.promptId,feedbackArea:s,subFeatureName:p};pN.sendChatEventTelemetry(HS((v={},(0,i._)(v,cC.ChatEventType,dC.ThumbsDownButtonClicked),(0,i._)(v,cC.ChatEventParameters,JSON.stringify(y)),v))),t&&pN.setQueryGuid(""),qO(),GO(c,u,s,l)}(t,r)}},{key:"setHVCPromptDetected",value:function(e){this.hvcPromptDetected=e}},{key:"setHVCPromptStringsList",value:function(e){this.hvcPromptStringsList=e}},{key:"setHVCPromptToHVCCategoryMap",value:function(e){this.hvcPromptToHVCCategoryMap=e}},{key:"getfeedbackCientAppName",value:function(){var e="PPTWeb";switch(_p.GetHostAppPlatform()){case yM:e="PPTWin32";break;case SM:e="PPTMac";break;case bM:e="PPTiOS"}return e}}],[{key:"getInstance",value:function(e,t,r,o,i,a,s,l){return this.instance||(this.instance=new n(e,t,r,o,i,a,s,l)),n.instance}}]),n}(hU.h);(0,i._)(TU,"instance",void 0);class IU{constructor(e){Qp.h.assign(IU,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotGetUserContextSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[IU.getTypeName()])}}IU.H_={T_:IU.getTypeName(),B_:IU.getBaseTypes()};var _U,wU=ob.getInstance(),PU=function(){var e=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){return n=new Vp.Xr({parentPath:["Signal",IU.getTypeName()],items:[{id:aT.generateId(),body:new IU}]}),CU=(new Date).getTime(),null===(t=e.current)||void 0===t||t.submitOperation({operation:n,workflowAnnotationType:uU.getTypeName()}),wU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.UserTypeOperationSubmitted))),ZR("successfully submitted operation to AL : \n\n\n"+JSON.stringify(n)+"\nat Time : "+new Date+"\n\n\n"),[2]}))}));return function(t){return e.apply(this,arguments)}}(),xU=function(){var e=(0,gd._)((function(e,t,n){var r,o,i;return(0,F.__generator)(this,(function(a){return r=null==e?void 0:e.body,o=null==r?void 0:r.userType,i=null==r?void 0:r.isEUDBUser,US(wU,uU.getTypeName(),CU,sC.UserIdentityTypeResponseTime,_C.CopilotChat,n,void 0,!1),ZR("".concat(uU.getTypeName()," response. Time Taken : ").concat((0,qp.WU)(CU)," sec \n, UserType : ").concat(o,", isEUDBUser : ").concat(i)),t(o,i),[2]}))}));return function(t,n,r){return e.apply(this,arguments)}}(),kU=n(64909),AU=n(88611),LU=ob.getInstance(),DU=function(e,t,n){var r,o,a,s,l=(0,dg.A)(),c=mU.y.POST;e===mU.p.Suggestion?(a=OU(l),s=RU()):(a=NU(t,n),s=FU(l));var u,d={request:a,headers:s,httpMethod:c,type:e,queryId:l,scenario:KM[_p.GetHostAppPlatform()]},p=new Vp.Xr({parentPath:["Signal",kU.G.getTypeName()],items:[{id:aT.generateId(),body:new kU.G(d)}]});_U=(new Date).getTime(),null===(o=Sb.getInstance().getChatRef())||void 0===o||null===(r=o.current)||void 0===r||r.submitOperation({operation:p,workflowAnnotationType:gU.x.getTypeName()}),LU.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.SubstrateAPIOperationSubmitted),(0,i._)(u,cC.ChatEventParameters,e),u))),ZR("successfully submitted operation to AL : \n\n\n"+JSON.stringify(p)+"\nat Time : "+new Date+"\nSessionKey: \n\n\n")},OU=function(e){var t={EntityRequests:[{EntityType:"Prompt",Query:{QueryString:""},Filter:{And:[{Or:[{Term:{Product:"PowerPoint"}}]}]},Size:25}],TimeZone:"UTC",Cvid:e,Scenario:{Name:KM[_p.GetHostAppPlatform()],Dimensions:[{DimensionName:"UserExperience",DimensionValue:"PromptLibrary"}]}};return JSON.stringify(t)},NU=function(e){var t={PromptActivityList:[{PromptId:e,UserActivity:{Favorite:{IsFavorite:arguments.length>1&&void 0!==arguments[1]&&arguments[1],ActivityDatetimeInUtc:(new Date).toISOString()}}}],PromptActivityListCount:1};return JSON.stringify(t)},RU=function(){return[{key:op.XClientLanguage,value:TS(_p.GetHostAppDisplayLanguage())},{key:op.XClientFlights,value:"EnablePromptSuggestion,ServeStaticPrompts,EnableClientLocaleBasedFilterSupportForPrompts,AddUserActivityInPromptSuggestion"}]},FU=function(e){return[{key:op.ClientRequestId,value:e}]},MU=ob.getInstance(),BU=function(){var e=(0,gd._)((function(e,t,n){var r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return r=e.body,[4,UU(r)];case 1:return o.sent(),US(MU,TP.getTypeName(),0===t?qp.qD:t,sC.CopilotODSLImageResponseTime,_C.InsertImage,n),ZR("".concat(TP.getTypeName()," response.")),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),UU=function(){var e=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){return t=e.images,ZR("CopilotOdslImageAnnotation received "+JSON.stringify(t)+" "+e.baseUrl),t&&t.length&&e.baseUrl?(t.forEach((function(t){gv.addImage({url:e.baseUrl+t.imageId,description:t.description,altText:t.altText,license:t.license})})),[2]):[2]}))}));return function(t){return e.apply(this,arguments)}}(),HU=ob.getInstance(),GU=sb.getInstance(),zU=function(){var e=(0,gd._)((function(e,t){var n,r,o,a,s,l,c,u,d,p,g,m,f,h,v,y;return(0,F.__generator)(this,(function(C){switch(n=e.body,r=n.intent,o=n.rephrasedQuery,a=[],cF(n.entities)||(a=n.entities),ZR("Intent received from Copilot Odsl Intent Workflow: ".concat(r,", ").concat(a)),o&&ZR("Rephrased query received from Copilot Odsl Intent Workflow: ".concat(o)),HU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.PPTCopilotIntentDetected)),!1),r){case Yd.Command:switch(HU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,Jh(Dh.IsEntitiesLogRemovedFromChatEventParameters)?r:r+" "+a[0]))),a[0]){case $d.Slide:null===(s=t.current)||void 0===s||s.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(l=Gx().get(Hd.CreatePresentation))&&void 0!==l?l:[]},FN()));break;case $d.Text:null===(c=t.current)||void 0===c||c.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(u=Gx().get(Hd.AddText))&&void 0!==u?u:[]},FN())),GU.setScenarioName(Cv.FormatText);break;case $d.Image:null===(d=t.current)||void 0===d||d.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(p=Gx().get(Hd.AddImage))&&void 0!==p?p:[]},FN())),GU.setScenarioName(Cv.InsertImage),ob.getInstance().logTriedEvent(Iv.AddContent,MC.AddImage,yE.RX.Create)}break;case Yd.Summarize:case Yd.SegmentSummarize:case Yd.StyleSummarize:GU.setScenarioName(Cv.Summary),null===(g=t.current)||void 0===g||g.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(m=Gx().get(Hd.PresentationSummary))&&void 0!==m?m:[]},FN())),HU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,r+" "+Hd.PresentationSummary)));break;case Yd.ActionItem:GU.setScenarioName(Cv.Summary),null===(f=t.current)||void 0===f||f.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(h=Gx().get(Hd.CallToAction))&&void 0!==h?h:[]},FN())),HU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,r+" "+Hd.CallToAction)));break;case Yd.ImportantSlide:GU.setScenarioName(Cv.Summary),null===(v=t.current)||void 0===v||v.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(y=Gx().get(Hd.ImportantSlides))&&void 0!==y?y:[]},FN())),HU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,r+" "+Hd.ImportantSlides)));break;case Yd.OutOfScope:case Yd.Invalid:HU.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventParameters,r))),Jh(Dh.IsScenarioErrorTelemetryEnabled)&&sb.getInstance().addScenarioError(Sv.IntentDetectionFailure)}return[2]}))}));return function(t,n){return e.apply(this,arguments)}}(),qU=n(47018);const WU="fui-Image",jU=(0,Ks.X)({base:{g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw",B7ck84d:"f1ewtqcl",mc9l5x:"f14t3ns0"},bordered:{icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"]},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},square:{},shadow:{E5pizo:"f1whvlc6"},center:{st4lth:"f1plgu50",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},contain:{st4lth:"f1kle4es",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},default:{},cover:{st4lth:"f1ps3kmd",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},none:{st4lth:"f1plgu50",Ermj5k:["f13uwng7","fjmyj0p"],Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},block:{a9b677:"fly5x3f"}},{d:[".fj3muxo{border-top-color:var(--colorNeutralStroke1);}",".f1akhkt{border-right-color:var(--colorNeutralStroke1);}",".f1lxtadh{border-left-color:var(--colorNeutralStroke1);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".f14t3ns0{display:inline-block;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1whvlc6{box-shadow:var(--shadow4);}",".f1plgu50{object-fit:none;}",".f14xojzb{object-position:center;}",".f1l02sjl{height:100%;}",".fly5x3f{width:100%;}",".f1kle4es{object-fit:contain;}",".f1ps3kmd{object-fit:cover;}",".f13uwng7{object-position:left top;}",".fjmyj0p{object-position:right top;}"]}),VU=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{bordered:n=!1,fit:r="default",block:o=!1,shape:i="square",shadow:a=!1}=e;return{bordered:n,fit:r,block:o,shape:i,shadow:a,components:{root:"img"},root:qs.Gk((0,Ws.g)("img",{ref:t,...e}),{elementType:"img"})}})(e,t);return(e=>{const t=jU();e.root.className=(0,Ms.z)(WU,t.base,e.block&&t.block,e.bordered&&t.bordered,e.shadow&&t.shadow,t[e.fit],t[e.shape],e.root.className)})(n),(0,il.$e)("useImageStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.Y)(e.root,{})))(n)}));VU.displayName="Image";var QU=function(){return a.createElement("div",null,PowerpointCopilotStrings.AssistantChatHelpSuggestion.substring(0,PowerpointCopilotStrings.AssistantChatHelpSuggestion.indexOf(zF)),Vh(Lh.IsInputV2Enabled)?a.createElement(qU.ReL,null):a.createElement(VU,{src:n(99394),height:16,width:16,style:{display:"inline-block",width:16,height:16}}),PowerpointCopilotStrings.AssistantChatHelpSuggestion.substring(PowerpointCopilotStrings.AssistantChatHelpSuggestion.indexOf(zF)+5))},JU={HelpResponse:a.memo(QU)},KU=a.memo((function(e){var t=e.component;return a.useEffect((function(){var e;ob.getInstance().sendErrorTelemetry(HS((e={},(0,i._)(e,uC.ErrorMessage,"Missing renderer for ".concat(t)),(0,i._)(e,uC.ErrorCategory,IC.Error),e)))}),[t]),a.createElement("i",null,"Sorry, cannot display this message.")})),XU={renderers:JU,renderFallback:function(e){return a.createElement(KU,{component:e.component})}},ZU=function(e){return{showFeedbackButtons:e,useFluentAIGeneratedIndicator:!0,shouldSupportCitationsInAvalon:Vh(Lh.IsCitationSupportForAvalonEnabled)}},YU=function(){switch(_p.GetHostAppPlatform()){case yM:return"PowerPoint_Win32";case SM:return"PowerPoint_Mac";case bM:return"PowerPoint_iOS";default:return"PowerPoint_Online"}},$U=function(){switch(_p.GetHostAppPlatform()){case yM:return"Win32";case SM:return"Mac";case bM:return"iOS";default:return"Web"}},eH={},tH=function(){eH[vM.addSlide()]={headerText:PowerpointCopilotStrings.HintCardAddSlideSuggestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardAddSlideSuggestionMessage]},eH[vM.createPresentation()]={headerText:PowerpointCopilotStrings.HintCardCreatePresentationSuggestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardCreatePresentationSuggestionMessage]},eH[vM.changeTextFormat()]={headerText:PowerpointCopilotStrings.HintCardChangeTextStyleSuggestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardChangeTextStyleSuggestionMessage]},eH[vM.addImage()]={headerText:PowerpointCopilotStrings.HintCardAddImageSuggestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardAddImageSuggestionMessage]},eH[vM.addEnterpriseImage()]={headerText:PowerpointCopilotStrings.HintCardAddImageSuggestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardAddEnterpriseImageSuggestionMessage]},eH[vM.addText()]={headerText:PowerpointCopilotStrings.HintCardAddTextSuggestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardAddTextSuggestionMessage]},eH[vM.transformFile()]={headerText:PowerpointCopilotStrings.HintCardTransformFileSuggestionHeader,descriptionTextList:zR.IsSettingTrue(DR.PPTCIQDocMenuEnabled)?[PowerpointCopilotStrings.HintCardTransformFileSuggestionWithCiqMessage]:[PowerpointCopilotStrings.HintCardTransformFileSuggestionMessage]},eH[vM.askAQuestion()]={headerText:PowerpointCopilotStrings.HintCardAskAQuestionHeader,descriptionTextList:[PowerpointCopilotStrings.HintCardAskAQuestionSuggestionMessage]}};class nH{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(nH,this,e)}static getTypeName(){return"AugLoop_CopilotCommandingSteerability_SteerableCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[nH.getTypeName()])}}nH.H_={T_:nH.getTypeName(),B_:nH.getBaseTypes()};class rH{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(rH,this,e)}static getTypeName(){return"AugLoop_CopilotCommandingSteerability_SteerableCopilotChatHistoryOutputAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[rH.getTypeName()])}}rH.H_={T_:rH.getTypeName(),B_:rH.getBaseTypes()};const oH="Sorry, Something went wrong. Please try again.";var iH=n(58651);const aH=[{name:"undo_application",alternateNames:["reverse","undo"],description:"Reverse the previous action taken by the user.",returnVariable:{type:"void",description:""},args:[]},{name:"insert_images",alternateNames:["insertImages","insert_image"],description:"Generates an image from the given text description and inserts it into the given slides.",returnVariable:{type:"shapes",description:"The images that were inserted."},args:[{name:"description",required:!0,description:"Text description of the image to insert.",type:"string"},{name:"slides",alternateNames:["scope"],required:!0,description:"The slides on which to insert the image.",type:"slides",promptAlternative:{name:"scope"},validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"imageType",required:!1,description:"The type of image to insert.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Default","Icon","Sticker","Cutout","Cartoon"]}}]},{name:"image_invalid",alternateNames:[],description:"insert_images statements that contained an invalid image description are corrected to this statement. This statement should only be inserted during post processing.",returnVariable:{type:"void",description:""},args:[]},{name:"invalid_request",alternateNames:["invalidRequest"],description:"user requests that are not currently supported should return this statement.",returnVariable:{type:"void",description:""},args:[]},{name:"select_shapes",alternateNames:["selectShapes","select_shape"],description:"Selects shapes as specified by the given scope and index.",returnVariable:{type:"shapes",description:"The shapes that match the given selection criteria."},args:[{name:"scope",required:!0,description:"The slides from which shapes should be selected.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"index",required:!1,description:"The index of the shape to select. index is 0-based. For example, index of fourth shape is 3.",type:"selectionIndex"},{name:"shapeType",required:!1,description:"The type of shape to select.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["GeometricShape","Image","Textbox","Curve","Elbow","Straight","LineInverse","Triangle","RightTriangle","Rectangle","Diamond","Parallelogram","Trapezoid","NonIsoscelesTrapezoid","Pentagon","Hexagon","Heptagon","Octagon","Decagon","Dodecagon","Star4","Star5","Star6","Star7","Star8","Star10","Star12","Star16","Star24","Star32","RoundRectangle","Round1Rectangle","Round2SameRectangle","Round2DiagonalRectangle","SnipRoundRectangle","Snip1Rectangle","Snip2SameRectangle","Snip2DiagonalRectangle","Plaque","Ellipse","Teardrop","HomePlate","Chevron","PieWedge","Pie","BlockArc","Donut","NoSmoking","RightArrow","LeftArrow","UpArrow","DownArrow","StripedRightArrow","NotchedRightArrow","BentUpArrow","LeftRightArrow","UpDownArrow","LeftUpArrow","LeftRightUpArrow","QuadArrow","LeftArrowCallout","RightArrowCallout","UpArrowCallout","DownArrowCallout","LeftRightArrowCallout","UpDownArrowCallout","QuadArrowCallout","BentArrow","UturnArrow","CircularArrow","LeftCircularArrow","LeftRightCircularArrow","CurvedRightArrow","CurvedLeftArrow","CurvedUpArrow","CurvedDownArrow","SwooshArrow","Cube","Can","LightningBolt","Heart","Sun","Moon","SmileyFace","IrregularSeal1","IrregularSeal2","FoldedCorner","Bevel","Frame","HalfFrame","Corner","DiagonalStripe","Chord","Arc","LeftBracket","RightBracket","LeftBrace","RightBrace","BracketPair","BracePair","Callout1","Callout2","Callout3","AccentCallout1","AccentCallout2","AccentCallout3","BorderCallout1","BorderCallout2","BorderCallout3","AccentBorderCallout1","AccentBorderCallout2","AccentBorderCallout3","WedgeRectCallout","WedgeRRectCallout","WedgeEllipseCallout","CloudCallout","Cloud","Ribbon","Ribbon2","EllipseRibbon","EllipseRibbon2","LeftRightRibbon","VerticalScroll","HorizontalScroll","Wave","DoubleWave","Plus","FlowChartProcess","FlowChartDecision","FlowChartInputOutput","FlowChartPredefinedProcess","FlowChartInternalStorage","FlowChartDocument","FlowChartMultidocument","FlowChartTerminator","FlowChartPreparation","FlowChartManualInput","FlowChartManualOperation","FlowChartConnector","FlowChartPunchedCard","FlowChartPunchedTape","FlowChartSummingJunction","FlowChartOr","FlowChartCollate","FlowChartSort","FlowChartExtract","FlowChartMerge","FlowChartOfflineStorage","FlowChartOnlineStorage","FlowChartMagneticTape","FlowChartMagneticDisk","FlowChartMagneticDrum","FlowChartDisplay","FlowChartDelay","FlowChartAlternateProcess","FlowChartOffpageConnector","ActionButtonBlank","ActionButtonHome","ActionButtonHelp","ActionButtonInformation","ActionButtonForwardNext","ActionButtonBackPrevious","ActionButtonEnd","ActionButtonBeginning","ActionButtonReturn","ActionButtonDocument","ActionButtonSound","ActionButtonMovie","Gear6","Gear9","Funnel","MathPlus","MathMinus","MathMultiply","MathDivide","MathEqual","MathNotEqual","CornerTabs","SquareTabs","PlaqueTabs","ChartX","ChartStar","ChartPlus"],enumValuesAlternateNames:["WedgeEllipseCallout:SpeechBubble","RightArrow:Arrow","MathEqual:Equation","Ellipse:Oval","Ellipse:Circle","FlowChartConnector:Connector","Straight:Line","Rectangle:Square","Image:Picture"],enumValuesToReject:["Flowchart"]}},{name:"name",required:!1,description:"Name of the shapes to select. This filter is unioned with shapeType.",type:"string"},{name:"shapeIds",required:!1,description:"The shape IDs that match the given selection criteria.",type:"string"},{name:"left",required:!1,description:"The left position of the shape.",type:"positiveNumber"},{name:"top",required:!1,description:"The top position of the shape.",type:"positiveNumber"},{name:"height",required:!1,description:"The height of the shape.",type:"positiveNumber"},{name:"width",required:!1,description:"The width of the shape.",type:"positiveNumber"},{name:"area",required:!1,description:"The area of the shape.",type:"positiveNumber"},{name:"lineColor",required:!1,description:"The color of the shape's outline.",type:"color"},{name:"lineDashStyle",required:!1,description:"The dash style of the shape's outline.",type:"enum",validationArgs:{enumValues:["Dash","DashDot","DashDotDot","LongDash","LongDashDot","RoundDot","Solid","SquareDot","LongDashDotDot","SystemDash","SystemDot","SystemDashDot"]}},{name:"lineWeight",required:!1,description:"The weight of the shape's outline.",type:"positiveNumber"},{name:"lineTransparency",required:!1,description:"The transparency of the shape's outline.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"fillColor",required:!1,description:"The color of the shape's fill.",type:"color"},{name:"fillTransparency",required:!1,description:"The transparency of the shape's fill.",type:"rangedNumber",validationArgs:{min:0,max:1}}]},{name:"insert_shapes",alternateNames:["insertShapes","insert_shape"],description:"Inserts shapes of shapeType in the provided slides.",returnVariable:{type:"shapes",description:"The shapes that were inserted."},args:[{name:"slides",required:!0,description:"The slides on which shapes has to be inserted.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"shapeType",required:!0,description:"The type of shape to insert.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["InjectForShapesCircleSquare"],enumValues:["Textbox","Curve","Elbow","Straight","LineInverse","Triangle","RightTriangle","Rectangle","Diamond","Parallelogram","Trapezoid","NonIsoscelesTrapezoid","Pentagon","Hexagon","Heptagon","Octagon","Decagon","Dodecagon","Star4","Star5","Star6","Star7","Star8","Star10","Star12","Star16","Star24","Star32","RoundRectangle","Round1Rectangle","Round2SameRectangle","Round2DiagonalRectangle","SnipRoundRectangle","Snip1Rectangle","Snip2SameRectangle","Snip2DiagonalRectangle","Plaque","Ellipse","Teardrop","HomePlate","Chevron","PieWedge","Pie","BlockArc","Donut","NoSmoking","RightArrow","LeftArrow","UpArrow","DownArrow","StripedRightArrow","NotchedRightArrow","BentUpArrow","LeftRightArrow","UpDownArrow","LeftUpArrow","LeftRightUpArrow","QuadArrow","LeftArrowCallout","RightArrowCallout","UpArrowCallout","DownArrowCallout","LeftRightArrowCallout","UpDownArrowCallout","QuadArrowCallout","BentArrow","UturnArrow","CircularArrow","LeftCircularArrow","LeftRightCircularArrow","CurvedRightArrow","CurvedLeftArrow","CurvedUpArrow","CurvedDownArrow","SwooshArrow","Cube","Can","LightningBolt","Heart","Sun","Moon","SmileyFace","IrregularSeal1","IrregularSeal2","FoldedCorner","Bevel","Frame","HalfFrame","Corner","DiagonalStripe","Chord","Arc","LeftBracket","RightBracket","LeftBrace","RightBrace","BracketPair","BracePair","Callout1","Callout2","Callout3","AccentCallout1","AccentCallout2","AccentCallout3","BorderCallout1","BorderCallout2","BorderCallout3","AccentBorderCallout1","AccentBorderCallout2","AccentBorderCallout3","WedgeRectCallout","WedgeRRectCallout","WedgeEllipseCallout","CloudCallout","Cloud","Ribbon","Ribbon2","EllipseRibbon","EllipseRibbon2","LeftRightRibbon","VerticalScroll","HorizontalScroll","Wave","DoubleWave","Plus","FlowChartProcess","FlowChartDecision","FlowChartInputOutput","FlowChartPredefinedProcess","FlowChartInternalStorage","FlowChartDocument","FlowChartMultidocument","FlowChartTerminator","FlowChartPreparation","FlowChartManualInput","FlowChartManualOperation","FlowChartConnector","FlowChartPunchedCard","FlowChartPunchedTape","FlowChartSummingJunction","FlowChartOr","FlowChartCollate","FlowChartSort","FlowChartExtract","FlowChartMerge","FlowChartOfflineStorage","FlowChartOnlineStorage","FlowChartMagneticTape","FlowChartMagneticDisk","FlowChartMagneticDrum","FlowChartDisplay","FlowChartDelay","FlowChartAlternateProcess","FlowChartOffpageConnector","ActionButtonBlank","ActionButtonHome","ActionButtonHelp","ActionButtonInformation","ActionButtonForwardNext","ActionButtonBackPrevious","ActionButtonEnd","ActionButtonBeginning","ActionButtonReturn","ActionButtonDocument","ActionButtonSound","ActionButtonMovie","Gear6","Gear9","Funnel","MathPlus","MathMinus","MathMultiply","MathDivide","MathEqual","MathNotEqual","CornerTabs","SquareTabs","PlaqueTabs","ChartX","ChartStar","ChartPlus"],enumValuesAlternateNames:["WedgeEllipseCallout:SpeechBubble","RightArrow:Arrow","MathEqual:Equation","Ellipse:Oval","Ellipse:Circle","FlowChartConnector:Connector","Straight:Line"],enumValuesToReject:["Flowchart"]}},{name:"description",required:!1,description:"The description of the shapeType that needs to be inserted.",type:"string"}]},{name:"format_shapes",alternateNames:["formatShapes","format_shape"],description:"Format the specified shapes using the given parameters.",returnVariable:{type:"void",description:""},args:[{name:"shapes",alternateNames:["scope"],required:!0,description:"The shapes to format.",type:"shapes",promptAlternative:{name:"scope"}},{name:"left",required:!1,description:"The left position of the shape.",type:"positiveNumber"},{name:"top",required:!1,description:"The top position of the shape.",type:"positiveNumber"},{name:"height",required:!1,description:"The height of the shape.",type:"positiveNumber"},{name:"width",required:!1,description:"The width of the shape.",type:"positiveNumber"},{name:"lineColor",required:!1,description:"The color of the shape's outline.",type:"color"},{name:"lineDashStyle",required:!1,description:"The dash style of the shape's outline.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Dash","DashDot","DashDotDot","LongDash","LongDashDot","RoundDot","Solid","SquareDot","LongDashDotDot","SystemDash","SystemDot","SystemDashDot"]}},{name:"lineStyle",required:!1,description:"The style of the shape's outline.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{enumValues:["Single","ThickBetweenThin","ThickThin","ThinThick","ThinThin"]}},{name:"lineWeight",required:!1,description:"The weight of the shape's outline.",type:"positiveNumber"},{name:"lineTransparency",required:!1,description:"The transparency of the shape's outline.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"fillColor",required:!1,description:"The color of the shape's fill.",type:"color"},{name:"fillTransparency",required:!1,description:"The transparency of the shape's fill.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"shadowPreset",required:!1,description:"The preset type of the shadow.",type:"enum",validationArgs:{enumValues:["TopLeftInner","TopInner","TopRightInner","LeftInner","RightInner","BottomRightInner","BottomInner","BottomLeftInner","CenterInner","TopLeftOuter","TopOuter","TopRightOuter","LeftOuter","RightOuter","BottomRightOuter","BottomOuter","BottomLeftOuter","CenterOuter","Perspective1","Perspective2","Perspective3","Perspective4","Perspective5"]}},{name:"shadowAlign",required:!1,description:"The alignment of the shadow.",type:"enum",validationArgs:{enumValues:["TopLeft","Top","TopRight","Left","Right","BottomLeft","Bottom","BottomRight","Center"]}},{name:"shadowColor",required:!1,description:"The color of the shape's shadow.",type:"color"},{name:"shadowTransparency",required:!1,description:"The transparency of the shape's shadow.",type:"rangedNumber",validationArgs:{min:0,max:1}},{name:"shadowScaleX",required:!1,description:"The horizontal scale of the shape's shadow in percentage of the size of the shape.",type:"number"},{name:"shadowScaleY",required:!1,description:"The vertical scale of the shape's shadow in percentage of the size of the shape.",type:"number"},{name:"shadowSkewX",required:!1,description:"The horizontal skew of the shape's shadow.",type:"number"},{name:"shadowSkewY",required:!1,description:"The vertical skew of the shape's shadow.",type:"number"},{name:"shadowRadius",required:!1,description:"The blur radius of the shape's shadow in points.",type:"number"},{name:"shadowAngle",required:!1,description:"The angle of the shape's shadow.",type:"rangedNumber",validationArgs:{min:0,max:359}},{name:"shadowDistance",required:!1,description:"The distance of the shape's shadow in points.",type:"rangedNumber",validationArgs:{min:0,max:200}},{name:"alignHorizontal",required:!1,description:"aligning shapes horizontally.",type:"enum",validationArgs:{enumValues:["Left","Right","Center"]}},{name:"alignVertical",required:!1,description:"aligning shapes vertically.",type:"enum",validationArgs:{enumValues:["Top","Middle","Bottom"]}},{name:"distribute",required:!1,description:"distributing shapes around the slide.",type:"enum",validationArgs:{enumValues:["Horizontal","Vertical"]}},{name:"alignRelative",required:!1,description:"aligning shapes with respect to a reference.",type:"enum",validationArgs:{enumValues:["Slide","SelectedObjects"]}},{name:"animation",required:!1,description:"If an animation should be applied.",type:"boolean",validationArgs:{correctionStrategy:["StringAsTrue"]}},{name:"animationType",required:!1,description:"The type of animation to be applied, default is entrance.",type:"enum",validationArgs:{enumValues:["Entrance","Exit","Emphasis"]}},{name:"animationName",required:!1,description:"The name of the animation to be applied, default is appear.",type:"enum",validationArgs:{enumValues:["Appear","Fade","FlyIn","FloatIn","Split","Wipe","Shape","Wheel","RandomBars","GrowAndTurn","Zoom","Swivel","Bounce","Pulse","ColorPulse","Teeter","Spin","GrowShrink","Desaturate","Darken","Lighten","Transparency","ObjectColor","ComplementaryColor","LineColor","FillColor","BrushColor","FontColor","Underline","BoldFlash","BoldReveal","Wave","Disappear","FlyOut","FloatOut","ShrinkAndTurn"]}},{name:"animationDuration",required:!1,description:"The duration of the animation to be applied in milliseconds.",type:"number"},{name:"animationDelay",required:!1,description:"The delay of the animation to be applied in milliseconds.",type:"number"},{name:"zOrder",required:!1,description:"The order of the shape along the depth axis.",type:"enum",validationArgs:{enumValues:["Front","Forward","Backward","Back"]}}]},{name:"delete_shapes",alternateNames:["deleteShapes","delete_shape"],description:"Delete the specified shapes.",returnVariable:{type:"void",description:""},args:[{name:"shapes",alternateNames:["scope"],required:!0,description:"The shapes to delete.",type:"shapes",promptAlternative:{name:"scope"}}]},{name:"select_semantic_shape",alternateNames:["selectSemanticShape"],description:"Selects shapes based on natural language descriptions of their content within the presentation. This function is best used when you want to select shapes based on its text content, rather than its style, position, or location within the presentation. For example, if you want to select shapes containing text that discusses a specific topic, you can use this function to describe the desired text content within the shape in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"shapes",description:"The shapes that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the shapes to select.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body","Image:Picture"]}}]},{name:"select_indices_shape",alternateNames:[],description:"Selects shapes using the given shape indices.",returnVariable:{type:"shapes",description:"The shapes matching the given shape indices."},args:[{name:"indices",required:!0,description:"The shape indices that match the given selection criteria.",type:"string"}]},{name:"select_slides",alternateNames:["selectSlides","select_slide"],description:"Selects slides using the given scope and index.",returnVariable:{type:"slides",description:"The slides that match the given selection criteria."},args:[{name:"scope",required:!1,description:'The scope from which slides should be selected. The default value is "Selection", which selects the current selection of slide(s). Use "Presentation" to select all slides in the presentation.',type:"enum",validationArgs:{enumValues:["Selection","Presentation"]}},{name:"index",required:!1,description:"The index of the slide to select. index is 0-based. For example, index of fourth slide is 3.",type:"selectionIndexExtended"},{name:"id",required:!1,description:"The creation ID of the slide to select.",type:"string"}]},{name:"create_new_presentation_using_source",alternateNames:["createNewPresentationUsingSource","create_new_presentation_using_source"],description:"Generates and inserts a new presentation of slides by transforming a source file. Use when creating a slideshow, presentation, or PPT.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides we will be replacing when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"source",alternateNames:["file","document"],required:!0,description:"The source file to use when generating slides.",type:"string"}]},{name:"create_new_presentation_using_prompt",alternateNames:["createNewPresentationUsingPrompt","create_new_presentation_using_prompt"],description:"Generates a new presentation of slides from a prompt and replaces the existing slides with it. Use when creating a slideshow, presentation, or PPT.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides we will be replacing when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!0,description:"The prompt to use when generating a new presentation.",type:"string"}]},{name:"create_slides_using_prompt",alternateNames:["createSlidesUsingPrompt","create_slides_using_prompt"],description:"Generates new slide(s) from a prompt and inserts them after the given slides.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!0,description:"The prompt to use when generating slides.",type:"string"}]},{name:"generate_slides",alternateNames:["generateSlides","generate_slide"],description:"Do Not use this function",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides. Required when adding slides, but not needed when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!1,description:"The prompt to use when generating slides.",type:"string",validationArgs:{correctionStrategy:["EnsureSingleValue"]}},{name:"source",alternateNames:["file","document"],required:!1,description:"The source file to use when generating slides.",type:"string"},{name:"createPresentation",required:!1,description:"If the generate_slides statement is for presentation creation. Default is false. True when generating a new presentation via prompt or from source file.",type:"boolean"}]},{name:"generate_slides",alternateNames:["generateSlides","generate_slide"],description:"Performs 1 of 3 tasks, all of which insert new slide(s). 1) Generate new slide(s) from a prompt and inserts them after the given slides. 2) Generate a new presentation of slides by transforming a source file. 3) Generate a new presentation of slides from a prompt.",returnVariable:{type:"slides",description:"The slides that were generated."},args:[{name:"precededBy",alternateNames:["slides"],required:!0,description:"The slides after which we should generate slides. Required when adding slides, but not needed when generating a new presentation.",type:"slides",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"prompt",required:!1,description:"The prompt to use when generating slides. Default is false.",type:"string"},{name:"source",alternateNames:["file","document"],required:!1,description:"The source file to use when generating slides. Default is blank.",type:"string"},{name:"createPresentation",required:!1,description:"If the generate_slides statement is for presentation creation. Default is false. True when generating a new presentation via prompt or from source file.",type:"boolean"}]},{name:"format_slides",alternateNames:["formatSlides","format_slide"],description:"Arranges the given slide or presentation in a particular style when Human asks for it. Powerpoint uses designer to format the slides.",returnVariable:{type:"slides",description:"The slides that were formatted."},args:[{name:"slides",alternateNames:["scope"],required:!0,description:"The slides to format.",type:"slides",promptAlternative:{name:"scope"},validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_slides"]}},{name:"strategy",required:!1,description:'The formatting strategy to apply. Use "beautify" on 1+ slides to making them prettier. Use "organize" to reorganize the entire presentation, making it more structured. Use "ThemeIdeas" to try a new design on the entire presentation.',type:"enum",validationArgs:{enumValues:["beautify","organize","ThemeIdeas"],enumValuesAlternateNames:["organize:structure"],correctionStrategy:["Dismissable","ReplaceStructureWithOrganize"]}},{name:"animation",required:!1,description:"If an animation should be applied.",type:"boolean",validationArgs:{correctionStrategy:["StringAsTrue"]}},{name:"isVisible",required:!1,description:"If the slide is visible.",type:"boolean"},{name:"targetFormatSlideByIndex",required:!1,description:"The index of the slides whose format we should follow for transform.",type:"selectionIndexExtended"}]},{name:"delete_slides",alternateNames:["deleteSlides","delete_slide"],description:"Deletes the given slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",alternateNames:["scope"],required:!0,description:"The slides to delete.",type:"slides",promptAlternative:{name:"scope"}}]},{name:"move_slides",alternateNames:["moveSlides","move_slide"],description:"Moves slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!0,description:"The slides to move.",type:"slides"},{name:"precededBy",alternateNames:["target"],required:!0,description:"The target slides besides which we move the slides to.",type:"slides",promptAlternative:{name:"target"}},{name:"before",required:!1,description:"Whether to move the slides before or after the target. The default value is false.",type:"boolean"}]},{name:"transition_slides",alternateNames:["transitionSlides","transition_slide"],description:"Transitions slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!1,description:"The slides to transition.",type:"slides"},{name:"type",required:!1,description:"The type of the transition.",type:"enum",validationArgs:{enumValues:["None","Morph","Fade","Push","Wipe","Split","Reveal","Cut","RandomBars","Shape","Uncover","Cover","Flash","FallOver","Drape","Curtains","Wind","Prestige","Fracture","Crush","PeelOff","PageCurl","Airplane","Origami","Dissolve","Checkerboard","Blinds","Clock","Ripple","Honeycomb","Glitter","Vortex","Shred","Switch","Flip","Gallery","Cube","Doors","Box","Comb","Zoom","Random","Pan","FerrisWheel","Conveyor","Rotate","Window","Orbit","FlyThrough"]}},{name:"time",required:!1,description:"The length of the transition in seconds.",type:"positiveNumber"},{name:"delay",required:!1,description:"The number of second to delay before moving to the next slide.",type:"positiveNumber"}]},{name:"select_semantic_slide",alternateNames:["selectSemanticSlide"],description:"Selects slides based on natural language descriptions of their content within the presentation. This function is best used when you want to select slides based on its text content, rather than its position or location within the presentation. For example, if you want to select slides containing text that discusses a specific topic, you can use this function to describe the desired text content in the slide in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"slides",description:"The slides that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the shapes on a slide to evaluate the selection criteria.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body"]}}]},{name:"select_indices_slide",alternateNames:[],description:"Selects slides using the given slide indices.",returnVariable:{type:"slides",description:"The slides matching the given shape indices."},args:[{name:"indices",required:!0,description:"The slide indices that match the given selection criteria.",type:"string"}]},{name:"rewrite_slides",alternateNames:["rewriteSlides","rewrite_slide"],description:"Rewrites slides.",returnVariable:{type:"void",description:""},args:[{name:"slides",required:!0,description:"The slides to rewrite.",type:"slides"},{name:"prompt",required:!0,description:"The prompt to use when rewriting slides.",type:"string"}]},{name:"select_text",alternateNames:["selectText"],description:"Selects text using the given scope, text pattern, or index. Defaults to current user selection if no parameters are provided.",returnVariable:{type:"textRanges",description:"The textRanges that match the given selection criteria."},args:[{name:"scope",required:!1,description:'The scope from which text should be selected. Default is user selection. shapes and slides are target entities obtained from other functions. "Presentation" selects all text in the presentation.',type:["shapes","slides","Presentation"],validationArgs:{correctionStrategy:["Dismissable"]}},{name:"text",required:!1,description:"The text to select.",type:"stringOrRegex"},{name:"index",required:!1,description:"The occurrence of matched text to select.",type:"selectionIndex"},{name:"name",required:!1,description:"The name of the text boxes to select.",type:"string",validationArgs:{correctionStrategy:["TitleSubtitleNameFixup"]}}]},{name:"insert_text",alternateNames:["insertText"],description:"Inserts provided text after the selected textRanges.",returnVariable:{type:"textRanges",description:"The textRanges that were inserted."},args:[{name:"precededBy",required:!0,description:"The textRange after which we should insert the text.",type:"textRanges",validationArgs:{correctionStrategy:["InjectMissingVariableStatement:select_text"]}},{name:"text",required:!0,description:"The text to insert.",type:"string"}]},{name:"format_text",alternateNames:["formatText"],description:"Format the specified textRanges using the given arguments.",returnVariable:{type:"void",description:""},args:[{name:"textRanges",alternateNames:["scope"],required:!0,description:"The textRanges to format.",type:"textRanges",promptAlternative:{name:"scope"}},{name:"color",alternateNames:["fontColor"],required:!1,description:"The text color to apply.",type:"color"},{name:"bold",required:!1,description:"Whether the text should be bold.",type:"boolean"},{name:"italic",required:!1,description:"Whether the text should be italic.",type:"boolean"},{name:"underline",required:!1,description:"The underline style to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Dash","DashHeavy","DashLong","DashLongHeavy","DotDash","DotDashHeavy","DotDotDash","DotDotDashHeavy","Dotted","DottedHeavy","Double","Heavy","None","Single","Wavy","WavyDouble","WavyHeavy"],enumValuesAlternateNames:["None:false","Wavy:Wave"]}},{name:"fontName",required:!1,description:"The font name to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Abadi","Agency FB","Aharoni","Aldhabi","Algerian","Amasis MT Pro","Angsana New","AngsanaUPC","Aparajita","Aptos","Arabic Typesetting","Arial","Arial Nova","Arial Rounded MT","Avenir Next LT Pro","Baguet Script","Bahnschrift","Baskerville Old Face","Batang","BatangChe","Bell MT","Berlin Sans FB","Bernard MT","Bierstadt","Bierstadt Display","Biome","Blackadder ITC","Bodoni MT","Bodoni MT Poster","Book Antiqua","Bookman Old Style","Bradley Hand ITC","Britannic","Broadway","Browallia New","BrowalliaUPC","Brush Script MT","Calibri","Californian FB","Calisto MT","Cambria","Cambria Math","Candara","Castellar","Cavolini","Century","Century Gothic","Century Schoolbook","Chamberi Super Display","Chiller","Cochocib Script Latin Pro","Colonna MT","Comic Sans MS","Congenial","Consolas","Constantia","Cooper","Copperplate Gothic","Corbel","Cordia New","CordiaUPC","Courier New","Curlz MT","DaunPenh","David","Daytona","DengXian","DilleniaUPC","DokChampa","Dotum","DotumChe","Dreaming Outloud Pro","Calibri Light","Georgia Pro","Sitka Heading","Sitka Text","Times New Roman","Verdana Pro","Dreaming Outloud Script Pro","Dubai","Ebrima","Edwardian Script ITC","Elephant Pro","Eras ITC","EucrosiaUPC","Euphemia","Fairwater Script","FangSong","Fave Script Pro","Felix Titling","Footlight MT","Forte","Forte Forward","Franklin Gothic","Franklin Gothic Book","FrankRuehl","FreesiaUPC","Freestyle Script","Gabriola","Gadugi","Garamond","Gautami","Georgia","Gigi","Gill Sans MT","Gill Sans Nova","Gisha","Gloucester MT","Goudy Old Style","Goudy Type","Grandview","Grandview Display","Grotesque","Gulim","GulimChe","Gungsuh","GungsuhChe","Hadassah Friedlaender","Harrington","HGGothicE","HGMaruGothicMPRO","HGMinchoE","HGPGothicE","HGPMinchoE","HGPSoeiKakugothicUB","HGSGothicE","HGSMinchoE","HGSoeiKakugothicUB","HGSSoeiKakugothicUB","High Tower Text","Impact","Imprint MT Shadow","Ink Free","IrisUPC","Iskoola Pota","JasmineUPC","Javanese Text","Jokerman","Juice ITC","Jumble","KaiTi","Kalinga","Kartika","Khmer UI","Kigelia","Kigelia Arabic","KodchiangUPC","Kokila","Kristen ITC","Kunstler Script","Lao UI","Latha","Leelawadee","Leelawadee UI","Levenim MT","LilyUPC","Lucida Bright","Lucida Calligraphy","Lucida Fax","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Magneto","Maiandra GD","Malgun Gothic","Mangal","Mangal Pro","Matura MT Script Capitals","Meiryo","Meiryo UI","Microsoft GothicNeo","Microsoft Himalaya","Microsoft JhengHei","Microsoft JhengHei UI","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft Uighur","Microsoft YaHei","Microsoft YaHei UI","Microsoft Yi Baiti","MingLiU","MingLiU_HKSCS","MingLiU_HKSCS-ExtB","MingLiU-ExtB","Miriam","Miriam Fixed","Mistral","Modern Love","Modern Love Caps","Modern Love Grunge","Modern No. 20","Mongolian Baiti","MoolBoran","MS Gothic","MS Mincho","MS PGothic","MS PMincho","MS UI Gothic","MT Extra","MV Boli","Myanmar Text","Mystical Woods Rough Script","Mystical Woods Smooth Script","Narkisim","Neue Haas Grotesk Text Pro","News Gothic MT","Niagara Engraved","Niagara Solid","Nirmala Text","Nirmala UI","Nordique Inline","NSimSun","Nyala","OCRB","Onyx","Palace Script MT","Palatino Linotype","Papyrus","Perpetua","Perpetua Titling MT","Plantagenet Cherokee","Playbill","PMingLiU","PMingLiU-ExtB","Posterama","Pristina","Quire Sans","Raavi","Rage","Rastanty Cortez","Ravie","Rockwell","Rockwell Nova","Rod","Sabon Next LT","Sagona","Sagona Book","Sakkal Majalla","Sanskrit Text","Script MT","Seaford","Seaford Display","Segoe Print","Segoe Script","Segoe UI","Segoe UI Emoji","Segoe UI Historic","Segoe UI Symbol","Segoe UI Semibold","Selawik","Shonar Bangla","Shruti","SimHei","Simplified Arabic","Simplified Arabic Fixed","SimSun","SimSun-ExtB","Sitka Banner","Sitka Display","Sitka Small","Sitka Subheading","Skeena","Skeena Display","Snap ITC","Source Sans Pro","Speak Pro","STCaiyun","STFangsong","STHupo","STKaiti","STXihei","STXingkai","STXinwei","STZhongsong","Sylfaen","Symbol","Tahoma","Tempus Sans ITC","Tenorite","Tenorite Display","TH SarabunPSK","The Hand","The Serif Hand","Tisa Offc Serif Pro","Trade Gothic Inline","Trade Gothic Next","Trade Gothic Next Rounded","Traditional Arabic","Trebuchet MS","Tunga","Tw Cen MT","UD Digi Kyokasho N-B","UD Digi Kyokasho N-R","UD Digi Kyokasho NK-B","UD Digi Kyokasho NK-R","UD Digi Kyokasho NP-B","UD Digi Kyokasho NP-R","Univers","Urdu Typesetting","Utsaah","Vani","Verdana","Vijaya","Viner Hand ITC","Vivaldi","Vladimir Script","Vrinda","Walbaum Display","Walbaum Heading","Walbaum Text","Webdings","Wide Latin","Wingdings","Wingdings 2","Wingdings 3","Yu Gothic","Yu Gothic UI","Yu Mincho"]}},{name:"size",alternateNames:["fontSize"],required:!1,description:"The font size to apply.",type:"integer"},{name:"bulleted",required:!1,description:"Whether the text should be bulleted.",type:"boolean"},{name:"horizontalAlignment",required:!1,description:"The horizontal alignment to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Center","Distributed","Justify","JustifyLow","Left","Right","ThaiDistributed"],enumValuesAlternateNames:["Center:Middle"]}},{name:"verticalAlignment",required:!1,description:"The vertical alignment to apply.",type:"enum",promptAlternative:{enumValues:[]},validationArgs:{correctionStrategy:["Dismissable"],enumValues:["Bottom","BottomCentered","Middle","MiddleCentered","Top","TopCentered"],enumValuesAlternateNames:["Middle:Center"]}}]},{name:"delete_text",alternateNames:["deleteText"],description:"Clears the text in the specified textRanges.",returnVariable:{type:"void",description:""},args:[{name:"textRanges",alternateNames:["scope"],required:!0,description:"The textRanges to delete.",type:"textRanges",promptAlternative:{name:"scope"}}]},{name:"replace_text",alternateNames:["replaceText"],description:"Replaces the specified text with the specified new text.",returnVariable:{type:"void",description:""},args:[{name:"textToReplace",required:!0,description:"The text to replace.",type:"string"},{name:"newText",required:!0,description:"The new text to insert.",type:"string"}]},{name:"select_semantic_text",alternateNames:["selectSemanticText"],description:"Selects text ranges based on natural language descriptions of their content within the presentation. This function is best used when you want to select text ranges based on its content, rather than its exact wording, position, or location within the presentation. For example, if you want to select text ranges that discuss a specific topic, you can use this function to describe the desired selection in plain language, and the function will intelligently match and return relevant selections from the presentation.",returnVariable:{type:"textRanges",description:"The text ranges that match the given selection criteria."},args:[{name:"query",required:!0,description:"The description of what needs to be selected.",type:"string"},{name:"name",required:!1,description:"The name of the text boxes to select.",type:"enum",validationArgs:{enumValues:["Title","Subtitle","Content","Note","SmartArt","Image","TextBox","Table","Chart","Other","GroupShape"],enumValuesAlternateNames:["Content:Body"]}}]},{name:"select_indices_text",alternateNames:[],description:"Selects text ranges using the given shape reference and text.",returnVariable:{type:"textRanges",description:"The text ranges that reference the matching shape reference and text."},args:[{name:"indices",required:!0,description:"The text range reference that matches the given selection criteria.",type:"string"}]}];class sH{static handle(e,t,n){return(0,F.__awaiter)(this,void 0,void 0,(function*(){var r,o,i,a,s;const l=e.body;if(l&&nH.typeGuard(l))try{if((null===(o=null===(r=null==l?void 0:l.odslResponse)||void 0===r?void 0:r.odsl)||void 0===o?void 0:o.statements)&&(null===(a=null===(i=null==l?void 0:l.odslResponse)||void 0===i?void 0:i.odsl)||void 0===a?void 0:a.statements.length)>0){const e=sH.handleODSLResponse(l.odslResponse.odsl.statements,n);null===(s=t.current)||void 0===s||s.addResponseMessage({chatCardType:jp._.PlanBuilderCard,chatMessageData:{planBuilderCardProps:{user:ig.Q9.Chat,chatMessage:"",tasks:e,handleStartClicked:e=>{var t,r,o,i;if(e.length!==(null===(r=null===(t=null==l?void 0:l.odslResponse)||void 0===t?void 0:t.odsl)||void 0===r?void 0:r.statements.length))return void iH.error("Mismatch in the number of confirmed tasks and original statements.");const a=[];for(let t=0;t<e.length;t++){const n=null===(i=null===(o=null==l?void 0:l.odslResponse)||void 0===o?void 0:o.odsl)||void 0===i?void 0:i.statements[t],r=e[t].taskProperties,s=n&&r?this.replaceOdslStatementParameters(n,r):void 0;s&&a.push(s)}const s={odsl:{statements:a}};n.handlePlanStartClicked(s)}}}})}}catch(e){e instanceof Error&&this.showMarkdownErrorCard("Error displaying a plan for the Agent plan "+e.toString(),t)}}))}static handleODSLResponse(e,t){const n=[];return e.flatMap((e=>e.arguments.nested?JSON.parse(e.arguments.nested.json||"{}"):e)).forEach((e=>{n.push(this.extractCodeValues(e,t))})),n}static extractCodeValues(e,t){var n;const r=[];null===(n=e.argumentsArray)||void 0===n||n.forEach((n=>{const o=n.key,i=this.stringifyArgumentValue(n.value);r.push({name:this.getDescriptiveArgumentName(e.name,o,t),value:i,type:n.value.type,enumOptions:this.getArgumentEnumOptionsIfHas(e.name,o,t)})}));return{title:this.getDescriptiveStatementName(e.name,t),icon:this.getIcon(),taskProperties:r,description:this.getStatementDescription(e.name,t)}}static replaceOdslStatementParameters(e,t){const n=[],r=e.argumentsArray;for(let e=0;e<t.length;e++)r&&n.push({key:r[e].key||"",value:this.destringifyArgumentValue(t[e])});return{name:e.name,returns:e.returns,arguments:this.convertArgsArrayToOdslArguments(n),dismissedArguments:e.dismissedArguments,argumentsArray:n}}static convertArgsArrayToOdslArguments(e){const t={};return e.forEach((e=>{t[e.key]=e.value})),t}static stringifyArgumentValue(e){var t,n;try{switch(e.type){case"string":case"color":case"formattedString":return e.string?e.string:"";case"regex":return e.regex?e.regex:"";case"var":case"scope":case"enum":return e.name?e.name:"";case"boolean":return e.boolean?"true":"false";case"number":return e.number?e.number.toString():"";case"jsonGrid":return e.json?e.json:"";case"stringList":return(null===(t=e.stringList)||void 0===t?void 0:t.join(", "))||"";case"numberList":return(null===(n=e.numberList)||void 0===n?void 0:n.join(", "))||"";default:return"Unsupported argument value type."}}catch(t){return"Failed to stringify argument value of type "+e.type}}static destringifyArgumentValue(e){const t={type:e.type};try{switch(e.type){case"string":case"color":case"formattedString":t.string=e.value;break;case"regex":t.regex=e.value;break;case"var":case"scope":case"enum":t.name=e.value;break;case"boolean":t.boolean="true"===e.value.toLowerCase();break;case"number":t.number=parseInt(e.value);break;case"jsonGrid":t.json=e.value;break;case"stringList":t.stringList=e.value.split(", ");break;case"numberList":t.numberList=e.value.split(", ").map((e=>parseInt(e)));break;default:t.string="Unsupported argument value type."}}catch(n){iH.error("Failed to de-stringify argument "+e.value+" of type "+t.type)}return t}static getDescriptiveStatementName(e,t){var n,r;const o=null===(r=null===(n=t.odslPlugins)||void 0===n?void 0:n.find((t=>t.name===e)))||void 0===r?void 0:r.description;return o||e}static getPluginByStatementName(e,t){var n;return null===(n=t.odslPlugins)||void 0===n?void 0:n.find((t=>{var n;return t.name===e||(null===(n=t.alternateNames)||void 0===n?void 0:n.includes(e))}))}static getStatementDescription(e,t){const n=this.getPluginByStatementName(e,t);return n?n.description:""}static getDescriptiveArgumentName(e,t,n){const r=this.getPluginByStatementName(e,n);if(r){const e=r.args;for(const n of e)if(n.name===t)return n.description}return"Failed to get argument description"}static getArgumentEnumOptionsIfHas(e,t,n){var r;const o=this.getPluginByStatementName(e,n);if(o){const e=o.args;for(const n of e)if(n.name===t&&void 0!==n.validationArgs)return null===(r=n.validationArgs)||void 0===r?void 0:r.enumValues}}static getIcon(){return"PowerPoint"}static showMarkdownErrorCard(e,t){var n;null===(n=t.current)||void 0===n||n.addResponseMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e}},chatMessageBodyData:void 0,stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!1})}}class lH{constructor(e){Qp.h.assign(lH,this,e)}static getTypeName(){return"AugLoop_CopilotCommandingSteerability_SteerableCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[lH.getTypeName()])}}lH.H_={T_:lH.getTypeName(),B_:lH.getBaseTypes()};class cH{constructor(e){Qp.h.assign(cH,this,e)}static getTypeName(){return"AugLoop_CopilotCommandingSteerability_SteerableCopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[cH.getTypeName()])}}cH.H_={T_:cH.getTypeName(),B_:cH.getBaseTypes()};const uH=(e,t)=>({queryId:t,query:e});class dH{static generateId(){return dH.operationId++,"CommandingDisambiguation-Input"+dH.operationId.toString()}}dH.operationId=0;class pH extends hU.h{constructor(e,t,n){super(),this.baseHandler=e,this.copilotChatRef=t,this.settings=n}shouldSendRequestToAugloop(e){return this.baseHandler.shouldSendRequestToAugloop(e)}getWorkflowsToRegister(){return[...this.baseHandler.getWorkflowsToRegister(),{workflowAnnotationType:nH.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:65e3}]}getDefaultSignalOperation(e,t){return(0,F.__awaiter)(this,void 0,void 0,(function*(){const[n,r]=function(e,t){const n=uH(e,t);return[new lH(n),nH.getTypeName()]}(e,t);return{operation:new Vp.g0({parentPath:["session"],items:[{id:dH.generateId(),body:n}]}),workflowAnnotationType:r}}))}sendResponseToClient(e,t){var n,r,o,i;const a=null===(r=null===(n=e.body)||void 0===n?void 0:n.chatResponse)||void 0===r?void 0:r.messages;a&&a.length>0&&(null===(o=this.copilotChatRef.current)||void 0===o||o.addResponseMessage({chatCardType:jp._.MarkdownCard,chatMessageData:{markDownCardProps:{message:null!==(i=gH(a[0].text))&&void 0!==i?i:oH}},stopLoadingUi:!0})),sH.handle(e,this.copilotChatRef,this.settings);const s=e.id;if(!this.annotationId||this.annotationId!==s)return this.annotationId&&this.annotationId===s||(this.annotationId=s),this.baseHandler.sendResponseToClient(e,t)}sendEventToClient(e,t){return this.baseHandler.sendEventToClient(e,t)}getHostSettings(){return this.baseHandler.getHostSettings()}getALSession(){return this.baseHandler.getALSession()}getAuthToken(){return this.baseHandler.getAuthToken()}isFeatureGateEnabledFromClient(e){return this.baseHandler.isFeatureGateEnabledFromClient(e)}}const gH=e=>{var t;try{const n=null===(t=JSON.parse(e))||void 0===t?void 0:t.payload;return n?n.displayMessage:oH}catch(t){return e}};var mH=n(26154),fH=n(21740),hH=n(22585),vH=function(e,t){var n=[];return zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)||e===Vd.USED||n.push(yH(vM.createPresentation(),mH.snm,mH.ui8,!1,!1,!1)),(!rF(t)||rR()&&Vh(Lh.IsBumbleBeeZQMVisibleForConsumer))&&n.push(yH(vM.transformFile(),cg.cIO,cg.EK9,!1,!1,!0,Iw.ck.File,iF()?OR([Iw.ck.Event,Iw.ck.People,Iw.ck.Message]):void 0)),n},yH=function(e,t,n,r,o,i,a,s){return{suggestionText:e,iconRegular:t,iconHover:n,isDisabled:r,shouldSubmitQueryOnClick:o,shouldLaunchCIQOnSelection:i,scopedEntity:a,unSupportedEntities:s}},CH=function(e,t){var n,r=[];switch(r=vH(e,t),e){case Vd.BLANK:var o;(o=r).push.apply(o,Ed((n=[],zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)&&n.push(yH(vM.addImage(),Dk.ugV,Dk._CC,!1,!1)),zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)?n.push(yH(vM.showHelpLink(),nE.LHQ,nE.ne2,!1,!1)):n.push(yH(vM.addSlide(),mH.uJQ,mH.IIZ,!1,!1)),n)));break;case Vd.USED:var i;(i=r).push.apply(i,Ed([yH(vM.summarizePresentation(),fH.vR$,fH.dDm,!1,!Jh(Dh.EnableZQMQuerySubmissionThroughChatInputBox)),yH(vM.structurePresentation(),hH.$oq,hH.v$E,!1,!Jh(Dh.EnableZQMQuerySubmissionThroughChatInputBox)),yH(vM.askAQuestion(),fH.oR,fH.wn6,!1,!1)]));break;case Vd.LESS_WORD_COUNT:var a;(a=r).push.apply(a,Ed([zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)?yH(vM.showActionItems(),cg.Da8,cg.l0C,!1,!Jh(Dh.EnableZQMQuerySubmissionThroughChatInputBox)):yH(vM.addSlide(),mH.uJQ,mH.IIZ,!1,!1),yH(vM.askAQuestion(),fH.oR,fH.wn6,!1,!1),yH(vM.addImage(),Dk.ugV,Dk._CC,!1,!1)]))}return r=function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;switch(s.suggestionText){case vM.createPresentation():Jh(Dh.CreatePresentationInMenuEnabled)&&t.push(s);break;case vM.transformFile():Jh(Dh.TransformFileInMenuEnabled)&&t.push(s);break;case vM.addSlide():Jh(Dh.AddSlideInMenuEnabled)&&t.push(s);break;case vM.addImage():Jh(Dh.AddImageInMenuEnabled)&&t.push(s);break;case vM.addEnterpriseImage():Vh(Lh.IsHubbleEnterpriseEnabled)&&t.push(s);break;case vM.structurePresentation():Jh(Dh.StructurePresentationInMenuEnabled)&&t.push(s);break;case vM.summarizePresentation():Jh(Dh.SummarizeInMenuEnabled)&&t.push(s);break;case vM.tryNewDesign():Vh(Lh.TryNewDesignOptionInMenuEnabled)&&t.push(s);break;case vM.askAQuestion():t.push(s)}}}catch(e){r=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t}(r),{headerText:PowerpointCopilotStrings.ZQMHumbleHeaderLine1+"\n\n"+PowerpointCopilotStrings.ZQMHumbleHeaderLine2,promptSuggestionList:r.slice(0,3)}};function SH(e){return rF(e)&&!rR()?Vh(Lh.UseUpdatedZQMV2PromptString)?tM.createPresentationAboutNationalPark():tM.createPresentationConsumer():tM.createFromFile()}function bH(e){return rF(e)?Vh(Lh.UseUpdatedZQMV2PromptString)?tM.addSlideAboutMeeting():tM.addSlideAbout():tM.createPresentationAboutCollaboration()}function EH(e){return rF(e)?tM.addAnImageOfCake():tM.showKeySlidesFromThisPresentation()}var TH,IH,_H=function(e,t){var n=!Jh(Dh.EnableZQMQuerySubmissionThroughChatInputBox),r=Vh(Lh.UseUpdatedZQMV2PromptString),o=e===Vd.BLANK||e===Vd.LESS_WORD_COUNT,i=[{suggestionCategory:$F.menuSectionCreate(),suggestionText:SH(t),iconRegular:bw.vfO,shouldLaunchCIQOnSelection:oF(t),unSupportedEntities:iF()?OR([Iw.ck.Event,Iw.ck.People,Iw.ck.Message]):void 0},{suggestionCategory:$F.menuSectionCreate(),suggestionText:r?bH(t):tM.createPresentationAbout(),iconRegular:bw.vfO},{suggestionCategory:$F.menuSectionUnderstand(),suggestionText:o?tM.datesAndDeadlines():tM.summarize(),iconRegular:Ew.uJg,shouldSubmitQueryOnClick:!o&&n},{suggestionCategory:$F.menuSectionUnderstand(),suggestionText:r?EH(t):tM.showKeySlides(),iconRegular:Ew.uJg,shouldSubmitQueryOnClick:!o&&n}];return Vh(Lh.IsDesignerShownInZQM)&&i.push({suggestionCategory:$F.menuSectionCreateImage(),suggestionText:tM.generateImage(),iconRegular:Dk.spT}),{promptSuggestionList:i}};class wH{constructor(e){Qp.h.assign(wH,this,e)}static getTypeName(){return"AugLoop_SegmentToSlide_SegmentToSlideSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[wH.getTypeName()])}}wH.H_={T_:wH.getTypeName(),B_:wH.getBaseTypes()},function(e){e.Error="Error",e.Unauthorized="Unauthorized",e.InvalidInput="InvalidInput",e.SlideGenerationFailed="SlideGenerationFailed",e.Overloaded="Overloaded",e.BlockedByRAI="BlockedByRAI",e.CopilotLicensingError="CopilotLicensingError"}(TH||(TH={}));var PH=sb.getInstance(),xH=ob.getInstance(),kH=Tb.getInstance(),AH=(function(){var e=(0,gd._)((function(e,t){var n,r,o,a,s;return(0,F.__generator)(this,(function(l){return r=Sb.getInstance().getChatRef(),IH=(new Date).getTime(),jE.getInstance().getState()!==Qd.IDLE&&mb.getInstance().addContextId(qp.dB),o=Jh(Dh.IsSegmentToSlideSendTemplateIdEnabled)&&ib.getInstance().isCreateNewFromBlank()?"":"NonEmptyTemplateId",a={correlationId:qp.dB,segmentBlobs:e,language:_p.GetHostAppDisplayLanguage(),fCreateNewPresentation:zR.IsSettingTrue(DR.PPTBBPresOutlineEnabled),entryPoint:XM.Chat,sourceDocumentSensitivityLabels:t,templateId:o,jsonCmdApiVersion:yR(),fCreateJsonCmdList:Vh(Lh.IsCreateJsonCmdListForBumbleBeeEnabled)},s=new Vp.Xr({parentPath:["Signal",wH.getTypeName()],items:[{id:lx.r.generateId(),body:new wH(a)}]}),jE.getInstance().getState()===Qd.IDLE||(null===(n=r.current)||void 0===n||n.submitOperation({operation:s,workflowAnnotationType:yw.getTypeName()}),lw.getInstance().setSkillName(mp.ContentTransform),xH.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.SegmentToSlideOperationSubmitted))),jE.getInstance().setState(Qd.WAITING_FOR_SEGMENT_TO_SLIDE_WF_RESPONSE)),[2]}))}))}(),function(){var e=(0,gd._)((function(e,t,n,r,o,a,s){var l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x,k,A,L,D,O,N,R,M,B,U,H,G,z,q;return(0,F.__generator)(this,(function(W){switch(W.label){case 0:return jE.getInstance().getState()===Qd.IDLE?(ZR("SegmentToSlideWorkflowHandler: ExecutionStateManager is in IDLE state. Returning \n"),[2]):(ZR("".concat(yw.getTypeName()," response received\n Time Taken: ").concat((0,qp.WU)(IH),"s ")),jE.getInstance().setState(Qd.EXECUTING),PH.setResponseTime((0,qp.WU)(qp.qD)),l=e.body,c=null==l?void 0:l.slideResponses,u=null==l?void 0:l.presentationOutline,d=null==l?void 0:l.error,p=JSON.stringify(c),g=null==l?void 0:l.designerOptions,m=null==l?void 0:l.sourceDocumentSensitivityLabels,f=null==l?void 0:l.hasAddedImage,h=null==l?void 0:l.numberOfSlides,v=null==l?void 0:l.fileName,y=null==l?void 0:l.jsonCmdPayload,void 0!==l.correlationId&&GS(l.correlationId),C=xH.getQueryGuid(),US(xH,yw.getTypeName(),IH,sC.SegmentToSlideResponseTime,_C.CreatePresentationFromDoc,s),S=new lT({status:fE.failed,queryId:C,error:void 0}),void 0===d?[3,4]:(ZR("Error from SegmentToSlide WF: ".concat(d,"\n json response : ").concat(p)),b=function(e,t,n){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ZR("Error in SegmentToSlide, Type : ".concat(t.errorType,", Message : ").concat(t.message,"\n")),ob.getInstance().sendErrorTelemetry(HS((r={},(0,i._)(r,uC.ErrorMessage,"Error in SegmentToSlide Workflow , Type : ".concat(t.errorType)),(0,i._)(r,uC.ErrorCategory,IC.ContextIQ),r)));var a,s={errorType:"".concat(t.errorType),featureName:_C.CreatePresentationFromDoc};switch(t.errorType){case TH.Overloaded:s.errorMessage=PowerpointCopilotStrings.ThrottlingErrorMessage,wL(e,PowerpointCopilotStrings.ThrottlingErrorMessage,void 0,void 0,o,s),a=pC.ThrottlingErrorMessage;break;case TH.SlideGenerationFailed:case TH.Error:case TH.InvalidInput:case TH.BlockedByRAI:s.errorMessage=PowerpointCopilotStrings.TransformFileGeneralError,wL(e,PowerpointCopilotStrings.TransformFileGeneralError,void 0,void 0,o,s),a=pC.TransformFileGeneralError;break;case TH.Unauthorized:s.errorMessage=PowerpointCopilotStrings.CLPNoAccessPermission,wL(e,PowerpointCopilotStrings.CLPNoAccessPermission,void 0,void 0,o,s),a=pC.CLPNoAccessPermission;break;case TH.CopilotLicensingError:s.errorMessage=OfficeaicopilotStrings.LicenseValidationErrorMessage,wL(e,OfficeaicopilotStrings.LicenseValidationErrorMessage,void 0,void 0,o,s),a=pC.LicenseValidationErrorMessage;break;default:s.errorMessage=PowerpointCopilotStrings.TransformFileGeneralError,wL(e,PowerpointCopilotStrings.TransformFileGeneralError,void 0,void 0,o,s),cF(n)||(n.error=PowerpointCopilotStrings.TransformFileGeneralError),a=pC.TransformFileGeneralError}return a}(t,d,S,!ZA()),MS(xH,qp.qD,"".concat(yw.getTypeName(),"_Error"),d.errorType,ep.Server,void 0,!ZA(),b),UA()?[3,1]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,3])));case 1:return[4,HA(S,t)];case 2:W.sent(),W.label=3;case 3:return M_(!1,"SegmentToSlideWorkflow_".concat(d.errorType),Cv.CreatePresentationFromDoc),PH.resetData(),[2];case 4:return E=(new Date).getTime(),T={status:Md.SUCCESS},I=[],_=[],PH.setScenarioName(Cv.CreatePresentationFromDoc),Vh(Lh.IsCreateJsonCmdListForBumbleBeeEnabled)&&y?(_=y.cmds,ZR("CreatePres Command Object created in Augloop"),[3,12]):[3,5];case 5:if(cF(c))return[3,11];for(w=0;w<c.length;w++)c[w].error?ZR("SlideResponse slide ".concat(w," has error. type: ").concat(null===(P=c[w].error)||void 0===P?void 0:P.errorType,"; message: ").concat(null===(x=c[w].error)||void 0===x?void 0:x.message)):I.push(c[w].slide);W.label=6;case 6:return W.trys.push([6,9,,10]),I.length>0?[4,AD({slideResponseFromSegmentWF:I})]:[3,8];case 7:k=W.sent(),_.push(k),W.label=8;case 8:return[3,10];case 9:return A=W.sent(),ZR("CreatePres Command Object creation failed"+JSON.stringify(A)),T={status:Md.FAILED,error:Bd.SEGMENT_TO_SLIDE_SERVER_ERROR},[3,10];case 10:return[3,12];case 11:cF(u)?(ZR("SlideResponse and presentationOutline response are undefined"),T={status:Md.FAILED,error:Bd.SEGMENT_TO_SLIDE_SERVER_ERROR}):(L={name:mv.CreatePresentationCmd,version:Dv,data:u},_.push(L)),W.label=12;case 12:return _.length>0?(D={},O={scenarioName:Cv.CreatePresentationFromDoc,startTime:PH.getStartTime(),entryPoint:XM.Chat,correlationId:C,timeToODSLMS:1e3*PH.getResponseTime(),timeODSLToJOfcMS:0,capability:PH.getCapability(),featureName:PH.getFeatureName(),subFeatureName:PH.getSubFeatureName()},ZR("scenarioOptions : ",JSON.stringify(O)),[4,(0,gd._)((function(){var e,n,o,i,a;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:return e=Vh(Lh.IsEmptyLabelFixForCLPv2FeatureEnabled),!Vh(Lh.IsApplyLabelUsingTryUpgradeLabelEnabled)||!GL()||!e&&PR(kH)?[3,4]:e&&PR(kH)?[3,3]:(n=!lD())?[4,xR(kH,T)]:[3,2];case 1:n=!s.sent(),s.label=2;case 2:if(n)return T=Sd(Cd({},T),{status:Md.FAILED,error:Bd.APPLY_CLP_LABEL_FAILED}),[2];s.label=3;case 3:return[3,5];case 4:cF(m)||(ZR("Applying label using docMetaData"),o={labelInfo:m},O.docMetadata=o),s.label=5;case 5:D.scenarioOptions=JSON.stringify(O),cF(g)||(D.designerOptions=JSON.stringify(g)),s.label=6;case 6:return s.trys.push([6,8,,9]),pd()?r(!0):r(!1),null===(i=t.current)||void 0===i||i.updateLoadingComponentProps(Cd({loadingUiStringList:[PowerpointCopilotStrings.TransformFileLoadingUIMessage4,PowerpointCopilotStrings.LoadingUILookingThingsOver,PowerpointCopilotStrings.LoadingUIAlmostThere]},FN())),[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,X_(e,_,D)];case 1:return T=t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 7:return s.sent(),ZR("log result : ",JSON.stringify(T)),[3,9];case 8:return a=s.sent(),ZR("Execution failed"+JSON.stringify(a)),T={status:Md.FAILED,error:Bd.JOFC_EXCEPTION},[3,9];case 9:return[2]}}))}))()]):[3,14];case 13:return W.sent(),Jh(Dh.IsJofcCommandErrorTelemetryEnabled)&&T.status!==Md.SUCCESS&&xH.sendChatEventTelemetry(HS((R={},(0,i._)(R,cC.ChatEventType,dC.SegmentToSlideJOfcCommandsError),(0,i._)(R,cC.ChatEventParameters,Bd[null!==(N=T.error)&&void 0!==N?N:Bd.UNKNOWN_ERROR]),R))),[3,15];case 14:M_(!1,"SegmentToSlideWorkflow_NoCmdsGenerated",Cv.CreatePresentationFromDoc),W.label=15;case 15:switch(xH.sendLatencyTelemetry(HS((0,i._)({},sC.QueryExecutionTime,(0,qp.WU)(E)))),M=Lx.length>0&&""!==Lx[0]&&fF(Dx),T.status){case Md.BLOCKED:case Md.UNSUPPORTED:case Md.FAILED:case Md.UNEXPECTED_VERSION:case Md.USER_ABORTED:case Md.PARTIAL_SUCCESS:return[3,16];case Md.SUCCESS:return[3,17]}return[3,19];case 16:return XP(T,t,a,yw.getTypeName(),S,!ZA()),[3,19];case 17:return S.status=fE.success,[4,zA(Md.SUCCESS)];case 18:return W.sent(),U=GF()[2],M&&(U.linkPrefix=Lx.filter((function(e){return e})).join(" ")+" "),o(),H=!(Vh(Lh.UseAIResponsesInODSLForSydney)&&ZA()),G={featureName:PH.getFeatureName()},null===(B=t.current)||void 0===B||B.addResponseMessage(function(e,t,n,r,o,i){var a={text:PowerpointCopilotStrings.TransformFileConfirmationHeader.replace("%s",null!=e?e:PowerpointCopilotStrings.TransformFileDocumentAliasWhenFilenameIsMissing)},s={text:PowerpointCopilotStrings.TransformFileConfirmationDesignerLayoutAdjustmentSuggestion.split(PowerpointCopilotStrings.RibbonButtonDesigner)[0],linkText:{text:PowerpointCopilotStrings.RibbonButtonDesigner,linkOnClick:o,linkSuffix:PowerpointCopilotStrings.TransformFileConfirmationDesignerLayoutAdjustmentSuggestion.split(PowerpointCopilotStrings.RibbonButtonDesigner)[1]}},l=[];if(l.push({text:PowerpointCopilotStrings.TransformFileConfirmationSpeakerNotes}),t&&l.push({text:PowerpointCopilotStrings.TransformFileConfirmationAddedImages}),l.push({text:PowerpointCopilotStrings.TransformFileConfirmationAddedLayouts}),FL.shouldShowInDocSensitivityLabel()&&""!==FL.getInDocSensitiveLabelInfo().displayName){var c,u=PowerpointCopilotStrings.TransformFileConfirmationCLPSensitivityLabel1Prefix.replace("%s",null!==(c=FL.getInDocSensitiveLabelInfo().displayName)&&void 0!==c?c:"")+PowerpointCopilotStrings.TransformFileConfirmationCLPSensitivityLabel1LinkText+PowerpointCopilotStrings.TransformFileConfirmationCLPSensitivityLabel1Suffix;l.push({text:u})}var d=[{listHeader:PowerpointCopilotStrings.TransformFileConfirmationListPrefix.replace("%s",n),listItems:l}];return DL(d,a,s,Sd(Cd({},mL),{clpSensitivityIndicatorData:FL.shouldShowInDocSensitivityLabel()?ML():void 0}),r,Wd.CHATPPT,i)}(v,f,h,H,n,G)),xH.sendChatEventTelemetry(HS((z={},(0,i._)(z,cC.ChatEventType,dC.TransformFileUsedWithCLP),(0,i._)(z,cC.ChatEventParameters,"IsEncrypted_".concat(kH.isInDocSensitivityLabelEncrypted())),z))),xH.sendChatEventTelemetry(HS((q={},(0,i._)(q,cC.ChatEventType,dC.QuerySuccessful),(0,i._)(q,cC.ChatEventParameters,yw.getTypeName()),q))),MS(xH,qp.qD,void 0,void 0,void 0,void 0,!ZA()),[3,19];case 19:return PH.resetData(),UA()?[3,20]:(jE.getInstance().setState(Qd.IDLE),mb.getInstance().emptyContextIdListandCleanup(),[3,22]);case 20:return[4,HA(S,t)];case 21:W.sent(),W.label=22;case 22:return ZR("User Perceived Latency :  ".concat((0,qp.WU)(qp.qD)," sec")),[4,Nw(t)];case 23:return W.sent(),[2]}}))}));return function(t,n,r,o,i,a,s){return e.apply(this,arguments)}}()),LH=ob.getInstance(),DH=function(){var e=(0,gd._)((function(e,t,n){var r,o,a,s,l,c,u,d,p,g,m,f;return(0,F.__generator)(this,(function(h){return o=null==e?void 0:e.body,a=null==o?void 0:o.correlationId,s=null==o?void 0:o.generatedSlideNumber,l=null==o?void 0:o.totalSlideNumber,mb.getInstance().isValidAnnotationResponse(a)?(ZR("".concat(Cw.getTypeName()," response. correlationId: ").concat(a,", generatedSlideNumber: ").concat(s,", totalSlideNumber: ").concat(l)),0===l?(LH.sendChatEventTelemetry(HS((g={},(0,i._)(g,cC.ChatEventType,dC.SegmentToSlideProgress),(0,i._)(g,cC.ChatEventParameters,"total slide count is 0"),(0,i._)(g,cC.Cv,null!=n?n:""),(0,i._)(g,cC.UserQueryGuid,a),g))),[2,!1]):(m=Math.round(s/l*100).toString(),LH.sendChatEventTelemetry(HS((f={},(0,i._)(f,cC.ChatEventType,dC.SegmentToSlideProgress),(0,i._)(f,cC.ChatEventParameters,m),(0,i._)(f,cC.Cv,null!=n?n:""),(0,i._)(f,cC.UserQueryGuid,a),f))),"100"===m&&(m="98"),null===(r=t.current)||void 0===r||r.updateLoadingComponentProps(Cd({loadingUiStringList:[PowerpointCopilotStrings.LoadingUIGenerateSlides.replace("%s",m)]},FN())),[2,!0])):(ZR("Ignoring segmentToSlideProgressAnnotationProcessor for correlationId: ".concat(a)),LH.sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.ChatEventType,dC.InvalidContextIdResponse),(0,i._)(p,cC.ChatEventParameters,null!==(d=null===(u=e.body)||void 0===u||null===(c=u.H_)||void 0===c?void 0:c.T_)&&void 0!==d?d:""),(0,i._)(p,cC.Cv,null!=n?n:""),(0,i._)(p,cC.UserQueryGuid,a),p))),[2,!1])}))}));return function(t,n,r){return e.apply(this,arguments)}}(),OH=n(62449),NH=window.innerHeight-100,RH=("".concat(NH,"px"),(0,Za.n)((0,OH.f)({chatFreStack:{height:"calc(100vh - 50px)"},chatFreStackZoom:{height:"calc(100vh - 50px)"}}))),FH=(0,Za.n)({ariaAnnouncer:{position:"absolute",width:"1px",height:"1px",margin:"-1px",padding:"0",overflow:"hidden",border:"0",clipPath:"inset(50%)",whiteSpace:"nowrap"}}),MH={calloutStyles:{marginTop:4,borderRadius:2},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},BH=ob.getInstance(),UH=function(e,t,n){var r=a.useCallback(function(){var r=(0,gd._)((function(r){var o,a,s,l,c,u,d;return(0,F.__generator)(this,(function(p){return a=window.location.href.replace("taskpane.html","dialog.html"),s={displayCategory:[{value:rp.Create,count:6},{value:rp.Ask,count:6},{value:rp.Edit,count:6},{value:rp.Understand,count:6}]},l=r?{displayCategory:[r]}:void 0,c=n===Sh.G.defaultBlack,u=function(n){var r=JSON.parse(n);switch(ZR("message received from Copilot Lab: ",n),r.type){case tp.Ack:BH.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CopilotLabDialogLaunched)));var a={facetsLib:s,prompts:e,locale:TS(_p.GetHostAppDisplayLanguage()),selectedFacets:l,isDarkMode:c,bookmarked:[],promptLabDialogHeader:OfficeaicopilotStrings.CopilotPromptLibraryHeader,promptLabDialogButtonLabel:OfficeaicopilotStrings.CopilotLabLaunchertext};o&&o.messageChild(JSON.stringify(a),{targetOrigin:"*"});break;case tp.CloseEvent:o&&o.close(),BH.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CopilotLabDialogClosed)));break;case tp.PromptOnClick:o&&o.close(),BH.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.CopilotLabDialogClosed)));var u,d,p,g=r.prompt;if(ZR("Prompt on Click prompt: ",g),BH.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.CopilotLabPromptItemClicked),(0,i._)(u,cC.ChatEventParameters,"".concat(g.DisplayCategory)),u))),bN(Wd.COPILOTLAB),EN(r.prompt.PromptId),_p.GetHostAppPlatform()===CM)setTimeout((function(){var e,t;null===(t=Sb.getInstance().getChatRef())||void 0===t||null===(e=t.current)||void 0===e||e.setInputAreaText(r.prompt.CommandText)}),700);else null===(p=Sb.getInstance().getChatRef())||void 0===p||null===(d=p.current)||void 0===d||d.setInputAreaText(r.prompt.CommandText);break;case tp.PromptFavoriteClick:var m,f,h=r.favorited;r.prompt.UserActvity.Favorite.IsFavorite=h,BH.sendChatEventTelemetry(HS((m={},(0,i._)(m,cC.ChatEventType,dC.CopilotLabSavedPromptClicked),(0,i._)(m,cC.ChatEventParameters,"".concat(r.prompt.DisplayCategory)),m))),t((function(e){return f=e,e}));var v=null==f?void 0:f.map((function(e){return e.PromptId===r.prompt.PromptId?r.prompt:e}));t(v),DU(mU.p.UserActivity,r.prompt.PromptId,h),ZR("prompt favorite click prompt: ".concat(JSON.stringify(r.prompt),", favorited: "),h);break;case tp.FliterChange:var y=r.filter;ZR("filter changed",y);break;case tp.FavoriteFilterClick:var C=r.showOnlyFavorite;ZR("show only favorite",C)}},d=function(){ZR("dialog closed")},_p.GetHostAppPlatform()===CM?Office.context.ui.displayDialogAsync(a,{displayInIframe:!0,hideTitle:!0,height:55,width:55},(function(e){(o=e.value).addEventHandler(Office.EventType.DialogMessageReceived,(function(e){u(e.message)}))})):OfficeFirstPartyDialog.displayWebDialog(a,{displayInIframe:!0,dialogTitle:OfficeaicopilotStrings.CopilotPromptLibraryHeader,hideTitle:!0,height:55,width:55,onMessage:u,onClose:d}).then((function(e){o=e})),[2]}))}));return function(e){return r.apply(this,arguments)}}(),[e,n,t]);return{launchCopilotLab:r}},HH=function(e,t,n,r){var o=[],i=WH(e,t);i.length>0&&o.push({sectionHeader:PowerpointCopilotStrings.PromptMenuSectionEdit,starterPrompts:i});var a=GH();return e>=Dw()&&a.length>0&&o.push({sectionHeader:PowerpointCopilotStrings.PromptMenuSectionUnderstand,starterPrompts:a}),Jh(Dh.LearnMoreOptionInMenuEnabled)&&o.push({sectionHeader:rM,starterPrompts:[zH()]}),Vh(Lh.IsCopilotPromptLabEnabled)&&n.length>0&&o.push({sectionHeader:rM,starterPrompts:[qH(r)]}),o},GH=function(){var e=[];return Jh(Dh.SummarizeInMenuEnabled)&&(e.push({suggestionText:vM.summarizePresentation(),iconRegular:fH.vR$,iconHover:fH.dDm,shouldSubmitQueryOnClick:!0}),e.push({suggestionText:vM.showKeySlides(),iconRegular:hH.Pcs,iconHover:hH.RaE,shouldSubmitQueryOnClick:!0}),e.push({suggestionText:vM.showActionItems(),iconRegular:cg.Da8,iconHover:cg.l0C,shouldSubmitQueryOnClick:!0})),e.push({suggestionText:vM.askAQuestion(),inputAreaText:PowerpointCopilotStrings.AskAQuestionPlaceholderPrefix+" ",iconRegular:fH.oR,iconHover:fH.wn6,shouldSubmitQueryOnClick:!1}),e},zH=function(){return{suggestionText:vM.showHelpLink(),iconRegular:nE.LHQ,iconHover:nE.ne2,shouldSubmitQueryOnClick:!0}},qH=function(e){return{suggestionText:vM.viewMorePrompts(),iconRegular:qU.a$3,iconHover:qU.e13,shouldSubmitQueryOnClick:!1,copilotPromptLab:{shouldOpenCopilotPromptLab:!0,launchCopilotPromptLab:function(){e()}}}},WH=function(e,t){var n=[],r=ib.getInstance().getSlideCount(),o=ib.getInstance().isCreatePresentationEnabled(),i=!0,a=!1,s=void 0;try{for(var l,c=function(){var e=[];return Jh(Dh.CreatePresentationInMenuEnabled)&&!zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)&&e.push({suggestionText:vM.createPresentation(),iconRegular:mH.snm,iconHover:mH.ui8,shouldSubmitQueryOnClick:!1}),Jh(Dh.TransformFileInMenuEnabled)&&e.push({suggestionText:vM.transformFile(),iconRegular:cg.cIO,iconHover:cg.EK9,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!0}),Jh(Dh.AddSlideInMenuEnabled)&&!zR.IsSettingTrue(DR.PPTContentGenerationDisabledByAdmin)&&e.push({suggestionText:vM.addSlide(),iconRegular:mH.uJQ,iconHover:mH.IIZ,shouldSubmitQueryOnClick:!1}),Jh(Dh.AddImageInMenuEnabled)&&e.push({suggestionText:vM.addImage(),iconRegular:Dk.ugV,iconHover:Dk._CC,shouldSubmitQueryOnClick:!1}),Vh(Lh.IsHubbleEnterpriseEnabled)&&e.push({suggestionText:vM.addEnterpriseImage(),iconRegular:Dk.ugV,iconHover:Dk._CC,shouldSubmitQueryOnClick:!1}),Jh(Dh.ChangeTextFormatInMenuEnabled)&&e.push({suggestionText:vM.changeTextFormat(),iconRegular:fH.xVR,iconHover:fH.jDD,shouldSubmitQueryOnClick:!1}),zR.IsSettingTrue(DR.PPTCopilotScnAnimate)&&Jh(Dh.AnimateInMenuEnabled)&&e.push({suggestionText:vM.animate(),iconRegular:hH.yL$,iconHover:hH.aTm,shouldSubmitQueryOnClick:!0}),Jh(Dh.StructurePresentationInMenuEnabled)&&e.push({suggestionText:vM.structurePresentation(),iconRegular:hH.$oq,iconHover:hH.v$E,shouldSubmitQueryOnClick:!0}),Vh(Lh.TryNewDesignOptionInMenuEnabled)&&e.push({suggestionText:vM.tryNewDesign(),iconRegular:cg.ThK,iconHover:cg.vY5,shouldSubmitQueryOnClick:!0}),e}()[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var u=l.value;switch(u.suggestionText){case vM.structurePresentation():if(!aF(r,e))continue;break;case vM.transformFile():if(rF(t))continue;break;case vM.createPresentation():break;case vM.animate():case vM.tryNewDesign():case vM.changeTextFormat():if(r<2||o)continue}n.push(u)}}catch(e){a=!0,s=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}return n},jH=function(e,t,n,r){return{sections:HH(e,t,n,r)}},VH=function(e,t,n,r){var o={promptGuideMenuData:{nodeType:"Root",text:$F.menuTitle(),children:Fw(e,t)}};if(n.length>0){var i={copilotLabMenuItemText:eM.viewMorePrompts(),iconRegular:qU.a$3,iconHover:qU.e13,handleOnClickCopilotLab:r};o.copilotLabProps=i}return o};const QH="fui-Label",JH="fui-Label__required",KH=(0,Ks.X)({root:{Bahqtrf:"fk6fouc",sj55zd:"f19n0e5"},disabled:{sj55zd:"f1s2aq7o",Bbusuzp:"f1dcs8yz"},required:{sj55zd:"f1whyuy6",uwmqm3:["fruq291","f7x41pl"]},small:{Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm"},medium:{Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},large:{Be2twd7:"fod5ikn",Bg96gwp:"faaz57k",Bhrd7zp:"fl43uef"},semibold:{Bhrd7zp:"fl43uef"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1whyuy6{color:var(--colorPaletteRedForeground3);}",".fruq291{padding-left:var(--spacingHorizontalXS);}",".f7x41pl{padding-right:var(--spacingHorizontalXS);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),XH=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{disabled:n=!1,required:r=!1,weight:o="regular",size:i="medium"}=e;return{disabled:n,required:qs.lq(!0===r?"*":r||void 0,{defaultProps:{"aria-hidden":"true"},elementType:"span"}),weight:o,size:i,components:{root:"label",required:"span"},root:qs.Gk((0,Ws.g)("label",{ref:t,...e}),{elementType:"label"})}})(e,t);return(e=>{const t=KH();e.root.className=(0,Ms.z)(QH,t.root,e.disabled&&t.disabled,t[e.size],"semibold"===e.weight&&t.semibold,e.root.className),e.required&&(e.required.className=(0,Ms.z)(JH,t.required,e.disabled&&t.disabled,e.required.className))})(n),(0,il.$e)("useLabelStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.FD)(e.root,{children:[e.root.children,e.required&&(0,Bs.Y)(e.required,{})]})))(n)}));XH.displayName="Label";const ZH=a.createContext(void 0),YH={},$H=(ZH.Provider,(e,t)=>{const{size:n}=null!==(r=a.useContext(ZH))&&void 0!==r?r:YH;var r;const{appearance:o="primary",labelPosition:i="after",size:s=(null!=n?n:"medium"),delay:l=0}=e,c=(0,Bl.Bi)("spinner"),{role:u="progressbar",...d}=e,p=qs.Gk((0,Ws.g)("div",{ref:t,role:u,...d},["size"]),{elementType:"div"}),[g,m]=a.useState(!1),[f,h]=(0,Hl.Z)();a.useEffect((()=>{if(!(l<=0))return f((()=>{m(!0)}),l),()=>{h()}}),[f,h,l]);const v=qs.lq(e.label,{defaultProps:{id:c},renderByDefault:!1,elementType:XH}),y=qs.lq(e.spinner,{renderByDefault:!0,elementType:"span"});v&&p&&!p["aria-labelledby"]&&(p["aria-labelledby"]=v.id);return{appearance:o,delay:l,labelPosition:i,size:s,shouldRenderSpinner:!l||g,components:{root:"div",spinner:"span",spinnerTail:"span",label:XH},root:p,spinner:y,spinnerTail:qs.Gk(e.spinnerTail,{elementType:"span"}),label:v}}),eG="fui-Spinner",tG="fui-Spinner__spinner",nG="fui-Spinner__spinnerTail",rG="fui-Spinner__label",oG=(0,Js.y)("r82apo5",null,[".r82apo5{display:flex;align-items:center;justify-content:center;line-height:0;gap:8px;overflow:hidden;}"]),iG=(0,Ks.X)({vertical:{Beiy3e4:"f1vx9l62"}},{d:[".f1vx9l62{flex-direction:column;}"]}),aG=(0,Js.y)("rvgcg50","r15nd2jo",{r:[".rvgcg50{position:relative;flex-shrink:0;-webkit-mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);background-color:var(--colorBrandStroke2Contrast);color:var(--colorBrandStroke1);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:rb7n1on;}","@keyframes rb7n1on{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}",".r15nd2jo{position:relative;flex-shrink:0;-webkit-mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);background-color:var(--colorBrandStroke2Contrast);color:var(--colorBrandStroke1);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:r1gx3jof;}","@keyframes r1gx3jof{0%{transform:rotate(0deg);}100%{transform:rotate(-360deg);}}"],s:["@media screen and (forced-colors: active){.rvgcg50{background-color:HighlightText;color:Highlight;forced-color-adjust:none;}}","@media screen and (prefers-reduced-motion: reduce){.rvgcg50{animation-duration:1.8s;}}","@media screen and (forced-colors: active){.r15nd2jo{background-color:HighlightText;color:Highlight;forced-color-adjust:none;}}","@media screen and (prefers-reduced-motion: reduce){.r15nd2jo{animation-duration:1.8s;}}"]}),sG=(0,Js.y)("rxov3xa","r1o544mv",{r:[".rxov3xa{position:absolute;display:block;width:100%;height:100%;-webkit-mask-image:conic-gradient(transparent 105deg, white 105deg);mask-image:conic-gradient(transparent 105deg, white 105deg);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:var(--curveEasyEase);animation-name:r15mim6k;}",'.rxov3xa::before,.rxov3xa::after{content:"";position:absolute;display:block;width:100%;height:100%;animation:inherit;background-image:conic-gradient(currentcolor 135deg, transparent 135deg);}',"@keyframes r15mim6k{0%{transform:rotate(-135deg);}50%{transform:rotate(0deg);}100%{transform:rotate(225deg);}}",".rxov3xa::before{animation-name:r18vhmn8;}","@keyframes r18vhmn8{0%{transform:rotate(0deg);}50%{transform:rotate(105deg);}100%{transform:rotate(0deg);}}",".rxov3xa::after{animation-name:rkgrvoi;}","@keyframes rkgrvoi{0%{transform:rotate(0deg);}50%{transform:rotate(225deg);}100%{transform:rotate(0deg);}}",".r1o544mv{position:absolute;display:block;width:100%;height:100%;-webkit-mask-image:conic-gradient(transparent 105deg, white 105deg);mask-image:conic-gradient(transparent 105deg, white 105deg);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:var(--curveEasyEase);animation-name:r109gmi5;}",'.r1o544mv::before,.r1o544mv::after{content:"";position:absolute;display:block;width:100%;height:100%;animation:inherit;background-image:conic-gradient(currentcolor 135deg, transparent 135deg);}',"@keyframes r109gmi5{0%{transform:rotate(135deg);}50%{transform:rotate(0deg);}100%{transform:rotate(-225deg);}}",".r1o544mv::before{animation-name:r17whflh;}","@keyframes r17whflh{0%{transform:rotate(0deg);}50%{transform:rotate(-105deg);}100%{transform:rotate(0deg);}}",".r1o544mv::after{animation-name:re4odhl;}","@keyframes re4odhl{0%{transform:rotate(0deg);}50%{transform:rotate(-225deg);}100%{transform:rotate(0deg);}}"],s:["@media screen and (prefers-reduced-motion: reduce){.rxov3xa{animation-iteration-count:0;background-image:conic-gradient(transparent 120deg, currentcolor 360deg);}.rxov3xa::before,.rxov3xa::after{content:none;}}","@media screen and (prefers-reduced-motion: reduce){.r1o544mv{animation-iteration-count:0;background-image:conic-gradient(transparent 120deg, currentcolor 360deg);}.r1o544mv::before,.r1o544mv::after{content:none;}}"]}),lG=(0,Ks.X)({inverted:{De3pzq:"fr407j0",sj55zd:"f1f7voed"},rtlTail:{btxmck:"f179dep3",gb5jj2:"fbz9ihp",Br2kee7:"f1wkkxo7"},"extra-tiny":{Bqenvij:"fd461yt",a9b677:"fjw5fx7",qmp6fs:"f1v3ph3m"},tiny:{Bqenvij:"fjamq6b",a9b677:"f64fuq3",qmp6fs:"f1v3ph3m"},"extra-small":{Bqenvij:"frvgh55",a9b677:"fq4mcun",qmp6fs:"f1v3ph3m"},small:{Bqenvij:"fxldao9",a9b677:"f1w9dchk",qmp6fs:"f1v3ph3m"},medium:{Bqenvij:"f1d2rq10",a9b677:"f1szoe96",qmp6fs:"fb52u90"},large:{Bqenvij:"f8ljn23",a9b677:"fpdz1er",qmp6fs:"fb52u90"},"extra-large":{Bqenvij:"fbhnoac",a9b677:"feqmc2u",qmp6fs:"fb52u90"},huge:{Bqenvij:"f1ft4266",a9b677:"fksc0bp",qmp6fs:"fa3u9ii"}},{d:[".fr407j0{background-color:var(--colorNeutralStrokeAlpha2);}",".f1f7voed{color:var(--colorNeutralStrokeOnBrand2);}",".f179dep3{-webkit-mask-image:conic-gradient(white 255deg, transparent 255deg);mask-image:conic-gradient(white 255deg, transparent 255deg);}",".fbz9ihp::before,.fbz9ihp::after{background-image:conic-gradient(transparent 225deg, currentcolor 225deg);}",".fd461yt{height:16px;}",".fjw5fx7{width:16px;}",".f1v3ph3m{--fui-Spinner--strokeWidth:var(--strokeWidthThick);}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".fxldao9{height:28px;}",".f1w9dchk{width:28px;}",".f1d2rq10{height:32px;}",".f1szoe96{width:32px;}",".fb52u90{--fui-Spinner--strokeWidth:var(--strokeWidthThicker);}",".f8ljn23{height:36px;}",".fpdz1er{width:36px;}",".fbhnoac{height:40px;}",".feqmc2u{width:40px;}",".f1ft4266{height:44px;}",".fksc0bp{width:44px;}",".fa3u9ii{--fui-Spinner--strokeWidth:var(--strokeWidthThickest);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1wkkxo7{background-image:conic-gradient(currentcolor 0deg, transparent 240deg);}}",{m:"screen and (prefers-reduced-motion: reduce)"}]]}),cG=(0,Ks.X)({inverted:{sj55zd:"fonrgv7"},"extra-tiny":{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},tiny:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},"extra-small":{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},small:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},medium:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},"extra-large":{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},huge:{Bahqtrf:"fk6fouc",Be2twd7:"f1pp30po",Bhrd7zp:"fl43uef",Bg96gwp:"f106mvju"}},{d:[".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f106mvju{line-height:var(--lineHeightBase500);}"]}),uG=a.forwardRef(((e,t)=>{const n=$H(e,t);return(e=>{const{labelPosition:t,size:n,appearance:r}=e,{dir:o}=(0,ul.Y)(),i=oG(),a=iG(),s=aG(),l=lG(),c=sG(),u=cG();e.root.className=(0,Ms.z)(eG,i,("above"===t||"below"===t)&&a.vertical,e.root.className),e.spinner&&(e.spinner.className=(0,Ms.z)(tG,s,l[n],"inverted"===r&&l.inverted,e.spinner.className)),e.spinnerTail&&(e.spinnerTail.className=(0,Ms.z)(nG,c,"rtl"===o&&l.rtlTail,e.spinnerTail.className)),e.label&&(e.label.className=(0,Ms.z)(rG,u[n],"inverted"===r&&u.inverted,e.label.className))})(n),(0,il.$e)("useSpinnerStyles_unstable")(n),(e=>{(0,Us.C)(e);const{labelPosition:t,shouldRenderSpinner:n}=e;return(0,Bs.FD)(e.root,{children:[e.label&&n&&("above"===t||"before"===t)&&(0,Bs.Y)(e.label,{}),e.spinner&&n&&(0,Bs.Y)(e.spinner,{children:e.spinnerTail&&(0,Bs.Y)(e.spinnerTail,{})}),e.label&&n&&("below"===t||"after"===t)&&(0,Bs.Y)(e.label,{})]})})(n)}));uG.displayName="Spinner";var dG=a.lazy((function(){return Promise.all([n.e(9412),n.e(3181)]).then(n.bind(n,19898)).then((function(e){return{default:e.LazyLoadedDesigner}}))})),pG=n(30160);function gG(e){let t=e.length;for(;--t>=0;)e[t]=0}const mG=256,fG=286,hG=30,vG=15,yG=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),CG=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),SG=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bG=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),EG=new Array(576);gG(EG);const TG=new Array(60);gG(TG);const IG=new Array(512);gG(IG);const _G=new Array(256);gG(_G);const wG=new Array(29);gG(wG);const PG=new Array(hG);function xG(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let kG,AG,LG;function DG(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}gG(PG);const OG=e=>e<256?IG[e]:IG[256+(e>>>7)],NG=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},RG=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,NG(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},FG=(e,t,n)=>{RG(e,n[2*t],n[2*t+1])},MG=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},BG=(e,t,n)=>{const r=new Array(16);let o,i,a=0;for(o=1;o<=vG;o++)a=a+n[o-1]<<1,r[o]=a;for(i=0;i<=t;i++){let t=e[2*i+1];0!==t&&(e[2*i]=MG(r[t]++,t))}},UG=e=>{let t;for(t=0;t<fG;t++)e.dyn_ltree[2*t]=0;for(t=0;t<hG;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},HG=e=>{e.bi_valid>8?NG(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},GG=(e,t,n,r)=>{const o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]},zG=(e,t,n)=>{const r=e.heap[n];let o=n<<1;for(;o<=e.heap_len&&(o<e.heap_len&&GG(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!GG(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r},qG=(e,t,n)=>{let r,o,i,a,s=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+s++],r+=(255&e.pending_buf[e.sym_buf+s++])<<8,o=e.pending_buf[e.sym_buf+s++],0===r?FG(e,o,t):(i=_G[o],FG(e,i+mG+1,t),a=yG[i],0!==a&&(o-=wG[i],RG(e,o,a)),r--,i=OG(r),FG(e,i,n),a=CG[i],0!==a&&(r-=PG[i],RG(e,r,a)))}while(s<e.sym_next);FG(e,256,t)},WG=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,i=t.stat_desc.elems;let a,s,l,c=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<i;a++)0!==n[2*a]?(e.heap[++e.heap_len]=c=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,o&&(e.static_len-=r[2*l+1]);for(t.max_code=c,a=e.heap_len>>1;a>=1;a--)zG(e,n,a);l=i;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],zG(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=s,n[2*l]=n[2*a]+n[2*s],e.depth[l]=(e.depth[a]>=e.depth[s]?e.depth[a]:e.depth[s])+1,n[2*a+1]=n[2*s+1]=l,e.heap[1]=l++,zG(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,u,d,p,g,m,f=0;for(p=0;p<=vG;p++)e.bl_count[p]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)u=e.heap[c],p=n[2*n[2*u+1]+1]+1,p>l&&(p=l,f++),n[2*u+1]=p,u>r||(e.bl_count[p]++,g=0,u>=s&&(g=a[u-s]),m=n[2*u],e.opt_len+=m*(p+g),i&&(e.static_len+=m*(o[2*u+1]+g)));if(0!==f){do{for(p=l-1;0===e.bl_count[p];)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[l]--,f-=2}while(f>0);for(p=l;0!==p;p--)for(u=e.bl_count[p];0!==u;)d=e.heap[--c],d>r||(n[2*d+1]!==p&&(e.opt_len+=(p-n[2*d+1])*n[2*d],n[2*d+1]=p),u--)}})(e,t),BG(n,c,e.bl_count)},jG=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=a,a=t[2*(r+1)+1],++s<l&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4))},VG=(e,t,n)=>{let r,o,i=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),r=0;r<=n;r++)if(o=a,a=t[2*(r+1)+1],!(++s<l&&o===a)){if(s<c)do{FG(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==i&&(FG(e,o,e.bl_tree),s--),FG(e,16,e.bl_tree),RG(e,s-3,2)):s<=10?(FG(e,17,e.bl_tree),RG(e,s-3,3)):(FG(e,18,e.bl_tree),RG(e,s-11,7));s=0,i=o,0===a?(l=138,c=3):o===a?(l=6,c=3):(l=7,c=4)}};let QG=!1;const JG=(e,t,n,r)=>{RG(e,0+(r?1:0),3),HG(e),NG(e,n),NG(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var KG=(e,t,n,r)=>{let o,i,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<mG;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),WG(e,e.l_desc),WG(e,e.d_desc),a=(e=>{let t;for(jG(e,e.dyn_ltree,e.l_desc.max_code),jG(e,e.dyn_dtree,e.d_desc.max_code),WG(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*bG[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=o&&(o=i)):o=i=n+5,n+4<=o&&-1!==t?JG(e,t,n,r):4===e.strategy||i===o?(RG(e,2+(r?1:0),3),qG(e,EG,TG)):(RG(e,4+(r?1:0),3),((e,t,n,r)=>{let o;for(RG(e,t-257,5),RG(e,n-1,5),RG(e,r-4,4),o=0;o<r;o++)RG(e,e.bl_tree[2*bG[o]+1],3);VG(e,e.dyn_ltree,t-1),VG(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),qG(e,e.dyn_ltree,e.dyn_dtree)),UG(e),r&&HG(e)},XG={_tr_init:e=>{QG||((()=>{let e,t,n,r,o;const i=new Array(16);for(n=0,r=0;r<28;r++)for(wG[r]=n,e=0;e<1<<yG[r];e++)_G[n++]=r;for(_G[n-1]=r,o=0,r=0;r<16;r++)for(PG[r]=o,e=0;e<1<<CG[r];e++)IG[o++]=r;for(o>>=7;r<hG;r++)for(PG[r]=o<<7,e=0;e<1<<CG[r]-7;e++)IG[256+o++]=r;for(t=0;t<=vG;t++)i[t]=0;for(e=0;e<=143;)EG[2*e+1]=8,e++,i[8]++;for(;e<=255;)EG[2*e+1]=9,e++,i[9]++;for(;e<=279;)EG[2*e+1]=7,e++,i[7]++;for(;e<=287;)EG[2*e+1]=8,e++,i[8]++;for(BG(EG,287,i),e=0;e<hG;e++)TG[2*e+1]=5,TG[2*e]=MG(e,5);kG=new xG(EG,yG,257,fG,vG),AG=new xG(TG,CG,0,hG,vG),LG=new xG(new Array(0),SG,0,19,7)})(),QG=!0),e.l_desc=new DG(e.dyn_ltree,kG),e.d_desc=new DG(e.dyn_dtree,AG),e.bl_desc=new DG(e.bl_tree,LG),e.bi_buf=0,e.bi_valid=0,UG(e)},_tr_stored_block:JG,_tr_flush_block:KG,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(_G[n]+mG+1)]++,e.dyn_dtree[2*OG(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{RG(e,2,3),FG(e,256,EG),(e=>{16===e.bi_valid?(NG(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var ZG=(e,t,n,r)=>{let o=65535&e,i=e>>>16&65535,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{o=o+t[r++]|0,i=i+o|0}while(--a);o%=65521,i%=65521}return o|i<<16};const YG=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var $G=(e,t,n,r)=>{const o=YG,i=r+n;e^=-1;for(let n=r;n<i;n++)e=e>>>8^o[255&(e^t[n])];return~e},ez={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},tz={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:nz,_tr_stored_block:rz,_tr_flush_block:oz,_tr_tally:iz,_tr_align:az}=XG,{Z_NO_FLUSH:sz,Z_PARTIAL_FLUSH:lz,Z_FULL_FLUSH:cz,Z_FINISH:uz,Z_BLOCK:dz,Z_OK:pz,Z_STREAM_END:gz,Z_STREAM_ERROR:mz,Z_DATA_ERROR:fz,Z_BUF_ERROR:hz,Z_DEFAULT_COMPRESSION:vz,Z_FILTERED:yz,Z_HUFFMAN_ONLY:Cz,Z_RLE:Sz,Z_FIXED:bz,Z_DEFAULT_STRATEGY:Ez,Z_UNKNOWN:Tz,Z_DEFLATED:Iz}=tz,_z=258,wz=262,Pz=42,xz=113,kz=666,Az=(e,t)=>(e.msg=ez[t],t),Lz=e=>2*e-(e>4?9:0),Dz=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Oz=e=>{let t,n,r,o=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=o?n-o:0}while(--t);t=o,r=t;do{n=e.prev[--r],e.prev[r]=n>=o?n-o:0}while(--t)};let Nz=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Rz=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Fz=(e,t)=>{oz(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Rz(e.strm)},Mz=(e,t)=>{e.pending_buf[e.pending++]=t},Bz=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Uz=(e,t,n,r)=>{let o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),n),1===e.state.wrap?e.adler=ZG(e.adler,t,o,n):2===e.state.wrap&&(e.adler=$G(e.adler,t,o,n)),e.next_in+=o,e.total_in+=o,o)},Hz=(e,t)=>{let n,r,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match;const l=e.strstart>e.w_size-wz?e.strstart-(e.w_size-wz):0,c=e.window,u=e.w_mask,d=e.prev,p=e.strstart+_z;let g=c[i+a-1],m=c[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(n=t,c[n+a]===m&&c[n+a-1]===g&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(r=_z-(p-i),i=p-_z,r>a){if(e.match_start=t,a=r,r>=s)break;g=c[i+a-1],m=c[i+a]}}}while((t=d[t&u])>l&&0!=--o);return a<=e.lookahead?a:e.lookahead},Gz=e=>{const t=e.w_size;let n,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-wz)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Oz(e),r+=t),0===e.strm.avail_in)break;if(n=Uz(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Nz(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Nz(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<wz&&0!==e.strm.avail_in)},zz=(e,t)=>{let n,r,o,i=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,s=e.strm.avail_in;do{if(n=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>o&&(n=o),n<i&&(0===n&&t!==uz||t===sz||n!==r+e.strm.avail_in))break;a=t===uz&&n===r+e.strm.avail_in?1:0,rz(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Rz(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(Uz(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return s-=e.strm.avail_in,s&&(s>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=s&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-s,e.strm.next_in),e.strstart),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==sz&&t!==uz&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(Uz(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,i=o>e.w_size?e.w_size:o,r=e.strstart-e.block_start,(r>=i||(r||t===uz)&&t!==sz&&0===e.strm.avail_in&&r<=o)&&(n=r>o?o:r,a=t===uz&&0===e.strm.avail_in&&n===r?1:0,rz(e,e.block_start,n,a),e.block_start+=n,Rz(e.strm)),a?3:1)},qz=(e,t)=>{let n,r;for(;;){if(e.lookahead<wz){if(Gz(e),e.lookahead<wz&&t===sz)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Nz(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-wz&&(e.match_length=Hz(e,n)),e.match_length>=3)if(r=iz(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Nz(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Nz(e,e.ins_h,e.window[e.strstart+1]);else r=iz(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Fz(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===uz?(Fz(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fz(e,!1),0===e.strm.avail_out)?1:2},Wz=(e,t)=>{let n,r,o;for(;;){if(e.lookahead<wz){if(Gz(e),e.lookahead<wz&&t===sz)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Nz(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-wz&&(e.match_length=Hz(e,n),e.match_length<=5&&(e.strategy===yz||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=iz(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=Nz(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Fz(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=iz(e,0,e.window[e.strstart-1]),r&&Fz(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=iz(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===uz?(Fz(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fz(e,!1),0===e.strm.avail_out)?1:2};function jz(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}const Vz=[new jz(0,0,0,0,zz),new jz(4,4,8,4,qz),new jz(4,5,16,8,qz),new jz(4,6,32,32,qz),new jz(4,4,16,16,Wz),new jz(8,16,32,32,Wz),new jz(8,16,128,128,Wz),new jz(8,32,128,256,Wz),new jz(32,128,258,1024,Wz),new jz(32,258,258,4096,Wz)];function Qz(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Iz,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Dz(this.dyn_ltree),Dz(this.dyn_dtree),Dz(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Dz(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Dz(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Jz=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Pz&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==xz&&t.status!==kz?1:0},Kz=e=>{if(Jz(e))return Az(e,mz);e.total_in=e.total_out=0,e.data_type=Tz;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Pz:xz,e.adler=2===t.wrap?0:1,t.last_flush=-2,nz(t),pz},Xz=e=>{const t=Kz(e);var n;return t===pz&&((n=e.state).window_size=2*n.w_size,Dz(n.head),n.max_lazy_match=Vz[n.level].max_lazy,n.good_match=Vz[n.level].good_length,n.nice_match=Vz[n.level].nice_length,n.max_chain_length=Vz[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},Zz=(e,t,n,r,o,i)=>{if(!e)return mz;let a=1;if(t===vz&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||n!==Iz||r<8||r>15||t<0||t>9||i<0||i>bz||8===r&&1!==a)return Az(e,mz);8===r&&(r=9);const s=new Qz;return e.state=s,s.strm=e,s.status=Pz,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=t,s.strategy=i,s.method=n,Xz(e)};var Yz=(e,t)=>{if(Jz(e)||t>dz||t<0)return e?Az(e,mz):mz;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||n.status===kz&&t!==uz)return Az(e,0===e.avail_out?hz:mz);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(Rz(e),0===e.avail_out)return n.last_flush=-1,pz}else if(0===e.avail_in&&Lz(t)<=Lz(r)&&t!==uz)return Az(e,hz);if(n.status===kz&&0!==e.avail_in)return Az(e,hz);if(n.status===Pz&&0===n.wrap&&(n.status=xz),n.status===Pz){let t=Iz+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Cz||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,Bz(n,t),0!==n.strstart&&(Bz(n,e.adler>>>16),Bz(n,65535&e.adler)),e.adler=1,n.status=xz,Rz(e),0!==n.pending)return n.last_flush=-1,pz}if(57===n.status)if(e.adler=0,Mz(n,31),Mz(n,139),Mz(n,8),n.gzhead)Mz(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Mz(n,255&n.gzhead.time),Mz(n,n.gzhead.time>>8&255),Mz(n,n.gzhead.time>>16&255),Mz(n,n.gzhead.time>>24&255),Mz(n,9===n.level?2:n.strategy>=Cz||n.level<2?4:0),Mz(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Mz(n,255&n.gzhead.extra.length),Mz(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=$G(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(Mz(n,0),Mz(n,0),Mz(n,0),Mz(n,0),Mz(n,0),Mz(n,9===n.level?2:n.strategy>=Cz||n.level<2?4:0),Mz(n,3),n.status=xz,Rz(e),0!==n.pending)return n.last_flush=-1,pz;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let o=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+o),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=$G(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=o,Rz(e),0!==n.pending)return n.last_flush=-1,pz;t=0,r-=o}let o=new Uint8Array(n.gzhead.extra);n.pending_buf.set(o.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=$G(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=$G(e.adler,n.pending_buf,n.pending-r,r)),Rz(e),0!==n.pending)return n.last_flush=-1,pz;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Mz(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=$G(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=$G(e.adler,n.pending_buf,n.pending-r,r)),Rz(e),0!==n.pending)return n.last_flush=-1,pz;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Mz(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=$G(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(Rz(e),0!==n.pending))return n.last_flush=-1,pz;Mz(n,255&e.adler),Mz(n,e.adler>>8&255),e.adler=0}if(n.status=xz,Rz(e),0!==n.pending)return n.last_flush=-1,pz}if(0!==e.avail_in||0!==n.lookahead||t!==sz&&n.status!==kz){let r=0===n.level?zz(n,t):n.strategy===Cz?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(Gz(e),0===e.lookahead)){if(t===sz)return 1;break}if(e.match_length=0,n=iz(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Fz(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===uz?(Fz(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fz(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===Sz?((e,t)=>{let n,r,o,i;const a=e.window;for(;;){if(e.lookahead<=_z){if(Gz(e),e.lookahead<=_z&&t===sz)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,r=a[o],r===a[++o]&&r===a[++o]&&r===a[++o])){i=e.strstart+_z;do{}while(r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&o<i);e.match_length=_z-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=iz(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=iz(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Fz(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===uz?(Fz(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Fz(e,!1),0===e.strm.avail_out)?1:2})(n,t):Vz[n.level].func(n,t);if(3!==r&&4!==r||(n.status=kz),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),pz;if(2===r&&(t===lz?az(n):t!==dz&&(rz(n,0,0,!1),t===cz&&(Dz(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),Rz(e),0===e.avail_out))return n.last_flush=-1,pz}return t!==uz?pz:n.wrap<=0?gz:(2===n.wrap?(Mz(n,255&e.adler),Mz(n,e.adler>>8&255),Mz(n,e.adler>>16&255),Mz(n,e.adler>>24&255),Mz(n,255&e.total_in),Mz(n,e.total_in>>8&255),Mz(n,e.total_in>>16&255),Mz(n,e.total_in>>24&255)):(Bz(n,e.adler>>>16),Bz(n,65535&e.adler)),Rz(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?pz:gz)},$z={deflateInit:(e,t)=>Zz(e,t,Iz,15,8,Ez),deflateInit2:Zz,deflateReset:Xz,deflateResetKeep:Kz,deflateSetHeader:(e,t)=>Jz(e)||2!==e.state.wrap?mz:(e.state.gzhead=t,pz),deflate:Yz,deflateEnd:e=>{if(Jz(e))return mz;const t=e.state.status;return e.state=null,t===xz?Az(e,fz):pz},deflateSetDictionary:(e,t)=>{let n=t.length;if(Jz(e))return mz;const r=e.state,o=r.wrap;if(2===o||1===o&&r.status!==Pz||r.lookahead)return mz;if(1===o&&(e.adler=ZG(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===o&&(Dz(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const i=e.avail_in,a=e.next_in,s=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,Gz(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Nz(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,Gz(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=s,e.avail_in=i,r.wrap=o,pz},deflateInfo:"pako deflate (from Nodeca project)"};const eq=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var tq={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)eq(n,t)&&(e[t]=n[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,o=e.length;t<o;t++){let o=e[t];n.set(o,r),r+=o.length}return n}};let nq=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){nq=!1}const rq=new Uint8Array(256);for(let e=0;e<256;e++)rq[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;rq[254]=rq[254]=1;var oq={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,o,i,a=e.length,s=0;for(o=0;o<a;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),i=0,o=0;i<s;o++)n=e.charCodeAt(o),55296==(64512&n)&&o+1<a&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|63&n):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|63&n):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|63&n);return t},buf2string:(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,o;const i=new Array(2*n);for(o=0,r=0;r<n;){let t=e[r++];if(t<128){i[o++]=t;continue}let a=rq[t];if(a>4)i[o++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?i[o++]=65533:t<65536?i[o++]=t:(t-=65536,i[o++]=55296|t>>10&1023,i[o++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&nq)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(i,o)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+rq[e[n]]>t?n:t}};var iq=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const aq=Object.prototype.toString,{Z_NO_FLUSH:sq,Z_SYNC_FLUSH:lq,Z_FULL_FLUSH:cq,Z_FINISH:uq,Z_OK:dq,Z_STREAM_END:pq,Z_DEFAULT_COMPRESSION:gq,Z_DEFAULT_STRATEGY:mq,Z_DEFLATED:fq}=tz;function hq(e){this.options=tq.assign({level:gq,method:fq,chunkSize:16384,windowBits:15,memLevel:8,strategy:mq},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iq,this.strm.avail_out=0;let n=$z.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==dq)throw new Error(ez[n]);if(t.header&&$z.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?oq.string2buf(t.dictionary):"[object ArrayBuffer]"===aq.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=$z.deflateSetDictionary(this.strm,e),n!==dq)throw new Error(ez[n]);this._dict_set=!0}}function vq(e,t){const n=new hq(t);if(n.push(e,!0),n.err)throw n.msg||ez[n.err];return n.result}hq.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let o,i;if(this.ended)return!1;for(i=t===~~t?t:!0===t?uq:sq,"string"==typeof e?n.input=oq.string2buf(e):"[object ArrayBuffer]"===aq.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(i===lq||i===cq)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(o=$z.deflate(n,i),o===pq)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),o=$z.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===dq;if(0!==n.avail_out){if(i>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},hq.prototype.onData=function(e){this.chunks.push(e)},hq.prototype.onEnd=function(e){e===dq&&(this.result=tq.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var yq=function(e,t){return(t=t||{}).raw=!0,vq(e,t)},Cq=function(e,t){return(t=t||{}).gzip=!0,vq(e,t)},Sq={Deflate:hq,deflate:vq,deflateRaw:yq,gzip:Cq,constants:tz};const bq=16209;var Eq=function(e,t){let n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_;const w=e.state;n=e.next_in,I=e.input,r=n+(e.avail_in-5),o=e.next_out,_=e.output,i=o-(t-e.avail_out),a=o+(e.avail_out-257),s=w.dmax,l=w.wsize,c=w.whave,u=w.wnext,d=w.window,p=w.hold,g=w.bits,m=w.lencode,f=w.distcode,h=(1<<w.lenbits)-1,v=(1<<w.distbits)-1;e:do{g<15&&(p+=I[n++]<<g,g+=8,p+=I[n++]<<g,g+=8),y=m[p&h];t:for(;;){if(C=y>>>24,p>>>=C,g-=C,C=y>>>16&255,0===C)_[o++]=65535&y;else{if(!(16&C)){if(64&C){if(32&C){w.mode=16191;break e}e.msg="invalid literal/length code",w.mode=bq;break e}y=m[(65535&y)+(p&(1<<C)-1)];continue t}for(S=65535&y,C&=15,C&&(g<C&&(p+=I[n++]<<g,g+=8),S+=p&(1<<C)-1,p>>>=C,g-=C),g<15&&(p+=I[n++]<<g,g+=8,p+=I[n++]<<g,g+=8),y=f[p&v];;){if(C=y>>>24,p>>>=C,g-=C,C=y>>>16&255,16&C){if(b=65535&y,C&=15,g<C&&(p+=I[n++]<<g,g+=8,g<C&&(p+=I[n++]<<g,g+=8)),b+=p&(1<<C)-1,b>s){e.msg="invalid distance too far back",w.mode=bq;break e}if(p>>>=C,g-=C,C=o-i,b>C){if(C=b-C,C>c&&w.sane){e.msg="invalid distance too far back",w.mode=bq;break e}if(E=0,T=d,0===u){if(E+=l-C,C<S){S-=C;do{_[o++]=d[E++]}while(--C);E=o-b,T=_}}else if(u<C){if(E+=l+u-C,C-=u,C<S){S-=C;do{_[o++]=d[E++]}while(--C);if(E=0,u<S){C=u,S-=C;do{_[o++]=d[E++]}while(--C);E=o-b,T=_}}}else if(E+=u-C,C<S){S-=C;do{_[o++]=d[E++]}while(--C);E=o-b,T=_}for(;S>2;)_[o++]=T[E++],_[o++]=T[E++],_[o++]=T[E++],S-=3;S&&(_[o++]=T[E++],S>1&&(_[o++]=T[E++]))}else{E=o-b;do{_[o++]=_[E++],_[o++]=_[E++],_[o++]=_[E++],S-=3}while(S>2);S&&(_[o++]=_[E++],S>1&&(_[o++]=_[E++]))}break}if(64&C){e.msg="invalid distance code",w.mode=bq;break e}y=f[(65535&y)+(p&(1<<C)-1)]}}break}}while(n<r&&o<a);S=g>>3,n-=S,g-=S<<3,p&=(1<<g)-1,e.next_in=n,e.next_out=o,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=o<a?a-o+257:257-(o-a),w.hold=p,w.bits=g};const Tq=15,Iq=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),_q=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),wq=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Pq=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var xq=(e,t,n,r,o,i,a,s)=>{const l=s.bits;let c,u,d,p,g,m,f=0,h=0,v=0,y=0,C=0,S=0,b=0,E=0,T=0,I=0,_=null;const w=new Uint16Array(16),P=new Uint16Array(16);let x,k,A,L=null;for(f=0;f<=Tq;f++)w[f]=0;for(h=0;h<r;h++)w[t[n+h]]++;for(C=l,y=Tq;y>=1&&0===w[y];y--);if(C>y&&(C=y),0===y)return o[i++]=20971520,o[i++]=20971520,s.bits=1,0;for(v=1;v<y&&0===w[v];v++);for(C<v&&(C=v),E=1,f=1;f<=Tq;f++)if(E<<=1,E-=w[f],E<0)return-1;if(E>0&&(0===e||1!==y))return-1;for(P[1]=0,f=1;f<Tq;f++)P[f+1]=P[f]+w[f];for(h=0;h<r;h++)0!==t[n+h]&&(a[P[t[n+h]]++]=h);if(0===e?(_=L=a,m=20):1===e?(_=Iq,L=_q,m=257):(_=wq,L=Pq,m=0),I=0,h=0,f=v,g=i,S=C,b=0,d=-1,T=1<<C,p=T-1,1===e&&T>852||2===e&&T>592)return 1;for(;;){x=f-b,a[h]+1<m?(k=0,A=a[h]):a[h]>=m?(k=L[a[h]-m],A=_[a[h]-m]):(k=96,A=0),c=1<<f-b,u=1<<S,v=u;do{u-=c,o[g+(I>>b)+u]=x<<24|k<<16|A}while(0!==u);for(c=1<<f-1;I&c;)c>>=1;if(0!==c?(I&=c-1,I+=c):I=0,h++,0==--w[f]){if(f===y)break;f=t[n+a[h]]}if(f>C&&(I&p)!==d){for(0===b&&(b=C),g+=v,S=f-b,E=1<<S;S+b<y&&(E-=w[S+b],!(E<=0));)S++,E<<=1;if(T+=1<<S,1===e&&T>852||2===e&&T>592)return 1;d=I&p,o[d]=C<<24|S<<16|g-i}}return 0!==I&&(o[g+I]=f-b<<24|64<<16),s.bits=C,0};const{Z_FINISH:kq,Z_BLOCK:Aq,Z_TREES:Lq,Z_OK:Dq,Z_STREAM_END:Oq,Z_NEED_DICT:Nq,Z_STREAM_ERROR:Rq,Z_DATA_ERROR:Fq,Z_MEM_ERROR:Mq,Z_BUF_ERROR:Bq,Z_DEFLATED:Uq}=tz,Hq=16180,Gq=16190,zq=16191,qq=16192,Wq=16194,jq=16199,Vq=16200,Qq=16206,Jq=16209,Kq=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Xq(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Zq=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Hq||t.mode>16211?1:0},Yq=e=>{if(Zq(e))return Rq;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Hq,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Dq},$q=e=>{if(Zq(e))return Rq;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Yq(e)},eW=(e,t)=>{let n;if(Zq(e))return Rq;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Rq:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,$q(e))},tW=(e,t)=>{if(!e)return Rq;const n=new Xq;e.state=n,n.strm=e,n.window=null,n.mode=Hq;const r=eW(e,t);return r!==Dq&&(e.state=null),r};let nW,rW,oW=!0;const iW=e=>{if(oW){nW=new Int32Array(512),rW=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(xq(1,e.lens,0,288,nW,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;xq(2,e.lens,0,32,rW,0,e.work,{bits:5}),oW=!1}e.lencode=nW,e.lenbits=9,e.distcode=rW,e.distbits=5},aW=(e,t,n,r)=>{let o;const i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),i.window.set(t.subarray(n-r,n-r+o),i.wnext),(r-=o)?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};var sW=(e,t)=>{let n,r,o,i,a,s,l,c,u,d,p,g,m,f,h,v,y,C,S,b,E,T,I=0;const _=new Uint8Array(4);let w,P;const x=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Zq(e)||!e.output||!e.input&&0!==e.avail_in)return Rq;n=e.state,n.mode===zq&&(n.mode=qq),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,u=n.bits,d=s,p=l,T=Dq;e:for(;;)switch(n.mode){case Hq:if(0===n.wrap){n.mode=qq;break}for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(2&n.wrap&&35615===c){0===n.wbits&&(n.wbits=15),n.check=0,_[0]=255&c,_[1]=c>>>8&255,n.check=$G(n.check,_,2,0),c=0,u=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=Jq;break}if((15&c)!==Uq){e.msg="unknown compression method",n.mode=Jq;break}if(c>>>=4,u-=4,E=8+(15&c),0===n.wbits&&(n.wbits=E),E>15||E>n.wbits){e.msg="invalid window size",n.mode=Jq;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&c?16189:zq,c=0,u=0;break;case 16181:for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(n.flags=c,(255&n.flags)!==Uq){e.msg="unknown compression method",n.mode=Jq;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Jq;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&4&n.wrap&&(_[0]=255&c,_[1]=c>>>8&255,n.check=$G(n.check,_,2,0)),c=0,u=0,n.mode=16182;case 16182:for(;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&4&n.wrap&&(_[0]=255&c,_[1]=c>>>8&255,_[2]=c>>>16&255,_[3]=c>>>24&255,n.check=$G(n.check,_,4,0)),c=0,u=0,n.mode=16183;case 16183:for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&4&n.wrap&&(_[0]=255&c,_[1]=c>>>8&255,n.check=$G(n.check,_,2,0)),c=0,u=0,n.mode=16184;case 16184:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&4&n.wrap&&(_[0]=255&c,_[1]=c>>>8&255,n.check=$G(n.check,_,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(g=n.length,g>s&&(g=s),g&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+g),E)),512&n.flags&&4&n.wrap&&(n.check=$G(n.check,r,g,i)),s-=g,i+=g,n.length-=g),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===s)break e;g=0;do{E=r[i+g++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E))}while(E&&g<s);if(512&n.flags&&4&n.wrap&&(n.check=$G(n.check,r,g,i)),s-=g,i+=g,E)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===s)break e;g=0;do{E=r[i+g++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E))}while(E&&g<s);if(512&n.flags&&4&n.wrap&&(n.check=$G(n.check,r,g,i)),s-=g,i+=g,E)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(4&n.wrap&&c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Jq;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=zq;break;case 16189:for(;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}e.adler=n.check=Kq(c),c=0,u=0,n.mode=Gq;case Gq:if(0===n.havedict)return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,Nq;e.adler=n.check=1,n.mode=zq;case zq:if(t===Aq||t===Lq)break e;case qq:if(n.last){c>>>=7&u,u-=7&u,n.mode=Qq;break}for(;u<3;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}switch(n.last=1&c,c>>>=1,u-=1,3&c){case 0:n.mode=16193;break;case 1:if(iW(n),n.mode=jq,t===Lq){c>>>=2,u-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=Jq}c>>>=2,u-=2;break;case 16193:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Jq;break}if(n.length=65535&c,c=0,u=0,n.mode=Wq,t===Lq)break e;case Wq:n.mode=16195;case 16195:if(g=n.length,g){if(g>s&&(g=s),g>l&&(g=l),0===g)break e;o.set(r.subarray(i,i+g),a),s-=g,i+=g,l-=g,a+=g,n.length-=g;break}n.mode=zq;break;case 16196:for(;u<14;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Jq;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.lens[x[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[x[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,w={bits:n.lenbits},T=xq(0,n.lens,0,19,n.lencode,0,n.work,w),n.lenbits=w.bits,T){e.msg="invalid code lengths set",n.mode=Jq;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;I=n.lencode[c&(1<<n.lenbits)-1],h=I>>>24,v=I>>>16&255,y=65535&I,!(h<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(y<16)c>>>=h,u-=h,n.lens[n.have++]=y;else{if(16===y){for(P=h+2;u<P;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(c>>>=h,u-=h,0===n.have){e.msg="invalid bit length repeat",n.mode=Jq;break}E=n.lens[n.have-1],g=3+(3&c),c>>>=2,u-=2}else if(17===y){for(P=h+3;u<P;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=h,u-=h,E=0,g=3+(7&c),c>>>=3,u-=3}else{for(P=h+7;u<P;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=h,u-=h,E=0,g=11+(127&c),c>>>=7,u-=7}if(n.have+g>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Jq;break}for(;g--;)n.lens[n.have++]=E}}if(n.mode===Jq)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Jq;break}if(n.lenbits=9,w={bits:n.lenbits},T=xq(1,n.lens,0,n.nlen,n.lencode,0,n.work,w),n.lenbits=w.bits,T){e.msg="invalid literal/lengths set",n.mode=Jq;break}if(n.distbits=6,n.distcode=n.distdyn,w={bits:n.distbits},T=xq(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,w),n.distbits=w.bits,T){e.msg="invalid distances set",n.mode=Jq;break}if(n.mode=jq,t===Lq)break e;case jq:n.mode=Vq;case Vq:if(s>=6&&l>=258){e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,Eq(e,p),a=e.next_out,o=e.output,l=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,u=n.bits,n.mode===zq&&(n.back=-1);break}for(n.back=0;I=n.lencode[c&(1<<n.lenbits)-1],h=I>>>24,v=I>>>16&255,y=65535&I,!(h<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(v&&!(240&v)){for(C=h,S=v,b=y;I=n.lencode[b+((c&(1<<C+S)-1)>>C)],h=I>>>24,v=I>>>16&255,y=65535&I,!(C+h<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=C,u-=C,n.back+=C}if(c>>>=h,u-=h,n.back+=h,n.length=y,0===v){n.mode=16205;break}if(32&v){n.back=-1,n.mode=zq;break}if(64&v){e.msg="invalid literal/length code",n.mode=Jq;break}n.extra=15&v,n.mode=16201;case 16201:if(n.extra){for(P=n.extra;u<P;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;I=n.distcode[c&(1<<n.distbits)-1],h=I>>>24,v=I>>>16&255,y=65535&I,!(h<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(!(240&v)){for(C=h,S=v,b=y;I=n.distcode[b+((c&(1<<C+S)-1)>>C)],h=I>>>24,v=I>>>16&255,y=65535&I,!(C+h<=u);){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}c>>>=C,u-=C,n.back+=C}if(c>>>=h,u-=h,n.back+=h,64&v){e.msg="invalid distance code",n.mode=Jq;break}n.offset=y,n.extra=15&v,n.mode=16203;case 16203:if(n.extra){for(P=n.extra;u<P;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Jq;break}n.mode=16204;case 16204:if(0===l)break e;if(g=p-l,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Jq;break}g>n.wnext?(g-=n.wnext,m=n.wsize-g):m=n.wnext-g,g>n.length&&(g=n.length),f=n.window}else f=o,m=a-n.offset,g=n.length;g>l&&(g=l),l-=g,n.length-=g;do{o[a++]=f[m++]}while(--g);0===n.length&&(n.mode=Vq);break;case 16205:if(0===l)break e;o[a++]=n.length,l--,n.mode=Vq;break;case Qq:if(n.wrap){for(;u<32;){if(0===s)break e;s--,c|=r[i++]<<u,u+=8}if(p-=l,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=n.flags?$G(n.check,o,p,a-p):ZG(n.check,o,p,a-p)),p=l,4&n.wrap&&(n.flags?c:Kq(c))!==n.check){e.msg="incorrect data check",n.mode=Jq;break}c=0,u=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,c+=r[i++]<<u,u+=8}if(4&n.wrap&&c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Jq;break}c=0,u=0}n.mode=16208;case 16208:T=Oq;break e;case Jq:T=Fq;break e;case 16210:return Mq;default:return Rq}return e.next_out=a,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<Jq&&(n.mode<Qq||t!==kq))&&aW(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,4&n.wrap&&p&&(e.adler=n.check=n.flags?$G(n.check,o,p,e.next_out-p):ZG(n.check,o,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===zq?128:0)+(n.mode===jq||n.mode===Wq?256:0),(0===d&&0===p||t===kq)&&T===Dq&&(T=Bq),T},lW={inflateReset:$q,inflateReset2:eW,inflateResetKeep:Yq,inflateInit:e=>tW(e,15),inflateInit2:tW,inflate:sW,inflateEnd:e=>{if(Zq(e))return Rq;let t=e.state;return t.window&&(t.window=null),e.state=null,Dq},inflateGetHeader:(e,t)=>{if(Zq(e))return Rq;const n=e.state;return 2&n.wrap?(n.head=t,t.done=!1,Dq):Rq},inflateSetDictionary:(e,t)=>{const n=t.length;let r,o,i;return Zq(e)?Rq:(r=e.state,0!==r.wrap&&r.mode!==Gq?Rq:r.mode===Gq&&(o=1,o=ZG(o,t,n,0),o!==r.check)?Fq:(i=aW(e,t,n,n),i?(r.mode=16210,Mq):(r.havedict=1,Dq)))},inflateInfo:"pako inflate (from Nodeca project)"};var cW=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const uW=Object.prototype.toString,{Z_NO_FLUSH:dW,Z_FINISH:pW,Z_OK:gW,Z_STREAM_END:mW,Z_NEED_DICT:fW,Z_STREAM_ERROR:hW,Z_DATA_ERROR:vW,Z_MEM_ERROR:yW}=tz;function CW(e){this.options=tq.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new iq,this.strm.avail_out=0;let n=lW.inflateInit2(this.strm,t.windowBits);if(n!==gW)throw new Error(ez[n]);if(this.header=new cW,lW.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=oq.string2buf(t.dictionary):"[object ArrayBuffer]"===uW.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=lW.inflateSetDictionary(this.strm,t.dictionary),n!==gW)))throw new Error(ez[n])}function SW(e,t){const n=new CW(t);if(n.push(e),n.err)throw n.msg||ez[n.err];return n.result}CW.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let i,a,s;if(this.ended)return!1;for(a=t===~~t?t:!0===t?pW:dW,"[object ArrayBuffer]"===uW.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=lW.inflate(n,a),i===fW&&o&&(i=lW.inflateSetDictionary(n,o),i===gW?i=lW.inflate(n,a):i===vW&&(i=fW));n.avail_in>0&&i===mW&&n.state.wrap>0&&0!==e[n.next_in];)lW.inflateReset(n),i=lW.inflate(n,a);switch(i){case hW:case vW:case fW:case yW:return this.onEnd(i),this.ended=!0,!1}if(s=n.avail_out,n.next_out&&(0===n.avail_out||i===mW))if("string"===this.options.to){let e=oq.utf8border(n.output,n.next_out),t=n.next_out-e,o=oq.buf2string(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(o)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==gW||0!==s){if(i===mW)return i=lW.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},CW.prototype.onData=function(e){this.chunks.push(e)},CW.prototype.onEnd=function(e){e===gW&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=tq.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var bW=function(e,t){return(t=t||{}).raw=!0,SW(e,t)},EW={Inflate:CW,inflate:SW,inflateRaw:bW,ungzip:SW,constants:tz};const{Deflate:TW,deflate:IW,deflateRaw:_W,gzip:wW}=Sq,{Inflate:PW,inflate:xW,inflateRaw:kW,ungzip:AW}=EW;var LW={Deflate:TW,deflate:IW,deflateRaw:_W,gzip:wW,Inflate:PW,inflate:xW,inflateRaw:kW,ungzip:AW,constants:tz},DW=function(e){var t="\n    let clientSessionId = cluster('odxaugloop.eastus.kusto.windows.net').database('ODX AugLoop Service').WorkflowOperationEvent\n    | where TIMESTAMP > ago(7d)\n    | where operationName == \"FluxCopilot\"\n    | where sessionKey == \"".concat(e,'"\n    | distinct clientSessionId;\n    union Office_Voice_ActionAI*\n        | where Event_ReceivedTime > ago(7d)\n        | where Session_Id in (clientSessionId)\n        | project-reorder Event_Time, Event_ReceivedTime, Event_Name, Data_ChatEventType, Data_UserQueryGuid, Data_OperationName, Data_AugloopSessionGuid, Data_EventState, Data_Type\n        | order by Event_Time asc\n    '),n=OW(t);return{name:"Client Chat Event logs",description:"Get Client Chat Event logs for a given session id",linkUrl:"https://dataexplorer.azure.com/clusters/https%3a%2f%2fkusto.aria.microsoft.com/databases/9783945ebc2b468fbb8a2890cdab903b?query=".concat(n),query:t}},OW=function(e){var t=(new TextEncoder).encode(e),n=LW.deflate(t);return btoa(String.fromCharCode.apply(null,n))},NW=n(46835),RW=n(59801);function FW(e){ob.getInstance().sendErrorTelemetry([{key:uC.ErrorCategory,value:IC.SketchToImage},{key:uC.ErrorMessage,value:e}])}function MW(e,t){return BW.apply(this,arguments)}function BW(){return BW=(0,gd._)((function(e,t){var n,r,o,i;return(0,F.__generator)(this,(function(a){switch(a.label){case 0:if(jE.getInstance().getState()!==Qd.IDLE)return(0,NW.debuglog)("Image insertion triggered while in a non-idle execution state"),[2];jE.getInstance().setState(Qd.EXECUTING),(0,NW.debuglog)("handleInsertImageOnClick"),n={status:Md.SUCCESS},(r=sb.getInstance()).setScenarioName(Cv.InsertImage),a.label=1;case 1:return a.trys.push([1,3,,4]),o={scenarioName:r.getScenarioName(),startTime:r.getStartTime(),entryPoint:XM.Chat,correlationId:(0,dg.A)(),timeToODSLMS:1e3*r.getResponseTime(),timeODSLToJOfcMS:0,capability:r.getCapability(),featureName:r.getFeatureName(),subFeatureName:r.getSubFeatureName()},i={scenarioOptions:JSON.stringify(o)},[4,PowerPoint.run(function(){var o=(0,gd._)((function(o){var a,s,l,c,u,d,p;return(0,F.__generator)(this,(function(g){switch(g.label){case 0:return[4,Yv(o)];case 1:return a=g.sent(),s={},0!==a.length?[3,3]:[4,Kv(o,a)];case 2:return l=g.sent().split("#"),s={type:1,id:+l[0],cId:+l[1]},[3,4];case 3:c=a[0].id.split("#"),s={type:1,id:+c[0],cId:+c[1]},g.label=4;case 4:return u=[],d={name:mv.AddPictureCmd,version:Dv,sourceType:dv.Raw64,data:e,altText:t,target:s},u.push(d),[4,X_(o,u,i)];case 5:return n=g.sent(),r.resetData(),jE.getInstance().setState(Qd.IDLE),n.status===Md.SUCCESS?ob.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.PPTCopilotSketchInsertImageCompleted}]):(JSON.stringify(null!==(p=n.error)&&void 0!==p?p:Bd.UNKNOWN_ERROR),FW("fail to insert the image to slide, result : ${errorString}")),[2]}}))}));return function(e){return o.apply(this,arguments)}}())];case 2:return a.sent(),(0,NW.debuglog)("log result : ${JSON.stringify(result))}"),[3,4];case 3:return a.sent(),n={status:Md.FAILED},(0,NW.debuglog)("Execute failed: ${JSON.stringify(result))}"),FW("fail to insert the image to slide"),[3,4];case 4:return[2]}}))})),BW.apply(this,arguments)}var UW,HW,GW,zW,qW,WW,jW=function(){var e=(0,gd._)((function(e){var t,n,r,o,i,a,s;return(0,F.__generator)(this,(function(l){return n={featureName:_C.CopilotChat,subFeatureName:MC.SketchToImage},(r=null==e||null===(t=e.current)||void 0===t?void 0:t.getLastMessage())&&r.messageType===jp._.ChatCardWrapper&&Vh(Lh.UseSketchImageCardForBeautifyingInk)&&(i=r.body).renderData&&(null===(o=i.renderData)||void 0===o?void 0:o.component)===pp.SketchCard&&(null===(s=e.current)||void 0===s||s.updateLastMessage({chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:i.textContent,renderData:Sd(Cd({},i.renderData),{props:Sd(Cd({},null===(a=i.renderData)||void 0===a?void 0:a.props),{isRehydration:!0})})}},chatMessageBodyData:{feedbackSectionPosition:ag.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:NN(Wd.SKETCHTOIMAGE,n),chatHydrationKeys:{imagesKey:"images"}},addCardToChatHistory:!0})),[2]}))}));return function(t){return e.apply(this,arguments)}}(),VW=function(){var e=(0,gd._)((function(e,t){var n,r,o,i,s,l,c,u,d,p,g,m,f,h;return(0,F.__generator)(this,(function(v){switch(v.label){case 0:return r=null==e?void 0:e.body,jE.getInstance().setState(Qd.IDLE),"OK"!=r.status?((0,NW.debuglog)("sketchAnnotationProcessor: sketchAnnotation.status: ${sketchAnnotation.status}"),FW(r.status),null===(o=t.current)||void 0===o||o.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.ServerErrorMessage}}}}),[2]):void 0===(i=null===(n=r.blobs)||void 0===n?void 0:n[0])?((0,NW.debuglog)("sketchAnnotationProcessor: No blob in sketchAnnotation"),FW("No blob in sketchAnnotation"),null===(s=t.current)||void 0===s||s.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.ServerErrorMessage}}}}),[2]):(l=zR.getSettingAsString(DR.AugloopSharedSessionID),[4,mS(l).requestBinaryDataForBlob(i)]);case 1:return void 0===(c=v.sent())||0===c.length?((0,NW.debuglog)("sketchAnnotationProcessor: No storedImage in imageBlob"),FW("No storedImage in imageBlob"),null===(u=t.current)||void 0===u||u.addResponseMessage({chatCardType:jp._.Default,chatMessageData:{defaultMessageProps:{user:ig.Q9.Chat,messageHeader:{text:PowerpointCopilotStrings.ServerErrorMessage}}}})):(d=c.reduce((function(e,t){return e+String.fromCharCode(t)}),""),p="data:image/png;base64,"+btoa(d),g={featureName:_C.CopilotChat,subFeatureName:MC.SketchToImage},m=r.altText?r.altText:"sketch",Vh(Lh.UseSketchImageCardForBeautifyingInk)?null===(f=t.current)||void 0===f||f.addResponseMessage({chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:ig.Q9.Chat,renderData:{component:pp.SketchCard,props:{images:[p],altText:[m]}}}},chatMessageBodyData:{feedbackSectionPosition:ag.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:NN(Wd.SKETCHTOIMAGE,g)},addCardToChatHistory:!1}):null===(h=t.current)||void 0===h||h.addResponseMessage({chatCardType:jp._.ContentCard,chatMessageData:{contentCardProps:{user:ig.Q9.Chat,cardContent:{contentBody:a.createElement("img",{src:p,width:"100%",alt:m}),cardButtons:[{buttonTitle:FB(),buttonText:FB(),handleButtonOnClick:function(){return MW(p,m)},icon:a.createElement(RW.dLz,null),isDisabled:!1}]}}},chatMessageBodyData:{feedbackSectionPosition:ag.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:NN(Wd.SKETCHTOIMAGE,g)}}),ob.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.PPTCopilotSketchOperationCompleted}])),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),QW=n(6056),JW=n(91387),KW=n(52119);class XW{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Qp.h.assign(XW,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_CopilotGPTAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[XW.getTypeName()])}}XW.H_={T_:XW.getTypeName(),B_:XW.getBaseTypes()};class ZW{constructor(e){Qp.h.assign(ZW,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[ZW.getTypeName()])}}ZW.H_={T_:ZW.getTypeName(),B_:ZW.getBaseTypes()};class YW{constructor(e){Qp.h.assign(YW,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTListOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotGpt_OperationResponse"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[YW.getTypeName()])}}YW.H_={T_:YW.getTypeName(),B_:YW.getBaseTypes()};class $W{constructor(e){Qp.h.assign($W,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotGpt_OperationResponse"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[$W.getTypeName()])}}$W.H_={T_:$W.getTypeName(),B_:$W.getBaseTypes()},function(e){e.GetGPTList="GetGPTList",e.GetGPT="GetGPT"}(UW||(UW={}));class ej{constructor(e){Qp.h.assign(ej,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_CopilotGPTSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[ej.getTypeName()])}}ej.H_={T_:ej.getTypeName(),B_:ej.getBaseTypes()};class tj{constructor(e){Qp.h.assign(tj,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[tj.getTypeName()])}}tj.H_={T_:tj.getTypeName(),B_:tj.getBaseTypes()};class nj{constructor(e){Qp.h.assign(nj,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTListOperation"}static getBaseTypes(){return["AugLoop_CopilotGpt_Operation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[nj.getTypeName()])}}nj.H_={T_:nj.getTypeName(),B_:nj.getBaseTypes()};class rj{constructor(e){Qp.h.assign(rj,this,e)}static getTypeName(){return"AugLoop_CopilotGpt_GetGPTOperation"}static getBaseTypes(){return["AugLoop_CopilotGpt_Operation"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[rj.getTypeName()])}}rj.H_={T_:rj.getTypeName(),B_:rj.getBaseTypes()},function(e){e.Success="Success",e.Failure="Failure"}(HW||(HW={})),function(e){e.Success="Success",e.InvalidRequest="InvalidRequest",e.InternalError="InternalError",e.GptListNotFound="GptListNotFound",e.InvalidGptNotFound="InvalidGpt_NotFound",e.InvalidGptNoAccess="InvalidGpt_NoAccess",e.InvalidGptDeleted="InvalidGpt_Deleted",e.InvalidGptBlocked="InvalidGpt_Blocked"}(GW||(GW={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(zW||(zW={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(qW||(qW={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(WW||(WW={}));var oj,ij,aj=n(78126),sj={getGPTList:null,getGPT:null},lj=function(e,t){sj[e]=t},cj=function(e){return sj[e]?sj[e]:(new Date).getTime()},uj={getGPTList:null,getGPT:null};!function(e){e.GPTRequest="GPTRequest",e.GPTResponse="GPTResponse",e.GPTError="GPTError",e.GPTLatency="GPTLatency",e.GPTTimeout="GPTTimeout"}(oj||(oj={})),function(e){e.Success="success",e.Error="error"}(ij||(ij={}));var dj=n(58651),pj=!1;var gj,mj=function(e,t){pj&&(null==t?dj.log("CopilotGPT Log:",e):dj.log("CopilotGPT Log:",e,t))},fj=function(e,t){var n=(0,F.__assign)((0,F.__assign)((0,F.__assign)({},t.chatUiProps),e),{suggestionPillsUiProps:{suggestionList:[]},chatInputV2Props:(0,F.__assign)((0,F.__assign)({},t.chatUiProps.chatInputV2Props),{isImageInputButtonEnabled:!1,buttonProps:{groundingButtonEnabled:!1,ciqButtonEnabled:!1,menuButtonEnabled:!1}})});return mj("Updated Copilot Chat Props for GPTs",n),(0,F.__assign)((0,F.__assign)({},t),{chatUiProps:n})},hj=function(e){return e.filter((function(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.gptIdentifier)||void 0===t?void 0:t.id)&&void 0!==n&&n})).map((function(e){var t,n,r;return{id:null!==(n=null===(t=null==e?void 0:e.gptIdentifier)||void 0===t?void 0:t.id)&&void 0!==n?n:"",name:null!==(r=null==e?void 0:e.name)&&void 0!==r?r:"",isDefaultCopilot:!1,copilotType:uO.CustomGPT,isSelected:!1,menuIconUrl:e.icon}}))},vj=ej.getTypeName(),yj=function(e,t,n,r){return(0,F.__awaiter)(void 0,void 0,void 0,(function(){return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return mj("getGPTDetails from CopilotGPT",e),[4,Cj(UW.GetGPT,t,n,e)];case 1:return o.sent(),r.setTimeout(UW.GetGPT,3e4),[2]}}))}))},Cj=function(e,t,n,r){return(0,F.__awaiter)(void 0,void 0,void 0,(function(){var o,i;return(0,F.__generator)(this,(function(a){return o=Sj(e,r,n),i=new Vp.g0({parentPath:["Signal",vj],items:[{id:lx.r.generateId(),body:o}]}),mj("Submitting signal to Augloop : ".concat(vj," with operation type: ").concat(e," and signal: ").concat(JSON.stringify(o))),lj(e,(new Date).getTime()),t(i,vj),gj=(new Date).getTime(),[2]}))}))},Sj=function(e,t,n){var r=(0,aj.A)();switch(function(e,t){uj[e]=t}(e,r),null==n||n(e,oj.GPTRequest),e){case UW.GetGPTList:var o={type:UW.GetGPTList};return new ej({operation:o,queryId:r});case UW.GetGPT:var i={type:UW.GetGPT,gptId:t};return new ej({operation:i,queryId:r});default:return new ej}},bj=function(e,t,n,r,o){return(0,F.__awaiter)(void 0,void 0,void 0,(function(){var i,a,s,l,c,u,d,p,g,m,f,h,v,y,C;return(0,F.__generator)(this,(function(S){var b;switch(mj("".concat(ej.getTypeName()," response. Time Taken : ").concat((b=gj,((new Date).getTime()-b)/1e3)," sec \n")),i=e.body,a=i.operationResponse,s=a.type){case UW.GetGPTList:return r(!1),(d=null===(f=null==(l=a)?void 0:l.gptResult)||void 0===f?void 0:f.statusCode)!==GW.Success?(mj("GetGPTList failed with status code: ".concat(d," and message: ").concat(null==l?void 0:l.messageToRender)),t((function(e){return 0!==e.copilotSwitcherMenuItemProps.length?e:{copilotSwitcherMenuItemProps:[],status:ij.Error}})),[2,{operationType:s,statusCode:d}]):(c=null!==(v=null===(h=null==l?void 0:l.gptListResponse)||void 0===h?void 0:h.gptList)&&void 0!==v?v:[],mj("GetGPTList response: ".concat(JSON.stringify(c))),0===c.length?(mj("No GPTs found"),[2,{operationType:s,statusCode:d}]):(t({copilotSwitcherMenuItemProps:hj(c),status:ij.Success}),[2,{operationType:s,statusCode:d}]));case UW.GetGPT:return o(!1),u=a,mj("GetGPT response: ".concat(JSON.stringify(u))),(d=null===(y=null==u?void 0:u.gptResult)||void 0===y?void 0:y.statusCode)!==GW.Success?(mj("GetGPT failed with status code: ".concat(d," and message: ").concat(null==u?void 0:u.messageToRender)),n({copilotChatProps:void 0,gptId:"",status:ij.Error}),[2,{operationType:s,statusCode:d}]):(p=null===(C=u.gptResponse)||void 0===C?void 0:C.gptDetails)?(g=function(e){var t,n,r=(null!==(n=null===(t=null==e?void 0:e.conversationStarters)||void 0===t?void 0:t.conversationStarterList)&&void 0!==n?n:[]).map((function(e){var t,n;return{suggestionText:null!==(t=null==e?void 0:e.text)&&void 0!==t?t:"",suggestionCategory:null!==(n=null==e?void 0:e.title)&&void 0!==n?n:"",iconRegular:lg.I11,shouldSubmitQueryOnClick:!1,shouldLaunchCIQOnSelection:!1}}));return{zeroQueryMessageV2Props:{promptSuggestionList:r}}}(p),m=d!==GW.Success?ij.Error:ij.Success,n({copilotChatProps:g,gptId:p.gptIdentifier.id,status:m}),[2,{operationType:s,statusCode:d}]):(mj("No GPT details found"),[2])}return[2]}))}))},Ej=function(){function e(e,t){var n=this;this.queryTimeoutMap=new Map,this.gptListResponseTimeoutInternal=function(){mj("GPT List response timed out"),n.setIsTimeoutForGPTList(!0)},this.gptDetailsResponseTimeoutInternal=function(){mj("GPT Details response timed out"),n.setIsTimeoutForGPTDetails(!0)},this.setIsTimeoutForGPTList=e,this.setIsTimeoutForGPTDetails=t}return e.getInstance=function(t,n){return e.instance||(e.instance=new e(t,n)),e.instance},e.resetInstance=function(){e.instance=void 0},e.prototype.setTimeout=function(e,t){var n;switch(e){case UW.GetGPTList:n=this.gptListResponseTimeoutInternal;break;case UW.GetGPT:n=this.gptDetailsResponseTimeoutInternal}var r=window.setTimeout(n,t);this.queryTimeoutMap.set(e,r)},e.prototype.clearTimeout=function(e){var t=this.queryTimeoutMap.get(e);t&&(mj("Clearing timeout for operation type: ".concat(e)),clearTimeout(t),this.queryTimeoutMap.delete(e))},e}();function Tj(e,t,n,r,o){var i=this,s=(0,F.__read)(a.useState(),2),l=s[0],c=s[1],u=(0,F.__read)(a.useState({copilotSwitcherMenuItemProps:[],status:ij.Success}),2),d=u[0],p=u[1],g=(0,F.__read)(a.useState(!1),2),m=g[0],f=g[1],h=(0,F.__read)(a.useState({copilotChatProps:t.chatUiProps,gptId:"",status:ij.Success}),2),v=h[0],y=h[1],C=(0,F.__read)(a.useState(!1),2),S=C[0],b=C[1],E=(0,F.__read)(a.useState(!1),2),T=E[0],I=E[1],_=(0,F.__read)(a.useState(!1),2),w=_[0],P=_[1],x=Ej.getInstance(P,I),k=function(e,t,n,r,o,i,a,s){var l=this;return{handleAnnotation:function(c){return(0,F.__awaiter)(l,void 0,void 0,(function(){var l,u,d,p,g,m,f,h,v,y,C,S;return(0,F.__generator)(this,(function(b){switch(b.label){case 0:b.trys.push([0,5,6,7]),l=(0,F.__values)(c.items),u=l.next(),b.label=1;case 1:return u.done?[3,4]:(d=u.value,(null==(p=null===(S=d.body)||void 0===S?void 0:S.H_)?void 0:p.T_)!==XW.getTypeName()?[3,3]:[4,bj(d,t,e,n,r)]);case 2:g=b.sent(),m=g.operationType,f=g.statusCode,h=(new Date).getTime()-cj(m),lj(m,null),s.clearTimeout(m),h&&a(m,oj.GPTLatency,h),f===GW.Success?a(m,oj.GPTResponse):(a(m,oj.GPTError,JSON.stringify({statusCode:f})),m===UW.GetGPT?o(!0):m===UW.GetGPTList&&f!==GW.GptListNotFound&&i(!0)),b.label=3;case 3:return u=l.next(),[3,1];case 4:return[3,7];case 5:return v=b.sent(),y={error:v},[3,7];case 6:try{u&&!u.done&&(C=l.return)&&C.call(l)}finally{if(y)throw y.error}return[7];case 7:return[2]}}))}))}}}(y,p,f,b,n,r,o,x).handleAnnotation;a.useEffect((function(){var e;return e=t.copilotCommunicationHandler.getHostSettings().devBuild,pj=e,t.copilotCommunicationHandler.getALSession().then((function(e){c(e)})),function(){Ej.resetInstance()}}),[]),a.useEffect((function(){l&&e&&l.activateAnnotation(XW.getTypeName(),{callback:k}).then((function(){A()}))}),[l,e]),a.useEffect((function(){w&&e&&(f(!1),0===d.copilotSwitcherMenuItemProps.length&&r(!0),o(UW.GetGPTList,oj.GPTError,JSON.stringify({statusCode:"GPTListTimeout"})))}),[w]),a.useEffect((function(){T&&e&&(b(!1),n(!0),o(UW.GetGPT,oj.GPTError,JSON.stringify({statusCode:"GPTDetailsTimeout"})))}),[T]);var A=function(){l&&e&&!m&&(f(!0),function(e,t,n){(0,F.__awaiter)(void 0,void 0,void 0,(function(){return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return mj("getGPTList from CopilotGPT"),[4,Cj(UW.GetGPTList,e,t)];case 1:return r.sent(),n.setTimeout(UW.GetGPTList,3e4),[2]}}))}))}((function(e,t){l.submitOperation(e,t)}),o,x))};return{isLoadingMenu:m,isLoadingGPTDetails:S,isTimeoutForGPTList:w,isTimeoutForGPTDetails:T,fetchGPTList:A,gptListProps:d,fetchGPTDetails:function(t){return(0,F.__awaiter)(i,void 0,void 0,(function(){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return e&&l?(b(!0),[4,yj(t,(function(e,t){l.submitOperation(e,t)}),o,x)]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},gptDetailsProps:v}}var Ij=n(76708),_j=n(62988),wj=n(75200),Pj=n(45662),xj=n(1545),kj=n(96024);const Aj={show:"fui-toast-show",dismiss:"fui-toast-dismiss",dismissAll:"fui-toast-dismiss-all",update:"fui-toast-update",pause:"fui-toast-pause",play:"fui-toast-play"},Lj="bottom",Dj="bottom-end",Oj="bottom-start",Nj="top",Rj="top-end",Fj="top-start";let Mj=0;const Bj=()=>{};function Uj(e){const{targetDocument:t}=(0,ul.Y)();return a.useMemo((()=>t?{dispatchToast:(n,r)=>{!function(e,t={},n){var r;const o={...t,content:e,toastId:null!==(r=t.toastId)&&void 0!==r?r:(Mj++).toString()},i=new CustomEvent(Aj.show,{bubbles:!1,cancelable:!1,detail:o});n.dispatchEvent(i)}(n,{...r,toasterId:e,data:{root:null==r?void 0:r.root}},t)},dismissToast:n=>{!function(e,t,n){const r=new CustomEvent(Aj.dismiss,{bubbles:!1,cancelable:!1,detail:{toastId:e,toasterId:t}});n.dispatchEvent(r)}(n,e,t)},dismissAllToasts:()=>{!function(e,t){const n=new CustomEvent(Aj.dismissAll,{bubbles:!1,cancelable:!1,detail:{toasterId:e}});t.dispatchEvent(n)}(e,t)},updateToast:n=>{!function(e,t){const n=new CustomEvent(Aj.update,{bubbles:!1,cancelable:!1,detail:e});t.dispatchEvent(n)}({...n,data:{root:n.root},toasterId:e},t)},pauseToast:n=>{!function(e,t,n){const r=new CustomEvent(Aj.pause,{bubbles:!1,cancelable:!1,detail:{toastId:e,toasterId:t}});n.dispatchEvent(r)}(n,e,t)},playToast:n=>{!function(e,t,n){const r=new CustomEvent(Aj.play,{bubbles:!1,cancelable:!1,detail:{toastId:e,toasterId:t}});n.dispatchEvent(r)}(n,e,t)}}:{dispatchToast:Bj,dismissToast:Bj,dismissAllToasts:Bj,updateToast:Bj,pauseToast:Bj,playToast:Bj}),[t,e])}var Hj=n(8656);const Gj="fui-Toast",zj=(0,Js.y)("rhf7k35",null,[".rhf7k35{display:grid;grid-template-columns:auto 1fr auto;padding:12px;border-radius:var(--borderRadiusMedium);border:1px solid var(--colorTransparentStroke);box-shadow:var(--shadow8);font-size:var(--fontSizeBase300);line-height:20px;font-weight:var(--fontWeightSemibold);color:var(--colorNeutralForeground1);background-color:var(--colorNeutralBackground1);}"]),qj=(0,Ks.X)({inverted:{sj55zd:"f1w7i9ko",De3pzq:"f5pduvr"}},{d:[".f1w7i9ko{color:var(--colorNeutralForegroundInverted2);}",".f5pduvr{background-color:var(--colorNeutralBackgroundInverted);}"]});const Wj=a.forwardRef(((e,t)=>{const n=((e,t)=>({components:{root:"div"},root:qs.Gk((0,Ws.g)("div",{ref:t,...e}),{elementType:"div"}),backgroundAppearance:e.appearance}))(e,t);return(e=>{const t=zj(),n=qj();e.root.className=(0,Ms.z)(Gj,t,"inverted"===e.backgroundAppearance&&n.inverted,e.root.className)})(n),((e,t)=>((0,Us.C)(e),(0,Bs.Y)(Hj.CH,{value:t.backgroundAppearance,children:(0,Bs.Y)(e.root,{})})))(n,function(e){const{backgroundAppearance:t}=e;return{backgroundAppearance:t}}(n))}));Wj.displayName="Toast";var jj=n(86816),Vj=n(18006);const Qj={close:()=>null,intent:void 0,bodyId:"",titleId:""},Jj=a.createContext(void 0),Kj=Jj.Provider,Xj=()=>{var e;return null!==(e=a.useContext(Jj))&&void 0!==e?e:Qj},Zj="fui-ToastTitle",Yj="fui-ToastTitle__media",$j="fui-ToastTitle__action",eV=(0,Js.y)("rdjap1e",null,[".rdjap1e{display:flex;grid-column-end:3;color:var(--colorNeutralForeground1);word-break:break-word;}"]),tV=(0,Js.y)("r8x5mrd","r1soj19y",[".r8x5mrd{display:flex;padding-top:2px;grid-column-end:2;padding-right:8px;font-size:16px;color:var(--colorNeutralForeground1);}",".r1soj19y{display:flex;padding-top:2px;grid-column-end:2;padding-left:8px;font-size:16px;color:var(--colorNeutralForeground1);}"]),nV=(0,Js.y)("r2j19ip","rjfozdo",[".r2j19ip{display:flex;align-items:start;padding-left:12px;grid-column-end:-1;color:var(--colorBrandForeground1);}",".rjfozdo{display:flex;align-items:start;padding-right:12px;grid-column-end:-1;color:var(--colorBrandForeground1);}"]),rV=(0,Ks.X)({root:{sj55zd:"f1w7i9ko"},action:{sj55zd:"f1qz2gb0"},media:{sj55zd:"fqpbvvt"}},{d:[".f1w7i9ko{color:var(--colorNeutralForegroundInverted2);}",".f1qz2gb0{color:var(--colorBrandForegroundInverted);}",".fqpbvvt{color:var(--colorNeutralForegroundInverted);}"]}),oV=(0,Ks.X)({success:{sj55zd:"f36rra6"},error:{sj55zd:"f1ca9wz"},warning:{sj55zd:"f13isgzr"},info:{sj55zd:"fkfq4zb"}},{d:[".f36rra6{color:var(--colorStatusSuccessForeground1);}",".f1ca9wz{color:var(--colorStatusDangerForeground1);}",".f13isgzr{color:var(--colorStatusWarningForeground1);}",".fkfq4zb{color:var(--colorNeutralForeground2);}"]}),iV=(0,Ks.X)({success:{sj55zd:"ff3wk4x"},error:{sj55zd:"fbq2gqr"},warning:{sj55zd:"fx6hq1t"},info:{sj55zd:"f1w7i9ko"}},{d:[".ff3wk4x{color:var(--colorStatusSuccessForegroundInverted);}",".fbq2gqr{color:var(--colorStatusDangerForegroundInverted);}",".fx6hq1t{color:var(--colorStatusWarningForegroundInverted);}",".f1w7i9ko{color:var(--colorNeutralForegroundInverted2);}"]}),aV=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{intent:n,titleId:r}=Xj(),o=(0,Hj.i1)();let i;switch(n){case"success":i=a.createElement(ru.gcm,null);break;case"error":i=a.createElement(ru.Tox,null);break;case"warning":i=a.createElement(jj.BFW,null);break;case"info":i=a.createElement(Vj.N_H,null)}return{action:qs.lq(e.action,{elementType:"div"}),components:{root:"div",media:"div",action:"div"},media:qs.lq(e.media,{renderByDefault:!!n,defaultProps:{children:i},elementType:"div"}),root:qs.Gk((0,Ws.g)("div",{ref:t,children:e.children,id:r,...e}),{elementType:"div"}),intent:n,backgroundAppearance:o}})(e,t);return(e=>{const t=eV(),n=nV(),r=tV(),o=oV(),i=iV(),{intent:a}=e,s=rV();e.root.className=(0,Ms.z)(Zj,t,"inverted"===e.backgroundAppearance&&s.root,e.root.className),e.media&&(e.media.className=(0,Ms.z)(Yj,r,"inverted"===e.backgroundAppearance&&s.media,e.media.className,a&&o[a],a&&"inverted"===e.backgroundAppearance&&i[a])),e.action&&(e.action.className=(0,Ms.z)($j,n,"inverted"===e.backgroundAppearance&&s.action,e.action.className))})(n),(e=>((0,Us.C)(e),(0,Bs.FD)(a.Fragment,{children:[e.media?(0,Bs.Y)(e.media,{}):null,(0,Bs.Y)(e.root,{}),e.action?(0,Bs.Y)(e.action,{}):null]})))(n)}));aV.displayName="ToastTitle";var sV=n(23606),lV=n(37264),cV=n(750);const uV=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:n=!1}=e,{close:r}=Xj(),o=(0,sV.h)(t),i=(0,Gs.D)((e=>{var t,n;null==o||null===(t=(n=o.props).onClick)||void 0===t||t.call(n,e),e.isDefaultPrevented()||r()})),a={...null==o?void 0:o.props,ref:null==o?void 0:o.ref,onClick:i},s=(0,cV.F)("button"===(null==o?void 0:o.type)||"a"===(null==o?void 0:o.type)?o.type:"div",{...a,type:"button"});return{children:(0,lV.L)(t,n?a:s)}})(e);return(e=>e.children)(t)};uV.displayName="ToastTrigger";const dV={scrollState:"none",setScrollState:()=>({})},pV=a.createContext(void 0),gV=pV.Provider,mV=()=>{var e;return null!==(e=a.useContext(pV))&&void 0!==e?e:dV};var fV=n(33592),hV=n(80927),vV=n(46886);const yV="--fui-Drawer--size",CV=(Wb.L.colorNeutralBackground1,Wb.L.colorNeutralForeground1,(0,Ks.X)({start:{h3c5rm:0,vrafjx:0,Bekrc4i:0,u1mtju:["f1xteiwb","fsqykmd"],oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["fvfyk4","frppm18"]},end:{zhjwy3:0,wvpqe5:0,ibv6hh:0,B4g9neb:["fsqykmd","f1xteiwb"],j35jbq:["f1e31b4d","f1vgc2s3"],oyh7mz:["frppm18","fvfyk4"]},bottom:{B5kzvoi:"f1yab3r1",Bhzewxz:"f198g47y"},small:{Bjr0ffy:"f1exhnwo"},medium:{Bjr0ffy:"fqofjzu"},large:{Bjr0ffy:"fce6y3m"},full:{Bjr0ffy:"fsdmzs6"}},{d:[[".f1xteiwb{border-right:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],[".fsqykmd{border-left:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".fvfyk4{right:auto;}",".frppm18{left:auto;}",[".fsqykmd{border-left:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],[".f1xteiwb{border-right:var(--strokeWidthThin) solid var(--colorTransparentStroke);}",{p:-1}],".f1yab3r1{bottom:0;}",".f198g47y{top:auto;}",".f1exhnwo{--fui-Drawer--size:320px;}",".fqofjzu{--fui-Drawer--size:592px;}",".fce6y3m{--fui-Drawer--size:940px;}",".fsdmzs6{--fui-Drawer--size:100vw;}"]})),SV=(0,Ks.X)({small:{Bjr0ffy:"f1exhnwo"},medium:{Bjr0ffy:"fqofjzu"},large:{Bjr0ffy:"fce6y3m"},full:{Bjr0ffy:"f1rat34m"}},{d:[".f1exhnwo{--fui-Drawer--size:320px;}",".fqofjzu{--fui-Drawer--size:592px;}",".fce6y3m{--fui-Drawer--size:940px;}",".f1rat34m{--fui-Drawer--size:100%;}"]}),bV={small:hV.TV.durationGentle,medium:hV.TV.durationSlow,large:hV.TV.durationSlower,full:hV.TV.durationUltraSlow};function EV(e,t,n){const r=`translate3d(var(${t}), 0, 0)`,o=`translate3d(calc(var(${t}) * -1), 0, 0)`;return"start"===e?"rtl"===n?o:r:"end"===e?"rtl"===n?r:o:"bottom"===e?`translate3d(0, var(${t}), 0)`:"translate3d(0, 0, 0)"}(0,vV.$)((({position:e,size:t,dir:n})=>{const r=[{transform:EV(e,yV,n),opacity:0},{transform:"translate3d(0, 0, 0)",opacity:1}],o=bV[t];return{enter:{keyframes:r,duration:o,easing:hV.TV.curveDecelerateMid},exit:{keyframes:[...r].reverse(),duration:o,easing:hV.TV.curveAccelerateMin}}}));const TV=(0,vV.$)((({position:e,size:t,dir:n})=>{const r=[{transform:EV(e,yV,n),boxShadow:`0px ${Wb.L.colorTransparentBackground}`,opacity:0},{transform:"translate3d(0, 0, 0)",boxShadow:Wb.L.shadow64,opacity:1}],o=bV[t];return{enter:{keyframes:r,duration:o,easing:hV.TV.curveDecelerateMid},exit:{keyframes:[...r].reverse(),duration:o,easing:hV.TV.curveAccelerateMin}}})),IV=(0,vV.$)((({size:e})=>{const t=[{opacity:0},{opacity:1}],n=bV[e];return{enter:{keyframes:t,easing:hV.TV.curveLinear,duration:n},exit:{keyframes:[...t].reverse(),easing:hV.TV.curveLinear,duration:n}}}));var _V=n(1810),wV=n(24459),PV=n(22519);const xV=(0,Js.y)("rmnljus",null,[".rmnljus{inset:0px;position:fixed;background-color:rgba(0, 0, 0, 0.4);}"]),kV=(0,Ks.X)({nested:{De3pzq:"f1c21dwh"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}"]}),AV=a.forwardRef(((e,t)=>{const n=(0,_V.W)({...e,as:e.as},t),r=(0,wV.l)(n);return(e=>{const t=xV(),n=kV();e.backdrop&&(e.backdrop.className=(0,Ms.z)(t,e.isNestedDialog&&n.nested,e.backdrop.className))})(n),(0,PV.V)(n,r)}));function LV(e,t,n){return null===e?null:{...e,children:(r,o)=>(null==e?void 0:e.children)?e.children(t,{...o,...n}):a.createElement(t,{...o,...n},o.children)}}AV.displayName="OverlayDrawerSurface";const DV={active:!0,canRender:!0,ref:a.createRef(),type:"idle"},OV="fui-OverlayDrawer",NV="fui-OverlayDrawer__backdrop",RV=(0,Js.y)("r7dfyj8","rmx02j7",{r:[".r7dfyj8{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:fixed;top:0;bottom:0;}",".r7dfyj8:focus{outline-style:none;}",".r7dfyj8:focus-visible{outline-style:none;}",".r7dfyj8[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.r7dfyj8[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".rmx02j7{overflow:hidden;width:var(--fui-Drawer--size);max-width:100vw;height:auto;max-height:100vh;box-sizing:border-box;display:flex;flex-direction:column;align-items:flex-start;justify-content:flex-start;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);position:fixed;top:0;bottom:0;}",".rmx02j7:focus{outline-style:none;}",".rmx02j7:focus-visible{outline-style:none;}",".rmx02j7[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.rmx02j7[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:["@media (forced-colors: active){.r7dfyj8[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}","@media (forced-colors: active){.rmx02j7[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),FV=(0,Ks.X)({start:{},end:{},bottom:{Bhzewxz:"f198g47y",Bqenvij:"fub80nq",a9b677:"fr97h3j"},absolute:{qhf8xq:"f1euv43f"}},{d:[".f198g47y{top:auto;}",".fub80nq{height:var(--fui-Drawer--size);}",".fr97h3j{width:100vw;}",".f1euv43f{position:absolute;}"]}),MV=e=>{const t=(({position:e,size:t})=>{const n=CV(),r=SV();return(0,Ms.z)(n[e],"bottom"===e&&r[t],"bottom"!==e&&n[t])})(e),n=RV(),r=FV(),o=!!e.mountNode&&r.absolute,i=e.root.backdrop;return e.root.className=(0,Ms.z)(OV,t,n,r[e.position],o,e.root.className),i&&(i.className=(0,Ms.z)(NV,o,i.className)),e},BV=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{open:n,size:r,position:o}=function(e){const{open:t=!1,size:n="small",position:r="start"}=e;return{size:n,position:r,open:t}}(e),{backdropMotion:i,modalType:a="modal",inertTrapFocus:s,onOpenChange:l,surfaceMotion:c,mountNode:u}=e,{dir:d}=(0,ul.Y)(),p=qs.Gf(e.backdrop),g="non-modal"!==a&&null!==p,m=qs.Gk({...e,ref:t,backdrop:g?{...p}:null,backdropMotion:LV(i,IV,{size:r})},{elementType:AV}),f=qs.Gk({open:n,onOpenChange:l,inertTrapFocus:s,modalType:a,surfaceMotion:LV(c,TV,{position:o,size:r,dir:d}),children:null},{elementType:fV.l});return{components:{root:AV,dialog:fV.l},root:m,dialog:f,open:n,size:r,position:o,mountNode:u,motion:DV}})(e,t),r=(()=>{const[e,t]=a.useState("none");return{setScrollState:t,scrollState:e}})();return MV(n),(0,il.$e)("useDrawerOverlayStyles_unstable")(n),(0,il.$e)("useOverlayDrawerStyles_unstable")(n),((e,t)=>((0,Us.C)(e),(0,Bs.Y)(gV,{value:t,children:(0,Bs.Y)(e.dialog,{children:(0,Bs.Y)(e.root,{})})})))(n,r)}));BV.displayName="OverlayDrawer";var UV=n(71194);const HV=e=>(e(0),0),GV=e=>e;var zV=n(82745);const qV=(e,t)=>{const{setScrollState:n}=mV(),r=a.useRef(null),[o,i]=function(){const{targetDocument:e}=(0,ul.Y)(),t=null==e?void 0:e.defaultView,n=t?t.requestAnimationFrame:HV,r=t?t.cancelAnimationFrame:GV;return(0,UV.X)(n,r)}(),s=a.useCallback((()=>{r.current&&n((({scrollTop:e,scrollHeight:t,clientHeight:n})=>t<=n?"none":0===e?"top":e+n===t?"bottom":"middle")(r.current))}),[n]),l=a.useCallback((()=>{i(),o((()=>s()))}),[i,o,s]);return(0,pl.E)((()=>{s()}),[e.children,s]),(0,pl.E)((()=>(s(),()=>i())),[i,s]),{components:{root:"div"},root:qs.Gk((0,Ws.g)("div",{ref:(0,bc.a)(t,r),...e,onScroll:(0,zV.p)(e.onScroll,l)}),{elementType:"div"})}},WV="fui-DrawerBody",jV=(0,Js.y)("ri6rvx7",null,[".ri6rvx7{padding:0 var(--spacingHorizontalXXL);flex:1;align-self:stretch;position:relative;z-index:1;overflow:auto;}",".ri6rvx7:last-child{padding-bottom:calc(var(--spacingHorizontalXXL) + 1px);}",".ri6rvx7:first-child{padding-top:calc(var(--spacingHorizontalXXL) + 1px);}"]),VV=a.forwardRef(((e,t)=>{const n=qV(e,t);return(e=>{const t=jV();e.root.className=(0,Ms.z)(WV,t,e.root.className)})(n),(0,il.$e)("useDrawerBodyStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.Y)(e.root,{})))(n)}));VV.displayName="DrawerBody";var QV=n(45392),JV=n(84037),KV=n(33085);function XV(e){const t=[];let n=0;const r=(e,n)=>{const r=t[e];t[e]=t[n],t[n]=r},o=i=>{let a=i;const s=ZV(i),l=YV(i);s<n&&e(t[s],t[a])<0&&(a=s),l<n&&e(t[l],t[a])<0&&(a=l),a!==i&&(r(a,i),o(a))};return{all:()=>t.slice(0,n),clear:()=>{n=0},contains:e=>{const r=t.indexOf(e);return r>=0&&r<n},dequeue:()=>{if(0===n)throw new Error("Priority queue empty");const e=t[0];return t[0]=t[--n],o(0),e},enqueue:o=>{t[n++]=o;let i=n-1,a=$V(i);for(;i>0&&e(t[a],t[i])>0;)r(a,i),i=a,a=$V(i)},peek:()=>0===n?null:t[0],remove:e=>{const r=t.indexOf(e);-1===r||r>=n||(t[r]=t[--n],o(r))},size:()=>n}}const ZV=e=>2*e+1,YV=e=>2*e+2,$V=e=>Math.floor((e-1)/2);function eQ(e,t){for(const[n,r]of Object.entries(t))null!=r&&(e[n]=r)}const tQ={onStatusChange:void 0,priority:0,pauseOnHover:!1,pauseOnWindowBlur:!1,position:"bottom-end",timeout:3e3};let nQ=0;function rQ(e={}){const t=(0,KV.C)(),{toasterId:n,shortcuts:r}=e,[o]=a.useState((()=>function(e){const{limit:t=Number.POSITIVE_INFINITY}=e,n=new Set,r=new Map,o=XV(((e,t)=>{const n=r.get(e),o=r.get(t);return n&&o?n.priority===o.priority?n.order-o.order:n.priority-o.priority:0}));return{buildToast:(i,s)=>{var l;const{toastId:c,content:u,toasterId:d}=i;if(r.has(c))return;const p={...tQ,close:()=>{var e;const t=r.get(c);t&&(n.delete(c),s(),null===(e=t.onStatusChange)||void 0===e||e.call(t,null,{status:"dismissed",...t}))},remove:()=>{if(r.get(c)){if(r.delete(c),n.size<t&&o.peek()){const e=r.get(o.dequeue());if(!e)return;n.add(e.toastId)}s()}},toastId:c,content:u,updateId:0,toasterId:d,order:nQ++,data:{},imperativeRef:a.createRef()};eQ(p,e),eQ(p,i),r.set(c,p),null===(l=p.onStatusChange)||void 0===l||l.call(p,null,{status:"queued",...p}),n.size>=t?o.enqueue(c):n.add(c)},dismissAllToasts:()=>{n.clear(),o.clear()},dismissToast:e=>{n.delete(e)},isToastVisible:e=>n.has(e),updateToast:e=>{const{toastId:t}=e,n=r.get(t);n&&(Object.assign(n,e),n.updateId++)},visibleToasts:n,toasts:r}}(e))),{targetDocument:i}=(0,ul.Y)(),s=a.useRef(null),l=(0,Gs.D)((e=>e===n)),c=(0,Gs.D)((e=>{if(null==r?void 0:r.focus)return r.focus(e)})),u=a.useCallback((()=>{o.visibleToasts.forEach((e=>{var t;const n=o.toasts.get(e);null==n||null===(t=n.imperativeRef.current)||void 0===t||t.pause()}))}),[o]),d=a.useCallback((()=>{o.visibleToasts.forEach((e=>{var t;const n=o.toasts.get(e);null==n||null===(t=n.imperativeRef.current)||void 0===t||t.play()}))}),[o]),p=a.useCallback((()=>Array.from(o.visibleToasts).reduce(((e,t)=>{const n=o.toasts.get(t);return n?e?e.order<(null==n?void 0:n.order)?n:e:n:e}),void 0)),[o]),g=a.useCallback((()=>{const e=p();var t;(null==e?void 0:e.imperativeRef.current)?e.imperativeRef.current.focus():(null===(t=s.current)||void 0===t||t.focus(),s.current=null)}),[p]),m=a.useCallback((()=>{o.visibleToasts.forEach((e=>{const t=o.toasts.get(e);null==t||t.close()})),g()}),[o,g]);a.useEffect((()=>{if(!i)return;const e=(e,n)=>{const r=e=>{l(e.detail.toasterId)&&(n(e),t())};return i.addEventListener(e,r),()=>i.removeEventListener(e,r)},n=e(Aj.show,(e=>{o.buildToast(e.detail,t)})),r=e(Aj.update,(e=>{o.updateToast(e.detail)})),a=e(Aj.dismiss,(e=>{o.dismissToast(e.detail.toastId)})),d=e(Aj.dismissAll,(e=>{o.dismissAllToasts()})),g=e(Aj.pause,(e=>{const t=o.toasts.get(e.detail.toastId);var n;t&&(null===(n=t.imperativeRef.current)||void 0===n||n.pause())})),m=e(Aj.play,(e=>{const t=o.toasts.get(e.detail.toastId);var n;t&&(null===(n=t.imperativeRef.current)||void 0===n||n.play())})),f=e=>{if(c(e)){u();const e=p();var t;if(e)s.current=(0,Nl.s)(i.activeElement)?i.activeElement:null,null===(t=e.imperativeRef.current)||void 0===t||t.focus()}};return i.addEventListener("keydown",f),()=>{n(),d(),r(),a(),g(),m(),i.removeEventListener("keydown",f)}}),[o,t,i,l,u,p,c]);const f=(()=>{if(!o)return new Map;const e=new Map;return Array.from(o.toasts.values()).forEach((t=>{const{position:n}=t;e.has(n)||e.set(n,[]),n.startsWith("bottom")?e.get(n).push(t):e.get(n).unshift(t)})),e})();return{isToastVisible:o.isToastVisible,toastsToRender:f,pauseAllToasts:u,playAllToasts:d,tryRestoreFocus:g,closeAllToasts:m}}var oQ=n(74151);const iQ=(0,Js.y)("r16zaflb","r75casi",[".r16zaflb{animation-name:rsacmq1;}","@keyframes rsacmq1{from{opacity:0;}to{opacity:0;}}",".r75casi{animation-name:rsacmq1;}"]),aQ=a.forwardRef(((e,t)=>{const n=iQ(),{running:r,timeout:o,onTimeout:i}=e,s={animationDuration:`${o}ms`,animationPlayState:r?"running":"paused"};return o<0?null:a.createElement("span",{onAnimationEnd:i,"data-timer-status":s.animationPlayState,ref:t,style:s,className:n})}));aQ.displayName="Timer";const sQ={success:"assertive",warning:"assertive",error:"assertive",info:"polite"},lQ=(0,vV.$)((({element:e})=>({enter:[{keyframes:[{marginTop:0,minHeight:0,maxHeight:0,opacity:0},{marginTop:"16px",minHeight:44,maxHeight:`${e.scrollHeight}px`,opacity:0}],duration:200},{keyframes:[{opacity:0},{opacity:1}],delay:200,duration:400}],exit:[{keyframes:[{marginTop:"16px",minHeight:44,maxHeight:`${e.scrollHeight}px`},{marginTop:0,minHeight:0,maxHeight:0}],delay:400,duration:200},{keyframes:[{opacity:1},{opacity:0}],duration:400}]}))),cQ="fui-ToastContainer",uQ=(0,Js.y)("r98b696",null,[".r98b696{box-sizing:border-box;margin-top:16px;pointer-events:all;border-radius:var(--borderRadiusMedium);}",".r98b696[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);}"]);const dQ=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{visible:n,children:r,close:o,remove:i,updateId:s,announce:l,data:c,timeout:u,politeness:d,intent:p="info",pauseOnHover:g,pauseOnWindowBlur:m,imperativeRef:f,tryRestoreFocus:h,...v}=e,y=(0,Bl.Bi)("toast-title"),C=(0,Bl.Bi)("toast-body"),S=a.useRef(null),{targetDocument:b}=(0,ul.Y)(),[E,T]=a.useState(!1),I=a.useRef(!1),_=a.useRef(!1),w=(0,JV.V)({tabBehavior:"limited-trap-focus",ignoreDefaultKeydown:{Tab:!0,Escape:!0,Enter:!0}}),P=(0,Gs.D)((()=>{var e;const t=null==b?void 0:b.activeElement;t&&(null===(e=S.current)||void 0===e?void 0:e.contains(t))&&(_.current=!0),o()})),x=(0,Gs.D)((t=>{var n;return null===(n=e.onStatusChange)||void 0===n?void 0:n.call(e,null,{status:t,...e})})),k=(0,Gs.D)((()=>T(!1))),A=(0,Gs.D)((()=>{var e,t;if(I.current)return;const n=!!(null===(e=S.current)||void 0===e?void 0:e.contains(null!==(t=null==b?void 0:b.activeElement)&&void 0!==t?t:null));u<0?T(!0):n||T(!0)}));a.useImperativeHandle(f,(()=>({focus:()=>{S.current&&S.current.focus()},play:()=>{I.current=!1,A()},pause:()=>{I.current=!0,k()}}))),a.useEffect((()=>()=>x("unmounted")),[x]),a.useEffect((()=>{var e,t;if(b&&m)return null===(e=b.defaultView)||void 0===e||e.addEventListener("focus",A),null===(t=b.defaultView)||void 0===t||t.addEventListener("blur",k),()=>{var e,t;null===(e=b.defaultView)||void 0===e||e.removeEventListener("focus",A),null===(t=b.defaultView)||void 0===t||t.removeEventListener("blur",k)}}),[b,k,A,m]);const L=c.root,D=a.useCallback(((e,{direction:t})=>{"exit"===t&&i(),"enter"===t&&(A(),x("visible"))}),[x,A,i]),O=(0,Gs.D)((e=>{var t;k(),null==L||null===(t=L.onMouseEnter)||void 0===t||t.call(L,e)})),N=(0,Gs.D)((e=>{var t;A(),null==L||null===(t=L.onMouseEnter)||void 0===t||t.call(L,e)})),{findFirstFocusable:R,findLastFocusable:F}=(0,oQ.r)(),M=(0,Gs.D)((e=>{var t,n,r;e.key===Hs.epd&&(e.preventDefault(),P()),e.key===Hs.ozo&&e.currentTarget===e.target&&(e.preventDefault(),e.shiftKey?null===(n=F(e.currentTarget))||void 0===n||n.focus():null===(r=R(e.currentTarget))||void 0===r||r.focus()),null==L||null===(t=L.onKeyDown)||void 0===t||t.call(L,e)}));return a.useEffect((()=>{var e;if(!n)return;const t=null!=d?d:sQ[p];var r;l(null!==(r=null===(e=S.current)||void 0===e?void 0:e.textContent)&&void 0!==r?r:"",{politeness:t})}),[l,d,S,n,s,p]),a.useEffect((()=>()=>{_.current&&(_.current=!1,h())}),[h]),{components:{timer:aQ,root:"div"},timer:qs.Gk({onTimeout:P,running:E,timeout:null!=u?u:-1},{elementType:aQ}),root:qs.Gk((0,Ws.g)("div",{ref:(0,bc.a)(t,S),children:r,tabIndex:0,role:"listitem","aria-labelledby":y,"aria-describedby":C,...v,...L,...w,onMouseEnter:O,onMouseLeave:N,onKeyDown:M}),{elementType:"div"}),timerTimeout:u,transitionTimeout:0,running:E,visible:n,remove:i,close:P,onTransitionEntering:()=>{},updateId:s,nodeRef:S,intent:p,titleId:y,bodyId:C,onMotionFinish:D}})(e,t);return(e=>{const t=uQ();e.root.className=(0,Ms.z)(cQ,t,e.root.className)})(n),((e,t)=>{const{onMotionFinish:n,visible:r,updateId:o}=e;return(0,Us.C)(e),(0,Bs.Y)(Kj,{value:t.toast,children:(0,Bs.Y)(lQ,{appear:!0,onMotionFinish:n,visible:r,unmountOnExit:!0,children:(0,Bs.FD)(e.root,{children:[e.root.children,(0,Bs.Y)(e.timer,{},o)]})})})})(n,function(e){const{close:t,intent:n,titleId:r,bodyId:o}=e;return{toast:a.useMemo((()=>({close:t,intent:n,titleId:r,bodyId:o})),[t,n,r,o])}}(n))}));dQ.displayName="ToastContainer";const pQ=()=>{};const gQ=e=>{const{offset:t,announce:n,mountNode:r,inline:o=!1,...i}=e,s=a.useRef((()=>null)),{toastsToRender:l,isToastVisible:c,pauseAllToasts:u,playAllToasts:d,tryRestoreFocus:p,closeAllToasts:g}=rQ(i),m=a.useCallback(((e,t)=>s.current(e,t)),[]),{dir:f}=(0,ul.Y)(),h=qs.Gk((0,Ws.g)("div",i),{elementType:"div"}),v=(0,JV.V)({tabBehavior:"limited-trap-focus",ignoreDefaultKeydown:{Escape:!0}}),y=(0,Gs.D)((t=>{var n;t.key===Hs.uf9&&(t.preventDefault(),g()),null===(n=e.onKeyDown)||void 0===n||n.call(e,t)})),C=e=>{var t;const r=function(e,t){const{targetDocument:n}=(0,ul.Y)(),r=a.useRef(pQ);return a.useCallback((o=>{if(!o||!n)return r.current(),void(r.current=pQ);const i=n.createTreeWalker(o,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>(0,Nl.s)(e)&&e.classList.contains(cQ)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}),a=e=>{const{target:t,key:n}=e;if((0,Nl.s)(t)){if(n===Hs.yd$){i.currentNode=t;let e=i.nextNode();e||(i.currentNode=o,e=i.nextNode()),(0,Nl.s)(e)&&e.focus()}if(n===Hs.DoI){i.currentNode=t;let e=i.previousNode();e&&e.contains(t)&&(e=i.previousNode()),e||(i.currentNode=o,e=i.lastChild()),(0,Nl.s)(e)&&e.focus()}}},s=t=>{(0,Nl.s)(t.currentTarget)&&!t.currentTarget.contains((0,Nl.s)(t.relatedTarget)?t.relatedTarget:null)&&e()},l=e=>{(0,Nl.s)(e.currentTarget)&&!e.currentTarget.contains((0,Nl.s)(e.relatedTarget)?e.relatedTarget:null)&&t()};o.addEventListener("keydown",a),o.addEventListener("focusin",s),o.addEventListener("focusout",l),r.current=()=>{o.removeEventListener("keydown",a),o.removeEventListener("focusin",s),o.removeEventListener("focusout",l)}}),[n,e,t])}(u,d),{announceToast:o,toasterRef:i}=function(e){const t=a.useRef(!0),n=a.useRef((()=>{})),r=a.useCallback(((n,r)=>{t.current&&e(n,r)}),[e]);return{announceToast:r,toasterRef:a.useCallback((e=>{if(!e)return void n.current();const r=e=>{(0,Nl.s)(e.currentTarget)&&e.currentTarget.contains((0,Nl.s)(e.relatedTarget)?e.relatedTarget:null)||(t.current=!1)},o=e=>{(0,Nl.s)(e.currentTarget)&&e.currentTarget.contains((0,Nl.s)(e.relatedTarget)?e.relatedTarget:null)||(t.current=!0)};e.addEventListener("focusin",r),e.addEventListener("focusout",o),n.current=()=>{e.removeEventListener("focusin",r),e.removeEventListener("focusout",o)}}),[])}}(null!=n?n:m);return qs.lq(l.has(e)?h:null,{defaultProps:{ref:(0,bc.a)(r,i),children:null===(t=l.get(e))||void 0===t?void 0:t.map((e=>a.createElement(dQ,{...e,tryRestoreFocus:p,intent:e.intent,announce:o,key:e.toastId,visible:c(e.toastId)},e.content))),onKeyDown:y,...v,"data-toaster-position":e,role:"list"},elementType:"div"})};return{dir:f,mountNode:r,components:{root:"div",bottomStart:"div",bottomEnd:"div",topStart:"div",topEnd:"div",top:"div",bottom:"div"},root:qs.Gk(h,{elementType:"div"}),bottomStart:C(Oj),bottomEnd:C(Dj),topStart:C(Fj),topEnd:C(Rj),top:C(Nj),bottom:C(Lj),announceRef:s,offset:t,announce:null!=n?n:m,renderAriaLive:!n,inline:o}};var mQ=n(75693);const fQ="fui-AriaLive__assertive",hQ="fui-AriaLive__polite",vQ=(0,Js.y)("rrd10u0",null,[".rrd10u0{clip:rect(0px, 0px, 0px, 0px);height:1px;margin:-1px;overflow:hidden;padding:0px;width:1px;position:absolute;}"]),yQ=e=>{const t=(e=>{const[t,n]=a.useState(void 0),r=a.useRef(0),[o]=a.useState((()=>XV(((e,t)=>e.politeness===t.politeness?e.createdAt-t.createdAt:"assertive"===e.politeness?-1:1)))),i=(0,Gs.D)(((e,i)=>{const{politeness:a}=i;if(e===(null==t?void 0:t.message))return;const s={message:e,politeness:a,createdAt:r.current++};t?o.enqueue(s):n(s)})),[s,l]=(0,Hl.Z)();a.useEffect((()=>(s((()=>{o.peek()?n(o.dequeue()):n(void 0)}),500),()=>l())),[t,o,s,l]),a.useImperativeHandle(e.announceRef,(()=>i));const c="polite"===(null==t?void 0:t.politeness)?t.message:void 0,u="assertive"===(null==t?void 0:t.politeness)?t.message:void 0;return{components:{assertive:"div",polite:"div"},assertive:qs.Gk(e.assertive,{defaultProps:{"aria-live":"assertive",children:u},elementType:"div"}),polite:qs.Gk(e.polite,{defaultProps:{"aria-live":"polite",children:c},elementType:"div"})}})(e);return(e=>{const t=vQ();e.assertive.className=(0,Ms.z)(t,fQ,e.assertive.className),e.polite.className=(0,Ms.z)(t,hQ,e.polite.className)})(t),(e=>((0,Us.C)(e),(0,Bs.FD)(a.Fragment,{children:[(0,Bs.Y)(e.assertive,{}),(0,Bs.Y)(e.polite,{})]})))(t)};yQ.displayName="AriaLive";const CQ=(e,t,n)=>{const r={};var o;const i=n?function(e){return"horizontal"in e||"vertical"in e}(n)?n:null!==(o=n[e])&&void 0!==o?o:{}:{},a="top"===e||"bottom"===e,{horizontal:s=(a?0:20),vertical:l=16}=i,c="ltr"===t?"left":"right",u="ltr"===t?"right":"left";switch(e){case"top":Object.assign(r,{top:l,left:`calc(50% + ${s}px)`,transform:"translateX(-50%)"});break;case"bottom":Object.assign(r,{bottom:l,left:`calc(50% + ${s}px)`,transform:"translateX(-50%)"});break;case"top-start":Object.assign(r,{top:l,[c]:s});break;case"top-end":Object.assign(r,{top:l,[u]:s});break;case"bottom-start":Object.assign(r,{bottom:l,[c]:s});break;case"bottom-end":Object.assign(r,{bottom:l,[u]:s})}return r};const SQ="fui-Toaster",bQ=(0,Js.y)("r3hfdjz",null,[".r3hfdjz{position:fixed;width:292px;pointer-events:none;}"]),EQ=(0,Ks.X)({inline:{qhf8xq:"f1euv43f"}},{d:[".f1euv43f{position:absolute;}"]}),TQ=e=>{const t=gQ(e);return(e=>{const t=bQ(),n=EQ(),r=(0,Ms.z)(SQ,t,e.inline&&n.inline,e.root.className);var o,i,a,s,l,c,u,d,p,g,m,f;e.bottomStart&&(e.bottomStart.className=r,null!==(i=(o=e.bottomStart).style)&&void 0!==i||(o.style={}),Object.assign(e.bottomStart.style,CQ(Oj,e.dir,e.offset))),e.bottomEnd&&(e.bottomEnd.className=r,null!==(s=(a=e.bottomEnd).style)&&void 0!==s||(a.style={}),Object.assign(e.bottomEnd.style,CQ(Dj,e.dir,e.offset))),e.topStart&&(e.topStart.className=r,null!==(c=(l=e.topStart).style)&&void 0!==c||(l.style={}),Object.assign(e.topStart.style,CQ(Fj,e.dir,e.offset))),e.topEnd&&(e.topEnd.className=r,null!==(d=(u=e.topEnd).style)&&void 0!==d||(u.style={}),Object.assign(e.topEnd.style,CQ(Rj,e.dir,e.offset))),e.top&&(e.top.className=r,null!==(g=(p=e.top).style)&&void 0!==g||(p.style={}),Object.assign(e.top.style,CQ(Nj,e.dir,e.offset))),e.bottom&&(e.bottom.className=r,null!==(f=(m=e.bottom).style)&&void 0!==f||(m.style={}),Object.assign(e.bottom.style,CQ(Lj,e.dir,e.offset)))})(t),(0,il.$e)("useToasterStyles_unstable")(t),(e=>{const{announceRef:t,renderAriaLive:n,inline:r,mountNode:o}=e;(0,Us.C)(e);const i=!!(e.bottomStart||e.bottomEnd||e.topStart||e.topEnd||e.top||e.bottom),s=n?(0,Bs.Y)(yQ,{announceRef:t}):null,l=(0,Bs.FD)(a.Fragment,{children:[e.bottom?(0,Bs.Y)(e.bottom,{}):null,e.bottomStart?(0,Bs.Y)(e.bottomStart,{}):null,e.bottomEnd?(0,Bs.Y)(e.bottomEnd,{}):null,e.topStart?(0,Bs.Y)(e.topStart,{}):null,e.topEnd?(0,Bs.Y)(e.topEnd,{}):null,e.top?(0,Bs.Y)(e.top,{}):null]});return r?(0,Bs.FD)(a.Fragment,{children:[s,i?l:null]}):(0,Bs.FD)(a.Fragment,{children:[s,i?(0,Bs.Y)(mQ.Z,{mountNode:o,children:l}):null]})})(t)};TQ.displayName="Toaster";var IQ=n(43369),_Q=n(20749),wQ=n(43947),PQ=n(47779),xQ=n(47490),kQ=n(27543),AQ=n(41807),LQ=n(77062),DQ=n(65076),OQ=n(32776);const NQ=function(e){var t=e.onCloseFre,n=e.mountNode,r=e.primaryButtonText,o=e.headerText,i=e.title,s=e.image,l=e.bodyText,c=e.anchorId,u=null==s?void 0:s.src,d={target:document.getElementById(c),position:"above",align:"start"},p=(0,F.__read)(a.useState(!0),2),g=p[0],m=p[1];return a.createElement(PQ.l,{open:g,size:"large",trapFocus:!0,onOpenChange:function(){m(!1),t(!1)},mountNode:n,positioning:d,withArrow:!0},a.createElement(xQ.S,{"aria-label":"".concat(o," ").concat(i," ").concat(l)},a.createElement(kQ.M,null,o),a.createElement(AQ.N,{media:a.createElement(LQ._,{fit:"contain",src:u})},a.createElement(DQ.T,null,i),a.createElement("div",null,l)),a.createElement(OQ.w,{primary:{children:r,onClick:function(){m(!1),t(!0)},role:"button",tabIndex:-1,"aria-label":r}})))};var RQ=n(55776),FQ=n(10286),MQ=(0,F.__assign)((0,F.__assign)((0,F.__assign)({maxWidth:"100%",height:"32px"},Xa.Pt.margin("2px","16px","2px","16px")),Xa.Pt.padding("0px")),{alignItems:"center",cornerRadius:"8px",borderRadius:"8px",backgroundColor:Wb.L.colorNeutralBackground3,":hover":{backgroundColor:Wb.L.colorNeutralBackground3Hover,"& button":{backgroundColor:Wb.L.colorNeutralBackground3Hover}},":hover:active":{backgroundColor:Wb.L.colorNeutralBackground3Selected}}),BQ=(0,F.__assign)((0,F.__assign)((0,F.__assign)({maxWidth:"100%",height:"32px"},Xa.Pt.margin("2px","8px","2px","8px")),Xa.Pt.padding("0px")),{alignItems:"center",cornerRadius:"8px",backgroundColor:Wb.L.colorNeutralBackground3}),UQ=(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("0px")),{width:"32px",height:"32px",alignItems:"center",backgroundColor:Wb.L.colorNeutralBackground3,":hover":{backgroundColor:Wb.L.colorNeutralBackground3Hover}}),HQ={menuContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},drawerBody:(0,F.__assign)({},Xa.Pt.padding("0px")),menuItem:(0,F.__assign)((0,F.__assign)({},MQ),{":hover":{backgroundColor:Wb.L.colorNeutralBackground3Hover,"& rect":{fill:Wb.L.colorNeutralStroke1Hover},"& button":{backgroundColor:Wb.L.colorNeutralBackground3Hover}},":hover:active":{backgroundColor:Wb.L.colorNeutralBackground3Selected,"& rect":{fill:Wb.L.colorNeutralStroke1Hover}},"& rect":{fill:"transparent"}}),menuItemSelected:(0,F.__assign)((0,F.__assign)({},MQ),{"& rect":{fill:Wb.L.colorBrandForeground1}}),menuItemSeeMore:(0,F.__assign)((0,F.__assign)({},MQ),Xa.Pt.padding("0px","0px","0px","6px")),menuItemParts:{justifyContent:"space-between"},itemSelector:(0,F.__assign)({},Xa.Pt.margin("4px","0px","0px","0px")),menuItemIcon:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("0px","0px","0px","5px")),{maxWidth:"20px",maxHeight:"20px",alignSelf:"center"}),menuItemLabel:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("0px","0px","0px","6px")),{fontSize:"14px",lineHeight:"14px",alignSelf:"center",color:Wb.L.colorNeutralForeground1}),menuItemLabelSelected:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("0px","0px","0px","6px")),{fontSize:"14px",lineHeight:"14px",alignSelf:"center",fontWeight:Wb.L.fontWeightSemibold,color:Wb.L.colorNeutralForeground1}),menuButton:{minWidth:"95%",alignItems:"center"},chatHistoryButton:(0,F.__assign)((0,F.__assign)((0,F.__assign)({},MQ),{width:"calc(100% - 32px)",alignSelf:"flex-end",borderRadius:"8px"}),Xa.Pt.margin("2px","16px","12px","16px")),actionButtonContainer:(0,F.__assign)({},Xa.Pt.padding("0px","6px","0px","0px")),actionButton:(0,F.__assign)({},UQ),errorToastBody:(0,F.__assign)({alignItems:"start"},Xa.Pt.gap("5px")),errorToastIcon:(0,F.__assign)({},Xa.Pt.padding("5px")),errorToastText:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("5px","0px")),{width:"200px",fontWeight:"600",fontSize:"300"}),errorToastMount:{position:"fixed",top:"90vh",height:"0px",width:"100%"}},GQ={menuItem:(0,F.__assign)((0,F.__assign)({},BQ),{":hover":{backgroundColor:Wb.L.colorNeutralBackground3Hover,"& rect":{fill:Wb.L.colorNeutralStroke1Hover}},":hover:active":{backgroundColor:Wb.L.colorNeutralBackground3Selected,"& rect":{fill:Wb.L.colorNeutralStroke1Hover}},"& rect":{fill:"transparent"}}),menuItemSelected:(0,F.__assign)((0,F.__assign)({},BQ),{":hover":{backgroundColor:Wb.L.colorNeutralBackground3Hover},":hover:active":{backgroundColor:Wb.L.colorNeutralBackground3Selected},"& rect":{fill:Wb.L.colorBrandForeground1}}),chatHistoryButton:(0,F.__assign)((0,F.__assign)((0,F.__assign)({},MQ),{width:"calc(100% - 32px)",alignSelf:"flex-end"}),Xa.Pt.padding("0px")),errorToastBody:(0,F.__assign)({alignItems:"start"},Xa.Pt.gap("5px")),errorToastIcon:(0,F.__assign)({},Xa.Pt.padding("5px")),errorToastText:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("5px","0px")),{width:"200px",fontWeight:"600",fontSize:"300"}),errorToastMount:{position:"fixed",top:"90vh",height:"0px",width:"100%"}},zQ=(0,Za.n)(HQ),qQ=(0,Za.n)((0,F.__assign)((0,F.__assign)({},HQ),GQ));const WQ="fui-DrawerHeader",jQ=(0,Js.y)("r3ovn4i",null,[".r3ovn4i{width:100%;max-width:100%;padding:var(--spacingVerticalXXL) var(--spacingHorizontalXXL) var(--spacingVerticalS);gap:var(--spacingHorizontalS);align-self:stretch;display:flex;flex-direction:column;box-sizing:border-box;position:relative;z-index:2;}"]),VQ=(0,Ks.X)({separator:{Dlnsje:"fxnjyrl",E3zdtr:"f1mdlcz9",B1piin3:["f15yvnhg","f1n6gb5g"],Eqx8gd:["f1n6gb5g","f15yvnhg"],Bp15pi3:"f1564nw5",Bjyk6c5:"fdlpgxj",F2fol1:"f15cmg8x",Ba2ppi3:"f3f8dgl",B1dyfl9:"fjvo4va",Bsft5z2:"f13zj6fq",By385i5:"fo72kxq"},separatorVisible:{Bp15pi3:"fjsqi2x"}},{d:[".fxnjyrl::after{height:1px;}",".f1mdlcz9::after{position:absolute;}",".f15yvnhg::after{right:0;}",".f1n6gb5g::after{left:0;}",".f1564nw5::after{opacity:0;}",".fdlpgxj::after{background-color:var(--colorNeutralStroke1);}",".f15cmg8x::after{transition-duration:var(--durationNormal);}",".f3f8dgl::after{transition-property:opacity;}",".fjvo4va::after{transition-timing-function:var(--curveEasyEase);}",'.f13zj6fq::after{content:"";}',".fo72kxq::after{bottom:0;}",".fjsqi2x::after{opacity:1;}"]}),QQ=a.forwardRef(((e,t)=>{const n=((e,t)=>{const{scrollState:n}=mV();return{components:{root:"header"},root:qs.Gk((0,Ws.g)("header",{ref:t,role:"none",...e}),{elementType:"header"}),scrollState:n}})(e,t);return(e=>{const t=jQ(),n=VQ();e.root.className=(0,Ms.z)(WQ,t,"none"!==e.scrollState&&n.separator,["middle","bottom"].includes(e.scrollState)&&n.separatorVisible,e.root.className)})(n),(0,il.$e)("useDrawerHeaderStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.Y)(e.root,{})))(n)}));QQ.displayName="DrawerHeader";const JQ="fui-DrawerHeaderNavigation",KQ=(0,Js.y)("r1ig4pwh",null,[".r1ig4pwh{margin:calc(var(--spacingVerticalS) * -1) calc(var(--spacingHorizontalL) * -1);}"]),XQ=a.forwardRef(((e,t)=>{const n=((e,t)=>({components:{root:"nav"},root:qs.Gk((0,Ws.g)("nav",{ref:t,...e}),{elementType:"nav"})}))(e,t);return(e=>{const t=KQ();e.root.className=(0,Ms.z)(JQ,t,e.root.className)})(n),(0,il.$e)("useDrawerHeaderNavigationStyles_unstable")(n),(e=>((0,Us.C)(e),(0,Bs.Y)(e.root,{})))(n)}));XQ.displayName="DrawerHeaderNavigation";var ZQ=n(52317),YQ=n(98571),$Q=n(98032),eJ=n(7240),tJ=n(5202),nJ=n(78165),rJ=n(99666),oJ=n(83929),iJ=n(31833),aJ=n(40695),sJ=n(13413),lJ={toolbar:(0,F.__assign)({justifyContent:"space-between"},Xa.Pt.padding("8px","6px","8px","6px")),switcherButton:(0,F.__assign)({alignItems:"center",width:"32px",cursor:"initial",height:"32px"},Xa.Pt.padding("8px","6px","8px","6px")),switcherButtonToggled:{fontSize:"20px",backgroundColor:Wb.L.colorNeutralBackground1Selected,"&:hover":{backgroundColor:Wb.L.colorNeutralBackground2Selected}},drawerHeader:(0,F.__assign)({},Xa.Pt.padding("0px")),drawer:(0,F.__assign)((0,F.__assign)({width:"-webkit-fill-available",justifyContent:"space-between",display:"flex"},Xa.Pt.padding("13px","6px","8px","6px")),Xa.Pt.margin("0px")),drawerToolbar:(0,F.__assign)({},Xa.Pt.padding("0px")),label:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("3px","3px","3px","4px")),{fontSize:"14px",lineHeight:"20px",alignSelf:"center",color:Wb.L.colorNeutralForeground1}),labelIcon:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("0px","0px","0px","4px")),{maxWidth:"20px",maxHeight:"20px",alignSelf:"center"}),toolbarButton:{fontSize:"20px",cursor:"initial"},toolbarGroup:{display:"flex"},toolbarButtonsGroup:{display:"flex"},creditButton:{height:"26px",alignSelf:"center",fontWeight:Wb.L.fontWeightRegular,whiteSpace:"nowrap"},creditTooltip:{maxWidth:"60%"},creditTitle:{marginBottom:"5px"}},cJ={toolbar:(0,F.__assign)({justifyContent:"space-between"},Xa.Pt.padding("0px","0px","8px","0px")),drawer:(0,F.__assign)((0,F.__assign)({justifyContent:"space-between",display:"flex"},Xa.Pt.padding("5px","0px","8px","0px")),Xa.Pt.margin("0px")),switcherButton:(0,F.__assign)((0,F.__assign)({alignItems:"center",width:"32px",cursor:"initial",height:"32px"},Xa.Pt.padding("8px","6px","8px","6px")),{"&:hover":(0,F.__assign)({},Xa.Pt.borderColor(Wb.L.colorNeutralStroke1))}),switcherButtonToggled:{fontSize:"20px",backgroundColor:Wb.L.colorNeutralBackground1Selected,"&:hover":(0,F.__assign)((0,F.__assign)({},Xa.Pt.borderColor(Wb.L.colorNeutralStroke1)),{backgroundColor:Wb.L.colorNeutralBackground2Selected})},label:(0,F.__assign)((0,F.__assign)({},Xa.Pt.padding("3px","3px","3px","4px")),{fontSize:"16px",lineHeight:"20px",alignSelf:"center",fontWeight:Wb.L.fontWeightSemibold,color:Wb.L.colorNeutralForeground1}),toolbarButtonsGroup:{display:"flex",gap:"8px"},toolbarButton:(0,F.__assign)((0,F.__assign)({fontSize:"20px",maxWidth:"24px",minWidth:"24px",maxHeight:"24px",borderRadius:"4px",cursor:"initial"},Xa.Pt.padding("2px")),{"&:hover":(0,F.__assign)((0,F.__assign)({},Xa.Pt.borderColor(Wb.L.colorNeutralStroke1)),{backgroundColor:Wb.L.colorNeutralBackground1Hover,"> span > svg":{color:Wb.L.colorNeutralForeground2}})})},uJ=(0,Za.n)(lJ),dJ=(0,Za.n)((0,F.__assign)((0,F.__assign)({},lJ),cJ)),pJ=n(55089),gJ="CopilotSwitcherMenuID",mJ=function(){var e=(0,pJ.dJ)();return e||"Close"},fJ=function(e,t){switch(e){case"close":return a.createElement(cg.LMj,null);case"help":return a.createElement(nE.XLu,null);case"expandOrCollapse":return t?a.createElement(Tw.rCp,null):a.createElement(Tw.lA0,null);default:return null}},hJ=a.memo((function(e){var t,n,r,o=e.copilotList,i=e.isMenuOpen,s=e.onMenuStateChange,l=e.isDrawer,c=e.closeButton,u=e.closeButtonStyle,d=e.headerMenuButtonProps,p=e.afterFirstRender,g=e.showCreditButton,m=e.appPlatform,f=e.appName,h=o.find((function(e){return e.isSelected})),v=null==h?void 0:h.name,y=null==h?void 0:h.menuIcon,C=null==h?void 0:h.menuIconUrl,S=null==h?void 0:h.iconAltText,b=(0,sJ.CJ)(),E=(0,pJ.X_)()||"Credit balance",T=(0,pJ.fk)()||"Track credit usage",I=(0,pJ.Zz)()||"Credits refill at the start of each month.",_=uJ(),w=dJ(),P="PC"===m?w:_,x=(0,Ms.z)(P.toolbarButton,u),k=a.useRef(null),A=a.useRef(null),L="".concat("https://go.microsoft.com/fwlink/?linkid=2281345&ref=").concat(f,"#credits");a.useEffect((function(){null==p||p()}),[]),a.useEffect((function(){window.requestAnimationFrame((function(){var e,t;i?null===(e=A.current)||void 0===e||e.focus():null===(t=k.current)||void 0===t||t.focus()}))}),[i]);var D=(0,pJ.IG)()||"Task Pane Options",O=mJ(),N=mJ(),R=(0,pJ.Kw)()||"Collapse",F=(0,pJ.T5)()||"Expand",M=(0,pJ.e)()||"Help",B=(0,pJ.oC)()||"Move",U=(0,pJ.tW)()||"Resize";return l?a.createElement(QQ,{className:P.drawerHeader},a.createElement(XQ,{className:P.drawer},a.createElement(ZQ.M,{size:"large","aria-label":b,className:P.drawerToolbar},a.createElement(YQ.$,{role:"presentation",className:P.toolbarGroup},a.createElement(xj.m,{withArrow:!0,positioning:"below",content:b,relationship:"label"},a.createElement(kj.I,{className:P.switcherButtonToggled,icon:a.createElement(jj.hO5,null),"aria-checked":!0,ref:A,onClick:function(e){return s(e,{open:!i})}})))),g&&a.createElement($Q.A,{openOnHover:!0,size:"small",positioning:"below-end"},a.createElement(eJ.W,{disableButtonEnhancement:!0},a.createElement(Lb.$,{appearance:"outline",size:"small",icon:a.createElement(ug.jvx,null),className:P.creditButton,onClick:function(){window.open(L,"_blank")},"aria-label":E},E)),a.createElement(tJ.H,{tabIndex:-1,className:P.creditTooltip,"aria-label":"".concat(T," ").concat(I)},a.createElement("div",{className:P.creditTitle},a.createElement(nJ.E,{weight:"semibold"},T)),a.createElement("div",null,a.createElement(nJ.E,null,I)))))):a.createElement(ZQ.M,{"aria-label":b,className:P.toolbar},a.createElement(YQ.$,{role:"presentation",className:P.toolbarGroup},a.createElement(xj.m,{withArrow:!0,positioning:"below",content:b,relationship:"label"},a.createElement(kj.I,{id:gJ,className:P.switcherButton,icon:a.createElement(jj.hO5,null),ref:k,onClick:function(e){return s(e,{open:!i})}})),a.createElement("div",{className:P.labelIcon},C?a.createElement(RQ.Z,{iconUrl:C,iconAltText:S}):y),v&&a.createElement(rJ.J,{weight:"semibold",className:P.label},v)),a.createElement(YQ.$,{role:"presentation",className:P.toolbarGroup},a.createElement(_j.W,{horizontal:!0,style:P.toolbarButtonsGroup},d&&d.buttons&&a.createElement(oJ.W,{positioning:"below"},a.createElement(iJ.c,null,a.createElement(xj.m,{withArrow:!0,positioning:"below",content:D,relationship:"label"},a.createElement(kj.I,{"data-unique-id":"TaskPaneOptionsBtnShared","aria-label":D,className:P.toolbarButton,icon:a.createElement(lg.geq,null)}))),a.createElement(aJ.b,{className:null==d?void 0:d.menuStyle},a.createElement(QV.c,null,d.buttons.map((function(e){var t,n,r;return a.createElement(Pj.D,{key:e.type,className:null==d?void 0:d.menuItemStyle,onClick:e.clickHandler,icon:null!==(n=null!==(t=e.icon)&&void 0!==t?t:fJ(e.type))&&void 0!==n?n:a.createElement("div",{style:{marginInlineStart:"20px"}})},null!==(r=e.label)&&void 0!==r?r:function(e,t){switch(e){case oU.Close:return N;case oU.ExpandOrCollapse:return t?R:F;case oU.Help:return M;case oU.Move:return B;case oU.Resize:return U;default:return""}}(e.type))}))))),a.createElement(xj.m,{key:c.type,withArrow:!0,positioning:"below",content:null!==(t=c.label)&&void 0!==t?t:O,relationship:"label"},a.createElement(kj.I,{"aria-label":null!==(n=c.label)&&void 0!==n?n:O,className:x,icon:null!==(r=c.icon)&&void 0!==r?r:fJ(oU.Close),onClick:c.clickHandler,"data-unique-id":"TaskPaneCloseBtnShared"})))))})),vJ={src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAADAFBMVEVHcEw2MzMMFBcREA8FBAQBBQgaGhoFBggRFR0jISEFBANBQ0QNDQwIBwwlJSUPDg4IBgcLCgoODQxeYGhSU1M2NjNDQT4FM29ccXU2SlkVUmpSVVgHRE9ycW+acc6xfG6DkY2EVlGyhNxBQkZDQkXbnGtBP0WncWxNMDLTh1XNRhWOiYc2PEvsrXVLUoAwR3dWUGHncbDBLwrvnFc6ODtQZ4VHS2HNisbjfKvGZDszNEvgJyXxtoBeYGy8h6/KVi6ha8b0mUibcsr5tnsAAACnPhkAJ5n/8aj/86j/8Kj/8an/76j/86n/9qkbGx0AAAH/8Kn/w4ciISQeHiH/woUYGRr/xYslJSctKy0wLjIpKCo1MjV8Va8fHzaBWLL/xImKXrc5Njg9Oj3/x4X/yoooJzlDP0KFW7V3UaxQTVH//7azR3ZIRUj/6ZBwTajKm+z/7Xr/+7LiuPj/4pT/AADcsPTqx/3/64j/76nnv/r/w4z/zoAoKTHBkuTVixpqRqEZHSv/8bD/7YL/zpH20/8yMDzMOyHXqfL/5566iuH6hrBbWFz/yY7/4f/xzv/hlQD/vYRjYWb/7HKpe9beigD/1YqgPnP92v/RW5IiIi+Ua8bye6n/0prSou7/3pH/un3/+IbDUob/2o6wksEuPGXcZZrocKHRhSoLGQDQfBn/xojNbQf/7pf/pGEpMUb/9nmMY73/kVD/96/+chyuRoT7XAYzL6/DTxRgQpyTZcD9kbpaR63/4X7JbiByaW/9mcr/sW//9ZX/vnfTPACidM/HXgr/62b/8KHWfACtgNskMFb/2HPCChT/sGNGNrRKPJr/x273ux/ooABWS2u1c2H/2KTnQgsIHaTpDADVAAD2xP6eS5aJZoz/hTeHO3v+yluTf67+qdyCT6L1pTX/PwD/xp6lb3i2PFJybI13ZLD8yEj7JQDMrd2Fj+j+zLGpAQDoqtO5bsPXfrjHg0JWd9z4lgH7g2/87b28aD/ebADuAGi0cJGPSgD/AAsACwFHcEwnoIJ4AAABAHRSTlMAKAchFgsqAQQmESgfDigoGRwkJigkIRgOEh8rJxr+VyM0/t+MmcZCYHuGMP/Invs+8WPC7vy4pb5S8/vdU33GyNyP+uXmp/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A4zYaCgAAEalJREFUeNrsmF9IW3kWx6/RmGiMjY2tJmZqXRDHFped9mG3tGw7O+ze3JsEbiDkaSEPubBDisVLBIMBRQOShYDBjVJ2g7FCK0aDa1KNMHXRFP8MVqoFrWXG+mCdWVpoH8rM7OzTnnPu1fb5amdfesz/2H4/53vO+f1+V4b5GB/jY3yMj3GM0Cnxf1HWQ2iUwNe/HAeKazRardFYfhRGo1YLHL8EBGSu0YJ0iclUBVEBgc8mUwlgaMEL3YdNHtTLS0pMIFxcXPZeFBcDiKmkpFyLPnyw5CF3FCftysqi96KyUqaoMpEPug8kD8ZXkDhIGgyGaoo6uMMbxECICpNsw4nro3wVypM46NbVmY+iDqMaKRChChF0J5w+mF9VcRp9J3Gz1WqteRfwTsYABigGIBi1J2kCpm8ieczdbK2xWCzWhvr65kaK5ub6BhtiyAxoQ4XpJE3QayD94jKSB/Vao7m+seWLVNzjhxBFeIinvmhprK9TGNCFYjBBoz8p+yH9MjLfarVozc0tqTjoen0+r8/t8+Hd7U6LaU+qpbkBGRBBNuEkykD6lH41JK9tupzy+NNuj88LAKjs9njcGPBGFNPxlnpCIBNOhAD1wX5Kv1ZTfznlF1HNLWfvRvuBwCNTeNw+0XMNEWAkiqAMQHDs+qN+ZaXBYK3RN4B8GpN2d0K2ETESiaQLHqgGtgEwdMaBwJf2tDRZZBNOgEBH+tB9kH7zQsqDpvt8na+TEX9qYXo3NwOR253OLBTESMwTP+iE70Ux3ogmKB7ojjd/UH/S15shfQ+FOxLxLuy++G/7+/EqlymI4kEn/oJPTF9rsFjJA1P5caZRpzdi/xsMNUxTxpOm/9wTixSmX7S3v/gxNRjlnNks74hGUvhJOzCADdgOnnS83kgeVJiMx2hEvbYE5w/0r6z7X/uw4cVYYbe9fSYVlQIQkiRlsxK+lKKpHHyeEUXqSbcYr9daDUhQor4NoADUAFamad3v7sTUksnMq/bpKChmXU6WZTmW41jWbncBhJScBhcKET+NpUxAjai6CGgA6uvNGb887H5vjuSzLtRl7SzncHAQ8MzZs1IgCggZMebBORXj0AdAoN4CNOB0ZZHNov+cms/nfX0w80JEeZ4lYWBwHAXHu7KBwCAYJMZ8B6/Bg2s1NQZDZZlqC8CAYmqACwXs/3Q6cjCTYwMSD7ZzsijL0osQfsBxPAuV4MEjrAL+i0YNFUGlBbIBBpu+ej3sp20nkpuWAk7eaecVYQd7+ILqwHMO1hWQptvXY26a13iTxabeAh2OABpwGfTDsN5t7e9KUojjnU6nnZWlZRK4CTzo82iEPRDYbS/EaIc6aNFb5UHQqaoArkE2zSfrg+GwGA5HPD/0BIQQFN5plwHAdB4BQsAgwGvC4eyB7ItcLOb1ut2xWIOFViNVNdAbsQJWptk/CPJhMbkfDLggU57lUZ51UBMqJXCEBBY+Bx84qMJo+0IMtyxvslFnxRoY9apaABfBGubzQYzwoH8j4IIsnSDjVBhwDllWYAUgEAQWLcDvpMB0DmsAANeoBqqaQKfBRcCmNa4HRwlhIyRh+Z1kNfqvOMDBKIZCHLUkfQ8WDM+kcOHwRjrPWmgpUANAQ2jTN2wER5FgNJzlFQCBEEAX+95BIynQKCgAnCT9mMJDgzcWa9LaaBBVAzBXwgAABKNBSeBJnsNyYwCIvAyEHILsCG9n8XtXIJMR8cjkjV3RqwegIWAuhaPDQDA6HM2GsNN5GD5sfjCfh97nBJQXCIDWBRaHM1DI4IHN1xlpZmAlgDE4HsAwAbhgBlGSMIABbgKYwIdCoI+DSLWAXwGAMAJ4fV7xOAAl7wAgglEXZMthAUgbbyyHvU8FoMUQHwQohCtQWAB1iNgF5rg9cGkvGgwiQRTUBGwBuQNYZT3g2ZDcABy1Ic2GU1pP0ak5GT8WAI4h8+n+ChAEwQE7GU41ONQmMwRlL0ADaD6FLJtxY/6+rQUCULUWywsRAPzcigBAsCKgBYIQEuQewCWAAMh6bD/wgsV9MTC67sMLB+/WLgKUVahbiHAzrGQ+fbO2AvqtwdZoz+Hw0TgetSI0QciB2wI2IgDwWdd6HAG8yeSrSzqbypUQ9gLT6dJSfcOb/cko6gdbV4CAE4R30qy8MgmKA8oC6ZLCC9gAXu9WZueKxgZDoGYvoC48VVpuebO0ttIK8goBlCFE+bOyC/LaxCqBW7IUXKcJAANmdswWW1mxuu0Ym+B0aRXzxzf7i0BAAQTYCHAgcLJ2ZVtQGlNmQP3oQpz0I1vTO1c1NerPZFiDU6XMhXx+b3GS9DuAgFqA8gYLWPkdr0wB3JxH+t6twqudC4xVbQXkQTxVqm3I5yfWiKCjo7cDPHAqeyJ/aAD6Lu+QfFYaPtRPxmZ2tptqbWVVJSovz2gOSiuY60v5xIDsASBM8j1OpfQ0hO+HS2LDoE8TmIzknl29rq85pf7CAC5MwYFSpmF+XibowOhFBCiE8zB9wSHPhZCVnMOFOG0BPvdWLPdsZ7u+1lp2RvUFqtwDZVrmwsT8UmJtcVEm6GjrneR6epRFAfZC3IyEnmzPyvDGBun7fGLSPfPs6vZ163lzdZHaHsApOFVaeUbP/Ok/q/NLq3sji+QAeNAGDCvgw7sIRYNrGxsb4TT93SKZXNgG/b4b5y9erDYc41gO60DZWcb89PHq6tj8xP7AyGIvEbT1DkC0dbROQrROtsLbtY21NTi6+rx4/ShO7zzq295+/k292Ww2qD6WUwXOGJlfP376LyRYSuwhAkUbxMDy8jLelzsGlh9gAIDb44/EMjPPHvX1bQ89v/+782Zzndoa6MursAIMM/cYCBKJMTChHxFGjgjgBve2jrY2Alhb80eSaZR/1Pfw4dDzoft3L2ITQA30alug6Czzm24keJ7oB4L5icTL4MjIyNRUmxJEAAxbg70PHnQMpqZJXtG/f/v3FjM0gbrdkFqgqJz5w625ubnHT+fe9q+OoQurT14uT40QxeJPU6A/BT+tPy2OPFjby+2QfN/DPvAf4vZvawlA5YEENkNogRtfzhHB7HdgQlfX2DgybL5cXh6ZQgi8T40MLO9t/vDzw0ey/MPvh4Zu3r9z587tz2qt0IWqj2TQAlrm3F+6u7vnoA5P//22v78LYnwcarGaePJkc3Pz5Ut42HySWJ1Yyi/l+zBQfgjkb99GgE+qVQPAcQAB/vb3boq5x7Oz34719ye6ZAigyC8tTSxNTEwswfPE+MR4HrPvQ/2bqA+hAJjUA2iYr8/9ufsWANzqnvvq6ey3b/ufKAxd4315fOzK9+XHx8cAKQ/mo/s3Uf8uxj9qa6qPcSwnB3719T9BnaL71lezs93fIQM5MT4uc4x3wZQmEqt5Sh4D9O/du3f33mcaAlDbA7AOlTM3/nruy/+1bzahTWVRHL9JtR9o4xhtTEbaqU2IBYt14ReCLgbXCSSEfEsTeGmCxUAhgcALZpEQ2tJIiBCaklUz0lXIooix0G6ymGbhwrrSMtQuxEIL6rgYGBjmnHPfS6uze6/OwOC/5qN94O93z73v9eb23WcPZIMHz16Aw9Yr6IuXjx+9/P3xI57Hv/7x6r5El/lPnizeZOfgOqBCQHOM/RzfqAA7ipE8wOHp6sOtd+9eUd6929pZXX3428r9lQP+IuTJ4g3241kV03IQOMkuxtOlZnQnGg0EAtFAVMqD1dUXL148xcdTeF6FvHmzsvIFf3Fx9ieGy+Ynlc2KcTqi62IsXp1pNQM7gcD7gJzd3SgKRemFCoNOO6DAxx/wZ2dn4WHUwhDQK7oUS9Pyvn52Ix+faTUQGwjcC9y7B8+7u4FDIRl42dl59kZu/yzlJjOd1aiblmu62HAVDEoVAAP9i6AQhR8LPFh9s0L82dnnz5+DwCX8bKw7qXhajn2gP85uJNBgqDF5b3JycgIewObPUuAA+UQnmh9/kfkQKMCABntA4bT8+A+8BMbEdD6eHhmqTExM8q/JiQn5idD4At83KkMfP36S+Ovr68NMzUopTct5Ce6kUvlqeqbUqjSQKmWS+Pggl2azUhkqjcyk159/WKfcwRGgeJ2SrxWf0p0408vubheSWISZjdZQs9HgFg1JAt82tgHeInw8Xv2AAm/f/nl3eFj6ZaxirVhzdpBZ7PYlNKiCwkipNVSpNJvNxmQDA2+o6UBHfDpezScSibeQT3b75eFLfEKkeK1YhwUY9Czb7elsMpXI5z/vp0c2SiDRGmrsAhfRrVapVNogOuDzienp6dTr18B3tS/SrFjVWjEU4LLgAIOlbDY5Pb2/X02nZ2ZGNkDjcwmzsTEyMjLD6dU4xycL2SW7PRMUeAmUrhVTDxiMPbcEhxMMtgvlwuvpfAJ6Ih5Pg8Y+YAFMQTo0HvCpVDKZLWxD+4PB4K1hPilVulas150wsAs+t8Npc9ntsUS5XEimphPQFflqFT2k7FHPY9shyWw5scn5QeH2oOJBQKtkuhMwBH2iGwTAAIZiOVtIpYAEFqiBSeCoAzzBofjlApQf6k+xGIdVTEpRwMSswjiVwLVMCvPlbDKZTKEGmQBYYhO9jL1vX85wgfZ147CaSalON2BkZo/YFp2ZoIuKYF9Kzs/PlwuF5EFSxAb6fDmJeHsmk1ngFRhXI0BzQiO76vPVRYfT6XJJCu/3CvMoUc5mswX6ykLL0WrvPR63ZZwoIKDALePgGXWTUhDweHw0Dm1BuQr2zaW9Qnn+IOVycm9pkw7ZbE4swGEB5YvVsoAHBZy2TNCGVcjYeTa3tpco21ub0o+WXcB3ZhzIF9DglpYEFM8JUcDq7RhgqCdoQFL+kt8A3AV4ib+AfKFdtzIVH0xoVmxiFi+EGxxWcLmCtuXMMg/WJYh44DuALwqYYL12GQTUTUoN7LZfNugogAT8y8gq0vcAd3K+JCAI9dsML0TK14q7dQbWG/L7/QcGTmylzZYhqPREcQbbiHe4F0QI4ts1z6D2jOI/ndKklAaBHw1oHDjIIZixfR1qewb4brcP8LUar4GVGVVPSg3sSggyVhvziDVRUnAe1MIpBw8hHwS89bpXyEEPXGGDJxT+vaKzSmboZeZQKDxeG/N6a6LopjI4JIeFYAeNcDhMfG/OmxNAwcyMBjWTUlql0pxjZ8PhcGQshN0gwjWJHBYWHM52W2YT3u2o1Xyix5PLgWo9B7lABdCrWyvGT+gWEIiEQ3wkkIJbEBwOUZTRYtvNiw+XDE+t5s9RLLwAiielPVIJDIyZI5AwKHhRQeB1OEhdFHwYxMMpi4M2lxszM2aAjyV65ffRyCUwsd7IFCQyhW3zetp1pIk+KfVxUYIjXcLncuNG/rFEcQH4KOjiBqapTVSYCo+N4XUJYfW2LFDzyPScnxLyw7AdRH638r8WdC5Gp+hiYLoWi83FYrEpPhYg9XGPFB+1nPNDFH/o6iAOgO5T+tOqbqXCG3nQwGBkzBqbg1wjBX5x/CLU8k6svcTv1p8+pup2tp5eGgbUC8wSmysWi1IZwiGykMOxYUotHLYwZiI+fipSeTdbP14PucF581xxDRSKoDCFZwVpAFciyzGfZ9T/yO9Xe2cpN8BxYNAyNjpVXFt7v1acozpsXov8M+HIKGNaw4DuaPjcAMdBdx8WgY2a59YgUAeSwFpIiUwh/yrg6fSD8Xck/EMGUARU6LbGikVyAIniNW5BHpHI9SuIp+bD+D8aPh+JcDZKCvhfXrGYYzgW0KBTB/NlpPfI+K7Tx47s3mZ+Yy8WARXwlOxhPedHLdetZrw2mK3XLaPniWU0EB7Lf0Q39crXA7q1mSv0gYNJyw72duALPLQmoGuw9dT8o7qt+VARSEFyAAmDyWTE3R1ardEEbMPAQB81nvBH2nypmdpDCiCh69MMdKLp0yEc6FB8fnP90W8x6GwwAAcu8VWQ/s22F3QU+rmDHi0kEf4OfnQS6f3fDM87gjvwXSZ6OZ0dJv3fcovJIQct7fE5Bh4UeEM7fbTfni474GYf7fFDwdPhX95yxTd5SXus/pPtXt/zPd/zPf+X/A2C0RxvbxOJzQAAAABJRU5ErkJggg==",alt:"Credits teaching UI",style:{justifyContent:"center"}},yJ=function(e){var t=e.isMenuOpen,n=e.onMenuStateChange,r=e.handleCopilotChatChange,o=e.copilotList,i=e.showLoadingShimmer,s=e.paneSilhouetteHeaderProps,l=e.switcherMenuChatHistoryProps,c=e.featureFlags,u=e.appPlatform,d=e.menuErrorProps,p=e.appName,g=zQ(),m=qQ(),f="PC"===u?m:g,h=(0,wj.P)(),v=(0,F.__read)(a.useState(!1),2),y=v[0],C=v[1],S=(0,F.__read)(a.useState(!1),2),b=S[0],E=S[1],T=a.useMemo((function(){return o.filter((function(e){return!e.isLink}))}),[o]),I=a.useMemo((function(){return o.filter((function(e){return e.isLink}))}),[o]),_=T,w=T.length>5;w&&!y&&(_=T.slice(0,5)),(null==d?void 0:d.unloadedCopilotTypes.length)>0&&(_=_.filter((function(e){return!(null==d?void 0:d.unloadedCopilotTypes.includes(e.copilotType))})));var P=(0,pJ.NZ)()||"See Less",x=(0,pJ.XS)()||"See More",k=y?a.createElement(lg.nbk,null):a.createElement(lg.geq,null),A=l&&l.isSwitcherMenuChatHistoryPanelOpen&&l.chatHistoryContainer,L=(0,pJ.U7)()||"Tips",D=(0,pJ.hV)()||"Got it",O=(0,pJ.vT)()||"Your Microsoft 365 subscription includes credits that you can use to unlock Copilot experiences and more. Track your usage here.",N=(0,pJ.rM)()||"View your credit balance",R=(0,IQ.WV)(),M=a.useRef(null),B=window.innerWidth?window.innerWidth:628,U=function(e){var t=!e.isLink;return a.createElement(Pj.D,{key:e.id,onClick:function(t){r(e.id),n(t,{open:!1,type:"menuItemClick"})},"aria-label":e.name,className:e.isSelected?f.menuItemSelected:f.menuItem},a.createElement(_j.W,{horizontal:!0,style:f.menuItemParts},a.createElement(wQ.l,null,a.createElement(_j.W,{horizontal:!0},!t&&a.createElement("div",{style:{marginLeft:"3px",color:"transparent"}}),t&&a.createElement(wQ.l,{style:f.itemSelector},a.createElement("svg",{width:"3",height:"20",viewBox:"0 0 3 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("rect",{width:"3",height:"16",rx:"1.5"}))),a.createElement(wQ.l,{style:f.menuItemIcon},e.menuIconUrl?a.createElement(RQ.Z,{iconUrl:e.menuIconUrl,iconAltText:e.iconAltText}):e.menuIcon?e.menuIcon:a.createElement("div",{style:{width:"20px"}})),a.createElement(wQ.l,{style:e.isSelected?f.menuItemLabelSelected:f.menuItemLabel},e.name))),a.createElement(wQ.l,{style:f.actionButtonContainer},e.isSelected&&(null==l?void 0:l.newConversationClickHandler)&&a.createElement(xj.m,{withArrow:!0,positioning:"below",content:R,relationship:"label"},a.createElement(kj.I,{className:f.actionButton,icon:a.createElement(lg.svB,null),onClick:function(){return l.newConversationClickHandler({eventName:"Switcher_Menu_Change_Topic_Button_Clicked",gptId:e.id,shouldSetLoadingUIStates:!0})},"aria-label":e.name+","+R})))))},H=(0,Bl.Bi)("toaster"),G=Uj(H).dispatchToast;return a.useEffect((function(){(null==d?void 0:d.showErrorMessage)&&!i&&G(a.createElement(Wj,null,a.createElement(aV,{action:a.createElement(uV,null,a.createElement(Lb.$,{appearance:"subtle",size:"small",icon:a.createElement(cg.Avk,null)}))},null==d?void 0:d.errorMessage)),{intent:"info",timeout:3e3,onStatusChange:function(e,t){"unmounted"===t.status&&(null==d||d.onErrorMessageDismiss())}})}),[null==d?void 0:d.showErrorMessage,i]),a.createElement(a.Fragment,null,(c.isCreditsUIEnabled||b)&&a.createElement(NQ,{headerText:L,title:N,bodyText:O,primaryButtonText:D,image:vJ,anchorId:gJ,onCloseFre:function(e){E(!1)}}),a.createElement(hJ,{isMenuOpen:t,onMenuStateChange:n,copilotList:o,isDrawer:!1,closeButton:s.closeButton,closeButtonStyle:s.closeButtonStyle,headerMenuButtonProps:s.headerMenuButtonProps,afterFirstRender:s.afterFirstRender,appPlatform:u}),a.createElement(BV,(0,F.__assign)({},h,{style:{width:"".concat(B,"px"),backgroundColor:Wb.L.colorNeutralBackground3},position:"start",open:t,onOpenChange:function(e,t){return n(e,{open:t.open})}}),a.createElement(hJ,{isMenuOpen:t,onMenuStateChange:n,copilotList:o,isDrawer:!0,closeButton:s.closeButton,closeButtonStyle:s.closeButtonStyle,headerMenuButtonProps:s.headerMenuButtonProps,showCreditButton:s.showCreditButton,appPlatform:u,appName:p}),a.createElement(VV,{className:f.drawerBody},i?a.createElement(FQ.Y,null):A?l.chatHistoryContainer({onPaneClose:l.handleChatHistoryPanelClose}):a.createElement("div",{className:(0,Ms.z)(f.menuContainer)},a.createElement(QV.c,{style:{width:"100%"}},_.map((function(e){return a.createElement(a.Fragment,{key:e.id},U(e))})),w&&a.createElement(Pj.D,{key:y?P:x,icon:k,onClick:function(){C(!y),window.requestAnimationFrame((function(){var e;return null===(e=M.current)||void 0===e?void 0:e.focus()}))},ref:M,"aria-label":y?P:x,className:f.menuItemSeeMore},y?P:x),I.map((function(e){return a.createElement(a.Fragment,{key:e.id},U(e))}))),a.createElement(_j.W,null,l&&a.createElement("div",{className:(0,Ms.z)(f.chatHistoryButton)},a.createElement(_Q.r,{onClick:function(){l.onClickShowChatHistoryPanel(),l.setIsSwitcherMenuChatHistoryPanelOpen(!0)}})),a.createElement("div",{style:{position:"relative"}},a.createElement(TQ,{inline:!0,toasterId:H,position:"bottom"})))))))};var CJ=n(56201),SJ=n(2970),bJ=n(6577),EJ=n(17788),TJ=(0,es.Q)(EJ.zQ),IJ={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:TJ.themeBackground},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:TJ.themeBackground},chatUiStackItemInContainer:{position:"relative",height:"100%"},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":(0,F.__assign)((0,F.__assign)({backgroundColor:TJ.colorNeutralStroke1Selected},Xa.Pt.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":(0,F.__assign)((0,F.__assign)((0,F.__assign)({backgroundColor:TJ.colorNeutralForeground3},Xa.Pt.borderRadius("20px")),Xa.Pt.border("2px","solid",TJ.colorNeutralBackground2Hover)),{":hover":{backgroundColor:TJ.colorNeutralForeground2}}),"::-webkit-scrollbar-track":(0,F.__assign)({backgroundColor:TJ.colorNeutralBackground2Hover},Xa.Pt.borderRadius("20px")),height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":(0,F.__assign)((0,F.__assign)({backgroundColor:TJ.colorNeutralStroke1Selected},Xa.Pt.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":(0,F.__assign)((0,F.__assign)((0,F.__assign)({backgroundColor:TJ.colorNeutralForeground3},Xa.Pt.borderRadius("20px")),Xa.Pt.border("2px","solid",TJ.colorNeutralBackground2Hover)),{":hover":{backgroundColor:TJ.colorNeutralForeground2}}),"::-webkit-scrollbar-track":(0,F.__assign)({backgroundColor:TJ.colorNeutralBackground2Hover},Xa.Pt.borderRadius("20px")),height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},incomingShimmerCard:(0,F.__assign)((0,F.__assign)((0,F.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},Xa.Pt.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Xa.Pt.margin("10px")),outgoingShimmerCard:(0,F.__assign)((0,F.__assign)((0,F.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},Xa.Pt.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Xa.Pt.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("8px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:TJ.colorNeutralBackground1}),outgoingShimmerCardWrapper:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("8px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.margin(0,"16px")),{height:"124px",opacity:"0.8",backgroundColor:TJ.colorNeutralBackground1}),inputBox:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("8px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.margin(0,"16px")),{height:"75px",opacity:"0.8",backgroundColor:TJ.colorNeutralBackground1,display:"flex",flexDirection:"column"}),Xa.Pt.padding("10px")),{justifyContent:"space-between"}),pills:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("5px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.padding("5px")),{height:"8px",opacity:"0.8",backgroundColor:TJ.colorNeutralBackground1,width:"60%"}),smallPills:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("5px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.padding("5px")),{height:"8px",opacity:"0.8",backgroundColor:TJ.colorNeutralBackground1,width:"50%"}),bottomContainer:(0,F.__assign)({display:"flex",flexDirection:"column"},Xa.Pt.gap("10px")),pillsContainer:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({display:"flex",flexDirection:"row",flexWrap:"wrap"},Xa.Pt.gap("10px")),{justifyContent:"end"}),Xa.Pt.margin(0,"16px")),{alignItems:"center"}),inputText:{width:"85%"},inputButton:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},_J={chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:Wb.L.colorNeutralBackground1},chatUiStackZoom:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",backgroundColor:Wb.L.colorNeutralBackground1},chatUiStackItemInContainer:{position:"relative",height:"100%"},chatFreStack:{overflowWrap:"break-word",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":(0,F.__assign)((0,F.__assign)({backgroundColor:Wb.L.colorNeutralStroke1Selected},Xa.Pt.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":(0,F.__assign)((0,F.__assign)((0,F.__assign)({backgroundColor:Wb.L.colorNeutralForeground3},Xa.Pt.borderRadius("20px")),Xa.Pt.border("2px","solid",Wb.L.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Wb.L.colorNeutralForeground2}}),"::-webkit-scrollbar-track":(0,F.__assign)({backgroundColor:Wb.L.colorNeutralBackground2Hover},Xa.Pt.borderRadius("20px")),height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},chatFreStackZoom:{overflowWrap:"break-word",marginTop:"5px",marginBottom:"5px","::-webkit-scrollbar":(0,F.__assign)((0,F.__assign)({backgroundColor:Wb.L.colorNeutralStroke1Selected},Xa.Pt.borderRadius("20px")),{width:"11px"}),"::-webkit-scrollbar-thumb":(0,F.__assign)((0,F.__assign)((0,F.__assign)({backgroundColor:Wb.L.colorNeutralForeground3},Xa.Pt.borderRadius("20px")),Xa.Pt.border("2px","solid",Wb.L.colorNeutralBackground2Hover)),{":hover":{backgroundColor:Wb.L.colorNeutralForeground2}}),"::-webkit-scrollbar-track":(0,F.__assign)({backgroundColor:Wb.L.colorNeutralBackground2Hover},Xa.Pt.borderRadius("20px")),height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},incomingShimmerCard:(0,F.__assign)((0,F.__assign)((0,F.__assign)({alignItems:"center",justifyContent:"flex-end",display:"grid",paddingBottom:"10px",position:"relative"},Xa.Pt.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Xa.Pt.margin("10px")),outgoingShimmerCard:(0,F.__assign)((0,F.__assign)((0,F.__assign)({alignItems:"center",justifyContent:"flex-start",display:"grid",paddingBottom:"10px",position:"relative"},Xa.Pt.gap("10px")),{gridTemplateColumns:"min-content 100%"}),Xa.Pt.margin("10px","20px","0px","10px")),incomingShimmerCardWrapper:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("8px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.margin("4px","16px","16px","48px")),{justifyContent:"flex-end",height:"68px",opacity:"0.6",backgroundColor:Wb.L.colorNeutralBackground1}),outgoingShimmerCardWrapper:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("8px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.margin(0,"16px")),{height:"124px",opacity:"0.8",backgroundColor:Wb.L.colorNeutralBackground1}),inputBox:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("8px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.margin(0,"16px")),{height:"75px",opacity:"0.8",backgroundColor:Wb.L.colorNeutralBackground1,display:"flex",flexDirection:"column"}),Xa.Pt.padding("10px")),{justifyContent:"space-between"}),pills:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("5px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.padding("5px")),{height:"8px",opacity:"0.8",backgroundColor:Wb.L.colorNeutralBackground1,width:"60%"}),smallPills:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({},Xa.Pt.borderRadius("5px")),Xa.Pt.border("1px","solid","rgba(230, 230, 230, 1)")),Xa.Pt.padding("5px")),{height:"8px",opacity:"0.8",backgroundColor:Wb.L.colorNeutralBackground1,width:"50%"}),bottomContainer:(0,F.__assign)({display:"flex",flexDirection:"column"},Xa.Pt.gap("10px")),pillsContainer:(0,F.__assign)((0,F.__assign)((0,F.__assign)((0,F.__assign)({display:"flex",flexDirection:"row",flexWrap:"wrap"},Xa.Pt.gap("10px")),{justifyContent:"end"}),Xa.Pt.margin(0,"16px")),{alignItems:"center"}),inputText:{width:"85%"},inputButton:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},wJ=(0,Za.n)(IJ),PJ=(0,Za.n)(_J),xJ=function(e,t){if(t)for(var n in e)e[n]=(0,Ms.z)(e[n],t[n]);return e},kJ=function(e){var t=e.className,n=wJ();return a.createElement(_j.W,{style:t},a.createElement(jb.E,null,a.createElement("div",{className:n.incomingShimmerCardWrapper},a.createElement("div",{className:n.incomingShimmerCard},a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}))),a.createElement("div",{className:n.outgoingShimmerCardWrapper},a.createElement("div",{className:n.outgoingShimmerCard},a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO}),a.createElement(Vb.H,{size:yO})))),a.createElement(jb.E,null,a.createElement("div",{className:n.bottomContainer},a.createElement("div",{className:n.pillsContainer},a.createElement("div",{className:n.smallPills},a.createElement(Vb.H,{size:8})),a.createElement("div",{className:n.pills},a.createElement(Vb.H,{size:8})),a.createElement(Vb.H,{shape:"circle",size:yO})),a.createElement("div",{className:n.inputBox},a.createElement("div",{className:n.inputText},a.createElement(Vb.H,{size:yO})),a.createElement("div",{className:n.inputButton},a.createElement(Vb.H,{size:yO,shape:"circle"}),a.createElement(Vb.H,{size:yO,shape:"circle"}))))))},AJ=n(24389),LJ=function(){return a.createElement("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{clipPath:"url(#clip0_4437_102859)"},a.createElement("path",{d:"M43.2727 4H20.6421C16.8051 4 14.2003 7.90009 15.67 11.4445L27.445 39.8402C29.1305 43.905 34.8911 43.8971 36.5656 39.8277L48.2505 11.4309C49.7082 7.88834 47.1035 4 43.2727 4Z",fill:"url(#paint0_radial_4437_102859)"}),a.createElement("circle",{cx:"32",cy:"36",r:"22",fill:"url(#paint1_radial_4437_102859)"}),a.createElement("circle",{cx:"32",cy:"36",r:"22",fill:"url(#paint2_radial_4437_102859)",fillOpacity:"0.5"}),a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M45.7494 18.8244L37.0286 40.0181C35.1844 44.4998 28.84 44.5085 26.9837 40.0318L18.2051 18.8619C18.3398 18.7533 18.4759 18.6462 18.6132 18.5407L27.4455 39.8403C29.1311 43.9051 34.8917 43.8972 36.5662 39.8278L45.3404 18.5044C45.4781 18.6095 45.6144 18.7162 45.7494 18.8244Z",fill:"url(#paint3_linear_4437_102859)"}),a.createElement("path",{d:"M45.3348 18.5059C41.6592 15.6919 36.9872 14 32.0006 14C26.9787 14 22.3036 15.6917 18.6152 18.5419L27.4252 39.8402C29.1108 43.905 34.8714 43.8971 36.5459 39.8278L45.3348 18.5059Z",fill:"url(#paint4_radial_4437_102859)"}),a.createElement("path",{d:"M38.2732 17.9193C38.4165 17.9308 38.5419 17.8239 38.5534 17.6806C38.5649 17.5374 38.458 17.4119 38.3147 17.4004C38.1714 17.389 38.046 17.4958 38.0345 17.6391C38.023 17.7824 38.1299 17.9079 38.2732 17.9193Z",fill:"url(#paint5_linear_4437_102859)"}),a.createElement("path",{d:"M24.401 19.4206C24.5443 19.4321 24.6697 19.3252 24.6812 19.1819C24.6927 19.0386 24.5858 18.9131 24.4425 18.9017C24.2992 18.8902 24.1737 18.9971 24.1623 19.1404C24.1508 19.2837 24.2577 19.4091 24.401 19.4206Z",fill:"url(#paint6_linear_4437_102859)"}),a.createElement("path",{d:"M40.2277 22.8628C40.2086 23.1017 39.9995 23.2798 39.7607 23.2607C39.5219 23.2416 39.3437 23.0325 39.3629 22.7936C39.382 22.5548 39.5911 22.3767 39.8299 22.3958C40.0687 22.4149 40.2468 22.624 40.2277 22.8628Z",fill:"url(#paint7_linear_4437_102859)"}),a.createElement("path",{d:"M24.6881 23.4473C24.8791 23.4626 25.0464 23.3201 25.0617 23.1291C25.077 22.938 24.9345 22.7707 24.7434 22.7555C24.5524 22.7402 24.3851 22.8827 24.3698 23.0737C24.3545 23.2648 24.497 23.4321 24.6881 23.4473Z",fill:"url(#paint8_linear_4437_102859)"}),a.createElement("path",{d:"M35.4122 24.3054C35.6033 24.3207 35.7705 24.1782 35.7858 23.9871C35.8011 23.7961 35.6586 23.6288 35.4676 23.6135C35.2765 23.5982 35.1092 23.7407 35.0939 23.9318C35.0787 24.1228 35.2211 24.2901 35.4122 24.3054Z",fill:"url(#paint9_linear_4437_102859)"}),a.createElement("path",{d:"M35.1976 33.5143C35.3887 33.5296 35.556 33.3871 35.5713 33.196C35.5865 33.005 35.444 32.8377 35.253 32.8224C35.0619 32.8071 34.8947 32.9496 34.8794 33.1407C34.8641 33.3317 35.0066 33.499 35.1976 33.5143Z",fill:"url(#paint10_linear_4437_102859)"}),a.createElement("path",{d:"M34.7617 34.6109C34.7426 34.8497 34.5335 35.0279 34.2947 35.0087C34.0559 34.9896 33.8778 34.7805 33.8969 34.5417C33.916 34.3029 34.1251 34.1248 34.3639 34.1439C34.6027 34.163 34.7808 34.3721 34.7617 34.6109Z",fill:"url(#paint11_linear_4437_102859)"}),a.createElement("path",{d:"M33.461 33.4624C33.4419 33.7012 33.2328 33.8793 32.994 33.8602C32.7552 33.8411 32.5771 33.632 32.5962 33.3932C32.6153 33.1544 32.8244 32.9763 33.0632 32.9954C33.302 33.0145 33.4801 33.2236 33.461 33.4624Z",fill:"url(#paint12_linear_4437_102859)"}),a.createElement("path",{d:"M33.0528 38.565C33.3393 38.5879 33.5903 38.3742 33.6132 38.0876C33.6361 37.801 33.4224 37.5501 33.1358 37.5272C32.8492 37.5043 32.5983 37.718 32.5754 38.0046C32.5524 38.2912 32.7662 38.5421 33.0528 38.565Z",fill:"url(#paint13_linear_4437_102859)"}),a.createElement("path",{d:"M31.4373 25.0318C31.5806 25.0433 31.7061 24.9364 31.7176 24.7931C31.729 24.6498 31.6222 24.5244 31.4789 24.5129C31.3356 24.5014 31.2101 24.6083 31.1986 24.7516C31.1872 24.8949 31.2941 25.0203 31.4373 25.0318Z",fill:"url(#paint14_linear_4437_102859)"}),a.createElement("path",{d:"M38.6813 28.0485C38.8246 28.0599 38.9501 27.9531 38.9615 27.8098C38.973 27.6665 38.8661 27.541 38.7228 27.5296C38.5795 27.5181 38.4541 27.625 38.4426 27.7683C38.4311 27.9116 38.538 28.037 38.6813 28.0485Z",fill:"url(#paint15_linear_4437_102859)"}),a.createElement("path",{d:"M24.8264 28.2455C24.8149 28.3888 24.6895 28.4957 24.5462 28.4842C24.4029 28.4728 24.296 28.3473 24.3075 28.204C24.319 28.0607 24.4444 27.9539 24.5877 27.9653C24.731 27.9768 24.8379 28.1022 24.8264 28.2455Z",fill:"url(#paint16_linear_4437_102859)"}),a.createElement("path",{d:"M29.7179 34.5555C29.7065 34.6988 29.581 34.8057 29.4377 34.7942C29.2944 34.7828 29.1876 34.6573 29.199 34.514C29.2105 34.3707 29.3359 34.2638 29.4792 34.2753C29.6225 34.2868 29.7294 34.4122 29.7179 34.5555Z",fill:"url(#paint17_linear_4437_102859)"}),a.createElement("path",{d:"M34.8378 40.1875C34.8263 40.3308 34.7009 40.4376 34.5576 40.4262C34.4143 40.4147 34.3074 40.2892 34.3189 40.146C34.3303 40.0027 34.4558 39.8958 34.5991 39.9073C34.7424 39.9187 34.8493 40.0442 34.8378 40.1875Z",fill:"url(#paint18_linear_4437_102859)"}),a.createElement("circle",{cx:"30.7065",cy:"54.635",r:"10.2651",fill:"url(#paint19_radial_4437_102859)"}),a.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint20_radial_4437_102859)"}),a.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint21_radial_4437_102859)"}),a.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint22_radial_4437_102859)"}),a.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint23_radial_4437_102859)",fillOpacity:"0.8"}),a.createElement("circle",{cx:"32.0383",cy:"52.4709",r:"5.56954",fill:"url(#paint24_radial_4437_102859)",fillOpacity:"0.5"}),a.createElement("path",{d:"M45.5363 18.026C41.7695 15.1847 37.0813 13.5 31.9996 13.5C26.8959 13.5 22.1891 15.1993 18.4141 18.0629L18.6122 18.5407C22.3207 15.6929 26.9624 14 31.9996 14C37.0152 14 41.6389 15.6785 45.3394 18.5043L45.5363 18.026Z",fill:"url(#paint25_linear_4437_102859)"})),a.createElement("defs",null,a.createElement("radialGradient",{id:"paint0_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(12.96 91.5892) rotate(-72.0032) scale(88.3469 77.6412)"},a.createElement("stop",{offset:"0.693439",stopColor:"#FEE39E"}),a.createElement("stop",{offset:"0.944453",stopColor:"#E7E7E7"})),a.createElement("radialGradient",{id:"paint1_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(6.97869 113.113) rotate(-69.2873) scale(101.649 100.571)"},a.createElement("stop",{offset:"0.54057",stopColor:"#FEE39E"}),a.createElement("stop",{offset:"0.756027",stopColor:"#E7E7E7"})),a.createElement("radialGradient",{id:"paint2_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(24.8846 10.6232) rotate(77.745) scale(40.8411 13.4678)"},a.createElement("stop",{offset:"0.722796",stopColor:"#A99B93"}),a.createElement("stop",{offset:"1",stopColor:"#E7E7E7",stopOpacity:"0"})),a.createElement("linearGradient",{id:"paint3_linear_4437_102859",x1:"32.604",y1:"24.5358",x2:"30.1599",y2:"50.2788",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#E7E7E7"}),a.createElement("stop",{offset:"1",stopColor:"white"})),a.createElement("radialGradient",{id:"paint4_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(13.7515 86.4791) rotate(-69.9718) scale(80.4505 48.3189)"},a.createElement("stop",{offset:"0.557175",stopColor:"#FEE39E"}),a.createElement("stop",{offset:"0.650777",stopColor:"#FFB900"}),a.createElement("stop",{offset:"0.791699",stopColor:"#FF5C39"}),a.createElement("stop",{offset:"0.875",stopColor:"#DF4221"}),a.createElement("stop",{offset:"1",stopColor:"#711400"})),a.createElement("linearGradient",{id:"paint5_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint6_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint7_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint8_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint9_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint10_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint11_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint12_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint13_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint14_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint15_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint16_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint17_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("linearGradient",{id:"paint18_linear_4437_102859",x1:"33.1015",y1:"9.67212",x2:"30.6658",y2:"40.1148",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0260417",stopColor:"#E9001B"}),a.createElement("stop",{offset:"0.218354",stopColor:"#BB0C21"}),a.createElement("stop",{offset:"0.560126",stopColor:"#F4364C"})),a.createElement("radialGradient",{id:"paint19_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(30.7065 55.1016) rotate(121.43) scale(9.84288 6.65281)"},a.createElement("stop",{offset:"0.271006",stopColor:"#A9A9A9"}),a.createElement("stop",{offset:"0.715999",stopColor:"#B1B1B1",stopOpacity:"0.5"}),a.createElement("stop",{offset:"0.934077",stopColor:"#DCDCDC",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint20_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.8709 50.8751) rotate(120.689) scale(10.5254)"},a.createElement("stop",{offset:"0.103226",stopColor:"#C58FF1"}),a.createElement("stop",{offset:"0.322917",stopColor:"#9D50EE"}),a.createElement("stop",{offset:"0.510417",stopColor:"#7B30EA"}),a.createElement("stop",{offset:"0.78125",stopColor:"#CB5285"})),a.createElement("radialGradient",{id:"paint21_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.9445 50.0656) rotate(104.486) scale(8.23697)"},a.createElement("stop",{stopColor:"#DAB0F2"}),a.createElement("stop",{offset:"0.806053",stopColor:"#D1A5EA",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint22_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(33.0917 49.8449) rotate(123.541) scale(3.92887)"},a.createElement("stop",{stopColor:"#EDDAFD"}),a.createElement("stop",{offset:"0.573279",stopColor:"#D8BDEF",stopOpacity:"0.57836"}),a.createElement("stop",{offset:"1",stopColor:"#BC95DC",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint23_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(32.0383 52.4709) rotate(97.8153) scale(9.88655)"},a.createElement("stop",{offset:"0.446038",stopColor:"white",stopOpacity:"0"}),a.createElement("stop",{offset:"0.841379",stopColor:"white"})),a.createElement("radialGradient",{id:"paint24_radial_4437_102859",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(31.8462 58.0405) rotate(-90) scale(4.03312 7.97021)"},a.createElement("stop",{stopColor:"#FFB3BB"}),a.createElement("stop",{offset:"1",stopColor:"#FE625D",stopOpacity:"0"})),a.createElement("linearGradient",{id:"paint25_linear_4437_102859",x1:"18.4141",y1:"19.5907",x2:"18.2667",y2:"10.1574",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#F3F3F3"}),a.createElement("stop",{offset:"0.853323",stopColor:"#E7E7E7"})),a.createElement("clipPath",{id:"clip0_4437_102859"},a.createElement("rect",{width:"64",height:"64",fill:"white"}))))},DJ={root:(0,F.__assign)((0,F.__assign)({position:"relative",alignItems:"center",justifyContent:"space-between"},Xa.Pt.overflow("hidden","auto")),{scrollBehavior:"smooth",height:"100%"}),mainContent:{alignItems:"center",justifyContent:"center",marginTop:Wb.L.spacingVerticalXXL,rowGap:Wb.L.spacingVerticalL,height:"100%"},textContent:{rowGap:Wb.L.spacingVerticalM,alignItems:"center",maxWidth:"220px"},text:{textAlign:"center"}},OJ=(0,Za.n)(DJ),NJ=function(e){e.isDarkMode;var t=e.errorScreenTitle,n=e.errorScreenText,r=OJ();return a.createElement(_j.W,{style:r.root},a.createElement(_j.W,{style:r.mainContent},a.createElement(LJ,null),a.createElement(_j.W,{style:r.textContent},a.createElement(AJ.M,{block:!0,className:r.text},t),a.createElement(xb.c,{block:!0,className:r.text},n))))},RJ=(0,gh.Ex)("officeaicopilot-switcher-menu-container.copilotUiStrings.CopilotLabel"),FJ=function(){return a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M14.1437 3.34932C13.9101 2.54966 13.177 2 12.3439 2L11.7427 2C10.8467 2 10.0758 2.634 9.90296 3.51321L8.85352 8.85006L9.15094 7.89102C9.39431 7.1063 10.1202 6.57143 10.9418 6.57143L14.2351 6.57143L15.6352 7.74347L16.8818 6.57143H16.4905C15.6574 6.57143 14.9242 6.02177 14.6907 5.22211L14.1437 3.34932Z",fill:"url(#paint0_radial_725_52234)"}),a.createElement("path",{d:"M6.0492 16.6427C6.28017 17.4462 7.01519 17.9997 7.85121 17.9997H9.07497C10.0844 17.9997 10.9126 17.2006 10.9488 16.1918L11.1295 11.1426L10.842 12.0951C10.6031 12.8867 9.87385 13.4283 9.04701 13.4283L5.73383 13.4283L4.34959 12.5431L3.32812 13.4283H3.71324C4.54926 13.4283 5.28427 13.9818 5.51524 14.7853L6.0492 16.6427Z",fill:"url(#paint1_radial_725_52234)"}),a.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint2_linear_725_52234)"}),a.createElement("path",{d:"M12.2503 2H5.68785C3.81286 2 2.68787 4.39748 1.93788 6.79497C1.04933 9.63537 -0.113354 13.4342 3.25037 13.4342H6.11145C6.9435 13.4342 7.67548 12.8878 7.91125 12.0899C8.40466 10.4199 9.26493 7.52162 9.94109 5.31373C10.2857 4.18837 10.5728 3.22188 11.0134 2.62001C11.2604 2.28258 11.6721 2 12.2503 2Z",fill:"url(#paint3_linear_725_52234)"}),a.createElement("path",{d:"M7.74902 17.9997H14.3115C16.1865 17.9997 17.3114 15.603 18.0614 13.2063C18.95 10.3668 20.1127 6.56934 16.7489 6.56934H13.8877C13.0557 6.56934 12.3238 7.11559 12.088 7.91346C11.5946 9.58288 10.7343 12.48 10.0582 14.687C9.71358 15.812 9.42651 16.7782 8.98593 17.3799C8.73893 17.7172 8.32725 17.9997 7.74902 17.9997Z",fill:"url(#paint4_radial_725_52234)"}),a.createElement("path",{d:"M7.74902 17.9997H14.3115C16.1865 17.9997 17.3114 15.603 18.0614 13.2063C18.95 10.3668 20.1127 6.56934 16.7489 6.56934H13.8877C13.0557 6.56934 12.3238 7.11559 12.088 7.91346C11.5946 9.58288 10.7343 12.48 10.0582 14.687C9.71358 15.812 9.42651 16.7782 8.98593 17.3799C8.73893 17.7172 8.32725 17.9997 7.74902 17.9997Z",fill:"url(#paint5_linear_725_52234)"}),a.createElement("defs",null,a.createElement("radialGradient",{id:"paint0_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.7128 8.89484) rotate(-129.141) scale(7.20751 6.76953)"},a.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),a.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),a.createElement("stop",{offset:"1",stopColor:"#0736C4"})),a.createElement("radialGradient",{id:"paint1_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(4.74347 13.4005) rotate(51.7328) scale(6.58647 6.39483)"},a.createElement("stop",{stopColor:"#FFB657"}),a.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),a.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),a.createElement("linearGradient",{id:"paint2_linear_725_52234",x1:"5.29507",y1:"3.38547",x2:"6.17192",y2:"13.8705",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),a.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),a.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),a.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),a.createElement("linearGradient",{id:"paint3_linear_725_52234",x1:"6.11337",y1:"2",x2:"6.59201",y2:"13.4355",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{stopColor:"#3DCBFF"}),a.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),a.createElement("radialGradient",{id:"paint4_radial_725_52234",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(17.0861 5.45023) rotate(109.881) scale(15.2451 18.7446)"},a.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),a.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),a.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),a.createElement("linearGradient",{id:"paint5_linear_725_52234",x1:"17.6045",y1:"5.87149",x2:"17.5982",y2:"8.9847",gradientUnits:"userSpaceOnUse"},a.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),a.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))},MJ=n(58651),BJ=function(e){return!e||e===vO};var UJ=function(e,t){return t!==uO.CustomGPT?void 0:e},HJ=!1;var GJ=function(e,t){HJ&&(null==t?MJ.log("CopilotSwitcherContainer Log:",e):MJ.log("CopilotSwitcherContainer Log:",e,t))},zJ=function(e,t,n,r){var o,i=uj[o=e]?uj[o]:(0,aj.A)(),a=[{key:yE.h3.UserQueryGuid,value:null!=i?i:(0,aj.A)()},{key:yE.h3.SelectedSwitcherMenuItemId,value:r}];switch(t){case oj.GPTRequest:eb.j.getInstance().sendTelemetryChatEventData((0,F.__spreadArray)((0,F.__spreadArray)([],(0,F.__read)(a),!1),[{key:yE.h3.ChatEventType,value:e===UW.GetGPT?yE.a5.GetGPTDetailsRequest:yE.a5.GetGPTListRequest}],!1));break;case oj.GPTResponse:eb.j.getInstance().sendTelemetryChatEventData((0,F.__spreadArray)((0,F.__spreadArray)([],(0,F.__read)(a),!1),[{key:yE.h3.ChatEventType,value:e===UW.GetGPT?yE.a5.GetGPTDetailsResponse:yE.a5.GetGPTListResponse}],!1));break;case oj.GPTError:eb.j.getInstance().sendTelemetryErrorData((0,F.__spreadArray)((0,F.__spreadArray)([],(0,F.__read)(a),!1),[{key:yE.IC.ErrorCategory,value:e===UW.GetGPT?yE.a5.GetGPTDetailsError:yE.a5.GetGPTListError},{key:yE.IC.ErrorMessage,value:n}],!1));break;case oj.GPTLatency:eb.j.getInstance().sendTelemetryLatencyData((0,F.__spreadArray)((0,F.__spreadArray)([],(0,F.__read)(a),!1),[{key:yE.CT.RequestSignalType,value:e===UW.GetGPT?yE.a5.GetGPTDetailsLatency:yE.a5.GetGPTListLatency},{key:yE.CT.FeatureName,value:yE.Z_.Extensibility},{key:yE.CT.SubFeatureName,value:yE.EF.DeclarativeCopilots},{key:yE.CT.UserPerceivedLatency,value:n}],!1))}},qJ=a.forwardRef((function(e,t){var n,r,o,i,s,l=e.style,c=e.platformType,u=e.copilotCommunicationHandler,d=e.theme,p=e.themeV2,g=e.chatUiProps,m=e.debugProps,f=e.copilotPluginProps,h=e.copilotFeatureFlags,v=(0,F.__read)(a.useState(!1),2),y=v[0],C=v[1],S=(0,F.__read)(a.useState(void 0),2),b=S[0],E=S[1],T=(0,F.__read)(a.useState(!1),2),I=T[0],_=T[1],w=void 0!==p,P=wJ(),x=PJ(),k=a.useRef(null),A=(0,dO.Lh)(RJ)||"Copilot",L=null===(n=u.getHostSettings())||void 0===n?void 0:n.appPlatform;xJ(w?x:P,l);var D=eb.j.getInstance(),O=(0,F.__read)(a.useState((function(){})),2),N=O[0],R=O[1],M=(0,F.__read)(a.useState((function(){})),2),B=M[0],U=M[1],H=(0,F.__read)(a.useState((function(){})),2),G=H[0],z=H[1],q=(0,F.__read)(a.useState(!1),2),W=q[0],j=q[1],V=(null===(r=null==g?void 0:g.chatHistoryUiProps)||void 0===r?void 0:r.enableChatHistoryV2)&&(null===(o=null==f?void 0:f.paneSilhouetteHeaderProps)||void 0===o?void 0:o.enableChatHistory),Q=a.useCallback((function(e){e?et(!1):j(!1)}),[]),J=(0,F.__read)(a.useState(null==h?void 0:h.isCreditsUIEnabled),2),K=J[0],X=J[1],Z=(0,F.__read)(a.useState(null!==(i=e.chatUiProps.creditsUIProps)&&void 0!==i?i:{creditUpsellHandler:function(){},setShowCreditsUI:X,upsellFwdLinkId:"",clientParam:""}),2),Y=Z[0],$=Z[1],ee=(0,F.__read)(a.useState(e),2),te=ee[0],ne=ee[1],re=(0,F.__read)(a.useState(!0),2),oe=re[0],ie=re[1],ae=(0,F.__read)(a.useState(!1),2),se=ae[0],le=ae[1],ce=(0,F.__read)(a.useState(!1),2),ue=ce[0],de=ce[1],pe=(0,F.__read)(a.useState(!1),2),ge=pe[0],me=pe[1],fe=(0,F.__read)(a.useState([]),2),he=fe[0],ve=fe[1];a.useEffect((function(){ge&&ve((function(e){return(0,F.__spreadArray)((0,F.__spreadArray)([],(0,F.__read)(e),!1),[uO.CustomGPT],!1)}))}),[ge]);var ye=(0,F.__read)(a.useState(d),2),Ce=ye[0],Se=ye[1],be=(0,F.__read)(a.useState(p),2),Ee=be[0],Te=be[1],Ie=a.useRef(null);function _e(){if(c!==IO.Y.IOS)if(y)1==window.devicePixelRatio&&C(!1);else if(!function(){var e=null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem("preloadCopilot");if(e){var t=JSON.parse(e),n=t.isPreloaded,r=t.isHidden;return n&&r}return!1}()){var e=document.getElementById("ChatWrapperId");if(e)e.getBoundingClientRect().height<=0&&C(!0)}}a.useEffect((function(){Se(d),Te(p)}),[d,p]),a.useEffect((function(){if(c!==IO.Y.IOS)return _e(),window.addEventListener("resize",_e),function(){window.removeEventListener("resize",_e)};var t;t=e.copilotCommunicationHandler.getHostSettings().devBuild,HJ=t}));var we=null==f?void 0:f.showCopilotSwitcherMenu,Pe=(0,F.__read)(a.useState([]),2),xe=Pe[0],ke=Pe[1],Ae=a.useMemo((function(){var e;return null===(e=xe.find((function(e){return e.id===b})))||void 0===e?void 0:e.name}),[b]),Le=a.useMemo((function(){var e;return null===(e=xe.find((function(e){return e.id===b})))||void 0===e?void 0:e.copilotType}),[xe,b]),De=(0,F.__read)(a.useState(void 0),2),Oe=De[0],Ne=De[1];a.useEffect((function(){if(b&&Le){var e=UJ(b,Le);Ne(e)}}),[b,Le]);var Re=Tj(h.isCustomGPTsEnabled,te,de,me,(function(e,t,n){zJ(e,t,n,b)})),Fe=Re.isLoadingMenu,Me=Re.isLoadingGPTDetails,Be=Re.isTimeoutForGPTList,Ue=Re.isTimeoutForGPTDetails,He=Re.fetchGPTList,Ge=Re.gptListProps,ze=Re.fetchGPTDetails,qe=Re.gptDetailsProps,We=a.useCallback((function(e){var t,n,r,o=xe.find((function(t){return t.id===e}));if(!o)throw t=yE.a5.GPTBrandingIdInvalid,n="GPT id ".concat(e," not found in copilotListInternal"),eb.j.getInstance().sendTelemetryErrorData([{key:yE.IC.ErrorCategory,value:t},{key:yE.IC.ErrorMessage,value:n},{key:yE.IC.ErrorCode,value:r}]),new Error("Invalid GPT id ".concat(e));return{name:o.name,iconUrl:o.menuIconUrl,id:e}}),[xe]);a.useEffect((function(){ie(!!Fe)}),[Fe]),a.useEffect((function(){h.isCustomGPTsEnabled&&le(!!Me)}),[Me]),a.useEffect((function(){if(h.isCustomGPTsEnabled&&!Be&&Ge.status===ij.Success){GJ("Updating GPT list in switcher menu");var e=xe.filter((function(e){return e.copilotType!==uO.CustomGPT})),t=xe.find((function(e){return e.isSelected})),n=Ge.copilotSwitcherMenuItemProps;(null==t?void 0:t.copilotType)===uO.CustomGPT&&(n=n.map((function(e){return(0,F.__assign)((0,F.__assign)({},e),{isSelected:e.id===t.id})}))),ke((0,F.__spreadArray)((0,F.__spreadArray)([],(0,F.__read)(e),!1),(0,F.__read)(n),!1))}else Ge.status===ij.Error&&et(!1)}),[Ge]),a.useEffect((function(){if(h.isCustomGPTsEnabled&&!Ue&&qe.status===ij.Success&&""!==qe.gptId){GJ("Updating GPT details in switcher menu container"),Ve(qe.gptId);var e=fj(qe.copilotChatProps,te);ne(e)}}),[qe]),a.useEffect((function(){if(0===xe.length){var e=function(e){return{id:vO,name:e,isSelected:!0,copilotType:uO.Default,menuIcon:a.createElement(FJ,null)}}(A);ke((0,F.__spreadArray)((0,F.__spreadArray)([e],(0,F.__read)((null==f?void 0:f.copilotList)||[]),!1),(0,F.__read)(h.isCustomGPTsEnabled?[{id:"GetCopilotExtensions",name:"Get Copilot agents",isSelected:!1,isLink:!0,linkURL:"https://go.microsoft.com/fwlink/?linkid=2271054",menuIcon:a.createElement(RW.zVV,null)}]:[]),!1))}else{var t=null==f?void 0:f.copilotList.find((function(e){return e.isSelected}));if(t){var n=xe.find((function(e){return e.isSelected}));n&&n.id!==t.id&&ke((function(e){return e.map((function(e){return(0,F.__assign)((0,F.__assign)({},e),{isSelected:e.id===t.id})}))}))}}}),[null==f?void 0:f.copilotList]);var je=a.useCallback((function(e){null==f||f.handleCopilotChatChange(e)}),[f]),Ve=function(e){de(!1);var t=xe.map((function(t){return(0,F.__assign)((0,F.__assign)({},t),{isSelected:t.id===e})}));k.current!=e&&(k.current=e,ke(t),E(e))},Qe=function(e){var t,n=xe.find((function(t){return t.id===e}));D.sendTelemetryChatEventData([{key:yE.h3.ChatEventType,value:yE.a5.CopilotChange},{key:yE.h3.ChatEventParameters,value:JSON.stringify({id:e,type:null==n?void 0:n.copilotType})}]),n&&(null==n?void 0:n.isLink)&&(null==n?void 0:n.linkURL)?(t=null==n?void 0:n.linkURL,window.open(t,"_blank")):k.current!=e&&Ve(e)};a.useEffect((function(){var e=xe.find((function(e){return e.isSelected}));e&&je(e.id)}),[xe]);var Je=a.useMemo((function(){return(0,F.__spreadArray)([],(0,F.__read)(xe),!1).map((function(e,t){return{item:e,index:t}})).sort((function(e,t){if(void 0===e.item.copilotType&&void 0===t.item.copilotType)return 0;if(void 0===e.item.copilotType)return 1;if(void 0===t.item.copilotType)return-1;var n=fO[e.item.copilotType]-fO[t.item.copilotType];return 0!==n?n:e.index-t.index})).map((function(e){return e.item}))}),[xe]),Ke=(0,F.__read)(a.useState(a.createElement(a.Fragment,null)),2),Xe=Ke[0],Ze=Ke[1];a.useEffect((function(){var e=null==f?void 0:f.copilotList.find((function(e){return e.isSelected}));Ze(e?e.copilotComponent:a.createElement(a.Fragment,null))}),[null==f?void 0:f.copilotList]),a.useEffect((function(){if(Y){var e=(0,F.__assign)({},g);e.creditsUIProps=Y,e.creditsUIProps.setShowCreditsUI=X,ne((0,F.__assign)((0,F.__assign)({},te),{chatUiProps:e})),$(e.creditsUIProps)}}),[K]);var Ye=(0,F.__read)(a.useState(!1),2),$e=Ye[0],et=Ye[1],tt=function(e,t){et(t.open),t.open&&(W&&V&&j(!1),D.sendTelemetryChatEventData([{key:yE.h3.ChatEventType,value:yE.a5.SwitcherMenuStateChange},{key:yE.h3.ChatEventParameters,value:JSON.stringify({isOpen:t.open,eventType:t.type})}]));var n={timestamp:(new Date).getTime(),chatEventParams:JSON.stringify({isMenuOpen:t.open,isItemClick:"menuItemClick"===t.type})};qp.sU.sendLoggingEventToClient(Iw.Yk.CopilotSwitcherMenuStateChange,n)},nt=(0,F.__read)(a.useState(!1),2),rt=nt[0],ot=nt[1];a.useEffect((function(){var t=xe.find((function(e){return e.isSelected})),n=xe.find((function(e){return e.copilotType===uO.Default}));t&&n&&t.id===n.id&&ot(!1),ot(xe&&we&&(null==t?void 0:t.id)&&(null==n?void 0:n.id)&&(null==t?void 0:t.id)!==(null==n?void 0:n.id)&&hO.includes(null==t?void 0:t.copilotType)),n&&n.isSelected&&ne(e)}),[xe,we,m]),a.useEffect((function(){var t=xe.find((function(e){return e.isSelected}));if(h.isCustomGPTsEnabled&&t&&t.copilotType&&t.copilotType===uO.CustomGPT){var n=fj(qe.copilotChatProps,e);ne(n)}else ne(e)}),[e]),a.useEffect((function(){b&&_(!0);h.isCustomGPTsEnabled&&Le===uO.CustomGPT&&(0,F.__awaiter)(void 0,void 0,void 0,(function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,Promise.all([He(),ze(b)])];case 1:return e.sent(),[2]}}))}))}),[b]),a.useEffect((function(){I&&BJ(b)&&(0,F.__awaiter)(void 0,void 0,void 0,(function(){var e,t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return e=UJ(b,Le),t={gptId:e},(null==Ie?void 0:Ie.current)?[4,(0,JW.a_)(bJ.S5.GetMessagesOperation,void 0,void 0,void 0,null==Ie?void 0:Ie.current,void 0,void 0,t)]:[3,2];case 1:return n.sent(),Ie.current=null,[3,3];case 2:null==G||G({eventName:"Switcher_Menu_Item_Clicked",gptId:e,shouldSetLoadingUIStates:!0}),n.label=3;case 3:return[2]}}))}))}),[b,I]);var it=(0,KW.dg)(h),at=((null==h?void 0:h.enableNewChatOnlyOnCopilot)?BJ(b):null==h?void 0:h.showNewChatOnGPTItem)?G:void 0;return a.createElement(Ij.V,{copilotChatHistoryContext:{setOnClickShowChatHistoryPanel:R,setChatHistoryContainer:U,setNewConversationClickHandler:z},copilotChatConversationSelectedContext:{conversationId:Ie,handleChatHistoryConversationClick:function(e,t){return(0,F.__awaiter)(void 0,void 0,void 0,(function(){return(0,F.__generator)(this,(function(n){return Qe(null!=e?e:vO),Ie.current=t,[2]}))}))}}},a.createElement(Of.L,{theme:Ee||Ce,shouldUseFluentV9Tokens:w,dir:Ee?Ee.dir:Ce.dir},a.createElement(_j.W,{style:y?P.chatUiStackZoom:P.chatUiStack},f.paneSilhouetteHeaderProps&&a.createElement(KW.ZJ.Provider,{value:it},a.createElement(yJ,{isMenuOpen:$e,onMenuStateChange:tt,handleCopilotChatChange:Qe,copilotList:Je,showLoadingShimmer:oe,paneSilhouetteHeaderProps:(0,F.__assign)((0,F.__assign)({},f.paneSilhouetteHeaderProps),{afterFirstRender:function(){null==u||u.sendEventToClient(Iw.PV.SharedHeaderRendered)},showCreditButton:K}),switcherMenuChatHistoryProps:V?{onClickShowChatHistoryPanel:N,chatHistoryContainer:B,isSwitcherMenuChatHistoryPanelOpen:W,setIsSwitcherMenuChatHistoryPanelOpen:j,handleChatHistoryPanelClose:Q,newConversationClickHandler:at}:void 0,featureFlags:h,appPlatform:L,menuErrorProps:h.isCustomGPTsEnabled?{showErrorMessage:ge&&$e,errorMessage:bO(),unloadedCopilotTypes:he,onErrorMessageDismiss:function(){return me(!1)}}:void 0})),!f.paneSilhouetteHeaderProps&&a.createElement(CJ.V,{isMenuOpen:$e,onMenuStateChange:tt,handleCopilotChatChange:Qe,copilotList:Je,showLoadingShimmer:oe}),se?a.createElement(kJ,{className:y?P.chatFreStackZoom:P.chatFreStack}):rt?a.createElement(SJ.K,{componentToRender:Xe}):ue?a.createElement(NJ,{isDarkMode:null!==(s=null==Ee?void 0:Ee.isDarkModeEnabled)&&void 0!==s?s:null==Ce?void 0:Ce.isDarkModeEnabled,errorScreenTitle:CO(Ae),errorScreenText:SO()}):a.createElement(_j.W,{style:P.chatUiStackItemInContainer},a.createElement(qp.zn,(0,F.__assign)({},te,{theme:Ce,themeV2:Ee,ref:t,switcherMenuProps:{currentSelectedGPTId:Oe,shouldClearChatHistory:I,setShouldClearChatHistory:_,getBrandingById:We}}))))))}));qJ.displayName="CopilotSwitcherMenuContainer";var WJ=function(e){var t,r,o,i=(t=function(){return Promise.all([n.e(6008),n.e(9037),n.e(7645),n.e(7410),n.e(1757)]).then(n.bind(n,44994)).then((function(e){return{default:e.ReviewerAgent}}))},r="ReviewerAgent",void 0===o&&(o=3),(0,a.lazy)((function(){return new Promise((function(e,n){var i=0,a=function(){t().then((function(t){return e(t)})).catch((function(e){++i>=o?n(e):(Rm.error("Error in lazy loading package ".concat(r),e),a())}))};a()}))})));return a.createElement(a.Suspense,{fallback:a.createElement(a.Fragment,null)},a.createElement(i,e))};function jJ(e,t,n){return VJ.apply(this,arguments)}function VJ(){return(VJ=(0,gd._)((function(e,t,n){return(0,F.__generator)(this,(function(r){return Gp("Applying suggestion",e,t,n),[2]}))}))).apply(this,arguments)}function QJ(e){return JJ.apply(this,arguments)}function JJ(){return(JJ=(0,gd._)((function(e){return(0,F.__generator)(this,(function(e){return[2,""]}))}))).apply(this,arguments)}function KJ(){return XJ.apply(this,arguments)}function XJ(){return XJ=(0,gd._)((function(){var e,t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:e="",t="",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:return n=o.sent(),e=n.email,t=n.displayName,[3,4];case 3:return r=o.sent(),Gp("Error getting user info: "+r),[2,{displayName:"defaultName",email:"defaultEmail"}];case 4:return[2,{displayName:t,email:e}]}}))})),XJ.apply(this,arguments)}function ZJ(){return YJ.apply(this,arguments)}function YJ(){return(YJ=(0,gd._)((function(){var e,t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return e=Sb.getInstance(),t=e.getChatRef(),[4,_f.getInstance(void 0,t,MR,UR).getInDocSensitiveLabelUsingOfcJs()];case 1:return[2,{id:(n=r.sent()).labelId,parent:n.parentName,isEncrypted:n.encryptionType!==Tp.None,displayName:n.displayName,priority:n.order}]}}))}))).apply(this,arguments)}function $J(){return{settings:{hostAppId:YU(),hostAppName:"PowerPoint",hostAppPlatform:$U(),hostAppScenario:"Copilot",hostDefaultLocale:TS(_p.GetHostAppDisplayLanguage()),isDogfoodEnvironment:!0,resultTime:1e4,enableAutomaticScoping:!0},telemLogger:{logError:function(e){Gp("Reviewer agent people picker CIQ Error Log: ",e)}},entitiesSupported:[Iw.ck.People],isExpandedECCEnabled:!1}}function eK(e){Gp("DEBUG Log : Highlight comment with commentid ",+e),pU({type:sU.ChatPPTTriggerCommentHighlight,commentId:e})}var tK=function(){function e(){Sp(this,e)}return Ep(e,[{key:"onError",value:function(e,t){if(e!==Ih.HandoffMessageResponse)throw Gp("Unhandled Handoff error type: "+e+(t?" Error: ".concat(JSON.stringify(t)):"")),new Error(Oh);wL(Sb.getInstance().getChatRef(),Oh)}},{key:"submitSignal",value:function(e,t){var n;null===(n=Sb.getInstance().getChatRef().current)||void 0===n||n.submitOperation(t)}},{key:"onAnnotationReceived",value:function(e,t,n,r){var o=ob.getInstance();_h.uC.typeGuard(t)&&(t.queryId&&(GS(t.queryId),mb.getInstance().removeContextId(t.queryId)),o.recordCheckPoint(UC.HandoffMessageReceived)),US(o,e,n,sC.HandoffMessageResponseTime,_C.Handoff,r)}},{key:"onHandoffMessageIdSubmitted",value:function(e){var t,n;switch(mb.getInstance().addContextId(e.queryId),e.handoffOperation){case wh.Q.GET:t=dC.HandoffMessageIdGetOperationSubmitted,n=UC.HandoffMessageIdSent;break;case wh.Q.PROCESSED:t=dC.HandoffMessageIdProcessedOperationSubmitted,n=UC.HandoffMessageIdProcessed}t&&ob.getInstance().sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,t))),n&&ob.getInstance().recordCheckPoint(n)}},{key:"logDebug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];TF&&Gp(t.join("\n"))}},{key:"submitQuery",value:function(e){var t;null===(t=Sb.getInstance().getChatRef().current)||void 0===t||t.submitUserQuery({text:e})}}]),e}();class nK{constructor(e){Qp.h.assign(nK,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffProperties"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[nK.getTypeName()])}}nK.H_={T_:nK.getTypeName(),B_:nK.getBaseTypes()};class rK{constructor(e){Qp.h.assign(rK,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffProperties","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[rK.getTypeName()])}}rK.H_={T_:rK.getTypeName(),B_:rK.getBaseTypes()};class oK{constructor(e){Qp.h.assign(oK,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_AppHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[oK.getTypeName()])}}oK.H_={T_:oK.getTypeName(),B_:oK.getBaseTypes()};class iK{constructor(e){Qp.h.assign(iK,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInternalMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffProperties","AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[iK.getTypeName()])}}iK.H_={T_:iK.getTypeName(),B_:iK.getBaseTypes()};class aK{constructor(e){Qp.h.assign(aK,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessageId"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[aK.getTypeName()])}}aK.H_={T_:aK.getTypeName(),B_:aK.getBaseTypes()};class sK{constructor(e){Qp.h.assign(sK,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Qp.h.matchesTypesFor(e,[sK.getTypeName()])}}function lK(e){if(!e)throw new Error("query is undefined")}function cK(e){if(!e)throw new Error("response context property undefined")}function uK(e){return dK.apply(this,arguments)}function dK(){return(dK=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return EK.getInstance().autoExecuteQuery(e),ob.getInstance().sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ContentProcessingOperationSubmitted))),jE.getInstance().setState(Qd.WAITING_FOR_CONTENT_PROCESSING_WF_RESPONSE),[2]}))}))).apply(this,arguments)}sK.H_={T_:sK.getTypeName(),B_:sK.getBaseTypes()};var pK="7c614a77-0c4c-47ff-a605-8fe56e10dbeb";function gK(e,t,n){if(e&&e.length>0){var r,o,a=function(e){var t;if(e.toLocaleLowerCase()===pK)t=BB();else t="";return t}(e);if(a)jE.getInstance().setState(Qd.EXECUTING),null===(r=t.current)||void 0===r||r.submitUserQuery({text:a}),VS({query:a,queryId:"",destinationApp:Ph.Ww.POWERPOINT,language:""},this.handoffMessageRequestSubmitTime);n.sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,dC.CshCopilotLinkClicked),(0,i._)(o,cC.ChatEventParameters,JSON.stringify({success:!!a,promptIdGuid:e})),o)))}}var mK="TriggerCreatePresentationAbout",fK="TriggerCreatePresentationFromFile",hK="triggerSummary",vK="TriggerAskCopilot",yK=function(){function e(t,n){Sp(this,e),(0,i._)(this,"copilotChatRef",void 0),(0,i._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return Ep(e,[{key:"isFeature",value:function(e){return Vh(Lh.InAppHandoffEnabled)&&e.scenarioName==Ph.Cu.INAPP&&e.destinationApp==Ph.Ww.POWERPOINT&&e.sourceApp==Ph.Ww.POWERPOINT}},{key:"handleValidation",value:function(e){cK(e.context)}},{key:"handleExecution",value:function(e){var t=JSON.parse(e.context).featureName;if(void 0===t||t===rM)throw new Error("InAppHandoffMessage - featureName is undefined.");switch(t){case CF.SkittleContextMenuUserClickAction:this.handleNoQueryInAppHandOffMessageForCopilotOnCanvas(e,this.copilotChatRef);case CF.ContextSensitiveHelpClickAction:this.handleNoQueryInAppHandOffMessageForCopilotOnContextSensitiveHelp(e,this.copilotChatRef)}}},{key:"handleNoQueryInAppHandOffMessageForCopilotOnCanvas",value:function(e,t){var n=ob.getInstance();try{var r,o,a=JSON.parse(e.context).contextMenuSelection;switch(a){case mK:var s;Gp("TriggerCreatePresentationAbout in app handoff message received"),n.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerCreatePresentationAboutCalledViaInAppHandOffMessage}]),r=PowerpointCopilotStrings.PreFilledPromptGuideItemCreateAPresentationAbout,null===(s=t.current)||void 0===s||s.setInputAreaText(r);break;case fK:var l;Gp("TriggerCreatePresentationFromFile in app handoff message received"),n.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerCreatePresentationFromFileCalledViaInAppHandOffMessage}]),r=PowerpointCopilotStrings.PreFilledPromptGuideItemCreatePresentationFrom,null===(l=t.current)||void 0===l||l.setInputAreaText(r);break;case hK:var c;if(0==e.manualSendPrompt)Gp("TriggerSummary in app handoff message received"),jE.getInstance().setState(Qd.EXECUTING),n.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerSummaryCalledViaInAppHandOffMessage}]),r=PowerpointCopilotStrings.PromptMenuItemSummarize,EK.getInstance().autoExecuteQuery(r),o=!0;else Gp("handleNoQueryInAppHandOffMessageForCopilotOnCanvas: TriggerSummary invoked without manualSendPrompt set as false. No action taken."),n.sendChatEventTelemetry(HS((c={},(0,i._)(c,cC.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(_h.uC.getTypeName(),"_Error")),(0,i._)(c,cC.ChatErrorType,ep.Client),(0,i._)(c,cC.ChatErrorParameters,"TriggerSummary invoked without manualSendPrompt set as false. No action taken."),c)));break;case vK:var u;Gp("TriggerAskCopilot in app handoff message received"),n.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerAskCopilotCalledViaInAppHandOffMessage}]),null===(u=t.current)||void 0===u||u.setInputAreaText(rM);break;default:var d;Gp("handleNoQueryInAppHandOffMessageForCopilotOnCanvas: Invoked with an unknown value of contextMenuSelection. No action taken. Value: "+a),n.sendChatEventTelemetry(HS((d={},(0,i._)(d,cC.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(_h.uC.getTypeName(),"_Error")),(0,i._)(d,cC.ChatErrorType,ep.Client),(0,i._)(d,cC.ChatErrorParameters,"Invoked with an unknown value of contextMenuSelection. No action taken. Value: "+a),d)))}r&&VS(Sd(Cd({},e),{query:r,manualSendPrompt:!o}),this.handoffMessageRequestSubmitTime)}catch(e){var p;throw Gp("handleNoQueryInAppHandOffMessageForCopilotOnCanvas:"+e.message),n.sendChatEventTelemetry(HS((p={},(0,i._)(p,cC.ChatEventType,"InAppHandoffMessage handling for Copilot on Canvas - ".concat(_h.uC.getTypeName(),"_Error")),(0,i._)(p,cC.ChatErrorType,ep.Client),(0,i._)(p,cC.ChatErrorParameters,e.message),p))),e}}},{key:"handleNoQueryInAppHandOffMessageForCopilotOnContextSensitiveHelp",value:function(e,t){var n=ob.getInstance();try{if(!e.context)throw new Error("response.context is undefined");gK(JSON.parse(e.context).promptIdGuid,t,n)}catch(e){var r;throw Gp("handleNoQueryInAppHandOffMessageForCopilotOnContextSensitiveHelp:"+e.message),n.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,"InAppHandoffMessage handling for Copilot on Context Sensitive Help - ".concat(_h.uC.getTypeName(),"_Error")),(0,i._)(r,cC.ChatErrorType,ep.Client),(0,i._)(r,cC.ChatErrorParameters,e.message),r))),e}}}]),e}(),CK=function(){function e(t,n){Sp(this,e),(0,i._)(this,"copilotChatRef",void 0),(0,i._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return Ep(e,[{key:"isFeature",value:function(e){var t;return null!==(t=e.manualSendPrompt)&&void 0!==t&&t}},{key:"handleValidation",value:function(e){cK(e.context),lK(e.query)}},{key:"handleExecution",value:function(e){var t,n,r=e.query;null===(t=this.copilotChatRef.current)||void 0===t||t.setInputAreaText(r),null===(n=this.copilotChatRef.current)||void 0===n||n.setInputFocus(),VS(e,this.handoffMessageRequestSubmitTime)}}]),e}(),SK=function(){function e(t,n){Sp(this,e),(0,i._)(this,"copilotChatRef",void 0),(0,i._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return Ep(e,[{key:"isFeature",value:function(e){var t;if(!zh("HVCAppHandOffScenarioEnabled"))return!1;var n=null===(t=e.content)||void 0===t?void 0:t[0].contentString,r=JSON.parse(null!=n?n:"{}");return(null==r?void 0:r.HVCScenarioName)&&"PPT"===(null==r?void 0:r.HVCScenarioName)?(Gp("entityPickerProps: ",n),!0):(Gp("entityPickerProps is undefined in handoffMessageResponseProcessor"),!1)}},{key:"handleValidation",value:function(e){cK(e.context),lK(e.query)}},{key:"handleExecution",value:function(e){var t=this;return(0,gd._)((function(){var n,r,o,s,l,c,u;return(0,F.__generator)(this,(function(d){return function(e,t,n,r){var o,a,s,l=/(https:\/\/(www\.)?\S*)(\s|$)/i,c={featureName:_C.Commanding,subFeatureName:MC.HandOff};if(l.test(e.query)){var u,d=JSON.parse(e.context).sourceDocUrl;if(void 0===d||d===rM)throw new Error("sourceDocumentLink is undefined");var p=d.substring(d.lastIndexOf("/")+1),g=e.query.match(l)[1],m=e.query.split(g);null===(u=n.current)||void 0===u||u.addResponseMessage(_L({linkPrefix:m[0],linkText:decodeURI(p),linkSuffix:m.length>1?m[1]:void 0},(function(){return zN(g)}),g,yL,!0,Wd.CHATPPT,void 0,void 0,c))}else{var f;null===(f=n.current)||void 0===f||f.addResponseMessage(IL(e.query,yL,!0,c))}ob.getInstance().sendLatencyTelemetry(HS((0,i._)({},sC.UserPerceivedLatency,(0,qp.WU)(r)))),jE.getInstance().setState(Qd.EXECUTING),null===(o=n.current)||void 0===o||o.updateLoadingComponentProps(Cd({loadingUiStringList:null!==(s=Gx().get(t))&&void 0!==s?s:[]},FN())),null===(a=n.current)||void 0===a||a.startLoadingUi()}(e,Hd.TransformDocument,t.copilotChatRef,t.handoffMessageRequestSubmitTime),s=JSON.parse(null!==(o=null===(n=e.content)||void 0===n?void 0:n[0].contentString)&&void 0!==o?o:"{}"),c=null!==(l=null==s?void 0:s.entityList)&&void 0!==l?l:[],u={list:c,headerDescription:"Here is the list of files you have chosen for the presentation creation.",entityInteractionDisabled:!0},null===(r=t.copilotChatRef.current)||void 0===r||r.addResponseMessage(function(e){return{chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:ig.Q9.Chat,element:(t=e,a.createElement(eE,Object.assign({},t)))}},chatMessageBodyData:mL,stopLoadingUi:!0};var t}(u)),VS(e,t.handoffMessageRequestSubmitTime),[2]}))}))()}}]),e}(),bK=function(){function e(t,n){Sp(this,e),(0,i._)(this,"copilotChatRef",void 0),(0,i._)(this,"handoffMessageRequestSubmitTime",void 0),this.copilotChatRef=t,this.handoffMessageRequestSubmitTime=n}return Ep(e,[{key:"isFeature",value:function(e){return!0}},{key:"handleValidation",value:function(e){cK(e.context),lK(e.query)}},{key:"handleExecution",value:function(e){var t=this;return(0,gd._)((function(){return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return[4,uK(e.query)];case 1:return n.sent(),VS(e,t.handoffMessageRequestSubmitTime),[2]}}))}))()}}]),e}(),EK=function(e){eC(n,e);var t=aC(n);function n(){return Sp(this,n),t.call(this,new tK)}return Ep(n,[{key:"getHandoffMessageIdSignal",value:function(e,t,n){return new uT({handOffMessageId:t,handoffOperation:n,queryId:e})}},{key:"isHandoffAutoSubmitPromptsEnabled",value:function(){return Jh(Dh.IsHandoffAutoSubmitPromptsEnabled)}},{key:"processHandoffMessage",value:function(e){for(var t=Sb.getInstance().getChatRef(),n=[new yK(t,this.handoffMessageIdRequestSubmitTime),new CK(t,this.handoffMessageIdRequestSubmitTime),new SK(t,this.handoffMessageIdRequestSubmitTime),new bK(t,this.handoffMessageIdRequestSubmitTime)],r=0;r<n.length;r++){var o=n[r];if(o.isFeature(e)){o.handleValidation(e),o.handleExecution(e);break}}}},{key:"sendHandoffDocUrlSignal",value:function(){var e,t=Office.context.document.url,n=new sK({documentUrl:t}),r=new Vp.Xr({parentPath:["session","doc"],items:[{id:aT.generateId(),body:n}]});null===(e=Sb.getInstance().getChatRef().current)||void 0===e||e.submitOperation({operation:r,workflowAnnotationType:sK.getTypeName()})}}],[{key:"getInstance",value:function(){return n._instance||(n._instance=new n),n._instance}}]),n}(Nh);(0,i._)(EK,"_instance",void 0);var TK=function(){return Office&&"ExtensionLifeCycle"in Office&&"taskpane"in Office.ExtensionLifeCycle};function IK(){return _K.apply(this,arguments)}function _K(){return(_K=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return ZR("Closing Shared Header"),TK()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.close()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function wK(){return PK.apply(this,arguments)}function PK(){return(PK=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return ZR("Moving Shared Header"),TK()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.move()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function xK(){return(xK=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return ZR("Shared Header Loaded"),TK()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.notifyHeaderLoaded()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function kK(){if(_p.isWin32Platform())return{buttons:[{type:oU.Move,clickHandler:wK},{type:oU.Close,clickHandler:IK}]}}var AK={rootStack:Cd({textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},Xa.Pt.gap("12px"),Xa.Pt.padding("0px","0px","10px","0px"))},LK=(0,Za.n)(AK),DK=function(e,t){var n=LK();return{SketchCard:function(r){var o=yd(a.useState(0),2),i=o[0],s=o[1],l=function(){var t=(0,gd._)((function(){return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,e(r.images[i],r.altText[i])];case 1:return t.sent(),[2]}}))}));return function(){return t.apply(this,arguments)}}(),c=function(){var e=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,t()];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}();return a.useEffect((function(){r.isRehydration||c()}),[r.isRehydration]),a.createElement(_j.W,{style:n.rootStack},r.images&&r.images.map((function(e,t){return a.createElement(VU,{src:e,key:t,alt:r.altText[t],shape:"rounded",onClick:function(){!function(e){s(e)}(t)},shadow:i===t&&r.images.length>1,"aria-selected":i===t,tabIndex:0})})),a.createElement(_j.W,{horizontal:!0},a.createElement(al,{size:"small",onClick:l,icon:a.createElement(RW.rz9,null),tabIndex:0},"Insert")))}}},OK=n(58651),NK=Gg.Unknown,RK=!1,FK=!0,MK=!1,BK=mb.getInstance(),UK=sb.getInstance(),HK=ob.getInstance(),GK=Tb.getInstance();Jh(Dh.UseNewCopilotSharedPackage)&&function(e,t,n,r){Hp=e,Gp=t,wp=n,Pp=r}("PPT",ZR,HK,{IsClpEnabledInEnterpriseForSydney:function(){return Jh(Dh.IsClpEnabledInEnterpriseForSydney)},IsApplyLabelUsingTryUpgradeLabelEnabled:function(){return Vh(Lh.IsApplyLabelUsingTryUpgradeLabelEnabled)},IsUserTypeEnterprise:function(){return oF(WK())},getOfficeJSDocumentURL:function(){return dR()},shouldCLPExceptionDisableEnterpriseSearch:function(){return Jh(Dh.ShouldCLPExceptionDisableEnterpriseSearch)},setEnableEnterpriseSearchOverride:DS,getFeedbackData:NN});var zK,qK=function(e){var t,r=e.theme,o=void 0===r?Sh.G.defaultWhite:r,s=e.isHighContrast,l=void 0!==s&&s,c=function(e,t,n,r){if(Le){var o=Fe,i=o.find((function(t){return t.queryId===e}));if(void 0!==i){var a=o.indexOf(i);o[a].telemetry=t}else o.push({queryId:e,telemetry:t});if(r){var s={messages:r,requests:Ed(Fe.map((function(e){return Sd(Cd({},e),{requestId:e.queryId})}))),id:n,isFirstMessageTrigger:!0,status:"Success"};qe({conversation:s})}Me(o),u()}},u=function(){He($A())},d=function(e){return Nn.apply(this,arguments)},p=yd((0,a.useState)(Gg.Unknown),2),g=p[0],m=p[1],f=yd(a.useState({objectId:"",tenantId:""}),2),h=f[0],v=f[1],y=(0,a.useRef)(g),C=yd((0,a.useState)(!1),2),S=C[0],b=C[1],E=yd(a.useState(void 0),2),T=E[0],I=E[1],_=yd((0,a.useState)(Vd.BLANK),2),w=_[0],P=_[1],x=yd((0,a.useState)(CH(w,g)),2),k=x[0],A=x[1],L=yd((0,a.useState)(_H(w,g)),2),D=L[0],O=L[1],N=(0,a.useRef)(k),R=(0,a.useRef)(D),M=yd((0,a.useState)(ZU(!0)),2),B=M[0],U=M[1],H=yd((0,a.useState)(0),2),G=H[0],z=H[1],q=(0,a.useRef)(G),W=yd((0,a.useState)(0),2),j=W[0],V=W[1],Q=(tH(),{promptSuggestionHintCardMap:eH}),J=a.useRef([]),K=a.useRef([]),X=a.useRef(MC.Unset),Z=yd((0,a.useState)([]),2),Y=Z[0],$=Z[1],ee=UH(Y,$,o).launchCopilotLab,te=function(e,t,n,r,o){var i=yd((0,a.useState)(jH(e,t,r,o)),2),s=i[0],l=i[1];return(0,a.useEffect)((function(){l(jH(e,t,r,o))}),[e,t,n,r,o]),s}(G,g,j,Y,ee),ne=function(e,t,n,r,o){var i=yd((0,a.useState)(VH(e,t,r,o)),2),s=i[0],l=i[1];return(0,a.useEffect)((function(){l(VH(e,t,r,o))}),[e,t,n,r,o]),s}(G,g,j,Y,ee),re=a.useRef(!1),oe=yd((0,a.useState)(!1),2),ie=oe[0],ae=oe[1],se=yd((0,a.useState)(tE.NotACommand),2),le=se[0],ce=se[1],ue=a.useRef(!1),de=yd(a.useState(void 0),2),pe=de[0],ge=(de[1],yd(a.useState(Tk()),2)),me=ge[0],fe=ge[1],he=yd(a.useState(!1),2),ve=he[0],ye=he[1],Ce=yd((0,a.useState)(!1),2),Se=Ce[0],be=Ce[1],Ee=yd(a.useState(void 0),2),Te=Ee[0],Ie=Ee[1],_e=yd(a.useState(!1),2),we=_e[0],Pe=_e[1],xe=a.useRef(!1),ke=a.useRef((0,dg.A)()),Ae=a.useRef(null),Le=Vh(Lh.IsSydneyDebugToggleEnabled)||Vh(Lh.IsDebugSectionV2Enabled),De=yd(a.useState(""),2),Oe=De[0],Ne=De[1],Re=yd(a.useState([]),2),Fe=Re[0],Me=Re[1],Be=yd(a.useState(),2),Ue=Be[0],He=Be[1],Ge=yd(a.useState(),2),ze=Ge[0],qe=Ge[1],We=yd(a.useState(!1),2),je=We[0],Ve=We[1],Qe=yd(a.useState(),2),Je=Qe[0],Ke=Qe[1],Xe=yd(a.useState(Le?{conversationId:Oe,telemetryData:Fe,isDebugToggleEnabled:Le,sessionId:kA,conversationLogObject:Ue,sydneyConversationObject:ze,debugMessageInfoObject:Je,showDebugInfoMessage:je,setShowDebugInfoOnMessage:Ve,sdxVersion:vF(),augloopKustoQueryURL:"",clientKustoQueryURL:""}:void 0),2),Ze=Xe[0],Ye=Xe[1],$e=a.useRef((0,EO.XG)()),et=bh({clientInfoRef:$e,theme:o,locale:TS(_p.GetHostAppDisplayLanguage()),clientId:$g,redirectUri:sN(),isWebPlatform:_p.isWebPlatform()}).onAttachCloudFiles,tt=EK.getInstance(),nt=tt.getDocumentHandoffMessageId(),rt=yd((0,a.useState)(!1),2),ot=rt[0],it=rt[1],at=Qh(),st=yd((0,a.useState)(null),2),lt=st[0],ct=st[1],ut=yd((0,a.useState)(!1),2),dt=ut[0],pt=ut[1],gt=yd(a.useState(!1),2),mt=gt[0],ft=gt[1],ht=yd(a.useState(!1),2),vt=ht[0],yt=ht[1],Ct=yd(a.useState(""),2),St=Ct[0],bt=Ct[1],Et=yd((0,a.useState)({displayName:rM,email:rM}),2),Tt=Et[0],It=Et[1],_t=yd((0,a.useState)(""),2),wt=_t[0],Pt=_t[1],xt=yd(a.useState(Ch.LAUNCH_WITH_REVIEWERS),2),kt=xt[0],At=xt[1];a.useEffect((function(){q.current=G,wn()}),[G]),a.useEffect((function(){y.current=g}),[g]),a.useEffect((function(){N.current=k}),[k]),a.useEffect((function(){R.current=D}),[D]),a.useEffect((function(){U(ZU(ve)),ZR("Feedback button is shown: "+ve)}),[ve]),a.useEffect((function(){var e,t;ie?null===(e=nn.current)||void 0===e||e.updateLoadingComponentProps({showStopGeneratingButton:!pd(),showInlineStopGeneratingButton:pd()}):null===(t=nn.current)||void 0===t||t.updateLoadingComponentProps({showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})}),[ie]),a.useEffect((function(){RK=me,Cn((function(e){return Sd(Cd({},e),{isFluxFlowEnabled:me})})),HK.setIsFluxEnabled(_k(me)),fn((function(e){return Sd(Cd({},e),{toggleUiProps:Sd(Cd({},e.toggleUiProps),{trySydneyToggleChecked:void 0!==me&&me})})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(e){return Sd(Cd({},e),{toggleUiProps:Sd(Cd({},e.toggleUiProps),{trySydneyToggleChecked:void 0!==me&&me})})}))}),[me]),a.useEffect((function(){var e=!at&&mt;fn((function(t){return Sd(Cd({},t),{toggleUiProps:Sd(Cd({},t.toggleUiProps),{reviewerAgentToggleChecked:e})})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(t){return Sd(Cd({},t),{toggleUiProps:Sd(Cd({},t.toggleUiProps),{reviewerAgentToggleChecked:e})})}))}),[mt]);var Lt=a.useCallback((function(){pt(!0),OK.log("handleReviewerAgentToggle User Query: ",St),setTimeout((function(){pt(!1)}),2e3)}),[]),Dt=a.useCallback((function(e,t){var n=null==t?void 0:t.checked;ZR("Toggling Reviewer Agent to "+(n?"on":"off")),qn(n?_B:IB),ft(null!=n&&n),bt(""),yt(!1),At(Ch.LAUNCH_FROM_TOGGLE),Lt()}),[Lt]);a.useEffect((function(){fn((function(e){return Sd(Cd({},e),{streamingUiProps:{cardDataValue:pe}})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(e){return Sd(Cd({},e),{streamingUiProps:{cardDataValue:pe}})}))}),[pe]);var Ot,Nt,Rt,Ft=a.useMemo((function(){var e=$e.current.userPrincipalName;return new im({userPrincipalName:e,redirectUri:sN(),logTelemetry:Vh(Lh.LogMSALTokenRequestTelemetry)})}),[$e.current]),Mt=a.useMemo((function(){var e=$e.current.userPrincipalName;return new im({userPrincipalName:e,redirectUri:sN(),clientId:$g,logTelemetry:Vh(Lh.LogMSALTokenRequestTelemetry)})}),[$e.current]),Bt=function(e,t,n,r){return{trySydneyToggleOnChange:e,trySydneyToggleChecked:t,trySydneyToggleEnabled:!1,tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryReviewerAgentToggleOnChange:n,tryReviewerAgentToggleChecked:r,tryReviewerAgentToggleEnabled:Qh()&&zh("IsReviewerAgentToggleEnabled",!1)}}((function(e,t){var n=null==t?void 0:t.checked;ZR("Toggling Try Sydney to "+(n?"on":"off")),fe(null!=n&&n)}),me,Dt,mt),Ut=function(){var e=(0,gd._)((function(){var e,t;return(0,F.__generator)(this,(function(n){return e=function(e,t,n){var r=[],o=-1;for(XR(e);r.length<t&&o<e.length;)o++,r.find((function(t){return t===e[o%e.length]}))||n.find((function(t){return t===e[o%e.length]}))||r.push(e[o%e.length]);return r}(K.current,2,J.current),J.current=e.slice(0,2),t=function(e){switch(e){case MC.AddImage:case MC.AddEnterpriseImage:case MC.AddSlide:return Iv.AddContent;case MC.CreatePresentation:case MC.CreateFromFile:return Iv.CreatePresentation;case MC.Organize:return Iv.Organize;case MC.Summarize:case MC.ShowActionItems:case MC.KeySlides:return Iv.Summarize;case MC.Animate:case MC.Beautify:return Iv.BasicCommand;case MC.Help:return Iv.DocumentQnA;case MC.BasicChat:case MC.Sydney:case MC.SelfHelpSearch:return Iv.ChatQnA;default:return Iv.CopilotChat}}(X.current),HK.logSeenEvent(t,X.current,Hw(t)),fn((function(e){return Sd(Cd({},e),{suggestionPillsUiProps:Sd(Cd({},e.suggestionPillsUiProps),{suggestionList:J.current})})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(e){return Sd(Cd({},e),{suggestionPillsUiProps:Sd(Cd({},e.suggestionPillsUiProps),{suggestionList:J.current})})})),[2]}))}));return function(){return e.apply(this,arguments)}}(),Ht=function(e,t){return{suggestionList:t?[FF()]:[],showRefreshButton:!0,onRefreshButtonClicked:e}}(Ut,SN),Gt=function(){J.current=K.current.slice(0,2),ZR("Setting suggestion list here...   ".concat(J.current)),fn((function(e){return Sd(Cd({},e),{suggestionPillsUiProps:Sd(Cd({},e.suggestionPillsUiProps),{suggestionList:J.current})})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(e){return Sd(Cd({},e),{suggestionPillsUiProps:Sd(Cd({},e.suggestionPillsUiProps),{suggestionList:J.current})})}))},zt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MC.BasicChat,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Iv.ChatQnA;ZR("Setting pill Bank to : ".concat(e)),K.current=e,e.length>0?(HK.logSeenEvent(n,t,Hw(n)),X.current=t):SN&&(K.current=[FF()].concat(Ed(K.current))),Gt()},qt={isDarkModeEnabled:o===Sh.G.defaultBlack,isHighContrastModeEnabled:l},Wt={profile:fB.pptChat,settings:{hostAppId:YU(),hostAppName:"PowerPoint",hostAppPlatform:$U(),hostAppScenario:"Copilot",hostDefaultLocale:TS(_p.GetHostAppDisplayLanguage()),isDogfoodEnvironment:VR(),customizedEmptyECCSuggestionsString:PowerpointCopilotStrings.TransformDocumentCiqEmptyPlaceholderMessage,sessionId:null!==(Ot=ke.current)&&void 0!==Ot?Ot:HK.getCopilotChatSessionId(),useFluentV9:Vh(Lh.EditorFluentV9SettingEnabled)},telemLogger:{logError:function(e){ZR("Shared Copilot CIQ Error Log: ",e)}},telemSink:Vh(Lh.ShouldSendTelemetrySink)?YS.getInstance().getTelemetrySink():void 0,transformFileMenuTitle:PowerpointCopilotStrings.TransformDocumentCiqMenuTitle,transformFilePlaceholderText:PowerpointCopilotStrings.TransformDocumentPromptPlaceholder,entitiesSupported:[Iw.ck.File],isExpandedECCEnabled:!1,getSensitivityInfo:Vh(Lh.IsInputV2Enabled)?HL:void 0,onOpenGptStorefront:Jh("IsAtMentionRedirectURLSetup")?Sm:void 0,onAttachCloudFiles:et},jt={settings:{hostAppId:YU(),hostAppName:"PowerPoint",hostAppPlatform:$U(),hostAppScenario:Jh(Dh.IsCreatePresentaionCIQAppScenarioEnabled)?"Copilot":void 0,hostDefaultLocale:TS(_p.GetHostAppDisplayLanguage()),isDogfoodEnvironment:VR(),customizedEmptyECCSuggestionsString:PowerpointCopilotStrings.TransformDocumentCiqEmptyPlaceholderMessage,sessionId:null!==(Nt=ke.current)&&void 0!==Nt?Nt:HK.getCopilotChatSessionId(),enableAutomaticScoping:!0,useFluentV9:Vh(Lh.EditorFluentV9SettingEnabled)},telemLogger:{logError:function(e){ZR("Shared Copilot CIQ Error Log: ",e)}},telemSink:Vh(Lh.ShouldSendTelemetrySink)?YS.getInstance().getTelemetrySink():void 0,transformFileMenuTitle:PowerpointCopilotStrings.TransformDocumentCiqMenuTitle,transformFilePlaceholderText:PowerpointCopilotStrings.TransformDocumentPromptPlaceholder,entitiesSupported:[Iw.ck.People,Iw.ck.File,Iw.ck.Event,Iw.ck.Message],isExpandedECCEnabled:!0,getSensitivityInfo:Vh(Lh.IsInputV2Enabled)?HL:void 0,featureFlags:{enableAppGptsInCiq:zh("IsEnableAppGptsInCIQ"),enableAppPluginsInCiq:zh("IsEnableAppPluginsInCIQ"),enableTopicECC:zh("IsEnableTopicECC"),enableAppMessageExtensionsInCiq:zh("IsEnableAppMsgExtInCIQ"),enableAppPPInCiq:zh("IsEnableAppPPInCIQ"),enableAppTypeBInCiq:zh("IsEnableAppTypeBInCIQ")},onOpenGptStorefront:Jh("IsAtMentionRedirectURLSetup")?Sm:void 0,onAttachCloudFiles:et,inlineSuggestionsStyles:MH},Vt=(0,a.useCallback)((function(){if(xk()){var e=[];return Vh(Lh.EnableEnterpriseToggleInPhase2Ux)&&e.push({id:iU.$.Work,onToggle:function(e){ZR("Microsoft M365 toggle is "+(e?"enabled":"turned off")),DS(e),Ie(e)},state:Te?aU.p.Enabled:aU.p.Disabled}),e.push({id:iU.$.Web,onToggle:function(e){ZR("Web Content toggle is "+(e?"enabled":"turned off")),Pe(e),OS=e,FK?FK=!1:(ZR("Clearing suggestion list and cache on Grounding source change. Web Search:"+(e?"on":"off")),Ln(),zt([]))},state:we?aU.p.Enabled:aU.p.Disabled}),e}}),[Te,we]),Qt=function(){return zR.IsSettingTrue(DR.PPTCIQDocMenuEnabled)&&(!Jh(Dh.EnableCIQWithUserTypeCheck)||S&&Lk())},Jt={chatPlaceholderMessage:qM(),chatRestShyPlaceholderMessage:PowerpointCopilotStrings.AskAQuestionPlaceholder,voiceInputProps:pd()?void 0:{voiceInputLocale:_p.GetHostAppDisplayLanguage(),microphonePermissionErrorMessage:GM(),microphonePermissionErrorTitle:HM(),microphonePermissionImagePath:zM()?n(83226):void 0,showMicrophonePermissionHelpLink:zM()},editorConfig:Qt()?Wt:void 0};if(Qt()){var Kt=Vh(Lh.IsAllEntitiesSupported)&&xk();Rt=Wt,MK&&Kt&&(Rt=Te?jt:Wt)}var Xt,Zt=cE(HK),Yt=function(e){try{return e.reduce((function(e,t){return e[t.hvcPromptList.join("").toLocaleLowerCase()]=t.hvcCategory,e}),{})}catch(e){ZR("Error in getHVCPromptToCategoryMap:",e)}return{}}(Zt),$t=function(e){try{return e.map((function(e){return{tokenPhrases:e.hvcPromptList}}))}catch(e){ZR("Error in getHVCPromptStringsAPIs:",e)}return[]}(Zt);Jh(Dh.UseSortedHVCTokenList)&&((Xt=$t.map((function(e){var t=e.tokenPhrases.join("");return{concatenatedString:t,length:t.length,tokenList:e}}))).sort((function(e,t){return e.concatenatedString.startsWith(t.concatenatedString)?-1:t.concatenatedString.startsWith(e.concatenatedString)?1:e.concatenatedString<t.concatenatedString?-1:e.concatenatedString>t.concatenatedString?1:e.length-t.length})),$t=Xt.map((function(e){return e.tokenList})));var en=(0,a.useCallback)((function(){return{chatPlaceholderMessage:qM(),chatRestShyPlaceholderMessage:PowerpointCopilotStrings.AskAQuestionPlaceholder,transfromFileNonCIQPlaceholderMessage:PowerpointCopilotStrings.TransformWordDocumentNonCiqPlaceholder,menuProps:ne,voiceInputProps:pd()?void 0:{voiceInputLocale:_p.GetHostAppDisplayLanguage(),microphonePermissionErrorMessage:GM(),microphonePermissionErrorTitle:HM(),microphonePermissionImagePath:n(83226)},editorConfig:Rt,buttonProps:{ciqButtonEnabled:Vh(Lh.IsCIQPaperClipButtonEnabled),groundingButtonEnabled:xk()},pluginsInfo:Vt(),characterLimitErrorMessage:fm()?OfficeaicopilotStrings.ChatInputCharacterLimitExceededMessage:"Character limit exceeded",isHVCAppChatV2Enabled:dE(),hvcPromptStringsList:$t,isCardSpanWrappingEnabled:Jh(Dh.IsCardSpanWrappingEnabled),imageInputEnabled:Vh(Lh.IsImageInputEnabled),isImageInputButtonEnabled:Vh(Lh.IsImageInputEnabled),imageSizeLimitInMB:Jh(Dh.IsImageResizeEnabled)?qh(Lh.ImageSizeLimitInMBWhenResizing,10):Vh(Lh.UseImageSizeLimitInKB)?Math.round(qh(Lh.ImageSizeLimitInKB,700)/1024*100)/100:qh(Lh.ImageSizeLimitInMB,1),isImageResizeEnabled:Jh(Dh.IsImageResizeEnabled),imageResizedSizeInKB:qh(Lh.ImageResizedSizeInKB,290),imageResizePreferredSizeInPx:JSON.parse(jh(Lh.ImageResizePreferredSizeInPx,"[2000, 1024, 800, 512]")),imageResizeCompressionQuality:qh(Lh.ImageResizeCompressionQuality,85)/100,onChatInputHVCPromptUpdated:function(e,t){if(t){var n=uE(e,Yt);ce(n),ZR("HVC PPTSupportedCommandCategory detected: ",n),ue.current=!1}else!1===ue.current&&(ce(tE.NotACommand),ZR("HVC PPTSupportedCommandCategory removed"))},onUserQuerySubmitted:function(){ue.current=!0}}}),[Te,we,ne,g,S]),tn=a.useMemo((function(){ZR("Updating host token provider");var e=oF(g)?"AAD":"MSA";return{getToken:function(e){return aN(pG.dW,e)},accountInfo:{userId:h.objectId,tenantId:h.tenantId},identityType:e,isEUDBUser:T}}),[g,h,T]),nn=a.useRef(null);Sb.getInstance().setChatRef(nn);var rn=TU.getInstance((function(e,t){return On.apply(this,arguments)}),(function(e,t){return Rn.apply(this,arguments)}),nn,(function(e){var t=k.promptSuggestionList.findIndex((function(t){return t.suggestionText===e}));-1!==t&&A((function(e){var n=Cd({},e);return n.promptSuggestionList[t].isDisabled=!0,n}))}),(function(e,t){return Fn.apply(this,arguments)}),ae,it,zt),on=function(e,t,n){return(0,a.useMemo)((()=>new pH(t,e,n)),[t,e,n])}(nn,rn,{handlePlanStartClicked:function(e){ZR("User requested to start plan. This is being called from CopilotChatShared in the office monorepo."+JSON.stringify(e)),Mx(e,nn,ae,xn,it,xe)},odslPlugins:aH}),an=yd((0,a.useState)(en()),2),sn=an[0],ln=an[1],cn=function(e,t,n,r,o,i,s){return{DesignerCard:function(l){return l.clientSessionId&&(t.sessionId=l.clientSessionId),l.turnId&&(t.correlationId=l.turnId),r&&r.accountInfo&&(l.objectId&&!r.accountInfo.userId&&(r.accountInfo.userId=l.objectId),l.tenantId&&!r.accountInfo.tenantId&&(r.accountInfo.tenantId=l.tenantId)),a.createElement(a.Suspense,{fallback:a.createElement(uG,{size:"extra-tiny"})},a.createElement(dG,Sd(Cd({},l),{insertImagesInCanvas:e,hostCallback:n,hostTokenProvider:r,clientSettings:t,handleDesignerHistoryEvent:o,handleDesignerError:i,handleDesignerTelemetry:s})))}}}(function(){var e=(0,gd._)((function(e,t,n,r){return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return[4,rP(e,null==t?void 0:t.description,null==t?void 0:t.altText,null==t?void 0:t.license,UK,null==t?void 0:t.isUrl,null==t?void 0:t.pac,(function(e,t,n){ZP(e,nn,xe,t,n,void 0,!0)}),n,r,Ae)];case 1:return o.sent(),[2]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),{hostAppName:"PowerPointCopilotChat",clientId:(0,dg.A)(),designerTheme:Xw((0,cw.$x)(),(0,cw.R2)()),platformType:Kw(),hostBuildVersion:Jw(),sessionId:zR.getSettingAsString(DR.ChatPPTSessionID),selectedDesignerEnv:Vh(Lh.IsDesignerDogfoodEndpointEnabled)?"dogfood":"production",uiLanguage:TS(_p.GetHostAppDisplayLanguage()),audienceGroup:VR()?"Dogfood":"Production",showFeedBackSection:!1},(function(e){oP(e,nn)}),tn,(function(e){!function(e,t){var n;ZR("historyEventData received from designer: ",e.data);var r=null==t||null===(n=t.current)||void 0===n?void 0:n.getLastMessage(),o=ob.getInstance().getQueryGuid(),i=cP(o);if(r&&r.messageType===jp._.ChatCardWrapper&&e&&Jh(Dh.IsDalleImageRehydrationEnabled)){var a,s=r.body;if((null===(a=s.renderData)||void 0===a?void 0:a.component)===pp.DesignerCard){var l,c=null===(l=s.renderData)||void 0===l?void 0:l.props;if(!c.base64ImageData){var u,d,p,g,m,f,h,v,y=null===(u=c.message)||void 0===u?void 0:u.toString(),C=e.data;ob.getInstance().sendChatEventTelemetry(Ed(i).concat([{key:cC.ChatEventType,value:dC.DesignerBase64ImagesReceived},{key:cC.ChatEventParameters,value:(null!==(f=null===(d=C.data.base64Thumbnail)||void 0===d?void 0:d.length)&&void 0!==f?f:0)>0?"success":"failure"}]));var S=Sd(Cd({},c),{base64ImageData:C.data.base64Thumbnail,generatedImageUrls:C.data.imgUrl,historyEventLocale:null!==(h=null===(p=C.metadata)||void 0===p?void 0:p.locale)&&void 0!==h?h:"",historyEventLanguage:null!==(v=null===(g=C.metadata)||void 0===g?void 0:g.language)&&void 0!==v?v:"",historyEventTimeStamp:C.timeStamp});null===(m=t.current)||void 0===m||m.updateLastMessage({chatCardType:jp._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:y,renderData:{component:pp.DesignerCard,props:S}}},chatMessageBodyData:{feedbackSectionPosition:ag.O.Footer,feedbackData:Qw,messageId:Vw,chatHydrationKeys:{imagesKey:"base64ImageData"}}})}}}}(e,nn)}),iP,aP).DesignerCard;XU.renderers.DesignerCard=cn;var un=DK(MW,(0,gd._)((function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,jW(nn)];case 1:return e.sent(),[2]}}))}))).SketchCard;XU.renderers.SketchCard=un;var dn,pn,gn=yd((0,a.useState)({zeroQueryMessageProps:k,menuProps:te,chatInputProps:Jt,hintCardProps:Q,toggleUiProps:Bt,suggestionPillsUiProps:Ht,streamingUiProps:{cardDataValue:pe},chatContainerUiProps:B,documentSensitivityProps:GK.getSensitivity(),customMessageRenderers:XU,changeTopicUiProps:{hideChangeTopicButton:Pk()},chatHistoryUiProps:{enableChatHistoryV2:kk(),enableChatHistoryLocalStorage:Ak(),isGptsEnabled:Vh(Lh.IsCustomGPTsEnabled)},creditsUIProps:Vh(Lh.IsCreditsUIInternalEnabled)?{creditUpsellHandler:Tm,upsellFwdLinkId:OF(),clientParam:NF()}:void 0}),2),mn=gn[0],fn=gn[1],hn=GK.shouldShowInDocSensitivityLabel()?GK.getInDocSensitiveLabelInfo():void 0,vn=yd((0,a.useState)({citationTitle:lM(),isFluxFlowEnabled:me,sensitivityIndicatorData:hn?{tooltipText:null!==(dn=hn.description)&&void 0!==dn?dn:"",badgeText:null!==(pn=hn.displayName)&&void 0!==pn?pn:"",iconType:hn.encryptionType!==Tp.None?uf.JF.Encryption:uf.JF.NonEncryption}:void 0,isCitationsEnabled:Jh(Dh.IsCitationsEnabled)}),2),yn=vn[0],Cn=vn[1],Sn=a.useMemo((function(){var e,t=Kf.getInstance();nn.current&&t.setProxyOperator(null===(e=nn.current)||void 0===e?void 0:e.executePluginOperation);return t}),[nn.current]),bn=yd((0,a.useState)({zeroQueryMessageProps:Vh(Lh.IsZQMV2Enabled)?void 0:k,zeroQueryMessageV2Props:Vh(Lh.IsZQMV2Enabled)?D:void 0,chatInputV2Props:sn,toggleUiProps:Bt,suggestionPillsUiProps:Ht,streamingUiProps:{cardDataValue:pe},chatContainerUiProps:B,documentSensitivityProps:GK.getSensitivity(),copilotLabProps:Vh(Lh.IsSharedCopilotLabEnabled)?{isCopilotLabHeaderDisabled:!_p.isWebPlatform(),copilotLabLink:yF(),facets:Jh(Dh.ShouldSendCopilotLabCategories)?mm(NR()):void 0}:void 0,customMessageRenderers:XU,changeTopicUiProps:{hideChangeTopicButton:Pk()},chatHistoryUiProps:{enableChatHistoryV2:kk(),enableChatHistoryLocalStorage:Ak(),isGptsEnabled:Vh(Lh.IsCustomGPTsEnabled)},clientInfoProps:$e.current?{clientInfo:$e.current,taskModuleLauncher:Sn.launchTaskModule.bind(null,Vh(Lh.ShouldLaunchTaskModuleInNewWindow))}:void 0,creditsUIProps:Vh(Lh.IsCreditsUIInternalEnabled)?{creditUpsellHandler:Tm,upsellFwdLinkId:OF(),clientParam:NF()}:void 0}),2),En=bn[0],Tn=bn[1];function In(){return(In=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return[4,AR(o,l)];case 1:return e=t.sent(),ZR("SDX ClientInfo : ",e),$e.current=e,Tn((function(t){return Sd(Cd({},t),{clientInfoProps:{clientInfo:e,taskModuleLauncher:Sn.launchTaskModule.bind(null,Vh(Lh.ShouldLaunchTaskModuleInNewWindow))}})})),[2]}}))}))).apply(this,arguments)}(0,a.useEffect)((function(){fn((function(e){return Sd(Cd({},e),{chatInputProps:Sd(Cd({},e.chatInputProps),{isDisabled:ot})})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(e){return Sd(Cd({},e),{chatInputV2Props:Sd(Cd({},e.chatInputV2Props),{isDisabled:ot})})}))}),[ot]),(0,a.useEffect)((function(){A(CH(w,g)),Vh(Lh.IsZQMV2Enabled)&&O(_H(w,g))}),[w,g]),(0,a.useEffect)((function(){ln(en)}),[en]),(0,a.useEffect)((function(){var e;function t(){return(t=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return oF(g)?[4,(e=Tb.getInstance(Cn)).setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2];case 1:t.sent(),e.setLabelChangeEventListener(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}sF(),_n(),VO(),wn(),HK.setCopilotChatSessionId(null!==(e=ke.current)&&void 0!==e?e:rM),function(){t.apply(this,arguments)}(),null==BK||BK.addHandlerCleanup(gk),null==BK||BK.addHandlerCleanup(tL),null==BK||BK.addHandlerCleanup(BO),function(){return qR.apply(this,arguments)}().then((function(e){ye(e)}));var n=zR.getSettingAsString(DR.ChatPPTSessionID);ZR("ChatPPT Session Id - "+(cF(n)?rM:n)),zR.IsSettingTrue(DR.PPTCreatorEnabled)&&function(e,t){var n=zR.getSettingAsString(DR.PPTStoryTellerExecutionResponse);ZR("PPT StoryTeller ResponseJson: "+n);try{var r=JSON.parse(n);if(0===r.length||cF(r[r.length-1].query))return;var o,a=r[r.length-1];switch(pN.sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,dC.StoryTellerResponseInChat),(0,i._)(o,cC.ChatEventParameters,a.status.toLowerCase()),o))),a.query,mN=a.status,fN=a.contextData,a.status.toLowerCase()){case Gd.Failure:var s,l={errorMessage:PowerpointCopilotStrings.StorytellerFailureMessage,errorType:yp.StorytellerFailureMessage,featureName:_C.CreatePresentation,subFeatureName:MC.CreatePresentation};null===(s=e.current)||void 0===s||s.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerFailureMessage,hL,!0,Wd.COPILOTSTART,void 0,!1,!0,void 0,l));break;case Gd.Cancelled:var c,u,d={featureName:_C.CreatePresentation,subFeatureName:void 0};null===(c=e.current)||void 0===c||c.addResponseMessage(IL(a.query,yL,!0,d)),null===(u=e.current)||void 0===u||u.addResponseMessage(TL(PowerpointCopilotStrings.StorytellerCancelledMessage,hL,!0,Wd.COPILOTSTART,void 0,!1,!0,void 0,d));break;case Gd.Success:var p,g,m={featureName:_C.CreatePresentation,subFeatureName:void 0};null===(p=e.current)||void 0===p||p.addResponseMessage(IL(a.query,yL,!0,m));var f=GF()[3],h=_L(f,t,void 0,mL,!0,Wd.CHATPPT,void 0,void 0,m);null===(g=e.current)||void 0===g||g.addResponseMessage(h)}}catch(e){var v;ZR("Error while getting PPT storyteller execution response: "+e.message),pN.sendErrorTelemetry(HS((v={},(0,i._)(v,uC.ErrorMessage,"Error while getting PPT storyteller execution response"),(0,i._)(v,uC.ErrorCategory,IC.StoryTeller),v)))}}(nn,xn),Jh(Dh.ShouldSupportHVCDetectionOnClientSide)&&(rn.setHVCPromptStringsList($t),rn.setHVCPromptToHVCCategoryMap(Yt)),at&&(0,gd._)((function(){var e,t,n,r;return(0,F.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,rn.getALSession()];case 1:return e=o.sent(),[4,KJ()];case 2:return t=o.sent(),[4,_p.getDocumentUrlAsync()];case 3:return n=o.sent(),ct(e),It(t),Pt(n),[3,5];case 4:return r=o.sent(),OK.error("Failed to fetch session:",r),[3,5];case 5:return[2]}}))}))()}),[]),(0,a.useEffect)((function(){Vh(Lh.IsInputV2Enabled)?Tn({zeroQueryMessageProps:Vh(Lh.IsZQMV2Enabled)?void 0:k,zeroQueryMessageV2Props:Vh(Lh.IsZQMV2Enabled)?D:void 0,chatInputV2Props:sn,toggleUiProps:Bt,suggestionPillsUiProps:Ht,streamingUiProps:{cardDataValue:pe},chatContainerUiProps:B,documentSensitivityProps:GK.getSensitivity(),copilotLabProps:Vh(Lh.IsSharedCopilotLabEnabled)?{isCopilotLabHeaderDisabled:!_p.isWebPlatform(),copilotLabLink:yF(),facets:Jh(Dh.ShouldSendCopilotLabCategories)?mm(NR()):void 0}:void 0,customMessageRenderers:XU,changeTopicUiProps:{hideChangeTopicButton:Pk()},chatHistoryUiProps:{enableChatHistoryV2:kk(),enableChatHistoryLocalStorage:Ak(),isGptsEnabled:Vh(Lh.IsCustomGPTsEnabled)},clientInfoProps:$e.current?{clientInfo:$e.current,taskModuleLauncher:Sn.launchTaskModule.bind(null,Vh(Lh.ShouldLaunchTaskModuleInNewWindow))}:void 0,creditsUIProps:Vh(Lh.IsCreditsUIInternalEnabled)?{creditUpsellHandler:Tm,upsellFwdLinkId:OF(),clientParam:NF()}:void 0}):fn({zeroQueryMessageProps:k,menuProps:te,chatInputProps:Jt,hintCardProps:Q,toggleUiProps:Bt,suggestionPillsUiProps:Ht,streamingUiProps:{cardDataValue:pe},chatContainerUiProps:B,documentSensitivityProps:GK.getSensitivity(),customMessageRenderers:XU,changeTopicUiProps:{hideChangeTopicButton:Pk()},chatHistoryUiProps:{enableChatHistoryV2:kk(),enableChatHistoryLocalStorage:Ak(),isGptsEnabled:Vh(Lh.IsCustomGPTsEnabled)},creditsUIProps:Vh(Lh.IsCreditsUIInternalEnabled)?{creditUpsellHandler:Tm,upsellFwdLinkId:OF(),clientParam:NF()}:void 0})}),[te,k,sn,D,S]),(0,a.useEffect)((function(){var e,t,n;Le&&Ye({conversationId:Oe,telemetryData:Fe,isDebugToggleEnabled:Le,sessionId:kA,conversationLogObject:Ue,sydneyConversationObject:ze,debugMessageInfoObject:Je,showDebugInfoMessage:je,setShowDebugInfoOnMessage:Ve,sdxVersion:vF(),augloopKustoQueryURL:(e=kA,t="\n    let workflows = split('',',');\n    let audienceGroup = split('''',',');\n    let platforms = split('''',',');\n    WorkflowOperationEvent\n    | where operationName in (\"ActionAIExec\", \"FluxCopilot\")\n    | where TIMESTAMP > ago(1d)\n    | where resourceId in  (\"PowerPointFluxCopilot\")\n    | where  workflows[0] == '' or resourceId in~ (workflows)\n    | where  audienceGroup[0] == '' or clientReleaseAudienceGroup in~ (audienceGroup)\n    | where platforms[0] == '' or clientAppPlatform in~(platforms)\n    | extend extraFields = parse_json(dataFields)\n    | extend errMsg = tostring(extraFields[\"errMsg\"]), isChatHistory = tobool(extraFields[\"isOnlyChatHistorySignal\"])\n    | where isChatHistory != true\n    | extend queryId = tostring(extraFields[\"queryId\"])\n    | where isnotempty(queryId)\n    | extend errorName = case (isnotempty(tostring(extraFields[\"errorName\"])),tostring(extraFields[\"errorName\"]),\n                            isnotempty( tostring(extraFields[\"skillErrorName\"])), tostring(extraFields[\"skillErrorName\"]),\"Unknown\")\n    | extend errMsg = strcat(errMsg, '::')\n    | parse errMsg with endReason ':' errCode ':' *\n    | extend errorCategory = case(\n        success == 1, 'Success',\n        errMsg == '::', 'Success',\n        endReason in ('InputQueryError', 'UnsupportedLanguageError', 'Text2ImageError', 'OffensiveContent'), 'User',\n        endReason in ('ActionAIError', 'LicensingError', 'ResolveDelegationsError', 'InferenceAPIError', 'unexpected', 'ODSLSyntaxError', 'ODSLParseError', 'TokenCountError'), 'System',\n        'Uncategorized'\n    )\n    | extend Category = case(errorCategory == \"Success\", errorCategory,\n                            endReason == \"SkillFailedError\", strcat(endReason, \"-\", errCode, \"-\", errorName),\n                            endReason == \"SydneyError\", strcat(endReason, \"-\", errCode ),\n                            endReason)\n    | where sessionKey == '".concat(e,"'\n    | project sessionKey, clientSessionId, queryId, workflow, errorName, endReason, errCode, Category, errorCategory,extraFields\n    "),n=OW(t),{name:"Augloop Operations",description:"Get FluxCopilot operation for a given session id",linkUrl:"https://dataexplorer.azure.com/clusters/https%3a%2f%2fodxaugloop.eastus.kusto.windows.net/databases/ODX%20AugLoop%20Service?query=".concat(n),query:t}).linkUrl,clientKustoQueryURL:DW(kA).linkUrl})}),[Oe,Fe,Ue,ze,je,Je,kA]),(0,a.useEffect)((function(){(Vh(Lh.IsMsgExtEnabled)||Vh(Lh.IsCloudFileUploadEnabled))&&function(){In.apply(this,arguments)}()}),[o,l]);var _n=function(){var e=zR.getSettingAsString(DR.PPTDocumentState),t=null;try{t=JSON.parse(e)}catch(e){return void ZR("failed in parsing json for document state",e.message)}ZR("Received document state from Host App Settings ".concat(e)),cF(t)||ib.getInstance().setDocumentState(t)},wn=function(){var e=ib.getInstance().getSlideCount();V(e);var t=Vd.BLANK;e>1&&!ib.getInstance().isCreatePresentationEnabled()&&(t=G>=Dw()?Vd.USED:Vd.LESS_WORD_COUNT),P(t),ZR("Presentation type set : ",t)},Pn=function(){var e=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,PowerPoint.run(function(){var e=(0,gd._)((function(e){var t,n;return(0,F.__generator)(this,(function(r){switch(r.label){case 0:return(t=e.presentation.getSelectedSlides()).load({select:"id,items"}),[4,e.sync()];case 1:return r.sent(),(n=t.items.length)>1?(e.presentation.setSelectedSlides([t.items[n-1].id]),[4,e.sync()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),xn=function(){var e=(0,gd._)((function(){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,Pn()];case 1:return e.sent(),_p.GetHostAppPlatform()===yM||_p.GetHostAppPlatform()===SM||_p.GetHostAppPlatform()===bM?Office.context.ui.executeFeature(26891):pU({type:sU.ChatPPTShowDesigner,message:""}),[2]}}))}));return function(){return e.apply(this,arguments)}}(),kn=function(e,t){var n,r;(NK=e,m(e),b(!0),I(t),fe(Tk()),Cn((function(e){return Sd(Cd({},e),{isFluxFlowEnabled:Tk()})})),rF(e))?HK.sendChatEventTelemetry(HS((n={},(0,i._)(n,cC.ChatEventType,dC.PrimaryUserType),(0,i._)(n,cC.ChatEventParameters,"Consumer"),n))):HK.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.PrimaryUserType),(0,i._)(r,cC.ChatEventParameters,Gg[e]),r)))},An=function(e){z(e),re.current||(e>=Dw()&&!zR.IsSettingTrue(DR.TriggerSummary)&&Kx(),re.current=!0),Gt()},Ln=function(){fn((function(e){return Sd(Cd({},e),{suggestionPillsUiProps:Sd(Cd({},e.suggestionPillsUiProps),{clearCacheSuggestionPills:!0})})})),Vh(Lh.IsInputV2Enabled)&&Tn((function(e){return Sd(Cd({},e),{suggestionPillsUiProps:Sd(Cd({},e.suggestionPillsUiProps),{clearCacheSuggestionPills:!0})})}))};function Dn(){return Dn=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){e=cP("00000000-0000-0000-0000-000000000000");try{Office.context.auth.getAuthContextAsync((function(t){if("succeeded"===t.status){var n=t.value;if(n){var r=n.userObjectId||h.objectId,o=n.tenantId||h.tenantId;v({objectId:r,tenantId:o})}else ZR("Authcontext is undefined"),ob.getInstance().sendErrorTelemetry(Ed(e).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Authcontext fetched from OfficeJS is undefined"}]))}else{ZR("Failed to fetch user id from OfficeJS with status: ",t.status);var i="";try{i=JSON.stringify(t)}catch(e){i="".concat(t)}ob.getInstance().sendErrorTelemetry(Ed(e).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Failed to fetch user object from OfficeJS. Status=".concat(t.status,". Result=").concat(i)}]))}}))}catch(t){ZR("Error getting user id: "+t),ob.getInstance().sendErrorTelemetry(Ed(e).concat([{key:uC.ErrorCategory,value:IC.Designer},{key:uC.ErrorMessage,value:"Error thrown while fetching user Object. Message=".concat(t.message)},{key:uC.ErrorCode,value:t.code}]))}return[2]}))})),Dn.apply(this,arguments)}function On(){return On=(0,gd._)((function(e,t){var n,r,o,a=arguments;return(0,F.__generator)(this,(function(s){switch(s.label){case 0:if(ZR("handleResponseItem cv: ",n=a.length>2&&void 0!==a[2]?a[2]:rM),Wh("EnableALCorrelationLogs")||(n=""),!(null===(r=e.body)||void 0===r?void 0:r.H_))return[3,43];switch(e.body.H_.T_){case EP.getTypeName():return[3,1];case VE.getTypeName():return[3,3];case EE.getTypeName():return[3,5];case TE.getTypeName():return[3,7];case IE.getTypeName():return[3,9];case fb.getTypeName():return[3,11];case yw.getTypeName():return[3,13];case hb.getTypeName():return[3,15];case Cw.getTypeName():return[3,17];case dw.getTypeName():return[3,19];case gw.getTypeName():return[3,21];case ED.getTypeName():return[3,23];case TP.getTypeName():return[3,25];case IP.getTypeName():return[3,27];case xw.getTypeName():return[3,29];case uU.getTypeName():return[3,31];case dU.getTypeName():return[3,33];case gU.x.getTypeName():return[3,34];case _h.uC.getTypeName():return[3,35];case fD.getTypeName():return[3,36];case jL.getTypeName():return[3,38];case Kp.getTypeName():return[3,40];case Wk.getTypeName():return[3,41];case cO.getTypeName():return[3,42]}return[3,43];case 1:return BK.removeContextId(null===(o=e.body)||void 0===o?void 0:o.queryId),[4,Fx(e,nn,ae,xn,t,it,xe,n)];case 2:case 4:case 6:case 8:case 10:case 12:case 14:case 16:case 18:case 20:case 22:case 24:case 26:case 28:case 30:case 32:case 37:case 39:return s.sent(),[3,43];case 3:return[4,MA(e,nn,ae,xn,zt,t,it,Ne,c,xe,$e.current,Se,n,G,Ve,Ke,u)];case 5:return[4,Qx(e,nn,G,t,n)];case 7:return[4,dk(e,nn,G,n)];case 9:return[4,Ck(e,nn,G,n,Ve,Ke,u)];case 11:return[4,dD(e,nn,n)];case 13:return[4,AH(e,nn,xn,ae,Ln,xe,n)];case 15:return[4,RO(e,nn,n)];case 17:return[4,DH(e,nn)];case 19:return[4,ox(e,nn,xn,ae,xe,n)];case 21:return[4,mx(e,nn,xn,ae,Ln,xe,n)];case 23:return[4,_D(e,nn,xn,ae,xe)];case 25:return[4,BU(e,t,n)];case 27:return[4,zU(e,nn)];case 29:return[4,Rw(e,An,n)];case 31:return[4,xU(e,kn,n)];case 33:return ib.getInstance().powerpointDocumentStateAnnotationProcessor(e,wn),[3,43];case 34:return function(e,t,n){ZR("substrateAPIResponseAnnotationProcessor",e),ZR("".concat(gU.x.getTypeName()," response received\n Time Taken: ").concat((0,qp.WU)(_U),"s "));var r=e.body,o=r.queryId,a=r.status,s=r.results,l=r.error,c=r.httpStatus,u=r.type;if(US(LU,gU.x.getTypeName(),_U,sC.SubstrateAPIResponseTime,_C.CopilotLab,n,void 0,!1),o&&ZR("substrateAPIResponseAnnotationProcessor: queryID: ",o),c&&ZR("substrateAPIResponseAnnotationProcessor: httpStatus: ",c),s&&ZR("substrateAPIResponseAnnotationProcessor: results: ",s),a!==AU.G.Failed){if(a===AU.G.Success&&u===mU.p.Suggestion&&s)try{var d,p=JSON.parse(null!=s?s:""),g=null==p?void 0:p.Groups,m=null==g||null===(d=g[0])||void 0===d?void 0:d.Suggestions;(null==m?void 0:m.length)>0&&t(m)}catch(e){return void ZR("substrateAPIResponseAnnotationProcessor: failed to parse results")}}else{var f,h,v,y="",C="";l?(ZR("substrateAPIResponseAnnotationProcessor: error: ",l),C=ep.Server,y=null!==(f=null==l?void 0:l.code)&&void 0!==f?f:""):(C=ep.SubstrateService,y=null!==(h=null==c?void 0:c.toString())&&void 0!==h?h:""),LU.sendChatEventTelemetry(HS((v={},(0,i._)(v,cC.ChatEventType,"".concat(gU.x.getTypeName(),"_Error")),(0,i._)(v,cC.ChatEventParameters,y||""),(0,i._)(v,cC.ChatErrorType,C||""),v)))}}(e,$,n),[3,43];case 35:return tt.handleHandoffMessage(e,n),[3,43];case 36:return[4,SD(e,nn,ae,xe,n)];case 38:return[4,eD(e,nn)];case 40:return Lg(e,ob.getInstance().getQuerySubmitTime(),FR,nn,n),[3,43];case 41:return $k(e,nn,n),[3,43];case 42:return VW(e,nn),[3,43];case 43:return[2]}}))})),On.apply(this,arguments)}function Nn(){return(Nn=(0,gd._)((function(e){var t,n,r,o;return(0,F.__generator)(this,(function(a){ZR("Handoff message from host app: ",e),t=null;try{t=JSON.parse(e)}catch(e){return ZR("failed in parsing json for handoff message",e.message),HK.sendChatEventTelemetry(HS((n={},(0,i._)(n,cC.ChatEventType,pC.HandoffMessageFromHostAppSettingsError),(0,i._)(n,cC.ChatErrorType,ep.Client),(0,i._)(n,cC.ChatErrorParameters,e.message),n))),[2]}return ZR("Received handoff message from Host App Settings ".concat(t)),!cF(t)&&t.items&&t.items.length>0&&t.items[0]?(tt.handleHandoffMessage(t.items[0],""),[2]):(ZR(r="invalid operation for handoff message"),HK.sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,pC.HandoffMessageFromHostAppSettingsError),(0,i._)(o,cC.ChatErrorType,ep.Client),(0,i._)(o,cC.ChatErrorParameters,r),o))),[2])}))}))).apply(this,arguments)}function Rn(){return Rn=(0,gd._)((function(e,t){var n,r,o,a,s,l,c,u,p,g,m,f,h,v,y,C,S,b,E,T,I;return(0,F.__generator)(this,(function(_){switch(_.label){case 0:switch(ZR("Event Received from sharedCopilot, Event: ".concat(e)),e){case Iw.PV.CopilotChatLoaded:return[3,1];case Iw.PV.AugloopResponseTimeout:return[3,4];case Iw.PV.AnnotationActivated:return[3,5];case Iw.PV.StopGeneratingButtonClicked:return[3,13];case Iw.PV.QueryEndOnGptSwitch:return[3,14];case Iw.PV.CitationLinkClicked:return[3,15];case Iw.PV.BasicChatStatus:return[3,16];case Iw.PV.ChatTopicChanged:return[3,17];case Iw.PV.BasicChatSuggestionPills:return[3,18];case Iw.PV.ChatHistoryHydrationFailed:return[3,19];case Iw.PV.QuerySubmitted:return[3,20];case Iw.PV.ResetContextId:return[3,21];case Iw.PV.PluginsStateUpdated:return[3,22];case Iw.PV.SharedHeaderRendered:return[3,23]}return[3,24];case 1:return sF(),function(){Dn.apply(this,arguments)}(),Vh(Lh.IsTriggerPptVisualOperationEnabled)&&function(){HR.apply(this,arguments)}(),function(e){var t,n=new Vp.Xr({parentPath:["session","#userContext#"],items:[{id:"myUserContext1",body:new _P({isAdminControlTurnedOn:fR()})}]});null===(t=e.current)||void 0===t||t.submitOperation({operation:n,workflowAnnotationType:_P.getTypeName()})}(nn),UK.setTelemetryHandler(HK),function(e){var t=zR.getSetting(DR.AppStartTimestamp);t&&e.recordCheckPoint(UC.AppStart,t);var n=zR.getSetting(DR.CopilotPaneStartTimestamp);n&&!lX&&e.recordCheckPoint(UC.CopilotPaneStart,n),e.logSeenEvent(Iv.CopilotChat);var r,o,a,s,l,c,u,d=[{key:sC.SDXResourcesLoadTime,value:(0,qp.WU)(uX)},{key:sC.LocalizationStringsLoadTime,value:yS}];Xh()&&!lX&&(d.push({key:sC.FeatureName,value:_C.ChatPaneLoad}),d.push({key:sC.PPTUserCopilotPaneLoadTime,value:(0,qp.WU)(n)})),e.sendLatencyTelemetry(d,!0),e.logAshaEvent("Copilot:Chat Pane:Chat Pane"),e.sendChatEventTelemetry(HS((r={},(0,i._)(r,cC.ChatEventType,dC.TaskPaneStart),(0,i._)(r,cC.ChatEventParameters,uX),r))),e.sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,dC.AppLoadStart),(0,i._)(o,cC.ChatEventParameters,dX),o))),e.sendChatEventTelemetry(HS((a={},(0,i._)(a,cC.ChatEventType,dC.OfficeJSReady),(0,i._)(a,cC.ChatEventParameters,sX),a))),e.sendChatEventTelemetry(HS((s={},(0,i._)(s,cC.ChatEventType,dC.AppExecutionStart),(0,i._)(s,cC.ChatEventParameters,ZK),s))),e.sendChatEventTelemetry(HS((l={},(0,i._)(l,cC.ChatEventType,dC.StringLocalizationStart),(0,i._)(l,cC.ChatEventParameters,YK),l))),cX&&e.sendChatEventTelemetry(HS((c={},(0,i._)(c,cC.ChatEventType,dC.OfficeAddinCalledTime),(0,i._)(c,cC.ChatEventParameters,cX),c))),lX&&e.sendChatEventTelemetry(HS((u={},(0,i._)(u,cC.ChatEventType,dC.PreloadCopilot),(0,i._)(u,cC.ChatEventParameters,lX),u))),e.recordCheckPoint(UC.ChatPaneLoaded)}(HK),zR.IsSettingTrue(DR.TriggerCreatePresentationAbout)?(ZR("TriggerCreatePresentationAbout host setting is true"),HK.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerCreatePresentationAboutCalled}]),null===(n=nn.current)||void 0===n||n.setInputAreaText(PowerpointCopilotStrings.PreFilledPromptGuideItemCreateAPresentationAbout)):zR.IsSettingTrue(DR.TriggerCreatePresentationFromFile)?(ZR("TriggerCreatePresentationFromFile host setting is true"),HK.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerCreatePresentationFromFileCalled}]),null===(r=nn.current)||void 0===r||r.setInputAreaText(PowerpointCopilotStrings.PreFilledPromptGuideItemCreatePresentationFrom)):zR.IsSettingTrue(DR.TriggerAddASlide)?(ZR("TriggerAddASlide host setting is true"),HK.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.TriggerAddASlideCalled}]),null===(o=nn.current)||void 0===o||o.setInputAreaText(PowerpointCopilotStrings.PreFilledPromptGuideItemAddASlideAbout)):zR.IsSettingTrue(DR.TriggerSummary)?(ZR("TriggerSummary host setting is true"),jE.getInstance().setState(Qd.EXECUTING),ZR("Calling common core component to trigger summary for nudge"),function(){var e;wp.sendChatEventTelemetry(Ng(((e={})[Ap.ChatEventType]=Lp.SummaryFromNudgeTriggered,e)))}(),null===(a=nn.current)||void 0===a||a.submitUserQuery({text:PowerpointCopilotStrings.PromptMenuItemSummarize})):null!=zR.getSettingAsString(DR.TriggerCshCopilot)&&(ZR("TriggerCshCopilot host setting has a PromptIdGuid defined"),gK(zR.getSettingAsString(DR.TriggerCshCopilot),nn,HK)),(s=zR.getSettingAsString(DR.PPTHandoffMessage))?[4,d(s)]:[3,3];case 2:_.sent(),_.label=3;case 3:return[3,24];case 4:return BK.isRequestPending()?(BK.emptyContextIdListandCleanup(),(null==t?void 0:t.workflowAnnotationType)!==TE.getTypeName()&&(null==t?void 0:t.workflowAnnotationType)!==IE.getTypeName()||function(e){var t;!$x&&ek.length>0&&(pk(e,Sk(hL,!0),!0),gk()),rk.sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.SummaryStreamingResponseTimeout),(0,i._)(t,cC.ChatEventParameters,"SummaryStreamingResponseTimeout"),(0,i._)(t,cC.ChatErrorType,ep.Server),t)))}(nn),(c=function(e){switch(e){case EE.getTypeName():case TE.getTypeName():case IE.getTypeName():return Cv.Summary;case dw.getTypeName():return Cv.Organize;case fb.getTypeName():case yw.getTypeName():return Cv.CreatePresentationFromDoc;case uw.KJ.getTypeName():case uw.Ob.getTypeName():return Cv.BasicChat;case gw.getTypeName():return Cv.CreatePresentation;default:return Cv.CopilotChat}}(null==t?void 0:t.workflowAnnotationType))===Cv.BasicChat?[2]:(UK.setScenarioName(c),u=UK.getFeatureName(),HK.logTriedEvent(u,MC.Unset,Hw(u)),M_(!1,dC.AugloopResponseTimeout),p=RC.UnclearIntent,g=AC.ResponseDelayedOrTimedOut,c===Cv.Summary&&(p=RC.Summarize),HK.logAshaErrorEvent(FS(p,g),"Timeout waiting for server",c),m={errorMessage:PowerpointCopilotStrings.ErrorInExecution,errorType:yp.ResponseDelayedOrTimedOut,featureName:u,subFeatureName:MC.Unset},null===(l=nn.current)||void 0===l||l.addResponseMessage(TL(PowerpointCopilotStrings.ErrorInExecution,hL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,m)),[3,24])):[2];case 5:return t?(ZR("Annotation Activated: ".concat(t.workflowAnnotationType)),t.workflowAnnotationType!==xw.getTypeName()?[3,7]:[4,Nw(nn)]):[3,24];case 6:return _.sent(),[3,12];case 7:return t.workflowAnnotationType!==gU.x.getTypeName()||Vh(Lh.IsSharedCopilotLabEnabled)?[3,8]:(DU(mU.p.Suggestion),[3,12]);case 8:return t.workflowAnnotationType!==_h.dF.getTypeName()?[3,9]:(tt.sendHandoffDocUrlSignal(),[3,12]);case 9:return t.workflowAnnotationType!==_h.uC.getTypeName()?[3,10]:(tt.sendHandoffMessageId(wh.Q.GET,nt),[3,12]);case 10:return t.workflowAnnotationType!==uU.getTypeName()?[3,12]:[4,PU(nn)];case 11:_.sent(),_.label=12;case 12:return[3,24];case 13:return ZR("Stop Generation Clicked."),RR(nn,!0,dC.StopGeneratingButtonClicked,OC.UserAbortedQueryExecution,qp.dB,Se,xe,ae,be),[3,24];case 14:return ZR("Query End On Gpt Switch event received"),lU.enableQueryEndOnGptSwitch&&RR(nn,!1,dC.QueryEndOnGptSwitch,OC.GptSwitchAbortedQueryExecution,qp.dB,Se,xe,ae,be),[3,24];case 15:return f=t.referencePath,jN(f),[3,24];case 16:return be(!0),t.status===Iw.y2.Started?UK.setScenarioName(Cv.BasicChat):t.status===Iw.y2.Finished&&M_(!0,void 0,Cv.BasicChat),[3,24];case 17:return ZR("Chat Topic Changed: ",t),jE.getInstance().setState(Qd.IDLE),Zy.getInstance().getIsWarningMessageActive()&&Ex(nn),v={featureName:_C.CopilotChat},null===(h=nn.current)||void 0===h||h.addResponseMessage(TL(PowerpointCopilotStrings.TopicChangedResponseMessage,mL,!0,Wd.CHATPPT,void 0,!1,!0,void 0,v)),Ln(),zt([]),[3,24];case 18:return ZR("BasicChat SuggestionPills event triggered: ",t),(y=t).suggestionPills&&0!==y.suggestionPills.length?zt(y.suggestionPills):ZR("No suggestions returned by Basic Chat workflow"),fg()&&Tg(nn),[3,24];case 19:return wk()&&Vh(Lh.IsChatHistoryHydrationErrorEnabled)&&(oF(WK())||rF(WK())&&Vh(Lh.RehydrateMessagesConsumer))&&(S={errorMessage:OfficeaicopilotStrings.ChatHistoryHydrationError,errorType:yp.ChatHistoryHydrationError,featureName:_C.CopilotChat,subFeatureName:void 0},null===(C=nn.current)||void 0===C||C.addResponseMessage(TL(OfficeaicopilotStrings.ChatHistoryHydrationError,hL,!(zR.IsSettingTrue(DR.TriggerSummary)&&zR.IsSettingTrue(DR.TriggerAddASlide)&&zR.IsSettingTrue(DR.TriggerCreatePresentationAbout)&&zR.IsSettingTrue(DR.TriggerCreatePresentationFromFile)),Wd.CHATPPT,void 0,!1,!1,void 0,S))),[3,24];case 20:return ZR("QuerySubmitted event triggered: ",t),t&&t.workflowAnnotationType!==QW.T.getTypeName()&&(xe.current=!1,be(!1)),[3,24];case 21:return ZR("CopilotEvent ResetContextId received"),BK.emptyContextIdListandCleanup(),[3,24];case 22:return MK=!0,b=xk()&&!Vh(Lh.EnableEnterpriseToggleInPhase2Ux)&&Jh(Dh.IsEnterpriseSearchDefaultOn),E=!1,b&&(E=t.pluginsInfo.findIndex((function(e){return e&&"EnterpriseSearch"===e.id&&"acquired"===e.state}))>=0)&&(DS(!0),ob.getInstance().sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.GroundingSourceUpdated},{key:cC.ChatEventParameters,value:"Work:AutoOn"}])),Ie(E),[3,24];case 23:return Vh(Lh.IsCopilotSharedHeaderEnabled)&&(window.StaticHeaderLoadTime||function(){xK.apply(this,arguments)}(),ob.getInstance().sendLatencyTelemetry(HS((I={},(0,i._)(I,sC.StaticSharedHeaderLoadTimeInMs,null!==(T=window.StaticHeaderLoadTime)&&void 0!==T?T:""),(0,i._)(I,sC.SharedHeaderLoadTimeInMs,window.performance.now()),I)))),[3,24];case 24:return[2]}}))})),Rn.apply(this,arguments)}function Fn(){return Fn=(0,gd._)((function(e,t){var n,r,o,a,s,l,c,u,d,p,g,m,f,h,v;return(0,F.__generator)(this,(function(C){switch(e){case Iw.Yk.ZQMLoaded:if(Vh(Lh.IsZQMV2Enabled)){Gw(null===(r=R.current)||void 0===r?void 0:r.promptSuggestionList),HK.sendChatEventTelemetry(HS((o={},(0,i._)(o,cC.ChatEventType,dC.ZQMV2Loaded),(0,i._)(o,cC.ChatEventParameters,(new Date).getTime().toString()),o)));break}Gw(null===(n=N.current)||void 0===n?void 0:n.promptSuggestionList);break;case Iw.Yk.MenuButtonItemClicked:t.suggestionClicked===eM.addEnterpriseImage()&&HK.sendChatEventTelemetry([{key:cC.ChatEventType,value:dC.AddEnterpriseImageClicked}]),bN(Wd.CHATPPT),EN(rM);break;case Iw.Yk.MenuButtonItemClickedL1:!function(e,t,n){var r=Fw(t,n).find((function(t){return t.text===e}));if(null==r?void 0:r.children){var o=!0,i=!1,a=void 0;try{for(var s,l=r.children[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c,u,d=s.value,p=Bw(null!==(c=d.text)&&void 0!==c?c:rM),g=Uw(null!==(u=d.text)&&void 0!==u?u:rM),m=Hw(p);ob.getInstance().logSeenEvent(p,g,m)}}catch(e){i=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw a}}}}(null!==(a=t.suggestionClicked)&&void 0!==a?a:"",q.current,y.current),bN(Wd.CHATPPT);break;case Iw.Yk.AugloopErrorReceived:t.annotationName!==uw.KJ.getTypeName()&&t.annotationName!==uw.Ob.getTypeName()||M_(!1,t.annotationName===uw.KJ.getTypeName()?"BasicChatWorkflow_":"BasicChatStreamingWorkflow_"+JSON.parse(null!==(s=t.chatEventParams)&&void 0!==s?s:"").errorCategory,Cv.BasicChat);break;case Iw.Yk.ZQMButtonItemClicked:Vh(Lh.IsZQMV2Enabled)&&HK.sendChatEventTelemetry(HS((0,i._)({},cC.ChatEventType,dC.ZQMV2CardClicked))),bN(Wd.CHATPPT),EN(rM);break;case Iw.Yk.AugloopResponseReceived:l=(null==t?void 0:t.timeInMs)?(null==t?void 0:t.timeInMs)/1e3:0,u=null!==(c=null==t?void 0:t.annotationName)&&void 0!==c?c:"",YA(u,l);break;case Iw.Yk.InputAreaTextChangedToEmpty:case Iw.Yk.SuggestionPillClicked:case Iw.Yk.QueryExecutionCompleted:if(bN(Wd.CHATPPT),EN(rM),ce(tE.NotACommand),Iw.Yk.QueryExecutionCompleted===e&&(gk(),BO(),Vh(Lh.IsNotificationEnabledForSummary))){d=!0,p=!1,g=void 0;try{for(m=Nk.entries()[Symbol.iterator]();!(d=(f=m.next()).done);d=!0)h=yd(f.value,2),v=h[0],h[1],nA(v)&&qk.updateActiveCardForCompleteNotification(v,nn)}catch(e){p=!0,g=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw g}}}}return[2]}))})),Fn.apply(this,arguments)}(0,a.useEffect)((function(){null==rn||rn.setHVCPromptDetected(le)}),[le]);var Mn=Jh("IsHandleTabKeyEnabled")?function(e){"Tab"===e.key&&e.stopPropagation()}:void 0,Bn=yd(a.useState((function(){var e=[];return Vh(Lh.IsSwitcherMenuContainerEnabled)||e.push({id:IB,name:"Copilot",isSelected:!0,isDefaultCopilot:!0,menuIcon:a.createElement(Eh,null)}),at&&e.push({id:_B,name:wB,isSelected:!1,isDefaultCopilot:!1,copilotType:uO.ClientProvided,copilotComponent:a.createElement(WJ,{alSession:lt,onReviewerAgentToggleChange:Dt,onApplySuggestion:jJ,userQuery:St,addCommentToFirstLineOfDocument:QJ,onSuggestionCardNavigation:eK,isDarkModeEnabled:qt.isDarkModeEnabled,isHighContrastModeEnabled:qt.isHighContrastModeEnabled,documentURL:wt,authorName:Tt.displayName,authorEmail:Tt.email,isReviewerNotAddedButtonClicked:vt,getDocumentSensitivity:ZJ,agentLaunchType:kt,peoplePickerEditorConfig:$J()}),menuIcon:a.createElement(Th,null),iconAltText:wB}),e})),2),Un=Bn[0],Hn=Bn[1],Gn=yd(a.useState(IB),2),zn=Gn[0],qn=Gn[1],Wn=function(e){ZR("handleCopilotChatChange in client",e);var t=Un.map((function(t){return Sd(Cd({},t),e===_B?{copilotComponent:a.createElement(WJ,{alSession:lt,onReviewerAgentToggleChange:Dt,onApplySuggestion:jJ,userQuery:St,addCommentToFirstLineOfDocument:QJ,onSuggestionCardNavigation:eK,isDarkModeEnabled:qt.isDarkModeEnabled,isHighContrastModeEnabled:qt.isHighContrastModeEnabled,documentURL:wt,authorName:Tt.displayName,authorEmail:Tt.email,isReviewerNotAddedButtonClicked:vt,getDocumentSensitivity:ZJ,agentLaunchType:kt,peoplePickerEditorConfig:$J()}),isSelected:t.id===e}:{isSelected:t.id===e})}));Hn(t),qn(e)};a.useEffect((function(){Wn(zn)}),[zn,lt]);var jn=Vh(Lh.IsMsgExtEnabled)?{showCopilotSwitcherMenu:!1,copilotList:[],handleCopilotChatChange:function(e){}}:void 0,Vn={showCopilotSwitcherMenu:!0,copilotList:Un,handleCopilotChatChange:Wn,showNewChatButtonOnTop:!1},Qn={closeButton:{type:oU.Close,clickHandler:IK},headerMenuButtonProps:kK(),enableChatHistory:Vh(Lh.IsChatHistoryOnSwitcherMenuEnabled),showCreditButton:Vh(Lh.IsCreditsUIInternalEnabled)},Jn={showCopilotSwitcherMenu:!0,copilotList:Un,handleCopilotChatChange:Wn,showNewChatButtonOnTop:!1,paneSilhouetteHeaderProps:Vh(Lh.IsCopilotSharedHeaderEnabled)?Qn:void 0},Kn=RH(),Xn=Vh(Lh.IsSwitcherMenuContainerEnabled)?Jn:at?Vn:jn,Zn={mosTokenProvider:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(t){return[2,Ft.getToken(e).then((function(e){return null==e?void 0:e.accessToken}))]}))}));return function(t){return e.apply(this,arguments)}}()},Yn={copilotCommunicationHandler:Vh(Lh.IsCopilotCommandingSteerabilityEnabled)?on:rn,platformType:hR(),style:Kn,useALRuntime:!1,ref:nn,chatUiProps:Vh(Lh.IsInputV2Enabled)?En:mn,theme:qt,themeV2:Vh(Lh.EnableFluent2Tokens)?gm(lN,o,l):void 0,basicChatProps:yn,copilotTelemetryHandler:ob.getInstance(),debugProps:Ze,copilotPluginProps:Xn,copilotFeatureFlags:lU,hostTokenProviders:Zn,hostAppAuthTokens:Vh(Lh.IsCloudFileUploadEnabled)?{graphTokenProvider:function(){var e=(0,gd._)((function(e){return(0,F.__generator)(this,(function(e){switch(e.label){case 0:return[4,(t=Mt,Bh(void 0,void 0,void 0,(function(){var e,n;return Uh(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.getToken(em)];case 1:return e=r.sent(),[2,Mh(e)];case 2:throw n=r.sent(),Gp("Error fetching Graph token:",n),n;case 3:return[2]}}))})))];case 1:return[2,e.sent()]}var t}))}));return function(t){return e.apply(this,arguments)}}(),sharepointTokenProvider:function(){var e=(0,gd._)((function(e){var t;return(0,F.__generator)(this,(function(n){switch(n.label){case 0:return t=(i=null!=e?e:tm).substring(0,i.lastIndexOf("/")),[4,(r=Mt,o=t,Hh(void 0,void 0,void 0,(function(){var e,t;return Gh(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,r.getToken(o)];case 1:return e=n.sent(),[2,Mh(e)];case 2:throw t=n.sent(),Gp("Error fetching SharePoint token:",t),t;case 3:return[2]}}))})))];case 1:return[2,n.sent()]}var r,o,i}))}));return function(t){return e.apply(this,arguments)}}()}:{}},$n=Jh(Dh.IsAriaAnnouncerEnabled),er=FH();$n&&!Ae.current&&(t=a.createElement("div",{className:er.ariaAnnouncer,ref:Ae,"aria-live":"assertive","aria-atomic":"true"}));var tr=Vh(Lh.IsSwitcherMenuContainerEnabled)?a.createElement(qJ,Yn):a.createElement(a.Fragment,null,a.createElement(qp.zn,Yn),$n&&t),nr=mt?dt?a.createElement("div",null,"Loading Reviewer Agent..."):a.createElement(WJ,{alSession:lt,onReviewerAgentToggleChange:Dt,onApplySuggestion:jJ,userQuery:St,addCommentToFirstLineOfDocument:QJ,onSuggestionCardNavigation:eK,isDarkModeEnabled:qt.isDarkModeEnabled,isHighContrastModeEnabled:qt.isHighContrastModeEnabled,documentURL:wt,authorName:Tt.displayName,authorEmail:Tt.email,isReviewerNotAddedButtonClicked:vt,getDocumentSensitivity:ZJ,agentLaunchType:kt,peoplePickerEditorConfig:$J()}):dt?a.createElement("div",null,"Loading Chat..."):tr,rr=at?nr:tr;return a.createElement("div",{className:"ms-welcome",onKeyDown:Mn},rr)},WK=function(){return NK};!function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(zK||(zK={}));var jK,VK,QK=[{pptPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:Wg.defaultWhite},{pptPrimaryBackgroundColor:"#262626",sdxPrimaryBackgroundColor:"#525252",sdxTheme:Wg.defaultBlack},{pptPrimaryBackgroundColor:"#f0f0f0",sdxPrimaryBackgroundColor:"#0a0a0a",sdxTheme:Wg.defaultBlack},{pptPrimaryBackgroundColor:"#323232",sdxPrimaryBackgroundColor:"#323232",sdxTheme:Wg.defaultBlack},{pptPrimaryBackgroundColor:"#1B1A19",sdxPrimaryBackgroundColor:"#1B1A19",sdxTheme:Wg.defaultBlack}],JK=[{pptPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:Wg.defaultWhite},{pptPrimaryBackgroundColor:"#000000",sdxPrimaryBackgroundColor:"#0a0a0a",sdxTheme:Wg.defaultBlack}],KK=function(e,t){var n,r,o=pd()?JK.find((function(t){return t.pptPrimaryBackgroundColor===e})):QK.find((function(t){return t.pptPrimaryBackgroundColor===e}));return t&&XK(null!==(n=null==o?void 0:o.sdxPrimaryBackgroundColor)&&void 0!==n?n:"#F5F5F5"),null!==(r=null==o?void 0:o.sdxTheme)&&void 0!==r?r:Wg.defaultWhite},XK=function(e){document.body.style.backgroundColor=e};!function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(jK||(jK={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(VK||(VK={}));var ZK,YK,$K=n(44166),eX=(0,De.Z)(),tX=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,F.__extends)(t,e),t.prototype.render=function(){var e,t=(e=this.props).type,n=e.size,r=e.ariaLabel,o=e.ariaLive,i=e.styles,s=e.label,l=e.theme,c=e.className,u=e.labelPosition,d=r,p=(0,qe.G1)(this.props,qe.JM,["size"]),g=n;void 0===g&&void 0!==t&&(g=t===VK.large?jK.large:jK.medium);var m=eX(i,{theme:l,size:g,className:c,labelPosition:u});return a.createElement("div",(0,F.__assign)({},p,{className:m.root}),a.createElement("div",{className:m.circle}),s&&a.createElement("div",{className:m.label},s),d&&a.createElement("div",{role:"status","aria-live":o},a.createElement($K.P,null,a.createElement("div",{className:m.screenReaderText},d))))},t.defaultProps={size:jK.medium,ariaLive:"polite",labelPosition:"bottom"},t}(a.Component),nX={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},rX=(0,Oe.J9)((function(){return(0,c.i7)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})})),oX=(0,Pe.I)(tX,(function(e){var t,n=e.theme,r=e.size,o=e.className,i=e.labelPosition,a=n.palette,s=(0,c.Km)(nX,n);return{root:[s.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===i&&{flexDirection:"column-reverse"},"right"===i&&{flexDirection:"row"},"left"===i&&{flexDirection:"row-reverse"},o],circle:[s.circle,{boxSizing:"border-box",borderRadius:"50%",borderWidth:"1.5px",borderStyle:"solid",borderTopColor:a.themePrimary,borderRightColor:a.themeLight,borderBottomColor:a.themeLight,borderLeftColor:a.themeLight,animationName:rX(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[c.up]=(0,F.__assign)({borderTopColor:"Highlight"},(0,c.Qg)()),t)},r===jK.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===jK.small&&["ms-Spinner--small",{width:16,height:16}],r===jK.medium&&["ms-Spinner--medium",{width:20,height:20}],r===jK.large&&["ms-Spinner--large",{width:28,height:28}]],label:[s.label,n.fonts.small,{color:a.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===i&&{margin:"0 0 8px"},"right"===i&&{margin:"0 0 0 8px"},"left"===i&&{margin:"0 8px 0 0"}],screenReaderText:c.dX}}),void 0,{scope:"Spinner"}),iX=n(58651);OfficeFirstPartyAuth.autoPopup=!0,OfficeFirstPartyAuth.upnCheck=!1,OfficeFirstPartyAuth.useMsal3=!0;const aX=function(e){ZK=(new Date).getTime();var t=yd(a.useState(!1),2),n=t[0],r=t[1],o=yd(a.useState(Wg.defaultWhite),2),i=o[0],s=o[1],l=yd(a.useState(zK.disabled),2),c=l[0],u=l[1],d=function(e){var t=window.matchMedia("(prefers-color-scheme: light)").matches;if(e)u(t?zK.light:zK.dark);else{u(zK.disabled);var n=KK(_p.GetHostAppPlatform()===yM?Office.context.officeTheme.controlForegroundColor:Vh(Lh.IsCopilotThemeForWebEnabled)||dd()?Office.context.officeTheme.bodyBackgroundColor:"ffffff",!1);s(n)}};window.matchMedia("(forced-colors: active)").addEventListener("change",(function(e){e.matches?d(!0):d(!1)})),window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",(function(e){window.matchMedia("(forced-colors: active)").matches&&u(e.matches?zK.light:zK.dark)}));var p=function(e){var t;ZR("OfficeTheme Changed"),t=Vh(Lh.IsCopilotThemeForWebEnabled)?KK(_p.GetHostAppPlatform()===yM?e.officeTheme.controlForegroundColor:e.officeTheme.bodyBackgroundColor,!0):KK(dd()?e.officeTheme.bodyBackgroundColor:e.officeTheme.controlForegroundColor,!0),s(t)},g=function(){var e=(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,p)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}));return function(){return e.apply(this,arguments)}}();a.useEffect((function(){(0,gd._)((function(){var e;return(0,F.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,eN()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),ZR("Auth initialization failed with exception ".concat(e)),[3,3];case 3:return[2]}}))}))();var e=Wg.defaultWhite,t=_p.GetHostAppPlatform();if(t===yM)e=KK(Office.context.officeTheme.controlForegroundColor,!0),g().catch((function(e){ZR("Register Theme Callback() error: "+e),eb.j.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,uM,dM,!1)}));else if(dd()){var n,o;null===(o=Office.context)||void 0===o||null===(n=o.themeManager)||void 0===n||n.getOfficeThemeAsync((function(t){if("succeeded"===t.status){var n=t.value;e=KK(n.bodyBackgroundColor,!0),s(e),g().catch((function(e){ZR("Register Theme Callback() error: "+e),eb.j.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,uM,dM,!1)}))}}))}else t===CM&&Vh(Lh.IsCopilotThemeForWebEnabled)&&(e=KK(Office.context.officeTheme.controlBackgroundColor,!0),g().catch((function(e){ZR("Register Theme Callback() error: "+e),eb.j.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,uM,dM,!1)})));window.matchMedia("(forced-colors: active)").matches&&d(!0),s(e),YK=(new Date).getTime(),function(e){kS.apply(this,arguments)}(r),window.addEventListener("beforeunload",(function(){iX.log("beforeunload"),Kf.getInstance().closeActiveDialog()}))}),[]),a.useEffect((function(){switch(c){case zK.light:s(Wg.defaultWhite);break;case zK.dark:s(Wg.defaultBlack)}}),[c]),a.useEffect((function(){n&&(document.title=PowerpointCopilotStrings.CopilotPaneTitle)}),[n]),ZR("App Execution completed in: ".concat(((new Date).getTime()-ZK)/1e3," sec"));var m,f=a.createElement(qK,{theme:i,isHighContrast:c!==zK.disabled}),h=function(e,t){void 0===t&&(t=fh);var n=(0,a.useState)(hh),r=n[0],o=n[1];return(0,a.useEffect)((function(){(0,gh.Au)((0,gh.U5)(e,"en-us"),r).then(o)}),[e]),(0,a.useEffect)((function(){o((0,gh._c)(t,r))}),[t]),(0,gh.zB)(r)}(TS(_p.GetHostAppDisplayLanguage()),void 0),v=a.createElement(yh,{lookupString:h}," ",f),y=n?a.createElement("div",{className:"ms-welcome"},a.createElement(Uf.q,{dir:(m=_S(),Am.includes(m)||km.includes(m)?gp.RTL:gp.LTR)},v)):a.createElement(No,null,a.createElement(oX,null)),C=i!==Wg.defaultWhite?"./assets/error-boundary-dark.webp":"./assets/error-boundary-light.webp";return zh("IsErrorBoundaryEnabled",!1)?a.createElement(Bf,{copilotChatTheme:gm(lN,i,c!==zK.disabled),errorBoundaryImagePath:C},y):y};var sX,lX,cX,uX=window.pptTaskPaneStartTime,dX=(new Date).getTime().toString(),pX=!1,gX=!1;function mX(){var e,t=null===(e=sessionStorage)||void 0===e?void 0:e.getItem("preloadCopilot");return!!t&&JSON.parse(t).isPreloaded}function fX(e){var t;(null===(t=sessionStorage)||void 0===t?void 0:t.getItem("preloadCopilot"))&&hX(e)}function hX(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=sessionStorage)||void 0===e||e.setItem("preloadCopilot",JSON.stringify({isPreloaded:!0,isHidden:t}))}function vX(){sX=(new Date).getTime().toString(),function(){switch(ud.log("Platform is - "+Office.context.platform),Office.context.platform){case Office.PlatformType.iOS:ie(re.IOS);break;case Office.PlatformType.Mac:ie(re.MACOS);break;default:ie(re.web)}}(),function(e,t){var n,r;void 0===e&&(e=(null===(n=null==D?void 0:D.FabricConfig)||void 0===n?void 0:n.iconBaseUrl)||(null===(r=null==D?void 0:D.FabricConfig)||void 0===r?void 0:r.fontBaseUrl)||L),[u,d,p,g,m,f,h,v,y,C,S,b,E,T,I,_,w,P,x].forEach((function(n){return n(e,t)})),k()}(),l.render(a.createElement("div",null,a.createElement(aX,null)),document.getElementById("container"))}Office.onReady((function(e){(null==e?void 0:e.addin)?(e.addin.visibilityMode===DF&&(gX=!0,mX()&&vX(),cX=(new Date).getTime().toString()),Office.addin.onVisibilityModeChanged((function(e){var t,n;if(t=e.visibilityMode,ob.getInstance().sendChatEventTelemetry(HS((n={},(0,i._)(n,cC.ChatEventType,dC.TaskPaneVisibilityModeChanged),(0,i._)(n,cC.ChatEventParameters,t),n))),"Taskpane"===e.visibilityMode){if(pX){zR.getSetting(DR.CopilotPaneStartTimestamp);pX=!1}gX=!1,ob.getInstance().releaseHeldTelemetryEvents(),fX(!1)}else e.visibilityMode===DF&&fX(!0)}))):vX()})),Office.actions.associate("ShowPreloadedCopilot",(function(e){var t;(pX=!0,null==e?void 0:e.CopilotPaneStartTimestamp)&&function(e){var t;ob.getInstance().sendLatencyTelemetry(HS((t={},(0,i._)(t,sC.FeatureName,_C.Preload_ChatPaneLoad),(0,i._)(t,sC.PPTUserCopilotPaneLoadTime,(0,qp.WU)(e)),t)),!0),ob.getInstance().recordCheckPoint(UC.CopilotPaneStart,e)}(e.CopilotPaneStartTimestamp);ob.getInstance().sendChatEventTelemetry(HS((t={},(0,i._)(t,cC.ChatEventType,dC.ShowPreloadedCopilot),(0,i._)(t,cC.ChatEventParameters,(new Date).getTime()),t))),Office.addin.showAsTaskpane()})),Office.actions.associate("PreloadCopilot",(function(){lX=(new Date).getTime().toString(),hX(),vX()}))},83226:(e,t,n)=>{"use strict";e.exports=n.p+"assets/mic-permission-dialog-ppt.svg"},99394:(e,t,n)=>{"use strict";e.exports=n.p+"assets/suggestion-button-icon.svg"},3110:(e,t,n)=>{"use strict";n.r(t),n.d(t,{JsonPatchError:()=>h,_areEquals:()=>P,applyOperation:()=>E,applyPatch:()=>T,applyReducer:()=>I,compare:()=>R,deepClone:()=>u,default:()=>F,escapePathComponent:()=>p,generate:()=>O,getValueByPointer:()=>b,observe:()=>D,unescapePathComponent:()=>g,unobserve:()=>L,validate:()=>w,validator:()=>_});var r={};n.r(r),n.d(r,{JsonPatchError:()=>v,_areEquals:()=>P,applyOperation:()=>E,applyPatch:()=>T,applyReducer:()=>I,deepClone:()=>y,getValueByPointer:()=>b,validate:()=>w,validator:()=>_});var o={};n.r(o),n.d(o,{compare:()=>R,generate:()=>O,observe:()=>D,unobserve:()=>L});var i,a=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=Object.prototype.hasOwnProperty;function l(e,t){return s.call(e,t)}function c(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var o in e)l(e,o)&&r.push(o);return r}function u(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function d(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function p(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function g(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function m(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(m(e[t]))return!0}else if("object"==typeof e)for(var r=c(e),o=r.length,i=0;i<o;i++)if(m(e[r[i]]))return!0;return!1}function f(e,t){var n=[e];for(var r in t){var o="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==o&&n.push(r+": "+o)}return n.join("\n")}var h=function(e){function t(t,n,r,o,i){var a=this.constructor,s=e.call(this,f(t,{name:n,index:r,operation:o,tree:i}))||this;return s.name=n,s.index=r,s.operation=o,s.tree=i,Object.setPrototypeOf(s,a.prototype),s.message=f(t,{name:n,index:r,operation:o,tree:i}),s}return a(t,e),t}(Error),v=h,y=u,C={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=b(n,this.path);r&&(r=u(r));var o=E(n,{op:"remove",path:this.from}).removed;return E(n,{op:"add",path:this.path,value:o}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=b(n,this.from);return E(n,{op:"add",path:this.path,value:u(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:P(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},S={add:function(e,t,n){return d(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:C.move,copy:C.copy,test:C.test,_get:C._get};function b(e,t){if(""==t)return e;var n={op:"_get",path:t};return E(e,n),n.value}function E(e,t,n,r,o,i){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===o&&(o=!0),void 0===i&&(i=0),n&&("function"==typeof n?n(t,0,e,t.path):_(t,0)),""===t.path){var a={newDocument:e};if("add"===t.op)return a.newDocument=t.value,a;if("replace"===t.op)return a.newDocument=t.value,a.removed=e,a;if("move"===t.op||"copy"===t.op)return a.newDocument=b(e,t.from),"move"===t.op&&(a.removed=e),a;if("test"===t.op){if(a.test=P(e,t.value),!1===a.test)throw new v("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a.newDocument=e,a}if("remove"===t.op)return a.removed=e,a.newDocument=null,a;if("_get"===t.op)return t.value=e,a;if(n)throw new v("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return a}r||(e=u(e));var s=(t.path||"").split("/"),l=e,c=1,p=s.length,m=void 0,f=void 0,h=void 0;for(h="function"==typeof n?n:_;;){if((f=s[c])&&-1!=f.indexOf("~")&&(f=g(f)),o&&("__proto__"==f||"prototype"==f&&c>0&&"constructor"==s[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===m&&(void 0===l[f]?m=s.slice(0,c).join("/"):c==p-1&&(m=t.path),void 0!==m&&h(t,0,e,m)),c++,Array.isArray(l)){if("-"===f)f=l.length;else{if(n&&!d(f))throw new v("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);d(f)&&(f=~~f)}if(c>=p){if(n&&"add"===t.op&&f>l.length)throw new v("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(a=S[t.op].call(t,l,f,e)).test)throw new v("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a}}else if(c>=p){if(!1===(a=C[t.op].call(t,l,f,e)).test)throw new v("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return a}if(l=l[f],n&&c<p&&(!l||"object"!=typeof l))throw new v("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}function T(e,t,n,r,o){if(void 0===r&&(r=!0),void 0===o&&(o=!0),n&&!Array.isArray(t))throw new v("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=u(e));for(var i=new Array(t.length),a=0,s=t.length;a<s;a++)i[a]=E(e,t[a],n,!0,o,a),e=i[a].newDocument;return i.newDocument=e,i}function I(e,t,n){var r=E(e,t);if(!1===r.test)throw new v("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function _(e,t,n,r){if("object"!=typeof e||null===e||Array.isArray(e))throw new v("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!C[e.op])throw new v("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new v("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new v('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new v("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new v("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&m(e.value))throw new v("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var o=e.path.split("/").length,i=r.split("/").length;if(o!==i+1&&o!==i)throw new v("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new v("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var a=w([{op:"_get",path:e.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new v("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function w(e,t,n){try{if(!Array.isArray(e))throw new v("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)T(u(t),u(e),n||!0);else{n=n||_;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(e){if(e instanceof v)return e;throw e}}function P(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,o,i=Array.isArray(e),a=Array.isArray(t);if(i&&a){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!P(e[n],t[n]))return!1;return!0}if(i!=a)return!1;var s=Object.keys(e);if((r=s.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!P(e[o=s[n]],t[o]))return!1;return!0}return e!=e&&t!=t}var x=new WeakMap,k=function(e){this.observers=new Map,this.obj=e},A=function(e,t){this.callback=e,this.observer=t};function L(e,t){t.unobserve()}function D(e,t){var n,r=function(e){return x.get(e)}(e);if(r){var o=function(e,t){return e.observers.get(t)}(r,t);n=o&&o.observer}else r=new k(e),x.set(e,r);if(n)return n;if(n={},r.value=u(e),t){n.callback=t,n.next=null;var i=function(){O(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(i)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=e,n.unobserve=function(){O(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(t,new A(t,n)),n}function O(e,t){void 0===t&&(t=!1);var n=x.get(e.object);N(n.value,e.object,e.patches,"",t),e.patches.length&&T(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function N(e,t,n,r,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=c(t),a=c(e),s=!1,d=a.length-1;d>=0;d--){var g=e[f=a[d]];if(!l(t,f)||void 0===t[f]&&void 0!==g&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&n.push({op:"test",path:r+"/"+p(f),value:u(g)}),n.push({op:"remove",path:r+"/"+p(f)}),s=!0):(o&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var m=t[f];"object"==typeof g&&null!=g&&"object"==typeof m&&null!=m&&Array.isArray(g)===Array.isArray(m)?N(g,m,n,r+"/"+p(f),o):g!==m&&(o&&n.push({op:"test",path:r+"/"+p(f),value:u(g)}),n.push({op:"replace",path:r+"/"+p(f),value:u(m)}))}}if(s||i.length!=a.length)for(d=0;d<i.length;d++){var f;l(e,f=i[d])||void 0===t[f]||n.push({op:"add",path:r+"/"+p(f),value:u(t[f])})}}}function R(e,t,n){void 0===n&&(n=!1);var r=[];return N(e,t,r,"",n),r}const F=Object.assign({},r,o,{JsonPatchError:h,deepClone:u,escapePathComponent:p,unescapePathComponent:g})}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return i[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=i,e=[],s.O=(t,n,r,o)=>{if(!n){var i=1/0;for(u=0;u<e.length;u++){for(var[n,r,o]=e[u],a=!0,l=0;l<n.length;l++)(!1&o||i>=o)&&Object.keys(s.O).every((e=>s.O[e](n[l])))?n.splice(l--,1):(a=!1,o<i&&(i=o));if(a){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);s.r(o);var i={};t=t||[null,n({}),n([]),n(n)];for(var a=2&r&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>i[t]=()=>e[t]));return i.default=()=>e,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>(({105:"vendors~id-ID-UiStrings-json",227:"officeaicopilotchatstrings_sv",368:"vendors~gu-IN-UiStrings-json",373:"officeaicopilotchatstrings_te",416:"vendors~as-IN-UiStrings-json",444:"vendors~lo-LA-UiStrings-json",449:"officeaicopilotchatstrings_ur",469:"vendors~te-IN-UiStrings-json",507:"vendors~bs-Latn-BA-UiStrings-json",526:"augloop",530:"vendors~en-US-UiStrings-json",640:"officeaicopilotchatstrings_ms",673:"officeaicopilotchatstrings_fr-ca",717:"vendors~auth-msal-browser",777:"vendors~mt-MT-UiStrings-json",811:"officeaicopilotchatstrings_pa-in",817:"vendors~uk-UA-UiStrings-json",827:"officeaicopilotchatstrings_ca-es-valencia",869:"vendors~hi-IN-UiStrings-json",935:"officeaicopilotchatstrings_ga-ie",1032:"officeaicopilotchatstrings_sd-arab-pk",1034:"sccserviceciq",1039:"officeaicopilotchatstrings_vi",1103:"officeaicopilotchatstrings_zu-za",1172:"vendors~bn-IN-UiStrings-json",1226:"officeaicopilotchatstrings_sw",1280:"vendors~vi-VN-UiStrings-json",1312:"officeaicopilotchatstrings_sr-cyrl-ba",1337:"vendors~fi-FI-UiStrings-json",1354:"vendors~gl-ES-UiStrings-json",1361:"officeaicopilotchatstrings_ta",1398:"vendors~sq-AL-UiStrings-json",1467:"vendors~da-DK-UiStrings-json",1565:"vendors~sccservicevoiceaugloop",1668:"officeaicopilotchatstrings_quz-pe",1751:"officeaicopilotchatstrings_ru",1757:"ReviewerAgent",1827:"vendors~pt-BR-UiStrings-json",1950:"officeaicopilotchatstrings_eu",2163:"officeaicopilotchatstrings_zh-hans",2337:"officeaicopilotchatstrings_da",2580:"vendors~ko-KR-UiStrings-json",2582:"vendors~ne-NP-UiStrings-json",2793:"officeaicopilotchatstrings_gd-gb",2800:"vendors~sr-Cyrl-BA-UiStrings-json",2820:"vendors~inlinecreationhvcapp",2899:"officeaicopilotchatstrings_mt-mt",2933:"officeaicopilotchatstrings_de",2935:"officeaicopilotchatstrings_ml",3005:"officeaicopilotchatstrings_hi",3036:"officeaicopilotchatstrings_sq",3047:"officeaicopilotchatstrings_sr",3049:"officeaicopilotchatstrings_pt-pt",3066:"vendors~ug-CN-UiStrings-json",3071:"officeaicopilotchatstrings_el",3073:"officeaicopilotchatstrings_no",3181:"lazyloadeddesigner",3275:"vendors~or-IN-UiStrings-json",3375:"vendors~lt-LT-UiStrings-json",3431:"officeaicopilotchatstrings_lt",3449:"officeaicopilotchatstrings_mr",3457:"officeaicopilotchatstrings_hu",3514:"vendors~ja-JP-UiStrings-json",3536:"officeaicopilotchatstrings_bn-in",3561:"officeaicopilotchatstrings_sl",3601:"officeaicopilotchatstrings_he",3670:"officeaicopilotchatstrings_si-lk",3856:"vendors~zh-TW-UiStrings-json",3889:"vendors~ms-MY-UiStrings-json",3912:"officeaicopilotchatstrings_mk",3935:"vendors~ciqinputareahvc",3961:"vendors~ro-RO-UiStrings-json",3981:"vendors~eu-ES-UiStrings-json",4016:"officeaicopilotchatstrings_pt",4035:"vendors~en-GB-UiStrings-json",4043:"vendors~ur-PK-UiStrings-json",4059:"vendors~lv-LV-UiStrings-json",4067:"vendors~es-ES-UiStrings-json",4121:"officeaicopilotchatstrings_af",4123:"officeaicopilotchatstrings_ja",4140:"vendors~zh-CN-UiStrings-json",4156:"officeaicopilotchatstrings_ca",4161:"vendors~ca-Es-VALENCIA-UiStrings-json",4207:"vendors~sk-SK-UiStrings-json",4263:"vendors~fa-IR-UiStrings-json",4267:"vendors~fr-CA-UiStrings-json",4342:"vendors~sr-Cyrl-RS-UiStrings-json",4394:"vendors~es-MX-UiStrings-json",4445:"officeaicopilotchatstrings_hy",4467:"vendors~tr-TR-UiStrings-json",4499:"officeaicopilotchatstrings_it",4692:"officeaicopilotchatstrings_cy",4723:"vendors~hr-HR-UiStrings-json",4775:"officeaicopilotchatstrings_be-by",4836:"vendors~quz-PE-UiStrings-json",4858:"officeaicopilotchatstrings_en-us",4972:"officeaicopilotchatstrings_zh-hant",5136:"officeaicopilotchatstrings_th",5203:"officeaicopilotchatstrings_kn",5214:"officeaicopilotchatstrings_kk",5273:"officeaicopilotchatstrings_en-gb",5315:"vendors~fr-FR-UiStrings-json",5316:"vendors~km-KH-UiStrings-json",5327:"vendors~ca-ES-UiStrings-json",5375:"vendors~af-ZA-UiStrings-json",5431:"officeaicopilotchatstrings_fa",5501:"officeaicopilotchatstrings_ar",5526:"vendors~fil-PH-UiStrings-json",5610:"officeaicopilotchatstrings_tr",5612:"officeaicopilotchatstrings_nn-no",5663:"officeaicopilotchatstrings_fi",5664:"officeaicopilotchatstrings_uk",5743:"vendors~th-TH-UiStrings-json",5812:"officeaicopilotchatstrings_gu",5821:"officeaicopilotchatstrings_kok",5853:"vendors~az-Latn-AZ-UiStrings-json",5882:"officeaicopilotchatstrings_nl",5939:"officeaicopilotchatstrings_id",5943:"officeaicopilotchatstrings_mi-nz",5944:"vendors~nb-NO-UiStrings-json",5997:"vendors~uz-Latn-UZ-UiStrings-json",6008:"editor",6115:"vendors~gd-gb-UiStrings-json",6121:"officeaicopilotchatstrings_prs",6148:"vendors~sv-SE-UiStrings-json",6193:"officeaicopilotchatstrings_fil",6202:"officeaicopilotchatstrings_ko",6226:"vendors~sl-SI-UiStrings-json",6251:"vendors~sr-Latn-RS-UiStrings-json",6295:"vendors~pt-PT-UiStrings-json",6343:"officeaicopilotchatstrings_et",6470:"officeaicopilotchatstrings_ug-cn",6613:"vendors~pa-IN-UiStrings-json",6627:"vendors~mk-MK-UiStrings-json",6645:"vendors~el-GR-UiStrings-json",6705:"vendors~hu-HU-UiStrings-json",6746:"officeaicopilotchatstrings_sr-cyrl",6759:"dialog-modal",6784:"vendors~kk-KZ-UiStrings-json",6862:"officeaicopilotchatstrings_hr",6929:"vendors~ta-IN-UiStrings-json",6932:"officeaicopilotchatstrings_km-kh",6966:"officeaicopilotchatstrings_sk",7033:"officeaicopilotchatstrings_uz",7055:"officeaicopilotchatstrings_az-latn-az",7153:"officeaicopilotchatstrings_bs-latn-ba",7193:"vendors~sccserviceciq",7288:"officeaicopilotchatstrings_pl",7289:"vendors~ru-RU-UiStrings-json",7320:"officeaicopilotchatstrings_es",7358:"vendors~copilotchatdisplay",7391:"vendors~nl-NL-UiStrings-json",7410:"vendors~ReviewerAgent",7420:"officeaicopilotchatstrings_tt",7490:"officeaicopilotchatstrings_lb-lu",7585:"vendors~de-DE-UiStrings-json",7628:"officeaicopilotchatstrings_fr",7748:"vendors~nn-NO-UiStrings-json",7877:"vendors~kok-IN-UiStrings-json",7965:"officeaicopilotchatstrings_ro",7987:"vendors~is-IS-UiStrings-json",7999:"officeaicopilotchatstrings_bn-bd",8021:"officeaicopilotchatstrings_bg",8063:"officeaicopilotchatstrings_ha-latn-ng",8224:"officeaicopilotchatstrings_as-in",8249:"vendors~bg-BG-UiStrings-json",8280:"vendors~cs-CZ-UiStrings-json",8305:"vendors~ga-IE-UiStrings-json",8343:"vendors~pl-PL-UiStrings-json",8398:"vendors~ar-SA-UiStrings-json",8453:"vendors~mi-NZ-UiStrings-json",8575:"vendors~ka-GE-UiStrings-json",8582:"officeaicopilotchatstrings_ne-np",8679:"vendors~ml-IN-UiStrings-json",8707:"vendors~he-IL-UiStrings-json",8762:"officeaicopilotchatstrings_am",8767:"officeaicopilotchatstrings_mn-mn",8830:"officeaicopilotchatstrings_es-mx",8888:"vendors~am-ET-UiStrings-json",8892:"officeaicopilotchatstrings_is",8902:"vendors~lb-LU-UiStrings-json",9003:"vendors~kn-IN-UiStrings-json",9005:"officeaicopilotchatstrings_lo-la",9032:"vendors~hy-AM-UiStrings-json",9066:"vendors~cy-GB-UiStrings-json",9177:"vendors~it-IT-UiStrings-json",9203:"officeaicopilotchatstrings_or",9206:"officeaicopilotchatstrings_lv",9229:"vendors~mr-IN-UiStrings-json",9306:"vendors~et-EE-UiStrings-json",9412:"vendors~lazyloadeddesigner",9452:"officeaicopilotchatstrings_ky",9669:"officeaicopilotchatstrings_gl",9693:"officeaicopilotchatstrings_tk-tm",9918:"officeaicopilotchatstrings_cs",9930:"vendors~tt-RU-UiStrings-json",9988:"officeaicopilotchatstrings_ka"}[e]||e)+".js"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="TypeScriptModule:",s.l=(e,t,n,i)=>{if(r[e])r[e].push(t);else{var a,l;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==o+n){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",o+n),a.src=e),r[e]=[t];var p=(t,n)=>{a.onerror=a.onload=null,clearTimeout(g);var o=r[e];if(delete r[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(n))),t)return t(n)},g=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=1926,(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={1926:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[i,a,l]=n,c=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(l)var u=l(s)}for(t&&t(n);c<i.length;c++)o=i[c],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return s.O(u)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var l=s.O(void 0,[9037,7645],(()=>s(96461)));l=s.O(l),TypeScriptModule=l})();
//# sourceMappingURL=taskpane.js.map