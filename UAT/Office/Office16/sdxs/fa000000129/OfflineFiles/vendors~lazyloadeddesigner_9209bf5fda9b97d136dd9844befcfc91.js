"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[9412],{32335:(e,t,n)=>{n.d(t,{E:()=>to});var i={};n.r(i),n.d(i,{hasBrowserEnv:()=>fe,hasStandardBrowserEnv:()=>Se,hasStandardBrowserWebWorkerEnv:()=>ve,navigator:()=>Ce,origin:()=>ye});var o=n(23182);function a(e,t){return function(){return e.apply(t,arguments)}}var r=n(72715);const{toString:s}=Object.prototype,{getPrototypeOf:l}=Object,c=(d=Object.create(null),e=>{const t=s.call(e);return d[t]||(d[t]=t.slice(8,-1).toLowerCase())});var d;const u=e=>(e=e.toLowerCase(),t=>c(t)===e),p=e=>t=>typeof t===e,{isArray:g}=Array,h=p("undefined");const m=u("ArrayBuffer");const f=p("string"),C=p("function"),S=p("number"),v=e=>null!==e&&"object"==typeof e,y=e=>{if("object"!==c(e))return!1;const t=l(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},E=u("Date"),T=u("File"),A=u("Blob"),I=u("FileList"),R=u("URLSearchParams"),[D,P,b,w]=["ReadableStream","Request","Response","Headers"].map(u);function U(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let i,o;if("object"!=typeof e&&(e=[e]),g(e))for(i=0,o=e.length;i<o;i++)t.call(null,e[i],i,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),a=o.length;let r;for(i=0;i<a;i++)r=o[i],t.call(null,e[r],r,e)}}function M(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,o=n.length;for(;o-- >0;)if(i=n[o],t===i.toLowerCase())return i;return null}const O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,F=e=>!h(e)&&e!==O;const k=(B="undefined"!=typeof Uint8Array&&l(Uint8Array),e=>B&&e instanceof B);var B;const _=u("HTMLFormElement"),L=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),N=u("RegExp"),x=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};U(n,((n,o)=>{let a;!1!==(a=t(n,o,e))&&(i[o]=a||n)})),Object.defineProperties(e,i)},G="abcdefghijklmnopqrstuvwxyz",H="0123456789",j={DIGIT:H,ALPHA:G,ALPHA_DIGIT:G+G.toUpperCase()+H};const z=u("AsyncFunction"),q=(W="function"==typeof setImmediate,V=C(O.postMessage),W?setImmediate:V?($=`axios@${Math.random()}`,K=[],O.addEventListener("message",(({source:e,data:t})=>{e===O&&t===$&&K.length&&K.shift()()}),!1),e=>{K.push(e),O.postMessage($,"*")}):e=>setTimeout(e));var W,V,$,K;const Q="undefined"!=typeof queueMicrotask?queueMicrotask.bind(O):void 0!==r&&r.nextTick||q,J={isArray:g,isArrayBuffer:m,isBuffer:function(e){return null!==e&&!h(e)&&null!==e.constructor&&!h(e.constructor)&&C(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||C(e.append)&&("formdata"===(t=c(e))||"object"===t&&C(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&m(e.buffer),t},isString:f,isNumber:S,isBoolean:e=>!0===e||!1===e,isObject:v,isPlainObject:y,isReadableStream:D,isRequest:P,isResponse:b,isHeaders:w,isUndefined:h,isDate:E,isFile:T,isBlob:A,isRegExp:N,isFunction:C,isStream:e=>v(e)&&C(e.pipe),isURLSearchParams:R,isTypedArray:k,isFileList:I,forEach:U,merge:function e(){const{caseless:t}=F(this)&&this||{},n={},i=(i,o)=>{const a=t&&M(n,o)||o;y(n[a])&&y(i)?n[a]=e(n[a],i):y(i)?n[a]=e({},i):g(i)?n[a]=i.slice():n[a]=i};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&U(arguments[e],i);return n},extend:(e,t,n,{allOwnKeys:i}={})=>(U(t,((t,i)=>{n&&C(t)?e[i]=a(t,n):e[i]=t}),{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let o,a,r;const s={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),a=o.length;a-- >0;)r=o[a],i&&!i(r,e,t)||s[r]||(t[r]=e[r],s[r]=!0);e=!1!==n&&l(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:c,kindOfTest:u,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(g(e))return e;let t=e.length;if(!S(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:_,hasOwnProperty:L,hasOwnProp:L,reduceDescriptors:x,freezeMethods:e=>{x(e,((t,n)=>{if(C(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];C(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach((e=>{n[e]=!0}))};return g(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:M,global:O,isContextDefined:F,ALPHABET:j,generateString:(e=16,t=j.ALPHA_DIGIT)=>{let n="";const{length:i}=t;for(;e--;)n+=t[Math.random()*i|0];return n},isSpecCompliantForm:function(e){return!!(e&&C(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(v(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const o=g(e)?[]:{};return U(e,((e,t)=>{const a=n(e,i+1);!h(a)&&(o[t]=a)})),t[i]=void 0,o}}return e};return n(e,0)},isAsyncFn:z,isThenable:e=>e&&(v(e)||C(e))&&C(e.then)&&C(e.catch),setImmediate:q,asap:Q};function Y(e,t,n,i,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),o&&(this.response=o,this.status=o.status?o.status:null)}J.inherits(Y,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const X=Y.prototype,Z={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{Z[e]={value:e}})),Object.defineProperties(Y,Z),Object.defineProperty(X,"isAxiosError",{value:!0}),Y.from=(e,t,n,i,o,a)=>{const r=Object.create(X);return J.toFlatObject(e,r,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),Y.call(r,e.message,t,n,i,o),r.cause=e,r.name=e.name,a&&Object.assign(r,a),r};const ee=Y;var te=n(37542).Buffer;function ne(e){return J.isPlainObject(e)||J.isArray(e)}function ie(e){return J.endsWith(e,"[]")?e.slice(0,-2):e}function oe(e,t,n){return e?e.concat(t).map((function(e,t){return e=ie(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const ae=J.toFlatObject(J,{},null,(function(e){return/^is[A-Z]/.test(e)}));const re=function(e,t,n){if(!J.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=J.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!J.isUndefined(t[e])}))).metaTokens,o=n.visitor||c,a=n.dots,r=n.indexes,s=(n.Blob||"undefined"!=typeof Blob&&Blob)&&J.isSpecCompliantForm(t);if(!J.isFunction(o))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(J.isDate(e))return e.toISOString();if(!s&&J.isBlob(e))throw new ee("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(e)||J.isTypedArray(e)?s&&"function"==typeof Blob?new Blob([e]):te.from(e):e}function c(e,n,o){let s=e;if(e&&!o&&"object"==typeof e)if(J.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(J.isArray(e)&&function(e){return J.isArray(e)&&!e.some(ne)}(e)||(J.isFileList(e)||J.endsWith(n,"[]"))&&(s=J.toArray(e)))return n=ie(n),s.forEach((function(e,i){!J.isUndefined(e)&&null!==e&&t.append(!0===r?oe([n],i,a):null===r?n:n+"[]",l(e))})),!1;return!!ne(e)||(t.append(oe(o,n,a),l(e)),!1)}const d=[],u=Object.assign(ae,{defaultVisitor:c,convertValue:l,isVisitable:ne});if(!J.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!J.isUndefined(n)){if(-1!==d.indexOf(n))throw Error("Circular reference detected in "+i.join("."));d.push(n),J.forEach(n,(function(n,a){!0===(!(J.isUndefined(n)||null===n)&&o.call(t,n,J.isString(a)?a.trim():a,i,u))&&e(n,i?i.concat(a):[a])})),d.pop()}}(e),t};function se(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function le(e,t){this._pairs=[],e&&re(e,this,t)}const ce=le.prototype;ce.append=function(e,t){this._pairs.push([e,t])},ce.toString=function(e){const t=e?function(t){return e.call(this,t,se)}:se;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const de=le;function ue(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function pe(e,t,n){if(!t)return e;const i=n&&n.encode||ue,o=n&&n.serialize;let a;if(a=o?o(t,n):J.isURLSearchParams(t)?t.toString():new de(t,n).toString(i),a){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+a}return e}const ge=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){J.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},he={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},me={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:de,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},fe="undefined"!=typeof window&&"undefined"!=typeof document,Ce="object"==typeof navigator&&navigator||void 0,Se=fe&&(!Ce||["ReactNative","NativeScript","NS"].indexOf(Ce.product)<0),ve="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,ye=fe&&window.location.href||"http://localhost",Ee={...i,...me};const Te=function(e){function t(e,n,i,o){let a=e[o++];if("__proto__"===a)return!0;const r=Number.isFinite(+a),s=o>=e.length;if(a=!a&&J.isArray(i)?i.length:a,s)return J.hasOwnProp(i,a)?i[a]=[i[a],n]:i[a]=n,!r;i[a]&&J.isObject(i[a])||(i[a]=[]);return t(e,n,i[a],o)&&J.isArray(i[a])&&(i[a]=function(e){const t={},n=Object.keys(e);let i;const o=n.length;let a;for(i=0;i<o;i++)a=n[i],t[a]=e[a];return t}(i[a])),!r}if(J.isFormData(e)&&J.isFunction(e.entries)){const n={};return J.forEachEntry(e,((e,i)=>{t(function(e){return J.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),i,n,0)})),n}return null};const Ae={transitional:he,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,o=J.isObject(e);o&&J.isHTMLForm(e)&&(e=new FormData(e));if(J.isFormData(e))return i?JSON.stringify(Te(e)):e;if(J.isArrayBuffer(e)||J.isBuffer(e)||J.isStream(e)||J.isFile(e)||J.isBlob(e)||J.isReadableStream(e))return e;if(J.isArrayBufferView(e))return e.buffer;if(J.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return re(e,new Ee.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return Ee.isNode&&J.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((a=J.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return re(a?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||i?(t.setContentType("application/json",!1),function(e,t,n){if(J.isString(e))try{return(t||JSON.parse)(e),J.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Ae.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(J.isResponse(e)||J.isReadableStream(e))return e;if(e&&J.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw ee.from(e,ee.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ee.classes.FormData,Blob:Ee.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],(e=>{Ae.headers[e]={}}));const Ie=Ae,Re=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),De=Symbol("internals");function Pe(e){return e&&String(e).trim().toLowerCase()}function be(e){return!1===e||null==e?e:J.isArray(e)?e.map(be):String(e)}function we(e,t,n,i,o){return J.isFunction(i)?i.call(this,t,n):(o&&(t=n),J.isString(t)?J.isString(i)?-1!==t.indexOf(i):J.isRegExp(i)?i.test(t):void 0:void 0)}class Ue{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function o(e,t,n){const o=Pe(t);if(!o)throw new Error("header name must be a non-empty string");const a=J.findKey(i,o);(!a||void 0===i[a]||!0===n||void 0===n&&!1!==i[a])&&(i[a||t]=be(e))}const a=(e,t)=>J.forEach(e,((e,n)=>o(e,n,t)));if(J.isPlainObject(e)||e instanceof this.constructor)a(e,t);else if(J.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))a((e=>{const t={};let n,i,o;return e&&e.split("\n").forEach((function(e){o=e.indexOf(":"),n=e.substring(0,o).trim().toLowerCase(),i=e.substring(o+1).trim(),!n||t[n]&&Re[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)})),t})(e),t);else if(J.isHeaders(e))for(const[t,i]of e.entries())o(i,t,n);else null!=e&&o(t,e,n);return this}get(e,t){if(e=Pe(e)){const n=J.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(J.isFunction(t))return t.call(this,e,n);if(J.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Pe(e)){const n=J.findKey(this,e);return!(!n||void 0===this[n]||t&&!we(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function o(e){if(e=Pe(e)){const o=J.findKey(n,e);!o||t&&!we(0,n[o],o,t)||(delete n[o],i=!0)}}return J.isArray(e)?e.forEach(o):o(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const o=t[n];e&&!we(0,this[o],o,e,!0)||(delete this[o],i=!0)}return i}normalize(e){const t=this,n={};return J.forEach(this,((i,o)=>{const a=J.findKey(n,o);if(a)return t[a]=be(i),void delete t[o];const r=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(o):String(o).trim();r!==o&&delete t[o],t[r]=be(i),n[r]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return J.forEach(this,((n,i)=>{null!=n&&!1!==n&&(t[i]=e&&J.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[De]=this[De]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=Pe(e);t[i]||(!function(e,t){const n=J.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+n,{value:function(e,n,o){return this[i].call(this,t,e,n,o)},configurable:!0})}))}(n,e),t[i]=!0)}return J.isArray(e)?e.forEach(i):i(e),this}}Ue.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),J.reduceDescriptors(Ue.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),J.freezeMethods(Ue);const Me=Ue;function Oe(e,t){const n=this||Ie,i=t||n,o=Me.from(i.headers);let a=i.data;return J.forEach(e,(function(e){a=e.call(n,a,o.normalize(),t?t.status:void 0)})),o.normalize(),a}function Fe(e){return!(!e||!e.__CANCEL__)}function ke(e,t,n){ee.call(this,null==e?"canceled":e,ee.ERR_CANCELED,t,n),this.name="CanceledError"}J.inherits(ke,ee,{__CANCEL__:!0});const Be=ke;function _e(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new ee("Request failed with status code "+n.status,[ee.ERR_BAD_REQUEST,ee.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Le=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let o,a=0,r=0;return t=void 0!==t?t:1e3,function(s){const l=Date.now(),c=i[r];o||(o=l),n[a]=s,i[a]=l;let d=r,u=0;for(;d!==a;)u+=n[d++],d%=e;if(a=(a+1)%e,a===r&&(r=(r+1)%e),l-o<t)return;const p=c&&l-c;return p?Math.round(1e3*u/p):void 0}};const Ne=function(e,t){let n,i,o=0,a=1e3/t;const r=(t,a=Date.now())=>{o=a,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),s=t-o;s>=a?r(e,t):(n=e,i||(i=setTimeout((()=>{i=null,r(n)}),a-s)))},()=>n&&r(n)]},xe=(e,t,n=3)=>{let i=0;const o=Le(50,250);return Ne((n=>{const a=n.loaded,r=n.lengthComputable?n.total:void 0,s=a-i,l=o(s);i=a;e({loaded:a,total:r,progress:r?a/r:void 0,bytes:s,rate:l||void 0,estimated:l&&r&&a<=r?(r-a)/l:void 0,event:n,lengthComputable:null!=r,[t?"download":"upload"]:!0})}),n)},Ge=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},He=e=>(...t)=>J.asap((()=>e(...t))),je=Ee.hasStandardBrowserEnv?function(){const e=Ee.navigator&&/(msie|trident)/i.test(Ee.navigator.userAgent),t=document.createElement("a");let n;function i(n){let i=n;return e&&(t.setAttribute("href",i),i=t.href),t.setAttribute("href",i),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return n=i(window.location.href),function(e){const t=J.isString(e)?i(e):e;return t.protocol===n.protocol&&t.host===n.host}}():function(){return!0},ze=Ee.hasStandardBrowserEnv?{write(e,t,n,i,o,a){const r=[e+"="+encodeURIComponent(t)];J.isNumber(n)&&r.push("expires="+new Date(n).toGMTString()),J.isString(i)&&r.push("path="+i),J.isString(o)&&r.push("domain="+o),!0===a&&r.push("secure"),document.cookie=r.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function qe(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const We=e=>e instanceof Me?{...e}:e;function Ve(e,t){t=t||{};const n={};function i(e,t,n){return J.isPlainObject(e)&&J.isPlainObject(t)?J.merge.call({caseless:n},e,t):J.isPlainObject(t)?J.merge({},t):J.isArray(t)?t.slice():t}function o(e,t,n){return J.isUndefined(t)?J.isUndefined(e)?void 0:i(void 0,e,n):i(e,t,n)}function a(e,t){if(!J.isUndefined(t))return i(void 0,t)}function r(e,t){return J.isUndefined(t)?J.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function s(n,o,a){return a in t?i(n,o):a in e?i(void 0,n):void 0}const l={url:a,method:a,data:a,baseURL:r,transformRequest:r,transformResponse:r,paramsSerializer:r,timeout:r,timeoutMessage:r,withCredentials:r,withXSRFToken:r,adapter:r,responseType:r,xsrfCookieName:r,xsrfHeaderName:r,onUploadProgress:r,onDownloadProgress:r,decompress:r,maxContentLength:r,maxBodyLength:r,beforeRedirect:r,transport:r,httpAgent:r,httpsAgent:r,cancelToken:r,socketPath:r,responseEncoding:r,validateStatus:s,headers:(e,t)=>o(We(e),We(t),!0)};return J.forEach(Object.keys(Object.assign({},e,t)),(function(i){const a=l[i]||o,r=a(e[i],t[i],i);J.isUndefined(r)&&a!==s||(n[i]=r)})),n}const $e=e=>{const t=Ve({},e);let n,{data:i,withXSRFToken:o,xsrfHeaderName:a,xsrfCookieName:r,headers:s,auth:l}=t;if(t.headers=s=Me.from(s),t.url=pe(qe(t.baseURL,t.url),e.params,e.paramsSerializer),l&&s.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),J.isFormData(i))if(Ee.hasStandardBrowserEnv||Ee.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if(!1!==(n=s.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];s.setContentType([e||"multipart/form-data",...t].join("; "))}if(Ee.hasStandardBrowserEnv&&(o&&J.isFunction(o)&&(o=o(t)),o||!1!==o&&je(t.url))){const e=a&&r&&ze.read(r);e&&s.set(a,e)}return t},Ke="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const i=$e(e);let o=i.data;const a=Me.from(i.headers).normalize();let r,s,l,c,d,{responseType:u,onUploadProgress:p,onDownloadProgress:g}=i;function h(){c&&c(),d&&d(),i.cancelToken&&i.cancelToken.unsubscribe(r),i.signal&&i.signal.removeEventListener("abort",r)}let m=new XMLHttpRequest;function f(){if(!m)return;const i=Me.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());_e((function(e){t(e),h()}),(function(e){n(e),h()}),{data:u&&"text"!==u&&"json"!==u?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=f:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(f)},m.onabort=function(){m&&(n(new ee("Request aborted",ee.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new ee("Network Error",ee.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const o=i.transitional||he;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new ee(t,o.clarifyTimeoutError?ee.ETIMEDOUT:ee.ECONNABORTED,e,m)),m=null},void 0===o&&a.setContentType(null),"setRequestHeader"in m&&J.forEach(a.toJSON(),(function(e,t){m.setRequestHeader(t,e)})),J.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),u&&"json"!==u&&(m.responseType=i.responseType),g&&([l,d]=xe(g,!0),m.addEventListener("progress",l)),p&&m.upload&&([s,c]=xe(p),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(r=t=>{m&&(n(!t||t.type?new Be(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(r),i.signal&&(i.signal.aborted?r():i.signal.addEventListener("abort",r)));const C=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);C&&-1===Ee.protocols.indexOf(C)?n(new ee("Unsupported protocol "+C+":",ee.ERR_BAD_REQUEST,e)):m.send(o||null)}))},Qe=(e,t)=>{let n,i=new AbortController;const o=function(e){if(!n){n=!0,r();const t=e instanceof Error?e:this.reason;i.abort(t instanceof ee?t:new Be(t instanceof Error?t.message:t))}};let a=t&&setTimeout((()=>{o(new ee(`timeout ${t} of ms exceeded`,ee.ETIMEDOUT))}),t);const r=()=>{e&&(a&&clearTimeout(a),a=null,e.forEach((e=>{e&&(e.removeEventListener?e.removeEventListener("abort",o):e.unsubscribe(o))})),e=null)};e.forEach((e=>e&&e.addEventListener&&e.addEventListener("abort",o)));const{signal:s}=i;return s.unsubscribe=r,[s,()=>{a&&clearTimeout(a),a=null}]},Je=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,o=0;for(;o<n;)i=o+t,yield e.slice(o,i),o=i},Ye=(e,t,n,i,o)=>{const a=async function*(e,t,n){for await(const i of e)yield*Je(ArrayBuffer.isView(i)?i:await n(String(i)),t)}(e,t,o);let r,s=0,l=e=>{r||(r=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await a.next();if(t)return l(),void e.close();let o=i.byteLength;if(n){let e=s+=o;n(e)}e.enqueue(new Uint8Array(i))}catch(e){throw l(e),e}},cancel:e=>(l(e),a.return())},{highWaterMark:2})},Xe="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,Ze=Xe&&"function"==typeof ReadableStream,et=Xe&&("function"==typeof TextEncoder?(tt=new TextEncoder,e=>tt.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var tt;const nt=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},it=Ze&&nt((()=>{let e=!1;const t=new Request(Ee.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),ot=Ze&&nt((()=>J.isReadableStream(new Response("").body))),at={stream:ot&&(e=>e.body)};var rt;Xe&&(rt=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!at[e]&&(at[e]=J.isFunction(rt[e])?t=>t[e]():(t,n)=>{throw new ee(`Response type '${e}' is not supported`,ee.ERR_NOT_SUPPORT,n)})})));const st=async(e,t)=>{const n=J.toFiniteNumber(e.getContentLength());return null==n?(async e=>null==e?0:J.isBlob(e)?e.size:J.isSpecCompliantForm(e)?(await new Request(e).arrayBuffer()).byteLength:J.isArrayBufferView(e)||J.isArrayBuffer(e)?e.byteLength:(J.isURLSearchParams(e)&&(e+=""),J.isString(e)?(await et(e)).byteLength:void 0))(t):n},lt=Xe&&(async e=>{let{url:t,method:n,data:i,signal:o,cancelToken:a,timeout:r,onDownloadProgress:s,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:p}=$e(e);c=c?(c+"").toLowerCase():"text";let g,h,[m,f]=o||a||r?Qe([o,a],r):[];const C=()=>{!g&&setTimeout((()=>{m&&m.unsubscribe()})),g=!0};let S;try{if(l&&it&&"get"!==n&&"head"!==n&&0!==(S=await st(d,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(J.isFormData(i)&&(e=n.headers.get("content-type"))&&d.setContentType(e),n.body){const[e,t]=Ge(S,xe(He(l)));i=Ye(n.body,65536,e,t,et)}}J.isString(u)||(u=u?"include":"omit");const o="credentials"in Request.prototype;h=new Request(t,{...p,signal:m,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:i,duplex:"half",credentials:o?u:void 0});let a=await fetch(h);const r=ot&&("stream"===c||"response"===c);if(ot&&(s||r)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=a[t]}));const t=J.toFiniteNumber(a.headers.get("content-length")),[n,i]=s&&Ge(t,xe(He(s),!0))||[];a=new Response(Ye(a.body,65536,n,(()=>{i&&i(),r&&C()}),et),e)}c=c||"text";let g=await at[J.findKey(at,c)||"text"](a,e);return!r&&C(),f&&f(),await new Promise(((t,n)=>{_e(t,n,{data:g,headers:Me.from(a.headers),status:a.status,statusText:a.statusText,config:e,request:h})}))}catch(t){if(C(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new ee("Network Error",ee.ERR_NETWORK,e,h),{cause:t.cause||t});throw ee.from(t,t&&t.code,e,h)}}),ct={http:null,xhr:Ke,fetch:lt};J.forEach(ct,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const dt=e=>`- ${e}`,ut=e=>J.isFunction(e)||null===e||!1===e,pt=e=>{e=J.isArray(e)?e:[e];const{length:t}=e;let n,i;const o={};for(let a=0;a<t;a++){let t;if(n=e[a],i=n,!ut(n)&&(i=ct[(t=String(n)).toLowerCase()],void 0===i))throw new ee(`Unknown adapter '${t}'`);if(i)break;o[t||"#"+a]=i}if(!i){const e=Object.entries(o).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(dt).join("\n"):" "+dt(e[0]):"as no adapter specified";throw new ee("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function gt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Be(null,e)}function ht(e){gt(e),e.headers=Me.from(e.headers),e.data=Oe.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return pt(e.adapter||Ie.adapter)(e).then((function(t){return gt(e),t.data=Oe.call(e,e.transformResponse,t),t.headers=Me.from(t.headers),t}),(function(t){return Fe(t)||(gt(e),t&&t.response&&(t.response.data=Oe.call(e,e.transformResponse,t.response),t.response.headers=Me.from(t.response.headers))),Promise.reject(t)}))}const mt="1.7.5";var ft=n(58651);const Ct={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{Ct[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const St={};Ct.transitional=function(e,t,n){function i(e,t){return"[Axios v1.7.5] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,o,a)=>{if(!1===e)throw new ee(i(o," has been removed"+(t?" in "+t:"")),ee.ERR_DEPRECATED);return t&&!St[o]&&(St[o]=!0,ft.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,a)}};const vt={assertOptions:function(e,t,n){if("object"!=typeof e)throw new ee("options must be an object",ee.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let o=i.length;for(;o-- >0;){const a=i[o],r=t[a];if(r){const t=e[a],n=void 0===t||r(t,a,e);if(!0!==n)throw new ee("option "+a+" must be "+n,ee.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ee("Unknown option "+a,ee.ERR_BAD_OPTION)}},validators:Ct},yt=vt.validators;class Et{constructor(e){this.defaults=e,this.interceptors={request:new ge,response:new ge}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Ve(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:o}=t;void 0!==n&&vt.assertOptions(n,{silentJSONParsing:yt.transitional(yt.boolean),forcedJSONParsing:yt.transitional(yt.boolean),clarifyTimeoutError:yt.transitional(yt.boolean)},!1),null!=i&&(J.isFunction(i)?t.paramsSerializer={serialize:i}:vt.assertOptions(i,{encode:yt.function,serialize:yt.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a=o&&J.merge(o.common,o[t.method]);o&&J.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete o[e]})),t.headers=Me.concat(a,o);const r=[];let s=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let d,u=0;if(!s){const e=[ht.bind(this),void 0];for(e.unshift.apply(e,r),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=r.length;let p=t;for(u=0;u<d;){const e=r[u++],t=r[u++];try{p=e(p)}catch(e){t.call(this,e);break}}try{c=ht.call(this,p)}catch(e){return Promise.reject(e)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return pe(qe((e=Ve(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}J.forEach(["delete","get","head","options"],(function(e){Et.prototype[e]=function(t,n){return this.request(Ve(n||{},{method:e,url:t,data:(n||{}).data}))}})),J.forEach(["post","put","patch"],(function(e){function t(t){return function(n,i,o){return this.request(Ve(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Et.prototype[e]=t(),Et.prototype[e+"Form"]=t(!0)}));const Tt=Et;class At{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e,i,o){n.reason||(n.reason=new Be(e,i,o),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;return{token:new At((function(t){e=t})),cancel:e}}}const It=At;const Rt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Rt).forEach((([e,t])=>{Rt[t]=e}));const Dt=Rt;const Pt=function e(t){const n=new Tt(t),i=a(Tt.prototype.request,n);return J.extend(i,Tt.prototype,n,{allOwnKeys:!0}),J.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(Ve(t,n))},i}(Ie);Pt.Axios=Tt,Pt.CanceledError=Be,Pt.CancelToken=It,Pt.isCancel=Fe,Pt.VERSION=mt,Pt.toFormData=re,Pt.AxiosError=ee,Pt.Cancel=Pt.CanceledError,Pt.all=function(e){return Promise.all(e)},Pt.spread=function(e){return function(t){return e.apply(null,t)}},Pt.isAxiosError=function(e){return J.isObject(e)&&!0===e.isAxiosError},Pt.mergeConfig=Ve,Pt.AxiosHeaders=Me,Pt.formToJSON=e=>Te(J.isHTMLForm(e)?new FormData(e):e),Pt.getAdapter=pt,Pt.HttpStatusCode=Dt,Pt.default=Pt;const bt=Pt;var wt,Ut=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class Mt{constructor(e,t){this.defaultRequestTimeoutMS=8e3,this.axiosInstance=Mt.setAxiosInstance(t),this.clientParams=e,this.lastAbortController=new AbortController}static setAxiosInstance(e){return null!=e?e:bt.create()}static getGuid(e){return null==e||32!=e.length?e:e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20,e.length+1)}isCancelledByClient(e){return bt.isCancel(e)}postProxy(e,t,i,o){var a;return Ut(this,void 0,void 0,(function*(){if(e){const e=null===(a=n.g.SydneyDesignerInlayEditing_Commands)||void 0===a?void 0:a.dascall;if(e){const n=t.toLowerCase(),o=new URL(n),a=n.indexOf(o.pathname),r=n.substring(a),s=yield e(r,i),l={},c=Mt.getGuid(s.traceId);if("string"==typeof c&&(l[Ot.CorrelationId]=c),"string"==typeof s.errorMsg&&s.errorMsg.length>0||void 0!==s.errorCode){let e=`errorCode=[${s.errorCode}], subCode=[${s.errorSubCode}], `;e+=`reason=[${s.errorMsg}], status=[${s.responseCode}]`,l[Ot.FailureReason]=e}else if(200==s.responseCode&&void 0!==s.data){l["content-type"]=s.data.contentType;try{if(s.data.contentType.startsWith("text/plain"))return{data:atob(s.data.content),headers:l,status:s.responseCode};const e=yield fetch(`data:${s.data.contentType};base64,${s.data.content}`);return{data:yield e.blob(),headers:l,status:s.responseCode}}catch(e){l[Ot.FailureReason]=`Failed to decode or create blob: ${e}`}}return{data:"",headers:l,status:s.responseCode}}}return yield this.axiosInstance.post(t,i,o)}))}}!function(e){e[e.prod=0]="prod",e[e.edog=1]="edog",e[e.int=2]="int",e[e.local=3]="local",e[e.canary=4]="canary",e[e.euc=5]="euc"}(wt||(wt={}));const Ot={AccessToken:"AccessToken",Action:"Action",AudienceGroup:"AudienceGroup",Authorization:"Authorization",Caller:"Caller",ClientBuild:"ClientBuild",ClientId:"ClientId",ClientName:"ClientName",ContainerId:"ContainerId",ContentType:"Content-Type",CorrelationId:"X-Correlation",Correlation_Id:"X-Correlation-ID",DataCenterHint:"X-DC-Hint",DeviceId:"DeviceId",DocId:"DocId",EnvironmentHint:"X-Environment-Hint",ErrorCode:"X-ErrorCode",FailureReason:"X-FailureReason",FileToken:"FileToken",Handler:"Handler",HostApp:"HostApp",InviteCode:"InviteCode",InviteProgram:"InviteProgram",Locale:"Locale",PersistentId:"PersistentId",Platform:"Platform",ReleaseChannel:"ReleaseChannel",SessionId:"SessionId",StatusCode:"StatusCode",ThemeMetadatas:"ThemeMetadatas",Trigger:"Trigger",UploadToStorage:"x-upload-to-storage-das",UserAgent:"User-Agent",UserId:"UserId",UserSessionId:"X-UserSessionId",UserType:"UserType"},Ft={NotEnoughSuggestions:"NotEnoughSuggestions"},kt="http://localhost:8087",Bt="https://designerapp.edog.officeapps.live.com",_t="https://designerapp.officeapps.live-int.com",Lt="https://canary.designerapp.officeapps.live.com",Nt="https://euc.designerapp.officeapps.live.com",xt="https://designerapp.officeapps.live.com";class Gt{static getBaseUrl(e){switch(e){case wt.local:return kt;case wt.edog:return Bt;case wt.int:return _t;case wt.canary:return Lt;case wt.euc:return Nt;case wt.prod:default:return xt}}static getGettyUsageReportUrl(e){switch(e){case wt.euc:return"https://euc.hubblecontent.osi.office.net/contentsvc/api/telemetry/getty";case wt.local:case wt.edog:case wt.int:return"https://hubblecontent.df.osi.office.net/contentsvc/api/telemetry/getty";case wt.canary:case wt.prod:default:return"https://hubblecontent.osi.office.net/contentsvc/api/telemetry/getty"}}static getDasRing(e){const t=e.toString();if(t===new URL(kt).toString())return wt.local;if(t===new URL(Bt).toString())return wt.edog;if(t===new URL(_t).toString())return wt.int;if(t===new URL(Lt).toString())return wt.canary;if(t===new URL(Nt).toString())return wt.euc;if(t===new URL(xt).toString())return wt.prod;throw new Error("Invalid DAS URL")}static getAccountUrl(e){return this.getBaseUrl(e)+"/designerapp/Account.ashx"}static getAnimationsUrl(e){return this.getBaseUrl(e)+"/designerapp/Animation.ashx"}static getAnimationTemplatesUrl(e){return this.getAnimationsUrl(e)+"/?Action=GetAllAnimationTemplates"}static getAppsIntegrationUrl(e){return this.getBaseUrl(e)+"/designerapp/OAuth.ashx"}static getBrandKitEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/BrandKit.ashx"}static getDallEBaseUrl(e){return this.getBaseUrl(e)+"/designerapp/DallE.ashx"}static getDallEImageUrl(e){return`${this.getDallEBaseUrl(e)}?action=GetDallEImagesCogSci`}static getDallEReportImageUrl(e){return`${this.getDallEBaseUrl(e)}?action=ReportDallEImage`}static getDocumentEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/Document.ashx"}static getImageTransformUrl(e){return this.getBaseUrl(e)+"/designerapp/imagetransformation.ashx"}static getLoggingUrl(e){return this.getBaseUrl(e)+"/designerapp/RemoteUls.ashx"}static getMediaEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/MediaSuggestions.ashx"}static getMediaUploadUrl(e){return this.getBaseUrl(e)+"/designerapp/Media.ashx"}static getMediaPollUrl(e,t){return this.getBaseUrl(e)+`/designerapp/Media.ashx?action=poll&id=${t}`}static getObjectLevelAnimationUrl(e){return this.getAnimationsUrl(e)+"/?Action=ObjectLevelAnimation"}static getPhoneUploadServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/mobileupload.ashx"}static getProactiveSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/proactivesuggestions.ashx"}static getPublishUrl(e){return this.getBaseUrl(e)+"/designerapp/Publish.ashx"}static getRealTimeChannelUrl(e){return(this.getBaseUrl(e)+"/designerapp/RealTimeChannel.ashx").replace("http","ws")}static getRecommendedImageServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/FilterRecommendations.ashx"}static getSocialMediaOAuthURL(e,t,n){return this.getBaseUrl(e)+`/designerapp/SocialMedia.ashx?state=${t}&social_media=${n.toLocaleLowerCase()}`}static getStableDiffusionUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx"}static getSAMEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/sam.ashx/?Action=SAM"}static getStableDiffusionGenerativeFontEffectUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=TextEffects"}static getStableDiffusionObjectRemovalUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=MIRObjRem"}static getStableDiffusionProductPlacementUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=ProductPlacement"}static getStableDiffusionReportImageUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx/?Action=Report"}static getSubmitTemplateUrl(e){return this.getBaseUrl(e)+"/designerapp/SubmitTemplate.ashx"}static getSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/suggestions.ashx"}static getSuggestionThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx"}static getSuggestionCompressedThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx/?action=GetCompressedThumbnail"}static getTraceRequestEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/TraceRequest.ashx"}static getUserAssetsServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/userasset.ashx"}static getWhatsNewEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/notifications.ashx"}static getTryItPromptsUrl(e){return this.getBaseUrl(e)+"/designerapp/TryItPrompts.ashx"}static getOCPSClientUrl(e){return this.getBaseUrl(e)+"/designerapp/OCPSClient.ashx"}static getBotAssetUrl(e,t,n){return this.getBaseUrl(e)+`/designerapp/BotAsset.ashx?chatId=${t}&messageId=${n}`}static getAbuseMonitoringUrl(e){return this.getBaseUrl(e)+"/designerapp/AbuseMonitoring.ashx"}}var Ht;!function(e){e[e.InProgress=0]="InProgress",e[e.Completed=1]="Completed",e[e.Failed=2]="Failed"}(Ht||(Ht={}));var jt,zt,qt,Wt,Vt,$t,Kt,Qt,Jt,Yt,Xt,Zt,en,tn,nn;!function(e){e.AcLst="AcLst",e.AddNewPage="AddNewPage",e.ApplyDesignIdea="ApplyDesignIdea",e.ApplyImageEffects="ApplyImageEffects",e.ApplyImageSmartFilter="ApplyImageSmartFilter",e.ApplyTextTemplate="ApplyTextTemplate",e.AutoCrop="AutoCrop",e.BlurImage="BlurImage",e.CanvasPan="CanvasPan",e.CanvasZoom="CanvasZoom",e.CanvasZoomWithMultiPointer="CanvasZoomWithMultiPointer",e.ChangeAutoFitAction="ChangeAutoFitAction",e.ChangeBold="ChangeBold",e.ChangeDocFontFamily="ChangeDocFontFamily",e.ChangeEffects="ChangeEffects",e.ChangeFillColor="ChangeFillColor",e.ChangeFontEffect="ChangeFontEffect",e.ChangeFontFamily="ChangeFontFamily",e.ChangeFontSize="ChangeFontSize",e.ChangeGraphicColor="ChangeGraphicColor",e.ChangeGraphicPictureFill="ChangeGraphicPictureFill",e.ChangeItalic="ChangeItalic",e.ChangePictureBrightness="ChangePictureBrightness",e.ChangePictureContrast="ChangePictureContrast",e.ChangePictureEffects="ChangePictureEffects",e.ChangePictureSaturation="ChangePictureSaturation",e.ChangeStrike="ChangeStrike",e.ChangeStyle="ChangeStyle",e.ChangeTextColor="ChangeTextColor",e.ChangeZOrder="ChangeZOrder",e.ChgAdjVals="ChgAdjVals",e.CreateNewDoc="CreateNewDoc",e.Crop="Crop",e.CropAndScale="CropAndScale",e.CropToGeometry="CropToGeometry",e.CurrentCanvasSize="CurrentCanvasSize",e.Cutcopy="Cutcopy",e.DeleteBackground="DeleteBackground",e.DeleteText="DeleteText",e.DetachGraphicFromBackground="DetachGraphicFromBackground",e.DistributeAction="DistributeAction",e.DuplicateGraphic="DuplicateGraphic",e.DuplicatePage="DuplicatePage",e.EnsureFontAction="EnsureFontAction",e.InsertAudio="InsertAudio",e.InsertConnector="InsertConnector",e.InsertInk="InsertInk",e.InsertModel3D="InsertModel3D",e.InsertPicture="InsertPicture",e.InsertShape="InsertShape",e.InsertText="InsertText",e.InsertTxt="InsertTxt",e.InsertVideo="InsertVideo",e.InvalidateRenderer="InvalidateRenderer",e.ModConXfmAct="ModConXfmAct",e.ModXfrmAct="ModXfrmAct",e.OpenFile="OpenFile",e.Painted="Painted",e.Paste="Paste",e.PreviewAudio="PreviewAudio",e.RecomputeCanvasZoomPan="RecomputeCanvasZoomPan",e.RecreateView="RecreateView",e.RecreateViewAction="RecreateViewAction",e.RedrawScreen="RedrawScreen",e.RemoveGraphics="RemoveGraphics",e.RemovePage="RemovePage",e.ReorderPage="ReorderPage",e.ReplacePicture="ReplacePicture",e.ReplacePictureByPath="ReplacePictureByPath",e.ReplacePictureWithSmartCrop="ReplacePictureWithSmartCrop",e.ReplaceText="ReplaceText",e.RotateBackground="RotateBackground",e.SelGrphAct="SelGrphAct",e.SetAlphaColorTransform="SetAlphaColorTransform",e.SetGraphicAsBackground="SetGraphicAsBackground",e.SetPictureTransparency="SetPictureTransparency",e.SetTextAlphaColorTransform="SetTextAlphaColorTransform",e.SetTransparentBackground="SetTransparentBackground",e.SetupDoc="SetupDoc",e.SwitchPage="SwitchPage",e.TemplateLoadedFromURL="TemplateLoadedFromURL",e.ToggleTextCharacterRunAction="ToggleTextCharacterRunAction",e.Undoredo="Undoredo"}(jt||(jt={})),function(e){e.AddToSignupList="AddToSignupList",e.AddToWaitlist="AddToWaitlist",e.AddWaitListQuestionnaireResponse="AddWaitListQuestionnaireResponse",e.AppliedBrandedDesignIdea="AppliedBrandedDesignIdea",e.AppliedClientFilter="AppliedClientFilter",e.AppliedDesignFromScratch="AppliedDesignFromScratch",e.AppliedDesignIdea="AppliedDesignIdea",e.AppliedDesignInNewTab="AppliedDesignInNewTab",e.AppliedImageEffects="AppliedImageEffects",e.AppliedInspireRecommendations="AppliedInspireRecommendations",e.AppliedRemoveBackground="AppliedRemoveBackground",e.AppliedSmartFilter="AppliedSmartFilter",e.AppliedTextTemplate="AppliedTextTemplate",e.AppliedYourNextDesign="AppliedYourNextDesign",e.BulkDeleteDesigns="BulkDeleteDesigns",e.CancelDownload="CancelDownload",e.DismissNotifyMe="DismissNotifyMe",e.ChangedDisplayMode="ChangeDisplayMode",e.ClickedBrand="ClickedBrand",e.ClickedBrandThumbnail="ClickedBrandThumbnail",e.ClickedGenerateButton="ClickedGenerateButton",e.ClickedHomepageHeaderGenerateButton="ClickedHomepageHeaderGenerateButton",e.ClickedSharePromptTemplate="ClickedSharePromptTemplate",e.ClickedShuffle="ClickedShuffle",e.ClickedStyle="ClickedStyle",e.ClickedTemplate="ClickedTemplate",e.ClickedTryAnExample="ClickedTryAnExample",e.ClickedTryItTile="ClickedTryItTile",e.CompleteBrandKitSetUp="CompleteBrandKitSetUp",e.CopyInviteLink="CopyInviteLink",e.EditInDesigner="EditInDesigner",e.ShowDesignIdea="ShowDesignIdea",e.ShareArtifact="ShareArtifact",e.ShareImageBlob="ShareImageBlob",e.InitializedDocFromContent="InitializedDocFromContent",e.LazyTasksInitialization="LazyTasksInitialization",e.NavigatePage="NavigatePage",e.PageDuration="PageDuration",e.FetchAudios="FetchAudios",e.PrepareCanvasKit="PrepareCanvasKit",e.InitCanvasKitLayout="InitCanvasKitLayout",e.ClearActiveImageSource="ClearActiveImageSource",e.ClickedDalleEntry="ClickedDalleEntry",e.CloseDesignFromScratch="CloseDesignFromScratch",e.GetContentBasedSuggestions="GetContentBasedSuggestions",e.GetDalleImages="GetDalleImages",e.GetDalleInpaintedImages="GetDalleInpaintedImages",e.GetDallePrompts="GetDallePrompts",e.GetDFSPrompts="GetDFSPrompts",e.GetText2Category="GetText2Category",e.LoadThumbnails="LoadThumbnails",e.UpdateContentSuggestionImages="UpdateContentSuggestionImages",e.OpenDesignFromScratch="OpenDesignFromScratch",e.RenderDalleThumbnail="RenderDalleThumbnail",e.SearchedForDalleImage="SearchedForDalleImage",e.SkippedToBlankCanvas="SkippedToBlankCanvas",e.UploadImageFromDeviceDesignFromScratch="UploadImageFromDeviceDesignFromScratch",e.UploadImageFromPhoneDesignFromScratch="UploadImageFromPhoneDesignFromScratch",e.UpdateDesignQuery="UpdateDesignQuery",e.UpdateTitle="UpdateTitle",e.UpdateSubtitle="UpdateSubtitle",e.ClickOnMyMediaFromDFS="ClickOnMyMediaFromDFS",e.MyMediaUserActivity="MyMediaUserActivity",e.ClickOnTryItFREItem="ClickOnTryItFREItem",e.ClickOnUploadFromDFS="ClickOnUploadFromDFS",e.ClickOnUploadFromPhoneFromDFS="ClickOnUploadFromPhoneFromDFS",e.ClickOnLinkedInProfileFromDFS="ClickOnLinkedInProfileFromDFS",e.ClickPromptGuidance="ClickPromptGuidance",e.ServerExport="ServerExport",e.ShowPromptGuidance="ShowPromptGuidance",e.ExpandSuggestionItem="ExpandSuggestionItem",e.ShowDFSMyBrandButton="ShowDFSMyBrandButton",e.ToggleDFSMyBrandButton="ToggleDFSMyBrandButton",e.ToggleDFSMyBrandOption="ToggleDFSMyBrandOption",e.TriggerConsentCard="TriggerConsentCard",e.ConsentUsingUserPic="ConsentUsingUserPic",e.GetTryItFREPrompt="GetTryItFREPrompt",e.BrowseTryItFREItems="BrowseTryItFREItems",e.TryItFREItemHovered="TryItFREItemHovered",e.LoadedTryItFREItem="LoadedTryItFREItem",e.ClickMicrosoftCreateLink="ClickMicrosoftCreateLink",e.ClickPrivacyLink="ClickPrivacyLink",e.ClickRecentDesign="ClickRecentDesign",e.CloseModernBackstage="CloseModernBackstage",e.DeleteDesign="DeleteDesign",e.DuplicateDesign="DuplicateDesign",e.FailedToRenderDesign="FailedToRenderDesign",e.GetArtifactInfo="GetArtifactInfo",e.GetRecentDesigns="GetRecentDesigns",e.GetRecentImages="GetRecentImages",e.OpenContextMenu="OpenContextMenu",e.OpenModernBackstage="OpenModernBackstage",e.OpenNewDesign="OpenNewDesign",e.ClickLogoToHomePage="ClickLogoToHomePage",e.ClickMyDesigns="ClickMyDesigns",e.CloseFileMenu="CloseFileMenu",e.DuplicateCurrentDesign="DuplicateCurrentDesign",e.OpenFileMenu="OpenFileMenu",e.RenameCurrentDesign="RenameCurrentDesign",e.ResizeCurrentDesign="ResizeCurrentDesign",e.StartANewDesign="StartANewDesign",e.RTCConnectionStateChanged="RTCConnectionStateChanged",e.RTCSendRequest="RTCSendRequest",e.RTCStop="RTCStop",e.ClickWhatsNewItem="ClickWhatsNewItem",e.OpenWhatsNew="OpenWhatsNew",e.WhatsNewExpand="WhatsNewExpand",e.ClickedHeaderJoinButton="ClickedHeaderJoinButton",e.DisplayedLandingPage="DisplayedLandingPage",e.EnteredEmailIdForWaitList="EnteredEmailIdForWaitList",e.usedTopSignUpForm="usedTopSignUpForm",e.ClickedLandingPageCta="ClickedLandingPageCta",e.ClickedLandingPageSocialProof="ClickedLandingPageSocialProof",e.ChangeInputOnLandingPage="ChangeInputOnLandingPage",e.SawLandingPageFloatingFooter="SawLandingPageFloatingFooter",e.SubscribeToNotifications="SubscribeToNotifications",e.GuestFlowInitFromLandingPage="GuestFlowInitFromLandingPage",e.GuestFlowInitFromSkipUrlParam="GuestFlowInitFromSkipUrlParam",e.ResolveContentsUrls="ResolveContentsUrls",e.ApplyCaptionSuggestion="ApplyCaptionSuggestion",e.ApplyHashtagSuggestion="ApplyHashtagSuggestion",e.BeginPublish="BeginPublish",e.CancelCaptionHashtagGeneration="CancelCaptionHashtagGeneration",e.CancelOnSeenCaptionHashtagResult="CancelOnSeenCaptionHashtagResult",e.CancelPublish="CancelPublish",e.CopyCaptionTextToClipboard="CopyCaptionTextToClipboard",e.DismissDownloadCallout="DismissDownloadCallout",e.DismissShareCallout="DismissShareCallout",e.EditCaption="EditCaption",e.EditPostDescription="EditPostDescription",e.GenerateCaptionHashtag="GenerateCaptionHashtag",e.GenerateMoreCaptionHashtag="GenerateMoreCaptionHashtag",e.OpenCaptionHashtagGenerator="OpenCaptionHashtagGenerator",e.OpenDownloadCallout="OpenDownloadCallout",e.OpenShareCallout="OpenShareCallout",e.PublishToSocialMedia="PublishToSocialMedia",e.SelectPostGoal="SelectPostGoal",e.AppliedResizedSuggestion="AppliedResizedSuggestion",e.DismissSmartResizeModal="DismissSmartResizeModal",e.ExpandCuratedResizeList="ExpandCuratedResizeList",e.OpenSmartResizeModal="OpenSmartResizeModal",e.RequestResizedSuggestion="RequestResizedSuggestion",e.ResizeInNewTab="ResizeInNewTab",e.ApproveAsset="ApproveAssetToUpload",e.ApprovePhoneUploadedAssets="ApprovePhoneUploadedAssetsForUpload",e.GetPhoneUploadedAssets="GetPhoneUploadedAssets",e.GetPhoneUploadLink="GetPhoneUploadLink",e.GetPhoneUploadLinkInfo="GetPhoneUploadLinkInfo",e.PhoneBurstUpload="PhoneBurstUpload",e.EditTextPrompt="EditTextPrompt",e.GenerateTextContent="GenerateTextContent",e.ApplyTextContent="ApplyTextContent",e.ApplyTextContentReplaceAll="ApplyTextContentReplaceAll",e.CopyTextToClipboard="CopyTextToClipboard",e.ApplyTextTemplate="ApplyTextTemplate",e.EditExperienceGc2QoSError="EditExperienceGc2QoSError",e.GetSmartCrop="GetSmartCrop",e.GuestLoginPrompt="GuestLoginPrompt",e.GuestFlowSession="GuestFlowSession",e.TrackGuestLoginPrompt="TrackGuestLoginPrompt",e.TrackGuestSetupDoc="TrackGuestSetupDoc",e.AddBrandKitColor="AddBrandKitColor",e.ApplyBrandedPreview="ApplyBrandedPreview",e.ApplyBrandedTemplate="ApplyBrandedTemplate",e.ApplyBrandFromARETriggered="ApplyBrandFromARETriggered",e.ApplyBrandLogoToCanvas="ApplyBrandLogoToCanvas",e.CloseBrandStudio="CloseBrandStudio",e.CloseBrandStudioEditView="CloseBrandStudioEditView",e.CreateBrand="CreateBrand",e.DeleteBrandKit="DeleteBrandKit",e.DeleteBrandKitColor="DeleteBrandKitColor",e.DeleteLogo="DeleteLogo",e.DiscardBrandKitChanges="DiscardBrandKitChanges",e.DownloadBrandCard="DownloadBrandCard",e.DownloadBrandKit="DownloadBrandKit",e.DownloadLogo="DownloadLogo",e.EditBrand="EditBrand",e.EditBrandKitColor="EditBrandKitColor",e.EditBrandKitFont="EditBrandKitFont",e.ClearBrandVoice="ClearBrandVoice",e.GenerateBrandKit="GenerateBrandKit",e.GenerateLogo="GenerateLogo",e.GeneratePalette="GeneratePalette",e.GetBrandIdeas="GetBrandIdeas",e.GetBrandKit="GetBrandKit",e.OpenBrandStudio="OpenBrandStudio",e.OpenedAddBrandKitPane="ClickAddBrandKitButton",e.OpenPaletteGenerator="OpenPaletteGenerator",e.OpenShowMorePalettes="OpenShowMorePalettes",e.SelectGeneratedBrandKit="SelectGeneratedBrandKit",e.SelectOtherGeneratedPalette="SelectOtherGeneratedPalette",e.SaveBrand="SaveBrand",e.UndoApplyBrandedTemplate="UndoApplyBrandedTemplate",e.UploadLogo="UploadLogo",e.ResizeLogo="ResizeLogo",e.RemoveLogoBackground="RemoveLogoBackground",e.OpenMagicFill="OpenMagicFill",e.OpenMagicExpand="OpenMagicExpand",e.OpenMagicBackground="OpenMagicBackground",e.OpenMagicErase="OpenMagicErase",e.OpenMagicSAM="OpenMagicSAM",e.OpenQuickSelect="OpenQuickSelect",e.AcceptMagicFill="AcceptMagicFill",e.AcceptMagicExpand="AcceptMagicExpand",e.AcceptMagicBackground="AcceptMagicBackground",e.AcceptMagicErase="AcceptMagicErase",e.AcceptMagicSAM="AcceptMagicSAM",e.ClickCopy="ClickCopy",e.ClickDuplicate="ClickDuplicate",e.ClickRemove="ClickRemove",e.DiscardMagicFill="DiscardMagicFill",e.DiscardMagicExpand="DiscardMagicExpand",e.DiscardMagicBackground="DiscardMagicBackground",e.DiscardMagicErase="DiscardMagicErase",e.DiscardMagicSAM="DiscardMagicSAM",e.DiscardQuickSelect="DiscardQuickSelect",e.RestartMagicFill="RestartMagicFill",e.RestartMagicErase="RestartMagicErase",e.ReportMagicErase="ReportMagicErase",e.ReportMagicExpand="ReportMagicExpand",e.ReportMagicFill="ReportMagicFill",e.RestartQuickSelect="RestartQuickSelect",e.AcquireAccessToken="AcquireAccessToken",e.AddAuthTokenToConfig="AddAuthTokenToConfig",e.AddAuthTokenToMap="AddAuthTokenToMap",e.SilentSso="SilentSso",e.SubstrateAccessTokenUpdated="SubstrateAccessTokenUpdated",e.UpdateActiveUser="UpdateActiveUser",e.UserStartedLogout="UserStartedLogout",e.DismissBrandkitMigrationMessageBar="DismissBrandkitMigrationMessageBar",e.DismissCustomFontsMigrationMessageBar="DismissCustomFontsMigrationMessageBar",e.DismissBackstageMigrationMessageBar="DismissBackstageMigrationMessageBar",e.OnlineMigrationCompleted="OnlineMigrationCompleted",e.OnlineMigrationInterrupted="OnlineMigrationInterrupted",e.OnlineMigrationStarted="OnlineMigrationStarted",e.OnlineStorageStartMigrationRequest="OnlineStorageStartMigrationRequest",e.ShowBrandkitMigrationMessageBar="ShowBrandkitMigrationMessageBar",e.ShowCustomFontsMigrationMessageBar="ShowCustomFontsMigrationMessageBar",e.ShowBackstageMigrationMessageBar="ShowBackstageMigrationMessageBar",e.UserEligibleForOnlineMigration="UserEligibleForOnlineMigration",e.CustomizeAlbumSuggestion="CustomizeAlbumSuggestion",e.GenerateAlbumSuggestions="GenerateAlbumSuggestions",e.GetAlbumSuggestions="GetAlbumSuggestions",e.SeenAlbumSuggestion="SeenAlbumSuggestion",e.CustomizeCollageSuggestion="CustomizeCollageSuggestion",e.GenerateCollageSuggestions="GenerateCollageSuggestions",e.GetCollageSuggestions="GetCollageSuggestions",e.ShowCollageSuggestion="ShowCollageSuggestion",e.MiniAppLoaded="MiniAppLoaded",e.ClickedGeneratedResult="ClickedGeneratedResult",e.EditTryItTile="EditTryItTile",e.ClickedHistoryItem="ClickedHistoryItem",e.DeleteCreation="DeleteCreation",e.GetArtifactList="GetArtifactList",e.DismissedInstallBanner="DismissedInstallBanner",e.ClickedInstallBanner="ClickedInstallBanner",e.ClickedInstallBannerPostCoreAction="ClickedInstallBannerPostCoreAction",e.ClickEditImage="ClickEditImage",e.ClickCreateDesign="ClickCreateDesign",e.CanvasInlayGetRegeneratedImage="CanvasInlayGetRegeneratedImage",e.CanvasInlayClickedBackOrExit="CanvasInlayClickedBackorExit",e.CanvasInlayUsedBlurBackground="CanvasInlayUsedBlurBackground",e.CanvasInlayUsedColorPop="CanvasInlayUsedColorPop",e.CanvasInlayUsedGenerativeErase="CanvasInlayUsedGenerativeErase",e.CanvasInlayUsedRestyle="CanvasInlayUsedRestyle",e.CanvasInlayUsedResize="CanvasInlayUsedResize",e.CanvasInlayFRE="CanvasInlayFRE",e.CanvasInlayPinchZoom="CanvasInlayPinchZoom",e.EditorSaveBlobToHost="EditorSaveBlobToHost",e.EditorHostSaveResult="EditorHostSaveResult",e.GenerateDocumentFromPrompt="GenerateDocumentFromPrompt",e.OpenDocument="OpenDocument",e.BeginDocumentSave="BeginDocumentSave",e.EndDocumentSave="EndDocumentSave",e.StartSaveSession="StartSaveSession",e.EndSaveSession="EndSaveSession",e.UpdatePersistentId="UpdatePersistentId",e.EditDocumentForSave="EditDocumentForSave",e.DesignerHostMessageHandlerInit="DesignerHostMessageHandlerInit",e.DesignerHostMessageHandlerSetExperience="DesignerHostMessageHandlerSetExperience",e.DesignerHostMessageHandlerSendMessage="DesignerHostMessageHandlerSendMessage",e.DesignerHostMessageHandlerReceiveMessage="DesignerHostMessageHandlerReceiveMessage",e.DesignerHostMessageHandlerUpdateCallbackStatus="DesignerHostMessageHandlerUpdateCallbackStatus",e.DesignerHostMessageSetExportVariation="DesignerHostMessageSetExportVariation",e.GetPrompt="GetPrompt",e.PollIdBasedCanvasDefaultImage="PollIdBasedCanvasDefaultImage",e.DownloadIdBasedCanvasDefaultImage="DownloadIdBasedCanvasDefaultImage",e.HitBoostLimit="HitBoostLimit",e.ClickBoostCoinButton="ClickBoostCoinButton",e.ShowBoostUpsell="ShowBoostUpsell",e.ClickBuyCopilotButton="ClickBuyCopilotButton",e.AppliedImageAdjustSettings="AppliedImageAdjustSettings",e.BrowseMediaAsset="BrowseMediaAsset",e.CanvasDragEditFPS="CanvasDragEditFPS",e.ClickBrandFontButtonInFontPane="ClickBrandFontButtonInFontPane",e.ClickCarouselIndicator="ClickCarouselIndicator",e.ClickDesignerSocialLink="ClickDesignerSocialLink",e.ClickedSendAnInvite="ClickedSendAnInvite",e.ClickEasySocialSharingLink="ClickEasySocialSharingLink",e.ClickFontCategory="ClickFontCategory",e.ClickFontInsideFontCategory="ClickFontInsideFontCategory",e.ClickFontSearchResults="ClickFontSearchResults",e.ClickInsidePanel="ClickInsidePanel",e.ClickRecentFonts="ClickRecentFonts",e.ClickCustomFonts="ClickCustomFonts",e.ClickRecommendedHashtag="ClickRecommendedHashtag",e.ClickSignInUploadPanel="ClickSignInUploadPanel",e.ClickSimilarFonts="ClickSimilarFonts",e.ClickSuggestedFonts="ClickSuggestedFonts",e.CloseImageCreator="CloseImageCreator",e.CloseSendInviteModal="CloseSendInviteModal",e.ConnectUserCloudAccount="ConnectUserCloudAccount",e.ContextualMenu="ContextualMenu",e.CopyArtifact="CopyArtifact",e.CopyGeneratedImage="CopyGeneratedImage",e.DeleteAsset="DeleteAsset",e.DeleteFont="DeleteFont",e.DeleteMultipleAssets="DeleteMultipleAssets",e.DesignerOnlineCheck="DesignerOnlineCheck",e.UndoDeletedAssets="UndoDeletedAssets",e.DiscardPhoneUploadedAssets="DiscardPhoneUploadedAssets",e.DisconnectCloudAccount="DisconnectCloudAccount",e.DismissDesignIdeasPanel="DismissDesignIdeasPanel",e.DismissFontPanel="DismissFontPanel",e.DismissInstallBannerPostCoreAction="DismissInstallBannerPostCoreAction",e.DismissMyFonts="DismissMyFonts",e.DismissReferralCardPopup="DismissReferralCardPopup",e.DismissReferralPane="DismissReferralPane",e.DisplayedInstallBanner="DisplayedInstallBanner",e.DisplayedInstallBannerPostCoreActionSuccess="DisplayedInstallBannerPostCoreActionSuccess",e.DisplayedTabletBlockingPage="DisplayedTabletBlockingPage",e.DoneTeachingStep="DoneTeachingStep",e.DownloadArtifact="DownloadArtifact",e.DownloadGeneratedImage="DownloadGeneratedImage",e.DownloadImage="DownloadImage",e.DragAndDrop="DragAndDrop",e.EditImagePaneClose="EditImageClose",e.EditImagePaneOpen="EditImageOpen",e.ExportVideoFrame="ExportVideoFrame",e.ExportVideoFrameCompleted="ExportVideoFrameCompleted",e.GenerateImageTexture="GenerateImageTexture",e.GetAbuseMonitoringExport="GetAbuseMonitoringExport",e.GetCloudUserAssets="GetCloudUserAssets",e.GetCloudUserOAuthURL="GetCloudUserOAuthURL",e.GetCloudUserProfile="GetCloudUserProfile",e.GetAllAssets="GetAllAssets",e.GetAllCloudAssets="GetAllCloudAssets",e.GetAllFontAssets="GetAllFontAssets",e.GetAllImageArtifacts="GetAllImageArtifacts",e.GetAndUploadCloudUserAsset="GetAndUploadCloudUserAsset",e.GetAssetById="GetAssetById",e.GetAssetPathById="GetAssetPathById",e.GetAutoAdjustEffects="GetAutoAdjustEffects",e.GetAutoFocusEffects="GetAutoFocusEffects",e.GetBackgroundRemoval="GetBackgroundRemoval",e.GetCopilotInfo="GetCopilotInfo",e.GetDepthMapBlur="GetDepthMapBlur",e.GetObjectRemoval="GetObjectRemoval",e.GetM365LicenseInfo="GetM365LicenseInfo",e.GetMagicFill="GetMagicFill",e.GetMagicBackground="GetMagicBackground",e.GetMagicExpand="GetMagicExpand",e.GetQuickSelect="GetQuickSelect",e.GetBGRClientMaskApplyTime="GetBGRClientMaskApplyTime",e.GetDesignIdeas="GetDesignIdeas",e.GetEmailContactPoint="GetEmailContactPoint",e.GetUserCountryLocaleInfo="GetUserCountryLocaleInfo",e.GetUserLevelPermission="GetUserLevelPermission",e.PatchEmailContactPoint="PatchEmailContactPoint",e.GetFontSearchResults="GetFontSearchResults",e.GetImageAIResult="GetImageAIResult",e.GetImageFilterRecommendations="GetImageFilterRecommendations",e.GetInspireRecommendations="GetInspireRecommendations",e.GetColorMapData="GetColorMapData",e.GetGenerativeText="GetGenerativeText",e.GetInviteInformation="GetInviteInformation",e.GetMediaAssets="GetMediaAssets",e.GetMediaAssetsForEditor="GetMediaAssetsForEditor",e.GetPostContentSuggestions="GetPostContentSuggestions",e.GetProfileInfo="GetProfileInfo",e.GetRegeneratedDallEImage="GetRegeneratedDallEImage",e.GetRewrittenDallEImagePrompt="GetRewrittenDallEImagePrompt",e.GetSAMMaskSelections="GetSAMMaskSelections",e.GetSelectedCategoryFonts="GetSelectedCategoryFonts",e.GetStorageInfo="GetStorageInfo",e.GetSimilarFonts="GetSimilarFonts",e.GetSmartFilter="GetSmartFilter",e.GetSuggestedFonts="GetSuggestedFonts",e.GetStableDiffusionGenerativeFontEffect="GetStableDiffusionGenerativeFontEffect",e.GetStableDiffusionObjectRemovedImage="GetStableDiffusionObjectRemovedImage",e.GetStableDiffusionProductPlacementImage="GetStableDiffusionProductPlacementImage",e.GetTemplates="GetTemplates",e.GetTranslatedText="GetTranslatedText",e.GetUserCloudProfileInfo="GetUserCloudProfileInfo",e.GetYourNextDesign="GetYourNextDesign",e.ImageEffectsOpen="ImageEffectsOpen",e.InitializeSAM="InitializeSAM",e.InitializeSAMBackground="InitializeSAMBackground",e.InsertMediaAsset="InsertMediaAsset",e.InspireRecommendationReset="InspireRecommendationReset",e.LinkOauthAccount="LinkOauthAccount",e.LoadedAdvancedTextTemplate="LoadedAdvancedTextTemplate",e.LoadedDesignFromScratchPanel="LoadedDesignFromScratchPanel",e.LoadedTemplatesPanel="LoadedTemplatesPanel",e.LoadedVisualsPanel="LoadedVisualsPanel",e.LoadedVisualsPanelInEditor="LoadedVisualsPanelInEditor",e.LoadFont="LoadFont",e.LoadImagePanel="LoadImagePanel",e.LoadSmartFilter="LoadSmartFilter",e.MigrateAssetsFromBlobToOneDrive="MigrateAssetsFromBlobToOneDrive",e.MobileWebCopySeen="MobileWebCopySeen",e.MobileWebShareToPhone="MobileWebShareToPhone",e.MobileWebShareSupported="MobileWebShareSupported",e.MotionThumbnailHover="MotionThumbnailHover",e.NavigatePanels="NavigatePanels",e.NavigateToExport="NavigateToExport",e.OpenDesignIdeasPanel="OpenDesignIdeasPanel",e.OpenReplaceImagePane="OpenReplaceImagePane",e.PopulateUploadedMedia="PopulateUploadedMedia",e.PreprocessInspireRecommendations="PreprocessInspireRecommendations",e.PreviewAudio="PreviewAudio",e.RecordLoginSource="RecordLoginSource",e.RecordSelectionNavigationTime="RecordSelectionNavigationTime",e.RecommendedHashtags="RecommendedHashtags",e.RemoveFromWaitlist="RemoveFromWaitlist",e.RenameDesign="RenameDesign",e.RenderContextualPanel="RenderContextualPanel",e.RenderImage="RenderImage",e.RenderedMotionThumbnail="RenderedMotionThumbnail",e.ReportStableDiffusionImage="ReportStableDiffusionImage",e.ResetAdjustSettings="ResetAdjustSettings",e.RestoreBackground="RestoreBackground",e.RetryGetDesignIdeas="RetryGetDesignIdeas",e.SaveArtifact="SaveArtifact",e.SearchWithSearchBox="SearchWithSearchBox",e.SelectionChanged="SelectionChanged",e.SendArtifactToPhone="SendArtifactToPhone",e.SendFeedback="SendFeedback",e.SetInitialPanel="SetInitialPanel",e.SharedDesign="SharedDesign",e.ShareFromSendToPhone="ShareFromSendToPhone",e.ShowReferralCardPopup="ShowReferralCardPopup",e.ShowReferralPane="ShowReferralPane",e.StartedTeachingStep="StartedTeachingStep",e.SubmitPromptTemplate="SubmitPromptTemplate",e.SubmitSendFeedback="SubmitSendFeedback",e.TemplateApplied="TemplateApplied",e.TestRenderFidelity="TestRenderFidelity",e.TransformRecommendation="TransformRecommendation",e.TriedInspireRecommendation="TriedInspireRecommendation",e.UndoApplyDesignIdea="UndoApplyDesignIdea",e.UndoApplyResizedSuggestion="UndoApplyResizedSuggestion",e.UndoApplyTemplate="UndoApplyTemplate",e.UndoEditImage="UndoEditImage",e.UpdateCloudUserRefreshToken="UpdateCloudUserRefreshToken",e.UpdatedUserAccountInfo="UpdatedUserAccountInfo",e.UpdateUndoRedoState="UpdateUndoRedoState",e.UploadCloudUserAsset="UploadCloudUserAsset",e.UploadFromPhoneCreateBurstUploadSession="CreateBurstUploadSession",e.UploadAllAssetsFromPhone="UploadAllAssetsFromPhone",e.UploadAsset="UploadAsset",e.ChunkingUploadCreateVideoUploadSession="ChunkingUploadCreateVideoUploadSession",e.ChunkingUploadVideoChunkUpload="ChunkingUploadVideoChunkUpload",e.ChunkingUploadVideoFileCommit="ChunkingUploadVideoFileCommit",e.UploadAssetViaChunk="UploadAssetViaChunk",e.UploadAssetFromPhone="UploadAssetsFromPhone",e.UploadCloudAsset="UploadCloudAsset",e.UploadDalleURL="UploadDalleURL",e.UploadFont="UploadFont",e.UploadMultipleCloudAssets="UploadMultipleCloudAssets",e.UploadMultipleAssets="UploadMultipleAssets",e.UserAssetDrop="UserAssetDrop",e.UserAssetReplace="UserAssetReplace",e.UserAssetThumbnailClick="UserAssetThumbnailClick",e.ValidateImageManifest="ValidateImageManifest",e.GetUserAssetUnifiedAPI="GetUserAssetUnifiedAPI",e.UploadURLToFileCache="UploadURLToFileCache",e.UploadURLToOneDrive="UploadURLToOneDrive",e.ValidateInvite="ValidateInvite",e.SyncUserAssets="SyncUserAssets",e.AddNewPage="AddNewPage",e.AddDuplicatePage="AddDuplicatePage",e.RemovePage="RemovePage",e.ReorderPage="ReorderPage",e.SwitchPage="SwitchPage",e.MultipageExport="MultipageExport",e.MultipageAction="MultipageAction",e.MultipageThumbnail="MultipageThumbnail",e.CloseExportSuccessModal="CloseExportSuccessModal",e.OpenExportSuccessModal="OpenExportSuccessModal",e.ShowPromotionPane="ShowPromotionPane",e.DisplayedMobileLandingPage="DisplayedMobileLandingPage",e.RedirectedToAppDownloadPage="RedirectedToAppDownloadPage",e.EmailInputStart="EmailInputStart",e.EmailInputSubmitted="EmailInputSubmitted",e.PwaInstallAvailable="PwaInstallAvailable",e.InstalledPwa="InstalledPwa",e.GlobalErrorBoundary="GlobalErrorBoundary",e.GetDocumentContentFromSuggestionUrl="GetDocumentContentFromSuggestionUrl",e.LayersPanelOpen="LayersPanelOpen",e.LayersItemSelection="LayersItemSelection",e.LayersItemDrag="LayersItemDrag",e.AddPromptTemplateField="AddPromptTemplateField",e.ClosePromptTemplateEditor="ClosePromptTemplateEditor",e.LoadedPromptTemplateFromUrl="LoadedPromptTemplateFromUrl",e.OpenPromptTemplateEditor="OpenPromptTemplateEditor",e.PromptTemplatePageShare="PromptTemplatePageShare",e.SharePromptTemplate="SharePromptTemplate",e.GenFontEffectPresetClickedFromEmpty="GenFontEffectPresetClickedFromEmpty",e.GenFontEffectPresetClickedTogglingOff="GenFontEffectPresetClickedTogglingOff",e.GenFontEffectPresetClickedGoingToNew="GenFontEffectPresetClickedGoingToNew",e.GenFontEffectRemovePaneButton="GenFontEffectRemovePaneButton",e.GenFontEffectTextInputFromSame="GenFontEffectTextInputFromSame",e.GenFontEffectTextInputFromEmpty="GenFontEffectTextInputFromEmpty",e.GenFontEffectTextInputFromDifferent="GenFontEffectTextInputFromDifferent",e.GenFontEffectCtxUIDiscard="GenFontEffectCtxUIDiscard",e.GenFontEffectCtxUILooksGood="GenFontEffectCtxUILooksGood",e.GenFontEffectCtxUIRegenerate="GenFontEffectCtxUIRegenerate",e.ExportAndSaveToBingChatStorage="ExportAndSaveToBingChatStorage",e.GetChatHistory="GetChatHistory",e.FetchImageFromQueryParam="FetchImageFromQueryParam",e.TeamsAppInitialization="TeamsAppInitialization",e.TeamsGetAuthToken="TeamsGetAuthToken",e.GetBotImagesFromDAS="GetBotImagesFromDAS",e.DetailPageImagesReady="DetailPageImagesReady",e.RenderedSplashScreen="RenderedSplashScreen",e.DisplayedRegionBlockingPage="DisplayedRegionBlockingPage",e.ClickInsertImage="ClickInsertImage",e.ClickReportImage="ClickReportImage",e.ClickRetryButtonImage="ClickRetryButtonImage",e.CloseWelcomeCopilotProModal="CloseWelcomeCopilotProModal",e.OpenWelcomeCopilotProModal="OpenWelcomeCopilotProModal"}(zt||(zt={})),function(e){e.CreateDocument="CreateDocument",e.OpenDocument="OpenDocument",e.SaveDocument="SaveDocument",e.DeleteDocument="DeleteDocument",e.DeltaSaveDocument="DeltaSaveDocument",e.WriteToMRU="WriteToMRU",e.FullSaveDocument="FullSaveDocument",e.SaveDocumentThumbnail="SaveDocumentThumbnail",e.GetBlob="GetBlob",e.DocumentSaveCompleted="DocumentSaveCompleted"}(qt||(qt={})),function(e){e.CompleteBoot="CompleteBoot",e.FeatureGatesLoadedFromCache="FeatureGatesLoadedFromCache",e.StartBoot="StartBoot",e.CheckHardwareCompatibility="CheckHardwareCompatibility",e.SessionStart="SessionStart",e.SessionEnded="SessionEnded",e.ContainerExpired="ContainerExpired",e.LaunchNewSession="LaunchNewSession"}(Wt||(Wt={})),function(e){e.InitializeActiveUser="InitializeActiveUser",e.SetActiveAccount="SetActiveAccount",e.SilentSsoSuccess="SilentSsoSuccess",e.ShowAadBlockPage="ShowAadBlockPage",e.UserCompletedLogin="UserCompletedLogin",e.UserCompletedLogout="UserCompletedLogout",e.BeforeLoginStart="BeforeLoginStart",e.UserStartedLogin="UserStartedLogin",e.UserStartedLogout="UserStartedLogout",e.GetAuthTokenMSAL="GetAuthTokenMSAL",e.HandleRedirectEnd="HandleRedirectEnd"}(Vt||(Vt={})),function(e){e.AuthAccountAdded="AuthAccountAdded",e.AuthAccountRemoved="AuthAccountRemoved",e.AuthSetActiveAccount="AuthSetActiveAccount",e.AuthSilentSsoSuccess="AuthSilentSsoSuccess",e.AuthUserCompletedLogin="AuthUserCompletedLogin",e.AuthUserCompletedLogout="AuthUserCompletedLogout",e.AuthUserStartedLogin="AuthUserStartedLogin",e.AuthUserStartedLogout="AuthUserStartedLogout",e.GetAuthTokenMSAL="GetAuthTokenMSAL"}($t||($t={})),function(e){e.ShowCookieBanner="ShowCookieBanner",e.DismissCookieBanner="DismissCookieBanner",e.OpenPrivacyStatementLink="OpenPrivacyStatementLink",e.OpenThirdPartyCookiesLink="OpenThirdPartyCookiesLink",e.ManageCookies="ManageCookies",e.AcceptAllCookies="AcceptAllCookies",e.RejectCookies="RejectCookies"}(Kt||(Kt={})),function(e){e.MiniEditSuggestion="EditSuggestion",e.MiniApplySuggestion="ApplySuggestion",e.MiniCopySuggestion="CopySuggestion",e.MiniDownloadSuggestion="DownloadSuggestion",e.MiniSendSuggestionSelectedMessage="SendSuggestionSelectedMessage",e.MiniStartFromBlank="StartFromBlank",e.MiniOpenSizeSelector="OpenSizeSelector",e.MiniChangeSize="ChangeSize",e.MiniChangeInputText="ChangeInputText",e.MiniAttemptLogin="MiniAttemptLogin",e.MiniSessionHover="SessionHover",e.MiniSessionScroll="SessionScroll",e.MiniHover="Hover",e.MiniScroll="Scroll",e.MiniFetchSuggestions="FetchSuggestions",e.MiniHostInitSuggestions="HostInitSuggestions",e.MiniHostUpdateSuggestions="HostUpdateSuggestions",e.MiniSignInRedirectClick="MiniSignInRedirectClick",e.MiniSignInRedirectPage="MiniSignInRedirectPage",e.MiniUploadImages="MiniUploadImages",e.MiniBrandFooteDesignerLogoClick="BrandFooterDesignerLogoClick"}(Qt||(Qt={})),function(e){e.MiniOpen="OpenMini",e.MiniClose="CloseMini",e.CompleteBoot="CompleteBoot"}(Jt||(Jt={})),function(e){e.CanvasLaunchTime="CanvasLaunchTime"}(Yt||(Yt={})),function(e){e.GlobalErrorBoundary="GlobalErrorBoundary"}(Xt||(Xt={})),function(e){e.Initialized="Initialized",e.PromptTileClicked="PromptTileClicked",e.PromptTileSeen="PromptTileSeen",e.Rendered="Rendered",e.RenderedWithImages="RenderedWithImages",e.SearchQuery="SearchQuery",e.SearchResultsClicked="SearchResultsClicked",e.SeeAllMiniAppsClicked="SeeAllMiniAppsClicked",e.TabClicked="TabClicked",e.TileClicked="TileClicked",e.TileSeen="TileSeen",e.CarouselButtonClicked="CarouselButtonClicked"}(Zt||(Zt={})),function(e){e.ReportWebVitals="ReportWebVitals",e.OutgoingRequest="OutgoingRequest"}(en||(en={})),function(e){e.Auth="Auth",e.AppActions="App",e.CanvasActions="Canvas",e.CookieActions="Cookie",e.Session="Session",e.Errors="Errors",e.Performance="Performance",e.Document="Document",e.Mock="Mock"}(tn||(tn={})),function(e){e.LocalBrowserContext="Local",e.GlobalBrowserContext="Global"}(nn||(nn={}));class on{setSuccess(e){}addMetadata(e,t,n){}setResult(e,t,n){}endNow(){}}var an,rn=n(60150),sn=n(58728);!function(e){e[e.None=0]="None",e[e.Sampled=1]="Sampled"}(an||(an={}));var ln=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-\S+)?$/,cn=function(e){return/^0+$/.test(e)},dn=/^([\da-f]{16})$/,un=16,pn=function(){function e(e,t,n){void 0===e&&(e=hn()),void 0===t&&(t=mn()),this.traceId=e,this.version="00",this._parentId=t,this._traceFlags=function(e){void 0===e&&(e=an.None);return e&an.Sampled}(n)}return Object.defineProperty(e.prototype,"parentId",{get:function(){return this._parentId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"traceFlags",{get:function(){return this._traceFlags},enumerable:!1,configurable:!0}),e.prototype.isValid=function(){return ln.test(this.serialize())&&!cn(this.traceId)&&!cn(this._parentId)},e.prototype.isSampled=function(){return(this.traceFlags&an.Sampled)===an.Sampled},e.prototype.updateSampled=function(e,t){return t!==this._parentId&&(!!this.updateParentId(t)&&(this._traceFlags=e?this._traceFlags|an.Sampled:this._traceFlags&~an.Sampled,!0))},e.prototype.updateParentId=function(e){return e?!(!dn.test(e)||cn(e))&&(this._parentId=e,!0):(this._parentId=mn(),!0)},e.prototype.serialize=function(){return"".concat(this.version,"-").concat(this.traceId,"-").concat(this._parentId,"-0").concat(this._traceFlags)},e.create=function(t,n,i){var o=new e(t,n,i);return o.isValid()?o:void 0},e.createNew=function(t){return new e(hn(),mn(),t)},e.parse=function(t){var n=ln.exec(t);if(n&&"ff"!==n[1]&&("00"!==n[1]||!n[5]))return e.create(n[2],n[3],parseInt(n[4],un))},e}();function gn(e){var t=new Uint8Array(e);window.crypto.getRandomValues(t);var n=Array.from(t).map((function(e){return(256+e).toString(un).slice(1)})).join("");return cn(n)?n.slice(1)+"1":n}function hn(){return gn(16)}function mn(){return gn(8)}var fn=n(81962),Cn="[-_*/0-9a-z]",Sn="[a-z]".concat(Cn,"{0,255}"),vn="[0-9a-z]".concat(Cn,"{0,240}"),yn="[a-z]".concat(Cn,"{0,13}"),En="".concat(vn,"@").concat(yn),Tn=new RegExp("^(?:".concat(Sn,"|").concat(En,")$")),An=/^[ -+--<>-~]{0,255}[!-+--<>-~]$/,In=function(){function e(){this._listMemberMap=new Map}return e.prototype.set=function(e,t){if(!Tn.test(e)||!An.test(t))return!1;var n=this._listMemberMap;return n.has(e)&&n.delete(e),n.set(e,t),n.size>32&&n.delete(n.keys().next().value),!0},e.prototype.unset=function(e){this._listMemberMap.delete(e)},e.prototype.get=function(e){return this._listMemberMap.get(e)},Object.defineProperty(e.prototype,"keys",{get:function(){return Array.from(this._listMemberMap.keys()).reverse()},enumerable:!1,configurable:!0}),e.prototype.serialize=function(){var e=this;return this.keys.map((function(t){return"".concat(t).concat("=").concat(e._listMemberMap.get(t))})).join(",")},e.parse=function(t){var n=new e,i=t.split(","),o=!0;return i.reverse().forEach((function(e){var t=e.trim();if(t){var i=t.split("=");2===i.length&&n.set(i[0],i[1])||((0,fn.wC)(1,0,(function(){return"Invalid trace state entry '".concat(t,"'")})),o=!1)}})),o?n:void 0},e}(),Rn=function(){function e(){}return e.getFields=function(e){var t="Event.",n=e.parent,i=e.state,a=i?i.serialize():void 0;return(0,o.__spreadArray)([(0,sn.m9)(t+"TraceId",n.traceId),(0,sn.m9)(t+"TraceParentId",n.parentId),(0,sn.Ug)(t+"TraceFlags",n.traceFlags)],a?[(0,sn.m9)(t+"TraceState",a)]:[],!0)},e}();var Dn=n(12569);n(58651);const Pn=new class{constructor(){this.telemetryLogger=new rn.M}createActivity(e){var t,n;const i=wn(e);if(null==i)return this.telemetryLogger.createActivity(e);const o=null!==(n=null===(t=e.eventContract)||void 0===t?void 0:t.name)&&void 0!==n?n:"";return this.telemetryLogger.createActivity(Object.assign(Object.assign({},e),{eventContract:Object.assign(Object.assign({},e.eventContract),{name:o,dataFields:Rn.getFields(i)})}))}sendActivity(e,t,n,i){this.telemetryLogger.sendActivity(e,t,n,i)}sendError(e){this.telemetryLogger.sendError(e)}createCustomerContentActivity(e){return this.telemetryLogger.createCustomerContentActivity(e)}sendTelemetryEvent(e){var t,n;const i=wn(e);if(null==i)return void this.telemetryLogger.sendTelemetryEvent(e);const o=null!==(n=null===(t=e.eventContract)||void 0===t?void 0:t.name)&&void 0!==n?n:"";this.telemetryLogger.sendTelemetryEvent(Object.assign(Object.assign({},e),{eventContract:Object.assign(Object.assign({},e.eventContract),{name:o,dataFields:Rn.getFields(i)})}))}sendCustomerContent(e){this.telemetryLogger.sendCustomerContent(e)}shutdown(){this.telemetryLogger.telemetrySinks.forEach((e=>{e instanceof Dn.r&&e.shutdown()}))}flush(){this.telemetryLogger.telemetrySinks.forEach((e=>{e instanceof Dn.r&&e.flush(!1)}))}setLogger(e){this.telemetryLogger=e}};function bn(e){var t;let n=e.dataFields||[];return n=[...n,...(null===(t=e.eventContract)||void 0===t?void 0:t.dataFields)||[]],Object.assign({},...n.map((e=>({[e.name]:e.value}))))}function wn(e){if(null==e)return;const t=bn(e);if(null==t)return;let n;var i;return"Event.TraceParent"in t&&"Event.TraceFlags"in t&&(n=function(e,t){var n=pn.parse(e);if(n){var i=void 0;return t&&(i=In.parse(t)),i||(i=new In),{parent:n,state:i}}}(t["Event.TraceParent"],t["Event.TraceFlags"])),null==n&&(i=an.Sampled,n={parent:pn.createNew(i),state:new In}),n}var Un=n(51199);const Mn=Un.o.DataCategories,On=Un.o.DiagnosticLevel;Un.o.DataFieldType;class Fn{constructor(e,t){this.sendEventCallback=t,this.metadata={},this.success=!1,this.activityConfig=e}setSuccess(e,t){const n=e?0:t?1:-1,i=e?"Success":t?"ExpectedFailure":"Failure",o=e?void 0:null!=t&&t;this.setResult(n,i,o)}addMetadata(e,t,n){this.metadata[e]=t}setResult(e,t,n){this.result={code:e,type:t,isExpected:n},this.success=0===this.result.code}endNow(){this.activityConfig.shouldSendEvent&&(this.metadata.Result=this.result,this.metadata.Success=this.success,this.metadata.IsCoreAction=this.activityConfig.isCoreAction,this.sendEventCallback(this.metadata))}}var kn=n(67785),Bn=n(79163),_n=n(58152);const Ln={};class Nn extends Fn{constructor(e,t,n){super(e,n),this.activity=t,this.activity.dataFields.push((0,sn.k)("CorrelationId",e.correlationId)),this.activity.dataFields.push((0,sn.LK)("IsUserAction",e.isUserInitiated)),this.activity.dataFields.push((0,sn.k)("DocId",e.docId)),this.activity.dataFields.push((0,sn.ip)("NetworkBandwidth",this.getNetworkBandwidthInMbps())),e.isCoreAction&&this.activity.dataFields.push((0,sn.LK)("Core",e.isCoreAction)),e.isIntentionalAction&&this.activity.dataFields.push((0,sn.LK)("UserIntent",e.isIntentionalAction)),e.additionalFields&&Object.entries(e.additionalFields).forEach((([e,t])=>{this.addMetadata(e,t,!0)}))}addMetadata(e,t,n){try{if(n&&null!=t&&""!==t)switch(typeof t){case"string":this.activity.dataFields.push((0,sn.m9)(e,t));break;case"number":isFinite(t)&&Math.floor(t)===t&&t<Number.MAX_SAFE_INTEGER&&t>Number.MIN_SAFE_INTEGER?this.activity.dataFields.push((0,sn.Ug)(e,t)):this.activity.dataFields.push((0,sn.ip)(e,t));break;case"boolean":this.activity.dataFields.push((0,sn.LK)(e,t));break;default:{const n=JSON.stringify(null!=t?t:"");this.activity.dataFields.push((0,sn.m9)(e,n))}}}catch(t){kn.Hv.sendTraceTag(527034193,Bn.n.msoulscat_Wac_Telemetry,_n.k.Error,`Error serializing key to activity Key:${e} Error:${t}`)}super.addMetadata(e,t,n)}endNow(){if(this.result?(this.activity.result=this.result,this.activity.success=0===this.result.code):this.activity.success=this.success,!this.isThrottled()){if(this.activityConfig.isLoggingEnabled){this.activity.endNow();const e=+bn(this.activity)["Activity.Duration"];this.metadata.Duration=e/1e3}this.activityConfig.shouldSendEvent&&super.endNow()}}isThrottled(){if(!this.activityConfig.MinMillisecondsLapsedPerEvent)return!1;const e=Ln[this.activityConfig.friendlyName];return!!(e&&e>Date.now()-this.activityConfig.MinMillisecondsLapsedPerEvent)||(Ln[this.activityConfig.friendlyName]=Date.now(),!1)}getNetworkBandwidthInMbps(){var e,t,n;return null!==(n=null===(t=null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.connection)||void 0===t?void 0:t.downlink)&&void 0!==n?n:-1}}var xn=n(11397);class Gn{constructor(){if(this.eventEmitter=new xn.EventEmitter,this.broadcastChannel="BroadcastChannel"in self?new BroadcastChannel("global_events"):void 0,Gn.instance)throw new Error("Error - EventManager.INSTANCE already exist.")}static getInstance(){return this.instance}on(e,t){this.broadcastChannel&&(this.broadcastChannel.onmessage=n=>{n.data.scope===nn.GlobalBrowserContext&&(kn.Hv.sendTraceTag(508433306,Bn.n.msoulscat_Wac_Telemetry,_n.k.Info,`EventManager.on: ${n.data.name}:${e} is handled`),t(n.data))}),this.eventEmitter.on(e,t)}emit(e,t){try{t.scope===nn.GlobalBrowserContext&&(this.broadcastChannel?(this.broadcastChannel.postMessage(t),kn.Hv.sendTraceTag(0,Bn.n.msoulscat_Wac_Telemetry,_n.k.Info,`EventManager.emit: ${t.name}:${e} is broadcasted`)):kn.Hv.sendTraceTag(0,Bn.n.msoulscat_Wac_Telemetry,_n.k.Info,`EventManager.emit: BroadcastChannel is not supported. ${t.name}:${e} is not broadcasted`)),this.eventEmitter.emit(e,t)}catch(e){throw kn.Hv.sendTraceTag(538186145,Bn.n.msoulscat_Wac_PptLive,_n.k.Error,`Event failed: ${t.name} Ex:${e}`),e}}removeAllListeners(){var e;this.eventEmitter.removeAllListeners(),null===(e=this.broadcastChannel)||void 0===e||e.close()}off(e,t){this.eventEmitter.removeListener(e,t)}}Gn.instance=new Gn;class Hn{constructor(e,t,n,i,o,a,r,s){if(Hn.instance)throw new Error("Error - TelemetryManager.INSTANCE already exist.");this.tenantName=e,this.activityCustomInitializer=t,this.hostInfoProvider=n,this.sessionInfoProvider=i,this.eventSubscriptionParams=o,this.clientScenarios=r,this.traceRequestBatchCustomizer=s,this.clientStoreProxy=null!=a?a:{dispatchPushTemplateHistoryAction:e=>{},dispatchPopTemplateHistoryAction:()=>{},dispatchSetAppliedTemplateAction:e=>{},dispatchSetAppliedVariationAction:e=>{},dispatchSetDocumentDirtiedAction:e=>{}}}static initialize(e,t,n,i,o,a,r,s){Hn.instance=new Hn(e,t,i,n,o,a,r,s)}static getInstance(){if(!Hn.instance)throw new Error("Error - TelemetryManager.INSTANCE has not been created before being accessed!");return this.instance}customizeActitivity(e,t,n){this.activityCustomInitializer&&this.activityCustomInitializer(e,t,n)}customizeTraceRequestBatchPayloads(e){this.traceRequestBatchCustomizer&&this.traceRequestBatchCustomizer(e)}getScenarioEventSubscriptionParams(){return this.eventSubscriptionParams}getTraceRequestHostInfo(){return this.hostInfoProvider()}getTraceRequestSessionInfo(){return this.sessionInfoProvider()}getClientScenarios(){return this.clientScenarios}getScenarioClientStoreProxy(){return this.clientStoreProxy}createEventName(e,t,n){const i=`${n||this.tenantName}.${e}.${t}`;return i.includes("_")?(kn.Hv.sendTraceTag(529093148,Bn.n.msoulscat_Wac_Telemetry,_n.k.Error,"eventName contains underscores"),i.replace(/_/g,"")):i}}const jn="IntentionalAction",zn={friendlyName:jn,eventType:tn.AppActions,tenantNameOverride:"Office.DesignerApp",isUserInitiated:!1,isLoggingEnabled:!0,shouldSendEvent:!1};function qn(e){if(e.shouldSendEvent||e.isLoggingEnabled){const t=!!e.isCoreAction&&(e.friendlyName===jn||Vn.has(e.friendlyName)),n=t||e.friendlyName===jn||$n.has(e.friendlyName),i=i=>{!function(e,t,n,i,o=!1,a=nn.LocalBrowserContext){var r;const s={type:e,name:t,isUserInitiated:n,isSuccess:null===(r=i.Success)||void 0===r||r,error:"",metadata:i,scope:a,IsIntentionalAction:o};Gn.getInstance().emit(e,s)}(e.eventType,e.friendlyName,e.isUserInitiated,i,n),n&&e.friendlyName!==jn&&function(e,t,n,i){const o=qn(e);o.setSuccess(t,i),n&&n.forEach((e=>{o.addMetadata(e.key,e.value,e.shouldAddToActivityLogging)}));o.endNow()}(Object.assign(Object.assign({},zn),{isCoreAction:t,additionalFields:{TriggerEvent:e.friendlyName}}),!0)},o=Object.assign(Object.assign({},e),{isCoreAction:t,isIntentionalAction:n,correlationId:"",docId:""});if(Wn){const t=Pn.createActivity({eventName:Hn.getInstance().createEventName(e.eventType,e.friendlyName,e.tenantNameOverride),eventFlags:{dataCategories:Mn.ProductServicePerformance|Mn.ProductServiceUsage,diagnosticLevel:On.RequiredServiceData}});return Hn.getInstance().customizeActitivity(t,o,e),new Nn(o,t,i)}}return new on}let Wn=!1,Vn=new Set,$n=new Set;const Kn="ServerHost",Qn="ServerPath",Jn="Action",Yn="StatusCode",Xn="RequestType",Zn="Method",ei="ContentType",ti="Error";var ni;!function(e){e.Axios="axios",e.Fetch="fetch"}(ni||(ni={}));const ii=(e,t,n,i,o)=>{var a;if(!(null==t?void 0:t.startsWith("http"))&&!(null==t?void 0:t.startsWith("/")))return new on;const{action:r,host:s,path:l}=(e=>{e.startsWith("/")&&(e=window.location.origin+e);try{const t=new URL(e),n=[...t.searchParams],i=n.find((e=>"action"==e[0].toLowerCase())),o=n.find((e=>"path"==e[0].toLowerCase()));let a=i?i[1]:null,r=t.pathname;return r.endsWith(".ashx")||(r=""),r=null==r?void 0:r.substring(0,60),r&&r.toLocaleLowerCase().indexOf("document.ashx")>-1&&o&&null===a&&(a="Download"),{host:t.host,path:r,action:a}}catch(e){return{host:"",path:"",action:null}}})(t);if(l.toLocaleLowerCase().includes("tracerequest.ashx"))return new on;const c=null===(a=null==o?void 0:o.keys)||void 0===a?void 0:a.call(o);if(c&&Array.from(c).some((e=>"dalle-poll-url"===e)))return new on;const d={[Jn]:r,[ei]:i,[Zn]:n,[Xn]:e,[Kn]:s,[Qn]:l};return qn({friendlyName:en.OutgoingRequest,eventType:tn.Performance,isUserInitiated:!1,isLoggingEnabled:!0,shouldSendEvent:!1,additionalFields:d})},oi=(e,t)=>{if(!e)return;const{statusCode:n,isExpectedFailure:i}=t||{},o=Boolean(n&&n>=100&&n<300);if(e.setSuccess(o,i),!o){const t=null!=n?`HTTP status code is ${n}`:"No status code";e.addMetadata(ti,t,!0)}null!=n&&e.addMetadata(Yn,n,!0),e.endNow()};var ai=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};var ri,si,li,ci=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class di extends Mt{constructor(){super(...arguments),this.defaultRequestTimeoutMS=8e3}fetchSuggestions(e,t,n,i){var o,a,r,s,l;return ci(this,void 0,void 0,(function*(){e.cancelLastRequest&&this.lastAbortController.abort();try{this.lastAbortController=new AbortController;const l=Ci.createRequestHeaders(this.clientParams,e.requestParams);l["Content-Type"]=e.contentType;const c=n?yield this.fetchSuggestionAsStreamData(e,l,this.lastAbortController,i):yield this.axiosInstance.request({url:this.url,data:e.data,headers:l,method:e.method,params:e.queryParams,timeout:null!==(a=null===(o=e.requestParams)||void 0===o?void 0:o.RequestTimeoutMS)&&void 0!==a?a:this.defaultRequestTimeoutMS,responseType:"arraybuffer",signal:this.lastAbortController.signal}),d=di.parseDASResponse(c.data,c.headers,c.status,t,n);return(null===(s=null===(r=e.requestParams)||void 0===r?void 0:r.hints)||void 0===s?void 0:s.ShouldPrefetchPictureThumbnails)&&d.then((t=>ci(this,void 0,void 0,(function*(){var n,i,o;(null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.suggestions)&&(yield Ci.prefetchThumbnails(t.content.suggestions,null!==(o=null===(i=e.requestParams)||void 0===i?void 0:i.ThumbnailPrefetchTimeoutInMs)&&void 0!==o?o:this.defaultRequestTimeoutMS))})))),yield d}catch(e){const t=this.isCancelledByClient(e),i=n&&"AbortError"===e.name,o=n&&!e.response&&e instanceof DOMException&&(null===(l=e.message)||void 0===l?void 0:l.includes("abort"));if(t||o||i)return{error:ri.ClientCanceled};throw e}}))}static parseDASResponse(e,t,n,i,o){var a;return ci(this,void 0,void 0,(function*(){if(n){const e=Ci.getSuggestionRequestErrorFromStatusCode(n,t);if(e!==ri.None)return{headers:t,statusCode:n,error:e}}const r=o?Ci.validateAndGetContentBody(e):new Uint8Array(e);if(!r||r instanceof Uint8Array&&!r.length)return{headers:t,statusCode:n,error:ri.NoResponse};const s=null!==(a=t[Ot.ContentType])&&void 0!==a?a:t[Ot.ContentType.toLowerCase()];if(!s)return{headers:t,statusCode:n,error:ri.NoResponse};let l={};const c=Ci.getContentType(s);return c==si.Multipart?l=yield di.parseMultipartSuggestions(s,r,i,o):c==si.JSON&&r instanceof Uint8Array&&(yield Ti.parseJSONPart(r,l)),{content:l,headers:t,statusCode:n,error:ri.None}}))}fetchSuggestionAsStreamData(e,t,n,i){var o,a;return ci(this,void 0,void 0,(function*(){const r=null!==(a=null===(o=e.requestParams)||void 0===o?void 0:o.RequestTimeoutMS)&&void 0!==a?a:this.defaultRequestTimeoutMS;let s;const l=new Promise((e=>s=setTimeout(e,r))),c=(d=`${this.url}?${e.queryParams.toString()}`,u={method:e.method,headers:t,body:e.data,signal:n.signal},ai(void 0,void 0,void 0,(function*(){var e;const t="string"==typeof d?d:d.url,n=null!==(e="string"==typeof d?null==u?void 0:u.method:d.method)&&void 0!==e?e:"GET",i=null==u?void 0:u.headers,o=null==i?void 0:i["Content-Type"],a=ii(ni.Fetch,t,n,o,null==u?void 0:u.body);try{const e=yield fetch(d,u);return oi(a,{statusCode:e.status}),e}catch(e){throw oi(a),e}})));var d,u;const p=yield Promise.race([c,l]);if(!p)throw this.lastAbortController.abort(),new Error(`timeout of ${r}ms exceeded`);if(!p.ok)throw{response:p};s&&clearTimeout(s);const g=p,h=Ci.convertHeadersToLowerCase(g.headers);return null==i||i(h),{data:g.body,headers:h,status:g.status}}))}static parseMultipartSuggestions(e,t,n,i){return ci(this,void 0,void 0,(function*(){return n==li.SCHEMA_V2?yield Pi.parseMultipartSuggestions(e,t,i):n==li.SCHEMA_V1?yield Ai.parseMultipartSuggestions(e,t,i):yield Ti.parseMultipartSuggestions(e,t,i)}))}}class ui extends di{constructor(){super(...arguments),this.url=Gt.getSuggestionEndpointUrl(this.clientParams.ServiceRing)}getSuggestions(e,t,n,i,o){return ci(this,void 0,void 0,(function*(){const a=JSON.stringify(e),r=new URLSearchParams,s=null==t?void 0:t.DocumentId;return void 0!==s&&r.append("documentId",s),yield this.fetchSuggestions({cancelLastRequest:n,contentType:"application/json",data:a,method:"POST",requestParams:t,queryParams:r},void 0,i,o)}))}getMultiPageSuggestions(e,t,n,i,o,a=li.SCHEMA_V1){return ci(this,void 0,void 0,(function*(){const r=JSON.stringify(e),s=new URLSearchParams,l=null==t?void 0:t.DocumentId;return void 0!==l&&s.append("documentId",l),yield this.fetchSuggestions({cancelLastRequest:n,contentType:"application/json",data:r,method:"POST",requestParams:t,queryParams:s},a,i,o)}))}getSuggestionDataFromFileCacheUrl(e,t,n,i){var o;return ci(this,void 0,void 0,(function*(){const a=null!=n?n:1,r=null!=i?i:500;let s,l;for(let n=0;n<a;n++)try{const i=yield this.axiosInstance.request({url:`${e}&action=getSuggestionData`,method:"GET",timeout:null!==(o=null==t?void 0:t.RequestTimeoutMS)&&void 0!==o?o:this.defaultRequestTimeoutMS,responseType:"arraybuffer",signal:this.lastAbortController.signal});if(s=yield di.parseDASResponse(i.data,i.headers,i.status),s.error==ri.None)return s;n<a-1&&(l&&clearTimeout(l),yield new Promise((e=>{l=setTimeout(e,r)})))}catch(e){n<a-1&&(l&&clearTimeout(l),yield new Promise((e=>{l=setTimeout(e,r)})))}return l&&clearTimeout(l),null!=s?s:{error:ri.NoResponse}}))}getSuggestionsWithImageContent(e,t,n,i,o){return ci(this,void 0,void 0,(function*(){const a=yield Ti.buildMultipartMixedRequest(e),r=new URLSearchParams,s=null==t?void 0:t.DocumentId;return void 0!==s&&r.append("documentId",s),yield this.fetchSuggestions({contentType:a.contentType,cancelLastRequest:n,data:a.body,method:"POST",queryParams:r,requestParams:t},void 0,i,o)}))}getMultiPageSuggestionsWithImageContent(e,t,n,i,o,a=li.SCHEMA_V1){return ci(this,void 0,void 0,(function*(){const r=yield Ti.buildMultipartMixedRequest(e),s=new URLSearchParams,l=null==t?void 0:t.DocumentId;return void 0!==l&&s.append("documentId",l),yield this.fetchSuggestions({contentType:r.contentType,cancelLastRequest:n,data:r.body,method:"POST",queryParams:s,requestParams:t},a,i,o)}))}static parseSuggestionsResponse(e,t,n){const i=Object.create(null,{parseDASResponse:{get:()=>super.parseDASResponse}});return ci(this,void 0,void 0,(function*(){const o=i.parseDASResponse.call(this,e,t,n);return yield o}))}}!function(e){e.ClientCanceled="Client canceled request",e.None="None",e.NoResults="No Results",e.NoResponse="No Response",e.Timeout="Timeout",e.NotEnoughSuggestions="Not Enough Suggestions"}(ri||(ri={})),function(e){e[e.Multipart=0]="Multipart",e[e.JSON=1]="JSON",e[e.Default=2]="Default"}(si||(si={})),function(e){e[e.SCHEMA=0]="SCHEMA",e[e.SCHEMA_V1=1]="SCHEMA_V1",e[e.SCHEMA_V2=2]="SCHEMA_V2"}(li||(li={}));var pi,gi=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class hi{}hi.tryPopulatePageDataFromUrlForMultiPageSuggestions=(e,t,n,i,o)=>gi(void 0,void 0,void 0,(function*(){var a,r,s,l,c,d,u,p;let g=!0;if(null!=t.multipageSuggestionUrls){const h=yield Promise.all(t.multipageSuggestionUrls.map((t=>e.getSuggestionDataFromFileCacheUrl(t,n,i,o))));for(let e=0;e<h.length;e++)null!=(null===(r=null===(a=h[e])||void 0===a?void 0:a.content)||void 0===r?void 0:r.pageData)?t.multiPageData[e]=null===(l=null===(s=h[e])||void 0===s?void 0:s.content)||void 0===l?void 0:l.pageData:g=!1,null!=(null===(d=null===(c=h[e])||void 0===c?void 0:c.content)||void 0===d?void 0:d.relationshipsData)?t.multiRelationshipsData[e]=null===(p=null===(u=h[e])||void 0===u?void 0:u.content)||void 0===p?void 0:p.relationshipsData:g=!1}return g})),function(e){e[e.CONTINUE=100]="CONTINUE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.PROCESSING=102]="PROCESSING",e[e.EARLY_HINTS=103]="EARLY_HINTS",e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.MOVED_TEMPORARILY=302]="MOVED_TEMPORARILY",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.USE_PROXY=305]="USE_PROXY",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_TOO_LONG=413]="REQUEST_TOO_LONG",e[e.REQUEST_URI_TOO_LONG=414]="REQUEST_URI_TOO_LONG",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.IM_A_TEAPOT=418]="IM_A_TEAPOT",e[e.INSUFFICIENT_SPACE_ON_RESOURCE=419]="INSUFFICIENT_SPACE_ON_RESOURCE",e[e.METHOD_FAILURE=420]="METHOD_FAILURE",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.LOCKED=423]="LOCKED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"}(pi||(pi={}));var mi=n(78126),fi=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class Ci{static createRequestHeaders(e,t){var n;const i={};i[Ot.AudienceGroup]=e.AudienceGroup,i[Ot.Caller]=e.Caller,i[Ot.ClientId]=e.ClientId,i[Ot.SessionId]=e.SessionId,i[Ot.UserId]=e.UserId,e.ClientName&&(i[Ot.ClientName]=e.ClientName);const o=null!==(n=null==t?void 0:t.CorrelationId)&&void 0!==n?n:(0,mi.A)();return i[Ot.CorrelationId]=o,i[Ot.Correlation_Id]=o,t&&(t.ContainerId&&(i[Ot.ContainerId]=t.ContainerId),t.DocumentId&&(i[Ot.DocId]=t.DocumentId),t.FileToken&&(i[Ot.FileToken]=t.FileToken),t.AuthToken&&(i[Ot.Authorization]=t.AuthToken),t.EnvHint&&(i[Ot.EnvironmentHint]=t.EnvHint),t.DcHint&&(i[Ot.DataCenterHint]=t.DcHint),t.ClientBuild&&(i[Ot.ClientBuild]=t.ClientBuild),t.ClientName&&(i[Ot.ClientName]=t.ClientName),t.HostApp&&(i[Ot.HostApp]=t.HostApp),t.Platform&&(i[Ot.Platform]=t.Platform),t.ReleaseChannel&&(i[Ot.ReleaseChannel]=t.ReleaseChannel),t.DesignerappserviceThirdParty&&(i["x-designerappservice-third-party"]=t.DesignerappserviceThirdParty)),e.UserType&&(i[Ot.UserType]=e.UserType),i["x-req-start"]=String(performance.now()),i}static prefetchThumbnails(e,t){return fi(this,void 0,void 0,(function*(){if((null==e?void 0:e.length)>0){const n=new Array;for(const t of e)if(t.relationshipsData){const e=t.relationshipsData;if(null==e?void 0:e.Relationship)for(const t of e.Relationship)t.Thumbnail&&n.push(t.Thumbnail)}n.length>0&&(yield Promise.all(n.map((e=>bt.get(e,{timeout:t})))))}}))}static getSuggestionRequestErrorFromStatusCode(e,t){var n,i;switch(e){case pi.OK:return ri.None;case pi.NO_CONTENT:return(null!==(i=null===(n=null==t?void 0:t[Ot.FailureReason.toLowerCase()])||void 0===n?void 0:n.toString())&&void 0!==i?i:"").toLowerCase()===Ft.NotEnoughSuggestions.toLowerCase()?ri.NotEnoughSuggestions:ri.NoResults;default:return ri.NoResponse}}static getContentType(e){return-1!=e.indexOf("multipart/mixed")?si.Multipart:-1!=e.indexOf("application/json")?si.JSON:si.Default}static convertHeadersToLowerCase(e){if(!e)return{};const t={};for(const[n,i]of e.entries())t[n.toLowerCase()]=i;return t}static validateAndGetContentBody(e){if(!e)return null;if(e instanceof ArrayBuffer){const t=new Uint8Array(e);return(null==t?void 0:t.length)?t:null}return e instanceof ReadableStream?e.getReader():null}}Ci.tryPopulateSuggestionPayloadFromURL=(e,t,n,i,o)=>fi(void 0,void 0,void 0,(function*(){var a,r,s;if(t.isMultiPage)return yield hi.tryPopulatePageDataFromUrlForMultiPageSuggestions(e,t,n,i,o);if(void 0!==(null==t?void 0:t.suggestionUrl)){const l=yield e.getSuggestionDataFromFileCacheUrl(t.suggestionUrl,n,i,o);if(null===(a=null==l?void 0:l.content)||void 0===a?void 0:a.pageData)return t.pageData=null===(r=null==l?void 0:l.content)||void 0===r?void 0:r.pageData,t.relationshipsData=null===(s=null==l?void 0:l.content)||void 0===s?void 0:s.relationshipsData,!0}return!1}));class Si{async processMultipartResponse(e,t,n){if(null==e)throw"multipartContentBuffer is empty";try{const i=new TextDecoder("utf-8").decode(e);this.parseMultipart(i,t).forEach((e=>{const t=this.parseResponsePart(e);n(t)}))}catch(e){const t={Err:new Error(e)};n(t)}}fetchBoundary(e){let t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,n){if(!e)throw"multipartContentBufferOrStream is empty";let i,o,a="",r=0,s=[],l=null;const c=e instanceof Uint8Array;try{for(;;){if(c)o=e;else{const{done:t,value:n}=await e.read();if(t)break;o=n}for(const e of o){const o=10===e||13===e,c=10===e&&13===l,d=10===l&&13===e;if(s.push(e),o||(a+=String.fromCharCode(e)),0===r&&c)`--${t}`===a&&(r=1,a="",s=[]);else if(1===r&&d)i=new Uint8Array(s),r=2,a="",s=[];else if(2===r&&c)r=3,a="",s=[];else if(3===r){if(a.length>t.length+4&&(a=""),`--${t}`===a){let e=s.length-a.length,t=s.slice(0,e-1);r=1,n({Headers:this.processHeader(i),Body:new Uint8Array(t)}),a="",i=void 0,s=[]}c&&(a="")}l=e}if(c)break}}catch(e){n({Err:new Error(e)})}}parseMultipart(e,t){const n=`--${t}`;return e.split(n).map((e=>e.trim())).filter((e=>""!==e&&"--"!==e))}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),n=new Map;t.forEach((e=>{const t=e.split(": ");2===t.length&&n.set(t[0],t[1])}));const i=this.parseResponseBodyFromPart(e),o=(new TextEncoder).encode(i);return{Headers:n,Body:o}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){let t=new Map;if(e){let n="";for(let t=0;t<e.byteLength;t+=1)n+=String.fromCharCode(e[t]);n.split("\n").forEach((e=>{let n=e.split(": ");2===n.length&&t.set(n[0],n[1])}))}return t}}var vi=n(37542).Buffer,yi=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))},Ei=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class Ti{static buildMultipartMixedRequest(e){var t,n;return yi(this,void 0,void 0,(function*(){const i="...Boundary_Outer";let o="",a=[],r=[];if("ImageFiles"in e&&e.ImageFiles.length>0){const{ImageFiles:t}=e,n=Ei(e,["ImageFiles"]);a=t,o=JSON.stringify(n)}else if("ImageBuffers"in e&&e.ImageBuffers.length>0){const{ImageBuffers:t}=e,n=Ei(e,["ImageBuffers"]);r=t,o=JSON.stringify(n)}else("ImageUrls"in e&&(null===(t=e.ImageUrls)||void 0===t?void 0:t.length)||(null===(n=e.MediaContent)||void 0===n?void 0:n.length))&&(o=JSON.stringify(e));const s=`--${i}\r\nContent-Type: application/json\r\n\r\n${o}`,l=vi.from(s),c=[];let d=l.length;if(c.push(l),(null==a?void 0:a.length)>0){for(const e of a)if(e.size>0&&e.type.length>0){const t=`\r\n--${i}\r\nContent-Type: ${e.type}\r\n\r\n`,n=vi.from(t),o=yield e.arrayBuffer(),a=new Uint8Array(o);c.push(n),c.push(a),d+=n.length,d+=a.length}}else if(r.length>0)for(const e of r)if(e.buffer.byteLength>0&&e.type.length>0){const t=`\r\n--${i}\r\nContent-Type: ${e.type}\r\n\r\n`,n=vi.from(t);c.push(n),c.push(e.buffer),d+=n.length,d+=e.buffer.length}const u=vi.from(`\r\n--${i}--`);c.push(u),d+=u.length;const p=new Uint8Array(d);let g=0;return c.forEach((e=>{p.set(e,g),g+=e.length})),{contentType:`multipart/mixed; boundary=${i}`,body:p}}))}static parseMultipartSuggestions(e,t,n){return yi(this,void 0,void 0,(function*(){const i={suggestions:[]},o=n?e=>{this.parseSuggestionPartContent(e,i,n)}:void 0,a=yield this.getSuggestionsPartContent(e,t,o);if(!n)for(const e of a)this.parseSuggestionPartContent(e,i);return i}))}static parseSuggestionPartContent(e,t,n){return yi(this,void 0,void 0,(function*(){const{Headers:i,Body:o}=e,a=null==i?void 0:i.get(Ot.ContentType);if(o&&a)if(!0===a.startsWith("application/json"))this.parseJSONPart(o,t,n);else this.parseDesignContent(e,t,n)}))}static getSuggestionsPartContent(e,t,n){return yi(this,void 0,void 0,(function*(){const i=new Si,o=i.fetchBoundary(e),a=[];let r="";return yield i.processMultipartBinaryResponse(t,o,(e=>{e.Err?r=`Designer Response: Error parsing response body ${e.Err}`:(null==n||n(e),a.push(e))})),r?Promise.reject(r):a}))}static parseDesignJSONPart(e,t){const n=(new TextDecoder).decode(e),i=JSON.parse(n);t.designData=i}static parseJSONPart(e,t,n){var i,o,a,r,s;return yi(this,void 0,void 0,(function*(){const l=(new TextDecoder).decode(e),c=JSON.parse(l);if(c.pageIds)return this.parseDesignJSONPart(e,t),void(null==n||n(t));if(c.KeyPhrases&&c.KeyPhrases.length>0)return t.keyphrase=null!==(i=c.KeyPhrases[0].KeyPhraseText)&&void 0!==i?i:"",void(null==n||n(t));if(c.Metadata){const e=c.Metadata;(null===(o=e.PromptEngineering)||void 0===o?void 0:o.PromptGuidance)&&(t.promptGuidance=e.PromptEngineering.PromptGuidance),(null===(a=e.PromptEngineering)||void 0===a?void 0:a.ParsedHeading)&&(t.parsedHeading=e.PromptEngineering.ParsedHeading),(null===(r=e.Prompt)||void 0===r?void 0:r.DetectedPromptIntent)&&(t.promptIntent=e.Prompt.DetectedPromptIntent)}if(c.PageData&&(t.pageData=c.PageData),c.RelationshipsData&&(t.relationshipsData=c.RelationshipsData),c.DesignData&&(t.designData=c.DesignData),null==n||n(t),c.DesignId){const e={data:new Uint8Array,metadata:""};this.populateDesignContentFromJson(e,c),null==n||n(e),null===(s=t.suggestions)||void 0===s||s.push(e)}}))}static parseDesignContent(e,t,n){var i;return yi(this,void 0,void 0,(function*(){const{Headers:o,Body:a}=e,r=null==o?void 0:o.get(Ot.ContentType);if(!r||!a)return;const s={data:new Uint8Array,metadata:""},l=new Si,c=l.fetchBoundary(r).trim();let d="";if(yield l.processMultipartBinaryResponse(a,c,(e=>{e.Err?d=`error parsing inner response body ${e.Err}`:this.populateDesignContent(e,s)})),d)throw new Error(d);null==n||n(s),null===(i=t.suggestions)||void 0===i||i.push(s)}))}static populateDesignContent(e,t){var n;return yi(this,void 0,void 0,(function*(){const{Headers:i,Body:o}=e,a=null===(n=null==i?void 0:i.get(Ot.ContentType))||void 0===n?void 0:n.trim();if(a&&o)if(a.startsWith("application/json")){const e=JSON.parse((new TextDecoder).decode(o));this.populateDesignContentFromJson(t,e)}else if(this.supportedMimeTypesForBinaryData.has(a)){if(o.length<=1)return;t.data=o}}))}}Ti.supportedMimeTypesForBinaryData=new Set(["image/jpeg","image/png","image/bmp"]),Ti.populateDesignContentFromJson=(e,t)=>{var n,i,o,a,r,s,l,c;t&&(e.metadata=null!==(n=t.Metadata)&&void 0!==n?n:"",e.pageData=null!==(i=t.PageData)&&void 0!==i?i:{},e.relationshipsData=null!==(o=t.RelationshipsData)&&void 0!==o?o:{},e.dimension=t.Dimension,e.slideSize=t.SlideSize,e.highResThumbnailUrl=null!==(a=t.HighResThumbnailUrl)&&void 0!==a?a:"",e.suggestionUrl=t.SuggestionUrl,e.urlIdentifier=t.UrlIdentifier,e.isMotionSuggestion=null!==(r=t.IsMotionSuggestion)&&void 0!==r&&r,t.additionalMetadata&&(e.proactiveSuggestionMetadata=t.additionalMetadata),e.debugInfo=t.DebugInfo,e.isMultiPage=t.IsMultiPage,e.apsEventId=t.ApsEventId,e.designLocale=t.DesignLocale,e.designExperiments=t.DesignExperiments,e.designId=t.DesignId,e.thumbnailUrl=t.SuggestionThumbnailUrl?t.SuggestionThumbnailUrl:t.ThumbnailUrl,e.thirdPartyData=t.ThirdPartyData,e.recipeType=null===(s=t.DesignExtendedInfo)||void 0===s?void 0:s.Recipetype,e.designDescription=null!==(l=t.DesignDescription)&&void 0!==l?l:"",e.designExtendedInfo=null!==(c=t.DesignExtendedInfo)&&void 0!==c?c:{})};class Ai extends Ti{static parseDesignJSONPart(e,t){var n;const i=(new TextDecoder).decode(e),o=JSON.parse(i);t.designData=null!==(n=t.designData)&&void 0!==n?n:[],t.designData.push(o)}}var Ii,Ri,Di=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n};class Pi extends Ti{static parseDesignJSONPart(e,t){var n;const i=(new TextDecoder).decode(e),o=JSON.parse(i);t.designInfo=null!==(n=t.designInfo)&&void 0!==n?n:[];const{RelationshipsData:a}=o,r={designData:Di(o,["RelationshipsData"]),designRels:a};t.designInfo.push(r)}}!function(e){e.ClientCanceled="Client canceled request",e.ContentTypeMissing="Content type header missing",e.EmptyBody="Empty Body",e.None="None",e.NoResults="No Results",e.NoResponse="No Response"}(Ii||(Ii={})),function(e){e.ClientCanceled="Client canceled request",e.EmptyBody="Empty Body",e.None="None",e.NoResults="No Results",e.NoResponse="No Response"}(Ri||(Ri={}));const{parseSuggestionsResponse:bi}=ui;var wi,Ui,Mi,Oi,Fi;!function(e){e.DownloadDesign="downloadDesign",e.GenerateImage="generateImage",e.UpdateDesignDescription="updateDesignDescription",e.UploadImage="uploadImage",e.LoadThumbnails="loadThumbnails"}(wi||(wi={})),function(e){e[e.Like=0]="Like",e[e.Dislike=1]="Dislike"}(Ui||(Ui={})),function(e){e.Pane="pane",e.Chat="chat"}(Mi||(Mi={})),function(e){e.Auto="auto",e.Dark="dark",e.Light="light",e.HighContrast="highContrast"}(Oi||(Oi={})),function(e){e[e.Done=0]="Done",e[e.Insert=1]="Insert"}(Fi||(Fi={}));var ki=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};const Bi=new Map([["image/jpeg","jpg"],["image/png","png"],["image/x-png","png"],["image/webp","webp"],["image/heic","heic"]]);class _i{constructor(e,t,n){this.targetOrigin=e,this.hostWindow=t,this.iframeid=n,this.boundOnMessage=this.onMessage.bind(this),this.callbacks=new Map,this.hostWindow.addEventListener("message",this.boundOnMessage)}removeMessageHandler(){this.off(),this.hostWindow.removeEventListener("message",this.boundOnMessage)}on(e,t){if(this.callbacks.has(e))throw new Error(`"${e}" already registered`);this.callbacks.set(e,t)}off(e){if(e){if(!this.callbacks.has(e))throw new Error(`"${e}" not registered`);this.callbacks.delete(e)}else this.callbacks.clear()}setTarget(e){this.target=e}send(e,t){if(!this.target)throw new Error("Must call initialize first");this.target.postMessage({type:e,data:t},this.targetOrigin)}destroy(){this.removeMessageHandler(),this.target=void 0,this.hostWindow=void 0}onMessage(e){var t;const{origin:n,data:i}=e,o=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.iframeid;if(new URL(n).origin!==new URL(this.targetOrigin).origin||o&&o!=this.iframeid)return;const{type:a,data:r}=i,s=this.callbacks.get(a);s&&s(r)}}const Li=["https://designerappservice.officeapps.live.com/designerappservice.all"],Ni=["https://designerappserviceppe.officeapps.live.com/designerappservice.all"];class xi extends Error{constructor(e,t){super(e),this.canRetry=t}}var Gi=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class Hi{constructor(e,t){this.m_appMessageHandler=e,this.m_settings=t}initialize(){this.m_appMessageHandler.on("auth_fetch",this.onAuthMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_settings=void 0}onAuthMessage(){return Gi(this,void 0,void 0,(function*(){try{const e=yield this.getAuthToken();this.m_appMessageHandler.send("auth_token",e)}catch(e){this.m_appMessageHandler.send("auth_error",e)}}))}getAuthToken(){return Gi(this,void 0,void 0,(function*(){if(this.m_settings.hostTokenProvider){const e=!1?Ni:Li;return yield this.m_settings.hostTokenProvider.getToken(e)}throw new xi("No host auth callback provided")}))}}var ji=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class zi{constructor(e,t){this.m_appMessageHandler=e,this.m_hostSessionStorage=t}initialize(){this.m_appMessageHandler.on("dcHint",this.onDcHintMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_hostSessionStorage=void 0}onDcHintMessage(e){return ji(this,void 0,void 0,(function*(){(null==e?void 0:e.dcHint)&&"string"==typeof(null==e?void 0:e.dcHint)&&this.m_hostSessionStorage.setDcHint(null==e?void 0:e.dcHint)}))}}class qi{constructor(e){var t,n,i;this.fileCacheInfoChangeHandler=null===(t=e.fileCacheInfoConfig)||void 0===t?void 0:t.hostCallback;const o=null===(n=e.fileCacheInfoConfig)||void 0===n?void 0:n.fileCacheInfo;if(o)this.containerId=o.containerId,this.fileToken=o.fileToken,this.dcHint=o.dcHint;else{const t=null===(i=e.hostTokenProvider)||void 0===i?void 0:i.identityType,n=e.telemetryConfig.clientName.toLowerCase().trim().replaceAll(" ","-");this.containerId=""+("AAD"===t?`aad-${n}-${(0,mi.A)()}`:`${n}-${(0,mi.A)()}`),this.fileToken=(0,mi.A)(),this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo())}}getContainerId(){return this.containerId}getFileToken(){return this.fileToken}getDcHint(){return this.dcHint}setDcHint(e){e!==this.dcHint&&(this.dcHint=e,this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo()))}getFileCacheInfo(){return{containerId:this.containerId,fileToken:this.fileToken,dcHint:this.dcHint}}}var Wi=function(e,t,n,i){return new(n||(n=Promise))((function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((i=i.apply(e,t||[])).next())}))};class Vi{constructor(e){var t,n;this.m_settings=e,this.axiosInstance=bt.create(),this.iframeid=(0,mi.A)(),this.m_hostWindow=null!==(n=null===(t=e.container.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==n?n:window,this.m_appMessageHandler=new _i(this.m_settings.miniURL.origin,this.m_hostWindow,this.iframeid),this.m_authMessageHandler=new Hi(this.m_appMessageHandler,this.m_settings),this.m_iframe=this.createAppFrame(),this.m_hostSessionStorage=new qi(this.m_settings),this.m_dcHintMessageHandler=new zi(this.m_appMessageHandler,this.m_hostSessionStorage);this.axiosInstance.interceptors.response.use((e=>{const t=e.headers[Ot.DataCenterHint.toLowerCase()];return t&&this.m_hostSessionStorage.setDcHint(t),e}))}getSuggestions(e,t,n,i,o,a){var r,s,l;return Wi(this,void 0,void 0,(function*(){if(!this.m_suggestionClient){const e=null===(r=this.m_settings.hostTokenProvider)||void 0===r?void 0:r.identityType,t=null===(s=this.m_settings.hostTokenProvider)||void 0===s?void 0:s.accountInfo.userId,n=this.m_settings.telemetryConfig.clientId,i=t?"AAD"===e?t:function(e,t){if(36===(null==e?void 0:e.length))return e.substr(19,4)+e.substr(24);return 16===(null==e?void 0:e.length)&&!0===t?e:(kn.Hv.sendTraceTag(507873103,Bn.n.msoulscat_Wac_Telemetry,_n.k.Error,"Unexpected localAccountId length"),"")}(t):n;this.m_suggestionClient=new ui({AudienceGroup:this.m_settings.telemetryConfig.audienceGroup,Caller:"DesignerEcosystem",ClientId:this.m_settings.telemetryConfig.clientId,ClientName:this.m_settings.telemetryConfig.clientName,ServiceRing:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),SessionId:this.m_settings.telemetryConfig.sessionId,UserId:i},this.axiosInstance)}const c=this.m_hostSessionStorage.getFileCacheInfo(),d={ContainerId:c.containerId,FileToken:c.fileToken,DcHint:c.dcHint},u={Title:{Text:""},SubTitle:{Text:""},Expectations:{Dimension:t,TypeMetadata:[null!==(l=this.m_settings.preferredImageOutputFormat)&&void 0!==l?l:"jpg","oxsd"],MinCount:n,MaxCount:i||(p=this.m_settings.viewConfig.view,p===Mi.Chat?4:14)},Hints:{DesignQuery:e,Trigger:"DesignFromScratch",DisableMotionSuggestions:"true",image2HeadingsForDFS:"true"},Scenario:a};var p;if(null==o?void 0:o.length){if("string"==typeof o[0]){const e=yield Promise.all(o.map((e=>{return t=e,ki(void 0,void 0,void 0,(function*(){try{const e=yield fetch(t),i=yield e.blob(),o=Bi.get(i.type)||"jpg";let a=n;if(!a){const e=new URL(t).pathname.split("/").pop();a=(null==e?void 0:e.slice(0,e.lastIndexOf(".")))||(0,mi.A)()}return new File([i],a+"."+o,{type:i.type})}catch(e){throw new Error(`Failed to fetch image: ${e.message}`)}}));var t,n})));return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},u),{ImageFiles:e}),d)}return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},u),{ImageBuffers:o}),d)}return yield this.m_suggestionClient.getSuggestions(u,d)}))}initialize(e){return Wi(this,void 0,void 0,(function*(){const t=Date.now();this.m_authMessageHandler.initialize(),this.m_dcHintMessageHandler.initialize();const n=new Promise(((n,i)=>{this.m_appMessageHandler.on("ready",(()=>{try{this.m_appMessageHandler.send("initialize",{designerEnvironment:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),telemetryConfig:this.m_settings.telemetryConfig,packageVersion:"0.23.9",appStartTimestamp:t,config:{insertMode:this.m_settings.insertMode,useDoneCta:this.m_settings.ctaButtonLabel===Fi.Done,hideSizeSelector:this.m_settings.hideSizeSelector,preferredImageOutputFormat:this.m_settings.preferredImageOutputFormat,disableOptionalConnectedExperiences:this.m_settings.disableOptionalConnectedExperiences,hostCanProvideAuthToken:!!this.m_settings.hostTokenProvider,hostAuthConfig:this.m_settings.hostTokenProvider?{hostAccountInfo:this.m_settings.hostTokenProvider.accountInfo,hostIdentityType:this.m_settings.hostTokenProvider.identityType,hostCanProvideAuthToken:!0,isEUDBUser:this.m_settings.hostTokenProvider.isEUDBUser}:void 0,useEnterpriseTOULink:this.m_settings.useEnterpriseTOULink,isSovereignUser:this.m_settings.isSovereignUser},suggestionsConfig:e,viewConfig:this.m_settings.viewConfig,fileCacheInfo:this.m_hostSessionStorage.getFileCacheInfo()}),this.m_appMessageHandler.off("ready"),n()}catch(e){i(e)}})),this.m_iframe.onerror=e=>{i(new Error(`Error loading iframe: ${e}`))}}));this.m_settings.container.appendChild(this.m_iframe),this.m_iframe.contentWindow&&this.m_appMessageHandler.setTarget(this.m_iframe.contentWindow),yield n}))}update(e){this.m_appMessageHandler.send("update",e)}updateAfterSignIn(){this.m_appMessageHandler.send("update_after_sign_in")}destroy(){this.m_appMessageHandler.destroy(),this.m_authMessageHandler.destroy(),this.m_dcHintMessageHandler.destroy(),this.m_iframe.remove(),this.m_hostWindow=void 0,this.m_settings=void 0}on(e,t){this.m_appMessageHandler.on(e,t)}off(e){this.m_appMessageHandler.off(e)}toggleInsertMode(e){this.m_appMessageHandler.send("insert_mode",e)}switchDesignerMiniAppTheme(e){this.m_appMessageHandler.send("switch_theme",e)}enableRedirectAuth(e){this.m_appMessageHandler.send("enable_redirect_auth",e)}createAppFrame(){var e,t,n;const i=new URL(this.m_settings.miniURL.toString());i.searchParams.append("view",null===(e=this.m_settings.viewConfig)||void 0===e?void 0:e.view),i.searchParams.append("theme",null!==(n=null===(t=this.m_settings.viewConfig)||void 0===t?void 0:t.theme)&&void 0!==n?n:"auto"),i.searchParams.append("sessionId",this.m_settings.telemetryConfig.sessionId),i.searchParams.append("clientId",this.m_settings.telemetryConfig.clientId),i.searchParams.append("clientName",this.m_settings.telemetryConfig.clientName),i.searchParams.append("iframeid",this.iframeid),this.m_settings.lng&&i.searchParams.append("lng",this.m_settings.lng),this.m_settings.loginHint&&i.searchParams.append("loginHint",this.m_settings.loginHint);const o=this.m_hostWindow.document.createElement("iframe");return o.allow="clipboard-write",o.width="100%",o.height="100%",o.style.border="none",o.src=i.toString(),this.m_settings.enableSandboxing&&o.sandbox.add("allow-scripts","allow-same-origin","allow-downloads","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation"),this.m_settings.disableEmbeddedCSPEnforcement||o.setAttribute("csp","object-src 'none'; base-uri 'none'; require-trusted-types-for 'script'; trusted-types default; "),o}getDesignerEnvironment(e){return Gt.getDasRing(e)}}const{parseSuggestionsResponse:$i}=ui;var Ki=n(8520),Qi=n(78185);function Ji(e,t){var n=Array.from(e),i=new Blob([new Uint8Array(n)],{type:t||"image/png"}),o=new FileReader;return o.readAsDataURL(i),new Promise((function(e,t){o.onload=function(){var t=o.result;e(t)},o.onerror=function(){t(o.error)}}))}var Yi=n(30160),Xi=n(58651),Zi=(0,n(55695).l8)({lightThemeWithChatCard:{backgroundColor:"#FFFFFF"},darkThemeWithChatCard:{backgroundColor:"#292929"}}),eo=n(58651),to=function(e){var t,n,i=Ki.useMemo((function(){return(0,mi.A)()}),[]),a=Ki.useRef(),r=Ki.useRef(!1),s=(0,Qi.N_)(),l=(0,Qi.Hz)(),c=(0,Qi.yV)(),d=(0,Qi.C1)();eo.log("Designer Log: historyEventData sent to Designer",e.historyEventData);var u=function(e){var t,n=e.clientSettings,i=e.hostTokenProvider,a=e.isAuthEnabled,r=e.isRehydration,s=e.turnId,l=e.hostCallback,c=e.fileCacheInfo,d=e.isPlugAndPlay,u=e.historyEventData,p=(0,Yi.eR)(null===(t=e.clientSettings)||void 0===t?void 0:t.selectedDesignerEnv,a),g=(0,Yi.iK)(null==n?void 0:n.selectedDesignerEnv,null==i?void 0:i.isEUDBUser),h=(null==n?void 0:n.clientId)||(0,mi.A)(),m=(null==n?void 0:n.sessionId)||(0,mi.A)(),f=(null==n?void 0:n.correlationId)||(0,mi.A)(),C=null==n?void 0:n.hostAppName,S=(null==n?void 0:n.scenarioName)||"Other",v=null==n?void 0:n.platformType,y=null==n?void 0:n.hostBuildVersion,E="".concat(C,"-").concat(v),T=null==n?void 0:n.audienceGroup;Xi.log("Designer Log: is Plug and Play enabled: ",d);var A=e.parentContainerIdentifier,I=Ki.useMemo((function(){var t,o,a,r,s,u,S;return{miniURL:p,serviceBaseURL:g,viewConfig:{view:Mi.Chat,theme:null!==(t=null==n?void 0:n.designerTheme)&&void 0!==t?t:Oi.Light,showFeedbackSection:null!==(o=null==n?void 0:n.showFeedBackSection)&&void 0!==o&&o,tempPlugNPlay:d},fileCacheInfoConfig:{hostCallback:null!=l?l:function(e){Xi.log("FileCacheInfo updated: ".concat(JSON.stringify(e)))},fileCacheInfo:c},telemetryConfig:{audienceGroup:null!=T?T:Qi.EW.Other,clientId:h,clientName:null!=C?C:"unknown",hostBuildVersion:null!=y?y:"unknown",hostEnvironment:E,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:m,correlationId:f,platform:(S=null!==(a=null==n?void 0:n.platformType)&&void 0!==a?a:Qi.lt.Web,S===Qi.lt.iOS?{platform:"iOS"}:S===Qi.lt.Web?{platform:"Web"}:S===Qi.lt.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform},container:document.getElementById(A),insertMode:!0,enableSandboxing:!0,ctaButtonLabel:null!==(r=e.preferredCtaButtonLabel)&&void 0!==r?r:Fi.Insert,hideSizeSelector:!0,preferredImageOutputFormat:null!==(s=e.preferredImageFormat)&&void 0!==s?s:"png",hostTokenProvider:i,lng:null!==(u=null==n?void 0:n.uiLanguage)&&void 0!==u?u:"en-US"}}),[p,g,null==n?void 0:n.designerTheme,null==n?void 0:n.platformType,null==n?void 0:n.uiLanguage,l,c,h,C,y,E,m,f,A,e.preferredCtaButtonLabel,e.preferredImageFormat,i]),R=Ki.useCallback((function(e,t,n,i,a,l,c,d,p,g){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){var h;return(0,o.__generator)(this,(function(m){switch(m.label){case 0:return[4,(h=new Vi((0,o.__assign)((0,o.__assign)({},I),{container:document.getElementById(e)}))).initialize((0,o.__assign)((0,o.__assign)({turnId:s,isRehydration:r,scenario:S,minCount:3,maxCount:4},null!=t?t:{}),{historyEventData:u}))];case 1:return m.sent(),n&&h.on("done",n),i&&h.on("customize",i),l&&h.on("feedback",l),a&&h.on("AnswerCardResize",a),c&&h.on("persist_results",c),d&&h.on("error",d),p&&h.on("telemetry",p),g&&h.on("keyboardEvent",g),[2,h]}}))}))}),[I,u,r,S,s]);return{designerMiniSettings:I,initializeDesignerMini:R}}({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:i,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo,isPlugAndPlay:e.isPlugAndPlay,historyEventData:e.historyEventData}),p=u.initializeDesignerMini,g=u.designerMiniSettings;eo.log("Designer Log: Designer Mini initialized with settings: ",g);var h=Ki.useCallback((function(t){return(0,o.__awaiter)(void 0,void 0,void 0,(function(){var n,i,a,r,s;return(0,o.__generator)(this,(function(l){switch(l.label){case 0:return(null===(i=t.options)||void 0===i?void 0:i.isUrl)&&t.uri?(null===(a=e.insertImagesInCanvas)||void 0===a||a.call(e,t.uri,(0,o.__assign)((0,o.__assign)({},t.options),{altText:t.altText,sourceUrl:t.uri}),t.correlationId,t.imageType),[3,3]):[3,1];case 1:return[4,Ji(t.media,t.mimeType)];case 2:n=l.sent(),null===(r=e.insertImagesInCanvas)||void 0===r||r.call(e,n,(0,o.__assign)((0,o.__assign)({},t.options),{altText:t.altText,sourceUrl:(null===(s=t.options)||void 0===s?void 0:s.isUrl)?t.uri:void 0}),t.correlationId,t.imageType),l.label=3;case 3:return[2]}}))}))}),[e]),m=Ki.useCallback((function(e){var t=document.getElementById(i);t&&(t.style.height="".concat(e.height,"px"))}),[i]),f=Ki.useCallback((function(t){var n;null===(n=null==e?void 0:e.onDesignerCustomize)||void 0===n||n.call(e,t,g)}),[g,e]),C=Ki.useCallback((function(t){!function(e,t,n,i){e===Ui.Like?i?null==t||t(i):null==t||t():e===Ui.Dislike&&(i?null==n||n(i):null==n||n())}(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),S=Ki.useCallback((function(t){var n;eo.log("Designer Log: data received after image generaton",t),null===(n=null==e?void 0:e.persistentChatHistoryCallback)||void 0===n||n.call(e,t)}),[e]),v=Ki.useCallback((function(t){var n;null===(n=null==e?void 0:e.handleDesignerError)||void 0===n||n.call(e,t)}),[e]),y=Ki.useCallback((function(t){var n;null===(n=null==e?void 0:e.handleDesignerTelemetry)||void 0===n||n.call(e,t)}),[e]),E=Ki.useCallback((function(e){var t;if("Escape"===e.key){var n=null===(t=document.getElementById(i))||void 0===t?void 0:t.closest("."+Qi.lc.CopilotMessage),o=document.getElementsByClassName(Qi.lc.UserMessage)[0];null==o||o.focus({preventScroll:!0}),null==n||n.focus()}}),[e]),T=Ki.useMemo((function(){var t,n,i,a={imageType:e.imageType};if(e.isStockQuery){var r=void 0;return r=e.imageType&&"enterprise"===e.imageType.toLowerCase()?e.companyName&&e.companyName.length>0?(n=c,i=e.companyName,n.includes("%s")?n.replace("%s",i):n):"From your organization's asset library":d,(0,o.__assign)((0,o.__assign)({},a),{stockContent:e.stockImages,sourceDescription:r,artifactType:Qi.FR.DesignSuggestions})}return"banner"===(null===(t=e.imageType)||void 0===t?void 0:t.toLowerCase())?(0,o.__assign)((0,o.__assign)({},a),{dimensions:e.dimensions,text:e.userInput.trim(),artifactType:Qi.FR.DesignSuggestions}):(0,o.__assign)((0,o.__assign)({},a),{text:e.userInput.trim(),sourceDescription:l,artifactType:Qi.FR.DallEImages})}),[e.companyName,e.dimensions,e.imageType,e.isStockQuery,e.stockImages,e.userInput]);return Ki.useEffect((function(){r.current||p(i,T,h,f,m,C,S,v,y,E).then((function(e){a.current=e,r.current=!0})).catch((function(e){eo.error(e)}))}),[T,p,m,f,h,C,i,S,v,y,E]),Ki.useEffect((function(){var t;(null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme)&&a.current&&a.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[null===(t=e.clientSettings)||void 0===t?void 0:t.designerTheme]),Ki.createElement(Ki.Fragment,null,Ki.createElement("div",{id:i,key:i,className:"".concat((null===(n=e.clientSettings)||void 0===n?void 0:n.designerTheme)===Oi.Dark?Zi.darkThemeWithChatCard:Zi.lightThemeWithChatCard),tabIndex:-1,"aria-label":s}))}}}]);
//# sourceMappingURL=vendors~lazyloadeddesigner.js.map