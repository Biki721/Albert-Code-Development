var TypeScriptModule;(()=>{"use strict";var e,t,n,o,i,r={57314:(e,t,n)=>{n.r(t);var o,i,r=n(21116),a=n(23182),s=n(8520),c=n(94329);!function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(o||(o={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(i||(i={}));var l,u,d,f,p,h,g,v,y,b,m,E,L,I,S=void 0,C=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]};!function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(d||(d={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.MsgExtTaskModule="MsgExtTaskModule"}(f||(f={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(p||(p={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened"}(h||(h={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode"}(g||(g={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat"}(v||(v={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(y||(y={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile"}(b||(b={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(m||(m={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(E||(E={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(L||(L={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(I||(I={}));var T=n(84443),P=(function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}e.getInstance=function(){return Y(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=(0,T.WU)(this.personalizationHITLCardActivationTime)}}(),"AugLoopChat".concat(S)),w=function(){function e(){}return e.generateId=function(){return e.operationId++,P+e.operationId.toString()},e.operationId=0,e}(),_=function(e,t){var n;l.sendErrorTelemetry(k(((n={})[g.ErrorMessage]="".concat(e),n[g.ErrorCategory]=f.CLP,n[g.ErrorCode]=t,n)))},A=function(e){var t;l.sendChatEventTelemetry(k(((t={})[p.ChatEventType]=h.OfficeJsApiCallForCLP,t[p.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},k=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};var U=function(e){return e||(e=v.CopilotChat),JSON.stringify({featureName:e})};function D(e){l.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function O(e,t){return e+" "+t}var N,M,x,H,R,q,F,j,B,z,G=n(58651),J=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},W=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e){this.params=e}e.prototype.loadMsalBrowser=function(){return J(this,void 0,void 0,(function(){var e,t,o;return W(this,(function(i){switch(i.label){case 0:e=1,i.label=1;case 1:if(!(e<=3))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,89761))];case 3:return t.msalModule=i.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(o=i.sent(),G.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),o),3===e)throw o;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createPublicClientApplication=function(e){var t,n;return J(this,void 0,void 0,(function(){var o,i;return W(this,(function(r){return o=null!==(n=null===(t=this.params)||void 0===t?void 0:t.clientId)&&void 0!==n?n:"6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",i=this.params.redirectUri,[2,new e({auth:{clientId:o,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47",redirectUri:new URL(i,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})]}))}))},e.prototype.getToken=function(e,t){var n;return J(this,void 0,void 0,(function(){var t,o,i,r,a;return W(this,(function(s){switch(s.label){case 0:return C("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:s.sent(),s.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=s.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&l.sendChatEventTelemetry(k(((a={})[p.ChatEventType]=h.MSALTokenRequested,a))),o=void 0,s.label=4;case 4:return s.trys.push([4,9,,10]),[4,t.initialize()];case 5:return s.sent(),0!==(null==(i=t.getAllAccounts())?void 0:i.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,s.sent()];case 7:return[4,this.getSelectedAccount(i,t)];case 8:if(!(o=s.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[2,this.acquireTokenSilent(e,o,t)];case 9:if(r=s.sent(),C("Failed to get access token: ".concat(null==r?void 0:r.message)),this.msalModule&&r instanceof this.msalModule.InteractionRequiredAuthError)return[2,this.acquireTokenPopup(e,o,t)];throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),r;case 10:return[2]}}))}))},e.prototype.getSelectedAccount=function(e,t){var n;return J(this,void 0,void 0,(function(){var o,i,r,a=this;return W(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(r=s.sent())?void 0:r.account];case 2:if(!e||0===e.length)return[2,null];if(o=this.params?null!==(n=e.find((function(e){var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==n?n:null:e[0],o)return[2,o];i=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(i),[4,this.loginPopupPromise];case 4:return[2,null==(r=s.sent())?void 0:r.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){var n;return J(this,void 0,void 0,(function(){var o,i;return W(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],loginHint:null===(n=this.params)||void 0===n?void 0:n.userPrincipalName},[4,t.ssoSilent(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,i]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n){return J(this,void 0,void 0,(function(){var o,i;return W(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,i]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return J(this,void 0,void 0,(function(){var o,i;return W(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,i]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&l.sendErrorTelemetry(k(((t={})[g.ErrorCategory]=f.MSAL,t[g.ErrorMessage]=e,t)))}}();!function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(N||(N={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(M||(M={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(x||(x={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(H||(H={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(R||(R={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(q||(q={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(F||(F={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(j||(j={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(B||(B={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(z||(z={}));function Y(e){return null==e}var Q=function(){return"undefined"!=typeof OfficeaicopilotStrings};var V,K,$=(V=function(e,t){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},V(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}V(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $(t,e),t}(function(e){function t(t,n){var o=e.call(this,n)||this;return o.name=t,o}return $(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(K||(K={}));var X=["ar-SA","he-IL"],ee=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","ru-RU","sv-SE","th-TH","tr-TR","uk-UA"],te=["bg-BG","el-GR","et-EE","hr-HR","lt-LT","lv-LV","id-ID","ro-RO","sk-SK","sl-SI","sr-latn-RS","vi-VN","de-CH","nl-BE"],ne=["ca-ES","cy-GB"];(function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.supportedLanguages=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","pt-PT","zh-CN","zh-TW"]}Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var o=this.supportedLanguages[n];if(t[0]===o.split("-")[0])return o}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new Z(K.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(ee),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(X))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(te)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(ne))}})(),n(58651);new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0});var oe="",ie="shimmer",re=function(){return Q()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},ae=function(){return Q()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that canâ€™t be applied when a file is read-only."},se=function(){return Q()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},ce=function(){return Q()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},le=function(){return Q()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},ue=function(){return Q()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},de=function(){return Q()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},fe=function(){return Q()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},pe=function(){return Q()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},he=function(){return Q()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},ge=function(){return Q()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},ve=function(){return Q()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},ye=function(){return Q()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},be=function(){return Q()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},me=function(){return Q()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},Ee=function(){return Q()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},Le=function(){return Q()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},Ie=function(){return Q()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},Se=n(74576),Ce=n(98483),Te=n(52421),Pe=n(36072),we=n(89169),_e=function(e){C("setting ClpOfficeJSApiError to ".concat(e)),e},Ae=!1;function ke(e,t,n,o,i){void 0===i&&(i=!0);var r={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:Te.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:o?U(o):void 0},a=!0,s=He.getInstance();(null==s?void 0:s.getShouldStopLoadingUi)&&(a=s.getShouldStopLoadingUi());var c={chatCardType:Pe._.Default,chatMessageData:{defaultMessageProps:{user:we.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:r,stopLoadingUi:a,startAugloopTimerForStreaming:!1,addCardToChatHistory:i};return function(e,t,n){var o,i;void 0===n&&(n=!0);var r={};if(t){l.sendChatEventTelemetry(k(((o={})[p.ChatEventType]=t.chatEventType,o[p.ChatEventParameters]=t.chatEventParam,o[p.ChatErrorType]=t.chatErrorType,o))),(i={})[d.ErrorType]=y.Client,i[d.ErrorParameter]=t.chatEventType,i[d.ErrorChatEventType]=t.chatEventType,i[d.ErrorChatEventParameter]=t.chatEventParam,r=i;var a=t.ashaErrorDetails;a&&D(a)}e&&(C("User Perceived Latency :  ".concat((0,T.WU)(T.qD)," sec")),r[d.UserPerceivedLatency]=(0,T.WU)(T.qD),r[d.IsQuerySuccess]=!1,l.sendLatencyTelemetry(k(r),n))}(t,n,!0),C("CLP error response message: ".concat(c)),c}function Ue(e,t,n,o){var i,r,a;if(null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getIsExecuting()){var s=function(e,t){switch(e){case B.ApplyLabelUnsupportedCrossTenantErrorCode:return t===j.CLP_Get?oe:re();case B.ApplyLabelDocumentReadOnlyErrorCode:return t===j.CLP_Get?oe:ae();case B.ApplyLabelInsufficientPermissionErrorCode:return t===j.CLP_Get?oe:se();case B.ApplyLabelLabelDisabledErrorCode:return t===j.CLP_Get?oe:ce();case B.ApplyLabelUnsupportedUdpErrorCode:return t===j.CLP_Get?oe:le();case B.ApplyLabelLabelingDisabledErrorCode:return t===j.CLP_Get?oe:ue();case B.ApplyLabelUnsupportedContentTypeErrorCode:return t===j.CLP_Get?oe:de();case B.ApplyLabelUnsupportedDkeErrorCode:return t===j.CLP_Get?oe:fe();case B.ApplyLabelLabelNotFoundErrorCode:case B.ErrorCode2147647531:return t===j.CLP_Get?oe:pe();case B.OsfControlContainerErrorCode:case B.OfficeSolutionFrameworkHostErrorCode:case B.DocCookieErrorCode:case B.HostIntegrationManagerErrorCode:case B.MsoOLDocumentErrorCode:case B.ClpSessionErrorCode:return he();case B.OMWorkflowUserNotFoundErrorCode:return ge();case B.OMOfficePerpetualNotSupportedErrorCode:return ve();case B.LabelingDisabledProtectedViewErrorCode:return ye();case B.LabelingDisabledAppguardErrorCode:return be();case B.LabelingDisabledPrivacySettingsErrorCode:return t===j.CLP_Get?oe:me();case B.LabelingDisabledUnsupportedLabelClientErrorCode:return t===j.CLP_Get?oe:Ee();case B.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===j.CLP_Get?oe:Le();case B.OMOfficeClientNotLicensedForLabelingErrorCode:return t===j.CLP_Get?oe:Ie();case B.PolicyManagerUnavailableErrorCode:return t===j.CLP_Get?oe:he();case B.ApplyLabelNewLabelSensitivityOrderErrorCode:return oe;case B.ErrorCode2147500033:default:return t===j.CLP_Get?oe:he()}}(t,n);if(s){Ae&&_e(!0),C("clp error: ".concat(s)),function(e,t){var n,o={chatEventType:h.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:y.Client,ashaErrorDetails:{vetoName:O(L.UnclearIntent,m.UserInputIssue),errorString:I.SensitivityExecutionFailed,featureName:v.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(ke(t,!0,o))}(e,s);var c=!0,u=He.getInstance();(null==u?void 0:u.getShouldStopLoadingUi)&&(c=u.getShouldStopLoadingUi()),o&&c&&o(),l.sendChatEventTelemetry(k(((i={})[p.ChatEventType]=h.CLPErrorShown,i[p.ChatEventParameters]=n+"_"+t,i)))}else C("clp error string is empty"),l.sendChatEventTelemetry(k(((r={})[p.ChatEventType]=h.CLPErrorIgnored,r[p.ChatEventParameters]=n+"_"+t,r)));return s}return oe}var De=function(){return De=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},De.apply(this,arguments)},Oe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Ne=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Me=null,xe=(0,Ce.A)(),He=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:oe,tenantId:oe},this.externalDocLabelInfo={labelId:oe,tenantId:oe},this.inDocLabelInfo.labelId=oe,this.inDocLabelInfo.tenantId=oe,this.externalDocLabelInfo.labelId=oe,this.externalDocLabelInfo.tenantId=oe}return e.getInstance=function(t,n,o,i){return Y(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),Y(t)||(e.clpSensitivityHandler.setBasicChatProps=t),Y(n)||(e.clpSensitivityHandler.copilotChatRef=n),Y(o)||(e.clpSensitivityHandler.removeCurrentContextId=o),Y(i)||(e.clpSensitivityHandler.getShouldStopLoadingUi=i),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return Oe(this,void 0,void 0,(function(){var e,t;return Ne(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 1:return e=n.sent(),this.setInDocSensitivityLabelInfo(e),A("setInDocSensitiveLabelInfoUsingOfcJs"),[3,3];case 2:return t=n.sent(),_("error in getLabel Api: ".concat(t.message),t.code),Ue(this.copilotChatRef,t.code,j.CLP_Get,this.removeCurrentContextId),C("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,3];case 3:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return Oe(this,void 0,void 0,(function(){var e,t;return Ne(this,(function(n){switch(n.label){case 0:C("Getting label"),e={labelId:oe,tenantId:oe},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=n.sent(),A("getLabel"),[3,4];case 3:return t=n.sent(),_("error in getLabel Api : ".concat(t.message),t.code),Ue(this.copilotChatRef,t.code,j.CLP_Get,this.removeCurrentContextId),C("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return C("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;C("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var i,r;return De(De({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(i=e.description)&&void 0!==i?i:"",badgeText:null!==(r=e.displayName)&&void 0!==r?r:"",iconType:e.encryptionType!==o.None?Se.JF.Encryption:Se.JF.NonEncryption}:void 0})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return Oe(this,void 0,void 0,(function(){var t;return Ne(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:oe}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):(C("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?(C("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){var t;return Oe(this,void 0,void 0,(function(){var n,o,r,a,s,c,l=this;return Ne(this,(function(u){switch(u.label){case 0:A("tryUpgradeLabel"),C("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=i[i.S_APPLYLABEL_OK],o=oe,u.label=1;case 1:return u.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,xe)];case 2:return u.sent(),[2,{status:i[i.S_APPLYLABEL_OK]}];case 3:return r=function(){return Oe(l,void 0,void 0,(function(){return Ne(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,xe)]}catch(e){_("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code),o=Ue(this.copilotChatRef,e.code,j.CLP_Upgrade,this.removeCurrentContextId),C("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},a=new Promise((function(e){Me=e})),s=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([a,r()]),s])];case 4:u.sent(),u.label=5;case 5:return[3,7];case 6:return c=u.sent(),_("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(c.message),c.code),Ue(this.copilotChatRef,c.code,j.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===c.message?C("Callback Timeout"):C("Exception while upgrading sensitivity label: ".concat(c.message,", error code: ").concat(c.code)),n=null!==(t=i[c.message])&&void 0!==t?t:c.message,[3,7];case 7:return Me=null,[2,{status:n,errorMessage:o}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:Re),A("Label Change Event Listener"),C("Sensitivity Label Change Event Listener Set")}catch(e){_("error in setting listener for CLP : ".concat(e.message),e.code),Ue(this.copilotChatRef,e.code,j.CLP_Upgrade,this.removeCurrentContextId),C("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return Oe(this,void 0,void 0,(function(){var t,n;return Ne(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 1:return t=o.sent(),C("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),A("External Doc HighestSensitivityLabel"),[3,3];case 2:return n=o.sent(),_("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),Ue(this.copilotChatRef,n.code,j.CLP_Get,this.removeCurrentContextId),C("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,3];case 3:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return Oe(this,void 0,void 0,(function(){return Ne(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return Oe(this,void 0,void 0,(function(){var t,n;return Ne(this,(function(o){switch(o.label){case 0:t={labelId:oe,tenantId:oe},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=o.sent(),C("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),A("HighestSensitivityLabel"),[3,4];case 3:return n=o.sent(),_("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),Ue(this.copilotChatRef,n.code,j.CLP_Get,this.removeCurrentContextId),C("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return Oe(this,void 0,void 0,(function(){var t;return Ne(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){C("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return A("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===oe)),this.externalDocLabelInfo.labelId!==oe&&u.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return A("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===oe)),this.inDocLabelInfo.labelId!==oe&&u.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.None},e}();function Re(e,t,n,o){return Oe(this,void 0,void 0,(function(){return Ne(this,(function(r){switch(r.label){case 0:return C("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(o)),A("Label change callback received, context:  ".concat(n)),Me&&n===xe&&(Me("ignore"),Me=null),o!==i.S_APPLYLABEL_OK?(_("error in upgrading label : ".concat(o),o.code),[2]):u.IsClpEnabledInEnterpriseForSydney()&&(He.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,He.getInstance().setSensitivityLabelToHighestSensitivity([He.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return r.sent(),[2];case 2:return u.IsApplyLabelUsingTryUpgradeLabelEnabled(),He.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}var qe;!function(e){e.AugloopSharedSessionID="AugloopSharedSessionID",e.HandoffMessageId="HandoffMessageId"}(qe||(qe={}));var Fe=function(){function e(){}return e.getSettingAsString=function(e){var t=Office.context.document.settings.get(e.toString());return Y(t)?t:t.toString()},e}();var je=n(3421),Be=n(60160),ze=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Ge=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Je=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return Ge(n,void 0,void 0,(function(){var e,t,n,o,i,r,a,s;return Je(this,(function(c){switch(c.label){case 0:e=null!==(r=null===(i=this.state.error)||void 0===i?void 0:i.message)&&void 0!==r?r:"No error message",t=null!==(s=null===(a=this.state.error)||void 0===a?void 0:a.stack)&&void 0!==s?s:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return c.sent(),[3,4];case 3:return o=c.sent(),C("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",o),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}ze(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){var t;C("ErrorBoundary caught an error ",e),null===(t=window.document.getElementById(ie))||void 0===t||t.style.setProperty("display","none"),function(e){var t;l.sendChatEventTelemetry(k(((t={})[p.ChatEventType]=h.ErrorBoundaryCaughtError,t[p.ChatEventParameters]=e,t))),D({vetoName:O(L.UnclearIntent,m.UnclassifiedError),errorString:I.UnexpectedFailure,featureName:v.CopilotChat})}(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?s.createElement(Be.L,{theme:this.props.copilotChatTheme,shouldUseFluentV9Tokens:!0},s.createElement(je.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children}}(s.Component);var We=n(57177),Ye=n(30974),Qe=n(47316),Ve=n(48636),Ke=n(1857),$e=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},Ze=function(e){var t={appId:"",botId:"",cardId:""};try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){C("msgExtension Utils: Failed to extract cardId from cardData")}return t},Xe=function(){return Xe=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xe.apply(this,arguments)},et=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},tt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},nt=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},C("MsgExtDialogLauncher : Task Module dialog closed")},this.onMessageCallback=function(e){return et(t,void 0,void 0,(function(){var t,n,o,i,r,a,s,c,u,d;return tt(this,(function(v){switch(v.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(e)).type!==Ve.o.Ack?[3,1]:(n=Ze(this.taskModuleProps),i={dialogContent:this.taskModuleProps.dialogContent,appDefinition:this.taskModuleProps.appDefinition,clientInfo:this.taskModuleProps.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:n},this.openedDialog.dialog.messageChild(JSON.stringify(i),{targetOrigin:window.location.origin}),[3,6]):[2];case 1:return t.type!==Ve.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==Ve.o.onServiceRequest)return[3,6];null===(d=l.setQueryGuid)||void 0===d||d.call(l,t.requestId),C("MsgExtDialogLauncher : Received service request from dialog",t),o={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},l.sendChatEventTelemetry(k(((s={})[p.ChatEventType]=h.TaskModuleServiceRequest,s[p.ChatEventParameters]=JSON.stringify(o),s))),i={requestId:t.requestId,messageType:Ve.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},v.label=3;case 3:return v.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(r=v.sent())&&(i.result=r),C("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),l.sendChatEventTelemetry(k(((c={})[p.ChatEventType]=h.TaskModuleServiceResponse,c[p.ChatEventParameters]=JSON.stringify(o),c))),this.openedDialog.dialog.messageChild(JSON.stringify(i),{targetOrigin:window.location.origin}),[3,6];case 5:return a=v.sent(),C("MsgExtDialogLauncher : Error executing plugin operation",a),l.sendErrorTelemetry(k(((u={})[g.ErrorMessage]=JSON.stringify(Xe(Xe({},o),{error:a})),u[g.ErrorCategory]=f.MsgExtTaskModule,u[g.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),u))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return et(t,void 0,void 0,(function(){var t,o,i=this;return tt(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=Ze(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return o=$e(),[4,Office.context.ui.displayDialogAsync(o,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return et(i,void 0,void 0,(function(){var n=this;return tt(this,(function(o){return this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:this.taskModuleProps.triggeringActionTitle},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return et(n,void 0,void 0,(function(){return tt(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return et(n,void 0,void 0,(function(){return tt(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2]}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForWebPlatformAsIframe=function(e,n){return et(t,void 0,void 0,(function(){var t,o=this;return tt(this,(function(i){switch(i.label){case 0:return t=$e(),[4,Office.context.ui.displayDialogAsync(t,{displayInIframe:!0,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return et(o,void 0,void 0,(function(){var t=this;return tt(this,(function(n){return this.openedDialog.dialog=e.value,this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return et(t,void 0,void 0,(function(){return tt(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),[2]}))}))}))];case 1:return i.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return et(t,void 0,void 0,(function(){var t,o,i,r=this;return tt(this,(function(a){return this.shouldDisplayDismissIcon=!1,t=$e(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(i=null===(o=this.taskModuleProps)||void 0===o?void 0:o.dialogTitle)&&void 0!==i?i:"Copilot Extensions Dialog",hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){r.openedDialog.dialog=e})).catch((function(e){C("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e,n){return et(t,void 0,void 0,(function(){var t,o,i,r,a,s;return tt(this,(function(c){return this.taskModuleProps=n,t=null===(a=n.clientInfo)||void 0===a?void 0:a.clientType,o=e&&t===Ke.WK.web?function(e){var t,n;if(e.viewMode===Pe.S.TaskViewMode){var o=null===(t=e.dialogContent)||void 0===t?void 0:t.height,i=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!o||!i||"number"!=typeof i||"number"!=typeof o)return{dialogHeight:55,dialogWidth:50};var r=screen.width,a=screen.height;return{dialogHeight:Math.floor(o/a*100),dialogWidth:Math.floor(i/r*100)}}return{dialogHeight:80,dialogWidth:80}}(n):function(e){var t,n,o,i,r=e.viewMode,a=r===Pe.S.TaskViewMode?window.outerWidth:window.innerWidth,s=r===Pe.S.TaskViewMode?window.outerHeight:window.innerHeight,c=r===Pe.S.TaskViewMode?5:0,l=r===Pe.S.TaskViewMode?2:0,u=null===(t=e.dialogContent)||void 0===t?void 0:t.height,d=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof d&&"number"==typeof u&&d<=a&&u<=s){var f=Math.floor(u/s*100),p=Math.floor(d/a*100);o=f+c,i=p+l}else o=55,i=50}catch(e){o=55,i=50}return{dialogHeight:o,dialogWidth:i}}(n),i=o.dialogHeight,r=o.dialogWidth,(null===(s=n.clientInfo)||void 0===s?void 0:s.clientType)===Ke.WK.web?e?this.openDialogForWebPlatformAsNewWindow(i,r):this.openDialogForWebPlatformAsIframe(i,r):this.openDialogForNativePlatform(i,r),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e}(),ot=n(64147),it=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),rt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},at=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},st=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return rt(this,void 0,void 0,(function(){var t,n,o;return at(this,(function(i){switch(i.label){case 0:return t=(0,Ce.A)(),dt(t,ot.o.AuthService,ot.L.GetToken,{request:e}),n=new it,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e}(),ct=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},lt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ut=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return ct(this,void 0,void 0,(function(){var t,n,o;return lt(this,(function(i){switch(i.label){case 0:return t=(0,Ce.A)(),dt(t,ot.o.ChannelService,ot.L.BotInvoke,{request:e}),n=new it,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e}(),dt=function(e,t,n,o){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:Ve.o.onServiceRequest,serviceName:t,apiName:n,requestData:o}),{targetOrigin:window.location.origin})},ft=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},pt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ht=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return ft(this,void 0,void 0,(function(){var t,n,o;return pt(this,(function(i){switch(i.label){case 0:return t=(0,Ce.A)(),dt(t,ot.o.AppService,ot.L.GetApp,{request:e}),n=new it,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e.prototype.getApps=function(){return ft(this,void 0,void 0,(function(){var e,t,n;return pt(this,(function(o){switch(o.label){case 0:return e=(0,Ce.A)(),dt(e,ot.o.AppService,ot.L.GetApps),t=new it,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e}(),gt=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,Ce.A)();dt(t,ot.o.TelemetryService,ot.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,Ce.A)();dt(t,ot.o.TelemetryService,ot.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,Ce.A)();dt(t,ot.o.TelemetryService,ot.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,Ce.A)();dt(t,ot.o.TelemetryService,ot.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,Ce.A)();dt(t,ot.o.TelemetryService,ot.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,Ce.A)();dt(t,ot.o.TelemetryService,ot.L.LogMetric,{request:e})},e}();s.memo((function(e){var t=e.dialogContent,n=e.appDefinition,o=e.userContext,i=e.hostContext,r=e.clientInfo,a=e.handleCloseButtonClick,c=e.shouldShowDismissIcon,l=e.copilotChatThemeV2,u=e.shouldDisplayInNewWindow,d=e.cardInfo,f=s.useMemo((function(){return ht.getInstance()}),[]),p=s.useMemo((function(){return st.getInstance()}),[]),h=s.useMemo((function(){return ut.getInstance()}),[]),g=s.useMemo((function(){return gt.getInstance()}),[]),v=s.useMemo((function(){return new Ye.R}),[]);return s.createElement(We.q,{theme:l},s.createElement(Qe.K,{dialogContent:t,botService:h,appDefinition:n,tokenService:p,telemetryService:g,userContext:o,hostContext:i,appService:f,externalAuthService:v,clientInfo:r,isCardRenderingInTaskModuleEnabled:!0,handleCloseButtonClick:a,taskModuleLauncher:nt.getInstance().launchTaskModule.bind(null,u),shouldShowDismissIcon:c,cardInfo:d,isDialogAcRendererEnabledForTaskModule:!0}))}));var vt=n(13400),yt=n(55538),bt=function(e){};(0,vt.mL)(yt.N,{currentLocale:void 0,strings:{},errorHandler:bt,loaders:[],stringMapInitialized:!1});var mt;!function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(mt||(mt={}));var Et,Lt=n(92776),It=n(26586),St=n(76558),Ct=n(58651),Tt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Pt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},wt=(function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return Tt(t,void 0,void 0,(function(){var e;return Pt(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){Ct.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===x.win32?this.handleDefaultThemeChange():this.platform===x.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}}(),(0,s.createContext)({officePlatform:x.web,officeTheme:void 0}),n(40769));!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(Et||(Et={}));!function(){function e(e){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set;var t=this.getDocumentHandoffMessageId();t&&this.pendingHandoffMessageIds.add(t)}e.prototype.getDocumentHandoffMessageId=function(){var e=Fe.getSettingAsString(qe.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,Ce.A)(),o=this.getHandoffMessageIdSignal(n,t,e),i=new wt.g0({parentPath:["Signal",Lt.uC.getTypeName()],items:[{id:w.generateId(),body:o}]});e===It.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(o.H_.T_,{operation:i,workflowAnnotationType:Lt.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(o)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.handleHandoffMessage=function(e,t){try{if(!(null==e?void 0:e.body)||!Lt.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var n=e.body;if(this.HandoffOperations.onAnnotationReceived(Lt.uC.getTypeName(),n,this.handoffMessageIdRequestSubmitTime,t),n.scenarioName===St.Cu.INAPP)return void this.processHandoffMessage(n);if(!this.isHandoffMessageIdSignalTracked(n.queryId))return;if(n.error){if(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+n.error),n.error.includes("Unable to download content. The specified blob does not exist")||n.error.includes("Unable to download content. Request failed with status code 500"))return;return void this.HandoffOperations.onError(Et.HandoffMessageResponse,"I ran into a problem while completing your request. Please try again.")}var o=this.getHandoffMessageIdFromSignal(n.queryId);return this.sendHandoffMessageId(It.Q.PROCESSED,o),this.completeTrackedHandoffMessageIdSignal(n.queryId),this.processHandoffMessage(n),o}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)}}();var _t=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},At=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},kt=(function(){function e(e){this.HandoffOperations=e}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e),n=new wt.Xr({parentPath:["session","doc"],items:[{id:w.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:Lt.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return _t(this,void 0,void 0,(function(){var n,o;return At(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,6,,7]),!Lt.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return n=e.body,this.HandoffOperations.onAnnotationReceived(Lt.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(Et.OutboundMessageResponse,n.error),[3,5]):[3,1];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(Et.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:return i.sent(),[3,5];case 4:this.HandoffOperations.onError(Et.NoGeneratedLinks),i.label=5;case 5:return[3,7];case 6:throw o=i.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+o.message),o;case 7:return[2]}}))}))}}(),n(27444));const Ut="https://graph.microsoft.com",Dt=e=>{var t,n;return{accessToken:e.accessToken,expirationTime:null!==(n=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0}};var Ot=n(58651);class Nt{constructor(e){this.params=e}loadMsalBrowser(){return(0,a.__awaiter)(this,void 0,void 0,(function*(){for(let e=1;e<=3;e++)try{return this.msalModule=yield n.e(717).then(n.bind(n,89761)),void(this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication))}catch(t){if(Ot.error(`Attempt ${e} to load @azure/msal-browser failed:`,t),3===e)throw t}}))}createPublicClientApplication(e){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const t=this.params.clientId,n=this.params.redirectUri;return new e({auth:{clientId:t,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}))}getToken(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){Ot.log("MsalTokenService.getToken called for resource: "+e),this.publicClientApplication||(yield this.loadMsalBrowser());const t=yield this.publicClientApplication;if(!t)throw new Error("Failed to acquire token - Could not load msal module");let n;try{yield t.initialize();const o=t.getAllAccounts();if(0===(null==o?void 0:o.length)){return yield this.ssoSilentNoAccount(e,t)}if(n=yield this.getSelectedAccount(o,t),!n)throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return this.acquireTokenSilent(e,n,t)}catch(o){if(Ot.log(`Failed to get access token: ${null==o?void 0:o.message}`),this.msalModule&&o instanceof this.msalModule.InteractionRequiredAuthError)return this.acquireTokenPopup(e,n,t);throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),o}}))}getSelectedAccount(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){var n,o,i;if(this.loginPopupPromise){const e=yield this.loginPopupPromise;return null!==(n=null==e?void 0:e.account)&&void 0!==n?n:void 0}if(!e||0===e.length)return;const r=this.params?null!==(o=e.find((e=>{var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=this.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==o?o:null:e[0];if(r)return r;const a=this.params?{loginHint:this.params.userPrincipalName}:void 0;try{this.loginPopupPromise=t.loginPopup(a);const e=yield this.loginPopupPromise;return null!==(i=null==e?void 0:e.account)&&void 0!==i?i:void 0}finally{this.loginPopupPromise=void 0}}))}ssoSilentNoAccount(e,t){return(0,a.__awaiter)(this,void 0,void 0,(function*(){var n;const o={scopes:[`${e}/.default`],loginHint:null===(n=this.params)||void 0===n?void 0:n.userPrincipalName},i=yield t.ssoSilent(o);return i||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),i}))}acquireTokenSilent(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const o={scopes:[`${e}/.default`],account:t},i=yield n.acquireTokenSilent(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),i}))}acquireTokenPopup(e,t,n){return(0,a.__awaiter)(this,void 0,void 0,(function*(){const o={scopes:[`${e}/.default`],account:t},i=yield n.acquireTokenPopup(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),i}))}logTokenAcquiredError(e){Ot.log("AuthTokenService",e)}}var Mt=n(35495),xt=n(15722),Ht=n(41260),Rt=n(45006),qt=n(3471),Ft=n(36733),jt=n(91108);const Bt=(0,qt.n)({dialog:Object.assign(Object.assign({display:"flex",width:"100%",height:"100%",maxWidth:"unset",backgroundColor:Ft.L.colorNeutralBackground4Hover},jt.Pt.padding("0px","0px","0px","0px")),{border:"none",borderRadius:"0px"}),dialogBody:{width:"100%",height:"100%",maxHeight:"100%"},dialogContent:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spinner:{position:"fixed",left:"50%",top:"50%"},iframe:{width:"97vw",height:"95vh",maxWidth:"100%",maxHeight:"100%",display:"block"}});var zt=n(58651);function Gt(e){const{service:t,onItemSelected:n,onDismissDialog:o,onErrorInLoading:i}=e,[r,c]=s.useState(!0),[l,u]=s.useState(null),d=Bt();s.useEffect((()=>{const e={pick:e=>(0,a.__awaiter)(this,void 0,void 0,(function*(){zt.log(e),n(e.items)})),close:e=>(0,a.__awaiter)(this,void 0,void 0,(function*(){o()})),pageLoaded:e=>{c(!1)}};if(l){let n;return t.initializePicker(l,e).then((e=>{n=e})).catch((e=>{i()})),()=>null==n?void 0:n()}}),[l,t]);const f=s.useCallback((e=>{u(e&&e.contentWindow||null)}),[]);return s.createElement("div",null,s.createElement(Mt.E,{className:d.dialog},s.createElement(xt.R,{className:d.dialogBody},s.createElement(Ht.C,{className:d.dialogContent},r&&s.createElement(Rt.y,{size:"large",className:d.spinner}),s.createElement("iframe",{title:"File Picker",sandbox:"allow-forms allow-modals allow-popups allow-same-origin allow-scripts",ref:f,className:d.iframe})))))}var Jt=n(58651);const Wt=e=>{const{userPrincipalName:t,appName:n,theme:o,locale:i,clientId:r,redirectUri:c,onItemSelected:l,onErrorInLoading:u,onDismissDialog:d}=e,f=s.useMemo((()=>new Nt({userPrincipalName:t,redirectUri:c,clientId:r})),[t,c,r]),p=s.useCallback((e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield f.getToken(null!=e?e:Ut);return Dt(t)}catch(e){return Jt.error("Error acquiring graph token:",e),{accessToken:"",expirationTime:0}}}))),[f]),h=s.useCallback((e=>(0,a.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield f.getToken(e);return Dt(t)}catch(e){return Jt.error("Error acquiring sharepoint token:",e),{accessToken:"",expirationTime:0}}}))),[f]),[g,v]=s.useState(void 0);return s.useEffect((()=>{const e=new kt.P(p,h,n,i,o);v(e)}),[n,p,i,h,o]),s.createElement("div",null,g?s.createElement(Gt,{service:g,onItemSelected:l,onDismissDialog:d,onErrorInLoading:u}):s.createElement("div",null,"Loading..."))};var Yt=n(91050),Qt=n(43338),Vt=n(58651);Office.onReady((0,r._)((function(){return(0,a.__generator)(this,(function(e){return Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,(function(e){var t;try{t=JSON.parse(e.message)}catch(e){Vt.error("Failed to parse message from parent:",e),t={}}var n,o,i,r;c.render(s.createElement(We.q,{theme:t.isDarkMode?Yt.C:Qt.o},s.createElement(Wt,{userPrincipalName:null!==(n=t.userPrincipalName)&&void 0!==n?n:"",clientId:null!==(o=t.clientId)&&void 0!==o?o:"",redirectUri:null!==(i=t.redirectUri)&&void 0!==i?i:"",locale:null!==(r=t.locale)&&void 0!==r?r:"",appName:"PowerPoint",onItemSelected:function(e){var t={type:z.OnItemSelected,files:e};Office.context.ui.messageParent(JSON.stringify(t))},onDismissDialog:function(){var e={type:z.CloseEvent};Office.context.ui.messageParent(JSON.stringify(e))},onErrorInLoading:function(){var e={type:z.OnErrorInLoading};Office.context.ui.messageParent(JSON.stringify(e))},theme:t.isDarkMode?"dark":"default"})),document.getElementById("cloud-file-picker-container"))})),Office.context.ui.messageParent(JSON.stringify({type:z.Ack})),[2]}))})))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=r,e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],a=!0,c=0;c<n.length;c++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(a=!1,i<r&&(r=i));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);s.r(i);var r={};t=t||[null,n({}),n([]),n(n)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,s.d(i,r),i},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>(({105:"vendors~id-ID-UiStrings-json",227:"officeaicopilotchatstrings_sv",368:"vendors~gu-IN-UiStrings-json",373:"officeaicopilotchatstrings_te",416:"vendors~as-IN-UiStrings-json",444:"vendors~lo-LA-UiStrings-json",449:"officeaicopilotchatstrings_ur",469:"vendors~te-IN-UiStrings-json",507:"vendors~bs-Latn-BA-UiStrings-json",526:"augloop",530:"vendors~en-US-UiStrings-json",640:"officeaicopilotchatstrings_ms",673:"officeaicopilotchatstrings_fr-ca",717:"vendors~auth-msal-browser",777:"vendors~mt-MT-UiStrings-json",811:"officeaicopilotchatstrings_pa-in",817:"vendors~uk-UA-UiStrings-json",827:"officeaicopilotchatstrings_ca-es-valencia",869:"vendors~hi-IN-UiStrings-json",935:"officeaicopilotchatstrings_ga-ie",1032:"officeaicopilotchatstrings_sd-arab-pk",1034:"sccserviceciq",1039:"officeaicopilotchatstrings_vi",1103:"officeaicopilotchatstrings_zu-za",1172:"vendors~bn-IN-UiStrings-json",1226:"officeaicopilotchatstrings_sw",1280:"vendors~vi-VN-UiStrings-json",1312:"officeaicopilotchatstrings_sr-cyrl-ba",1337:"vendors~fi-FI-UiStrings-json",1354:"vendors~gl-ES-UiStrings-json",1361:"officeaicopilotchatstrings_ta",1398:"vendors~sq-AL-UiStrings-json",1467:"vendors~da-DK-UiStrings-json",1565:"vendors~sccservicevoiceaugloop",1668:"officeaicopilotchatstrings_quz-pe",1751:"officeaicopilotchatstrings_ru",1827:"vendors~pt-BR-UiStrings-json",1950:"officeaicopilotchatstrings_eu",2163:"officeaicopilotchatstrings_zh-hans",2337:"officeaicopilotchatstrings_da",2580:"vendors~ko-KR-UiStrings-json",2582:"vendors~ne-NP-UiStrings-json",2793:"officeaicopilotchatstrings_gd-gb",2800:"vendors~sr-Cyrl-BA-UiStrings-json",2820:"vendors~inlinecreationhvcapp",2899:"officeaicopilotchatstrings_mt-mt",2933:"officeaicopilotchatstrings_de",2935:"officeaicopilotchatstrings_ml",3005:"officeaicopilotchatstrings_hi",3036:"officeaicopilotchatstrings_sq",3047:"officeaicopilotchatstrings_sr",3049:"officeaicopilotchatstrings_pt-pt",3066:"vendors~ug-CN-UiStrings-json",3071:"officeaicopilotchatstrings_el",3073:"officeaicopilotchatstrings_no",3275:"vendors~or-IN-UiStrings-json",3375:"vendors~lt-LT-UiStrings-json",3431:"officeaicopilotchatstrings_lt",3449:"officeaicopilotchatstrings_mr",3457:"officeaicopilotchatstrings_hu",3514:"vendors~ja-JP-UiStrings-json",3536:"officeaicopilotchatstrings_bn-in",3561:"officeaicopilotchatstrings_sl",3601:"officeaicopilotchatstrings_he",3670:"officeaicopilotchatstrings_si-lk",3856:"vendors~zh-TW-UiStrings-json",3889:"vendors~ms-MY-UiStrings-json",3912:"officeaicopilotchatstrings_mk",3935:"vendors~ciqinputareahvc",3961:"vendors~ro-RO-UiStrings-json",3981:"vendors~eu-ES-UiStrings-json",4016:"officeaicopilotchatstrings_pt",4035:"vendors~en-GB-UiStrings-json",4043:"vendors~ur-PK-UiStrings-json",4059:"vendors~lv-LV-UiStrings-json",4067:"vendors~es-ES-UiStrings-json",4121:"officeaicopilotchatstrings_af",4123:"officeaicopilotchatstrings_ja",4140:"vendors~zh-CN-UiStrings-json",4156:"officeaicopilotchatstrings_ca",4161:"vendors~ca-Es-VALENCIA-UiStrings-json",4207:"vendors~sk-SK-UiStrings-json",4263:"vendors~fa-IR-UiStrings-json",4267:"vendors~fr-CA-UiStrings-json",4342:"vendors~sr-Cyrl-RS-UiStrings-json",4394:"vendors~es-MX-UiStrings-json",4445:"officeaicopilotchatstrings_hy",4467:"vendors~tr-TR-UiStrings-json",4499:"officeaicopilotchatstrings_it",4692:"officeaicopilotchatstrings_cy",4723:"vendors~hr-HR-UiStrings-json",4775:"officeaicopilotchatstrings_be-by",4836:"vendors~quz-PE-UiStrings-json",4858:"officeaicopilotchatstrings_en-us",4972:"officeaicopilotchatstrings_zh-hant",5136:"officeaicopilotchatstrings_th",5203:"officeaicopilotchatstrings_kn",5214:"officeaicopilotchatstrings_kk",5273:"officeaicopilotchatstrings_en-gb",5315:"vendors~fr-FR-UiStrings-json",5316:"vendors~km-KH-UiStrings-json",5327:"vendors~ca-ES-UiStrings-json",5375:"vendors~af-ZA-UiStrings-json",5431:"officeaicopilotchatstrings_fa",5501:"officeaicopilotchatstrings_ar",5526:"vendors~fil-PH-UiStrings-json",5610:"officeaicopilotchatstrings_tr",5612:"officeaicopilotchatstrings_nn-no",5663:"officeaicopilotchatstrings_fi",5664:"officeaicopilotchatstrings_uk",5743:"vendors~th-TH-UiStrings-json",5812:"officeaicopilotchatstrings_gu",5821:"officeaicopilotchatstrings_kok",5853:"vendors~az-Latn-AZ-UiStrings-json",5882:"officeaicopilotchatstrings_nl",5939:"officeaicopilotchatstrings_id",5943:"officeaicopilotchatstrings_mi-nz",5944:"vendors~nb-NO-UiStrings-json",5997:"vendors~uz-Latn-UZ-UiStrings-json",6008:"editor",6115:"vendors~gd-gb-UiStrings-json",6121:"officeaicopilotchatstrings_prs",6148:"vendors~sv-SE-UiStrings-json",6193:"officeaicopilotchatstrings_fil",6202:"officeaicopilotchatstrings_ko",6226:"vendors~sl-SI-UiStrings-json",6251:"vendors~sr-Latn-RS-UiStrings-json",6295:"vendors~pt-PT-UiStrings-json",6343:"officeaicopilotchatstrings_et",6470:"officeaicopilotchatstrings_ug-cn",6613:"vendors~pa-IN-UiStrings-json",6627:"vendors~mk-MK-UiStrings-json",6645:"vendors~el-GR-UiStrings-json",6705:"vendors~hu-HU-UiStrings-json",6746:"officeaicopilotchatstrings_sr-cyrl",6759:"dialog-modal",6784:"vendors~kk-KZ-UiStrings-json",6862:"officeaicopilotchatstrings_hr",6929:"vendors~ta-IN-UiStrings-json",6932:"officeaicopilotchatstrings_km-kh",6966:"officeaicopilotchatstrings_sk",7033:"officeaicopilotchatstrings_uz",7055:"officeaicopilotchatstrings_az-latn-az",7153:"officeaicopilotchatstrings_bs-latn-ba",7193:"vendors~sccserviceciq",7288:"officeaicopilotchatstrings_pl",7289:"vendors~ru-RU-UiStrings-json",7320:"officeaicopilotchatstrings_es",7358:"vendors~copilotchatdisplay",7391:"vendors~nl-NL-UiStrings-json",7420:"officeaicopilotchatstrings_tt",7490:"officeaicopilotchatstrings_lb-lu",7585:"vendors~de-DE-UiStrings-json",7628:"officeaicopilotchatstrings_fr",7748:"vendors~nn-NO-UiStrings-json",7877:"vendors~kok-IN-UiStrings-json",7965:"officeaicopilotchatstrings_ro",7987:"vendors~is-IS-UiStrings-json",7999:"officeaicopilotchatstrings_bn-bd",8021:"officeaicopilotchatstrings_bg",8063:"officeaicopilotchatstrings_ha-latn-ng",8224:"officeaicopilotchatstrings_as-in",8249:"vendors~bg-BG-UiStrings-json",8280:"vendors~cs-CZ-UiStrings-json",8305:"vendors~ga-IE-UiStrings-json",8343:"vendors~pl-PL-UiStrings-json",8398:"vendors~ar-SA-UiStrings-json",8453:"vendors~mi-NZ-UiStrings-json",8575:"vendors~ka-GE-UiStrings-json",8582:"officeaicopilotchatstrings_ne-np",8679:"vendors~ml-IN-UiStrings-json",8707:"vendors~he-IL-UiStrings-json",8762:"officeaicopilotchatstrings_am",8767:"officeaicopilotchatstrings_mn-mn",8830:"officeaicopilotchatstrings_es-mx",8888:"vendors~am-ET-UiStrings-json",8892:"officeaicopilotchatstrings_is",8902:"vendors~lb-LU-UiStrings-json",9003:"vendors~kn-IN-UiStrings-json",9005:"officeaicopilotchatstrings_lo-la",9032:"vendors~hy-AM-UiStrings-json",9066:"vendors~cy-GB-UiStrings-json",9177:"vendors~it-IT-UiStrings-json",9203:"officeaicopilotchatstrings_or",9206:"officeaicopilotchatstrings_lv",9229:"vendors~mr-IN-UiStrings-json",9306:"vendors~et-EE-UiStrings-json",9452:"officeaicopilotchatstrings_ky",9669:"officeaicopilotchatstrings_gl",9693:"officeaicopilotchatstrings_tk-tm",9918:"officeaicopilotchatstrings_cs",9930:"vendors~tt-RU-UiStrings-json",9988:"officeaicopilotchatstrings_ka"}[e]||e)+".js"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},i="TypeScriptModule:",s.l=(e,t,n,r)=>{if(o[e])o[e].push(t);else{var a,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+n),a.src=e),o[e]=[t];var f=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=8654,(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={8654:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=s.p+s.u(t),a=new Error;s.l(r,(n=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,c]=n,l=0;if(r.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(c)var u=c(s)}for(t&&t(n);l<r.length;l++)i=r[l],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var c=s.O(void 0,[9037,7645],(()=>s(57314)));c=s.O(c),TypeScriptModule=c})();
//# sourceMappingURL=cloudFilePickerDialog.js.map