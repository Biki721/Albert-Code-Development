"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[6008],{7988:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(17298).f)("ISessionContextProvider")},63318:(e,t,i)=>{var n,o,s;function r(e){return e?Object.values(o).find((t=>t===e)):void 0}function a(e){const t=new Set([o.CIQFlag_DateEntityRecognition,o.CIQFlag_PersonEntityRecognition,o.CIQFlag_Location,o.CIQFlag_LocalBusiness,o.CIQFlag_TaskRecognition,o.HeadingDetection,o.CIQFlag_Topic,o.CIQFlag_SatoriEntityRecognition,o.CIQFlag_File,o.CIQFlag_Time]);return!!e&&t.has(e)}i.d(t,{$w:()=>s,L9:()=>o,bx:()=>n,e3:()=>r,oe:()=>a}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(o||(o={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(s||(s={}))},70848:(e,t,i)=>{if(i.d(t,{OE:()=>a,_K:()=>l,r3:()=>u,z5:()=>c}),2063!=i.j)var n=i(23182);if(2063!=i.j)var o=i(16291);if(2063!=i.j)var s=i(63318);if(2063!=i.j)var r=i(31628);function a(e){const{annotationId:t,typeId:i,traceId:o,priority:a,supportedActions:l,suggestions:d,textInContext:u,start:h,length:g,metadata:p,nodeId:m,tileId:f,categoryTitle:v,isStealth:_,endNode:y,explanationTitle:I,explanationLabel:C,explanation:S,shouldShowMultilingualFre:b,languageId:T,shouldAttemptLanguageDetection:E}=e,N=(0,n.__rest)(e,["annotationId","typeId","traceId","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{annotationId:t}:{}),{typeId:(0,s.e3)(i)}),o?{traceId:o}:{}),{priority:a,supportedActions:c(l),suggestions:d.map(r.SR)}),u?{textInContext:u}:{}),{start:h,length:g}),p?{metadata:p}:{}),m?{nodeId:m}:{}),f?{tileId:f}:{}),v?{categoryTitle:v}:{}),_?{isStealth:_}:{}),y?{endNode:y}:{}),I?{explanationTitle:I}:{}),C?{explanationLabel:C}:{}),S?{explanation:S}:{}),b?{shouldShowMultilingualFre:b}:{}),T?{languageId:T}:{}),E?{shouldAttemptLanguageDetection:E}:{}),N)}function l(e){const{annotationId:t,typeId:i,traceId:o,priority:s,supportedActions:a,suggestions:l,textInContext:c,start:u,length:h,metadata:g,nodeId:p,tileId:m,categoryTitle:f,isStealth:v,endNode:_,explanationTitle:y,explanationLabel:I,explanation:C,shouldShowMultilingualFre:S,languageId:b,shouldAttemptLanguageDetection:T}=e,E=(0,n.__rest)(e,["annotationId","typeId","traceId","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t?{annotationId:t}:{}),i?{typeId:i.toString()}:{}),o?{traceId:o}:{}),{priority:s,supportedActions:d(a),suggestions:l.map(r.Io)}),c?{textInContext:c}:{}),{start:u,length:h}),g?{metadata:g}:{}),p?{nodeId:p}:{}),m?{tileId:m}:{}),f?{categoryTitle:f}:{}),v?{isStealth:v}:{}),_?{endNode:_}:{}),y?{explanationTitle:y}:{}),I?{explanationLabel:I}:{}),C?{explanation:C}:{}),S?{shouldShowMultilingualFre:S}:{}),b?{languageId:b}:{}),T?{shouldAttemptLanguageDetection:T}:{}),E)}function d(e){let t=0;return e.notificationOnly&&(t|=o.lb.NotificationOnly),e.delete&&(t|=o.lb.Delete),e.ignore&&(t|=o.lb.Ignore),e.ignoreAll&&(t|=o.lb.IgnoreAll),e.ignoreCritiqueType&&(t|=o.lb.IgnoreCritiqueType),e.addToDictionary&&(t|=o.lb.AddToDictionary),e.showDetails&&(t|=o.lb.ShowDetails),t}function c(e){return{notificationOnly:!!(e&o.lb.NotificationOnly),delete:!!(e&o.lb.Delete),ignore:!!(e&o.lb.Ignore),ignoreAll:!!(e&o.lb.IgnoreAll),ignoreCritiqueType:!!(e&o.lb.IgnoreCritiqueType),addToDictionary:!!(e&o.lb.AddToDictionary),showDetails:!!(e&o.lb.ShowDetails)}}function u(e){return"isFlagCritique"in e}},88241:(e,t,i)=>{var n,o;i.d(t,{Q:()=>o,p:()=>n}),function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(n||(n={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(o||(o={}))},31628:(e,t,i)=>{if(i.d(t,{Io:()=>r,SR:()=>s,fO:()=>d,gA:()=>a}),2063!=i.j)var n=i(23182);if(2063!=i.j)var o=i(16291);function s(e){const{text:t,action:i,languages:o,metadataJSON:s,description:r}=e,a=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:d(i),languages:o,metadataJSON:s,description:r},a)}function r(e){const{text:t,action:i,languages:o,metadataJSON:s,description:r}=e,a=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]),{confidenceLevel:d,source:c}=a;return Object.assign({text:t,action:l(i),languages:o,metadataJSON:s,description:r,confidenceLevel:d||0,source:c||0},a)}function a(e){return!(e.changeOnce||e.changeAll||e.autoCorrect||e.readAloud||e.personalizedAutoCorrect)}function l(e){let t=0;return e.changeOnce&&(t|=o.xv.ChangeOnce),e.changeAll&&(t|=o.xv.ChangeAll),e.autoCorrect&&(t|=o.xv.AutoCorrect),e.readAloud&&(t|=o.xv.ReadAloud),e.personalizedAutoCorrect&&(t|=o.xv.PersonalizedAutoCorrect),t}function d(e){return{changeOnce:(e&o.xv.ChangeOnce)===o.xv.ChangeOnce,changeAll:(e&o.xv.ChangeAll)===o.xv.ChangeAll,autoCorrect:(e&o.xv.AutoCorrect)===o.xv.AutoCorrect,readAloud:(e&o.xv.ReadAloud)===o.xv.ReadAloud,personalizedAutoCorrect:(e&o.xv.PersonalizedAutoCorrect)===o.xv.PersonalizedAutoCorrect}}},28510:(e,t,i)=>{i.d(t,{o:()=>n});const n={NumProofingLanguages:"NumProofingLanguages"}},14389:(e,t,i)=>{var n;i.d(t,{N:()=>n}),function(e){e[e.GENERIC=0]="GENERIC",e[e.OFFICE=1]="OFFICE",e[e.SVG=2]="SVG"}(n||(n={}))},37036:(e,t,i)=>{i.d(t,{W:()=>r});var n,o=i(23182),s=i(29906);!function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(n||(n={}));let r=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let i=!0;return t.forEach((t=>{const[n,o]=t.callback(e);i=this.processCallBackResult(i,n,o)})),i}processCallBackResult(e,t,i){return t!==n.NoReaction?e&&t===n.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const i={callback:t,id:this.nextListenerId()};let n=this._callbacks.get(e);return n||(n=[],this._callbacks.set(e,n)),n.push(i),i.id}removeListener(e){e&&this._callbacks.forEach(((t,i,n)=>{if(t){if(-1!==t.findIndex((t=>t.id===e)))return void n.set(i,t.filter((t=>t.id!==e)))}}))}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let i=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){i=!0;break}return void 0===t?i:i&&t}};r=(0,o.__decorate)([(0,s._)()],r)},48662:(e,t,i)=>{i.d(t,{c:()=>n});const n=(0,i(17298).f)("IFeatureFlagsReader")},8208:(e,t,i)=>{i.d(t,{F:()=>a});var n=i(23182),o=i(29906),s=i(37036),r=i(20255);let a=class extends s.W{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:r.d2.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};a=(0,n.__decorate)([(0,o._)()],a)},20255:(e,t,i)=>{i.d(t,{In:()=>r,d2:()=>n,kY:()=>o});var n,o,s=i(17298);!function(e){e[e.SettingsClicked=0]="SettingsClicked"}(n||(n={})),function(e){e[e.dropdown=0]="dropdown",e[e.languageDetectionNotificationBar=1]="languageDetectionNotificationBar",e[e.toneRewriteFre=2]="toneRewriteFre",e[e.multilingualFooterFre=3]="multilingualFooterFre",e[e.manageLanguages=4]="manageLanguages"}(o||(o={}));const r=(0,s.f)("IExternalSettingsFeature")},81876:(e,t,i)=>{i.d(t,{FS:()=>o,U1:()=>n,Zp:()=>r});var n,o,s=i(17298);!function(e){e[e.ClientInitialized=0]="ClientInitialized"}(n||(n={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(o||(o={}));const r=(0,s.f)("IRoamingDictionaryFeature")},32745:(e,t,i)=>{i.d(t,{K:()=>d});var n,o=i(23182);!function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.LOAD_ERROR=3]="LOAD_ERROR"}(n||(n={}));var s=i(29906),r=i(83010),a=i(37036),l=i(33767);let d=class extends a.W{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary&&!this.hostSettings.enableV2RoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}setRoamingDictionary(e){this._roamingDictionary=e}isReady(){return!this.check()&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===n.LOADED}processCallBackResult(e,t,i){return this._roamingDictionary=i.roamingDictionary,super.processCallBackResult(e,t,i)}};d=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,r.W)(l.n))],d)},22155:(e,t,i)=>{i.d(t,{DS:()=>u,KW:()=>h,OV:()=>n,xr:()=>o});var n,o,s=i(23182),r=i(17298),a=i(29906),l=i(83010),d=i(37036),c=i(8018);!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(o||(o={}));const u=(0,r.f)("IShowSynonymsFeature");let h=class extends d.W{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};h=(0,s.__decorate)([(0,a._)(),(0,s.__param)(0,(0,l.W)(c.r))],h)},1021:(e,t,i)=>{i.d(t,{Gv:()=>p,o9:()=>n,tq:()=>g,v$:()=>o});var n,o,s=i(23182),r=i(17298),a=i(29906),l=i(83010),d=i(37036),c=i(48662),u=i(28710),h=i(418);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(o||(o={}));const g=(0,r.f)("IUnsignedInEditorFeature");let p=class extends d.W{constructor(e,t,i){super(),this._featureFlagsReader=t,this._languageDetector=i,this.enablers=[!0],this.disablers.push(this),this.disablers.push(e)}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce(((e,t)=>{const i=t.split("-");if(i.length>0){const t=i[0];e.add(t)}return e}),new Set).size}};p=(0,s.__decorate)([(0,a._)(),(0,s.__param)(0,(0,l.W)(h.Z)),(0,s.__param)(1,(0,l.W)(c.c)),(0,s.__param)(2,(0,l.W)(u.v))],p)},8018:(e,t,i)=>{i.d(t,{r:()=>d});var n=i(23182),o=i(29906),s=i(83010),r=i(22649),a=i(15232),l=i(47492);let d=class extends l.t{constructor(e){super(e)}checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===a.G_.Subscription}setGracePeriodUntil(e){this._expiry=e}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(r.e))],d)},418:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(23182),o=i(22649),s=i(29906),r=i(83010),a=i(47492);let l=class extends a.t{constructor(e){super(e)}checkUserInfo(){return!!this.isLoggedIn}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(o.e))],l)},25719:(e,t,i)=>{i.d(t,{W:()=>l});var n=i(23182),o=i(29906),s=i(83010),r=i(48662),a=i(23812);let l=class{constructor(e,t){this._featureFlagsReader=e,this._paragraphDeltasEnabled=t}check(){return this._paragraphDeltasEnabled.check()&&this._featureFlagsReader.flags.enableOptimizedRehydration}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(r.c)),(0,n.__param)(1,(0,s.W)(a.H))],l)},23812:(e,t,i)=>{i.d(t,{H:()=>l});var n=i(23182),o=i(29906),s=i(83010),r=i(48662),a=i(33767);let l=class{constructor(e,t){this._hostSettings=e,this._featureFlagsReader=t}check(){return!!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableParagraphUpdates&&this._featureFlagsReader.flags.enableParagraphDeltas}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(a.n)),(0,n.__param)(1,(0,s.W)(r.c))],l)},47492:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(23182),o=i(29906);let s=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,(e=>(this.setUserInfo(e),e))),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider,this.ageGroup=e.ageGroup,this.ctry=e.ctry),this.isLoggedIn=!!e}};s=(0,n.__decorate)([(0,o._)()],s)},15232:(e,t,i)=>{var n,o,s,r,a,l;i.d(t,{G_:()=>a,P2:()=>l}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(o||(o={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(s||(s={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(r||(r={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},22649:(e,t,i)=>{i.d(t,{e:()=>s});var n,o=i(17298);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(n||(n={}));const s=(0,o.f)("IUserInfoStrategy")},89455:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(17298).f)("IUserInfoUpdater")},27018:(e,t,i)=>{i.d(t,{H:()=>s});var n,o=i(17298);!function(e){e[e.Undefined=0]="Undefined",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(n||(n={}));const s=(0,o.f)("IComponentInitializer")},34471:(e,t,i)=>{i.d(t,{S:()=>n});const n=(0,i(17298).f)("IRegistrable")},45352:(e,t,i)=>{i.d(t,{V:()=>n});const n=(0,i(17298).f)("IRegistrar")},59651:(e,t,i)=>{i.d(t,{w:()=>a});var n=i(23182),o=i(29906),s=i(66008),r=i(34471);let a=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){var e;if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();for(const t of this.registrables)await(null===(e=t.servicesInitialized)||void 0===e?void 0:e.call(t));this.shutDownCalled=!1}}shutDown(){if(!this.shutDownCalled){this.shutDownCalled=!0;for(const e of this.registrables)e.shutDown()}}async addRegistrable(e){var t;await e.initialize(),await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e)),this.registrables.push(e)}async recheckRegistrables(e){var t;const i=e.getAll(r.S),n=[];for(const e of i)this.registrables.includes(e)||(await e.initialize(),this.registrables.push(e),n.push(e));for(const e of n)await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e))}};a=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.t)(r.S))],a)},31352:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(17298).f)("ILanguageInfoProvider")},28710:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(17298).f)("IUxLanguageDetector")},61749:(e,t,i)=>{i.d(t,{U:()=>c});var n=i(23182),o=i(54147),s=i(91450);const r=(e,t=!1,i)=>{let n;const r=e.toLocaleLowerCase(),a=o.p[r];if(a&&(n=Array.isArray(a)?{languageId:e,languageName:a[0],isRtl:a[1]}:{languageId:e,languageName:a,isRtl:!1}),!n&&t){const e=s.Y[r];if(e){const t=Array.isArray(e)?e[0]:e,i=Array.isArray(e)?e[1]:void 0,s=o.p[t.toLocaleLowerCase()],r=!!Array.isArray(s)&&s[1],a=Array.isArray(s)?s[0]:s;n={languageId:t,languageName:null!=i?i:a,isRtl:r}}}if(n&&i){const e=n.languageId.toLocaleLowerCase();i.find((t=>t.toLocaleLowerCase()===e))||(n=void 0)}return n},a=e=>{const t=new Map;for(const i of e){if(!i.languageId)continue;const e=r(i.languageId);e&&!t.has(i.languageId)&&t.set(i.languageId,e)}return Array.from(t.values())};var l=i(29906);const d=["af-ZA","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as-IN","az-Latn-AZ","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-CB","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","kok-IN","ko-KR","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","nso-ZA","or-IN","pa-IN","pl-PL","ps-AF","pt-BR","pt-PT","rm-CH","ro-MD","ro-RO","ru-MD","ru-RU","rw-RW","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tn-BW","tn-ZA","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN","wo-SN","xh-ZA","yo-NG","zu-ZA"];let c=class{constructor(){this.bxSupportedLanguages=d.map((e=>({languageId:e})))}getLanguageInfo(e){return r(e,!0,d)}mapToLanguageInfo(e){return a(e)}bxDefaultSupportedLanguages(){return a(this.bxSupportedLanguages)}};c=(0,n.__decorate)([(0,l._)()],c)},1297:(e,t,i)=>{i.d(t,{I:()=>r});var n=i(23182),o=i(19728),s=i(37814);class r{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0)&&(this._codesList.splice(t,1),!0)},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=i,!0},this.moveDown=e=>{const t=this._codesList.indexOf(e);if(t<0||t===this._codesList.length-1)return!1;const i=this._codesList[t+1];return this._codesList[t+1]=this._codesList[t],this._codesList[t]=i,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=i,!0},this._codesList=e,(0,s.Gn)(this)}get count(){var e;return null!==(e=this._codesList.length)&&void 0!==e?e:0}get defaultLanguageCode(){return r.getDefaultLanguageCode(this._codesList)}static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}get codesList(){return this._codesList||[]}}(0,n.__decorate)([o.observable],r.prototype,"_codesList",void 0),(0,n.__decorate)([o.computed],r.prototype,"count",null),(0,n.__decorate)([o.computed],r.prototype,"defaultLanguageCode",null),(0,n.__decorate)([o.computed],r.prototype,"codesList",null)},69352:(e,t,i)=>{i.d(t,{O:()=>s});var n=i(23182),o=i(29906);let s=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};s=(0,n.__decorate)([(0,o._)()],s)},28798:(e,t,i)=>{i.d(t,{K3:()=>n,aP:()=>r,iw:()=>s});var n,o=i(17298);!function(e){e.auto="auto",e.ltr="ltr",e.rtl="rtl"}(n||(n={}));const s=(0,o.f)("ILanguageScriptDirectionDetector"),r=(0,o.f)("ILanguageScriptDirectionDetectorFactory")},19685:(e,t,i)=>{i.d(t,{H:()=>n});const n=(0,i(17298).f)("ILocalizer")},98089:(e,t,i)=>{i.d(t,{k:()=>c});var n=i(23182),o=i(36915),s=i(51199),r=i(37053),a=i(18349),l=i(29906),d=i(83010);let c=class{constructor(e,t){this.logger=e,this.proofingEmitter=t,this.loggerEventName="AggregateEventCount",this.dataToLog={eventCountMap:{},metadata:{locales:[]}}}async initialize(){this.proofingEmitter.on("proofingLanguageChanged",(e=>{this.updateMetadata({locales:e.data.codesList.slice()})}))}incrementEventCount(e,t,i=1){var n,o,s;const r=null!==(n=(s=this.dataToLog.eventCountMap)[e])&&void 0!==n?n:s[e]={};null!==(o=r[t])&&void 0!==o||(r[t]=0),r[t]+=i}shutDown(){this.logger.logEvent(512304030,this.loggerEventName,o.q.Info,void 0,s.o.SamplingPolicy.Measure,this.dataToLog,void 0)}updateMetadata(e){this.dataToLog.metadata=Object.assign(Object.assign({},this.dataToLog.metadata),e)}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.g)),(0,n.__param)(1,(0,d.W)(a.o))],c)},14784:(e,t,i)=>{var n,o;i.d(t,{f:()=>o,n:()=>n}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(n||(n={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(o||(o={}))},94089:(e,t,i)=>{var n;i.d(t,{M:()=>n}),function(e){e.Diagnostics="Diagnostics"}(n||(n={}))},43222:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(17298).f)("IAggregateLogger")},37053:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(17298).f)("ILogger")},15661:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(17298).f)("IOaLogger")},54181:(e,t,i)=>{i.d(t,{C:()=>n});const n=(0,i(17298).f)("ITransportActivity")},45243:(e,t,i)=>{i.d(t,{l:()=>n});const n=(0,i(17298).f)("ITransportLogger")},84036:(e,t,i)=>{i.d(t,{V:()=>f});var n=i(23182),o=i(51451),s=i(29906),r=i(36915),a=i(58651);const l=(e,t,i,n)=>{const o={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:i,data:n};return JSON.stringify(o)};let d=class{async initialize(e){}addCorrelationID(e){a.log(`CorrelationID is: ${e}`)}log(e,t,i,n){this.dispatchLog(null,e,t,i,n)}debug(e,t,i){this.dispatchLog(null,e,r.q.Debug,t,i)}error(e,t,i){this.dispatchLog(null,e,r.q.Error,t,i)}warn(e,t,i){this.dispatchLog(null,e,r.q.Warn,t,i)}info(e,t,i){this.dispatchLog(null,e,r.q.Info,t,i)}logEvent(e,t,i,n,o,s){this.dispatchLog(t,e,i,n,s)}dispatchLog(e,t,i,n,o){switch(i){case r.q.Debug:a.log(l(e,t,n,o));break;case r.q.Error:a.error(l(e,t,n,o));break;case r.q.Info:a.info(l(e,t,n,o));break;case r.q.Warn:a.warn(l(e,t,n,o));break;default:throw new Error("Invalid logging level")}}};d=(0,n.__decorate)([(0,s._)()],d);var c=i(51199),u=i(54181),h=i(45243),g=i(8628),p=i(66008),m=i(83010);let f=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logActivityBase(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logActivityBase(e,void 0,t,i,n)},this.logActivityBase=(e,t,i,n,o)=>{const s=this.getNewActivity(e,c.o.SamplingPolicy.CriticalExperimentation);t&&(null==s||s.dataFields.push((0,g.n)("message",t))),i&&(null==s||s.dataFields.push((0,g.n)("data",JSON.stringify(i)))),n&&(null==s||s.dataFields.push(...n)),s&&(s.success=!0,s.endNow())}}async initialize(e,t,i,n,s){if(!this._initialized){if(!this._initializing)try{this._debugMode=await e.read(o.l.DebugMode),this._debugMode&&this._transports.push(new d);for(const o of this._transports)await o.initialize(e,i,n,t,s);this._activityTransport&&await this._activityTransport.initialize(e,i,n,t,s)}finally{this._initializing=!1}this._initialized=!0}}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,i,n){this.logEvent(e,null,t,i,c.o.SamplingPolicy.Measure,n)}info(e,t,i){this.logEvent(e,null,r.q.Info,t,c.o.SamplingPolicy.Measure,i)}warn(e,t,i){this.logEvent(e,null,r.q.Warn,t,c.o.SamplingPolicy.Measure,i)}error(e,t,i){this.logEvent(e,null,r.q.Error,t,c.o.SamplingPolicy.CriticalBusinessImpact,i)}debug(e,t,i){this.logEvent(e,null,r.q.Debug,t,c.o.SamplingPolicy.Diagnostics,i)}logServiceRequest(e,t,i,n,o){for(const s of this._transports)t&&(s.serviceRequestID=t),this.logEvent(e,null,i,n,c.o.SamplingPolicy.Measure,o)}logEvent(e,t,i,n,o,s,a){if(this._initialized&&(this._debugMode||i!==r.q.Debug))for(const r of this._transports)r.logEvent(e,t,i,n,o,s,a)}getNewActivity(e,t,i){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,i):void 0}};f=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,p.t)(h.l)),(0,n.__param)(1,(0,m.W)(u.C))],f)},26692:(e,t,i)=>{i.d(t,{h:()=>c});var n=i(23182),o=i(24111),s=i(29906),r=i(83010),a=i(51199),l=i(37053),d=i(8628);let c=class{constructor(e,t){this._queryDetection=e,this._logger=t,this._diagosticEventName="OAPanelDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logInternal(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logInternal(e,void 0,t,i,n)},this.logInternal=(e,t,i,n,o)=>{var s,r;const l=this._logger.getNewActivity(e,a.o.SamplingPolicy.CriticalExperimentation);null==l||l.dataFields.push((0,d.n)("conversationId",null!==(s=null==o?void 0:o.conversationId)&&void 0!==s?s:this._queryDetection.getCurrentQueryConversationId()||""),(0,d.n)("logicalId",null!==(r=null==o?void 0:o.logicalId)&&void 0!==r?r:this._queryDetection.getCurrentQueryLogicalId()||"")),t&&(null==l||l.dataFields.push((0,d.n)("message",t))),i&&(null==l||l.dataFields.push((0,d.n)("data",JSON.stringify(i)))),n&&(null==l||l.dataFields.push(...n)),l&&(l.success=!0,l.endNow())}}};c=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(o.J)),(0,n.__param)(1,(0,r.W)(l.g))],c)},26292:(e,t,i)=>{i.d(t,{L:()=>v});var n,o=i(23182),s=i(1416),r=i(51199),a=i(36915);!function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(n||(n={}));var l,d=i(41066),c=i(91970),u=i(29906),h=i(83010),g=i(51451),p=i(22649),m=i(8628);const f=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];let v=l=class{constructor(e,t,i){this._userInfoStrategy=e,this._telemetrySink=t,this._loggerSettings=i,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._configurationId=""}async initialize(e,t,i,n,o){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{this._hostSettings=o,this._sessionContext=t,this._configurationId=await e.read(g.l.ConfigurationId),this._appId=await e.read(g.l.AppId),this._clientId=await e.read(g.l.ClientId),this._internalLogger=new s.V(this._loggerSettings,this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,i,n,o,s,r){if(this._initialized&&this._loggerSettings.defaultEventName){const a=t||this._loggerSettings.defaultEventName;this.sendLog(a,e,i,n,o,s,r)}}getNewActivity(e,t,i){var n,o,s;if(!this._initialized)return;const a=this._internalLogger.createActivity(e,void 0,{dataCategories:r.o.DataCategories.ProductServiceUsage,diagnosticLevel:r.o.DiagnosticLevel.RequiredServiceData});if(this._userInfoStrategy.execute(!1,(e=>(e&&a.dataFields.push(..._([["User_Id",e.userId],["Tenant_Id",e.tenantId],["Identity_Provider",JSON.stringify(e.identityProvider)],["License_Type",e.licenseType]])),e))),a.dataFields.push(...this.getSessionContextDataFields()),a.dataFields.push(..._([["App_Id",this._appId],["Client_Id",this._clientId],["CorrelationID",null!==(n=this._sessionCorrelationId)&&void 0!==n?n:""],["ConfigurationId",this._configurationId],["FlightsToTrack",null===(s=null===(o=this._hostSettings)||void 0===o?void 0:o.flightsToTrack)||void 0===s?void 0:s.join(";")]])),i){const t=l.createFunnelContract(e,i);a.dataFields.push(...t)}return a}getSessionContextDataFields(){var e,t;return this._sessionContext?_([["Browser_Type",this._sessionContext.browserType],["Browser_Version",null!==(e=this._sessionContext.browserVersion)&&void 0!==e?e:""],["Store_Runtime_Id",null!==(t=this._sessionContext.extensionStoreId)&&void 0!==t?t:""],["Extension_Version",this._sessionContext.extensionVersion],["Extension_Version_Name",this._sessionContext.extensionVersionName]]):[]}addCorrelationID(e){this._sessionCorrelationId=e}sendLog(e,t,i,n,o,s,d){var c,u;if(!this._initialized||i===a.q.Debug)return;const h=[];this.serviceRequestId&&h.push(y("Service_Request_Id",this.serviceRequestId,r.o.DataFieldType.Guid.valueOf())),this._sessionContext&&h.push(...this.getSessionContextDataFields());let g="",p="",m="";if(this._userInfoStrategy.execute(!1,(e=>{var t;return e&&(g=e.userId,p=null!==(t=e.tenantId)&&void 0!==t?t:"",m=e.identityProvider.toString()),e})),h.push(..._([["Tag",t.toString()],["Tag_Hex",t.toString(16)],["Level",a.q[i]],["App_Id",this._appId],["Client_Id",this._clientId],["User_Id",g],["Tenant_Id",p],["Identity_Provider",m],["Text_Message",n],["Correlation_Id",this._sessionCorrelationId],["Data",s instanceof Error?JSON.stringify(I(s)):s?JSON.stringify(s):void 0],["FlightsToTrack",null===(u=null===(c=this._hostSettings)||void 0===c?void 0:c.flightsToTrack)||void 0===u?void 0:u.join(";")]])),d){l.createFunnelContract(e,d).forEach((e=>h.push(e)))}this._internalLogger.logStandaloneMetric(e,o,r.o.DiagnosticLevel.RequiredServiceData,r.o.DataCategories.NotSet,h)}static createFunnelContract(e,t){const i=n[t];return d.A.Office.System.Funnel.getFields(e,{name:e,state:i})}};function _(e){return e.map((e=>e[1]?y(e[0],e[1]):void 0)).filter((e=>!!e))}function y(e,t,i){return(0,m.n)(e,t,r.o.DataClassification.SystemMetadata,i)}function I(e){const t={};return function(e,t){var i;const n="object"==typeof e&&null!==e;function o(t){if(!n)return;const i=e[t];return"string"==typeof i?i:void 0}t.errorMessage=null!==(i=o("message"))&&void 0!==i?i:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),f.forEach((i=>{const n=e[i];n&&(t[i]="object"==typeof n?JSON.stringify(n):n)}))}(e,t),t.message?t.message=`${t.message}\n${t.errorMessage}`:t.message=t.errorMessage,void 0===t.stack&&(t.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),t}v=l=(0,o.__decorate)([(0,u._)(),(0,o.__param)(0,(0,h.W)(p.e)),(0,o.__param)(1,(0,h.W)(c.qy)),(0,o.__param)(2,(0,h.W)(c.k_))],v)},99724:(e,t,i)=>{i.d(t,{M5:()=>o,pD:()=>r,zJ:()=>s});var n=i(17298);const o=(0,n.f)("IHostEmitter"),s=(0,n.f)("IHostEmitterArray");var r;!function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configV2RequestEvent="configV2RequestEvent",e.hostModelTileStateReset="hostModelTileStateReset",e.hostModelVisualStateChange="hostModelTileVisualStateChange",e.hostModelDelta="hostModelDelta",e.hostModelFormattingDelta="hostModelFormattingDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelParagraphTextTiles="hostModelParagraphTextTiles",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelRehydrateTilesFinished="hostModelRehydrateTilesFinished",e.hostModelAddedRootNode="hostModelAddedRootNode",e.hostModelRemovedRootNode="hostModelRemovedRootNode",e.hostModelCritiques="hostModelCritiques",e.hostModelCritiqueAction="hostModelCritiqueAction",e.hostModelFlags="hostModelFlags",e.hostModelTextTileEmittedToAugloop="hostModelTextTileEmittedToAugloop",e.oaRankedAnnotations="oaRankedAnnotations",e.oaAnnotationsTriggered="oaAnnotationsTriggered",e.oaFlagAnnotationsTriggered="oaFlagAnnotationsTriggered",e.oaMenuControlSignal="oaMenuControlSignal",e.predictionTriggered="predictionTriggered",e.nudgeTriggered="nudgeTriggered",e.nudgeAccepted="nudgeAccepted",e.headingDetectionRecognized="headingDetectionRecognized",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configV2ResponseEvent="configV2ResponseEvent",e.clearTileCritiques="clearTileCritiques",e.clearCritiquesForNode="clearCritiquesForNode",e.restoreNodeForCritiqueStore="restoreNodeForCritiqueStore",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange",e.ciqSettingsChange="ciqSettingsChange",e.critiqueValuePerLanguageChanged="critiqueValuePerLanguageChanged",e.saveInlineEditingSettings="saveInlineEditingSettings",e.autoCorrectLanguagesUpdated="autoCorrectLanguagesUpdated",e.addWordToDictionaryLocally="addWordToDictionaryLocally",e.setRoamingDictionaryState="setRoamingDictionaryState",e.enableRoamingDictionary="enableRoamingDictionary",e.updateCurrentSessionDictionary="updateCurrentSessionDictionary",e.setAugLoopState="setAugLoopState",e.getAugLoopState="getAugLoopState",e.squiggleClick="squiggleClick",e.taskRecognitionSignal="taskRecognitionSignal",e.toneDetection="toneDetection",e.autoCorrectionTriggered="autoCorrectionTriggered",e.writeProofingLanguage="writeProofingLanguage",e.readProofingLanguage="readProofingLanguage",e.readProofingUserDictionary="readProofingUserDictionary",e.readRoamingProofingOverriddenOptions="readRoamingProofingOverriddenOptions",e.copywriterRequestSuggestions="copywriterRequestSuggestions",e.copywriterSuggestionsReady="copywriterSuggestionsReady",e.seenEventTriggered="seenEventTriggered",e.addWordsToRoamingUserDictionary="addWordsToRoamingUserDictionary",e.requestSynonyms="requestSynonyms",e.receivedSynonyms="receivedSynonyms",e.writeProofingSettingsToRoaming="writeProofingSettingsToRoaming",e.readOASettings="readOASettings",e.writeOASettings="writeOASettings",e.conditionalOrchestratorSettingsChanged="conditionalOrchestratorSettingsChanged",e.aiInsertRequestSuggestions="aiInsertRequestSuggestions",e.aiInsertSuggestionsReady="aiInsertSuggestionsReady",e.logout="logout",e.textAugmentationCoreResponse="textAugmentationCoreResponse",e.textAugmentationCoreRemovalResponse="textAugmentationCoreRemovalResponse",e.textAugmentationCoreRequest="textAugmentationCoreRequest"}(r||(r={}))},62026:(e,t,i)=>{i.d(t,{f:()=>n});const n=(0,i(17298).f)("IInstrumentationMessageProcessor")},18349:(e,t,i)=>{i.d(t,{o:()=>n});const n=(0,i(17298).f)("IProofingEmitter")},14945:(e,t,i)=>{var n;i.d(t,{G:()=>n}),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(n||(n={}))},83136:(e,t,i)=>{i.d(t,{N:()=>r});var n=i(23182),o=i(45402),s=i(29906);let r=class extends o.bk{constructor(){super(...arguments),this.eventNamesUsed=new Set}async initialize(){}shutDown(){for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}on(e,t){super.on(e,t),this.eventNamesUsed.add(e)}off(e,t){try{super.off(e,t)}catch(e){}}};r=(0,n.__decorate)([(0,s._)()],r)},18500:(e,t,i)=>{if(i.d(t,{A:()=>l}),2063!=i.j)var n=i(98089);if(2063!=i.j)var o=i(51550);if(2063!=i.j)var s=i(43222);if(2063!=i.j)var r=i(34471);if(2063!=i.j)var a=i(15275);class l{constructor(){this.imports=[o.A]}get uniqueId(){return(0,a.z)(507918427)}configureRootServices(e){e.bind(r.S).toExisting(s.v),e.bind(s.v).to(n.k)}}},51550:(e,t,i)=>{if(i.d(t,{A:()=>f}),2063!=i.j)var n=i(66213);if(2063!=i.j)var o=i(34471);if(2063!=i.j)var s=i(38825);if(2063!=i.j)var r=i(22910);if(2063!=i.j)var a=i(22155);if(2063!=i.j)var l=i(28710);if(2063!=i.j)var d=i(23812);if(2063!=i.j)var c=i(69352);if(2063!=i.j)var u=i(57128);if(2063!=i.j)var h=i(79544);if(2063!=i.j)var g=i(25719);if(2063!=i.j)var p=i(25622);if(2063!=i.j)var m=i(15275);class f{constructor(){this.imports=[h.u]}get uniqueId(){return(0,m.z)(507918421)}configureRootServices(e){e.bind(s.n).to(u.y),e.bind(l.v).to(c.O),e.bind(r.j).to(r.c),e.bind(o.S).toExisting(r.j),e.bind(p.oA).toDynamicValue((e=>()=>e.getOptional(p.q4))),e.bind(p.Ze).toDynamicValue((e=>()=>e.getOptional(p.jh))),e.bind(p.cg).toDynamicValue((e=>()=>e.getOptional(p.sh))),e.bind(n.m).to(n.r),e.bind(d.H).toSelf(),e.bind(g.W).toSelf(),e.bind(a.DS).to(a.KW)}}},15275:(e,t,i)=>{function n(e){return e}i.d(t,{z:()=>n})},98484:(e,t,i)=>{i.d(t,{U:()=>a});var n=i(45402);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(83432);if(2063!=i.j)var r=i(29906);class a{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918419)}configureRootServices(e){!function(e,t,i){try{(0,s.Yi)(e,t,i)}catch(e){}}((0,r._)(),n.bk)}}},87753:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(17298).f)("IsMobile")},79544:(e,t,i)=>{if(i.d(t,{u:()=>R}),2063!=i.j)var n=i(98484);if(2063!=i.j)var o=i(3568);if(2063!=i.j)var s=i(1416);if(2063!=i.j)var r=i(4879);if(2063!=i.j)var a=i(8208);if(2063!=i.j)var l=i(92739);if(2063!=i.j)var d=i(91970);if(2063!=i.j)var c=i(20255);if(2063!=i.j)var u=i(81168);if(2063!=i.j)var h=i(99724);if(2063!=i.j)var g=i(33767);if(2063!=i.j)var p=i(28798);if(2063!=i.j)var m=i(37053);if(2063!=i.j)var f=i(18349);if(2063!=i.j)var v=i(34471);if(2063!=i.j)var _=i(45352);if(2063!=i.j)var y=i(81876);if(2063!=i.j)var I=i(7988);if(2063!=i.j)var C=i(54181);if(2063!=i.j)var S=i(45243);if(2063!=i.j)var b=i(1021);if(2063!=i.j)var T=i(8018);if(2063!=i.j)var E=i(418);if(2063!=i.j)var N=i(84036);if(2063!=i.j)var x=i(26292);if(2063!=i.j)var w=i(83136);if(2063!=i.j)var L=i(59651);if(2063!=i.j)var D=i(32745);if(2063!=i.j)var F=i(15275);if(2063!=i.j)var A=i(13190);class R{constructor(){this.imports=[n.U]}get uniqueId(){return(0,F.z)(507918415)}configureRootServices(e){e.bind(_.V).to(L.w),e.bind(h.M5).to(w.N),e.bind(v.S).toExisting(h.M5),e.bind(h.zJ).toExisting(h.M5),e.bind(f.o).to(w.N),e.bind(v.S).toExisting(f.o),e.bind(u.G).to(l.L),e.bind(x.L).toSelf(),e.bind(S.l).toExisting(x.L),e.bind(C.C).toExisting(x.L),e.bind(m.g).to(N.V);const t=new o.a,i=e.getOptional(d.qy);if(i){const{logGroupName:n,tenant:o,logToConsole:a,logToKusto:l}=t,c=new s.V({logGroupName:n,tenant:o,defaultEventName:"",logToConsole:a,logToKusto:l},i,!0);(0,r.L)(c),e.bind(d.ZL).toValue(c)}e.bind(d.k_).toValue(t),e.bind(p.aP).toValue((()=>e.getOptional(p.iw))),e.bind(T.r).toSelf(),e.bind(c.In).to(a.F),e.bind(y.Zp).to(D.K),e.bind(E.Z).toSelf(),e.bind(b.tq).to(b.Gv),e.bind(I.a).toDynamicValue((e=>{let t;const i=e.get(g.n);return async()=>t?Promise.resolve(t):new Promise((n=>{var o,s,r,a,l,d;const c=(0,A.cO)();t={os:void 0,arch:void 0,browserType:null!==(o=null==c?void 0:c.name)&&void 0!==o?o:"",browserVersion:null!==(s=null==c?void 0:c.version)&&void 0!==s?s:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:"",sessionId:null!==(a=null===(r=i.hostMetadata)||void 0===r?void 0:r.sessionId)&&void 0!==a?a:e.get(u.G).generate(),composeSessionId:null!==(d=null===(l=i.hostMetadata)||void 0===l?void 0:l.composeSessionId)&&void 0!==d?d:e.get(u.G).generate()},n(t)}))}))}}},84194:(e,t,i)=>{if(i.d(t,{k:()=>a}),2063!=i.j)var n=i(34471);if(2063!=i.j)var o=i(98839);if(2063!=i.j)var s=i(5494);if(2063!=i.j)var r=i(15275);class a{get uniqueId(){return(0,r.z)(507347844)}configureRootServices(e){e.bind(o.J).to(s.k),e.bind(n.S).toExisting(o.J)}}},35731:(e,t,i)=>{i.d(t,{F:()=>n});const n=(0,i(17298).f)("IPaneOpenState")},51451:(e,t,i)=>{var n;i.d(t,{l:()=>n}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(n||(n={}))},63526:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(17298).f)("IProofingPersistedStore")},10590:(e,t,i)=>{i.d(t,{C:()=>n});const n=(0,i(17298).f)("IRoamingDictionaryBroker")},3568:(e,t,i)=>{if(i.d(t,{a:()=>o}),2063!=i.j)var n=i(94089);class o{constructor(){this.logGroupName="EditorBx",this.tenant={tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},this.defaultEventName=n.M.Diagnostics,this.logToConsole=!1,this.logToKusto=!0}}},63596:(e,t,i)=>{function n(e,t){var i;return!!e&&!0===(null===(i=e.find((e=>e.entityType===t)))||void 0===i?void 0:i.enabled)}function o(e,t){var i;if(e)return null===(i=e.find((e=>e.entityType===t)))||void 0===i?void 0:i.maxResults}function s(e,t,i,o){return!!(null!=e?e:[]).includes(o)||n(t,i)}i.d(t,{Z$:()=>o,f1:()=>s,i$:()=>n})},29417:(e,t,i)=>{i.d(t,{U:()=>o});var n=i(17298);(0,n.f)("IEditorCritiqueGroups");const o=(0,n.f)("ICIQFlagEditorCategories")},63285:(e,t,i)=>{i.d(t,{e:()=>o,rI:()=>s});var n=i(17298);const o=(0,n.f)("ILanguageListStateStore"),s=((0,n.f)("SupportsIndividualCIQFlagDisabling"),(0,n.f)("IEditorSettingsManager"))},4531:(e,t,i)=>{i.d(t,{z:()=>n});const n=(0,i(17298).f)("IEditorSettingsState")},33767:(e,t,i)=>{i.d(t,{d:()=>n,n:()=>s});var n,o=i(17298);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(n||(n={}));const s=(0,o.f)("IHostSettings")},13190:(e,t,i)=>{i.d(t,{cO:()=>d});var n=i(72715);class o{constructor(e,t){this.name=e,this.version=t}}class s{constructor(e){this.version=e,this.name="node"}}class r{constructor(){this.bot=!0,this.name="bot",this.version=null}}const a=3,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function d(e){return e?c(e):navigator?c(navigator.userAgent):n.version?new s(n.version.slice(1)):null}function c(e){const t=""!==e&&l.reduce(((t,[i,n])=>{if(t)return t;const o=n.exec(e);return!!o&&[i,o]}),!1);if(!t)return null;const[i,n]=t;if("searchbot"===i)return new r;let s=n[1].split(/[._]/).slice(0,3);return s?s.length<a&&(s=[...s,...u(a-s.length)]):s=[],new o(i,s.join("."))}function u(e){const t=[];for(let i=0;i<e;i+=1)t.push("0");return t}},4281:(e,t,i)=>{i.d(t,{L:()=>d});var n=i(23182),o=i(98647),s=i(25622),r=i(29906),a=i(83010),l=i(27603);let d=class{constructor(e){this.targetWindowFactory=e,this.isComposing=!1,this._isInitalized=!1}async initialize(){var e,t;this._isInitalized||(this._windowEventListener=new o.J(null!==(t=null===(e=this.targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:window),this._windowEventListener.addListener("compositionstart",this.onCompositionStart),this._windowEventListener.addListener("compositionend",this.onCompositionEnd),this._isInitalized=!0)}shutDown(){var e;null===(e=this._windowEventListener)||void 0===e||e.removeAllListeners(),this._windowEventListener=void 0,this._isInitalized=!1}onCompositionStart(){this.isComposing=!0}onCompositionEnd(){this.isComposing=!1}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.cg)),(0,n.__param)(0,(0,l.l)())],d)},91430:(e,t,i)=>{function n(e,t){return!(!e||!t)&&(e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext&&e.nodeId===t.nodeId)}function o(e,t){return!(e.start>=t.start+t.length||t.start>=e.start+e.length)}i.d(t,{PD:()=>s,gS:()=>n,tw:()=>o});function s(e){const t=new Map;for(const i of e){if(!i.tileId)continue;const e=t.get(i.tileId.nodeId);e?e.push(i):t.set(i.tileId.nodeId,[i])}return t}},13014:(e,t,i)=>{function n(e){return function(e,t){const i=-e.getTimezoneOffset(),n=i>=0?"+":"-";return e.getFullYear()+"-"+o(e.getMonth()+1)+"-"+o(e.getDate())+"T"+o(e.getHours())+":"+o(e.getMinutes())+":"+o(e.getSeconds())+(t?"."+o(e.getMilliseconds()):"")+n+o(i/60)+":"+o(i%60)}(e,!0)}function o(e){const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}i.d(t,{k:()=>n})},98647:(e,t,i)=>{if(i.d(t,{J:()=>o}),2063!=i.j)var n=i(84030);class o{constructor(e){this.listeners={},this.captureListeners={},this.element=(0,n.E)(e)?e:new n.O(e)}addListener(e,t,i){const n=this.element.deref();if(n){if(null==i?void 0:i.capture){if(e in this.captureListeners)throw new Error(`Event ${e} previously registered.`);this.captureListeners[e]=t}else{if(e in this.listeners)throw new Error(`Event ${e} previously registered.`);this.listeners[e]=t}n.addEventListener(e,t,i)}}removeListener(e,t){const i=this.element.deref();i&&((null==t?void 0:t.capture)?e in this.captureListeners&&(i.removeEventListener(e,this.captureListeners[e],t),delete this.captureListeners[e]):e in this.listeners&&(i.removeEventListener(e,this.listeners[e]),delete this.listeners[e]))}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e);this.listeners={};for(const e of Object.keys(this.captureListeners))this.removeListener(e,{capture:!0});this.captureListeners={}}}},27999:(e,t,i)=>{i.d(t,{z:()=>n});class n{constructor(){this.listeners={}}subscribe(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n.push(t),this.listeners[e]=n}unsubscribe(e,t){var i;let n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.listeners[e]=n}publishEvent(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];for(const e of n)e(t)}}},92739:(e,t,i)=>{i.d(t,{L:()=>r});var n=i(23182),o=i(29906),s=i(78126);let r=class{generate(){return(0,s.A)()}};r=(0,n.__decorate)([(0,o._)()],r)},86196:(e,t,i)=>{i.d(t,{q:()=>n});const n=(0,i(17298).f)("ICompositionEventHandler")},81168:(e,t,i)=>{i.d(t,{G:()=>n});const n=(0,i(17298).f)("IGuidGenerator")},24111:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(17298).f)("IQueryDetection")},38825:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(17298).f)("IResourceUrlFormatter")},24033:(e,t,i)=>{if(i.d(t,{K2:()=>r,KV:()=>a,Pe:()=>s,Sg:()=>d,ug:()=>l}),2063!=i.j)var n=i(42119);if(2063!=i.j)var o=i(72677);const s=e=>{const t=e;return void 0!==t.x&&void 0!==t.y},r=e=>{const t=e;return void 0!==t.left&&void 0!==t.top&&void 0!==t.width&&void 0!==t.height};function a(e){return e?e instanceof HTMLElement?e:r(e)?new o.M(e.left,e.right,e.top,e.bottom):s(e)?e:e.getBoundingClientRect():null}function l(e){if(e)return r(e)?{getBoundingClientRect:()=>{var t,i;return{x:e.left,y:e.top,top:e.top,left:e.left,bottom:null!==(t=e.bottom)&&void 0!==t?t:0,right:null!==(i=e.right)&&void 0!==i?i:0,width:e.width,height:e.height}}}:s(e)?{getBoundingClientRect:()=>({x:e.x,y:e.y,top:e.y,left:e.x,bottom:e.y,right:e.x,width:0,height:0})}:e}function d(e,t){if(void 0===e)return{position:"below",align:"start"};if(t)return{position:"above",align:"start"};switch(e){case n.A.topLeftEdge:return{position:"above",align:"start"};case n.A.topCenter:case n.A.topAutoEdge:return{position:"above",align:"center"};case n.A.topRightEdge:return{position:"above",align:"end"};case n.A.bottomLeftEdge:return{position:"below",align:"start"};case n.A.bottomCenter:case n.A.bottomAutoEdge:return{position:"below",align:"center"};case n.A.bottomRightEdge:return{position:"below",align:"end"};case n.A.leftTopEdge:return{position:"before",align:"top"};case n.A.leftCenter:return{position:"before",align:"center"};case n.A.leftBottomEdge:return{position:"before",align:"bottom"};case n.A.rightTopEdge:return{position:"after",align:"top"};case n.A.rightCenter:return{position:"after",align:"center"};case n.A.rightBottomEdge:return{position:"after",align:"bottom"}}}},98839:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(17298).f)("ITimer")},79360:(e,t,i)=>{i.d(t,{l:()=>o});var n=i(84030);class o extends n.O{constructor(e,t,i){super(e),this.logger=t,this.derefFailedLogMessage=i}deref(){const e=super.deref();return e||this.logger.error(508143266,this.derefFailedLogMessage,new Error(this.derefFailedLogMessage)),e}}},92324:(e,t,i)=>{i.d(t,{I:()=>f});var n=i(23182),o=i(94610),s=i(3661),r=i(92739),a=i(48662),l=i(33767),d=i(37053),c=i(14600),u=i(88241),h=i(8628),g=i(29906),p=i(83010),m=i(27603);let f=class{constructor(e,t,i,n){var a,l;this._featureFlagReader=e,this.hostSettings=t,this._logger=i,this._oaMetric=n,this._isNextDeltaProgramaticallyInserted=!1,this._augloopReconnectionOccurring=!1,this._unsupportedEntities=[],this.registeredQueryDetectionStartChars=[],this.FORBIDDEN_CHARS=['"',"<",">","/","\\","|"],this.PUNCTUATION_CHARS=[",",".",":","!","?","'",";","&"],this.ALLOWED_PREVIOUS_CHARS=["(","/","+",""],this.registerQueryDetectionStartCharacter=e=>{this.registeredQueryDetectionStartChars.includes(e)||this.registeredQueryDetectionStartChars.push(e)},this.unregisterQueryDetectionStartCharacter=e=>{const t=this.registeredQueryDetectionStartChars.indexOf(e);t>-1&&this.registeredQueryDetectionStartChars.splice(t,1)},this.handleAugloopReconnection=e=>{this._augloopReconnectionOccurring=!0;try{e()}finally{this._augloopReconnectionOccurring=!1}},this.handleTileRemoved=e=>{var t,i;return(null===(t=this._currentQuery)||void 0===t?void 0:t.tileId)===e&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),null===(i=this._currentQuery)||void 0===i?void 0:i.queryRange},this.getCurrentQuery=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.queryRange},this.getIsSameWordQueriesDismissed=()=>{var e;return null!==(e=this._isCurrentQueryDismissed)&&void 0!==e&&e},this.updateCurrentQuery=e=>{var t,i,n,o,s,r,a;if(this._currentQuery=e,this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1),!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric))return;const l=this._currentQuery.queryRange.length===(null!==(n=null===(i=this._currentQuery.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1),d={logicalId:this._currentQuery.additionalData.logicalId||"",conversationId:this._currentQuery.additionalData.conversationId||"",clientCorrelationId:this._clientCorrelationId||"",triggerCharacter:null!==(o=this._currentQuery.queryRange.prefix)&&void 0!==o?o:"@",isEmptyQuery:l,queryLength:this._currentQuery.queryRange.length-(null!==(r=null===(s=this._currentQuery.queryRange.prefix)||void 0===s?void 0:s.length)&&void 0!==r?r:1)};null===(a=this._oaMetric)||void 0===a||a.startEntry(this._currentQuery.additionalData.logicalId,d)},this.getCurrentQueryTileId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.tileId},this.getCurrentQueryLogicalId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.logicalId},this.getCurrentQueryConversationId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.conversationId},this.getCurrentQueryCorrelationKeys=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData},this.getPreviousQueryCorrelationKeys=()=>this._previousData,this.removeDetectedQuery=()=>{var e;this._previousData=null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData,this._currentQuery=void 0,this._currentScope=void 0,this._unsupportedEntities=[]},this.setCurrentQueryRange=(e,t,i,n,o)=>{var s,a;return this.updateCurrentQuery({tileId:e,queryRange:t,additionalData:{triggerCharacter:o,scopeInfo:n,logicalId:this.registerNewLogicalId(),conversationId:i?(null===(s=this._currentQuery)||void 0===s?void 0:s.additionalData.conversationId)||"":(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||""}}),null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData},this.getCurrentScope=()=>this._currentScope,this.setCurrentScope=(e,t=!0)=>{this._currentScope=e,this._currentQuery&&t&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope})}))},this.getUnsupportedEntities=()=>this._unsupportedEntities,this.setUnsupportedEntities=e=>{this._unsupportedEntities=e,this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{unsupportedEntities:this._unsupportedEntities})}))},this.setClientCorrelationId=e=>{this._clientCorrelationId=e},this.setNextDeltaProgramaticallyInserted=e=>{this._isNextDeltaProgramaticallyInserted=!0,this._programaticallyInsertedSource=e},this.resetNextDeltaProgramaticallyInserted=()=>{this._isNextDeltaProgramaticallyInserted=!1,this._programaticallyInsertedSource=void 0},this.dismissCurrentQuery=(e,t,i,n)=>{var o,s;this._currentQuery&&(e&&this._logger.logActivity(null!=i?i:"OACurrentQueryDismiss",void 0,[...null!=n?n:[],(0,h.n)("interaction",null!=t?t:"escape"),(0,h.n)("conversationId",null!==(o=this.getCurrentQueryConversationId())&&void 0!==o?o:""),(0,h.n)("logicalId",null!==(s=this.getCurrentQueryLogicalId())&&void 0!==s?s:"")]),this._isCurrentQueryDismissed=!0)},this.handleTileDelta=(e,t,i,n,r)=>{var a,l,d,c,u,h,g,p,m,f,v;const{deltaType:_,unit:y,length:I,content:C,position:S}=t;return _!==o.WI.Update||0!==I||C?void 0===I||void 0===S?this.getIfLocal(n)?{queryRange:null===(d=this._currentQuery)||void 0===d?void 0:d.queryRange,additionalData:null===(c=this._currentQuery)||void 0===c?void 0:c.additionalData}:{queryRange:void 0,additionalData:void 0}:y!==o.OD.Sentence&&y!==o.OD.Paragraph||_!==o.WI.Add&&_!==o.WI.Update||!((null!==(h=null===(u=null==C?void 0:C.trim())||void 0===u?void 0:u.length)&&void 0!==h?h:0)>1||0===(null===(g=null==C?void 0:C.trim())||void 0===g?void 0:g.length))||1===(null==C?void 0:C.length)&&s.xC(C.charCodeAt(0))?this.getIfLocal(n)?(this.handleLocalTileDelta(e,S,I,_,C,i,r),{queryRange:null===(f=this._currentQuery)||void 0===f?void 0:f.queryRange,additionalData:null===(v=this._currentQuery)||void 0===v?void 0:v.additionalData}):(this.handleRemoteTileDelta(e,S,I,_,C),{queryRange:void 0,additionalData:void 0}):(this._currentQuery&&this._currentQuery.tileId===e&&_===o.WI.Update&&C&&r&&C.length!==r.length&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this.getIfLocal(n)?{queryRange:null===(p=this._currentQuery)||void 0===p?void 0:p.queryRange,additionalData:null===(m=this._currentQuery)||void 0===m?void 0:m.additionalData}:{queryRange:void 0,additionalData:void 0}):this.getIfLocal(n)?{queryRange:null===(a=this._currentQuery)||void 0===a?void 0:a.queryRange,additionalData:null===(l=this._currentQuery)||void 0===l?void 0:l.additionalData}:{queryRange:void 0,additionalData:void 0}},this.getIfLocal=e=>this._featureFlagReader.flags.enableQueryOnlyOnLocalChange?e===u.Q.Local:e===u.Q.Local||e===u.Q.Code,this.logQueryDetected=()=>{var e,t;this._logger.logActivity("OAQueryDetected",void 0,[(0,h.n)("conversationId",null!==(e=this.getCurrentQueryConversationId())&&void 0!==e?e:""),(0,h.n)("logicalId",null!==(t=this.getCurrentQueryLogicalId())&&void 0!==t?t:"")])},this.handleLocalTileDelta=(e,t,i,n,a,l,d)=>{var c,u,h,g;const p=this._isNextDeltaProgramaticallyInserted,m=this._programaticallyInsertedSource;if(!this._augloopReconnectionOccurring)if(this._currentQuery){if(this._currentQuery.tileId!==e)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const{isWithinSearchQuery:s,updatedEditedPosition:r}=this.isWithinSearchQuery(n,t,i,a,null!==(c=null==a?void 0:a.length)&&void 0!==c?c:0,l,d);if(!s)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(a&&void 0!==this.FORBIDDEN_CHARS.find((e=>a.includes(e))))return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(t=r,n===o.WI.Add&&void 0!==a){const e=l.substring(this._currentQuery.queryRange.start,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length);if(1===a.length&&this.isWhitespace(a.charCodeAt(0))&&this._currentQuery.queryRange.prefix){let t=!0;for(let i=0;i<e.length;i++)if(e.charAt(i)!==this._currentQuery.queryRange.prefix){t=!1;break}if(t)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}this._currentQuery.queryRange.length+=a.length}else if(n===o.WI.Update&&void 0!==a&&i){const e=t-this._currentQuery.queryRange.start,n=this._currentQuery.queryRange.length-e,o=Math.min(i,n);if(this._currentQuery.queryRange.length+=a.length,this._currentQuery.queryRange.length-=o,0===this._currentQuery.queryRange.length)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}else if(n===o.WI.Delete){const e=t-this._currentQuery.queryRange.start,n=Math.min(this._currentQuery.queryRange.length-e,i);this._currentQuery.queryRange.length-=n}if(this._currentQuery.queryRange.length<(null!==(h=null===(u=this._currentQuery.queryRange.prefix)||void 0===u?void 0:u.length)&&void 0!==h?h:1))this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0;else{l.substring(this._currentQuery.queryRange.start+1,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length).trim().split(" ").length>4&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0)}if((null===(g=this._currentQuery)||void 0===g?void 0:g.queryRange)&&this._currentQuery.queryRange.length>this.maxQueryLength)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope,clientCorrelationId:this._clientCorrelationId||"",isUserInsertion:!p,source:m})}))}else if((n===o.WI.Add||n===o.WI.Update)&&a){const i=a,n=a.trim();if(this.registeredQueryDetectionStartChars.includes(n)){const o=i.indexOf(n),s=l[t+o-1];if(s&&!(this.isWhitespace(s.charCodeAt(0),!1)||this.ALLOWED_PREVIOUS_CHARS.includes(s)&&!this.registeredQueryDetectionStartChars.includes(s)))return;this.updateCurrentQuery({tileId:e,queryRange:{start:t+o,length:1,prefix:n},additionalData:{triggerCharacter:n,logicalId:this.registerNewLogicalId(),conversationId:(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!p,source:m}}),this.logQueryDetected()}else if(a.length>0){for(let e=0;e<a.length;e++)s.Yv(a.charCodeAt(e))&&this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1);for(let e=0;e<a.length;e++)if(s.Yv(a.charCodeAt(e))||this.FORBIDDEN_CHARS.includes(a.charAt(e)))return;if(this.PUNCTUATION_CHARS.includes(a))return;const i=this.getWordBeforeChange(l,t+a.length-1);if(this.registeredQueryDetectionStartChars.includes(i[0])){if(i.indexOf(i[0],1)>0)return;if(this._isCurrentQueryDismissed)return;if(i.length>this.maxQueryLength)return;this.updateCurrentQuery({tileId:e,queryRange:{start:t-i.length+a.length,length:i.length,prefix:i[0]},additionalData:{triggerCharacter:i[0],logicalId:this.registerNewLogicalId(),conversationId:(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!p,source:m}}),this.logQueryDetected()}}}},this.handleRemoteTileDelta=(e,t,i,n,s)=>{var r,a;if(!this._currentQuery)return;if(e!==this._currentQuery.tileId)return;if(t>=this._currentQuery.queryRange.start+this._currentQuery.queryRange.length)return;if(t>this._currentQuery.queryRange.start)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const l=n===o.WI.Add?null!==(r=null==s?void 0:s.length)&&void 0!==r?r:0:n===o.WI.Delete?-1*i:n===o.WI.Update?(null!==(a=null==s?void 0:s.length)&&void 0!==a?a:0)-i:0;this._currentQuery.queryRange.start+=l},this.isWithinSearchQuery=(e,t,i,n,s,r,a)=>{let l=t;if(!this._currentQuery)return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(""===this._currentQuery.queryRange.prefix)return{isWithinSearchQuery:!0,updatedEditedPosition:l};if(l<this._currentQuery.queryRange.start)return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(l===this._currentQuery.queryRange.start&&(e!==o.WI.Update||n!==this._currentQuery.queryRange.prefix))return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(e===o.WI.Add&&void 0!==n&&1===s&&l>0){const e=r.charAt(l-1);(e===n||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(n.charCodeAt(0)))&&(l-=1)}if(e===o.WI.Delete&&1===i&&a){const e=r.charAt(l-1),t=a;(e===t||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(t.charCodeAt(0)))&&(l-=1)}return l>this._currentQuery.queryRange.start+this._currentQuery.queryRange.length+(e!==o.WI.Delete?0:-1)?{isWithinSearchQuery:!1,updatedEditedPosition:l}:{isWithinSearchQuery:!0,updatedEditedPosition:l}},this.isWhitespace=(e,t)=>8203===e||s.Yv(e,t),this.getWordBeforeChange=(e,t)=>{let i=t;for(i=t;i>=0&&!this.isWhitespace(e.charCodeAt(i));i--);return e.substring(i+1,t+1)},this.registerNewLogicalId=()=>(new r.L).generate(),this.maxQueryLength=null!==(l=null===(a=this.hostSettings.oaSettings)||void 0===a?void 0:a.maxQueryLength)&&void 0!==l?l:300}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(a.c)),(0,n.__param)(1,(0,p.W)(l.n)),(0,n.__param)(2,(0,p.W)(d.g)),(0,n.__param)(3,(0,p.W)(c.u)),(0,n.__param)(3,(0,m.l)())],f)},71632:(e,t,i)=>{function n(e){var t;const i=e&&(e.commonAncestorContainer||e),n=i&&(i.ownerDocument||("[object HTMLDocument]"===Object.prototype.toString.apply(i)?i:null));return n&&(null!==(t=n.defaultView)&&void 0!==t?t:window)}function o(e,t){const i=n(e),o=i&&i[t],s=window,r=s&&s[t];return r&&e instanceof r||o&&e instanceof o}i.d(t,{C:()=>o,e:()=>n})},22910:(e,t,i)=>{i.d(t,{c:()=>u,j:()=>d});var n=i(23182),o=i(33767),s=i(84030),r=i(17298),a=i(29906),l=i(83010);const d=(0,r.f)("ISafeWindow"),c=1e4;let u=class{constructor(e){this._hostSettings=e,this._clearanceIntervalId=void 0,this._requestedFrames=[],this._requestedIdleFrames=[]}async initialize(){this._hostSettings.enableClearingOfRequestedAnimationFrames&&this.setIntervals()}shutDown(){var e;this._clearanceIntervalId&&(clearInterval(this._clearanceIntervalId),this._clearanceIntervalId=void 0);for(const{id:t,targetWindowRef:i}of this._requestedFrames)null===(e=i.deref())||void 0===e||e.cancelAnimationFrame(t);this._requestedFrames=[]}requestAnimationFrame(e,t=window){const i=(0,s.E)(t)?t:new s.O(t),n=i.deref();if(!n)return-1;const o=n.requestAnimationFrame(e);return this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedFrames.push({id:o,targetWindowRef:i,time:(new Date).getTime()}),o}requestIdleCallback(e,t,i=window){const n=(0,s.E)(i)?i:new s.O(i),o=n.deref();if(!o)return-1;let r;return r="requestIdleCallback"in o?o.requestIdleCallback(e,{timeout:t}):o.setTimeout(e,t),this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedIdleFrames.push({id:r,targetWindowRef:n,time:(new Date).getTime()}),r}cancelIdleCallback(e,t=window){const i=((0,s.E)(t)?t:new s.O(t)).deref();i&&("requestIdleCallback"in i?i.cancelIdleCallback(e):i.clearTimeout(e))}setIntervals(){this._clearanceIntervalId=setInterval((()=>{var e;const t=(new Date).getTime();let i=this._requestedFrames.findIndex((({time:e})=>t-e<c)),n=-1===i?this._requestedFrames.splice(0,this._requestedFrames.length):this._requestedFrames.splice(0,i);if(n.length)for(const{id:t,targetWindowRef:i}of n)null===(e=i.deref())||void 0===e||e.cancelAnimationFrame(t);if(i=this._requestedIdleFrames.findIndex((({time:e})=>t-e<c)),n=-1===i?this._requestedIdleFrames.splice(0,this._requestedIdleFrames.length):this._requestedIdleFrames.splice(0,i),n.length)for(const{id:e,targetWindowRef:t}of n){const i=t.deref();i&&("requestIdleCallback"in i?i.cancelIdleCallback(e):i.clearTimeout(e))}}),c)}};u=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(o.n))],u)},3661:(e,t,i)=>{function n(e,t){let i,n,s={firstDiffLeft:0,firstDiffRight:t.length};e.length<t.length?(i=e,n=t):(i=t,n=e),i=i.replace(""," "),n=n.replace(""," "),n.startsWith(i)?(s.firstDiffLeft=i.length,s.firstDiffRight=0):n.endsWith(i)?(s.firstDiffLeft=0,s.firstDiffRight=i.length):(s=function(e,t){const i={firstDiffLeft:0,firstDiffRight:t.length};return i.firstDiffLeft=o(e,t,!0),i.firstDiffRight=o(e,t,!1),i}(e,t),s.firstDiffLeft+s.firstDiffRight>i.length&&(s.firstDiffRight=i.length-s.firstDiffLeft)),function(e,t,i){if(e.firstDiffLeft>0){const n=e.firstDiffLeft<t.length&&u(t,e.firstDiffLeft),o=e.firstDiffLeft<i.length&&u(i,e.firstDiffLeft);(n||o)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight<=1)return;const n=e.firstDiffRight<t.length&&u(t,t.length-e.firstDiffRight),o=e.firstDiffRight<i.length&&u(i,i.length-e.firstDiffRight);(n||o)&&(e.firstDiffRight-=1)}(s,e,t);s.firstDiffLeft<e.length&&u(e,s.firstDiffLeft)||s.firstDiffLeft<t.length&&u(t,s.firstDiffLeft),s.firstDiffRight>0&&(s.firstDiffRight<e.length&&u(e,e.length-s.firstDiffRight)||s.firstDiffRight<t.length&&u(t,t.length-s.firstDiffRight));return s}function o(e,t,i){let n;for(n=0;n<e.length&&n<t.length;n+=1){const o=e.charCodeAt(i?n:e.length-n-1),s=t.charCodeAt(i?n:t.length-n-1);if(o!==s&&!(l(o,!0)&&l(s,!0)||c(o)&&c(s)))break}return n}let s;function r(e){try{return s||(s=new RegExp("[\\p{Extended_Pictographic}\\u{1F3FB}-\\u{1F3FF}\\u{1F9B0}-\\u{1F9B3}]","u")),s.test(e)}catch(e){return!1}}function a(e){return!!e&&/[\u0E81-\u0EDF\u0f00-\u0FFF\u1000-\u109F\u1780-\u17F9\u1980-\u19DF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\u0E00-\u0E7F\uff66-\uff9f]/g.test(e)}function l(e,t=!1){if(c(e))return!t;if(d(e))return!0;switch(e){case 11:case 9:return!0}return!1}function d(e){switch(e){case 12288:case 8194:case 8195:case 8197:case 32:case 160:return!0}return!1}function c(e){switch(e){case 13:case 10:case 65532:return!0}return!1}function u(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}i.d(t,{CC:()=>n,Fc:()=>g,Yv:()=>l,_1:()=>r,tF:()=>a,xC:()=>d});const h="0123456789";function g(e){return function(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}(e)||function(e){return h.includes(e)}(e)}},25622:(e,t,i)=>{i.d(t,{Ze:()=>l,cg:()=>d,jh:()=>s,oA:()=>a,q4:()=>o,sh:()=>r});var n=i(17298);const o=(0,n.f)("TargetRenderElement"),s=(0,n.f)("TargetDocument"),r=(0,n.f)("TargetWindow"),a=(0,n.f)("TargetRenderElementFactory"),l=(0,n.f)("TargetDocumentFactory"),d=(0,n.f)("TargetWindowFactory")},66213:(e,t,i)=>{i.d(t,{m:()=>f,r:()=>v});var n=i(23182),o=i(17298),s=i(29906),r=i(83010),a=i(51199),l=i(33767),d=i(37053),c=i(51451),u=i(63526),h=i(22910),g=i(40467),p=i(28510),m=i(8628);const f=(0,o.f)("IE2eMetric");let v=class{constructor(e,t,i,n){var o;this._logger=e,this._hostSettings=t,this._proofingStore=i,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,a.o.SamplingPolicy.CriticalExperimentation);if(!t)return;e.forEach((e=>{t.dataFields.push((0,m.n)(e.name,e.duration,void 0,a.o.DataFieldType.Double.valueOf()))})),t.dataFields.push((0,m.n)(this._alEventName,this._isAlEnabled));const i=this._proofingStore.getCachedEntry(c.l.ProofingLanguages).storeEntryValue;t.dataFields.push((0,m.n)(p.o.NumProofingLanguages,i.length)),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(o=this._hostSettings.orchestratorSettings)||void 0===o?void 0:o.enableAugLoop),this.metric=new g.J(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,i){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,i)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};v=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(d.g)),(0,n.__param)(1,(0,r.W)(l.n)),(0,n.__param)(2,(0,r.W)(u.K)),(0,n.__param)(3,(0,r.W)(h.j))],v)},14600:(e,t,i)=>{i.d(t,{u:()=>n});const n=(0,i(17298).f)("IOaMetric")},40467:(e,t,i)=>{i.d(t,{J:()=>d});var n,o=i(23182),s=i(14784),r=i(36915),a=i(51199),l=i(29906);let d=n=class{constructor(e,t,i,n,o,s){this._logger=e,this._safeWindow=t,this._eventName=i,this._performanceApiGarbageCollectorIntervalInMs=n,this._logToTelemetry=o,this._onTimeout=s,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,i){const[n]=this._getPerformanceEntryNames(e);let o=window.performance.mark(n);if(void 0===o){const e=window.performance.getEntriesByName(n);if(1!==e.length)return void this._logger.logEvent(541099735,s.f.TelemetryError,r.q.Error,`Unable to find performance entry by name: ${n}`,a.o.SamplingPolicy.CriticalExperimentation);o=e[0]}this._performanceMarksInGarbageCollection.push(o),t&&this._performanceMarksInGCCorrelationKeysHistory.set(o.name,{correlationKeys:t,customData:i}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const i=`${t}-${e}`;return[e,`${i}--${n.END_SUFFIX}`,i]}addMeasure(e,t,i){const[n,o,l]=this._getPerformanceEntryNames(e,t);if(0!==window.performance.getEntriesByName(n).length)try{if(window.performance.mark(o),window.performance.measure(l,n,o),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]),window.performance.clearMarks(o),window.performance.clearMeasures(l),i){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,o=e.customData;this._performanceMarksInGCCorrelationKeysHistory.set(n,{correlationKeys:t,customData:Object.assign(Object.assign({},o),i)})}}}catch(e){this._logger.logEvent(523646680,s.f.TelemetryError,r.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e}`,a.o.SamplingPolicy.CriticalExperimentation)}}commitEntry(e,t=this._eventName,i){const[n,o,l]=this._getPerformanceEntryNames(e,t),d=window.performance.getEntriesByName(n);if(0!==d.length)try{window.performance.mark(o),window.performance.measure(l,n,o),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]);const s=this._performanceMarksInGCCorrelationKeysHistory.get(n);this._logToTelemetry(this._measuresNames.get(e)||[],null==s?void 0:s.correlationKeys,null==s?void 0:s.customData,i),window.performance.clearMarks(n),window.performance.clearMarks(o),window.performance.clearMeasures(l),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(d[0])}catch(e){this._logger.logEvent(521417349,s.f.TelemetryError,r.q.Error,`Error while commiting a telemetry entry, error: ${e}`,a.o.SamplingPolicy.CriticalExperimentation)}}setOnTimeout(e){this._onTimeout=e}_clearAndReschedule(e){const t=Date.now(),i=[],n=this._performanceMarksInGarbageCollection.filter((n=>{const o=window.performance.timeOrigin+n.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-o<this._performanceApiGarbageCollectorIntervalInMs)return!0;if(this._onTimeout){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n.name)||{};e.isTimeout=!0,this._onTimeout(e.logicalId,e)}return i.push(n),window.performance.clearMarks(n.name),window.performance.clearMeasures(n.name),this._measuresNames.delete(n.name),!1}));for(const e of i)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,n.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||(!e&&"requestIdleCallback"in window?this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs):this._garbageCollectionScheduler=window.setTimeout((()=>{this._clearAndReschedule()}),this._performanceApiGarbageCollectorIntervalInMs))}};d.END_SUFFIX="end",d=n=(0,o.__decorate)([(0,l._)()],d)},11727:(e,t,i)=>{i.d(t,{z:()=>h});var n=i(23182),o=i(29906),s=i(83010),r=i(51199),a=i(33767),l=i(37053),d=i(22910),c=i(40467),u=i(8628);let h=class{constructor(e,t,i){this._logger=e,this._hostSettings=t,this._eventName="OASuggestionLoadTime",this._dataEventName="Data",this._performanceApiGarbageCollectorIntervalInMs=12e4,this._logToTelemetry=(e,t,i,n)=>{var o,s,a,l,d;const c=this._logger.getNewActivity(n||this._eventName,r.o.SamplingPolicy.CriticalExperimentation);if(c){for(const t of e)c.dataFields.push((0,u.n)(t.name,t.duration,void 0,r.o.DataFieldType.Double.valueOf()));c.dataFields.push((0,u.n)("conversationId",null!==(o=null==t?void 0:t.conversationId)&&void 0!==o?o:""),(0,u.n)("logicalId",null!==(s=null==t?void 0:t.logicalId)&&void 0!==s?s:""),(0,u.n)("triggeringChar",null!==(a=null==t?void 0:t.triggerCharacter)&&void 0!==a?a:"@"),(0,u.n)(this._dataEventName,JSON.stringify(Object.assign({isEmptyQuery:null===(l=null==t?void 0:t.isEmptyQuery)||void 0===l||l,dataSource:void 0,isAL:!0,workflow:"oa",logicalId:null==t?void 0:t.logicalId},i))),(0,u.n)("queryLength",null!==(d=null==t?void 0:t.queryLength)&&void 0!==d?d:0)),c.success=!0,c.endNow()}},this.metric=new c.J(e,i,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry),this.setOnTimeout(((e="",t)=>{t&&this.commitEntry(e,"Timeout")}))}startEntry(e,t,i){var n;(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.e2eMetric)&&this.metric.startEntry(e,t,i)}setOnTimeout(e){var t;(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric)&&this.metric.setOnTimeout(e)}addMeasure(e,t,i){var n;(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.e2eMetric)&&this.metric.addMeasure(e,t,i)}commitEntry(e,t,i){var n;(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.e2eMetric)&&this.metric.commitEntry(e,t,i)}};h=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(l.g)),(0,n.__param)(1,(0,s.W)(a.n)),(0,n.__param)(2,(0,s.W)(d.j))],h)},8628:(e,t,i)=>{if(i.d(t,{n:()=>o}),2063!=i.j)var n=i(51199);function o(e,t,i,o){return{name:e,value:t,dataType:(null!=o?o:"boolean"==typeof t)?n.o.DataFieldType.Boolean.valueOf():"number"==typeof t?n.o.DataFieldType.Int64.valueOf():n.o.DataFieldType.String.valueOf(),classification:null!=i?i:n.o.DataClassification.EssentialServiceMetadata}}},88011:(e,t,i)=>{function n(e,t,i,n){return s((i=>e.requestAnimationFrame(i,t)),i,n)}function o(e,t,i,n,o){return s((i=>e.requestAnimationFrame((()=>setTimeout(i,n)),t)),i,o)}function s(e,t,i){let n=!1,o=!1;const r=[];let a=!1;return()=>new Promise((async l=>{if("Immediately"===i){if(!n){n=!0;try{await t()}catch(e){}e((()=>{n=!1,l()}))}}else n?(a&&(o=!0),r.push(l)):(n=!0,e((async()=>{a=!0;try{await t()}catch(e){}a=!1,n=!1,l();for(const e of r)e();o&&(o=!1,s(e,t,i))})))}))}i.d(t,{IS:()=>o,hQ:()=>n})},4962:(e,t,i)=>{function n(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const i=new URL(e),n=t.trim();return i.pathname.endsWith("/")?i.pathname+=n:i.pathname=`${i.pathname}/${n}`,i.toString()}i.d(t,{W:()=>n})},84030:(e,t,i)=>{var n,o;i.d(t,{E:()=>a,O:()=>r});class s{constructor(e){this[n]="WeakRef",this.weakMap=new WeakMap,this.weakMap.set(this,e)}deref(){return this.weakMap.get(this)}}n=Symbol.toStringTag;class r{constructor(e){this[o]="WeakRef","object"==typeof i.g&&i.g&&void 0===i.g.WeakRef?this.weakRef=new s(e):this.weakRef=new i.g.WeakRef(e)}deref(){return this.weakRef.deref()}}function a(e){return"WeakRef"===e[Symbol.toStringTag]}o=Symbol.toStringTag},57128:(e,t,i)=>{i.d(t,{y:()=>s});var n=i(23182),o=i(29906);let s=class{getUrl(e){return e}};s=(0,n.__decorate)([(0,o._)()],s)},5494:(e,t,i)=>{i.d(t,{k:()=>r});var n=i(23182),o=i(29906);class s{constructor(e){this._customWindow=e,this._timeouts=new Map,this._intervals=new Map}get targetWindow(){var e;return null!==(e=this._customWindow)&&void 0!==e?e:window}clearTimer(e){const t=this._timeouts.get(e);t&&(this.targetWindow.clearTimeout(t),this._timeouts.delete(e));const i=this._intervals.get(e);i&&(this.targetWindow.clearInterval(i),this._intervals.delete(e))}setInterval(e,t,i){this.clearTimer(e);const n=this.targetWindow.setInterval(t,i);return this._intervals.set(e,n),e}setIntervalWithDelay(e,t,i,n){this.clearTimer(e);const o=this.targetWindow.setTimeout((()=>{t();const n=this.targetWindow.setInterval(t,i);this._intervals.set(e,n)}),n);return this._timeouts.set(e,o),e}setTimeout(e,t,i){this.clearTimer(e);const n=this.targetWindow.setTimeout(t,i);return this._timeouts.set(e,n),e}async initialize(){}shutDown(){for(const e of this._timeouts.values())this.targetWindow.clearTimeout(e);for(const e of this._intervals.values())this.targetWindow.clearInterval(e);this._intervals.clear(),this._timeouts.clear()}}let r=class{constructor(){this._timer=new s}clearTimer(e){this._timer.clearTimer(e)}setInterval(e,t,i){return this._timer.setInterval(e,t,i)}setIntervalWithDelay(e,t,i,n){return this._timer.setIntervalWithDelay(e,t,i,n)}setTimeout(e,t,i){return this._timer.setTimeout(e,t,i)}async initialize(){}shutDown(){this._timer.shutDown()}};r=(0,n.__decorate)([(0,o._)()],r)},76316:(e,t,i)=>{if(i.d(t,{z:()=>o}),2063!=i.j)var n=i(4962);function o(e,t=""){const i=null===t?e:(0,n.W)(e,t);window.open(i,"_blank","noopener,noreferrer")}},91970:(e,t,i)=>{i.d(t,{ZL:()=>s,k_:()=>o,qy:()=>r});var n=i(17298);(0,n.f)("IOnCanvasKpiHelper");const o=(0,n.f)("ILoggerSettings"),s=(0,n.f)("IEditorSdkLogger"),r=((0,n.f)("IKpiTracker"),(0,n.f)("TelemetrySink"))},89958:(e,t,i)=>{if(i.d(t,{I6:()=>B,Yx:()=>M,cf:()=>U,fQ:()=>j,gs:()=>W,sb:()=>z}),2063!=i.j)var n=i(81168);if(2063!=i.j)var o=i(37053);if(2063!=i.j)var s=i(33767);if(2063!=i.j)var r=i(23812);if(2063!=i.j)var a=i(25719);if(2063!=i.j)var l=i(99724);if(2063!=i.j)var d=i(24111);if(2063!=i.j)var c=i(63526);if(2063!=i.j)var u=i(48662);if(2063!=i.j)var h=i(1297);if(2063!=i.j)var g=i(51451);if(2063!=i.j)var p=i(20796);if(2063!=i.j)var m=i(23380);if(2063!=i.j)var f=i(76487);if(2063!=i.j)var v=i(17025);if(2063!=i.j)var _=i(40634);if(2063!=i.j)var y=i(8475);if(2063!=i.j)var I=i(38583);if(2063!=i.j)var C=i(74805);if(2063!=i.j)var S=i(67386);if(2063!=i.j)var b=i(33727);if(2063!=i.j)var T=i(48903);if(2063!=i.j)var E=i(47375);if(2063!=i.j)var N=i(89637);if(2063!=i.j)var x=i(63995);if(2063!=i.j)var w=i(25359);if(2063!=i.j)var L=i(78426);if(2063!=i.j)var D=i(5698);if(2063!=i.j)var F=i(98402);if(2063!=i.j)var A=i(81174);if(2063!=i.j)var R=i(26094);if(2063!=i.j)var q=i(37076);if(2063!=i.j)var P=i(40014);if(2063!=i.j)var O=i(66815);if(2063!=i.j)var k=i(27846);const z=e=>{e.bind(T.q).toDynamicValue((()=>()=>new q.j))},M=e=>{e.bind(f.WP).toDynamicValue((e=>{const t=e.get(n.G),i=e.get(o.g),c=e.get(N.t),u=e.get(x.B),h=e.get(v.k),g=e.get(y.G),p=e.getOptional(m.E),f=e.get(b.w),S=e.get(L.d),T=e.get(s.n),E=e.get(r.H),w=e.get(a.W),A=e.get(_.d),R=e.get(C.W),q=e.getAll(l.zJ),O=e.getOptional(d.J),z=e.getOptional(I.M);return(e,n,o,s,r,a,l)=>{switch(e){case D.Z.OutlineNode:return new F.T(n,r,o,s,l);case D.Z.TerminalNode:return new P.x(n,o,s,l);case D.Z.TileNode:return new k.b(t,i,c,u,h,g,p,f,S,T,E,w,A,e,n,null!=a?a:R,o,q,z,s,l,O);default:throw Error(`This factory cannot build ${D.Z[e]}.`)}}}))},W=e=>{e.bind(f.Om).toDynamicValue((e=>{const t=e.get(n.G),i=e.get(b.w);return(e,n)=>new A.f(t,i,e,n)}))},j=e=>{e.bind(C.u).toDynamicValue((e=>{const t=e.get(c.K),i=e.get(f.Om),n=e.get(w.D),a=e.get(v.k),l=e.get(s.n),d=e.get(u.c),h=e.get(_.d),g=e.get(S.b),p=e.get(r.H),m=e.get(o.g),y=e.getOptional(I.M);return(e,o)=>new R.zR(t,i,n,a,l,d,h,g,p,m,y,e,o)}))},B=e=>{e.bind(p.q).toDynamicValue((()=>e=>new p.x(e)))},U=e=>{e.bind(E.kK).toDynamicValue((()=>()=>{const t=e.get(s.n),i=e.get(v.k),n=e.get(u.c),o=e.get(r.H),a=e.get(c.K),l=new h.I(a.getCachedEntry(g.l.ProofingLanguages).storeEntryValue),d=Object.assign(Object.assign(Object.assign(Object.assign({},n.flags),i),t),{paragraphDeltasEnabled:o.check()});return new O.$(d,l)}))}},51106:(e,t,i)=>{var n,o;i.d(t,{M:()=>n,s:()=>o}),function(e){e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange",e.TonalFRE="TonalFRE",e.ActionInlineSettingChange="ActionInlineSettingChange"}(n||(n={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(o||(o={}))},71069:(e,t,i)=>{if(i.d(t,{N:()=>a}),2063!=i.j)var n=i(41505);if(2063!=i.j)var o=i(38999);if(2063!=i.j)var s=i(15275);if(2063!=i.j)var r=i(33767);class a{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918409)}configureRootServices(e){e.bind(n.C).toDynamicValue((e=>{const t=e.get(r.n);return new o.t(t.defaultLocale)}))}}},26812:(e,t,i)=>{if(i.d(t,{I:()=>g}),2063!=i.j)var n=i(97651);if(2063!=i.j)var o=i(4288);if(2063!=i.j)var s=i(14284);if(2063!=i.j)var r=i(10100);if(2063!=i.j)var a=i(94251);if(2063!=i.j)var l=i(77238);if(2063!=i.j)var d=i(15275);if(2063!=i.j)var c=i(34471);if(2063!=i.j)var u=i(21203);if(2063!=i.j)var h=i(63423);class g{constructor(){this.imports=[a.l]}get uniqueId(){return(0,d.z)(507908323)}configureRootServices(e){e.bind(l.B).to(n.C),e.bind(c.S).toExisting(l.B),e.bind(r.v).toSelf(),e.bind(c.S).to(o.D),e.bind(c.S).to(s.n),e.bind(c.S).toExisting(u.s),e.bind(u.s).to(h.H)}}},94251:(e,t,i)=>{if(i.d(t,{l:()=>d}),2063!=i.j)var n=i(47507);if(2063!=i.j)var o=i(5045);if(2063!=i.j)var s=i(57734);if(2063!=i.j)var r=i(54936);if(2063!=i.j)var a=i(15275);if(2063!=i.j)var l=i(34471);class d{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507360220)}configureRootServices(e){e.bind(o.g).to(n.p),e.bind(l.S).toExisting(o.g),e.bind(s.D).toExisting(o.g),e.bind(r.p).toExisting(o.g)}}},51562:(e,t,i)=>{if(i.d(t,{Q:()=>d}),2063!=i.j)var n=i(61808);if(2063!=i.j)var o=i(59873);if(2063!=i.j)var s=i(60848);if(2063!=i.j)var r=i(78426);if(2063!=i.j)var a=i(69061);if(2063!=i.j)var l=i(15275);class d{constructor(e){this.attachedToParagraphLevelDivs=e,this.imports=[]}get uniqueId(){return(0,l.z)(507918412)}configureRootServices(e){e.bind(r.d).to(this.attachedToParagraphLevelDivs?a.c:o.Z),e.bind(s.l).to(n.h)}}},39459:(e,t,i)=>{if(i.d(t,{V:()=>M}),2063!=i.j)var n=i(51550);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(34471);if(2063!=i.j)var r=i(8907);if(2063!=i.j)var a=i(79721);if(2063!=i.j)var l=i(71602);if(2063!=i.j)var d=i(23150);if(2063!=i.j)var c=i(66166);if(2063!=i.j)var u=i(94335);if(2063!=i.j)var h=i(25359);if(2063!=i.j)var g=i(402);if(2063!=i.j)var p=i(89637);if(2063!=i.j)var m=i(968);if(2063!=i.j)var f=i(63995);if(2063!=i.j)var v=i(71186);if(2063!=i.j)var _=i(97502);if(2063!=i.j)var y=i(40634);if(2063!=i.j)var I=i(55608);if(2063!=i.j)var C=i(42038);if(2063!=i.j)var S=i(74805);if(2063!=i.j)var b=i(67386);if(2063!=i.j)var T=i(10968);if(2063!=i.j)var E=i(23360);if(2063!=i.j)var N=i(33727);if(2063!=i.j)var x=i(88094);if(2063!=i.j)var w=i(38310);if(2063!=i.j)var L=i(15630);if(2063!=i.j)var D=i(88717);if(2063!=i.j)var F=i(26094);if(2063!=i.j)var A=i(74491);if(2063!=i.j)var R=i(71389);if(2063!=i.j)var q=i(85579);if(2063!=i.j)var P=i(79090);if(2063!=i.j)var O=i(2563);if(2063!=i.j)var k=i(46928);if(2063!=i.j)var z=i(89958);class M{constructor(){this.imports=[n.A]}get uniqueId(){return(0,o.z)(507918410)}configureRootServices(e){e.bind(S.W).to(F.zR),(0,z.sb)(e),(0,z.Yx)(e),(0,z.gs)(e),(0,z.fQ)(e),(0,z.I6)(e),(0,z.cf)(e),e.bind(_.V).to(r.C),e.bind(L.j).to(O.o),e.bind(E.b).to(q.y),e.bind(w.o).to(w.v),e.bind(x.k).toTransient(x.h),e.bind(C.Y).to(C.B),e.bind(y.d).to(a.m),e.bind(b.b).to(A.S),e.bind(N.w).to(P.D),e.bind(s.S).toExisting(N.w),e.bind(s.S).to(k.j),e.bind(T.b).to(R.o),e.bind(I.n).to(D.C),e.bind(l.hN).to(d.F),e.bind(l.c0).to(c.a),e.bind(l.pT).to(u.R),e.bind(l.b0).to(u.R),e.bind(h.D).to(g._n),e.bind(p.t).to(m.a),e.bind(f.B).to(v.M)}}},99787:(e,t,i)=>{i.d(t,{$:()=>d});var n=i(23182),o=i(88241),s=i(36915),r=i(51199),a=i(51106),l=i(29906);let d=class{constructor(e,t,i){this._mutationObserverFactory=e,this.elementTransformers=t,this._logger=i,this.connectMutationObserver=(e,t,i,n)=>{this._mutationObserver=this._mutationObserverFactory((e=>{e.forEach(((e,t,s)=>{const r=null==n?void 0:n.filterSelector;r&&r!==e.target.nodeName||this.handleMutation(e,o.Q.Local,null==i?void 0:i(e,t,s))}))})),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach(((t,i,n)=>this.handleMutation(t,o.Q.Local,e?e(t,i,n):void 0)))},this.handleMutation=(e,t,i)=>{var n;try{const n=this.onElementRemoved,o=this.onElementAdded,s=this.onElementChanged;switch(e.type){case"childList":if(n){Array.from(e.removedNodes).forEach((e=>{n(e,t,i)}))}if(o){Array.from(e.addedNodes).forEach((e=>{o(e,t,i)}))}break;case"characterData":s&&s(e.target,t);break;case"attributes":this.handleAttributeChange(e,t,o,s,n)}}catch(e){null===(n=this._logger)||void 0===n||n.logEvent(508146690,a.s.MutationError,s.q.Error,"Error while processing a mutation.",r.o.SamplingPolicy.CriticalBusinessImpact,e)}}}handleAttributeChange(e,t,i,n,o){const s=e.attributeName,r=e.target;this.elementTransformers&&s&&this.elementTransformers.forEach((e=>{e.attributeList.includes(s)&&e.transform(r)})),null==n||n(r,t,void 0)}disconnect(e){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};d=(0,n.__decorate)([(0,l._)()],d)},68733:(e,t,i)=>{i.d(t,{P:()=>c});var n=i(23182),o=i(37053),s=i(29906),r=i(83010),a=i(27603),l=i(88409),d=i(99787);let c=class extends d.${constructor(e,t){super(e,void 0,t),this.mutationObserverFactory=e,this.logger=t}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1})}};c=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(l.V)),(0,n.__param)(1,(0,a.l)()),(0,n.__param)(1,(0,r.W)(o.g))],c)},22894:(e,t,i)=>{i.d(t,{o:()=>f});var n=i(23182),o=i(51106),s=i(99787),r=i(88241),a=i(36915),l=i(51199),d=i(98647),c=i(37053),u=i(10387),h=i(88409),g=i(29906),p=i(83010),m=i(27603);let f=class extends s.${constructor(e,t,i){super(e,null==i?void 0:i.elementTransformers,t),this.mutationObserverFactory=e,this._logger=t,this._lastCharacterModificationReplacedCharacters=!1,this.connectMutationObserver=(e,t,i)=>{this._mutationObserver=this._mutationObserverFactory((e=>{var t;let n=!1,s=!1;for(let d=0;d<e.length;d++){const c=e[d],u=e;try{const e=this.onElementRemoved,t=this.onElementAdded,o=this.onElementChanged;switch(c.type){case"childList":if(e){const t=Array.from(c.removedNodes);t.length&&!s&&(e(t.pop(),r.Q.Local,void 0),s=!0)}if(t){const e=Array.from(c.addedNodes);e.length&&!n&&(t(e.pop(),r.Q.Local,null==i?void 0:i(c,d,u)),n=!0)}break;case"characterData":o&&o(c.target,r.Q.Local,void 0,this._lastCharacterModificationReplacedCharacters);break;case"attributes":this.handleAttributeChange(c,r.Q.Local,t,o,e)}}catch(e){null===(t=this._logger)||void 0===t||t.logEvent(508146694,o.s.MutationError,a.q.Error,"Error while processing a mutation.",l.o.SamplingPolicy.CriticalBusinessImpact,e)}finally{this._lastCharacterModificationReplacedCharacters=!1}}})),this._mutationObserver.observe(e,t),this.eventListener=new d.J(e),this.eventListener.addListener("keypress",this.onKeyPress,{passive:!0,capture:!0})},this.onKeyPress=e=>{const t=e.currentTarget.ownerDocument.getSelection();(null==t?void 0:t.toString().startsWith(e.key))?this._lastCharacterModificationReplacedCharacters=!0:this._lastCharacterModificationReplacedCharacters=!1},this._mutationContextBuilder=null==i?void 0:i.mutationContextBuilder,this.elementTransformers=null==i?void 0:i.elementTransformers}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)for(const i of t.attributeList)e.add(i);e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder),this._styleChangeObserver=this.mutationObserverFactory((e=>{this.onVisualStateChanged&&e.length>0&&this.onVisualStateChanged(e[0].target,"StyleChange")})),this._styleChangeObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]})}disconnect(e){var t,i,n;super.disconnect(e),null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,null===(i=this._styleChangeObserver)||void 0===i||i.takeRecords(),null===(n=this._styleChangeObserver)||void 0===n||n.disconnect()}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(h.V)),(0,n.__param)(1,(0,m.l)()),(0,n.__param)(1,(0,p.W)(c.g)),(0,n.__param)(2,(0,m.l)()),(0,n.__param)(2,(0,p.W)(u.Bc))],f)},43581:(e,t,i)=>{i.d(t,{D:()=>g});var n=i(23182),o=i(99787),s=i(88241),r=i(71632),a=i(98647),l=i(37053),d=i(88409),c=i(29906),u=i(83010),h=i(27603);let g=class extends o.${constructor(e,t){super(e,void 0,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;t&&this._element&&t(this._element,s.Q.Local,void 0)}}observe(e){var t;((0,r.C)(e,"HTMLInputElement")||(0,r.C)(e,"HTMLTextAreaElement")||(0,r.C)(e,"HTMLDivElement"))&&(this._element=e,null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=new a.J(e),this.eventListener.addListener("input",this._onElementChangedEvent,{passive:!0}),this.eventListener.addListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(e){var t;null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,super.disconnect(e),this._element=void 0}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(d.V)),(0,n.__param)(1,(0,h.l)()),(0,n.__param)(1,(0,u.W)(l.g))],g)},82963:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(17298).f)("IHostModelPersistedStore")},24835:(e,t,i)=>{function n(e,t){e.isApplying||e.suggestions[0].text&&(null==t||t.addWordToIgnoreList(e.suggestions[0].text,!0))}i.d(t,{yf:()=>n})},97651:(e,t,i)=>{i.d(t,{C:()=>b});var n=i(23182),o=i(10100),s=i(33767),r=i(48662),a=i(29906),l=i(83010),d=i(66008),c=i(27603),u=i(17298);const h=(0,u.f)("ISelectedCritiqueCategory");let g=class{constructor(e){this._selectedCritiqueCategory=e}filter(e){return!!e&&(!this._selectedCritiqueCategory.isAnyCategorySelected()||void 0!==e.categoryTitle&&this._selectedCritiqueCategory.isCritiqueCategorySelected(e.categoryTitle))}};g=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(h))],g);var p=i(94909),m=i(6701),f=i(70848),v=i(5045),_=i(85681);let y=class{constructor(e,t,i){this._enabledCritiqueTypes=e,this._upsellStore=t,this._hostSettings=i}filter(e){var t,i;let n=!0;if(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser){const t=null!==(i=e.typeId)&&void 0!==i?i:"";this._enabledCritiqueTypes.isCritiqueTypePremium(t)&&(this._hostSettings.enableOrchestration&&this._upsellStore.addPremiumCritique((0,f.OE)(e)),n=this._upsellStore.previewPremiumSquiggles)}return n}};y=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(v.g)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(1,(0,l.W)(_.Ey)),(0,n.__param)(2,(0,l.W)(s.n))],y);var I=i(63318);const C=(0,u.f)("ISpellingSettingsStore");let S=class{constructor(e){this._spellingSettingsStore=e}filter(e){var t;if(!e)return!1;if(e.priority!==I.bx.High||!this._spellingSettingsStore.isSpellingDisabledForAnyLanguage())return!0;const i=[];for(const n of e.suggestions){const e=null!==(t=n.languages)&&void 0!==t?t:[];n.languages=e.filter((e=>this._spellingSettingsStore.isSpellingEnabledForLanguage(e))),n.languages.length&&i.push(n)}return e.suggestions=i,!!i.length}};S=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(C))],S);let b=class{constructor(e,t,i,n,o,s,r,a){this._dictionaryCritiqueFilter=e,this._basicCritiqueFilters=t,this._hostSettings=i,this._featureFlagsReader=n,this._premiumCritiqueFilter=o,this._spellingCritiqueFilter=s,this._categoryCritiqueFilter=r,this._stealthSquiggleEnabledCritiqueTypes=a,this._critiqueFilters=[]}async initialize(){this._critiqueFilters.push(this._dictionaryCritiqueFilter),!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableCritiqueSettings&&this._spellingCritiqueFilter&&this._critiqueFilters.push(this._spellingCritiqueFilter),this._critiqueFilters.push(...this._basicCritiqueFilters),this._hostSettings.enhancedUpsellEnabled&&this._premiumCritiqueFilter&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._categoryCritiqueFilter&&this._critiqueFilters.push(this._categoryCritiqueFilter)}shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){if(!e)return[];return e.filter((e=>{var t,i,n;const o=e.isVisible,s=e.isStealth;let r=!0;const a=null!==(n=null===(t=this._stealthSquiggleEnabledCritiqueTypes)||void 0===t?void 0:t.isCritiqueTypeEnabled(null!==(i=e.typeId)&&void 0!==i?i:"",e.priority))&&void 0!==n&&n;for(const t of this._critiqueFilters)if(r=t.filter(e),!r)break;return e.isVisible=r,e.isStealth=a,e.isVisible!==o||e.isStealth!==s}))}};b=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(o.v)),(0,n.__param)(1,(0,d.t)(p.D)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(2,(0,l.W)(s.n)),(0,n.__param)(3,(0,l.W)(r.c)),(0,n.__param)(4,(0,c.l)()),(0,n.__param)(4,(0,l.W)(y)),(0,n.__param)(5,(0,c.l)()),(0,n.__param)(5,(0,l.W)(S)),(0,n.__param)(6,(0,c.l)()),(0,n.__param)(6,(0,l.W)(g)),(0,n.__param)(7,(0,c.l)()),(0,n.__param)(7,(0,l.W)(m.a))],b)},4288:(e,t,i)=>{i.d(t,{D:()=>I});var n=i(23182),o=i(51106),s=i(36915),r=i(51199),a=i(14945),l=i(88241),d=i(18349),c=i(63526),u=i(33767),h=i(22649),g=i(37053),p=i(66213),m=i(8475),f=i(33727),v=i(29906),_=i(83010),y=i(74266);let I=class{constructor(e,t,i,n,d,c,u,h){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=i,this._proofingPersistedStore=n,this._hostSettings=d,this._userInfoStrategy=c,this._logger=u,this._e2eMetric=h,this._websiteProvedOnce=!1,this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(536978384,o.s.UpdateCritiqueException,s.q.Error,"Error while updating critiques on the shadow graph.",r.o.SamplingPolicy.CriticalBusinessImpact,e)}},this.updateCritiques=e=>{const t=e.data,i=new Map,n=[],o=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;o.has(t)||(this._e2eMetric.commitEntry(t),o.add(t));const s=i.get(e.tileId.nodeId);if(s)s.push(e);else{i.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&n.push(t)}}n.length&&this._nodePoller.pollNodes(a.G.NewData,n,l.Q.Code,void 0,!1,i)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}shutDown(){}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===a.G.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,(0,y.Q)(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}};I=(0,n.__decorate)([(0,v._)(),(0,n.__param)(0,(0,_.W)(f.w)),(0,n.__param)(1,(0,_.W)(d.o)),(0,n.__param)(2,(0,_.W)(m.G)),(0,n.__param)(3,(0,_.W)(c.K)),(0,n.__param)(4,(0,_.W)(u.n)),(0,n.__param)(5,(0,_.W)(h.e)),(0,n.__param)(6,(0,_.W)(g.g)),(0,n.__param)(7,(0,_.W)(p.m))],I)},10100:(e,t,i)=>{i.d(t,{v:()=>l});var n=i(23182),o=i(63318),s=i(29906),r=i(83010),a=i(21203);let l=class{constructor(e){this._wordDictionary=e}filter(e){return!!e.textInContext&&(e.typeId===o.L9.CIQFlag_DateEntityRecognition||e.typeId===o.L9.CIQFlag_PersonEntityRecognition||e.typeId===o.L9.CIQFlag_Location||e.typeId===o.L9.CIQFlag_Time||e.typeId===o.L9.CIQFlag_LocalBusiness||e.typeId===o.L9.CIQFlag_TaskRecognition||e.typeId===o.L9.CIQFlag_Topic||e.typeId===o.L9.CIQFlag_SatoriEntityRecognition||e.typeId===o.L9.CIQFlag_File||!this._wordDictionary.isWordIgnored(e.textInContext)&&!e.wasAddedToDictionaryInCurrentSession)}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(a.s))],l)},20246:(e,t,i)=>{i.d(t,{p:()=>m});var n=i(23182),o=i(51451),s=i(99724),r=i(14945),a=i(88241),l=i(37053),d=i(63526),c=i(33767),u=i(8475),h=i(33727),g=i(29906),p=i(83010);let m=class{constructor(e,t,i,n,s,r){this._logger=e,this._proofingDom=t,this._proofingPersistedStore=i,this._nodePoller=n,this._hostEmitter=s,this._hostSettings=r,this.getLocalesForSameLanguage=async e=>{var t,i,n,s;const r=[],a=await this._proofingPersistedStore.read(o.l.ProofingLanguages),l=e.suggestions.length&&(null===(t=e.suggestions[0].languages)||void 0===t?void 0:t.length)?e.suggestions[0].languages[0]:null!==(s=null!==(i=a[0])&&void 0!==i?i:null===(n=this._hostSettings.proofingLocales)||void 0===n?void 0:n[0])&&void 0!==s?s:this._hostSettings.defaultLocale;if(l){const e=l.split("-")[0];for(const t of a)e===t.split("-")[0]&&r.push(t)}else this._logger.error(557953868,"Expected language in ISuggestion or the list of Proofing Languages");return r}}async disableCritique(e){if(void 0===e.typeId)return;const t=await this._proofingPersistedStore.read(o.l.OverriddenCritiqueTypeOptions);let i=!1;for(const n of t)n.id===e.typeId&&(n.value="0",i=!0);if(!i){const i=await this.getLocalesForSameLanguage(e);for(const n of i)t.push({id:e.typeId,languageId:n,name:"",value:"0"})}await this._proofingPersistedStore.write(o.l.OverriddenCritiqueTypeOptions,t),this._hostEmitter.emit(s.pD.critiqueSettingsChange,{address:void 0,message:t}),this._nodePoller.pollNodes(r.G.ChangeData,this._proofingDom.tileNodes,a.Q.Code),this._onDisableCritique&&this._onDisableCritique(e.typeId)}setOnDisableCritique(e){this._onDisableCritique=e}};m=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(l.g)),(0,n.__param)(1,(0,p.W)(h.w)),(0,n.__param)(2,(0,p.W)(d.K)),(0,n.__param)(3,(0,p.W)(u.G)),(0,n.__param)(4,(0,p.W)(s.M5)),(0,n.__param)(5,(0,p.W)(c.n))],m)},47507:(e,t,i)=>{i.d(t,{p:()=>f});var n=i(23182),o=i(51451),s=i(99724),r=i(63318),a=i(63526),l=i(33767),d=i(29906),c=i(83010),u=i(37053);const h="19a112ec-21fd-432a-9d1f-195e5e94a00b";let g=class{constructor(e,t,i){this._hostEmitter=e,this._logger=t,this._proofingPersistedStore=i,this._hasSpellingBeenDisabled=!1,this._spellingSettings=new Set,this._readSpellingSettings=async e=>{const t=new Set;for(const i of e)i.id===h&&"0"===i.value&&(i.languageId?t.add(i.languageId):this._logger.error(545067014,"Undefined languageId in Spelling overriddenCritiqueTypeOption"));this._spellingSettings=t},this._updateSpellingSettings=async e=>{const t=e.message;await this._readSpellingSettings(t)}}async initialize(){const e=await this._proofingPersistedStore.read(o.l.OverriddenCritiqueTypeOptions);await this._readSpellingSettings(e),this._hostEmitter.on(s.pD.critiqueSettingsChange,this._updateSpellingSettings)}shutDown(){}isSpellingDisabledForAnyLanguage(){const e=this._spellingSettings.size>0;return e&&(this._hasSpellingBeenDisabled=!0),this._hasSpellingBeenDisabled||e}isSpellingEnabledForLanguage(e){return!this._spellingSettings.has(e)}};g=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(s.M5)),(0,n.__param)(1,(0,c.W)(u.g)),(0,n.__param)(2,(0,c.W)(a.K))],g);var p=i(15232);function m(e,t,i,n){var o,s,a;e.set(r.L9.ContextualSpelling,1),e.set(r.L9.WrongSpelling,1),(null===(o=null==n?void 0:n.taskRecognition)||void 0===o?void 0:o.enabled)&&e.set(r.L9.CIQFlag_TaskRecognition,1),(null===(s=null==n?void 0:n.headingDetection)||void 0===s?void 0:s.enabled)&&e.set(r.L9.HeadingDetection,1),(null===(a=null==n?void 0:n.flagAnnotationSettings)||void 0===a?void 0:a.enabled)&&(e.set(r.L9.CIQFlag_Location,1),e.set(r.L9.CIQFlag_File,1),e.set(r.L9.CIQFlag_Time,1),e.set(r.L9.CIQFlag_LocalBusiness,1),e.set(r.L9.CIQFlag_Topic,1),e.set(r.L9.CIQFlag_SatoriEntityRecognition,1),e.set(r.L9.CIQFlag_DateEntityRecognition,1),e.set(r.L9.CIQFlag_PersonEntityRecognition,1));for(const n of t){const t=n.toLowerCase();"mc-officeeditortonalenabled"===t&&i===p.G_.Subscription?e.set(r.L9.TonalRewrite,1):"csi-editor-topicsuggestions"===t&&e.set(r.L9.TopicSuggestion,1)}}let f=class{constructor(e,t,i){var n;this._proofingPersistedStore=e,this._hostSettings=t,this._hostEmitter=i,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map,this._premiumCritiqueTypes=new Map,this._ciqFlagsEnabled=!0,this.critiqueSettingsChange=e=>{this.setOverriddenCritiqueTypes(e.message)},this.ciqSettingsChange=e=>{this._ciqFlagsEnabled=e.message.ciqFlagsEnabled};const s=this._proofingPersistedStore.getCachedEntry(o.l.OverriddenCritiqueTypeOptions);m(this._availableCritiqueTypes,null!==(n=this._hostSettings.flightsToTrack)&&void 0!==n?n:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this.setOverriddenCritiqueTypes(s.storeEntryValue),s.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async initialize(){this._hostEmitter.on(s.pD.critiqueSettingsChange,this.critiqueSettingsChange),this._hostEmitter.on(s.pD.ciqSettingsChange,this.ciqSettingsChange)}shutDown(){}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(o.l.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e,t){if((0,r.oe)(e)&&!this._ciqFlagsEnabled)return!1;const i=this._availableCritiqueTypes.get(e);let n=this._overriddenCritiqueTypes.get(e);if(this._critiqueToCategoryIdMap){const i=t===r.bx.High?h:this._critiqueToCategoryIdMap.get(e);if(i){0===this._overriddenCritiqueTypes.get(i)&&(n=0)}}return void 0===n?1===i:1===n}isCritiqueTypePremium(e){return e===r.L9.TonalRewrite||(this._hostSettings.enableOrchestration?1===this._premiumCritiqueTypes.get(e):1!==this._availableCritiqueTypes.get(e))}setOverriddenCritiqueTypes(e){if(e){this._overriddenCritiqueTypes.clear();for(const t of e)this._overriddenCritiqueTypes.set(t.id,parseInt(t.value,10))}}setAvailableCritiqueTypes(e,t){var i;if(e){this._availableCritiqueTypes.clear(),m(this._availableCritiqueTypes,null!==(i=this._hostSettings.flightsToTrack)&&void 0!==i?i:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this._critiqueToCategoryIdMap=t;for(const t of e)this._availableCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}setPremiumCritiqueTypes(e){if(e){this._premiumCritiqueTypes.clear();for(const t of e)this._premiumCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}};f=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(a.K)),(0,n.__param)(1,(0,c.W)(l.n)),(0,n.__param)(2,(0,c.W)(s.M5))],f)},54162:(e,t,i)=>{i.d(t,{H:()=>I});var n=i(23182),o=i(63318),s=i(51451),r=i(35731),a=i(63526),l=i(18261),d=i(60963),c=i(19728);(0,c.action)(((e,t)=>{e.isThinking=t}));const u=(0,c.action)(((e,t,i)=>{e.numSuggestions=t,e.hasFilteredCritiques||(e.hasFilteredCritiques=i&&t>=2)}));(0,c.action)(((e,t)=>{e.onCritiqueAdded=t})),(0,c.action)(((e,t)=>{e.addClientLog=t})),(0,c.action)(((e,t)=>{e.upsell=t})),(0,c.action)(((e,t)=>{e.onOpenEditorPane=t})),(0,c.action)(((e,t)=>{e.currentTone=t}));let h=!1;(0,d.debounce)((e=>{!function(e){u(e,e.paneCritiques.size,h)}(e)}),5e3);const g=(0,i(17298).f)("IndicatorStore");var p=i(29906),m=i(83010),f=i(27603),v=i(5045),_=i(91677),y=i(85681);let I=class{constructor(e,t,i,n,o,s){this._enabledCritiqueTypes=e,this._paneEnabledCritiqueTypes=t,this._paneOpenState=i,this._proofingPersistedStore=n,this._upsellStore=o,this._indicatorStore=s}filter(e){return this.addCritiqueToIndicatorMapIfNeeded(e),void 0!==e.typeId&&this.isCritiqueCategoryEnabled(e.priority)&&this.isCritiqueTypeEnabled(e.typeId,e.priority)||e.typeId===o.L9.TopicSuggestion}isCritiqueCategoryEnabled(e){var t;return e===o.bx.High&&!!this._proofingPersistedStore.getCachedEntry(s.l.EnableSpelling).storeEntryValue||e===o.bx.Medium&&!!this._proofingPersistedStore.getCachedEntry(s.l.EnableGrammar).storeEntryValue||e===o.bx.Low&&((null===(t=this._upsellStore)||void 0===t?void 0:t.previewPremiumSquiggles)||!!this._proofingPersistedStore.getCachedEntry(s.l.EnableRefinements).storeEntryValue)||e===o.bx.Informational}isCritiqueTypeEnabled(e,t){var i,n;const o=void 0!==this._paneOpenState,s=o&&(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen)&&(null===(n=this._paneEnabledCritiqueTypes)||void 0===n?void 0:n.isCritiqueTypeEnabled(e,t));return this._enabledCritiqueTypes.isCritiqueTypeEnabled(e,t)||s||!!this._upsellStore&&(!o||this._upsellStore.previewPremiumSquiggles)&&this._enabledCritiqueTypes.isCritiqueTypePremium(e)}addCritiqueToIndicatorMapIfNeeded(e){var t,i;if(!(e.typeId&&e.traceId&&this._paneEnabledCritiqueTypes&&this._indicatorStore))return;const n=e.priority===o.bx.Low,s=this.isCritiqueCategoryEnabled(e.priority)||(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser)&&n,r=this._paneEnabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority),a=this._enabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority);let d=!0;e.typeId!==o.L9.TopicSuggestion&&e.typeId!==o.L9.CIQFlag_Topic||(d=e.isVisible),s&&(r||a)&&d&&function(e,t,i,n,o){var s;e&&t&&n&&!e.paneCritiques.has(t)&&(e.paneCritiques.set(t,i),null===(s=e.onCritiqueAdded)||void 0===s||s.call(e,e.paneCritiques.size,i&&!!e.upsell),h||(h=o),i&&e.refinementsStore&&(0,l.Xf)(e.refinementsStore,n))}(this._indicatorStore,e.traceId,n,e.categoryTitle,r&&!a&&!(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen))}};I=(0,n.__decorate)([(0,p._)(),(0,n.__param)(0,(0,m.W)(v.g)),(0,n.__param)(1,(0,f.l)()),(0,n.__param)(1,(0,m.W)(_.M)),(0,n.__param)(2,(0,f.l)()),(0,n.__param)(2,(0,m.W)(r.F)),(0,n.__param)(3,(0,m.W)(a.K)),(0,n.__param)(4,(0,f.l)()),(0,n.__param)(4,(0,m.W)(y.Ey)),(0,n.__param)(5,(0,f.l)()),(0,n.__param)(5,(0,m.W)(g))],I)},61644:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(23182),o=i(29906);let s=class{setOnFeedbackIconClicked(e){this._onFeedbackIconClicked=e}feedbackIconClicked(e,t){this._onFeedbackIconClicked&&this._onFeedbackIconClicked(e,t)}};s=(0,n.__decorate)([(0,o._)()],s)},94909:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(17298).f)("ICritiqueFilters")},77238:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(17298).f)("ICritiqueFilterer")},67409:(e,t,i)=>{i.d(t,{A_:()=>_,MG:()=>v,W:()=>c,dP:()=>m,dt:()=>g,ht:()=>u,qB:()=>h,r:()=>d,r6:()=>p});var n=i(23182),o=i(63318),s=i(70848),r=i(31628),a=i(17298),l=i(29906);(0,a.f)("ICritiqueInterpreter");function d(e){const t=[o.L9.ContextualSpelling,o.L9.WrongSpelling];return!!e&&e.typeId!==o.L9.Synonyms&&(e.priority===o.bx.High||!!e.typeId&&t.includes(e.typeId))}function c(e){return!!e&&e.typeId===o.L9.TopicSuggestion}function u(e){return!0===("number"==typeof e.supportedActions?(0,s.z5)(e.supportedActions):e.supportedActions).delete}function h(e){const t="number"==typeof e.action?(0,r.fO)(e.action):e.action;return!0===t.changeAll||!0===t.changeOnce||!0===t.autoCorrect||!0===t.personalizedAutoCorrect}function g(e){return!!e&&(u(e)&&!e.suggestions.some((e=>h(e))))}function p(e){return(null==e?void 0:e.typeId)===o.L9.TonalRewrite}function m(e){return!0===("number"==typeof e.action?(0,r.fO)(e.action):e.action).personalizedAutoCorrect}function f(e){for(const t of e.suggestions)if(4===t.action)return t}function v(e){for(const t of e.suggestions)if(!0===t.action.autoCorrect)return t}function _(e){return!!f(e)}let y=class{isSpellingCritique(e){return!!e&&d({priority:e.priority,typeId:(0,o.e3)(e.typeId)})}isTopicSuggestionCritique(e){return!!e&&c({typeId:(0,o.e3)(e.typeId)})}isDeleteActionAvailable(e){return u(e)}isChangeActionAvailable(e){return h(e)}isRepeatedWord(e){return g(e)}isRewrite(e){return p({typeId:(0,o.e3)(e.typeId)})}isPersonalized(e){return m(e)}hasAtLeastOneSynonym(e){return function(e){return e.suggestions.some((e=>function(e){const t=/\[(.*)\]/g;return!!e.description&&!e.description.match(t)}(e)))}(e)}getAutoCorrectionSuggestion(e){return f(e)}};y=(0,n.__decorate)([(0,l._)()],y)},71975:(e,t,i)=>{i.d(t,{W:()=>n});const n=(0,i(17298).f)("IDisableCritiqueHandler")},5045:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(17298).f)("IEnabledCritiqueTypes")},57734:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(17298).f)("IEnabledCritiqueTypesSetter")},54936:(e,t,i)=>{i.d(t,{p:()=>n});const n=(0,i(17298).f)("IEnabledPremiumCritiqueTypes")},63519:(e,t,i)=>{i.d(t,{M:()=>o,g:()=>s});var n=i(17298);const o=(0,n.f)("IFeedbackStore"),s=(0,n.f)("IFeedbackStoreFactory")},91677:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(17298).f)("IPaneOnlyEnabledCritiqueTypes")},95537:(e,t,i)=>{i.d(t,{S:()=>n});const n=(0,i(17298).f)("IShadowElementsStore")},6701:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(17298).f)("IStealthSquiggleEnabledCritiqueTypes")},85681:(e,t,i)=>{i.d(t,{Ey:()=>r,mq:()=>n,nz:()=>o});var n,o,s=i(17298);!function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(n||(n={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(o||(o={}));const r=(0,s.f)("IUpsellStore")},21203:(e,t,i)=>{i.d(t,{s:()=>n});const n=(0,i(17298).f)("IWordDictionary")},26633:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(23182),o=i(29906);const s=String.fromCharCode(65532);let r=class{constructor(){}filter(e){var t;return!(null===(t=e.textInContext)||void 0===t?void 0:t.includes(s))}};r=(0,n.__decorate)([(0,o._)()],r)},74266:(e,t,i)=>{if(i.d(t,{Q:()=>a}),2063!=i.j)var n=i(51451);if(2063!=i.j)var o=i(8628);if(2063!=i.j)var s=i(51199);if(2063!=i.j)var r=i(51106);const a=(e,t,i,a)=>{if(!e||!t)return;const l=e.getNewActivity(r.M.WebSiteProvedOnce,s.o.SamplingPolicy.CriticalBusinessImpact),d=t.getCachedEntry(n.l.ProofingLanguages).storeEntryValue;let c;a.execute(!1,(e=>(c=null==e?void 0:e.regionScope,e))),l&&(l.dataFields.push((0,o.n)("Proofing_Languages",d.join(","))),l.dataFields.push((0,o.n)("Region_Scope",null!=c?c:"unknown")),l.dataFields.push((0,o.n)("IsAL",i&&!0===i.enableOrchestration&&i.orchestratorSettings&&!0===i.orchestratorSettings.enableAugLoop||!1)),l.success=!0,l.endNow())}},63423:(e,t,i)=>{i.d(t,{H:()=>f});var n,o=i(23182),s=i(14945),r=i(88241);!function(e){e.IgnoreListUpdate="IgnoreListUpdate",e.CustomDictionaryUpdate="CustomDictionaryUpdate"}(n||(n={}));var a=i(81876),l=i(18349),d=i(33767),c=i(10590),u=i(8475),h=i(33727),g=i(29906),p=i(83010),m=i(27603);let f=class{constructor(e,t,i,o,a,l){this._proofingDom=e,this._proofingEmitter=t,this.hostSettings=o,this._roamingDictionaryFeature=a,this._roamingDictionaryBroker=l,this._ignoredWords=new Set,this.isWordIgnored=e=>{var t;const i=e.trim();if(this._ignoredWords.has(i))return!0;return!!(null===(t=this._roamingDictionaryFeature.getRoamingDictionary())||void 0===t?void 0:t.testWord(i,!0))},this.clearIgnoredWords=()=>{var e;this._ignoredWords.clear(),null===(e=this._nodePoller)||void 0===e||e.pollNodes(s.G.ChangeData,this._proofingDom.tileNodes,r.Q.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:s.G.RemoveData,data:n.IgnoreListUpdate})},this.addWordToIgnoreList=(e,t=!1)=>{this.addWordsToIgnoreList([e],t)},this.addWordsToIgnoreList=(e,t=!1)=>{var i;let o=!1;for(let t=0;t<e.length;t++){const i=e[t];if(i){const e=i.trim();if(this._ignoredWords.has(e))continue;this._ignoredWords.add(e),o=!0}}o&&!t&&(null===(i=this._nodePoller)||void 0===i||i.pollNodes(s.G.ChangeData,this._proofingDom.tileNodes,r.Q.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:s.G.NewData,data:n.IgnoreListUpdate}))},this.addWordToCustomDictionary=e=>{var t,i;if(e){if(this.hostSettings.enableV2RoamingDictionary&&(null===(t=this._roamingDictionaryBroker)||void 0===t?void 0:t.isRoamingDictionaryReady))return this._roamingDictionaryBroker.addWordToRoamingDictionary(e),!0;{const t=e.trim();if(this.roamingDictionary&&this._roamingDictionaryFeature.isReady()){return!!this.roamingDictionary.addWord(t)&&(null===(i=this._nodePoller)||void 0===i||i.pollNodes(s.G.ChangeData,this._proofingDom.tileNodes,r.Q.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:s.G.NewData,data:n.CustomDictionaryUpdate}),!0)}}}return!1},this._nodePoller=o.enableOrchestration?void 0:i}get roamingDictionary(){if(this.hostSettings.enableRoamingDictionary)return this._roamingDictionaryFeature.getRoamingDictionary()}async initialize(){this.hostSettings.enableRoamingDictionary&&this._roamingDictionaryFeature.emitAndEvaluate({eventId:a.U1.ClientInitialized,sender:a.FS.WordDictionaryInit})}shutDown(){}get roamingDictionaryEnabled(){var e;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!this._roamingDictionaryFeature.isReady()}};f=(0,o.__decorate)([(0,g._)(),(0,o.__param)(0,(0,p.W)(h.w)),(0,o.__param)(1,(0,p.W)(l.o)),(0,o.__param)(2,(0,p.W)(u.G)),(0,o.__param)(3,(0,p.W)(d.n)),(0,o.__param)(4,(0,p.W)(a.Zp)),(0,o.__param)(5,(0,m.l)()),(0,o.__param)(5,(0,p.W)(c.C))],f)},23380:(e,t,i)=>{i.d(t,{E:()=>n});const n=(0,i(17298).f)("ICritiquesBrokerFactory")},66815:(e,t,i)=>{i.d(t,{$:()=>D});var n=i(27999),o=i(88241),s=i(14945),r=i(94610),a=i(3661),l=i(63318),d=i(63326),c=i(41385);class u{constructor(e,t){this.id=(0,c.h)(),this.range=e,this.parent=t,t.registerChild(this)}retire(){var e;null===(e=this.parent)||void 0===e||e.unregisterChild(this),this.parent=void 0}move(e,t){return e&&(this.range=e),t&&(this.parent=t),this.id=(0,c.h)(),this}}var h=i(402),g=i(66166),p=i(23150),m=i(94335);function f(e,t=!1){switch(e){case d.fT.Sentence:return new p.F({newLineSentenceSeparatorEnabled:t});case d.fT.Paragraph:return new g.a;default:return new m.R}}var v=i(71186),_=i(968),y=i(63373),I=i(7569);class C extends n.z{constructor(e,t){super(),this._settings=e,this._logger=t}updateSettings(e){this._settings=e}updateParagraphNodes(e,t,i,n,o,s,r){if(!this._settings.enableOrchestration||!this._settings.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,i,n,o);const a={oldTextInfo:t,newTextInfo:i,tileNode:e,sequenceId:o,minDiffBounds:n,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(a),this._addNewChildren(a),this._buildGraphTransaction(a,s,r),a.graphTransaction}_updateExistingChildren(e){var t,i;if(!e.tileNode.children.length)return;const n=null!==(i=null===(t=e.oldTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"",o=e.newTextInfo.content,s=n!==o,r={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let a=e.tileNode.children.length-1;for(;a>=0;){const t=e.tileNode.children[a].range;if(n.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=o.length-n.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!s)){t.offset<e.minDiffBounds.firstDiffLeft&&(r.firstDiffLeft=Math.min(t.offset,r.firstDiffLeft));const i=n.length-t.offset-t.span;i<e.minDiffBounds.firstDiffRight&&(r.firstDiffRight=Math.min(i,r.firstDiffRight));const o=e.tileNode.children.splice(a,1);e.nodesToRetire.length&&r.firstDiffRight!==i?r.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...o):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...o):e.nodesToRetire.push(...o)}a-=1}e.unitRange={offset:r.firstDiffLeft,span:o.length-r.firstDiffRight-r.firstDiffLeft,enforcedCompleteTileTextUnit:!s&&this._settings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=(0,h.e)(e.newTextInfo.content,e.minDiffBounds,f(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),e.unitRange);for(const i of t){const t=new u(i,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.range.textUnit=(!1===e.range.validEndBoundary&&this._settings.enableOptimizedCallingPattern&&e.range.enforcedCompleteTileTextUnit,this._settings.completeTileTextUnit)}_buildTile(e,t,i,n){const o=t.range.offset,s=t.range.span;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:o,span:s},length:i.length},data:i.slice(o,o+s),proofingLanguages:this._settings.proofingLanguages,textUnit:t.range.textUnit}}_convertToUpdate(e,t,i,n,o,s){var r,a;if(!(null==e?void 0:e.range)||!(null==t?void 0:t.range))return;const l=null!==(a=null===(r=i.oldTextInfo)||void 0===r?void 0:r.content)&&void 0!==a?a:"",d=i.newTextInfo.content,c=l.length-e.range.offset-e.range.span,u=d.length-t.range.offset-t.range.span;if(!n&&e.range.offset!==t.range.offset||n&&c!==u)return;const h=this._emitParagraphDeltaUpdate(e,t,i,o,s);return e.range.offset=t.range.offset,e.range.span=t.range.span,e.range.validEndBoundary=t.range.validEndBoundary,e.range.enforcedCompleteTileTextUnit=t.range.enforcedCompleteTileTextUnit,e.range.textUnit=t.range.textUnit,t.retire(),i.nodesToAdd.splice(n?i.nodesToAdd.length-1:0,1),i.nodesToInsert.splice(n?i.nodesToInsert.length-1:0,1,e),i.nodesToRetire.splice(n?i.nodesToRetire.length-1:0,1),i.nodesToUpdate.push(e),i.graphTransaction.unreconciledContent.find((i=>{const n=i.header.elementId.id===t.id;return n&&(i.header.elementId.id=e.id),n})),h}_buildGraphTransaction(e,t,i){e.nodesToInsert=[...e.nodesToAdd];const n=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,i),o=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,i);S(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();n&&this.publishEvent("deltaEvent",n),o&&this.publishEvent("deltaEvent",o),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,i,n,o){var s;const r={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},a=this._updateExistingChildrenDeprecated(e,null!==(s=null==t?void 0:t.content)&&void 0!==s?s:"",i.content,n,r);return this._addNewChildrenDeprecated(e,i,n,o,a,r)}_updateExistingChildrenDeprecated(e,t,i,n,o){if(e.children.length){const s=Object.assign({},n),r=t!==i;let a=e.children.length-1;for(;a>=0;){const l=e.children[a].range;if(l.offset<n.firstDiffLeft&&l.offset+l.span<n.firstDiffLeft||l.offset+l.span===n.firstDiffLeft&&l.validEndBoundary&&r);else if(t.length-l.offset<n.firstDiffRight)l.offset=i.length-t.length+l.offset,o.updatedNodes.push(e.children[a].id);else{l.offset<n.firstDiffLeft&&(s.firstDiffLeft=Math.min(l.offset,s.firstDiffLeft));const i=t.length-l.offset-l.span;i<n.firstDiffRight&&(s.firstDiffRight=Math.min(i,s.firstDiffRight));const r=e.children.splice(a,1);for(const e of r)o.removedNodes.push(e.id),e.retire()}a-=1}return{offset:s.firstDiffLeft,span:i.length-s.firstDiffRight-s.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._settings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,i,n,o,s){const r=(0,h.e)(t.content,i,f(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),o),a=[];for(const i of r){const o=new u(i,e);this._attachTextUnit(o),a.push(o),s.unreconciledContent.push(this._buildTile(e,o,t.content,n)),s.addedNodes.push(o.id)}return S(e,a),s}_emitParagraphDeltaUpdate(e,t,i,n,o){if(this._settings.paragraphDeltasEnabled){const s=(0,I.Gn)(i.oldTextInfo,e.range.offset,e.range.offset+e.range.span),r=(0,I.Gn)(i.newTextInfo,t.range.offset,t.range.offset+t.range.span);if(e.registered||this._emitParagraphAdd(i,e,n),void 0!==e.eventSeqId){e.eventSeqId+=1;const i=b(e,s,r,!!t.range.validEndBoundary,!!t.range.enforcedCompleteTileTextUnit,n,o,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,e.cachedWordCount);return e.cachedWordCount=i.wordCount,i}}}_emitParagraphDeltaAdd(e,t){if(this._settings.paragraphDeltasEnabled)for(const i of e.nodesToAdd)this._emitParagraphAdd(e,i,t)}_emitParagraphAdd(e,t,i){var n;if(t.registered)return void(this._settings.enableParagraphDeltasVerboseLogging&&(null===(n=this._logger)||void 0===n||n.info(539002012,"The node has been registered, skipping")));const o=this._settings.enableParagraphDeltasEmptyInitialTile,r=(0,I.Gn)(e.newTextInfo,t.range.offset,t.range.offset+t.range.span);t.eventSeqId=0;const a=e.tileNode.findPreviousChildNode(t),l=e.tileNode.findNextChildNode(t);if(this.publishEvent("nodeEvent",{tileNodeId:e.tileNode.id,id:t.id,content:o?Object.assign(Object.assign({},r),{content:""}):r,eventSeqId:t.eventSeqId,mutationChangeType:i,messageType:s.G.NewData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t),prevTileId:"#head#"===a?a:null==a?void 0:a.id,nextTileId:"#tail#"===l?l:null==l?void 0:l.id}),o){t.eventSeqId+=1;const e=b(t,void 0,r,!!t.range.validEndBoundary,!0,i,!1,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,0);this.publishEvent("deltaEvent",e)}t.registered=!0}_emitParagraphDeltaRetire(e,t){var i;if(this._settings.paragraphDeltasEnabled)for(const n of e.nodesToRetire)n.registered=!1,this.publishEvent("nodeEvent",{tileNodeId:e.tileNode.id,id:n.id,content:{content:""},eventSeqId:null!==(i=n.eventSeqId)&&void 0!==i?i:0,mutationChangeType:t,messageType:s.G.RemoveData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(n)})}getSpecifiedLocaleForNode(e){var t,i;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(i=e.parent)||void 0===i?void 0:i.specifiedLocale}}function S(e,t){if(t.length){const i=t[0].range.offset;if(e.children.length){let n=e.children.length-1,o=t;for(;n>=0;){if(i>e.children[n].range.offset){e.children.splice(n,0,...o),o=[];break}n-=1}o.length&&e.children.splice(0,0,...o)}else e.children=t}}function b(e,t,i,n,o,s,l,c,u,h,g){var p,m;const I=null!==(p=null==t?void 0:t.content)&&void 0!==p?p:"",C=i.content,S=a.CC(I,C);l&&(S.firstDiffLeft-=1);let b=!1;if(!n&&u!==d.fT.Phrase&&u!==c){const e=S.firstDiffLeft,t=C.length-S.firstDiffRight;b=-1!==f(u).findEndBoundary(C,e-1,t)}const T=new v.M(new _.a,h),E=null!=g?g:T.getWordCount(I),N=T.hasWordCountChanged(S,E,C,!0);let x,w=r.OD.Word;if(o?w=(0,y.d)(c):b?w=(0,y.d)(u):N.isWordCountChanged?n&&(w=(0,y.d)(c)):w=r.OD.Chars,c===d.fT.Paragraph&&u===d.fT.Sentence&&w!==r.OD.Paragraph){const e=S.firstDiffLeft,t=f(u),i=t.findBeginBoundary(C,e,0),n=t.findEndBoundary(C,e-1,C.length);x=[{position:i,length:(-1===n?C.length:n)-i,unit:r.OD.Sentence}]}return{textTileNode:e,oldTextInfo:t,newTextInfo:i,minDiffBounds:S,wordCount:N.wordCount,deltaUnit:w,mutationChangeType:s,invalidationRanges:x,wordBoundaries:null!==(m=N.wordBoundaries)&&void 0!==m?m:[]}}class T extends n.z{constructor(e,t,i){super(),this.id=e,this._settings=t,this._logger=i,this._cachedWordCount=0,this._cachedTiles=new Map,this.seqId=0,this._eventSeqId=0,this.children=[],this.childrenIdMap=new Map,this._disposed=!1,this.isForceRehydrationExpected=!1,this._republishTextTileDeltaEvent=e=>{this.publishEvent("textTileDeltaEvent",e)},this._republishTextTileNodeEvent=e=>{this.publishEvent("textTileNodeEvent",e)},this._wordCount=new _.a,this._wordCountDetector=new v.M(this._wordCount,this._settings),this._textTileNodeManager=new C(this._settings,this._logger),this._textTileNodeManager.subscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.subscribe("nodeEvent",this._republishTextTileNodeEvent),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetInternal()}get eventSeqId(){return this._eventSeqId}get cachedText(){var e;return null!==(e=this._cachedTextInfo)&&void 0!==e?e:{content:""}}get disposed(){return this._disposed}get previousNodeId(){return void 0===this.previousNode||"#head#"===this.previousNode?this.previousNode:this.previousNode.id}get nextNodeId(){return void 0===this.nextNode||"#tail#"===this.nextNode?this.nextNode:this.nextNode.id}resetInternal(){this._cachedTextInfo=void 0,this._cachedWordCount=0,this.documentModel=void 0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();this.children=[],this.childrenIdMap.clear(),this._invalidationDiffBounds=void 0}updateSettings(e){this._settings=e,this._wordCountDetector=new v.M(this._wordCount,this._settings),this._textTileNodeManager.updateSettings(e)}resetState(){if(this.resetInternal(),this.removeAllParagraphNodesFromAugloop(),!this._settings.enableOrchestration){const e={firstDiffLeft:0,firstDiffRight:0};this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:"",newText:"",minDiffBounds:e,maxDiffBounds:e,seqId:this.seqId,forceReflow:!0})}this.publishEvent("stateReset",{tileNodeId:this.id})}async dispose(){this.resetInternal(),this._textTileNodeManager.unsubscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.unsubscribe("nodeEvent",this._republishTextTileNodeEvent)}reconcile(e){var t,i,n,o,s,r,l,d,c;if(e.rehydrateCritiques&&e.idleReconcileTrigger&&!this.isForceRehydrationExpected)return;const u=null!==(i=null===(t=this._cachedTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"",h=e.text.content,g=a.CC(u,h);if(this.documentModel=e.documentModel,e.mutationWasTextReplacement&&(g.firstDiffLeft-=1),h!==u&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},g)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,g.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,g.firstDiffRight)),this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:null===(n=e.brokerOptions)||void 0===n?void 0:n.critiques,oldText:u,newText:h,minDiffBounds:g,maxDiffBounds:null!==(o=this._invalidationDiffBounds)&&void 0!==o?o:{firstDiffLeft:u.length,firstDiffRight:0},seqId:this.seqId,forceReflow:null!==(r=null===(s=e.brokerOptions)||void 0===s?void 0:s.forceReflow)&&void 0!==r?r:void 0!==(null===(l=e.brokerOptions)||void 0===l?void 0:l.critiques)}),h===u&&this.children.length>0&&(!e.rehydrateCritiques||e.optimizedRehydrationEnabled)){if(e.rehydrateCritiques){let t=this.children[0];for(const e of this.children)e.range.offset>t.range.offset&&(t=e);const i=(0,I.Gn)(e.text,t.range.offset,t.range.offset+t.range.span);this.publishEvent("paragraphDiff",{paragraph:t,textInfo:i,mutationChangeType:e.mutationChangeType})}return this._settings.enableOrchestration&&(e.forceTileDiffEmission||e.rehydrateCritiques)&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,newTextInfo:e.text,minDiffBounds:g,hasWordChanges:!1,cachedWordCount:this._cachedWordCount,cachedTiles:Array.from(this._cachedTiles.values()),mutationChangeType:e.mutationChangeType,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e.text),void(this._cachedTextInfo=e.text)}return this._reconcileState(e.text,g,null!==(d=e.rehydrateCritiques)&&void 0!==d&&d,e.mutationChangeType,null!==(c=e.mutationWasTextReplacement)&&void 0!==c&&c)}findPreviousChildNode(e){var t;const i=e.range.offset;for(const t of this.children)if(t!==e&&t.range.offset+t.range.span===i)return t;return"#head#"===this.previousNode?this.previousNode:null===(t=this.previousNode)||void 0===t?void 0:t.findLastChildNode()}findNextChildNode(e){var t;const i=e.range.offset+e.range.span;for(const t of this.children)if(t!==e&&t.range.offset===i)return t;return"#tail#"===this.nextNode?this.nextNode:null===(t=this.nextNode)||void 0===t?void 0:t.findFirstChildNode()}findLastChildNode(){let e;for(const t of this.children)(!e||t.range.offset>e.range.offset)&&(e=t);return e}findFirstChildNode(){let e;for(const t of this.children)(!e||t.range.offset<e.range.offset)&&(e=t);return e}_reconcileFormatting(e){var t;if(this._cachedTextInfo){if(!(0,I.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){const i=(0,I.FD)(this._cachedTextInfo,t.range.offset,t.range.offset+t.range.span),n=(0,I.FD)(e,t.range.offset,t.range.offset+t.range.span);(0,I.V8)(i,n)||this.publishEvent("formattingDiff",{paragraph:t,sourceType:o.p.ParagraphNode,data:n})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:o.p.TileNode,data:null!==(t=e.formattedRanges)&&void 0!==t?t:[]})}if(!(0,I.V8)(this._cachedTextInfo.objectReferences,e.objectReferences)||!(0,I.lX)(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of I._E)"objectReferences"!==e&&delete t[e];for(const e of this.children)this.publishEvent("formattingDiff",{paragraph:e,sourceType:o.p.ParagraphNode,data:t});this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:o.p.TileNode,data:t})}}}retire(){var e,t,i;this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:null!==(t=null===(e=this._cachedTextInfo)||void 0===e?void 0:e.content)&&void 0!==t?t:"",newText:"",minDiffBounds:this._invalidationDiffBounds,maxDiffBounds:this._invalidationDiffBounds,seqId:this.seqId,forceReflow:!0}),this._settings.enableOrchestration&&(this.publishEvent("removeTileNode",{tileNodeId:this.id}),this.removeAllParagraphNodesFromAugloop()),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),null===(i=this._logger)||void 0===i||i.debug(562057756,"Retire node",this.id)}removeAllParagraphNodesFromAugloop(){if(!this._settings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._settings.paragraphDeltasEnabled)for(const t of e)this.publishEvent("textTileNodeEvent",{tileNodeId:this.id,id:t,eventSeqId:this.seqId,mutationChangeType:o.Q.Code,messageType:s.G.RemoveData,specifiedLocale:this.specifiedLocale,documentModel:this.documentModel});else this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},mutationChangeType:o.Q.Code})}move(e){const t=this.id;return this.id=(0,c.h)(),this.publishEvent("brokerNodeChange",{oldNodeId:t,newNodeId:this.id}),this.documentModel=e,this.id}_reconcileState(e,t,i,n,s){const r=this.seqId+1,a=e.content;let l;if(this._settings.paragraphDeltasEnabled)l=!1,this._cachedWordCount=0;else if(this._settings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,a);l=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else l=this._reconcileWordCount(t,a);const d=this._textTileNodeManager.updateParagraphNodes(this,this._cachedTextInfo,e,t,r,n,s);if(this._reconcileParagraphs(d,r),this._settings.enableOrchestration&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,newTextInfo:e,minDiffBounds:t,cachedWordCount:this._cachedWordCount,mutationChangeType:n,hasWordChanges:l,graphTransaction:d,cachedTextInfo:this._cachedTextInfo,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e),this._cachedTextInfo=e,i||l||this._settings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._settings.enableOptimizedCallingPattern&&n!==o.Q.Code&&this.setIsForceRehydrationExpected(),this._settings.enableOrchestration){for(const e of d.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);d.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._settings.paragraphDeltasEnabled?d.removedNodes.length>0&&this.publishEvent("handleRemovedNodes",{tileNodeId:this.id,nodesToRetire:d.removedNodes}):this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:d,mutationChangeType:n,newTextInfo:e})}return this._resetInvalidationStateAndReturnTiles(d.unreconciledContent,r)}this.setIsForceRehydrationExpected()}setIsForceRehydrationExpected(){this._invalidationDiffBounds&&(this.isForceRehydrationExpected=!0)}clearIsForceRehydrationExpected(){this.isForceRehydrationExpected=!1}critiqueAction(e,t){return!this._settings.enableOrchestration&&(this.publishEvent("brokerProcessCritiqueAction",{tileNodeId:this.id,actionType:e,offset:t}),e===l.$w.ApplySuggestion&&this.reconcile({text:this.cachedText,mutationChangeType:o.Q.Local}),!0)}_reconcileWordCount(e,t){const i=this._wordCountDetector.getWordCount(t);let n=0;e.firstDiffLeft<=t.length&&(n=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const o=i>0&&(i!==this._cachedWordCount||n>1);return this._cachedWordCount=i,o}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,i]of this._cachedTiles){-1===this.children.findIndex((t=>t.id===e))?this._cachedTiles.delete(e):i.header.seqId=t.toString()}e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._settings.enableOptimizedCallingPattern||this.clearIsForceRehydrationExpected(),this._invalidationDiffBounds=void 0,this.seqId=t,e}registerChild(e){this.childrenIdMap.set(e.id,e),this.publishEvent("registerChildNode",{tileNodeId:this.id,childNodeId:e.id})}unregisterChild(e){this.childrenIdMap.delete(e.id),this.publishEvent("unregisterChildNode",{childNodeId:e.id})}getChildById(e){return this.childrenIdMap.get(e)}}var E=i(14251),N=i(96733);function x(e,t,i,n,o,s,a,l,d,c,u,h){var g;let p,m,f=0;const v=null!==(g=null==n?void 0:n.content)&&void 0!==g?g:"",_=o.content,y=s.firstDiffLeft,I=v.length-s.firstDiffRight,C=_.length-s.firstDiffRight,S=function(e,t,i,n,o){if(e===t)return r.WI.Update;if(i===o)return r.WI.Add;if(n===o)return r.WI.Delete;return r.WI.Update}(v.length,_.length,I,C,y);switch(S){case r.WI.Update:f=I-y,p=_.substring(y,C),m=v.substring(y,I);break;case r.WI.Add:f=0,p=_.substring(y,C);break;case r.WI.Delete:f=I-y,m=v.substring(y,I)}return{tileId:e,tileVersion:t,documentModel:i,delta:new E.s({deltaType:S,unit:l,position:y,length:f,content:p,wordCount:a,invalidationRanges:u,userInfo:{userType:L(c)}}),sourceType:d,changeType:c,deletedOrReplacedCharacters:m,tileText:_,wordBoundaries:h}}function w(e,t,i,n,r){var a,l,d;const c=null!==(a=e.graphTransaction)&&void 0!==a?a:{addedNodes:[],unreconciledContent:[],removedNodes:null!==(l=e.nodesToRetire)&&void 0!==l?l:[],updatedNodes:[]},u=null!==(d=e.mutationChangeType)&&void 0!==d?d:o.Q.Code,h=c.removedNodes.map((e=>({messageType:s.G.RemoveData,data:{tileId:e,tileVersion:t.eventSeqId,documentModel:n,changeType:u,isTextNode:!0,tile:void 0}})));return h.push(...c.unreconciledContent.map((o=>{const{prev:a,next:l}=function(e,t){const i=e.getChildById(t);if(!i)return{prev:void 0,next:void 0};const n=e.findPreviousChildNode(i),o=e.findNextChildNode(i);return{prev:"#head#"===n?n:null==n?void 0:n.id,next:"#tail#"===o?o:null==o?void 0:o.id}}(t,o.header.elementId.id);return{messageType:r&&!c.addedNodes.includes(o.header.elementId.id)?s.G.ChangeData:s.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:t.eventSeqId,documentModel:n,changeType:u,isTextNode:!0,tile:new N.Cg(Object.assign(Object.assign({},e.newTextInfo),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:i}]})),prevId:a,nextId:l}}}))),h}function L(e){switch(e){case o.Q.Local:return r.HS.SessionUser;case o.Q.Remote:return r.HS.Collaborator;default:return r.HS.Programmatic}}class D extends n.z{constructor(e,t){super(),this._settings=e,this._proofingLanguages=t,this._textTileNodes=new Map,this._tileRootNodeToTileNode=new Map,this._textTileNodeToRootNode=new Map,this._disposed=!1,this._brokerMoveEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerMove"},e))},this._brokerCritiqueActionEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerCritiqueAction"},e))},this._brokerReconcileEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerReconcile"},e))},this._removeTileNodeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i={tileId:e.tileNodeId,tileVersion:t.eventSeqId,documentModel:t.documentModel,changeType:o.Q.Code,isTextNode:!1,tile:void 0};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:i,messageType:s.G.RemoveData})},this._tileDiffEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i=function(e,t,i,n){var s,a;const l=null!==(s=e.graphTransaction)&&void 0!==s?s:{addedNodes:[],unreconciledContent:null!==(a=e.cachedTiles)&&void 0!==a?a:[],removedNodes:[],updatedNodes:[]};let c=r.OD.Chars;l.unreconciledContent.some((e=>e.textUnit===d.fT.Paragraph))?c=r.OD.Paragraph:l.unreconciledContent.some((e=>e.textUnit===d.fT.Sentence))?c=r.OD.Sentence:e.hasWordChanges&&(c=r.OD.Word);const u=l.unreconciledContent.map((e=>{var n;return{position:e.header.elementId.offset,length:e.header.elementId.span,unit:(0,y.d)(e.textUnit),languageId:null!==(n=t.specifiedLocale)&&void 0!==n?n:i}}));return x(e.tileNodeId,t.eventSeqId,n,e.cachedTextInfo,e.newTextInfo,e.minDiffBounds,e.cachedWordCount,c,o.p.TileNode,e.mutationChangeType,u)}(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},i))},this._paragraphDiffEventHandler=e=>{var t,i,n;const s=x(e.paragraph.id,null!==(t=e.paragraph.eventSeqId)&&void 0!==t?t:0,null===(i=e.paragraph.parent)||void 0===i?void 0:i.documentModel,e.textInfo,e.textInfo,{firstDiffLeft:e.paragraph.range.span,firstDiffRight:0},null!==(n=e.paragraph.cachedWordCount)&&void 0!==n?n:0,r.OD.Sentence,o.p.ParagraphNode,e.mutationChangeType);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},s))},this._paragraphNodeChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i=w(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableParagraphUpdates);this.publishEvent("tilingEvent",{messageName:"hostModelParagraphTextTiles",data:i})},this._formattingDiffEventHandler=e=>{var t,i,n;let o,s,a=0;if(e.tileNodeId){const i=this.getTileRootNodeById(e.tileNodeId);o=null==i?void 0:i.id,a=null!==(t=null==i?void 0:i.eventSeqId)&&void 0!==t?t:0,s=null==i?void 0:i.documentModel}if(!o&&e.paragraph&&(o=e.paragraph.id,a=null!==(i=e.paragraph.eventSeqId)&&void 0!==i?i:0,s=null===(n=e.paragraph.parent)||void 0===n?void 0:n.documentModel),!o)return;const l=function(e,t,i,n,o){return{tileId:e,tileVersion:t,documentModel:i,delta:Array.isArray(o)?new E.s({deltaType:r.WI.FormattingUpdate,formattedRanges:o}):new E.s({deltaType:r.WI.OtherNonContentUpdate,otherNonContentData:o}),sourceType:n}}(o,a,s,e.sourceType,e.data);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelFormattingDelta"},l))},this._textTileNodeEventHandler=e=>{const t=function(e,t){var i;return{tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:e.mutationChangeType,isTextNode:!0,tile:e.content?new N.Cg(Object.assign(Object.assign({},e.content),{formattedRanges:[...null!==(i=e.content.formattedRanges)&&void 0!==i?i:[],{start:0,length:e.content.content.length,languageId:t}]})):void 0,prevId:e.prevTileId,nextId:e.nextTileId}}(e,this._proofingLanguages.defaultLanguageCode);this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:e.messageType})},this._textTileDeltaEventHandler=e=>{var t,i;const n=x(e.textTileNode.id,null!==(t=e.textTileNode.eventSeqId)&&void 0!==t?t:0,null===(i=e.textTileNode.parent)||void 0===i?void 0:i.documentModel,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,o.p.ParagraphNode,e.mutationChangeType,e.invalidationRanges,e.wordBoundaries);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},n))},this._stateChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);t&&this._sendNewTextTileEvent(t),e.tileNodeId=this._tileRootNodeToTileNode.get(e.tileNodeId)||e.tileNodeId,this.publishEvent("stateReset",e)},this._handleRemovedNodesEventHandler=e=>{this.publishEvent("handleRemovedNodes",e)},this._registerChildNodeEventHandler=e=>{this._textTileNodeToRootNode.set(e.childNodeId,e.tileNodeId)},this._unregisterChildNodeEventHandler=e=>{this._textTileNodeToRootNode.delete(e.childNodeId)},this._sendNewTextTileEvent=e=>{const t={tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:o.Q.Code,isTextNode:!1,tile:void 0,prevId:e.previousNodeId,nextId:e.nextNodeId};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:s.G.NewData})},this._findTextTileNodeById=e=>{var t;const i=this._textTileNodeToRootNode.get(e);if(!i)return;const n=this._tileRootNodeToTileNode.get(i);return n?null===(t=this._textTileNodes.get(n))||void 0===t?void 0:t.getChildById(e):void 0}}get disposed(){return this._disposed}async dispose(){if(!this._disposed){for(const e of this._textTileNodes.values())e.unsubscribe("stateReset",this._stateChangeEventHandler),e.unsubscribe("removeTileNode",this._removeTileNodeEventHandler),e.unsubscribe("tileDiff",this._tileDiffEventHandler),e.unsubscribe("paragraphDiff",this._paragraphDiffEventHandler),e.unsubscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),e.unsubscribe("formattingDiff",this._formattingDiffEventHandler),e.unsubscribe("registerChildNode",this._registerChildNodeEventHandler),e.unsubscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),e.unsubscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),e.unsubscribe("brokerNodeChange",this._brokerMoveEventHandler),e.unsubscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),e.unsubscribe("brokerReconcile",this._brokerReconcileEventHandler),await e.dispose();this._textTileNodes.clear(),this._tileRootNodeToTileNode.clear(),this._disposed=!0}}setProofingLanguages(e){this._proofingLanguages=e;for(const e of this._textTileNodes.values())e.reconcile({text:e.cachedText,mutationChangeType:o.Q.Code})}updateSettings(e){this._settings=e;for(const e of this._textTileNodes.values())e.updateSettings(this._getTileRootNodeSettings())}async pushText(e,t){const i=[];for(const t of e){const e=this._getTileRootNodeForExternalId(t.tileNodeId);e.previousNode=this.getPreviousTileRootNode(t.previousNodeId),e.nextNode=this.getNextTileRootNode(t.nextNodeId);const n=e.reconcile(t);n&&i.push(...n)}if(0===i.length)return;const n=this._buildTilesToSend(i,this._proofingLanguages),o={messageType:t,data:{tiles:n,uxLanguage:this._proofingLanguages.defaultLanguageCode}};t!==s.G.RemoveData?this.publishEvent("tilesAvailable",o):this.publishEvent("clearTiles",n)}retireTileNode(e){const t=this._textTileNodes.get(e);t&&(t.retire(),this._textTileNodes.delete(e),this._tileRootNodeToTileNode.delete(t.id))}moveTileNode(e,t,i){const n=this._textTileNodes.get(e);if(!n)return;const o=n.documentModel,s=null!=i?i:o,r=n.id,a=n.move(s);this._textTileNodes.delete(e),this._tileRootNodeToTileNode.delete(r),this._textTileNodes.set(t,n),this._tileRootNodeToTileNode.set(a,t);const l=function(e,t,i,n,o,s,r,a,l){var d;return{oldTileId:e,newTileId:t,tileVersion:i,oldDocumentModel:a,newDocumentModel:l,tile:new N.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(d=n.formattedRanges)&&void 0!==d?d:[],{start:0,length:n.content.length,languageId:o}]})),prevId:s,nextId:r}}(a,r,n.eventSeqId,n.cachedText,this._proofingLanguages.defaultLanguageCode,n.previousNodeId,n.nextNodeId,o,s);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelMoveTextTile"},l))}_buildTilesToSend(e,t){const i=[];for(const n of e)for(const e of t.codesList)i.push(Object.assign(Object.assign({},n),{proofingLanguages:[e]}));return i}_getTileRootNodeForExternalId(e){let t=this._textTileNodes.get(e);if(!t){const i=this._tileRootNodeToTileNode.get(e);i&&(t=this._textTileNodes.get(i))}if(!t){const i=(0,c.h)();t=new T(i,this._getTileRootNodeSettings()),this._textTileNodes.set(e,t),this._tileRootNodeToTileNode.set(i,e),t.subscribe("stateReset",this._stateChangeEventHandler),t.subscribe("removeTileNode",this._removeTileNodeEventHandler),t.subscribe("tileDiff",this._tileDiffEventHandler),t.subscribe("paragraphDiff",this._paragraphDiffEventHandler),t.subscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),t.subscribe("formattingDiff",this._formattingDiffEventHandler),t.subscribe("textTileNodeEvent",this._textTileNodeEventHandler),t.subscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),t.subscribe("registerChildNode",this._registerChildNodeEventHandler),t.subscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),t.subscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),t.subscribe("brokerNodeChange",this._brokerMoveEventHandler),t.subscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),t.subscribe("brokerReconcile",this._brokerReconcileEventHandler),this._sendNewTextTileEvent(t)}return t}getTileRootNodeById(e){const t=this._tileRootNodeToTileNode.get(e);if(t)return this._textTileNodes.get(t)}getTileNodeId(e){return this._tileRootNodeToTileNode.get(e)}_getTileRootNodeSettings(){return Object.assign(Object.assign({},this._settings),{proofingLanguages:this._proofingLanguages.codesList})}getParagraphFinder(){return{findParagraph:e=>this._findTextTileNodeById(e),getParagraphText:e=>{const t=e.parent;if(!t)return;return t.cachedText.content.slice(e.range.offset,e.range.offset+e.range.span)},getParagraphTextForCritique:(e,t)=>{const i=e.parent;if(!i)return;const n=t.endNode?this._findTextTileNodeById(t.endNode.nodeId):e;if(!n)return;const o=t.endNode?n.range.offset+t.endNode.end:t.start+t.length,s=i.cachedText.content;if(n.parent===i)return s.substring(t.start,o).replace(/\u00A0/g," ");let r,a=s.substring(t.start)+"\n",l=i;do{if(r=l.nextNode,!r||"#tail#"===r)return;l=r;const e=l===n.parent,t=e?o:void 0,i=e?"":"\n";a+=l.cachedText.content.substring(0,t)+i}while(l!==n.parent);return a},isCritiqueInNode:(e,t)=>t.nodeId!==e.id&&!(t.start>=e.range.offset+e.range.span||e.range.offset>=t.start+t.length),getTileRootNodeById:e=>this.getTileRootNodeById(e),getTileNodeId:e=>this.getTileNodeId(e)}}async processTileCritiques(e){const t=this._tileRootNodeToTileNode.get(e.tileNodeId)||e.tileNodeId;for(const i of e.critiques)i.tileId&&(i.tileId.nodeId=t);this.publishEvent("critiquesAvailable",{tileNodeId:t,critiques:e.critiques,messageType:e.messageType})}getPreviousTileRootNode(e){return void 0===e||"#head#"===e?e:this._getTileRootNodeForExternalId(e)}getNextTileRootNode(e){return void 0===e||"#tail#"===e?e:this._getTileRootNodeForExternalId(e)}}},47375:(e,t,i)=>{i.d(t,{kK:()=>b});var n=i(23182),o=i(99724),s=i(14945),r=i(91430),a=i(70848),l=i(18349),d=i(48662),c=i(33767),u=i(23812),h=i(24111),g=i(17025),p=i(33727),m=i(59096),f=i(21203),v=i(17298),_=i(29906),y=i(83010),I=i(66008),C=i(27603),S=i(24835);const b=(0,v.f)("ITextProcessingControllerFactory"),T=(0,v.f)("ITextAugmentationProcessingControllerFactory");(0,v.f)("ITextProcessingControllerLegacyWrapper");let E=class{constructor(e,t,i,n,l,d,c,u,h,g,p,m){this.proofingEmitter=e,this.proofingDom=t,this._textProcessorCoreFactory=i,this._textAugmentationCoreFactory=n,this._hostModelSettings=l,this._textEventPublisher=d,this._hostEmitters=c,this._featureFlagsReader=u,this._hostSettings=h,this._paragraphDeltasEnabled=g,this._queryDetection=p,this._wordDictionary=m,this.handleTextChangeEvent=e=>{this.textProcessingController.pushText(e.data,e.messageType)},this.initializeTextProcessingController=()=>{const e=this._textProcessorCoreFactory();return e.subscribe("critiquesAvailable",this._critiquesAvailableHandler),e.subscribe("clearTiles",this._clearTilesHandler),e.subscribe("tilesAvailable",this._tilesAvailableHandler),e.subscribe("stateReset",this._tileStateResetHandler),e.subscribe("tilingEvent",this._tilingEventHandler),e.subscribe("handleRemovedNodes",this._handleRemovedNodesHandler),this.proofingDom.setTextProcessingParagraphFinder(e.getParagraphFinder()),e},this.initializeTextAugmentationCore=()=>{const e=this.textProcessingController.getParagraphFinder(),t=this._textAugmentationCoreFactory(e);return t.subscribe("critiquesReceived",this._onCritiquesReceived),t.subscribe("clearTiles",this._handleOnRemoveTiles),t.subscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),t},this._tilingEventHandler=async e=>this.textAugmentationController.processTilingMessage(e),this._tileStateResetHandler=e=>{for(const t of this._hostEmitters)t.emit(o.pD.hostModelTileStateReset,{address:void 0,message:e.tileNodeId})},this._handleOnRemoveTiles=e=>{const t=e.tiles.map((e=>({tileId:e.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0,languageId:""})));this.proofingEmitter.emit("critiqueEvent",{data:t,messageType:s.G.RemoveData})},this._onCritiquesReceived=e=>{if(e.tileId)return void this.textProcessingController.processTileCritiques({tileNodeId:e.tileId,critiques:e.critiques,messageType:0===e.critiques.length?s.G.RemoveData:s.G.ChangeData});const t=(0,r.PD)(e.critiques);for(const e of t.keys()){const i=t.get(e);this.textProcessingController.processTileCritiques({tileNodeId:e,critiques:null!=i?i:[],messageType:0===(null==i?void 0:i.length)?s.G.RemoveData:s.G.ChangeData})}},this._critiquesAvailableHandler=e=>{const t=this.proofingDom.findNode(e.tileNodeId);t&&this.proofingEmitter.emit("squiggleDataEvent",{messageType:e.messageType,data:{critiquesToElementsMap:[{elementId:e.tileNodeId,element:t.element,critiques:e.critiques.map(a.OE)}]}})},this._clearTilesHandler=e=>{this._handleOnRemoveTiles({tiles:e})},this._handleUserRevertedAutoCorrection=e=>{(0,S.yf)(e.critique,this._wordDictionary)},this._tilesAvailableHandler=async e=>{const{schedulerDefaultWaitingTime:t,schedulerDefaultWaitingTimeIncrement:i,schedulerDefaultMaxTime:n}=this._hostModelSettings;this._proofingTimeout&&(window.clearTimeout(this._proofingTimeout),this._proofingTimeout=void 0,this._timeoutLength||(this._timeoutLength=t),this._timeoutLength=Math.min(this._timeoutLength+i,n)),this._proofingTimeout=window.setTimeout((async()=>{this._timeoutLength=t,await this.textAugmentationController.processTilingMessage(Object.assign({messageName:"textTilesMessage"},e)),this._proofingTimeout=void 0}),this._timeoutLength)},this._onFeatureFlagsChanged=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},e),this._hostModelSettings),this._hostSettings),{paragraphDeltasEnabled:this._paragraphDeltasEnabled.check()});this.textProcessingController.updateSettings(t)},this._handleRemovedNodesHandler=e=>{if(this._queryDetection)for(const t of e.nodesToRetire)this._queryDetection.handleTileRemoved(t)}}async initialize(){this._textEventPublisher.subscribe("textChange",this.handleTextChangeEvent),this._featureFlagsReader.subscribe("flagsChanged",this._onFeatureFlagsChanged)}shutDown(){var e,t,i,n,o,s,r,a;this._textEventPublisher.unsubscribe("textChange",this.handleTextChangeEvent),this._featureFlagsReader.unsubscribe("flagsChanged",this._onFeatureFlagsChanged),null===(e=this._textAugmentationController)||void 0===e||e.unsubscribe("critiquesReceived",this._onCritiquesReceived),null===(t=this._textAugmentationController)||void 0===t||t.unsubscribe("clearTiles",this._handleOnRemoveTiles),null===(i=this._textProcessingController)||void 0===i||i.unsubscribe("critiquesAvailable",this._critiquesAvailableHandler),null===(n=this._textProcessingController)||void 0===n||n.unsubscribe("clearTiles",this._clearTilesHandler),null===(o=this._textProcessingController)||void 0===o||o.unsubscribe("tilesAvailable",this._tilesAvailableHandler),null===(s=this._textProcessingController)||void 0===s||s.unsubscribe("stateReset",this._tileStateResetHandler),null===(r=this._textProcessingController)||void 0===r||r.unsubscribe("tilingEvent",this._tilingEventHandler),null===(a=this._textProcessingController)||void 0===a||a.unsubscribe("handleRemovedNodes",this._handleRemovedNodesHandler)}setProofingLanguages(e){this.textProcessingController.setProofingLanguages(e)}async pushText(e,t){return this.textProcessingController.pushText(e,t)}get textProcessingController(){return this._textProcessingController||(this._textProcessingController=this.initializeTextProcessingController()),this._textProcessingController}get textAugmentationController(){return this._textAugmentationController||(this._textAugmentationController=this.initializeTextAugmentationCore()),this._textAugmentationController}};E=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,y.W)(l.o)),(0,n.__param)(1,(0,y.W)(p.w)),(0,n.__param)(2,(0,y.W)(b)),(0,n.__param)(3,(0,y.W)(T)),(0,n.__param)(4,(0,y.W)(g.k)),(0,n.__param)(5,(0,y.W)(m.n)),(0,n.__param)(6,(0,I.t)(o.zJ)),(0,n.__param)(7,(0,y.W)(d.c)),(0,n.__param)(8,(0,y.W)(c.n)),(0,n.__param)(9,(0,y.W)(u.H)),(0,n.__param)(10,(0,C.l)()),(0,n.__param)(10,(0,y.W)(h.J)),(0,n.__param)(11,(0,C.l)()),(0,n.__param)(11,(0,y.W)(f.s))],E)},14284:(e,t,i)=>{i.d(t,{n:()=>m});var n=i(23182),o=i(1297),s=i(51451),r=i(14945),a=i(88241),l=i(63526),d=i(18349),c=i(37053),u=i(29906),h=i(83010),g=i(8475),p=i(33727);let m=class{constructor(e,t,i,n,r){this._proofingStore=e,this._emitter=t,this.nodePoller=i,this.proofingDom=n,this._logger=r,this._proofingLanguages=new o.I(this._proofingStore.getDefaultValue(s.l.ProofingLanguages))}async initialize(){this._proofingLanguages=new o.I(await this._proofingStore.read(s.l.ProofingLanguages)),this._emitter.on("proofingLanguageChanged",(async e=>{this.switchProofingLanguage(e.data)}))}shutDown(){}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(536978383,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map((e=>e.resetState())),this.nodePoller.pollNodes(r.G.NewData,this.proofingDom.tileNodes,a.Q.Code,void 0,!0))}};m=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(l.K)),(0,n.__param)(1,(0,h.W)(d.o)),(0,n.__param)(2,(0,h.W)(g.G)),(0,n.__param)(3,(0,h.W)(p.w)),(0,n.__param)(4,(0,h.W)(c.g))],m)},8475:(e,t,i)=>{i.d(t,{G:()=>n});const n=(0,i(17298).f)("INodePoller")},23360:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(17298).f)("IPreOrderTraverser")},33727:(e,t,i)=>{i.d(t,{w:()=>n});const n=(0,i(17298).f)("IProofingDom")},15630:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(17298).f)("ITileNodeReader")},85579:(e,t,i)=>{i.d(t,{y:()=>s});var n=i(23182),o=i(29906);let s=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){var e;if(this._rootNodes.length){const t=[];for(t.push(...this._rootNodes);t.length;){const i=t.pop();yield i,(null===(e=null==i?void 0:i.children)||void 0===e?void 0:e.length)&&t.push(...i.children)}}yield}};s=(0,n.__decorate)([(0,o._)()],s)},79090:(e,t,i)=>{i.d(t,{D:()=>g});var n=i(23182),o=i(99724),s=i(5698),r=i(85579),a=i(37076),l=i(29906),d=i(27603),c=i(83010);function u(e,t){const i={nodeType:s.Z.TileNode,id:e.id,parent:t.parent,element:t.element,children:void 0,critiques:[],textFormattingInfo:e.cachedText,plainText:e.cachedText.content,pullText:()=>e.cachedText,retire:e.retire,resetState:e.resetState,reconcile:(t,i,n,o,s,r)=>e.reconcile({text:e.cachedText,mutationChangeType:t,rehydrateCritiques:o,forceTileDiffEmission:s,mutationWasTextReplacement:r,brokerOptions:{critiques:i,forceReflow:n}}),move:(t,n)=>(e.move(),i),critiqueAction:e.critiqueAction,getPreviousTileId:()=>e.previousNodeId,getNextTileId:()=>e.nextNodeId};return e.children.length>0&&(i.children=e.children.map((e=>h(e,i)))),i}function h(e,t){const i={nodeType:s.Z.ParagraphNode,id:e.id,element:e.range,parent:t,children:void 0,eventSeqId:e.eventSeqId,retire:e.retire,move:()=>(e.move(),i),resetState:()=>{}};return i}let g=class{constructor(e){this._hostEmitter=e,this._tileNodeDictionary={},this._terminalNodeDictionary={},this._paragraphNodeDictionary={},this._preOrderTraverser=new r.y}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){var t,i;const n=null!==(i=null!==(t=this.findParagraphNode(e))&&void 0!==t?t:this.findTileNode(e))&&void 0!==i?i:this.findTerminalNode(e);return n||(this.ensureCanFindNode()?this._iterateGraph(e):null)}findTileNode(e){var t;return null!==(t=this.findTileRootNode(e))&&void 0!==t?t:this._tileNodeDictionary[e]}get tileNodes(){return Object.values(this._tileNodeDictionary)}findParagraphNode(e){var t;return null!==(t=this.findTextTileNode(e))&&void 0!==t?t:this._paragraphNodeDictionary[e]}findTerminalNode(e){return this._terminalNodeDictionary[e]}addNode(e){var t;if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else{this._shadowGraph||(this._shadowGraph=new a.j),this._shadowGraph.rootNodes.push(e);const i=this._selectDictionary(e.nodeType);i&&(i[e.id]=e),null===(t=this._hostEmitter)||void 0===t||t.emit(o.pD.hostModelAddedRootNode,{address:void 0,message:e.id})}}removeNode(e){var t;if(!this.findNode(e.id))return;let i,n=!1;if(e.parent?i=e.parent.children:this._shadowGraph&&(i=this._shadowGraph.rootNodes,n=!0),n){const i=this._selectDictionary(e.nodeType);i&&delete i[e.id],null===(t=this._hostEmitter)||void 0===t||t.emit(o.pD.hostModelRemovedRootNode,{address:void 0,message:e.id})}!function(e,t){if(t){const i=t.indexOf(e);if(-1!==i)return t.splice(i,1),!0}}(e,i),e.retire()}async initialize(){}shutDown(){var e;this.retireAllShadowGraphRootNodes(),null===(e=this._shadowGraph)||void 0===e||e.clear()}_selectDictionary(e){switch(e){case s.Z.TileNode:return this._tileNodeDictionary;case s.Z.ParagraphNode:return this._paragraphNodeDictionary;case s.Z.TerminalNode:return this._terminalNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let i=t.next();for(;!i.done;){if(i.value&&i.value.id===e)return i.value;i=t.next()}return null}setTextProcessingParagraphFinder(e){this._paragraphFinder=e}findTileRootNode(e){if(!this._paragraphFinder)return null;const t=this.getTileNodeByTileRootNodeId(e),i=this._paragraphFinder.getTileRootNodeById(e);return i&&t?u(i,t):null}findTextTileNode(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.findParagraph(e);if(!t)return null;let i;if(t.parent){const e=this.getTileNodeByTileRootNodeId(t.parent.id);e&&(i=u(t.parent,e))}return h(t,i)}getTileNodeByTileRootNodeId(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.getTileNodeId(e);return t?this.findTileNode(t):null}};g=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.l)()),(0,n.__param)(0,(0,c.W)(o.M5))],g)},2563:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(23182),o=i(29906),s=i(5698);let r=class{isTileNode(e){return e.nodeType===s.Z.TileNode}reconcile(e,t,i,n,o,s,r){return e.reconcile(t,i,!!n,!!o,!!s,!!r)}critiques(e){return e.critiques}getPreviousTileId(e){return e.getPreviousTileId()}getNextTileId(e){return e.getNextTileId()}};r=(0,n.__decorate)([(0,o._)()],r)},17025:(e,t,i)=>{i.d(t,{k:()=>n});const n=(0,i(17298).f)("IHostModelSettings")},17999:(e,t,i)=>{if(i.d(t,{W:()=>o}),2063!=i.j)var n=i(41385);class o{constructor(e,t,i,o,s,r){this._observer=t,this.nodeType=e,this.id=null!=r?r:(0,n.h)(),this.children=i,this.element=o,this.parent=s}retire(){if(this._observer.disconnect(this.element),this.children)for(const e of this.children)e.retire();this.children=void 0}move(e,t){return this._observer.disconnect(this.element),this.id=(0,n.h)(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}}},20796:(e,t,i)=>{i.d(t,{q:()=>n,x:()=>o});const n=(0,i(17298).f)("IConditionalAttributeFilterFactory");class o{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach((i=>{t=t||i(e)})),!t}}},63373:(e,t,i)=>{if(i.d(t,{d:()=>s}),2063!=i.j)var n=i(63326);if(2063!=i.j)var o=i(94610);function s(e){switch(e){case n.fT.Word:return o.OD.Word;case n.fT.Sentence:return o.OD.Sentence;case n.fT.Paragraph:return o.OD.Paragraph;default:return o.OD.Sentence}}},8907:(e,t,i)=>{i.d(t,{C:()=>s});var n=i(23182),o=i(29906);let s=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const i=t.join(",");return e.querySelector(i)?Array.from(e.querySelectorAll(i)):[]}};s=(0,n.__decorate)([(0,o._)()],s)},61808:(e,t,i)=>{i.d(t,{h:()=>k});var n=i(23182);const o=(0,i(17298).f)("IChildElementFinderFactory");var s=i(10387),r=i(76487),a=i(71632),l=i(14945),d=i(88241),c=i(99724),u=i(33767),h=i(17025),g=i(88409),p=i(8475),m=i(74805),f=i(33727),v=i(95537),_=i(59096),y=i(78426),I=i(15630),C=i(5698),S=i(2479),b=i(29906),T=i(17999),E=i(41385);let N=class extends T.W{constructor(e,t,i,n,o,s,r,a){super(i,n,void 0,o,s,r),this._proofingDom=e,this._tileContent=t,this.nodeType=i,this._observer=n,this.element=o,this.parent=s,this._logger=a,this.children=[],this.id=(0,E.h)(),this._proofingDom.registerNode(this)}retire(){var e;this.parent=void 0,null===(e=this._logger)||void 0===e||e.debug(0,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){return this._proofingDom.unregisterNode(this),super.move(e,t),this._proofingDom.registerNode(this),this}resetState(e){}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,i,n,o,s){}get plainText(){return this.pullText().content}getPreviousTileId(){}getNextTileId(){}};N=(0,n.__decorate)([(0,b._)()],N);var x=i(40014);function w(e,t,i){if(e.spellcheck){const i=e.closest("[contenteditable=true]"),n=null==i?void 0:i.getAttribute("spellcheck"),o=e.getAttribute("spellcheck");return i?i.setAttribute("spellcheck","false"):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(i||e).setAttribute(t.editorSpellcheckAttribute,"true"),i=>{const s=i.closest("[contenteditable=true]");s?n?s.setAttribute("spellcheck",n):s.removeAttribute("spellcheck"):o?(e.setAttribute("spellcheck",o),e.spellcheck=!1):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(s||i).removeAttribute(t.editorSpellcheckAttribute)}}if(null==i?void 0:i.some((t=>t(e)))){return(e.closest("[contenteditable=true]")||e).setAttribute(t.editorSpellcheckAttribute,"true"),e=>{(e.closest("[contenteditable=true]")||e).removeAttribute(t.editorSpellcheckAttribute)}}return()=>{}}var L=i(83010),D=i(27603);let F=class{constructor(e,t,i,n,o,s,r,u,h,g,p,m,f,v){this._observerFactory=e,this._tileContent=t,this._proofingDom=i,this._nodePoller=n,this._tileNodeReader=o,this._settings=s,this._hostSettings=r,this._childElementsFinderFactory=u,this._hostEmitter=g,this._graphNodeFactory=p,this.shadowElementsStore=f,this.textEventPublisher=v,this.buildNode=(e,t,i,n)=>{var o,s;const r=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),u=new x.x(r,e,t,n),h=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),g=this._getNewTopology(u,h,u).map((e=>this.createTileNode(e,u)));u.children=g,u.documentModel=i;const p=w(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);return u.registerVisualizationRemovedCallback((()=>{const e=this._tileContent.getContainingElement(u);e&&p(e)})),((0,a.C)(e,"HTMLInputElement")||(0,a.C)(e,"HTMLTextAreaElement"))&&(null===(o=this.shadowElementsStore)||void 0===o||o.setCanvasElement(g[0].id,e)),r.onElementAdded=(e,t)=>{var i;u.element&&!u.element.contains(e)||this._nodePoller.pollNodes(l.G.NewData,null!==(i=u.children)&&void 0!==i?i:[],t,void 0,void 0,void 0,!this._hostSettings.enableOrchestration)},r.onElementChanged=(e,t,i,n)=>{this._nodePoller.pollNodes(l.G.ChangeData,this._getChildrenToReconcile(u,e),t,void 0,void 0,void 0,void 0,n)},r.onElementRemoved=(e,t)=>{var i;this._nodePoller.pollNodes(l.G.ChangeData,null!==(i=u.children)&&void 0!==i?i:[],t)},r.onVisualStateChanged=(e,t)=>{var i,n,o,s,r;if("StyleChange"!==t){if("Created"===t){const e=this._tileContent.getContainingElement(u);if(e){const t=w(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);u.registerRetireCallback((()=>{const e=this._tileContent.getContainingElement(u);e&&t(e)}))}}else u.visualizationWasRemoved();this._nodePoller.pollNodes(l.G.ChangeData,null!==(n=u.children)&&void 0!==n?n:[],d.Q.Code,void 0,!0,void 0,void 0);for(const e of null!==(o=u.children)&&void 0!==o?o:[])null===(s=this._hostEmitter)||void 0===s||s.emit(c.pD.hostModelVisualStateChange,{address:void 0,message:{tileId:e.id,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,created:"Created"===t}})}else null===(i=this.textEventPublisher)||void 0===i||i.publishTextStyleEvent()},this._nodePoller.pollNodes(l.G.NewData,u.children,null!==(s=this._graphNodeBuilderTerminalRule.initialContentChangeType)&&void 0!==s?s:d.Q.Code),u},this._getNewTopology=(e,t,i)=>e.element?t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter((e=>this._graphNodeBuilderTerminalRule.filters.every((t=>t(e,i,this._graphNodeBuilderTerminalRule))))):[],this._graphNodeBuilderTerminalRule=h.nodeMetaType,this._paragraphNodesBuilder=null==m?void 0:m(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_getChildrenToReconcile(e,t){return[...(e.children||[]).filter((e=>{var i,n;return null!==(n=null===(i=e.element)||void 0===i?void 0:i.contains(t))&&void 0!==n?n:!this._settings.narrowOnChangeReconciliation&&this._tileNodeReader.critiques(e).length}))]}createTileNode(e,t){const i=this._observerFactory(S.j.AttributeObserver),n=this._paragraphNodesBuilder&&this._graphNodeFactory?this._graphNodeFactory(C.Z.TileNode,i,e,t,void 0,this._paragraphNodesBuilder):new N(this._proofingDom,this._tileContent,C.Z.TileNode,i,e,t);return this._hostSettings.disableTileNodeObserver||(i.onElementChanged=(e,t)=>{this._nodePoller.pollNodes(l.G.NewData,[n],t)},i.observe(document.body)),n}};F=(0,n.__decorate)([(0,b._)(),(0,n.__param)(0,(0,L.W)(g.C)),(0,n.__param)(1,(0,L.W)(y.d)),(0,n.__param)(2,(0,L.W)(f.w)),(0,n.__param)(3,(0,L.W)(p.G)),(0,n.__param)(4,(0,L.W)(I.j)),(0,n.__param)(5,(0,L.W)(h.k)),(0,n.__param)(6,(0,L.W)(u.n)),(0,n.__param)(7,(0,L.W)(o)),(0,n.__param)(8,(0,L.W)(s.RW)),(0,n.__param)(9,(0,D.l)()),(0,n.__param)(9,(0,L.W)(c.M5)),(0,n.__param)(10,(0,D.l)()),(0,n.__param)(10,(0,L.W)(r.WP)),(0,n.__param)(11,(0,D.l)()),(0,n.__param)(11,(0,L.W)(m.u)),(0,n.__param)(12,(0,D.l)()),(0,n.__param)(12,(0,L.W)(v.S)),(0,n.__param)(13,(0,D.l)()),(0,n.__param)(13,(0,L.W)(_.n))],F);var A=i(25622),R=i(37053),q=i(68733),P=i(22894),O=i(43581);let k=class{constructor(e,t,i,n,o,s,r,a,l,d,c,u,h){this.hostSettings=e,this.proofingDom=t,this._settings=i,this._tileContent=n,this._tileNodeReader=o,this._nodePoller=s,this._textEventPublisher=r,this.targetDocumentFactory=a,this.logger=l,this._hostEmitter=d,this._graphNodeFactory=c,this._paragraphNodesBuilderFactory=u,this.shadowElementsStore=h}createGraphNode(e){const{element:t,filterSelector:i,parent:n,initialContentChangeType:o,documentModel:s,terminalNodeId:r}=e;if(!this._validateElementWithProofingDom(t))return;return this.getGraphNodeBuilderFactory(t,i,o).buildNode(t,n,s,r)}getGraphNodeBuilderFactory(e,t,i){const n=this.getObserverTypeBasedOnElement(e),o={ruleName:"",nodeMetaType:{nodeType:C.Z.TerminalNode,observerType:n,filters:[],filterSelector:t,initialContentChangeType:i},childMetaType:null};return new F(((e,t)=>function(e,t,i){const n=e=>new MutationObserver(e);switch(e){case S.j.InputNodeObserver:return new O.D(n,i);case S.j.TerminalNodeObserver:return new P.o(n,i);default:return new q.P(n,i)}}(e,0,this.logger)),this._tileContent,this.proofingDom,this._nodePoller,this._tileNodeReader,this._settings,this.hostSettings,(()=>({find:e=>[e]})),o,this._hostEmitter,this._graphNodeFactory,this._paragraphNodesBuilderFactory,this.shadowElementsStore,this._textEventPublisher)}getObserverTypeBasedOnElement(e){return(0,a.C)(e,"HTMLInputElement")||(0,a.C)(e,"HTMLTextAreaElement")?S.j.InputNodeObserver:S.j.TerminalNodeObserver}_validateElementWithProofingDom(e){var t,i,n,o;if(!(0,a.C)(e,"HTMLElement"))return!0;for(const i of this.proofingDom.tileNodes.values())if((0,a.C)(i.element,"HTMLElement")&&(i.element.contains(e)||e.contains(i.element)))return null===(t=this.logger)||void 0===t||t.error(508146704,"The element is already contained within another attached element."),!1;if(!this.hostSettings.doNotLimitToTargetDocument&&this.targetDocumentFactory){const t=null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref();if(t&&e.ownerDocument!==t)return null===(n=this.logger)||void 0===n||n.error(508146703,"The element must be within the target document."),!1}return!!((0,a.C)(e,"HTMLInputElement")&&["text","search"].includes(e.type)||(0,a.C)(e,"HTMLTextAreaElement")||e.isContentEditable)||(null===(o=this.logger)||void 0===o||o.error(508146702,"Unsupported element - only input (of type search and text only), textarea, and content editable elements are supported."),!1)}};k=(0,n.__decorate)([(0,b._)(),(0,n.__param)(0,(0,L.W)(u.n)),(0,n.__param)(1,(0,L.W)(f.w)),(0,n.__param)(2,(0,L.W)(h.k)),(0,n.__param)(3,(0,L.W)(y.d)),(0,n.__param)(4,(0,L.W)(I.j)),(0,n.__param)(5,(0,L.W)(p.G)),(0,n.__param)(6,(0,D.l)()),(0,n.__param)(6,(0,L.W)(_.i)),(0,n.__param)(7,(0,D.l)()),(0,n.__param)(7,(0,L.W)(A.Ze)),(0,n.__param)(8,(0,D.l)()),(0,n.__param)(8,(0,L.W)(R.g)),(0,n.__param)(9,(0,D.l)()),(0,n.__param)(9,(0,L.W)(c.M5)),(0,n.__param)(10,(0,D.l)()),(0,n.__param)(10,(0,L.W)(r.WP)),(0,n.__param)(11,(0,D.l)()),(0,n.__param)(11,(0,L.W)(m.u)),(0,n.__param)(12,(0,D.l)()),(0,n.__param)(12,(0,L.W)(v.S))],k)},79721:(e,t,i)=>{i.d(t,{m:()=>N});var n=i(23182),o=i(14945),s=i(99724),r=i(88241),a=i(1297),l=i(51451),d=i(63526),c=i(48662),u=i(37053),h=i(24111),g=i(96733),p=i(94610),m=i(14251),f=i(38583),v=i(33727),_=i(63326),y=i(5698),I=i(63373),C=i(39352),S=i(29906),b=i(66008),T=i(83010),E=i(27603);let N=class{constructor(e,t,i,n,o,s,r){this._hostEmitters=e,this._proofingStore=t,this._featureFlagReader=i,this._logger=n,this._proofingDom=o,this._queryDetection=s,this._nodeTraverser=r,this.tileTracked=new Set}emitTileEvent(e,t,i,n,r,a,l,d,c,u){var h,p;r===o.G.NewData?this.tileTracked.add(t):r===o.G.RemoveData&&(this.tileTracked.delete(t),null===(h=this._queryDetection)||void 0===h||h.handleTileRemoved(t));const m=(0,C.F)(e);for(const e of this._hostEmitters)e.emit(s.pD.hostModelTextTile,{address:void 0,message:{messageType:r,data:{tileId:t,tileVersion:n,documentModel:null==m?void 0:m.documentModel,changeType:a,isTextNode:l===y.Z.ParagraphNode,tile:i?new g.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(p=i.formattedRanges)&&void 0!==p?p:[],{start:0,length:i.content.length,languageId:null!=d?d:this.getProofingLanguage()}]})):void 0,prevId:c,nextId:u}}})}emitParagraphDiffEvent(e){this.tileTracked.has(e.paragraphNode.id)||this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(540915291,"Delta event sent when no parent tile node was created."),this.emitDiffEvent(e.paragraphNode,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,r.p.ParagraphNode,e.mutationChangeType,e.invalidationRanges)}emitTileDiffEvent(e,t,i,n,o,s,a,l,d){const c=a.unreconciledContent.some((e=>e.textUnit===_.fT.Paragraph))?p.OD.Paragraph:a.unreconciledContent.some((e=>e.textUnit===_.fT.Sentence))?p.OD.Sentence:o?p.OD.Word:p.OD.Chars,u=this.getProofingLanguage(),h=a.unreconciledContent.map((e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:(0,I.d)(e.textUnit),languageId:null!=d?d:u})));this.emitDiffEvent(e,t,i,n,s,c,r.p.TileNode,l,h)}emitMoveTileEvent(e,t,i,n,o,r,a,l,d){var c;for(const u of this._hostEmitters)u.emit(s.pD.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:n,oldDocumentModel:l,newDocumentModel:d,tile:new g.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(c=i.formattedRanges)&&void 0!==c?c:[],{start:0,length:i.content.length,languageId:null!=o?o:this.getProofingLanguage()}]})),prevId:r,nextId:a}})}emitParagraphNodeTileEvents(e,t,i,n){const r=(0,C.F)(e),a=t.removedNodes.map((t=>{var n;return{messageType:o.G.RemoveData,data:{tileId:t,tileVersion:null!==(n=e.eventSeqId)&&void 0!==n?n:0,documentModel:null==r?void 0:r.documentModel,changeType:i,isTextNode:!0,tile:void 0}}}));a.push(...t.unreconciledContent.map((s=>{var a,l,d;const c=this._proofingDom.findParagraphNode(s.header.elementId.id),u=c?null===(a=this._nodeTraverser)||void 0===a?void 0:a.findPreviousParagraphNode(c):void 0,h=c?null===(l=this._nodeTraverser)||void 0===l?void 0:l.findNextParagraphNode(c):void 0;return{messageType:this._featureFlagReader.flags.enableParagraphUpdates&&!t.addedNodes.includes(s.header.elementId.id)?o.G.ChangeData:o.G.NewData,data:{tileId:s.header.elementId.id,tileVersion:null!==(d=e.eventSeqId)&&void 0!==d?d:0,documentModel:null==r?void 0:r.documentModel,changeType:i,isTextNode:!0,tile:new g.Cg(Object.assign(Object.assign({},n),{content:s.data,formattedRanges:[{start:0,length:s.data.length,languageId:this.getProofingLanguage(s.proofingLanguages)}]})),prevId:"#head#"===u?u:null==u?void 0:u.id,nextId:"#tail#"===h?h:null==h?void 0:h.id}}})));for(const e of this._hostEmitters)e.emit(s.pD.hostModelParagraphTextTiles,{address:void 0,message:a})}getProofingLanguage(e){return a.I.getDefaultLanguageCode(null!=e?e:this._proofingStore.getCachedEntry(l.l.ProofingLanguages).storeEntryValue)}emitDiffEvent(e,t,i,n,o,a,l,d,c){var u,h,g;const f=null!==(u=null==t?void 0:t.content)&&void 0!==u?u:"",v=i.content,_=n.firstDiffLeft,y=f.length-n.firstDiffRight,I=v.length-n.firstDiffRight,S=f.length===v.length?p.WI.Update:y===_?p.WI.Add:I===_?p.WI.Delete:p.WI.Update;let b,T,E;switch(S){case p.WI.Update:b=y-_,T=v.substring(_,I),E=f.substring(_,y);break;case p.WI.Add:b=0,T=v.substring(_,I);break;case p.WI.Delete:b=y-_,E=f.substring(_,y)}let N=new m.s({deltaType:S,unit:a,position:_,length:b,content:T,wordCount:o,invalidationRanges:c,userInfo:{userType:d===r.Q.Local?p.HS.SessionUser:d===r.Q.Remote?p.HS.Collaborator:p.HS.Programmatic}});const x=l===r.p.ParagraphNode?null===(h=this._queryDetection)||void 0===h?void 0:h.handleTileDelta(e.id,N,v,d,E):void 0;N=Object.assign(Object.assign({},N),x);const w=(0,C.F)(e);for(const t of this._hostEmitters)t.emit(s.pD.hostModelDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(g=e.eventSeqId)&&void 0!==g?g:0,documentModel:null==w?void 0:w.documentModel,delta:N,sourceType:l,changeType:d,deletedOrReplacedCharacters:E}})}emitFormattingDiffEvent(e,t,i){var n;const o=(0,C.F)(e),r=Array.isArray(i)?new m.s({deltaType:p.WI.FormattingUpdate,formattedRanges:i}):new m.s({deltaType:p.WI.OtherNonContentUpdate,otherNonContentData:i});for(const i of this._hostEmitters)i.emit(s.pD.hostModelFormattingDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(n=e.eventSeqId)&&void 0!==n?n:0,documentModel:null==o?void 0:o.documentModel,delta:r,sourceType:t}})}};N=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.t)(s.zJ)),(0,n.__param)(1,(0,T.W)(d.K)),(0,n.__param)(2,(0,T.W)(c.c)),(0,n.__param)(3,(0,T.W)(u.g)),(0,n.__param)(4,(0,T.W)(v.w)),(0,n.__param)(5,(0,E.l)()),(0,n.__param)(5,(0,T.W)(h.J)),(0,n.__param)(6,(0,E.l)()),(0,n.__param)(6,(0,T.W)(f.M))],N)},97502:(e,t,i)=>{i.d(t,{V:()=>n});const n=(0,i(17298).f)("IElementsRetriever")},10387:(e,t,i)=>{i.d(t,{Bc:()=>o,RW:()=>s});var n=i(17298);const o=(0,n.f)("IGrammarTerminalSymbol"),s=(0,n.f)("IGrammarNonTerminalSymbolExpanded");(0,n.f)("IGrammarRules")},76487:(e,t,i)=>{i.d(t,{Om:()=>s,WP:()=>o,ZR:()=>r});var n=i(17298);const o=(0,n.f)("IGraphNodeFactory"),s=(0,n.f)("IParagraphNodeFactory");function r(e){return!!e&&"id"in e&&"nodeType"in e}},40634:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(17298).f)("IHostTilingEmitter")},88409:(e,t,i)=>{i.d(t,{C:()=>o,V:()=>s});var n=i(17298);const o=(0,n.f)("INodeObserverFactory"),s=(0,n.f)("IMutationObserverFactory")},38583:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(17298).f)("INodeTraverser")},55608:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(17298).f)("IParagraphFormattingExtractor")},74805:(e,t,i)=>{i.d(t,{W:()=>s,u:()=>o});var n=i(17298);const o=(0,n.f)("IParagraphNodesBuilderFactory"),s=(0,n.f)("IParagraphNodesBuilder")},67386:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(17298).f)("IParagraphNodesEventEmitter")},10968:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(17298).f)("IParagraphTextExtractor")},48903:(e,t,i)=>{i.d(t,{q:()=>n});const n=(0,i(17298).f)("IShadowGraphFactory")},60848:(e,t,i)=>{i.d(t,{l:()=>n});const n=(0,i(17298).f)("ITerminalNodeBuilder")},20831:(e,t,i)=>{if(i.d(t,{$:()=>o}),2063!=i.j)var n=i(5698);function o(e){return(null==e?void 0:e.nodeType)===n.Z.TileNode&&!!e.element&&!!e.children&&e.children.every((e=>e.nodeType===n.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element))}},2479:(e,t,i)=>{var n;i.d(t,{j:()=>n}),function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(n||(n={}))},5698:(e,t,i)=>{var n;i.d(t,{Z:()=>n}),function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(n||(n={}))},98402:(e,t,i)=>{i.d(t,{T:()=>a});var n=i(23182),o=i(17999),s=i(5698),r=i(29906);let a=class extends o.W{constructor(e,t,i,n,o){super(s.Z.OutlineNode,e,t,i,n,o),this._observer=e,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};a=(0,n.__decorate)([(0,r._)()],a)},88717:(e,t,i)=>{i.d(t,{C:()=>d});var n=i(23182),o=i(33727),s=i(7569),r=i(29906),a=i(83010),l=i(81174);let d=class{constructor(e){this._proofingDom=e}getFormattingAt(e,t=0,i=-1){let n=null;if(n="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,l.l)(n)){const e=n.parent.textFormattingInfo;if(e){const o=n.element.offset+t;return(0,s.FD)(e,o,i<0?o+n.element.span:o+i)}}}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.w))],d)},81174:(e,t,i)=>{i.d(t,{f:()=>l,l:()=>d});var n=i(23182),o=i(81168),s=i(83010),r=i(33727),a=i(5698);let l=class{constructor(e,t,i,n){this._guidGenerator=e,this._proofingDom=t,this.eventSeqId=0,this.nodeType=a.Z.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=i,this.parent=n,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};function d(e){var t;return(null==e?void 0:e.nodeType)===a.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element&&(null===(t=e.parent)||void 0===t?void 0:t.nodeType)===a.Z.TileNode&&!!e.parent.element&&!!e.parent.children}l=(0,n.__decorate)([(0,n.__param)(0,(0,s.W)(o.G)),(0,n.__param)(1,(0,s.W)(r.w))],l)},42038:(e,t,i)=>{i.d(t,{B:()=>a,Y:()=>r});var n=i(23182),o=i(17298),s=i(29906);const r=(0,o.f)("IParagraphNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,s._)()],a)},26094:(e,t,i)=>{i.d(t,{zR:()=>E});var n=i(23182),o=i(51451),s=i(14945),r=i(63526),a=i(33767),l=i(48662),d=i(23812),c=i(37053),u=i(17025),h=i(40634),g=i(38583),p=i(76487),m=i(67386),f=i(25359),v=i(5698),_=i(17298),y=i(29906),I=i(83010),C=i(27603),S=i(7569);const b=(0,_.f)("CompleteTileTextUnitToken"),T=(0,_.f)("PartialTileTextUnit");let E=class{constructor(e,t,i,n,o,s,r,a,l,d,c,u,h){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=i,this.settings=n,this._hostSettings=o,this._featureFlagReader=s,this._hostTilingEmitter=r,this._paragraphNodesEventEmitter=a,this._paragraphDeltasEnabled=l,this._logger=d,this.nodeTraverser=c,this._completeTileTextUnit=null!=u?u:n.completeTileTextUnit,this._partialTileTextUnit=null!=h?h:n.partialTileTextUnit}updateParagraphNodes(e,t,i,n,o,s,r){if(!this._hostSettings.enableOrchestration||!this._featureFlagReader.flags.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,i,n,o);const a={oldTextInfo:t,newTextInfo:i,tileNode:e,sequenceId:o,minDiffBounds:n,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(a),this._addNewChildren(a),this._buildGraphTransaction(a,s,r),a.graphTransaction}_updateExistingChildren(e){var t,i,n;if(!(null===(t=e.tileNode.children)||void 0===t?void 0:t.length))return;const o=null!==(n=null===(i=e.oldTextInfo)||void 0===i?void 0:i.content)&&void 0!==n?n:"",s=e.newTextInfo.content,r=o!==s,a={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let l=e.tileNode.children.length-1;for(;l>=0;){const t=e.tileNode.children[l].element;if(t){if(o.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=s.length-o.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!r)){t.offset<e.minDiffBounds.firstDiffLeft&&(a.firstDiffLeft=Math.min(t.offset,a.firstDiffLeft));const i=o.length-t.offset-t.span;i<e.minDiffBounds.firstDiffRight&&(a.firstDiffRight=Math.min(i,a.firstDiffRight));const n=e.tileNode.children.splice(l,1);e.nodesToRetire.length&&a.firstDiffRight!==i?a.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...n):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...n):e.nodesToRetire.push(...n)}l-=1}else l-=1}e.unitRange={offset:a.firstDiffLeft,span:s.length-a.firstDiffRight-a.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._hostSettings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e.newTextInfo.content,e.minDiffBounds,this._completeTileTextUnit,e.unitRange);for(const i of t){const t=this._graphNodeFactory(i,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.element&&(e.element.textUnit=!1===e.element.validEndBoundary&&this._hostSettings.enableOptimizedCallingPattern&&!0!==e.element.enforcedCompleteTileTextUnit?this._partialTileTextUnit:this._completeTileTextUnit)}_buildTile(e,t,i,n){var s,r,a,l,d;const c=null!==(r=null===(s=t.element)||void 0===s?void 0:s.offset)&&void 0!==r?r:0,u=null!==(l=null===(a=t.element)||void 0===a?void 0:a.span)&&void 0!==l?l:i.length;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:c,span:u},length:i.length},data:i.slice(c,c+u),proofingLanguages:this._proofingPersistedStore.getCachedEntry(o.l.ProofingLanguages).storeEntryValue,textUnit:null===(d=t.element)||void 0===d?void 0:d.textUnit}}_convertToUpdate(e,t,i,n,o,s){var r,a;if(!(null==e?void 0:e.element)||!(null==t?void 0:t.element))return;const l=null!==(a=null===(r=i.oldTextInfo)||void 0===r?void 0:r.content)&&void 0!==a?a:"",d=i.newTextInfo.content,c=l.length-e.element.offset-e.element.span,u=d.length-t.element.offset-t.element.span;if(!n&&e.element.offset!==t.element.offset||n&&c!==u)return;const h=this._emitParagraphDeltaUpdate(e,t,i,o,s);return e.element.offset=t.element.offset,e.element.span=t.element.span,e.element.validEndBoundary=t.element.validEndBoundary,e.element.enforcedCompleteTileTextUnit=t.element.enforcedCompleteTileTextUnit,e.element.textUnit=t.element.textUnit,t.retire(),i.nodesToAdd.splice(n?i.nodesToAdd.length-1:0,1),i.nodesToInsert.splice(n?i.nodesToInsert.length-1:0,1,e),i.nodesToRetire.splice(n?i.nodesToRetire.length-1:0,1),i.nodesToUpdate.push(e),i.graphTransaction.unreconciledContent.find((i=>{const n=i.header.elementId.id===t.id;return n&&(i.header.elementId.id=e.id),n})),h}_buildGraphTransaction(e,t,i){e.nodesToInsert=[...e.nodesToAdd];const n=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,i),o=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,i);N(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();n&&this._hostTilingEmitter.emitParagraphDiffEvent(n),o&&this._hostTilingEmitter.emitParagraphDiffEvent(o),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,i,n,o){var s;const r={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},a=this._updateExistingChildrenDeprecated(e,null!==(s=null==t?void 0:t.content)&&void 0!==s?s:"",i.content,n,r);return this._addNewChildrenDeprecated(e,i,n,o,a,r)}_updateExistingChildrenDeprecated(e,t,i,n,o){var s;if(null===(s=e.children)||void 0===s?void 0:s.length){const s=Object.assign({},n),r=t!==i;let a=e.children.length-1;for(;a>=0;){const l=e.children[a].element;if(l)if(l.offset<n.firstDiffLeft&&l.offset+l.span<n.firstDiffLeft||l.offset+l.span===n.firstDiffLeft&&l.validEndBoundary&&r);else if(t.length-l.offset<n.firstDiffRight)l.offset=i.length-t.length+l.offset,o.updatedNodes.push(e.children[a].id);else{l.offset<n.firstDiffLeft&&(s.firstDiffLeft=Math.min(l.offset,s.firstDiffLeft));const i=t.length-l.offset-l.span;i<n.firstDiffRight&&(s.firstDiffRight=Math.min(i,s.firstDiffRight));const r=e.children.splice(a,1);for(const e of r)o.removedNodes.push(e.id),e.retire()}a-=1}return{offset:s.firstDiffLeft,span:i.length-s.firstDiffRight-s.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._hostSettings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,i,n,o,s){const r=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t.content,i,this._completeTileTextUnit,o),a=[];for(const i of r){const o=this._graphNodeFactory(i,e);this._attachTextUnit(o),a.push(o),s.unreconciledContent.push(this._buildTile(e,o,t.content,n)),s.addedNodes.push(o.id)}return N(e,a),s}_emitParagraphDeltaUpdate(e,t,i,n,o){if(this._paragraphDeltasEnabled.check()){if(!e.element||!t.element)return;const s=(0,S.Gn)(i.oldTextInfo,e.element.offset,e.element.offset+e.element.span),r=(0,S.Gn)(i.newTextInfo,t.element.offset,t.element.offset+t.element.span);if(e.registered||this._emitParagraphAdd(i,e,n),void 0!==e.eventSeqId){e.eventSeqId+=1;const i=this._paragraphNodesEventEmitter.generateDeltaEventInformation(e,s,r,!!t.element.validEndBoundary,!!t.element.enforcedCompleteTileTextUnit,n,o,e.cachedWordCount);return e.cachedWordCount=i.wordCount,i}}}_emitParagraphDeltaAdd(e,t){if(this._paragraphDeltasEnabled.check())for(const i of e.nodesToAdd)this._emitParagraphAdd(e,i,t)}_emitParagraphAdd(e,t,i){var n,o;if(t.registered)return void(this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.info(539002012,"The node has been registered, skipping"));const r=this._featureFlagReader.flags.enableParagraphDeltasEmptyInitialTile;if(t.element){const a=(0,S.Gn)(e.newTextInfo,t.element.offset,t.element.offset+t.element.span);t.eventSeqId=0;const l=null===(n=this.nodeTraverser)||void 0===n?void 0:n.findPreviousParagraphNode(t),d=null===(o=this.nodeTraverser)||void 0===o?void 0:o.findNextParagraphNode(t);this._hostTilingEmitter.emitTileEvent(e.tileNode,t.id,r?Object.assign(Object.assign({},a),{content:""}):a,t.eventSeqId,s.G.NewData,i,v.Z.ParagraphNode,this.getSpecifiedLocaleForNode(t),"#head#"===l?l:null==l?void 0:l.id,"#tail#"===d?d:null==d?void 0:d.id),r&&(t.eventSeqId+=1,this._hostTilingEmitter.emitParagraphDiffEvent(this._paragraphNodesEventEmitter.generateDeltaEventInformation(t,void 0,a,!!t.element.validEndBoundary,!0,i,!1,0))),t.registered=!0}else this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(539002013,"Anchor element is undefined for the node to add")}_emitParagraphDeltaRetire(e,t){var i;if(this._paragraphDeltasEnabled.check())for(const n of e.nodesToRetire)n.registered=!1,this._hostTilingEmitter.emitTileEvent(e.tileNode,n.id,{content:""},null!==(i=n.eventSeqId)&&void 0!==i?i:0,s.G.RemoveData,t,v.Z.ParagraphNode,this.getSpecifiedLocaleForNode(n))}getSpecifiedLocaleForNode(e){var t,i;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(i=e.parent)||void 0===i?void 0:i.specifiedLocale}};function N(e,t){if(t.length&&e.children&&t[0].element){const i=t[0].element.offset;if(e.children.length){let n=e.children.length-1,o=t;for(;n>=0;){const t=e.children[n].element;if(t&&i>t.offset){e.children.splice(n,0,...o),o=[];break}n-=1}o.length&&e.children.splice(0,0,...o)}else e.children=t}}E=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,I.W)(r.K)),(0,n.__param)(1,(0,I.W)(p.Om)),(0,n.__param)(2,(0,I.W)(f.D)),(0,n.__param)(3,(0,I.W)(u.k)),(0,n.__param)(4,(0,I.W)(a.n)),(0,n.__param)(5,(0,I.W)(l.c)),(0,n.__param)(6,(0,I.W)(h.d)),(0,n.__param)(7,(0,I.W)(m.b)),(0,n.__param)(8,(0,I.W)(d.H)),(0,n.__param)(9,(0,I.W)(c.g)),(0,n.__param)(10,(0,I.W)(g.M)),(0,n.__param)(10,(0,C.l)()),(0,n.__param)(11,(0,C.l)()),(0,n.__param)(11,(0,I.W)(b)),(0,n.__param)(12,(0,C.l)()),(0,n.__param)(12,(0,I.W)(T))],E)},74491:(e,t,i)=>{i.d(t,{S:()=>g});var n=i(23182),o=i(17025),s=i(63995),r=i(25359),a=i(63326),l=i(3661),d=i(94610),c=i(63373),u=i(29906),h=i(83010);let g=class{constructor(e,t,i){this._wordCountDetector=e,this._hostModelSettings=t,this._textUnitChunker=i}generateDeltaEventInformation(e,t,i,n,o,s,r,u){var h;const g=null!==(h=null==t?void 0:t.content)&&void 0!==h?h:"",p=i.content,m=l.CC(g,p);r&&(m.firstDiffLeft-=1);let f=!1;if(!n&&this._hostModelSettings.partialTileTextUnit!==a.fT.Phrase&&this._hostModelSettings.partialTileTextUnit!==this._hostModelSettings.completeTileTextUnit){const e=m.firstDiffLeft,t=p.length-m.firstDiffRight;f=-1!==this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit).findEndBoundary(p,e-1,t)}const v=null!=u?u:this._wordCountDetector.getWordCount(g),_=this._wordCountDetector.hasWordCountChanged(m,v,p),y=o?(0,c.d)(this._hostModelSettings.completeTileTextUnit):f?(0,c.d)(this._hostModelSettings.partialTileTextUnit):_.isWordCountChanged?n?(0,c.d)(this._hostModelSettings.completeTileTextUnit):d.OD.Word:d.OD.Chars;let I;if(this._hostModelSettings.completeTileTextUnit===a.fT.Paragraph&&this._hostModelSettings.partialTileTextUnit===a.fT.Sentence&&y!==d.OD.Paragraph){const e=m.firstDiffLeft,t=this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit),i=t.findBeginBoundary(p,e,0),n=t.findEndBoundary(p,e-1,p.length);I=[{position:i,length:(-1===n?p.length:n)-i,unit:d.OD.Sentence}]}return{paragraphNode:e,oldTextInfo:t,newTextInfo:i,minDiffBounds:m,wordCount:_.wordCount,deltaUnit:y,mutationChangeType:s,invalidationRanges:I}}};g=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(s.B)),(0,n.__param)(1,(0,h.W)(o.k)),(0,n.__param)(2,(0,h.W)(r.D))],g)},71389:(e,t,i)=>{i.d(t,{o:()=>c});var n=i(23182),o=i(38583),s=i(33727),r=i(29906),a=i(83010),l=i(27603),d=i(81174);let c=class{constructor(e,t){this._proofingDom=e,this._tileNodeTraverser=t}getParagraphText(e){let t=null;if(t="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,d.l)(t)){const e=t.parent.plainText,i=t.element.offset,n=t.element.span,o=t.element.span?i+n:void 0;return e.substring(i,o).replace(/\u00A0/g," ")}}getQueryString(e,t,i){const n=this.getParagraphText(e);if(!n)return 0===t.start&&0===t.length&&""===t.prefix?"":void 0;return n.substring(t.start+(i?0:void 0===t.prefix?1:t.prefix.length),t.start+t.length)}getTextBetween(e,t,i=0,n=-1){var o;let s=null;s="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let r=null;if(r="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,d.l)(s)&&(0,d.l)(r)){if(s.parent.element===r.parent.element)return this.getSubsetOfParagraph(s.parent,s.element.offset+i,r.element.offset+(-1===n?r.element.span:n));{let e,t=this.getSubsetOfParagraph(s.parent,s.element.offset+i,void 0)+"\n",a=s.parent;do{if(e=null===(o=this._tileNodeTraverser)||void 0===o?void 0:o.findNextTileNode(a),!e||"#tail#"===e)return;a=e,t+=this.getSubsetOfParagraph(a,0,a.id===r.parent.id?r.element.offset+(-1===n?r.element.span:n):void 0)+(a.id===r.parent.id?"":"\n")}while(a.id!==r.parent.id);return t}}}getSubsetOfParagraph(e,t,i){return e.plainText.substring(t,i).replace(/\u00A0/g," ")}};c=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.w)),(0,n.__param)(1,(0,a.W)(o.M)),(0,n.__param)(1,(0,l.l)())],c)},37076:(e,t,i)=>{i.d(t,{j:()=>s});var n=i(23182),o=i(29906);let s=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}clear(){this._contexts=[]}};s=(0,n.__decorate)([(0,o._)()],s)},95706:(e,t,i)=>{i.d(t,{h:()=>g});var n=i(23182),o=i(33767),s=i(25719),r=i(37053),a=i(59096),l=i(15630),d=i(39352),c=i(29906),u=i(83010),h=i(27603);let g=class{constructor(e,t,i,n,o){this._tileNodeReader=e,this._hostSettings=t,this._optimizedRehydrationEnabled=i,this._logger=n,this._textEventPublisher=o}pollNodes(e,t,i,n,o,s,r,a){var l,c,u,h;if(this._textEventPublisher&&!0===this._hostSettings.sdkV2Enabled){const n=[];for(const e of t)if(this._tileNodeReader.isTileNode(e))try{const t=(0,d.F)(e);n.push({text:e.pullText(),mutationChangeType:i,tileNodeId:e.id,rehydrateCritiques:o,forceTileDiffEmission:r,mutationWasTextReplacement:a,documentModel:null==t?void 0:t.documentModel,previousNodeId:this._tileNodeReader.getPreviousTileId(e),nextNodeId:this._tileNodeReader.getNextTileId(e),optimizedRehydrationEnabled:this._optimizedRehydrationEnabled.check(),brokerOptions:{critiques:null==s?void 0:s.get(e.id),forceReflow:!0}})}catch(e){null===(c=this._logger)||void 0===c||c.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(l=this._logger)||void 0===l||l.error(0,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack});this._textEventPublisher.publishTextChangeEvent(n,e)}else for(const e of t)if(this._tileNodeReader.isTileNode(e))try{this._tileNodeReader.reconcile(e,i,null==s?void 0:s.get(e.id),!0,o,r,a)}catch(e){null===(h=this._logger)||void 0===h||h.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(u=this._logger)||void 0===u||u.error(509727256,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack})}removeQueuedTiles(e){}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(l.j)),(0,n.__param)(1,(0,u.W)(o.n)),(0,n.__param)(2,(0,u.W)(s.W)),(0,n.__param)(3,(0,h.l)()),(0,n.__param)(3,(0,u.W)(r.g)),(0,n.__param)(4,(0,h.l)()),(0,n.__param)(4,(0,u.W)(a.n))],g)},40014:(e,t,i)=>{i.d(t,{x:()=>a});var n=i(23182),o=i(29906),s=i(17999),r=i(5698);let a=class extends s.W{constructor(e,t,i,n){super(r.Z.TerminalNode,e,void 0,t,i,n),this._observer=e,this.retiredCallbacks=[],this.visualizationRemovedCallbacks=[],this.element&&this._observer.observe(this.element)}retire(){for(const e of this.retiredCallbacks)e();this.retiredCallbacks=[],this.visualizationWasRemoved(),super.retire()}move(e,t){if(super.move(e,t),this.children)for(const t of this.children)t.move(e);return this.element&&this._observer.observe(this.element),this}resetState(){}registerRetireCallback(e){this.retiredCallbacks.push(e)}registerVisualizationRemovedCallback(e){this.visualizationRemovedCallbacks.push(e)}visualizationWasRemoved(){for(const e of this.visualizationRemovedCallbacks)e();this.visualizationRemovedCallbacks=[]}};a=(0,n.__decorate)([(0,o._)()],a)},88094:(e,t,i)=>{i.d(t,{h:()=>a,k:()=>r});var n=i(23182),o=i(17298),s=i(29906);const r=(0,o.f)("ITerminalNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,s._)()],a)},27846:(e,t,i)=>{i.d(t,{b:()=>m});var n=i(23182),o=i(14945),s=i(88241),r=i(99724),a=i(3661),l=i(63318),d=i(29906),c=i(17999),u=i(5698),h=i(94610),g=i(7569),p=i(39352);let m=class extends c.W{constructor(e,t,i,n,r,a,l,d,c,h,g,p,m,f,v,_,y,I,C,S,b,T){super(f,v,void 0,y,S,b),this._guidGenerator=e,this._logger=t,this._wordCount=i,this._wordCountDetector=n,this._settings=r,this._nodePoller=a,this._proofingDom=d,this._tileContent=c,this._hostSettings=h,this._paragraphDeltasEnabled=g,this._optimizedRehydrationEnabled=p,this._hostTilingEmitter=m,this.nodeType=f,this._observer=v,this._paragraphNodesBuilder=_,this.element=y,this._hostEmitters=I,this.nodeTraverser=C,this.parent=S,this.queryDetection=T,this.children=[],this._cachedWordCount=0,this._cachedTiles=new Map,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetState(!0),this._hostSettings.enableOrchestration||(this._critiquesBroker=null==l?void 0:l(this.id,this.element)),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,o.G.NewData,s.Q.Code,u.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}getPreviousTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}retire(){var e,t,i;this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},null===(e=this._critiquesBroker)||void 0===e||e.reconcile(void 0,null!==(i=null===(t=this._cachedTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"","",this._invalidationDiffBounds,this._invalidationDiffBounds,this._seqId,!0),this._hostSettings.enableOrchestration&&(this._hostTilingEmitter.emitTileEvent(this,this.id,void 0,this._eventSeqId,o.G.RemoveData,s.Q.Code,u.Z.TileNode,this.specifiedLocale),this.removeAllParagraphNodesFromAugloop()),this.parent=void 0,this._cachedTextInfo=void 0,this._currentText=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._logger.debug(562057756,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}removeAllParagraphNodesFromAugloop(){if(!this._hostSettings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._paragraphDeltasEnabled.check())for(const t of e)this._hostTilingEmitter.emitTileEvent(this,t,void 0,this._eventSeqId,o.G.RemoveData,s.Q.Code,u.Z.ParagraphNode,this.specifiedLocale);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},s.Q.Code,void 0)}move(e,t){var i,n;const o=(0,p.F)(this),s=(0,p.F)(null!=t?t:this);this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const r=this.id;return super.move(e,t),null===(i=this._critiquesBroker)||void 0===i||i.move(r,this.id),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(r,this.id,null!==(n=this._cachedTextInfo)&&void 0!==n?n:{content:""},this._eventSeqId,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId(),null==o?void 0:o.documentModel,null==s?void 0:s.documentModel),this._proofingDom.registerNode(this),this}resetState(e){e||this.removeAllParagraphNodesFromAugloop(),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();if(this.children=[],this._invalidationDiffBounds=void 0,!e){if(this._critiquesBroker){const e={firstDiffLeft:0,firstDiffRight:0};this._critiquesBroker.reconcile(void 0,"","",e,e,this._seqId,!0)}for(const e of this._hostEmitters)e.emit(r.pD.hostModelTileStateReset,{address:void 0,message:this.id});this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,o.G.NewData,s.Q.Code,u.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,i,n,o,s){var r,l,d,c,u,p,m;if(this.parent){const f=null!==(r=this._tileContent.getText(this))&&void 0!==r?r:{content:""},v=null!==(d=null===(l=this._cachedTextInfo)||void 0===l?void 0:l.content)&&void 0!==d?d:"",_=f.content;this._currentText=f;const y=a.CC(v,_);if(s&&(y.firstDiffLeft-=1),_!==v&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},y)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,y.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,y.firstDiffRight)),this._critiquesBroker&&this._critiquesBroker.reconcile(t,v,_,y,null!==(c=this._invalidationDiffBounds)&&void 0!==c?c:{firstDiffLeft:v.length,firstDiffRight:0},this._seqId,null!=i?i:void 0!==t),_===v&&this.children.length>0&&(!n||this._optimizedRehydrationEnabled.check())){if(n){let t=this.children[0];for(const e of this.children)e.element&&e.element.offset>(null!==(p=null===(u=t.element)||void 0===u?void 0:u.offset)&&void 0!==p?p:0)&&(t=e);if(t.element){const i=(0,g.Gn)(f,t.element.offset,t.element.offset+t.element.span);this._hostTilingEmitter.emitParagraphDiffEvent({paragraphNode:t,oldTextInfo:i,newTextInfo:i,minDiffBounds:{firstDiffLeft:t.element.span,firstDiffRight:0},wordCount:null!==(m=t.cachedWordCount)&&void 0!==m?m:0,deltaUnit:h.OD.Sentence,mutationChangeType:e,invalidationRanges:void 0})}}return this._hostSettings.enableOrchestration&&(o||n)&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,f,y,!1,this._cachedWordCount,{addedNodes:[],removedNodes:[],updatedNodes:[],unreconciledContent:Array.from(this._cachedTiles.values())},e,this.specifiedLocale)),this._reconcileFormatting(f),void(this._cachedTextInfo=f)}return this._reconcileState(f,y,null!=n&&n,e,null!=s&&s)}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId)}get critiques(){var e,t;return null!==(t=null===(e=this._critiquesBroker)||void 0===e?void 0:e.critiques)&&void 0!==t?t:[]}critiqueAction(e,t){return!!this._critiquesBroker&&(this._critiquesBroker.critiqueAction(e,t),e===l.$w.ApplySuggestion&&this.reconcile(s.Q.Local),!0)}get textFormattingInfo(){return this._currentText}_reconcileState(e,t,i,n,o){var r;const a=this._seqId+1,l=e.content;let d;if(this._paragraphDeltasEnabled.check())d=!1,this._cachedWordCount=0;else if(this._hostSettings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,l);d=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else d=this._reconcileWordCount(t,l);const c=this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedTextInfo,e,t,a,n,o);if(this._reconcileParagraphs(c,a),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,e,t,d,this._cachedWordCount,c,n,this.specifiedLocale)),this._reconcileFormatting(e),this._cachedTextInfo=e,i||d||this._hostSettings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._hostSettings.enableOptimizedCallingPattern&&n!==s.Q.Code&&this._tryScheduleReconcileTimer(),this._hostSettings.enableOrchestration){for(const e of c.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);if(c.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._paragraphDeltasEnabled.check())for(const e of c.removedNodes)null===(r=this.queryDetection)||void 0===r||r.handleTileRemoved(e);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,c,n,e)}return this._resetInvalidationStateAndReturnTiles(c.unreconciledContent,a)}this._tryScheduleReconcileTimer()}_reconcileFormatting(e){var t;if(this._cachedTextInfo){if(!(0,g.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){if(!t.element)continue;const i=(0,g.FD)(this._cachedTextInfo,t.element.offset,t.element.offset+t.element.span),n=(0,g.FD)(e,t.element.offset,t.element.offset+t.element.span);(0,g.V8)(i,n)||this._hostTilingEmitter.emitFormattingDiffEvent(t,s.p.ParagraphNode,n)}this._hostTilingEmitter.emitFormattingDiffEvent(this,s.p.TileNode,null!==(t=e.formattedRanges)&&void 0!==t?t:[])}if(!(0,g.V8)(this._cachedTextInfo.objectReferences,e.objectReferences)||!(0,g.lX)(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of g._E)"objectReferences"!==e&&delete t[e];for(const e of this.children)e.element&&this._hostTilingEmitter.emitFormattingDiffEvent(e,s.p.ParagraphNode,t);this._hostTilingEmitter.emitFormattingDiffEvent(this,s.p.TileNode,t)}}}_reconcileWordCount(e,t){const i=this._wordCountDetector.getWordCount(t);let n=0;e.firstDiffLeft<=t.length&&(n=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const o=i>0&&(i!==this._cachedWordCount||n>1);return this._cachedWordCount=i,o}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,i]of this._cachedTiles){this._proofingDom.findParagraphNode(e)?i.header.seqId=t.toString():this._cachedTiles.delete(e)}e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds)&&(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout((()=>{this._logger.debug(562057757,"Dirty range timer has fired."),this._nodePoller.pollNodes(o.G.NewData,[this],s.Q.Code,void 0,!0),this._clearReconcileTimer()}),this._settings.reconcileTileNodeTime),!0)}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(562057758,"Dirty range timer has been cleared."))}get eventSeqId(){return this._eventSeqId}get plainText(){var e,t;return null!==(t=null===(e=this._currentText)||void 0===e?void 0:e.content)&&void 0!==t?t:""}};m=(0,n.__decorate)([(0,d._)()],m)},38310:(e,t,i)=>{i.d(t,{o:()=>r,v:()=>a});var n=i(23182),o=i(17298),s=i(29906);const r=(0,o.f)("ITileNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,s._)()],a)},46928:(e,t,i)=>{i.d(t,{j:()=>p});var n=i(23182),o=i(14945),s=i(88241),r=i(99724),a=i(24111),l=i(29906),d=i(66008),c=i(83010),u=i(27603),h=i(8475),g=i(33727);let p=class{constructor(e,t,i,n){this._hostEmitters=e,this._nodePoller=t,this._proofingDom=i,this._queryDetection=n,this.rehydrateTiles=e=>{const t=e.message;if(t.length>0)for(const e of t){const t=this._proofingDom.findTileNode(e);null==t||t.resetState()}else for(const e of this._proofingDom.tileNodes)e.resetState();this._nodePoller.pollNodes(o.G.NewData,this._proofingDom.tileNodes,s.Q.Code,void 0,!0)}}async initialize(){for(const e of this._hostEmitters)e.on(r.pD.hostModelRehydrateTiles,this._handleRehydrate.bind(this))}shutDown(){}_handleRehydrate(e){this._queryDetection?this._queryDetection.handleAugloopReconnection((()=>{this.rehydrateTiles(e)})):this.rehydrateTiles(e)}};p=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.t)(r.zJ)),(0,n.__param)(1,(0,c.W)(h.G)),(0,n.__param)(2,(0,c.W)(g.w)),(0,n.__param)(3,(0,u.l)()),(0,n.__param)(3,(0,c.W)(a.J))],p)},59873:(e,t,i)=>{i.d(t,{Z:()=>A});var n,o=i(23182);!function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(n||(n={}));class s{constructor(e,t){this._textRetrieverFactory=e,this._indexReadjuster=t,this.findOffsetPositions=async(e,t,i=!1,o)=>{const s=new Map;let r=0;t.sort(((e,t)=>e.index-t.index));const a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let l,d=0;if(l=void 0!==o?o:this._textRetrieverFactory(e).retrieve().content,t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>l.length)return s;const c=await this._indexReadjuster.getReadjustedIndices(e,t,l);let u;for(;a.nextNode();){const e=a.currentNode,o=r,l=e.textContent?e.textContent.length:0,h=o+l;for(let r=d;r<t.length;r+=1){const a=c[r];if(a.indexType===n.Start&&a.index>=o&&(i?a.index<=h:a.index<h))d+=1,s.set(t[r].startIndex,{startNode:e,startOffset:a.index-o});else{if(!(a.indexType===n.End&&a.index>=o&&a.index<=h))break;{d+=1;const i=s.get(t[r].startIndex);if(!i)throw new Error("The critique's end index has no conforming start index.");i.endNode=e,i.endOffset=a.index-o,s.set(t[r].startIndex,i)}}}if(r+=l,l>0&&(u=e),d===t.length)break}if(d!==t.length)if(u){const e=r-(u.textContent?u.textContent.length:0);for(let i=d;i<t.length;i+=1){const o=c[i];if(o.indexType===n.Start&&o.index===r)d+=1,s.set(t[i].startIndex,{startNode:u,startOffset:o.index-e});else{if(o.indexType!==n.End||o.index!==r)break;{d+=1;const n=s.get(t[i].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=u,n.endOffset=o.index-e,s.set(t[i].startIndex,n)}}}}else for(let i=d;i<t.length;i+=1){const o=c[i];if(o.indexType===n.Start&&0===o.index)s.set(t[i].startIndex,{startNode:e,startOffset:0});else{if(o.indexType!==n.End||0!==o.index)break;{const n=s.get(t[i].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=e,n.endOffset=0,s.set(t[i].startIndex,n)}}}return s},this.createRange=(e,t)=>{if(!(null==t?void 0:t.endNode)||void 0===t.endOffset)return;const i=e.createRange();return i.setStart(t.startNode,t.startOffset),i.setEnd(t.endNode,t.endOffset),i}}async getCritiqueRanges(e,t){const i=[];for(const e of t)i.push({index:e.start,indexType:n.Start,startIndex:e.start}),i.push({index:e.start+e.length,indexType:n.End,startIndex:e.start});const o=await this.findOffsetPositions(e,i),s=e.ownerDocument||document;return t.map((e=>{const t=o.get(e.start);return{critique:e,range:this.createRange(s,t)}}))}async getRangeOfNode(e,t,i,o){const s=[];s.push({index:t,indexType:n.Start,startIndex:t}),s.push({index:t+i,indexType:n.End,startIndex:t});const r=await this.findOffsetPositions(e,s,!1,o),a=e.ownerDocument||document;return this.createRange(a,r.get(t))}async getNodeInsertionPosition(e,t,i){const o=[];o.push({index:t,indexType:n.Start,startIndex:t}),o.push({index:t,indexType:n.End,startIndex:t});const s=await this.findOffsetPositions(e,o,i),r=e.ownerDocument||document;return this.createRange(r,s.get(t))}includePrecedingSpace(e,t){let i;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))i={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const n=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(n.currentNode=t.startContainer;n.previousNode();){const e=n.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(i={startNode:e,startOffset:e.textContent.length-1});break}}}return i&&t.setStart(i.startNode,i.startOffset),t}}class r{constructor(e){this.element=e}retrieve(){return{content:this.element.value}}}class a{constructor(e){this.element=e}retrieve(){return{content:this.element?l(this.element.innerText):""}}}function l(e){if(!e.includes(""))return e;const t=e.split("");let i="";return t.forEach(((e,t)=>{t%2==0&&(i+=e)})),i}var d=i(83448),c=i(83817);class u extends a{constructor(e){super(e),this.parentContentEditable=(0,c.m)(e)}retrieve(){const e=super.retrieve();return Object.assign(Object.assign(Object.assign({},e),{isInsideTable:this.getIsInsideTable()}),this.getListTypeAndIndentation())}getIsInsideTable(){if(!this.parentContentEditable)return;let e=this.element;for(;e&&e!==this.parentContentEditable;){if("TABLE"===e.nodeName)return!0;e=e.parentElement}return!1}getListTypeAndIndentation(){if(!this.parentContentEditable)return;let e,t,i=this.element;for(;i&&i!==this.parentContentEditable;)"OL"===i.nodeName&&(e||(e=d.pc.Numbered),t=(null!=t?t:-1)+1),"UL"===i.nodeName&&(e||(e=d.pc.Bullet),t=(null!=t?t:-1)+1),i=i.parentElement;return{listType:null!=e?e:d.pc.NoList,indentation:t}}}class h{setHtmlElement(e){this.element!==e&&(this.element=e,this.ownerDocument=e.ownerDocument||void 0)}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}}var g=i(71632),p=i(98647);const m="createUndoCheckpoint",f=(e,t)=>new Promise((i=>t.requestAnimationFrame(i,e)));class v extends h{constructor(e,t,i){super(),this.textNodeRangeBuilder=e,this._safeWindow=t,this._logger=i,this._textInterceptionMaxTimeoutMs=2e3,this._keysCache="",this.documentKeyboardEventHandler=e=>("keydown"!==e.type||1!==e.key.length||e.altKey||e.ctrlKey||e.metaKey||(this._keysCache+=e.key),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),this.inputInterceptionTimeoutHandler=e=>{this._logger&&this._logger.warn(507248854,`Input interception is shutting down on timeout after ${this._textInterceptionMaxTimeoutMs}ms`),this.stopInputInterception(e)},this.getRange=async(e,t)=>{if(this.element&&this.ownerDocument)return this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)},this.selectRange=(e,t)=>{const i=e.getSelection();if(!i)return;const n=[];for(let e=0;e<i.rangeCount;e++)n.push(i.getRangeAt(e));return i.removeAllRanges(),i.addRange(t),i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),n},this.selectRanges=(e,t)=>{const i=e.getSelection();if(!i)return!1;if(i.removeAllRanges(),t)for(const e of t)i.addRange(e);return!0},this.focusElementAndPrepareRange=async(e,t,i,n)=>(i.focus(),this.prepareRange(e,t,n)),this.prepareRange=async(e,t,i)=>(await f(this.targetWindow,this._safeWindow),!i||i.collapsed?this.getRange(e,t):i)}get targetWindow(){return this.element?(0,g.e)(this.element):window}async insert(e,t,i,n,o,s=!0){if(!this.element||!this.ownerDocument)return;const r=this.ownerDocument;s&&await f(this.targetWindow,this._safeWindow);let a=n;if(a||(a=await this.textNodeRangeBuilder.getNodeInsertionPosition(this.element,e,i)),a){const e=this.selectRange(r,a);await this.doReplacement(r,t),o&&this.selectRanges(r,e)}}async replace(e,t,i,n){if(!this.element||!this.ownerDocument)return;const{ownerDocument:o,element:s}=this,r=await this.focusElementAndPrepareRange(e,t,s,n);r&&(this.selectRange(o,r),await this.doReplacement(o,i))}async remove(e,t,i,n,o=!0,s){if(!this.element||!this.ownerDocument)return;const{ownerDocument:r}=this;o&&await f(this.targetWindow,this._safeWindow);let a=i;if(a&&!a.collapsed||(a=await this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)),a){s&&this.textNodeRangeBuilder.includePrecedingSpace(this.element,a);const e=this.selectRange(r,a);await this.doRemoval(r),n&&this.selectRanges(r,e)}return a}async autoCorrect(e,t,i,n,o){if(!this.element||!this.ownerDocument)return;let s,r=null;r=this.ownerDocument.getSelection(),r&&r.rangeCount>0&&(s={node:r.focusNode,offset:r.focusOffset}),o&&(this.startInputInterception(this.ownerDocument),this._interceptStartTime=Date.now(),this._logger&&this._logger.debug(507248859,`Starting text input interception ${this._interceptStartTime}`));let a=0;const l=this.ownerDocument;try{const o=await this.prepareRange(e,t,n);if(o){const e=o.toString();return this.selectRange(l,o),await this.doReplacement(l,i),a=i.length-t,e}}catch(e){throw o&&this._logger&&this._logger.error(507248858,"An error occurred during the auto correction text replacement while text interception is ON",e),e}finally{await this.restoreTextAndPosition(l,a,r,s,o)}}async restoreTextAndPosition(e,t,i,n,o){try{i&&n&&this.restorePosition(i,t,n)}catch(e){throw o&&this._logger&&this._logger.error(507248857,"An error occurred while trying to restore the cursor position after the auto correction and text interception is ON",e),e}finally{o&&await this.restoreText(e)}}restorePosition(e,t,i){var n,o,s;const r=i.offset+t,a=null!==(s=null===(o=null===(n=i.node)||void 0===n?void 0:n.textContent)||void 0===o?void 0:o.length)&&void 0!==s?s:r,l=Math.min(a,r);e.removeAllRanges(),e.setPosition(i.node,l)}async restoreText(e){try{await this.doReplacement(e,this._keysCache)}catch(e){throw this._logger&&this._logger.error(507248856,"An error occurred while trying to restore the cached text after the auto correction.",e),e}finally{if(this.stopInputInterception(e),this._interceptStartTime){const e=Date.now()-this._interceptStartTime;this._logger&&this._logger.debug(507248855,`Stop text input interception. Time take ${e} ms.`),this._interceptStartTime=void 0}}}startInputInterception(e){var t;this._keysCache="",this._textInterceptionTimeout=this.targetWindow.setTimeout((()=>this.inputInterceptionTimeoutHandler(e)),this._textInterceptionMaxTimeoutMs),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=new p.J(e),this._textInterceptionEventListener.addListener("keyup",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keydown",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keypress",this.documentKeyboardEventHandler,{capture:!0})}stopInputInterception(e){var t;this._textInterceptionTimeout&&(this.targetWindow.clearTimeout(this._textInterceptionTimeout),this._textInterceptionTimeout=void 0),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=void 0,this._keysCache=""}doReplacement(e,t){const i=new Event(m);return e.dispatchEvent(i),this.innerDoReplacement(e,t),e.dispatchEvent(i),Promise.resolve()}doRemoval(e){const t=new Event(m);return e.dispatchEvent(t),this.innerDoRemoval(e),e.dispatchEvent(t),Promise.resolve()}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}innerDoRemoval(e){e.execCommand("delete",!1),this.dispatchInputEvent()}}class _ extends h{constructor(){super(...arguments),this.doReplacement=(e,t,i,n,o)=>{e.setRangeText(t,i,n,o),this.dispatchInputEvent()},this.calculateBoundaries=(e,t,i)=>{const n=e.value.length,o=Math.min(t,n);return{start:o,end:Math.min(o+i,n)}}}async insert(e,t){if(!this.element)return;const i=this.calculateBoundaries(this.element,e,0);this.doReplacement(this.element,t,i.start,i.end,"end")}async replace(e,t,i){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,t);this.doReplacement(this.element,i,n.start,n.end,"end")}async autoCorrect(e,t,i){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,t),o=this.element.value.substring(n.start,n.end);return this.doReplacement(this.element,i,n.start,n.end,"preserve"),o}async remove(e,t,i,n,o,s){if(!this.element)return;const r=this.calculateBoundaries(this.element,s?e-1:e,s?t+1:t);this.doReplacement(this.element,"",r.start,r.end)}}class y extends h{constructor(e){super(),this.textRetrieverFactory=e}async insert(e,t){if(!this.element)return;const i=this.getReplacedText(e,e,t);this.element.innerText=i.text}async replace(e,t,i){if(!this.element)return;const n=this.getReplacedText(e,e+t,i);this.element.innerText=n.text}async autoCorrect(e,t,i){if(!this.element)return;const n=this.getReplacedText(e,e+t,i);return this.element.innerText=n.text,n.replacedPart}async remove(e,t,i,n,o,s=!1){if(!this.element)return;const r=this.getReplacedText(e,e+t,void 0,!s);this.element.innerText=r.text}getReplacedText(e,t,i,n){const o=this.getText(),s=o.length;let r=Math.min(e,s);const a=Math.min(t,s);n||i||" "!==o[r-1]||(r-=1);return{text:`${o.substring(0,r)}${null!=i?i:""}${o.substring(a)}`,replacedPart:o.substring(r,a)}}getText(){return this.element?this.textRetrieverFactory(this.element).retrieve().content:""}}var I=i(23888),C=i(22910),S=i(37053),b=i(25622),T=i(33727);class E{constructor(e,t,i,n){this._proofingDom=e,this._tileContent=t,this._indexReadjuster=i,this.targetWindow=n,this.getTextSelection=()=>{var e,t;const i=(null!==(t=null===(e=this.targetWindow)||void 0===e?void 0:e.deref())&&void 0!==t?t:window).getSelection();if(i){const e=this.getParentTileElement(i.anchorNode),t=this.getParentTileElement(i.focusNode);if(e&&t)return this.attemptToFindSelectionRange(e,t,i)}return Promise.resolve(void 0)},this.attemptToFindOffsetsIntoParentElement=(e,t)=>{const i=[],n=e.element&&this._tileContent.getContainingElement(e.element);if(!n)return i;const o=document.createTreeWalker(n,NodeFilter.SHOW_ALL,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let s=0;for(;o.nextNode();){const e=o.currentNode,n=e.textContent&&e.nodeType===e.TEXT_NODE?e.textContent.length:0;for(let n=0;n<t.length;n++)e===t[n]&&(i[n]=s);if(s+=n,i.length===t.length)break}if(0===s)for(let e=0;e<t.length;e++)n===t[e]&&(i[e]=s);return i},this.attemptToFindSelectionRange=async(e,t,i)=>{var n,o,s,r,a,l,d,c,u,h,g,p,m,f;let v,_;if(e.id===t.id){const t=this.attemptToFindOffsetsIntoParentElement(e,[i.anchorNode,i.focusNode]);v=t[0],_=t[1]}else v=this.attemptToFindOffsetsIntoParentElement(e,[i.anchorNode])[0],_=this.attemptToFindOffsetsIntoParentElement(t,[i.focusNode])[0];if(void 0!==v&&void 0!==_&&e.element&&t.element){let y,I,C,S,b,T,E=0,N=0;if(v>_?(E=_+i.focusOffset,N=v+i.anchorOffset,b=t,T=e):(E=v+i.anchorOffset,N=_+i.focusOffset,b=e,T=t),e.id===t.id){const t=this._tileContent.getContainingElement(e.element);if(!t)return;b=T=e;const g=null!==(o=null===(n=this._tileContent.getText(e))||void 0===n?void 0:n.content)&&void 0!==o?o:"";if(this._indexReadjuster)if(E===N){const e=0!==E&&"\n"===g.charAt(E),i=await this._indexReadjuster.getReadjustedIndices(t,[e?E-1:E],g,!0);e?(E=i[0]+1,N=i[0]+1):(E=i[0],N=i[0])}else{const e=await this._indexReadjuster.getReadjustedIndices(t,[E,N],g,!0);E=e[0],N=e[1]}if(!e.children)return{startParentElement:b,endParentElement:T,isCollapsed:i.isCollapsed,selectedText:i.toString(),startPosition:E,endPosition:N,startParagraphNode:y,endParagraphNode:I,startPositionInParagraphNode:C,endPositionInParagraphNode:S};for(const t of e.children){const e=t.element;E===N&&0!==E?E-1>=e.offset&&E-1<e.offset+e.span&&(y=t,C=E-e.offset,I=t,S=E-e.offset):(E>=e.offset&&(E<e.offset+e.span||0===E&&e.offset+e.span===0)&&(y=t,C=E-e.offset),N>=e.offset&&(N<e.offset+e.span||0===N&&e.offset+e.span===0)&&(I=t,S=N-e.offset))}if(!I){let t;for(const i of e.children)(!t||(null!==(r=null===(s=i.element)||void 0===s?void 0:s.offset)&&void 0!==r?r:0)>(null!==(l=null===(a=t.element)||void 0===a?void 0:a.offset)&&void 0!==l?l:0))&&(t=i);if(null==t?void 0:t.element){N===t.element.offset+t.element.span&&(I=t,S=N-t.element.offset)}}if(E===N&&!y&&!I){let t;for(const i of e.children)(!t||(null!==(c=null===(d=i.element)||void 0===d?void 0:d.offset)&&void 0!==c?c:0)>(null!==(h=null===(u=t.element)||void 0===u?void 0:u.offset)&&void 0!==h?h:0))&&(t=i);if(null==t?void 0:t.element){E===t.element.offset+t.element.span+1&&(y=t,C=E-t.element.offset,I=t,S=E-t.element.offset)}}}else{if(E=_+i.focusOffset,N=v+i.anchorOffset,b=t,T=e,!b.element||!T.element)return;const n=this._tileContent.getContainingElement(b.element),o=this._tileContent.getContainingElement(T.element);if(this._indexReadjuster&&n&&o){const e=null!==(p=null===(g=this._tileContent.getText(b))||void 0===g?void 0:g.content)&&void 0!==p?p:"";E=(await this._indexReadjuster.getReadjustedIndices(n,[E],e,!0))[0];const t=null!==(f=null===(m=this._tileContent.getText(T))||void 0===m?void 0:m.content)&&void 0!==f?f:"";N=(await this._indexReadjuster.getReadjustedIndices(o,[N],t,!0))[0]}if(b.children)for(const e of b.children)E>=e.element.offset&&E<e.element.offset+e.element.span&&(y=e,C=E-e.element.offset);if(T.children)for(const e of T.children)N>=e.element.offset&&N<e.element.offset+e.element.span&&(I=e,S=N-e.element.offset)}return{startParentElement:b,endParentElement:T,isCollapsed:i.isCollapsed,selectedText:i.toString(),startPosition:E,endPosition:N,startParagraphNode:y,endParagraphNode:I,startPositionInParagraphNode:C,endPositionInParagraphNode:S}}},this.getParentTileElement=e=>{let t;for(const i of this._proofingDom.tileNodes){this._tileContent.getContainingElement(i)===e&&(t=i)}return t||((null==e?void 0:e.parentNode)?this.getParentTileElement(e.parentNode):void 0)}}}var N=i(29906),x=i(83010),w=i(27603),L=i(76487),D=i(81174),F=i(20831);let A=class{constructor(e,t,i,n,o){this._proofingDom=e,this.indexReadjuster=t,this.safeWindow=i,this.logger=n,this.targetWindowRef=o,this.attachedToParagraphLevelDivs=!1}getText(e){const t=this.getTextRetriever(e,void 0);if(t)return t.retrieve()}getTextSelection(){return new E(this._proofingDom,this,this.indexReadjuster,this.targetWindowRef).getTextSelection()}getContainingElement(e){return(0,g.C)(e,"HTMLElement")?e:(0,L.ZR)(e)&&(0,D.l)(e)?R(e.parent):R(e)}async insert(e,t,i,n,o,s,r,a){const l=this.getTextWriter(e,t);if(l)return l.insert(i,n,o,s,r,a)}async replace(e,t,i,n,o,s){const r=this.getTextWriter(e,t);if(r)return r.replace(i,n,o,s)}async remove(e,t,i,n,o,s,r,a){const l=this.getTextWriter(e,t);if(l)return l.remove(i,n,s,r,a,o)}async autoCorrect(e,t,i,n,o,s,r){const a=this.getTextWriter(e,t);if(a)return a.autoCorrect(i,n,o,s,r)}async getCritiqueRanges(e,t,i){const n=null!=t?t:R(e);if(!n)return i.map((e=>({critique:e,range:void 0})));const o=this.getTextNodeRangeBuilder(e,t);return o?o.getCritiqueRanges(n,i):i.map((e=>({critique:e,range:void 0})))}async getRangeOfNode(e,t,i,n){const o=null!=t?t:R(e);if(!o)return;const s=this.getTextNodeRangeBuilder(e,t);return s?s.getRangeOfNode(o,i,n,(0,F.$)(e)?e.plainText:void 0):void 0}async getNodeInsertionPosition(e,t,i){const n=R(e);if(!n)return;const o=this.getTextNodeRangeBuilder(e,void 0);return o?o.getNodeInsertionPosition(n,t,i):void 0}getTextNodeRangeBuilder(e,t){const i=this.getTextRetriever(e,t);if(i)return new s((()=>i),this.indexReadjuster)}getTextRetriever(e,t){const i=null!=t?t:R(e);if(!i)return;let n;return n=(0,g.C)(i,"HTMLInputElement")||(0,g.C)(i,"HTMLTextAreaElement")?new r(i):this.attachedToParagraphLevelDivs?new u(i):new a(i),n}getTextWriter(e,t){var i;const n=null!==(i=R(e))&&void 0!==i?i:t,o=this.getTextNodeRangeBuilder(e,t),s=this.getTextRetriever(e,t);if(!n||!o||!s)return;let r;var a,l,d;return l="contenteditable",d="true",r=(a=n).hasAttribute(l)&&a.getAttribute(l)===d||null!==a.closest(`[${l}=${d}]`)?new v(o,this.safeWindow,this.logger):(0,g.C)(n,"HTMLInputElement")||(0,g.C)(n,"HTMLTextAreaElement")?new _:new y((()=>s)),r.setHtmlElement(n),r}};function R(e){return(0,D.l)(e)?e.parent.element:e.element}A=(0,o.__decorate)([(0,N._)(),(0,o.__param)(0,(0,x.W)(T.w)),(0,o.__param)(1,(0,x.W)(I.h)),(0,o.__param)(2,(0,x.W)(C.j)),(0,o.__param)(3,(0,x.W)(S.g)),(0,o.__param)(3,(0,w.l)()),(0,o.__param)(4,(0,x.W)(b.sh)),(0,o.__param)(4,(0,w.l)())],A)},78426:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(17298).f)("ITileContent")},69061:(e,t,i)=>{i.d(t,{c:()=>g});var n=i(23182),o=i(59873),s=i(23888),r=i(37053),a=i(22910),l=i(25622),d=i(33727),c=i(29906),u=i(83010),h=i(27603);let g=class extends o.Z{constructor(e,t,i,n,o){super(e,t,n,i,o),this.attachedToParagraphLevelDivs=!0}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(d.w)),(0,n.__param)(1,(0,u.W)(s.h)),(0,n.__param)(2,(0,u.W)(r.g)),(0,n.__param)(3,(0,u.W)(a.j)),(0,n.__param)(4,(0,u.W)(l.sh)),(0,n.__param)(4,(0,h.l)())],g)},59096:(e,t,i)=>{i.d(t,{i:()=>p,n:()=>g});var n=i(23182),o=i(27999),s=i(5494),r=i(88241),a=i(98839),l=i(17025),d=i(17298),c=i(29906),u=i(83010),h=i(27603);const g=(0,d.f)("ITextEventPublisher");let p=class extends o.z{constructor(e,t){super(),this._settings=e,this._timer=null!=t?t:new s.k}dispose(){return this._timer.shutDown(),Promise.resolve()}publishTextChangeEvent(e,t){this.publishEvent("textChange",{data:e,messageType:t}),this.scheduleSendIdleTextEvent(e,t)}publishTextStyleEvent(){this.publishEvent("styleChange",{})}scheduleSendIdleTextEvent(e,t){if(this._settings.enableTileNodeAutoReconciliation&&0!==e.length)for(const i of e)i.mutationChangeType!==r.Q.Code&&(this._timer.clearTimer(i.tileNodeId),this._timer.setTimeout(i.tileNodeId,(()=>{this.publishEvent("textChange",{data:[{tileNodeId:i.tileNodeId,text:i.text,mutationChangeType:r.Q.Code,rehydrateCritiques:!0,idleReconcileTrigger:!0,optimizedRehydrationEnabled:i.optimizedRehydrationEnabled}],messageType:t}),this._timer.clearTimer(i.tileNodeId)}),this._settings.reconcileTileNodeTime))}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(l.k)),(0,n.__param)(1,(0,h.l)()),(0,n.__param)(1,(0,u.W)(a.J))],p)},7569:(e,t,i)=>{function n(e,t){const i=e.start<t.start?e:t,n=i===e?t:e;if(!(i.end<n.start))return{start:n.start,end:i.end<n.end?i.end:n.end}}function o(e,t,i){if(!e)return;const o=e.content.substring(t,i);let s;if(e.formattedRanges){s=[];for(const o of e.formattedRanges){const e=n({start:o.start,end:o.start+o.length},{start:t,end:i});e&&s.push(Object.assign(Object.assign({},o),{start:e.start,length:e.end-e.start}))}}return Object.assign(Object.assign({},e),{content:o,formattedRanges:s})}function s(e,t,i){const n=[];if(e.formattedRanges)for(const o of e.formattedRanges){const e=o.start+o.length,s=Math.max(t,o.start),r=Math.min(i,e);r<=s||n.push(Object.assign(Object.assign({},o),{start:s,length:r-s}))}return n}i.d(t,{FD:()=>s,Gn:()=>o,V8:()=>d,_E:()=>r,lX:()=>a});const r=2063!=i.j?["queryRange","ipPosition","isColdIp","content","formattedRanges","objectReferences"]:null;function a(e,t){if(!e!=!t)return!1;if(!e||!t)return!0;const i=l(e);return!!d(i,l(e))&&i.every((i=>e[i]===t[i]))}function l(e){return Object.keys(e).filter((e=>!r.includes(e)))}function d(e,t){return!e==!t&&(!e||!t||e.length===t.length&&e.every(((i,n)=>function(e,t){const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(const n of i)if(Array.isArray(e[n])&&Array.isArray(t[n])){if(!d(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}(e[n],t[n]))))}},39352:(e,t,i)=>{function n(e){let t=e.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t}i.d(t,{F:()=>n})},50249:(e,t,i)=>{function n(e){var t,i,n,o,s,r,a;const{oaSettings:l,serviceSettings:d,hostMetadata:c}=e,{flagAnnotationSettings:u,nudge:h,predictions:g}=null!=d?d:{};return{ecc:{enabled:null!==(t=null==l?void 0:l.isContextualCardEnabled)&&void 0!==t&&t,entities:null==l?void 0:l.entitiesEnabled,bestMatch:null==l?void 0:l.bestMatchConfig,scopes:(null==l?void 0:l.scopesConfig)&&{entities:l.scopesConfig.entities,enabled:l.scopesConfig.enabled,maxResults:l.scopesConfig.maxResults}},flag:{enabled:null!==(i=null==u?void 0:u.enabled)&&void 0!==i&&i,entities:null!==(n=null==u?void 0:u.entityConfigs)&&void 0!==n?n:[]},nudge:{enabled:null!==(o=null==h?void 0:h.enabled)&&void 0!==o&&o,entities:null!==(s=null==h?void 0:h.entityConfigs)&&void 0!==s?s:[]},prediction:{enabled:null!==(r=null==g?void 0:g.enabled)&&void 0!==r&&r,entities:null!==(a=null==g?void 0:g.entityConfigs)&&void 0!==a?a:[],enableMiddleOfSentencePredictions:null==g?void 0:g.allowMiddleOfSentencePredictions,enableMultiPredict:null==g?void 0:g.enableMultiPredict},metadata:{appScenario:null==c?void 0:c.appScenario}}}i.d(t,{e:()=>n})},41109:(e,t,i)=>{i.d(t,{T:()=>n});const n=(0,i(17298).f)("IClientSubscriber")},51037:(e,t,i)=>{i.d(t,{X:()=>n});const n=(0,i(17298).f)("ILanguageDetectionSubscriber")},71895:(e,t,i)=>{i.d(t,{k:()=>E});var n=i(23182),o=i(95220);const s=e=>{var t,i,n,o;return(null===(t=null==e?void 0:e.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)||(null===(i=null==e?void 0:e.oaSettings)||void 0===i?void 0:i.enablePredictions)||(null===(o=null===(n=null==e?void 0:e.serviceSettings)||void 0===n?void 0:n.flagAnnotationSettings)||void 0===o?void 0:o.enabled)};var r=i(99724),a=i(37053),l=i(33767),d=i(14600),c=i(24111),u=i(25622),h=i(33727),g=i(61780),p=i(40769);class m{constructor(e,t){this._hostEmitter=e,this._logger=t,this._activationTokens=[]}async activateAnnotationsBase(e,t,i){if(e)if(this._activationTokens.length)this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation which is already initialized.`);else{this._session=e,this._sessionId=t;try{const e=await Promise.all(i());this._activationTokens=e.map((e=>e.token))}catch(e){this._logger.error(508044171,`Trying to activate ${this.annotationListenerType} failed due to an exception.`,e)}}else this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation with no session.`)}async deactivateAnnotations(e){if(!e||!this._activationTokens.length)return!1;try{const t=await Promise.all(this._activationTokens.map((t=>e.releaseAnnotation(t))));return this._activationTokens=[],t.every(Boolean)}catch(e){return this._logger.error(508044170,`Trying to deactivate ${this.annotationListenerType} failed due to an exception.`,e),!1}}async updateAnnotationActivationConfig(e){this._session?this._activationTokens.length?e&&this._activationTokens.map((t=>{var i;return null===(i=this._session)||void 0===i?void 0:i.updateAnnotationConfig(t,e)})):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid token.`):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid session object.`)}}var f=i(3910),v=i(85990),_=i(53353),y=i(14945);class I extends m{constructor(e,t,i,n,o){super(e,t),this._hostEmitter=e,this._logger=t,this._e2eMetric=i,this._queryDetection=n,this._hostSettings=o,this.annotationListenerType="OAAnnotationListener",this._onAnnotationResult=e=>{var t,i,n,o,s,a,l,d,c,u,h,m,I,C,S,b,T,E,N,x,w,L;const D=null===(t=e.items[0])||void 0===t?void 0:t.body;if(!D)return;let F;const A=g.h.getTypeNameFor(e);switch(A){case p.Xr.getTypeName():F=y.G.NewData;break;case p.fZ.getTypeName():F=y.G.ChangeData;break;case p.n4.getTypeName():F=y.G.RemoveData;break;default:return void this._logger.logDiagnostics("[OAAnnotationListener]: Unexpected annotation operation",{opType:A})}const R=null!==(i=e.parentPath[e.parentPath.length-1])&&void 0!==i?i:"",q=Number.parseInt(null!==(n=e.parentRevId)&&void 0!==n?n:"0",10);if(f.gh.typeGuard(D)){if(v.Yd.typeGuard(D.result)){if(null===(a=null===(s=null===(o=this._hostSettings)||void 0===o?void 0:o.serviceSettings)||void 0===s?void 0:s.predictions)||void 0===a?void 0:a.augloopPredictionsDisabled)return;const t=D.result;if(this.isValidSuggestionType(t.entityType)){let i=t.entityType;(i===_.c.People&&!t.entityResults||i===_.c.External)&&(i=_.c.PIM);const n=Object.assign(Object.assign({tileId:R,tileVersion:q,annotationId:e.items[0].id},t),{entityType:i,startIndex:t.startIndex>0?t.startIndex:(null!==(d=null===(l=t.context)||void 0===l?void 0:l.length)&&void 0!==d?d:0)+t.startIndex});this._hostEmitter.emit(r.pD.predictionTriggered,{address:this._sessionId,message:{messageType:F,data:n}})}}else if(v.aO.typeGuard(D.result)){const t=D.result;this.isValidSuggestionType(t.entityType)&&this._hostEmitter.emit(r.pD.nudgeTriggered,{address:this._sessionId,message:{messageType:F,data:Object.assign(Object.assign({},t),{tileId:R,tileVersion:q,annotationId:e.items[0].id,entityType:t.entityType})}})}}else if(f.Zx.typeGuard(D)||f.$g.typeGuard(D)){const t=null===(c=this._queryDetection)||void 0===c?void 0:c.getCurrentQuery(),i={logicalId:D.logicalId||(null===(u=this._queryDetection)||void 0===u?void 0:u.getCurrentQueryLogicalId())||"",conversationId:D.conversationId||(null===(h=this._queryDetection)||void 0===h?void 0:h.getCurrentQueryConversationId())||"",isEmptyQuery:!t||t.length===(null!==(I=null===(m=t.prefix)||void 0===m?void 0:m.length)&&void 0!==I?I:1),isTimeout:!1,queryLength:(null==t?void 0:t.length)?t.length-(null!==(S=null===(C=t.prefix)||void 0===C?void 0:C.length)&&void 0!==S?S:1):0},n=(e=>{if(f.$g.typeGuard(e)){const t=e;if(t.instrumentation&&t.instrumentation.length>0)return t.instrumentation[0].TraceId}})(D),o=n?{TraceId:n||""}:void 0;let s,a,l;if(this._e2eMetric.addMeasure(i.logicalId,"OAAnnotationResultsReceived",o),f.$g.typeGuard(D)){l=D.resultSummary;const e=D;for(const t of e.entityResults)if((null===(E=null===(T=null===(b=this._hostSettings)||void 0===b?void 0:b.oaSettings)||void 0===T?void 0:T.bestMatchConfig)||void 0===E?void 0:E.enabled)&&(null===(N=e.treatments)||void 0===N?void 0:N.bestMatchEntries))for(const i of e.treatments.bestMatchEntries)for(const e of t.entities)e.entityId===i.entityId&&(e.isBestMatch=!0);s=e.entityResults,a=e.entityResults.map((e=>e.modelInfo.elapsedTime)).filter(Number.isInteger).reduce(((e,t)=>e>t?e:t),0)}else{let e=[];try{(null===(L=null===(w=null===(x=this._hostSettings)||void 0===x?void 0:x.oaSettings)||void 0===w?void 0:w.bestMatchConfig)||void 0===L?void 0:L.enabled)&&(e=>{const t=e.results.findIndex((e=>e.bestMatchEntries&&e.bestMatchEntries.length>0));if(t>-1){const i=e.results[t],n=i.bestMatchEntries;n&&n.length>0&&i.results.forEach((e=>{e.isBestMatch=n.findIndex((t=>t.entityId===e.ReferenceId))>-1}))}})(D);for(const t of D.results)e=e.concat(t.results)}catch(e){this._logger.logDiagnostics("[OAAnnotationListener] unexpected annotation item format")}const t=new Map;for(const i of e){const e=t.get(i.entityType);e?e.entities.push(i):t.set(i.entityType,{entities:[i],entityType:i.entityType})}s=Array.from(t.values())}this._hostEmitter.emit(r.pD.oaRankedAnnotations,{address:this._sessionId,message:{messageType:F,data:{tileId:R,tileVersion:q,annotationId:e.items[0].id,results:s,resultStatus:D.status,resultSummary:l,queryCorrelationKeys:i,latency:a}}})}else f.Vn.typeGuard(D)&&this._hostEmitter.emit(r.pD.oaFlagAnnotationsTriggered,{address:this._sessionId,message:{messageType:F,data:{tileId:R,tileVersion:q,annotationId:e.items[0].id,results:D.results}}})},this.isValidSuggestionType=e=>Object.values(_.c).includes(e)}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>{var t,i,n,o;if(!e)return[];const s=[f.Zx];return(null===(i=null===(t=this._hostSettings)||void 0===t?void 0:t.oaSettings)||void 0===i?void 0:i.enableOaClient)?s.push(f.c$):s.push(f.os),(null===(o=null===(n=this._hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===o?void 0:o.enableOaClientPredictions)?s.push(f.Nh):s.push(f.Vm),s.push(f.Vn),s.map((t=>e.activateAnnotation(t.getTypeName(),{callback:this._onAnnotationResult})))}))}}var C=i(50249),S=i(29906),b=i(83010);const T=18e4;let E=class{constructor(e,t,i,n,s,r,a){this._hostEmitter=e,this._logger=t,this._hostSettings=i,this._oaMetric=n,this._queryDetection=s,this._proofingDom=r,this.targetDocumentFactory=a,this._oaStartupSignalSeq=0,this._startSignalIntervalId=null,this._lastStartSignalTime=0,this._elementsToProof=[],this._oaSendALMenuControlSignal=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);this._oaStartupSignalSeq=this._oaStartupSignalSeq+1,null==t||t.submitSignal(new o.I9(e.message),this._oaStartupSignalSeq.toString(),e.message.documentModel)},this._isSameOrDescendantElement=(e,t)=>e===t||e instanceof HTMLDivElement&&e.contains(t),this._handleDocumentFocusIn=e=>{const t=e.target;if(!(t instanceof HTMLElement))return;this._elementsToProof.some((e=>this._isSameOrDescendantElement(t,e)))&&(this._submitStartupSignal(),this._initStartupSignalTimer())},this._handleDocumentFocusOut=e=>{this._clearStartupSignalTimer()},this._attachFocusEventToProofedElements=async e=>{var t,i;const n=null===(t=this._proofingDom.findNode(e.message))||void 0===t?void 0:t.element;if(!(n&&n instanceof HTMLElement))return;this._elementsToProof.push(n);const o=(null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref())||document;o.activeElement instanceof HTMLElement&&this._isSameOrDescendantElement(o.activeElement,n)&&(this._submitStartupSignal(),this._initStartupSignalTimer())}}register(e,t){var i;if(!s(this._hostSettings))return;this._sessionsProvider=e,this._augloopDocumentSerializer=t,this._hostEmitter.on(r.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.on(r.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements);const n=(null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref())||document;n.addEventListener("focusin",this._handleDocumentFocusIn),n.addEventListener("focusout",this._handleDocumentFocusOut)}unregister(){var e;if(this._elementsToProof=[],s(this._hostSettings)){this._hostEmitter.off(r.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.off(r.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements);const t=(null===(e=this.targetDocumentFactory())||void 0===e?void 0:e.deref())||document;t.removeEventListener("focusin",this._handleDocumentFocusIn),t.removeEventListener("focusout",this._handleDocumentFocusOut)}this._clearStartupSignalTimer()}createAnnotationListener(){return new I(this._hostEmitter,this._logger,this._oaMetric,this._queryDetection,this._hostSettings)}onInitialize(e){this._initStartupSignal(e)}onSessionReconnected(e){this._initStartupSignal(e)}onDocumentCreated(e,t){var i,n,r;if(!s(this._hostSettings))return;this._oaStartupSignalSeq=this._oaStartupSignalSeq+1;const a=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.tokenOverride,l=this.getClientConfig(),d=null===(n=l.metadata)||void 0===n?void 0:n.appScenario;this._hostSettings.appId.startsWith("PowerPoint")&&"Copilot"!==d&&this._logger.logDiagnostics(`[OAClientSubscriber] client config for PowerPoint doesn't have correct appScenario: ${d}`),e.submitSignal(new o.c7({sessionConfig:{clientConfig:l,debugConfig:{tokenOverride:a}},parentPath:null===(r=this._augloopDocumentSerializer)||void 0===r?void 0:r.getParentPath(e,t).join("\\")}),this._oaStartupSignalSeq.toString(),t)}get isEnabled(){return!0}getClientConfig(){return(0,C.e)(this._hostSettings)}_submitStartupSignal(){var e;if(!s(this._hostSettings)||!this._currentSession)return;if(!(Date.now()-this._lastStartSignalTime>179e3))return;this._oaStartupSignalSeq++;const t=null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.tokenOverride;this._lastStartSignalTime=Date.now(),this._currentSession.submitSignal(new o.ep({debugOptions:{tokenOverride:t}}),this._oaStartupSignalSeq.toString())}_initStartupSignal(e){this._clearStartupSignalTimer(),this._currentSession=e,this._submitStartupSignal()}_initStartupSignalTimer(){this._startSignalIntervalId||(this._startSignalIntervalId=setInterval((()=>{this._submitStartupSignal()}),T))}_clearStartupSignalTimer(){this._startSignalIntervalId&&(clearInterval(this._startSignalIntervalId),this._startSignalIntervalId=null)}};E=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.W)(r.M5)),(0,n.__param)(1,(0,b.W)(a.g)),(0,n.__param)(2,(0,b.W)(l.n)),(0,n.__param)(3,(0,b.W)(d.u)),(0,n.__param)(4,(0,b.W)(c.J)),(0,n.__param)(5,(0,b.W)(h.w)),(0,n.__param)(6,(0,b.W)(u.Ze))],E)},60091:(e,t,i)=>{if(i.d(t,{cl:()=>r,nv:()=>l}),2063!=i.j)var n=i(92739);if(2063!=i.j)var o=i(61780);if(2063!=i.j)var s=i(59939);const r=(0,i(17298).f)("HostCallbacksTransformer");class a{constructor(e,t,i,n,o,s){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=i,this.logger=n,this.clientRuntime=o,this.aggregateLogger=s}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let i=t;for(const t of e)i=t(i,this);return i},this}async build(e,t){try{const e=await this.createClientMetadata(),i=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),n=this.createRuntimeOptions();await this.runPreRuntimeInit(e,n),await this.initClientRuntime(e,i,n);return{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const i=o.h.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:i,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(i,t)}logAnnotationResultItem(e,t){var i;const n=t.body?o.h.getTypeNameFor(t.body):"unknown";null===(i=this.aggregateLogger)||void 0===i||i.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:n,operationType:e}))}async createClientMetadata(){var e,t,i,n,o,s;const r={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(n=null===(i=this.hostSettings.hostMetadata)||void 0===i?void 0:i.appPlatform)&&void 0!==n?n:"Online",releaseAudienceGroup:null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(s=this.hostSettings.hostMetadata)||void 0===s?void 0:s.sessionId},a=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return a&&(r.flights=a.value),r}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var i;let n;return n=(null===(i=this.hostSettings.orchestratorSettings)||void 0===i?void 0:i.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,n},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(0,s.U)(this.telemetrySink)}}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var i;(null===(i=this.hostSettings.orchestratorSettings)||void 0===i?void 0:i.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((i=>i(e,t))))}async initClientRuntime(e,t,i){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,i)}createSession(e){var t;const i=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new n.L).generate();return this.clientRuntime.createSession({docSessionId:i})}}const l=(e,t,i,n,o,s)=>new a(e,t,i,n,o,s)},38417:(e,t,i)=>{i.d(t,{J:()=>s,a:()=>o});var n=i(17298);const o=(0,n.f)("AugloopSessionFactory"),s=(0,n.f)("IOrchestrator")},75712:(e,t,i)=>{i.d(t,{P:()=>o});var n=i(17298);const o=(0,n.f)("IALSessionFromHost");(0,n.f)("ProofingSettingsRequestTypes")},74458:(e,t,i)=>{if(i.d(t,{J:()=>a}),2063!=i.j)var n=i(41109);if(2063!=i.j)var o=i(71895);if(2063!=i.j)var s=i(11563);if(2063!=i.j)var r=i(15275);class a{constructor(){this.imports=[s.E]}get uniqueId(){return(0,r.z)(507918404)}configureRootServices(e){e.bind(n.T).to(o.k)}}},28709:(e,t,i)=>{if(i.d(t,{M:()=>p}),2063!=i.j)var n=i(38417);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(33767);if(2063!=i.j)var r=i(91970);if(2063!=i.j)var a=i(37053);if(2063!=i.j)var l=i(43222);if(2063!=i.j)var d=i(91928);if(2063!=i.j)var c=i(11563);if(2063!=i.j)var u=i(68540);if(2063!=i.j)var h=i(60091);const g=(0,i(17298).f)("IClientRuntime");class p{constructor(){this.imports=[c.E]}get uniqueId(){return(0,o.z)(507918289)}configureRootServices(e){var t;const i=e.get(s.n);(null===(t=i.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&i.orchestratorSettings.augLoopEndpoint&&(e.bind(g).toDynamicValue((()=>(0,u.xB)())),e.bind(n.a).toDynamicValue((e=>(t,i)=>{const n=e.get(s.n),o=e.get(d.o),c=e.get(r.qy),u=e.get(a.g),p=e.getOptional(l.v),m=e.get(g),f=(0,h.nv)(n,o,c,u,m,p),v=e.getAll(h.cl);return f.withHostCallbacksCustomizations(v),f.build(t,i)})))}}},68487:(e,t,i)=>{if(i.d(t,{g:()=>l}),2063!=i.j)var n=i(22177);if(2063!=i.j)var o=i(91928);if(2063!=i.j)var s=i(15275);if(2063!=i.j)var r=i(62026);if(2063!=i.j)var a=i(98288);class l{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918406)}configureRootServices(e){e.bind(r.f).to(a.E),e.bind(o.o).to(n.v)}}},41750:(e,t,i)=>{if(i.d(t,{h:()=>d}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(33767);if(2063!=i.j)var s=i(34471);if(2063!=i.j)var r=i(96669);if(2063!=i.j)var a=i(68487);if(2063!=i.j)var l=i(57015);class d{constructor(){this.imports=[a.g]}get uniqueId(){return(0,n.z)(507918402)}configureRootServices(e){e.bind(r.R9).toDynamicValue((e=>{const t=e.get(o.n);return new r.R9({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(s.S).to(l.M)}}},59939:(e,t,i)=>{i.d(t,{U:()=>s});const n="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",o=(e,t)=>{const i=[];for(const o of Object.keys(e)){if(void 0===e[o]||null===e[o])continue;const s={name:t?`${t}.${o}`:o,dataType:(n=e[o],"string"==typeof n?0:"boolean"==typeof n?1:"number"==typeof n?2:0),value:e[o],classification:4};i.push(s)}var n;return i};function s(e){return(t,i,s,r,a,l,d,c)=>{const u=t===n;let h,g=o(s);if(r){let e=o(a,r.split(".").slice(-1)[0]);u&&(e=[...e,...g],g=[]),h={name:r,dataFields:e}}const p={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:i,dataFields:g,eventFlags:{dataCategories:d,diagnosticLevel:c},eventContract:h};e.sendTelemetryEvent(p)}}},11563:(e,t,i)=>{if(i.d(t,{E:()=>d}),2063!=i.j)var n=i(8475);if(2063!=i.j)var o=i(95706);if(2063!=i.j)var s=i(38417);if(2063!=i.j)var r=i(68487);if(2063!=i.j)var a=i(78715);if(2063!=i.j)var l=i(15275);class d{constructor(){this.imports=[r.g]}get uniqueId(){return(0,l.z)(507918371)}configureRootServices(e){e.bind(s.J).to(a.r),e.bind(n.G).to(o.h)}}},78715:(e,t,i)=>{i.d(t,{r:()=>x});var n=i(23182),o=i(40769);class s{constructor(){this.mutex=Promise.resolve()}lock(){let e=e=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}}var r=i(36915),a=i(99724),l=i(88241),d=i(14945),c=i(33767),u=i(37053),h=i(66213),g=i(23812),p=i(43222),m=i(61780);class f{constructor(e,t,i,n,s,r,l,d){this._sessionId=e,this._logger=t,this._annotationListeners=i,this._session=n,this._aggregateLogger=s,this._augloopDocumentSerializer=r,this._hostEmitter=l,this._clientSubscribers=d,this.sessionWasDisconnected=!1,this.initialize=async()=>{try{this._session.setConnectCallback(this.onSessionConnected),this._session.setDisconnectCallback(this.onSessionDisconnected)}catch(e){this._logger.error(561534362,"Failed to initialize AugLoop session callbacks",e)}try{await this.activateAnnotations(this._annotationListeners.map((e=>e.annotationListenerType)))}catch(e){this._logger.error(508614281,"Failed to initialize AugLoop session annotations",e)}},this.close=()=>{this._session.close()},this.submitDelta=(e,t,i)=>{var n;const s=new o.xU({parentPath:e,items:[{id:e[e.length-1],revId:`${i}`,body:t,sourceTimestamp:Date.now()}]});this._session.submitOperation(s),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512337430,`submitDelta. unit: ${t.unit}`)},this.getSessionId=()=>this._sessionId,this.getSession=()=>this._session,this.updateAnnotationActivationConfig=async()=>{await Promise.all(this._annotationListeners.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325704,`updateAnnotationActivationConfig called for ${e.annotationListenerType}`),e.updateAnnotationActivationConfig()})))},this.activateAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325703,`activateAnnotations called for ${e.annotationListenerType}`),e.activateAnnotations(this._session,this._sessionId)})))},this.releaseAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));return(await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325702,`deactivateAnnotations called for ${e.annotationListenerType}`),e.deactivateAnnotations(this._session)})))).every(Boolean)},this.submitSignal=(e,t,i)=>{var n,s,r;const a=new o.g0({parentPath:this._augloopDocumentSerializer.getParentPath(this,i),items:[{id:t,body:e}]});this._session.submitOperation(a),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512325701,`submitted a signal of type: ${null!==(r=null===(s=e.H_)||void 0===s?void 0:s.T_)&&void 0!==r?r:"unknown"}`)},this.onDocumentCreated=e=>{for(const t of this._clientSubscribers)t.onDocumentCreated(this,e)},this.onSessionDisconnected=()=>{this.sessionWasDisconnected=!0,this._logger.warn(507773218,"Augloop session has disconnected")},this.onSessionConnected=async e=>{if(!e)return;const t=this.sessionWasDisconnected;if(this.sessionWasDisconnected=!1,t){this._logger.warn(508631257,"Augloop session has reconnected"),this._augloopDocumentSerializer.sessionReconnected(this._session),this._augloopDocumentSerializer.submitSeedOperations(this._session);for(const e of this._clientSubscribers)e.onSessionReconnected(this);this._hostEmitter.emit(a.pD.hostModelRehydrateTiles,{address:this._sessionId,message:[]}),this._hostEmitter.emit(a.pD.hostModelRehydrateTilesFinished,{address:this._sessionId,message:[]})}else this._logger.warn(508421253,"Augloop session has initially connected"),this._augloopDocumentSerializer.submitSeedOperations(this._session)}}submitOperation(e){var t,i;this._session.submitOperation(e);const n=m.h.getTypeNameFor(e);null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325706,`_submitItemsOperation called with ${n}`),null===(i=this._aggregateLogger)||void 0===i||i.incrementEventCount(512325705,`items submitted through ${n}`,e.items.length)}}var v=i(38417),_=i(14608),y=i(41109),I=i(29906),C=i(66008),S=i(27603);let b=class{constructor(e){this._clientSubscribers=e,this.hasCreatedDocument=!1}sessionReconnected(e){this.hasCreatedDocument=!1}submitSeedOperations(e){const t={id:"doc",body:new _.yo({isReadonly:!1})},i=new o.Xr({parentPath:["session"],items:[t]});try{e.submitSeedOperations([i])}catch(e){}}getParentPath(e,t){if(!this.hasCreatedDocument){this.hasCreatedDocument=!0;for(const i of this._clientSubscribers)i.onDocumentCreated(e,t)}return["session","doc"]}};b=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(y.T)),(0,n.__param)(0,(0,S.l)())],b);var T=i(75712);const E=(0,i(17298).f)("IAugloopDocumentSerializer");var N=i(83010);let x=class{constructor(e,t,i,n,c,u,h,g,p,m){this._hostEmitter=e,this._hostSettings=t,this._logger=i,this._e2eMetric=n,this._paragraphDeltasEnabled=c,this._clientSubscribers=u,this._sessionOrPromise=h,this._aggregateLogger=g,this._augloopSessionFactory=p,this._sessions=new Map,this._runtimeInstances=new Set,this._listenersInitialized=!1,this._fetchALSessionMutex=new s,this.initialize=async()=>{this._sessionOrPromise||this._augloopSessionFactory||this._logger.error(509694866,"Failed to initialize AugLoop, there is no runtime available"),this._hostSettings.enableOrchestration&&(this._logger.log(570782413,r.q.Info,"Initializing Orchestrator."),this._hostEmitter.on(a.pD.hostModelParagraphTextTiles,this._handleTiles),this._hostEmitter.on(a.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(a.pD.hostModelFormattingDelta,this._handleDelta),this._hostEmitter.on(a.pD.hostModelTextTile,this._handleTile),this._hostEmitter.on(a.pD.hostModelMoveTextTile,this._handleMove));for(const e of this._clientSubscribers)e.register(this,this._augloopDocumentSerializer);this._listenersInitialized=!0},this.shutDown=()=>{this._logger.log(570782414,r.q.Debug,"Shutting down Orchestrator."),this._listenersInitialized||this._logger.log(570782415,r.q.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted.");for(const e of this._clientSubscribers)e.unregister();for(const e of this._sessions.values())e.getSession()!==this._sessionFromHost&&e.close();for(const e of this._runtimeInstances)e.uninitialize();this._sessions.clear(),this._runtimeInstances.clear(),this._listenersInitialized=!1,this._sessionOrPromise=void 0,this._sessionFromHost=void 0},this.deactivateAnnotations=async e=>{const t=(await Promise.all([...this._sessions.keys()].map((t=>{var i;return null===(i=this._sessions.get(t))||void 0===i?void 0:i.releaseAnnotations(e)})))).every(Boolean);return t||this._logger.error(526209822,"Some annotations failed to be deactivated."),t},this.activateAnnotations=async e=>{for(const t of this._sessions.values())await t.activateAnnotations(e)},this.getOrCreateSession=async e=>{var t;const i=await this._fetchALSessionMutex.lock(),n=null!==(t=this._sessions.get(e))&&void 0!==t?t:await this._createSession(e);return i(),n},this.getSessions=async e=>{if(!e)return this._sessions;const t=new Map;for(const i of e)t.set(i,await this.getOrCreateSession(i));return t},this._createSession=async e=>{const t=[];for(const e of this._clientSubscribers)t.push(e.createAnnotationListener());let i="function"==typeof this._sessionOrPromise?await this._sessionOrPromise():this._sessionOrPromise;if(i)this._sessionFromHost=i;else{if(!this._augloopSessionFactory)return;{const{session:t,runtime:n}=await this._augloopSessionFactory(this._augloopDocumentSerializer,e);i=t,n&&this._runtimeInstances.add(n)}}if(!i)return;const n=new f(e,this._logger,t,i,this._aggregateLogger,this._augloopDocumentSerializer,this._hostEmitter,this._clientSubscribers);await n.initialize();for(const e of this._clientSubscribers)e.onInitialize(n);return this._sessions.set(e,n),n},this._handleDelta=async e=>{const t=e.message;if(t.sourceType===l.p.TileNode)return;const i=await this.getOrCreateSession(e.address);i&&(this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i.submitDelta([...this._augloopDocumentSerializer.getParentPath(i,t.documentModel),t.tileId],t.delta,t.tileVersion))},this._handleTiles=async e=>{this._paragraphDeltasEnabled.check()||await this._handleTileMessages(e.address,e.message)},this._handleTile=async e=>{this._paragraphDeltasEnabled.check()&&e.message.data.isTextNode&&await this._handleTileMessages(e.address,[e.message])},this._handleTileMessages=async(e,t)=>{const i=await this.getOrCreateSession(e);if(i)for(const n of t){const t=n.data;let s;switch(n.messageType){case d.G.NewData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),s=new o.Xr({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}],prevId:n.data.prevId,nextId:n.data.nextId});break;case d.G.RemoveData:s=new o.n4({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,sourceTimestamp:Date.now()}]});break;case d.G.ChangeData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),s=new o.fZ({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}]})}i.submitOperation(s),this._hostEmitter.emit(a.pD.hostModelTextTileEmittedToAugloop,{address:e,message:n})}},this._handleMove=async e=>{const t=e.message;await this._handleTileMessages(e.address,[{messageType:d.G.RemoveData,data:{tileId:t.oldTileId,tileVersion:t.tileVersion,documentModel:t.oldDocumentModel,tile:void 0,changeType:l.Q.Code,isTextNode:!1}},{messageType:d.G.NewData,data:{tileId:t.newTileId,tileVersion:t.tileVersion,documentModel:t.newDocumentModel,tile:t.tile,changeType:l.Q.Code,isTextNode:!1,prevId:t.prevId,nextId:t.nextId}}])},this._augloopDocumentSerializer=null!=m?m:new b(u)}};x=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,N.W)(a.M5)),(0,n.__param)(1,(0,N.W)(c.n)),(0,n.__param)(2,(0,N.W)(u.g)),(0,n.__param)(3,(0,N.W)(h.m)),(0,n.__param)(4,(0,N.W)(g.H)),(0,n.__param)(5,(0,C.t)(y.T)),(0,n.__param)(5,(0,S.l)()),(0,n.__param)(6,(0,N.W)(T.P)),(0,n.__param)(6,(0,S.l)()),(0,n.__param)(7,(0,S.l)()),(0,n.__param)(7,(0,N.W)(p.v)),(0,n.__param)(8,(0,S.l)()),(0,n.__param)(8,(0,N.W)(v.a)),(0,n.__param)(9,(0,S.l)()),(0,n.__param)(9,(0,N.W)(E))],x)},22177:(e,t,i)=>{i.d(t,{v:()=>d});var n=i(23182),o=i(51451),s=i(63526),r=i(33767),a=i(29906),l=i(83010);let d=class{constructor(e,t){this._proofingStore=e,this._hostSettings=t}async buildDescriptors(){var e;const t="FlightIds";let i;try{i=JSON.parse(await this._proofingStore.read(o.l.Descriptors))}catch(e){i=JSON.parse(this._proofingStore.getDefaultValue(o.l.Descriptors))}let n="";if(this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(n=`${n}${this._hostSettings.flightsToTrack.join(";")}`),""!==n){const e=i.find((e=>e.name===t));e?e.value=`${e.value};${n}`:i.push({name:t,value:n})}return(null===(e=this._hostSettings.hostMetadata)||void 0===e?void 0:e.releaseAudienceGroup)&&i.push({name:"Audience",value:c(this._hostSettings.hostMetadata.releaseAudienceGroup)}),i}};function c(e){switch(e){case"Local":case"Staging":case"Dogfood":case"DogFood":return"DogFood";case"Microsoft":return"Microsoft";default:return"Production"}}d=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(s.K)),(0,n.__param)(1,(0,l.W)(r.n))],d)},91928:(e,t,i)=>{i.d(t,{o:()=>n});const n=(0,i(17298).f)("IDescriptorManager")},98288:(e,t,i)=>{i.d(t,{E:()=>T});var n=i(23182),o=i(51451),s=i(1297);const r="IsPaneOpen",a="IsPaneOpenedInSession";var l,d,c=i(28510),u=i(63318),h=i(70848),g=i(99724),p=i(8628),m=i(63526),f=i(37053),v=i(35731),_=i(51199),y=i(63326),I=i(29906),C=i(83010),S=i(27603);!function(e){e.InstrumentationCall="InstrumentationCall"}(l||(l={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(d||(d={}));var b=i(91928);let T=class{constructor(e,t,i,n,o){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=i,this._logger=n,this._paneOpenState=o}async process(e){const t=await this.getRequest(e);return!!t&&(this.emitInstrumentationRequest(t,e),this.logActivity(t,e),!0)}async getRequest(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext)return{appId:await this._proofingStore.read(o.l.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:s.I.getDefaultLanguageCode(await this._proofingStore.read(o.l.ProofingLanguages)),traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map((e=>e.text)),suggestionText:this.getSuggestionText(e),metadata:this.getMetadata(e),substrateEventCustomFields:e.customProperties}}getSuggestionText(e){const t=e.critique.suggestions.map((e=>e.text));let i=t[e.eventId-4];return e.eventId!==y.xp.Autoreplace&&e.eventId!==y.xp.AutoreplaceUndo||(i=t[0]),e.eventId>=y.xp.ChangeAllSugg0&&e.eventId<=y.xp.ChangeAllSugg2&&(i=t[e.eventId-8]),i}getMetadata(e){var t,i;const n=null!==(i=null===(t=e.critique.metadata)||void 0===t?void 0:t.slice())&&void 0!==i?i:[];this._paneOpenState&&n.push({name:r,value:String(this._paneOpenState.isPaneOpen)},{name:a,value:String(this._paneOpenState.isPaneOpenedInSession)});const s=this._proofingStore.getCachedEntry(o.l.ProofingLanguages).storeEntryValue;return n.push({name:c.o.NumProofingLanguages,value:String(s.length)}),n}emitInstrumentationRequest(e,t){e.critiqueTypeId===u.L9.TopicSuggestion||(0,h.r3)(t.critique)||this._hostEmitter.emit(g.pD.instrumentationRequestV1,{address:void 0,message:e})}logActivity(e,t){const i=this._logger.getNewActivity(l.InstrumentationCall,_.o.SamplingPolicy.Measure),n=e.substrateEventCustomFields&&"true"===e.substrateEventCustomFields.isPersonalized||!1;i&&(i.dataFields.push((0,p.n)("EventID",e.eventId)),i.dataFields.push((0,p.n)("CritiquePriority",e.critiquePriority)),i.dataFields.push((0,p.n)("CritiqueTypeId",e.critiqueTypeId)),i.dataFields.push((0,p.n)("IsPersonalizedEvent",n)),e.critiqueTypeId===u.L9.TopicSuggestion&&(i.dataFields.push((0,p.n)("SuggestionMetadataJSON",JSON.stringify(t.critique.suggestions.map((e=>e.metadataJSON))))),i.dataFields.push((0,p.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata)))),i.success=!0,i.endNow())}};T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.W)(g.M5)),(0,n.__param)(1,(0,C.W)(m.K)),(0,n.__param)(2,(0,C.W)(b.o)),(0,n.__param)(3,(0,C.W)(f.g)),(0,n.__param)(4,(0,S.l)()),(0,n.__param)(4,(0,C.W)(v.F))],T)},57015:(e,t,i)=>{i.d(t,{M:()=>g});var n=i(23182),o=i(99724),s=i(22649),r=i(33767),a=i(37053),l=i(7988),d=i(96669),c=i(29906),u=i(83010),h=i(15232);let g=class{constructor(e,t,i,n,o,s){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=i,this._hostSettings=n,this._logger=o,this._sessionContextProvider=s}async initialize(){this._hostEmitter.on(o.pD.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const i=await this._sessionContextProvider();return i.sessionId&&(this._editorService.xUserSessionId=i.sessionId),i.composeSessionId&&(this._editorService.xUserComposeSessionId=i.composeSessionId),function(e,t,i){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let n=h.G_.NoLicense;t?n=h.G_.Subscription:i&&(n=i),null==e||e.push({name:"LicenseType",value:n})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};g=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(s.e)),(0,n.__param)(1,(0,u.W)(o.M5)),(0,n.__param)(2,(0,u.W)(d.R9)),(0,n.__param)(3,(0,u.W)(r.n)),(0,n.__param)(4,(0,u.W)(a.g)),(0,n.__param)(5,(0,u.W)(l.a))],g)},76192:(e,t,i)=>{i.d(t,{N:()=>n});const n=(0,i(17298).f)("IOrchestratorSettings")},31387:(e,t,i)=>{i.d(t,{u:()=>c});var n=i(8520),o=i(745),s=i(41642),r=i(3817),a=i(28853),l=i(48662);const d=(0,o.F5)({state:s.A.on(a.JY),featureFlagsReader:s.A.on(l.c)}),c=(0,r.PA)((()=>{const{featureFlagsReader:e,state:t}=(0,o.KN)(d),{politeUpdates:i,assertiveUpdates:s,status:r,statusSeverity:a}=t,l={width:0,height:0,color:"transparent",background:"none",border:"none",outline:"none",overflow:"hidden",pointerEvents:"none"};return window.self===window.top||e.flags.enableAriaStatusInNonRootIFrames?n.createElement(n.Fragment,null,r&&n.createElement("div",{role:"status","aria-live":a,"aria-label":r,style:l}),0!==s.length&&n.createElement("div",{role:"log","aria-live":"assertive",style:l},s),0!==i.length&&n.createElement("div",{role:"log","aria-live":"polite",style:l},i)):null}))},28853:(e,t,i)=>{i.d(t,{JY:()=>u,Th:()=>h,yi:()=>g});var n=i(23182),o=i(98647),s=i(48662),r=i(19728),a=i(17298),l=i(29906),d=i(83010),c=i(37814);const u=(0,a.f)("IAriaStatusStateStore"),h=(0,a.f)("IAriaStatusStateStoreFactory");let g=class{constructor(e){this.featureFlagsReader=e,this.purgeDelay=1e4,this.logPurgeTimeout={},this._politeUpdates=[],this._assertiveUpdates=[],this._status=void 0,this._statusSeverity="off",this.postMessageIfIframe=e=>window.self!==window.top&&(this.featureFlagsReader.flags.enableAriaStatusPostMessage?(window.parent.postMessage(e,"*"),!0):!this.featureFlagsReader.flags.enableAriaStatusInNonRootIFrames),this.reset=(e,t,i)=>{this.postMessageIfIframe({messageType:"msAriaResetMessage",resetStatus:e,resetAssertiveLogs:t,resetPoliteLogs:i})||(e&&(this._status=void 0,this._statusSeverity="off"),t&&(this._assertiveUpdates=[]),i&&(this._politeUpdates=[]))},this.scheduleLogCleanup=e=>{this.cancelScheduledCleanup(e),this.logPurgeTimeout[e]=window.setTimeout((()=>{const t="assertive"===e,i="polite"===e;this.reset(!1,t,i)}),this.purgeDelay)},this.cancelScheduledCleanup=e=>{const t=this.logPurgeTimeout[e];t&&(window.clearTimeout(t),this.logPurgeTimeout[e]=void 0)},this.onMessage=e=>{var t;if(null===(t=e.data)||void 0===t?void 0:t.messageType)if("msAriaSetMessage"===e.data.messageType){const t=e.data;void 0===t.status||"assertive"!==t.severity&&"polite"!==t.severity&&"off"!==t.severity||(Array.isArray(t.status)?this.addPreservedStatuses(t.status,t.severity):this.setStatus(t.status,t.severity,!!t.preserve))}else if("msAriaResetMessage"===e.data.messageType){const t=e.data;void 0!==t.resetAssertiveLogs&&void 0!==t.resetPoliteLogs&&void 0!==t.resetStatus&&this.reset(t.resetStatus,t.resetAssertiveLogs,t.resetPoliteLogs)}},(0,c.Gn)(this)}get politeUpdates(){return this._politeUpdates}get assertiveUpdates(){return this._assertiveUpdates}get status(){return this._status}get statusSeverity(){return this._statusSeverity}async initialize(){this.featureFlagsReader.flags.enableAriaStatusPostMessage&&window.self===window.top&&(this.eventListener=new o.J(window),this.eventListener.addListener("message",this.onMessage,{passive:!0,capture:!0}))}shutDown(){var e;null===(e=this.eventListener)||void 0===e||e.removeAllListeners(),this.eventListener=void 0}setStatus(e,t,i=!1){if(!this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:i}))if(i){if("polite"===t||"assertive"===t){const i="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),i.push(e),this.scheduleLogCleanup(t)}}else this._statusSeverity=t,this._status=e}addPreservedStatuses(e,t){if(!this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:!0})&&("polite"===t||"assertive"===t)){const i="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),i.push(...e),this.scheduleLogCleanup(t)}}resetAll(){this.reset(!0,!0,!0)}resetPreserved(){this.reset(!1,!0,!0)}resetStatus(){this.reset(!0,!1,!1)}};(0,n.__decorate)([r.observable],g.prototype,"_politeUpdates",void 0),(0,n.__decorate)([r.computed],g.prototype,"politeUpdates",null),(0,n.__decorate)([r.observable],g.prototype,"_assertiveUpdates",void 0),(0,n.__decorate)([r.computed],g.prototype,"assertiveUpdates",null),(0,n.__decorate)([r.observable],g.prototype,"_status",void 0),(0,n.__decorate)([r.computed],g.prototype,"status",null),(0,n.__decorate)([r.observable],g.prototype,"_statusSeverity",void 0),(0,n.__decorate)([r.computed],g.prototype,"statusSeverity",null),(0,n.__decorate)([r.action],g.prototype,"setStatus",null),(0,n.__decorate)([r.action],g.prototype,"addPreservedStatuses",null),(0,n.__decorate)([r.action],g.prototype,"reset",void 0),g=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(s.c))],g)},53382:(e,t,i)=>{i.d(t,{Jx:()=>n,XG:()=>u,mU:()=>c});var n,o=i(23182),s=i(19685),r=i(28853),a=i(17298),l=i(29906),d=i(83010);!function(e){e[e.KeepOriginal=0]="KeepOriginal",e[e.AutoCorrectAppearance=1]="AutoCorrectAppearance",e[e.AutoCorrectHover=2]="AutoCorrectHover",e[e.SingleIssueOnLine=3]="SingleIssueOnLine",e[e.IssuesOnLine=4]="IssuesOnLine"}(n||(n={}));const c=(0,a.f)("IAriaStatusUniqueProxy");let u=class{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.existingCritiques=new Set,this.completeStatusMessage=(e,t)=>{const i=this.getMessageKey(t);if(!i)return e;let o=this.localizer.getMessage(i,e);return t===n.AutoCorrectHover&&(o=`${o} ${this.localizer.getMessage("ebx_autoCorrectedKeyboardAccess")}`),o},this.getMessageKey=e=>e===n.AutoCorrectAppearance||e===n.AutoCorrectHover?"ebx_autoCorrected":e===n.SingleIssueOnLine?"ebx_issuesOnLineSingular":e===n.IssuesOnLine?"ebx_issuesOnLinePlural":void 0}setStatus(e,t,i=!1,n,o){if(n&&i){if(this.existingCritiques.has(n))return;this.existingCritiques.add(n)}const s=void 0===o?e:this.completeStatusMessage(e,o);this.ariaStatusStateStore.setStatus(s,t,i)}addPreservedStatuses(e,t){const i=e.filter((e=>{const t=this.existingCritiques.has(e.id);return t||this.existingCritiques.add(e.id),!t})).map((e=>void 0===e.messageKind?e.text:this.completeStatusMessage(e.text,e.messageKind)));this.ariaStatusStateStore.addPreservedStatuses(i,t)}setLineNavStatus(e,t,i){e<1||this.setStatus(e.toLocaleString(),t,i,void 0,1===e?n.SingleIssueOnLine:n.IssuesOnLine)}};u=(0,o.__decorate)([(0,l._)(),(0,o.__param)(0,(0,d.W)(r.JY)),(0,o.__param)(1,(0,d.W)(s.H))],u)},22628:(e,t,i)=>{if(i.d(t,{U:()=>g,d:()=>u}),2063!=i.j)var n=i(83806);var o=i(745),s=i(41642),r=i(28798),a=i(25622),l=i(33767);if(2063!=i.j)var d=i(40166);var c=i(8520);const u=c.createContext(void 0),h=(0,o.F5)({languageScriptDirectionDetector:s.A.on(r.iw).optional(),targetWindowRef:s.A.on(a.sh).optional(),hostSettings:s.A.on(l.n).optional()}),g=e=>{const{hostSettings:t,languageScriptDirectionDetector:i,targetWindowRef:s}=(0,o.SM)(h),r=c.useContext(u),a=null==s?void 0:s.deref();c.useEffect((()=>{var e;return null===(e=null==t?void 0:t.onCalloutOpened)||void 0===e||e.call(t,null,void 0,r),()=>{var e;null===(e=null==t?void 0:t.onCalloutClosed)||void 0===e||e.call(t,null,void 0,r)}}),[t,r,e.target,a]);const l={hostId:r,eventBubblingEnabled:!0};return c.createElement(n.P,Object.assign({dir:null==i?void 0:i.dir(),layerProps:l},e,{target:e.target,doNotLayer:!r&&e.doNotLayer}),void 0===i?e.children:c.createElement(d.K,{rtl:i.isRtl()},e.children))}},96969:(e,t,i)=>{i.d(t,{v:()=>h});var n=i(745),o=i(41642),s=i(28798),r=i(33767),a=i(98032),l=i(5202),d=i(40166),c=i(8520);const u=(0,n.F5)({languageScriptDirectionDetector:o.A.on(s.iw).optional(),hostSettings:o.A.on(r.n).optional()}),h=c.forwardRef(((e,t)=>{var i,o,s,r;const{hostSettings:h,languageScriptDirectionDetector:g}=(0,n.SM)(u),p=c.useRef(null),m=(null===(i=e.popover)||void 0===i?void 0:i.positioning).target;return c.useImperativeHandle(t,(()=>({getElementRef:()=>p}))),c.useEffect((()=>{var e;return null===(e=null==h?void 0:h.onCalloutOpened)||void 0===e||e.call(h,null,m,void 0),()=>{var e;null===(e=null==h?void 0:h.onCalloutClosed)||void 0===e||e.call(h,null,m,void 0)}}),[h,m]),c.createElement(a.A,Object.assign({},e.popover,{"aria-label":null===(o=e.popover)||void 0===o?void 0:o.ariaLabel,"aria-labelledBy":null===(s=e.popover)||void 0===s?void 0:s.ariaLabelledBy,"aria-role":null===(r=e.popover)||void 0===r?void 0:r.ariaRole}),c.createElement(l.H,Object.assign({},e.surface,{ref:p,dir:null==g?void 0:g.dir()}),void 0===g?e.children:c.createElement(d.K,{rtl:g.isRtl()},e.children)))}))},55649:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(17298).f)("ICalloutDismissalHandler")},7433:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(17298).f)("ICritiqueCalloutStateStoreBase")},34055:(e,t,i)=>{i.d(t,{x:()=>n});const n=(0,i(17298).f)("IUndoCalloutStateStoreBase")},20394:(e,t,i)=>{i.d(t,{D:()=>s,Y:()=>n});var n,o=i(17298);!function(e){e.critique="critique",e.inlineSuggestions="inlineSuggestions",e.languageAutoDetection="languageAutoDetection"}(n||(n={}));const s=(0,o.f)("IFooterFreStore")},23191:(e,t,i)=>{i.d(t,{z:()=>l});var n=i(23182),o=i(29906),s=i(83010),r=i(14253),a=i(33727);let l=class{constructor(e,t){this._inlineSuggestionsRenderer=e,this._proofingDom=t}filter(e){const t=this._inlineSuggestionsRenderer.getCurrentMenuInfo();if(!t||"InlineSuggestionsResultsUserInitiatedMenuType"!==t.menuType.menuType)return!0;if(e.nodeId===t.tileId){const i=this._proofingDom.findParagraphNode(t.tileId);if((null==i?void 0:i.element)&&"offset"in i.element)return!this.intersects(e.start,e.start+e.length,i.element.offset+t.queryRange.start,i.element.offset+t.queryRange.start+t.queryRange.length)}return!0}intersects(e,t,i,n){return e<=n&&i<=t}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(r.V)),(0,n.__param)(1,(0,s.W)(a.w))],l)},54058:(e,t,i)=>{i.d(t,{I:()=>n});const n=(0,i(17298).f)("IInlineSuggestionStore")},52215:(e,t,i)=>{i.d(t,{Z:()=>n});const n=(0,i(17298).f)("IInlineSuggestionsCalloutStore")},2599:(e,t,i)=>{i.d(t,{T:()=>n});const n=(0,i(17298).f)("IInlineSuggestionsCalloutUtils")},14253:(e,t,i)=>{i.d(t,{P:()=>n,V:()=>s});var n,o=i(17298);!function(e){e.AttachFile="AttachFile",e.TriggerChar="TriggerChar",e.Fre="Fre"}(n||(n={}));const s=(0,o.f)("IInlineSuggestionsRenderer")},8534:(e,t,i)=>{i.d(t,{H:()=>te});var n,o,s,r=i(23182),a=i(62924),l=i(53353),d=i(55642),c=i(8628),u=i(99724),h=i(63596);!function(e){e[e.Unknown=0]="Unknown",e[e.Title=1]="Title",e[e.Subtitle=2]="Subtitle",e[e.Heading1=3]="Heading1",e[e.Heading2=4]="Heading2",e[e.Heading3=5]="Heading3"}(n||(n={})),function(e){e.Installed="Installed",e.NotInstalled="NotInstalled"}(o||(o={})),function(e){e.Query="Query",e.Action="Action"}(s||(s={}));var g=i(88241),p=i(98647),m=i(33767),f=i(15661),v=i(24111),_=i(81168),y=i(19685),I=i(28798),C=i(14600),S=i(874),b=i(25936),T=i(14251),E=i(94610),N=i(39352),x=i(33727),w=i(10968),L=i(78426),D=i(12220),F=i(89669),A=i(47381),R=i(96606),q=i(37814),P=i(19881),O=i(19728),k=i(13014);const z=(e,t,i,n,o,s)=>({ConversationId:t,ImpressionType:n,LocalTime:(new Date).toISOString(),ProviderName:o,Results:s,LogicalId:e,TraceId:i,Version:2});function M(e,t){const i="TopHits",n={};n[i]=[],e.forEach((e=>{e.entities.forEach((e=>{if(e.isBestMatch)n[i].push(e);else{const t=e.entityType;n[t]?n[t].push(e):n[t]=[e]}}))})),0===n[i].length&&delete n[i];const o=[];let s=1;for(const e in n){const r=n[e];let a=1;o.push(Object.assign({Type:"Group",Name:e===i?i:r[0].entityType,LayoutType:"Vertical",Position:s,ResultsView:n[e].map((e=>({Type:"Entity",EntityType:`${e.entityType}Suggestion`,ReferenceId:e.ReferenceId,Position:a++,PlacementType:"Visible"})))},t&&{MetaData:t})),s++}return o}var W,j=i(57645),B=i(21592),U=i(3216);!function(e){e[e.AuthorName=0]="AuthorName",e[e.EmailSenderName=1]="EmailSenderName",e[e.FallbackValue=2]="FallbackValue",e[e.LastModifiedByUser=3]="LastModifiedByUser",e[e.LastModifiedByContact=4]="LastModifiedByContact",e[e.LastAccessedByUser=5]="LastAccessedByUser",e[e.SentByUser=6]="SentByUser",e[e.DateCreatedByUser=7]="DateCreatedByUser",e[e.UserCreatedBy=8]="UserCreatedBy"}(W||(W={}));const H=e=>{if(!e)return"";const t=e.includes("Z")?e:`${e}Z`;return(0,U.Z)(new Date(t),new Date)},V=(e,t,i,n)=>{var o,s,r,a;const l=(0,B.$)().getStringsFor("FileTidbitStrings"),d=(e,...t)=>{let i=l(e);return t.filter(Boolean).forEach(((e,t)=>{i=i.replace(`{${t}}`,e)})),i},c=((e,t,i,n)=>{var o;const{Author:s,From:r,DateAccessed:a,DateCreated:l,DateModified:d,SharedDateTime:c,propertyHits:u,UserRelationshipType:h}=e;if(i&&n&&h!==j.b.Uploaded)return W.LastAccessedByUser;const g=(s||(null===(o=null==r?void 0:r.EmailAddress)||void 0===o?void 0:o.Name)||"").trim(),p=g===t;if(i){const e=(null==u?void 0:u.includes("EmailSenderName"))||(null==u?void 0:u.includes("EmailSenderAddress")),t=(null==u?void 0:u.includes("Author"))||(null==u?void 0:u.includes("AuthorEmail"));if(h===j.b.Uploaded)return t?W.UserCreatedBy:W.DateCreatedByUser;if(e)return p?W.SentByUser:W.EmailSenderName;if(t)return W.AuthorName;if(h===j.b.None&&(null==r?void 0:r.EmailAddress)&&c)return W.EmailSenderName;if(a){const e=a.includes("Z")?a:`${a}Z`,t=new Date(e),i=new Date;if(Math.floor((i.getTime()-t.getTime())/864e5)<10)return W.LastAccessedByUser;if((null==r?void 0:r.EmailAddress)&&c){const e=c.includes("Z")?c:`${c}Z`;if(new Date(e)>t)return p?W.SentByUser:W.EmailSenderName}return W.LastAccessedByUser}}return(null==r?void 0:r.EmailAddress)&&c?p?W.SentByUser:W.EmailSenderName:d&&g?p?W.LastModifiedByUser:W.LastModifiedByContact:p&&a?W.LastAccessedByUser:g&&l?W.AuthorName:W.FallbackValue})(e,t,i,n),u=e.Author||(null===(s=null===(o=e.From)||void 0===o?void 0:o.EmailAddress)||void 0===s?void 0:s.Name)||"",h=(null===(a=null===(r=e.From)||void 0===r?void 0:r.EmailAddress)||void 0===a?void 0:a.Name)||"";switch(c){case W.AuthorName:return d("userCreatedOnDate",u,H(e.DateCreated));case W.DateCreatedByUser:return d("youCreatedOnDate",H(e.DateCreated));case W.UserCreatedBy:return d("userCreatedBy",u);case W.LastAccessedByUser:return d("youOpenedOnDate",H(e.DateAccessed));case W.LastModifiedByUser:return d("youModifiedOnDate",H(e.DateModified));case W.LastModifiedByContact:return d("userModifiedOnDate",u,H(e.DateModified));case W.EmailSenderName:return d("userSentOnDate",h,H(e.SharedDateTime));case W.SentByUser:return d("youSentOnDate",H(e.SharedDateTime));case W.FallbackValue:return void 0!==e.SecondaryText?e.SecondaryText:d("weFoundThisFile");default:throw new Error(c)}};var G=i(29906),Q=i(83010),K=i(27603),$=i(66008);const J=(0,i(17298).f)("IDefaultInlineSuggestionItems");var Z=i(56489),Y=i(71641),X=i(83817),ee=i(96821);let te=class{constructor(e,t,i,n,s,g,p,m,f,v,_,y,I,C,T){this.hostSettings=e,this.logger=t,this.oaResultStore=i,this._hostEmitter=n,this._messageExtensionAppDataProvider=s,this._queryDetection=g,this._proofingDom=p,this._paragraphTextExtractor=m,this._guidGenerator=f,this._localizer=v,this._tileContent=_,this._languageScriptDirectionDetector=y,this._oaMetric=I,this.defaultInlineSuggestionItems=C,this.themeStore=T,this._fileCount=0,this._queryCorrelationKeys=void 0,this._unscopedNodeId=void 0,this._hybrid=!1,this._enableExpandedECCSearchBar=void 0,this.onRestoreFocus=(e,t)=>{t()},this.onFeedbackButtonClicked=()=>{var e,t,i,n,o;if(!(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.onFeedbackButtonClicked))return;const s=[];this.suggestions.map((e=>{e.entities.map((e=>{s.push(e)}))}));const r={conversationId:null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.conversationId,logicalId:null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId,sessionId:null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId,query:this.queryString,entities:s};this.hostSettings.serviceSettings.ECCFeedbackSettings.onFeedbackButtonClicked(r)},this._profilePicturesUrlsCache={},this._peopleSuggestionsAwaitingProfilePicture=[],this.triggerMethod=void 0,this.menuPositionNoteId="",this.menuPositionQueryRange=void 0,this.isDividerShown=!1,this.isLoading=!0,this.isError=!1,this.resultStatus=void 0,this.resultReset=!1,this.queryString="",this.searchBoxQueryString="",this.noSuggestionsHeaderInfo=void 0,this.keyboardHandlerTarget=new S.E,this.menuType=void 0,this.overrideTargetLocation=void 0,this.queryChar=void 0,this.initialMenuPosition=0,this.enableScopedHeader=!1,this.newEntityTypes=void 0,this.newItemsById=void 0,this._isCardVisible=!1,this._isFirstMenuUpdate=!1,this._suggestions=void 0,this._preloadedSuggestions=void 0,this.isFlightEnabled=e=>(this.hostSettings.flightsToTrack||[]).includes(e),this.inlineSuggestionsStrings=(0,B.$)().getStringsFor("InlineSuggestionStrings"),this.calloutStrings=(0,B.$)().getStringsFor("OnCanvasCalloutStrings"),this.setQueryString=e=>{this.queryString=e},this.setSearchBoxQueryString=e=>{this.searchBoxQueryString=e},this.setInitialMenuPosition=e=>{this.initialMenuPosition=e},this.setPreloadedSuggestions=(e,t)=>{this._preloadedSuggestions=this.convertNewSuggestions(e,void 0,t,void 0,!0,!0),this.isLoading=0===this._preloadedSuggestions.length,this.resultStatus=d.i.Success},this.clearPreloadedSuggestions=()=>{this._preloadedSuggestions=[]},this.handleExternalKeyboardEvents=(e,t)=>{if(t&&!this.enableExpandedECC)return!1;switch(e){case R.m.arrowDown:return this.onUserInteraction(e),this.keyboardHandlerTarget.onKeyPressed(A.h.ArrowDown,t);case R.m.arrowUp:return this.onUserInteraction(e),this.keyboardHandlerTarget.onKeyPressed(A.h.ArrowUp,t);case R.m.arrowLeft:return this.onUserInteraction(e),this.keyboardHandlerTarget.onKeyPressed(A.h.ArrowLeft,t);case R.m.arrowRight:return this.onUserInteraction(e),this.keyboardHandlerTarget.onKeyPressed(A.h.ArrowRight,t);case R.m.home:return this.keyboardHandlerTarget.onKeyPressed(A.h.Home,t);case R.m.end:return this.keyboardHandlerTarget.onKeyPressed(A.h.End,t);case R.m.tab:return this.enableExpandedECC?this.keyboardHandlerTarget.onKeyPressed(A.h.Tab,t):this.handleTabEnterKeyboardEvents(e,t);case R.m.enter:return this.handleTabEnterKeyboardEvents(e,t);default:this.logger.logDiagnostics("[InlineSuggestionStore] unexpected keyboard event",{key:e})}return this.onUserInteraction(e),!1},this.handleTabEnterKeyboardEvents=(e,t)=>{if(this.isError)this.onAction(b.L.Retry);else{if(!this.isEmpty)return this.onUserInteraction(e),this.keyboardHandlerTarget.onKeyPressed(A.h.Enter,t);this.onAction(b.L.ClearSearch)}return!0},this.onGroupSelected=e=>{var t,i,n;if(!(null===(i=null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===i?void 0:i.enabled))return;const o=e.suggestions[0],s=null==o?void 0:o.entityType,r=e.isScoped;(r||this.hostSettings.oaSettings.mockResults)&&this.reset({scope:r?void 0:s,dueToScope:!0}),null===(n=this._onGroupSelected)||void 0===n||n.call(this,e);const a=!r&&s?{entityType:s,contentSources:o.GroupContentSources}:void 0;if(this.setScope(a,null==o?void 0:o.nodeId),!this.hostSettings.oaSettings.mockResults){const e={results:[],isLoading:!0,resultStatus:void 0,queryCorrelationKeys:this._queryCorrelationKeys?Object.assign(Object.assign({},this._queryCorrelationKeys),{scopeInfo:a}):void 0,nodeId:void 0,resultReset:!0};this.queryString="",this.searchBoxQueryString="",this.updateState(e)}},this.onItemSelected=e=>{var t,i,n,o;const s=e;if((null===(i=null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===i?void 0:i.enabled)&&s.scopeInfo&&s.entityType===l.c.Scope)return this._unscopedNodeId=s.nodeId,void this.setScope(s.scopeInfo,s.nodeId);if("feedback"!==e.key)if(e.entityType&&e.key){const t=e.entityType;this.resetScope(t)}else if(s.type!==l.c.Scope)null===(o=this._onItemSelected)||void 0===o||o.call(this,s);else{const t=null===(n=e.scopeInfo)||void 0===n?void 0:n.entityType;this.resetScope(t)}else this.onFooterAction(a._R.Feedback)},this.getBestParentElement=e=>{var t;const i=e&&this._tileContent.getContainingElement(e);if(i)return null!==(t=(0,X.m)(i))&&void 0!==t?t:i},this.onUserInteraction=e=>{let t;switch(e){case R.m.arrowDown:t=D.rE;break;case R.m.arrowUp:t=D.cc;break;case R.m.enter:t=D.hk;break;case R.m.tab:t=D.g7;break;case void 0:t=D.l1;break;default:return}this.logger.logActivity(D.dm,void 0,[(0,c.n)("interaction",t)],this._queryCorrelationKeys)},this.onAction=e=>{var t;if(e===b.L.ClearSearch)this.oaResultStore.clearResults();(null===(t=this.currentScope)||void 0===t?void 0:t.entityType)&&this.restoreScope(),this._onAction&&this._onAction(e),this._hostEmitter.emit(u.pD.oaAnnotationsTriggered,{address:void 0,message:void 0})},this.restoreScope=()=>{this.setScope(void 0,this._unscopedNodeId),this._unscopedNodeId=void 0},this.getCurrentQueryString=()=>{var e,t;const i=null===(e=this._queryDetection)||void 0===e?void 0:e.getCurrentQuery(),n=null===(t=this._queryDetection)||void 0===t?void 0:t.getCurrentQueryTileId(),o=i&&n&&this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(n),i)||"";return this.searchBoxQueryString||o},this.onFooterAction=e=>{var t;null===(t=this._onFooterAction)||void 0===t||t.call(this,e)},this.getLocale=()=>this.hostSettings.defaultLocale,this.onFirstRender=()=>{var e,t,i,n,o,s,r,a,l,d,u,h,g,p,m,f;this._isCardVisible=!0,this.logger.logActivity(D.s1,void 0,[(0,c.n)("numOfSonoraSuggestionsDisplayed",null!==(t=null===(e=this._suggestions)||void 0===e?void 0:e.length)&&void 0!==t?t:-1),(0,c.n)("numOfSonoraFileSuggestionsDisplayed",this._fileCount),(0,c.n)("triggerCharacter",null!==(o=null===(n=null===(i=this._queryDetection)||void 0===i?void 0:i.getCurrentQuery())||void 0===n?void 0:n.prefix)&&void 0!==o?o:"@"),(0,c.n)("isUserInsertion",null===(a=null===(r=null===(s=this._queryDetection)||void 0===s?void 0:s.getCurrentQueryCorrelationKeys())||void 0===r?void 0:r.isUserInsertion)||void 0===a||a),(0,c.n)("source",null!==(u=null===(d=null===(l=this._queryDetection)||void 0===l?void 0:l.getCurrentQueryCorrelationKeys())||void 0===d?void 0:d.source)&&void 0!==u?u:""),(0,c.n)(D.JZ,!!this.hostSettings.enableKeptMetric),(0,c.n)("wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===(null===(h=this.menuType)||void 0===h?void 0:h.menuType)),(0,c.n)("menuType",(null!==(p=null===(g=this.menuType)||void 0===g?void 0:g.menuType)&&void 0!==p?p:"Unknown").replace("InlineSuggestions","").replace("MenuType","").replace("Results",""))]);const v=null===(m=this._queryDetection)||void 0===m?void 0:m.getCurrentQueryLogicalId();v&&(null===(f=this._oaMetric)||void 0===f||f.addMeasure(v,"InlineSuggestionRendered"))},this.onDismissed=async e=>{var t;this._isCardVisible=!1,await(null===(t=this._onDismissed)||void 0===t?void 0:t.call(this,e))},this.onProcessedResults=()=>{var e,t;const i=null===(e=this._queryDetection)||void 0===e?void 0:e.getCurrentQueryLogicalId();i&&this._queryCorrelationKeys&&(null===(t=this._oaMetric)||void 0===t||t.addMeasure(i,"InlineSuggestionProcessedResults"))},this.onRenderResults=()=>{var e,t;const i=null===(e=this._queryDetection)||void 0===e?void 0:e.getCurrentQueryLogicalId();i&&this._queryCorrelationKeys&&(null===(t=this._oaMetric)||void 0===t||t.commitEntry(i,"InlineSuggestionResultsRendered"))},this.updateState=e=>{e.results.length<1&&!this._onSuggestionsUpdated?this.updateInternalState(e,[]):(this._messageExtensionAppDataProvider?this._messageExtensionAppDataProvider.getAppDefinitionIdMap():Promise.resolve(void 0)).then((t=>{var i;const n=this.getCurrentQueryString(),o=this.convertNewSuggestions(e.results,e.queryCorrelationKeys,e.nodeId,t,e.isLocalSuggestion);this._onSuggestionsUpdated?this._onSuggestionsUpdated(o,n,(i=>Promise.resolve(this.convertNewSuggestions(i,e.queryCorrelationKeys,e.nodeId,t,!0))),e.resultStatus,e.isLoading,null===(i=this._queryDetection)||void 0===i?void 0:i.getCurrentScope(),e.resultReset,e.latency,this.menuType,this._supportedEntityTypes,void 0,e.resultSummary).then((t=>{var i,o;t?((null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.logicalId)&&(null===(o=this._oaMetric)||void 0===o||o.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionUpdated")),this.updateInternalState(Object.assign(Object.assign({},e),{isLoading:!(e.isLoading&&t.length>0)&&e.isLoading,resultStatus:t.length>0?d.i.Success:e.results.length>0&&0===t.length?d.i.NoResults:e.resultStatus}),t,n)):this.queryString=n})).catch((e=>this.logger.logDiagnostics(`Failed to convert suggestions: ${e}`))):this.updateInternalState(e,o)})).catch((e=>this.logger.logDiagnostics(`Failed to get ME app definitions: ${e}`)))},this._logResultStatus=(e,t,i,n)=>{const o=null!=i?i:this._guidGenerator.generate(),s=new Map([["QueryLength",this.queryString.length.toString()]]),r=((e,t,i,n,o)=>Object.assign(Object.assign(Object.assign({Version:2,TraceId:e,LocalTime:(new Date).toISOString(),Status:t},n&&{ProviderName:n}),i&&{Latency:i}),o&&{RequestParams:o}))(o,d.i[e],t,n,s);this.logger.logDiagnostics(D.vb,r)},this.updateInternalState=(e,t,i)=>{var n,o,s,r,a,l,c,u,h,g,p,m,f,v,_,y,I,C,S,b,T,E,N,x,w,L,F;this._suggestions=O.observable.array([]),this.isLoading=e.isLoading,this.resultStatus=e.resultStatus,this.resultReset=null!==(n=e.resultReset)&&void 0!==n&&n;let A=t;if(this._isFirstMenuUpdate&&(null===(s=null===(o=this.hostSettings.oaSettings)||void 0===o?void 0:o.scopesConfig)||void 0===s?void 0:s.enabled)&&this.hostSettings.oaSettings.scopesConfig.enableAutomaticScoping){const e=t.filter((e=>e.intent&&e.intent>0)).sort(((e,t)=>{var i,n;return(null!==(i=t.intent)&&void 0!==i?i:0)-(null!==(n=e.intent)&&void 0!==n?n:0)}))[0];e&&(void 0===e.isScopingEnabled||e.isScopingEnabled)&&(null!==(r=e.intent)&&void 0!==r?r:0)>(null!==(a=this.hostSettings.oaSettings.scopesConfig.automaticScopingIntentCutoff)&&void 0!==a?a:.9)&&(null===(l=this._queryDetection)||void 0===l||l.setCurrentScope({entityType:e.entityType},!1),A=t.filter((t=>t.entityType===e.entityType)))}if(void 0!==i)this.queryString=i;else{const e=null===(c=this._queryDetection)||void 0===c?void 0:c.getCurrentQuery(),t=null===(u=this._queryDetection)||void 0===u?void 0:u.getCurrentQueryTileId();if(e&&t)if(this._enableExpandedECCSearchBar&&void 0!==this.lastComposingBoxQuery){const i=Object.assign(Object.assign({},e),{start:this.initialMenuPosition+1,length:this.lastComposingBoxQuery.length});this.queryString=null!==(h=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),i))&&void 0!==h?h:""}else this.queryString=null!==(g=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),e))&&void 0!==g?g:"";else this.queryString=""}if(this.setIsError(e.resultStatus),this.noSuggestionsHeaderInfo=void 0,this.isLoading||e.resultStatus!==d.i.NoResults||(this.currentScope?this.noSuggestionsHeaderInfo={title:(0,ee.X)(this.currentScope.entityType),isScoped:!0,isScopingEnabled:!0,suggestions:[]}:this._menuDefaultNoSuggestionsHeaderInfo&&(this.noSuggestionsHeaderInfo=Object.assign({},this._menuDefaultNoSuggestionsHeaderInfo))),e.resultStatus===d.i.NoResults||e.resultStatus===d.i.Timeout||e.resultStatus===d.i.UnexpectedError)this._logResultStatus(e.resultStatus,e.latency);else if(e.resultStatus===d.i.Success){const t=this._guidGenerator.generate(),i=A.reduce(((e,t)=>e.concat(t.entities)),[]).filter((e=>e.providerName)).reduce(((e,t)=>{var i;const n=t.providerName;return e[n]||(e[n]=[]),e[n].push({Type:t.entityType,ReferenceId:null!==(i=t.entityId)&&void 0!==i?i:""}),e}),{});for(const[n,o]of Object.entries(i))if(this._logResultStatus(e.resultStatus,e.latency,t,n),n!==D.CL){const i=z((null===(p=e.queryCorrelationKeys)||void 0===p?void 0:p.logicalId)||"",(null===(m=e.queryCorrelationKeys)||void 0===m?void 0:m.conversationId)||"",t,D.R7,n,o);this.logger.logDiagnostics(D.AK,Object.assign({logicalId:(null===(f=e.queryCorrelationKeys)||void 0===f?void 0:f.logicalId)||""},i))}}const R=null===(v=this._queryDetection)||void 0===v?void 0:v.getCurrentQuery();this._queryCorrelationKeys=Object.assign(Object.assign({},e.queryCorrelationKeys),{logicalId:null!==(y=null===(_=e.queryCorrelationKeys)||void 0===_?void 0:_.logicalId)&&void 0!==y?y:"",conversationId:null!==(C=null===(I=e.queryCorrelationKeys)||void 0===I?void 0:I.conversationId)&&void 0!==C?C:"",triggerCharacter:null!==(T=null===(b=null===(S=this._queryDetection)||void 0===S?void 0:S.getCurrentQuery())||void 0===b?void 0:b.prefix)&&void 0!==T?T:"@",isEmptyQuery:!R||R.length===(null!==(N=null===(E=R.prefix)||void 0===E?void 0:E.length)&&void 0!==N?N:1),queryLength:R?R.length-(null!==(w=null===(x=R.prefix)||void 0===x?void 0:x.length)&&void 0!==w?w:1):0}),this._isFirstMenuUpdate=!1,(null===(L=e.queryCorrelationKeys)||void 0===L?void 0:L.logicalId)&&(null===(F=this._oaMetric)||void 0===F||F.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionInternalStateUpdated")),this.appendConvertedSuggestions(A,e)},this.appendConvertedSuggestions=(e,t)=>{var i,n,o,s,a,u,h,g,p,m,f,v,_,y,I,C,S,b,T,E,N,x,w,L,F,A,R,q;if(!this.isLoading&&!this.isError&&this.defaultInlineSuggestionItems)for(const t of this.defaultInlineSuggestionItems)for(const n of t(this.queryString,this.menuType,this.queryChar,this._supportedEntityTypes,null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.scopeInfo))e.push(n),this.resultStatus=d.i.Success;if(this._suggestions=e,this.fetchAndUpdateProfilePictureAndUpdateSuggestionsList(this._peopleSuggestionsAwaitingProfilePicture),this._fileCount=this._suggestions.filter((e=>e.entityType===l.c.File)).length||0,!this._isCardVisible||0===this._suggestions.length&&this.isLoading)return;const P=this._suggestions.reduce(((e,t)=>(e[t.entityType]=t.entities.length,e.total+=e[t.entityType],e)),{total:0}),{total:O}=P,z=(0,r.__rest)(P,["total"]);this.logger.logActivity(D.OY,void 0,[(0,c.n)("numOfSonoraSuggestionsDisplayed",O),(0,c.n)("numOfSuggestionsDisplayed",JSON.stringify(z)),(0,c.n)("status",null!==(n=t.resultStatus)&&void 0!==n?n:-1),(0,c.n)("responseCancelled",null!==(s=null===(o=t.resultSummary)||void 0===o?void 0:o.Cancelled)&&void 0!==s?s:0),(0,c.n)("responseEarlyExit",null!==(u=null===(a=t.resultSummary)||void 0===a?void 0:a.EarlyExit)&&void 0!==u?u:0),(0,c.n)("responseNoResults",null!==(g=null===(h=t.resultSummary)||void 0===h?void 0:h.NoResults)&&void 0!==g?g:0),(0,c.n)("responseSuccess",null!==(m=null===(p=t.resultSummary)||void 0===p?void 0:p.Success)&&void 0!==m?m:0),(0,c.n)("responseTimeout",null!==(v=null===(f=t.resultSummary)||void 0===f?void 0:f.Timeout)&&void 0!==v?v:0),(0,c.n)("responseUnexpectedError",null!==(y=null===(_=t.resultSummary)||void 0===_?void 0:_.UnexpectedError)&&void 0!==y?y:0),(0,c.n)("isError",this.isError),(0,c.n)("latency",null!==(I=t.latency)&&void 0!==I?I:-1),(0,c.n)("triggeringChar",null!==(S=null===(C=this._queryCorrelationKeys)||void 0===C?void 0:C.triggerCharacter)&&void 0!==S?S:"@"),(0,c.n)("queryLength",this.queryString.length),(0,c.n)("scopeType",null!==(E=null===(T=null===(b=this._queryCorrelationKeys)||void 0===b?void 0:b.scopeInfo)||void 0===T?void 0:T.entityType)&&void 0!==E?E:""),(0,c.n)("menuType",(null!==(x=null===(N=this.menuType)||void 0===N?void 0:N.menuType)&&void 0!==x?x:"Unknown").replace("InlineSuggestions","").replace("MenuType","").replace("Results","")),(0,c.n)("hybrid",this._hybrid)],this._queryCorrelationKeys);const W=(null===(L=null===(w=this.hostSettings.oaSettings)||void 0===w?void 0:w.scopesConfig)||void 0===L?void 0:L.enabled)?{HasClickableScopeHeader:!0}:void 0;this.logger.logDiagnostics(D.Ss,((e,t,i)=>({LogicalId:e,Version:2,LocalTime:(0,k.k)(new Date),LayoutType:"Vertical",ResultsView:M(t,i),PageNumber:0}))(null!==(A=null===(F=t.queryCorrelationKeys)||void 0===F?void 0:F.logicalId)&&void 0!==A?A:"",this._suggestions,W)),(null===(R=t.queryCorrelationKeys)||void 0===R?void 0:R.logicalId)&&(null===(q=this._oaMetric)||void 0===q||q.addMeasure(t.queryCorrelationKeys.logicalId,"InlineSuggestionAppendedConvertedSuggestions"))},this.setIsError=(e=void 0)=>{this.isError=e===d.i.UnexpectedError||e===d.i.Cancelled},this.convertNewSuggestions=(e,t,i,n,o,s)=>{var r,a,d,c,u;if(e.length<1)return[];const h=[];for(const c of e){const e=[];for(const u of c.entities){let c;switch(u.entityType.toLocaleLowerCase()){case l.c.File.toLocaleLowerCase():c=this.convertFileSuggestion(u);break;case l.c.People.toLocaleLowerCase():c=this.convertPeopleSuggestion(u),this._peopleSuggestionsAwaitingProfilePicture.push(c);break;case l.c.Topic.toLocaleLowerCase():c=this.convertTopicSuggestion(u);break;case l.c.MessageExtensionApp.toLocaleLowerCase():c=this.convertMessageExtensionAppSuggestion(u,n);break;case l.c.External.toLocaleLowerCase():c=(null===(r=this.hostSettings.oaSettings)||void 0===r?void 0:r.enableConnectorGroupHeadings)?this.convertGenericSuggestion(u):this.convertExternalSuggestion(u);break;case l.c.Event.toLocaleLowerCase():c=this.convertEventSuggestion(u);break;case l.c.Message.toLocaleLowerCase():c=this.convertEmailSuggestion(u);break;case l.c.Chat.toLocaleLowerCase():c=this.convertTeamsChatSuggestion(u);break;case l.c.Channel.toLocaleLowerCase():c=this.convertTeamsChannelSuggestion(u);break;case l.c.Team.toLocaleLowerCase():c=this.convertTeamSuggestion(u);break;case l.c.App.toLocaleLowerCase():c=this.convertAppSuggestion(u);break;case l.c.PIM.toLocaleLowerCase():c=this.convertPimSuggestion(u);break;default:c=this.convertGenericSuggestion(u)}if(!c)continue;c.logicalId=null==t?void 0:t.logicalId,c.nodeId=i;const h=c.type;if(!s&&(g=h,Object.values(l.c).includes(g))&&this._supportedEntityTypes&&!this._supportedEntityTypes.includes(h))continue;const p=new Date,m=c.id?null===(a=this.newItemsById)||void 0===a?void 0:a.get(c.id):void 0;m&&p<m&&(c.isNew=!0),(o||e.length<this.getMaxEntityCount(h,null===(d=this._queryDetection)||void 0===d?void 0:d.getCurrentScope()))&&e.push(c)}h.push(Object.assign(Object.assign({},c),{entities:e}))}var g;return(null===(c=this._queryCorrelationKeys)||void 0===c?void 0:c.logicalId)&&(null===(u=this._oaMetric)||void 0===u||u.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionConvertedSuggestions")),h},this.getMaxEntityCount=(e,t)=>{var i,n,o;const s=!!(null==t?void 0:t.entityType),r=s?null===(n=null===(i=this.hostSettings.oaSettings)||void 0===i?void 0:i.scopesConfig)||void 0===n?void 0:n.maxResults:(0,h.Z$)(null===(o=this.hostSettings.oaSettings)||void 0===o?void 0:o.entitiesEnabled,e);return null!=r?r:s?5:3},this.convertPeopleSuggestionToInlineSuggestion=async e=>{const t=this.convertPeopleSuggestion(e);return await this.fetchAndUpdateProfilePicture(t),t},this.convertLoopSuggestionToInlineSuggestion=e=>this.convertGenericSuggestion(e),this.convertFileSuggestion=e=>{var t,i;if(!(e.AccessUrl&&e.FileName&&e.FileExtension&&e.FileSourceType))return;const{FileExtension:n,FileName:o,FileSourceType:s,AccessUrl:r}=e,a=function(e){if(!e)return"";const t=e.lastIndexOf(".");return t>-1?e.substring(0,t):e}(o);let d="";try{const i=null===(t=this.hostSettings.userId)||void 0===t?void 0:t.userDisplayName,n=(this.hostSettings.flightsToTrack||[]).includes("mc-editor-enable-files-new-tidbits");d=V(e,i,n,0===this.queryString.length)}catch(e){this.logger.logDiagnostics("[InlineSuggestionStore] tidbit generation failed")}return Object.assign(Object.assign({},e),{type:l.c.File,sourceType:this.getInlineFileSuggestionSourceType(s),fileName:o,hitFileName:a,fileExtension:n,url:r,lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:null!==(i=e.FileSize)&&void 0!==i?i:0,subject:d,titleHitHighlightProperty:"hitFileName",subtitleHitHighlightProperty:"subject"})},this.convertPeopleSuggestion=e=>{var t,i,n;const o=null!==(i=null!==(t=this.getPeopleSuggestionEmailAddress(e))&&void 0!==t?t:e.JobTitle)&&void 0!==i?i:"no email";let s=e.imageUrl;s||(s=this._profilePicturesUrlsCache[o]);const r=e.subtitlePropertyOverride;return Object.assign(Object.assign({},e),{ReferenceId:e.ReferenceId||e.entityId,type:l.c.People,displayName:e.text,primaryEmailAddress:o,subtitleOverride:r?e[r]:void 0,imageUrl:s,titleHitHighlightProperty:"displayName",subtitleHitHighlightProperty:null!==(n=r)&&void 0!==n?n:"primaryEmailAddress"})},this.getDefaultProfilePictureUrl=e=>`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e}&default=none`,this.convertTopicSuggestion=e=>Object.assign(Object.assign({},e),{type:e.entityType,id:e.TopicId,title:e.DisplayName,subtitle:e.Description,iconName:"Hashtag",tooltip:e.Description}),this.resetScope=e=>{this.reset({scope:e,isLoading:!0,resultReset:!0,dueToScope:!0}),this.setScope(e?{entityType:e}:void 0)},this.convertMessageExtensionAppSuggestion=(e,t)=>{const i=!!t&&t.get(e.AppId);if(i&&this.isMessageExtensionAppInstalled(i.State))return Object.assign(Object.assign({},e),{type:e.entityType,id:e.AppId,title:e.DisplayName,subtitle:i.Description,imageUrl:i.IconUrl,tooltip:i.Description})},this.convertExternalSuggestion=e=>{var t;const i=this.getExternalTidbit(e);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.ItemId,title:e.text,subtitle:i,tooltip:e.text}),!e.IconUrl&&{iconName:null===(t=e.icon)||void 0===t?void 0:t.iconName}),e.IconUrl&&{imageUrl:e.IconUrl}),{subtitleHitHighlightProperty:"ContentDomainName"})},this.convertEventSuggestion=e=>Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,eventId:e.OriginalId||e.entityId||e.text,eventName:e.text,eventStartDateTime:e.Start,eventEndDateTime:e.End,isAllDay:e.IsAllDay,isSeries:!!e.SeriesMasterId,hasRecording:e.HasRecording}),this.convertEmailSuggestion=e=>{var t,i,n,o,s,r;return Object.assign(Object.assign({},e),{type:l.c.Message,id:e.text,subject:e.Subject,sender:null!==(r=null!==(n=null===(i=null===(t=e.From)||void 0===t?void 0:t.EmailAddress)||void 0===i?void 0:i.Name)&&void 0!==n?n:null===(s=null===(o=e.From)||void 0===o?void 0:o.EmailAddress)||void 0===s?void 0:s.Address)&&void 0!==r?r:"",emailId:e.ItemId.Id})},this.convertAppSuggestion=e=>Object.assign(Object.assign({},e),{id:e.CollectorId,type:l.c.App,title:e.Title,imageUrl:e.IconAnonymousUrl}),this.convertTeamsChatSuggestion=e=>{var t,i,n,o,s,r,a,l,d,c;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{id:e.text}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),{type:e.entityType,title:e.Name,name:e.Name,threadId:e.ThreadId,threadType:null!==(o=null===(n=e.ThreadType)||void 0===n?void 0:n.toString())&&void 0!==o?o:"",teamName:e.Name,groupId:e.GroupId,matchingMembers:null!==(r=null===(s=e.MatchingMembers)||void 0===s?void 0:s.map((e=>this.convertPeopleResultToInlinePerson(e))))&&void 0!==r?r:[],chatMembers:null!==(l=null===(a=e.ChatMembers)||void 0===a?void 0:a.map((e=>this.convertPeopleResultToInlinePerson(e))))&&void 0!==l?l:[],totalChatMembersCount:null!==(d=e.TotalChatMembersCount)&&void 0!==d?d:0,lastMessageTime:null!==(c=e.LastMessageTime)&&void 0!==c?c:"",imageUrl:e.IconUrl})},this.convertPeopleResultToInlinePerson=e=>{var t,i,n;return Object.assign({type:e.entityType,displayName:null!==(t=e.DisplayName)&&void 0!==t?t:"",primaryEmailAddress:null===(i=e.EmailAddresses)||void 0===i?void 0:i[0],iconName:null===(n=e.icon)||void 0===n?void 0:n.iconName},e)},this.convertTeamsChannelSuggestion=e=>{var t,i;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,subtitle:this._localizer.getMessage("channelOfTeamLabel",e.TeamName),tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})},this.convertTeamSuggestion=e=>{var t,i;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})},this.convertPimSuggestion=e=>{const t=this.getIconNameForPimType(e.IntentId),i=this.getSubtitleForPimTypeEntity(e);return Object.assign(Object.assign({},e),{type:l.c.PIM,id:e.text,title:e.text,tooltip:e.text,subtitle:i,iconName:t})},this.convertGenericSuggestion=e=>{var t,i,n,o,s,r;let a=e.entityType,d=e.subtitle,c=null!==(t=e.tooltip)&&void 0!==t?t:"";const u=a===l.c.Scope,h=(u?e.ScopeDisplayName:e.text)||"";if(a.toLocaleLowerCase()===l.c.External.toLocaleLowerCase()&&(null===(i=this.hostSettings.oaSettings)||void 0===i?void 0:i.enableConnectorGroupHeadings)&&e.GroupDisplayName){const t=this.getExternalTidbit(e);a=e.GroupDisplayName,d=t,c=h}let g=null===(n=e.icon)||void 0===n?void 0:n.iconName;u&&(g="Meetings"===e.ScopeDisplayName?"Event":e.ScopeDisplayName);let p=!1;const m=new Date;if(u&&this.newEntityTypes&&(this.hostSettings.flightsToTrack||[]).includes("mc-editor-oa-forward-slash")&&(this.hostSettings.flightsToTrack||[]).includes("mc-editor-oa-new-tag"))for(const t of this.newEntityTypes){const i=new Date(t[1]);t[0]===(null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType)&&m<=new Date(i.setDate(i.getDate()+14))&&(p=!0)}return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:a,id:null!==(r=null!==(s=e.id)&&void 0!==s?s:e.Id)&&void 0!==r?r:e.text,title:h,subtitle:d,tooltip:c}),!e.IconUrl&&{iconName:g}),e.IconUrl&&{imageUrl:e.IconUrl}),{isNew:p})},this.getInlineFileSuggestionSourceType=e=>{switch(e){case"ClassicAttachment":return b.x.ClassicAttachment;case"OneDriveForBusiness":return b.x.OneDriveForBusiness;case"SharepointOnline":return b.x.SharepointOnline;default:return b.x.Undefined}},this.isMessageExtensionAppInstalled=e=>!!e&&e!==o.NotInstalled,this.getIconNameForPimType=e=>{let t="PhoneNumber";return e===Y.Nm.Address?t="Location":e===Y.Nm.Membership&&(t="Member"),t},this.getSubtitleForPimTypeEntity=e=>{var t;let i="";return e.entityType===l.c.PIM?i=null!==(t=e.SecondaryText)&&void 0!==t?t:"":"Phones"in e&&e.Phones&&e.Phones.length>0&&e.Phones[0].Type&&(i=e.Phones[0].Type),i},(0,q.Gn)(this),this.oaResultStore.setOnUpdate(this.updateState),this.reset()}get oaSettings(){return this.hostSettings.oaSettings}get isFeedbackEnabled(){return!0===this.hostSettings.isFeedbackEnabledForEcc}get isFeedbackButtonEnabled(){var e,t;return!0===(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.isFeedbackButtonEnabled)}get isRtl(){var e,t;return null!==(t=null===(e=this._languageScriptDirectionDetector())||void 0===e?void 0:e.isRtl())&&void 0!==t&&t}startNewECCMenu(e,t,i,n,o,s,r,a,l,d,c,u,h,g,p,m,f){var v,_,y,I,C,S;this._onItemSelected=t,this.onItemFocused=i,this._onAction=n,this._onFooterAction=o,this._onSuggestionsUpdated=s,this._onGroupSelected=r,this.onPreventDismissOnEvent=a,this.onRestoreFocus=l,this._onDismissed=d,this.onSearchBoxQueryChange=f,this.overrideTargetLocation=u,this._supportedEntityTypes=e.supportedEntityTypes,this.isDividerShown=e.isDividerShown,this.menuType=e.menuType,this._menuDefaultNoSuggestionsHeaderInfo=e.noSuggestionsHeaderInfo,this.newEntityTypes=e.newEntityTypes,this.newItemsById=e.newItemsById,this.style=e.style,this.styles=e.styles,this.theme=function(e,t,i){const n=null==t?void 0:t.getComponentActiveTheme(i?Z.yF.expandedInlineSuggestionComponentName:Z.yF.inlineSuggestionComponentName);let o;e&&(o=JSON.parse(JSON.stringify(e)));return o=ie(o,n),o}(e.theme,this.themeStore,!0===e.enableExpandedECC),this.showMoreEntitiesConfig=e.showMoreEntitiesConfig,this.browseThisComputerConfig=e.browseThisComputerConfig,this.appGptConfig=e.appGptConfig,this.enableExpandedECC=e.enableExpandedECC,this.queryChar=e.triggerCharacter,this._hybrid=null!==(y=null===(_=null===(v=this.hostSettings.serviceSettings)||void 0===v?void 0:v.hybridAugloop)||void 0===_?void 0:_.enabled)&&void 0!==y&&y,this.enableScopedHeader=(void 0===e.enableScopedHeader||e.enableScopedHeader)&&"InlineSuggestionsResultsUserInitiatedMenuType"===e.menuType.menuType&&!0===(null===(C=null===(I=this.hostSettings.oaSettings)||void 0===I?void 0:I.scopesConfig)||void 0===C?void 0:C.enabled),this.expandedEccSearchBarConfig=e.expandedEccSearchBarConfig,this.removeComposingBoxQuery=h,this.updateComposingBoxQuery=g,this.handleKeyDown=p,this.fluentTheme=null===(S=this.themeStore)||void 0===S?void 0:S.getExpandedEccFluentTheme(),this._isFirstMenuUpdate=!0,this.triggerMethod=m,this._enableExpandedECCSearchBar=e.enableExpandedECCSearchBar,this.reset(c)}getCalloutStateStoreProps(){if(this.menuType)return this}reset(e){var t,i;if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.mockResults)this.resetData(),this.mockAnnotations(null==e?void 0:e.scope);else if(this._onSuggestionsUpdated){this.resetData(!1,e);const t=this.getNewCorrelationKeys(),n={results:[],isLoading:void 0!==(null==e?void 0:e.isLoading)?e.isLoading:this.isLoading,resultStatus:this.resultStatus,queryCorrelationKeys:null!==(i=this._queryCorrelationKeys)&&void 0!==i?i:t,nodeId:void 0,resultReset:void 0===(null==e?void 0:e.resultReset)||e.resultReset};this.queryString="",(null==e?void 0:e.dueToScope)||(this.searchBoxQueryString=""),this.updateState(n)}else this.resetData(!0,e)}resetData(e=!0,t){const i=()=>{this._suggestions=O.observable.array([]),this._fileCount=0,this.isLoading=void 0===(null==t?void 0:t.isLoading)||t.isLoading,this.isError=!1,this.resultStatus=void 0,this.resultReset=void 0===(null==t?void 0:t.resultReset)||t.resultReset,this._queryCorrelationKeys=void 0,this._profilePicturesUrlsCache={},this._peopleSuggestionsAwaitingProfilePicture=[]};e?(0,O.runInAction)(i):i()}mockAnnotations(e){var t;switch(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.mockResultState){case"Loading":this.isLoading=!0;break;case"NoResult":this.isLoading=!1,this._suggestions=O.observable.array([]);break;case"Error":this.isLoading=!1,this._suggestions=O.observable.array([]),this.resultStatus=d.i.UnexpectedError,this.isError=!0;break;default:this.isLoading=!1,i.e(6008).then(i.bind(i,82899)).then((t=>{(0,O.runInAction)((()=>{this._suggestions=this.convertNewSuggestions(t.mockInlineSuggestions.filter((t=>!e||t.entityType===e)),void 0,void 0,void 0,!0)}))}))}}get isEmpty(){return 0===this.suggestions.length}get preloadedSuggestions(){var e;return null!==(e=this._preloadedSuggestions)&&void 0!==e?e:[]}get suggestions(){var e,t,i;if(!this.resultReset&&(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(void 0===this.currentScope||this._preloadedSuggestions.some((e=>{var t;return e.entityType===(null===(t=this.currentScope)||void 0===t?void 0:t.entityType)})))){const e=this._preloadedSuggestions;return[...e,...(null!==(t=this._suggestions)&&void 0!==t?t:[]).filter((t=>!e.some((e=>e.entityType===t.entityType))))]}return null!==(i=this._suggestions)&&void 0!==i?i:[]}get currentScope(){var e;return null===(e=this._queryDetection)||void 0===e?void 0:e.getCurrentScope()}get unsupportedEntities(){var e;return null===(e=this._queryDetection)||void 0===e?void 0:e.getUnsupportedEntities()}setComposingBoxQuery(e){this.lastComposingBoxQuery=e}get expandedECCHeader(){const e=(0,B.$)().getStringsFor("InlineSuggestionStrings");if(!this.enableExpandedECC||!this._supportedEntityTypes)return[{type:l.c.Scope,title:e("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}];const t=this._supportedEntityTypes.map((e=>{var t;return{type:l.c.Scope,title:(0,ee.X)(e),iconName:e,scopeInfo:{entityType:e},isSelected:1===(null===(t=this._supportedEntityTypes)||void 0===t?void 0:t.length),id:e}}));return this._supportedEntityTypes.length>1&&t.unshift({type:l.c.Scope,title:e("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}),t}getNewCorrelationKeys(){var e,t,i,n,o,s;const r=null===(e=this._queryDetection)||void 0===e?void 0:e.getCurrentQuery(),a=null===(t=this._queryDetection)||void 0===t?void 0:t.getCurrentQueryCorrelationKeys();if(!r||!a)return{logicalId:"",conversationId:"",isEmptyQuery:!0,queryLength:0};return Object.assign(Object.assign({},a),{isEmptyQuery:r.length===(null!==(n=null===(i=r.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1),isTimeout:!1,queryLength:r.length-(null!==(s=null===(o=r.prefix)||void 0===o?void 0:o.length)&&void 0!==s?s:1)})}setMenuPositionNoteId(e){this.menuPositionNoteId=e}setMenuPositionQueryRange(e){this.menuPositionQueryRange=e}setScope(e,t){var i,n,o,s,r,a;null===(i=this._queryDetection)||void 0===i||i.setCurrentScope(e);const l=this._proofingDom.findParagraphNode(t||(null===(n=this._queryDetection)||void 0===n?void 0:n.getCurrentQueryTileId())||this.menuPositionNoteId||"");!(null===(o=this._queryDetection)||void 0===o?void 0:o.getCurrentQuery())&&this.menuPositionQueryRange&&l&&(null===(s=this._queryDetection)||void 0===s||s.setCurrentQueryRange(l.id,this.menuPositionQueryRange,void 0,e,this.queryChar));const d=null===(r=this._queryDetection)||void 0===r?void 0:r.getCurrentQuery();if(!l)return;this.hostSettings.oaSettings&&!this.hostSettings.oaSettings.mockResults&&this.oaResultStore.updateLoadingStatus(!0);const c=new T.s(Object.assign(Object.assign({deltaType:E.WI.Update,unit:E.OD.Chars,position:(null==d?void 0:d.start)||0,additionalData:null===(a=this._queryDetection)||void 0===a?void 0:a.getCurrentQueryCorrelationKeys()},d&&{queryRange:d}),{content:"",userInfo:{userType:E.HS.SessionUser}})),h=(0,N.F)(l);this._hostEmitter.emit(u.pD.hostModelDelta,{address:void 0,message:{tileId:l.id,tileVersion:l.eventSeqId||0,documentModel:null==h?void 0:h.documentModel,delta:c,sourceType:g.p.ParagraphNode,changeType:g.Q.Code,deletedOrReplacedCharacters:void 0}});const m=this.getBestParentElement(l);if(!(null==m?void 0:m.ownerDocument.defaultView))return;const f=new p.J(m.ownerDocument.defaultView);f.addListener("focus",(e=>{e.stopPropagation(),f.removeAllListeners()}),{capture:!0,once:!0}),m.focus()}async fetchAndUpdateProfilePicture(e){if(!e.primaryEmailAddress)return;if(e.imageUrl)return e.imageUrl;if(this._profilePicturesUrlsCache[e.primaryEmailAddress])return this._profilePicturesUrlsCache[e.primaryEmailAddress];const t=await this.getProfilePictureUrl(e.primaryEmailAddress);return this._profilePicturesUrlsCache[e.primaryEmailAddress]=t,e.imageUrl=t,t}async fetchAndUpdateProfilePictureAndUpdateSuggestionsList(e){var t,i;for(const n of e)(null===(t=this._queryCorrelationKeys)||void 0===t?void 0:t.logicalId)&&(null===(i=this._oaMetric)||void 0===i||i.startEntry(this._queryCorrelationKeys.logicalId+n.Id,this._queryCorrelationKeys));const n=new Map,o=new Map;await Promise.all(e.map((async e=>{const t=await this.fetchAndUpdateProfilePicture(e);n.set(e,t),o.set(e.primaryEmailAddress,e)}))),(0,O.runInAction)((()=>{var t,i,s,r,a;for(const o of e){n.get(o)?(null===(s=this._queryCorrelationKeys)||void 0===s?void 0:s.logicalId)&&(null===(r=this._oaMetric)||void 0===r||r.commitEntry(this._queryCorrelationKeys.logicalId+o.Id,"Success","ProfilePictureLoadingTime")):(null===(t=this._queryCorrelationKeys)||void 0===t?void 0:t.logicalId)&&(null===(i=this._oaMetric)||void 0===i||i.commitEntry(this._queryCorrelationKeys.logicalId+o.Id,"Error","ProfilePictureLoadingTime"))}if(!(null===(a=this._suggestions)||void 0===a?void 0:a.length))return;const d=this._suggestions.findIndex((e=>e.entityType===l.c.People));if(-1===d)return;const c=this._suggestions[d];for(let e=0;e<c.entities.length;e++){const t=c.entities[e],i=this.getPeopleSuggestionEmailAddress(t);if(void 0===i)continue;const s=o.get(i);if(void 0===s)continue;const r=n.get(s);void 0!==r&&(c.entities[e]=Object.assign(Object.assign({},t),{imageUrl:r}))}this._suggestions[d]=c,this._suggestions=[...this._suggestions]}))}async getProfilePictureUrl(e){var t;if(null==e?void 0:e.includes("@")){if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.getProfilePictureUrl){return await this.hostSettings.oaSettings.getProfilePictureUrl(e)}return this.getDefaultProfilePictureUrl(e)}return""}getPeopleSuggestionEmailAddress(e){return(0,O.isObservableArray)(e.EmailAddresses)||Array.isArray(e.EmailAddresses)?e.EmailAddresses[0]:e.EmailAddresses}getExternalTidbit(e){let t="";try{const i=(0,B.$)().getStringsFor("InlineSuggestionStrings");e.ContentDomainName?t=e.ContentDomainName:e.LastModifiedDateTimeUtc&&(t=`${i("lastModifiedDateLabel")} ${(0,U.Z)(new Date(e.LastModifiedDateTimeUtc),new Date)}`)}catch(e){this.logger.logDiagnostics("[InlineSuggestionStore] external tidbit generation failed")}return t}};function ie(e,t){if(!e)return t;if(t)for(const i in t){const n=i;"object"==typeof t[n]?e[n]?ie(e[n],t[n]):e[n]=t[n]:e[n]||(e[n]=t[n])}return e}(0,r.__decorate)([O.observable],te.prototype,"isDividerShown",void 0),(0,r.__decorate)([O.observable],te.prototype,"isLoading",void 0),(0,r.__decorate)([O.observable],te.prototype,"isError",void 0),(0,r.__decorate)([O.observable],te.prototype,"resultStatus",void 0),(0,r.__decorate)([O.observable],te.prototype,"resultReset",void 0),(0,r.__decorate)([O.observable],te.prototype,"queryString",void 0),(0,r.__decorate)([O.observable],te.prototype,"searchBoxQueryString",void 0),(0,r.__decorate)([O.observable],te.prototype,"noSuggestionsHeaderInfo",void 0),(0,r.__decorate)([O.observable],te.prototype,"menuType",void 0),(0,r.__decorate)([O.observable],te.prototype,"overrideTargetLocation",void 0),(0,r.__decorate)([O.observable],te.prototype,"queryChar",void 0),(0,r.__decorate)([O.observable],te.prototype,"initialMenuPosition",void 0),(0,r.__decorate)([O.observable],te.prototype,"lastComposingBoxQuery",void 0),(0,r.__decorate)([O.observable],te.prototype,"newEntityTypes",void 0),(0,r.__decorate)([O.observable],te.prototype,"newItemsById",void 0),(0,r.__decorate)([O.observable],te.prototype,"_isCardVisible",void 0),(0,r.__decorate)([O.observable],te.prototype,"_isFirstMenuUpdate",void 0),(0,r.__decorate)([O.observable],te.prototype,"_suggestions",void 0),(0,r.__decorate)([O.observable],te.prototype,"_preloadedSuggestions",void 0),(0,r.__decorate)([O.action],te.prototype,"startNewECCMenu",null),(0,r.__decorate)([O.action],te.prototype,"mockAnnotations",null),(0,r.__decorate)([O.computed],te.prototype,"isEmpty",null),(0,r.__decorate)([O.computed],te.prototype,"preloadedSuggestions",null),(0,r.__decorate)([O.computed],te.prototype,"suggestions",null),(0,r.__decorate)([O.action],te.prototype,"setQueryString",void 0),(0,r.__decorate)([O.action],te.prototype,"setSearchBoxQueryString",void 0),(0,r.__decorate)([O.action],te.prototype,"setInitialMenuPosition",void 0),(0,r.__decorate)([O.action],te.prototype,"setComposingBoxQuery",null),(0,r.__decorate)([O.action],te.prototype,"setPreloadedSuggestions",void 0),(0,r.__decorate)([O.action],te.prototype,"clearPreloadedSuggestions",void 0),(0,r.__decorate)([O.action],te.prototype,"onGroupSelected",void 0),(0,r.__decorate)([O.action],te.prototype,"onItemSelected",void 0),(0,r.__decorate)([O.action],te.prototype,"updateInternalState",void 0),(0,r.__decorate)([O.action],te.prototype,"appendConvertedSuggestions",void 0),(0,r.__decorate)([O.action],te.prototype,"setIsError",void 0),te=(0,r.__decorate)([(0,G._)(),(0,r.__param)(0,(0,Q.W)(m.n)),(0,r.__param)(1,(0,Q.W)(f.m)),(0,r.__param)(2,(0,Q.W)(F.C)),(0,r.__param)(3,(0,Q.W)(u.M5)),(0,r.__param)(4,(0,K.l)()),(0,r.__param)(4,(0,Q.W)(P.Z)),(0,r.__param)(5,(0,Q.W)(v.J)),(0,r.__param)(6,(0,Q.W)(x.w)),(0,r.__param)(7,(0,Q.W)(w.b)),(0,r.__param)(8,(0,Q.W)(_.G)),(0,r.__param)(9,(0,Q.W)(y.H)),(0,r.__param)(10,(0,Q.W)(L.d)),(0,r.__param)(11,(0,Q.W)(I.aP)),(0,r.__param)(12,(0,K.l)()),(0,r.__param)(12,(0,Q.W)(C.u)),(0,r.__param)(13,(0,K.l)()),(0,r.__param)(13,(0,$.t)(J)),(0,r.__param)(14,(0,K.l)()),(0,r.__param)(14,(0,Q.W)(Z.YQ))],te)},81814:(e,t,i)=>{i.d(t,{g:()=>b});var n=i(23182),o=i(84030),s=i(71632),r=i(99724),a=i(33767),l=i(15661),d=i(14600),c=i(24111),u=i(25622),h=i(2599),g=i(81174),p=i(78426),m=i(33727),f=i(95537),v=i(71418),_=i(19728),y=i(29906),I=i(83010),C=i(27603),S=i(37814);let b=class{constructor(e,t,i,n,r,a,l,d,c,u){this._hostSettings=e,this._oaLogger=t,this._oaMetric=i,this._tileContent=n,this._queryDetection=r,this._proofingDom=a,this._hostEmitter=l,this._shadowElementsStore=d,this._targetWindowFactory=u,this.displayCallout=void 0,this.hostModelVisualStateChange=e=>{e.message.created&&this._lastUpdate&&this.setDisplayCallout(this._lastUpdate.displayCallout,this._lastUpdate.menuInfo,this._lastUpdate.calloutProps).catch((e=>{this._oaLogger.logDiagnostics("Error setting display callout",e)}))},this.setDisplayCallout=async(e,t,i)=>{var n;this._lastUpdate={displayCallout:e,menuInfo:t,calloutProps:i};const s=this._queryDetection.getCurrentQueryLogicalId();if(e&&t&&i){let e=i.overrideTargetLocation;if(!e){const i=await this.getTargetLocationOfECC(t.tileId,t.queryRange,t.targetOffset);if(!i)return;if(this._queryDetection.getCurrentQueryLogicalId()!==s)return;e=i}"x"in e&&void 0!==e.x&&"InlineSuggestionsResultsFlagMenuType"===t.menuType.menuType&&(e.x=e.x-11),t.targetLocation=e;const r=this._queryDetection.getCurrentQueryLogicalId();r&&this._oaMetric.addMeasure(r,"InlineSuggestionsCalloutDisplay");const a=i.isRtl,l=i.queryChar,d=(0,_.toJS)(null===(n=i.styles)||void 0===n?void 0:n.containerStyles);(0,_.runInAction)((()=>{var t,n;this.displayCallout={calloutProps:i,targetLocation:e,targetWindow:null!==(n=null===(t=this._targetWindowFactory)||void 0===t?void 0:t.call(this))&&void 0!==n?n:new o.O(window),directionalHintCallback:(e,t,i)=>this.directionalHintCallback(e,t,i,a),maxHeightCallback:(e,t)=>this.maxHeightCallback(e,t,l,d)}}))}else this.closeMenu()},this.directionalHintCallback=(e,t,i,n)=>this._inlineSuggestionCalloutUtils.getCalloutDirection(n,e,t,i),this.maxHeightCallback=(e,t,i,n)=>{let o=this._inlineSuggestionCalloutUtils.getPluginCalloutMaxHeight(e,t,i);return(null==n?void 0:n.maxHeight)&&(o=Math.min(n.maxHeight,null!=o?o:Number.MAX_SAFE_INTEGER)),o},this.closeMenu=()=>{this.displayCallout=void 0,this._queryDetection.removeDetectedQuery()},this.getTargetLocationOfECC=async(e,t,i)=>{var n,o,r,a,l,d,c,u,h;const p=this._proofingDom.findParagraphNode(e);if(!(0,g.l)(p))return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid parent HTML element could be found"),null;const m=p.element.offset+t.start;let f=this._tileContent.getContainingElement(p);if((0,s.C)(f,"HTMLInputElement")||(0,s.C)(f,"HTMLTextAreaElement")){const e=null===(n=this._shadowElementsStore)||void 0===n?void 0:n.getShadowElementStore(p.parent.id);e?(await e.updateOverlay(),f=e.container):this._oaLogger.logDiagnostics("Attempted to render ECC on an input/textarea, but no shadow element store was available, so the ECC will most likely be placed in the wrong place.")}const v=await this._tileContent.getRangeOfNode(p.parent,f,m,null!==(r=null===(o=t.prefix)||void 0===o?void 0:o.length)&&void 0!==r?r:1);if(!f)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element could not be determined"),null;if(!f.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element was disconnected"),null;if(!v)return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid range for the menu character could be found"),null;if(!v.startContainer.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range was returned containing a detached HTML node"),null;if((null===(a=this._hostSettings.oaSettings)||void 0===a?void 0:a.atMentionClassName)&&this.hasSomeParentWithAnyClass(v.startContainer,[this._hostSettings.oaSettings.atMentionClassName]))return null;if((null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.disabledClassNames)&&this.hasSomeParentWithAnyClass(v.startContainer,this._hostSettings.oaSettings.disabledClassNames))return null;let _=v.getBoundingClientRect();if(0===_.top&&0===_.bottom&&0===_.left&&0===_.right&&0===_.height&&0===_.width){if(v.startContainer!==v.endContainer||!v.startContainer.parentElement)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;if(_=v.startContainer.parentElement.getBoundingClientRect(),0===_.top&&0===_.bottom&&0===_.left&&0===_.right&&0===_.height&&0===_.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found"),null}const y=i?new DOMRect(_.left-(null!==(d=i.x)&&void 0!==d?d:0),_.top-(null!==(c=i.y)&&void 0!==c?c:0),_.width+2*(null!==(u=i.x)&&void 0!==u?u:0),_.height+2*(null!==(h=i.y)&&void 0!==h?h:0)):_;return function(e,t,i){const n=t.commonAncestorContainer.ownerDocument,o=null==n?void 0:n.defaultView;if(!o)return!1;const s={x:e.left+e.width/2,y:e.top+e.height/2};let r=n.elementFromPoint(s.x,s.y),a=!1;do{if(r===i){a=!0;break}r=null==r?void 0:r.parentNode}while(r);if(!a)return!1;return s.x<0||s.y<0||s.x>(o.innerWidth||n.documentElement.clientWidth)||s.y>(o.innerHeight||n.documentElement.clientHeight)}(y,v,f)?null:y},this._inlineSuggestionCalloutUtils=null!=c?c:new v.c,(0,S.Gn)(this)}async initialize(){this._hostEmitter.on(r.pD.hostModelVisualStateChange,this.hostModelVisualStateChange)}shutDown(){this.closeMenu()}hasSomeParentWithAnyClass(e,t){return!!t.find((t=>{var i;return null===(i=e.className)||void 0===i?void 0:i.split(" ").includes(t)}))||!!e.parentElement&&this.hasSomeParentWithAnyClass(e.parentElement,t)}};(0,n.__decorate)([_.observable],b.prototype,"displayCallout",void 0),(0,n.__decorate)([_.action],b.prototype,"closeMenu",void 0),b=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,I.W)(a.n)),(0,n.__param)(1,(0,I.W)(l.m)),(0,n.__param)(2,(0,I.W)(d.u)),(0,n.__param)(3,(0,I.W)(p.d)),(0,n.__param)(4,(0,I.W)(c.J)),(0,n.__param)(5,(0,I.W)(m.w)),(0,n.__param)(6,(0,I.W)(r.M5)),(0,n.__param)(7,(0,C.l)()),(0,n.__param)(7,(0,I.W)(f.S)),(0,n.__param)(8,(0,C.l)()),(0,n.__param)(8,(0,I.W)(h.T)),(0,n.__param)(9,(0,C.l)()),(0,n.__param)(9,(0,I.W)(u.cg))],b)},71418:(e,t,i)=>{if(i.d(t,{c:()=>o}),2063!=i.j)var n=i(42119);class o{getPluginCalloutMaxHeight(e,t,i){var n;const o=null!==(n=e.y)&&void 0!==n?n:e.top;if(o)return Math.max(t.innerHeight-o,o)-20}getCalloutDirection(e,t,i,o){return e?n.A.bottomRightEdge:n.A.bottomLeftEdge}}},97944:(e,t,i)=>{i.d(t,{Q:()=>b});var n=i(23182),o=i(84030),s=i(71632),r=i(99724),a=i(33767),l=i(15661),d=i(14600),c=i(24111),u=i(25622),h=i(2599),g=i(81174),p=i(78426),m=i(33727),f=i(95537),v=i(71418),_=i(19728),y=i(29906),I=i(83010),C=i(27603),S=i(37814);let b=class{constructor(e,t,i,n,r,a,l,d,c,u){this._hostSettings=e,this._oaLogger=t,this._oaMetric=i,this._tileContent=n,this._queryDetection=r,this._proofingDom=a,this._hostEmitter=l,this._shadowElementsStore=d,this._targetWindowFactory=u,this.displayCallout=void 0,this.hostModelVisualStateChange=e=>{e.message.created&&this._lastUpdate&&this.setDisplayCallout(this._lastUpdate.displayCallout,this._lastUpdate.menuInfo,this._lastUpdate.calloutProps).catch((e=>{this._oaLogger.logDiagnostics("Error setting display callout",e)}))},this.setDisplayCallout=async(e,t,i)=>{var n;this._lastUpdate={displayCallout:e,menuInfo:t,calloutProps:i};const s=this._queryDetection.getCurrentQueryLogicalId();if(e&&t&&i){let e=i.overrideTargetLocation;if(!e){const i=await this.getTargetLocationOfECC(t.tileId,t.queryRange);if(!i)return;if(this._queryDetection.getCurrentQueryLogicalId()!==s)return;e=i}"x"in e&&void 0!==e.x&&"InlineSuggestionsResultsFlagMenuType"===t.menuType.menuType&&(e.x=e.x-11),t.targetLocation=e;const r=this._queryDetection.getCurrentQueryLogicalId();r&&this._oaMetric.addMeasure(r,"InlineSuggestionsCalloutDisplay");const a={trapFocus:!1},l=i.isRtl,d=i.queryChar,c=(0,_.toJS)(null===(n=i.styles)||void 0===n?void 0:n.containerStyles);(0,_.runInAction)((()=>{var t,n;this.displayCallout={calloutProps:i,targetLocation:e,targetWindow:null!==(n=null===(t=this._targetWindowFactory)||void 0===t?void 0:t.call(this))&&void 0!==n?n:new o.O(window),directionalHintCallback:(e,t,i)=>this.directionalHintCallback(e,t,i,l),maxHeightCallback:(e,t)=>this.maxHeightCallback(e,t,d,c),popoverProps:a,isMobile:!0}}))}else this.closeMenu()},this.directionalHintCallback=(e,t,i,n)=>this._inlineSuggestionCalloutUtils.getCalloutDirection(n,e,t,i),this.maxHeightCallback=(e,t,i,n)=>{let o=this._inlineSuggestionCalloutUtils.getPluginCalloutMaxHeight(e,t,i);return(null==n?void 0:n.maxHeight)&&(o=Math.min(n.maxHeight,null!=o?o:Number.MAX_SAFE_INTEGER)),o},this.closeMenu=()=>{this.displayCallout=void 0,this._queryDetection.removeDetectedQuery()},this.getTargetLocationOfECC=async(e,t)=>{var i,n,o,r,a,l,d,c,u,h;const p=this._proofingDom.findParagraphNode(e);if(!(0,g.l)(p))return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid parent HTML element could be found"),null;const m=p.element.offset+t.start;let f=this._tileContent.getContainingElement(p);if((0,s.C)(f,"HTMLInputElement")||(0,s.C)(f,"HTMLTextAreaElement")){const e=null===(i=this._shadowElementsStore)||void 0===i?void 0:i.getShadowElementStore(p.parent.id);e?(await e.updateOverlay(),f=e.container):this._oaLogger.logDiagnostics("Attempted to render ECC on an input/textarea, but no shadow element store was available, so the ECC will most likely be placed in the wrong place.")}const v=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.enableECCForMobileDevice,_=await this._tileContent.getRangeOfNode(p.parent,f,m,null!==(r=null===(o=t.prefix)||void 0===o?void 0:o.length)&&void 0!==r?r:1);if(!f)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element could not be determined"),null;if(!f.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element was disconnected"),null;if(!_)return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid range for the menu character could be found"),null;if(!_.startContainer.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range was returned containing a detached HTML node"),null;if((null===(a=this._hostSettings.oaSettings)||void 0===a?void 0:a.atMentionClassName)&&this.hasSomeParentWithAnyClass(_.startContainer,[this._hostSettings.oaSettings.atMentionClassName]))return null;if((null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.disabledClassNames)&&this.hasSomeParentWithAnyClass(_.startContainer,this._hostSettings.oaSettings.disabledClassNames))return null;let y=null===(c=document.getElementById(null!==(d=null==v?void 0:v.inputBoxId)&&void 0!==d?d:"m365chat-input-formTextBox"))||void 0===c?void 0:c.getBoundingClientRect();if(!y||0===y.top&&0===y.bottom&&0===y.left&&0===y.right&&0===y.height&&0===y.width){if(_.startContainer!==_.endContainer||!_.startContainer.parentElement)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;if(y=_.startContainer.parentElement.getBoundingClientRect(),0===y.top&&0===y.bottom&&0===y.left&&0===y.right&&0===y.height&&0===y.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found"),null}const I=null!==(u=null==v?void 0:v.mainAxisOverride)&&void 0!==u?u:0,C=null!==(h=null==v?void 0:v.crossAxisOverride)&&void 0!==h?h:0,S=new DOMRect(y.left-C,y.top-I,y.width,y.height);return function(e,t,i){const n=t.commonAncestorContainer.ownerDocument,o=null==n?void 0:n.defaultView;if(!o)return!1;const s={x:e.left+e.width/2,y:e.top+e.height/2};let r=n.elementFromPoint(s.x,s.y),a=!1;do{if(r===i){a=!0;break}r=null==r?void 0:r.parentNode}while(r);if(!a)return!1;return s.x<0||s.y<0||s.x>(o.innerWidth||n.documentElement.clientWidth)||s.y>(o.innerHeight||n.documentElement.clientHeight)}(S,_,f)?null:S},this._inlineSuggestionCalloutUtils=null!=c?c:new v.c,(0,S.Gn)(this)}async initialize(){this._hostEmitter.on(r.pD.hostModelVisualStateChange,this.hostModelVisualStateChange)}shutDown(){this.closeMenu()}hasSomeParentWithAnyClass(e,t){return!!t.find((t=>{var i;return null===(i=e.className)||void 0===i?void 0:i.split(" ").includes(t)}))||!!e.parentElement&&this.hasSomeParentWithAnyClass(e.parentElement,t)}};(0,n.__decorate)([_.observable],b.prototype,"displayCallout",void 0),(0,n.__decorate)([_.action],b.prototype,"closeMenu",void 0),b=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,I.W)(a.n)),(0,n.__param)(1,(0,I.W)(l.m)),(0,n.__param)(2,(0,I.W)(d.u)),(0,n.__param)(3,(0,I.W)(p.d)),(0,n.__param)(4,(0,I.W)(c.J)),(0,n.__param)(5,(0,I.W)(m.w)),(0,n.__param)(6,(0,I.W)(r.M5)),(0,n.__param)(7,(0,C.l)()),(0,n.__param)(7,(0,I.W)(f.S)),(0,n.__param)(8,(0,C.l)()),(0,n.__param)(8,(0,I.W)(h.T)),(0,n.__param)(9,(0,C.l)()),(0,n.__param)(9,(0,I.W)(u.cg))],b)},29100:(e,t,i)=>{i.d(t,{W:()=>se});var n=i(23182),o=i(62924),s=i(99724),r=i(98647),a=i(14945),l=i(88241),d=i(20255),c=i(63318),u=i(3661),h=i(8628),g=i(88011),p=i(33767),m=i(15661),f=i(37053),v=i(14600),_=i(81168),y=i(24111),I=i(19685),C=i(48662),S=i(18349),b=i(22910),T=i(35731),E=i(62026),N=i(12220),x=i(2115),w=i(96606),L=i(92507),D=i(53353),F=i(55642),A=i(30181),R=i(96733),q=i(94610),P=i(14251),O=i(28853),k=i(55649),z=i(81174),M=i(39352),W=i(33727),j=i(10968),B=i(78426),U=i(63519),H=i(54058),V=i(52215),G=i(89669),Q=i(30256),K=i(44404),$=i(25936),J=i(63326),Z=i(60963),Y=i(75499),X=i(29906),ee=i(83010),te=i(27603),ie=i(52928),ne=i(19728),oe=i(14253);let se=class{constructor(e,t,i,n,p,m,f,v,_,y,I,C,S,b,T,E,A,P,O,k,M,W,j,B,U){this._hostSettings=e,this._oaLogger=t,this._logger=i,this._oaMetric=n,this._guidGenerator=p,this._hostEmitter=m,this._proofingDom=f,this._paragraphTextExtractor=v,this._inlineSuggestionStore=_,this._tileContent=y,this._oaResultStore=I,this._queryDetection=C,this._localizer=S,this._featureFlagsReader=b,this._inlineSuggestionsCalloutStore=T,this._proofingEmitter=E,this._safeWindow=A,this._paneOpenState=P,this._predictionStore=O,this._ariaStatusStateStoreFactory=k,this._indicatorStore=M,this._calloutDismissalHandler=W,this._externalSettingsFeature=j,this._instrumentationProcessor=B,this.feedbackStoreFactory=U,this._menus=new Map,this._automaticallyOpenECCForTiles=new Map,this._menuCurrentlyOpen=void 0,this._menuEventListeners=[],this._isClearingSearch=!1,this._isCIQMentionsEnabled=!0,this._triggeringMethod=void 0,this._searchBarQuery="",this._initialMenuPosition=0,this._lastComposingBoxQuery=void 0,this._clearSearchBox=!1,this.initialize=async()=>{var e;this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled)&&(this._hostEmitter.on(s.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(s.pD.hostModelTextTile,this._handleTextTile),this._hostEmitter.on(s.pD.nudgeAccepted,this.handleNudgeAccepted),this._hostEmitter.on(s.pD.ciqSettingsChange,this.ciqSettingsChange),this._hostEmitter.on(s.pD.hostModelRehydrateTilesFinished,this.hostModelRehydrateTilesFinished),this._hostEmitter.on(s.pD.hostModelVisualStateChange,this.hostModelVisualStateChange))},this.shutDown=()=>{this._accessibilityElement&&(this._accessibilityElement.remove(),this._accessibilityElement=void 0),this._menus.clear(),this._automaticallyOpenECCForTiles.clear(),this._menuCurrentlyOpen=void 0,this.detachEventsFromParentElement(),this._scrollThrottle=void 0,this._resizeThrottle=void 0},this.automaticallyOpenECCOnTileInteractions=(e,t,i=!1,n,o)=>{if(!e)throw Error("You must specify a query character.");if(!this._menus.get(e))throw Error("This character is not being used for menu creation.");if(this._automaticallyOpenECCForTiles.has(t))throw Error("This tile already is automatically opening the ECC on interaction.");const s=this._proofingDom.findTileNode(t);if(!s)throw Error("Unable to find tile to attach to.");const a={handleEvent:async t=>{this._menuCurrentlyOpen||x.x.isKey(t,w.m.enter)&&(t.stopImmediatePropagation(),t.preventDefault(),await this.openMenuAtCursor(s,e,n,!0))}};let l=!1;const d={handleEvent:t=>{this._menuCurrentlyOpen||l||(l=!1,0===t.button&&this._safeWindow.requestAnimationFrame((async()=>{this._tileContent.getTextSelection().then((t=>{(null==t?void 0:t.startParentElement.id)===s.id&&t.endParentElement.id===s.id&&this.openMenuAtCursor(s,e,n,!0).catch((e=>{this._logger.error(507357320,"Failed to open menu for automatic atMention",e)}))})).catch((e=>{this._logger.error(507360218,"Failed to get text selection for automatic atMention",e)}))})))}},c={handleEvent:async()=>{l=!!this._menuCurrentlyOpen}};let u;if(o)u=o(a,d);else{const e=this._inlineSuggestionStore.getBestParentElement(s);if(e){const t=new r.J(e);t.addListener("keydown",a),t.addListener("mousedown",c),t.addListener("mouseup",d),u=()=>{t.removeAllListeners()}}else u=()=>{}}this._automaticallyOpenECCForTiles.set(t,{queryChar:e,removeTextIfNotAccepted:i,supportedEntityTypesOverride:n,eventHandlerDisposal:u,eventHandlerCallback:o})},this.hostModelVisualStateChange=e=>{if(e.message.created){const t=this._automaticallyOpenECCForTiles.get(e.message.tileId);if(t&&(this.removeAutomaticallyOpenECCOnTileInteractions(e.message.tileId),this.automaticallyOpenECCOnTileInteractions(t.queryChar,e.message.tileId,t.removeTextIfNotAccepted,t.supportedEntityTypesOverride,t.eventHandlerCallback)),this._menuCurrentlyOpen){const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!e)return;const t=this._inlineSuggestionStore.getBestParentElement(e);t?this.attachEventsToParentElement(t):this.detachEventsFromParentElement()}}},this.renderMenuWithItems=async(e,t,i,n,o,s,r,a,l)=>{var d;const c=this._proofingDom.findParagraphNode(e);if(!c)return!1;const u=this._inlineSuggestionStore.isFlightEnabled("mc-editor-enable-searchbar");return this._menuCurrentlyOpen=this.setMenuCurrentlyOpen(void 0,{supportedEntityTypes:void 0,onItemSelected:o,theme:s,style:r,styles:a,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:n,getLocalItems:l,expandedEccSearchBarConfig:this.buildExpandedEccSearchBarConfig(c,u),browseThisComputerConfig:this.buildBrowseThisComputerConfig(),appGptConfig:this.buildAppGptConfig(),enableExpandedECCSearchBar:u},c,{start:0,length:0},void 0,i,!0,!1,!1,null===(d=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===d?void 0:d.source),this.prepareAndRenderECC(c,"",!0,t)},this.showExistingMenu=async(e,t,i,n,o,s,r,a,l,d,c)=>{var u;if(this._menuCurrentlyOpen)return!1;const h=this._menus.get(n);if(!h)return!1;const g=this._proofingDom.findParagraphNode(e);if(void 0!==(null==g?void 0:g.eventSeqId)){const e=this._paragraphTextExtractor.getParagraphText(g);if(void 0!==e){const p=e.substring(t,t+i),m=p.charAt(0)===n,f={start:t,length:i,prefix:void 0!==n&&m?n:""};return this._menuCurrentlyOpen=this.setMenuCurrentlyOpen(n,Object.assign(Object.assign({},h),{shouldRemoveTextOnItemSelection:s,specifiedItemsToDisplay:l,expandedEccSearchBarConfig:this.buildExpandedEccSearchBarConfig(g,h.enableExpandedECCSearchBar),browseThisComputerConfig:this.buildBrowseThisComputerConfig(),appGptConfig:this.buildAppGptConfig()}),g,f,void 0,null!=d?d:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},o,s,c,null===(u=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===u?void 0:u.source),a&&(this._menuCurrentlyOpen.onItemSelected=a),(r||l)&&(this._menuCurrentlyOpen.supportedEntityTypes=r),l&&(this._menuCurrentlyOpen.onSuggestionsUpdated=void 0),this._menuCurrentlyOpen.specifiedItemsToDisplay||this.emitHostDataToGenerateMenuItems(p,f,g),this.prepareAndRenderECC(g,p)}}return!1},this.showEntityPrediction=async(e,t,i,n,s,r,a)=>{var l,d;const c=null!==(l=this._menus.get("@"))&&void 0!==l?l:this.getDefaultMenuInformation();this._oaResultStore.clearResults(),this._queryDetection.removeDetectedQuery();const u=this._proofingDom.findParagraphNode(e);if(void 0!==(null==u?void 0:u.eventSeqId)){const e={start:t,length:0,prefix:""},l=this._paragraphTextExtractor.getQueryString(u,e);if(void 0!==l)return this._menuCurrentlyOpen=this.setMenuCurrentlyOpen(void 0,Object.assign(Object.assign({},c),{supportedEntityTypes:void 0,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:i,onOpen:void 0,onItemSelected:(e,t)=>{n(e,t)},onFooterAction:async e=>{if(e===o._R.IgnoreOnce)null==s||s();await this.dismissECC(!1)},onClose:()=>{null==r||r()},onSuggestionsUpdated:e=>{for(const t of e)for(const e of t.entities)e.isBestMatch=!1;return Promise.resolve(e)}}),u,e,void 0,{menuType:"InlineSuggestionsEntityPredictionMenuType"},!0,!1,!1,null===(d=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===d?void 0:d.source),this.prepareAndRenderECC(u,l,!0,a)}return!1},this.initShowMoreEntitiesParagraph=(e,t,i)=>{if(!this._menuCurrentlyOpen)return;this.removeShowMoreEntitiesParagraph(this._menuCurrentlyOpen);const n=this.generateNewParagraphNode();return this._menuCurrentlyOpen.searchBoxGeneratedParagraphId=n.id,t&&(this._previouslySpecifiedItemsToDisplay=this._menuCurrentlyOpen.specifiedItemsToDisplay,this._menuCurrentlyOpen.specifiedItemsToDisplay=void 0),this._oaResultStore.updateLoadingStatus(!0,!0),this.emitHostDataToGenerateMenuItems(i,{start:0,length:i.length,prefix:""},n,e?{entityType:e}:void 0),n},this.generateNewParagraphNode=()=>{const e=new z.f(this._guidGenerator,this._proofingDom,{offset:0,span:0});return this._hostEmitter.emit(s.pD.hostModelTextTile,{address:void 0,message:{messageType:a.G.NewData,data:{tileId:e.id,tileVersion:e.eventSeqId,changeType:l.Q.Local,isTextNode:!0,tile:new R.Cg({content:""})}}}),e},this.removeShowMoreEntitiesParagraph=e=>{e.searchBoxGeneratedParagraphId&&(this._hostEmitter.emit(s.pD.hostModelTextTile,{address:void 0,message:{messageType:a.G.RemoveData,data:{tileId:e.searchBoxGeneratedParagraphId,tileVersion:0,changeType:l.Q.Code,isTextNode:!0,tile:new R.Cg({content:""})}}}),e.searchBoxGeneratedParagraphId=void 0)},this.buildExpandedEccSearchBarConfig=(e,t)=>{var i;const n=null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.triggerCharacter;return{enableExpandedECCSearchBar:t,onSearchChange:(t="")=>{var i,o;const s=n+t,r=t.length+(null!==(i=null==n?void 0:n.length)&&void 0!==i?i:0);(null===(o=this._menuCurrentlyOpen)||void 0===o?void 0:o.expandedEccSearchBarConfig)&&(this._searchBarQuery=t,this._inlineSuggestionStore.setSearchBoxQueryString(t),this.emitHostDataToGenerateMenuItems(s,{start:0,length:r,prefix:n},e,void 0,!0),this._oaLogger.logActivity(N.h8,void 0,this.getDefaultLogDataForMenu()))},onSearchClear:()=>{this._clearSearchBox=!0,this._inlineSuggestionStore.setSearchBoxQueryString(""),this.removeComposingBoxQuery(void 0,!0)}}},this.buildShowMoreEntitiesConfig=(e,t,i,n)=>{var s,r;if(null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.disableFlagShowMoreEntities)return;const a=this.convertFlagType(e.typeId);if(a===o.z4.File||a===o.z4.Person){const e=a===o.z4.File?D.c.File:D.c.People,s=a===o.z4.File?this._localizer.getMessage("ebx_ECCSearchFileButtonLabel"):this._localizer.getMessage("ebx_ECCSearchPeopleButtonLabel");return Object.assign(Object.assign({},null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.showMoreEntitiesSettings),{isShowMoreEntitiesEnabled:!0,showMoreEntitiesButtonLabel:s,searchBoxPlaceHolder:s,onSearchChange:(t="")=>{this.onSearchBoxQueryChange(t,e)},onClickShowMoreEntities:()=>{const t=this._inlineSuggestionStore.searchBoxQueryString;this.initShowMoreEntitiesParagraph(e,!0,t)?this._oaLogger.logActivity(N.tb,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(N.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},onCloseShowMoreEntities:()=>{this._menuCurrentlyOpen&&(this._previouslySpecifiedItemsToDisplay?(this._menuCurrentlyOpen.specifiedItemsToDisplay=this._previouslySpecifiedItemsToDisplay,this._oaResultStore.updateResults(this._menuCurrentlyOpen.specifiedItemsToDisplay,n.id,0===this._menuCurrentlyOpen.specifiedItemsToDisplay.length?F.i.NoResults:F.i.Success,void 0,void 0,0===this._menuCurrentlyOpen.specifiedItemsToDisplay.length?{NoResults:1}:{Success:1})):(this._menuCurrentlyOpen.specifiedItemsToDisplay=void 0,this._oaResultStore.updateLoadingStatus(!0,!0),this.emitHostDataToGenerateMenuItems(t,i,n)),this.removeShowMoreEntitiesParagraph(this._menuCurrentlyOpen)),this._oaLogger.logActivity(N.mj,void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this.initShowMoreEntitiesParagraph(e,!1,"")?this._oaLogger.logActivity(N.N2,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(N.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},entityType:e})}},this.onSearchBoxQueryChange=(e,t)=>{var i,n;if(!(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.searchBoxGeneratedParagraphId)&&!this.initShowMoreEntitiesParagraph(t,!0,e))return void this._oaLogger.logActivity(N.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu());const o=(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.searchBoxGeneratedParagraphId)?this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.searchBoxGeneratedParagraphId):void 0;o?(this._inlineSuggestionStore.setSearchBoxQueryString(e),this._oaResultStore.updateLoadingStatus(!0,!0),this.emitHostDataToGenerateMenuItems(e,{start:0,length:e.length,prefix:""},o,t?{entityType:t}:void 0,!1,!0),this._oaLogger.logActivity(N.xe,void 0,this.getDefaultLogDataForMenu())):this._oaLogger.logActivity(N.iI,{error:"Could not find paragraph node for search bar"},this.getDefaultLogDataForMenu())},this.buildBrowseThisComputerConfig=e=>{var t,i,n;const s=(null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.browseThisComputerSettings)||void 0===i?void 0:i.enableBrowseThisComputerOnFileFlags)&&(!e||this.convertFlagType(e.typeId)===o.z4.File);if(!s)return;const{browseThisComputerHtmlId:r}=(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.browseThisComputerConfig)||{},{browseThisComputerSettings:a}=this._hostSettings.serviceSettings||{};return{isBrowseThisComputerEnabled:s,isUploadFileButtonEnabled:!e&&(null==a?void 0:a.isUploadFileButtonEnabled),browseThisComputerHtmlId:r,onClickBrowseThisComputer:null==a?void 0:a.onBrowseThisComputerCallback,browseThisComputerButtonLabel:this._localizer.getMessage("ebx_browseThisComputerLabel"),enableCloudPicker:null==a?void 0:a.enableCloudPicker,fluentMenuConfig:null==a?void 0:a.fluentMenuConfig}},this.buildAppGptConfig=()=>{var e,t;const i=null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.appGptConfig)||void 0===t?void 0:t.enableAppGpt;if(!i)return;const{appGptConfig:n}=this._hostSettings.serviceSettings||{};return{enableAppGpt:i,onClickExploreMoreCopilots:null==n?void 0:n.onClickExploreMoreCopilots}},this.showFlag=async(e,t,i,n,s,r,a,l,c)=>{var u,h,g;if(!e.nodeId)return!1;this._oaResultStore.clearResults(),this._queryDetection.removeDetectedQuery();const p=null!==(h=null!==(u=this._menus.get(void 0))&&void 0!==u?u:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==h?h:this.getDefaultMenuInformation(),m=this.convertFlagType(e.typeId);if(void 0===m)return this._oaLogger.logDiagnostics("Unable to determine type of flag for critique type: "+e.typeId),!1;const f=this._proofingDom.findParagraphNode(e.nodeId);if(void 0!==(null==f?void 0:f.eventSeqId)){const u={start:e.start-f.element.offset,length:e.length,prefix:""},h=e.shouldIgnoreFlaggedText?"":this._paragraphTextExtractor.getQueryString(f,u);if(h||e.shouldIgnoreFlaggedText&&""===h){let v=!1;return this._menuCurrentlyOpen=this.setMenuCurrentlyOpen(void 0,Object.assign(Object.assign({},p),{supportedEntityTypes:e.supportedEntityTypes,shouldRemoveTextOnItemSelection:!1,onOpen:void 0,onClose:t=>{var n;t||null===(n=this._instrumentationProcessor)||void 0===n||n.process({critique:(0,ne.toJS)(e),eventId:J.xp.ClickNoAction}),i(void 0,v)},critiqueRange:u,onItemSelected:(n,o)=>{var s;null===(s=this._instrumentationProcessor)||void 0===s||s.process({critique:(0,ne.toJS)(e),eventId:J.xp.ChangeSuggOther}),t(e,n,o),i(!1,!1)},onFooterAction:async t=>{var l,u,h,g;let p;switch(t){case o._R.IgnoreOnce:p=J.xp.Ignore,null==n||n(e);break;case o._R.IgnoreAll:p=J.xp.IgnoreAll,null==s||s(e);break;case o._R.IgnoreRule:p=J.xp.DoNotCheckThisIssue,null==r||r(e);break;case o._R.OpenEditorPane:null===(u=null===(l=this._indicatorStore)||void 0===l?void 0:l.onOpenEditorPane)||void 0===u||u.call(l,L.k.ContextualCard),i(void 0,!1);break;case o._R.Options:null===(h=this._externalSettingsFeature)||void 0===h||h.openSettings(d.kY.dropdown);break;case o._R.Feedback:null==a||a(e);break;case o._R.Next:return v=!0,await this.dismissECC(!1),void this.navigateWithDelay(c,1);case o._R.Previous:return v=!0,await this.dismissECC(!1),void this.navigateWithDelay(c,-1)}p&&(null===(g=this._instrumentationProcessor)||void 0===g||g.process({critique:(0,ne.toJS)(e),eventId:p})),await this.dismissECC(!1)},onSuggestionsUpdated:async(t,i,n,o,s,r,a,l,d,c,u,h,g)=>{let m=t;if(!e.suggestionItems&&p.onSuggestionsUpdated){if(m=await p.onSuggestionsUpdated(t,i,n,o,s,r,a,l,d,c,u,this.logWithMenuData,g),!m)return;e.supportedEntityTypes&&(m=m.filter((t=>{var i;return null===(i=e.supportedEntityTypes)||void 0===i?void 0:i.includes(t.entityType)})))}for(const t of m){e.groupTitle&&(t.groupTitle=e.groupTitle),e.groupSubtitle&&(t.groupSubtitle=e.groupSubtitle);for(const e of t.entities)e.isBestMatch=!1}return m},showMoreEntitiesConfig:this.buildShowMoreEntitiesConfig(e,h,u,f),browseThisComputerConfig:this.buildBrowseThisComputerConfig(e),appGptConfig:this.buildAppGptConfig(),expandedEccSearchBarConfig:this.buildExpandedEccSearchBarConfig(f,p.enableExpandedECCSearchBar)}),f,u,{x:0,y:3},{menuType:"InlineSuggestionsResultsFlagMenuType",flag:m,brandingMode:this._hostSettings.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("flag",!1,m!==o.z4.Topic,void 0!==c),critiqueSetSize:l?(0,Y.v)(l).length:void 0,critiquePosition:null==l?void 0:l.currentIndex},m!==o.z4.File,!0,!1,null===(g=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===g?void 0:g.source),e.suggestionItems&&(this._menuCurrentlyOpen.specifiedItemsToDisplay=e.suggestionItems),this._menuCurrentlyOpen.specifiedItemsToDisplay||this.emitHostDataToGenerateMenuItems(h,u,f),this.prepareAndRenderECC(f,h)}}return!1},this.navigateWithDelay=(e,t)=>{setTimeout((()=>{e(t)}),50)},this.getDefaultMenuInformation=()=>({supportedEntityTypes:void 0,onItemSelected:()=>{},shouldRemoveTextOnItemSelection:!0,enableExpandedECCSearchBar:this._inlineSuggestionStore.isFlightEnabled("mc-editor-enable-searchbar")}),this.convertFlagType=e=>{switch(e){case c.L9.CIQFlag_PersonEntityRecognition:return o.z4.Person;case c.L9.CIQFlag_File:return o.z4.File;case c.L9.CIQFlag_LocalBusiness:case c.L9.CIQFlag_Location:case c.L9.CIQFlag_Time:return o.z4.Location;case c.L9.CIQFlag_Topic:return o.z4.Topic;case c.L9.CIQFlag_TaskRecognition:case c.L9.CIQFlag_SatoriEntityRecognition:case c.L9.CIQFlag_DateEntityRecognition:case c.L9.HeadingDetection:return o.z4.Location;default:return}},this.onFooterAction=e=>{var t;(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.onFooterAction)?this._menuCurrentlyOpen.onFooterAction(e):this.runDefaultFooterActionIfAvailable(e)},this.onSuggestionsUpdated=async(e,t,i,n,o,s,r,a,l,d,c,u)=>{if(this._menuCurrentlyOpen)return this._menuCurrentlyOpen.specifiedItemsToDisplay&&(e=await i(this._menuCurrentlyOpen.specifiedItemsToDisplay)),this._menuCurrentlyOpen.onSuggestionsUpdated?this._menuCurrentlyOpen.onSuggestionsUpdated(e,t,i,n,o,s,r,a,l,d,c,this.logWithMenuData,u):e;this._oaLogger.logDiagnostics("Received suggestions update with no menu open")},this.logWithMenuData=(e,t,i)=>{const n=this.getDefaultLogDataForMenu();i&&n.push(...i),this._oaLogger.logActivity(e,t,n)},this.handleNudgeAccepted=e=>{const t=e.message.data.nudge,i={hasEntityResults:void 0!==t.entityResults,entityType:t.entityType};!e.message.data.fromUserAction&&this._menuCurrentlyOpen?(this._menuCurrentlyOpen.wasOpenedViaNudge=!0,this._menuCurrentlyOpen.wasOpenedViaNudgeInfo=i):this._nextMenuOpenIsViaNudge=i},this._handleTextTile=e=>{if(e.message.messageType===a.G.RemoveData){const t=e.message.data.tileId;if(this._menuCurrentlyOpen){const e=t===this._menuCurrentlyOpen.tileId,i=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);(e||!i&&!this._clearSearchBox)&&this.dismissECC(!1)}this._automaticallyOpenECCForTiles.has(t)&&this.removeAutomaticallyOpenECCOnTileInteractions(t)}},this.ciqSettingsChange=e=>{this._isCIQMentionsEnabled=e.message.isCIQMenuEnabled},this.hostModelRehydrateTilesFinished=()=>{var e;if(!(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.parentTileId)||void 0===this._menuCurrentlyOpen.parentTileOffset)return;if(this._featureFlagsReader.flags.disableECCMenuRecreationOnALReconnection)return;const t=this._proofingDom.findTileNode(this._menuCurrentlyOpen.parentTileId);if(!t)return;const i=this._menuCurrentlyOpen.parentTileOffset+this._menuCurrentlyOpen.queryRange.start;let n;if(t.children)for(const e of t.children)if(e.element&&e.element.offset<=i&&e.element.offset+e.element.span>=i){n=e;break}if(!n)return;this._menuCurrentlyOpen.tileId=n.id;const o=this._paragraphTextExtractor.getQueryString(n,this._menuCurrentlyOpen.queryRange,!0);void 0!==o&&(this._oaResultStore.updateLoadingStatus(!0),this.emitHostDataToGenerateMenuItems(o,this._menuCurrentlyOpen.queryRange,n))},this.notifyMenuTriggeringMethod=e=>{this._triggeringMethod=e},this._handleDelta=e=>{const t=e.message;t.sourceType!==l.p.TileNode&&this._handleUpdate(t.tileId,t.delta,t.changeType)},this._handleUpdate=async(e,t,i)=>{var n,o,s,r,a,d,c,h,g,p,m,f,v,_,y,I,C,S,b,T;const E="InlineSuggestionsResultsUserInitiatedMenuType"!==(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.menuType.menuType);if((t.unit===q.OD.Sentence||t.unit===q.OD.Paragraph)&&(t.deltaType===q.WI.Add||t.deltaType===q.WI.Update)&&((null!==(s=null===(o=t.content)||void 0===o?void 0:o.length)&&void 0!==s?s:0)>1||0===(null===(r=t.content)||void 0===r?void 0:r.length))&&void 0===t.queryRange===(void 0===this._menuCurrentlyOpen||E))return;const x=!((null===(a=this._menuCurrentlyOpen)||void 0===a?void 0:a.enableExpandedECCSearchBar)&&this._triggeringMethod===oe.P.AttachFile||this._clearSearchBox);if(i!==l.Q.Local){if(this._menuCurrentlyOpen){const i=this._queryDetection.getCurrentQuery();if(i)this._menuCurrentlyOpen.queryRange=i,this.addZeroQueryHintText(),this._menuCurrentlyOpen.searchBoxGeneratedParagraphId||(null===(d=t.additionalData)||void 0===d?void 0:d.scopeInfo)||await this.tryToUpdatePreloadedItems(t,e,!0);else{if(!x)return void(this._clearSearchBox=!1);this.dismissECC(!1)}}return}(null===(c=this._menuCurrentlyOpen)||void 0===c?void 0:c.shouldDismissOnTyping)&&await this.dismissECC(!1);const w=this._proofingDom.findParagraphNode(e);let L,F=null===(h=t.queryRange)||void 0===h?void 0:h.prefix;if((null==w?void 0:w.parent)&&this._automaticallyOpenECCForTiles.has(w.parent.id)&&!this._queryDetection.getIsSameWordQueriesDismissed()&&!t.queryRange&&t.deltaType===q.WI.Add&&void 0!==t.position&&void 0!==t.content&&(1!==t.content.length||!u.Yv(t.content.charCodeAt(0)))&&","!==t.content){const i=this._automaticallyOpenECCForTiles.get(w.parent.id);F=null==i?void 0:i.queryChar,t.additionalData=this._queryDetection.setCurrentQueryRange(e,{prefix:"",start:t.position,length:t.content.length},!1,void 0,F),t.queryRange=this._queryDetection.getCurrentQuery(),L=null==i?void 0:i.supportedEntityTypesOverride}if(t.queryRange){if(!this._isCIQMentionsEnabled&&!1!==this._hostSettings.isHidingCIQMenuSupported){if((null!==(g=t.queryRange.prefix)&&void 0!==g?g:"@")===(null!==(p=this._hostSettings.ciqTriggeringChar)&&void 0!==p?p:"/"))return}const i=!this._menuCurrentlyOpen,n=!w&&(null===(m=this._menuCurrentlyOpen)||void 0===m?void 0:m.searchBoxGeneratedParagraphId)?t.content:this._paragraphTextExtractor.getQueryString(w,t.queryRange);if(this._menuCurrentlyOpen){if(void 0===n)return void await this.dismissECC(!1);this._menuCurrentlyOpen.queryRange=t.queryRange,this._menuCurrentlyOpen.keyStrokes=this._menuCurrentlyOpen.keyStrokes+1,this.updateSpecifiedItemsToDisplay(e,n,!1,void 0),this._menuCurrentlyOpen.onQueryUpdated&&this._menuCurrentlyOpen.onQueryUpdated(n),this._menuCurrentlyOpen.searchBoxGeneratedParagraphId||this.addZeroQueryHintText(),this._oaLogger.logActivity(N.WT,void 0,[...this.getDefaultLogDataForMenu()])}else if(w&&void 0!==n){const e=this._menus.get(F);if(e){let i;if((null===(f=this._nextMenuOpenIsViaNudge)||void 0===f?void 0:f.entityType)===D.c.File&&!this._nextMenuOpenIsViaNudge.hasEntityResults&&(null===(_=null===(v=this._hostSettings.serviceSettings)||void 0===v?void 0:v.nudge)||void 0===_?void 0:_.automaticallyScope)&&(null===(I=null===(y=this._hostSettings.oaSettings)||void 0===y?void 0:y.scopesConfig)||void 0===I?void 0:I.enabled)&&t.additionalData&&(this._queryDetection.setCurrentScope({entityType:D.c.File},!1),t.additionalData.scopeInfo={entityType:D.c.File}),e.enableExpandedECC&&(null===(C=this._hostSettings.oaSettings)||void 0===C?void 0:C.scopeToPeopleTabInExpandedECC)&&"@"===F&&t.additionalData&&(this._queryDetection.setCurrentScope({entityType:D.c.People},!1),t.additionalData.scopeInfo={entityType:D.c.People}),!e.enableExpandedECC&&(null===(S=this._hostSettings.oaSettings)||void 0===S?void 0:S.scopeToAppGptInlineSuggestion)&&"@"===F&&t.additionalData&&(this._queryDetection.setCurrentScope({entityType:D.c.App},!1),t.additionalData.scopeInfo={entityType:D.c.App}),this._menuCurrentlyOpen=this.setMenuCurrentlyOpen(F,e,w,t.queryRange,void 0,{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",brandingMode:e.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},!1,!0,!1,null===(b=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===b?void 0:b.source),L&&(this._menuCurrentlyOpen.supportedEntityTypes=L),1!==t.queryRange.length&&(this._menuCurrentlyOpen.keyStrokes=this._menuCurrentlyOpen.keyStrokes+1),this._menuCurrentlyOpen.expandedEccSearchBarConfig=this.buildExpandedEccSearchBarConfig(w,this._menuCurrentlyOpen.enableExpandedECCSearchBar),this._menuCurrentlyOpen.browseThisComputerConfig=this.buildBrowseThisComputerConfig(),this._menuCurrentlyOpen.appGptConfig=this.buildAppGptConfig(),this._menuCurrentlyOpen.enableExpandedECCSearchBar&&this._inlineSuggestionStore.isFlightEnabled("mc-editor-attachbutton-searchbar-position")&&this._triggeringMethod===oe.P.AttachFile){const e=null===(T=this._inlineSuggestionStore.getBestParentElement(w))||void 0===T?void 0:T.parentNode,t=null!==e?e.getBoundingClientRect():void 0;i=t?{x:t.left,y:t.top}:void 0}this.prepareAndRenderECC(w,n,!1,i)&&this.addZeroQueryHintText(),this._oaLogger.logActivity(N.WT,void 0,[...this.getDefaultLogDataForMenu()])}}await this.tryToUpdatePreloadedItems(t,e,i)}else x&&await this.dismissECC(!1)},this.tryToUpdatePreloadedItems=async(e,t,i=!1)=>{var n;if(!(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.getLocalItems))return void(this._inlineSuggestionStore.preloadedSuggestions.length&&this._inlineSuggestionStore.clearPreloadedSuggestions());const o=this._proofingDom.findParagraphNode(t),s=e.queryRange&&this._paragraphTextExtractor.getQueryString(o,e.queryRange);if(void 0!==s){const n=await this._menuCurrentlyOpen.getLocalItems(s);i?await this.updatePreloadedItems(n,e,t):await this.updatePreloadedItemsDebounced(n,e,t)}},this.updatePreloadedItems=async(e,t,i)=>{var n;const o=null===(n=t.additionalData)||void 0===n?void 0:n.scopeInfo,s=new Set,r=new Set,a=new Set;for(const e of this._inlineSuggestionStore.preloadedSuggestions)for(const t of e.entities)t.entityId&&s.add(t.entityId),t.nodeId&&a.add(t.nodeId);for(const t of e)for(const e of t.entities)e.entityId&&r.add(e.entityId);const l=s.size===r.size&&[...s].every((e=>r.has(e))),d=a.has(i),c=0===e.length&&0!==this._inlineSuggestionStore.preloadedSuggestions.length;l&&d&&!c||o&&!e.some((e=>e.entityType===o.entityType))||this._inlineSuggestionStore.setPreloadedSuggestions(e,i)},this.updatePreloadedItemsDebounced=(0,Z.debounce)(this.updatePreloadedItems,200),this.updateSpecifiedItemsToDisplay=(e,t,i,n)=>{var o;if(this._menuCurrentlyOpen)if(i&&this._inlineSuggestionStore.startNewECCMenu(this._menuCurrentlyOpen,(e=>{this.onItemSelected(e),this.dismissECC(!0)}),this.onItemFocused,this.onAction,this.onFooterAction,this._menuCurrentlyOpen.specifiedItemsToDisplay||this._menuCurrentlyOpen.onSuggestionsUpdated?this.onSuggestionsUpdated:void 0,this.onGroupSelected,this.onPreventDismissCalloutOnEvent,this.onRestoreFocus,this.dismissECC,this._menuCurrentlyOpen.getLocalItems?{isLoading:!1,resultReset:!1}:void 0,n,this.removeComposingBoxQuery,this.updateComposingBoxQuery,this.handleKeyDown,this._triggeringMethod,this.onSearchBoxQueryChange,this._menuCurrentlyOpen.appGptConfig),this._menuCurrentlyOpen.specifiedItemsToDisplay){const i=[];for(const e of this._menuCurrentlyOpen.specifiedItemsToDisplay){const n=e.entities.filter((e=>e.text.toLowerCase().includes(t.toLowerCase())));n.length>0&&i.push(Object.assign(Object.assign({},e),{entities:n}))}this._oaResultStore.updateResults(i,e,0===i.length?F.i.NoResults:F.i.Success,void 0,void 0,0===i.length?{NoResults:1}:{Success:1})}else(null===(o=this._hostSettings.oaSettings)||void 0===o?void 0:o.mockResults)||(i?this._oaResultStore.startNewECCMenu():this._oaResultStore.updateLoadingStatus(!0))},this.addZeroQueryHintText=()=>{var e,t,i,n,o,s;"InlineSuggestionsResultsUserInitiatedMenuType"===(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.menuType.menuType)&&this._menuCurrentlyOpen.queryRange.length===(null!==(i=null===(t=this._menuCurrentlyOpen.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1)&&(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.enableZeroQueryHintText)&&(null===(s=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===s?void 0:s.enabled)&&(void 0===this._hostSettings.serviceSettings.predictions.domInsertion||this._hostSettings.serviceSettings.predictions.domInsertion)&&!this._menuCurrentlyOpen.enableExpandedECCSearchBar&&this._safeWindow.requestAnimationFrame((async()=>{var e,t,i,n,o,s;if(!this._menuCurrentlyOpen||this._menuCurrentlyOpen.queryRange.length!==(null!==(t=null===(e=this._menuCurrentlyOpen.queryRange.prefix)||void 0===e?void 0:e.length)&&void 0!==t?t:1))return;const r=this._paragraphTextExtractor.getParagraphText(this._menuCurrentlyOpen.tileId),a=this._menuCurrentlyOpen.queryRange.start+(null!==(n=null===(i=this._menuCurrentlyOpen.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1),l="BizChat"===(null===(o=this._hostSettings.hostMetadata)||void 0===o?void 0:o.appName)?this._localizer.getMessage("ebx_ECCZeroQueryBizChatHintText")+" ":this._localizer.getMessage("ebx_ECCZeroQueryHintText")+" ";await(null===(s=this._predictionStore)||void 0===s?void 0:s.updatePrediction({text:l,context:null==r?void 0:r.substring(0,a),annotationId:"1",tileId:this._menuCurrentlyOpen.tileId,tileVersion:0,entityType:D.c.Text,startIndex:a,length:l.length,shouldDismissOnTextChange:!0,shouldShowInsertionHelperText:!1,isHelperText:!0}))}))},this.getCurrentPositionInDocument=(e,t)=>{var i,n;const o=this._proofingDom.findParagraphNode(e);let s=null!==(n=null===(i=null==o?void 0:o.element)||void 0===i?void 0:i.offset)&&void 0!==n?n:0;return s+=t,s},this.attachEventsToParentElement=e=>{var t;if(this.detachEventsFromParentElement(),!e)return;const i=new r.J(e),n=new r.J(e.ownerDocument);let o;try{(null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.top)&&e.ownerDocument.defaultView!==e.ownerDocument.defaultView.top&&(o=new r.J(e.ownerDocument.defaultView.top))}catch(e){this._logger.error(507606676,"Failed to create EventListener",e)}this._menuEventListeners.push(i),this._menuEventListeners.push(n),i.addListener("keydown",this.handleKeyDown),n.addListener("mouseup",this.handleMouseDown,{capture:!0});try{null==o||o.addListener("mouseup",(async e=>{(0,ie.m)(e.target)||!0!==e.target.isConnected||await this.dismissECC(!1)}),{capture:!0}),o&&this._menuEventListeners.push(o)}catch(e){this._logger.debug(508055872,"Unable to add event listener to parent window outside of iframe")}},this.detachEventsFromParentElement=()=>{for(const e of this._menuEventListeners)e.removeAllListeners();this._menuEventListeners=[]},this.handleKeyDown=e=>{(async e=>{var t,i,n,o;if(this._menuCurrentlyOpen){for(const t of[w.m.arrowDown,w.m.arrowUp,w.m.arrowLeft,w.m.arrowRight,w.m.enter,w.m.tab,w.m.end,w.m.home])if((x.x.isKey(e,t)||x.x.isKey(e,t,!0))&&this._inlineSuggestionStore.handleExternalKeyboardEvents(t,e.altKey))return e.stopPropagation(),void e.preventDefault();if(!x.x.isKey(e,w.m.arrowLeft)&&!x.x.isKey(e,w.m.arrowRight)||await this.isKeyCursorOverParagraph(e)||(0,ie.m)(e.target)){if(x.x.isKey(e,w.m.space)&&(null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.length)===(null===(n=null===(i=this._queryDetection.getCurrentQuery())||void 0===i?void 0:i.prefix)||void 0===n?void 0:n.length)&&this._oaLogger.logActivity(N.hf,void 0,[...this.getDefaultLogDataForMenu(),(0,h.n)("interaction",N.RK)]),x.x.isKey(e,w.m.delete)){const t=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,i=await this._tileContent.getTextSelection();(null==i?void 0:i.startPositionInParagraphNode)===t&&(this.dismissECC(!1),e.stopPropagation(),e.preventDefault())}x.x.isKey(e,w.m.escape)&&((null===(o=this._hostSettings.oaSettings)||void 0===o?void 0:o.enableCurrentQueryDismissalOnEscape)&&this._queryDetection.dismissCurrentQuery(!0,N.iL,N.hf,this.getDefaultLogDataForMenu()),this.dismissECC(!1),e.stopPropagation(),e.preventDefault())}else await this.dismissECC(!1)}})(e).catch((e=>{this._logger.error(506803665,"handleKeyDown threw an exception",e)}))},this.getQueryRangeBoundingClientRect=async()=>{if(!this._menuCurrentlyOpen)return null;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!(0,z.l)(e))return null;const t=await this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+this._menuCurrentlyOpen.queryRange.start,this._menuCurrentlyOpen.queryRange.length);return t?t.getBoundingClientRect():null},this.isMouseEventOverParagraph=async e=>{const t=await this.getQueryRangeBoundingClientRect();return!!t&&(e.clientX>=t.x&&e.clientX<=t.x+t.width&&e.clientY>=t.y&&e.clientY<=t.y+t.height)},this.isKeyCursorOverParagraph=async e=>{var t;if(!this._menuCurrentlyOpen)return!1;const i=this._menuCurrentlyOpen.queryRange.start,n=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,o=await this._tileContent.getTextSelection();if(void 0!==(null==o?void 0:o.startPositionInParagraphNode)){if((null===(t=o.startParagraphNode)||void 0===t?void 0:t.id)!==this._menuCurrentlyOpen.tileId)return!1;if(i===n)return!1;if(o.startPositionInParagraphNode>i&&o.startPositionInParagraphNode<n)return!0;if(o.startPositionInParagraphNode===i&&i!==n&&x.x.isKey(e,w.m.arrowRight))return!0;if(o.startPositionInParagraphNode===n&&i!==n&&x.x.isKey(e,w.m.arrowLeft))return!0}return!1},this.handleMouseDown=async e=>{this._featureFlagsReader.flags.enableNoDismissOnClickOutside&&(await this.isMouseEventOverParagraph(e)||(0,ie.m)(e.target)||!1===e.target.isConnected)||await this.dismissECC(!1)},this.dismissMenu=async()=>{await this.dismissECC(!1)},this.dismissECC=async e=>{var t,i,n,o;if(!this._menuCurrentlyOpen)return;this._queryDetection.resetNextDeltaProgramaticallyInserted(),this._menuCurrentlyOpen.enableExpandedECCSearchBar&&(this._searchBarQuery.length>0&&this.removeComposingBoxQuery(),this._clearSearchBox=!1,this._triggeringMethod=void 0,this._lastComposingBoxQuery=void 0,this._inlineSuggestionStore.setComposingBoxQuery(void 0),this._inlineSuggestionStore.setInitialMenuPosition(0));const s=this._menuCurrentlyOpen;this._menuCurrentlyOpen=void 0;const r=this._queryDetection.getPreviousQueryCorrelationKeys();this._oaLogger.logActivity(N.fL,void 0,[(0,h.n)("keyStrokeToSuccess",s.keyStrokes),(0,h.n)("persistTime",s.openTime?Date.now()-s.openTime:0),(0,h.n)("accepted",e),...this.getDefaultLogDataForMenu(s)],r),await this._inlineSuggestionsCalloutStore.setDisplayCallout(!1,void 0,void 0),this.detachEventsFromParentElement(),this.resetAriaAttributes(),this.removeShowMoreEntitiesParagraph(s),this._previouslySpecifiedItemsToDisplay=void 0,s.onClose&&s.onClose(e,s.openTime?Date.now()-s.openTime:0),this._queryDetection.removeDetectedQuery(),(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableZeroQueryHintText)&&await(null===(i=this._predictionStore)||void 0===i?void 0:i.clearPrediction());const l=this.isAtTriggeringChar(s);e?this.setAriaStatus(l?"ebx_AtCIQMentionsClosedViaInsertionAriaLabel":"ebx_SlashCIQMentionsClosedViaInsertionAriaLabel"):this.setAriaStatus(l?"ebx_AtCIQMentionsClosedAriaLabel":"ebx_SlashCIQMentionsClosedAriaLabel");const d=this._proofingDom.findParagraphNode(s.tileId),c=(null==d?void 0:d.parent)&&this._automaticallyOpenECCForTiles.get(d.parent.id);if(null==c?void 0:c.removeTextIfNotAccepted){this._isClearingSearch=!0;const e=this.getTileNode(s.tileId);if(e){const t=null!==(o=null===(n=s.queryRange.prefix)||void 0===n?void 0:n.length)&&void 0!==o?o:1,i=this.getCurrentPositionInDocument(s.tileId,s.queryRange.start);this._tileContent.remove(e,void 0,i+t,s.queryRange.length-t).then((()=>{this._isClearingSearch=!1})).catch((()=>{this._isClearingSearch=!1}))}}this._proofingEmitter.emit("eccStateChanged",{messageType:a.G.RemoveData})},this.isAtTriggeringChar=e=>"@"===e.queryRange.prefix,this.renderECC=()=>{this._menuCurrentlyOpen&&this._inlineSuggestionsCalloutStore.setDisplayCallout(!0,this._menuCurrentlyOpen,this._inlineSuggestionStore.getCalloutStateStoreProps()).then((()=>{var e;(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.onOpen)&&this._menuCurrentlyOpen.onOpen(this._menuCurrentlyOpen),this._menuCurrentlyOpen&&(this._menuCurrentlyOpen.wasOpenedViaNudge?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByNudgeAriaLabel":"ebx_SlashCIQMentionsOpenedByNudgeAriaLabel"):"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByUserTypingAriaLabel":"ebx_SlashCIQMentionsOpenedByUserTypingAriaLabel",this._menuCurrentlyOpen.queryRange.prefix):"InlineSuggestionsResultsFlagMenuType"===this._menuCurrentlyOpen.menuType.menuType&&this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByFlagAriaLabel":"ebx_SlashCIQMentionsOpenedByFlagAriaLabel"))})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to display callout: ${e}`)}))},this.getTileNode=e=>{const t=this._proofingDom.findParagraphNode(e);return null==t?void 0:t.parent},this.onAction=e=>{var t,i,n,o,s;if(this._menuCurrentlyOpen){if(e===$.L.ClearSearch){const e=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!e)return void this._oaLogger.logDiagnostics("No parent found for clearing search");this._oaLogger.logActivity(N.rN,void 0,this.getDefaultLogDataForMenu());const o=null!==(i=null===(t=this._menuCurrentlyOpen.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1;if(this._menuCurrentlyOpen.queryRange.length!==o&&"InlineSuggestionsResultsFlagMenuType"!==this._menuCurrentlyOpen.menuType.menuType){const t=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,this._menuCurrentlyOpen.queryRange.start);this._isClearingSearch=!0,this._tileContent.remove(e,void 0,t+o,this._menuCurrentlyOpen.queryRange.length-o).then((()=>{this._isClearingSearch=!1})).catch((()=>{this._isClearingSearch=!1}))}else"InlineSuggestionsResultsFlagMenuType"===this._menuCurrentlyOpen.menuType.menuType?(this._isClearingSearch=!0,this.initShowMoreEntitiesParagraph(null===(n=this._menuCurrentlyOpen.showMoreEntitiesConfig)||void 0===n?void 0:n.entityType,!1,""),this._oaLogger.logActivity(N.N2,void 0,this.getDefaultLogDataForMenu()),this._isClearingSearch=!1):(this._oaLogger.logDiagnostics("ECC query cleared with no query"),this.retryQuery())}else e===$.L.Retry&&this.retryQuery();null===(s=(o=this._menuCurrentlyOpen).onAction)||void 0===s||s.call(o,e)}},this.onPreventDismissCalloutOnEvent=e=>{var t,i,n;if(!this._menuCurrentlyOpen)return!1;if(this._isClearingSearch)return!0;if("InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType){if(this._featureFlagsReader.flags.enableNoDismissOnClickOutside&&["click","mouseup"].includes(e.type))return!0;if("resize"===e.type&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableResizeDismissal))return!1;if("resize"===e.type)return null===(i=this._resizeThrottle)||void 0===i||i.call(this),!0;if("scroll"===e.type)return null===(n=this._scrollThrottle)||void 0===n||n.call(this),!0}if(this._menuCurrentlyOpen.onPreventDismissCalloutOnEvent){if(this._menuCurrentlyOpen.onPreventDismissCalloutOnEvent(e,this._menuCurrentlyOpen))return!0}else if("focus"===e.type&&"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType)return!0;return!(!this._calloutDismissalHandler||this._calloutDismissalHandler.shouldDismissCallout(e,"ECC",this._menuCurrentlyOpen))},this.onRestoreFocus=(e,t)=>{var i;(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onRestoreFocus)?this._menuCurrentlyOpen.onRestoreFocus(e,t):t()},this.onGroupSelected=e=>{var t,i;null===(i=null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.onGroupSelected)||void 0===i||i.call(t,e)},this.telemetryKeptCallback=(e,t)=>{const i=this._oaLogger;e&&setTimeout((()=>{e()&&this._hostSettings.enableKeptMetric&&i.logActivity(N.qS,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(null!=t?t:{})])}),3e4)},this.onItemSelected=e=>{var t,i;if(!this._menuCurrentlyOpen)return;this._searchBarQuery="",e.wasOpenedViaNudge=this._menuCurrentlyOpen.wasOpenedViaNudge,e.wasOpenedViaNudgeAndHasEntityResults=null===(t=this._menuCurrentlyOpen.wasOpenedViaNudgeInfo)||void 0===t?void 0:t.hasEntityResults,this._oaLogger.logActivity(N.OE,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(e)]);const n=this._menuCurrentlyOpen.enableExpandedECCSearchBar,o=null!==(i=this._menuCurrentlyOpen.critiqueRange)&&void 0!==i?i:this._menuCurrentlyOpen.queryRange,s=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,n?this._initialMenuPosition:o.start);n&&this._searchBarQuery.length>0&&this._oaLogger.logActivity(N.Uj,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(e)]);const r=this._menuCurrentlyOpen.onItemSelected;if(this._menuCurrentlyOpen.shouldRemoveTextOnItemSelection){const t=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!t)return void this._oaLogger.logDiagnostics("No parent found for selecting ECC item.");const i=!n||void 0===this._lastComposingBoxQuery&&this._triggeringMethod!==oe.P.AttachFile&&this._triggeringMethod!==oe.P.Fre?o.length:this._lastComposingBoxQuery?this._lastComposingBoxQuery.length+1:1;this._tileContent.remove(t,void 0,s,i).then((i=>{r(e,i,t.element,this.telemetryKeptCallback)})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to remove text range for ECC application: ${e}`)}))}else if(this._menuCurrentlyOpen.shouldCalculateRemovalRange){const t=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!t)return void this._oaLogger.logDiagnostics("No tile found for selecting ECC item.");this._tileContent.getRangeOfNode(t,void 0,s,o.length).then((i=>{i?r(e,i,t.element,this.telemetryKeptCallback):this._oaLogger.logDiagnostics("Could not determine Range for the search query after selected ECC item.")})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to determine range for ECC application: ${e}`)}))}else r(e,void 0,void 0,this.telemetryKeptCallback);this.resetAriaAttributes()},this.retrieveMenuParentElement=()=>this._menuCurrentlyOpen?this._inlineSuggestionStore.getBestParentElement(this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId)):void 0,this.onItemFocused=e=>{var t;if(e.focusedItemHtmlId){const i=this.retrieveMenuParentElement();if(!i)return;(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.enableExpandedECC)&&this.handleExpandedEccFocus(i,e),this._hostSettings.enableDetachedAccessibilityElementForEcc&&this.handleDetachedAccessibilityElement(i,e),i.setAttribute("aria-activedescendant",e.focusedItemHtmlId),i.setAttribute("aria-controls",e.focusedItemHtmlId),i.setAttribute("aria-owns",e.focusedItemHtmlId),this._parentElementAriaRef=i}else this.resetAriaAttributes()},this.resetAriaAttributes=()=>{if(this._accessibilityElement&&(this._accessibilityElement.remove(),this._accessibilityElement=void 0),this._parentElementAriaRef)this._parentElementAriaRef.removeAttribute("aria-activedescendant"),this._parentElementAriaRef.removeAttribute("aria-controls"),this._parentElementAriaRef.removeAttribute("aria-owns"),this._parentElementAriaRef=void 0;else{const e=this.retrieveMenuParentElement();null==e||e.removeAttribute("aria-activedescendant"),null==e||e.removeAttribute("aria-controls"),null==e||e.removeAttribute("aria-owns")}},this.updateComposingBoxQuery=e=>{var t;this._lastComposingBoxQuery=e?void 0:null!==(t=this._lastComposingBoxQuery)&&void 0!==t?t:this._lastComposingBoxQuery=this._inlineSuggestionStore.queryString,this._inlineSuggestionStore.setComposingBoxQuery(this._lastComposingBoxQuery)},this.removeComposingBoxQuery=(e,t)=>{var i,n;if(!this._menuCurrentlyOpen)return;const o=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!o)return;const s=this._triggeringMethod!==oe.P.AttachFile&&this._triggeringMethod!==oe.P.Fre,r=s?1:null!==(n=null===(i=this._menuCurrentlyOpen.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1;if(this._menuCurrentlyOpen.queryRange.length===r&&this._triggeringMethod!==oe.P.AttachFile)return;const a=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,this._initialMenuPosition);this._isClearingSearch=!0;const l=s?void 0!==this._lastComposingBoxQuery?this._lastComposingBoxQuery.length+1:1:this._menuCurrentlyOpen.queryRange.length;s&&l-r==0||(this._triggeringMethod===oe.P.AttachFile?(this._inlineSuggestionStore.setMenuPositionNoteId(this._menuCurrentlyOpen.tileId),this._inlineSuggestionStore.setMenuPositionQueryRange(this._menuCurrentlyOpen.queryRange),this._tileContent.replace(o,void 0,a,l," ").then((()=>{null==e||e.focus()})).finally((()=>{this._isClearingSearch=!1}))):this._tileContent.remove(o,void 0,a+r,l-r).then((()=>{if(t){this.updateComposingBoxQuery(!0),this._inlineSuggestionStore.setQueryString("");const e=document.querySelectorAll("input[type=search]");e.length>0&&(e[0].focus(),e[0].setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")))}})).finally((()=>{var e,t,i;if(this._clearSearchBox){const n=null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.triggerCharacter,o=null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.tileId;if(!o)return;const s=this._proofingDom.findParagraphNode(o);if(!s)return;this.emitHostDataToGenerateMenuItems(n+"",{start:0,length:null!==(i=null==n?void 0:n.length)&&void 0!==i?i:0,prefix:n},s,void 0,!0)}this._clearSearchBox=!1,this._isClearingSearch=!1})))},this.getLogDataForSuggestion=e=>{var t,i;return e.entityType===D.c.File?[(0,h.n)("selectedType",e.entityType),(0,h.n)("fileType",null!==(t=e.FileExtension)&&void 0!==t?t:"Unknown"),(0,h.n)("fileSource",e.FileSourceType)]:e.entityType===D.c.Loop?[(0,h.n)("selectedType",e.entityType),(0,h.n)("loopType",null!==(i=e.id)&&void 0!==i?i:"Unknown")]:[(0,h.n)("selectedType",e.entityType)]},this._resizeThrottle=(0,g.IS)(this._safeWindow,window,this.renderECC,25,"After"),this._scrollThrottle=(0,g.hQ)(this._safeWindow,window,this.renderECC,"After")}getCurrentMenuInfo(){return this._menuCurrentlyOpen}enableInlineSuggestionsMenu(e,t,i,n,o,s,r,a,l,d,c,u,h,g,p,m,f,v,_,y,I,C,S,b){var T,E;if(!t)throw Error("You must specify a query character.");if(this._menus.get(t))throw Error("This character is already being used for menu creation.");this._menus.set(t,{supportedEntityTypes:e,onItemSelected:i,specifiedItemsToDisplay:n,theme:o,style:s,styles:r,onOpen:a,onClose:l,onAction:d,onSuggestionsUpdated:u,onRestoreFocus:h,onPreventDismissCalloutOnEvent:g,shouldRemoveTextOnItemSelection:null==c||c,onGroupSelected:p,brandingMode:m,enableScopedHeader:f,getLocalItems:v,isDividerShown:_,noSuggestionsHeaderInfo:y,newEntityTypes:I,newItemsById:S,enableExpandedECC:C,browseThisComputerConfig:null===(T=this._hostSettings.serviceSettings)||void 0===T?void 0:T.browseThisComputerSettings,appGptConfig:null===(E=this._hostSettings.serviceSettings)||void 0===E?void 0:E.appGptConfig,enableExpandedECCSearchBar:void 0!==b?b:this._inlineSuggestionStore.isFlightEnabled("mc-editor-enable-searchbar")}),this._queryDetection.registerQueryDetectionStartCharacter(t)}disableInlineSuggestionsMenu(e){if(!e)throw Error("You must specify a query character.");if(!this._menus.get(e))throw Error("This character is not being used for menu creation.");this._menus.delete(e),this._queryDetection.unregisterQueryDetectionStartCharacter(e),this._menuCurrentlyOpen&&this._menuCurrentlyOpen.queryRange.prefix===e&&this.dismissECC(!1)}removeAutomaticallyOpenECCOnTileInteractions(e){const t=this._automaticallyOpenECCForTiles.get(e);if(!t)throw Error("This tile is not set to automatically open the ECC on interaction.");this._automaticallyOpenECCForTiles.delete(e),t.eventHandlerDisposal()}async openMenuAtCursor(e,t,i,n){var o,s,r;const a=await this._tileContent.getTextSelection();let l,d;if((null==a?void 0:a.endParagraphNode)&&a.endPositionInParagraphNode)l=a.endParagraphNode.id,d=a.endPositionInParagraphNode;else{if(!(null===(o=e.children)||void 0===o?void 0:o.length))return;l=e.children[0].id,d=0}await this.showExistingMenu(l,d,0,t,!1,null!==(r=null===(s=this._menus.get(t))||void 0===s?void 0:s.shouldRemoveTextOnItemSelection)&&void 0!==r&&r,i,void 0,void 0,void 0,n)}prepareAndRenderECC(e,t,i=!0,n){const o=this._queryDetection.getCurrentQueryLogicalId();o&&this._oaMetric.addMeasure(o,"InlineSuggestionsRenderer"),i&&this._inlineSuggestionStore.setQueryString(t);const s=this._inlineSuggestionStore.getBestParentElement(e);return s&&this.attachEventsToParentElement(s),this.updateSpecifiedItemsToDisplay(e.id,t,!0,n),this.renderECC(),this._proofingEmitter.emit("eccStateChanged",{messageType:a.G.NewData}),!0}emitHostDataToGenerateMenuItems(e,t,i,n,o,r){var a,d;const c=new P.s({deltaType:q.WI.Update,unit:q.OD.Chars,position:t.start,length:t.length,content:e,queryRange:t,userInfo:{userType:q.HS.SessionUser}}),u=o?this._queryDetection.getCurrentScope():void 0;c.additionalData=this._queryDetection.setCurrentQueryRange(i.id,t,r,null!=u?u:n,null===(a=this._menuCurrentlyOpen)||void 0===a?void 0:a.triggerCharacter),o?c.additionalData.scopeInfo=u:n&&(c.additionalData.scopeInfo=n);const h=(0,M.F)(i);this._hostEmitter.emit(s.pD.hostModelDelta,{address:void 0,message:{tileId:i.id,tileVersion:null!==(d=i.eventSeqId)&&void 0!==d?d:0,documentModel:null==h?void 0:h.documentModel,delta:c,sourceType:l.p.ParagraphNode,changeType:l.Q.Code,deletedOrReplacedCharacters:void 0}})}retryQuery(){if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!e)return;const t=(0,M.F)(e);this._oaLogger.logActivity(N.hG,void 0,this.getDefaultLogDataForMenu()),this._hostEmitter.emit(s.pD.oaMenuControlSignal,{address:void 0,message:{mode:A.O.UserInitiated,retry:!0,documentModel:null==t?void 0:t.documentModel}})}getDefaultLogDataForMenu(e){var t,i,n,o,s,r;const a=null!=e?e:this._menuCurrentlyOpen;if(!a)return[];const l=null!==(n=null!==(i=null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.prefix)&&void 0!==i?i:a.triggerCharacter)&&void 0!==n?n:"@",d=this._queryDetection.getCurrentScope();return[(0,h.n)("scope",null!==(o=null==d?void 0:d.entityType)&&void 0!==o?o:""),(0,h.n)("keyStrokes",a.keyStrokes),(0,h.n)("isEmptyQuery",a.queryRange.length===l.length),(0,h.n)("wasOpenedViaNudge",a.wasOpenedViaNudge),(0,h.n)("triggerCharacter",l),(0,h.n)("wasOpenedIsViaNudgeAndHasEntityResults",null!==(r=null===(s=a.wasOpenedViaNudgeInfo)||void 0===s?void 0:s.hasEntityResults)&&void 0!==r&&r),(0,h.n)("wasOpenedViaAutomaticAtMention",a.wasOpenedViaAutomaticAtMention),(0,h.n)("wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===a.menuType.menuType),(0,h.n)("menuType",a.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")),(0,h.n)(N.JZ,!!this._hostSettings.enableKeptMetric)]}setAriaStatus(e,t){var i,n;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(n=null===(i=this._ariaStatusStateStoreFactory)||void 0===i?void 0:i.call(this))||void 0===n||n.setStatus(this._localizer.getMessage(e,t),"assertive",!1))}setMenuCurrentlyOpen(e,t,i,n,o,s,r=!1,a=!0,l=!1,d){var c,u;const h=Object.assign(Object.assign({triggerCharacter:e},t),{onFooterAction:e=>{var i;this.runDefaultFooterActionIfAvailable(e)||null===(i=t.onFooterAction)||void 0===i||i.call(t,e),this.dismissECC(!1)},targetLocation:{x:0,y:0},targetOffset:o,tileId:i.id,parentTileId:null===(c=i.parent)||void 0===c?void 0:c.id,parentTileOffset:null===(u=i.element)||void 0===u?void 0:u.offset,shouldDismissOnTyping:r,shouldCalculateRemovalRange:a,menuType:s,openTime:Date.now(),queryRange:n,close:()=>{this.dismissECC(!1)},getQuery:()=>{if(this._menuCurrentlyOpen){const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);return this._paragraphTextExtractor.getQueryString(e,this._menuCurrentlyOpen.queryRange)}},onQueryUpdated:void 0,wasOpenedViaNudge:!!this._nextMenuOpenIsViaNudge,wasOpenedViaNudgeInfo:this._nextMenuOpenIsViaNudge,keyStrokes:0,wasOpenedViaAutomaticAtMention:l,invocationSource:d});return this._nextMenuOpenIsViaNudge=void 0,this._initialMenuPosition=n.start,this._inlineSuggestionStore.setInitialMenuPosition(n.start),h}runDefaultFooterActionIfAvailable(e){var t,i,n,s,r,a,l;if(e===o._R.OpenEditorPane)null===(i=null===(t=this._indicatorStore)||void 0===t?void 0:t.onOpenEditorPane)||void 0===i||i.call(t,L.k.ContextualCard);else if(e===o._R.Options)null===(n=this._externalSettingsFeature)||void 0===n||n.openSettings(d.kY.dropdown);else{if(e!==o._R.Feedback)return!1;null===(r=null===(s=this.feedbackStoreFactory)||void 0===s?void 0:s.call(this))||void 0===r||r.feedbackIconClicked("",null!==(l=null===(a=this._menuCurrentlyOpen)||void 0===a?void 0:a.triggerCharacter)&&void 0!==l?l:"Unknown menu type")}return!0}buildInlineSuggestionsResultsMenuActions(e,t,i,n){var s;const r=[];switch(e){case"flag":t&&r.push(o._R.ReadAloud),i&&r.push(o._R.IgnoreRule),this._hostSettings.isFeedbackEnabledForEcc&&r.push(o._R.Feedback),this._hostSettings.ignoreAllEnabled&&r.push(o._R.IgnoreAll),this._hostSettings.ignoreOnceEnabled&&r.push(o._R.IgnoreOnce),this._hostSettings.showOptionsButton&&r.push(o._R.Options),this._paneOpenState&&(this._paneOpenState.isPaneOpen?n&&(r.push(o._R.Previous),r.push(o._R.Next)):r.push(o._R.OpenEditorPane));break;case"userInitiated":this._hostSettings.showOptionsButton&&r.push(o._R.Options),this._hostSettings.isFeedbackEnabledForEcc&&r.push(o._R.Feedback),(null===(s=this._paneOpenState)||void 0===s?void 0:s.isPaneOpen)||r.push(o._R.OpenEditorPane)}return r}handleExpandedEccFocus(e,t){this._safeWindow.requestAnimationFrame((()=>{var i,n;const o=e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`),s=(null===(i=t.item)||void 0===i?void 0:i.type)===D.c.Scope;o&&s&&((null===(n=t.item)||void 0===n?void 0:n.isSelected)?o.ariaSelected="true":o.ariaSelected="false")}))}handleDetachedAccessibilityElement(e,t){this._safeWindow.requestAnimationFrame((()=>{var i,n;const o=e.getRootNode(),s=e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`);if(!((null==s?void 0:s.ariaLabel)&&o instanceof ShadowRoot))return;if(this._hostSettings.enableExpandedECCAccessibilityElement){if(this._accessibilityElement)this._accessibilityElement.removeAttribute("aria-label"),this._accessibilityElement.removeAttribute("role");else{this._accessibilityElement=e.ownerDocument.createElement("div"),this._accessibilityElement.setAttribute("role","listBox");const t=e.ownerDocument.querySelector("#inlineSuggestionsEnclosingDiv");this._accessibilityElement.setAttribute("aria-label",(null==t?void 0:t.getAttribute("aria-label"))||"")}this._accessibilityElement.style.cssText="width: 0; height: 0; overflow: hidden;"}this._accessibilityElement||(this._accessibilityElement=e.ownerDocument.createElement("div"),this._accessibilityElement.setAttribute("role","listbox"),this._accessibilityElement.style.cssText="width: 0; height: 0; overflow: hidden;");const r=e.ownerDocument.createElement("button");this._hostSettings.enableExpandedECCAccessibilityElement?(r.setAttribute("role",s.getAttribute("role")||"option"),r.setAttribute("type",s.getAttribute("type")||"button"),r.id=t.focusedItemHtmlId,r.innerText=s.ariaLabel,r.ariaLabel=s.ariaLabel,s.id.includes("header")||s.id.includes("overflow")?(this._accessibilityElement.setAttribute("aria-label","tablist"),r.ariaPosInSet=String(Number(s.id.substring(s.id.length-1,s.id.length))+1),r.ariaSetSize=String(null===(n=null===(i=s.parentElement)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.children.length),r.ariaSelected=s.getAttribute("aria-selected")):(r.ariaPosInSet=s.ariaPosInSet,r.ariaSetSize=s.ariaSetSize,r.ariaSelected="true")):(r.setAttribute("role","option"),r.setAttribute("type","button"),r.id=t.focusedItemHtmlId,r.innerText=s.ariaLabel,r.ariaLabel=s.ariaLabel,r.ariaPosInSet=s.ariaPosInSet,r.ariaSetSize=s.ariaSetSize,r.ariaSelected="true"),this._accessibilityElement.children.length&&this._accessibilityElement.children[0].remove(),this._accessibilityElement.appendChild(r),o.appendChild(this._accessibilityElement)}))}};se=(0,n.__decorate)([(0,X._)(),(0,n.__param)(0,(0,ee.W)(p.n)),(0,n.__param)(1,(0,ee.W)(m.m)),(0,n.__param)(2,(0,ee.W)(f.g)),(0,n.__param)(3,(0,ee.W)(v.u)),(0,n.__param)(4,(0,ee.W)(_.G)),(0,n.__param)(5,(0,ee.W)(s.M5)),(0,n.__param)(6,(0,ee.W)(W.w)),(0,n.__param)(7,(0,ee.W)(j.b)),(0,n.__param)(8,(0,ee.W)(H.I)),(0,n.__param)(9,(0,ee.W)(B.d)),(0,n.__param)(10,(0,ee.W)(G.C)),(0,n.__param)(11,(0,ee.W)(y.J)),(0,n.__param)(12,(0,ee.W)(I.H)),(0,n.__param)(13,(0,ee.W)(C.c)),(0,n.__param)(14,(0,ee.W)(V.Z)),(0,n.__param)(15,(0,ee.W)(S.o)),(0,n.__param)(16,(0,ee.W)(b.j)),(0,n.__param)(17,(0,te.l)()),(0,n.__param)(17,(0,ee.W)(T.F)),(0,n.__param)(18,(0,te.l)()),(0,n.__param)(18,(0,ee.W)(Q.o)),(0,n.__param)(19,(0,te.l)()),(0,n.__param)(19,(0,ee.W)(O.Th)),(0,n.__param)(20,(0,te.l)()),(0,n.__param)(20,(0,ee.W)(K.$)),(0,n.__param)(21,(0,te.l)()),(0,n.__param)(21,(0,ee.W)(k.J)),(0,n.__param)(22,(0,te.l)()),(0,n.__param)(22,(0,ee.W)(d.In)),(0,n.__param)(23,(0,te.l)()),(0,n.__param)(23,(0,ee.W)(E.f)),(0,n.__param)(24,(0,te.l)()),(0,n.__param)(24,(0,ee.W)(U.g))],se)},19881:(e,t,i)=>{i.d(t,{Z:()=>d});var n=i(23182),o=i(33767),s=i(15661),r=i(29906),a=i(83010);function l(e){return null==e}let d=class{constructor(e,t){this._hostSettings=e,this._oaLogger=t,this._appDefinitionIdMapCacheTTLInMilliseconds=6e4,this._appDefinitionIdMapCacheDisabled=!1,this.getAppDefinitionIdMap=async()=>{var e;if(null===(e=this._messageExtensionAppSuggestionSetting)||void 0===e?void 0:e.enabled)return!this._appDefinitionIdMapCacheDisabled&&this._appDefinitionIdMapLastNetwrokCallTime&&this._appDefinitionIdMapLastNetwrokCallTime+this._appDefinitionIdMapCacheTTLInMilliseconds>(new Date).getTime()?this._appDefinitionIdMap:(this.clearTimeout(),Promise.race([this.getAndAddAppDefinitionIdMapToCache(),this.getTimeoutPromise()]))},this.getAndAddAppDefinitionIdMapToCache=()=>new Promise((e=>this._getAppDefinitionIdMapCallback?this._getAppDefinitionIdMapCallback().then((t=>(this.clearTimeout(),this._appDefinitionIdMapCacheDisabled||(this._appDefinitionIdMap=t,this._appDefinitionIdMapLastNetwrokCallTime=(new Date).getTime()),e(t)))).catch((()=>(this.clearTimeout(),this._oaLogger.logDiagnostics("Failed to get appDefinitionIdMap from Host"),e(void 0)))):e(void 0))),this.getTimeoutPromise=(e=3e3)=>new Promise((t=>{this._timeoutId=setTimeout((()=>(this._oaLogger.logDiagnostics("getAppDefinitionIdMap:: request timeout"),t(void 0))),e)})),this.clearTimeout=()=>{this._timeoutId&&clearTimeout(this._timeoutId)},this.initialize()}initialize(){var e,t;this._messageExtensionAppSuggestionSetting=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.messageExtensionAppSuggestion,(null===(t=this._messageExtensionAppSuggestionSetting)||void 0===t?void 0:t.enabled)&&(this._getAppDefinitionIdMapCallback=this._messageExtensionAppSuggestionSetting.getAppDefinitionIdMapCallback,this._appDefinitionIdMapCacheDisabled=!l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)&&0===this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds,this._appDefinitionIdMapCacheTTLInMilliseconds=l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)?this._appDefinitionIdMapCacheTTLInMilliseconds:this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.n)),(0,n.__param)(1,(0,a.W)(s.m))],d)},20889:(e,t,i)=>{if(i.d(t,{S:()=>o}),2063!=i.j)var n=i(62575);function o(e){if(e)return(0,n.L)(e)?e:"Cloud"}},26297:(e,t,i)=>{function n(e){if(null===s&&function(){s={};for(const e in r)s[e]=new RegExp("["+r[e]+"]","g")}(),e&&!function(e){null===o&&function(){let e="[";for(const t in r)e+=r[t];e+="]",o=new RegExp(e)}();const t=null==o?void 0:o.test(e.toLowerCase());return!t}(e))for(const t in s)e=e.replace(s[t],t);return e}i.d(t,{S:()=>n});let o=null,s=null;const r={a:"A",b:"B",c:"C",d:"D",e:"E",f:"F",g:"G",h:"H",i:"I",j:"J",k:"K",l:"L",m:"M",n:"N",o:"O",p:"P",q:"Q",r:"R",s:"S",t:"T",u:"U",v:"V",w:"W",x:"X",y:"Y",z:"Z",2:"",3:"",:"",1:"",ae:"",th:"",ss:"",:"",oe:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",pts:"",tm:"",:"",4:"",5:"",6:"",7:"",8:"",9:"",10:"",11:"",12:"",13:"",14:"",15:"",16:"",17:"",18:"",19:"",20:"",0:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",21:"",22:"",23:"",24:"",25:"",26:"",27:"",28:"",29:"",30:"",31:"",32:"",33:"",34:"",35:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",36:"",37:"",38:"",39:"",40:"",41:"",42:"",43:"",44:"",45:"",46:"",47:"",48:"",49:"",50:"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"",hg:"",erg:"",ev:"",ltd:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","0":"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"",hpa:"",da:"",au:"",bar:"",ov:"",pc:"",dm:"",dm2:"",dm3:"",iu:"",:"",:"",:"",:"",:"",pa:"",na:"",a:"",ma:"",ka:"",kb:"",mb:"",gb:"",cal:"",kcal:"",pf:"",nf:"",f:"",g:"",mg:"",kg:"",hz:"",khz:"",mhz:"",ghz:"",thz:"",:"",m:"",d:"",k:"",fm:"",nm:"",m:"",mm:"",cm:"",km:"",mm2:"",cm2:"",m2:"",km2:"",mm3:"",cm3:"",m3:"",km3:"",ms:"",ms2:"",kpa:"",mpa:"",gpa:"",rad:"",rads:"",rads2:"",ps:"",ns:"",s:"",pv:"",nv:"",v:"",mv:"",kv:"",pw:"",nw:"",w:"",mw:"",kw:"",k:"",m:"",am:"",bq:"",cc:"",cd:"",ckg:"",co:"",db:"",gy:"",ha:"",hp:"",in:"",kk:"",kt:"",lm:"",ln:"",log:"",lx:"",mil:"",mol:"",ph:"",pm:"",ppm:"",pr:"",sr:"",sv:"",wb:"","1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""}},96821:(e,t,i)=>{if(i.d(t,{X:()=>r}),2063!=i.j)var n=i(53353);if(2063!=i.j)var o=i(71641);if(2063!=i.j)var s=i(21592);function r(e,t){const i=(0,s.$)().getStringsFor("InlineSuggestionStrings");switch(e){case n.c.File:return i("fileEntityLabel");case n.c.People:return i("peopleEntityLabel");case n.c.Loop:return i("loopsEntityLabel");case n.c.Topic:return i("topicsEntityLabel");case n.c.External:return i("externalEntityLabel");case n.c.MessageExtensionApp:return i("appEntityLabel");case n.c.Scope:return i("scopeEntityLabel");case n.c.Event:return i("eventEntityLabel");case n.c.Channel:return i("channelEntityLabel");case n.c.Chat:return i("chatEntityLabel");case n.c.Team:return i("teamEntityLabel");case n.c.Message:return i("emailEntityLabel");case n.c.PIM:return t===o.Nm.Address?i("addressEntityLabel"):t===o.Nm.Membership?i("membershipEntityLabel"):i("phoneEntityLabel");default:return e}}},3216:(e,t,i)=>{if(i.d(t,{Z:()=>g}),2063!=i.j)var n=i(21592);const o=6e4,s=60*o,r=24*s,a=7,l=24,d=1,c=2,u=.8,h=-10*o;function g(e,t){const i=(0,n.$)().getStringsFor("DateTimeStrings"),g=(e,...t)=>{let n=i(e);return t.filter(Boolean).forEach(((e,t)=>{n=n.replace(`{${t}}`,e)})),n},p=t.getTime()-e.getTime();if(p<0)return p<=h?"":g("justNow");const m=Math.round(p/r),f=Math.round(p/s);if(m>a)return function(e,t){const i=(0,n.$)(),o=i.getStringsFor("MonthsNames"),s=[o("January"),o("February"),o("March"),o("April"),o("May"),o("June"),o("July"),o("August"),o("September"),o("October"),o("November"),o("December")][e.getMonth()],r=`${s} ${e.getDate().toString()}, ${e.getFullYear().toString()}`,a=`${s} ${e.getDate().toString()}`,l=t.getFullYear()===e.getFullYear()?a:r;return l}(e,t);if(f>=l)return m>1?g("daysAgo",m.toString()):g("oneDayAgo");if(f>=c)return f>1?g("hoursAgo",f.toString()):g("oneHourAgo");if(f>=u)return d>1?g("hoursAgo",d.toString()):g("oneHourAgo");const v=Math.round(p/o);return v<=c?g("justNow"):g("minutesAgo",v.toString())}},82899:(e,t,i)=>{i.r(t),i.d(t,{mockInlineSuggestions:()=>s});var n=i(53353),o=i(57645);const s=[{entities:[{entityType:n.c.People,Id:"0",text:"Annie Reid",EmailAddresses:["areid@microsoft.com"],confidence:0},{entityType:n.c.People,Id:"0",text:"Ed Taylor",EmailAddresses:["et@microsoft.com"],confidence:0},{entityType:n.c.People,Id:"0",text:"Clippy",EmailAddresses:["clippy@microsoft.com"],confidence:0}],entityType:n.c.People},{entities:[{entityType:n.c.File,Id:"0",FileSourceType:"Unknown",text:"Feature Spec",FileName:"Feature Spec",FileExtension:"Docx",FileSize:1e3,AccessUrl:"mockFile.gg/FeatureSpec",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"1",FileSourceType:"Unknown",text:"Planning Deck",FileName:"Planning Deck",FileExtension:"pptx",FileSize:1e3,AccessUrl:"mockFile.gg/PlanningDeck",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",isBestMatch:!0,confidence:0},{entityType:n.c.File,Id:"2",FileSourceType:"Unknown",text:"Crunched Numbers",FileName:"Crunched Numbers",FileExtension:"xls",FileSize:1e3,AccessUrl:"mockFile.gg/CrunchedNumbers",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"3",FileSourceType:"Unknown",text:"Some Contract with a very very long name",FileName:"Some Contract with a very very long name",FileExtension:"pdf",FileSize:1e3,AccessUrl:"mockFile.gg/contract",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"4",FileSourceType:"Unknown",text:"Even more files",FileName:"Even more files",FileExtension:"txt",FileSize:1e3,AccessUrl:"mockFile.gg/txt",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0}],entityType:n.c.File},{entities:[{ContentDomainName:"People",ScopeTitle:"Insert People",ScopeDescription:"Search people in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",entityType:n.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",text:"Insert People",scopeInfo:{entityType:"People",contentSource:""},confidence:0},{ContentDomainName:"Files",ScopeTitle:"Insert Files",ScopeDescription:"Search files in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",entityType:n.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",text:"Insert Files",scopeInfo:{entityType:"File",contentSource:""},confidence:0},{ItemId:"Ci7lEZX87y1MfPYPsAnbHw",Title:"FL Desktop 2.0",Url:"https://www.figma.com/file/Ci7lEZX87y1MfPYPsAnbHw",IconUrl:"https://figmaconnector.blob.core.windows.net/assets/icons/figma-logo.svg",ContentDomainId:"nonEssFigmaConnector",Authors:[],LastModifiedDateTimeUtc:"2022-04-26T03:57:42",CreatedTimeUtc:"2022-04-26T03:57:42",Text:"FL Desktop 2.0",PropertyHits:[],ReferenceId:"e60f6f30-9164-8d5e-7451-1da86e66df64.7000.22",entityType:n.c.External,Id:"Ci7lEZX87y1MfPYPsAnbHw",text:"FL Desktop 2.0",confidence:0}],entityType:n.c.Scope},{entities:[{entityType:n.c.Loop,Id:"0",text:"Action Items",icon:{iconName:"FFXCCompleted"},confidence:0},{entityType:n.c.Loop,Id:"0",text:"Bulleted List",icon:{iconName:"FFXCBulletedList"},confidence:0},{entityType:n.c.Loop,Id:"0",text:"Checklist",icon:{iconName:"FFXCChecklist"},confidence:0}],entityType:n.c.Loop},{entities:[{entityType:n.c.MessageExtensionApp,AppId:"ExcelOnline",DisplayName:"Excel",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.1",Id:"ExcelOnline",text:"Excel",confidence:0},{entityType:n.c.MessageExtensionApp,AppId:"f12466e6-a66c-495f-86f5-135938125391",DisplayName:"Azure DevOps (Internal)",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.2",Id:"f12466e6-a66c-495f-86f5-135938125391",text:"Azure DevOps (Internal)",confidence:0}],entityType:n.c.MessageExtensionApp},{entityType:n.c.Event,entities:[{entityType:n.c.Event,confidence:1,text:"Multiday meeting",EventId:{Id:"id1"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",HasRecording:!0,isBestMatch:!0},{entityType:n.c.Event,confidence:1,text:"Sameday meeting",EventId:{Id:"id2"},Start:"2023-05-12T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",isBestMatch:!0},{entityType:n.c.Event,confidence:1,text:"Multiday all day meeting",EventId:{Id:"id3"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",IsAllDay:!0}]},{entityType:n.c.Message,entities:[{entityType:n.c.Message,confidence:1,text:"Error while running Local IIS",Subject:"Error while running Local IIS",From:{EmailAddress:{Name:"John Doe"}},ItemId:{Id:"id1"}},{entityType:n.c.Message,confidence:1,text:"RE: Enable console logging question",Subject:"RE: Enable console logging question",From:{EmailAddress:{Name:"Jane Doe"}},ItemId:{Id:"id2"}}]},{entityType:n.c.Chat,entities:[{entityType:n.c.Chat,confidence:1,text:"Group Chat",Name:"Group Chat",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4,ChatMembers:[{Id:"1",ResultSource:o.F.Server,confidence:1,entityType:n.c.People,text:"John Doe"}]},{entityType:n.c.Chat,confidence:1,text:"Group Chat 2",Name:"Group Chat 2",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:5,ChatMembers:[{Id:"1",ResultSource:o.F.Server,confidence:1,entityType:n.c.People,text:"John Doe"},{Id:"2",ResultSource:o.F.Server,confidence:1,entityType:n.c.People,text:"Jane Doe"}]}]},{entityType:n.c.Channel,entities:[{entityType:n.c.Channel,confidence:1,text:"Developer Channel",Name:"Developer Channel",TeamName:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entityType:n.c.Team,entities:[{entityType:n.c.Team,confidence:1,text:"Editor-SDK",Name:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entities:[{entityType:n.c.App,id:"id",Title:"Sales meetings",text:"",subtitle:"Turned on last week",imageUrl:"https://vivasales.dynamics.com/outlookaddin/manifestimages/appLogoCopilotForSales_64px.png",confidence:0},{entityType:n.c.App,Title:"Bing",subtitle:"Available on Copilot",text:"Turned on last week",imageUrl:"https://content.powerapps.com/resource/powerbiwfe/images/PowerBI96x96.c2c49fdb8eb6008a98b3.png",confidence:0}],entityType:n.c.App}]},12220:(e,t,i)=>{i.d(t,{AK:()=>b,CL:()=>E,JZ:()=>r,N2:()=>L,OE:()=>s,OY:()=>u,R7:()=>T,RK:()=>I,Ss:()=>C,Uj:()=>A,WT:()=>c,cc:()=>f,dm:()=>o,fL:()=>l,g7:()=>y,h8:()=>F,hG:()=>g,hf:()=>d,hk:()=>v,iI:()=>x,iL:()=>_,l1:()=>p,mj:()=>w,qS:()=>a,rE:()=>m,rN:()=>h,s1:()=>n,tb:()=>N,vb:()=>S,xe:()=>D});const n="OAPanelDisplayed",o="OAPanelUserInteraction",s="OAValueInserted",r="keptMetricEnabled",a="OAValueKept",l="OAPanelClosed",d="OACurrentQueryDismiss",c="OAPanelRequestUpdate",u="OAPanelUpdated",h="OAPanelClearQuery",g="OAPanelRetry",p="MouseEntering",m="DownArrow",f="UpArrow",v="Enter",_="Escape",y="Tab",I="Space",C="OAClientLayout",S="OAResponseReceived",b="OAClientDataSource",T="suggestions",E="GraphSearch",N="OAShowMoreEntitiesOpened",x="OAShowMoreEntitiesError",w="OAShowMoreEntitiesClosed",L="OAShowMoreEntitiesSearchCleared",D="OAShowMoreEntitiesSearchChanged",F="ExpandedEccSearchBarTextChaged",A="ExpandedEccSearchBarResultSelected"},85793:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(17298).f)("IMultilingualFreStore")},26876:(e,t,i)=>{i.d(t,{V:()=>F,S:()=>A});var n=i(23182),o=i(99724),s=i(8628),r=i(84030),a=i(14945),l=i(88241),d=i(3661),c=i(19685),u=i(33767),h=i(15661),g=i(24111),p=i(48662),m=i(28853),f=i(14253),v=i(61595),_=i(30256),y=i(81174),I=i(33727),C=i(78426),S=i(10968),b=i(62924);var T=i(94610),E=i(19728),N=i(17298),x=i(29906),w=i(83010),L=i(27603),D=i(37814);const F=(0,N.f)("INudgeStateStore");let A=class{constructor(e,t,i,n,d,c,u,h,g,p,m,f,v){this.localizer=e,this.hostSettings=t,this.hostEmitter=i,this.oaLogger=n,this.proofingDom=d,this.nudgeStore=c,this.tileContent=u,this._queryDetection=h,this.paragraphTextExtractor=g,this._ariaStatusStateStoreFactory=p,this._featureFlagsReader=m,this.inlineSuggestionsRenderer=f,this.predictionStore=v,this._nudgeDisplayTime=void 0,this._nudge=void 0,this._nudgeDisplayLocation=void 0,this._nudgeTargetDocumentRef=void 0,this.enableInlineNudge=!1,this.initialize=async()=>{var e,t;this.hostEmitter.on(o.pD.hostModelDelta,this.handleDelta),this.hostEmitter.on(o.pD.hostModelTextTile,this.handleTextTile),this.enableInlineNudge=!!(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.enableInlineNudge)},this.shutDown=()=>{},this.onNudgeUpdated=async()=>{var e,t,i,n,o,r,a,l,d,c,u,h,g,p,m;const f=this.nudgeStore.getCurrentNudge();if(f){if(this.oaLogger.logActivity("OANudgeReceived",void 0,[(0,s.n)("entityType",f.entityType.toString())],void 0),this.isNudgeDisabledForEntityType(null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge,f.entityType))return void await this.nudgeStore.clearNudge();if((null===(i=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===i?void 0:i.shouldRenderNudge)&&!this.hostSettings.serviceSettings.nudge.shouldRenderNudge(f))return void await this.nudgeStore.clearNudge();if(f.entityResults&&!(null===(o=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===o?void 0:o.entityNudgeClicked))return void await this.nudgeStore.clearNudge();if(f.entityResults&&(null===(l=null===(a=null===(r=this.inlineSuggestionsRenderer)||void 0===r?void 0:r.getCurrentMenuInfo())||void 0===a?void 0:a.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults))return void await this.nudgeStore.clearNudge();if(null===(d=this.predictionStore)||void 0===d?void 0:d.getCurrentPrediction())return void await this.nudgeStore.clearNudge();if(this._nudge&&this._nudge.text===f.text&&this._nudge.tileId===f.tileId&&this._nudge.entityType===f.entityType)return;const v=this.proofingDom.findParagraphNode(f.tileId);if(!(0,y.l)(v))return void await this.nudgeStore.clearNudge();const _=this.paragraphTextExtractor.getTextBetween(v,v,v.element.span-2,v.element.span);if(_&&""!==_){if(" :"===_)return void await this.onNudgeDismiss("space character precedes :");if(_.includes("@"))return void await this.onNudgeDismiss("@ character detected");if(_.includes("/"))return void await this.onNudgeDismiss("/ character detected")}const I=await this.tileContent.getNodeInsertionPosition(v.parent,v.element.offset+f.startIndex,!0);if(!I)return void await this.nudgeStore.clearNudge();if(!await this.isInputPointerAtNudge(f))return void await this.nudgeStore.clearNudge();const C=I.endContainer.parentElement;if(C&&this.containsInvalidNudgeSelector(C,null===(u=null===(c=this.hostSettings.serviceSettings)||void 0===c?void 0:c.nudge)||void 0===u?void 0:u.invalidNudgeSelectors))return void await this.nudgeStore.clearNudge();const S=I.getBoundingClientRect();this.updateNudge(f,null!==(h=null==C?void 0:C.ownerDocument)&&void 0!==h?h:document,S),this.oaLogger.logActivity("OANudgeDisplayed",void 0,[(0,s.n)("entityType",f.entityType.toString())],void 0),null===(m=null===(p=null===(g=this.hostSettings.serviceSettings)||void 0===g?void 0:g.nudge)||void 0===p?void 0:p.onNudgeDisplayed)||void 0===m||m.call(p,f),this.setAriaStatus("ebx_CIQNudgeDisplayed",f.text)}else this.clearNudge()},this.isInputPointerAtNudge=async e=>{var t;const i=await this.tileContent.getTextSelection();return!!i&&(i.startPosition===i.endPosition&&(null===(t=i.startParagraphNode)||void 0===t?void 0:t.id)===e.tileId&&i.endPositionInParagraphNode===e.startIndex)},this.updateNudge=(e,t,i)=>{this._nudge=e,this._nudgeTargetDocumentRef=new r.O(t),this._nudgeDisplayLocation=i,this._nudgeDisplayTime=Date.now()},this.clearNudge=()=>{this._nudge=void 0,this._nudgeTargetDocumentRef=void 0,this._nudgeDisplayLocation=void 0,this._nudgeDisplayTime=void 0},this.handleTextTile=e=>{if(this.nudge&&e.message.messageType===a.G.RemoveData){const t=e.message.data.tileId;this.nudge.tileId!==t&&this.proofingDom.findParagraphNode(this.nudge.tileId)||this.onNudgeDismiss("tile removed")}},this.handleDelta=async e=>{var t;const i=e.message;if(i.sourceType===l.p.TileNode)return;if(!this.nudge)return;const n=await this.tileContent.getTextSelection();if(!this.nudge)return;let o;if((null==n?void 0:n.isCollapsed)&&n.startParagraphNode&&n.startParagraphNode.id===this.nudge.tileId&&n.startPositionInParagraphNode){if(o=await this.tileContent.getNodeInsertionPosition(n.startParentElement,n.startParagraphNode.element.offset+n.startPositionInParagraphNode,!0),!o)return this.oaLogger.logDiagnostics("Nudge text update: could not determine range for nudge insertion"),void await this.onNudgeDismiss("could not determine position");if(i.delta.deltaType===T.WI.Add&&(null===(t=i.delta.content)||void 0===t?void 0:t.includes(":"))&&" "===this.paragraphTextExtractor.getTextBetween(n.startParagraphNode,n.startParagraphNode,i.delta.position-1,i.delta.position))return void await this.onNudgeDismiss(": was proceeded with a space");const e=o.getBoundingClientRect();(0,E.runInAction)((()=>{this._nudgeDisplayLocation&&(this._nudgeDisplayLocation=e)}))}else(null==n?void 0:n.startParagraphNode)&&n.startPositionInParagraphNode?(n.isCollapsed||await this.onNudgeDismiss("Text range was selected"),0===n.startPositionInParagraphNode?await this.onNudgeDismiss("A new sentence was started"):await this.onNudgeDismiss("Text selection moved to another sentence")):await this.onNudgeDismiss("Unable to determine text selection")},(0,D.Gn)(this),this.nudgeStore.setOnUpdatedNudge(this.onNudgeUpdated)}get nudge(){return this._nudge}get nudgeDisplayLocation(){return this._nudgeDisplayLocation}get nudgeTargetDocumentRef(){return this._nudgeTargetDocumentRef}get insertionCharacter(){var e,t,i;return null!==(i=null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.insertionCharacter)&&void 0!==i?i:"@"}async onNudgeDismiss(e,t){var i,n,o;const r=this.nudgeStore.getCurrentNudge();if(!r)return;const a=this.proofingDom.findParagraphNode(r.tileId);if(!(0,y.l)(a))return void await this.nudgeStore.clearNudge();let l="";if(t){const e=this.paragraphTextExtractor.getTextBetween(a,a,a.element.span-2,a.element.span);l=": "===e?'user pasted text after ": "':(null==e?void 0:e.includes(":"))?'user pasted text after ":"':"user pasted text"}const d=Date.now()-this._nudgeDisplayTime;this.oaLogger.logActivity("OANudgeDismissed",void 0,[(0,s.n)("entityType",r.entityType.toString()),(0,s.n)("dismissTrigger",t?l:e),(0,s.n)("persistTime",d)],void 0),await this.nudgeStore.clearNudge(),null===(o=null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===n?void 0:n.onNudgeDismissed)||void 0===o||o.call(n,r,d,t?l:e)}async onNudgeAccepted(e,t){var i,n,r,l,c,u,h,g,p,m;const f=this.nudgeStore.getCurrentNudge();if(!f)return void this.oaLogger.logDiagnostics("Nudge click: could not find nudge in store");const v=Date.now()-this._nudgeDisplayTime;if(this.oaLogger.logActivity("OANudgeClicked",void 0,[(0,s.n)("entityType",f.entityType.toString()),(0,s.n)("persistTime",v),(0,s.n)("userAction",e)],void 0),null===(r=null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===n?void 0:n.onNudgeAccepted)||void 0===r||r.call(n,f,v,e,t),await this.nudgeStore.clearNudge(),t)if(null===(l=this.hostSettings.oaSettings)||void 0===l?void 0:l.isContextualCardEnabled){const e=this.proofingDom.findParagraphNode(f.tileId);if(!(0,y.l)(e))return void this.oaLogger.logDiagnostics("Nudge click: could not find paragraph node");const i=await this.tileContent.getTextSelection();let n;i||this.oaLogger.logDiagnostics("Nudge click: could not determine text selection");let s=0,r=!1;if((null==i?void 0:i.isCollapsed)&&i.startParagraphNode&&i.startParagraphNode.id===e.id&&i.startPositionInParagraphNode){const t=this.paragraphTextExtractor.getParagraphText(i.startParagraphNode);t&&!d.Yv(t.charCodeAt(i.startPositionInParagraphNode-1))&&(r=!0),s=e.element.offset+i.startPositionInParagraphNode,n=await this.tileContent.getNodeInsertionPosition(i.startParentElement,s,!0)}if(n||(s=e.element.offset+f.startIndex,n=await this.tileContent.getNodeInsertionPosition(e.parent,s,!0)),!n)return void this.oaLogger.logDiagnostics("Nudge click: could not determine range for nudge insertion");if(this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:f,fromUserAction:t},messageType:a.G.NewData},address:void 0}),f.entityResults){if(!(null===(u=null===(c=this.hostSettings.serviceSettings)||void 0===c?void 0:c.nudge)||void 0===u?void 0:u.entityNudgeClicked))return void this.oaLogger.logDiagnostics("Nudge click: entity nudge was clicked, but no callback was provided");if(f.entityResults.entities.length>1&&this.inlineSuggestionsRenderer){const t=[],i=f.entityResults.entities;t.push({entities:i,intent:f.entityResults.intent,entityType:f.entityResults.entityType});const n=s-e.element.offset,o=t=>{this.hostSettings.serviceSettings.nudge.entityNudgeClicked(t,e.parent.element,e.id,n)};await this.inlineSuggestionsRenderer.showExistingMenu(e.id,n,0,null!==(h=this.hostSettings.serviceSettings.nudge.insertionCharacter)&&void 0!==h?h:"@",!0,!1,void 0,o,t,{menuType:"InlineSuggestionsResultsFlagMenuType",flag:b.z4.Location,brandingMode:this.hostSettings.brandingMode,actions:this.inlineSuggestionsRenderer.buildInlineSuggestionsResultsMenuActions("flag",!1,!1)})}else this.hostSettings.serviceSettings.nudge.entityNudgeClicked(f.entityResults.entities[0],e.parent.element,e.id,s-e.element.offset)}else this._queryDetection.setNextDeltaProgramaticallyInserted("Nudge"),await this.tileContent.insert(e.parent,void 0,s,(r?" ":"")+(null!==(m=null===(p=null===(g=this.hostSettings.serviceSettings)||void 0===g?void 0:g.nudge)||void 0===p?void 0:p.insertionCharacter)&&void 0!==m?m:"@"),!0,n,!1)}else this.oaLogger.logDiagnostics("Nudge click: ECC was not enabled");else this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:f,fromUserAction:t},messageType:a.G.NewData},address:void 0})}isNudgeDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}containsInvalidNudgeSelector(e,t){var i;let n=!1;if(t)for(const o of t)(e.matches(o)||(null===(i=e.nextElementSibling)||void 0===i?void 0:i.matches(o)))&&(n=!0);return n}setAriaStatus(e,t){var i;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(i=this._ariaStatusStateStoreFactory())||void 0===i||i.setStatus(this.localizer.getMessage(e,t),"assertive",!1))}};(0,n.__decorate)([E.observable],A.prototype,"_nudgeDisplayTime",void 0),(0,n.__decorate)([E.observable],A.prototype,"_nudge",void 0),(0,n.__decorate)([E.computed],A.prototype,"nudge",null),(0,n.__decorate)([E.observable],A.prototype,"_nudgeDisplayLocation",void 0),(0,n.__decorate)([E.computed],A.prototype,"nudgeDisplayLocation",null),(0,n.__decorate)([E.observable],A.prototype,"_nudgeTargetDocumentRef",void 0),(0,n.__decorate)([E.computed],A.prototype,"nudgeTargetDocumentRef",null),(0,n.__decorate)([E.computed],A.prototype,"insertionCharacter",null),(0,n.__decorate)([E.action],A.prototype,"updateNudge",void 0),(0,n.__decorate)([E.action],A.prototype,"clearNudge",void 0),A=(0,n.__decorate)([(0,x._)(),(0,n.__param)(0,(0,w.W)(c.H)),(0,n.__param)(1,(0,w.W)(u.n)),(0,n.__param)(2,(0,w.W)(o.M5)),(0,n.__param)(3,(0,w.W)(h.m)),(0,n.__param)(4,(0,w.W)(I.w)),(0,n.__param)(5,(0,w.W)(v.Y)),(0,n.__param)(6,(0,w.W)(C.d)),(0,n.__param)(7,(0,w.W)(g.J)),(0,n.__param)(8,(0,w.W)(S.b)),(0,n.__param)(9,(0,w.W)(m.Th)),(0,n.__param)(10,(0,w.W)(p.c)),(0,n.__param)(11,(0,L.l)()),(0,n.__param)(11,(0,w.W)(f.V)),(0,n.__param)(12,(0,L.l)()),(0,n.__param)(12,(0,w.W)(_.o))],A)},60120:(e,t,i)=>{i.d(t,{T:()=>m});var n=i(51244),o=i(8520),s=i(94329),r=i(75210),a=i(745),l=i(41642),d=i(95537),c=i(22910),u=i(51921);const h=(0,a.F5)({safeWindow:l.A.on(c.j)}),g=(0,n.PA)((e=>{const{safeWindow:t}=(0,a.KN)(h),{store:i}=e,n=i.anchor,s=o.useRef(!1),r=o.useRef(null),l=o.useRef(null),d=o.useRef({top:0,left:0}),c=o.useRef([]),[g,p]=o.useState({container:{display:"none"},overlay:{display:"none"},anchorStyle:{position:"static"}}),m=(0,u.uE)(n,g.overlay.paddingBottom),f=Object.assign({},g.overlay),v=()=>{const e=(0,u.dB)(n,l.current,d),t=(0,u.Cf)(n);d.current={top:e.top,left:e.left},p((()=>((()=>{const e=n.scrollLeft,t=n.scrollTop;r.current&&(r.current.scrollLeft=e,r.current.scrollTop=t)})(),{container:e,overlay:t.overlay,anchorStyle:t.anchor}))),i.setShadowElement(l.current,r.current)},_=()=>{var e;e=v,t.requestAnimationFrame((()=>{s.current||e()}))},y=()=>new Promise((e=>{_(),c.current.push(e)}));return o.useEffect((()=>(_(),i.setUpdateOverlay(y),()=>{s.current=!0})),[]),o.useEffect((()=>{c.current.forEach((e=>e())),c.current=[]}),[g]),n.isConnected?o.createElement("div",{ref:l,style:g.container},o.createElement("div",{style:f,className:"hc-noadjust"},o.createElement("div",{style:m,ref:r},o.createElement("span",{"aria-hidden":"true"},n.value)))):null})),p=(0,a.F5)({store:l.A.on(d.S)}),m=(0,n.PA)((()=>{const{store:e}=(0,a.KN)(p);return o.createElement(o.Fragment,null,Array.from(e.stores.values()).map((e=>{var t;return s.createPortal(o.createElement("editor-shadow",{style:{overflow:"auto"}},o.createElement(o.Fragment,null,o.createElement("style",null,"\n  @media print {\n    .ms-editor-shadow-container {\n      display:none !important;\n    }\n  }\n  .ms-editor-shadow-container {\n    all: initial;\n  }"),o.createElement(r.Ay.div,{className:"ms-editor-shadow-container"},o.createElement(g,{store:e})))),null!==(t=e.anchor.parentElement)&&void 0!==t?t:window.document.body)})))}))},9928:(e,t,i)=>{i.d(t,{F:()=>a});var n=i(23182),o=i(19728),s=i(29906),r=i(37814);let a=class{constructor(){this.stores=new Map,(0,r.Gn)(this)}setCanvasElement(e,t){this.stores.set(e,new l(t))}getShadowElementStore(e){return this.stores.get(e)}removeShadowElementStore(e){this.stores.delete(e)}};(0,n.__decorate)([o.observable],a.prototype,"stores",void 0),a=(0,n.__decorate)([(0,s._)()],a);class l{constructor(e){this.container=void 0,this.overlay=void 0,this._updateOverlay=()=>new Promise((()=>{})),this.updateOverlay=async()=>{await this._updateOverlay()},this.setUpdateOverlay=e=>{this._updateOverlay=e},this.setShadowElement=(e,t)=>{this.container=e,this.overlay=t},this.anchor=e,(0,r.Gn)(this)}}(0,n.__decorate)([o.observable],l.prototype,"anchor",void 0),(0,n.__decorate)([o.observable],l.prototype,"container",void 0),(0,n.__decorate)([o.observable],l.prototype,"overlay",void 0),(0,n.__decorate)([o.observable],l.prototype,"_updateOverlay",void 0),(0,n.__decorate)([o.action],l.prototype,"setUpdateOverlay",void 0),(0,n.__decorate)([o.action],l.prototype,"setShadowElement",void 0)},27959:(e,t,i)=>{i.d(t,{PF:()=>d,Qr:()=>l});var n,o=i(23182),s=i(29906),r=i(17298),a=i(96292);!function(e){e[e.None=0]="None",e[e.Processed=1]="Processed",e[e.SquiggleInitialized=2]="SquiggleInitialized"}(n||(n={}));let l=class{constructor(){this._processedCritiques=new Map,this._invalidatedItems=new Map,this._keystrokesCount=0,this.items=new Map,this.setItem=(e,t)=>{this.items.set(e,t)},this.process=e=>!(!e||this._processedCritiques.has(e))&&(this._processedCritiques.set(e,{status:n.Processed,progress:0}),!0),this.setInitializationProgress=(e,t)=>{if(!e)return!1;const i=this._processedCritiques.get(e);return!(!i||i.status!==n.Processed&&i.status!==n.SquiggleInitialized)&&(this._processedCritiques.set(e,{status:n.SquiggleInitialized,progress:t}),!0)},this.getSquiggleInitializationProgress=e=>{if(!e)return 0;const t=this._processedCritiques.get(e);return(null==t?void 0:t.status)===n.SquiggleInitialized?t.progress:0},this.forEachCritiqueForItems=(e,t)=>{for(const i of e){const e=this.items.get(i);if(!e)return;for(const n of e){const o=n[0];t({squiggles:n[1],key:o,elementCritiques:e,elementId:i})}}},this.removeForCritique=(e,t,i=!1)=>{const n=this.items.get(e);if(!n)return;const o=n.get(t);return o?(i&&this._invalidatedItems.set(t,{squiggles:o,keystrokes:this._keystrokesCount}),n.delete(t),o):void 0},this.isEmpty=e=>void 0===this.items.get(e)&&0===this._invalidatedItems.size,this.checkInvalidatedAutoCorrections=e=>{if(0===this._invalidatedItems.size)return void(this._keystrokesCount=0);if(this._keystrokesCount+=1,!e)return;const t=[];for(const i of this._invalidatedItems.entries()){const n=i[1];this._keystrokesCount-n.keystrokes>a.tB&&t.push(i[0]),e(n.squiggles)&&t.push(i[0])}for(const e of t)this._invalidatedItems.delete(e)}}};l=(0,o.__decorate)([(0,s._)()],l);(0,r.f)("IContentEditableAutoCorrectionCache");const d=(0,r.f)("IFormElementAutoCorrectionCache")},48858:(e,t,i)=>{i.d(t,{QE:()=>f});var n=i(23182),o=i(8520),s=i(29299),r=i(41771),a=i(39836),l=i(252),d=i(32760),c=i(96292),u=i(29906),h=i(72113);const g=function(e){return t=>{var i;const n=a.Bn.AutoCorrectSquiggle,s=t.squiggleRef||o.useRef(null),r=t.element.ownerDocument.defaultView||window,l=o.useRef(0),d=o.useRef(1-t.initializationProgress),u=o.useCallback((()=>t.isCaretOver||t.isMouseOver||t.isCalloutOpened),[t.isCaretOver,t.isMouseOver,t.isCalloutOpened]),h=o.useCallback((()=>u()||d.current>0?"ms-squiggle ms-squiggle-autocorrect-hl ":"ms-squiggle ms-squiggle-autocorrect"),[d,u]),g=h(),p=d.current>0?{opacity:d.current}:{},[m,f]=o.useState(g),[v,_]=o.useState(p);o.useEffect((()=>{f(h())}),[t.isHighlighted,t.isCaretOver,t.isMouseOver,t.isCalloutOpened,f]);const y=t.useSvgUnderline?a.fQ[n]:0,I=e=>{var i;t.onCallOut(s.current,t.critique,null!==(i=t.critique.textInContext)&&void 0!==i?i:"","keyboard"===e,(()=>{}),t.element,t.squiggleKind,(0,c.eO)(t.data),y)},C=o.useCallback((()=>t.closeCallout(t.critique.traceId)),[t,t.critique.traceId]),S=t.openCalloutOnHover?void 0:()=>I("mouse");o.useEffect((()=>{t.openCalloutOnHover?t.isMouseOver?I("mouse"):t.isCalloutOpened||t.closeCallout(t.critique.traceId):t.isMouseOver&&(d.current=0,T(),_({}),f(h()))}),[t.isMouseOver,t.isCalloutOpened,d,_]);const b=t.isCaretOver&&!t.isCalloutOpened;o.useEffect((()=>{b?t.showTooltip(t.squiggleKind,s.current,t.critique,"keyboard"):t.closeTooltip(t.critique.traceId)}),[s,b]);const T=o.useCallback((()=>{0!==l.current&&(_({}),f(h()),r.clearInterval(l.current),l.current=0)}),[l,f,_]),E=o.useCallback((()=>{if(d.current<.01)d.current=0,T();else{d.current-=.02;const e=u();_({opacity:e?1:d.current}),f(h())}t.critique.traceId&&t.setInitializationProgress(t.critique.traceId,1-d.current)}),[d,T,_,h,f,u]),N=o.useCallback((()=>{d.current>0&&(T(),l.current=r.setInterval(E,100))}),[l]);return o.useEffect((()=>(N(),()=>{T(),t.closeCallout(t.critique.traceId),t.closeTooltip(t.critique.traceId)})),[N,T]),(null===(i=t.autoCorrectionBroker)||void 0===i?void 0:i.getAutoCorrectionIsBeingApplied(t.critique))?null:e(Object.assign(Object.assign({},t),{patternName:n,className:m,calloutOpened:t.isCalloutOpened,squiggleRef:s,styleOverrides:v,openCalloutPredicate:e=>!e.shiftKey&&!e.altKey&&"Control"===e.key,onClick:S,onNonLeftClick:C,onKeyboardEvent:()=>I("keyboard"),onEscapePress:()=>t.closeTooltip(t.critique.traceId)}))}},p=o.memo(g(r.m),d.I),m=o.memo(g(l.G),d.P);let f=class{constructor(e,t,i){this.hostSettings=e,this.featureFlagsReader=t,this.autoCorrectionBroker=i}getSquiggles(e,t,i,n){if((0,h.v4)(this.featureFlagsReader))return o.createElement(o.Fragment,null,t.map(((e,t)=>o.createElement(s.X,{key:t.toString(),autoCorrectProps:e,theme:i,isHighContrastMode:n,hostSettings:this.hostSettings}))));{const r=((0,h.l9)(this.featureFlagsReader)||(0,h.YY)(this.featureFlagsReader))&&o.createElement(s.u,{squigglerId:e,squigglesProps:t,theme:i,isHighContrastMode:n,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!0,ariaStatusUpdatesOnlyForSpellingGrammar:(0,h.YY)(this.featureFlagsReader)});return o.createElement(o.Fragment,null,r,t.map(((e,t)=>o.createElement(p,Object.assign({key:t.toString()},e,{useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey,autoCorrectionBroker:this.autoCorrectionBroker})))))}}getFormInputSquiggle(e,t,i,n){return o.createElement(m,Object.assign({key:e},t,{initializationProgress:i,setInitializationProgress:n}))}};f=(0,n.__decorate)([(0,u._)()],f)},53124:(e,t,i)=>{i.d(t,{n:()=>L});var n=i(23182),o=i(63318),s=i(3661),r=i(70848),a=i(71632),l=i(99724),d=i(22910),c=i(37053),u=i(63285),h=i(58550),g=i(44698),p=i(42007),m=i(49845),f=i(67409),v=i(81174),_=i(78426),y=i(33727),I=i(71975),C=i(21203),S=i(27959),b=i(96292),T=i(72113),E=i(29906),N=i(66008),x=i(83010),w=i(27603);let L=class{constructor(e,t,i,n,d,c,u,g,p,m,_,y,I){this._hostEmitters=e,this.tileContent=t,this.critiqueRangeBuilder=i,this.proofingDom=n,this.safeWindow=d,this._disableCritiqueHandler=c,this.logger=u,this.critiqueStore=g,this.applyCritiqueSuggestionHandler=p,this.applyFlagHandler=m,this.wordDictionary=_,this.editorSettingsManager=y,this._formElementAutoCorrectionCache=I,this.applyCritiqueSuggestion=async(e,t,i,n,r,a,l,d)=>{var c;await this.applySuggestion(e,t,{nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},(async()=>{var i,l,d,c;(null===(i=n.textInContext)||void 0===i?void 0:i.includes(""))&&(n.start+=(n.textInContext.match(new RegExp("^+"))||[""])[0].length,n.length-=(n.textInContext.match(//g)||[]).length,n.textInContext=n.textInContext.replace(//g,""),r.text=r.text.replace(//g,""));let u=!1;if(this.applyCritiqueSuggestionHandler&&this.critiqueRangeBuilder){const i=a||(null===(l=(await this.critiqueRangeBuilder.getCritiqueRanges([n],t))[0])||void 0===l?void 0:l.range);u=!!i&&!!this.applyCritiqueSuggestionHandler.onApplyCritiqueSuggestion(e,n,r,i)}const h=n.nodeId?this.proofingDom.findNode(n.nodeId):n.tileId?this.proofingDom.findNode(n.tileId.nodeId):null;if(h){if(!u){if(!(0,f.qB)(r)&&(0,f.ht)(n))this.tileContent.remove(h,t,n.start,n.length,!0,a);else{let{start:e,length:i}=n,l=r.text;if(n.textInContext&&n.typeId===o.L9.DoubleSpaceGrammar){const t=s.CC(n.textInContext,l),o=l.length-t.firstDiffRight;t.firstDiffLeft===o&&(e+=t.firstDiffLeft,i=1,l="")}this.tileContent.replace(h,t,e,i,l,a)}(0,f.MG)(n)&&(null===(c=this.wordDictionary)||void 0===c||c.addWordToIgnoreList(r.text))}}else null===(d=this.logger)||void 0===d||d.error(508146699,"Unable to find node while applying critique suggestion")})),!d||l!==b.Ah.autocorrection&&l!==b.Ah.personalizedAutocorrection||null===(c=this._formElementAutoCorrectionCache)||void 0===c||c.removeForCritique(d,n.traceId||"")},this.applyFlagSuggestion=(e,t,i,n,o,s)=>this.applySuggestion(e,t,{nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},(async()=>{var i,r,a;const l=s||!this.critiqueRangeBuilder?s:null===(i=(await this.critiqueRangeBuilder.getCritiqueRanges([n],t))[0])||void 0===i?void 0:i.range;l?this.applyFlagHandler?this.applyFlagHandler.onApplyFlag(e,n,o,l):null===(a=this.logger)||void 0===a||a.error(523633800,"Flag application failed due to no applyFlagHandler"):null===(r=this.logger)||void 0===r||r.error(523633799,"Unable to determine range for flag application")})),this.ignoreCritiqueOnce=(e,t,i,n)=>{var s;!!(null===(s=this.applyCritiqueSuggestionHandler)||void 0===s?void 0:s.onIgnoreCritiqueSuggestion(e,n))||this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},o.$w.IgnoreOnce)},this.ignoreFlagOnce=(e,t,i,n)=>{var s;!!(null===(s=this.applyFlagHandler)||void 0===s?void 0:s.onIgnoreFlag(e,n))||this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},o.$w.IgnoreOnce)},this.ignoreAllOfFlag=(e,t,i)=>{var n,s;const r=this.proofingDom.findParagraphNode(i.nodeId);if(!(0,v.l)(r))return void(null===(n=this.logger)||void 0===n||n.error(507574144,"Unable to find paragraph node while ignoring all flags"));!!(null===(s=this.applyFlagHandler)||void 0===s?void 0:s.onIgnoreAllOfFlag(e,i))||this.callbackOnProofedElement({nodeId:i.nodeId,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},o.$w.IgnoreAll)},this.ignoreAllOfCritique=(e,t,i,n)=>{var o,s,a,l;if(!i)return;let d;d=(0,f.MG)(n)?n.suggestions[0].text:n.textInContext,d&&(null===(o=this.wordDictionary)||void 0===o||o.addWordToIgnoreList(d));const c=this.proofingDom.findParagraphNode(null!==(s=n.nodeId)&&void 0!==s?s:i);(0,v.l)(c)&&(null===(a=this.critiqueStore)||void 0===a||a.updateNode([{critique:(0,r._K)(n),critiqueDiffType:h.K.Delete}],c.parent.id,null!==(l=c.eventSeqId)&&void 0!==l?l:0))},this.disableCritiqueType=async(e,t,i,n)=>{var s,r;i&&(n.typeId&&await(null===(s=this.editorSettingsManager)||void 0===s?void 0:s.stopCheckingForCritiqueType(n.typeId)),this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},o.$w.DisableCritiqueType),await(null===(r=this._disableCritiqueHandler)||void 0===r?void 0:r.disableCritique(n)))},this.disableFlagType=(e,t,i,n)=>{var s;!!(null===(s=this.applyFlagHandler)||void 0===s?void 0:s.onDisableFlag(e,n))||this.callbackOnProofedElement({nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},o.$w.DisableCritiqueType)},this.applySuggestion=async(e,t,i,n)=>{var s,r,l,d;const c=null!==(s=this.tileContent.getContainingElement(e))&&void 0!==s?s:t;if(!c)return void(null===(r=this.logger)||void 0===r||r.error(508146698,"Unable to find containing element"));const u=(0,T.mH)(c),h=null!==(l=null==u?void 0:u.scrollTop)&&void 0!==l?l:0,g=null!==(d=null==u?void 0:u.scrollLeft)&&void 0!==d?d:0;await n(),this.callbackOnProofedElement(i,o.$w.ApplySuggestion);const p=(0,a.e)(c);this.safeWindow.requestAnimationFrame((()=>{u&&(u.scrollTop=h,u.scrollLeft=g)}),p)},this.callbackOnProofedElement=(e,t)=>{if(e.nodeId)for(const i of this._hostEmitters)i.emit(l.pD.hostModelCritiqueAction,{address:void 0,message:{critiqueInfo:e,actionType:t}})}}};L=(0,n.__decorate)([(0,E._)(),(0,n.__param)(0,(0,N.t)(l.zJ)),(0,n.__param)(1,(0,x.W)(_.d)),(0,n.__param)(2,(0,x.W)(g.s)),(0,n.__param)(2,(0,w.l)()),(0,n.__param)(3,(0,x.W)(y.w)),(0,n.__param)(4,(0,x.W)(d.j)),(0,n.__param)(5,(0,w.l)()),(0,n.__param)(5,(0,x.W)(I.W)),(0,n.__param)(6,(0,x.W)(c.g)),(0,n.__param)(6,(0,w.l)()),(0,n.__param)(7,(0,x.W)(h.$)),(0,n.__param)(7,(0,w.l)()),(0,n.__param)(8,(0,x.W)(p.a)),(0,n.__param)(8,(0,w.l)()),(0,n.__param)(9,(0,x.W)(m.K)),(0,n.__param)(9,(0,w.l)()),(0,n.__param)(10,(0,x.W)(C.s)),(0,n.__param)(10,(0,w.l)()),(0,n.__param)(11,(0,x.W)(u.rI)),(0,n.__param)(11,(0,w.l)()),(0,n.__param)(12,(0,w.l)()),(0,n.__param)(12,(0,x.W)(S.PF))],L)},9865:(e,t,i)=>{i.d(t,{FY:()=>y,hJ:()=>v});var n=i(23182),o=i(8520),s=i(29299),r=i(63318),a=i(41771),l=i(10358),d=i(96292),c=i(39836),u=i(252),h=i(32760),g=i(29906),p=i(72113);const m=function(e){return t=>{var i;const[n,s]=o.useState(!1),a=null!==(i=t.squiggleRef)&&void 0!==i?i:o.useRef(null),l=(0,c.H7)(t.critique,!!t.isAutoCorrectionEnabled),u=()=>{s(!1)},h=e=>{var i;s(!0);const n=t.useSvgUnderline?c.fQ[l]:0;t.onCallOut(a.current,t.critique,null!==(i=t.critique.textInContext)&&void 0!==i?i:"","keyboard"===e,u,t.element,d.Ah.critique,(0,d.eO)(t.data),n)},g=o.useCallback((()=>t.closeCallout(t.critique.traceId)),[t,t.critique.traceId]),m=t.critique.typeId?"ms-squiggle-"+function(e,t){const i=Object.keys(e).filter((i=>e[i]===t));return i.length>0?i[0]:null}(r.L9,t.critique.typeId):void 0,f=`ms-squiggle ms-squiggle-${t.critique.priority} ${m} ${n||t.isHighlighted?"hl":""} ${t.stealth?"stealth":""}`,v=t.isMouseOver?"mouse":t.isCaretOver?"keyboard":void 0,_=v&&!n;return o.useEffect((()=>{_?t.showTooltip(t.squiggleKind,a.current,t.critique,v):t.closeTooltip(t.critique.traceId)}),[a.current,t.critique,_]),o.useEffect((()=>()=>{t.closeTooltip(t.critique.traceId)}),[]),e(Object.assign(Object.assign({},t),{patternName:l,className:f,calloutOpened:n,squiggleRef:a,openCalloutPredicate:e=>(0,p.iN)()||t.useAltHotkey?!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key:!e.shiftKey&&!e.ctrlKey&&e.altKey&&"ArrowDown"===e.key,onKeyboardEvent:()=>h("keyboard"),onClick:()=>h("mouse"),onNonLeftClick:g,onEscapePress:()=>t.closeTooltip(t.critique.traceId)}))}};const f=o.memo(m(a.m),h.I),v=o.memo(m(l.z),h.I),_=o.memo(m(u.G),h.P);let y=class{constructor(e,t){this.hostSettings=e,this.featureFlagsReader=t}getSquiggles(e,t,i,n){if((0,p.v4)(this.featureFlagsReader))return o.createElement(s.u,{squigglerId:e,squigglesProps:t,theme:i,isHighContrastMode:n,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!1,ariaStatusUpdatesOnlyForSpellingGrammar:!1});{const r=((0,p.l9)(this.featureFlagsReader)||(0,p.YY)(this.featureFlagsReader))&&o.createElement(s.u,{squigglerId:e,squigglesProps:t,theme:i,isHighContrastMode:n,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!0,ariaStatusUpdatesOnlyForSpellingGrammar:(0,p.YY)(this.featureFlagsReader)});return o.createElement(o.Fragment,null,r,t.map(((e,t)=>o.createElement(f,Object.assign({key:t.toString()},e,{isAutoCorrectionEnabled:this.hostSettings.enableAutoCorrect,squiggleKind:d.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,i,n){return o.createElement(_,Object.assign({key:e},t,{squiggleKind:d.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey}))}};y=(0,n.__decorate)([(0,g._)()],y)},73893:(e,t,i)=>{i.d(t,{i:()=>n});const n=(0,i(17298).f)("ICritiqueApplicationHandler")},96292:(e,t,i)=>{i.d(t,{Ah:()=>o,eO:()=>s,kI:()=>r,tB:()=>n});const n=15;var o;function s(e){return function(e){return void 0!==e.range}(e)?e.range:void 0}function r(e){return e===o.autocorrection||e===o.personalizedAutocorrection}!function(e){e.autocorrection="autocorrection",e.critique="critique",e.personalizedAutocorrection="personalized-autocorrection"}(o||(o={}))},96285:(e,t,i)=>{i.d(t,{C:()=>o,Q:()=>s});var n=i(17298);const o=(0,n.f)("ISquigglerCanvasRenderingState"),s=(0,n.f)("ISquigglerCanvasRenderingStateFactory")},60773:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(17298).f)("ISquigglerUXFactory")},97050:(e,t,i)=>{i.d(t,{B:()=>d});var n=i(23182),o=i(29906),s=i(83010),r=i(22400),a=i(18349),l=i(96285);let d=class{constructor(e,t){this.proofingEventListener=e,this.container=t,this.messages=[],this.uxInitialized=!1,this.onCritiqueForUiEvent=e=>{if(this.uxInitialized){this.container.get(l.C).onCritiqueForUiEvent(e)}else this.messages.push(e)},this.onSquiggleUXReadyEvent=async e=>{const t=this.container.get(l.C);let i;for(;i=this.messages.shift();)await t.onCritiqueForUiEvent(i);this.uxInitialized=!0}}async initialize(){this.proofingEventListener.on("squiggleUXReadyEvent",this.onSquiggleUXReadyEvent),this.proofingEventListener.on("squiggleDataEvent",this.onCritiqueForUiEvent)}shutDown(){}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(a.o)),(0,n.__param)(1,(0,s.W)(r.p))],d)},32760:(e,t,i)=>{if(i.d(t,{I:()=>o,P:()=>s}),2063!=i.j)var n=i(53268);function o(e,t){const i=e.stealth===t.stealth,o=e.isHighlighted===t.isHighlighted,s=e.isCaretOver===t.isCaretOver,r=e.isMouseOver===t.isMouseOver,a=(0,n.a)(e.data.clientRect,t.data.clientRect);return s&&r&&a&&o&&i}function s(e,t){const i=e.isHighlighted===t.isHighlighted,n=e.isCaretOver===t.isCaretOver,o=e.isMouseOver===t.isMouseOver,s=e.data.start===t.data.start,r=e.data.end===t.data.end,a=e.data.text===t.data.text,l=e.data.overlayCss.height===t.data.overlayCss.height,d=e.data.overlayCss.width===t.data.overlayCss.width;return n&&r&&l&&d&&o&&s&&a&&i}},72113:(e,t,i)=>{function n(e){return e.flags.enableCSSHighlightApiSquiggleRendering&&"highlights"in CSS}function o(e){return e.flags.enableCssHighlightApiAnnouncementsOnly&&"highlights"in CSS}function s(e){return e.flags.enableCssHighlightApiAnnouncementsOnlyForSpellingAndGrammar&&"highlights"in CSS}function r(e){return null===e?null:e.scrollHeight>e.clientHeight?e:r(e.parentNode)}function a(){return/Macintosh|Mac OS X/i.test(navigator.userAgent)}i.d(t,{YY:()=>s,iN:()=>a,l9:()=>o,mH:()=>r,v4:()=>n})},29299:(e,t,i)=>{if(i.d(t,{X:()=>u,u:()=>h}),2063!=i.j)var n=i(9865);var o=i(745),s=i(41642);if(2063!=i.j)var r=i(96292);if(2063!=i.j)var a=i(39836);var l=i(25622),d=i(8520);const c=(0,o.F5)({targetWindow:s.A.on(l.sh)}),u=e=>{const{targetWindow:t}=(0,o.KN)(c),{autoCorrectProps:i}=e,{critique:n,initializationProgress:s}=i,r=d.useRef(0),[a,l]=d.useState(1-s);return d.useEffect((()=>{const e=()=>{var e;0!==r.current&&(null===(e=t.deref())||void 0===e||e.clearInterval(r.current),r.current=0)},o=()=>{l((t=>t<.01?(e(),0):t-.02)),n.traceId&&i.setInitializationProgress(n.traceId,1-a)};return(()=>{if(a>0){e();const i=t.deref();i&&(r.current=i.setInterval(o,100))}})(),()=>{e()}}),[i,n.traceId,a,t]),d.createElement(h,Object.assign({},e,{squigglerId:i.id,squigglesProps:[i],opacity:a,isAutoCorrection:!0,ariaStatusUpdatesOnly:!1,ariaStatusUpdatesOnlyForSpellingGrammar:!1}))},h=e=>{var t;const{squigglerId:i,squigglesProps:o,theme:s,isHighContrastMode:l,opacity:c,hostSettings:u,isAutoCorrection:h,ariaStatusUpdatesOnly:m,ariaStatusUpdatesOnlyForSpellingGrammar:f}=e,v=CSS.highlights;if(!v)return null;for(const e in a.Bn){const t=a.Bn[e];h===(t===a.Bn.AutoCorrectSquiggle)&&(v.delete(g(t,i,!1)),v.delete(g(t,i,!0)))}const _=new Map,y=[];for(const e of o){const n=(0,a.H7)(e.critique,!!u.enableAutoCorrect),o=g(n,i,!1),s=g(n,i,e.isHighlighted),l=null!==(t=_.get(s))&&void 0!==t?t:new Highlight;switch(n){case"SpellingSquiggle":if(f&&(e.squiggleKind===r.Ah.autocorrection||e.squiggleKind===r.Ah.personalizedAutocorrection))continue;l.type="spelling-error";break;case"GrammarSquiggle":l.type="grammar-error";break;default:if(f)continue;l.type="highlight"}l.add(e.data.range),_.set(s,l),y.push([o,n,c])}for(const[e,t]of _)v.set(e,t);return m?d.createElement(d.Fragment,null):d.createElement(d.Fragment,null,o.map(((e,t)=>d.createElement(n.hJ,Object.assign({key:t.toString()},e,{squiggleKind:r.Ah.critique,useAltHotkey:!!u.useAlternativeSquiggleHotkey})))),d.createElement("style",null,"@media not print {\n        ",y.map((e=>{const[t,i,n]=e,o=e=>l?"highlight":e;let r="",d="";switch(i){case a.Bn.SpellingSquiggle:r=`text-decoration: ${o(s.highPriorityColors.tile)} wavy underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 1px;\n                   text-underline-offset: 0px;`,d=`background-color: ${o(s.highPriorityColors.highlight)};`;break;case a.Bn.GrammarSquiggle:r=`text-decoration: ${o(s.mediumPriorityColors.tile)} double underline;\n                   text-decoration-skip-ink: none;\n                   text-underline-offset: 0.5px;`,d=`background-color: ${o(s.mediumPriorityColors.highlight)};`;break;case a.Bn.AdvancedSquiggle:r=`text-decoration: ${o(s.lowPriorityColors.tile)} dashed underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 2px;`,d=`background-color: ${o(s.lowPriorityColors.highlight)};`;break;case a.Bn.CIQFlagSquiggle:r=`text-decoration: ${o(s.ciqFlagColors.tile)} dotted underline;\n                   text-decoration-skip-ink: none;\n                   text-underline-offset: 1px;\n                   text-decoration-thickness: 3px;`,d=`background-color: ${o(s.ciqFlagColors.highlight)};`;break;case a.Bn.HeadingDetectionSquiggle:r=`text-decoration: ${o(s.headingDetectionColors.tile)} dashed underline;\n                   text-decoration-skip-ink: none;\n                   text-decoration-thickness: 2px;`,d=`background-color: ${o(s.headingDetectionColors.highlight)};`;break;case a.Bn.AutoCorrectSquiggle:r=`text-decoration: ${o(p(s.autoCorrectColors.tile,n))} solid underline;\n                    background-color: ${o(p(s.autoCorrectColors.highlight,n))};\n                    text-decoration-skip-ink: none;\n                    text-underline-offset: 1px;\n                    text-decoration-thickness: 1px;`,d=`text-decoration: ${o(s.autoCorrectColors.tile)} solid underline;\n                background-color: ${o(s.autoCorrectColors.highlight)};`}return`\n            ::highlight(${t}) {\n              ${r}\n            }\n            ::highlight(${t}-hl) {\n              ${r}\n              ${d}\n            }\n            `})),"}"))};function g(e,t,i){return e+"-"+t+(i?"-hl":"")}const p=(e,t)=>{const i=Math.max(0,Math.min(1,t));if(7===e.length){return e+Math.floor(255*i).toString(16).padStart(2,"0")}{const t=parseInt(e.slice(-2),16)/255,n=Math.floor(i*t*255).toString(16).padStart(2,"0");return e.slice(0,-2)+n}}},4635:(e,t,i)=>{if(i.d(t,{G:()=>o}),2063!=i.j)var n=i(70848);class o{constructor(e,t,i,n){this.calloutStateStore=e,this.inlineSuggestionsRenderer=t,this.undoCalloutStateStore=i,this.logger=n}async showFlagCritique(e){var t,i,o,s,r,a;if(!(0,n.r3)(e.critique))return void(null===(t=this.logger)||void 0===t||t.error(0,"Got a critique that is not a flag critique, but expected a flag critique"));if(!e.onApplyFlag)return void(null===(i=this.logger)||void 0===i||i.error(508909201,"Got flag callout display, but no function for onApplyFlag was specified"));if(!this.inlineSuggestionsRenderer)return void(null===(o=this.logger)||void 0===o||o.error(508909200,"Got flag callout display, but no inlineSuggestionRenderer"));await this.inlineSuggestionsRenderer.showFlag(e.critique,e.onApplyFlag,((e,t)=>{var i,n,o;t?null===(i=this.calloutStateStore)||void 0===i||i.hide():null===(n=this.calloutStateStore)||void 0===n||n.clickNoActionHide(e),null===(o=this.undoCalloutStateStore)||void 0===o||o.hide()}),e.onFlagIgnoreOnce,e.onFlagIgnoreAll,e.onDisableFlag,e.onShowFeedback,null===(s=this.calloutStateStore)||void 0===s?void 0:s.navInfo,null===(r=this.calloutStateStore)||void 0===r?void 0:r.navigate),null===(a=this.calloutStateStore)||void 0===a||a.markAsShown(e.critique,e.onDismiss)}}},41771:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(8520);if(2063!=i.j)var o=i(10358);if(2063!=i.j)var s=i(68559);const r=e=>{const{top:t,left:i,width:r,height:a}=e.data.clientRect,l=e.isVisible?void 0:"none";return n.createElement(n.Fragment,null,n.createElement(o.z,{anchor:e.anchor,calloutOpened:e.calloutOpened,disableCalloutOnDoubleClick:e.disableCalloutOnDoubleClick,element:e.element,isCaretOver:e.isCaretOver,isMouseOver:e.isMouseOver,onClick:e.onClick,onEscapePress:e.onEscapePress,onKeyboardEvent:e.onKeyboardEvent,onNonLeftClick:e.onNonLeftClick,openCalloutPredicate:e.openCalloutPredicate}),n.createElement("span",{role:e.role,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,ref:e.squiggleRef,className:e.className,style:Object.assign({top:t,left:i,width:r,height:a,zIndex:e.data.zIndex,display:l},e.styleOverrides)}),e.useSvgUnderline&&n.createElement(s.a,{width:r,left:i,squiggleHeight:t+a,patternName:e.patternName,className:e.className,styleOverrides:Object.assign({display:l},e.styleOverrides)}))}},10358:(e,t,i)=>{i.d(t,{z:()=>r});var n=i(8520);if(2063!=i.j)var o=i(98647);if(2063!=i.j)var s=i(93550);const r=e=>{const{anchor:t,calloutOpened:i,disableCalloutOnDoubleClick:r,element:a,isCaretOver:l,isMouseOver:d,onClick:c,onEscapePress:u,onKeyboardEvent:h,onNonLeftClick:g,openCalloutPredicate:p}=e,m=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),f=n.useRef(null);return n.useEffect((()=>{const e=e=>{if(d&&!i){const e=(a.ownerDocument.defaultView||window).getSelection();e&&e.focusNode===e.anchorNode&&e.focusOffset===e.anchorOffset&&(null==c||c())}},n=e=>{i&&0!==e.button&&(null==g||g())};if(r){const i=a.ownerDocument.defaultView||window,s=t=>{const n=t;0===n.button?1===n.detail&&(f.current=i.setTimeout(e,200)):null==g||g()},r=()=>{f.current&&(i.clearTimeout(f.current),f.current=null)},l=e=>r(),d=new o.J(t);return d.addListener("click",s),d.addListener("dblclick",l),d.addListener("mouseup",n),()=>{d.removeAllListeners(),r()}}{const i=new o.J(t);return i.addListener("click",e),i.addListener("mouseup",n),()=>{i.removeAllListeners()}}}),[t,r,a,g,d,i,c]),n.useEffect((()=>{if(l||d||i){const e=(0,s.a2)(t),n=new o.J(e),r=e=>{const t=e;l&&(null==p?void 0:p(t))&&!i?"keyup"===t.type?null==h||h():m(e):"Escape"===t.key&&"keyup"===t.type&&(null==u||u())};return n.addListener("keyup",r),i||(n.addListener("focus",m),n.addListener("blur",m),n.addListener("keydown",r)),()=>{n.removeAllListeners()}}}),[d,l,i,t,p,h,u]),null}},39836:(e,t,i)=>{i.d(t,{Bn:()=>r,H7:()=>a,K3:()=>d,VA:()=>c,fQ:()=>l});var n=i(8520);if(2063!=i.j)var o=i(63318);if(2063!=i.j)var s=i(67409);const r={SpellingSquiggle:"SpellingSquiggle",GrammarSquiggle:"GrammarSquiggle",AdvancedSquiggle:"AdvancedSquiggle",CIQFlagSquiggle:"CIQFlagSquiggle",HeadingDetectionSquiggle:"HeadingDetectionSquiggle",AutoCorrectSquiggle:"AutoCorrectSquiggle",UnknownSquiggle:"UnknownSquiggle"};function a(e,t){switch(e.priority){case o.bx.High:return(0,s.MG)(e)&&t?"AutoCorrectSquiggle":"SpellingSquiggle";case o.bx.Medium:return"GrammarSquiggle";case o.bx.Low:return"AdvancedSquiggle";case o.bx.Informational:return e.typeId===o.L9.HeadingDetection?"HeadingDetectionSquiggle":"CIQFlagSquiggle";default:return"UnknownSquiggle"}}const l={SpellingSquiggle:4,GrammarSquiggle:3,AdvancedSquiggle:2,CIQFlagSquiggle:3,HeadingDetectionSquiggle:2,AutoCorrectSquiggle:1,UnknownSquiggle:0},d={SpellingSquiggle:0,GrammarSquiggle:0,AdvancedSquiggle:0,CIQFlagSquiggle:1,HeadingDetectionSquiggle:0,AutoCorrectSquiggle:0,UnknownSquiggle:0},c=e=>{const{isHighContrastMode:t,theme:i}=e,o=e=>t?"highlight":e;return n.createElement("svg",{width:"0",height:"0",style:{position:"absolute"}},n.createElement("defs",null,n.createElement("pattern",{id:r.SpellingSquiggle,width:"5",height:l.SpellingSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("path",{d:"M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3",stroke:o(i.highPriorityColors.tile),strokeWidth:"1",fill:"transparent"})),n.createElement("pattern",{id:r.GrammarSquiggle,width:"5",height:l.GrammarSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round"},n.createElement("g",{stroke:o(i.mediumPriorityColors.tile)},n.createElement("path",{d:"M0,0.5 L5,0.5"}),n.createElement("path",{d:"M0,2.5 L5,2.5"})))),n.createElement("pattern",{id:r.AdvancedSquiggle,width:"10",height:l.AdvancedSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M1,1 L5,1",stroke:o(i.lowPriorityColors.tile),strokeWidth:"2",strokeLinecap:"round"}))),n.createElement("pattern",{id:r.AutoCorrectSquiggle,width:"5",height:l.AutoCorrectSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none"},n.createElement("path",{d:"M0,0.5 L5,0.5",strokeWidth:"1",stroke:o(i.autoCorrectColors.tile)}))),n.createElement("pattern",{id:r.CIQFlagSquiggle,width:"6",height:l.CIQFlagSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("circle",{cx:"1.5",cy:"1.5",r:"1.5",fill:o(i.ciqFlagColors.tile)}))),n.createElement("pattern",{id:r.HeadingDetectionSquiggle,width:"10",height:l.HeadingDetectionSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M1,1 L5,1",stroke:o(i.headingDetectionColors.tile),strokeWidth:"2",strokeLinecap:"round"})))))}},68559:(e,t,i)=>{i.d(t,{a:()=>s});var n=i(8520);if(2063!=i.j)var o=i(39836);const s=e=>{const{className:t,left:i,patternName:s,squiggleHeight:r,styleOverrides:a,width:l}=e,d=o.fQ[s],c=o.K3[s];return n.createElement("svg",{width:l,height:d,viewBox:`0 0 ${l} ${d}`,className:t,style:Object.assign({top:r?r-d+c:void 0,bottom:r?void 0:-1*(d+c),left:i,position:"absolute"},a)},n.createElement("rect",{fill:`url(#${s})`,width:l,height:d}))}},6982:(e,t,i)=>{i.d(t,{g:()=>N});var n=i(8520),o=i(745),s=i(41642),r=i(95373),a=i(48662),l=i(22910),d=i(84030),c=i(71632),u=i(14389),h=i(23466),g=i(60773),p=i(96292),m=i(51244);const f=(0,m.PA)((e=>{const t=new Map;for(const i of e.squiggles){let e=t.get(i.squiggleKind);e||(e=[],t.set(i.squiggleKind,e)),e.push(i)}return n.createElement(n.Fragment,null,Array.from(t).map(((t,i)=>{const[o,s]=t,r=e.squigglerUXFactory(o),a=s.map((t=>{const i=t.critique.traceId===e.caretHoveredCritiqueId||t.critique.traceId===e.mouseHoveredCritiqueId||t.critique.traceId===e.calloutOpenedForCritique;let n=t.id===e.mouseHoveredElement;return(0,p.kI)(t.squiggleKind)&&(n=n||t.id===e.mouseIndirectlyHoveredElement),Object.assign(Object.assign({},t),{isHighlighted:i,isCaretOver:t.id===e.caretHoveredElement,isMouseOver:n,isCalloutOpened:t.critique.traceId===e.calloutOpenedForCritique})}));return n.createElement(n.Fragment,{key:i},r.getSquiggles(e.squigglerId,a,e.theme,e.isHighContrastMode))})))}));var v=i(39836),_=i(72113),y=i(63318);function I(e,t){switch(e){case u.N.OFFICE:return function(e){return`\n    span.ms-squiggle-${y.bx.High} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.spellingTile};\n    }\n\n    span.ms-squiggle-${y.bx.Medium} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.grammarTile};\n    }\n\n    span.ms-squiggle-${y.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.insightTile};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 1px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      border-image-source: ${e.autoCorrectTile};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t);case u.N.SVG:return function(e){return`\n  span.ms-squiggle-autocorrect-hl, svg.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      box-sizing: border-box;\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-autocorrect, svg.ms-squiggle-autocorrect {\n      opacity: 0%;\n    }\n  `}(t);case u.N.GENERIC:default:return function(e){return`\n    span.ms-squiggle-${y.bx.High} {\n      border-bottom: 4px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.highPriorityColors.tile};\n      border-image-source: ${e.spellingTileBorder};\n    }\n\n    span.ms-squiggle-${y.bx.Medium} {\n      border-bottom: 3px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.mediumPriorityColors.tile};\n      border-image-source: ${e.grammarTileBorder};\n    }\n\n    span.ms-squiggle-${y.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px solid;\n      border-image-slice: 0 1 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.lowPriorityColors.tile};\n      border-image-source: ${e.insightTileBorder};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-image-source: ${e.autoCorrectTileBorder};\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t)}}const C=(e,t=u.N.GENERIC,i)=>{const n=I(t,i),o=`\n        span.ms-squiggle {\n            position: absolute;\n            border-radius: 2px;\n            border-image-repeat: repeat;\n            background-clip: content-box;\n            cursor: text;\n            pointer-events: none;\n            box-sizing: ${t===u.N.OFFICE?"content-box":"border-box"};\n        }\n\n        span.ms-squiggle.stealth {\n          opacity: 0%;\n          transition: opacity 0.25s;\n        }\n\n        span.ms-squiggle.stealth.hl {\n          opacity: 100%;\n        }\n\n        ${n}\n        ${function(e){return`\n    span.ms-squiggle-${y.bx.High}.hl {\n      background-color: ${e.theme.highPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${y.bx.Medium}.hl {\n      background-color: ${e.theme.mediumPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${y.bx.Low}.hl:not(.ms-squiggle-TopicSuggestion.hl) {\n      background-color: ${e.theme.lowPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition.hl, .ms-squiggle-CIQFlag_DateEntityRecognition.hl, .ms-squiggle-CIQFlag_SatoriEntityRecognition.hl, .ms-squiggle-CIQFlag_Location.hl, .ms-squiggle-CIQFlag_File.hl, .ms-squiggle-CIQFlag_Time.hl, .ms-squiggle-CIQFlag_Topic.hl, .ms-squiggle-CIQFlag_TaskRecognition.hl, .ms-squiggle-TopicSuggestion.hl, .ms-squiggle-CIQFlag_LocalBusiness.hl {\n      background-color: ${e.theme.ciqFlagColors.highlight};\n    }\n\n    span.ms-squiggle-HeadingDetection.hl {\n      background-color:${e.theme.headingDetectionColors.highlight};\n    }\n  `}(i)}\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n    `,s=`\n        span.hc-noadjust {\n          -ms-high-contrast-adjust: none;\n        }\n\n        span.ms-squiggle {\n          forced-color-adjust:none;\n          cursor: text;\n          box-sizing: border-box;\n          pointer-events: none;\n          border-color: highlight;\n          border-image-source: none;\n          background-image: none;\n          position: absolute;\n          border-radius: 0px;\n        }\n\n        ${function(e){return e===u.N.SVG?"":`\n    span.ms-squiggle-${y.bx.High} {\n      border-bottom: 4px solid highlight;\n    }\n\n    span.ms-squiggle-${y.bx.Medium} {\n      border-bottom: 3px double highlight;\n    }\n\n    span.ms-squiggle-${y.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px dashed highlight;\n    }\n\n    span.ms-squiggle-autocorrect {\n      border-bottom: none;\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid highlight;\n    }\n  `}(t)}\n\n        span.ms-squiggle-autocorrect {\n          border-bottom: none;\n        }\n\n        span.hl {\n          outline: 2px solid highlight;\n        }\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n\n        span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition,, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n          background-image: linear-gradient(to right, #3c97dd 33%, rgba(0,0,0,0) 0%);\n          background-position: bottom;\n          background-size: 6px 2px;\n          background-repeat: repeat-x;\n        }\n    `;return e?s:o};var S=i(94329),b=i(75210);const T=(0,o.F5)({featureFlagsReader:s.A.on(a.c),squigglerUXFactory:s.A.on(g.g),safeWindow:s.A.on(l.j),highConstrastModeDetector:s.A.on(h.P)});class E extends n.Component{constructor(e){super(e),this.connectSquiggler=()=>{this.squigglerEvents.connectSquiggler()},this.disconnectSquiggler=()=>{this.squigglerEvents.disconnectSquiggler()},this.setSquigglerRef=e=>{this.props.state.setSquigglerRef(e),this.squigglerEvents.updatePositionIfRelative()},this.shouldRender=()=>{var e,t;return null!==(t=null===(e=this.props.state.hostElement)||void 0===e?void 0:e.shouldRender(this.props.state.anchorElement))&&void 0!==t&&t},this.selectorRef=n.createRef();const t=new d.O(this.props.state.anchorElement?(0,c.e)(this.props.state.anchorElement):window);this.squigglerEvents=this.props.state.squigglerEventManager.createEventManager(t,this.props.state,this.props.deps.safeWindow)}componentDidUpdate(e){var t;const i=this.props.state.isVisible,n=e.state.isVisible;i?(this.props.state.reactOnComponentUpdate&&(this.squigglerEvents.updatePositionIfRelative(),this.squigglerEvents.checkHighlight()),n||this.connectSquiggler()):n&&this.disconnectSquiggler(),this.selectorRef.current&&(null===(t=this.props.state.hostElement)||void 0===t||t.squigglerUpdated(this.selectorRef.current))}async componentDidMount(){this.connectSquiggler(),await this.props.state.updateRanges(),this.squigglerEvents.checkHighlight(),this.squigglerEvents.updatePositionIfRelative()}componentWillUnmount(){this.disconnectSquiggler(),this.props.state.disconnectVisibilityTracker(),this.squigglerEvents.dispose()}render(){let e={};const{isRelativePositionEnabled:t,squiggleStyleType:i,id:o,top:s,left:r,anchorElement:a,isVisible:l,squigglesToRender:d,parentToRenderTo:c,hostElement:h,theme:g,caretHoveredCritiqueId:p,mouseHoveredCritiqueId:m,calloutOpenedForCritique:y,caretHoveredElement:I,mouseHoveredElement:T,mouseIndirectlyHoveredElement:E,scaleTransformValue:N}=this.props.state;if(!a||!c||!h)return null;e=t?{pointerEvents:"none",position:"relative",flexGrow:0,msHighContrastAdjust:"none",display:"block",top:`${s}px`,left:`${r}px`}:{pointerEvents:"none",position:"absolute",msHighContrastAdjust:"none",flexGrow:0,top:`${s}px`,left:`${r}px`};const x=this.props.deps.highConstrastModeDetector.enabled,w=h.squigglerInlineStyles(a,N),L=i===u.N.SVG,D=C(x,i,g),F=n.createElement(f,{squiggles:d,squigglerId:o,theme:g.theme,isHighContrastMode:x,squigglerUXFactory:this.props.deps.squigglerUXFactory,caretHoveredCritiqueId:p,mouseHoveredCritiqueId:m,calloutOpenedForCritique:y,caretHoveredElement:I,mouseHoveredElement:T,mouseIndirectlyHoveredElement:E});return(0,_.v4)(this.props.deps.featureFlagsReader)?l&&this.shouldRender()?F:null:S.createPortal(n.createElement("editor-squiggler",{"aria-hidden":!0,tabindex:-1,style:{height:"0px",width:"0px"},ref:this.selectorRef},n.createElement(n.Fragment,null,n.createElement("style",null,"\n  @media print {\n    .ms-editor-squiggler {\n        display:none !important;\n    }\n  }\n  .ms-editor-squiggler {\n    all: initial;\n    display: block !important;\n    height: 0px !important;\n    width: 0px !important;\n  }"),n.createElement(b.Ay.div,{className:"ms-editor-squiggler",ref:this.setSquigglerRef,style:w},n.createElement("style",{type:"text/css"},D),L&&n.createElement(v.VA,{theme:g.theme,isHighContrastMode:x}),n.createElement("div",{style:e},l&&this.shouldRender()&&F)))),c)}}const N=(0,r.r)((0,m.PA)(E),T)},93550:(e,t,i)=>{i.d(t,{a2:()=>u,pT:()=>l});var n=i(23182),o=i(98647),s=i(88011),r=i(7635),a=i(29906);let l=class{createEventManager(e,t,i){return new c(e,t,i)}};l=(0,n.__decorate)([(0,a._)()],l);const d={passive:!1};class c{constructor(e,t,i){var n;this.targetWindowRef=e,this.state=t,this.safeWindow=i,this.isMouseWithinElement=!1,this.disconnectAdditionalHandlers=()=>null,this.connectedEventListeners=[],this.connectSquiggler=()=>{for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[];const e=this.targetWindowRef.deref();if(!e)return;const t=new o.J(e),i=new o.J(e.document);if(this.connectedEventListeners.push(t),this.connectedEventListeners.push(i),t.addListener("resize",this.reRenderDeferred,d),i.addListener("mouseup",this.onDocumentMouseUp,d),i.addListener("pointerup",this.onDocumentMouseUp,d),i.addListener("selectionchange",this.checkHighlight,d),this.state.anchorElement&&this.state.hostElement){const e=new o.J(this.state.anchorElement);if(this.connectedEventListeners.push(e),e.addListener("mouseenter",this.onMouseEnter,d),e.addListener("mouseleave",this.onMouseLeave,d),this.resizeObserver){this.resizeObserver.observe(this.state.anchorElement);for(const e of this.state.hostElement.shouldObserveSize(this.state.anchorElement))e&&this.resizeObserver.observe(e)}const t=u(this.state.anchorElement),i=new o.J(t);this.connectedEventListeners.push(i),i.addListener("input",this.onInputHandler,d),i.addListener("keyup",this.throttleKeyUp,d),this.isScrollable&&(i.addListener("scroll",this.throttleScroll,d),i.addListener("mousewheel",this.throttleScroll,d),i.addListener("touchmove",this.throttleScroll,d)),i.addListener("focusin",this.checkHighlight,d),i.addListener("focusout",this.throttleFocusOut,d),this.disconnectAdditionalHandlers=this.state.hostElement.addHandlers(this.state.anchorElement,this,this.state.proofedElements.map((e=>e.id)))}},this.disconnectSquiggler=()=>{var e;for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[],this.lastMouseMoveEvent=void 0,null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,this.disconnectAdditionalHandlers(),this.disconnectAdditionalHandlers=()=>{}},this.dispose=()=>{this.disconnectSquiggler(),this.throttledCheckCursorHighlight=void 0},this.reRender=()=>{this.state.updateRanges()},this.updatePositionIfRelative=()=>{this.requiresUpdateForRelativePosition()&&this.reRender()},this.checkHighlight=()=>{var e,t;const i=this.targetWindowRef.deref();i&&this.state.anchorElement&&(i.document.activeElement===this.state.anchorElement||this.state.anchorElement.contains(i.document.activeElement)||(null===(e=i.document.activeElement)||void 0===e?void 0:e.contains(this.state.anchorElement)))&&(this.onMouseEnter(),this.checkCaretPosition(),null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this))},this.onMouseEnter=()=>{var e;this.isMouseWithinElement=!0,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.anchorElement&&(this.mouseWithinElementEventListener=new o.J(this.state.anchorElement),this.connectedEventListeners.push(this.mouseWithinElementEventListener),this.mouseWithinElementEventListener.addListener("mousemove",this.onMouseMove,d))},this.onMouseLeave=()=>{var e;this.isMouseWithinElement=!1,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.setLastMousePosition(void 0),this.state.trivializeAllSquiggles(r.Rw.cursor)},this.onFocusOut=()=>{this.state.trivializeAllSquiggles(r.Rw.caret),this.state.closeTooltip()},this.onInputHandler=()=>{this.onInput()},this.onInput=()=>{(this.getShouldReactToInput()||this.state.isAutoCorrectionOnly||this.requiresUpdateForRelativePosition())&&this.reRender()},this.onKeyup=e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key)?this.checkCaretPosition():("Delete"===e.key||"Backspace"===e.key||this.isTabPressed(e)||this.state.isAutoCorrectionOnly)&&this.onInput()},this.isTabPressed=e=>"Tab"===e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey,this.checkCaretPosition=()=>{var e;const t=((null===(e=this.state.anchorElement)||void 0===e?void 0:e.ownerDocument)||document).getSelection();t&&t.rangeCount>0&&this.state.updateSelectionHighlightState(t)},this.onMouseMove=e=>{var t;this.state.anchorElement&&this.isMouseWithinElement?(this.lastMouseMoveEvent=e,null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this)):this.lastMouseMoveEvent=void 0},this.checkCursorHighlight=()=>{if(this.lastMouseMoveEvent&&this.state.anchorElement){const e={x:this.lastMouseMoveEvent.clientX,y:this.lastMouseMoveEvent.clientY};this.state.setLastMousePosition(e)}this.state.updateCursorHighlightState(),this.lastMouseMoveEvent=void 0},this.onDocumentMouseUp=e=>{this.onMouseClick(e),this.reRenderDeferred()},this.onMouseClick=e=>{const{anchorElement:t,updateCursorHighlightState:i,setLastMousePosition:n}=this.state;if(!t)return;n({x:e.clientX,y:e.clientY}),this.checkCaretPosition(),i()},this.throttleScroll=()=>{this.reRenderDeferred()},this.reRenderDeferred=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRender()),this.targetWindowRef)},this.throttleKeyUp=e=>{this.safeWindow.requestAnimationFrame((()=>this.onKeyup(e)),this.targetWindowRef)},this.throttleFocusOut=()=>{this.safeWindow.requestAnimationFrame((()=>this.onFocusOut()),this.targetWindowRef)},this.throttleUpdateOnResize=()=>{this.safeWindow.requestAnimationFrame((()=>{this.state.updatePosition(this.state.isRelativePositionEnabled),this.reRender()}),this.targetWindowRef)},this.requiresUpdateForRelativePosition=()=>{const{isRelativePositionEnabled:e}=this.state;return e&&this.state.updatePosition(e)},this.determineIfScrollable=e=>{switch(e){case"scroll":return!0;case"hidden":case"visible":return!1;default:return null}};const a=e.deref();if(a&&(this.throttledCheckCursorHighlight=(0,s.hQ)(this.safeWindow,a,this.checkCursorHighlight,"After"),this.state.anchorElement)){if(this.isScrollable=null===(n=this.state.hostElement)||void 0===n?void 0:n.isScrollable(this.state.anchorElement),void 0===this.isScrollable){const e=this.getAnchorElementComputedStyle();this.isScrollable=e&&!(!1===this.determineIfScrollable(e.overflowX)&&!1===this.determineIfScrollable(e.overflowY))}a.ResizeObserver&&(this.resizeObserver=new a.ResizeObserver((()=>this.throttleUpdateOnResize())))}}getAnchorElementComputedStyle(){var e;return this.anchorElementComputedStyle||(this.anchorElementComputedStyle=this.state.anchorElement&&(null===(e=this.targetWindowRef.deref())||void 0===e?void 0:e.getComputedStyle(this.state.anchorElement))),this.anchorElementComputedStyle}getShouldReactToInput(){if(void 0!==this.reactToOnInput)return this.reactToOnInput;const e=this.getAnchorElementComputedStyle();return this.reactToOnInput=["center","right"].includes((null==e?void 0:e.textAlign)||"")||"rtl"===(null==e?void 0:e.direction),this.reactToOnInput}}function u(e){let t=e;if("true"!==t.contentEditable&&t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(t=e)}return t}},48785:(e,t,i)=>{i.d(t,{i:()=>he});var n=i(23182),o=i(8520),s=i(53382),r=i(27959),a=i(19728),l=i(37814);class d{constructor(e,t,i){this.range=e,this.zIndex=i,this.originalStartContainerOfRange=e.startContainer,this.clientRect=t}isRangeInValidState(){return this.range.startContainer===this.originalStartContainerOfRange&&!this.range.collapsed}updateRange(e){e&&(this.range=e)}}class c{constructor(e,t,i,n,o,s,r,d){this.id=e,this.element=t,this.squiggleKind=i,this.critique=n,this.isVisible=o,this.stealth=s,this.data=r,this.squiggleRef=d,(0,l.Gn)(this,{isVisible:a.observable,stealth:a.observable,data:a.observable,updateFromRect:a.action})}updateFromRect(e,t){var i;this.isVisible!==e.visible&&(this.isVisible=e.visible),e.visible&&(this.data=new d(t,e,this.data.zIndex));const n=null!==(i=this.critique.isStealth)&&void 0!==i&&i;n!==this.stealth&&(this.stealth=n)}}var u,h=i(53124),g=i(53268),p=i(44698),m=i(58550),f=i(42007),v=i(49845),_=i(97633),y=i(99724),I=i(63318),C=i(76316),S=i(71632),b=i(84030),T=i(14389),E=i(22910),N=i(92739),x=i(88011),w=i(62026),L=i(33767),D=i(37053),F=i(4531),A=i(63285);function R(e,t,i,n){return e&&i>=e.top&&i<=e.bottom?t>=e.left&&t<=e.right?u.direct:n&&t>=e.right-n&&t<=e.left?u.indirect:u.line:u.none}function q(e,t){if("Caret"!==t.type||!t.focusNode)return u.none;if(e.isPointInRange(t.focusNode,t.focusOffset))return u.direct;const i=e.getBoundingClientRect(),n=t.getRangeAt(0).getBoundingClientRect();return i.top<=n.top&&i.bottom>=n.bottom?u.line:u.none}function P(e,t){return!("Caret"!==t.type||!t.focusNode)&&e.isPointInRange(t.focusNode,t.focusOffset)}!function(e){e.none="none",e.direct="direct",e.line="line",e.indirect="indirect"}(u||(u={}));var O=i(7635),k=i(67409),z=i(81174),M=i(78426),W=i(33727),j=i(38583),B=i(85681),U=i(63519),H=i(71975),V=i(21203),G=i(92510),Q=i(25618),K=i(96292),$=i(83314),J=i(13559),Z=i(93550);function Y(e){if(!e||"auto"===e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t+1}function X(e,t,i,n,o=1){const s=n,r={top:t.clientTop,left:t.clientLeft,right:0,bottom:0,width:t.clientWidth,height:t.clientHeight},a=i(function(e){if(e.startContainer===e.endContainer)return Array.from(e.getClientRects());const t=e.startContainer.ownerDocument||document,i=t.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ALL),n=[];for(;i.nextNode()&&(0===n.length&&i.referenceNode!==e.startContainer||(n.push(i.referenceNode),i.referenceNode!==e.endContainer)););const o=[],s=t.createRange();for(const t of n)t.nodeType===t.TEXT_NODE&&(s.selectNode(t),t===e.startContainer?s.setStart(t,e.startOffset):t===e.endContainer&&s.setEnd(t,e.endOffset),o.push(...Array.from(s.getClientRects())));let r=!0;for(const e of o)if(e.top!==o[0].top||e.height!==o[0].height){r=!1;break}if(r){return[o.reduce(((e,t)=>new DOMRect(Math.min(e.left,t.left),e.top,Math.max(e.right,t.right)-Math.min(e.left,t.left),e.height)))]}return o}(e),e),l=[];if(a)for(const e of a){const t=0===r.width?s.right-s.left:r.width/o,i=Math.max(e.left-s.left,r.left),n=Math.min(e.right-s.left,t),a={top:e.top-s.top,left:i,bottom:e.bottom-s.top,right:n,width:n-i,height:e.height,visible:!ee(e,s)};l.push(a)}return l}function ee(e,t){return e.bottom>t.bottom+e.height/4||e.left>t.right||e.right<t.left||e.bottom<t.top}function te(e){if(!e)return 0;const t=parseFloat(e);return isNaN(t)?0:t}var ie=i(83817);const ne=()=>!0,oe=(e,t,i,n,o=!0)=>{var s,r,a,l,d,c,u,h,g,p,m;const f=i.find((t=>t.match(e))),v=null!==(s=null==f?void 0:f.shouldRender)&&void 0!==s?s:ne,_=null!==(r=null==f?void 0:f.shouldRenderSquiggle)&&void 0!==r?r:ne,y=null!==(a=null==f?void 0:f.shouldObserveSize)&&void 0!==a?a:()=>[],I=null!==(l=null==f?void 0:f.addHandlers)&&void 0!==l?l:()=>()=>null,C=null!==(d=null==f?void 0:f.squigglerInlineStyles)&&void 0!==d?d:()=>{},S=null!==(c=null==f?void 0:f.transformSquiggleRects)&&void 0!==c?c:e=>e,b=null!==(u=null==f?void 0:f.getForbiddenRects)&&void 0!==u?u:()=>[],T=null!==(h=null==f?void 0:f.isScrollable)&&void 0!==h?h:()=>{},E=null!==(g=null==f?void 0:f.squigglerUpdated)&&void 0!==g?g:()=>{},N=e.tagName.toLowerCase(),x="editor-shadow-element"===N?window.document.body:e.parentElement,w={element:null!==(p=e.parentElement)&&void 0!==p?p:window.document.body,zIndex:null!==(m=null==f?void 0:f.zIndex)&&void 0!==m?m:"auto",shouldRender:v,shouldRenderSquiggle:_,shouldObserveSize:y,addHandlers:I,squigglerInlineStyles:C,transformSquiggleRects:S,getForbiddenRects:b,isScrollable:T,squigglerUpdated:E,disableCalloutOnDoubleClick:null==f?void 0:f.disableCalloutOnDoubleClick};if("body"===N||!x)return w;if(null==f?void 0:f.selector){const t="string"==typeof f.selector?e.closest(f.selector):f.selector(e,null==n?void 0:n.element);if(t)return w.element=t,w}return w.element=o?((e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let i=e.parentElement,n=window.getComputedStyle(i);for(;i&&"relative"!==n.position&&i!==document.body;)i=i.parentElement,n=window.getComputedStyle(i);return i})(e,t()):x,w};var se=i(30950),re=i(17298),ae=i(29906),le=i(83010),de=i(66008),ce=i(27603);const ue=(0,re.f)("SquigglerV2StateStoreOptionsToken");let he=class{constructor(e,t,i,n,m,f,v,_,w,L,D,F,A,M,W,j,B,U,H,V,G,ee){var te,ne,re,ae,le,de,ce;this.tileContent=t,this.instrumentationProcessor=i,this._hostEmitters=n,this.hostEmitter=m,this.hostSettings=f,this.proofingDom=v,this._squiggleThemeStore=_,this.logger=w,this._tileNodeTraverser=L,this.upsellStore=D,this.editorSettingsState=A,this.feedbackStore=M,this._disableCritiqueHandler=W,this.critiqueStore=j,this.applyCritiqueSuggestionHandler=B,this.applyFlagHandler=U,this.wordDictionary=H,this.editorSettingsManager=V,this._formElementAutoCorrectionCache=G,this.autoCorrectionBroker=ee,this.diffPrecision=.01,this.isTooltipShown=!1,this.squigglesCache=new a.ObservableMap,this.autoCorrectDisabledLanguages=[],this.proofedElements=[],this.proofedElementDomRects=[],this.calloutOpenedForCritique=void 0,this.mouseHoveredElement=void 0,this.mouseIndirectlyHoveredElement=void 0,this.caretHoveredElement=void 0,this.scaleTransformValue=1,this.top=0,this.left=0,this.isAutoCorrectionOnly=!1,this.recalculateRelativePosition=()=>{this.isRelativePositionEnabledValue=this.calculateRelativePosition()},this.isVisible=!1,this.onCalloutPositionUpdated=(e,t)=>{this.isUndoCalloutAlignedRight=e,this.undoCalloutRect=t},this.autoCorrectLanguagesUpdated=async e=>{this.autoCorrectDisabledLanguages=e.message},this.recordAutoCorrectInstrumentationEvent=(e,t)=>{this.hostEmitter.emit(y.pD.autoCorrectionTriggered);const i={isPersonalized:(0,k.dP)(t).toString()};this.instrumentationProcessor.process({critique:e,eventId:15,customProperties:i})},this.setCritiques=async e=>{const t=this.proofedElements.find((t=>t.id===e.id));t?t.critiques=e.critiques:this.proofedElements.push(e),await this.updateRanges()},this.removeCritiques=async e=>{const t=this.proofedElements.findIndex((t=>t.id===e));-1!==t&&(this.squigglesCache.delete(e),this.proofedElements.splice(t,1),await this.updateRanges())},this.updateRanges=async()=>{this.throttledUpdateRanges?await this.throttledUpdateRanges():await this.updateRangesImmediately()},this.updateSquiggles=()=>{this.throttledUpdateSquiggles?this.throttledUpdateSquiggles():this.innerUpdateSquiggles()},this.setVisible=e=>{this.isVisible=e,e&&this.safeWindow.requestAnimationFrame((async()=>{await this.updateRanges()}))},this.setLastMousePosition=e=>{this.lastMousePosition=e},this.disconnectVisibilityTracker=()=>{var e;null===(e=this._visibilityTracker)||void 0===e||e.disconnect()},this.getCritiques=()=>this.proofedElements.reduce(((e,t)=>e.concat(t.critiques)),[]),this.showCallout=(e,t)=>{var i,n;const o=null===(i=this.targetWindowRef)||void 0===i?void 0:i.deref();if(!e.traceId||!o)return;const s=this.findSquiggle(e.traceId);if(s){const i=null!==(n=s.data.range.startContainer.parentElement)&&void 0!==n?n:s.element;this.safeWindow.requestAnimationFrame((()=>{i.scrollIntoView({behavior:"auto"}),o.setTimeout((()=>{var i,n;ge(s)&&(this.onShowCallout(null!==(n=null===(i=s.squiggleRef)||void 0===i?void 0:i.current)&&void 0!==n?n:null,e,s.data.range.toString(),!0,(()=>{}),s.element,K.Ah.critique),null==t||t())}),100)}),o)}},this.updateSelectionHighlightState=e=>{let t,i=0;this.forEachCritique((n=>{var o,s;for(const r of n.squiggles){if(!r.isVisible)continue;let a=u.none;this.ariaLineNavUpdatesEnabled?a=q(r.data.range,e):P(r.data.range,e)&&(a=u.direct),a===u.direct?(this.caretHoveredCritiqueId=r.critique.traceId,(1===n.squiggles.length||this.checkSquiggleSelection(r,e))&&(this.caretHoveredElement=r.id,ge(r)&&this.showTooltipAt(r.squiggleKind,null===(o=r.squiggleRef)||void 0===o?void 0:o.current,r.critique,"keyboard")),t=r,this.caretPosition={node:e.focusNode,offset:e.focusOffset}):(this.caretHoveredElement===r.id&&(this.caretPosition=void 0,null===(s=this.critiqueCalloutHandler)||void 0===s||s.hideCallout()),a===u.line&&(i+=1),this.trivializeSquiggle(r,O.Rw.caret))}})),this.updateAriaStatus(i,t)},this.updateSelectionHighlightStateFromCoordinates=e=>{let t,i=0;this.forEachCritique((n=>{var o,s;for(const r of n.squiggles){if(!r.isVisible)continue;const n=R(r.data.clientRect,e.x,e.y);n===u.direct?(this.caretHoveredCritiqueId=r.critique.traceId,this.caretHoveredElement=r.id,ge(r)&&this.showTooltipAt(r.squiggleKind,null===(o=r.squiggleRef)||void 0===o?void 0:o.current,r.critique,"keyboard",e),t=r):(n===u.line&&(i+=1),this.caretHoveredElement===r.id&&(this.caretPosition=void 0,null===(s=this.critiqueCalloutHandler)||void 0===s||s.hideCallout()),this.trivializeSquiggle(r,O.Rw.caret))}})),this.updateAriaStatus(i,t)},this.startUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=t.setTimeout((()=>{this.lastMousePosition?this.setMouseIndirectlyHoveredElement(void 0):this.clearUndoCardTimeout()}),2e3))},this.clearUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=void 0)},this.isMouseWithinUndoCallout=()=>{if(!this.undoCalloutRect||!this.lastMousePosition||!this.anchorElement)return!1;const e=(e,t,i)=>e>=t&&e<=t+i;return e(this.lastMousePosition.x,this.undoCalloutRect.x,this.undoCalloutRect.width)&&e(this.lastMousePosition.y,this.undoCalloutRect.y,this.undoCalloutRect.height)},this.updateCursorHighlightState=()=>{var e;if(this.lastMousePosition&&this.anchorElement)if(null===(e=this.options)||void 0===e?void 0:e.enableCursorIntersectionObserver){const e=new IntersectionObserver((t=>{this.updateCursorHighlightStateWithAnchorBoundingBox(t[0].boundingClientRect),e.disconnect()}));e.observe(this.anchorElement)}else{const e=this.anchorElement.getBoundingClientRect();this.updateCursorHighlightStateWithAnchorBoundingBox(e)}},this.updateCursorHighlightStateWithAnchorBoundingBox=e=>{if(!this.lastMousePosition)return;const{x:t,y:i}=this.lastMousePosition;let n,o=0;this.forEachCritique((s=>{var r,a,l,d;for(const c of s.squiggles){if(!c.isVisible||!this.anchorElement)continue;const s=this.mouseIndirectlyHoveredElement===c.id?null===(r=this.undoCalloutRect)||void 0===r?void 0:r.width:void 0;let h=R({left:c.data.clientRect.left+e.left,top:c.data.clientRect.top+e.top,right:c.data.clientRect.right+e.left,bottom:c.data.clientRect.bottom+e.top,width:c.data.clientRect.width,height:c.data.clientRect.height},t,i,s);const g=(0,K.kI)(c.squiggleKind);if(this.ariaLineNavUpdatesEnabled||h!==u.line||(h=u.none),g)if(this.mouseIndirectlyHoveredElement===c.id)if(h===u.indirect){if(void 0!==this.indirectTimer)continue;this.startUndoCardTimeout()}else this.setMouseIndirectlyHoveredElement(void 0),this.clearUndoCardTimeout();else(null===(a=this.options)||void 0===a?void 0:a.disableOpenAutoCorrectCalloutOnHover)||this.calloutOpenedForCritique!==c.critique.traceId||h!==u.none||this.isMouseWithinUndoCallout()||(null===(l=this.critiqueCalloutHandler)||void 0===l||l.hideCallout(),this.undoCalloutRect=void 0);if(h===u.direct)return n=c,this.mouseHoveredCritiqueId=c.critique.traceId,this.mouseHoveredElement=c.id,this.isUndoCalloutAlignedRight&&this.setMouseIndirectlyHoveredElement(c.id),void(c.squiggleKind===K.Ah.critique&&ge(c)&&this.showTooltipAt(c.squiggleKind,null===(d=c.squiggleRef)||void 0===d?void 0:d.current,c.critique,"mouse"));h===u.line&&(o+=1),this.trivializeSquiggle(c,O.Rw.cursor)}})),this.updateAriaStatus(o,n),n||this.trivializeCursorSquiggle()},this.trivializeAllSquiggles=e=>{e===O.Rw.caret?this.trivializeCaretSquiggle():this.trivializeCursorSquiggle()},this.trivializeSquiggle=(e,t,i=!1)=>{t===O.Rw.caret?this.trivializeSquiggleCaretHover(e.critique.traceId):this.mouseHoveredCritiqueId!==e.critique.traceId||i&&(0,K.kI)(e.squiggleKind)||this.trivializeCursorSquiggle()},this.trivializeSquiggleCaretHover=e=>{this.caretHoveredCritiqueId===e&&this.trivializeCaretSquiggle()},this.trivializeCursorSquiggle=()=>{this.mouseHoveredCritiqueId=void 0,this.mouseHoveredElement=void 0},this.trivializeCaretSquiggle=()=>{this.caretHoveredCritiqueId=void 0,this.caretHoveredElement=void 0},this.flagShowFeedback=(e,t)=>{var i,n,o,s,r;this.proofedElements.find((t=>t.element===e))&&((null==t?void 0:t.typeId)===I.L9.CIQFlag_Topic?(0,C.z)((0,se.S)({topicIds:(null===(i=t.suggestionItems)||void 0===i?void 0:i.map((e=>e.entities.map((e=>e.TopicId)))).join(","))||"",topicNames:(null===(n=t.suggestionItems)||void 0===n?void 0:n.map((e=>e.entities.map((e=>e.DisplayName)))).join(","))||"",highlightedText:t.textInContext||"",hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),requestId:t.nodeId,source:"EditorFlag",traceId:t.traceId||""})):null===(o=this.feedbackStore)||void 0===o||o.feedbackIconClicked(null!==(s=null==t?void 0:t.textInContext)&&void 0!==s?s:"",null!==(r=null==t?void 0:t.typeId)&&void 0!==r?r:""))},this.scaleTransform=e=>{this.scaleTransformValue=e,this.innerUpdateSquiggles()},this.updateAriaStatus=(e,t)=>{this.ariaStatusStateStore&&(t&&this.isAriaFeatureEnabled(J.j.highlight)?this.isAriaFeatureEnabled(J.j.highlight,t.critique)?this.ariaStatusStateStore.setStatus(this.getAriaStatusString(t),"assertive",!1,void 0,t.squiggleKind===K.Ah.critique?s.Jx.KeepOriginal:s.Jx.AutoCorrectHover):this.ariaStatusStateStore.setStatus("","assertive",!1,void 0):this.ariaLineNavUpdatesEnabled&&this.ariaStatusStateStore.setLineNavStatus(e,"polite",!1))},this.updateRangesImmediately=async()=>{var e;if(!this.isVisible)return;const t=new Set(this.squigglesCache.keys()),i=!!(null===(e=this.options)||void 0===e?void 0:e.autoCorrectionEnabled)&&!!this.autoCorrectionCache;let n=!1;await(0,a.transaction)((async()=>{var e,o,s,r,l,d;for(const c of this.proofedElements){const u=[],h=null!==(e=this.squigglesCache.get(c.id))&&void 0!==e?e:new a.ObservableMap,g=new Set(h.keys());for(const e of c.critiques)e.traceId&&g.delete(e.traceId),u.push(e);const p=await this.critiqueRangeBuilder.getCritiqueRanges(u,c.element),m=u.length>0?this.determineValidSquiggles(p):[];if(g.size>0&&this.removeCritiquesFromCache(g,h),m.length>0){const e=await this.buildSquigglesForCritiques(c.element,m,h,i),t=[];if(this.autoCorrectionBroker){for(let i=e.length-1;i>=0;i-=1){const n=e[i];if(!(null===(o=this.autoCorrectionCache)||void 0===o?void 0:o.process(n.critique.traceId)))continue;const a=null!==(s=n.critique.nodeId)&&void 0!==s?s:null===(r=n.critique.tileId)||void 0===r?void 0:r.nodeId,u=a?this.proofingDom.findNode(a):null;if(!u){null===(l=this.logger)||void 0===l||l.error(508146701,"Unable to find node while applying autocorrection");continue}this.autoCorrectionBroker.setIsApplyingAutoCorrection(n.critique);const h=await this.tileContent.autoCorrect(u,c.element,n.critique.start,n.critique.length,n.suggestion.text,n.range,null===(d=this.options)||void 0===d?void 0:d.autoCorrectionInputCacheEnabled);h?(t.push({replacedText:h,critique:n.critique}),this.recordAutoCorrectInstrumentationEvent(n.critique,n.suggestion)):this.autoCorrectionBroker.convertToNormalSquiggle(n.critique)}let i=0;for(let e=t.length-1;e>=0;e-=1)i+=this.autoCorrectionBroker.setIsFinishedApplyingAutoCorrection(t[e].critique,i),n=!0}}this.setCacheEntry(c.id,h),t.delete(c.id)}t.size>0&&this.removeMissingElements(t),this.updatePosition(this.isRelativePositionEnabled)})),n&&await this.updateRangesImmediately()},this.getValidCritiques=async e=>{const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.critiques,e.element);return this.determineValidSquiggles(t).map((e=>e.critique))},this.setCacheEntry=(e,t)=>{this.squigglesCache.set(e,t)},this.removeCritiquesFromCache=(e,t)=>{var i;for(const n of e.keys())t.delete(n),this.calloutOpenedForCritique===n&&(null===(i=this.critiqueCalloutHandler)||void 0===i||i.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.mouseHoveredCritiqueId!==n&&this.caretHoveredCritiqueId!==n||(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle())},this.removeMissingElements=e=>{var t;for(const i of e){const e=this.squigglesCache.get(i);if(e)for(const i of e.values())for(const e of i)null===(t=this._visibilityTracker)||void 0===t||t.unTrackSquiggle(e.data.range.startContainer);this.squigglesCache.delete(i)}},this.buildSquigglesForCritiques=async(e,t,i,n,o=K.Ah.critique)=>{var s,r,a,l,d,c;const u=[];if(this.anchorElement){const h=this.anchorElement.getBoundingClientRect(),g=null===(s=this.anchorElement.ownerDocument.activeElement)||void 0===s?void 0:s.contains(e),p=null===(r=this.targetWindowRef)||void 0===r?void 0:r.deref(),m=p&&(null===(a=this.hostElement)||void 0===a?void 0:a.getForbiddenRects(p)),f=(e,t)=>{var i;return null===(i=this.hostElement)||void 0===i?void 0:i.transformSquiggleRects(e,t,m)},v=[];for(const s of t){if(!s.range||!s.critique.traceId)continue;const t=i.get(s.critique.traceId);let r=null!==(l=null==t?void 0:t[0].squiggleKind)&&void 0!==l?l:o;if(n&&!t&&g){const e=(0,k.MG)(s.critique);if(e){const t=s.critique;if(this.autoCorrectionBroker&&!this.autoCorrectionBroker.getHasAutoCorrectionBeenConvertedToNormalSquiggle(t))if(this.autoCorrectionBroker.getHasAutoCorrectionBeenApplied(t))r=(null===(c=this.options)||void 0===c?void 0:c.personalizedAutoCorrectionEnabled)&&(0,k.dP)(e)?K.Ah.personalizedAutocorrection:K.Ah.autocorrection;else{if(this.enableAutoCorrectionForLanguages(e.languages)&&await(null===(d=this._visibilityTracker)||void 0===d?void 0:d.checkImmediateVisibility(s.range.startContainer))&&this.isAutoCorrectApplicable(s.range)){u.push({critique:t,suggestion:e,range:s.range});continue}this.autoCorrectionBroker.convertToNormalSquiggle(t)}}}this.createOrUpdateSquiggleStates(s.critique,s.range,e,i,r,h,t,f).shouldAnnounce&&v.push({critique:s.critique,squiggleKind:r})}v.length&&this.setAriaStatuses(v)}return u},this.isAutoCorrectApplicable=e=>{var t;const i=null===(t=this.targetWindowRef)||void 0===t?void 0:t.deref();if(!i)return!1;const n=i.document.getSelection();if(!(null==n?void 0:n.focusNode)||!n.isCollapsed)return!1;const o=e.comparePoint(n.focusNode,n.focusOffset);if(0===o)return!1;const s=i.document.createRange();return 1===o?(s.setStart(e.endContainer,e.endOffset),s.setEnd(n.focusNode,n.focusOffset)):(s.setStart(n.focusNode,n.focusOffset),s.setEnd(e.startContainer,e.startOffset)),s.toString().length<=K.tB},this.createOrUpdateSquiggleStates=(e,t,i,n,o,s,r,a)=>e.traceId&&this.anchorElement&&this.hostElement?this.updateSquiggle(r,t,e,i,o,s,a,n,e.traceId):{shouldAnnounce:!1},this.setAriaStatuses=e=>{if(this.ariaStatusStateStore){const t=e.map((e=>{if(!this.isAriaFeatureEnabled(J.j.appearance,e.critique))return;const{critique:t,squiggleKind:i}=e,n=t.textInContext;if(!n)return;const o=i===K.Ah.critique?`${t.categoryTitle} ${n}`:n,r=i===K.Ah.critique?s.Jx.KeepOriginal:s.Jx.AutoCorrectAppearance;return{text:o,id:t.traceId,messageKind:r}}));this.ariaStatusStateStore.addPreservedStatuses(t.filter((e=>!!e)),"assertive")}},this.findSquiggle=e=>{let t;return this.squigglesCache.forEach((i=>{const n=i.get(e);(null==n?void 0:n.length)&&(t=n[0])})),t},this.onShowCallout=(e,t,i,n,o,s,r,a,l)=>{var d,c,u,h,g;if(!this.isVisible)return;if(this.calloutOpenedForCritique===t.traceId)return;this.calloutOpenedForCritique&&this.onCalloutClosed(o,!1,this.calloutOpenedForCritique),this.closeTooltip(),this.setCalloutOpenedForCritique(t.traceId);const p=this.proofedElements.find((e=>e.element===s));let m=null===(d=null==p?void 0:p.graphNode)||void 0===d?void 0:d.element;if(!m&&t.nodeId){const e=this.proofingDom.findNode(t.nodeId);(0,z.l)(e)?m=e.parent.element:e&&(m=e.element)}if(!m)return void(null===(c=this.logger)||void 0===c||c.error(508146700,"Unable to find graph node while showing callout"));const f=null!=e?e:a;if(!f)return void(null===(u=this.logger)||void 0===u||u.error(507562183,"Unable to find target location while showing callout"));const v=e&&(0,S.C)(e,"HTMLElement")?e.ownerDocument:null===(h=this.anchorElement)||void 0===h?void 0:h.ownerDocument;null===(g=this.critiqueCalloutHandler)||void 0===g||g.showCallout({critique:t,issueText:i,setInitialFocus:n,target:f,gapSpace:l,targetDocumentRef:v&&new b.O(v),squiggleKind:r,onDismiss:e=>{this.onCalloutClosed(o,e,t.traceId)},onApplySuggestion:async(e,t)=>{var i,n;this.caretPosition=void 0,await this.critiqueApplicationHandler.applyCritiqueSuggestion(m,s,null!==(i=e.nodeId)&&void 0!==i?i:null==p?void 0:p.id,e,t,(null===(n=this.options)||void 0===n?void 0:n.disableRangeWhenApplyingCritiqueSuggestions)?void 0:a,r)},onApplyFlag:async(e,t,i)=>{await this.critiqueApplicationHandler.applyFlagSuggestion(m,s,e.nodeId,e,t,i)},onIgnoreOnce:e=>{var t,i,n;this.critiqueApplicationHandler.ignoreCritiqueOnce(m,s,null!==(n=null!==(t=e.nodeId)&&void 0!==t?t:null===(i=e.tileId)||void 0===i?void 0:i.nodeId)&&void 0!==n?n:null==p?void 0:p.id,e)},onIgnoreAll:e=>{var t;this.critiqueApplicationHandler.ignoreAllOfCritique(m,s,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onFlagIgnoreOnce:e=>{this.critiqueApplicationHandler.ignoreFlagOnce(m,s,e.nodeId,e)},onFlagIgnoreAll:e=>{this.critiqueApplicationHandler.ignoreAllOfFlag(m,s,e)},onDisableFlag:e=>{this.critiqueApplicationHandler.disableFlagType(m,s,e.nodeId,e)},onShowFeedback:e=>{this.flagShowFeedback(s,e)},onDisableCritiqueType:async e=>{var t;await this.critiqueApplicationHandler.disableCritiqueType(m,s,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onCalloutPositionUpdated:this.onCalloutPositionUpdated})},this.setCalloutOpenedForCritique=e=>{this.calloutOpenedForCritique=e},this.setMouseIndirectlyHoveredElement=e=>{this.mouseIndirectlyHoveredElement=e},this.innerUpdateSquiggles=async()=>{const e=[];if(this.forEachCritique((t=>{if(t.squiggles.length)for(const i of t.squiggles)i.data.isRangeInValidState()||e.push(i)})),e.length){const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.map((e=>e.critique)));if(t.length===e.length)for(let i=0;i<e.length;i++)e[i].data.updateRange(t[i].range)}this.innerUpdateSquigglesWithValidRanges()},this.innerUpdateSquigglesWithValidRanges=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();if(!(this.isVisible&&this.anchorElement&&t&&this.hostElement))return;const i=this.anchorElement.getBoundingClientRect(),n=this.hostElement.getForbiddenRects(t),o=(e,t)=>{var i;return null===(i=this.hostElement)||void 0===i?void 0:i.transformSquiggleRects(e,t,n)},s=[];(0,a.transaction)((()=>{this.forEachCritique((e=>{if(!e.squiggles.length)return;const t=e.squiggles[0];this.updateSquiggle(e.squiggles,t.data.range,t.critique,t.element,t.squiggleKind,i,o,e.elementCritiques,e.key).shouldAnnounce&&s.push(t)}))})),s.length&&this.setAriaStatuses(s)},this.updateSquiggle=(e,t,i,n,s,r,a,l,u)=>{var h,p,m,f,v,_;let y=!0;e?y=null===(m=null===(p=this._visibilityTracker)||void 0===p?void 0:p.isSquiggleVisible(t.startContainer))||void 0===m||m:null===(h=this._visibilityTracker)||void 0===h||h.trackSquiggle(t.startContainer);let I=!1;if(y&&this.anchorElement){const h=X(t,this.anchorElement,a,r,this.scaleTransformValue);if(e&&h.length===e.length)for(let n=0;n<h.length;n+=1){const o=h[n],s=e[n];o.visible===s.isVisible&&(0,g.a)(o,s.data.clientRect)||e[n].updateFromRect(o,t),s.critique.start=i.start,s.stealth!==(null!==(f=s.critique.isStealth)&&void 0!==f&&f)&&(s.stealth=null!==(v=s.critique.isStealth)&&void 0!==v&&v)}else{const r=[];for(const e of h){const a=new c(this.guidGenerator.generate(),n,s,i,e.visible,null!==(_=i.isStealth)&&void 0!==_&&_,new d(t,e,this.zIndex),o.createRef());r.push(a)}r.length>0&&(e||(I=!0),l.set(u,r))}}else if(e)for(const t of e)t.isVisible&&(t.isVisible=!1);return{shouldAnnounce:I}},this.forEachCritique=e=>{this.forEachCritiqueInCache(this.squigglesCache,e)},this.forEachCritiqueInCache=(e,t)=>{const i=new Map;for(const n of e){const e=n[0],o=n[1],s=[];for(const i of o){const n=i[0],r=i[1];r.length>0&&s.push(r[0].critique),t({squiggles:r,key:n,elementCritiques:o,elementId:e})}i.set(e,s)}return i},this.showTooltipAt=(e,t,i,n,o)=>{var s,r,a,l;if(!(null===(s=this.options)||void 0===s?void 0:s.tooltipEnabled)||(null===(r=this.upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(i)))return;if(this.calloutOpenedForCritique||(null===(a=this.editorSettingsState)||void 0===a?void 0:a.currentlyOpen))return void this.closeTooltip();const d=(null==t?void 0:t.ownerDocument)||(null===(l=this.anchorElement)||void 0===l?void 0:l.ownerDocument)||document;let c;if("keyboard"===n)if(o)c=this.getTooltipCoordinatesFromLocalPosition(o);else{const e=d.getSelection();if(!(e&&e.rangeCount>0))return;{const t=e.getRangeAt(0);let i;i=t.collapsed&&t.getClientRects().length?t.getClientRects()[0]:t.getBoundingClientRect(),c={x:i.left,y:i.bottom}}}else{if(!this.lastMousePosition)return;if(this.options.disableSquiggleTooltipOnTextSelection){const e=d.getSelection();if(e&&0!==e.toString().length)return}c=this.getTooltipCoordinatesFromGlobalPoint(this.lastMousePosition)}this.clearTooltipTimeout();const u=(0,ie.m)(d.activeElement);this.tooltipTimeout=window.setTimeout((()=>{var o;if("keyboard"===n){const e=(0,ie.m)(d.activeElement);if(u!==e)return}this.isTooltipShown=!0,null===(o=this.tooltipHandler)||void 0===o||o.showTooltip({squiggleKind:e,critique:i,position:c,origin:null!=t?t:void 0,isAbsolute:void 0,targetDocument:d})}),1e3)},this.getTooltipCoordinatesFromGlobalPoint=e=>({x:e.x+6,y:e.y+16}),this.getTooltipCoordinatesFromLocalPosition=e=>{var t,i,n;const o=null===(t=this.anchorElement)||void 0===t?void 0:t.getBoundingClientRect();return this.getTooltipCoordinatesFromGlobalPoint({x:e.x+(null!==(i=null==o?void 0:o.left)&&void 0!==i?i:0),y:e.y+(null!==(n=null==o?void 0:o.top)&&void 0!==n?n:0)})},this.closeTooltip=()=>{var e;this.clearTooltipTimeout(),this.isTooltipShown&&(this.isTooltipShown=!1,null===(e=this.tooltipHandler)||void 0===e||e.hideTooltip())},this.clearTooltipTimeout=()=>{this.tooltipTimeout&&(window.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=void 0)},this.onSquigglerVisibilityChange=e=>{this.setVisible(e)},this.onSquigglesVisibilityChange=()=>{this.updateSquiggles()},this.isAriaFeatureEnabled=(e,t)=>{var i,n;const o=null!==(n=null===(i=this.options)||void 0===i?void 0:i.ariaFeatures)&&void 0!==n?n:J.j.none;if(e===J.j.appearance||e===J.j.highlight){if(this.isAriaFeatureEnabled(J.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar))return!((null==t?void 0:t.priority)===I.bx.High||(null==t?void 0:t.priority)===I.bx.Medium)}return e===J.j.none?o===e:(o&e)===e},this.restoreCaretOnCalloutClose=()=>{var e,t,i,n,o;if((null===(e=this.options)||void 0===e?void 0:e.restoreCaretPosition)&&void 0!==this.caretPosition){const{node:e,offset:s}=this.caretPosition;if(void 0!==e){const r=((null===(t=this.anchorElement)||void 0===t?void 0:t.ownerDocument)||document).getSelection();if(!r||!e)return;const a=null!==(n=null===(i=e.textContent)||void 0===i?void 0:i.length)&&void 0!==n?n:0,l=Math.min(s,a);try{r.removeAllRanges(),r.setPosition(e,l)}catch(e){null===(o=this.logger)||void 0===o||o.error(539824961,"Error while restoring the IP on callout dismissed",e)}}}},this.checkSquiggleSelection=(e,t)=>{var i,n,o;if(!ge(e)||t.rangeCount<1)return!1;const s=t.getRangeAt(0);let r;r=s.collapsed&&s.getClientRects().length?s.getClientRects()[0]:s.getBoundingClientRect();const a=null!==(o=null===(n=null===(i=e.squiggleRef)||void 0===i?void 0:i.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==o?o:e.data.range.getBoundingClientRect();return!(a.left>r.right||a.right<r.left||a.top>r.bottom||a.bottom<r.top)},this.onCalloutClosed=(e,t,i)=>{e(),this.calloutOpenedForCritique===i&&this.setCalloutOpenedForCritique(void 0),!1===t?this.caretPosition=void 0:this.restoreCaretOnCalloutClose()},this.getAriaStatusString=e=>{const t=e.data.range.toString();return e.squiggleKind===K.Ah.critique?`${e.critique.categoryTitle} ${t}`:t},this.closeCalloutCallback=e=>{var t;e&&this.calloutOpenedForCritique===e&&(null===(t=this.critiqueCalloutHandler)||void 0===t||t.hideCallout())},this.getSquiggleProps=e=>{const t=this.anchorElement;return t?e.map((e=>{var i,n,o,s;const r=Object.assign(Object.assign({},e),{isHighlighted:!1,isCaretOver:!1,isMouseOver:!1,isCalloutOpened:!1,useSvgUnderline:(null===(i=this.options)||void 0===i?void 0:i.squiggleStyleType)===T.N.SVG,role:this.isAriaFeatureEnabled(J.j.none)?"status":"none presentation",ariaLive:this.isAriaFeatureEnabled(J.j.none)?"assertive":"off",ariaLabel:this.isAriaFeatureEnabled(J.j.highlight,e.critique)?this.getAriaStatusString(e):"",describedBy:$.y,anchor:t,onCallOut:this.onShowCallout,closeCallout:this.closeCalloutCallback,showTooltip:this.showTooltipAt,closeTooltip:this.closeTooltip});return r.disableCalloutOnDoubleClick=(null===(n=this.options)||void 0===n?void 0:n.disableCalloutOnDoubleClick)&&(null===(o=this.hostElement)||void 0===o?void 0:o.disableCalloutOnDoubleClick),(0,K.kI)(e.squiggleKind)&&this.autoCorrectionCache?Object.assign(Object.assign({},r),{squiggleKind:e.squiggleKind,initializationProgress:this.autoCorrectionCache.getSquiggleInitializationProgress(e.critique.traceId),setInitializationProgress:this.autoCorrectionCache.setInitializationProgress,openCalloutOnHover:!(!0===(null===(s=this.options)||void 0===s?void 0:s.disableOpenAutoCorrectCalloutOnHover))}):Object.assign(Object.assign({},r),{squiggleKind:K.Ah.critique})})):[]};const{anchorElement:ue,anchorId:he,proofedItem:pe,critiqueCalloutHandler:me,tooltipHandler:fe,options:ve}=e;let _e;this.critiqueCalloutHandler=me,this.tooltipHandler=fe,this.id=he,this.options=ve,this.ariaStatusStateStore=(null==ve?void 0:ve.ariaFeatures)?F:void 0,this.anchorElement=ue,this.proofedElements.push(pe),this.targetWindowRef=new b.O((0,S.e)(this.anchorElement)),this.critiqueRangeBuilder=new p.$(this.tileContent,this.proofingDom,this._tileNodeTraverser),this.safeWindow=new E.c(f),this.critiqueApplicationHandler=new h.n(this._hostEmitters,this.tileContent,this.critiqueRangeBuilder,this.proofingDom,this.safeWindow,this._disableCritiqueHandler,this.logger,this.critiqueStore,this.applyCritiqueSuggestionHandler,this.applyFlagHandler,this.wordDictionary,this.editorSettingsManager,this._formElementAutoCorrectionCache),this.guidGenerator=new N.L,this.squigglerEventManager=new Z.pT,this.autoCorrectionCache=new r.Qr;const ye=()=>_e||(_e=getComputedStyle(ue));this.hostElement=oe(ue,(()=>ye().position),null!==(te=null==ve?void 0:ve.edgeCases)&&void 0!==te?te:[],pe,!1),(null===(ne=this.hostElement.element)||void 0===ne?void 0:ne.parentElement)===this.anchorElement&&(this.anchorElement.firstElementChild===this.hostElement.element?this.top=0:this.top=-1*this.anchorElement.getBoundingClientRect().height),this.zIndex=this.hostElement.zIndex?Y(this.hostElement.zIndex.toString()):Y(ye().zIndex),this.parentToRenderTo=this.hostElement.element,this._visibilityTracker=null!==(re=null==ve?void 0:ve.visibilityTracker)&&void 0!==re?re:Q.Y,this.isVisible=this._visibilityTracker===Q.Y,this._visibilityTracker.connect({trackSquiggler:!0,trackSquiggles:null===(le=null===(ae=this.options)||void 0===ae?void 0:ae.visibilityTrackerShouldTrackSquiggles)||void 0===le||le,anchorElement:ue,onSquigglerVisibilityChange:this.onSquigglerVisibilityChange,onSquigglesVisibilityChange:this.onSquigglesVisibilityChange}),(null===(de=this.options)||void 0===de?void 0:de.mutationObserverBasedRelativePosition)&&(this.recalculateRelativePosition(),this._relativePositionMutationObserver=new MutationObserver((e=>this.recalculateRelativePosition())),this._relativePositionMutationObserver.observe(this.parentToRenderTo,{attributeFilter:["class","style"]})),(null==ve?void 0:ve.throttleUpdates)&&(this.throttledUpdateSquiggles=(0,x.IS)(this.safeWindow,this.targetWindowRef,this.innerUpdateSquiggles,16,"After"),this.throttledUpdateRanges=(0,x.IS)(this.safeWindow,this.targetWindowRef,this.updateRangesImmediately,16,"After")),this.autoCorrectDisabledLanguages=null!==(ce=null==ve?void 0:ve.autoCorrectDisabledLanguages)&&void 0!==ce?ce:[],this.hostEmitter.on(y.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),(0,l.Gn)(this)}get squigglesToRender(){const e=[];let t=!0;return this.forEachCritique((i=>{t&&i.squiggles.length>0&&!(0,K.kI)(i.squiggles[0].squiggleKind)&&(t=!1);const n=i.squiggles.filter((e=>{var t;return e.isVisible&&this.anchorElement&&(null===(t=this.hostElement)||void 0===t?void 0:t.shouldRenderSquiggle(e.data.range.startContainer,this.anchorElement))})),o=this.getSquiggleProps(n);e.push(...o)})),this.isAutoCorrectionOnly=t,e}get isRelativePositionEnabled(){return this.isRelativePositionEnabledValue?this.isRelativePositionEnabledValue:this.calculateRelativePosition()}calculateRelativePosition(){if(this.parentToRenderTo){return"static"===(""!==this.parentToRenderTo.style.position?this.parentToRenderTo.style.position:getComputedStyle(this.parentToRenderTo).position)}return!1}get isEmpty(){return 0===this.proofedElements.length}get theme(){return this._squiggleThemeStore}get squiggleStyleType(){var e;return null===(e=this.options)||void 0===e?void 0:e.squiggleStyleType}get reactOnComponentUpdate(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.reactOnComponentUpdate)&&void 0!==t&&t}get ariaLineNavUpdatesEnabled(){return this.isAriaFeatureEnabled(J.j.lineNavigation)}setSquigglerRef(e){this._squigglerElement=e}checkProofingElementsPosition(){let e=this.proofedElementDomRects.length!==this.proofedElements.length;const t=[];return this.proofedElements.forEach(((i,n)=>{const o=i.element.getBoundingClientRect();t.push(o);const s=this.proofedElementDomRects[n],r=!s||!(o.x===s.x&&o.y===s.y&&o.width===s.width&&o.height===s.height);e=e||r})),e&&(this.proofedElementDomRects=t),e}updatePosition(e){var t,i,n,o,s;if(e){if(this._squigglerElement&&this.anchorElement){if((null===(i=null===(t=this.hostElement)||void 0===t?void 0:t.element)||void 0===i?void 0:i.parentElement)===this.anchorElement&&this.anchorElement.firstElementChild===this.hostElement.element&&0===this.top&&0===this.left)return!1;let e=!1;const r=this._squigglerElement.getBoundingClientRect(),a=this.anchorElement.getBoundingClientRect(),l=a.top-r.top-this.top,d=a.left-r.left-this.left;return Math.abs(l)>(null!==(n=this.diffPrecision)&&void 0!==n?n:.01)&&(this.top+=l,e=!0),Math.abs(d)>(null!==(o=this.diffPrecision)&&void 0!==o?o:.01)&&(this.left+=d,e=!0),!e&&(null===(s=this.options)||void 0===s?void 0:s.trackProofingElementsPositionEnabled)&&(e=this.checkProofingElementsPosition()),e}}else if(this.anchorElement)if(this.anchorElement===this.parentToRenderTo)if(this.anchorElement===this.parentToRenderTo&&["body","html"].includes(this.anchorElement.nodeName.toLowerCase())){const e=function(e){const t=getComputedStyle(e),i=te(t.marginTop);return{x:te(t.marginLeft),y:i}}(this.anchorElement);this.left=this.anchorElement.offsetLeft+e.x,this.top=this.anchorElement.offsetTop+e.y}else this.left=0,this.top=0;else this.left=this.anchorElement.offsetLeft,this.top=this.anchorElement.offsetTop;return!1}dispose(){var e,t,i;this.clearUndoCardTimeout(),this.anchorElement&&(this.squigglesCache.clear(),null===(e=this._visibilityTracker)||void 0===e||e.disconnect(),this._visibilityTracker=void 0,null===(t=this._relativePositionMutationObserver)||void 0===t||t.disconnect(),this._relativePositionMutationObserver=void 0,this.proofedElements=[],this.anchorElement=void 0,this.parentToRenderTo=void 0,this.hostElement=void 0,this._squigglerElement=void 0,this.targetWindowRef=void 0,this.throttledUpdateSquiggles=void 0,this.throttledUpdateRanges=void 0,this.hostEmitter.off(y.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),(this.caretHoveredCritiqueId||this.mouseHoveredCritiqueId)&&(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle()),this.calloutOpenedForCritique&&(null===(i=this.critiqueCalloutHandler)||void 0===i||i.hideCallout(),this.setCalloutOpenedForCritique(void 0)))}determineValidSquiggles(e){var t,i,n,o,s,r,a,l,d;const c=[];for(const u of e){if(!u.range)continue;const e=u.range.commonAncestorContainer.nodeType===Node.TEXT_NODE?u.range.commonAncestorContainer.parentElement:u.range.commonAncestorContainer;let h=!0;("a"===(null==e?void 0:e.nodeName.toLowerCase())||!0===(null===(n=null===(i=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.squigglerSettings)||void 0===i?void 0:i.checkSquigglePositionValidity)||void 0===n?void 0:n.call(i,u.critique,u.range))||(null===(r=null===(s=null===(o=this.hostSettings.serviceSettings)||void 0===o?void 0:o.squigglerSettings)||void 0===s?void 0:s.invalidSquiggleParentSelectors)||void 0===r?void 0:r.some((t=>null==e?void 0:e.closest(t)))))&&(h=!1);const g=[...null!==(d=null===(l=null===(a=this.hostSettings.serviceSettings)||void 0===a?void 0:a.squigglerSettings)||void 0===l?void 0:l.invalidSquiggleSelectors)&&void 0!==d?d:[],".ms-prediction","a"];let p=u.range.startContainer;if(g.some((e=>{var t;return(0,S.C)(p,"HTMLElement")&&p.closest(e)||(null===(t=null==p?void 0:p.parentElement)||void 0===t?void 0:t.closest(e))})))h=!1;else for(;p=this.getNextNode(u.range.startContainer,!1,u.range.endContainer);){g.some((e=>{var t;return(0,S.C)(p,"HTMLElement")&&p.closest(e)||(null===(t=null==p?void 0:p.parentElement)||void 0===t?void 0:t.closest(e))}))&&(h=!1);break}h&&c.push(u)}return c}getNextNode(e,t,i){var n;if(i!==e){if(e.firstChild&&!t)return e.firstChild;if(e.parentNode)return null!==(n=e.nextSibling)&&void 0!==n?n:this.getNextNode(e.parentNode,!0,i)}}enableAutoCorrectionForLanguages(e=[]){return 0===this.autoCorrectDisabledLanguages.length||e.some((e=>!this.autoCorrectDisabledLanguages.includes(e)))}};function ge(e){return!e.squiggleRef||!!e.squiggleRef.current}(0,n.__decorate)([a.observable],he.prototype,"squigglesCache",void 0),(0,n.__decorate)([a.observable],he.prototype,"calloutOpenedForCritique",void 0),(0,n.__decorate)([a.observable],he.prototype,"mouseHoveredElement",void 0),(0,n.__decorate)([a.observable],he.prototype,"mouseIndirectlyHoveredElement",void 0),(0,n.__decorate)([a.observable],he.prototype,"caretHoveredElement",void 0),(0,n.__decorate)([a.observable],he.prototype,"scaleTransformValue",void 0),(0,n.__decorate)([a.observable],he.prototype,"top",void 0),(0,n.__decorate)([a.observable],he.prototype,"left",void 0),(0,n.__decorate)([a.computed],he.prototype,"squigglesToRender",null),(0,n.__decorate)([a.observable],he.prototype,"isVisible",void 0),(0,n.__decorate)([a.action],he.prototype,"removeCritiques",void 0),(0,n.__decorate)([a.action],he.prototype,"setVisible",void 0),(0,n.__decorate)([a.action],he.prototype,"updatePosition",null),(0,n.__decorate)([a.action],he.prototype,"updateSelectionHighlightState",void 0),(0,n.__decorate)([a.action],he.prototype,"updateSelectionHighlightStateFromCoordinates",void 0),(0,n.__decorate)([a.action],he.prototype,"updateCursorHighlightState",void 0),(0,n.__decorate)([a.action],he.prototype,"trivializeCursorSquiggle",void 0),(0,n.__decorate)([a.action],he.prototype,"trivializeCaretSquiggle",void 0),(0,n.__decorate)([a.action],he.prototype,"scaleTransform",void 0),(0,n.__decorate)([a.action],he.prototype,"dispose",null),(0,n.__decorate)([a.action],he.prototype,"updateRangesImmediately",void 0),(0,n.__decorate)([a.action],he.prototype,"setCacheEntry",void 0),(0,n.__decorate)([a.action],he.prototype,"removeCritiquesFromCache",void 0),(0,n.__decorate)([a.action],he.prototype,"removeMissingElements",void 0),(0,n.__decorate)([a.action],he.prototype,"buildSquigglesForCritiques",void 0),(0,n.__decorate)([a.action],he.prototype,"setCalloutOpenedForCritique",void 0),(0,n.__decorate)([a.action],he.prototype,"setMouseIndirectlyHoveredElement",void 0),(0,n.__decorate)([a.action],he.prototype,"innerUpdateSquigglesWithValidRanges",void 0),(0,n.__decorate)([a.action],he.prototype,"updateSquiggle",void 0),he=(0,n.__decorate)([(0,ae._)(),(0,n.__param)(0,(0,le.W)(ue)),(0,n.__param)(1,(0,le.W)(M.d)),(0,n.__param)(2,(0,le.W)(w.f)),(0,n.__param)(3,(0,de.t)(y.zJ)),(0,n.__param)(4,(0,le.W)(y.M5)),(0,n.__param)(5,(0,le.W)(L.n)),(0,n.__param)(6,(0,le.W)(W.w)),(0,n.__param)(7,(0,le.W)(G.Vw)),(0,n.__param)(8,(0,ce.l)()),(0,n.__param)(8,(0,le.W)(D.g)),(0,n.__param)(9,(0,ce.l)()),(0,n.__param)(9,(0,le.W)(j.M)),(0,n.__param)(10,(0,ce.l)()),(0,n.__param)(10,(0,le.W)(B.Ey)),(0,n.__param)(11,(0,ce.l)()),(0,n.__param)(11,(0,le.W)(s.mU)),(0,n.__param)(12,(0,ce.l)()),(0,n.__param)(12,(0,le.W)(F.z)),(0,n.__param)(13,(0,ce.l)()),(0,n.__param)(13,(0,le.W)(U.M)),(0,n.__param)(14,(0,ce.l)()),(0,n.__param)(14,(0,le.W)(H.W)),(0,n.__param)(15,(0,ce.l)()),(0,n.__param)(15,(0,le.W)(m.$)),(0,n.__param)(16,(0,ce.l)()),(0,n.__param)(16,(0,le.W)(f.a)),(0,n.__param)(17,(0,ce.l)()),(0,n.__param)(17,(0,le.W)(v.K)),(0,n.__param)(18,(0,ce.l)()),(0,n.__param)(18,(0,le.W)(V.s)),(0,n.__param)(19,(0,ce.l)()),(0,n.__param)(19,(0,le.W)(A.rI)),(0,n.__param)(20,(0,ce.l)()),(0,n.__param)(20,(0,le.W)(r.PF)),(0,n.__param)(21,(0,ce.l)()),(0,n.__param)(21,(0,le.W)(_.m))],he)},25618:(e,t,i)=>{if(i.d(t,{J:()=>s,Y:()=>r}),2063!=i.j)var n=i(84030);if(2063!=i.j)var o=i(71632);class s{constructor(){this._targetWindow=new n.O(window),this._visibleSquigglesRangeContainers=new Map,this._checkedElements=new Map,this._isAnchorElementVisible=!0,this.connect=e=>{var t;this._targetWindow=new n.O((0,o.e)(e.anchorElement)),(null===(t=this._targetWindow.deref())||void 0===t?void 0:t.IntersectionObserver)&&(this.initSquigglerObserver(e.trackSquiggler,e.anchorElement,e.onSquigglerVisibilityChange),this.initSquigglesObserver(e.trackSquiggles,e.onSquigglesVisibilityChange))},this.disconnect=()=>{this._squigglesVisibilityObserver&&this._squigglesVisibilityObserver.disconnect(),this._squigglerVisibilityObserver&&this._squigglerVisibilityObserver.disconnect(),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.disconnect()},this.trackSquiggle=e=>{var t;let i;if(!this._squigglesVisibilityObserver||!(i=this.getElementFromRange(e)))return;const n=null!==(t=this._visibleSquigglesRangeContainers.get(i))&&void 0!==t?t:{visible:void 0,handles:0};n.handles=n.handles+1,this._visibleSquigglesRangeContainers.set(i,n),this._squigglesVisibilityObserver.observe(i)},this.unTrackSquiggle=e=>{var t;let i;if(!this._squigglesVisibilityObserver||!(i=this.getElementFromRange(e)))return;const n=null!==(t=this._visibleSquigglesRangeContainers.get(i))&&void 0!==t?t:{visible:!1,handles:0};n.handles=n.handles-1,this._visibleSquigglesRangeContainers.set(i,n),n.handles<=0&&this.untrackElement(i)},this.isSquiggleVisible=e=>{const t=this.getElementFromRange(e);if(!t)return;if(!this._visibleSquigglesRangeContainers.has(t))return void this.trackSquiggle(e);const i=this._visibleSquigglesRangeContainers.get(t);return null==i?void 0:i.visible},this.checkImmediateVisibility=async e=>{const t=this.getElementFromRange(e);if(!t)return!1;const i=await this.asyncCheckVisibility(t);return this._checkedElements.delete(t),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.unobserve(t),i},this.asyncCheckVisibility=async e=>new Promise((t=>this.checkVisibility(e,t))),this.asyncVisibilityCallback=e=>{for(const t of e){const e=this._checkedElements.get(t.target);e&&e(t.isIntersecting)}},this.checkVisibility=(e,t)=>{if(!this._asyncVisibilityObserver){const e=this._targetWindow.deref();if(!e)return;this._asyncVisibilityObserver=new e.IntersectionObserver(this.asyncVisibilityCallback,{rootMargin:"0px",threshold:[0,1]})}this._checkedElements.set(e,t),this._asyncVisibilityObserver.observe(e)},this.untrackElement=e=>{var t;null===(t=this._squigglesVisibilityObserver)||void 0===t||t.unobserve(e),this._visibleSquigglesRangeContainers.delete(e)},this.initSquigglerObserver=(e,t,i)=>{if(!e)return;const n=this._targetWindow.deref();n&&(this._squigglerVisibilityObserver=new n.IntersectionObserver((e=>{i(this.getSquigglerIsVisible(e))}),{rootMargin:"0px",threshold:[0,1]}),this._squigglerVisibilityObserver.observe(t))},this.initSquigglesObserver=(e,t)=>{if(!e)return;const i=this._targetWindow.deref();i&&(this._squigglesVisibilityObserver=new i.IntersectionObserver((e=>{t(this.getVisibleSquigglesRangeContainers(e))}),{rootMargin:"0px",threshold:[0,1]}))},this.getVisibleSquigglesRangeContainers=e=>{var t;let i=!1;for(const n of e.values())if(n.target.isConnected){const e=null!==(t=this._visibleSquigglesRangeContainers.get(n.target))&&void 0!==t?t:{visible:!1,handles:1};e.visible=n.isIntersecting,this._visibleSquigglesRangeContainers.set(n.target,e)}else i=!0;return i&&this.removeZombies(),e},this.removeZombies=()=>{for(const e of this._visibleSquigglesRangeContainers.keys())e.isConnected&&this.untrackElement(e)},this.getSquigglerIsVisible=e=>(this._isAnchorElementVisible=e[e.length-1].isIntersecting,this._isAnchorElementVisible),this.getElementFromRange=e=>1===e.nodeType?e:e.parentElement}}const r={connect:()=>null,disconnect:()=>null,isSquiggleVisible:()=>!0,trackSquiggle:()=>null,unTrackSquiggle:()=>null,checkImmediateVisibility:async()=>!0}},13559:(e,t,i)=>{var n;i.d(t,{j:()=>n}),function(e){e[e.none=0]="none",e[e.appearance=1]="appearance",e[e.highlight=2]="highlight",e[e.lineNavigation=4]="lineNavigation",e[e.cssHighlightsAPIAnnouncement=8]="cssHighlightsAPIAnnouncement",e[e.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar=16]="cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar"}(n||(n={}))},7635:(e,t,i)=>{i.d(t,{Rw:()=>n,fD:()=>s,ue:()=>r});var n,o=i(17298);!function(e){e.caret="caret",e.cursor="cursor"}(n||(n={}));const s=(0,o.f)("ISquigglerStateStoreFactory"),r=(0,o.f)("ContentEditableSquigglerComponent")},84601:(e,t,i)=>{i.d(t,{_:()=>n});const n=(0,i(17298).f)("ISquigglePositioningEdgeCases")},92510:(e,t,i)=>{i.d(t,{Vw:()=>n,pz:()=>o});const n=(0,i(17298).f)("ISquiggleThemeStore"),o={highPriorityColors:{tile:"#EB0000",highlight:"#FF30001A"},mediumPriorityColors:{tile:"#3355FF",highlight:"#0055CC1A"},lowPriorityColors:{tile:"#7160E8",highlight:"#7160E833"},autoCorrectColors:{tile:"#38BA62",highlight:"#5BC55240"},ciqFlagColors:{tile:"#0F6CBD",highlight:"#0F6CBD1A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}};o.autoCorrectColors.tile,o.ciqFlagColors.tile,o.headingDetectionColors.tile,o.mediumPriorityColors.tile,o.highPriorityColors.tile,o.lowPriorityColors.tile},23086:(e,t,i)=>{i.d(t,{$K:()=>s,iV:()=>o});var n=i(17298);(0,n.f)("InputControlsV2ProxyOptionsToken");const o=(0,n.f)("IInputControlsStateStoreFactory"),s=(0,n.f)("InputControlsSquigglerComponent")},51921:(e,t,i)=>{if(i.d(t,{Cf:()=>s,dB:()=>r,uE:()=>a}),2063!=i.j)var n=i(71632);if(2063!=i.j)var o=i(83807);const s=e=>{const t={},i=window.getComputedStyle(e),s=(0,n.C)(e,"HTMLInputElement");if(t.whiteSpace="pre-wrap",t.wordWrap="break-word",["position","direction","boxSizing","writingMode","width","height","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize","display","visibility"].forEach((e=>{t[e]=i[e]})),t.paddingBottom="0px"===t.paddingBottom?0:t.paddingBottom,s){const n=i.boxSizing&&"content-box"!==i.boxSizing?parseFloat(i.height)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderTopWidth)-parseFloat(i.borderBottomWidth):i.height;t.lineHeight=Number.isNaN(Number(n))?n:`${n}px`,t.whiteSpace="pre",t.overflow="hidden",t.height=parseFloat(t.height)+3,"search"===e.getAttribute("type")&&(t.direction&&"ltr"!==t.direction?t.paddingLeft=`${parseFloat(i.paddingLeft||0)+15}px`:t.paddingRight=`${parseFloat(i.paddingRight||0)+15}px`)}const r={anchor:e,computedWidth:t.width,computedOverflow:i.overflowY||"",boxSizing:i.boxSizing,isInput:s};let a="auto";if(i.zIndex&&"auto"!==i.zIndex){const e=parseInt(i.zIndex,10);a=isNaN(e)?0:e+1}return{overlay:Object.assign(Object.assign({},t),{left:0,top:0,position:"absolute",pointerEvents:"none",resize:"unset",backgroundColor:"transparent",borderColor:"transparent",WebkitTextFillColor:"none",color:"transparent",willChange:"contents",outline:"none",zIndex:a,lineHeight:Number.isNaN(t.lineHeight)?"unset":t.lineHeight,height:Number.isNaN(t.height)?"unset":t.height,width:Number.isNaN(t.width)?"unset":(0,o.x)(r)}),anchor:t}},r=(e,t,i)=>{var n;if(!t)return{top:0,left:0};const o=null!==(n=i.current)&&void 0!==n?n:{top:0,left:0},s=e.getBoundingClientRect(),r=t.getBoundingClientRect(),a=s.top-r.top,l=s.left-r.left;return{top:Math.abs(a)>0?o.top+a:o.top,left:Math.abs(l)>0?o.left+l:o.left,position:"relative",height:"0px"}},a=(e,t)=>({width:"100%",overflow:"hidden",height:e.scrollHeight-e.clientHeight==0?`calc(100% + ${null!=t?t:"2px"})`:"calc(100% + 2px)"})},83807:(e,t,i)=>{i.d(t,{x:()=>s});const n=2063!=i.j?[]:null;let o;const s=e=>{o||(o=(()=>{const e=window.document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.top="-9999px",e.style.overflow="scroll",e.style.position="absolute",window.document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return window.document.body.removeChild(e),t})());const t=n.find((e=>{var t;return!!(null===(t=e.search)||void 0===t?void 0:t.test(window.location.href))}));if(!(null==t?void 0:t.getWidth)){const t=!e.isInput&&"hidden"!==e.computedOverflow&&e.anchor.scrollHeight-e.anchor.clientHeight&&"content-box"!==e.boxSizing&&!navigator.platform.startsWith("mac"),i=Number.parseFloat(e.computedWidth);return t?i-o:e.computedWidth}return t.getWidth(e)}},252:(e,t,i)=>{if(i.d(t,{G:()=>r}),2063!=i.j)var n=i(98647);if(2063!=i.j)var o=i(68559);var s=i(8520);const r=e=>{const t=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1);s.useEffect((()=>{const t=new n.J(e.anchor);return t.addListener("click",(()=>{var t;e.isMouseOver&&!e.calloutOpened&&(null===(t=e.onClick)||void 0===t||t.call(e))})),()=>{t.removeAllListeners()}}),[e.calloutOpened,e.critique,e.isMouseOver,e.anchor,e.onClick]);const i=i=>{var n,o,s;const r=i;e.isCaretOver&&(null===(n=e.openCalloutPredicate)||void 0===n?void 0:n.call(e,r))&&!e.calloutOpened?(t(i),"keyup"===r.type&&(null===(o=e.onKeyboardEvent)||void 0===o||o.call(e))):"Escape"===r.key&&"keyup"===r.type&&(null===(s=e.onEscapePress)||void 0===s||s.call(e))};return s.useEffect((()=>{if(e.isCaretOver||e.isMouseOver){const o=new n.J(e.anchor);return o.addListener("keyup",i),o.addListener("focus",t),o.addListener("blur",t),o.addListener("keydown",i),()=>{o.removeAllListeners()}}}),[e.isCaretOver,e.isMouseOver,e.calloutOpened,e.critique,e.anchor,e.openCalloutPredicate,e.onKeyboardEvent,e.onEscapePress]),s.createElement("span",{ref:e.squiggleRef,id:e.id,role:e.role,className:e.className,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,style:Object.assign({},e.styleOverrides)},s.createElement("span",{"aria-hidden":"true"},e.data.text),e.useSvgUnderline&&s.createElement(o.a,{width:"100%",left:0,patternName:e.patternName,styleOverrides:e.styleOverrides}))}},87324:(e,t,i)=>{i.d(t,{U:()=>h});var n=i(23182);const o=(0,i(17298).f)("ISquiggleThemeFactory");var s=i(19728),r=i(37814),a=i(92510),l=i(29906),d=i(27603),c=i(83010);const u=e=>`url("data:image/svg+xml,${encodeURIComponent(e.trim())}")`;let h=class{constructor(e){this._grammarTile="",this._grammarTileBorder="",this._insightTile="",this._insightTileBorder="",this._spellingTile="",this._spellingTileBorder="",this._autoCorrectTile="",this._autoCorrectBorder="",this._ciqFlagTile="",this._ciqFlagBorder="",this._headingDetectionTile="",this._headingDetectionBorder="",this.setSquiggleTheme=e=>{this._theme={highPriorityColors:e.highPriorityColors||this._theme.highPriorityColors,mediumPriorityColors:e.mediumPriorityColors||this._theme.mediumPriorityColors,lowPriorityColors:e.lowPriorityColors||this._theme.lowPriorityColors,autoCorrectColors:e.autoCorrectColors||this._theme.autoCorrectColors,ciqFlagColors:e.ciqFlagColors||this._theme.ciqFlagColors,headingDetectionColors:e.headingDetectionColors||this._theme.headingDetectionColors},this.setGrammarTiles(this._theme),this.setInsightTiles(this._theme),this.setSpellingTiles(this._theme),this.setAutoCorrectTiles(this._theme),this.setCiqFlagTiles(this._theme),this.setHeadingDetectionTiles(this._theme)},this.setGrammarTiles=e=>{this._grammarTile=u(`\n      <svg width="5px" height="3px" viewBox="0 0 5 3" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>grammar_double_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="grammar_double_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n            <path d="M0,2.5 L5,2.5" id="Line-2-Copy-11"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._grammarTileBorder=u(`\n    <svg width="15px" height="9px" viewBox="0 0 15 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n      <title>grammar_double_line</title>\n      <desc>Created with Sketch.</desc>\n      <g id="grammar_double_line" stroke="none" stroke-width="3" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n        <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n          <path d="M0,1.5 L15,1.5" id="Line-2-Copy-10"></path>\n          <path d="M0,7.5 L15,7.5" id="Line-2-Copy-11"></path>\n        </g>\n      </g>\n    </svg>\n  `)},this.setInsightTiles=e=>{this._insightTile=u(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._insightTileBorder=u(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this.setSpellingTiles=e=>{this._spellingTile=u(`\n      <svg width="5px" height="4px" viewBox="0 0 5 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="1"></path>\n              <rect id="Rectangle" x="0" y="0" width="5" height="4"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `),this._spellingTileBorder=u(`\n      <svg width="17px" height="9px" viewBox="0 0 17 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M 0,7.5 H 1 C 4.75,7.5 4.75,1.5 8.5,1.5 12.25,1.5 12.25,7.5 16,7.5 H 17" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="3"></path>\n              <rect id="Rectangle" x="0" y="0" width="17" height="9"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `)},this.setAutoCorrectTiles=e=>{this._autoCorrectTile=u(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._autoCorrectBorder=u(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `)},this.setCiqFlagTiles=e=>{this._ciqFlagTile=u(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n          <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `),this._ciqFlagBorder=u(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n            <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `)},this.setHeadingDetectionTiles=e=>{this._headingDetectionTile=u(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._headingDetectionBorder=u(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this._theme=a.pz;const t=null==e?void 0:e();t&&this.setSquiggleTheme(t),(0,r.Gn)(this)}get theme(){return this._theme}get grammarTile(){return this._grammarTile||this.setGrammarTiles(this._theme),this._grammarTile}get grammarTileBorder(){return this._grammarTileBorder||this.setGrammarTiles(this._theme),this._grammarTileBorder}get insightTile(){return this._insightTile||this.setInsightTiles(this._theme),this._insightTile}get insightTileBorder(){return this._insightTileBorder||this.setInsightTiles(this._theme),this._insightTileBorder}get spellingTile(){return this._spellingTile||this.setSpellingTiles(this._theme),this._spellingTile}get spellingTileBorder(){return this._spellingTileBorder||this.setSpellingTiles(this._theme),this._spellingTileBorder}get autoCorrectTile(){return this._autoCorrectTile||this.setAutoCorrectTiles(this._theme),this._autoCorrectTile}get autoCorrectTileBorder(){return this._autoCorrectBorder||this.setAutoCorrectTiles(this._theme),this._autoCorrectBorder}get ciqFlagTile(){return this._ciqFlagTile||this.setCiqFlagTiles(this._theme),this._ciqFlagTile}get ciqFlagTileBorder(){return this._ciqFlagBorder||this.setCiqFlagTiles(this._theme),this._ciqFlagBorder}get headingDetectionTile(){return this._headingDetectionTile||this.setHeadingDetectionTiles(this._theme),this._headingDetectionTile}get headingDetectionTileBorder(){return this._headingDetectionBorder||this.setHeadingDetectionTiles(this._theme),this._headingDetectionBorder}};(0,n.__decorate)([s.observable],h.prototype,"_theme",void 0),(0,n.__decorate)([s.observable],h.prototype,"_grammarTile",void 0),(0,n.__decorate)([s.observable],h.prototype,"_grammarTileBorder",void 0),(0,n.__decorate)([s.observable],h.prototype,"_insightTile",void 0),(0,n.__decorate)([s.observable],h.prototype,"_insightTileBorder",void 0),(0,n.__decorate)([s.observable],h.prototype,"_spellingTile",void 0),(0,n.__decorate)([s.observable],h.prototype,"_spellingTileBorder",void 0),(0,n.__decorate)([s.observable],h.prototype,"_autoCorrectTile",void 0),(0,n.__decorate)([s.observable],h.prototype,"_autoCorrectBorder",void 0),(0,n.__decorate)([s.observable],h.prototype,"_ciqFlagTile",void 0),(0,n.__decorate)([s.observable],h.prototype,"_ciqFlagBorder",void 0),(0,n.__decorate)([s.observable],h.prototype,"_headingDetectionTile",void 0),(0,n.__decorate)([s.observable],h.prototype,"_headingDetectionBorder",void 0),(0,n.__decorate)([s.computed],h.prototype,"theme",null),(0,n.__decorate)([s.computed],h.prototype,"grammarTile",null),(0,n.__decorate)([s.computed],h.prototype,"grammarTileBorder",null),(0,n.__decorate)([s.computed],h.prototype,"insightTile",null),(0,n.__decorate)([s.computed],h.prototype,"insightTileBorder",null),(0,n.__decorate)([s.computed],h.prototype,"spellingTile",null),(0,n.__decorate)([s.computed],h.prototype,"spellingTileBorder",null),(0,n.__decorate)([s.computed],h.prototype,"autoCorrectTile",null),(0,n.__decorate)([s.computed],h.prototype,"autoCorrectTileBorder",null),(0,n.__decorate)([s.computed],h.prototype,"ciqFlagTile",null),(0,n.__decorate)([s.computed],h.prototype,"ciqFlagTileBorder",null),(0,n.__decorate)([s.computed],h.prototype,"headingDetectionTile",null),(0,n.__decorate)([s.computed],h.prototype,"headingDetectionTileBorder",null),(0,n.__decorate)([s.action],h.prototype,"setSquiggleTheme",void 0),h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.l)()),(0,n.__param)(0,(0,c.W)(o))],h)},10062:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(17298).f)("IStyleDefinitions")},83314:(e,t,i)=>{i.d(t,{y:()=>n});const n="ms-squiggle-tooltip"},47:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(17298).f)("ISquiggleTooltipStateStore")},10390:(e,t,i)=>{i.d(t,{F:()=>g});var n=i(8520),o=i(745),s=i(41642),r=i(19685),a=i(98647),l=i(47),d=i(83314),c=i(3817),u=i(75210);const h=(0,o.F5)({state:s.A.on(l.A),localizer:s.A.on(r.H)}),g=(0,c.PA)((()=>{const{state:e,localizer:t}=(0,o.KN)(h),{styles:i,fontsUrl:s,targetDocumentRef:r}=e,l=n.useCallback((()=>{e.hide()}),[e]),c=n.useCallback((()=>{e.emergencyDismiss("Tooltip dismissed on click.")}),[e]);return n.useEffect((()=>{var e,t;const i=new a.J(r),n=new a.J(null!==(t=null===(e=r.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window);return i.addListener("scroll",l,{capture:!0}),n.addListener("resize",l,{capture:!0}),()=>{i.removeAllListeners(),n.removeAllListeners()}}),[l,r]),n.createElement("div",{style:i.container},s&&n.createElement("link",{rel:"stylesheet",href:s}),n.createElement(u.Ay.div,{style:i.shadowBoundary},(()=>{const{top:i,right:o,left:s,isVisible:r,ariaLabel:a,title:l,text:u,styles:h,isEccOpen:g}=e;return!r||g?n.createElement(n.Fragment,null):n.createElement("div",{role:"status","aria-live":"polite",id:d.y,style:h.shadowRoot},n.createElement("div",{onClick:c,style:Object.assign(Object.assign({},h.root),{top:i,left:s,right:o}),role:"tooltip","aria-label":t.getMessage("combineSentences",[l,a])},n.createElement("div",{"aria-hidden":!0,style:h.tooltipMain},n.createElement("div",{"aria-hidden":!0,style:h.title},l),n.createElement("div",{"aria-hidden":!0,style:h.text},u))))})()))}))},88740:(e,t,i)=>{i.d(t,{X:()=>T});var n=i(23182),o=i(63318),s=i(84030),r=i(14784),a=i(51199),l=i(8628),d=i(19685),c=i(33767),u=i(37053),h=i(28798),g=i(38825),p=i(14253),m=i(31109),f=i(10062),v=i(19728),_=i(29906),y=i(83010),I=i(27603),C=i(96292),S=i(72113),b=i(37814);let T=class{constructor(e,t,i,n,s,r,a,l){this.localizer=e,this.hostSettings=t,this.presentationDomSettings=i,this.logger=n,this.scriptDirectionDetector=s,this.styleDefinitions=r,this.urlFormatter=a,this.inlineSuggestionsRenderer=l,this._position=void 0,this._title=void 0,this._isVisible=!1,this._targetDocumentRef=void 0,this.getTitleCritique=e=>{var t;switch(e.priority){case o.bx.Low:return e.typeId===o.L9.TopicSuggestion?this.localizer.getMessage("ebx_SquiggleTooltipTopicTitle"):this.localizer.getMessage("ebx_SquiggleTooltipRefinementTitle");case o.bx.Medium:return this.localizer.getMessage("ebx_SquiggleTooltipGrammarTitle");case o.bx.High:return this.localizer.getMessage("ebx_SquiggleTooltipSpellingTitle");case o.bx.Informational:return null!==(t=e.tooltipTitle)&&void 0!==t?t:""}},this.getTitleAutocorrect=()=>this.localizer.getMessage("ebx_SquiggleTooltipAutoCorrectTitle"),this.resetTimeout=()=>{this.originStatusCheckTimer&&(window.clearTimeout(this.originStatusCheckTimer),this.originStatusCheckTimer=void 0)},this.checkOriginState=()=>{var e;null===(null===(e=this.origin)||void 0===e?void 0:e.parentElement)?this.emergencyDismiss("Tooltip dismissed on timeout: the origin is orphaned."):this.setOriginStateCheckTimeout()},this.setOriginStateCheckTimeout=()=>{this.originStatusCheckTimer=window.setTimeout(this.checkOriginState,3e3)},(0,b.Gn)(this)}get fontsUrl(){var e;return null===(e=this.urlFormatter)||void 0===e?void 0:e.getUrl(this.presentationDomSettings.fabricFontsDefinitionPath)}get title(){var e;return null!==(e=this._title)&&void 0!==e?e:""}get text(){if((0,C.kI)(this.squiggleKind))return this.localizer.getMessage("ebx_AutoCorrectTooltipText");{const e=(0,S.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipCombinationMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipCombinationAlt":"ebx_SquiggleTooltipCombination");return`${this.localizer.getMessage("ebx_SquiggleTooltipText")} ${e}`}}get ariaLabel(){return(0,C.kI)(this.squiggleKind)?this.localizer.getMessage("ebx_AutocorrectTooltipAriaText"):(0,S.iN)()?this.localizer.getMessage("ebx_SquiggleTooltipAriaTextMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipAriaTextAlt":"ebx_SquiggleTooltipAriaText")}get isVisible(){return this._isVisible}get top(){return this._position?`${this._position.y}px`:"auto"}get left(){if(!this._position||this.scriptDirectionDetector.isRtl())return"auto";return`calc(min(100vw - ${this._position.x+300}px, 0px) + ${this._position.x}px)`}get right(){return this._position&&this.scriptDirectionDetector.isRtl()?`calc(100vw - max(${this._position.x}px, 300px))`:"auto"}get styles(){return this.styleDefinitions.tooltip}get isEccOpen(){var e;return!!(null===(e=this.inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo())}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new s.O(document)}async initialize(){}shutDown(){this.hide()}show(e,t,i,n,o){this.resetTimeout(),this.squiggleKind=e,this._title=(0,C.kI)(this.squiggleKind)?this.getTitleAutocorrect():this.getTitleCritique(t),this._position=i,this._isVisible=!!this.hostSettings.showSquiggleTooltip,this.origin=n;const d=null!=o?o:null==n?void 0:n.ownerDocument;this._targetDocumentRef=d&&new s.O(d),this.setOriginStateCheckTimeout();const c=this.logger.getNewActivity(r.n.SquiggleTooltipShown,a.o.SamplingPolicy.CriticalExperimentation);c&&(c.dataFields.push((0,l.n)("CritiqueTypeId",t.typeId)),c.success=!0,c.endNow())}hide(){this.resetTimeout(),this.origin=void 0,this._targetDocumentRef=void 0,this._isVisible=!1,this._position=void 0,this.squiggleKind=void 0}emergencyDismiss(e){this.logger.warn(545910989,e),this.hide()}};(0,n.__decorate)([v.observable],T.prototype,"_position",void 0),(0,n.__decorate)([v.observable],T.prototype,"_title",void 0),(0,n.__decorate)([v.computed],T.prototype,"title",null),(0,n.__decorate)([v.observable],T.prototype,"_isVisible",void 0),(0,n.__decorate)([v.computed],T.prototype,"isVisible",null),(0,n.__decorate)([v.computed],T.prototype,"top",null),(0,n.__decorate)([v.computed],T.prototype,"left",null),(0,n.__decorate)([v.computed],T.prototype,"right",null),(0,n.__decorate)([v.observable],T.prototype,"_targetDocumentRef",void 0),(0,n.__decorate)([v.computed],T.prototype,"targetDocumentRef",null),(0,n.__decorate)([v.action],T.prototype,"show",null),(0,n.__decorate)([v.action],T.prototype,"hide",null),T=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,y.W)(d.H)),(0,n.__param)(1,(0,y.W)(c.n)),(0,n.__param)(2,(0,y.W)(m.D)),(0,n.__param)(3,(0,y.W)(u.g)),(0,n.__param)(4,(0,y.W)(h.iw)),(0,n.__param)(5,(0,y.W)(f.$)),(0,n.__param)(6,(0,y.W)(g.n)),(0,n.__param)(6,(0,I.l)()),(0,n.__param)(7,(0,I.l)()),(0,n.__param)(7,(0,y.W)(p.V))],T)},26748:(e,t,i)=>{i.d(t,{z:()=>d});var n=i(23182);const o=(0,i(17298).f)("IIconRegistrable");var s=i(29906),r=i(66008),a=i(27603),l=i(55695);let d=class{constructor(e){this.iconGroups=e}async initialize(){const e={};for(const t of this.iconGroups)for(const i of await t.getIcons())e[i.iconName]=i.icon;(0,l.K1)({icons:e})}shutDown(){}};d=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.t)(o)),(0,n.__param)(0,(0,a.l)())],d)},5662:(e,t,i)=>{if(i.d(t,{w:()=>s}),2063!=i.j)var n=i(28853);if(2063!=i.j)var o=i(15275);class s{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918369)}configureRootServices(e){e.bind(n.Th).toDynamicValue((()=>()=>e.getOptional(n.JY)))}}},59238:(e,t,i)=>{if(i.d(t,{E:()=>d}),2063!=i.j)var n=i(31387);if(2063!=i.j)var o=i(28853);if(2063!=i.j)var s=i(53382);if(2063!=i.j)var r=i(58359);if(2063!=i.j)var a=i(15275);if(2063!=i.j)var l=i(34471);class d{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918365)}configureRootServices(e){e.bind(r.i).toValue(n.u),e.bind(o.JY).to(o.yi),e.bind(l.S).toExisting(o.JY),e.bind(s.mU).to(s.XG)}}},68760:(e,t,i)=>{if(i.d(t,{E:()=>c}),2063!=i.j)var n=i(59238);if(2063!=i.j)var o=i(11966);if(2063!=i.j)var s=i(23466);if(2063!=i.j)var r=i(37851);if(2063!=i.j)var a=i(39671);if(2063!=i.j)var l=i(63519);if(2063!=i.j)var d=i(61644);class c{constructor(){this.imports=[a.r,n.E]}configureRootServices(e){e.bind(l.M).to(d.t),e.bind(o.$).to(o.I),e.bind(s.P).to(r.Q)}}},39671:(e,t,i)=>{if(i.d(t,{r:()=>f}),2063!=i.j)var n=i(12934);if(2063!=i.j)var o=i(87388);if(2063!=i.j)var s=i(42007);if(2063!=i.j)var r=i(72602);if(2063!=i.j)var a=i(44698);if(2063!=i.j)var l=i(53124);if(2063!=i.j)var d=i(63519);if(2063!=i.j)var c=i(71975);if(2063!=i.j)var u=i(20246);if(2063!=i.j)var h=i(73893);if(2063!=i.j)var g=i(15275);if(2063!=i.j)var p=i(34471);if(2063!=i.j)var m=i(97050);class f{constructor(){this.imports=[n.v]}get uniqueId(){return(0,g.z)(507918354)}configureRootServices(e){e.bind(d.g).toDynamicValue((e=>()=>e.getOptional(d.M))),e.bind(p.S).to(o.l),e.bind(s.a).to(r.R),e.bind(c.W).to(u.p),e.bind(h.i).to(l.n),e.bind(a.s).to(a.$),e.bind(p.S).to(m.B)}}},58219:(e,t,i)=>{if(i.d(t,{N:()=>I}),2063!=i.j)var n=i(5662);if(2063!=i.j)var o=i(44246);if(2063!=i.j)var s=i(69395);if(2063!=i.j)var r=i(89669);if(2063!=i.j)var a=i(23191);if(2063!=i.j)var l=i(94909);if(2063!=i.j)var d=i(15275);if(2063!=i.j)var c=i(34471);if(2063!=i.j)var u=i(33767);if(2063!=i.j)var h=i(54058);if(2063!=i.j)var g=i(52215);if(2063!=i.j)var p=i(14253);if(2063!=i.j)var m=i(8534);if(2063!=i.j)var f=i(81814);if(2063!=i.j)var v=i(97944);if(2063!=i.j)var _=i(29100);if(2063!=i.j)var y=i(19881);class I{constructor(){this.imports=[o.d,n.w]}get uniqueId(){return(0,d.z)(507918360)}configureRootServices(e){var t,i;e.bind(c.S).to(s.v),e.bind(r.C).to(r.L),e.bind(h.I).to(m.H),e.bind(p.V).to(_.W),e.bind(c.S).toExisting(p.V),e.bind(y.Z).toSelf();(null===(i=null===(t=e.get(u.n).oaSettings)||void 0===t?void 0:t.enableECCForMobileDevice)||void 0===i?void 0:i.enabled)?e.bind(g.Z).to(v.Q):e.bind(g.Z).to(f.g),e.bind(c.S).toExisting(g.Z),e.bind(l.D).to(a.z)}}},54546:(e,t,i)=>{if(i.d(t,{F:()=>l}),2063!=i.j)var n=i(58359);if(2063!=i.j)var o=i(95537);if(2063!=i.j)var s=i(9928);if(2063!=i.j)var r=i(60120);if(2063!=i.j)var a=i(15275);class l{get uniqueId(){return(0,a.z)(507918362)}configureRootServices(e){e.bind(o.S).to(s.F),e.bind(n.i).toValue(r.T)}}},24987:(e,t,i)=>{if(i.d(t,{D:()=>u}),2063!=i.j)var n=i(59238);if(2063!=i.j)var o=i(58359);if(2063!=i.j)var s=i(15275);if(2063!=i.j)var r=i(34471);if(2063!=i.j)var a=i(47);if(2063!=i.j)var l=i(10390);if(2063!=i.j)var d=i(88740);if(2063!=i.j)var c=i(90239);class u{constructor(){this.imports=[n.E,c.f]}get uniqueId(){return(0,s.z)(507918353)}configureRootServices(e){e.bind(a.A).to(d.X),e.bind(r.S).toExisting(a.A),e.bind(o.i).toValue(l.F)}}},90239:(e,t,i)=>{if(i.d(t,{f:()=>u}),2063!=i.j)var n=i(48858);if(2063!=i.j)var o=i(9865);if(2063!=i.j)var s=i(97633);if(2063!=i.j)var r=i(15275);if(2063!=i.j)var a=i(33767);if(2063!=i.j)var l=i(48662);if(2063!=i.j)var d=i(60773);if(2063!=i.j)var c=i(96292);class u{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918356)}configureRootServices(e){e.bind(d.g).toDynamicValue((e=>{const t=e.get(a.n),i=e.get(l.c),r=e.getOptional(s.m);return e=>{switch(e){case c.Ah.critique:return new o.FY(t,i);case c.Ah.autocorrection:case c.Ah.personalizedAutocorrection:return new n.QE(t,i,r);default:throw new Error("Unknown squiggle kind")}}}))}}},31109:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(17298).f)("IPresentationDomSettings")},52928:(e,t,i)=>{i.d(t,{m:()=>o});const n=2063!=i.j?[".ms-ecc-callout",".ms-critique-callout","editor-card","ms-cc-overflow","*[class*='Popover']"]:null;function o(e,t){return!!(e&&"closest"in e&&e.closest((null!=t?t:n).join(", ")))}},75499:(e,t,i)=>{function n(e){if(!e)return[];const t=[];for(const i of e.stores){const e=i.getCritiques();e.sort(((e,t)=>e.start-t.start));for(const n of e){const e={critique:n,store:i};t.push(e)}}return t}i.d(t,{v:()=>n})},35482:(e,t,i)=>{if(i.d(t,{wn:()=>a}),2063!=i.j)var n=i(55695);if(2063!=i.j)var o=i(71632);const s='style[data-merge-styles="true"], style[data-load-themed-styles="true"], style#ms-prediction-style';function r(e,t,i){var n,o;for(const s of e){if(!(s.dataset.bindId?t.head.querySelector(`style[data-bind-id='${s.dataset.bindId}']`):null)&&(null===(n=s.sheet)||void 0===n?void 0:n.cssRules.length)){const e=t.createElement("style");Array.from(s.attributes).forEach((t=>{t.nodeValue&&e.setAttribute(t.nodeName,t.nodeValue)}));const n=s.dataset.bindId||i.generate();s.dataset.bindId=n,e.dataset.bindId=n,t.head.appendChild(e);for(let t=0;t<s.sheet.cssRules.length;t++){const i=s.sheet.cssRules.item(t);i&&(null===(o=e.sheet)||void 0===o||o.insertRule(i.cssText,t))}}}}function a(e,t,i=s,a=document){r(Array.from(a.querySelectorAll(i)),e,t);const l=new MutationObserver((n=>{const s=[],l=Array.from(a.querySelectorAll(i));for(const e of n){const t=Array.from(e.addedNodes).filter((e=>(0,o.C)(e,"HTMLStyleElement")));for(const e of t){const t=l.find((t=>t.isSameNode(e)));t&&s.push(t)}}s.length&&r(s,e,t)}));l.observe(a.head,{childList:!0,subtree:!0});const d=n.nr.getInstance().onInsertRule((()=>{!function(e,t){var i,n;if(e.length)for(const o of e){const e=t.head.querySelector(`style[data-bind-id="${o.dataset.bindId}"]`);if((null===(i=o.sheet)||void 0===i?void 0:i.cssRules.length)&&(null===(n=null==e?void 0:e.sheet)||void 0===n?void 0:n.cssRules.length))for(let t=e.sheet.cssRules.length;t<o.sheet.cssRules.length;t++){const i=o.sheet.cssRules.item(t);i&&e.sheet.insertRule(i.cssText,t)}}}(Array.from(a.querySelectorAll("style[data-bind-id]")),e)}));return()=>{l.disconnect(),d()}}},71187:(e,t,i)=>{if(i.d(t,{WH:()=>r}),2063!=i.j)var n=i(55695);const o='style[data-merge-styles="true"], style[data-make-styles-bucket], style[data-load-themed-styles="true"], style#ms-prediction-style';function s(e,t,i,n){var o,s,r,a;const l=null!=n?n:Array.from(e.querySelectorAll(t)),d=Array.from(i.querySelectorAll(t));for(const e of d)(null===(o=e.originalElement)||void 0===o?void 0:o.isConnected)||(e.originalElement=void 0,e.remove());for(const e of l)if(null===(s=e.sheet)||void 0===s?void 0:s.cssRules.length){const t=d.find((t=>t.originalElement===e));if(null===(r=null==t?void 0:t.sheet)||void 0===r?void 0:r.cssRules.length)for(let i=t.sheet.cssRules.length;i<e.sheet.cssRules.length;i++){const n=e.sheet.cssRules.item(i);n&&t.sheet.insertRule(n.cssText,i)}else{t&&(t.originalElement=void 0,t.remove());const n=i.ownerDocument.createElement("style");n.originalElement=e;for(const t of Array.from(e.attributes))t.nodeValue&&n.setAttribute(t.nodeName,t.nodeValue);i.appendChild(n);for(let t=0;t<e.sheet.cssRules.length;t++){const i=e.sheet.cssRules.item(t);i&&(null===(a=n.sheet)||void 0===a||a.insertRule(i.cssText,t))}}}}function r(e,t=o,i=document){s(i,t,e);const r=new MutationObserver((n=>{const o=[];for(const e of n)o.push(...Array.from(e.addedNodes).concat(Array.from(e.removedNodes)).concat(Array.from([e.target])).map((e=>{var t;return"STYLE"===e.nodeName?e:"STYLE"===(null===(t=e.parentElement)||void 0===t?void 0:t.nodeName)?e.parentElement:void 0})).filter((e=>!!e)));o.length&&s(i,t,e,o)})),a=n.nr.getInstance().onInsertRule((()=>{s(i,t,e)}));return r.observe(i.head,{childList:!0,subtree:!0,attributes:!0}),()=>{a(),r.disconnect();const i=Array.from(e.querySelectorAll(t));for(const e of i)e.originalElement&&(e.originalElement=void 0,e.remove());for(const t of Array.from(e.childNodes))t.originalElement&&(t.originalElement=void 0,t.remove())}}},30950:(e,t,i)=>{i.d(t,{S:()=>n});const n=({topicIds:e,topicNames:t,highlightedText:i,hostMetadata:n,requestId:o,source:s,traceId:r})=>{const a=`&body=${encodeURIComponent(`Tell us about your experience with this topic suggestion. Was the suggestion accurate or helpful?\n    \n\n\n\nEngineering notes:\n_______________________________\n\n    TopicIds: ${e}\n\n    TopicNames: ${t}\n\n    HighlightedText: ${i}\n\n    HostMetadata: ${n}\n\n    KMAPIRequestId: ${o}\n\n    Source: ${s}\n\n    TraceId: ${r}\n_______________________________\n`)}`;return"mailto:projecthedleyfeedback@service.microsoft.com?subject=Viva Topics Editor Suggestion Feedback"+encodeURIComponent(": "+i)+a}},72602:(e,t,i)=>{i.d(t,{R:()=>s});var n=i(23182),o=i(29906);let s=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map}handleApplyCritiqueSuggestion(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyCritiqueSuggestion(e,t,i,n){const o=this._applyHandlerMap.get(t.typeId);return!!o&&o(e,t,i,n)}handleIgnoreCritiqueSuggestion(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreCritiqueSuggestion(e,t){const i=this._ignoreHandlerMap.get(t.typeId);return!!i&&i(e,t)}};s=(0,n.__decorate)([(0,o._)()],s)},32272:(e,t,i)=>{i.d(t,{r:()=>s});var n=i(23182),o=i(29906);let s=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map,this._ignoreAllHandlerMap=new Map,this._disableHandlerMap=new Map}handleApplyFlag(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyFlag(e,t,i,n){const o=this._applyHandlerMap.get(t.typeId);return!!o&&o(e,t,i,n)}handleIgnoreFlag(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreFlag(e,t){const i=this._ignoreHandlerMap.get(t.typeId);return!!i&&i(e,t)}handleIgnoreAllOfFlag(e,t){return this._ignoreAllHandlerMap.set(e,t),()=>this._ignoreAllHandlerMap.delete(e)}onIgnoreAllOfFlag(e,t){const i=this._ignoreAllHandlerMap.get(t.typeId);return!!i&&i(e,t)}handleDisableFlag(e,t){return this._disableHandlerMap.set(e,t),()=>this._disableHandlerMap.delete(e)}onDisableFlag(e,t){const i=this._disableHandlerMap.get(t.typeId);return!!i&&i(e,t)}};s=(0,n.__decorate)([(0,o._)()],s)},87388:(e,t,i)=>{i.d(t,{l:()=>p});var n=i(23182),o=i(99724),s=i(36915),r=i(63318),a=i(37053),l=i(58550),d=i(33727),c=i(29906),u=i(66008),h=i(27603),g=i(83010);let p=class{constructor(e,t,i,n){this._hostEmitters=e,this._critiqueStore=t,this._proofingDom=i,this._logger=n,this.initialize=async()=>{for(const e of this._hostEmitters)e.on(o.pD.hostModelCritiqueAction,this.onHostModelCritiqueActionEvent)},this.shutDown=()=>{},this.onHostModelCritiqueActionEvent=e=>{if(!e.message.critiqueInfo.nodeId)return void this._logger.log(523871251,s.q.Error,`IHostModelCritiqueAction message: Received undefined args. ActionType:${e.message.actionType}`);let t=this._proofingDom.findTileNode(e.message.critiqueInfo.nodeId);if(!t){const i=this._proofingDom.findParagraphNode(e.message.critiqueInfo.nodeId);if(!(null==i?void 0:i.parent))return void this._logger.log(523896789,s.q.Error,"CritiqueActionEventHandler: Received event args with unknown node id.");t=i.parent}if(!t.critiqueAction(e.message.actionType,e.message.critiqueInfo.offset))if(this._critiqueStore)switch(e.message.actionType){case r.$w.IgnoreOnce:case r.$w.ApplySuggestion:this._critiqueStore.removeCritique(e.message.critiqueInfo.traceId,e.message.critiqueInfo.nodeId);break;case r.$w.DisableCritiqueType:break;case r.$w.IgnoreAll:if(!e.message.critiqueInfo.typeId){this._logger.log(507574115,s.q.Error,"critique is missing typeId");break}if(!e.message.critiqueInfo.textInContext){this._logger.log(507574098,s.q.Error,"critique is missing textInContext");break}this._critiqueStore.removeAllCritiquesOfTypeAndText(e.message.critiqueInfo.typeId,e.message.critiqueInfo.textInContext);break;default:this._logger.log(523896792,s.q.Error,"CritiqueActionEventHandler: Received unexpected actionType.")}else this._logger.log(523896791,s.q.Error,"CritiqueActionEventHandler: No critique store is available.")}}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.t)(o.zJ)),(0,n.__param)(1,(0,h.l)()),(0,n.__param)(1,(0,g.W)(l.$)),(0,n.__param)(2,(0,g.W)(d.w)),(0,n.__param)(3,(0,g.W)(a.g))],p)},20179:(e,t,i)=>{i.d(t,{A:()=>h});var n=i(23182),o=i(33727),s=i(14945),r=i(70848),a=i(18349),l=i(29906),d=i(83010),c=i(27603),u=i(8498);let h=class{constructor(e,t,i){this._proofingDom=e,this._proofingEmitter=t,this._sessionTelemetryTracker=i}dispatchCritiques(e,t,i=s.G.NewData){var n;const o=this._proofingDom.findTileNode(t);o&&(this._proofingEmitter.emit("squiggleDataEvent",{messageType:i,data:{critiquesToElementsMap:[{elementId:t,element:o.element,critiques:e.map(r.OE)}]}}),null===(n=this._sessionTelemetryTracker)||void 0===n||n.update(e,t))}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(o.w)),(0,n.__param)(1,(0,d.W)(a.o)),(0,n.__param)(2,(0,c.l)()),(0,n.__param)(2,(0,d.W)(u.H))],h)},44698:(e,t,i)=>{i.d(t,{$:()=>f,s:()=>m});var n=i(23182),o=i(81174),s=i(71389),r=i(5698),a=i(20831),l=i(78426),d=i(33727),c=i(38583),u=i(17298),h=i(29906),g=i(83010),p=i(27603);const m=(0,u.f)("ICritiqueRangeBuilder");let f=class{constructor(e,t,i){this._tileContent=e,this._proofingDom=t,this._tileNodeTraverser=i,this.getCritiqueRangeAcrossTileNodes=e=>{const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!t)return Promise.resolve(void 0);let i;return i=e.endNode?this.getParagraphNodeAndOffset(e.endNode.nodeId,e.endNode.end):this.getParagraphNodeAndOffset(e.nodeId,e.length),i?this.getRangeAcrossTileNodes(t.paragraphNode,i.paragraphNode,t.offset,i.offset):Promise.resolve(void 0)},this.getParagraphNodeAndOffset=(e,t)=>{const i=this._proofingDom.findParagraphNode(e);if(i)return{paragraphNode:i,offset:t};const n=this._proofingDom.findTileNode(e);if(!(null==n?void 0:n.children))return;let s;for(const e of n.children)(0,o.l)(e)&&t>=e.element.offset&&t<e.element.offset+e.element.span&&(s=e);return s?{paragraphNode:s,offset:t-s.element.offset}:void 0},this.getRangeAcrossTileNodes=async(e,t,i=0,n=-1)=>{let s=null;s="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let r=null;if(r="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,o.l)(s)&&(0,o.l)(r)){const e=await this._tileContent.getNodeInsertionPosition(s.parent,s.element.offset+i,!0),t=await this._tileContent.getNodeInsertionPosition(r.parent,r.element.offset+(-1===n?r.element.span:n),!1);if(!(null==e?void 0:e.startContainer.ownerDocument)||!(null==t?void 0:t.endContainer.ownerDocument)||e.startContainer.ownerDocument!==t.endContainer.ownerDocument)return;const o=e.startContainer.ownerDocument.createRange();return o.setStart(e.startContainer,e.startOffset),o.setEnd(t.endContainer,t.endOffset),o}},this.ensureNoLeadingOrTrailingWhitespace=e=>{if(e.endNode)return e;const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!(null==t?void 0:t.paragraphNode.element)||!e.nodeId)return e;const i=t.offset-t.paragraphNode.element.offset,n=this._paragraphTextExtractor.getTextBetween(e.nodeId,e.nodeId,i,i+e.length);if(!n)return e;let o=e.start,s=e.length;const r=n.trimStart(),a=n.trimEnd();return n.length!==r.length&&(o+=n.length-r.length,s-=n.length-r.length),n.length!==a.length&&(s-=n.length-a.length),Object.assign(Object.assign({},e),{start:o,length:s})},this._paragraphTextExtractor=new s.o(this._proofingDom,this._tileNodeTraverser)}async getCritiqueRanges(e,t){var i,n,o;const s=new Map;for(const t of e){const e=t.nodeId?this._proofingDom.findNode(t.nodeId):t.tileId?this._proofingDom.findNode(t.tileId.nodeId):null,o=(null==e?void 0:e.nodeType)===r.Z.ParagraphNode?e.parent:(null==e?void 0:e.nodeType)===r.Z.TileNode?e:void 0;if((0,a.$)(o)){const e=null!==(n=null===(i=s.get(o.id))||void 0===i?void 0:i[0])&&void 0!==n?n:[];e.push(t),s.set(o.id,[e,o])}}const l=new Map;for(const[e,i]of s.values()){const n=[],s=[];for(const t of e)if(t.endNode){const e=this._proofingDom.findParagraphNode(t.endNode.nodeId);(null===(o=null==e?void 0:e.parent)||void 0===o?void 0:o.id)!==i.id?s.push(t):n.push(t)}else n.push(t);if(n.length>0){const e=await this._tileContent.getCritiqueRanges(i,t,n.map(this.ensureNoLeadingOrTrailingWhitespace));for(const t of e)l.set(n.find((e=>e.traceId===t.critique.traceId)),t.range)}if(s.length>0)for(const e of s)l.set(e,await this.getCritiqueRangeAcrossTileNodes(this.ensureNoLeadingOrTrailingWhitespace(e)))}return e.map((e=>({critique:e,range:l.get(e)})))}};f=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(l.d)),(0,n.__param)(1,(0,g.W)(d.w)),(0,n.__param)(2,(0,g.W)(c.M)),(0,n.__param)(2,(0,p.l)())],f)},83812:(e,t,i)=>{i.d(t,{U:()=>E});var n=i(23182),o=i(58550),s=i(27999),r=i(14945);var a=i(91430),l=i(63318),d=i(73003);class c extends s.z{constructor(e,t,i){super(),this._settings=e,this._logger=t,this._fre=i,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this._wordBoundaries=new Map,this.removeCritique=(e,t,i)=>{var n,o;const s=null==i?void 0:i(t);if(!s)return void(null===(n=this._logger)||void 0===n||n.error(507900049,"removeCritique - Unable to find tileNode"));const r=this._critiquesByNode.get(s),a=r?this.findCritiqueInCritiques(r,e):void 0;r&&a?(this.removeKnownCritique(a,r,a),this.dispatchCritiquesForNode(s)):null===(o=this._logger)||void 0===o||o.error(507900048,"removeCritique - Unable to find critique on tile")},this.getCritique=(e,t,i)=>{var n;const o=null==i?void 0:i(t);if(!o)return void(null===(n=this._logger)||void 0===n||n.error(507900049,"getCritique - Unable to find tileNode"));const s=this._critiquesByNode.get(o);return s?this.findCritiqueInCritiques(s,e):void 0},this.dispatchCritiquesForNode=e=>{const t=this._critiquesByNode.get(e),i=t?this.getCritiquesToDispatch(t):[];this.publishEvent("dispatchCritiques",{critiques:i,nodeId:e,messageType:r.G.NewData})},this.removeAllCritiquesOfType=e=>{for(const t of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeFromNode(t,e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{for(const i of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeAndTextFromNode(i,e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{const i=this.getCritiques(e);if(!i)return;const n=[];for(const e of i.critiques.values())e.typeId===t&&n.push(e);if(n.length>0){for(const e of n)this.removeSpecifiedCritique(e,i.critiques);this.dispatchCritiquesForNode(i.tileId)}},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,i)=>{const n=this.getCritiques(e);if(!n)return;const o=[];for(const e of n.critiques.values())e.typeId===t&&e.textInContext===i&&o.push(e);if(o.length>0){for(const e of o)this.removeSpecifiedCritique(e,n.critiques);this.dispatchCritiquesForNode(n.tileId)}},this.removeSpecifiedCritique=(e,t)=>{for(const i of t.values())if(i.traceId===e.traceId)return this.removeKnownCritique(e,t,i),!0;return!1},this.removeKnownCritique=(e,t,i)=>{(function(e){return"isFlagCritique"in e})(e)&&e.isIgnored||t.delete(i),this.publishEvent("removeCritiques",{critiques:new Set([i])})},this.getOverlappingCritiques=(e,t)=>{var i;const n=[];let o=1/0,s=!1,r=!1;for(const d of e)d.traceId!==t.traceId&&(0,a.tw)(d,t)&&(o=Math.min(o,d.priority),s=s||d.typeId===l.L9.TopicSuggestion,r=r||null!==(i=d.isIgnored)&&void 0!==i&&i,n.push(d));return{shouldOverrideCritiques:!r&&(t.typeId===l.L9.TopicSuggestion||!s&&o>=t.priority),critiques:n}},this.getCritiquesToDispatch=e=>{var t;const i=Array.from(e.values()).filter((e=>e.isVisible&&!e.isIgnored));return null===(t=this._fre)||void 0===t||t.setFor(i),i},this.findCritiqueInCritiques=(e,t)=>{for(const i of e.values())if(i.traceId===t)return i}}clearNode(e){let t=!1;const i=this._critiquesByNode.get(e);i&&(this._critiquesByNode.delete(e),this._wordBoundaries.delete(e),this.publishEvent("removeCritiques",{critiques:i}),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),t=!0),t&&this.publishEvent("dispatchCritiques",{critiques:[],nodeId:e,messageType:r.G.RemoveData})}resetNode(e){this.clearNode(e),this.updateNode([],e,0)}getAllCritiques(){const e=[];for(const t of this._critiquesByNode.keys()){const i=this.getCritiques(t);i&&e.push(i)}return e}getCritiques(e){var t;const i=this._critiquesByNode.get(e);if(i){return{critiques:i,tileId:e,tileVersion:null!==(t=this._latestNodeVersion.get(e))&&void 0!==t?t:0}}}setWordBoundaries(e,t,i){let n=this._wordBoundaries.get(e);n||(n=new Map,this._wordBoundaries.set(e,n)),n.set(t.id,{offset:t.range.offset,length:t.range.span,boundaries:i})}removeWordBoundariesByPosition(e,t,i){const n=this._wordBoundaries.get(e);if(!n)return;const o=t+i;for(const[e,s]of n)if(s.offset<t){const e=s.offset+s.length-1;e>t&&(s.length-=e-t)}else s.offset>=t&&s.offset+s.length<=o?n.delete(e):(s.offset-=i,s.offset<o&&(s.length-=o-s.offset))}updateNode(e,t,i,n=!1){var s,r;i>=(null!==(s=this._latestNodeVersion.get(t))&&void 0!==s?s:0)&&this._latestNodeVersion.set(t,i);const a=this._critiquesByNode.get(t),l=this._wordBoundaries.get(t);if(a){if(n||(null!==(r=this._settings.enableDispatchCritiquesOnEmptyDiffs)&&void 0!==r?r:e.length>0)){for(const t of e){const e=this.getOverlappingCritiques(a,t.critique);switch(t.critiqueDiffType){case o.K.Add:case o.K.Update:if(e.critiques.length){if(e.shouldOverrideCritiques){for(const t of e.critiques)this.removeSpecifiedCritique(t,a);this.isNotPartialCritique(t.critique,l)&&a.add(t.critique)}}else this.isNotPartialCritique(t.critique,l)&&a.add(t.critique);break;case o.K.Delete:this.removeSpecifiedCritique(t.critique,a);case o.K.Move:}}const i=[];if(i.push(t),c=e,(0,d.A)(c)){const e=function(e,t){const i=[];return i.concat((0,d.o)(e,t)),i}(this._critiquesByNode,!!this._settings.enableStealthSquiggles);for(const t of e)t.nodeId&&i.push(t.nodeId)}for(const e of i)this.dispatchCritiquesForNode(e)}}else this._critiquesByNode.set(t,new Set);var c}isNotPartialCritique(e,t){if(!t||0===t.size)return!0;for(const i of t.values())if(e.start>=i.offset&&e.start<i.offset+i.length){const t=i.offset;for(const n of i.boundaries){const i=n.start+t,o=n.end+t+1,s=o-i;if(e.start>=i&&e.start+e.length<=o&&e.length<s)return!1}return!0}return!0}setAugLoopProcessingHandler(e){}}var u=i(80370);const h=(0,i(17298).f)("ICritiquesFre");var g=i(99724),p=i(33767),m=i(18349),f=i(37053),v=i(5698),_=i(85681),y=i(33727),I=i(24850),C=i(44404),S=i(29906),b=i(83010),T=i(27603);let E=class{constructor(e,t,i,n,o,s,r,a,l){this._critiqueDispatcher=e,this._hostSettings=t,this._upsellStore=i,this._proofingEmitter=n,this._hostEmitter=o,this._proofingDom=s,this._logger=r,this._indicatorStore=a,this._fre=l,this.dispatchCritiquesForNode=e=>{this.augLoopProcessingHandler||this._critiqueStoreCore.dispatchCritiquesForNode(e)},this.removeCritique=(e,t)=>{this._critiqueStoreCore.removeCritique(e,t,this.nodeIdFinder)},this.getCritique=(e,t)=>this._critiqueStoreCore.getCritique(e,t,this.nodeIdFinder),this.nodeIdFinder=e=>{var t;if(!e)return;const i=this._proofingDom.findNode(e);return(null==i?void 0:i.nodeType)===v.Z.TileNode?i.id:(null==i?void 0:i.nodeType)===v.Z.ParagraphNode?null===(t=i.parent)||void 0===t?void 0:t.id:void 0},this.removeAllCritiquesOfType=e=>{this._critiqueStoreCore.removeAllCritiquesOfType(e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndText(e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeFromNode(e,t)},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,i)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndTextFromNode(e,t,i)},this.onDispatchCritiques=e=>{this._critiqueDispatcher.dispatchCritiques(e.critiques,e.nodeId,e.messageType)},this.onRemoveCritiques=e=>{var t;for(const i of e.critiques.values())null===(t=this._upsellStore)||void 0===t||t.removePremiumCritique(i),(0,I.BZ)(this._indicatorStore,i.traceId,i.categoryTitle)},this._critiqueStoreCore=new c(this._hostSettings,this._logger,this._fre),this._critiqueStoreCore.subscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.subscribe("removeCritiques",this.onRemoveCritiques)}get core(){return this._critiqueStoreCore}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",(e=>{if(e.proofingLanguagesChanged&&!this.augLoopProcessingHandler)for(const e of this._proofingDom.tileNodes)this.resetNode(e.id)})),this._hostEmitter.on(g.pD.hostModelTileStateReset,(e=>{this.augLoopProcessingHandler||this.resetNode(e.message)})),this._hostEmitter.on(g.pD.hostModelVisualStateChange,(e=>{e.message.created&&!this.augLoopProcessingHandler&&this.dispatchCritiquesForNode(e.message.tileId)}))}shutDown(){this._proofingEmitter.off("proofingLanguageChanged"),this._hostEmitter.off(g.pD.hostModelTileStateReset),this._hostEmitter.off(g.pD.hostModelVisualStateChange),this._critiqueStoreCore.unsubscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.unsubscribe("removeCritiques",this.onRemoveCritiques)}clearNode(e){this.augLoopProcessingHandler?this.augLoopProcessingHandler.clearNode(e):this._critiqueStoreCore.clearNode(e)}resetNode(e){this.augLoopProcessingHandler||this._critiqueStoreCore.resetNode(e)}getAllCritiques(){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getAllCritiques():this._critiqueStoreCore.getAllCritiques()}getCritiques(e){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getCritiques(e):this._critiqueStoreCore.getCritiques(e)}updateNode(e,t,i,n=!1){this.augLoopProcessingHandler?this.augLoopProcessingHandler.updateNode(e,t,i,n):this._critiqueStoreCore.updateNode(e,t,i,n)}setAugLoopProcessingHandler(e){this.augLoopProcessingHandler=e}};E=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.W)(u.h)),(0,n.__param)(1,(0,b.W)(p.n)),(0,n.__param)(2,(0,T.l)()),(0,n.__param)(2,(0,b.W)(_.Ey)),(0,n.__param)(3,(0,b.W)(m.o)),(0,n.__param)(4,(0,b.W)(g.M5)),(0,n.__param)(5,(0,b.W)(y.w)),(0,n.__param)(6,(0,b.W)(f.g)),(0,n.__param)(7,(0,T.l)()),(0,n.__param)(7,(0,b.W)(C.$)),(0,n.__param)(8,(0,T.l)()),(0,n.__param)(8,(0,b.W)(h))],E)},63654:(e,t,i)=>{i.d(t,{SF:()=>L});var n=i(23182),o=i(74266),s=i(81174),r=i(77238),a=i(33727),l=i(10968),d=i(91430),c=i(37053),u=i(33767),h=i(63526),g=i(22649),p=i(66213),m=i(48662),f=i(63326),v=i(63318),_=i(3661),y=i(968),I=i(66840);class C{constructor(e){this.paragraphNode=e}get id(){return this.paragraphNode.id}get range(){var e,t,i,n,o,s,r;return{offset:null!==(t=null===(e=this.paragraphNode.element)||void 0===e?void 0:e.offset)&&void 0!==t?t:0,span:null!==(n=null===(i=this.paragraphNode.element)||void 0===i?void 0:i.span)&&void 0!==n?n:0,textUnit:null===(o=this.paragraphNode.element)||void 0===o?void 0:o.textUnit,validEndBoundary:null===(s=this.paragraphNode.element)||void 0===s?void 0:s.validEndBoundary,enforcedCompleteTileTextUnit:null===(r=this.paragraphNode.element)||void 0===r?void 0:r.enforcedCompleteTileTextUnit}}}class S{constructor(e={enablePhraseTextUnitClientSide:!0,ignoreNonLatinZeroSquiggles:!0,enableSquigglesOnlyOnWholeWords:!0}){this.settings=e}isValid(e,t,i,n,o){var s,r,a,l;if(!e.nodeId||!t)return!1;const d=new y.a;if(this.settings.enablePhraseTextUnitClientSide&&e.priority!==v.bx.High&&!(0,v.oe)(e.typeId)&&t.range.textUnit!==f.fT.Sentence&&t.range.textUnit!==f.fT.Paragraph)return!1;if(this.settings.ignoreNonLatinZeroSquiggles&&(!e.suggestions.length||0===e.suggestions[0].action)&&(0,I.c)(e.textInContext))return!1;null==o||o(e);let c=e.textInContext;c&&(c=c.replace(/\u00A0/g," "));const u=t.range.offset,h=n(e);if(c!==h)return!1;if((e.priority===v.bx.High||e.priority===v.bx.Informational)&&(void 0===e.endNode||e.endNode.nodeId===t.id)&&this.settings.enableSquigglesOnlyOnWholeWords){const t=i;if(!t)return!1;const n=e.start-u,o=n+e.length,c=o===t.length;let[g,p]=function(e,t,i,n,o){if(!e)return["",0];let s=0;(t===n||t+1===n&&_.Yv(e.charCodeAt(t+1)))&&(s+=1);i===o&&(s+=1);return[e.substring(t,i),s]}(t,null!==(r=null===(s=d.getBackwardBreak(t,n+1))||void 0===s?void 0:s.cp)&&void 0!==r?r:0,null!==(l=null===(a=d.getForwardBreak(t,o-1))||void 0===a?void 0:a.cp)&&void 0!==l?l:o,n,o);if(h&&!c&&""===h[h.length-1]&&(p+=1),_._1(g))return!0;if(_.tF(g))return!0;return p===2}return!0}}var b=i(29906),T=i(83010),E=i(27603),N=i(58550),x=i(97633);function w(e,t){var i;const n=e?t.findParagraphNode(e):null;return{paragraphNode:n,htmlElement:null===(i=null==n?void 0:n.parent)||void 0===i?void 0:i.element}}let L=class{constructor(e,t,i,n,o,s,r,a,l,d,c){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=i,this._hostSettings=n,this._proofingPersistedStore=o,this._userInfoStrategy=s,this._e2eMetric=r,this._featureFlagReader=a,this._proofingDom=l,this._paragraphTextExtractor=d,this._autoCorrectionBroker=c,this._websiteProvedOnce=!1}onEvent(e){var t,i;const{added:n,removedIds:o,source:s,tileId:r,tileVersion:a}=e,{paragraphNode:l}=w(r,this._proofingDom),c=null!==(i=null===(t=null==l?void 0:l.parent)||void 0===t?void 0:t.id)&&void 0!==i?i:r,u=this.onCommonCritiquesRemoved(o,s),h=n.filter((e=>{const t=u.findIndex((t=>(0,d.gS)(e,t.critique)));return!(t>=0)||(u.splice(t,1),!1)}));u.push(...this.onCommonCritiquesAdded(h,r)),u.length>0&&this._critiqueStore.updateNode(u,c,a),this._e2eMetric.commitEntry(`${r}--${a}`)}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,(0,o.Q)(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}onCommonCritiquesAdded(e,t){var i,n;if(0===e.length)return[];const{paragraphNode:o}=w(t,this._proofingDom),r=null!==(n=null===(i=null==o?void 0:o.parent)||void 0===i?void 0:i.id)&&void 0!==n?n:t,a=new S({enablePhraseTextUnitClientSide:this._featureFlagReader.flags.enablePhraseTextUnitClientSide,ignoreNonLatinZeroSquiggles:!!this._hostSettings.ignoreNonLatinZeroSquiggles,enableSquigglesOnlyOnWholeWords:this._featureFlagReader.flags.enableSquigglesOnlyOnWholeWords}),l=this._paragraphTextExtractor.getParagraphText(o),c=function(e,t,i,n,o,s,r,a,l,c,u){if(0===e.length)return[];const h=r.getCritiques(i);if(!h)return[];const g=new Map,p=new Set;for(const e of h.critiques)l(e)&&g.set(e.start,e);const m=[];for(const i of e)if(i&&u.isValid(i,t,n,o,a)){const e=g.get(i.start);if(e&&(0,d.gS)(e,i)){e.annotationId=i.annotationId,m.push({critique:e,critiqueDiffType:N.K.Update}),p.add(i.start);continue}if(!s)for(const e of g.values())(0,d.tw)(e,i)&&m.push({critique:e,critiqueDiffType:N.K.Delete});c.applyFilters([i]),m.push({critique:i,critiqueDiffType:N.K.Add})}if(s)for(const e of g.values())p.has(e.start)||m.push({critique:e,critiqueDiffType:N.K.Delete});return m}(e,null===o?null:new C(o),r,l,(e=>{var t,i;const n=null!==(i=null===(t=null==o?void 0:o.element)||void 0===t?void 0:t.offset)&&void 0!==i?i:0;let s="";return s=void 0===e.endNode?this._paragraphTextExtractor.getTextBetween(o,o,e.start-n,e.start-n+e.length):this._paragraphTextExtractor.getTextBetween(o,e.endNode.nodeId,e.start-n,e.endNode.end),s}),this._featureFlagReader.flags.enableForceClearCritiques,this._critiqueStore,(e=>{(0,s.l)(o)&&(e.start=e.start+o.element.offset)}),(e=>((e,t)=>!!(0,s.l)(t)&&e.nodeId!==t.id&&!(e.start>=t.element.offset+t.element.span||t.element.offset>=e.start+e.length))(e,o)),this._critiqueFilterer,a);return c.length>0&&this.logWebsiteProvedOnce(),c}onCommonCritiquesRemoved(e,t){return function(e,t,i,n){if(0===e.length)return[];const o=i.getAllCritiques().reduce(((e,t)=>{for(const i of t.critiques)e.set(i.annotationId,{critique:i,tileId:t.tileId,tileVersion:t.tileVersion});return e}),new Map),s=[];for(const i of e){const e=o.get(i);if(e){if("Augloop"===t&&(null==n?void 0:n.getHasAutoCorrectionBeenApplied(e.critique)))continue;s.push({critique:e.critique,critiqueDiffType:N.K.Delete})}}return s}(e,t,this._critiqueStore,this._autoCorrectionBroker)}};L=(0,n.__decorate)([(0,b._)(),(0,n.__param)(0,(0,T.W)(N.$)),(0,n.__param)(1,(0,T.W)(r.B)),(0,n.__param)(2,(0,T.W)(c.g)),(0,n.__param)(3,(0,T.W)(u.n)),(0,n.__param)(4,(0,T.W)(h.K)),(0,n.__param)(5,(0,T.W)(g.e)),(0,n.__param)(6,(0,T.W)(p.m)),(0,n.__param)(7,(0,T.W)(m.c)),(0,n.__param)(8,(0,T.W)(a.w)),(0,n.__param)(9,(0,T.W)(l.b)),(0,n.__param)(10,(0,E.l)()),(0,n.__param)(10,(0,T.W)(x.m))],L)},99481:(e,t,i)=>{i.d(t,{o:()=>I});var n=i(23182),o=i(36915),s=i(88241),r=i(14945),a=i(99724),l=i(18349),d=i(33767),c=i(37053),u=i(94610),h=i(29906),g=i(66008),p=i(83010),m=i(63654),f=i(11094),v=i(85693),_=i(19050),y=i(90203);let I=class{constructor(e,t,i,n,a,l,d,c,h){this._hostEmitters=e,this._proofingEmitter=t,this._critiquesEventHandler=i,this._filteringEventHandler=n,this._nodeEventHandler=a,this._spanEventHandler=l,this._formattingEventHandler=d,this._hostSettings=c,this._logger=h,this.shutDown=()=>{this._logger.log(556372812,o.q.Debug,"Shutting down EventHub.")},this.onFilterChangedEvent=e=>{this._filteringEventHandler.onEvent({eventType:e.messageType})},this.onHostModelCritiquesEvent=e=>{const t={added:e.data.critiquesAdded,removedIds:e.data.critiqueIdsRemoved,eventType:e.messageType,source:e.data.source,tileId:e.data.tileId,tileVersion:e.data.tileVersion};this._critiquesEventHandler.onEvent(t)},this.onHostModelDeltaEvent=e=>{const{delta:t,deletedOrReplacedCharacters:i,sourceType:n,tileId:o,tileVersion:a}=e.message;if(!0===this._hostSettings.sdkV2Enabled||n!==s.p.TileNode)return;const l={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===u.WI.Add?r.G.NewData:t.deltaType===u.WI.Delete?r.G.RemoveData:r.G.ChangeData,tileId:o,tileVersion:a,deletedOrReplacedCharacters:i};this._spanEventHandler.onEvent(l)},this.onHostModelFormattingDelta=e=>{const t=e.message.delta,i=e.message.tileId,n=e.message.tileVersion,o={formattedRanges:t.formattedRanges,eventType:t.deltaType===u.WI.Add?r.G.NewData:t.deltaType===u.WI.Delete?r.G.RemoveData:r.G.ChangeData,tileId:i,tileVersion:n};this._formattingEventHandler.onEvent(o)},this.onHostModelTextTileEvent=e=>{if(!0===this._hostSettings.sdkV2Enabled)return;const t=e.data.tileId,i=e.data.tileVersion,n={eventType:e.messageType,tileId:t,tileVersion:i};this._nodeEventHandler.onEvent(n)},this.onClearCritiquesForNode=e=>{const t={eventType:r.G.RemoveData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)},this.onRestoreNodeForCritiqueStore=e=>{const t={eventType:r.G.NewData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)}}async initialize(){if(this._logger.log(556372811,o.q.Debug,"Initializing EventHub."),this._hostSettings.enableOrchestration){this._proofingEmitter.on("enabledCritiqueTypesChanged",(e=>this.filterMessageType("enabledCritiqueTypesChanged",e,this.onFilterChangedEvent,void 0,r.G.ChangeData)));for(const e of["eccStateChanged","wordDictionaryEvent"])this._proofingEmitter.on(e,(t=>this.filterMessageType(e,t,this.onFilterChangedEvent,r.G.ChangeData)));for(const e of this._hostEmitters)e.on(a.pD.hostModelCritiques,(e=>this.filterMessageType("hostModelCritiques",e.message,this.onHostModelCritiquesEvent,void 0,r.G.ChangeData))),e.on(a.pD.hostModelFlags,(e=>this.filterMessageType("hostModelFlags",e.message,this.onHostModelCritiquesEvent,void 0,r.G.ChangeData))),e.on(a.pD.hostModelTextTile,(e=>this.filterMessageType("hostModelTextTile",e.message,this.onHostModelTextTileEvent,r.G.ChangeData))),e.on(a.pD.hostModelDelta,this.onHostModelDeltaEvent),e.on(a.pD.clearCritiquesForNode,this.onClearCritiquesForNode),e.on(a.pD.restoreNodeForCritiqueStore,this.onRestoreNodeForCritiqueStore),e.on(a.pD.hostModelFormattingDelta,this.onHostModelFormattingDelta)}}filterMessageType(e,t,i,n,s){s&&t.messageType!==s||n&&t.messageType===n?this._logger.log(556372815,o.q.Warn,`${e} message: Unexpected MessageType.`):i(t)}};I=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.t)(a.zJ)),(0,n.__param)(1,(0,p.W)(l.o)),(0,n.__param)(2,(0,p.W)(m.SF)),(0,n.__param)(3,(0,p.W)(f.F)),(0,n.__param)(4,(0,p.W)(_.l)),(0,n.__param)(5,(0,p.W)(y.bz)),(0,n.__param)(6,(0,p.W)(v.o)),(0,n.__param)(7,(0,p.W)(d.n)),(0,n.__param)(8,(0,p.W)(c.g))],I)},11094:(e,t,i)=>{i.d(t,{F:()=>u});var n=i(23182),o=i(77238),s=i(29906),r=i(83010),a=i(27603),l=i(58550),d=i(24850),c=i(44404);let u=class{constructor(e,t,i){this._critiqueStore=e,this._critiqueFilterer=t,this._indicatorStore=i}onEvent(e){const t=this._critiqueStore.getAllCritiques();this._indicatorStore&&(0,d.$x)(this._indicatorStore);for(const e of t){const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map((e=>({critique:e,critiqueDiffType:l.K.Update})));t.length>0&&this._critiqueStore.updateNode(t,e.tileId,e.tileVersion)}}};u=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(l.$)),(0,n.__param)(1,(0,r.W)(o.B)),(0,n.__param)(2,(0,a.l)()),(0,n.__param)(2,(0,r.W)(c.$))],u)},85693:(e,t,i)=>{i.d(t,{o:()=>l});var n=i(23182),o=i(58550),s=i(29906),r=i(83010),a=i(30459);let l=class{constructor(e){this._critiqueStore=e}onEvent(e){const t=this._critiqueStore.getCritiques(e.tileId);t&&(0,a.d)(t,e.tileVersion)&&this._critiqueStore.updateNode([],e.tileId,e.tileVersion,!0)}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(o.$))],l)},42007:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(17298).f)("IApplyCritiqueSuggestionHandler")},49845:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(17298).f)("IApplyFlagHandler")},97633:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(17298).f)("IAutoCorrectionBroker")},80370:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(17298).f)("ICritiqueDispatcher")},58550:(e,t,i)=>{i.d(t,{$:()=>s,K:()=>n});var n,o=i(17298);!function(e){e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.Update=2]="Update",e[e.Delete=4]="Delete"}(n||(n={}));const s=(0,o.f)("ICritiqueStore")},19050:(e,t,i)=>{i.d(t,{l:()=>l});var n=i(23182),o=i(14945),s=i(29906),r=i(83010),a=i(58550);let l=class{constructor(e){this._critiqueStore=e}onEvent(e){switch(e.eventType){case o.G.NewData:this._critiqueStore.updateNode([],e.tileId,e.tileVersion);break;case o.G.RemoveData:this._critiqueStore.clearNode(e.tileId)}}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(a.$))],l)},90203:(e,t,i)=>{i.d(t,{bz:()=>y});var n=i(23182),o=i(14945),s=i(48662),r=i(37053);var a=i(3661),l=i(63318),d=i(29906),c=i(83010),u=i(27603),h=i(968),g=i(30459),p=i(58550),m=i(97633),f=i(21203),v=i(67409),_=i(24835);let y=class{constructor(e,t,i,n,s){this._critiqueStore=e,this._featureFlagsReader=t,this._logger=i,this._wordDictionary=n,this._autoCorrectionBroker=s,this.calcLengths=e=>function(e,t,i,n=!1){var s;let r=null!=t?t:0,a=0;switch(i){case o.G.NewData:a=null!==(s=null==e?void 0:e.length)&&void 0!==s?s:r,n||(r=a);break;case o.G.RemoveData:a=-r;break;case o.G.ChangeData:a=e?e.length-r:a}return{length:r,lengthDiff:a}}(e.content,e.length,e.eventType,this._featureFlagsReader.flags.disableCalcLengthForAddDeltasInPresentation),this.deletedDiff=(e,t,i,n,s,r,a=!1)=>function(e,t,i,n,s,r,a=!1,d,c,u=!0){if(!t&&0===n&&!s)return;const h={offset:e.start,span:e.length},g={offset:i,span:n},m=(!I(t,u)||i===e.start)&&(i!==e.start+e.length||r!==o.G.RemoveData||void 0===s||!I(s,u))&&(a||i+n===e.start||i===e.start+e.length)&&function(e){return!(0,l.oe)(e.typeId)||e.typeId===l.L9.CIQFlag_DateEntityRecognition||e.typeId===l.L9.CIQFlag_PersonEntityRecognition||e.typeId===l.L9.HeadingDetection||e.typeId===l.L9.CIQFlag_TaskRecognition}(e);if(f=h,y=g,!(!f||!y||f.offset>=y.offset+y.span||y.offset>=f.offset+f.span)||m&&function(e,t){return!(!e||!t||e.offset!==t.offset+t.span&&t.offset!==e.offset+e.span)}(h,g)){if((0,v.A_)(e)){if(null==c?void 0:c.getAutoCorrectionIsBeingApplied(e))return;(0,_.yf)(e,d)}return{critique:e,critiqueDiffType:p.K.Delete}}var f,y;return}(e,t,i,n,s,r,a,this._wordDictionary,this._autoCorrectionBroker)}onEvent(e){var t,i;const n=this._critiqueStore.getCritiques(e.tileId);if(!n||!(0,g.d)(n,e.tileVersion))return;const{length:s,lengthDiff:r}=this.calcLengths(e),a=null!==(t=e.position)&&void 0!==t?t:0,l=[];for(const t of n.critiques){const n=this.deletedDiff(t,null!==(i=e.content)&&void 0!==i?i:"",a,s,e.deletedOrReplacedCharacters,e.eventType,e.eventType!==o.G.ChangeData);if(n)l.push(n);else if(t.start>=a&&0!==r){const e=t.start;t.start+=r,l.push({critique:t,critiqueDiffType:p.K.Move,oldStart:e})}}this._critiqueStore.updateNode(l,e.tileId,e.tileVersion)}};function I(e,t){return 1===e.length&&(a.xC(e.charCodeAt(0))||t&&(0,h.B)(e))}y=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(p.$)),(0,n.__param)(1,(0,c.W)(s.c)),(0,n.__param)(2,(0,c.W)(r.g)),(0,n.__param)(3,(0,u.l)()),(0,n.__param)(3,(0,c.W)(f.s)),(0,n.__param)(4,(0,u.l)()),(0,n.__param)(4,(0,c.W)(m.m))],y)},37851:(e,t,i)=>{i.d(t,{Q:()=>l});var n=i(23182),o=i(56489),s=i(29906),r=i(27603),a=i(83010);let l=class{constructor(e){this.themeStore=e}get enabled(){var e,t;return(null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme)===o.SV.highContrast||(null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"screen and (-ms-high-contrast: active)").matches)}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.l)()),(0,n.__param)(0,(0,a.W)(o.YQ))],l)},23466:(e,t,i)=>{i.d(t,{P:()=>n});const n=(0,i(17298).f)("IHighContrastModeDetector")},71626:(e,t,i)=>{i.d(t,{V:()=>_});var n=i(23182),o=i(28798),s=i(51451),r=i(1297),a=i(31352),l=i(28710),d=i(63526),c=i(33767),u=i(25622),h=i(18349),g=i(19728),p=i(29906),m=i(83010),f=i(27603),v=i(37814);let _=class{constructor(e,t,i,n,a,l){this.languageInfoProvider=e,this.languageDetector=t,this.proofingStore=i,this.hostSettings=n,this.targetRenderElement=a,this.emitter=l,this._proofingLanguageDirCache={},this._defaultProofingLanguageDir=o.K3.auto,this._uxLanguageDir=o.K3.auto,this.updateProofingLanguageDir=e=>{this._defaultProofingLanguageDir=this.getLanguageDir(e)},this.updateUxLanguageDir=()=>{const e=this.languageDetector.getUILanguage();this._uxLanguageDir=this.getLanguageDir(e)},this.getLanguageDir=e=>{const t=this.languageInfoProvider.getLanguageInfo(e);return t?t.isRtl?o.K3.rtl:o.K3.ltr:o.K3.auto},(0,v.Gn)(this),this.updateUxLanguageDir(),this.proofingStore.read(s.l.ProofingLanguages).then((e=>this.updateProofingLanguageDir(r.I.getDefaultLanguageCode(e)))).catch((()=>{})),this.emitter&&this.emitter.on("proofingLanguageChanged",(async e=>{e.proofingLanguagesChanged&&this.updateProofingLanguageDir(e.data.defaultLanguageCode)}))}get uxLanguageDir(){return this.hostSettings.manageRtlInEditorUx?this._uxLanguageDir:o.K3.auto}get optionsUxLanguageDir(){return this._uxLanguageDir}isRtl(){var e;if(this.uxLanguageDir!==o.K3.auto)return this.uxLanguageDir===o.K3.rtl;const t=null===(e=this.targetRenderElement())||void 0===e?void 0:e.deref();return void 0!==t&&window.getComputedStyle(t).direction===o.K3.rtl}dir(){return this.isRtl()?"rtl":"ltr"}getProofingLanguageDir(e){if(!this.hostSettings.manageRtlForProofingLanguage)return o.K3.auto;if(!e)return this._defaultProofingLanguageDir;let t=this._proofingLanguageDirCache[e];return t||(t=this.getLanguageDir(e),this._proofingLanguageDirCache[e]=t),t}};(0,n.__decorate)([g.observable],_.prototype,"_uxLanguageDir",void 0),(0,n.__decorate)([g.computed],_.prototype,"uxLanguageDir",null),(0,n.__decorate)([g.action],_.prototype,"updateProofingLanguageDir",void 0),(0,n.__decorate)([g.action],_.prototype,"updateUxLanguageDir",void 0),_=(0,n.__decorate)([(0,p._)(),(0,n.__param)(0,(0,m.W)(a.d)),(0,n.__param)(1,(0,m.W)(l.v)),(0,n.__param)(2,(0,m.W)(d.K)),(0,n.__param)(3,(0,m.W)(c.n)),(0,n.__param)(4,(0,m.W)(u.oA)),(0,n.__param)(5,(0,f.l)()),(0,n.__param)(5,(0,m.W)(h.o))],_)},44246:(e,t,i)=>{if(i.d(t,{d:()=>l}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(15661);if(2063!=i.j)var s=i(26692);if(2063!=i.j)var r=i(14600);if(2063!=i.j)var a=i(11727);class l{get uniqueId(){return(0,n.z)(507918355)}configureRootServices(e){e.bind(o.m).to(s.h),e.bind(r.u).to(a.z)}}},13897:(e,t,i)=>{if(i.d(t,{u:()=>f}),2063!=i.j)var n=i(32272);if(2063!=i.j)var o=i(44246);if(2063!=i.j)var s=i(35152);if(2063!=i.j)var r=i(12934);if(2063!=i.j)var a=i(49845);if(2063!=i.j)var l=i(15275);if(2063!=i.j)var d=i(33767);if(2063!=i.j)var c=i(34471);if(2063!=i.j)var u=i(92029);if(2063!=i.j)var h=i(48107);if(2063!=i.j)var g=i(26522);if(2063!=i.j)var p=i(30444);if(2063!=i.j)var m=i(52726);class f{constructor(){this.imports=[r.v,o.d,s.r]}get uniqueId(){return(0,l.z)(507918358)}configureRootServices(e){var t,i;e.bind(a.K).to(n.r);const o=e.get(d.n);(null===(i=null===(t=o.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.enabled)&&((0,u.iO)(o)&&e.bind(c.S).to(u.lJ),(0,h.U)(o)&&e.bind(c.S).to(h.B),(0,g.p)(o)&&e.bind(c.S).to(g.C),(0,p.f)(o)&&e.bind(c.S).to(p.C),(0,m.f)(o)&&e.bind(c.S).to(m.C))}}},35152:(e,t,i)=>{if(i.d(t,{r:()=>g}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(33767);if(2063!=i.j)var s=i(63318);if(2063!=i.j)var r=i(29417);if(2063!=i.j)var a=i(76750);if(2063!=i.j)var l=i(92029);if(2063!=i.j)var d=i(48107);if(2063!=i.j)var c=i(26522);if(2063!=i.j)var u=i(30444);if(2063!=i.j)var h=i(52726);class g{get uniqueId(){return(0,n.z)(507781790)}configureRootServices(e){var t,i;const n=e.get(o.n);(null===(i=null===(t=n.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.enabled)&&((0,l.iO)(n)&&p(e,s.L9.CIQFlag_DateEntityRecognition,"ebx_DateEntityRecognitionCategoryTitle"),(0,d.U)(n)&&p(e,s.L9.CIQFlag_File,"ebx_CIQFlagFileTooltipTitle"),(0,c.p)(n)&&p(e,s.L9.CIQFlag_PersonEntityRecognition,"ebx_PersonEntityRecognitionCategoryTitle"),(0,u.f)(n)&&p(e,s.L9.CIQFlag_Time,"ebx_CIQFlagTimeCategoryTitle"),(0,h.f)(n)&&p(e,s.L9.CIQFlag_Topic,"ebx_CIQFlagTopicCategoryTitle"))}}function p(e,t,i){e.bind(r.U).toValue((e=>({id:t,name:(0,a.kd)(i,e)})))}},12934:(e,t,i)=>{if(i.d(t,{v:()=>C}),2063!=i.j)var n=i(26812);if(2063!=i.j)var o=i(94909);if(2063!=i.j)var s=i(54162);if(2063!=i.j)var r=i(26633);if(2063!=i.j)var a=i(20179);if(2063!=i.j)var l=i(83812);if(2063!=i.j)var d=i(63654);if(2063!=i.j)var c=i(99481);if(2063!=i.j)var u=i(11094);if(2063!=i.j)var h=i(85693);if(2063!=i.j)var g=i(80370);if(2063!=i.j)var p=i(58550);if(2063!=i.j)var m=i(15275);if(2063!=i.j)var f=i(34471);if(2063!=i.j)var v=i(8498);if(2063!=i.j)var _=i(19050);if(2063!=i.j)var y=i(89165);if(2063!=i.j)var I=i(90203);class C{constructor(){this.imports=[n.I]}get uniqueId(){return(0,m.z)(507908322)}configureRootServices(e){e.bind(f.S).to(c.o),e.bind(d.SF).toSelf(),e.bind(u.F).toSelf(),e.bind(h.o).toSelf(),e.bind(_.l).toSelf(),e.bind(I.bz).toSelf(),e.bind(g.h).to(a.A),e.bind(v.H).to(y.y),e.bind(p.$).to(l.U),e.bind(f.S).toExisting(p.$),e.bind(o.D).to(s.H),e.bind(o.D).to(r.o)}}},71417:(e,t,i)=>{if(i.d(t,{k:()=>r}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(24111);if(2063!=i.j)var s=i(92324);class r{get uniqueId(){return(0,n.z)(507917961)}configureRootServices(e){e.bind(o.J).to(s.I)}}},76081:(e,t,i)=>{i.d(t,{K:()=>m});var n=i(23182),o=i(36915),s=i(99724),r=i(14945),a=i(33767),l=i(37053),d=i(19685),c=i(29906),u=i(66008),h=i(83010),g=i(53353),p=i(61595);let m=class{constructor(e,t,i,n,s){this._hostEmitters=e,this._hostSettings=t,this._logger=i,this._nudgeStore=n,this._localizer=s,this.onNudgeEvent=e=>{if(!e.message.data.tileId)return void this._logger.log(510248464,o.q.Error,"INudge message: Received undefined args.");const t=e.message.data;t.text=this.getNudgeMessage(t.entityType);const i=Object.assign(Object.assign({eventType:e.message.messageType},t),{nudge:t});this.onEvent(i)},this.messagePerEntityType={[g.c.File]:"nudgeTextForFile",[g.c.People]:"nudgeTextForPeople",[g.c.Event]:"nudgeTextForMeetings",[g.c.Message]:"nudgeTextForEmails"}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(s.pD.nudgeTriggered,this.onNudgeEvent)}shutDown(){}async onEvent(e){e.eventType===r.G.NewData?await this._nudgeStore.updateNudge(e.nudge):await this._nudgeStore.clearNudge()}getNudgeMessage(e){var t,i,n;const o=null!==(n=null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===i?void 0:i.insertionCharacter)&&void 0!==n?n:"@";return this._localizer.getMessage(this.messagePerEntityType[e],o)}};m=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.t)(s.zJ)),(0,n.__param)(1,(0,h.W)(a.n)),(0,n.__param)(2,(0,h.W)(l.g)),(0,n.__param)(3,(0,h.W)(p.Y)),(0,n.__param)(4,(0,h.W)(d.H))],m)},61595:(e,t,i)=>{i.d(t,{Y:()=>r,h:()=>a});var n=i(23182),o=i(17298),s=i(29906);const r=(0,o.f)("INudgeStore");let a=class{constructor(){this.updateNudge=async e=>{this._currentNudge=e,this._onUpdate&&await this._onUpdate()},this.clearNudge=async()=>{this._currentNudge=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentNudge=()=>this._currentNudge,this.setOnUpdatedNudge=e=>{this._onUpdate=e}}};a=(0,n.__decorate)([(0,s._)()],a)},92029:(e,t,i)=>{i.d(t,{iO:()=>E,lJ:()=>T});var n=i(23182),o=i(16291),s=i(14945),r=i(99724),a=i(63318),l=i(33767),d=i(37053),c=i(19685),u=i(62026),h=i(63596),g=i(85990),p=i(53353),m=i(49845),f=i(58550),v=i(33727),_=i(71975),y=i(4649),I=i(29906),C=i(66008),S=i(83010),b=i(27603);let T=class extends y.H{constructor(e,t,i,n,r,a,l,d,c){super(e,t,i,n,a,l,d,c),this._localizer=r,this.onFlagAnnotationUpdate=e=>{var t,i;const n=e.message.messageType,r=e.message.data;if(n===s.G.NewData&&r.results.length>0){const i=[];for(const e of r.results){if(!g.uH.typeGuard(e))continue;if(1!==e.results.length||e.results[0].entityType!==p.c.DateTime||!E(this._hostSettings))continue;const n=e.results[0].subType,s=e.results[0].text;let a,l;try{const e=JSON.parse(s);e.start&&e.end&&("DateRange"===n?(a=N(e.start).getTime(),l=N(e.end).getTime()):(a=Date.parse(e.start),l=Date.parse(e.end)))}catch(e){}a||l||!Date.parse(s)||(a="Date"===n?N(s).getTime():Date.parse(s),l=a);const d=[{entities:[{entityType:p.c.DateTime,text:this.getTextForEntity(n),icon:{iconName:"FFXCEventDate"},confidence:e.modelMetadata.score,startDateTime:null==a?void 0:a.toString(),endDateTime:null==l?void 0:l.toString(),subType:n}],entityType:p.c.DateTime,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle")}];let c;switch(n){case"Date":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTooltipTitle");break;case"Datetime":case"DateTime":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeTooltipTitle");break;case"DateRange":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeTooltipTitle");break;case"Time":c=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeTooltipTitle");break;case"TimeRange":c=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeTooltipTitle")}const u=r.tileId+e.id;i.push({annotationId:u,traceId:u,languageId:this._hostSettings.defaultLocale,nodeId:r.tileId,nodeVersion:r.tileVersion,textInContext:null!==(t=e.context)&&void 0!==t?t:"",start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore,supportedEntityTypes:[p.c.DateTime],suggestionItems:d,additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:c,categoryTitle:this._localizer.getMessage("ebx_DateEntityRecognitionCategoryTitle")})}this.addFlags(e.address,i)}else if(n===s.G.RemoveData){const t=null===(i=this._annotationIdMap)||void 0===i?void 0:i.get(r.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,r.annotationId)}},this.getTextForEntity=e=>{switch(e){case"Date":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateLabel");case"Datetime":case"DateTime":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeLabel");case"DateRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeLabel");case"Time":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeLabel");case"TimeRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeLabel");default:return""}},this.onApplyFlag=(e,t,i,n)=>{var o,s;if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(s=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.flagAnnotationSettings)||void 0===s?void 0:s.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_DateEntityRecognition}};function E(e){var t,i;return(0,h.i$)(null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,p.c.DateTime)}function N(e){const t=e.split(/\D+/).map((e=>parseInt(e,10)));return t[1]=t[1]-1,new Date(t[0],t[1],t[2])}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(l.n)),(0,n.__param)(2,(0,S.W)(v.w)),(0,n.__param)(3,(0,S.W)(d.g)),(0,n.__param)(4,(0,S.W)(c.H)),(0,n.__param)(5,(0,S.W)(f.$)),(0,n.__param)(6,(0,S.W)(_.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(u.f)),(0,n.__param)(8,(0,b.l)()),(0,n.__param)(8,(0,S.W)(m.K))],T)},69395:(e,t,i)=>{i.d(t,{v:()=>h});var n=i(23182),o=i(99724),s=i(14945),r=i(33767),a=i(24111),l=i(29906),d=i(66008),c=i(83010),u=i(89669);let h=class{constructor(e,t,i,n){this._hostEmitters=e,this._hostSettings=t,this._oaResultsStore=i,this._queryDetection=n,this.onOARankedAnnotationsEvent=e=>{const t=e.message.data,i=Object.assign(Object.assign({},t),{eventType:e.message.messageType,isLoading:!1});this.onEvent(i)},this.oaAnnotationsTriggeredEvent=e=>{this._oaResultsStore.updateLoadingStatus(!0)}}async initialize(){var e;if(this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled))for(const e of this._hostEmitters)e.on(o.pD.oaAnnotationsTriggered,this.oaAnnotationsTriggeredEvent),e.on(o.pD.oaRankedAnnotations,this.onOARankedAnnotationsEvent)}shutDown(){}onEvent(e){const{results:t,tileId:i,latency:n,resultStatus:o,queryCorrelationKeys:r,resultSummary:a}=e;switch(e.eventType){case s.G.NewData:case s.G.ChangeData:this._oaResultsStore.updateResults(t,i,o,r?Object.assign(Object.assign({},r),{scopeInfo:this._queryDetection.getCurrentScope()}):void 0,n,a);break;case s.G.RemoveData:this._oaResultsStore.clearResults()}}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.t)(o.zJ)),(0,n.__param)(1,(0,c.W)(r.n)),(0,n.__param)(2,(0,c.W)(u.C)),(0,n.__param)(3,(0,c.W)(a.J))],h)},48107:(e,t,i)=>{i.d(t,{B:()=>T,U:()=>E});var n=i(23182),o=i(16291),s=i(14945),r=i(99724),a=i(63318),l=i(33767),d=i(37053),c=i(19685),u=i(62026),h=i(63596),g=i(53353),p=i(49845),m=i(58550),f=i(33727),v=i(71975),_=i(10968),y=i(4649),I=i(29906),C=i(66008),S=i(83010),b=i(27603);let T=class extends y.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,a,l,d,u),this._localizer=r,this._paragraphTextExtractor=c,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(r===s.G.NewData&&a.results.length>0){const n=a.results.filter((e=>"GraphSearch"===e.ownerId));if(E(this._hostSettings)){const s=n.filter((e=>e.results[0].entityType===g.c.File)),r=[];for(const e of s){const n={entities:e.results,entityType:g.c.File,groupTitle:this._localizer.getMessage("fileEntityLabel")},s=this._paragraphTextExtractor.getParagraphText(a.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==s?void 0:s.substring(e.range.start,e.range.start+e.range.length),d=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(d)}l&&r.push({annotationId:d,traceId:d,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore,supportedEntityTypes:[g.c.File],suggestionItems:[n],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle"),shouldIgnoreFlaggedText:!0})}this.addFlags(e.address,r)}}else if(r===s.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var o,s;if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(s=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.flagAnnotationSettings)||void 0===s?void 0:s.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_File}};function E(e){var t,i;return(0,h.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,g.c.File,"mc-editor-oa-files-flag")}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(l.n)),(0,n.__param)(2,(0,S.W)(f.w)),(0,n.__param)(3,(0,S.W)(d.g)),(0,n.__param)(4,(0,S.W)(c.H)),(0,n.__param)(5,(0,S.W)(m.$)),(0,n.__param)(6,(0,S.W)(v.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(u.f)),(0,n.__param)(8,(0,S.W)(_.b)),(0,n.__param)(9,(0,b.l)()),(0,n.__param)(9,(0,S.W)(p.K))],T)},4649:(e,t,i)=>{i.d(t,{H:()=>h});var n=i(23182),o=i(14945),s=i(99724),r=i(70848),a=i(63326),l=i(16291),d=i(29906),c=i(81174),u=i(19728);let h=class{constructor(e,t,i,n,s,r,l,d){this._hostEmitters=e,this._hostSettings=t,this._proofingDom=i,this._logger=n,this._critiqueStore=s,this._disableCritiqueHandler=r,this._instrumentationProcessor=l,this._applyFlagHandler=d,this._annotationMap=new Map,this._isDisabled=!1,this.shutDownCallbacks=[],this.ignoredStrings=[],this.shutDown=()=>{for(const e of this.shutDownCallbacks)e();this.flagHandlerShutdown()},this.getFlagData=e=>this._annotationMap.get(e),this.onIgnoreAllOfFlag=(e,t)=>{},this.removeFlag=(e,t)=>{const i=this._annotationMap.get(t);if(!i)return;const n=this.getCommonCritiqueById(i.critique.annotationId);n&&n.isIgnored||(this.emitEvent(o.G.RemoveData,[i.critique],i.critique.nodeId,e),this._annotationMap.delete(t))},this.onHostModelCritiques=e=>{for(const t of e.message.data.critiqueIdsRemoved)this._annotationMap.delete(t)},this.getCommonCritiqueById=e=>{let t;for(const i of this._critiqueStore.getAllCritiques())for(const n of i.critiques)n.annotationId===e&&(t=n);return t},this.onApplyFlag_Internal=(e,t,i,n)=>{if(!t.annotationId)return!0;const s=this._annotationMap.get(t.annotationId);if(s){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,c.l)(e))return this._logger.error(508146688,"Unable to find paragraph node while applying flag"),!1;this.onApplyFlag(e,t,i,n),this._annotationMap.delete(t.annotationId),this.emitEvent(o.G.RemoveData,[s.critique],s.critique.nodeId),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.ChangeAllSuggOther})}else this._logger.error(508146659,"Unable to find flag data while applying flag");return!1},this.onIgnoreFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,c.l)(e))return this._logger.error(508146658,"Unable to find paragraph node while ignoring flag"),!1;i.critique.isIgnored=!0,this.onIgnoreFlag(e,t),this._annotationMap.delete(t.annotationId),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.Ignore})}else this._logger.error(508146657,"Unable to find flag data while ignoring flag");return!1},this.onIgnoreAllOfFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,c.l)(e))return this._logger.error(507574145,"Unable to find paragraph node while ignoring all of flag"),!1;if(!t.textInContext)return this._logger.error(507574097,"Unable to find flag textInContext while ignoring all of flag"),!1;this.ignoredStrings.push(t.textInContext),i.critique.isIgnored=!0,this.onIgnoreAllOfFlag(e,t),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.IgnoreAll})}else this._logger.error(507574096,"Unable to find flag data while ignoring all of flag");return!1},this.onDisableFlag_Internal=(e,t)=>{var i;if(!t.annotationId)return!1;this._isDisabled=!0,this.onDisableFlag();for(const e of this._annotationMap.values())this.removeFlag(void 0,e.critique.annotationId);return null===(i=this._disableCritiqueHandler)||void 0===i||i.disableCritique(t),this._instrumentationProcessor.process({critique:(0,u.toJS)(t),eventId:a.xp.DoNotCheckThisIssue}),!1}}async initialize(){if(this._hostSettings.enableOrchestration){for(const e of this._hostEmitters)e.on(s.pD.hostModelCritiques,this.onHostModelCritiques);this._applyFlagHandler&&(this.shutDownCallbacks.push(this._applyFlagHandler.handleApplyFlag(this.getCritiqueType(),this.onApplyFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreFlag(this.getCritiqueType(),this.onIgnoreFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreAllOfFlag(this.getCritiqueType(),this.onIgnoreAllOfFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleDisableFlag(this.getCritiqueType(),this.onDisableFlag_Internal))),this.flagHandlerInitialize()}}addFlags(e,t){const i=new Map;for(const e of t){const t=i.get(e.nodeId);t?t.push(e):i.set(e.nodeId,[e])}for(const[t,n]of i)this.addFlagsInSameTile(e,t,n[0].nodeVersion,n)}addFlagsInSameTile(e,t,i,n){if(this._isDisabled)return;const s=n.map((e=>Object.assign(Object.assign({isFlagCritique:!0},e),{nodeId:t,nodeVersion:i,priority:l.bx.Informational,suggestions:[],typeId:this.getCritiqueType(),isIgnored:!1}))).filter((e=>{var t,i,n,o,s;if(e.annotationId&&this._annotationMap.get(e.annotationId))return!1;if(e.textInContext&&this.ignoredStrings.includes(e.textInContext))return!1;const a=this._proofingDom.findParagraphNode(e.nodeId);return!!(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.element)&&(null===(s=null===(o=null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===n?void 0:n.shouldRenderFlag)||void 0===o?void 0:o.call(n,(0,r.OE)(e),a.parent.element,e.nodeId,e.start,length))||void 0===s||s)}));this.emitEvent(o.G.NewData,s,t,e,i);for(const e of s)this._annotationMap.set(e.annotationId,{tileId:t,critique:e,additionalData:e.additionalData})}addFlag(e,t,i,n,o,s,r,a,l,d,c,u,h,g,p,m,f,v){this.addFlagsInSameTile(e,o,s,[{annotationId:t,textInContext:r,length:l,start:a,languageId:n,traceId:i,supportedActions:d,supportedEntityTypes:c,suggestionItems:u,shouldIgnoreFlaggedText:v,groupTitle:g,groupSubtitle:p,tooltipTitle:m,categoryTitle:f,additionalData:h}])}emitEvent(e,t,i,n=void 0,r=0){for(const a of this._hostEmitters)a.emit(s.pD.hostModelFlags,{address:n,message:{messageType:o.G.ChangeData,data:{critiquesAdded:e===o.G.NewData?t:[],critiqueIdsRemoved:e===o.G.RemoveData?t.map((e=>e.annotationId)):[],tileId:i,tileVersion:r,source:"Local"}}})}};h=(0,n.__decorate)([(0,d._)()],h)},26522:(e,t,i)=>{i.d(t,{C:()=>N,p:()=>x});var n=i(23182),o=i(16291),s=i(14945),r=i(8628),a=i(99724),l=i(63318),d=i(33767),c=i(37053),u=i(19685),h=i(62026),g=i(63596),p=i(53353),m=i(49845),f=i(58550),v=i(33727),_=i(71975),y=i(10968),I=i(78426),C=i(4649),S=i(29906),b=i(66008),T=i(83010),E=i(27603);let N=class extends C.H{constructor(e,t,i,n,a,l,d,c,u,h,g){super(e,t,i,n,l,d,c,g),this._localizer=a,this._paragraphTextExtractor=u,this._tileContent=h,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(x(this._hostSettings))if(r===s.G.NewData&&a.results.length>0){const n=a.results.filter((e=>e.results.length>0&&e.results[0].entityType===p.c.People)),s=[];for(const e of n){const n=[];for(const t of e.results){if(!t.DisplayName)continue;const e=["JobTitle","Company","Department","OfficeLocation"],i=t;i.PropertyHits&&e.includes(i.PropertyHits[0])?n.push(Object.assign(Object.assign({},t),{subtitlePropertyOverride:i.PropertyHits[0]})):n.push(t)}const r={entities:n,entityType:p.c.People,groupTitle:this._localizer.getMessage("peopleEntityLabel")},l=this._paragraphTextExtractor.getParagraphText(a.tileId),d=null!==(t=e.context)&&void 0!==t?t:null==l?void 0:l.substring(e.range.start,e.range.start+e.range.length),c=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(c)}d&&s.push({annotationId:c,traceId:c,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:d,start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore,supportedEntityTypes:[p.c.People],suggestionItems:0===n.length?void 0:[r],additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:this._localizer.getMessage("ebx_CIQFlagPeopleTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_PersonEntityRecognitionCategoryTitle")})}this.addFlags(e.address,s)}else if(r===s.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var o,s;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);if(a&&(this._annotationMap.delete(t.annotationId),null===(s=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.flagAnnotationSettings)||void 0===s?void 0:s.flagInsertionCallback)){const o=a.additionalData.replacementRange;if(o){const n=o.start-a.additionalData.range.start,s=t.start+n;this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+s,o.length).then((n=>{if(!n)return void this._logger.logDiagnostics("Unable to find replacement flag range",void 0,[(0,r.n)("FlagTypeId",a.critique.typeId),(0,r.n)("Start",a.additionalData.range.start),(0,r.n)("Length",a.additionalData.range.length),(0,r.n)("ReplacementStart",o.start),(0,r.n)("ReplacementLength",o.length),(0,r.n)("InTextReplacementStart",s)]);const l=Object.assign(Object.assign({},t),{start:s,length:o.length});this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,l)})).catch((e=>{this._logger.logDiagnostics("Unable to find replacement flag range",void 0,[(0,r.n)("Exception",e),(0,r.n)("FlagTypeID",a.critique.typeId),(0,r.n)("Start",a.additionalData.range.start),(0,r.n)("Length",a.additionalData.range.length),(0,r.n)("ReplacementStart",o.start),(0,r.n)("ReplacementLength",o.length),(0,r.n)("InTextReplacementStart",s)])}))}else this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t)}},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(a.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return l.L9.CIQFlag_PersonEntityRecognition}};function x(e){var t,i;return(0,g.i$)(null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,p.c.People)}N=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.t)(a.zJ)),(0,n.__param)(1,(0,T.W)(d.n)),(0,n.__param)(2,(0,T.W)(v.w)),(0,n.__param)(3,(0,T.W)(c.g)),(0,n.__param)(4,(0,T.W)(u.H)),(0,n.__param)(5,(0,T.W)(f.$)),(0,n.__param)(6,(0,T.W)(_.W)),(0,n.__param)(6,(0,E.l)()),(0,n.__param)(7,(0,T.W)(h.f)),(0,n.__param)(8,(0,T.W)(y.b)),(0,n.__param)(9,(0,T.W)(I.d)),(0,n.__param)(10,(0,E.l)()),(0,n.__param)(10,(0,T.W)(m.K))],N)},89669:(e,t,i)=>{i.d(t,{C:()=>g,L:()=>p});var n=i(23182),o=i(15661),s=i(33767),r=i(24111),a=i(14600),l=i(52298),d=i(55642),c=i(17298),u=i(29906),h=i(83010);const g=(0,c.f)("IOAResultStore");let p=class{constructor(e,t,i,n){this._oaLogger=e,this._hostSettings=t,this._queryDetection=i,this._oaMetric=n,this._results=[],this._resultsByNode=new Map,this._isLoading=!0,this._isTimeout=!1,this._resultReset=!1,this.setOnUpdate=e=>{this.onUpdate=e},this.updateResults=(e,t,i,n,o,s)=>{var r,a;if(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.mockNoAugloopResults)return;const l=(null==n?void 0:n.logicalId)&&n.logicalId!==this._queryDetection.getCurrentQueryLogicalId();this.logStoreUpdate(e,!!l,i,n),l?this._oaMetric.commitEntry(n.logicalId,"OAAnnotationResultsDropped"):(n&&this._oaMetric.addMeasure(n.logicalId,"OAResultsReceived"),this.cancelTimeout(),this._isLoading=!1,this._isTimeout=!1,this._resultSummary=s,this._resultStatus=i,this._resultReset=!1,this._results=this._results.concat(e),this._resultsByNode.set(t,e),this.update(i,e,null!==(a=null!=n?n:this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==a?a:{conversationId:"",logicalId:""},t,o,s))},this.updateLoadingStatus=(e,t=!1)=>{this._isLoading=e,this._isTimeout=!1,this._resultSummary=void 0,this._resultStatus=void 0,this._resultReset=t,e&&(this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())),this.update()},this.startNewECCMenu=()=>{this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())},this.clearResults=()=>{this._results=[],this._isTimeout=!1,this._isLoading=!0,this._resultReset=!1,this._resultsByNode.clear()},this.getResults=()=>this._results,this.getResultSummary=()=>this._resultSummary,this.getResultStatus=()=>this._resultStatus,this.getLoadingStatus=()=>this._isLoading,this.getTimeoutStatus=()=>this._isTimeout||this._resultStatus===d.i.UnexpectedError,this.timeoutFunc=()=>{this._isTimeout=!0,this._isLoading=!1,this._resultSummary={Timeout:1},this._resultStatus=d.i.Timeout,this._resultReset=!1,this.update(d.i.Timeout,void 0,void 0,void 0,this.getTimeoutThreshold(),this._resultSummary)},this.cancelTimeout=()=>{this._timeoutID&&clearTimeout(this._timeoutID)},this.update=(e=void 0,t=[],i=void 0,n,o,s=void 0)=>{this.onUpdate&&this.onUpdate({results:t,isLoading:this._isLoading,queryCorrelationKeys:i,resultSummary:s,resultStatus:e,resultReset:this._resultReset,nodeId:n,latency:o})}}logStoreUpdate(e,t,i,n){const o={};for(const t of e){o[t.entityType]=t.entities.length}this._oaLogger.logActivity(l.y,{actualLogicalId:null==n?void 0:n.logicalId,actualConversationId:null==n?void 0:n.conversationId,annotationCount:e.length,resultStatus:null!=i?i:-1,annotations:o,dropped:t})}getTimeoutThreshold(){var e;return(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.updateResultsTimeout)||3500}};p=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(o.m)),(0,n.__param)(1,(0,h.W)(s.n)),(0,n.__param)(2,(0,h.W)(r.J)),(0,n.__param)(3,(0,h.W)(a.u))],p)},30444:(e,t,i)=>{i.d(t,{C:()=>N,f:()=>x});var n=i(23182),o=i(16291),s=i(14945),r=i(99724),a=i(63318),l=i(33767),d=i(37053),c=i(19685),u=i(62026);if(2063!=i.j)var h=i(63596);var g=i(85990),p=i(48210),m=i(53353),f=i(49845),v=i(58550),_=i(33727),y=i(78426),I=i(71975),C=i(4649),S=i(29906),b=i(66008),T=i(83010),E=i(27603);let N=class extends C.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,l,d,c,u),this._tileContent=r,this._localizer=a,this.onFlagAnnotationUpdate=e=>{const t=e.message.messageType,i=e.message.data;if(t===s.G.NewData&&i.results.length>0){const t=[];for(const e of i.results){if(!g.uH.typeGuard(e))continue;if(0===e.results.length)continue;const n=e.results[0];if(!p.f.typeGuard(n))continue;const s=[{entities:[{entityType:m.c.Text,text:n.context+n.hint,subtitle:void 0,icon:{iconName:"Globe"},confidence:1}],entityType:m.c.Text,groupTitle:this._localizer.getMessage("ebx_CIQFlagTimeTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTimeSubtitle")}];t.push({annotationId:i.annotationId,traceId:i.annotationId,languageId:e.language,nodeId:i.tileId,nodeVersion:i.tileVersion,textInContext:n.context,start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore,supportedEntityTypes:[m.c.Text],suggestionItems:s,additionalData:n,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTimeTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTimeCategoryTitle")})}this.addFlags(e.address,t)}else t===s.G.RemoveData&&this.removeFlag(e.address,i.annotationId)},this.onApplyFlag=(e,t,i,n)=>{if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),this._tileContent.replace(e.parent,void 0,t.start,t.length,i.text.trim(),n))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{}}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_Time}};function x(e){var t,i;return(0,h.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,m.c.Time,"mc-unified-text-prediction-timezone-perspectives")}N=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.t)(r.zJ)),(0,n.__param)(1,(0,T.W)(l.n)),(0,n.__param)(2,(0,T.W)(_.w)),(0,n.__param)(3,(0,T.W)(d.g)),(0,n.__param)(4,(0,T.W)(y.d)),(0,n.__param)(5,(0,T.W)(c.H)),(0,n.__param)(6,(0,T.W)(v.$)),(0,n.__param)(7,(0,T.W)(I.W)),(0,n.__param)(7,(0,E.l)()),(0,n.__param)(8,(0,T.W)(u.f)),(0,n.__param)(9,(0,E.l)()),(0,n.__param)(9,(0,T.W)(f.K))],N)},52726:(e,t,i)=>{i.d(t,{C:()=>T,f:()=>E});var n=i(23182),o=i(16291),s=i(14945),r=i(99724),a=i(63318),l=i(33767),d=i(37053),c=i(19685),u=i(62026),h=i(63596),g=i(53353),p=i(49845),m=i(58550),f=i(33727),v=i(71975),_=i(10968),y=i(4649),I=i(29906),C=i(66008),S=i(83010),b=i(27603);let T=class extends y.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,a,l,d,u),this._localizer=r,this._paragraphTextExtractor=c,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(r===s.G.NewData&&a.results.length>0){const n=a.results.filter((e=>"GraphSearch"===e.ownerId));if(E(this._hostSettings)){const s=n.filter((e=>e.results[0].entityType===g.c.Topic)),r=[];for(const e of s){const n={entities:e.results.map((e=>Object.assign(Object.assign({},e),{icon:{iconName:"Hashtag"}}))),entityType:g.c.Topic,groupTitle:this._localizer.getMessage("ebx_CIQFlagTopicTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTopicSubtitle")},s=this._paragraphTextExtractor.getParagraphText(a.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==s?void 0:s.substring(e.range.start,e.range.start+e.range.length);if(!l)continue;const d=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(d)}r.push({annotationId:d,traceId:d,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore|o.lb.IgnoreAll,supportedEntityTypes:[g.c.Topic],suggestionItems:[n],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle")})}this.addFlags(e.address,r)}}else if(r===s.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var o,s;if(!t.annotationId)return;const r=this._annotationMap.get(t.annotationId);r&&(this._annotationMap.delete(t.annotationId),(null===(s=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.flagAnnotationSettings)||void 0===s?void 0:s.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(r.additionalData,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return a.L9.CIQFlag_Topic}};function E(e){var t,i;return(0,h.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,g.c.Topic,"mc-editor-oa-topics-flags")}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(l.n)),(0,n.__param)(2,(0,S.W)(f.w)),(0,n.__param)(3,(0,S.W)(d.g)),(0,n.__param)(4,(0,S.W)(c.H)),(0,n.__param)(5,(0,S.W)(m.$)),(0,n.__param)(6,(0,S.W)(v.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(u.f)),(0,n.__param)(8,(0,S.W)(_.b)),(0,n.__param)(9,(0,b.l)()),(0,n.__param)(9,(0,S.W)(p.K))],T)},52298:(e,t,i)=>{i.d(t,{$:()=>o,y:()=>n});const n="OAResultStoreUpdates",o="OAPredictionReceived"},91289:(e,t,i)=>{i.d(t,{Y:()=>v});var n=i(23182),o=i(53353),s=i(36915),r=i(99724),a=i(14945),l=i(33767),d=i(37053),c=i(15661),u=i(86196),h=i(30256),g=i(52298),p=i(29906),m=i(66008),f=i(83010);let v=class{constructor(e,t,i,n,o,r){this._hostEmitters=e,this._hostSettings=t,this._logger=i,this._oaLogger=n,this._predictionStore=o,this._compositionEventHandler=r,this.onPredictionEvent=e=>{if(this.isDisabledOrComposing())return;if(!e.message.data.tileId)return void this._logger.log(510248457,s.q.Error,"IPrediction message: Received undefined args.");const t=e.message.data,i={eventType:e.message.messageType,tileId:t.tileId,tileVersion:t.tileVersion,prediction:t};this.onEvent(i)}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(r.pD.predictionTriggered,this.onPredictionEvent)}shutDown(){}isDisabledOrComposing(){return!this._hostSettings.isTextPredictionEnabled||this._compositionEventHandler.isComposing}async onEvent(e){this.isDisabledOrComposing()||(e.eventType===a.G.NewData?(this._oaLogger.logActivity(g.$,{predictionText:e.prediction.entityType!==o.c.Text?e.prediction.entityType.toString():e.prediction.text,entityType:e.prediction.entityType,replacingExistingPrediction:void 0!==this._predictionStore.getCurrentPrediction()}),e.prediction.isFromAugLoop=!0,await this._predictionStore.updatePrediction(e.prediction)):await this._predictionStore.clearPrediction())}};v=(0,n.__decorate)([(0,p._)(),(0,n.__param)(0,(0,m.t)(r.zJ)),(0,n.__param)(1,(0,f.W)(l.n)),(0,n.__param)(2,(0,f.W)(d.g)),(0,n.__param)(3,(0,f.W)(c.m)),(0,n.__param)(4,(0,f.W)(h.o)),(0,n.__param)(5,(0,f.W)(u.q))],v)},30256:(e,t,i)=>{i.d(t,{X:()=>a,o:()=>r});var n=i(23182),o=i(17298),s=i(29906);const r=(0,o.f)("IPredictionStore");let a=class{constructor(){this.updatePrediction=async e=>{this._currentPrediction=e,this._onUpdate&&await this._onUpdate()},this.clearPrediction=async()=>{this._currentPrediction=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentPrediction=()=>this._currentPrediction,this.setOnUpdatedPrediction=e=>{this._onUpdate=e}}};a=(0,n.__decorate)([(0,s._)()],a)},25552:(e,t,i)=>{i.d(t,{z:()=>n});const n=(0,i(17298).f)("IPresentationSettings")},53268:(e,t,i)=>{function n(e,t){return e===t||e.bottom===t.bottom&&e.height===t.height&&e.left===t.left&&e.right===t.right&&e.top===t.top&&e.width===t.width}i.d(t,{a:()=>n})},28577:(e,t,i)=>{function n(e,t,i,n){var o;const s=[];let r=0;const a=new Set;for(const{critique:l}of e){let e=!1;const d=(null===(o=l.textInContext)||void 0===o?void 0:o.toLowerCase())||"";i&&(e=a.has(d)),r<t&&!e?l.isVisible&&(n&&l.isStealth&&(l.isStealth=!1,s.push(l)),a.add(d),r++):e&&l.isVisible?(l.isVisible=!1,s.push(l)):l.isVisible&&(n&&!l.isStealth?(l.isStealth=!0,s.push(l)):n||(l.isVisible=!1,s.push(l)),a.add(d))}return s}i.d(t,{Y:()=>n})},69032:(e,t,i)=>{if(i.d(t,{k:()=>o}),2063!=i.j)var n=i(63318);function o(e){const t=[];return e.forEach((e=>{t.push({confidenceScore:s(e),critique:e})})),t.sort(((e,t)=>t.confidenceScore-e.confidenceScore)),t}function s(e){return e.typeId===n.L9.TopicSuggestion?function(e){let t=0;try{e.suggestions.forEach((e=>{const i=JSON.parse(e.metadataJSON||"{}");t=Math.max(i.annotationScore,t)}))}catch(e){}return t}(e):e.typeId===n.L9.CIQFlag_Topic?function(e){var t;let i=0;return null===(t=e.suggestionItems)||void 0===t||t.forEach((e=>{e.entities.forEach((e=>{i=Math.max(e.confidence,i)}))})),i}(e):0}},30459:(e,t,i)=>{function n(e,t){return t>=e.tileVersion}i.d(t,{d:()=>n})},58359:(e,t,i)=>{i.d(t,{i:()=>n});const n=(0,i(17298).f)("EditorCanvasInjectableComponent")},11966:(e,t,i)=>{i.d(t,{$:()=>l,I:()=>d});var n=i(23182),o=i(17298),s=i(29906),r=i(83010),a=i(25552);const l=(0,o.f)("IContentValidator");let d=class{constructor(e){this.presentationSettings=e}validate(e){if(!e)return"";let t=e;return t.includes("")&&(t=t.replace(//g,"")),t.slice(0,this.presentationSettings.maxServiceContentLengthInChars)}};d=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(a.z))],d)},8498:(e,t,i)=>{i.d(t,{H:()=>n});const n=(0,i(17298).f)("ISessionTelemetryTracker")},89165:(e,t,i)=>{i.d(t,{y:()=>u});var n=i(23182),o=i(14784),s=i(51199),r=i(63318),a=i(8628),l=i(37053),d=i(29906),c=i(83010);let u=class{constructor(e){this._logger=e,this._renderedCritiques=new Map}update(e,t){const i=this._renderedCritiques.get(t)||new Map;for(const t of e){const e=`${t.textInContext}#${t.typeId}`;i.set(e,t)}this._renderedCritiques.set(t,i)}logTelemetry(){const e=this._logger.getNewActivity(o.n.CritiquesShown,s.o.SamplingPolicy.CriticalExperimentation);if(!e)return;let t=[];Array.from(this._renderedCritiques.values()).forEach((e=>{t=t.concat(Array.from(e.values()))}));const i={};try{const e=Array.from(t.values()).reduce(((e,t)=>{if(t.typeId){let i=new Set;t.typeId===r.L9.TopicSuggestion&&(i=t.suggestions.reduce(((e,t)=>{const i=t.metadataJSON;if(i){const t=JSON.parse(i).id;t&&e.add(t)}return e}),new Set)),t.typeId in e?(e[t.typeId].count+=1,i.forEach(e[t.typeId].suggestions.add,e[t.typeId].suggestions)):e[t.typeId]={count:1,suggestions:i}}return e}),{});for(const t in e)i[t]={count:e[t].count,suggestions:[...e[t].suggestions]}}catch(e){this._logger.error(524116174,"Data preparation failed for CritiquesShown",e)}e.dataFields.push((0,a.n)("Critiques",JSON.stringify(i))),e.success=!0,e.endNow()}};u=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(l.g))],u)},66840:(e,t,i)=>{function n(e){if(e){return/[^\u0000-\u007f]/.test(e)}return!1}i.d(t,{c:()=>n})},73003:(e,t,i)=>{if(i.d(t,{A:()=>l,o:()=>d}),2063!=i.j)var n=i(58550);var o=i(63318);if(2063!=i.j)var s=i(69032);if(2063!=i.j)var r=i(28577);const a=[o.L9.TopicSuggestion,o.L9.CIQFlag_Topic];function l(e){return e.some((e=>e.critiqueDiffType!==n.K.Move&&a.includes(e.critique.typeId)))}function d(e,t){const i=[];for(const t of e.values())for(const e of t)a.includes(e.typeId)&&i.push(e);const n=(0,s.k)(i);return(0,r.Y)(n,3,!0,t)}},25857:(e,t,i)=>{var n,o;i.d(t,{G:()=>n,i:()=>o}),function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="wus-001.nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}(n||(n={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(o||(o={}))},96669:(e,t,i)=>{i.d(t,{qq:()=>de,R9:()=>ce});var n={};i.r(n),i.d(n,{BrowserExtensionRequestV1:()=>P,BrowserExtensionResponseV1:()=>W,CommonAppIdProperty:()=>g,CommonAppVersionProperty:()=>F,CommonCritique:()=>N,CommonDescriptorsProperty:()=>I,CommonLanguageIdProperty:()=>v,CommonLanguageUXIdProperty:()=>S,CommonOverriddenCritiqueTypeOptions:()=>T,CommonRequestIdProperty:()=>m,CommonResponseStatusProperty:()=>p,CommonRevisionIdProperty:()=>L,CommonRunOnProfileIdProperty:()=>b,CommonTextUnitProperty:()=>_,CommonTileIdProperty:()=>w,ConfigRequestV2:()=>k,ConfigResponseV2:()=>B,CritiqueCategoryInfo:()=>A,CritiqueTypeInfo:()=>R,CritiqueTypeOption:()=>G,Descriptor:()=>C,EditorServiceConfigV2Headers:()=>J,EditorServiceInstrumentationHeaders:()=>Y,EditorServiceLanguageinfoHeaders:()=>Z,EditorServicePostTileCheckHeaders:()=>$,InstrumentationRequestV1:()=>M,LanguageInfoRequestV1:()=>z,LanguageInfoResponseV1:()=>U,Metadatum:()=>x,Suggestion:()=>E,SupportedActions:()=>D,SupportedLanguage:()=>Q,TileCheckCritique:()=>K,TileCheckRequestV1:()=>O,TileCheckResponseV1:()=>j,TileCheckSpan:()=>H,TileContent:()=>f,TileElement:()=>V,TopologyNode:()=>y,UserIdentity:()=>q});var o=i(92435),s=i(67392);const r="Composite",a="String",l="Number",d="Sequence",c={xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}};function u(e){const t={};for(const a of e)t[(r=a[0],r.charAt(0).toLowerCase()+r.slice(1))]=(i=a[0],n=a[1],o=a[2],s=a[3],{serializedName:i,required:o,defaultValue:s,type:{name:n}});var i,n,o,s,r;return t}function h(e,t){return{type:{name:r,className:e,modelProperties:t}}}const g=h("CommonAppIdProperty",u([["AppId",a]])),p=h("CommonResponseStatusProperty",u([["ResponseStatus",l,!1,0]])),m=h("CommonRequestIdProperty",u([["RequestId",a]])),f=h("TileContent",Object.assign(Object.assign({},u([["TileId",a,!0],["RevisionId",a,!0]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},tileElements:{serializedName:"TileElements",type:{name:d,element:{type:{name:r,className:"TileElement"}}}}})),v=h("CommonLanguageIdProperty",u([["LanguageId",a]])),_=h("CommonTextUnitProperty",u([["TextUnit",l]])),y=h("TopologyNode",Object.assign(Object.assign({},u([["Id",a,!0],["RevisionId",a,!0],["Type",l,!0],["NumberOfChildren",l],["AreChildsOrdered","Boolean",void 0,!1]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"Children",type:{name:d,element:{type:{name:r,className:"TopologyNode"}}}}})),I=h("CommonDescriptorsProperty",{descriptors:{serializedName:"Descriptors",type:{name:d,element:{type:{name:r,className:"Descriptor"}}}}}),C=h("Descriptor",u([["Name",a,!0],["Value",a,!0]])),S=h("CommonLanguageUXIdProperty",u([["LanguageUXId",a]])),b=h("CommonRunOnProfileIdProperty",u([["RunOnProfileId","Uuid"]])),T=h("CommonOverriddenCritiqueTypeOptions",{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:d,element:{type:{name:r,className:"CritiqueTypeOption"}}}}}),E=h("Suggestion",u([["Text",a,!0],["Description",a],["ConfidenceLevel",l],["Source",l],["Action",l,!0],["BucketId",l],["NumberOfInstances",l]])),N=h("CommonCritique",Object.assign(Object.assign({},u([["TraceId","Uuid"],["TypeId","Uuid"],["CategoryTitle",a],["Context",a],["Start",l,void 0,0],["StartInContext",l,void 0,0],["Length",l,void 0,0],["LanguageId",a],["Priority",l]])),{metadata:{serializedName:"Metadata",type:{name:d,element:{type:{name:r,className:"Metadatum"}}}}})),x=h("Metadatum",u([["Name",a,!0],["Value",a,!0]])),w=h("CommonTileIdProperty",u([["TileId",a]])),L=h("CommonRevisionIdProperty",u([["RevisionId",a]])),D=h("SupportedActions",u([["SupportedActions",l]])),F=h("CommonAppVersionProperty",u([["AppVersion",a]])),A=h("CritiqueCategoryInfo",Object.assign(Object.assign({},u([["Id","Uuid",!0],["Name",a,!0],["Priority",l]])),{critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:d,element:{type:{name:r,className:"CritiqueTypeInfo"}}}}})),R=h("CritiqueTypeInfo",Object.assign(Object.assign({},u([["Id","Uuid",!0],["Name",a,!0],["IsBinaryCritiqueType","Boolean"],["DefaultCritiqueValue",l,!0],["CritiquePriority",l],["CritiqueTag",a]])),{critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:d,element:{type:{name:a}}}}})),q=h("UserIdentity",u([["IdentityProvider",l,!0],["Puid",a,!0],["TenantId",a],["Cid",a]])),P=h("BrowserExtensionRequestV1",Object.assign(Object.assign({},g.type.modelProperties),u([["Browser",a],["BrowserVersion",a],["ClientId",a],["Email",a],["ExtensionId",a],["FirstInstallVersion",a],["LanguageId",a],["LanguageUxId",a],["LicenseType",a],["StoreId",a],["TenantId",a]]))),O=h("TileCheckRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),I.type.modelProperties),S.type.modelProperties),b.type.modelProperties),T.type.modelProperties),u([["SessionId",a,!0],["RequestOrderInSession",l]])),{content:{serializedName:"Content",type:{name:d,element:{type:{name:r,className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:r,className:"TopologyNode"}}})),k=h("ConfigRequestV2",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),F.type.modelProperties),I.type.modelProperties),v.type.modelProperties),S.type.modelProperties),b.type.modelProperties)),z=h("LanguageInfoRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),I.type.modelProperties),v.type.modelProperties),S.type.modelProperties),b.type.modelProperties)),M=h("InstrumentationRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},g.type.modelProperties),v.type.modelProperties),I.type.modelProperties),u([["TraceId","Uuid",!0],["CritiqueGenerationTime",l],["CritiquePriority",l,!0],["CritiqueTypeId","Uuid",!0],["EventId",l,!0],["OriginalText",a],["PreContextBegin",l],["PostContextEnd",l],["SubstrateEventName",a]])),{flaggedText:{constraints:{MaxLength:2e4,MinLength:1},serializedName:"FlaggedText",required:!0,type:{name:a}},metadata:{serializedName:"Metadata",type:{name:d,element:{type:{name:r,className:"Metadatum"}}}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Dictionary",value:{type:{name:"any"}}}},suggestions:{serializedName:"Suggestions",type:{name:d,element:{type:{name:a}}}},suggestionText:{constraints:{MaxLength:2e4},serializedName:"SuggestionText",type:{name:a}}})),W=h("BrowserExtensionResponseV1",Object.assign(Object.assign(Object.assign(Object.assign({},p.type.modelProperties),m.type.modelProperties),u([["UseTileCheck","Boolean",void 0,!1],["Descriptors",a],["StyleObserverIntervalTime",l,void 0,0],["StyleSampleTime",l,void 0,0],["RootContentMaxLengthInChars",l,void 0,2e3],["SchedulerDefaultWaitingTime",l,void 0,0],["SchedulerDefaultWaitingTimeIncrement",l,void 0,0],["SchedulerDefaultMaxTime",l,void 0,0],["RefreshCritiqueWaitingTime",l,void 0,0],["RequestCritiqueDelay",l,void 0,0],["EnableDirtyRangeAutoRehydration","Boolean",void 0,!1],["TelemetryTenant",a],["LogGroupName",a],["SendToAria","Boolean",void 0,!1],["IntervalForActivityCleanup",l,void 0,0],["MaxAllowedTimeForActivities",l,void 0,0],["CalloutHoverTimeout",l,void 0,0],["MaxSuggestionItemsDisplayNumber",l,void 0,0],["EditorClientState",l],["ConfigurationId",a]])),{disabledWebSites:{serializedName:"DisabledWebSites",type:{name:d,element:{type:{name:a}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:d,element:{type:{name:a}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:d,element:{type:{name:a}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:a}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:a}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"any"}}}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:d,element:{type:{name:a}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:d,element:{type:{name:a}}}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),j=h("TileCheckResponseV1",Object.assign(Object.assign({},p.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:d,element:{type:{name:r,className:"TileCheckCritique"}}}}})),B=h("ConfigResponseV2",Object.assign(Object.assign({},p.type.modelProperties),{critiqueCategoryInfoList:{serializedName:"CritiqueCategoryInfoList",required:!0,type:{name:d,element:{type:{name:r,className:"CritiqueCategoryInfo"}}}}})),U=h("LanguageInfoResponseV1",Object.assign(Object.assign({},p.type.modelProperties),{supportedLanguages:{serializedName:"SupportedLanguages",required:!0,type:{name:d,element:{type:{name:r,className:"SupportedLanguage"}}}}})),H=h("TileCheckSpan",Object.assign(Object.assign(Object.assign({},v.type.modelProperties),u([["Start",l,void 0,0],["Length",l,void 0,"tileElement.Text.Length - span.Start"],["DoNotCheck","Boolean"]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),V=h("TileElement",Object.assign(Object.assign(Object.assign(Object.assign({},v.type.modelProperties),_.type.modelProperties),u([["Text",a,!0],["IsClean","Boolean"]])),{enabledLanguages:{serializedName:"EnabledLanguages",type:{name:d,element:{type:{name:d,element:{type:{name:r,className:"CommonLanguageIdProperty"}}}}}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},spans:{serializedName:"Spans",type:{name:d,element:{type:{name:r,className:"TileCheckSpan"}}}}})),G=h("CritiqueTypeOption",Object.assign(Object.assign({},v.type.modelProperties),u([["Id","Uuid",!0],["Name",a],["TypeName",a],["Value",a,!0]]))),Q=h("SupportedLanguage",Object.assign(Object.assign(Object.assign({},v.type.modelProperties),_.type.modelProperties),u([["SupportedCritiqueTag",a]]))),K=h("TileCheckCritique",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},N.type.modelProperties),w.type.modelProperties),L.type.modelProperties),D.type.modelProperties),u([["BucketId",l],["ExplanationTitle",a],["ExplanationLabel",a],["Explanation",a],["Status",l],["Tag",l]])),{suggestions:{serializedName:"Suggestions",type:{name:d,element:{type:{name:r,className:"Suggestion"}}}}})),$=h("EditorServicePostTileCheckHeaders",c),J=h("EditorServiceConfigV2Headers",c),Z=h("EditorServiceLanguageinfoHeaders",c),Y=h("EditorServiceInstrumentationHeaders",c),X={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},ee={parameterPath:"body",mapper:P},te={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},ie={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},ne={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},oe={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},se={parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}},re={parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},ae={parameterPath:"body",mapper:M};class le extends o.Nl{constructor(e){var t,i;e||(e={});const n="@editor/client-rest-api/2.0.0",r=e.userAgentOptions&&e.userAgentOptions.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${n}`:`${n}`,a=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),e),{userAgentOptions:{userAgentPrefix:r},baseUri:null!==(i=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri)&&void 0!==i?i:"https://nleditor.osi.officeppe.net/NLEditor"});super(a);let l=!1;if((null==e?void 0:e.pipeline)&&e.pipeline.getOrderedPolicies().length>0){l=e.pipeline.getOrderedPolicies().some((e=>e.name===s.uQ))}e&&e.pipeline&&0!=e.pipeline.getOrderedPolicies().length&&l||(this.pipeline.removePolicy({name:s.uQ}),this.pipeline.addPolicy(s.N$({credential:null==e?void 0:e.credential,scopes:`${a.credentialScopes}`,challengeCallbacks:{authorizeRequestOnChallenge:o.fj}}))),this.pipeline.removePolicy({name:s.PR}),this.pipeline.removePolicy({name:s.OD}),this.$host=e.$host||"https://nleditor.osi.officeppe.net/NLEditor"}}class de extends le{browserextension(e,t){return this.sendOperationRequest({body:e,options:t},he)}}class ce extends le{instrumentation(e,t){return this.sendOperationRequest({body:e,options:t},ge)}}const ue=o.rl(n,!1),he={path:"/api/V1/BrowserExtension",httpMethod:"POST",responses:{200:{bodyMapper:W},400:{},500:{}},requestBody:ee,urlParameters:[ie],headerParameters:[X,te,ne,oe,se],mediaType:"json",serializer:ue},ge={path:"/api/V1/Instrumentation",httpMethod:"POST",responses:{200:{headersMapper:Y},400:{},500:{}},requestBody:ae,urlParameters:[ie],headerParameters:[X,ne,oe,re,{parameterPath:"authorization",mapper:{serializedName:"Authorization",type:{name:"String"}}},{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],mediaType:"json",serializer:ue}},54147:(e,t,i)=>{function n(e,t,i){const n={};for(const o in i)n[e+"-"+o]=`${t} (${i[o]})`;return n}i.d(t,{p:()=>o});const o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (Namibi)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (Kml)","ak-gh":"Akan (Gaana)","am-et":" ()","ar-001":[" ()",!0],"ar-ae":[" (  )",!0],"ar-bh":[" ()",!0],"ar-dj":[" ()",!0],"ar-dz":[" ()",!0],"ar-eg":[" ()",!0],"ar-er":[" ()",!0],"ar-il":[" ()",!0],"ar-iq":[" ()",!0],"ar-jo":[" ()",!0],"ar-km":[" ( )",!0],"ar-kw":[" ()",!0],"ar-lb":[" ()",!0],"ar-ly":[" ()",!0],"ar-ma":[" ( )",!0],"ar-mr":[" ()",!0],"ar-om":[" ()",!0],"ar-ps":[" ( )",!0],"ar-qa":[" ()",!0],"ar-sa":[" (  )",!0],"ar-sd":[" ()",!0],"ar-so":[" ()",!0],"ar-ss":[" ( )",!0],"ar-sy":[" ()",!0],"ar-td":[" ()",!0],"ar-tn":[" ()",!0],"ar-ye":[" ()",!0],"arn-cl":"Mapudungun (Chile)","as-in":" ()","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (Espaa)","az-cyrl-az":" ()","az-latn-az":"azrbaycan (Azrbaycan)","ba-ru":" ()","bas-cm":"sa (Kmrn)","be-by":" ()","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":" ()","bin-ng":"d (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":" ()","bn-in":" ()","bo-cn":" ()","bo-in":" ()","br-fr":"brezhoneg (Fras)","brx-in":" ()","bs-cyrl-ba":" (  )","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":" ()","ca-ad":"catal (Andorra)","ca-es":"catal (catal)","ca-es-valencia":"valenci (Espanya)","ca-fr":"catal (Frana)","ca-it":"catal (Itlia)","ccp-cakm-bd":" ()","ccp-cakm-in":" ()","ce-ru":" ()","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":" (  )","co-fr":"Corsu (Francia)","cs-cz":"etina (esko)","cu-ru":" ()","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (Grnland)","dav-ke":"Kitaita (Kenya)"},n("de","Deutsch",{at:"sterreich",be:"Belgien",ch:"Schweiz",de:"Deutschland",it:"Italien",li:"Liechtenstein",lu:"Luxemburg"})),{"dje-ne":"Zarmaciine (Nier)","dsb-de":"dolnoserbina (Nimska)","dua-cm":"dul (Cameroun)","dv-mv":[" ( )",!0],"dyo-sn":"joola (Senegal)","dz-bt":" ()","ebu-ke":"Kembu (Kenya)","ee-gh":"Eegbe (Ghana nutome)","ee-tg":"Eegbe (Togo nutome)","el-cy":" ()","el-gr":" ()"}),n("en","English",{"001":"World","029":"Caribbean",150:"Europe",ae:"United Arab Emirates",ag:"Antigua & Barbuda",ai:"Anguilla",as:"American Samoa",at:"Austria",au:"Australia",bb:"Barbados",be:"Belgium",bi:"Burundi",bm:"Bermuda",bs:"Bahamas",bw:"Botswana",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",ch:"Switzerland",ck:"Cook Islands",cm:"Cameroon",cx:"Christmas Island",cy:"Cyprus",de:"Germany",dk:"Denmark",dm:"Dominica",er:"Eritrea",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",gb:"United Kingdom",gd:"Grenada",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gm:"Gambia",gu:"Guam",gy:"Guyana",hk:"Hong Kong SAR",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",je:"Jersey",jm:"Jamaica",ke:"Kenya",ki:"Kiribati",kn:"St. Kitts & Nevis",ky:"Cayman Islands",lc:"St. Lucia",lr:"Liberia",ls:"Lesotho",mg:"Madagascar",mh:"Marshall Islands",mo:"Macao SAR",mp:"Northern Mariana Islands",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mw:"Malawi",my:"Malaysia",na:"Namibia",nf:"Norfolk Island",ng:"Nigeria",nl:"Netherlands",nr:"Nauru",nu:"Niue",nz:"New Zealand",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pn:"Pitcairn Islands",pr:"Puerto Rico",pw:"Palau",rw:"Rwanda",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St Helena, Ascension, Tristan da Cunha",si:"Slovenia",sl:"Sierra Leone",ss:"South Sudan",sx:"Sint Maarten",sz:"Eswatini",tc:"Turks & Caicos Islands",tk:"Tokelau",to:"Tonga",tt:"Trinidad & Tobago",tv:"Tuvalu",tz:"Tanzania",ug:"Uganda",um:"U.S. Outlying Islands",us:"United States",vc:"St. Vincent & Grenadines",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vu:"Vanuatu",ws:"Samoa",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"})),{"eo-001":"esperanto (Mondo)"}),n("es","espaol",{419:"Latinoamrica",ar:"Argentina",bo:"Bolivia",br:"Brasil",bz:"Belice",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",do:"Repblica Dominicana",ec:"Ecuador",es:"Espaa, alfabetizacin internacional",es_tradnl:"Espaa, alfabetizacin tradicional",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"Mxico",ni:"Nicaragua",pa:"Panam",pe:"Per",ph:"Filipinas",pr:"Puerto Rico",py:"Paraguay",sv:"El Salvador",us:"Estados Unidos",uy:"Uruguay",ve:"Venezuela"})),{"et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (Kamrn)","fa-ir":[" ()",!0]}),n("ff-latn","Pulaar",{bf:"Burkibaa Faaso",cm:"Kameruun",gh:"Ganaa",gm:"Gammbi",gn:"Gine",gw:"Gine-Bisaawo",lr:"Liberiyaa",mr:"Muritani",ne:"Nijeer",ng:"Nijeriyaa",sl:"Seraa liyon",sn:"Senegaal"})),{"fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"froyskt (Danmark)","fo-fo":"froyskt (Froyar)"}),n("fr","franais",{"029":"carabes",be:"Belgique",bf:"Burkina Faso",bi:"Burundi",bj:"Bnin",bl:"Saint-Barthlemy",ca:"Canada",cd:"Congo, Rpublique dmocratique du",cf:"Rpublique centrafricaine",cg:"Congo",ch:"Suisse",ci:"Cte dIvoire",cm:"Cameroun",dj:"Djibouti",dz:"Algrie",fr:"France",ga:"Gabon",gf:"Guyane franaise",gn:"Guine",gp:"Guadeloupe",gq:"Guine quatoriale",ht:"Hati",km:"Comores",lu:"Luxembourg",ma:"Maroc",mc:"Monaco",mf:"Saint-Martin",mg:"Madagascar",ml:"Mali",mq:"Martinique",mr:"Mauritanie",mu:"Maurice",nc:"Nouvelle-Caldonie",ne:"Niger",pf:"Polynsie franaise",pm:"Saint-Pierre-et-Miquelon",re:"La Runion",rw:"Rwanda",sc:"Seychelles",sn:"Sngal",sy:"Syrie",td:"Tchad",tg:"Togo",tn:"Tunisie",vu:"Vanuatu",wf:"Wallis-et-Futuna",yt:"Mayotte"})),{"fur-it":"furlan (Italie)","fy-nl":"Frysk (Nederln)","ga-ie":"Gaeilge (ire)","gd-gb":"Gidhlig (An Roghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"Avae (Paragui)","gsw-ch":"Schwiizerttsch (Schwiiz)","gsw-fr":"Elsssisch (Frnkrisch)","gsw-li":"Schwiizerttsch (Lichteschti)","gu-in":" ()","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"lelo Hawaii (Amelika Hui P Ia)","he-il":[" ()",!0],"hi-in":" ()","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbina (Nmska)","hu-hu":"magyar (Magyarorszg)","hy-am":" ()","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Ass Igbo (Najra)","ii-cn":" ()","is-is":"slenska (sland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (Citt del Vaticano)","iu-cans-ca":" ()","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":" ()","jgo-cm":"Ndaa (Kamln)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":" (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":" ()","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"  ()","kkj-cm":"kak (Kamrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":" ()","kn-in":" ()","ko-kp":" ()","ko-kr":"()","kok-in":" ()","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":" ()","ks-deva-in":"","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamrn)","ksh-de":"Klsch (Dotschland)","ku-arab-iq":["  ()",!0],"ku-arab-ir":" ()","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":" ()","la-001":"lingua latna (World)","lag-tz":"Klaangi (Taansana)","lb-lu":"Ltzebuergesch (Ltzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"Lakliyapi (Mlahaska Tamkohe)","ln-ao":"lingla (Angla)","ln-cd":"lingla (Republki ya Kong Demokratki)","ln-cf":"lingla (Repibiki ya Afrka ya Kti)","ln-cg":"lingla (Kongo)","lo-la":" ()","lrc-iq":"  (Iraq)","lrc-ir":"  (Iran)","lt-lt":"lietuvi (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latvieu (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"Kmr (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"meta (Kamalun)","mi-nz":"te reo Mori (Aotearoa)","mk-mk":" ( )","ml-in":" ()","mn-mn":" ()","mn-mong-cn":"  (    )","mn-mong-mn":"  ( )","mni-in":" (India)","moh-ca":"Kanien'kha","mr-in":" ()","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDA (kameru)","my-mm":" ()","mzn-ir":" ()","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokml (Norge)","nb-sj":"norsk bokml (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersasssch (Dtschland)","nds-nl":"Neddersasssch (Nedderlannen)","ne-in":" ()","ne-np":" ()"}),n("nl","Nederlands",{aw:"Aruba",be:"Belgi",bq:"Bonaire, Sint Eustatius en Saba",cw:"Curaao",nl:"Nederland",sr:"Suriname",sx:"Sint-Maarten"})),{"nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"Shw ngiembn (Kmalm)","nqo-gn":[" ( )",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (Frana)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":" ()","os-ge":" ()","os-ru":" ()","pa-arab-pk":[" ()",!0],"pa-in":" ()","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prsiskan (swtai)","prs-af":[" ()",!0],"ps-af":[" ()",!0],"ps-pk":[" ()",!0]}),n("pt","portugus",{ao:"Angola",br:"Brasil",ch:"Sua",cv:"Cabo Verde",gq:"Guin Equatorial",gw:"Guin-Bissau",lu:"Luxemburgo",mo:"RAE de Macau",mz:"Moambique",pt:"Portugal",st:"So Tom e Prncipe",tl:"Timor-Leste"})),{"qps-latn-x-sh":"P Sfh","qps-ploc":"[ () !!! !!]","qps-ploca":"[  ( ) !!! !!! ]","qps-plocm":["[  ( ) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (Per)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"romn (Republica Moldova)","ro-ro":"romn (Romnia)","rof-tz":"Kihorombo (Tanzania)"}),n("ru","",{by:"",kg:"",kz:"",md:"",ru:"",ua:""})),{"rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":" ()","sah-ru":" ()","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":[" ()",!0],"sd-deva-in":" (India)","se-fi":"davvismegiella (Suopma)","se-no":"davvismegiella (Norga)","se-se":"davvismegiella (Ruoa)","seh-mz":"sena (Moambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"Sng (Kdrsse t Bafrka)","shi-latn-ma":"Tasheliyt (lmrib)","shi-tfng-ma":" ()","si-lk":" ( )","sk-sk":"slovenina (Slovensko)","sl-si":"slovenina (Slovenija)","sma-no":"arjelsaemiengele (Nrje)","sma-se":"arjelsaemiengele (Sveerje)","smj-no":"julevusmegiella (Vuodna)","smj-se":"julevusmegiella (Svierik)","smn-fi":"anarkiel (Suom)","sms-fi":"smill (Lddjnnam)","sn-latn-zw":"chiShona (Zimbabwe)"}),n("so","Soomaali",{dj:"Jabuuti",et:"Itoobiya",ke:"Kenya",so:"Soomaaliya"})),{"sq-al":"shqip (Shqipri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (Kosov)"}),n("sr-cyrl","",{ba:"  ",cs:"    ()",me:" ",rs:"",xk:""})),n("sr-latn","srpski",{ba:"Bosna i Hercegovina",cs:"Srbija i Crna Gora (Biva)",me:"Crna Gora",rs:"Srbija",xk:"Kosovo"})),{"ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (land)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)"}),n("sw","Kiswahili",{cd:"Jamhuri ya Kidemokrasia ya Kongo",ke:"Kenya",tz:"Tanzania",ug:"Uganda"})),{"syr-sy":[" ()",!0],"ta-in":" ()","ta-lk":" ()","ta-my":" ()","ta-sg":" ()","te-in":" ()","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":" ()","th-th":" ()","ti-er":" ()","ti-et":" ()","tig-er":" ()","tk-tm":"Trkmen dili (Trkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"Trke (Kbrs)","tr-tr":"Trke (Trkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":" ()","twq-ne":"Tasawaq senni (Nier)","tzm-arab-ma":["   (Morocco)",!0],"tzm-latn-dz":"Tamazit n lala (Djazar)","tzm-latn-ma":"Tamazit n lala (Meuk)","tzm-tfng-ma":" ()","ug-cn":[" (  )",!0],"uk-ua":" ()","ur-in":[" ()",!0],"ur-pk":[" ()",!0],"uz-arab-af":" ()","uz-cyrl-uz":" ()","uz-latn-uz":"ozbek (Ozbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":" ()","ve-za":"Tshivena (South Africa)","vi-vn":"Ting Vit (Vit Nam)","vo-001":"Volapk (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":" ()","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (Kemeln)","yi-001":[" ()",!0],"yo-bj":"d Yorb (Orlde Bn)","yo-ng":"d Yorb (Oril-d Njr)","zgh-tfng-ma":" ()","zh-cn":"()","zh-hk":"()","zh-hans-hk":" ()","zh-hans-mo":" ()","zh-mo":"()","zh-sg":"()","zh-tw":"()","zu-za":"isiZulu (iNingizimu Afrika)"})},91450:(e,t,i)=>{i.d(t,{Y:()=>n});const n={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azrbaycan"],"az-cyrl":["az-Cyrl-AZ"," ()"],"az-latn":["az-Latn-AZ","Azrbaycanl (Latn)"],ba:"ba-RU",bas:["bas-CM","sa"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN",""],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA"," ()"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER",""],ca:"ca-ES",ccp:["ccp-Cakm-BD",""],"ccp-cakm":["ccp-Cakm-BD"," ()"],ce:["ce-RU",""],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU",""],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","dul"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT",""],ebu:["ebu-KE","Kembu"],ee:["ee-GH","Eegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA"," ()"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kak"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN",""],"ks-arab":["ks-Arab-IN"," ()"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","Klsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","Klaangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","Lakliyapi"],ln:["ln-CD","lingla"],lo:"lo-LA",lrc:["lrc-IR"," "],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","Kmr"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","meta"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN",""],mn:["mn-MN",""],"mn-cyrl":["mn-MN"," ( )"],"mn-mong":["mn-Mong-CN","  ( )"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDA"],my:["my-MM",""],mzn:["mzn-IR",""],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersasssch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","Shw ngiembn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE",""],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prsiskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","Sng"],shi:["shi-Tfng-MA",""],"shi-latn":["shi-Latn-MA","Tasheliyt (Latin)"],"shi-tfng":["shi-Tfng-MA"," (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS"," ()"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ",""],"tg-cyrl":["tg-Cyrl-TJ"," ()"],th:"th-TH",ti:"ti-ER",tig:["tig-ER",""],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","Tamazit n lala"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","Tamazit n lala (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF"," ()"],"uz-cyrl":["uz-Cyrl-UZ"," ()"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR",""],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR"," (Vai)"],ve:["ve-ZA","Tshivena"],vi:"vi-VN",vo:["vo-001","Volapk"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET",""],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001",""],yo:"yo-NG",zgh:["zgh-Tfng-MA",""],"zgh-tfng":["zgh-Tfng-MA"," (Tifinagh)"],zh:["zh-CN",""],"zh-hans":"zh-CN","zh-hant":["zh-HK","()"],zu:"zu-ZA"}},63326:(e,t,i)=>{var n,o,s,r,a,l,d,c,u,h,g;i.d(t,{ED:()=>n,fT:()=>o,xp:()=>h}),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(s||(s={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(r||(r={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(d||(d={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(c||(c={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(u||(u={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(h||(h={})),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One"}(g||(g={}))},10730:(e,t,i)=>{i.d(t,{f:()=>s});var n=i(23182),o=i(29906);let s=class{get critiqueCallout(){return{goPremium:{forcedColorAdjust:"none",msHighContrastAdjust:"none",backgroundColor:"window",color:"windowtext"},goPremiumLink:{color:"highlight"}}}get tooltip(){return{tooltipMain:{background:"window",boxShadow:"none",border:"1px solid windowframe"},title:{color:"windowtext"},text:{color:"windowtext"}}}};s=(0,n.__decorate)([(0,o._)()],s)},9210:(e,t,i)=>{i.d(t,{U:()=>u});var n,o=i(23182);!function(e){e.focused="1px solid #605e5c",e.none="none"}(n||(n={}));var s=i(61033),r=i(16417),a=i(55695),l=i(56489);const d=e=>{let t="'Segoe UI'";if(e)switch(e.toLowerCase()){case"ar":t="'Segoe UI Web (Arabic)'";break;case"bg-bg":case"ru-ru":case"uk-ua":t="'Segoe UI Web (Cyrillic)'";break;case"cs-cz":case"et-ee":case"hr-hr":case"hu-hu":case"lt-lt":case"lv-lv":case"pl-pl":case"lt-sr-sp":case"tr-tr":case"sk-sk":case"kk-kz":t="'Segoe UI Web (East European)'";break;case"el-gr":t="'Segoe UI Web (Greek)'";break;case"he-il":t="'Segoe UI Web (Hebrew)'";break;case"vi-vn":t="'Segoe UI Web (Vietnamese)'";break;case"ja-jp":t="YuGothic, 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka";break;case"ko-kr":t="'Malgun Gothic', Gulim";break;case"ch-zhs":t="'Microsoft Yahei', Verdana, Simsun";break;case"ch-zht":t="'Microsoft Jhenghei', Pmingliu";break;case"hi-in":t="'Nirmala UI'";break;case"th-th":t="'Leelawadee UI Regular', 'Kmer UI'";break;default:t="'Segoe UI Web (West European)'"}return`${t}, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif`};var c=i(29906);let u=class{constructor(e,t){this.uxLanguageCode=e,this.themeStore=t,this._calloutZIndex=Number.MAX_SAFE_INTEGER-1}get critiqueCallout(){return{shadowHost:{all:"initial",position:"absolute",zIndex:this._calloutZIndex},calloutMain:{root:{fontFamily:d(this.uxLanguageCode),borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:[{borderRadius:8,MsHighContrastAdjust:"auto",fontFamily:d(this.uxLanguageCode)}]},calloutV9:{fontFamily:d(this.uxLanguageCode),borderRadius:8}}}get undoCallout(){return{buttonIcon:{icon:{color:s.kd.black},root:{selectors:{"&.ms-editor-focus":{border:n.focused}}},borderRadius:"2px"},logoButtonBase:{cursor:"default",pointerEvents:"all",lineHeight:"24px",fontSize:a.s.size12,fontWeight:a.BO.semibold,WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",padding:0,margin:"0 8px",flexGrow:0,whiteSpace:"nowrap",overflow:"visible",color:r.m.palette.blue,alignSelf:"center"},calloutContainer:{height:"40px",borderRadius:"4px",padding:"4px"},calloutMain:{root:{borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:{borderRadius:8,MsHighContrastAdjust:"auto"}},calloutV9:{fontFamily:d(this.uxLanguageCode),borderRadius:8}}}get tooltip(){var e,t,i,n,o;const s=null===(e=this.themeStore)||void 0===e?void 0:e.getComponentActiveTheme(l.yF.squiggleTooltipComponentName);return{container:{all:"initial",position:"absolute",zIndex:Number.MAX_SAFE_INTEGER},shadowBoundary:{all:"initial"},shadowRoot:{width:"0px !important",height:"0px !important",overflowX:"hidden"},root:{position:"fixed",maxWidth:300,background:"transparent",border:"none",cursor:"default"},tooltipMain:{msHighContrastAdjust:"none",forcedColorAdjust:"none",fontFamily:d(this.uxLanguageCode),fontSize:"12px",fontWeight:600,background:null!==(t=null==s?void 0:s.background)&&void 0!==t?t:r.m.palette.white,padding:"6px 12px",display:"inline-block",boxShadow:null!==(i=null==s?void 0:s.shadow)&&void 0!==i?i:"0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",border:"none",borderRadius:4},title:{marginBottom:"4px",color:null!==(n=null==s?void 0:s.text)&&void 0!==n?n:r.m.palette.neutralSecondary},text:{color:null!==(o=null==s?void 0:s.altText)&&void 0!==o?o:r.m.palette.black}}}};u=(0,o.__decorate)([(0,c._)()],u)},26230:(e,t,i)=>{i.d(t,{Y:()=>v,bb:()=>T,c$:()=>y});var n=i(23182),o=i(28798),s=i(51451),r=i(1297),a=i(63526),l=i(18349),d=i(28710),c=i(23466),u=i(19728),h=i(17298),g=i(29906),p=i(83010),m=i(27603),f=i(37814);const v=(0,h.f)("IDefaultStyleDefinitionsFactory"),_=(0,h.f)("IDefaultStyleOverrides"),y=(0,h.f)("IHighContrastStyleOverrides"),I=(0,h.f)("IRightToLeftUxStyleOverrides"),C=(0,h.f)("IRightToLeftUxFabricStyleOverrides"),S=(0,h.f)("IRightToLeftProofingStyleOverrides"),b=(0,h.f)("IRightToLeftProofingFabricStyleOverrides");let T=class{constructor(e,t,i,n,a,l,d,c,u,h,g,p){this.scriptDirectionDetector=e,this.highContrastModeDetector=t,this.proofingStore=i,this.emitter=n,this.defaultStyleDefinitionsFactory=l,this.highContrastStyleOverrides=d,this.rtlUxStyleOverrides=c,this.rtlUxFabricStyleOverrides=u,this.rltProofingStyleOverrides=h,this.rltProofingFabricStyleOverrides=g,this.styleOverrides=p,this.onProofingLanguageChanged=e=>{this.styles=this.defineStyles()},this.defineStyles=()=>{const e=this.defaultStyleDefinitionsFactory(this.uxLanguage);return this.styleOverrides?{critiqueCallout:this.applyOverrides(e.critiqueCallout,this.styleOverrides.critiqueCallout),undoCallout:this.applyOverrides(e.undoCallout,this.styleOverrides.undoCallout),tooltip:this.applyOverrides(e.tooltip,this.styleOverrides.tooltip)}:e},this.getAdjustedStyle=e=>{let t=this.styles[e];const i=this.scriptDirectionDetector.isRtl();i&&this.rtlUxStyleOverrides&&(t=this.applyOverrides(t,this.rtlUxStyleOverrides[e])),this.rtlUxFabricStyleOverrides&&(i&&document.dir!==o.K3.rtl||!i&&document.dir===o.K3.rtl)&&(t=this.applyOverrides(t,this.rtlUxFabricStyleOverrides[e]));const n=this.scriptDirectionDetector.getProofingLanguageDir();return(n===o.K3.rtl||n===o.K3.auto&&i)&&this.rltProofingStyleOverrides&&(t=this.applyOverrides(t,this.rltProofingStyleOverrides[e])),document.dir===o.K3.rtl&&this.rltProofingFabricStyleOverrides&&(t=this.applyOverrides(t,this.rltProofingFabricStyleOverrides[e])),this.highContrastModeDetector.enabled&&this.highContrastStyleOverrides&&(t=this.applyOverrides(t,this.highContrastStyleOverrides[e])),t},this.applyOverrides=(e,t)=>{if(!t)return e;const i={};for(const n of Object.keys(e))i[n]=Object.assign(Object.assign({},e[n]),t[n]);return i},this.uxLanguage=a.getUILanguage(),this.styles=this.defineStyles(),this.proofingStore.read(s.l.ProofingLanguages).then((e=>{this.onProofingLanguageChanged(r.I.getDefaultLanguageCode(e))})).catch((()=>{})),this.emitter.on("proofingLanguageChanged",(async e=>{this.onProofingLanguageChanged(e.data.defaultLanguageCode)})),(0,f.Gn)(this)}get critiqueCallout(){return this.getAdjustedStyle("critiqueCallout")}get undoCallout(){return this.getAdjustedStyle("undoCallout")}get tooltip(){return this.getAdjustedStyle("tooltip")}};(0,n.__decorate)([u.observable],T.prototype,"styles",void 0),(0,n.__decorate)([u.computed],T.prototype,"critiqueCallout",null),(0,n.__decorate)([u.computed],T.prototype,"undoCallout",null),(0,n.__decorate)([u.computed],T.prototype,"tooltip",null),(0,n.__decorate)([u.action],T.prototype,"onProofingLanguageChanged",void 0),T=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(o.iw)),(0,n.__param)(1,(0,p.W)(c.P)),(0,n.__param)(2,(0,p.W)(a.K)),(0,n.__param)(3,(0,p.W)(l.o)),(0,n.__param)(4,(0,p.W)(d.v)),(0,n.__param)(5,(0,p.W)(v)),(0,n.__param)(6,(0,m.l)()),(0,n.__param)(6,(0,p.W)(y)),(0,n.__param)(7,(0,m.l)()),(0,n.__param)(7,(0,p.W)(I)),(0,n.__param)(8,(0,m.l)()),(0,n.__param)(8,(0,p.W)(C)),(0,n.__param)(9,(0,m.l)()),(0,n.__param)(9,(0,p.W)(S)),(0,n.__param)(10,(0,m.l)()),(0,n.__param)(10,(0,p.W)(b)),(0,n.__param)(11,(0,m.l)()),(0,n.__param)(11,(0,p.W)(_))],T)},39099:(e,t,i)=>{i.d(t,{l:()=>Se});i(42410);var n=i(8018),o=i(14945),s=i(88241),r=i(51451),a=i(63526),l=i(37053),d=i(15661),c=i(24111),u=i(99724),h=i(58550),g=i(42007),p=i(8475),m=i(57734),f=i(91677),v=i(6701),_=i(5045),y=i(85681),I=i(71975),C=i(63519),S=i(17298);const b=(0,S.f)("ICritiqueValueStore");var T=i(78426),E=i(81174);const N=(0,S.f)("IDexLitePaneStore");var x=i(19728);const w=(e,t)=>0===e.localeCompare(t,[],{sensitivity:"base"}),L=(e,t)=>{if(w(e,"Grammar")||w(e,"Spelling"))return[];const i=[];return t.forEach((e=>{(e=>{const t=["en","es","de","fr"];for(const i of t)if(w(i,e))return!0;return!1})(e)&&i.push(e.toLocaleUpperCase())})),t.length===i.length?[]:i};const D=(0,x.action)(((e,t)=>{e.count=Math.max(0,t),0===e.count&&(e.isCritiqueSelected=!1)})),F=(0,x.action)(((e,t)=>{e.isCritiqueSelected=t})),A=(0,x.action)(((e,t)=>{e.multilingualTagsStore.languageTags=(0,x.observable)(L(e.category,t))})),R=(0,x.action)(((e,t)=>{e.isProofingDisabled=void 0!==e.id&&t.includes(e.id)})),q=(0,x.action)(((e,t,i)=>{const n=e.proofingItems.get(t);n&&D(n,i)})),P=(0,x.action)(((e,t,i)=>{const n=e.proofingItems.get(t);n&&F(n,i)})),O=(0,x.action)((e=>{e.proofingItems.forEach((e=>{F(e,!1)}))})),k=((0,x.action)(((e,t,i)=>{O(e),P(e,t,i)})),(0,x.action)(((e,t)=>{e.proofingItems.forEach((e=>{A(e,t)}))}))),z=(0,x.action)(((e,t)=>{e.proofingItems.forEach((e=>{R(e,t)}))})),M=((0,x.action)(((e,t)=>{const i=e.proofingItems.get(t);i&&D(i,i.count+1)})),(0,x.action)(((e,t)=>{const i=e.proofingItems.get(t);i&&D(i,i.count>0?i.count-1:0)})),(0,x.action)((e=>{e.proofingItems.forEach((e=>{D(e,0)}))})),(0,x.action)(((e,t)=>{e.isEnabled=t}))),W=((0,x.action)((e=>{e.isEnabled=!e.isEnabled})),(0,x.action)(((e,t,i)=>{q(e.correctionsStore,t,i),q(e.refinementsStore,t,i),q(e.sensitivityStore,t,i),q(e.enhancementsStore,t,i)})),(0,x.action)((e=>{O(e.correctionsStore),O(e.refinementsStore),O(e.sensitivityStore),O(e.enhancementsStore)})),(0,x.action)(((e,t,i)=>{i&&(O(e.correctionsStore),O(e.refinementsStore),O(e.sensitivityStore),O(e.enhancementsStore)),P(e.correctionsStore,t,i),P(e.refinementsStore,t,i),P(e.sensitivityStore,t,i),P(e.enhancementsStore,t,i)})),(0,x.action)(((e,t)=>{k(e.correctionsStore,t),k(e.refinementsStore,t),k(e.sensitivityStore,t),k(e.enhancementsStore,t)}))),j=((0,x.action)(((e,t)=>{M(e.textPredictionSettingStore,t)})),(0,x.action)(((e,t)=>{e.isPremiumUser=t}))),B=(0,x.action)(((e,t)=>{z(e.correctionsStore,t),z(e.refinementsStore,t)}));var U=i(56489),H=i(44404),V=i(24850),G=i(91764),Q=i(38922),K=i(81876),$=i(20255),J=i(89455),Z=i(48662),Y=i(98647),X=i(18349),ee=i(1297),te=i(25622),ie=i(45352),ne=i(27018),oe=i(22649),se=i(84030),re=i(8628),ae=i(63258),le=i(33727),de=i(21203),ce=i(38417),ue=i(51037),he=i(81427),ge=i(8498),pe=i(54425),me=i(53356),fe=i(74204),ve=i(21592);class _e{constructor(e,t,i,n=void 0,o,s,r=new Date){this.hostSettings=e,this.isEditorClientShutdown=!1,this.isInitialized=!1,this.isUXInitialized=!1,this._proofingDisabled=!1,this.onWindowUnloaded=()=>{this.shutDown()},this.rootInjector=(0,fe.p)(this,e,n,o,t,i,s),this.diContainer=this.rootInjector.container,this.roamingDictionaryFeatureObj=this.diContainer.get(K.Zp),this.externalSettingsFeatureObj=this.diContainer.get($.In),this.userInfoUpdater=this.diContainer.get(J.M),this.hostEmitter=this.diContainer.get(u.M5),this.logger=this.diContainer.get(l.g),this.proofingDom=this.diContainer.get(le.w),this.proofingPersistedStore=this.diContainer.get(a.K),this.featureFlagReader=this.diContainer.get(Z.c),e.enableOrchestration&&(this.orchestrator=this.diContainer.get(ce.J)),window.frameElement&&(this.windowEventListener=new Y.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnloaded)),this._editorInitializationStartTime=r}registerTextTileEventListener(e){try{return this.hostEmitter.on(u.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983245,"Failed to register hostModelTextTile listener",e),!1}}registerDeltaEventListener(e){try{return this.hostEmitter.on(u.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983244,"Failed to register hostModelDelta listener",e),!1}}registerTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.on(u.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257550,"Failed to register hostModelTextTileEmittedToAugloop listener",e),!1}}unregisterTextTileEventListener(e){try{return this.hostEmitter.off(u.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983243,"Unable to unregister hostModelTextTile listener - no listener registered",e),!1}}unregisterDeltaEventListener(e){try{return this.hostEmitter.off(u.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983242,"Unable to unregister hostModelDelta listener - no listener registered",e),!1}}unregisterTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.off(u.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257549,"Unable to unregister hostModelTextTileEmittedToAugloop listener - no listener registered",e),!1}}async setLocale(e){let t="string"==typeof e?[e]:e;0===t.length&&(t=[this.hostSettings.defaultLocale]);const i=await this.proofingPersistedStore.read(r.l.ProofingLanguages),n=t.toString()!==i.toString();await this.proofingPersistedStore.write(r.l.ProofingLanguages,t),this.diContainer.get(X.o).emit("proofingLanguageChanged",{data:new ee.I(t),messageType:o.G.ChangeData,proofingLanguagesChanged:n})}async setMultiLingualProofingLocales(e){await this.setLocale(e)}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.proofingPersistedStore.write(r.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(m.D).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.proofingPersistedStore.read(r.l.EnableSpelling)}async isGrammarEnabled(){return this.proofingPersistedStore.read(r.l.EnableGrammar)}async areRefinementsEnabled(){return this.proofingPersistedStore.read(r.l.EnableRefinements)}async _enableDisableSpelling(e){await this.proofingPersistedStore.read(r.l.EnableSpelling)!==e&&(await this.proofingPersistedStore.write(r.l.EnableSpelling,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableGrammar(e){await this.proofingPersistedStore.read(r.l.EnableGrammar)!==e&&(await this.proofingPersistedStore.write(r.l.EnableGrammar,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableRefinements(e){await this.proofingPersistedStore.read(r.l.EnableRefinements)!==e&&(await this.proofingPersistedStore.write(r.l.EnableRefinements,e),this._emitEnabledCritiqueTypesChanged())}_refreshTileNodes(){this.diContainer.get(p.G).pollNodes(o.G.ChangeData,this.proofingDom.tileNodes,s.Q.Code,void 0,!0)}clearResources(){const e=this.diContainer.getOptional(de.s);null==e||e.clearIgnoredWords()}shutDown(){var e,t,i,n;if(!this.isEditorClientShutdown)try{this.isEditorClientShutdown=!0,null===(e=this.diContainer.getOptional(ge.H))||void 0===e||e.logTelemetry(),this.diContainer.unbind(te.jh),this.diContainer.unbind(te.sh),this.diContainer.unbind(te.q4),this.diContainer.unbind(te.Ze),this.diContainer.unbind(te.cg),this.diContainer.unbind(te.oA),this.clearResources(),this.diContainer.get(pe.W).shutDown(),null===(t=this.windowEventListener)||void 0===t||t.removeAllListeners(),this.windowEventListener=void 0,null===(i=this.orchestrator)||void 0===i||i.shutDown(),this.diContainer.get(ie.V).shutDown(),this.diContainer.get(me.J).clear()}catch(e){this.logger.error(520983241,"error while shutting down the editor client.",e),null===(n=this.onError)||void 0===n||n.call(this,"Error while shutting down the editor client.",e)}}logout(){this.hostEmitter.emit(u.pD.logout,{address:void 0,message:void 0})}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}updateUserInfo(e){this.userInfoUpdater.update(e)}async initialize(e){this.isEditorClientShutdown||(await this.initializeSDK(),await this.initializeUX(e))}async initializeSDK(){var e;if(this.isEditorClientShutdown)return;if(this.isInitialized)return;this.isInitialized=!0,(0,x.configure)({enforceActions:"observed"});const t=(0,ve.$)();if(await(null==t?void 0:t.loadLocale(this.hostSettings.defaultLocale)),await(null===(e=this.orchestrator)||void 0===e?void 0:e.initialize()),!this.isEditorClientShutdown){await this.diContainer.get(ne.H).initializeComponent();try{await this.diContainer.get(oe.e).executeAsync(!0)}catch(e){}}}async initializeUX(e){var t,i,n;if(!this.isEditorClientShutdown&&!this.isUXInitialized){this.isUXInitialized=!0;try{this.diContainer.bind(te.jh).toValue(new se.O(null!=e?e:document)),this.diContainer.bind(te.sh).toValue(new se.O(null!==(t=(null!=e?e:document).defaultView)&&void 0!==t?t:window)),await this.diContainer.get(pe.W).initializeComponent()}catch(e){this.logger.error(509634378,"Failed to initialize ux",e),null===(i=this.onError)||void 0===i||i.call(this,"Failed to initialize ux.",e)}null===(n=this.diContainer.getOptional(he.$))||void 0===n||n.schedule(1e3,3e5),await this.initLocale(this.hostSettings.defaultLocale),this.languageDetectionSubscriber=this.diContainer.getOptional(ue.X),this.logEditorInitializationComplete()}}logEditorInitializationComplete(){const e=new Date,t=[(0,re.n)("initializationEndTime",e.toISOString()),(0,re.n)("initializationStartTime",this._editorInitializationStartTime.toISOString()),(0,re.n)("initializationTime",e.getTime()-this._editorInitializationStartTime.getTime())];if(this.featureFlagReader.flags.enableLoggingModulesAndBindings){const e=this.diContainer.getBindings().map((e=>`${"function"!=typeof e.token?e.token.toString():e.token.name}: [${e.boundServices.map((e=>{var t;return null===(t=e.cache)||void 0===t?void 0:t.constructor.name}))}]`)).toString();t.push((0,re.n)("addedModuleClassNamesSize",this.rootInjector.addedModuleClassNames.size),(0,re.n)("addedModuleClassNames",[...this.rootInjector.addedModuleClassNames].join(", ")),(0,re.n)("modulesSharingSameModuleKeyButDifferentClassname",[...this.rootInjector.modulesSharingSameModuleKeyButDifferentClassname].join(", ")),(0,re.n)("bindings",e))}this.logger.logActivity("EditorInitializationComplete",void 0,t)}async initLocale(e){await this.setLocale(e)}setAvailableCritiqueTypes(e,t){const i=this.diContainer.getOptional(m.D);i&&(i.setAvailableCritiqueTypes(e,t),this._emitEnabledCritiqueTypesChanged())}async setPaneOnlyOverriddenCritiqueTypeOptions(e){const t=this.diContainer.getOptional(f.M);t&&(await this.proofingPersistedStore.write(r.l.PaneOverriddenCritiqueTypeOptions,e),t.setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}setAvailablePaneOnlyCritiqueTypes(e){const t=this.diContainer.getOptional(f.M);t&&(t.setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}_emitEnabledCritiqueTypesChanged(){this.diContainer.get(X.o).emit("enabledCritiqueTypesChanged",{messageType:o.G.ChangeData})}async disableProofing(){var e;if(this._proofingDisabled)return!0;if(!this.orchestrator)return!1;const t=await this.orchestrator.deactivateAnnotations([ae.nL.getTypeName()]);for(const t of this.proofingDom.tileNodes)this.hostEmitter.emit(u.pD.clearCritiquesForNode,{message:{nodeId:t.id,seqId:(null!==(e=t.eventSeqId)&&void 0!==e?e:0).toString()},address:void 0});return this._proofingDisabled=!0,t}async enableProofing(){var e,t;if(!this._proofingDisabled)return;if(null===(e=this.orchestrator)||void 0===e?void 0:e.activateAnnotations([ae.nL.getTypeName()])){for(const e of this.proofingDom.tileNodes)this.hostEmitter.emit(u.pD.restoreNodeForCritiqueStore,{message:{nodeId:e.id,seqId:(null!==(t=e.eventSeqId)&&void 0!==t?t:0).toString()},address:void 0});this._refreshTileNodes(),this._emitEnabledCritiqueTypesChanged(),this._proofingDisabled=!1}}addWordsToIgnoreList(e){const t=this.diContainer.getOptional(de.s);null==t||t.addWordsToIgnoreList(e)}setLanguageDetectedCallback(e){var t;null===(t=this.languageDetectionSubscriber)||void 0===t||t.setLanguageDetectedOnSignalCallback(e)}}var ye=i(41505),Ie=i(54058),Ce=i(14253);class Se extends _e{constructor(e,t,i,o=void 0,s,r,a=new Date){super(e,t,i,o,s,r,a),this.critiqueSuggestionClearanceCallbacks=[],this.updateDarkMode=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDarkMode(e)},this.getComponentsSupportedForTheming=()=>{var e,t;return null!==(t=null===(e=this.themeStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.updateDefaultTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDefaultTheme(e)},this.updateCurrentTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateCurrentTheme(e)},this.getComponentsSupportedForStyling=()=>{var e,t;return null!==(t=null===(e=this.styleStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.isPremiumUser=this.diContainer.get(n.r),this.themeStore=this.diContainer.getOptional(U.YQ),this.styleStore=this.diContainer.getOptional(U.UC),this.themeStore&&U.Cx.forEach(((e,t)=>{var i;null===(i=this.themeStore)||void 0===i||i.updateComponentThemes(t,e)})),this.styleStore&&U.w.forEach(((e,t)=>{var i;null===(i=this.styleStore)||void 0===i||i.updateComponentStyle(t,e)}))}async initLocale(e){var t,i;const n=null!==(i=this.hostSettings.isMultilingualProofingEnabled&&(null===(t=this.hostSettings.proofingLocales)||void 0===t?void 0:t.length)?this.hostSettings.proofingLocales:void 0)&&void 0!==i?i:[e];await this.setLocale(n),await this.setUiLocale(e)}async setLocale(e){const t="string"==typeof e?[e]:e;await super.setLocale(t);const i=this.diContainer.getOptional(N);i&&W(i,t)}async setUiLocale(e){var t;const i=(0,ve.$)().loadLocale(e);await i;const n=this.diContainer.getOptional(N);if(n){const t=this.diContainer.get(ye.N);await(async(e,t,i)=>{await i.setUiLocale(t),(0,x.runInAction)((()=>{e.uiLocale=t,e.correctionsStore.proofingItems.forEach((e=>{e.labelText=i.isCategorySupportedInCurrentUiLanguage(e.category)?i.toUiLocale(e.category):""})),e.refinementsStore.proofingItems.forEach((e=>{e.labelText=i.isCategorySupportedInCurrentUiLanguage(e.category)?i.toUiLocale(e.category):""}))}))})(n,e,t)}else if(this.diContainer.getOptional(ye.C))try{const t=this.diContainer.get(ye.C);await t.setUiLocale(e)}catch(i){this.logger.error(507885057,"Failed to initialize categories locale for: "+e,i),null===(t=this.onError)||void 0===t||t.call(this,"Failed to initialize categories locale for: "+e,i)}}setLocaleForTile(e,t){const i=this.proofingDom.findTileNode(e);if(!i)return!1;i.specifiedLocale=t,i.resetState();this.diContainer.get(h.$).resetNode(i.id);return this.diContainer.get(p.G).pollNodes(o.G.NewData,[i],s.Q.Code,void 0,!0),!0}registerCustomIconSet(e){for(const t of Object.keys(e))(0,Q.Z)(t,e[t])}async setBothOverrideAndPaneOnlyOverriddenCritiqueTypeOptions(e,t){await this.proofingPersistedStore.write(r.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(m.D).setOverriddenCritiqueTypes(e);const i=this.diContainer.getOptional(f.M);i&&(await this.diContainer.get(a.K).write(r.l.PaneOverriddenCritiqueTypeOptions,t),i.setOverriddenCritiqueTypes(t)),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}setDisabledCategories(e){const t=this.diContainer.get(N);B(t,e)}userInputEvent(){const e=this.diContainer.get(H.$);(0,V.sw)(e)}setAvailableStealthCritiqueTypes(e){this.hostSettings.enableStealthSquiggles&&(this.diContainer.get(v.a).setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}setOverriddenStealthCritiqueTypes(e){this.hostSettings.enableStealthSquiggles&&(this.diContainer.get(v.a).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}setPremiumCritiqueTypes(e){this.diContainer.get(_.g).setPremiumCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}setPreviewCritiquesCount(e,t){const i=this.diContainer.get(y.Ey);i.setPreviewModeActive(!0),i.setPreviewCount(e,!0),i.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(y.Ey).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(y.Ey).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(y.Ey).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(y.Ey).setOnPreviewCritiquesCountChange(e)}onDisableCritique(e){this.diContainer.get(I.W).setOnDisableCritique(e)}onFeedbackIconClicked(e){this.diContainer.get(C.M).setOnFeedbackIconClicked(e)}async setLanguageValueFromConfigResponses(e,t,i){const n=this.diContainer.get(b);await n.setLanguageValueFromConfigResponses(e,t,i)}onApplyCritiqueSuggestion(e,t){const i=this.diContainer.get(g.a).handleApplyCritiqueSuggestion(e,t);this.critiqueSuggestionClearanceCallbacks.push(i)}exp_getActivityLogger(){return this.diContainer.get(l.g)}exp_getOaLogger(){return this.diContainer.get(d.m)}exp_getQueryDetection(){return this.diContainer.get(c.J)}onTryPremiumPreview(e){this.diContainer.get(y.Ey).setOnTryPremiumPreview((t=>{e(t);const i=this.diContainer.getOptional(N);if(!i)return;const n=this.diContainer.get(H.$);j(i,!0),(0,G.it)(n,!1)}))}onPremiumPreviewExpired(e){this.diContainer.get(y.Ey).setOnPremiumPreviewExpired((()=>{e();const t=this.diContainer.getOptional(N);if(!t)return;const i=this.diContainer.get(H.$);j(t,!1),(0,G.it)(i,!0)}))}setOnOpenEditorPane(e){const t=this.diContainer.get(H.$);(0,G.lm)(t,e)}getComponentThemes(e){var t;return null===(t=this.themeStore)||void 0===t?void 0:t.getComponentThemes(e)}getDefaultTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.defaultTheme}getCurrentTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme}updateComponentThemes(e,t){var i;null===(i=this.themeStore)||void 0===i||i.updateComponentThemes(e,t)}getComponentStyle(e){var t;return null===(t=this.styleStore)||void 0===t?void 0:t.getComponentStyle(e)}updateComponentStyle(e,t){var i;null===(i=this.styleStore)||void 0===i||i.updateComponentStyle(e,t)}updateFluentThemes(e){var t;null===(t=this.themeStore)||void 0===t||t.updateFluentThemes(e)}setOnCritiqueAdded(e){const t=this.diContainer.get(H.$);(0,G.m)(t,e)}exp_externalInlineSuggestionAction(e){var t;if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)if("signalSent"===e){this.diContainer.get(u.M5).emit(u.pD.oaAnnotationsTriggered,{address:void 0,message:void 0})}else if("ClearDetectedQuery"===e){this.diContainer.get(c.J).removeDetectedQuery()}else{this.diContainer.get(Ie.I).handleExternalKeyboardEvents(e,!1)}}enableInlineSuggestionsMenu(e,t,i,n,o,s,r,a,l,d,c,u,h,g,p,m,f,v,_,y,I,C,S,b){var T;if(null===(T=this.hostSettings.oaSettings)||void 0===T?void 0:T.isContextualCardEnabled){this.diContainer.get(Ce.V).enableInlineSuggestionsMenu(e,t,i,n,o,s,r,a,l,d,c,u,h,g,p,m,f,v,_,y,I,C,S,b)}}disableInlineSuggestionsMenu(e){var t;if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled){this.diContainer.get(Ce.V).disableInlineSuggestionsMenu(e)}}showInlineSuggestionsMenuWithItems(e,t,i,n,o,s,r,a){var l;if(null===(l=this.hostSettings.oaSettings)||void 0===l?void 0:l.isContextualCardEnabled){return this.diContainer.get(Ce.V).renderMenuWithItems(e,t,i,n,o,s,r,a)}return Promise.resolve(!1)}async showExistingMenu(e,t,i,n,o,s,r,a,l,d){var c;if(null===(c=this.hostSettings.oaSettings)||void 0===c?void 0:c.isContextualCardEnabled){const c=this.diContainer.get(Ce.V);await c.showExistingMenu(e,t,i,n,o,s,r,a,l,d)}}async showExistingMenuAtCursor(e,t,i){var n;if(!(null===(n=this.hostSettings.oaSettings)||void 0===n?void 0:n.isContextualCardEnabled))return;const o=this.diContainer.get(T.d),s=await o.getTextSelection();(null==s?void 0:s.endParagraphNode)&&void 0!==s.endPositionInParagraphNode&&await this.showExistingMenu(s.endParagraphNode.id,s.endPositionInParagraphNode-e,e,t,!1,i)}async insertAndDisplayInlineSuggestionsMenu(e,t,i){var n;if(!e)return!1;if(null===(n=this.hostSettings.oaSettings)||void 0===n?void 0:n.isContextualCardEnabled){const n=this.diContainer.get(T.d);let o,s;if(t&&i){const e=this.proofingDom.findParagraphNode(t);if(!(0,E.l)(e))return!1;o=e.parent,s=await n.getNodeInsertionPosition(o,e.element.offset+i,!0)}else{const e=await n.getTextSelection();if(!e||e.startParentElement.id!==e.endParentElement.id)return!1;o=e.startParentElement,s=e.startPosition===e.endPosition?await n.getNodeInsertionPosition(o,e.startPosition,!0):await n.getRangeOfNode(o,void 0,e.startPosition,e.endPosition-e.startPosition)}return!!s&&(await n.insert(o,void 0,0,e,!0,s,!0),!0)}return!1}shutDown(){try{super.shutDown();for(const e of this.critiqueSuggestionClearanceCallbacks)e();this.critiqueSuggestionClearanceCallbacks=[]}catch(e){this.logger.error(509690076,"error while shutting down the editor client.",e)}}notifyMenuTriggeringMethod(e){this.diContainer.get(Ce.V).notifyMenuTriggeringMethod(e)}}},37876:(e,t,i)=>{i.d(t,{M:()=>a});var n=i(23182),o=i(21592);class s{static hash(e){let t=0,i=0;for(;i<e.length;)t=(t<<5)-t+e.charCodeAt(i++)|0;return t>0?t:-1*t}static format(e,...t){const i=t.length;return e.replace(/\{(\d+)\}/g,((e,n)=>n<i?t[n]:e))}static trimLeft(e){return e.replace(/^\s+/,"")}static trimRight(e){return e.replace(/\s+$/,"")}}var r=i(29906);let a=class{getMessage(e,t){const i=(0,o.$)(),n=i.getString("OnCanvasCalloutStrings",e)||i.getString("CopywriterStrings",e)||i.getString("EditorBrowserExtensionStrings",e)||i.getString("AiInsertStrings",e)||i.getString("InlineSuggestionStrings",e)||"";if(void 0===t)return n;const r=Array.isArray(t)?t:[t];return s.format(n,...r)}};a=(0,n.__decorate)([(0,r._)()],a)},61827:(e,t,i)=>{if(i.d(t,{J:()=>a}),2063!=i.j)var n=i(83976);if(2063!=i.j)var o=i(96285);if(2063!=i.j)var s=i(99746);if(2063!=i.j)var r=i(15275);class a{constructor(){this.imports=[n.$,s.k]}get uniqueId(){return(0,r.z)(507918337)}configureRootServices(e){e.bind(o.Q).toDynamicValue((e=>()=>e.getOptional(o.C)))}}},92970:(e,t,i)=>{if(i.d(t,{I:()=>c}),2063!=i.j)var n=i(61827);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(28798);if(2063!=i.j)var r=i(34471);if(2063!=i.j)var a=i(26748);if(2063!=i.j)var l=i(57487);if(2063!=i.j)var d=i(71626);class c{constructor(){this.imports=[n.J,l.R]}get uniqueId(){return(0,o.z)(507918214)}configureRootServices(e){e.bind(s.iw).to(d.V),e.bind(r.S).to(a.z)}}},51764:(e,t,i)=>{if(i.d(t,{Q:()=>d}),2063!=i.j)var n=i(74458);if(2063!=i.j)var o=i(10068);if(2063!=i.j)var s=i(11914);if(2063!=i.j)var r=i(50150);if(2063!=i.j)var a=i(15275);if(2063!=i.j)var l=i(34471);class d{constructor(){this.imports=[o.B,n.J]}get uniqueId(){return(0,a.z)(507918296)}configureRootServices(e){e.bind(s.Tc).to(r.l),e.bind(l.S).toExisting(s.Tc)}}},57487:(e,t,i)=>{if(i.d(t,{R:()=>d}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(31352);if(2063!=i.j)var s=i(61749);if(2063!=i.j)var r=i(63285);if(2063!=i.j)var a=i(34471);if(2063!=i.j)var l=i(78235);class d{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918307)}configureRootServices(e){e.bind(o.d).to(s.U),e.bind(r.e).to(l.N),e.bind(a.S).toExisting(r.e)}}},22404:(e,t,i)=>{if(i.d(t,{_:()=>u}),2063!=i.j)var n=i(74458);if(2063!=i.j)var o=i(58359);if(2063!=i.j)var s=i(10068);if(2063!=i.j)var r=i(11914);if(2063!=i.j)var a=i(53384);if(2063!=i.j)var l=i(63497);if(2063!=i.j)var d=i(15275);if(2063!=i.j)var c=i(34471);class u{constructor(){this.imports=[s.B,n.J]}get uniqueId(){return(0,d.z)(507918305)}configureRootServices(e){e.bind(r.Tc).to(a.O),e.bind(c.S).toExisting(r.Tc),e.bind(o.i).toValue(l.q)}}},88359:(e,t,i)=>{if(i.d(t,{B:()=>l}),2063!=i.j)var n=i(59238);if(2063!=i.j)var o=i(58359);if(2063!=i.j)var s=i(55844);if(2063!=i.j)var r=i(12505);if(2063!=i.j)var a=i(15275);class l{constructor(){this.imports=[r.Q,n.E]}get uniqueId(){return(0,a.z)(507918302)}configureRootServices(e){e.bind(o.i).toValue(s._)}}},46862:(e,t,i)=>{if(i.d(t,{y:()=>f}),2063!=i.j)var n=i(68760);if(2063!=i.j)var o=i(7433);if(2063!=i.j)var s=i(10062);if(2063!=i.j)var r=i(91099);if(2063!=i.j)var a=i(78743);if(2063!=i.j)var l=i(9210);if(2063!=i.j)var d=i(58359);if(2063!=i.j)var c=i(10730);if(2063!=i.j)var u=i(26230);if(2063!=i.j)var h=i(15275);if(2063!=i.j)var g=i(34471);var p=i(56489);if(2063!=i.j)var m=i(41750);class f{constructor(){this.imports=[n.E,m.h]}get uniqueId(){return(0,h.z)(507918293)}configureRootServices(e){e.bind(d.i).toValue(r.r),e.bind(o.v).to(a.b),e.bind(g.S).toExisting(o.v),e.bind(s.$).to(u.bb),e.bind(u.c$).to(c.f),e.bind(u.Y).toDynamicValue((e=>{const t=e.getOptional(p.YQ);return e=>new l.U(e,t)}))}}},55264:(e,t,i)=>{if(i.d(t,{O:()=>a}),2063!=i.j)var n=i(24987);if(2063!=i.j)var o=i(90239);if(2063!=i.j)var s=i(42449);if(2063!=i.j)var r=i(15275);class a{constructor(){this.imports=[s.C,n.D,o.f]}get uniqueId(){return(0,r.z)(507918281)}configureRootServices(e){}}},99746:(e,t,i)=>{if(i.d(t,{k:()=>l}),2063!=i.j)var n=i(37876);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(19685);if(2063!=i.j)var r=i(48343);if(2063!=i.j)var a=i(21592);class l{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918298)}configureRootServices(e){var t;const i=null!==(t=(0,a.$)())&&void 0!==t?t:new r.z;(0,a.Y)(i),e.bind(s.H).to(n.M)}}},78235:(e,t,i)=>{i.d(t,{N:()=>m});var n=i(23182),o=i(1297),s=i(51451),r=i(63526),a=i(37053),l=i(19685),d=i(31352),c=i(39423),u=i(19728),h=i(29906),g=i(83010),p=i(37814);let m=class{constructor(e,t,i,n,r){this._proofingStore=e,this._logger=t,this._settingsEmitter=i,this._localizer=n,this._languageInfo=r,this._languageAddMode=!1,this._actionStatus="",this._selectedKey=null,this.getLocalized=e=>this._localizer.getMessage(e),this.getLanguageName=e=>{var t;const i=this._languageInfo.getLanguageInfo(e);return null!==(t=null==i?void 0:i.languageName)&&void 0!==t?t:e},this.updateProofingLanguages=async()=>{const e=new o.I(await this._proofingStore.read(s.l.ProofingLanguages));(0,u.runInAction)((()=>{this.proofingLanguages=e}))},this.setActionStatus=(e,t)=>{const i=this.getLanguageName(t),n=t===i?t:`${t}. ${i}`,o=this._localizer.getMessage(e,n);this._actionStatus=o},this.proofingLanguages=new o.I(this._proofingStore.getDefaultValue(s.l.ProofingLanguages)),(0,p.Gn)(this)}get languageAddMode(){return this._languageAddMode}get actionStatus(){return this._actionStatus}get canAddLanguage(){return this.proofingLanguages.count<3}get canRemoveLanguage(){return this.proofingLanguages.count>1}get selectedKey(){return this._selectedKey}addSelected(){const e=this._selectedKey;!e||this.proofingLanguages.count>=3||(this.proofingLanguages.add(e),this.setActionStatus("ebx_languageAdded",e),this.setLanguageAddMode(!1))}remove(e){this.proofingLanguages.count>1&&(this.proofingLanguages.remove(e),this.setActionStatus("ebx_languageRemoved",e))}moveUp(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveUp(e),this.setActionStatus("ebx_languageMovedUp",e))}moveDown(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveDown(e),this.setActionStatus("ebx_languageMovedDown",e))}moveToTop(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveToTop(e),this.setActionStatus("ebx_languageMovedToTop",e))}setLanguageAddMode(e){this._languageAddMode=e}async revertChanges(){const e=new o.I(await this._proofingStore.read(s.l.ProofingLanguages));(0,u.runInAction)((()=>{this.proofingLanguages=e}))}async save(){await this._proofingStore.write(s.l.ProofingLanguages,this.proofingLanguages.codesList),this._logger.debug(512242964,`[ProofingLanguageStateStore] Saved proofing languages setting: ${this.proofingLanguages.codesList}`),await this._proofingStore.read(s.l.ProofingLanguageListInitialized)||await this._proofingStore.write(s.l.ProofingLanguageListInitialized,!0)}async initialize(){this._settingsEmitter.on(s.l.ProofingLanguages,this.updateProofingLanguages),this._logger.debug(512242963,"[ProofingLanguageStateStore] Sending load languages request to background script"),this.proofingLanguages=new o.I(await this._proofingStore.read(s.l.ProofingLanguages))}shutDown(){}setSelectedKey(e){this._selectedKey=e}};(0,n.__decorate)([u.observable],m.prototype,"proofingLanguages",void 0),(0,n.__decorate)([u.observable],m.prototype,"_languageAddMode",void 0),(0,n.__decorate)([u.computed],m.prototype,"languageAddMode",null),(0,n.__decorate)([u.observable],m.prototype,"_actionStatus",void 0),(0,n.__decorate)([u.computed],m.prototype,"actionStatus",null),(0,n.__decorate)([u.computed],m.prototype,"canAddLanguage",null),(0,n.__decorate)([u.computed],m.prototype,"canRemoveLanguage",null),(0,n.__decorate)([u.observable],m.prototype,"_selectedKey",void 0),(0,n.__decorate)([u.computed],m.prototype,"selectedKey",null),(0,n.__decorate)([u.action],m.prototype,"addSelected",null),(0,n.__decorate)([u.action],m.prototype,"remove",null),(0,n.__decorate)([u.action],m.prototype,"moveUp",null),(0,n.__decorate)([u.action],m.prototype,"moveDown",null),(0,n.__decorate)([u.action],m.prototype,"moveToTop",null),(0,n.__decorate)([u.action],m.prototype,"setLanguageAddMode",null),(0,n.__decorate)([u.action],m.prototype,"setSelectedKey",null),(0,n.__decorate)([u.action],m.prototype,"setActionStatus",void 0),m=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(r.K)),(0,n.__param)(1,(0,g.W)(a.g)),(0,n.__param)(2,(0,g.W)(c.E)),(0,n.__param)(3,(0,g.W)(l.H)),(0,n.__param)(4,(0,g.W)(d.d))],m)},98013:(e,t,i)=>{i.d(t,{E:()=>l});var n=i(23182),o=i(29906);let s=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise(((t,i)=>{this.execute(e,(e=>(this.lastError?i(this.lastError):t(e),e)))}))}};s=(0,n.__decorate)([(0,o._)()],s);var r=i(33767),a=i(83010);let l=class extends s{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,a.W)(r.n))],l)},38822:(e,t,i)=>{i.d(t,{q:()=>S});var n=i(23182),o=i(8520),s=i(745),r=i(41642),a=i(95373),l=i(22628),d=i(58359),c=i(69655),u=i(81168),h=i(28798),g=i(25622),p=i(33767),m=i(56489),f=i(71510),v=i(34053),_=i(35869),y=i(51244);const I=(0,s.F5)({editorCanvasInjectableComponents:r.A.onAll(d.i).optional(),guidGenerator:r.A.on(u.G),languageScriptDirectionDetector:r.A.on(h.iw).optional(),targetWindowRef:r.A.on(g.sh),hostSettings:r.A.on(p.n),themeStore:r.A.on(m.YQ)});let C=class extends o.Component{constructor(e){super(e),this.layerHostId=e.deps.guidGenerator.generate()}render(){const{hostSettings:e,languageScriptDirectionDetector:t,targetWindowRef:i}=this.props.deps,n=i.deref();return o.createElement("div",{dir:null==t?void 0:t.uxLanguageDir,style:{all:"initial"}},o.createElement(_.IF,{window:null!=n?n:window},e.renderWithinShadowDOM||e.renderWithinSeparateLayer?this.renderWithinSeparateLayer():this.renderComponents()))}renderWithinSeparateLayer(){var e;const{hostSettings:t}=this.props.deps;return o.createElement(o.Fragment,null,o.createElement(f.U,{id:this.layerHostId,style:{position:"fixed",zIndex:null!==(e=t.editorCardZIndex)&&void 0!==e?e:1e6,inset:0,visibility:"hidden"}}),o.createElement(l.d.Provider,{value:this.layerHostId},this.renderComponents()))}renderComponents(){const{editorCanvasInjectableComponents:e,themeStore:t}=this.props.deps,i=t.getFluentActiveTheme(),n=null==e?void 0:e.map(((e,t)=>o.createElement(e,{key:"injectableComponent"+t})));return o.createElement(c.q,{theme:i},o.createElement(m.O1.Provider,{value:!!this.props.deps.hostSettings.useFluentV9},o.createElement(v.Q,null,n)))}};C=(0,n.__decorate)([y.PA],C);const S=(0,a.r)(C,I)},70340:(e,t,i)=>{i.d(t,{C:()=>u});var n=i(96285),o=i(7635),s=i(23086),r=i(745),a=i(41642),l=i(3817),d=i(8520);const c=(0,r.F5)({squigglerCanvasRenderingState:a.A.on(n.C),contentEditableSquigglerComponent:a.A.on(o.ue).optional(),inputControlsSquigglerComponent:a.A.on(s.$K).optional()}),u=(0,l.PA)((()=>{const{contentEditableSquigglerComponent:e,inputControlsSquigglerComponent:t,squigglerCanvasRenderingState:i}=(0,r.KN)(c),n=[],o=[];if(!i.visible)return null;if(e)for(const[t,o]of i.squigglers)i.getVisibilityForAnchor(t)&&n.push(e(t,o));if(t)for(const e of i.inputControlsProxyList)o.push(t(e));return d.createElement(d.Fragment,null,...o,...n)}))},72614:(e,t,i)=>{i.d(t,{D:()=>z});var n=i(23182),o=i(4635),s=i(96292),r=i(70848);class a{constructor(e,t,i,n,s,r,a){this.hostSettings=e,this.calloutStateStore=t,this.undoCalloutStateStore=i,this.squiggleTooltipStateStore=n,this.critiqueStore=a,this.squigglerFlagCritiqueHandler=new o.G(t,s,i,r)}hideCallout(){var e;this.calloutStateStore.isVisible&&!this.calloutStateStore.isApplyingCritiqueAction&&(this.calloutStateStore.recordInstrumentationEventId(12),this.calloutStateStore.hide()),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}async showCallout(e){var t,i,n,o;null===(t=this.squiggleTooltipStateStore)||void 0===t||t.hide();const a=null===(i=this.critiqueStore)||void 0===i?void 0:i.getCritique(e.critique.traceId,e.critique.nodeId),l=Object.assign(Object.assign({},e),{critique:a?(0,r.OE)(a):e.critique});if(!(null===(o=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.squigglerSettings)||void 0===o?void 0:o.onSquiggleClicked)||this.hostSettings.serviceSettings.squigglerSettings.onSquiggleClicked(l.critique))if((0,r.r3)(l.critique))await this.squigglerFlagCritiqueHandler.showFlagCritique(l);else{if(this.undoCalloutStateStore&&e.squiggleKind===s.Ah.autocorrection)return this.undoCalloutStateStore.show(l);await this.calloutStateStore.show(l)}}}class l{constructor(e,t,i,n){this.squiggleTooltipStateStore=e,this.calloutStateStore=t,this.undoCalloutStateStore=i,this.featureFlagsReader=n}showTooltip(e){var t,i,n,o,s;const{squiggleKind:r,critique:a,position:l,origin:d,targetDocument:c}=e;if(!(null===(t=this.calloutStateStore)||void 0===t?void 0:t.isVisible)&&!(null===(i=this.undoCalloutStateStore)||void 0===i?void 0:i.isVisible)){if(!d&&!(null===(n=this.featureFlagsReader)||void 0===n?void 0:n.flags.enableCSSHighlightApiSquiggleRendering))return;(null===(o=this.squiggleTooltipStateStore)||void 0===o?void 0:o.isVisible)&&this.squiggleTooltipStateStore.hide(),null===(s=this.squiggleTooltipStateStore)||void 0===s||s.show(r,a,l,d,c)}}hideTooltip(){var e;null===(e=this.squiggleTooltipStateStore)||void 0===e||e.hide()}}var d=i(7635),c=i(23086),u=i(7433),h=i(47),g=i(73893),p=i(14253),m=i(84601),f=i(34055),v=i(17298);const _=(0,v.f)("ICritiqueCardNativeApi");(0,v.f)("IECCNativeApi");var y=i(58550),I=i(14945),C=i(84030),S=i(71632),b=i(18349),T=i(81168),E=i(37053),N=i(22910),x=i(48662),w=i(33767),L=i(81174),D=i(17025),F=i(33727),A=i(78426),R=i(19728),q=i(29906),P=i(83010),O=i(27603),k=i(37814);let z=class{constructor(e,t,i,n,o,s,d,c,u,h,g,p,m,f,v,_,y,b,T){this.proofingEventListener=e,this.squigglerStateStoreFactory=t,this.inputControlsStateStoreFactory=i,this.calloutStateStore=n,this.settings=o,this.guidGenerator=s,this.squiggleTooltipStateStore=d,this._logger=c,this.critiqueApplicationHandler=u,this.proofingDom=h,this.safeWindow=g,this.tileContent=p,this.featureFlagsReader=m,this.hostSettings=f,this.inlineSuggestionsRenderer=v,this.squigglePositioningEdgeCases=_,this.undoCalloutStateStore=y,this.nativeApi=b,this.critiqueStore=T,this.anchorElements=new Map,this.squigglers=new Map,this.visible=!0,this.tileVisibility=new Map,this._inputControlsProxyList=[],this._inputControlsProxyListCache=[],this.setVisibility=e=>{this.visible=e},this.setVisibilityForTile=(e,t)=>{var i,n,o,s,r,a,l,d;if(this.tileVisibility.set(e,t),!t){e===(null===(n=null===(i=this.inlineSuggestionsRenderer)||void 0===i?void 0:i.getCurrentMenuInfo())||void 0===n?void 0:n.parentTileId)&&this.inlineSuggestionsRenderer.dismissMenu();const t=null===(o=this.calloutStateStore.critique)||void 0===o?void 0:o.nodeId,c=this.proofingDom.findParagraphNode(null!=t?t:"");e===(null===(s=null==c?void 0:c.parent)||void 0===s?void 0:s.id)&&this.calloutStateStore.hide();const u=null===(a=null===(r=this.undoCalloutStateStore)||void 0===r?void 0:r.critique)||void 0===a?void 0:a.nodeId,h=this.proofingDom.findParagraphNode(null!=u?u:"");e===(null===(l=null==h?void 0:h.parent)||void 0===l?void 0:l.id)&&(null===(d=this.undoCalloutStateStore)||void 0===d||d.hide())}},this.getVisibilityForAnchor=e=>{var t;for(const[i,n]of this.anchorElements)if(e===n.id)return null===(t=this.tileVisibility.get(i))||void 0===t||t;return!0},this.getSquigglerForTile=e=>{const t=this.anchorElements.get(e);return t?this.squigglers.get(t.id):void 0},this.getCritiqueCount=e=>{var t;return!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null!==(t=null==e?void 0:e.getCritiques().length)&&void 0!==t?t:0},this.update=e=>(!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null==e?void 0:e.updateSquiggles()),this.navigate=(e,t)=>{!t&&this.squigglers.size>0&&(t=Array.from(this.squigglers.values())),t&&(this.calloutStateStore.setNavInfo({stores:t,ctr:"contenteditable",currentIndex:0,category:"category",onCloseNavigation:()=>{e()},onNavSuggestionApplied:()=>{this.calloutStateStore.navigate(0)}}),this.calloutStateStore.navigate(0))},this.clearSquiggles=(e,t,i)=>{1===e.proofedElements.length&&e.proofedElements[0].id===t?(this.anchorElements.delete(t),(0,R.runInAction)((()=>{this.squigglers.delete(i)})),e.dispose()):e.removeCritiques(t).then((()=>{(0,R.runInAction)((()=>{e.isEmpty&&(this.squigglers.delete(i),this.anchorElements.delete(t),e.dispose())}))}))},this.displayFlag=async e=>{const t={critique:e,issueText:"",setInitialFocus:!1,onDismiss(e){},onIgnoreOnce:this.onIgnoreOnce,onIgnoreAll:this.onIgnoreAll,onApplyFlag:this.onApplyFlag};await this.critiqueCalloutHandler.showCallout(t)},this.onApplyFlag=async(e,t,i)=>{await this.applyChange(e,(async(n,o)=>{await n.applyFlagSuggestion(o,void 0,e.nodeId,e,t,i)}))},this.applyChange=(e,t)=>{const i=this.proofingDom.findParagraphNode(e.nodeId);return(0,L.l)(i)&&i.parent.element?t(this.critiqueApplicationHandler,i.parent.element):Promise.resolve()},this.onIgnoreOnce=e=>{(0,r.r3)(e)&&this.applyChange(e,((t,i)=>{t.ignoreFlagOnce(i,void 0,e.nodeId,e)}))},this.onIgnoreAll=e=>{(0,r.r3)(e)&&this.applyChange(e,((t,i)=>{t.ignoreAllOfCritique(i,void 0,e.nodeId,e)}))},this.setSquiggler=(e,t)=>{this.squigglers.set(e,t)},this.notifyHost=e=>{var t,i;const n=e.data.critiquesToElementsMap;if(e.messageType===I.G.NewData)for(const e of n)null===(t=this.nativeApi)||void 0===t||t.critiqueCountChanged(e.critiques.length);else if(e.messageType===I.G.RemoveData)for(const e of n){this.anchorElements.get(e.elementId)&&(null===(i=this.nativeApi)||void 0===i||i.critiqueCountChanged(e.critiques.length))}},this.getAnchorElement=(e,t)=>{var i;let n=this.anchorElements.get(e);if(n){const t=n.elementRef.deref();if(null==t?void 0:t.isConnected)return n;this.clearSquiggler(e),this.anchorElements.delete(e)}let o=t;const s=null===(i=this.squigglePositioningEdgeCases)||void 0===i?void 0:i.getEdgeCases(),r=null==s?void 0:s.find((e=>e.match(t)));if(null==r?void 0:r.getAnchorElement)o=r.getAnchorElement(t);else{if(t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(o=e)}if("true"===o.getAttribute(this.settings.editorSpellcheckAttribute)){let t;for(const i of this.anchorElements.values())i.elementRef.deref()===o&&(this.anchorElements.set(e,i),t=i);n=t}}return n||(n={id:this.guidGenerator.generate(),elementRef:new C.O(o)},this.anchorElements.set(e,n)),n},this._zoomScale=1,this.updateInputControlsProxyListCache=e=>{this._inputControlsProxyListCache=e,this.safeWindow.requestAnimationFrame((()=>(0,R.action)((()=>this._inputControlsProxyList=this._inputControlsProxyListCache))()))},this.buildInputAndTextAreaList=e=>{if(!this.inputControlsStateStoreFactory)return;this._inputControlsProxyListCache=this._inputControlsProxyListCache.map((e=>(e.messageItem.changed=!1,e)));const t=e.data.critiquesToElementsMap;for(const e of t){if(!e.element)continue;const t=this.tileContent.getContainingElement(e.element);if(!t)continue;if(!(0,S.C)(t,"HTMLInputElement")&&!(0,S.C)(t,"HTMLTextAreaElement"))continue;const i=this.getAnchorElement(e.elementId,t);if(i){this._inputControlsProxyListCache=this._inputControlsProxyListCache.filter((e=>e.messageItem.anchor.id!==i.id));const t={entry:{elementId:e.elementId,element:e.element,critiques:e.critiques},anchor:{element:i.elementRef.deref(),id:i.id},changed:!0};this._inputControlsProxyListCache.push(this.inputControlsStateStoreFactory({messageItem:t,critiqueCalloutHandler:this.critiqueCalloutHandler,tooltipHandler:this.tooltipHandler,disableClearOnFocusFix:!1}))}}this.updateInputControlsProxyListCache(this._inputControlsProxyListCache)},this.buildContentEditableList=async e=>{if(!this.squigglerStateStoreFactory)return;const t=e.data.critiquesToElementsMap;if(e.messageType===I.G.NewData||e.messageType===I.G.ChangeData)for(const e of t){if(!e.element)continue;const t=this.proofingDom.findTileNode(e.elementId);if(!t)continue;const i=this.tileContent.getContainingElement(e.element);if(!i)continue;if((0,S.C)(i,"HTMLInputElement")||(0,S.C)(i,"HTMLTextAreaElement")||!(0,S.C)(i,"HTMLElement"))continue;const n=this.getAnchorElement(e.elementId,i);let o;if(n&&(o=this.squigglers.get(n.id)),!n||!e.critiques.length){n&&o&&!e.critiques.length&&this.clearSquiggles(o,e.elementId,n.id);continue}const s={id:e.elementId,graphNode:t,element:i,critiques:e.critiques};o?await o.setCritiques(s):(o=this.squigglerStateStoreFactory(s,n.elementRef.deref(),n.id,this.critiqueCalloutHandler,this.tooltipHandler),1!==this._zoomScale&&o.scaleTransform(this._zoomScale),this.setSquiggler(n.id,o))}else if(e.messageType===I.G.RemoveData)for(const e of t)this.clearSquiggler(e.elementId)},this.critiqueCalloutHandler=new a(this.hostSettings,this.calloutStateStore,this.undoCalloutStateStore,this.squiggleTooltipStateStore,this.inlineSuggestionsRenderer,this._logger,this.critiqueStore),this.tooltipHandler=new l(this.squiggleTooltipStateStore,this.calloutStateStore,this.undoCalloutStateStore,this.featureFlagsReader),(0,k.Gn)(this)}get inputControlsProxyList(){return this._inputControlsProxyList}async initialize(){this.proofingEventListener.emit("squiggleUXReadyEvent",{messageType:I.G.NewData})}shutDown(){var e;if(this.squigglers.size)for(const e of this.squigglers.values())e.dispose();this.squigglers.clear(),this.anchorElements.clear(),this.calloutStateStore.hide(),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}clearSquiggler(e){const t=this.anchorElements.get(e);if(!t)return;const i=this.squigglers.get(t.id);i&&this.clearSquiggles(i,e,t.id)}async onCritiqueForUiEvent(e){this.buildInputAndTextAreaList(e),await this.buildContentEditableList(e),this.notifyHost(e)}setZoomScale(e){this._zoomScale=e;for(const[,t]of this.squigglers)t.scaleTransform(e)}};(0,n.__decorate)([R.observable],z.prototype,"squigglers",void 0),(0,n.__decorate)([R.observable],z.prototype,"visible",void 0),(0,n.__decorate)([R.observable],z.prototype,"tileVisibility",void 0),(0,n.__decorate)([R.observable],z.prototype,"_inputControlsProxyList",void 0),(0,n.__decorate)([R.computed],z.prototype,"inputControlsProxyList",null),(0,n.__decorate)([R.action],z.prototype,"setVisibility",void 0),(0,n.__decorate)([R.action],z.prototype,"setVisibilityForTile",void 0),(0,n.__decorate)([R.action],z.prototype,"setSquiggler",void 0),(0,n.__decorate)([R.action],z.prototype,"updateInputControlsProxyListCache",void 0),z=(0,n.__decorate)([(0,q._)(),(0,n.__param)(0,(0,P.W)(b.o)),(0,n.__param)(1,(0,O.l)()),(0,n.__param)(1,(0,P.W)(d.fD)),(0,n.__param)(2,(0,O.l)()),(0,n.__param)(2,(0,P.W)(c.iV)),(0,n.__param)(3,(0,P.W)(u.v)),(0,n.__param)(4,(0,P.W)(D.k)),(0,n.__param)(5,(0,P.W)(T.G)),(0,n.__param)(6,(0,P.W)(h.A)),(0,n.__param)(6,(0,O.l)()),(0,n.__param)(7,(0,P.W)(E.g)),(0,n.__param)(8,(0,P.W)(g.i)),(0,n.__param)(9,(0,P.W)(F.w)),(0,n.__param)(10,(0,P.W)(N.j)),(0,n.__param)(11,(0,P.W)(A.d)),(0,n.__param)(12,(0,P.W)(x.c)),(0,n.__param)(13,(0,P.W)(w.n)),(0,n.__param)(14,(0,O.l)()),(0,n.__param)(14,(0,P.W)(p.V)),(0,n.__param)(15,(0,O.l)()),(0,n.__param)(15,(0,P.W)(m._)),(0,n.__param)(16,(0,O.l)()),(0,n.__param)(16,(0,P.W)(f.x)),(0,n.__param)(17,(0,O.l)()),(0,n.__param)(17,(0,P.W)(_)),(0,n.__param)(18,(0,O.l)()),(0,n.__param)(18,(0,P.W)(y.$))],z)},18406:(e,t,i)=>{i.d(t,{t:()=>s});var n=i(8520),o=i(63977);class s extends n.Component{constructor(e){super(e),this.retryTimer=0,this.labelErrorStyle={display:"none"},this.tryRecover=()=>{var e;this.props.maxRecoveryRetry>(this.state.retryNumber||0)&&(window.clearTimeout(this.retryTimer),this.retryTimer=window.setTimeout((()=>{var e;const t=(null!==(e=this.state.retryNumber)&&void 0!==e?e:0)+1;this.setState({hasError:!1,retryNumber:t})}),1e3*(null!==(e=this.state.retryNumber)&&void 0!==e?e:1)))},this.state={hasError:!1,retryNumber:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var i;const{logger:n,errorEventName:s,errorMessage:r}=this.props;o.R.logUnhandledError(n,{error:e,errorInfo:t,retryCount:null!==(i=this.state.retryNumber)&&void 0!==i?i:0},s,r)}componentWillUnmount(){window.clearTimeout(this.retryTimer)}componentDidUpdate(){this.state.hasError&&this.tryRecover()}render(){return this.state.hasError?n.createElement("div",{"aria-hidden":"true",style:this.labelErrorStyle,className:"ms-editor-rendering-error"},`${this.state.retryNumber}/${this.props.maxRecoveryRetry}`):this.props.children}}},63977:(e,t,i)=>{if(i.d(t,{R:()=>s}),2063!=i.j)var n=i(36915);if(2063!=i.j)var o=i(51199);class s{static logUnhandledError(e,t,i,s){e.logEvent(508055843,i,n.q.Error,s,o.o.SamplingPolicy.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,i){}}},5140:(e,t,i)=>{var n=i(23750);const o=new n.diff_match_patch;o.Diff_Timeout=0;const s=(e,t)=>e.index>=0?(e.index=t,e):t;addEventListener("message",(e=>{"get-url"!==e.data[0]?(e=>{try{const i=[],n=e.data[0],r=e.data[1],a=e.data[2],l=o.diff_main(n,r);1===l.length&&0===l[0][0]&&e.ports[0].postMessage({result:a});let d=0,c=0,u=0,h=0,g=0,p=0;for(const e of l){const n=e[0],o=e[1].length;switch(n){case 0:g=o,p=o;break;case 1:g=0,p=o;break;case-1:u+=o;continue}c+=u,u=0;for(let e=d;e<a.length;e+=1){const o=(t=a[e]).index>=0?t.index:t;if(o<h)throw new Error("Indices are not sorted!");if(!(o>=h&&o<h+p))break;i[e]=s(a[e],0===n?o+c-h:c),d+=1}if(d===a.length)break;c+=g,h+=p}for(let e=d;e<a.length;e+=1)i[e]=s(a[e],c);e.ports[0].postMessage({result:i})}catch(t){e.ports[0].postMessage({error:t})}var t})(e):e.ports[0].postMessage({url:self.location.href})}),!1)},12804:(e,t,i)=>{i.d(t,{a:()=>a});var n=i(23182),o=i(33767);var s=i(29906),r=i(83010);let a=class{constructor(e){this._hostSettings=e,this._getWorkerUrl=()=>new Promise((e=>{var t;const i=new MessageChannel;i.port1.onmessage=({data:t})=>{var n;i.port1.close(),e(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:null)},null===(t=this._dmp)||void 0===t||t.postMessage(["get-url"],[i.port2])})),this._callworker=(e,t,i)=>new Promise(((n,o)=>{var s;const r=new MessageChannel;r.port1.onmessage=({data:e})=>{r.port1.close(),e.error?o(e.error):n(e.result)},null===(s=this._dmp)||void 0===s||s.postMessage([e,t,i],[r.port2])}))}async initialize(){var e;if(null===(e=this._dmp)||void 0===e||e.terminate(),this._hostSettings.disableInlineWorkerLoader)this._dmp=new Worker(new URL(i.p+i.u(2063),i.b));else{const e=i(10339);this._dmp=new e.default}if(this._hostSettings.validateWorkerUrl){const e=await this._getWorkerUrl();await this._hostSettings.validateWorkerUrl(e)||this.shutDown()}}shutDown(){var e;null===(e=this._dmp)||void 0===e||e.terminate(),this._dmp=void 0}async getReadjustedIndices(e,t,i,n){var o;const s=null!==(o=e.textContent)&&void 0!==o?o:"",r=n?i:s,a=n?s:i;return await this._callworker(r,a,t)}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(o.n))],a)},80250:(e,t,i)=>{i.d(t,{R:()=>f});var n=i(23182),o=i(37614),s=i(81168),r=i(45352),a=i(63526),l=i(7988),d=i(37053),c=i(48662),u=i(33767),h=i(63977),g=i(29906),p=i(83010),m=i(27603);let f=class{constructor(e,t,i,n,o,s,r){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=i,this._sessionContextProvider=n,this._logger=o,this._featureFlagsReader=s,this._hostSettings=r}async initializeComponent(){let e;await this._featureFlagsReader.refreshFlags();try{this._sessionContextProvider&&(e=await this._sessionContextProvider())}catch(e){}await this._logger.initialize(this._proofingPersistedStore,this._featureFlagsReader,e,void 0,this._hostSettings),this._logger.debug(520984581,"Logger initialized"),h.R.addUnhandledExceptionsListeners(this._logger,o.s.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(520984580,"Initializing telemetry");const t=this._guidGenerator.generate();this._logger.addCorrelationID(t),this._logger.debug(520984579,"Registering listeners"),await this._registrar.initialize()}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,p.W)(s.G)),(0,n.__param)(1,(0,p.W)(r.V)),(0,n.__param)(2,(0,p.W)(a.K)),(0,n.__param)(3,(0,p.W)(l.a)),(0,n.__param)(3,(0,m.l)()),(0,n.__param)(4,(0,p.W)(d.g)),(0,n.__param)(5,(0,p.W)(c.c)),(0,n.__param)(6,(0,p.W)(u.n))],f)},88173:(e,t,i)=>{i.d(t,{y:()=>n});const n=(0,i(17298).f)("IEditorClient")},54425:(e,t,i)=>{i.d(t,{W:()=>n});const n=(0,i(17298).f)("IReactComponentInitializer")},74204:(e,t,i)=>{i.d(t,{p:()=>c});i(42410);if(2063!=i.j)var n=i(75712);if(2063!=i.j)var o=i(53356);if(2063!=i.j)var s=i(22400);if(2063!=i.j)var r=i(88173);if(2063!=i.j)var a=i(33767);if(2063!=i.j)var l=i(91970);if(2063!=i.j)var d=i(88728);const c=(e,t,i,c,u,h,g)=>{const p=new o.J(t.generateModuleKey),m=p.container;m.bind(s.p).toValue(m),m.bind(s.k).toValue(m.resolveNew),m.bind(o.J).toValue(p),m.bind(r.y).toValue(e),m.bind(a.n).toValue(t),m.bind(d.K).toValue(h),i&&m.bind(n.P).toValue(i),null==g||g(m),"configureRootServices"in c?p.addModule(c):m.bind(l.qy).toValue(c);for(const e of u)p.addModule(e);return p}},88728:(e,t,i)=>{i.d(t,{K:()=>n});i(42410);const n=(0,i(17298).f)("ReactComponentModules")},16221:(e,t,i)=>{if(i.d(t,{s:()=>s}),2063!=i.j)var n=i(84030);const o="__reactEvents";class s{constructor(e){this.element=new n.O(e),this.replacedElements=[],this.ownerDocument=new n.O(e.ownerDocument)}replaceListener(e){var t;if(!e)return;const i=new n.O(e),s=e.addEventListener,r=new n.O(s),a={},l=[];for(const t in e)t.startsWith(o)&&l.push(t);e.addEventListener=(e,t,n)=>{const o=r.deref(),s=i.deref();o&&s&&(e in a||(a[e]=[]),a[e].push({listener:t,options:n}),o.apply(s,[e,t,n]))};null===(t=this.replacedElements)||void 0===t||t.push({element:i,eventHandlers:a,restoreOriginalAddEventListener:()=>{e.addEventListener=s},existingReactEvents:l})}render(e){var t,i;const n=null===(t=this.element)||void 0===t?void 0:t.deref(),s=null===(i=this.ownerDocument)||void 0===i?void 0:i.deref();if(s&&n){this.replaceListener(n),this.replaceListener(n.firstElementChild),this.replaceListener(n.host),this.replaceListener(s),this.replaceListener(s.defaultView);try{return e()}finally{if(this.replacedElements)for(let e=this.replacedElements.length-1;e>=0;e--){const t=this.replacedElements[e],i=t.element.deref(),n=t.restoreOriginalAddEventListener;if(null==n||n(),t.restoreOriginalAddEventListener=void 0,i&&t.existingReactEvents){t.reactEventsToClear=[];for(const e in i)e.startsWith(o)&&!t.existingReactEvents.includes(e)&&t.reactEventsToClear.push(e)}t.existingReactEvents=void 0}}}}cleanup(){var e;if(!this.replacedElements||!this.ownerDocument)return;const t=this.ownerDocument.deref();for(const i of this.replacedElements){for(const n in i.eventHandlers){const o=i.element.deref();for(const s of i.eventHandlers[n])null==o||o.removeEventListener(n,s.listener,s.options),null===(e=null==t?void 0:t.defaultView)||void 0===e||e.removeEventListener(n,s.listener,s.options);if(o&&i.reactEventsToClear)for(const e of i.reactEventsToClear)o[e]=void 0}i.eventHandlers={}}this.replacedElements=void 0,this.ownerDocument=void 0,this.element=void 0}}},37614:(e,t,i)=>{var n;i.d(t,{s:()=>n}),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(n||(n={}))},55202:(e,t,i)=>{if(i.d(t,{b:()=>l}),2063!=i.j)var n=i(13897);if(2063!=i.j)var o=i(12934);if(2063!=i.j)var s=i(74458);if(2063!=i.j)var r=i(39671);if(2063!=i.j)var a=i(15275);class l{constructor(){this.imports=[n.u,r.r,o.v,s.J]}get uniqueId(){return(0,a.z)(507918295)}configureRootServices(e){}}},84494:(e,t,i)=>{if(i.d(t,{f:()=>F}),2063!=i.j)var n=i(90239);if(2063!=i.j)var o=i(7635);if(2063!=i.j)var s=i(6982);if(2063!=i.j)var r=i(92510);if(2063!=i.j)var a=i(87324);if(2063!=i.j)var l=i(53382);if(2063!=i.j)var d=i(27959);if(2063!=i.j)var c=i(48785);if(2063!=i.j)var u=i(58550);if(2063!=i.j)var h=i(42007);if(2063!=i.j)var g=i(49845);if(2063!=i.j)var p=i(97633);if(2063!=i.j)var m=i(78426);if(2063!=i.j)var f=i(33727);if(2063!=i.j)var v=i(38583);if(2063!=i.j)var _=i(85681);if(2063!=i.j)var y=i(63519);if(2063!=i.j)var I=i(71975);if(2063!=i.j)var C=i(21203);if(2063!=i.j)var S=i(15275);if(2063!=i.j)var b=i(62026);if(2063!=i.j)var T=i(37053);if(2063!=i.j)var E=i(99724);if(2063!=i.j)var N=i(33767);if(2063!=i.j)var x=i(4531);if(2063!=i.j)var w=i(63285);if(2063!=i.j)var L=i(26115);var D=i(8520);class F{constructor(){this.imports=[n.f]}get uniqueId(){return(0,S.z)(507847257)}configureRootServices(e){e.bind(o.ue).toValue(((e,t)=>D.createElement(s.g,{key:`squiggler-${e}`,state:t}))),e.bind(r.Vw).to(a.U),e.bind(o.fD).toDynamicValue((t=>{const i=e.get(m.d),n=e.get(b.f),o=e.get(T.g),s=e.getAll(E.zJ),a=e.get(E.M5),S=e.get(N.n),D=e.get(f.w),F=e.get(r.Vw),A=e.getOptional(v.M),R=e.getOptional(_.Ey),q=e.getOptional(l.mU),P=e.getOptional(x.z),O=e.getOptional(y.M),k=e.getOptional(I.W),z=e.getOptional(u.$),M=e.getOptional(h.a),W=e.getOptional(g.K),j=e.getOptional(C.s),B=e.getOptional(w.rI),U=e.getOptional(d.PF),H=e.getOptional(p.m);return(t,r,l,d,u,h={})=>new c.i({proofedItem:t,anchorElement:r,anchorId:l,critiqueCalloutHandler:d,tooltipHandler:u,options:e.get(L.z)(h)},i,n,s,a,S,D,F,o,A,R,q,P,O,k,z,M,W,j,B,U,H)}))}}},37860:(e,t,i)=>{if(i.d(t,{f:()=>c}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(91970);if(2063!=i.j)var s=i(33767);if(2063!=i.j)var r=i(81168);if(2063!=i.j)var a=i(12569);if(2063!=i.j)var l=i(7981);if(2063!=i.j)var d=i(58728);class c{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918277)}configureRootServices(e){e.getOptional(o.qy)||e.bind(o.qy).toDynamicValue((e=>{var t;const i=e.get(s.n),{sessionId:n=e.get(r.G).generate(),appPlatform:o="DefaultAppPlatform",appName:c="DefaultAppName",releaseAudienceGroup:u="",clientVersion:h=""}=null!==(t=i.hostMetadata)&&void 0!==t?t:{},g=[(0,d.m9)("Session.Id",n),(0,d.m9)("App.Platform",o),(0,d.m9)("App.Name",c),(0,d.m9)("Release.AudienceGroup",u),(0,d.m9)("App.Version",h)],p=new a.r(g,{endpointUrl:l.d.PUBLIC});return p.setFullEventsEnabled(!1),p}))}}},77239:(e,t,i)=>{if(i.d(t,{w:()=>r}),2063!=i.j)var n=i(74458);if(2063!=i.j)var o=i(58219);if(2063!=i.j)var s=i(15275);class r{constructor(){this.imports=[o.N,n.J]}get uniqueId(){return(0,s.z)(50786e4)}configureRootServices(e){}}},83976:(e,t,i)=>{if(i.d(t,{$:()=>S}),2063!=i.j)var n=i(80250);if(2063!=i.j)var o=i(30857);if(2063!=i.j)var s=i(79544);if(2063!=i.j)var r=i(15275);if(2063!=i.j)var a=i(27018);if(2063!=i.j)var l=i(63526);if(2063!=i.j)var d=i(34471);if(2063!=i.j)var c=i(22649);if(2063!=i.j)var u=i(89455);if(2063!=i.j)var h=i(87012);if(2063!=i.j)var g=i(17025);if(2063!=i.j)var p=i(82963);if(2063!=i.j)var m=i(76192);if(2063!=i.j)var f=i(31109);if(2063!=i.j)var v=i(25552);var _=i(56489);if(2063!=i.j)var y=i(40210);if(2063!=i.j)var I=i(98013);if(2063!=i.j)var C=i(96505);class S{constructor(){this.imports=[s.u]}get uniqueId(){return(0,r.z)(507918284)}configureRootServices(e){e.bind(a.H).to(n.R),e.bind(_.UC).to(_.h1),e.bind(_.YQ).to(_.ZP),e.bind(h.h).to(o.e),e.bind(g.k).toExisting(h.h),e.bind(v.z).toExisting(h.h),e.bind(f.D).toExisting(h.h),e.bind(m.N).toExisting(h.h),e.bind(C.C).toSelf(),e.bind(p.B).toExisting(C.C),e.bind(l.K).to(y.B),e.bind(d.S).toExisting(C.C),e.bind(d.S).toExisting(l.K),e.bind(c.e).to(I.E),e.bind(u.M).toExisting(c.e)}}},12505:(e,t,i)=>{if(i.d(t,{Q:()=>u}),2063!=i.j)var n=i(5662);if(2063!=i.j)var o=i(26876);if(2063!=i.j)var s=i(44246);if(2063!=i.j)var r=i(76081);if(2063!=i.j)var a=i(61595);if(2063!=i.j)var l=i(74458);if(2063!=i.j)var d=i(15275);if(2063!=i.j)var c=i(34471);class u{constructor(){this.imports=[s.d,l.J,n.w]}get uniqueId(){return(0,d.z)(507918280)}configureRootServices(e){e.bind(r.K).toSelf(),e.bind(c.S).toExisting(r.K),e.bind(a.Y).to(a.h),e.bind(o.V).to(o.S),e.bind(c.S).toExisting(o.V)}}},26115:(e,t,i)=>{if(i.d(t,{S:()=>u,z:()=>c}),2063!=i.j)var n=i(15275);if(2063!=i.j)var o=i(48662);if(2063!=i.j)var s=i(33767);if(2063!=i.j)var r=i(14389);if(2063!=i.j)var a=i(84601);if(2063!=i.j)var l=i(25618);if(2063!=i.j)var d=i(13559);const c=(0,i(17298).f)("ISquigglerOptionsFactory");class u{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918274)}configureRootServices(e){e.bind(c).toDynamicValue((e=>{const t=e.get(o.c),i=e.get(s.n),n=e.getOptional(a._);return(e={})=>{const o=t.flags.enableSvgSquiggleUnderline?r.N.SVG:i.sessionType===s.d.OWA_New_Email||i.sessionType===s.d.OWA_Draft_Email?r.N.OFFICE:r.N.GENERIC;e.edgeCases=null==n?void 0:n.getEdgeCases(),e.visibilityTracker=t.flags.enableVisibilityTracker?new l.J:l.Y,e.throttleUpdates=t.flags.enableSquigglesUpdateThrottling,e.visibilityTrackerShouldTrackSquiggles=t.flags.visibilityTrackerShouldTrackSquiggles,e.mutationObserverBasedRelativePosition=t.flags.mutationObserverBasedRelativePosition,e.enableCursorIntersectionObserver=t.flags.enableCursorIntersectionObserver;let a=d.j.none;t.flags.enableAriaStatusElement&&(t.flags.enableCssHighlightApiAnnouncementsOnly?a|=d.j.cssHighlightsAPIAnnouncement:t.flags.enableCssHighlightApiAnnouncementsOnlyForSpellingAndGrammar?a|=d.j.cssHighlightsAPIAnnouncementOnlyForSpellingAndGrammar:a|=d.j.appearance|d.j.highlight,t.flags.enableLineNavAriaAnnouncement&&(a|=d.j.lineNavigation));const c=e;return c.restoreCaretPosition=!!i.enableCaretPositionRestore,c.ariaFeatures=a,c.tooltipEnabled=!!i.showSquiggleTooltip,c.disableSquiggleTooltipOnTextSelection=!!i.disableSquiggleTooltipOnTextSelection,c.squiggleStyleType=o,c.autoCorrectionEnabled=i.enableAutoCorrect,c.personalizedAutoCorrectionEnabled=i.enablePersonalizedAutoCorrect,c.autoCorrectionInputCacheEnabled=i.enableAutoCorrect&&t.flags.enableAutoCorrectInputCache,c.trackProofingElementsPositionEnabled=i.dynamicProofingElementsEnabled,c.disableRangeWhenApplyingCritiqueSuggestions=i.disableRangeWhenApplyingCritiqueSuggestions,c.disableOpenAutoCorrectCalloutOnHover=i.disableOpenAutoCorrectCalloutOnHover,c}}))}}},42449:(e,t,i)=>{if(i.d(t,{C:()=>c}),2063!=i.j)var n=i(58359);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(34471);if(2063!=i.j)var r=i(90239);if(2063!=i.j)var a=i(96285);if(2063!=i.j)var l=i(70340);if(2063!=i.j)var d=i(72614);class c{constructor(){this.imports=[r.f]}get uniqueId(){return(0,o.z)(507918273)}configureRootServices(e){e.bind(n.i).toValue(l.C),e.bind(a.C).to(d.D),e.bind(s.S).toExisting(a.C)}}},19806:(e,t,i)=>{if(i.d(t,{H:()=>r}),2063!=i.j)var n=i(54425);if(2063!=i.j)var o=i(29732);if(2063!=i.j)var s=i(15275);class r{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918243)}configureRootServices(e){e.bind(n.W).to(o.M)}}},61181:(e,t,i)=>{if(i.d(t,{e:()=>a}),2063!=i.j)var n=i(23888);if(2063!=i.j)var o=i(15275);if(2063!=i.j)var s=i(34471);if(2063!=i.j)var r=i(12804);class a{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918239)}configureRootServices(e){e.bind(n.h).to(r.a),e.bind(s.S).toExisting(n.h)}}},40210:(e,t,i)=>{i.d(t,{B:()=>v});var n=i(23182),o=i(19858),s=i(27651),r=i(26883),a=i(39875),l=i(39423),d=i(51451),c=i(36915),u=i(33767),h=i(29906),g=i(83010);const p=new Map([[d.l.EnableCopilotInsert,!0],[d.l.EnableCopilotRewrite,!0],[d.l.EnableSpelling,!0],[d.l.EnableGrammar,!0],[d.l.EnableRefinements,!0],[d.l.EnableTelemetry,!0]]),m=new Map([[d.l.AppId,"EditorBX_Online"],[d.l.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}])],[d.l.ProofingLanguages,[]],[d.l.CritiqueValuePerLanguage,JSON.stringify([])],[d.l.DefaultProofingLanguageInitialized,!1],[d.l.ProofingLanguageListInitialized,!1],[d.l.IsLanguageAutoDetectEnabled,!0],[d.l.TonalFREAccepted,!1],[d.l.EnableEditor,!0],[d.l.EnableTextPrediction,!0],[d.l.EnableCIQFlags,!0],[d.l.EnableCIQMenu,!0],[d.l.OverriddenCritiqueTypeOptions,[]],[d.l.OverriddenInlineEditingSettings,[]],[d.l.PaneOverriddenCritiqueTypeOptions,[]],[d.l.StealthOverriddenCritiqueTypeOptions,[]],[d.l.ShowSynonyms,!1],[d.l.EnableSynonymsToggle,!1],[d.l.ConfigurationId,""],[d.l.ClientId,""],[d.l.HashedUserDictionary,[]]]),f=new Map([[d.l.DefaultLoggingLevel,c.q.Info],[d.l.DebugMode,!1]]);let v=class extends o.u{constructor(e,t,i,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i,this._hostSettings=n,this.write(d.l.AppId,this._hostSettings.appId)}populateStoreEntryMap(){const e=new Map;return p.forEach(((t,i)=>{e.set(i,{storeEntry:(0,s.EM)(i,t),isSynced:!0})})),m.forEach(((t,i)=>{e.set(i,{storeEntry:(0,s.EM)(i,t)})})),f.forEach(((t,i)=>{e.set(i,{storeEntry:(0,s.EM)(i,t,!0)})})),e}async initialize(){for(const e of p.keys())await this.read(e);await this.read(d.l.ConfigurationId);const e=Array.from(p.keys());e.push(...Array.from(m.keys())),e.push(...Array.from(f.keys()));for(const t of e)this._emitter.on(t,(()=>this.read(t)))}shutDown(){}async read(e){return e===d.l.AppId?Promise.resolve(this._hostSettings.appId):super.read(e)}async removePersistentKeys(){const e=Array.from(p.keys());e.push(...Array.from(m.keys())),e.push(...Array.from(f.keys())),e.length&&await this.storeEntryWriter.remove(e)}};v=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,g.W)(r.A)),(0,n.__param)(1,(0,g.W)(a.a)),(0,n.__param)(2,(0,g.W)(l.E)),(0,n.__param)(3,(0,g.W)(u.n))],v)},96505:(e,t,i)=>{i.d(t,{C:()=>g});var n,o=i(23182),s=i(19858),r=i(27651),a=i(26883),l=i(39875),d=i(39423);!function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(n||(n={}));var c=i(29906),u=i(83010);const h=new Map([[n.CourtesyAttributes,["data-gramm"]],[n.RootContentMaxLengthInChars,500]]);let g=class extends s.u{constructor(e,t,i){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i}populateStoreEntryMap(){const e=new Map;return h.forEach(((t,i)=>{e.set(i,{storeEntry:(0,r.Tm)(i,t),isSynced:!1})})),e}async initialize(){for(const e of h.keys())await this.read(e),this._emitter.on(e,(async()=>{await this.read(e)}))}shutDown(){}async removePersistentKeys(){const e=Array.from(h.keys());e.length&&await this.storeEntryWriter.remove(e)}};g=(0,o.__decorate)([(0,c._)(),(0,o.__param)(0,(0,u.W)(a.A)),(0,o.__param)(1,(0,u.W)(l.a)),(0,o.__param)(2,(0,u.W)(d.E))],g)},30857:(e,t,i)=>{i.d(t,{e:()=>d});var n=i(23182),o=i(3568),s=i(33767),r=i(29906),a=i(83010),l=i(63326);let d=class extends o.a{constructor(e){super(),this.hostSettings=e,this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?l.fT.Paragraph:l.fT.Sentence,this.partialTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?l.fT.Sentence:l.fT.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.n))],d)},87012:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(17298).f)("IEditorClientSettings")},29732:(e,t,i)=>{i.d(t,{M:()=>w});var n=i(23182),o=(i(42410),i(8520)),s=i(94329),r=i(37053),a=i(33767),l=i(25622),d=i(84030),c=i(28798),u=i(81168),h=i(98647),g=i(79360),p=i(38822),m=i(18406),f=i(37614),v=i(16221),_=i(2507),y=i(35482),I=i(71187);class C{constructor(e){var t,i,n;this.injector=e,this.render=()=>{var e,t;const i=this.injector.container.get(r.g);s.render(o.createElement(m.t,{errorEventName:f.s.UnhandledContentError,logger:i,maxRecoveryRetry:10,errorMessage:"Unhandled render content script error"},o.createElement(_.U,{injector:this.injector},o.createElement(p.q,null))),null!==(t=null===(e=this.editorCardShadowRoot)||void 0===e?void 0:e.firstElementChild)&&void 0!==t?t:this.editorCard)},this.onWindowUnload=()=>{try{this.shutDown()}catch(e){}};const u=this.injector.container.get(a.n);this.targetDocument=null!==(t=this.injector.container.getOptional(l.jh))&&void 0!==t?t:new d.O(document);const h=this.injector.container.getOptional(c.iw),g=this.targetDocument.deref();g&&(this.editorCard=g.createElement("editor-card"),this.editorCard.setAttribute("style",`position:absolute;top:0px;left:0px;z-index:${null!==(i=u.editorCardZIndex)&&void 0!==i?i:"auto"};display: block !important`),h&&this.editorCard.setAttribute("dir",h.dir()),g.body.appendChild(this.editorCard),this.editorCardShadowRoot=u.renderWithinShadowDOM&&g!==document?this.editorCard.attachShadow({mode:"open"}):void 0,this.editorCardShadowRoot&&(this.editorCardShadowRoot.appendChild(document.createElement("div")),(null===(n=u.disposalSettings)||void 0===n?void 0:n.enableReactEventCleanup)&&(this.reactEventCleanup=new v.s(this.editorCardShadowRoot))))}async initialize(){var e;if(!this.targetDocument||!this.editorCard)return;const t=this.targetDocument.deref();if(!t)return;const i=this.injector.container.get(r.g);i.debug(520984577,"[ReactApp] Render main app view");const n=this.injector.container.get(a.n);if(this.editorCardShadowRoot||!n.disableStyleCopying&&t!==document){const i=this.injector.container.get(u.G);this.disposal=n.enablePersistentStyleCopying?(0,y.wn)(t,i):(0,I.WH)(null!==(e=this.editorCardShadowRoot)&&void 0!==e?e:t.head)}window.frameElement&&(this.windowEventListener=new h.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnload,{once:!0})),this.injector.container.bind(l.q4).toValue(new g.l(this.editorCard,i,"Target render element ref is unavailable")),this.reactEventCleanup?this.reactEventCleanup.render(this.render):this.render()}shutDown(){var e,t,i,n,o,r;try{null===(e=this.disposal)||void 0===e||e.call(this)}catch(e){}if(this.editorCard)try{s.unmountComponentAtNode(null!==(i=null===(t=this.editorCardShadowRoot)||void 0===t?void 0:t.firstElementChild)&&void 0!==i?i:this.editorCard)}catch(e){}null===(n=this.reactEventCleanup)||void 0===n||n.cleanup(),this.reactEventCleanup=void 0,null===(o=this.windowEventListener)||void 0===o||o.removeAllListeners(),this.windowEventListener=void 0,this.disposal=void 0,null===(r=this.editorCard)||void 0===r||r.remove(),this.editorCard=void 0,this.editorCardShadowRoot=void 0,this.targetDocument=void 0}}var S=i(45352),b=i(88728),T=i(29906),E=i(83010),N=i(53356);let x=class{constructor(e){this._injector=e,this._initialized=!1,this._shutDown=!1}async initializeComponent(){if(this._initialized)return;this._initialized=!0;const e=this._injector.container.getOptional(b.K);if(e){const t=e.map((e=>e())),i=await Promise.all(t);for(const e of i)if(Array.isArray(e))for(const t of e)this._injector.addModule(t);else this._injector.addModule(e);await this._injector.container.get(S.V).recheckRegistrables(this._injector.container)}this._shutDown||(this.reactApp=await this.loadReactApp(),this._shutDown?this.reactApp.shutDown():await this.reactApp.initialize())}shutDown(){var e;this._shutDown=!0,null===(e=this.reactApp)||void 0===e||e.shutDown(),this.reactApp=void 0}};x=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,E.W)(N.J))],x);let w=class extends x{async loadReactApp(){return new C(this._injector)}};w=(0,n.__decorate)([(0,T._)()],w)},95323:(e,t,i)=>{var n;i.d(t,{_:()=>n}),function(e){e[e.Remote=0]="Remote",e[e.System=1]="System",e[e.User=2]="User"}(n||(n={}))},27651:(e,t,i)=>{if(i.d(t,{EM:()=>s,Hs:()=>r,Tm:()=>o}),2063!=i.j)var n=i(95323);const o=(e,t)=>({name:e,storeEntryType:n._.Remote,defaultValue:t,lastValueFromStorage:void 0}),s=(e,t,i)=>({name:e,storeEntryType:n._.User,defaultValue:t,lastValueFromStorage:void 0,shouldNotWriteDefaultValue:i});var r;!function(e){e.FeatureFlags="featureFlags",e.DynamicSettings="dynamicSettings"}(r||(r={}))},96052:(e,t,i)=>{i.d(t,{tx:()=>S});var n=i(23182),o=i(27999),s=i(36915),r=i(51199),a=i(37053),l=i(29906),d=i(83010),c=i(15232),u=i(22649),h=i(47492);let g=class extends h.t{constructor(e){super(e)}checkUserInfo(){return void 0===this.ageGroup||this.ageGroup===c.P2.Adult||this.ageGroup===c.P2.MinorNoParentalConsentRequired||this.ageGroup===c.P2.Unknown}};g=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],g);let p=class extends h.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===c.P2.NotAdult}};p=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],p);let m=class extends h.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===c.P2.MinorWithoutParentalConsent||this.ageGroup===c.P2.MinorWithParentalConsent}};m=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],m);var f=i(27603),v=i(1386),_=i(39423),y=i(26883),I=i(27651);const C={enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableOptimizedRehydration:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,enableAriaStatusElement:!1,enableCssHighlightApiAnnouncementsOnly:!1,enableCssHighlightApiAnnouncementsOnlyForSpellingAndGrammar:!1,enableLineNavAriaAnnouncement:!1,enableCSSHighlightApiSquiggleRendering:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,mutationObserverBasedRelativePosition:!1,visibilityTrackerShouldTrackSquiggles:!0,enableCursorIntersectionObserver:!1,isMsitUser:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1,enablePersonalizedAutoCorrect:!1,enableParagraphUpdates:!1,enableForceClearCritiques:!0,enableConditionalSignInMessage:!1,disableCalcLengthForAddDeltasInPresentation:!0,enableAnnotationActivationConfig:!0,enableAutoCorrectInputCache:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!1,enablePhraseTextUnitClientSide:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableParagraphDeltas:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableParagraphDeltasEmptyInitialTile:!1,enableGDocsAnnotatedCanvas:!1,disableTileNodeObserver:!1,enableQueryOnlyOnLocalChange:!1,enableSvgSquiggleUnderline:!1,enableEditorServiceRouting:!1,enableNoDismissOnClickOutside:!0,enableCopywriter:!1,disableCalloutOnDoubleClick:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!0,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,enableSquigglesOnlyOnWholeWords:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1};let S=class{constructor(e,t,i,n,s,r){this._emitter=e,this._storeEntryReader=t,this._logger=i,this._isAdult=n,this._isMinor=s,this._isChild=r,this._defaultAdultOnlyFeature={enableUpsellFeature:!0},this._defaultMinorAndAboveFeature={enableBxTelemetry:!0,enableRateExtensionPrompt:!0,enableRateExtensionPromptEdge:!0,enableRateExtensionPromptFpsSurvey:!0,enableOcvIntEndpoint:!0,enableOcvFeedbackUi:!0,enableUninstallSurvey:!0},this._defaultFeatureFlags=Object.assign(Object.assign(Object.assign({},this._defaultMinorAndAboveFeature),this._defaultAdultOnlyFeature),C),this._rolloutFeatureFlags=(0,I.Tm)(I.Hs.FeatureFlags,C),this._localFlags=Object.assign({},this._defaultFeatureFlags),this._flagOverrides={},this.updatedAdultOnlyFeatureFlags=e=>{var t;const i=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isAdult)||void 0===t?void 0:t.check()),n=Object.assign({},this._defaultAdultOnlyFeature);for(const t in this._defaultAdultOnlyFeature)n[t]=i&&e[t];return n},this.updateMinorAndAboveFeatureFlags=e=>{var t,i;const n=!this.areAgeGroupPredicatesProvided()||(!!(null===(t=this._isMinor)||void 0===t?void 0:t.check())||!!(null===(i=this._isAdult)||void 0===i?void 0:i.check())),o=Object.assign({},this._defaultMinorAndAboveFeature);for(const t in this._defaultMinorAndAboveFeature)o[t]=n&&e[t];return o},this.areAgeGroupPredicatesProvided=()=>!!(this._isAdult&&this._isChild&&this._isMinor),this._eventPublisher=new o.z}get flags(){return this._localFlags}overrideFlags(e){this._flagOverrides=e,this.applyFlagOverrides()}applyFlagOverrides(){this._localFlags=Object.assign(Object.assign({},this._localFlags),this._flagOverrides)}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(I.Hs.FeatureFlags,(()=>{this.updateFlags()})),await this.updateFlags()}shutDown(){}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutFeatureFlags);let t=Object.assign(Object.assign({},this._defaultFeatureFlags),...Object.entries(e).map((([e,t])=>{return{[e]:(i=t,"string"==typeof i?"true"===i.toLowerCase():!0===i)};var i})));if(t.enableAadc){const e=this.updateMinorAndAboveFeatureFlags(t),i=this.updatedAdultOnlyFeatureFlags(t);t=Object.assign(Object.assign(Object.assign({},t),e),i)}this._localFlags=t,this.applyFlagOverrides(),this.publishEvent("flagsChanged",this.flags)}catch(e){this._logger.logEvent(571318787,v.s.FeatureFlagParsingError,s.q.Error,void 0,r.o.SamplingPolicy.Diagnostics)}}subscribe(e,t){this._eventPublisher.subscribe(e,t)}unsubscribe(e,t){this._eventPublisher.unsubscribe(e,t)}publishEvent(e,t){this._eventPublisher.publishEvent(e,t)}};S=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(_.E)),(0,n.__param)(1,(0,d.W)(y.A)),(0,n.__param)(2,(0,d.W)(a.g)),(0,n.__param)(3,(0,f.l)()),(0,n.__param)(3,(0,d.W)(g)),(0,n.__param)(4,(0,f.l)()),(0,n.__param)(4,(0,d.W)(p)),(0,n.__param)(5,(0,f.l)()),(0,n.__param)(5,(0,d.W)(m))],S)},6566:(e,t,i)=>{i.d(t,{b:()=>a});var n=i(23182),o=i(29906),s=i(83010),r=i(3152);let a=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const i={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1},n={};n[e]=JSON.stringify(i),await this._extensionStorage.set(n)}};a=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(r.D))],a)},26883:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(17298).f)("IStoreEntryReader")},39875:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(17298).f)("IStoreEntryWriter")},49514:(e,t,i)=>{i.d(t,{t:()=>h});var n=i(23182),o=i(36915),s=i(51199),r=i(37053),a=i(29906),l=i(83010),d=i(1386),c=i(3152),u=i(6566);let h=class extends u.b{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const i=JSON.parse(t.value);return t.manualOverride&&void 0!==i?i:(e.lastValueFromStorage=i,void 0!==i?i:e.defaultValue)}}else try{return e.shouldNotWriteDefaultValue||await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(521479644,d.s.SettingInitializeError,o.q.Error,void 0,s.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}catch(e){this._logger.logEvent(521479643,d.s.SettingReadError,o.q.Error,void 0,s.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(521479642,d.s.SettingReadError,o.q.Error,void 0,s.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.get(e.name);if(t[e.name]){return JSON.parse(t[e.name])}}};h=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(c.D)),(0,n.__param)(1,(0,l.W)(r.g))],h)},38938:(e,t,i)=>{i.d(t,{r:()=>h});var n=i(23182),o=i(36915),s=i(51199),r=i(37053),a=i(29906),l=i(83010),d=i(1386),c=i(3152),u=i(6566);let h=class extends u.b{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let i=!1;const n=await this._extensionStorage.get(e.name);if(n[e.name]){i=JSON.parse(n[e.name]).manualOverride}i?this._logger.logEvent(521479641,d.s.SettingManualOverrideWarning,o.q.Warn,`manual override for store entry ${e.name} - writing skipped`,s.o.SamplingPolicy.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(521479640,d.s.SettingWriteError,o.q.Error,void 0,s.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async remove(e){await this._extensionStorage.remove(e)}};h=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(c.D)),(0,n.__param)(1,(0,l.W)(r.g))],h)},1386:(e,t,i)=>{var n,o;i.d(t,{M:()=>n,s:()=>o}),function(e){e.RemoteSettingSync="RemoteSettingSync"}(n||(n={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError",e.DynamicSettingsParsingError="RunTimeErrors.DynamicSettingsParsingError"}(o||(o={}))},39423:(e,t,i)=>{i.d(t,{E:()=>n});const n=(0,i(17298).f)("ISettingsEmitterBase")},64943:(e,t,i)=>{i.d(t,{G:()=>a});var n=i(23182);var o=i(29906),s=i(83010),r=i(3152);let a=class{constructor(e){this._browserStorage=e,this.registrations={},this.eventNamesUsed=new Set,this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]={listeners:[]}),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback);for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}_storageChangeDispatcher(e,t){for(const t of Object.keys(e)){const i=JSON.parse(e[t].oldValue),n=JSON.parse(e[t].newValue);(null==i?void 0:i.value)!==(null==n?void 0:n.value)&&this.callListeners(t,e[t].newValue)}}callListeners(e,t){const i=e,n=this.safelyGetRegistration(i);for(const e of n.listeners)e(t)}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0===e)return void(this.registrations={});if(void 0===t)return void(this.registrations[e]={listeners:[]});if(!((e,t)=>{let i=!1;for(let n=0;n<e.length;n+=1)e[n]===t&&(i=!0,e.splice(n,1),n-=1);return i})(this.safelyGetRegistration(e).listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}emit(e,...t){const i=this.safelyGetRegistration(e);for(const e of i.listeners)e(...t)}};a=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(r.D))],a)},7611:(e,t,i)=>{if(i.d(t,{H:()=>m}),2063!=i.j)var n=i(96052);if(2063!=i.j)var o=i(3152);if(2063!=i.j)var s=i(15275);if(2063!=i.j)var r=i(48662);if(2063!=i.j)var a=i(34471);if(2063!=i.j)var l=i(39423);if(2063!=i.j)var d=i(26883);if(2063!=i.j)var c=i(39875);if(2063!=i.j)var u=i(46845);if(2063!=i.j)var h=i(64943);if(2063!=i.j)var g=i(49514);if(2063!=i.j)var p=i(38938);class m{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918231)}configureRootServices(e){e.bind(r.c).to(n.tx),e.bind(a.S).toExisting(r.c),e.bind(d.A).to(g.t),e.bind(c.a).to(p.r),e.bind(o.D).to(u.h),e.bind(a.S).toExisting(o.D),e.bind(l.E).to(h.G),e.bind(a.S).toExisting(l.E)}}},19709:(e,t,i)=>{if(i.d(t,{p:()=>u}),2063!=i.j)var n=i(96669);if(2063!=i.j)var o=i(84194);if(2063!=i.j)var s=i(15275);if(2063!=i.j)var r=i(33767);if(2063!=i.j)var a=i(34471);if(2063!=i.j)var l=i(81427);if(2063!=i.j)var d=i(7611);if(2063!=i.j)var c=i(33272);class u{constructor(){this.imports=[d.H,o.k]}get uniqueId(){return(0,s.z)(507918238)}configureRootServices(e){e.bind(n.qq).toDynamicValue((e=>{const t=e.get(r.n);return new n.qq({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(l.$).to(c.o),e.bind(a.S).toExisting(l.$)}}},19858:(e,t,i)=>{i.d(t,{u:()=>s});var n=i(23182),o=i(29906);let s=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),i=t.storeEntry;return{storeEntryValue:void 0===i.lastValueFromStorage?i.defaultValue:i.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}async removePersistentKeys(){}};s=(0,n.__decorate)([(0,o._)()],s)},81427:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(17298).f)("IRemoteSettingsSyncer")},33272:(e,t,i)=>{i.d(t,{o:()=>S});var n=i(23182),o=i(63326),s=i(96669),r=i(36915),a=i(51199),l=i(51451),d=i(63526),c=i(37053),u=i(22649),h=i(7988),g=i(81168),p=i(98839),m=i(29906),f=i(83010),v=i(1386),_=i(6566),y=i(3152);function I(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}function C(e){return{descriptors:I(e.descriptors),disabledWebSites:I(e.disabledWebSites),allowedUrls:I(e.allowedUrls),disabledGrammars:I(e.disabledGrammars),editorClientState:I(e.editorClientState),configurationId:I(e.configurationId),featureFlags:I(e.featureFlags),dynamicSettings:I(e.dynamicSettings),intervalForActivityCleanup:I(e.intervalForActivityCleanup),conflictingElements:I(e.conflictingElements)}}let S=class extends _.b{constructor(e,t,i,n,o,s,r,a){super(e),this._editorService=t,this._proofingStore=i,this._logger=n,this._userInfoStrategy=o,this._sessionContextProvider=s,this._guidGenerator=r,this._timer=a,this._timerName="RemoteSettingsSyncerTimer"}async initialize(){}shutDown(){this._timer.clearTimer(this._timerName)}schedule(e,t){this._timer.setIntervalWithDelay(this._timerName,(async()=>this.sync()),t,e)}async sync(){this._logger.debug(537518984,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===o.ED.Success){this.logTelemetry(e);const i=C(t),n=await this.removeManualOverrides(i);if(n)return this._logger.debug(537518985,"Writing remote settings to local storage"),this.writeSettings(n)}}return this._logger.debug(537518986,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.set(e),!0}catch(e){this._logger.logEvent(537518987,v.s.SettingsSyncWriteError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(l.l.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(l.l.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){var e;try{const t=await this._sessionContextProvider();let i,n;const o=await this.fetchClientId(),s=await this._userInfoStrategy.executeAsync(!1);(null==s?void 0:s.userId)?(this._editorService.xUserId=s.userId,i=s.tenantId,n=s.email):this._editorService.xUserId=o;return{appId:await this._proofingStore.read(l.l.AppId),browser:t.browserType,browserVersion:null!==(e=t.browserVersion)&&void 0!==e?e:"",email:n,extensionId:t.extensionVersion,languageUxId:t.languageUxId,storeId:t.extensionStoreId,tenantId:i,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(537518988,v.s.SettingsSyncEditorRequestBuildError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}logTelemetry(e){if(this._lastConfigRequestUserId&&this._lastConfigRequestUserId===this._editorService.xUserId&&this._lastConfigRequest&&this._lastConfigRequest.browserVersion===e.browserVersion&&this._lastConfigRequest.email===e.email&&this._lastConfigRequest.languageUxId===e.languageUxId&&this._lastConfigRequest.tenantId===e.tenantId)return;this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(v.M.RemoteSettingSync,a.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())}async fetchRemoteSettings(e){var t;try{return await this._editorService.browserextension(e,{requestOptions:{customHeaders:{"X-UserId":null!==(t=this._editorService.xUserId)&&void 0!==t?t:""}}})}catch(e){this._logger.logEvent(537518989,v.s.SettingsSyncEditorServiceError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const i=await this._extensionStorage.get(e);for(const n of Object.keys(i)){JSON.parse(i[n]).manualOverride?this._logger.debug(537518990,"Manual override for remote setting",n):t[n]=e[n]}}catch(e){return this._logger.logEvent(537518991,v.s.SettingsSyncReadOverrideError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),void this.setLastError(e)}return t}async removePersistentKeys(){const e=Object.keys(C({}));e.length&&await this._extensionStorage.remove(e)}};S=(0,n.__decorate)([(0,m._)(),(0,n.__param)(0,(0,f.W)(y.D)),(0,n.__param)(1,(0,f.W)(s.qq)),(0,n.__param)(2,(0,f.W)(d.K)),(0,n.__param)(3,(0,f.W)(c.g)),(0,n.__param)(4,(0,f.W)(u.e)),(0,n.__param)(5,(0,f.W)(h.a)),(0,n.__param)(6,(0,f.W)(g.G)),(0,n.__param)(7,(0,f.W)(p.J))],S)},3152:(e,t,i)=>{i.d(t,{D:()=>s});var n,o=i(17298);!function(e){e.LocalStorageApi="LocalStorageApi"}(n||(n={}));const s=(0,o.f)("IBrowserStorageApi")},46845:(e,t,i)=>{i.d(t,{h:()=>a});var n,o=i(23182),s=i(29906),r=i(98647);let a=n=class{constructor(){this.eventListener=new r.J(document)}async initialize(){}shutDown(){this.eventListener.removeAllListeners()}async set(e){const t=Object.keys(e),i={};for(const n of t){const t=e[n];i[n]={oldValue:localStorage.getItem(n),newValue:t};try{localStorage.setItem(n,t)}catch(e){return Promise.reject(e)}}const n=new CustomEvent("storageItemInserted",{detail:i});return document.dispatchEvent(n),Promise.resolve()}async remove(e){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);return Promise.resolve()}async get(e){const t={};if("string"==typeof e)t[e]=n._getItem(e);else if(Array.isArray(e))for(const i of e)t[i]=n._getItem(i);else if(e instanceof Object){const i=Object.keys(e);for(const o of i){const i=n._getItem(o);t[o]=i||e[o]}}return Promise.resolve(t)}addChangeListener(e){this.eventListener.addListener("storageItemInserted",(t=>{t.detail&&e(t.detail,"")}))}removeEventListener(e){this.eventListener.removeAllListeners()}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};a=n=(0,o.__decorate)([(0,s._)()],a)},83817:(e,t,i)=>{function n(e){var t;if(e)return"true"===(null===(t=e.contentEditable)||void 0===t?void 0:t.toLowerCase())?e:n(e.parentElement)}i.d(t,{m:()=>n})},23888:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(17298).f)("IIndexReadjuster")},47211:(e,t,i)=>{i.d(t,{Q:()=>r});var n=i(23182),o=i(23750),s=i(29906);let r=class{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):t,this._dmp=new o.diff_match_patch,this._dmp.Diff_Timeout=0}getReadjustedIndices(e,t,i,n){var o;const s=[],r=null!==(o=e.textContent)&&void 0!==o?o:"",a=n?this._dmp.diff_main(i,r):this._dmp.diff_main(r,i);if(1===a.length&&0===a[0][0])return t;let l=0,d=0,c=0,u=0,h=0,g=0;for(const e of a){const i=e[0],n=e[1].length;switch(i){case 0:h=n,g=n;break;case 1:h=0,g=n;break;case-1:c+=n;continue}d+=c,c=0;for(let e=l;e<t.length;e+=1){const n=this.getIndex(t[e]);if(n<u)throw new Error("Indices are not sorted!");if(!(n>=u&&n<u+g))break;s[e]=0===i?this.getNewValue(t[e],n+d-u):this.getNewValue(t[e],d),l+=1}if(l===t.length)break;d+=h,u+=g}for(let e=l;e<t.length;e+=1)s[e]=this.getNewValue(t[e],d);return s}};r=(0,n.__decorate)([(0,s._)()],r)},5182:(e,t,i)=>{if(i.d(t,{O:()=>r}),2063!=i.j)var n=i(23888);if(2063!=i.j)var o=i(47211);if(2063!=i.j)var s=i(15275);class r{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918221)}configureRootServices(e){e.bind(n.h).to(o.Q)}}},25359:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(17298).f)("ITextUnitChunker")},71602:(e,t,i)=>{i.d(t,{b0:()=>r,c0:()=>s,hN:()=>o,pT:()=>a});var n=i(17298);const o=(0,n.f)("ISentenceTextUnitSeparator"),s=(0,n.f)("IParagraphTextUnitSeparator"),r=(0,n.f)("IDefaultTextUnitSeparator"),a=(0,n.f)("IDocumentTextUnitSeparator")},89637:(e,t,i)=>{i.d(t,{t:()=>n});const n=(0,i(17298).f)("IWordCount")},63995:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(17298).f)("IWordCountDetector")},66166:(e,t,i)=>{i.d(t,{a:()=>s});var n=i(23182),o=i(29906);let s=class{findBeginBoundary(e,t,i){const n=e.lastIndexOf("\n",t-1);return-1===n||n<=i?i:n+1}findEndBoundary(e,t,i){const n=e.indexOf("\n",t+1);return-1===n||n>i?-1:n+1}splitInUnits(e){const t=[];let i=-1;do{i=e.indexOf("\n",i+1),-1!==i&&t.push(i+1)}while(-1!==i);return t}};s=(0,n.__decorate)([(0,o._)()],s)},23150:(e,t,i)=>{i.d(t,{F:()=>D});var n=i(23182),o=i(33767),s=i(29906),r=i(83010);const a="[\0-\b\n--\u2028-\u2029]",l="[!-#%-*,-/:-;?-@_{}--------------------------------]",d="[----]",c="[?!.]",u="[]",h="[ -\t]",g="[\"']",p="[)]}]|[]|[]",m="[\u2028\u2029\n\r]",f=`[.]{2,6}|[.]([ ][.]){1,5}|([--])[.]|${`${`(${h}|${a}|${l}|${d})`}((((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]|((([]?[]{1,3}|[][]|[])?([]?[]{1,3}|[][]|[]))|([]?[]{1,3}|[][]|[])|(([]?[]{1,3}|[][]|[])?([]?[]{1,3}|[][]|[]))|([]?[]{1,3}|[][]|[]))[.]|([0-9]{1,4}[.]|[-]{1,4}[.])|([0-9]+(([ao])|((er)[ao]?)|(([][])[]?)|([mdtvn][ao])|([][]))[.]|[A-Za-z]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z]+((STR)|(str))[.]))`}|${`${`(${h}|${a}|${l}|[$+<=>^\`|~------------]|${d}|[0-9-------------------]|[-------])`}((([A-Za-z--------------]|[------------------------------------------------------------------------------------------------]|[--])[.])+|(([------])[.])+)`}`,v=new RegExp(`${c}|${u}`,"ig"),_=new RegExp(`${c}|${u}|${m}`,"ig"),y=new RegExp(f,"g");function I(e,t,i=0){const n=[];let o=t.exec(e);for(;null!==o;){if(o[i]){const e=o.index;n.push({begin:e,end:e+o[i].length})}o=t.exec(e)}return n}const C=`(${c}(${p}|${g}|${h})*${m})`,S=`(${c}(${p})*(${h})+)`,b=`(${u}(${p})*)`,T=`((${m})+)`,E=`(${c}(${p}|${g}|${h})*(${m})+)`,N=[new RegExp(C,"ig"),new RegExp(S,"ig"),new RegExp(b,"ig")],x=[new RegExp(S,"ig"),new RegExp(b,"ig"),new RegExp(T,"ig"),new RegExp(E,"ig")],w=new RegExp(`${C}|${S}|${b}`,"ig"),L=new RegExp(`${S}|${b}\n    |${T}|${E}`,"ig");let D=class{constructor(e){this._hostSettings=e}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?x:N;for(const i of t){const t=I(e,i);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=I(e,y),i=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some((e=>e.end===i))}findBeginBoundary(e,t,i){const n=this._hostSettings.newLineSentenceSeparatorEnabled?_:v,o=e.substring(i,t),s=I(o,n);for(let e=s.length-1;e>=0;e-=1){const t=o.substring(0,s[e].end);if(!this.isEndPuncSpecialCase(t)){const t=o.substring(s[e].begin,o.length),n=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===n:!n)continue;return i+s[e].end+n}}return i}findEndBoundary(e,t,i){const n=e.substring(t,i),o=I(n,this._hostSettings.newLineSentenceSeparatorEnabled?_:v);for(const e of o){const i=n.substring(0,e.end);if(!this.isEndPuncSpecialCase(i)){const i=n.substring(e.begin,n.length),o=this.expandEndRange(i);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===o:!o)continue;return t+e.end+o}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?L:w;return I(e.replace(y,(e=>"#".repeat(e.length))),t).map((e=>e.end))}};D=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(o.n))],D)},402:(e,t,i)=>{i.d(t,{_n:()=>l,e:()=>d});var n=i(23182),o=i(29906),s=i(83010),r=i(71602),a=i(63326);let l=class{constructor(e,t,i){this._sentenceSeparator=e,this._paragraphSeparator=t,this._unitySeparator=i}splitInUnitsFromExtendedBoundaries(e,t,i,n){return d(e,t,this.getUnitSeparator(i),n)}extendBoundariesFromDiffBounds(e,t,i){return c(e,t,this.getUnitSeparator(i))}getUnitSeparator(e){switch(e){case a.fT.Sentence:return this._sentenceSeparator;case a.fT.Paragraph:return this._paragraphSeparator;default:return this._unitySeparator}}};function d(e,t,i,n){const o=function(e,t,i,n){if(!i.firstDiffLeft&&!i.firstDiffRight&&!n.offset&&n.span===t.length)return function(e,t){const i=[],n=e.splitInUnits(t);let o=0;for(const e of n)i.push({offset:o,span:e-o,validEndBoundary:-1!==e}),o=e;(!n.length||n.length&&n[n.length-1]!==t.length)&&i.push({offset:o,span:t.length-o,validEndBoundary:!1});return i}(e,t);const o=2,s=t.slice(n.offset,n.offset+n.span),r=i.firstDiffLeft-n.offset,a=i.firstDiffRight-(t.length-n.offset-n.span);let l=0,d=0;const c=[],u=Math.min(s.length,s.length-a+o);do{const t=l;l=e.findEndBoundary(s,Math.max(l,r-o),u),d=-1!==l&&l<u?l:s.length,d-t&&c.push({offset:t+n.offset,span:d-t,validEndBoundary:-1!==l,enforcedCompleteTileTextUnit:n.enforcedCompleteTileTextUnit})}while(d<s.length);return c}(i,e,t,n||c(e,t,i));return!o.length||o[o.length-1].validEndBoundary&&!1!==o[o.length-1].validEndBoundary||(o[o.length-1]=function(e,t,i){if(!1===t.validEndBoundary&&t.span>=2){let n,o=t.span;do{n=e.slice(t.offset+o-2,t.offset+o),o-=1}while(!/\S/.test(n)&&o>=2);t.validEndBoundary=-1!==i.findEndBoundary(n,0,n.length)}return t}(e,o[o.length-1],i)),o}function c(e,t,i){let n,o=0,s=e.length,r=t.firstDiffLeft+1;if(e.length)do{if(r-=1,o=i.findBeginBoundary(e,r,0),s=i.findEndBoundary(e,e.length-t.firstDiffRight,e.length),n=-1!==s,s=-1!==s?s:e.length,r<e.length){if(o===i.findBeginBoundary(e,r+1,0))continue}let a=o,l=0;for(;a&&r===a+l;){l+=1;const t=a;if(a=i.findBeginBoundary(e,a-1,0),a<t-1){o=a;break}}}while(!(s-o));return{offset:o,span:s-o,validEndBoundary:n}}l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,s.W)(r.hN)),(0,n.__param)(1,(0,s.W)(r.c0)),(0,n.__param)(2,(0,s.W)(r.b0))],l)},94335:(e,t,i)=>{i.d(t,{R:()=>s});var n=i(23182),o=i(29906);let s=class{findBeginBoundary(e,t,i){return Math.min(t,i)}findEndBoundary(e,t,i){return e.length<i?-1:Math.max(t,i)}splitInUnits(e){return[e.length]}};s=(0,n.__decorate)([(0,o._)()],s)},968:(e,t,i)=>{i.d(t,{B:()=>g,a:()=>a});var n=i(23182),o=i(29906),s=i(3661);const r=new Set(["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\ufeff","","","","",""]);let a=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let i=this.getForwardBreak(e,t);return"WhiteSpace"===(null==i?void 0:i.wordBreakType)&&(i=this.getForwardBreak(e,i.cp)),i?i.cp:e.length}getBackwardBreakByWord(e,t){let i=this.getBackwardBreak(e,t);return"WhiteSpace"===(null==i?void 0:i.wordBreakType)&&(i=this.getBackwardBreak(e,i.cp)),i?i.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){if(t<=1)return;let i=t;for(;i>0;){const t=d(e,i-1);switch(t){case"Undetermined":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(i<=1)return;const n=i-1,o=d(e,n-1);if(t!==o&&l(t,o)&&("Undetermined"!==o||!this.supportsBrowserWordBreaking))return{cp:n,wordBreakType:t};break}}i-=1}}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:d(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,i){const n=[];if(!e)return n;let o,s=t;do{o&&(n.push(o),s=o.cp),o=this.getForwardBreakInternal(e,s,i)}while(o);return n}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,i){return this.getWordCountAndBreaksInRange(e,t,i).wordCount}getWordCountAndBreaksInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);return n.splice(0,0,this.getTextWordBreak(e,t)),{wordCount:this.getWordCount(n,e),wordBreaks:n}}getWordCountWithBoundariesAndBreaksInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);n.splice(0,0,this.getTextWordBreak(e,t));const o=this.getWordCountFromWordBreaks(n,e);return{wordCount:o.wordCount,wordBoundaries:o.wordBoundaries,wordBreaks:n}}getWordCountFromWordBreaks(e,t){const i={browserWordBreakCount:0,wordCount:0,wordBoundaries:[]};let n;for(let o=0;o<e.length;o+=1){const s=e[o];"AlphaNumeric"===s.wordBreakType||"Undetermined"===s.wordBreakType?("Undetermined"===s.wordBreakType&&(i.browserWordBreakCount+=1),c(o,e,t)&&(i.wordCount+=1,n=s.cp)):(void 0!==n&&(i.wordBoundaries.push({start:n,end:s.cp-1}),n=void 0),"Punctuation"!==s.wordBreakType&&"PuncuationWithoutBreak"!==s.wordBreakType||!u(o,e,t)||(i.wordCount+=1))}return void 0!==n&&i.wordBoundaries.push({start:n,end:t.length-1}),i}getForwardBreakInternal(e,t,i){if(t>=i-1)return;let n=t;for(;n<i;){const t=d(e,n);switch(t){case"Undetermined":case"Ignore":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(n>=i-1)return;let o=n+1,s=d(e,o);for(;"Ignore"===s;){if(o+=1,o>=i)return;s=d(e,o)}if(t!==s&&l(t,s)&&("Undetermined"!==s||!this.supportsBrowserWordBreaking))return{cp:o,wordBreakType:s};break}}n+=1}}};function l(e,t){return"PuncuationWithoutBreak"===e&&"AlphaNumeric"!==t||"AlphaNumeric"===e&&"PuncuationWithoutBreak"!==t||("Punctuation"===e||"FootnoteEndnotePunctuation"===e)||"WhiteSpace"===e}function d(e,t){const i=e.charAt(t).toString();return s.Fc(i)?"AlphaNumeric":function(e){const t=e.charCodeAt(0);return t>=0&&t<=31||32===t||t>=127&&t<=159||160===t||t>=8192&&t<=8202||8239===t||8287===t||9248===t||t>=9250&&t<=9252||12288===t||65282===t}(i)?"WhiteSpace":g(i)?"Punctuation":function(e){return"'"===e||""===e||""===e}(i)?"PuncuationWithoutBreak":function(e){return""===e}(i)?"FootnoteEndnotePunctuation":function(e){return""===e||""===e}(i)?"Ignore":"Undetermined"}function c(e,t,i){if(!e)return!0;const n=t[e];if(!n.cp)return!0;const o=t[e-1];let s=!0;if("Punctuation"===o.wordBreakType){let e=!1;for(let t=o.cp;t<n.cp;t+=1){const n=i.charAt(t);if("-"===n){if(e)return!0;e=!0}else e=!1;if(s=h(n),s)return!0}}else if("Undetermined"===o.wordBreakType)return!1;return("Undetermined"!==n.wordBreakType||"WhiteSpace"===o.wordBreakType)&&s}function u(e,t,i){const n=t[e];if(h(i.charAt(n.cp)))return!1;if(!e)return!0;if(!n.cp)return!1;const o=t[e-1];return"WhiteSpace"===o.wordBreakType||"FootnoteEndnotePunctuation"===o.wordBreakType}function h(e){return""===e||""===e}function g(e){return!!r.has(e)||(e>="!"&&e<="$"||e>="("&&e<="/"||e>=":"&&e<="@"||e>="["&&e<="`"||e>="{"&&e<="~"||e>=""&&e<=""||e>=""&&e<=""||e>=""&&e<=""||e>=" "&&e<=""||e>=" "&&e<="")}a=(0,n.__decorate)([(0,o._)()],a)},71186:(e,t,i)=>{i.d(t,{M:()=>l});var n=i(23182),o=i(33767),s=i(29906),r=i(83010),a=i(89637);let l=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,i,n=!1){let o,s=0;n?({wordCount:s,wordBoundaries:o}=this.computeValidWordCountAndBoundariesForRange(i,0,i.length)):s=this.computeValidWordCountForRange(i,0,i.length);const r={isWordCountChanged:!1,wordCount:s,wordBoundaries:o};if(s>0&&0===e.firstDiffLeft&&0===e.firstDiffRight)return r.isWordCountChanged=!0,r;if(e.firstDiffLeft+e.firstDiffRight<=i.length){if(this._wordCount.getWordCountInRange(i,e.firstDiffLeft,i.length-e.firstDiffRight)>1)return r.isWordCountChanged=!0,r}if(t>s)return r.isWordCountChanged=!0,r;const a=this.computeValidWordCountForRange(i,0,i.length-e.firstDiffRight);if(0===a)return r.isWordCountChanged=!1,r;const l=this.computeValidWordCountForRange(i,0,e.firstDiffLeft);return r.isWordCountChanged=a>l,r}getWordCount(e){return this.computeValidWordCountForRange(e,0,e.length)}computeValidWordCountForRange(e,t,i){if(t>=i||t<0||i>e.length)return 0;const{wordCount:n,wordBreaks:o}=this._wordCount.getWordCountAndBreaksInRange(e,t,i);return this.correctWordCountForIncompleteWord(o,e.length,n)}computeValidWordCountAndBoundariesForRange(e,t,i){if(t>=i||t<0||i>e.length)return{wordCount:0,wordBoundaries:[]};const{wordCount:n,wordBreaks:o,wordBoundaries:s}=this._wordCount.getWordCountWithBoundariesAndBreaksInRange(e,t,i);return{wordCount:this.correctWordCountForIncompleteWord(o,e.length,n),wordBoundaries:s}}correctWordCountForIncompleteWord(e,t,i){if(i<=0||0===e.length)return 0;const n=e.length-1;return"WhiteSpace"!==e[n].wordBreakType&&(this._hostSettings.newLineSentenceSeparatorEnabled||this._hostSettings.useParagraphAsTileSeparator||"Punctuation"!==e[n].wordBreakType)&&e[n].cp+1<=t?i-1:i}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,r.W)(a.t)),(0,n.__param)(1,(0,r.W)(o.n))],l)},2115:(e,t,i)=>{i.d(t,{x:()=>s});var n=i(18501),o=i(96606);class s{static createEvaluator(e,t,i,n,o){return r=>s.isKey(r,e,t,i,n,o)}static isKey(e,t,i,o,r,a){if(void 0!==i&&e.altKey!==i||void 0!==o&&e.ctrlKey!==o||void 0!==r&&e.metaKey!==r||void 0!==a&&e.shiftKey!==a)return!1;if(Array.isArray(t))return t.some((t=>s.isKey(e,t,i,o,r,a)));if(e.key===t)return!0;if(t in n.c){const i=n.c[t];return e.which===i||e.keyCode===i}return!1}}s.isEnterKey=e=>{const t=o.m.enter;return s.isKey(e,t)},s.isEnterOrSpaceKey=e=>{const t=o.m.enter,i=o.m.space;return s.isKey(e,[t,i])},s.isEscapeKey=e=>{const t=o.m.escape;return s.isKey(e,t)},s.focusIfEscapeKey=e=>{s.isKey(e,o.m.escape)&&(e.currentTarget.focus(),e.stopPropagation())},s.isSpaceKey=e=>{const t=o.m.space;return s.isKey(e,t)}},96606:(e,t,i)=>{var n;i.d(t,{m:()=>n}),function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.delete="Delete",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(n||(n={}))},92507:(e,t,i)=>{var n;i.d(t,{k:()=>n}),function(e){e[e.ContextualCard=0]="ContextualCard"}(n||(n={}))},41385:(e,t,i)=>{if(i.d(t,{h:()=>o}),2063!=i.j)var n=i(78126);function o(){return(0,n.A)()}},62446:(e,t,i)=>{if(i.d(t,{n:()=>s}),2063!=i.j)var n=i(1270);if(2063!=i.j)var o=i(89691);function s(){const e=new n.m(o.g);return new o.K(e)}},22400:(e,t,i)=>{i.d(t,{k:()=>s,p:()=>o});var n=i(17298);const o=(0,n.f)("IContainer"),s=(0,n.f)("IResolveNew")},89691:(e,t,i)=>{i.d(t,{K:()=>o,g:()=>n});const n={defaultScope:"Singleton",skipBaseClassChecks:!0};class o{constructor(e){this.container=e}bind(e){return new s(this,this.container.bind(e))}rebind(e){return new s(this,this.container.rebind(e))}unbind(e){try{return this.container.unbind(e),!0}catch(e){return!1}}get(e){return this.container.get(e)}getOptional(e){return this.container.isBound(e)?this.container.get(e):void 0}getAll(e){return this.container.isBound(e)?this.container.getAll(e):[]}isBound(e){return this.container.isBound(e)}createChildContainer(){return new o(this.container.createChild(n))}unbindAll(){this.container.unbindAll()}resolveNew(e){return this.container.resolve(e)}getBindings(){const e=(t=this.container,t._bindingDictionary).getMap();var t;const i=[];for(const[t,n]of e)i.push({token:t,boundServices:n});return i}}class s{constructor(e,t){this.container=e,this.bindingTo=t}to(e){this.bindingTo.to(e)}toSelf(){this.bindingTo.toSelf()}toValue(e){this.bindingTo.toConstantValue(e)}toDynamicValue(e){this.bindingTo.toDynamicValue((()=>e(this.container)))}toFactory(e){this.bindingTo.toFactory((()=>e(this.container)))}toExisting(e){this.bindingTo.toService(e)}toTransient(e){this.bindingTo.to(e).inTransientScope()}}},54754:(e,t,i)=>{if(i.d(t,{o:()=>o}),2063!=i.j)var n=i(94897);class o{constructor(e,t,i){this.injectionIdentifier=e,this.isOptional=t,this.isArray=i}resolveFrom(e){if(!this.shouldSkipResolving(e))return this.isArray?this.resolveArray(e):this.resolveSingular(e)}resolveSingular(e){return this.isOptional?e.getOptional(this.injectionIdentifier):e.get(this.injectionIdentifier)}resolveArray(e){if(!this.isOptional&&!e.isBound(this.injectionIdentifier))throw new Error("No matching bindings found for serviceIdentifier: "+this.injectionIdentifier.toString());return e.getAll(this.injectionIdentifier)}isBoundTo(e){return!!e.isBound(this.injectionIdentifier)}setupBinding(e,t){if(this.isArray&&Array.isArray(t))for(const i of t)this.setupSingleBinding(e,i);else this.setupSingleBinding(e,t)}setupSingleBinding(e,t){const i=e.bind(this.injectionIdentifier);(0,n.C)(t)?i.to(t):i.toValue(t)}toString(){const e={};return e.identifier=this.injectionIdentifier instanceof Function?this.injectionIdentifier.name:this.injectionIdentifier.toString(),this.isOptional&&(e.isOptional=this.isOptional),this.isArray&&(e.isArray=this.isArray),`ConfiguredDep(${JSON.stringify(e)})`}shouldSkipResolving(e){return!!this.isOptional&&!this.isBoundTo(e)}}},41642:(e,t,i)=>{if(i.d(t,{A:()=>o}),2063!=i.j)var n=i(54754);class o{constructor(e,t){this._isOptional=!1,this._injectionIdentifier=e,this._isArray=t}static on(e){return new o(e,!1)}static onAll(e){return new o(e,!0)}optional(){return this._isOptional=!0,this}build(){return new n.o(this._injectionIdentifier,this._isOptional,this._isArray)}}},94897:(e,t,i)=>{i.d(t,{C:()=>o});const n=new(i(87218).P);function o(e){if(!(e instanceof Function))return!1;return!!n.getConstructorMetadata(e).compilerGeneratedMetadata}},745:(e,t,i)=>{if(i.d(t,{F5:()=>s,KN:()=>r,SM:()=>a}),2063!=i.j)var n=i(58452);var o=i(8520);function s(e){const t={};for(const i of Object.keys(e)){const n=e[i];t[i]=n.build()}return t}function r(e){const t=(0,n.G)();return(0,o.useMemo)((()=>{const i={};for(const n of Object.keys(e))i[n]=e[n].resolveFrom(t);return i}),[t,e])}function a(e){const t=(0,n.N)();return(0,o.useMemo)((()=>{const i={};for(const n of Object.keys(e))i[n]=t&&e[n].resolveFrom(t);return i}),[t,e])}},95373:(e,t,i)=>{if(i.d(t,{r:()=>s}),2063!=i.j)var n=i(745);var o=i(8520);function s(e,t){var i;const s=i=>{const s=(0,n.KN)(t);return i.deps?o.createElement(e,Object.assign({},i)):o.createElement(e,Object.assign({},i,{deps:s}))},r=null!==(i=e.displayName)&&void 0!==i?i:e.name;return s.displayName=`${r}DepsResolver`,s}},43789:(e,t,i)=>{i.d(t,{E:()=>s,r:()=>r});var n=i(12048),o=i(8520);class s extends n.z{constructor(e,t){super(e,t)}onAddModule(e){var t;"configureScopedServices"in e?null===(t=e.configureScopedServices)||void 0===t||t.call(e,this.container):"scopedProviders"in e&&e.scopedProviders&&this.bindProvidersToContainer(this.container,e.scopedProviders)}}const r=(0,o.createContext)(void 0)},12048:(e,t,i)=>{if(i.d(t,{z:()=>s}),2063!=i.j)var n=i(62446);if(2063!=i.j)var o=i(94897);class s{constructor(e,t){this.addedModuleKeys=new Set,this._addedModuleClassNames=new Set,this._modulesSharingSameModuleKeyButDifferentClassname=new Set,this.container=e,this.generateModuleKey=t}static createContainer(e){return e?e.createChildContainer():(0,n.n)()}clear(){this.container.unbindAll(),this.addedModuleKeys.clear(),this._addedModuleClassNames.clear(),this._modulesSharingSameModuleKeyButDifferentClassname.clear()}get addedModuleClassNames(){return this._addedModuleClassNames}get modulesSharingSameModuleKeyButDifferentClassname(){return this._modulesSharingSameModuleKeyButDifferentClassname}addModule(e){var t;const i="function"!=typeof e?e.constructor.name:e.name,n=this.getModuleKey(e);if(this.addedModuleKeys.has(n))return void(this._addedModuleClassNames.has(i)||this._modulesSharingSameModuleKeyButDifferentClassname.add(i));this._addedModuleClassNames.add(i),this.addedModuleKeys.add(n);const o=this.getModuleInstance(e);this.addModules(null!==(t=o.imports)&&void 0!==t?t:[]),this.onAddModule(o)}addModules(e){for(const t of e)t&&(Array.isArray(t)?this.addModules(t):this.addModule(t))}bindProvidersToContainer(e,t){for(const i of t)if(i)if((0,o.C)(i))e.isBound(i)||e.bind(i).toSelf();else{const t=i.provide;if(!i.multiple&&e.isBound(t))throw new Error(`Duplicate provider type: ${String(t)}`);if("useClass"in i)e.bind(t).to(i.useClass);else if("useDynamicValue"in i)e.bind(t).toDynamicValue(i.useDynamicValue);else if("useExisting"in i)e.bind(t).toExisting(i.useExisting);else{if(!("useValue"in i))throw new Error("Unknown provider type");e.bind(t).toValue(i.useValue)}}}getModuleKey(e){var t,i;const n=this.getModuleInstance(e);return n.uniqueId?n.uniqueId:e instanceof Function&&null!==(i=null===(t=this.generateModuleKey)||void 0===t?void 0:t.call(this,e))&&void 0!==i?i:e}getModuleInstance(e){return e instanceof Function?new e:e}}},53356:(e,t,i)=>{i.d(t,{J:()=>s,S:()=>r});var n=i(12048),o=i(8520);class s extends n.z{constructor(e){super(n.z.createContainer(),e)}onAddModule(e){"configureRootServices"in e?e.configureRootServices(this.container):e.providers&&this.bindProvidersToContainer(this.container,e.providers)}}const r=(0,o.createContext)(void 0)},2507:(e,t,i)=>{i.d(t,{U:()=>u});var n=i(43789),o=i(12048),s=i(53356),r=i(58452),a=i(8520);const l=e=>{const t=(0,r.G)();return a.createElement(d,Object.assign({},e,{parentContainer:t}))};class d extends a.Component{constructor(e){super(e),this.state={injector:void 0}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){const e=o.z.createContainer(this.props.parentContainer),t=new n.E(e,this.rootInjector.generateModuleKey);this.props.onConfigureInjector(t),this.setState({injector:t})}render(){const{injector:e}=this.state;return e?a.createElement(n.r.Provider,{value:e},this.props.children):null}}d.contextType=s.S;class c extends a.Component{constructor(e){super(e),this.onConfigureInjector=e=>{e.addModule(this.props.value)},this.state={rootInjectorConfigured:!1}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){this.onConfigureInjector(this.rootInjector),this.setState({rootInjectorConfigured:!0})}render(){return this.state.rootInjectorConfigured?a.createElement(l,{onConfigureInjector:this.onConfigureInjector},this.props.children):null}}c.contextType=s.S;class u extends a.PureComponent{constructor(e){var t;super(e),this.injector=null!==(t=e.injector)&&void 0!==t?t:new s.J,this.entryModule=e.entryModule}render(){return this.entryModule?a.createElement(s.S.Provider,{value:this.injector},a.createElement(c,{value:this.entryModule},this.props.children)):a.createElement(s.S.Provider,{value:this.injector},this.props.children)}}},58452:(e,t,i)=>{if(i.d(t,{G:()=>r,N:()=>a}),2063!=i.j)var n=i(43789);if(2063!=i.j)var o=i(53356);var s=i(8520);function r(){const e=a();if(!e)throw new Error("No Injector context available");return e}function a(){const e=(0,s.useContext)(n.r),t=(0,s.useContext)(o.S),i=null!=e?e:t;return null==i?void 0:i.container}},17298:(e,t,i)=>{function n(e){return Symbol.for(e)}i.d(t,{f:()=>n})},11249:(e,t,i)=>{if(i.d(t,{N:()=>v}),2063!=i.j)var n=i(40769);if(2063!=i.j)var o=i(69318);if(2063!=i.j)var s=i(13115);if(2063!=i.j)var r=i(3910);if(2063!=i.j)var a=i(54949);if(2063!=i.j)var l=i(86504);if(2063!=i.j)var d=i(9840);if(2063!=i.j)var c=i(19137);if(2063!=i.j)var u=i(25801);if(2063!=i.j)var h=i(15274);if(2063!=i.j)var g=i(94079);const p={requiredFlights:["mc-editor-oa","mc-editor-oa-client-ecc"],isFeatureEnabled:(e,t)=>!0===(null==t?void 0:t.some((t=>t===e)))},m={};class f{constructor(e,t,i,n){this.refreshCadence=e,this.augloopSession=t,this.timer=i,this._logger=n}start(){this.timer.setIntervalWithDelay("refreshGraphSearchData",(()=>this.tryRefresh()),this.refreshCadence,this.refreshCadence)}stop(){this.timer.clearTimer("refreshGraphSearchData")}async tryRefresh(){if(this.augloopSession.isClosed)return;const e={parentPath:["session","doc"],items:[{id:"0",body:new o.$9({forceRefresh:!1})}]};this.augloopSession.submitOperation(new n.Xr(e))}onRefreshDone(){this._logger.info(507349215,"Graph search data refresh done")}}class v{constructor(e,t,i){var n,o,s,r,a,l,d,c,u,h;this.timer=i,this.defaultRefreshInterval=3e5,this.annotationListenerType="",this.config=e,this._logger=t,this.requiredSetting(null===(n=this.config.oaSettings)||void 0===n?void 0:n.enableOaClient,"oaSettings.enableOaClient"),this.requiredSetting(null===(s=null===(o=this.config.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===s?void 0:s.enabled,"serviceSettings.hybridAugloop.enabled"),this.requiredSetting(null===(a=null===(r=this.config.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.enableGraphSearchLocal,"serviceSettings.hybridAugloop.enableGraphSearchLocal"),this.requiredSetting(null===(l=this.config.orchestratorSettings)||void 0===l?void 0:l.enableAugLoop,"orchestratorSettings.enableAugLoop"),this.requiredSetting(!!(null===(d=this.config.orchestratorSettings)||void 0===d?void 0:d.substrateAuthTokenCallback),"orchestratorSettings.substrateAuthTokenCallback"),this.checkRequiredFlights(this.config.flightsToTrack),this.cacheGetter=(null===(h=null===(u=null===(c=this.config.serviceSettings)||void 0===c?void 0:c.hybridAugloop)||void 0===u?void 0:u.wasmConfig)||void 0===h?void 0:h.disableModuleCache)?()=>m:void 0,this.config.orchestratorSettings?(this.config.orchestratorSettings.preRuntimeInit=this.config.orchestratorSettings.preRuntimeInit||[],this.config.orchestratorSettings.preRuntimeInit.push(((e,t)=>this.preRuntimeInit(e,t)))):this._logger.error(507349214,"OrchestratorSettings missing. Required for Hybrid ECC"),this.eccEnabled=(e=>{var t;return!!(null===(t=e.oaSettings)||void 0===t?void 0:t.enableOaClient)})(e),this.eccEnabled||this._logger.warn(507349213,"Hybrid ECC workflows are not enabled.  Consider excluding Hybrid plugin support to reduce overall package size.")}get wasmScriptPath(){var e,t,i;return(0,u.Gm)(null===(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.wasmConfig)||void 0===i?void 0:i.scriptPath)}preRuntimeInit(e,t){return t.inferenceServiceFactory=l._.createFactory(this.wasmScriptPath,(0,u.$A)(this.config),this.cacheGetter),t.modelDownloader=new a.$(e.appName,"fs.microsoft.com/fs/augmentationLoop","res.cdn.office.net/polymer/models"),Promise.resolve()}requiredSetting(e,t){e||this._logger.error(507349212,`Required setting ${t} for hybrid wasn't set.`,t)}checkRequiredFlights(e){const t=p.requiredFlights.filter((t=>!p.isFeatureEnabled(t,e)));0!==t.length&&this._logger.error(507349211,`Hybrid requires these flights be enabled: ${t}`,t)}async activateAnnotations(e){if(!e||!this.eccEnabled)return;e.registerLocalWorkflow(h.A);const t=this.wasmScriptPath||"",i=(0,u.uz)(this.config),n={wasmRoot:t,locateFile:e=>(0,u.$A)(this.config,e),cacheModule:!0,wasmModuleCache:this.cacheGetter};e.registerLocalWorkflow((0,d.X8)(i,n)),e.registerLocalWorkflow((0,c.L4)(i,n)),e.activateAnnotation(s.NG.getTypeName()),e.registerLocalWorkflow(g.TE),e.activateAnnotation(r.os.getTypeName()),this.isUpdateSchedulerEnabled()?this.setupGraphSearchDataRefreshScheduler(e):e.activateAnnotation(o.$9.getTypeName())}isUpdateSchedulerEnabled(){var e,t,i;return null!==(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.enablePeriodicUpdates)&&void 0!==i&&i}getUpdateInterval(){var e,t,i;return null!==(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.periodicUpdateInterval)&&void 0!==i?i:this.defaultRefreshInterval}setupGraphSearchDataRefreshScheduler(e){this.graphSearchDataRefreshScheduler&&this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=new f(this.getUpdateInterval(),e,this.timer,this._logger),this.graphSearchDataRefreshScheduler.start(),e.activateAnnotation(o.$9.getTypeName(),{callback:this.graphSearchDataRefreshScheduler.onRefreshDone.bind(this.graphSearchDataRefreshScheduler)})}async deactivateAnnotations(e){return!(!e||!this.eccEnabled)&&(this.graphSearchDataRefreshScheduler&&(this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=void 0),e.releaseAnnotation(s.NG.getTypeName()),e.releaseAnnotation(r.os.getTypeName()),e.releaseAnnotation(o.$9.getTypeName()),!0)}async updateAnnotationActivationConfig(){}}},71268:(e,t,i)=>{i.d(t,{g:()=>c});var n=i(23182),o=i(11249),s=i(33767),r=i(37053),a=i(98839),l=i(29906),d=i(83010);let c=class{constructor(e,t,i){this.isEnabled=!0,this.graphSearchLocalAnnotationListener=new o.N(e,t,i)}onInitialize(){}register(e,t){}unregister(){}createAnnotationListener(){return this.graphSearchLocalAnnotationListener}onSessionReconnected(){}onDocumentCreated(){}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(s.n)),(0,n.__param)(1,(0,d.W)(r.g)),(0,n.__param)(2,(0,d.W)(a.J))],c)},11240:(e,t,i)=>{if(i.d(t,{p:()=>c}),2063!=i.j)var n=i(74458);if(2063!=i.j)var o=i(41109);if(2063!=i.j)var s=i(60091);if(2063!=i.j)var r=i(71268);if(2063!=i.j)var a=i(84194);if(2063!=i.j)var l=i(15275);if(2063!=i.j)var d=i(92940);class c{constructor(){this.imports=[n.J,a.k]}get uniqueId(){return(0,l.z)(507918226)}configureRootServices(e){e.bind(o.T).to(r.g),e.bind(s.cl).toDynamicValue((e=>(e,t)=>{var i;const n=(0,d.g)(e,null===(i=t.hostSettings.orchestratorSettings)||void 0===i?void 0:i.substrateAuthTokenCallback);return Object.assign(Object.assign({},e),{isFeatureEnabled:n.isFeatureEnabled,requestAuthToken:n.requestAuthToken})}))}}},92940:(e,t,i)=>{if(i.d(t,{g:()=>s}),2063!=i.j)var n=i(79732);function o(e,t){return async i=>i.TokenType===n.OY.Substrate&&t?{Token:await t(i)}:e(i)}function s(e,t){return{isFeatureEnabled:(i=e.isFeatureEnabled,async(e,t)=>{switch(e){case"Microsoft.Office.AugLoop.AnnotationsOrderingEnabled":case"Microsoft.Office.AugLoop.EarlyJoinCompletionEnabled":return!1;case"Microsoft.Office.AugLoop.DeltaOperationsEnabled":return!0}return i(e,t)}),requestAuthToken:o(e.requestAuthToken,t)};var i}},25801:(e,t,i)=>{i.d(t,{$A:()=>r,Gm:()=>s,uz:()=>a});var n=i(54572);if(2063!=i.j)var o=i(50249);const s=e=>{if(e){try{return new URL(e),"/"===e[e.length-1]?e.substring(0,e.length-1):e}catch(e){}const t=e.split("/").filter((e=>0!==e.length));if(0!==t.length)return["/",t.join("/")].join("")}return e},r=(e,t)=>{var i,n,o,r,a,l;return((e,t)=>["/"===e?"":s(e),t].join("/"))((null===(o=null===(n=null===(i=e.serviceSettings)||void 0===i?void 0:i.hybridAugloop)||void 0===n?void 0:n.wasmConfig)||void 0===o?void 0:o.binaryPath)||(null===(l=null===(a=null===(r=e.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.wasmConfig)||void 0===l?void 0:l.scriptPath),t)},a=e=>{var t,i,s,r,a;const d=(0,o.e)(e);return{emailId:e.userId.email,puid:e.userId.puid,scenarios:[n.Nz.BIZ_CHAT,"PowerPoint"===(null===(t=e.hostMetadata)||void 0===t?void 0:t.appName)?n.Nz.COPILOT_POWERPOINT:n.Nz.WORKPLACE_SEARCH],tenantId:e.userId.tenantId,substrateAuthTokenType:l[e.userId.identityProvider],entityTypes:[],clientConfig:{getConfig:()=>d},prefetchOnly:!1,market:e.defaultLocale,useLocalFileRanker:null===(s=null===(i=e.serviceSettings)||void 0===i?void 0:i.hybridAugloop)||void 0===s?void 0:s.useLocalFileRanker,includeLoopFiles:null===(a=null===(r=e.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.includeLoopFiles}},l=[n.Xe.SUBSTRATE_MSA,n.Xe.SUBSTRATE_AAD]},84738:(e,t,i)=>{if(i.r(t),i.d(t,{GraphSearchLocalAnnotationListener:()=>n.N,HybridModule:()=>o.p,graphSearchLocalOverrideHostCallbacks:()=>r.g,hostConfigToGraphConfig:()=>s.uz}),2063!=i.j)var n=i(11249);if(2063!=i.j)var o=i(11240);if(2063!=i.j)var s=i(25801);if(2063!=i.j)var r=i(92940)},37814:(e,t,i)=>{let n,o;async function s(){try{const e=await Promise.resolve().then(i.bind(i,19728));n=e.makeObservable,o=e.makeAutoObservable}catch(e){}}function r(e,t,i){return n?n(e,t,i):e}i.d(t,{Gn:()=>r,iJ:()=>s})},91764:(e,t,i)=>{i.d(t,{it:()=>r,lm:()=>a,m:()=>s,yV:()=>o});var n=i(19728);(0,n.action)(((e,t)=>{e.isThinking=t}));const o=(0,n.action)(((e,t,i)=>{e.numSuggestions=t,e.hasFilteredCritiques||(e.hasFilteredCritiques=i&&t>=2)})),s=(0,n.action)(((e,t)=>{e.onCritiqueAdded=t})),r=((0,n.action)(((e,t)=>{e.addClientLog=t})),(0,n.action)(((e,t)=>{e.upsell=t}))),a=(0,n.action)(((e,t)=>{e.onOpenEditorPane=t}));(0,n.action)(((e,t)=>{e.currentTone=t}))},24850:(e,t,i)=>{if(i.d(t,{$x:()=>d,BZ:()=>l,sw:()=>a}),2063!=i.j)var n=i(18261);var o=i(60963),s=i(91764);let r=!1;const a=(0,o.debounce)((e=>{!function(e){(0,s.yV)(e,e.paneCritiques.size,r)}(e)}),5e3);function l(e,t,i){e&&t&&i&&(e.paneCritiques.delete(t),e.refinementsStore&&(0,n.vr)(e.refinementsStore,i),e.paneCritiques.size||(r=!1))}function d(e){e&&(e.paneCritiques.clear(),e.refinementsStore&&(0,n.YS)(e.refinementsStore),r=!1)}},44404:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(17298).f)("IndicatorStore")},38999:(e,t,i)=>{if(i.d(t,{t:()=>c}),2063!=i.j)var n=i(4879);if(2063!=i.j)var o=i(42768);if(2063!=i.j)var s=i(36915);if(2063!=i.j)var r=i(35854);if(2063!=i.j)var a=i(38533);if(2063!=i.j)var l=i(21592);if(2063!=i.j)var d=i(59793);class c{constructor(e,t){this._displayLanguage=e,this._stringProvider=t,this._defaultUiLocale="en-us",this._categoryNameToLocalizedName=new Map,this._localizationTableFallbackMapping=(0,d.mO)(),this._localizedNameToCategoryName=new Map,this._nonEditorCategories=new Set([r.s.Acronyms,r.s.Perspectives,r.s.TonalRewrite]),this.uiLocale="",this.isCategorySupportedInCurrentUiLanguage=e=>!!this._categoriesForUILocale&&(e in this._categoriesForUILocale&&this._categoriesForUILocale[e].IsImplemented),this.setUiLocale(this._displayLanguage)}async setUiLocale(e){const t=e;this.uiLocale=t?t.toLowerCase():this._defaultUiLocale;const i=this._localizationTableFallbackMapping.get(this.uiLocale);if(i&&(this.uiLocale=i),this._categoriesForUILocale=await(0,a.oZ)(this.uiLocale),!this._categoriesForUILocale)throw Error(`Failed to load categories strings from localization file dynamically: ${this.uiLocale}`);this.cacheLocalizedCategories(this.uiLocale.toLowerCase(),this._categoriesForUILocale)}cacheLocalizedCategories(e,t){for(const i of Object.keys(t))this.cacheCategoryNames(i,t[i].LocalizedName,e)}get NonEditorCategories(){return this._nonEditorCategories}categoryNameToLocale(e,t){var i;const r=t.toLowerCase(),a=null===(i=this._categoryNameToLocalizedName.get(e))||void 0===i?void 0:i.get(r);if(a)return a;if(this._nonEditorCategories.has(e)){const t=this.localizeNonEditorCategoryNameToUiLocale(e);return this.cacheCategoryNames(e,t,r),t}return(0,n.C)().logEvent(571281556,"CategoryLocalizationNotFoundInLocalizationTable",o.h.Host,s.q.Error,{category:e,language:r}),e}toUiLocale(e){return this.categoryNameToLocale(e,this.uiLocale)}async localizedNameToStandardizedName(e,t){if(t===r.s.Spelling||t===r.s.Grammar||this.NonEditorCategories.has(t))return t;const i=this._localizedNameToCategoryName.get(t);if(i)return i;const n=await(0,a.oZ)(null!=e?e:this.uiLocale);if(n){const i=Object.keys(n).find((e=>{const i=n[e];return i&&i.LocalizedName===t}));if(i)return this.cacheCategoryNames(i,t,null!=e?e:this.uiLocale),i}const o=this.mapNonEditorCategoryNameToStandardizedName(t);return o?(this.cacheCategoryNames(o,t,this.uiLocale),o):t}cacheCategoryNames(e,t,i){const n=this._categoryNameToLocalizedName.get(e),o=null==n?void 0:n.get(i),s=this._localizedNameToCategoryName.get(t);if(!o)if(n)n.set(i,t);else{const n=new Map;n.set(i,t),this._categoryNameToLocalizedName.set(e,n)}s||this._localizedNameToCategoryName.set(t,e)}localizeNonEditorCategoryNameToUiLocale(e){var t;const i=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,n=i.getString.bind(i);switch(e){case r.s.Acronyms:return n("CritiqueCategoryStrings","Acronyms");case r.s.Perspectives:return n("CritiqueCategoryStrings","Perspectives");case r.s.TonalRewrite:return n("CritiqueCategoryStrings","TonalRewrite");default:return e}}mapNonEditorCategoryNameToStandardizedName(e){var t;const i=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,n=i.getString.bind(i);switch(e){case n("CritiqueCategoryStrings","Acronyms"):return r.s.Acronyms;case n("CritiqueCategoryStrings","Perspectives"):return r.s.Perspectives;case n("CritiqueCategoryStrings","TonalRewrite"):return r.s.TonalRewrite;default:return e}}}},41505:(e,t,i)=>{i.d(t,{C:()=>s,N:()=>o});var n=i(17298);const o=(0,n.f)("ICategoryLocalization"),s=(0,n.f)("ICategoryLocalizationSlim")},59793:(e,t,i)=>{var n;i.d(t,{mO:()=>o}),function(e){e.CATALAN="ca",e.CATALANCATALAN="ca-es",e.CHINESE="zh",e.CHINESESIMPLIFIED="zh-hans",e.CHINESETRADITIONAL="zh-hant",e.ENGLISH="en",e.ENGLISH_AUSTRALIA="en-au",e.ENGLISH_CANADA="en-ca",e.ENGLISH_INDIA="en-in",e.ENGLISH_UNITEDKINGDOM="en-gb",e.ENGLISH_UNITEDSTATES="en-us",e.FRENCH="fr",e.FRENCH_CANADA="fr-ca",e.FRENCH_FRANCE="fr-fr",e.GERMAN="de",e.ITALIAN="it",e.JAPANESE="ja",e.PORTUGUESE="pt",e.SPANISH="es",e.SPANISH_MEXICO="es-mx",e.SPANISH_SPAIN="es-es",e.VALENCIAN="ca-es-valencia",e.RUSSIAN="ru",e.BRAZILIAN="br"}(n||(n={}));const o=()=>new Map([[n.ENGLISH_AUSTRALIA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_CANADA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_INDIA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_UNITEDKINGDOM,n.ENGLISH_UNITEDSTATES],[n.FRENCH_CANADA,n.FRENCH_FRANCE],[n.SPANISH_MEXICO,n.SPANISH_SPAIN]]);var s;!function(e){e.Goals="Goals"}(s||(s={}))},35854:(e,t,i)=>{var n;i.d(t,{s:()=>n}),function(e){e.Acronyms="Acronyms",e.Clarity="Clarity",e.Conciseness="Conciseness",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Vocabulary="Vocabulary",e.TonalRewrite="Tone",e.Synonyms="Synonyms",e.DistinctWords="DistinctWords",e.Readability="Readability",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Similarity="SimilarityCategoryLevel",e.Goals="GoalsCard"}(n||(n={}))},38533:(e,t,i)=>{if(i.d(t,{oZ:()=>l}),2063!=i.j)var n=i(4879);if(2063!=i.j)var o=i(42768);if(2063!=i.j)var s=i(36915);if(2063!=i.j)var r=i(91450);const a=new Map([["es-419","es-MX"]]);async function l(e,t=!1){var d;const c=null!==(d=a.get(e))&&void 0!==d?d:e,u=(0,n.C)();try{return await i(85003)(`./${c.toLowerCase()}.json`)}catch(i){try{if(!t){const t=e.split("-")[0];if(t in r.Y){const e=r.Y[t];return l(Array.isArray(e)?e[0]:e,!0)}}u.logEvent(0,"Diagnostics",o.h.Undefined,s.q.Error,`Failed to load categories strings for locale ${e} from localization file dynamically: ${i}`,void 0,void 0,void 0,"Text_Message")}catch(t){u.logEvent(0,"Diagnostics",o.h.Undefined,s.q.Error,`Failed to load neutral categories strings for locale ${e} from localization file dynamically: ${i}`,void 0,void 0,void 0,"Text_Message")}return}}},91099:(e,t,i)=>{i.d(t,{r:()=>z,h:()=>O});var n=i(8520),o=i(745),s=i(41642),r=i(95373),a=i(7433),l=i(20394),d=i(55649),c=i(22628),u=i(75499),h=i(96969),g=i(19685),p=i(33767),m=i(98647),f=i(24033),v=i(71632),_=i(47588),y=i(4405),I=i(96606);const C="(-ms-high-contrast: active), (forced-colors: active)",S="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",b="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)";class T{get isHighContrastActive(){return window.matchMedia(C).matches}get isHighContrastBlack(){return window.matchMedia(S).matches}get isHighContrastWhite(){return window.matchMedia(b).matches}}new T;var E=i(56489),N=i(48689),x=i(23076),w=i(61964),L=i(2174),D=i(37641),F=i(36147);let A;var R=i(55695),q=i(51244);const P="editor-critique-card-id",O=(0,o.F5)({store:s.A.on(a.v),footerFREStore:s.A.on(l.D).optional(),themeStore:s.A.on(E.YQ).optional(),localizer:s.A.on(g.H),calloutDismissalHandler:s.A.on(d.J).optional(),styleStore:s.A.on(E.UC).optional(),hostSettings:s.A.on(p.n)});class k extends n.Component{constructor(e){super(e),this.hasPositioned=!1,this.critiqueCalloutRef=n.createRef(),this.handleKeyDown=e=>{var t;e.key===I.m.arrowDown&&(e.stopPropagation(),e.preventDefault(),null===(t=this.critiqueCalloutRef.current)||void 0===t||t.focus())},this.renderCallout=()=>n.createElement("div",null,n.createElement(w.N,Object.assign({},null!=A?A:A={settings:{theme:(0,D.I)((0,F.a)())},scopedSettings:{}}),this.renderSharedCallout())),this.emitClick=e=>{const t=new MouseEvent("click",{clientX:e.clientX,clientY:e.clientY});window.document.documentElement.dispatchEvent(t)},this.onAfterRender=()=>{var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),null===(t=this.documentEventListener)||void 0===t||t.addListener("contextmenu",this.emitClick,{capture:!0}),this.parentElement||(this.parentElement=this.store.getParentElement()),this.parentElement&&!this.parentElementEventListener&&(this.parentElementEventListener=new m.J(this.parentElement),this.parentElementEventListener.addListener("keydown",this.handleKeyDown)),this.store.afterRender()},this.dismiss=()=>{var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.store.clickNoActionHide()},this.renderTonalFreCard=()=>{const{themeStore:e,localizer:t}=this.props.deps,{onTonalFreAction:i}=this.store,o=null==e?void 0:e.getComponentActiveTheme(E.yF.tonalFreComponentName);if(o){let t;const i=null==e?void 0:e.getComponentThemes(E.yF.tonalFreComponentName),n=new T;i&&(n.isHighContrastWhite?t=i.get(E.SV.light):n.isHighContrastBlack&&(t=i.get(E.SV.dark)),t&&(o.iconPrimaryColor=t.highContrast.iconPrimaryColor,o.iconSecondaryColor=t.highContrast.iconSecondaryColor))}return n.createElement(L.Q,{automationId:"tonal_fre_card",onClickAction:i,strings:{cardTitle:t.getMessage("ebx_tonalFreTitle"),textDescription:t.getMessage("ebx_tonalFreDescription"),acceptButtonText:t.getMessage("ebx_tonalFreAcceptButton"),ignoreButtonText:t.getMessage("ebx_tonalFreIgnoreButton"),rejectLinkText:t.getMessage("ebx_tonalFreRejectButton"),rejectionMessage:t.getMessage("ebx_tonalFreRejectMessage"),editorSettingsText:t.getMessage("ebx_tonalFreOpenEditorSettings"),dissmissButtonAccessibilityLabel:t.getMessage("ebx_tonalFreDismissButtonAccessibilityLabel")},theme:o})},this.renderSharedCard=()=>{var e,t;const{deps:i}=this.props,{footerFREStore:o,themeStore:s,styleStore:r,hostSettings:a}=i,{addOnFooterData:d,critiqueSource:h,critiqueType:g,calloutCategory:p,calloutTitle:m,suggestionsToRender:f,showSynonyms:v,dropDownActions:_,navInfo:I,brandingMode:C,explanation:S,explanationTitle:b,onCalloutAction:T,settings:N,isUpsell:w}=this.store,L=null==s?void 0:s.getComponentActiveTheme(E.iN.critiqueCalloutComponentName),D=null==r?void 0:r.getComponentStyle(E.iN.critiqueCalloutComponentName),F=null==r?void 0:r.getComponentStyle(E.iN.footerFreComponentName),A=null===(t=null===(e=a.serviceSettings)||void 0===e?void 0:e.multilingual)||void 0===t?void 0:t.hideFooterFreIcon;L&&w&&(L.addOnFooterBackground=L.upsellFooterColor);const R=null==o?void 0:o.footerProps.get(l.Y.critique);return n.createElement(c.d.Consumer,null,(e=>{var t,i,o,s;return n.createElement(n.Fragment,null,n.createElement(x.n,{ref:this.critiqueCalloutRef,addOnFooterData:(null==R?void 0:R.display)?void 0:d,automationId:"browser_extension",critiqueSource:h,definition:{definitionType:"CritiqueDefinition",critiqueType:g,header:p,subheader:m,contextText:void 0,contextDecorations:void 0,suggestions:f,maximumSuggestions:f.length,showContext:!1,showDescription:v,actions:_,critiqueSetSize:I?(0,u.v)(I).length:void 0,critiquePosition:null==I?void 0:I.currentIndex,brandingMode:C,explanation:S,explanationTitle:b},onAction:T,onAfterUpdate:this.onAfterRender,settings:N,strings:this.getLocalizedSharedStrings(),style:Object.assign(Object.assign({},D),{minWidth:null!==(t=null==D?void 0:D.minWidth)&&void 0!==t?t:300,maxWidth:null!==(i=null==D?void 0:D.maxWidth)&&void 0!==i?i:420,hasBottomAttachment:(null==R?void 0:R.display)&&!R.pages.size}),theme:L,layerHostId:e}),n.createElement(y.b,{target:l.Y.critique,styles:{container:Object.assign({borderRadius:{topStart:0,topEnd:0,bottomStart:2,bottomEnd:2},minWidth:null!==(o=null==D?void 0:D.minWidth)&&void 0!==o?o:300,maxWidth:null!==(s=null==D?void 0:D.maxWidth)&&void 0!==s?s:420},null==F?void 0:F.container),dismissContainerStyle:null==F?void 0:F.dismissContainerStyle,textContainerStyle:null==F?void 0:F.textContainerStyle},hideIcon:A}))}))},this.renderSharedCallout=()=>{var e,t,i;const{localizer:o,themeStore:s}=this.props.deps,{target:r,setInitialFocus:a,shouldShowTonalFre:l,gapSpace:d,styles:u}=this.store,g=null==s?void 0:s.getComponentActiveTheme(E.yF.critiqueCalloutComponentName);if(!0!==this.context){const i=(0,R.Zq)(null===(e=u.calloutMain)||void 0===e?void 0:e.root,{marginLeft:this.state.marginLeft,marginRight:this.state.marginRight,border:(null===(t=null==g?void 0:g.callout)||void 0===t?void 0:t.borderColor)?`1px solid ${g.callout.borderColor}`:void 0});return n.createElement(c.U,{id:P,className:"ms-critique-callout","aria-label":o.getMessage("ebx_brandText"),ariaLabelledBy:"replacement-list",calloutMaxWidth:450,doNotLayer:!1,gapSpace:d,isBeakVisible:!1,onDismiss:this.dismiss,onPositioned:e=>{e&&!this.hasPositioned&&(this.hasPositioned=!0,e.alignmentEdge===N.x.left?e.elementPosition.left?this.setState({marginLeft:-15,marginRight:0}):this.setState({marginLeft:0,marginRight:15}):e.alignmentEdge===N.x.right?e.elementPosition.left?this.setState({marginLeft:15,marginRight:0}):this.setState({marginLeft:0,marginRight:-15}):this.setState({marginLeft:0,marginRight:0}))},role:"dialog",target:(0,f.KV)(r),preventDismissOnLostFocus:!1,preventDismissOnEvent:this.onPreventDismissCalloutOnEvent,styles:Object.assign(Object.assign({},u.calloutMain),{root:i})},n.createElement(_.Y,{disableFirstFocus:!a,isClickableOutsideFocusTrap:!0},l?this.renderTonalFreCard():this.renderSharedCard()))}{const e={popover:{trapFocus:a,withArrow:!1,open:this.state.calloutOpen,onOpenChange:(e,t)=>{!t.open&&this.onPreventDismissCalloutOnEvent(e)||(this.setState((e=>Object.assign(Object.assign({},e),{callOpen:t.open}))),t.open||this.dismiss())},positioning:{target:(0,f.ug)(r),align:"start",position:"below",offset:e=>({mainAxis:d,crossAxis:"start"===e.alignment?-15:0})},ariaLabel:o.getMessage("ebx_brandText"),ariaLabelledBy:"replacement-list"},surface:{className:"ms-critique-callout",style:Object.assign({padding:0,maxWidth:450,border:(null===(i=null==g?void 0:g.callout)||void 0===i?void 0:i.borderColor)?`1px solid ${g.callout.borderColor}`:void 0},u.calloutV9)}};return n.createElement(h.v,Object.assign({},e),l?this.renderTonalFreCard():this.renderSharedCard())}},this.onPreventDismissCalloutOnEvent=e=>{const{deps:t}=this.props,{calloutDismissalHandler:i}=t;if(i&&!i.shouldDismissCallout(e,"CritiqueCallout",void 0))return!0;if("click"===e.type){const t=this.store.target;if((0,v.C)(t,"HTMLElement")){const i=t.getBoundingClientRect();if(n=i,o=e.pageX,s=e.pageY,n.x<=o&&o<=n.x+n.width&&n.y<=s&&s<=n.y+n.height)return!0}}var n,o,s;return!1},this.store=e.deps.store,this.state={marginLeft:-15,marginRight:-15,calloutOpen:!0},this.documentEventListener=new m.J(this.store.targetDocumentRef)}componentDidUpdate(e,t,i){var n,o,s,r,a,l;this.parentElement||(this.parentElement=this.store.getParentElement()),this.store.isVisible?(null===(n=this.parentElement)||void 0===n||n.setAttribute("aria-activedescendant",P),null===(o=this.parentElement)||void 0===o||o.setAttribute("aria-controls",P),null===(s=this.parentElement)||void 0===s||s.setAttribute("aria-owns",P)):(null===(r=this.parentElement)||void 0===r||r.removeAttribute("aria-activedescendant"),null===(a=this.parentElement)||void 0===a||a.removeAttribute("aria-controls"),null===(l=this.parentElement)||void 0===l||l.removeAttribute("aria-owns"))}componentWillUnmount(){var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.documentEventListener=void 0,this.parentElement=void 0,null===(t=this.parentElementEventListener)||void 0===t||t.removeAllListeners(),this.parentElementEventListener=void 0}render(){const{styles:e,target:t}=this.store;let i=this.store.isVisible;return(!t||"x"in t&&"y"in t&&0===t.x&&0===t.y||(0,v.C)(t,"HTMLElement")&&!t.isConnected)&&(i=!1),n.createElement("div",{style:e.shadowHost},i?this.renderCallout():null)}getCommonStringsMap(){return{suggestionsGroupNoSuggestionsText:this.store.noSuggestionLabel}}getTextFormattingStringsMap(){const{localizer:e}=this.props.deps,{text:t,textInContext:i}=this.store;return{contextAccessibilityLabelForSpelling:e.getMessage("contextAccessibilityLabelForSpelling",[t,i]),contextAccessibilityLabelForRepeatedWord:e.getMessage("contextAccessibilityLabelForRepeatedWord",[t,i]),contextAccessibilityLabelForGrammar:e.getMessage("contextAccessibilityLabelForGrammar",[t,i]),contextAccessibilityLabelForRefinement:e.getMessage("contextAccessibilityLabelForRefinement",[t,i]),contextAccessibilityLabelForCorrection:e.getMessage("contextAccessibilityLabelForCorrection",[t,i])}}getCritiqueExplanationStringsMap(){const{localizer:e}=this.props.deps;return{explanationTableBefore:e.getMessage("explanationTableBefore"),explanationTableAfter:e.getMessage("explanationTableAfter"),explanationTableSeparator:e.getMessage("explanationTableSeparator"),explanationTableAccessibilityLabel:e.getMessage("explanationTableAccessibilityLabel")}}getCritiqueStringsMap(){var e;const{localizer:t}=this.props.deps,{calloutCategory:i,calloutTitle:n,navInfo:o}=this.store,s=t.getMessage("ebx_asInSynonyms"),r=`{0} ${s} {1}`,a=`{0}, {1} ${s} {2}`,l=o?(0,u.v)(o).length:0,d=null!==(e=null==o?void 0:o.currentIndex)&&void 0!==e?e:0,c=l-d-1;return{previewHeaderLabel:t.getMessage("ebx_previewLabel"),spellingCardHeader:i,repeatedWordCardSubheader:n,grammarCardHeader:i,tonalRewriteCardHeader:t.getMessage("ebx_toneLabel"),deleteRepeatedWord:t.getMessage("ebx_deleteRepeatedWord"),spellingSuggestionDescriptionAccessibilityLabel:r,suggestionWithTagAccessibilityLabel:"{0}, {1}",spellingSuggestionTagAndDescriptionAccessibilityLabel:a,ignoreAll:t.getMessage("ebx_ignoreAllButtonLabel"),ignoreOnce:t.getMessage("ebx_ignoreOnceButtonLabel"),addToDictionary:t.getMessage("ebx_addToDictionaryButtonLabel"),microsoftEditorBranding:t.getMessage("ebx_brandText"),microsoftEditorBrandingAccessibilityLabel:t.getMessage("ebx_brandTextArialLabel"),editorButtonTooltipContent:t.getMessage("ebx_settingsButtonTooltip"),footerSeeMoreActionsAccessibilityLabel:t.getMessage("ebx_moreButtonArialLabel"),changeAll:t.getMessage("ebx_changeAllCommandLabel"),giveFeedbackButtonText:t.getMessage("ebx_giveFeedback"),hideSynonyms:t.getMessage("ebx_hideSynonyms"),showSynonyms:t.getMessage("ebx_showSynonyms"),ignoreRule:t.getMessage("ebx_disableCritiqueButton"),options:t.getMessage("ebx_changeSettingsCommandLabel"),manageLanguages:t.getMessage("ebx_manageLanguages"),nextIssue:t.getMessage("ebx_nextIssueWithCount",c.toString()),nextIssueWithCount:t.getMessage("ebx_nextIssueWithCount",c.toString()),previousIssue:t.getMessage("ebx_previousIssueWithCount",d.toString()),previousIssueWithCount:t.getMessage("ebx_previousIssueWithCount",d.toString()),readAloudOriginalSentenceAccessibilityLabel:t.getMessage("readAloudOriginalSentenceAccessibilityLabel"),explanationFlyoutAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),footerExplanationButtonAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),editorButtonText:t.getMessage("editorButtonText")}}getLocalizedSharedStrings(){const e=this.getCritiqueStringsMap(),t=this.getCommonStringsMap(),i=this.getCritiqueExplanationStringsMap(),n=this.getTextFormattingStringsMap();return{critique:t=>e[t]||"",common:e=>t[e]||"",critiqueExplanation:e=>i[e]||"",textFormatting:e=>n[e]||""}}}k.contextType=E.O1;const z=(0,r.r)((0,q.PA)(k),O)},78743:(e,t,i)=>{i.d(t,{b:()=>de});var n,o,s=i(23182),r=i(1021),a=i(51451),l=i(17298);!function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(n||(n={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(o||(o={}));const d=(0,l.f)("IUpsellFeature");var c=i(31628),u=i(14784),h=i(51199),g=i(8628),p=i(63318),m=i(76316),f=i(3661);const v=(e,t)=>{const i=e.length,n=t.length;let o=0,s=0;for(let r=0;r<Math.min(i,n)&&e.charAt(r)===t.charAt(r);r+=1)o+=1,(0,f.Yv)(e.charCodeAt(r))&&(s=o);return s},_=(e,t)=>{const i=e.length,n=t.length;let o=0,s=0;for(let r=0;r<Math.min(i,n)&&e.charAt(i-r-1)===t.charAt(n-r-1);r+=1)o+=1,(0,f.Yv)(e.charCodeAt(i-r-1))&&(s=o);return s},y=(e,t,i)=>{let n,o;const s=e/2;return t<s&&i<s?(n=t,o=i):t<s?(n=t,o=Math.min(i,e-n)):i<s?(o=i,n=Math.min(t,e-o)):(n=s,o=s),{actualLeftContextLength:n,actualRightContextLength:o}},I=(e,t,i,n)=>{if(n){let n=t;for(;" "!==e.charAt(n)&&n<i;)n+=1;return n}{let n=i;const o=i;for(;" "!==e.charAt(n)&&n>t;)n-=1;return n+1<=o&&(n+=1),n}};var C=i(20255),S=i(84030),b=i(22155),T=i(63526),E=i(19685),N=i(33767),x=i(62026),w=i(37053),L=i(10590),D=i(48662),F=i(35731),A=i(81876),R=i(85681),q=i(67409),P=i(21203),O=i(33727),k=i(78426),z=i(63519);const M=(0,l.f)("ITonalFreStore");var W=i(92507),j=i(37814),B=i(30950),U=i(75499),H=i(96292),V=i(10062),G=i(28853),Q=i(85793),K=i(11966),$=i(97633),J=i(41505),Z=i(63326),Y=i(19728),X=i(29906),ee=i(83010),te=i(27603),ie=i(62924),ne=i(26740),oe=i(16924),se=i(24850);var re=i(44404),ae=i(83817),le=i(63794);let de=class{constructor(e,t,i,s,l,d,f,S,b,T,E,N,x,w,L,D,F,A,P,O,k,z,M,V,G,Q){var K;this.proofingStore=e,this.localizerService=t,this.hostSettings=i,this.wordDictionary=s,this.instrumentationProcessor=l,this.logger=d,this.validator=f,this._showSynonymsFeature=S,this._proofingDom=b,this._tileContent=T,this._upsellFeature=E,this.styleDefinitions=N,this._roamingDictionaryBroker=x,this._upsellStore=w,this._featureFlagsReader=L,this._unSignedInEditorFeature=D,this._ariaStatusStateStore=F,this._feedbackStore=A,this._tonalFreStore=P,this._categoryLocalization=O,this._paneOpenState=k,this._externalSettingsFeature=z,this._roamingDictionaryFeature=M,this._indicatorStore=V,this._multilingualFreStore=G,this._autoCorrectionBroker=Q,this.wasMarkedAsShown=!1,this.enableUpsell=!1,this._setInitialFocus=!1,this._isVisible=!1,this._target=void 0,this.showSynonymsState=!1,this._suggestionsToRender=[],this.isApplyingCritiqueAction=!1,this.navInfo=void 0,this._gapSpace=void 0,this._unsignedInEditorFeatureEnabled=!1,this.show=async e=>{var t,i,s,l,d,u;const{critique:h,setInitialFocus:g,target:p,onDismiss:m,onApplySuggestion:f,onIgnoreOnce:v,onIgnoreAll:_,onDisableCritiqueType:y,onShowFeedback:I,targetDocumentRef:C,gapSpace:S}=e,b=null!==(i=null===(t=this._upsellStore)||void 0===t?void 0:t.reducePreviewCount(h))&&void 0!==i?i:R.nz.Visible,T=null===(s=this._upsellStore)||void 0===s?void 0:s.isSquiggleBeingPreviewed(h);if(b!==R.nz.Hidden&&!T){if(this._unsignedInEditorFeatureEnabled=await this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:r.o9.CalloutShown,sender:r.v$.CritiqueCallout}),this.setSynonymsState(await this.proofingStore.read(a.l.ShowSynonyms)),this._suggestionsToRender=[],this._setInitialFocus=g,this.critique=h,this._targetDocumentRef=C,this.enableUpsell=!!(null===(l=this._upsellFeature)||void 0===l?void 0:l.emitAndEvaluate({eventId:n.CritiqueClicked,sender:o.ShowCritiqueCallout,critique:this.critique})),h.suggestions.length>0)for(const[e,t]of h.suggestions.entries()){if((0,c.gA)(t.action))continue;let i={id:e.toString(),title:this.getSuggestionTitle(t),subtitle:this.getSuggestionDescription(t),tag:this.getLanguageTags(t),actions:[ie._R.Accept]};this.isRewrite&&(i=Object.assign(Object.assign({},i),this.getSuggestionTitleWithDecorations(t))),this.suggestionsToRender.push(i)}this.critique.shouldShowMultilingualFre?null===(d=this._multilingualFreStore)||void 0===d||d.addMultilingualProofingFre():null===(u=this._multilingualFreStore)||void 0===u||u.removeMultilingualProofingFre(),this.onAfterShownCallback=()=>{this._setInitialFocus&&(0,le.Fy)(!0),this.onAfterShownCallback=void 0},this._gapSpace=S,(0,Y.runInAction)((()=>{this._target=p})),this.onApplySuggestion=f,this.onIgnoreOnce=v,this.onIgnoreAll=_,this.onDisableCritiqueType=y,this.onShowFeedback=I,this.setIsVisible(!0),this.onShown(h,m)}},this.setSynonymsState=e=>{this.showSynonymsState=e},this.setIsVisible=e=>{this._isVisible=e,this.wasMarkedAsShown=!1},this.hide=()=>{var e;(this._isVisible||this.wasMarkedAsShown)&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isRewrite&&(null===(e=this._tonalFreStore)||void 0===e||e.checkIfDisableTonalCritiqueInitiatedAndCompleteIt()),this._isVisible=!1,this.wasMarkedAsShown=!1,this.instrumentationEventId=void 0,this.critique=void 0,this._target=void 0,this._targetDocumentRef=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onDisableCritiqueType=void 0,this.footerAction=void 0,this._gapSpace=void 0,this._suggestionsToRender=[],this.onDismiss()},this.onDismiss=()=>{var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this),this.onDismissCallback=void 0},this.afterRender=()=>{var e;null===(e=this.onAfterShownCallback)||void 0===e||e.call(this)},this.onCalloutAction=(e,t,i)=>{this.isApplyingCritiqueAction=!0;try{this.isCritiqueAction(e)?this.onCritiqueAction(e,t):this.onCardAction(e)}finally{this.isApplyingCritiqueAction=!1}},this.onTonalFreAction=e=>{var t;if(this._tonalFreStore){this.isApplyingCritiqueAction=!0;try{let i=!1;switch(e){case oe.h.Accept:this._tonalFreStore.acceptTonalRewriteCritique();break;case oe.h.Ignore:this.ignoreOnce(),i=!0,this._tonalFreStore.logTonalFreIgnored();break;case oe.h.Reject:void 0!==(null===(t=this.critique)||void 0===t?void 0:t.typeId)&&this._tonalFreStore.disableTonalRewriteCritique(this.critique.typeId);break;case oe.h.OpenEditorSettings:this._tonalFreStore.showEditorSettings(),i=!0;break;case oe.h.DismissRejectMessage:i=!0}i&&this.hide()}finally{this.isApplyingCritiqueAction=!1}}},this.changeShowSynonymsState=()=>{const e=!this.showSynonymsState;this.proofingStore.write(a.l.ShowSynonyms,e).then((()=>{this.updateShowSynonyms(e)}))},this.updateShowSynonyms=e=>{this.showSynonymsState=e;const t=this.logger.getNewActivity(this.showSynonyms?u.n.ActionShowSynonymsFromCallout:u.n.ActionHideSynonymsFromCallout,h.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())},this.goPremium=e=>{var t;null===(t=this._upsellFeature)||void 0===t||t.goPremium(o.ShowCritiqueCallout,this.critique,e)},this.tryPremiumPreview=()=>{var e;null===(e=this._upsellStore)||void 0===e||e.tryPremiumPreview(this.critique)},this.signIn=()=>{chrome.runtime.sendMessage({activity:"authentication",type:"msidUserService"});const e=this.logger.getNewActivity(u.n.SignInInitialized,h.o.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push((0,g.n)("Entry","CritiqueCallout")),e.success=!0,e.endNow())},this.clickNoActionHide=()=>{const e=this.shouldShowTonalFre;!this.isVisible&&!this.wasMarkedAsShown||e||this.recordInstrumentationEventId(Z.xp.ClickNoAction),this.hide()},this.notifyAriaStatusChange=e=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(e,"assertive")},this.applySuggestion=(e,t)=>{var i;this.critique&&this.onApplySuggestion&&(null===(i=this._upsellStore)||void 0===i||i.removePremiumCritique(this.critique),this.onApplySuggestion(this.critique,e))},this.ignoreOnce=()=>{var e,t;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&(null===(t=this.onIgnoreOnce)||void 0===t||t.call(this,this.critique))},this.ignoreAll=()=>{var e;this.critique&&(null===(e=this.onIgnoreAll)||void 0===e||e.call(this,this.critique))},this.addToDictionary=()=>{var e;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&this.wordDictionary.addWordToCustomDictionary(this.critique.textInContext)},this.disableCritiqueType=async()=>{var e;const t=this.critique;if(void 0===(null==t?void 0:t.typeId))return void this.logger.error(571326788,"Undefined critique or typeId while trying to disable a critique type");await(null===(e=this.onDisableCritiqueType)||void 0===e?void 0:e.call(this,t));const i=this.logger.getNewActivity(u.n.ActionDisableCritique,h.o.SamplingPolicy.CriticalExperimentation);i&&(i.dataFields.push((0,g.n)("CritiqueTypeId",t.typeId)),t.typeId===p.L9.TopicSuggestion&&i.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(t.metadata))),i.success=!0,i.endNow()),this.recordInstrumentationEventId(Z.xp.DoNotCheckThisIssue),this.notifyAriaStatusChange(t.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",t.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel")),this.hide()},this.onRewriteFeedback=()=>{if(this.isRewrite){const e=this.suggestionsToRender.length>0?this.suggestionsToRender[0].title:"";this._feedbackStore.feedbackIconClicked(e,"tonal"),this.hide()}},this.isCritiqueAction=e=>{switch(e){case ie._R.Accept:case ie._R.IgnoreOnce:case ie._R.IgnoreAll:case ie._R.AddToDictionary:case ie._R.IgnoreRule:return!0;default:return!1}},this.onCritiqueAction=(e,t)=>{var i;if(!this.critique)return void this.logger.error(562438878,`Undefined critique on action: ${e}`);const n=void 0!==t?this.critique.suggestions[t]:void 0;let o,s;switch(e){case ie._R.Accept:n&&void 0!==t?(this.applySuggestion(n,t),o=this.localizer.getMessage("ebx_SuggestionAppliedMessage",n.text),s=this.isSpellingDeletion?Z.xp.Delete:Math.min(t+Z.xp.ChangeSugg0,Z.xp.ChangeSuggOther)):this.logger.error(543495585,`Undefined suggestionIndex or suggestion on Accept: ${t}, ${n}`);break;case ie._R.IgnoreOnce:this.ignoreOnce(),o=this.localizer.getMessage("ebx_GrammarIgnored"),s=Z.xp.Ignore;break;case ie._R.IgnoreAll:this.ignoreAll(),o=this.localizer.getMessage("ebx_SpellingIgnored"),s=Z.xp.IgnoreAll;break;case ie._R.AddToDictionary:this.addToDictionary(),o=this.localizer.getMessage("ebx_AddedToDictionary",this.critique.textInContext),s=Z.xp.AddToDictionary;break;case ie._R.IgnoreRule:this.disableCritiqueType(),o=this.critique.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",this.critique.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel"),s=Z.xp.DoNotCheckThisIssue}void 0!==s?this.recordInstrumentationEventId(s):this.logger.error(562438879,`Undefined actionInstrumentationEventId on action: ${e}`),void 0!==o?this.notifyAriaStatusChange(o):this.logger.error(562438880,`Undefined actionAriaNotification on action: ${e}`),this.hide(),null===(i=this.navInfo)||void 0===i||i.onNavSuggestionApplied()},this.executeActionIfDefined=(e,t)=>{t?t():this.logger.error(561853783,`Undefined action clicked: ${e}`)},this.onCardAction=e=>{var t,i;switch(e){case ie._R.Options:this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide();break;case ie._R.ManageLanguages:this.executeActionIfDefined("manageLanguagesAction",this.manageLanguagesAction),this.hide();break;case ie._R.ShowExplanation:break;case ie._R.Feedback:if(this.isRewrite)this.onRewriteFeedback();else if(this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback){let e;try{e=this.critique.suggestions.map((e=>{var t;return JSON.parse(null!==(t=e.metadataJSON)&&void 0!==t?t:"{}")}))}catch(e){this.logger.error(537778203,"Error parsing topic metadata json.")}(0,m.z)((0,B.S)({topicIds:(null==e?void 0:e.map((e=>e.id)).join(", "))||"",topicNames:(null==e?void 0:e.map((e=>e.displayName)).join(", "))||"",highlightedText:this.critique.textInContext||"",requestId:this.critique.metadata[0].value,hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),source:"EditorFlag",traceId:this.critique.traceId||""}))}else this.executeActionIfDefined("onShowFeedback",this.onShowFeedback);break;case ie._R.ToggleDescription:this.changeShowSynonymsState();break;case ie._R.AddOnFooterAction:this.executeActionIfDefined("footerAction",this.footerAction);break;case ie._R.Next:this.navigate(1);break;case ie._R.Previous:this.navigate(-1);break;case ie._R.OpenEditorPane:this._indicatorStore?null===(i=(t=this._indicatorStore).onOpenEditorPane)||void 0===i||i.call(t,W.k.ContextualCard):this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide()}},this.getSuggestionTitle=e=>!(0,q.qB)(e)&&this.critique&&(0,q.ht)(this.critique)?this.localizer.getMessage("ebx_deleteRepeatedWord"):this.validator.validate(e.text),this.getSuggestionTitleWithDecorations=e=>{var t;if(null===(t=this.critique)||void 0===t?void 0:t.textInContext){const{truncatedPrefix:t,truncatedSubstring:i,truncatedSuffix:n}=((e,t)=>{const i=t.length,n=v(e,t),o=Math.min(_(e,t),Math.min(i,e.length)-n),s=n+o,r=i-s,a=Math.min(130,r),l=Math.min(150-a,s),d=Math.min(l,n),c=Math.min(l,o),{actualLeftContextLength:u,actualRightContextLength:h}=y(l,d,c),g=t.substring(n-u,n),p=t.substring(n,i-o),m=t.substring(i-o,i-o+h);let f=g,C=p,S=m;if(n>u){const e=I(g,0,g.length,!0);f=`...${g.substring(e,g.length)}`}if(p.length>a){const e=I(p,0,a/2,!1),t=I(p,a/2,p.length,!0);C=`${p.substring(0,e)}...${p.substring(t,p.length)}`}if(o>h){const e=I(m,0,m.length,!1);S=`${m.substring(0,e)}...`}return{truncatedPrefix:f,truncatedSubstring:C,truncatedSuffix:S}})(this.critique.textInContext,e.text);return{title:t+i+n,titleDecorations:[{start:e.text.indexOf(i),length:i.length,decorationType:ie.vr.Rewrite}]}}return{title:this.getSuggestionTitle(e),titleDecorations:void 0}},this.getSuggestionDescription=e=>{if(!this.isSynonymsEnabled)return;if(!this.isSynonymsAvailable)return;let t=this.validator.validate(e.description);return this.isTopicSuggestionCritique&&(t=t.slice(0,125),e.description&&e.description.length>t.length&&(t+="...")),t||this.localizer.getMessage("ebx_synonymsNotAvailable")},this.getNeutralLanguageCode=e=>{const t=e.indexOf("-");return(t<0?e:e.slice(0,t)).toUpperCase()},this.getLanguageTags=e=>{const t=this.proofingStore.getCachedEntry(a.l.ProofingLanguages).storeEntryValue;if(!t||t.length<2||!e.languages)return"";const i=[];for(const t of e.languages){const e=this.getNeutralLanguageCode(t);i.includes(e)||i.push(e)}return i.join(", ")},this.setNavInfo=e=>{this.navInfo=e},this.navigate=(e=0)=>{const t=(0,U.v)(this.navInfo),i=t.length;if(!this.navInfo||0===i)return this.resetNavigation(),this.clickNoActionHide(),!1;const n=((this.navInfo.currentIndex+e)%i+i)%i,o=t[n];return this.navInfo=Object.assign(Object.assign({},this.navInfo),{currentIndex:n}),this.hide(),"contenteditable"===this.navInfo.ctr?this.navigateCe(o.store,o.critique):this.navigateV2(o.store,o.critique),!0},this.navigateCe=(e,t)=>{const i=this.navInfo;e.showCallout(t,(()=>{this.setNavInfo(i)}))},this.navigateV2=(e,t)=>{const i=e.messageItem.anchor.element,n=this.navInfo;e.showCallout(t,i,i.innerText,!0,(()=>{this.setNavInfo(n)}),H.Ah.critique)},this.resetNavigation=()=>{var e;null===(e=this.navInfo)||void 0===e||e.onCloseNavigation(),this.navInfo=void 0},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e),e===Z.xp.ClickNoAction&&this.resetNavigation(),this._indicatorStore&&(0,se.sw)(this._indicatorStore)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,Y.toJS)(this.critique),eventId:e})},(0,j.Gn)(this),(null===(K=this._externalSettingsFeature)||void 0===K?void 0:K.openSettings)&&(this.showOptionsAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(C.kY.dropdown)},this.manageLanguagesAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(C.kY.manageLanguages)})}get roamingDictionaryEnabled(){var e,t;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!(null===(t=this._roamingDictionaryFeature)||void 0===t?void 0:t.isReady())}get cloudIconEnabled(){return this.hostSettings.inferenceCritiqueCloudIconEnabled&&!this.isRewrite}get shouldShowAddToDictionary(){return!!this.critique&&(this.roamingDictionaryEnabled&&this.isSpelling&&!(0,q.dt)(this.critique))}get isUpsell(){return this.enableUpsell}get setInitialFocus(){return this._setInitialFocus}get isVisible(){return this._isVisible}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new S.O(document)}getParentElement(){var e,t;if(null===(e=this.critique)||void 0===e?void 0:e.nodeId){const e=this._proofingDom.findParagraphNode(this.critique.nodeId);if(!e)return;const i=this._tileContent.getContainingElement(e);if(i)return null!==(t=(0,ae.m)(i))&&void 0!==t?t:i}}get target(){return this._target}get isSynonymsEnabled(){return this._showSynonymsFeature.emitAndEvaluate({eventId:b.OV.GetMoreCommands,sender:b.xr.CritiqueCallout})}get showSynonyms(){return this.showSynonymsState||this.isTopicSuggestionCritique}get brandingMode(){return this.hostSettings.brandingMode}get suggestionsToRender(){return this._suggestionsToRender}get noSuggestionLabel(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.suggestions.length)&&(0,c.gA)(this.critique.suggestions[0].action)?this.critique.suggestions[0].text:""}get calloutTitle(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}return(0,q.dt)(this.critique)?this.localizer.getMessage("ebx_repeatedWordsExplanationTitle"):(0,q.r)(this.critique)?this.localizer.getMessage("ebx_spellingExplanationTitle"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionExplanationTitle"):this.validator.validate(this.critique.explanationTitle)}get text(){var e,t,i;return null!==(i=null===(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)||void 0===t?void 0:t.substring(this.critique.start,this.critique.start+this.critique.length))&&void 0!==i?i:""}get textInContext(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&void 0!==t?t:""}get calloutCategory(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}const e=this.critique.categoryTitle?this._categoryLocalization.toUiLocale(this.critique.categoryTitle):void 0,t=this.isRewrite?this.localizer.getMessage("ebx_toneLabel"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionLabel"):e;return this.validator.validate(t)}get explanation(){var e;return this.hostSettings.critiqueCalloutExplanationFlyout&&this.critique&&null!==(e=this.critique.explanation)&&void 0!==e?e:""}get explanationTitle(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.explanationLabel)&&void 0!==t?t:""}get localizer(){return this.localizerService}get styles(){return this.styleDefinitions.critiqueCallout}get proofingLanguageDir(){}get isSpelling(){return(0,q.r)(this.critique)}get isRepeatedWords(){return(0,q.dt)(this.critique)}get isRewrite(){return(0,q.r6)(this.critique)}get isTopicSuggestionCritique(){return(0,q.W)(this.critique)}get isAutoCorrection(){var e;return!!(this.hostSettings.enableAutoCorrect&&this.critique&&(0,q.MG)(this.critique)&&(null===(e=this._autoCorrectionBroker)||void 0===e?void 0:e.getHasAutoCorrectionBeenApplied(this.critique)))}get isSpellingDeletion(){return!!this.critique&&(0,q.ht)(this.critique)}get shouldShowTonalFre(){return this.isRewrite&&!!this.hostSettings.tonalFreEnabledForUser&&!!this._tonalFreStore&&!this._tonalFreStore.isTonalFreAccepted}get settings(){const e={RenderFooterIcons:"true"};return this.hostSettings.isFeedbackEnabled&&this.isRewrite&&(e.EnableFeedback="true"),this.hostSettings.ignoreAllEnabled&&(e.EnableIgnoreAll="true"),e}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:4}get critiqueType(){return this.critique&&(0,q.dt)(this.critique)?ie.L9.RepeatedWord:(0,q.r)(this.critique)?ie.L9.Spelling:(0,q.W)(this.critique)?ie.L9.Topic:this.critique&&this.critique.priority===p.bx.Medium?ie.L9.Grammar:this.isRewrite?ie.L9.TonalRewrite:ie.L9.Refinement}get critiqueSource(){if(this.critique&&this.cloudIconEnabled){const e=this.critique.metadata;if(e&&e.length>0)for(const t of e)if("CritiqueSource"===t.name&&"Inference"===t.value)return ne.UD.Inference}return ne.UD.Unknown}get isSynonymsAvailable(){var e;const t=null===(e=this.critique)||void 0===e?void 0:e.suggestions.find((e=>!!e.description&&!e.description.match(/\[(.*)\]/g)));return(this.isSpelling||this.isTopicSuggestionCritique)&&!this.isAutoCorrection&&!!t}get showDisableCritiqueTypeMenuItem(){return!!this.hostSettings.enableStopCheckingForThis&&!!this.critique&&this.critique.priority!==p.bx.High&&!this.isTopicSuggestionCritique}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}async initialize(){}shutDown(){this._target=void 0,this._targetDocumentRef=void 0,this.onDisableCritiqueType=void 0,this.onDismissCallback=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onAfterShownCallback=void 0,this.onShowFeedback=void 0,this.showOptionsAction=void 0,this.manageLanguagesAction=void 0,this.footerAction=void 0}markAsShown(e,t){this.wasMarkedAsShown=!0,this.onShown(e,t)}onShown(e,t){var i;this.shouldShowTonalFre&&(null===(i=this._tonalFreStore)||void 0===i||i.logTonalFreShown());const n=this.logger.getNewActivity(u.n.ActionShowCallout,h.o.SamplingPolicy.CriticalExperimentation);n&&(n.dataFields.push((0,g.n)("CritiqueTypeId",e.typeId)),e.typeId===p.L9.TopicSuggestion&&n.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata))),n.success=!0,n.endNow()),this.onDismiss(),this.onDismissCallback=t}get dropDownActions(){var e;const t=[];return this.isAutoCorrection?t.push(ie._R.AutoCorrectOptions):this.isSpelling&&!this.isSpellingDeletion?(this.hostSettings.ignoreAllEnabled&&t.push(ie._R.IgnoreAll),this.hostSettings.isMultilingualProofingEnabled&&this.hostSettings.enableManageLanguagesInCritiqueCallout&&t.push(ie._R.ManageLanguages)):this.hostSettings.ignoreOnceEnabled&&t.push(ie._R.IgnoreOnce),this.isTopicSuggestionCritique&&this.hostSettings.ignoreAllEnabled&&t.push(ie._R.IgnoreAll),this.isSynonymsAvailable&&this.isSynonymsEnabled&&!this.isTopicSuggestionCritique&&t.push(ie._R.ToggleDescription),this.hostSettings.showOptionsButton&&t.push(ie._R.Options),(this._featureFlagsReader.flags.enableOcvFeedbackUi||this.hostSettings.isFeedbackEnabled&&this.isRewrite||this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback)&&t.push(ie._R.Feedback),this.showDisableCritiqueTypeMenuItem&&t.push(ie._R.IgnoreRule),!this.isAutoCorrection&&this.shouldShowAddToDictionary&&t.push(ie._R.AddToDictionary),this.navInfo&&(t.push(ie._R.Next),t.push(ie._R.Previous)),(null===(e=this._paneOpenState)||void 0===e?void 0:e.isPaneOpen)||this.brandingMode!==ie.nH.IconButton&&this.brandingMode!==ie.nH.IconAndTextButton||t.push(ie._R.OpenEditorPane),t}get addOnFooterData(){if(this.unsignedInEditorFeatureEnabled)return this.footerAction=this.signIn,{actionText:this.localizer.getMessage("ebx_signIntoEditor"),message:`${this.localizer.getMessage("ebx_addGrammarChecking")}${this.localizer.getMessage("ebx_enhancedUpsellCategoriesComma")}`};if(!this.enableUpsell)return;if(!(this.hostSettings.areAdditionalPaneEntryPointsEnabled&&this._indicatorStore))return this.premiumPreviewFooter;this.footerAction=()=>{var e,t;null===(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.onOpenEditorPane)||void 0===t||t.call(e,W.k.ContextualCard),this.hide()};const e=(t=this._indicatorStore,Array.from(t.paneCritiques.values()).filter((e=>e)).length);var t;return{actionText:this.localizer.getMessage("ebx_openEditorLabel"),message:e>0?this.localizer.getMessage("ebx_editorAdvancedCritiquesLabel",e.toString()):this.localizer.getMessage("ebx_tryEditorLabel"),icon:"Editor"}}get premiumPreviewFooter(){if(!this.hostSettings.enhancedUpsellEnabled||!this._upsellStore)return this.footerAction=()=>this.goPremium("Regular_CCard"),{actionText:this.localizer.getMessage("ebx_goPremiumLinkText"),message:this.localizer.getMessage("ebx_goPremiumLine"),icon:"PremiumDiamond"};const e=this._upsellStore.previewModeActive,t=this.hostSettings.premiumPreviewEnabled,i=this._upsellStore.previewUnit,n=e?this._upsellStore.previewCount:this._upsellStore.premiumCount,o=t&&!e&&n>0;let s="ebx_premiumPreviewGeneralLine";const r=1===n;e&&i===R.mq.Suggestions?s=r?"ebx_premiumPreviewSuggestionsSingular":"ebx_premiumPreviewSuggestionsPlural":e&&i===R.mq.Days?s=r?"ebx_premiumPreviewDaysSingular":"ebx_premiumPreviewDaysPlural":n>0&&(s=r?"ebx_enhancedUpsellLineSingular":"ebx_enhancedUpsellLinePlural");const a=n.toLocaleString(),l=this.localizer.getMessage(s,a);return this.footerAction=o?()=>{var e;return null===(e=this._upsellStore)||void 0===e?void 0:e.tryPremiumPreview(this.critique)}:()=>this.goPremium("ContextualUpsell_CCard"),{actionText:o?this.localizer.getMessage("ebx_tryPremiumPreviewLink"):this.localizer.getMessage("ebx_goPremiumLinkText"),footerDecorations:n>0||e?[{decorationType:ie.vr.PremiumEmphasis,length:a.length,start:l.indexOf(a)}]:void 0,message:l,icon:"PremiumDiamond"}}};(0,s.__decorate)([Y.observable],de.prototype,"enableUpsell",void 0),(0,s.__decorate)([Y.computed],de.prototype,"isUpsell",null),(0,s.__decorate)([Y.observable],de.prototype,"_setInitialFocus",void 0),(0,s.__decorate)([Y.computed],de.prototype,"setInitialFocus",null),(0,s.__decorate)([Y.observable],de.prototype,"_isVisible",void 0),(0,s.__decorate)([Y.computed],de.prototype,"isVisible",null),(0,s.__decorate)([Y.observable],de.prototype,"_target",void 0),(0,s.__decorate)([Y.computed],de.prototype,"target",null),(0,s.__decorate)([Y.observable],de.prototype,"showSynonymsState",void 0),(0,s.__decorate)([Y.computed],de.prototype,"showSynonyms",null),(0,s.__decorate)([Y.computed],de.prototype,"brandingMode",null),(0,s.__decorate)([Y.observable],de.prototype,"_suggestionsToRender",void 0),(0,s.__decorate)([Y.computed],de.prototype,"suggestionsToRender",null),(0,s.__decorate)([Y.computed],de.prototype,"noSuggestionLabel",null),(0,s.__decorate)([Y.observable],de.prototype,"navInfo",void 0),(0,s.__decorate)([Y.computed],de.prototype,"calloutTitle",null),(0,s.__decorate)([Y.computed],de.prototype,"text",null),(0,s.__decorate)([Y.computed],de.prototype,"textInContext",null),(0,s.__decorate)([Y.computed],de.prototype,"calloutCategory",null),(0,s.__decorate)([Y.computed],de.prototype,"explanation",null),(0,s.__decorate)([Y.computed],de.prototype,"explanationTitle",null),(0,s.__decorate)([Y.computed],de.prototype,"styles",null),(0,s.__decorate)([Y.computed],de.prototype,"shouldShowTonalFre",null),(0,s.__decorate)([Y.computed],de.prototype,"settings",null),(0,s.__decorate)([Y.observable],de.prototype,"_gapSpace",void 0),(0,s.__decorate)([Y.computed],de.prototype,"gapSpace",null),(0,s.__decorate)([Y.computed],de.prototype,"critiqueType",null),(0,s.__decorate)([Y.computed],de.prototype,"critiqueSource",null),(0,s.__decorate)([Y.action],de.prototype,"show",void 0),(0,s.__decorate)([Y.action],de.prototype,"setSynonymsState",void 0),(0,s.__decorate)([Y.action],de.prototype,"setIsVisible",void 0),(0,s.__decorate)([Y.action],de.prototype,"hide",void 0),(0,s.__decorate)([Y.action],de.prototype,"onDismiss",void 0),(0,s.__decorate)([Y.action],de.prototype,"afterRender",void 0),(0,s.__decorate)([Y.action],de.prototype,"onCalloutAction",void 0),(0,s.__decorate)([Y.action],de.prototype,"onTonalFreAction",void 0),(0,s.__decorate)([Y.computed],de.prototype,"dropDownActions",null),(0,s.__decorate)([Y.action],de.prototype,"updateShowSynonyms",void 0),(0,s.__decorate)([Y.computed],de.prototype,"addOnFooterData",null),(0,s.__decorate)([Y.action],de.prototype,"setNavInfo",void 0),(0,s.__decorate)([Y.action],de.prototype,"navigate",void 0),(0,s.__decorate)([Y.action],de.prototype,"resetNavigation",void 0),de=(0,s.__decorate)([(0,X._)(),(0,s.__param)(0,(0,ee.W)(T.K)),(0,s.__param)(1,(0,ee.W)(E.H)),(0,s.__param)(2,(0,ee.W)(N.n)),(0,s.__param)(3,(0,ee.W)(P.s)),(0,s.__param)(4,(0,ee.W)(x.f)),(0,s.__param)(5,(0,ee.W)(w.g)),(0,s.__param)(6,(0,ee.W)(K.$)),(0,s.__param)(7,(0,ee.W)(b.DS)),(0,s.__param)(8,(0,ee.W)(O.w)),(0,s.__param)(9,(0,ee.W)(k.d)),(0,s.__param)(10,(0,ee.W)(d)),(0,s.__param)(10,(0,te.l)()),(0,s.__param)(11,(0,ee.W)(V.$)),(0,s.__param)(12,(0,ee.W)(L.C)),(0,s.__param)(12,(0,te.l)()),(0,s.__param)(13,(0,ee.W)(R.Ey)),(0,s.__param)(13,(0,te.l)()),(0,s.__param)(14,(0,ee.W)(D.c)),(0,s.__param)(15,(0,ee.W)(r.tq)),(0,s.__param)(16,(0,ee.W)(G.JY)),(0,s.__param)(17,(0,ee.W)(z.M)),(0,s.__param)(18,(0,ee.W)(M)),(0,s.__param)(18,(0,te.l)()),(0,s.__param)(19,(0,ee.W)(J.C)),(0,s.__param)(20,(0,te.l)()),(0,s.__param)(20,(0,ee.W)(F.F)),(0,s.__param)(21,(0,te.l)()),(0,s.__param)(21,(0,ee.W)(C.In)),(0,s.__param)(22,(0,te.l)()),(0,s.__param)(22,(0,ee.W)(A.Zp)),(0,s.__param)(23,(0,te.l)()),(0,s.__param)(23,(0,ee.W)(re.$)),(0,s.__param)(24,(0,te.l)()),(0,s.__param)(24,(0,ee.W)(Q.j)),(0,s.__param)(25,(0,te.l)()),(0,s.__param)(25,(0,ee.W)($.m))],de)},41614:(e,t,i)=>{var n;i.d(t,{u:()=>n}),function(e){e.calloutMain="calloutMain",e.moreActions="moreActions"}(n||(n={}))},48686:(e,t,i)=>{i.d(t,{$:()=>C,v:()=>y});var n=i(23182),o=i(8520),s=i(47018),r=i(26154),a=i(93675),l=i(745),d=i(41642),c=i(95373),u=i(34055),h=i(22628),g=i(96969),p=i(48689),m=i(17932),f=i(56489),v=i(24033),_=i(51244);const y=(0,l.F5)({state:d.A.on(u.x)});let I=class extends o.Component{constructor(){super(...arguments),this.applyUndo=()=>{this.props.deps.state.applyUndo()},this.openSettings=()=>{this.props.deps.state.openSettings()},this.onPositioned=e=>{this.props.deps.state.updateCalloutPosition((null==e?void 0:e.alignmentEdge)===p.x.right,!1)}}render(){const{state:e}=this.props.deps,{isVisible:t,undoAriaLabel:i,undoTitle:n,localizer:l,target:d,styles:c,showEditorBranding:u,gapSpace:p}=e,f=l.getMessage("ebx_settingsButtonTooltip"),_=l.getMessage("ebx_undoCalloutAriaLabel"),y=o.createElement("div",{style:Object.assign({display:"flex",flexDirection:"row",flexWrap:"nowrap"},c.calloutContainer)},o.createElement(a.$,{icon:o.createElement(s.t2R,{style:c.buttonIcon.icon}),appearance:"subtle",className:`${m.g.undoButton}`,"data-automation-id":"undo-callout-undo-button",key:"Undo",role:"button",style:c.buttonIcon,title:n,"aria-label":i,onClick:this.applyUndo}),o.createElement(a.$,{icon:o.createElement(r.$Dw,{style:c.buttonIcon.icon}),appearance:"subtle",className:m.g.settingsButton,key:"Settings","data-automation-id":"undo-callout-settings-button",role:"button",style:Object.assign({marginLeft:2},c.buttonIcon),title:f,"aria-label":f,onClick:this.openSettings}),u&&o.createElement("span",{role:"none presentation","aria-hidden":!0,style:c.logoButtonBase},l.getMessage("ebx_brandText")));if(this.context){const i={popover:{trapFocus:e.setInitialFocus,withArrow:!1,open:t,ariaLabel:_,ariaRole:"group",positioning:{target:(0,v.ug)(d),align:"center",position:"above",offset:e=>(this.props.deps.state.updateCalloutPosition("end"===e.alignment,!0),{mainAxis:p})}},surface:{style:Object.assign({padding:0,background:"transparent",borderRadius:8},c.calloutV9)}};return o.createElement(g.v,Object.assign({ref:e.undoCardV9Ref},i),y)}return t&&o.createElement(h.U,{ref:e.undoCardRef,isBeakVisible:!1,gapSpace:p,target:(0,v.KV)(d),doNotLayer:!0,role:"group",ariaLabel:_,setInitialFocus:e.setInitialFocus,onRestoreFocus:()=>{},onPositioned:this.onPositioned,styles:c.calloutMain},y)}};I.contextType=f.O1,I=(0,n.__decorate)([_.PA],I);const C=(0,c.r)(I,y)},17932:(e,t,i)=>{i.d(t,{f:()=>T,g:()=>b});var n=i(23182),o=i(24033),s=i(20255),r=i(14784),a=i(51199),l=i(19685),d=i(33767),c=i(37053),u=i(48662),h=i(62026),g=i(28853),p=i(10062),m=i(11966),f=i(21203),v=i(19728),_=i(29906),y=i(83010),I=i(27603),C=i(37814),S=i(8520);const b={undoButton:"ebx_undoButton",settingsButton:"ebx_settingsButton"};let T=class{constructor(e,t,i,n,r,a,l,d,c,u){var h;let g;this.localizer=e,this.hostSettings=t,this.externalSettingsFeature=i,this.logger=n,this.wordDictionary=r,this._ariaStatusStateStore=a,this._featureFlagsReader=l,this.validator=d,this.instrumentationProcessor=c,this.styleDefinitions=u,this._undoCardRef=S.createRef(),this._undoCardV9Ref=S.createRef(),this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._unsignedInEditorFeatureEnabled=!1,this.getTargetRect=()=>{var e,t;if(this.target)return(0,o.Pe)(this.target)?{left:this.target.x,right:this.target.x,top:this.target.y,bottom:this.target.y,width:0,height:0}:(0,o.K2)(this.target)?{left:this.target.left,right:null!==(e=this.target.right)&&void 0!==e?e:0,top:this.target.top,bottom:null!==(t=this.target.bottom)&&void 0!==t?t:0,width:this.target.width,height:this.target.height}:this.target.getBoundingClientRect()},this.setIsVisible=e=>{this._isVisible=e},this.executeShowOptionsAction=()=>{this.showOptionsAction&&this.showOptionsAction()},this.setShowOptionsAction=e=>{e&&(this.showOptionsAction=e)},this.notifyAriaStatusChange=(e,t)=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(this.localizer.getMessage(e,t),"assertive")},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,v.toJS)(this.critique),eventId:e})},(null===(h=this.externalSettingsFeature)||void 0===h?void 0:h.openSettings)&&(g=()=>{var e;null===(e=this.externalSettingsFeature)||void 0===e||e.openSettings(s.kY.dropdown)}),this.setShowOptionsAction(g),(0,C.Gn)(this)}get undoCardRef(){return this._undoCardRef}get undoCardV9Ref(){return this._undoCardV9Ref}get isVisible(){return this._isVisible}get target(){return this._target}get targetRect(){return this._targetRect||(this._targetRect=this.getTargetRect()),this._targetRect}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:0}get setInitialFocus(){var e;return null!==(e=this._setInitialFocus)&&void 0!==e&&e}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}get mainFocusZoneId(){return"calloutMain--undo"}get undoTitle(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,i=this.localizer.getMessage("ebx_autoCorrectRevertTo",t);return this.validator.validate(i)}get undoAriaLabel(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,i=t.split("").join(" "),n=this.localizer.getMessage("ebx_autoCorrectRevertTo",t),o=this.localizer.getMessage("ebx_undoButtonAriaLabel");return this.validator.validate(`${o}, ${n}, ${i}`)}get showEditorBranding(){return!!this.hostSettings.undoCardShowEditorLogo}get styles(){return this.styleDefinitions.undoCallout}checkShowConditions(e){return!!this.hostSettings.enableAutoCorrect}async prepareShowContent(e){const{onApplySuggestion:t,critique:i,onCalloutPositionUpdated:n}=e;this.critique=i,this.onApplySuggestion=t,this.onCalloutPositionUpdated=n}hide(e){this.isVisible&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isVisible&&(this.resetVariablesAfterHide(),this.onDismiss(e))}resetVariablesAfterHide(){this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._gapSpace=void 0,this.instrumentationEventId=void 0,this.onApplySuggestion=void 0,this.critique=void 0}onDismiss(e){this.onDismissCallback&&(this.onDismissCallback(e),this.onDismissCallback=void 0)}async show(e){if(!this.checkShowConditions(e))return;const{setInitialFocus:t,target:i,onDismiss:n,gapSpace:o}=e;this._target=i,this._gapSpace=o,this._setInitialFocus=t,this.onDismiss(!1),this.onDismissCallback=n,await this.prepareShowContent(e),this.setIsVisible(!0),this.doAfterShow()}doAfterShow(){this.logUndoCalloutOpened()}logUndoCalloutOpened(){const e=this.logger.getNewActivity(r.n.UndoCalloutShown,a.o.SamplingPolicy.CriticalExperimentation);e&&(e.success=!0,e.endNow())}clickNoActionHide(e){this.isVisible&&this.recordInstrumentationEventId(12),this.hide(e)}applyUndo(){if(this.onApplySuggestion&&this.critique&&this.critique.suggestions.length){const e=this.critique.suggestions[0];this.onApplySuggestion(this.critique,e),this.wordDictionary.addWordToIgnoreList(e.text),this.notifyAriaStatusChange("ebx_autoCorrectIgnored",e.text),this.recordInstrumentationEventId(16)}this.hide()}openSettings(){this.executeShowOptionsAction(),this.hide()}updateCalloutPosition(e,t){var i,n,o;if(this.onCalloutPositionUpdated){const s=t?null===(o=null===(n=this._undoCardV9Ref.current)||void 0===n?void 0:n.getElementRef().current)||void 0===o?void 0:o.firstChild:null===(i=this._undoCardRef.current)||void 0===i?void 0:i.firstChild;if(s){const t=s.getBoundingClientRect();this.onCalloutPositionUpdated(e,t)}}}};(0,n.__decorate)([v.observable],T.prototype,"_isVisible",void 0),(0,n.__decorate)([v.computed],T.prototype,"isVisible",null),(0,n.__decorate)([v.observable],T.prototype,"_target",void 0),(0,n.__decorate)([v.observable],T.prototype,"_targetRect",void 0),(0,n.__decorate)([v.action],T.prototype,"onDismiss",null),(0,n.__decorate)([v.action],T.prototype,"setIsVisible",void 0),(0,n.__decorate)([v.action],T.prototype,"show",null),(0,n.__decorate)([v.action],T.prototype,"clickNoActionHide",null),T=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,y.W)(l.H)),(0,n.__param)(1,(0,y.W)(d.n)),(0,n.__param)(2,(0,I.l)()),(0,n.__param)(2,(0,y.W)(s.In)),(0,n.__param)(3,(0,y.W)(c.g)),(0,n.__param)(4,(0,y.W)(f.s)),(0,n.__param)(5,(0,y.W)(g.JY)),(0,n.__param)(6,(0,y.W)(u.c)),(0,n.__param)(7,(0,y.W)(m.$)),(0,n.__param)(8,(0,y.W)(h.f)),(0,n.__param)(9,(0,y.W)(p.$))],T)},58040:(e,t,i)=>{i.d(t,{U:()=>p});var n=i(23182),o=i(53353),s=i(71632),r=i(98647),a=i(99724),l=i(14253),d=i(5698);var c=i(33727),u=i(29906),h=i(83010),g=i(27603);let p=class{constructor(e,t,i){this._hostEmitter=e,this._proofingDom=t,this._inlineSuggestionsRenderer=i,this._menuItems=new Map,this._rootItemEventListeners=new Map,this.registerMenuItem=e=>!!this._inlineSuggestionsRenderer&&(!this._menuItems.get(e.id)&&(this._menuItems.set(e.id,e),!0)),this.unregisterMenuItem=e=>this._menuItems.delete(e),this.onHostModelAddedRootNode=e=>{const t=this._proofingDom.findTerminalNode(e.message);if((null==(i=t)?void 0:i.nodeType)===d.Z.TerminalNode&&(0,s.C)(t.element,"HTMLElement")&&t.children){const e=new r.J(t.element);this._rootItemEventListeners.set(t.id,e),e.addListener("contextmenu",(e=>this.onContextMenuOpened(e,t.children[0])))}var i},this.onHostModelRemovedRootNode=e=>{var t;const i=this._proofingDom.findTerminalNode(e.message);i&&this._rootItemEventListeners.has(i.id)&&(null===(t=this._rootItemEventListeners.get(i.id))||void 0===t||t.removeAllListeners(),this._rootItemEventListeners.delete(i.id))},this.onContextMenuOpened=(e,t)=>{var i,n;if(!(null===(i=t.children)||void 0===i?void 0:i.length))return;const s={entities:[],entityType:o.c.Text};for(const e of this._menuItems.values()){if(e.isValid&&!e.isValid())return;s.entities.push(Object.assign({entityType:o.c.Text,text:e.title,confidence:0},e))}s.entities.length>0&&(e.preventDefault(),null===(n=this._inlineSuggestionsRenderer)||void 0===n||n.renderMenuWithItems(t.children[0].id,e,{menuType:"InlineSuggestionsRightClickContextMenuType"},[s],this.onItemSelected))},this.onItemSelected=e=>{const t=e;t.onItemSelected(t)}}async initialize(){this._inlineSuggestionsRenderer&&(this._hostEmitter.on(a.pD.hostModelAddedRootNode,this.onHostModelAddedRootNode),this._hostEmitter.on(a.pD.hostModelRemovedRootNode,this.onHostModelRemovedRootNode))}shutDown(){for(const e of this._rootItemEventListeners.values())e.removeAllListeners();this._rootItemEventListeners.clear()}};p=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(a.M5)),(0,n.__param)(1,(0,h.W)(c.w)),(0,n.__param)(2,(0,g.l)()),(0,n.__param)(2,(0,h.W)(l.V))],p)},37428:(e,t,i)=>{i.d(t,{I:()=>n});const n=(0,i(17298).f)("IContextualMenuEventHandler")},4405:(e,t,i)=>{i.d(t,{b:()=>f});var n=i(8520),o=i(745),s=i(41642),r=i(99765),a=i(20394),l=i(28798),d=i(56489),c=i(40166),u=i(21592),h=i(3817);const g=e=>{switch(e){case a.Y.critique:return"footer_fre_in_critique_callout";case a.Y.inlineSuggestions:return"footer_fre_in_inline_suggestion_callout";default:return"footer_fre_generic"}},p=()=>{const e=(0,u.$)().getStringsFor("OnCanvasCalloutStrings"),t={nextPageTooltip:e("footerFRE_nextPageTooltip"),paginationTipsText:e("footerFRE_paginationTipsText"),previousPageTooltip:e("footerFRE_previousPageTooltip")};return{footer:e=>t[e]||""}},m=(0,o.F5)({themeStore:s.A.on(d.YQ).optional(),footerFreStore:s.A.on(a.D).optional(),languageScriptDirectionDetector:s.A.on(l.iw).optional()}),f=(0,h.PA)((e=>{const{target:t,styles:i}=e,{footerFreStore:s,languageScriptDirectionDetector:a,themeStore:l}=(0,o.SM)(m),u=null==s?void 0:s.footerProps.get(t);if(!(null==u?void 0:u.display)||!u.pages.size)return n.createElement(n.Fragment,null);const h=null==l?void 0:l.getComponentThemes(d.yF.footerFreComponentName),f=l?null==h?void 0:h.get(l.currentTheme):void 0,v=n.createElement(r.J,{automationId:g(t),pages:Array.from(u.pages.values()),animated:u.animated,styles:i,strings:p(),theme:f,onDismiss:()=>null==s?void 0:s.setFooterDisplay(t,!1),hideIcon:e.hideIcon});return a?n.createElement(c.K,{rtl:a.isRtl()},v):v}))},96984:(e,t,i)=>{i.d(t,{o:()=>a});var n=i(23182),o=i(19728),s=i(29906),r=i(37814);let a=class{constructor(){this.footerProps=new Map,(0,r.Gn)(this)}setFooterDisplay(e,t){const i=this.footerProps.get(e);i&&this.footerProps.set(e,Object.assign(Object.assign({},i),{display:t}))}setFooterAnimated(e,t){const i=this.footerProps.get(e);i&&this.footerProps.set(e,Object.assign(Object.assign({},i),{animated:t}))}addFooterPage(e,t,i){var n;const o=null!==(n=this.footerProps.get(e))&&void 0!==n?n:{display:!0,pages:new Map,animated:!0};o.pages.set(t,i),o.display=!0,this.footerProps.set(e,o)}removeFooterPage(e,t){const i=this.footerProps.get(e);i&&(i.pages.delete(t),0===i.pages.size&&(i.display=!1),this.footerProps.set(e,i))}};(0,n.__decorate)([o.observable],a.prototype,"footerProps",void 0),(0,n.__decorate)([o.action],a.prototype,"setFooterDisplay",null),(0,n.__decorate)([o.action],a.prototype,"setFooterAnimated",null),(0,n.__decorate)([o.action],a.prototype,"addFooterPage",null),(0,n.__decorate)([o.action],a.prototype,"removeFooterPage",null),a=(0,n.__decorate)([(0,s._)()],a)},73224:(e,t,i)=>{i.d(t,{a:()=>h});var n=i(93675),o=i(745),s=i(41642),r=i(90553),a=i(20394),l=i(19685),d=i(3817),c=i(8520);const u=(0,o.F5)({localizer:s.A.on(l.H),footerFreStore:s.A.on(a.D)}),h=(0,d.PA)((e=>{var t;const{theme:i,style:s,languageName:l,undoCallback:d,manageLanguagesCallback:h}=e,{localizer:g,footerFreStore:p}=(0,o.KN)(u),m=()=>{p.removeFooterPage(a.Y.languageAutoDetection,r.Id)};return c.createElement("div",{style:Object.assign({color:null!==(t=null==i?void 0:i.textColor)&&void 0!==t?t:"#323130",minWidth:250},s)},c.createElement("div",{style:{marginBottom:12,paddingRight:14}},g.getMessage("autoDetectionFRE_HeadingText",l)),c.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},c.createElement(n.$,{appearance:"transparent",style:{fontSize:12,padding:2,minWidth:"fit-content",height:"revert",minHeight:24},onClick:()=>{d(),m()}},g.getMessage("autoDetectionFRE_UndoButtonText",l)),c.createElement(n.$,{style:{borderRadius:4,marginLeft:8,fontSize:12,height:"fit-content",minHeight:24,textAlign:"left",paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2},onClick:()=>{h(),m()}},g.getMessage("autoDetectionFRE_ManageLanguagesText",l))))}))},90553:(e,t,i)=>{i.d(t,{Id:()=>v,lP:()=>_,sy:()=>y});var n=i(745),o=i(41642),s=i(42119),r=i(20394),a=i(22628),l=i(96969),d=i(98647),c=i(24033),u=i(4405),h=i(56489),g=i(3817),p=i(35869),m=i(8520);const f=(0,n.F5)({footerFreStore:o.A.on(r.D)}),v="LanguageAutoDetection",_="lang-auto-detect-footer",y=(0,g.PA)((()=>{const{footerFreStore:e}=(0,n.KN)(f),t=e.footerProps.get(r.Y.languageAutoDetection);return(null==t?void 0:t.display)&&1===t.pages.size?m.createElement(I,null):null})),I=(0,g.PA)((()=>{var e,t;const i=m.useContext(h.O1),n=null!==(e=(0,p.ZY)())&&void 0!==e?e:document,o=null!==(t=n.defaultView)&&void 0!==t?t:window,[g,f]=m.useState(C(n)),[v,y]=m.useState(!0),I=m.useCallback((()=>{f(C(n))}),[n,f]);if(m.useEffect((()=>{const e=new d.J(o);return e.addListener("resize",I,{passive:!0,capture:!0}),()=>{e.removeAllListeners()}}),[I,o]),i){const e={popover:{id:_,withArrow:!1,open:v,onOpenChange:(e,t)=>{y(t.open)},positioning:{target:(0,c.ug)(g),align:"center",position:"above",offset:e=>({mainAxis:8})}},surface:{style:{padding:0,background:"transparent",borderRadius:8}}};return m.createElement(l.v,Object.assign({},e),m.createElement(u.b,{target:r.Y.languageAutoDetection}))}return m.createElement(a.U,{id:_,target:g,directionalHint:s.A.topCenter,isBeakVisible:!1,gapSpace:8,style:{borderRadius:8},styles:{root:{borderRadius:8},calloutMain:{background:"transparent"}}},m.createElement(u.b,{target:r.Y.languageAutoDetection}))}));function C(e){return{x:e.body.clientWidth-240,y:e.body.clientHeight-13}}},87320:(e,t,i)=>{i.d(t,{Nt:()=>l,cu:()=>d});var n=i(39558),o=i(97612),s=i(84030),r=i(8520),a=i(94329);function l(e,t,i){return new u(e,t,i)}function d(e,t){const i=new c(e);return{element:r.createElement(h,{eccUxReplacement:i,commonOptions:t}),eccUxReplacement:i}}class c{constructor(e){this.iframeElement=e,this.eccStateChanged=e=>{var t;null===(t=this.listener)||void 0===t||t.call(this,e)},this.setListener=e=>{this.listener=e}}dispose(){this.listener&&(this.listener(void 0),this.listener=void 0)}}class u extends c{constructor(e,t,i){super(t),this.editorCard=document.createElement("external-editor-card"),this.editorCard.setAttribute("style","position:absolute;top:0px;left:0px;z-index:auto;display: block !important"),e.appendChild(this.editorCard),a.render(r.createElement(h,{eccUxReplacement:this,commonOptions:i}),this.editorCard)}dispose(){this.editorCard&&(a.unmountComponentAtNode(this.editorCard),this.editorCard.remove(),this.editorCard=void 0),super.dispose()}}const h=e=>{var t;const{iframeElement:i,setListener:a}=e.eccUxReplacement,[l,d]=r.useState(),c=r.useCallback((e=>{d(e)}),[d]);if(r.useEffect((()=>(a(c),()=>{a(void 0)})),[c,a]),!l)return null;const u=function(e,t){var i,n;if(!e||!t||"string"==typeof t)return t;let o=e.getBoundingClientRect();const s=getComputedStyle(e),r=parseFloat(s.borderWidth.replace("px",""));if(o=new DOMRect(o.left+r,o.top+r,o.width-r-r,o.height-r-r),"left"in t&&"top"in t&&t.left&&t.top)return"width"in t&&"height"in t?{left:t.left+o.left,right:t.left+o.left+t.width,top:t.top+o.top,bottom:t.top+o.top+t.height,width:t.width,height:t.height}:{x:(null!==(i=t.left)&&void 0!==i?i:0)+o.left,y:(null!==(n=t.top)&&void 0!==n?n:0)+o.top};if("x"in t&&"y"in t)return{x:t.x+o.left,y:t.y+o.top};return t}(i,l.targetLocation);return u?r.createElement(o.O.Provider,{value:!!(null===(t=e.commonOptions)||void 0===t?void 0:t.useFluentV9)},r.createElement("div",{dir:l.calloutProps.isRtl?"rtl":"ltr",style:{all:"initial"}},r.createElement(n.$,Object.assign({},l,{targetWindow:new s.O(window),targetLocation:u})))):null}},66549:(e,t,i)=>{i.d(t,{V:()=>x});var n=i(8520),o=i(53353),s=i(98647),r=i(85802),a=i(24371),l=i(69655),d=i(4405),c=i(96821),u=i(20889),h=i(26297);const g='[\\.\\:\\;\\,\\s-_\\(\\)\\/\\"\\u2018\\u2019\\u201c\\u201d\\xab\\xbb\\!\\?\\#\\&\\+\\\\<\\>\\@\\+\\=\\xa1\\xbf\\xaa\\xba]';function p(e,t,i,n){if(t){const o=e.map((e=>(0,h.S)(e))),s=(0,h.S)(t);return 1===e.length&&""===e[0]?[]:function(e,t,i,n){let o;t=t.toUpperCase();const s={};for(const i of e){if(!i)continue;const e=n(i.toUpperCase());for(;o=e.exec(t);)f(i,o,s)}const r=function(e,t){const i=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.push({offset:parseInt(n,10),word:e[n],propertyHit:t});return i.sort(((e,t)=>t.offset-e.offset))}(s,i);r.length&&function(e,t){let i=e[e.length-1].offset+e[e.length-1].word.length;for(let n=e.length-2;n>=0;n--){const o=e[n].offset+e[n].word.length-1;e[n].offset<i?o>i?e[n].offset<i&&(e[n].word=t.substring(i,e[n].offset+e[n].word.length),e[n].offset=i):e.splice(n,1):i=o}}(r,t);return r}(o,s,i,n||m)}return[]}function m(e){return new RegExp("(^|"+g+")"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"ig")}function f(e,t,i){var n;const o=(null===(n=t[1])||void 0===n?void 0:n.length)?t.index+t[1].length:t.index;(!i[o]||i[o].length<e.length)&&(i[o]=e)}var v=i(14253),_=i(52928),y=i(20394),I=i(35386),C=i(64875),S=i(3817),b=i(19728);const T=e=>!(void 0===e.isScopingEnabled&&void 0===e.showSeparator);function E(e,t,i){var n;return i?i.message:null!==(n=null==e?void 0:e.customizedEmptyECCSuggestionsString)&&void 0!==n?n:t("suggestionsGroupNoSuggestionsText")}function N(e,t,i,n){const o={clearSearchLabel:t("clearSearchLabel"),showAvailableSuggestionsLabel:t("showAvailableSuggestionsLabel"),somethingWentWrongLabel:t("somethingWentWrongLabel"),tryAgainLabel:t("tryAgainLabel"),suggestionsGroupSearchResultAccessibilityLabel:t("suggestionsGroupSearchResultAccessibilityLabel"),combineSentences:t("combineSentences"),newTagText:t("newTagText"),discoveryPromoFooterText:t("discoveryPromoFooterText"),emailSentBy:t("emailSentBy"),feedbackText:t("feedbackText"),meetingSeries:t("meetingSeries"),recordText:t("recordText"),tabAriaLabel:t("allTabAriaLabel"),overflowTabAriaLabel:t("overflowTabAriaLabel"),expandedInlineSuggestionsSearchBarPlaceholder:t("expandedInlineSuggestionsSearchBarPlaceholder"),startTypingToSearch:t("startTypingToSearch")},s={ignoreAll:i("ebx_ignoreAllButtonLabel"),ignoreOnce:i("ebx_ignoreOnceButtonLabel"),ignoreRule:i("ebx_disableCritiqueButton"),options:i("ebx_changeSettingsCommandLabel"),giveFeedbackButtonText:i("ebx_giveFeedback"),editorButtonTooltipContent:i("ebx_settingsButtonTooltip"),editorButtonText:i("editorButtonText")},r={suggestionsGroupNoSuggestionsText:E(e,t,n)};return Object.assign(Object.assign({},function(){const e=Array(),t={};for(const i of e)t[i]=e=>"";return t}()),{inlineSuggestions:e=>o[e]||"",common:e=>r[e]||"",critique:e=>s[e]||""})}const x=(0,S.PA)((e=>{var t,i,h,g,m,f,C,S,E,x;const{calloutProps:L,layerHostId:D,styles:F}=e,{calloutStrings:A,currentScope:R,enableExpandedECC:q,enableScopedHeader:P,expandedEccSearchBarConfig:O,getLocale:k,expandedECCHeader:z,inlineSuggestionsStrings:M,isDividerShown:W,isFeedbackEnabled:j,isFeedbackButtonEnabled:B,onFeedbackButtonClicked:U,isFlightEnabled:H,isLoading:V,isRtl:G,oaSettings:Q,onGroupSelected:K,onItemFocused:$,onItemSelected:J,onProcessedResults:Z,onUserInteraction:Y,queryString:X,resultReset:ee,suggestions:te,theme:ie,updateComposingBoxQuery:ne,handleKeyDown:oe,triggerMethod:se,appGptConfig:re,unsupportedEntities:ae,removeComposingBoxQuery:le}=L,de=null==ae?void 0:ae.find((e=>e.entityType===(null==R?void 0:R.entityType))),ce=null===(t=null==Q?void 0:Q.bestMatchConfig)||void 0===t?void 0:t.enabled,ue=null==Q?void 0:Q.enablePrefixHighlighting,he=new Map,ge=n.useRef([]),pe=[],me=n.useRef(z),[fe,ve]=n.useState(null);q&&(me.current=me.current.map((e=>{var t,i,n;return Object.assign(Object.assign({},e),{isSelected:!(null==R?void 0:R.entityType)&&!(null===(t=e.scopeInfo)||void 0===t?void 0:t.entityType)||(null==R?void 0:R.entityType)===(null===(i=e.scopeInfo)||void 0===i?void 0:i.entityType)||!R&&e.isSelected&&1===(null===(n=null==Q?void 0:Q.entitiesEnabled)||void 0===n?void 0:n.length)})})),me.current.length&&!me.current.some((e=>e.isSelected))&&(me.current=[Object.assign(Object.assign({},me.current[0]),{isSelected:!0}),...me.current.slice(1)]));let _e=!1;(0,b.runInAction)((()=>{var e,t,i,n,s,r,a;if(V)return;const l=te.slice().sort(((e,t)=>{var i,n;return(null!==(i=e.priority)&&void 0!==i?i:0)-(null!==(n=t.priority)&&void 0!==n?n:0)}));let d;for(const s of l)for(const[,r]of s.entities.entries()){_e=_e||r.entityType===o.c.PIM;const a=ce&&r.isBestMatch,h=a?"":null!==(e=s.groupTitle)&&void 0!==e?e:r.entityType===o.c.PIM?(0,c.X)(r.type,r.IntentId):(0,c.X)(r.type);if(r.icon&&(r.icon.iconName=(0,u.S)(r.icon.iconName)),r.entityType===o.c.People&&w(r,G),r.entityType===o.c.Scope&&(null===(t=r.scopeInfo)||void 0===t?void 0:t.entityType)&&r.scopeInfo.entityType!==o.c.External&&(r.title=(0,c.X)(r.scopeInfo.entityType)),ue&&!r.hitHighlightIndexes){const e=r[null!==(i=r.titleHitHighlightProperty)&&void 0!==i?i:"title"],t=r[null!==(n=r.subtitleHitHighlightProperty)&&void 0!==n?n:"subtitle"];r.hitHighlightIndexes=p([X],e,"title").concat(t?p([X],t,"subTitle"):[])}let g=he.get(h);if(!g)if(g=Object.assign(Object.assign(Object.assign({title:h,subtitle:s.groupSubtitle,suggestions:[]},(null==R?void 0:R.entityType)===l[0].entityType&&{isScoped:!0}),r.entityType===o.c.Scope&&{isScopingEnabled:!1,showSeparator:!0}),W&&{showSeparator:!0}),he.set(h,g),a)pe.unshift(g);else if(s.entityType===o.c.Scope)d=g;else{if(R&&R.entityType!==s.entityType)continue;if(!R&&(null==ae?void 0:ae.some((e=>e.entityType===s.entityType))))continue;pe.push(g)}g.suggestions.push(r)}if(d&&pe.push(d),null==Q?void 0:Q.preventAllTabBackfill){const e=!R,t=(null===(s=pe[0])||void 0===s?void 0:s.suggestions.length)>0;q&&e&&t&&pe.splice(1)}if(null==Q?void 0:Q.gptResultsLengthCap){"App"===(null===(r=pe[0])||void 0===r?void 0:r.title)&&(null===(a=pe[0])||void 0===a||a.suggestions.splice(Q.gptResultsLengthCap))}pe.length&&(pe[0].showSeparator=!1),Z()}));const ye=n.useCallback((()=>{Y()}),[Y]),Ie=n.useCallback(((e,t)=>{if(fe){if(O&&se!==v.P.AttachFile&&se!==v.P.Fre){const i=fe.querySelectorAll("input[type=search]");i.length>0&&e.target===i[0]&&(null==ne||ne(),0===i[0].value.length&&setTimeout((()=>{i[0].value=t||""}),100))}if(!q&&(0,_.m)(e.target)&&"BUTTON"!==e.target.nodeName&&"INPUT"!==e.target.nodeName){e.preventDefault();const t=e.relatedTarget;null==t||t.focus()}}}),[fe,q,O,se,ne]),[Ce,Se]=n.useState(!1),[be,Te]=n.useState(!1);n.useEffect((()=>{if(!fe)return;const e=fe.ownerDocument,t=fe.querySelectorAll("input[type=search]"),i=e.querySelectorAll('[data-ms-editor="true"]');O&&t.length>0&&i.length>0&&e.activeElement===i[0]&&(se===v.P.AttachFile||se===v.P.Fre?(null==le||le(t[0]),t[0].focus()):X?t[0].setAttribute("placeholder",X):t[0].setAttribute("placeholder",M("expandedInlineSuggestionsSearchBarPlaceholder")))}),[fe,O,M,X,le,se]),n.useEffect((()=>{var e;if(!fe)return;const t=null!==(e=fe.ownerDocument.defaultView)&&void 0!==e?e:window;function i(){Se(t.matchMedia("(max-width: 480px)").matches),Te(t.matchMedia("(max-height: 480px)").matches)}i();const n=new s.J(t);n.addListener("resize",i);const o=fe.closest(".ms-ecc-callout"),r=o&&new s.J(o);return null==r||r.addListener("keydown",oe),()=>{n.removeAllListeners(),null==r||r.removeAllListeners()}}),[fe,oe]);const Ee=H("mc-editor-expanded-ecc-responsive"),Ne=H("mc-editor-enable-meeting-banner");(ee||!V||pe.length)&&(ge.current=P?(e=>{if(e.length>0&&e.some(T))return e;const t=e.findIndex((e=>{var t;return(null===(t=e.suggestions[0])||void 0===t?void 0:t.type)===o.c.Scope}));return-1!==t?(e[t]=Object.assign(Object.assign({},e[t]),{isScopingEnabled:!1,showSeparator:!0}),e.concat(e.splice(t,1))):e})(pe):pe);const xe=M("managePersonalInfoLinkText"),we=M("managePersonalInfoLinkUrl"),Le=M("meetingBannerText"),De=null!==(i=null==k?void 0:k())&&void 0!==i?i:"en-US",Fe=Object.assign(Object.assign({},L),{keyboardHandlerTarget:q?void 0:L.keyboardHandlerTarget,expandedKeyboardHandlerTarget:q?L.keyboardHandlerTarget:void 0,enablePrefixHighlighting:ue,appGptConfig:re,layerHostId:D,onGroupSelected:K,onItemSelected:J,showDiscoveryPromoFooter:null==Q?void 0:Q.enableDiscoveryPromoFooter,strings:N(Q,M,A,de),styles:F,theme:ie}),Ae=n.useMemo((()=>(0,I.jI)()?"rtl":"ltr"),[]);return n.createElement("div",{ref:ve,onMouseEnter:ye,onFocus:e=>Ie(e,X)},q?n.createElement(l.q,{theme:L.fluentTheme,dir:Ae},n.createElement(r._,Object.assign({},Fe,{results:ge.current,scopes:{title:"",isScopingEnabled:!1,suggestions:me.current},onItemFocused:$,disableTooltips:!0,isFeedbackEnabledForEcc:j,isFeedbackButtonEnabled:B,onFeedbackButtonClicked:U,enableResponsiveLayout:Ee,isSmallWindow:Ee&&Ce,isSmallHeight:Ee&&be,enableMeetingBanner:Ne,showMeetingBanner:Ne&&(null==R?void 0:R.entityType)===o.c.Event,meetingBannerText:Le,isUnsupported:!!de,locale:De}))):n.createElement(a.x,Object.assign({},Fe,{results:ge.current,onFocus:$,enableScopedHeader:P,disableTooltips:null==Q?void 0:Q.disableInlineSuggestionTooltips})),_e?n.createElement("div",{style:{height:"32px",padding:"4px 12px"}},n.createElement("a",{href:we,target:"_blank",rel:"noreferrer","aria-label":xe,style:{textDecoration:"unset",color:"#0078D4",fontSize:12,lineHeight:"16px"}},xe)):null,n.createElement(d.b,{target:y.Y.inlineSuggestions,styles:{container:{borderRadius:{topStart:0,topEnd:0,bottomStart:null!==(g=null===(h=null==F?void 0:F.containerStyles)||void 0===h?void 0:h.borderRadius)&&void 0!==g?g:8,bottomEnd:null!==(f=null===(m=null==F?void 0:F.containerStyles)||void 0===m?void 0:m.borderRadius)&&void 0!==f?f:8},minWidth:null!==(S=null===(C=null==F?void 0:F.containerStyles)||void 0===C?void 0:C.minWidth)&&void 0!==S?S:300,maxWidth:null!==(x=null===(E=null==F?void 0:F.containerStyles)||void 0===E?void 0:E.maxWidth)&&void 0!==x?x:420}}}))}));function w(e,t){e.initials=(0,C.I)(e.displayName,t)}},66320:(e,t,i)=>{i.d(t,{b:()=>c});var n=i(745),o=i(41642),s=i(52215),r=i(39558),a=i(3817),l=i(8520);const d=(0,n.F5)({inlineSuggestionsCalloutStore:o.A.on(s.Z)}),c=(0,a.PA)((()=>{var e;const{inlineSuggestionsCalloutStore:t}=(0,n.KN)(d);return(null===(e=t.displayCallout)||void 0===e?void 0:e.targetLocation)?l.createElement(r.$,Object.assign({},t.displayCallout)):null}))},39558:(e,t,i)=>{i.d(t,{$:()=>h});var n=i(23182),o=i(8520),s=i(22628),r=i(96969),a=i(66549),l=i(2115),d=i(96606),c=i(56489),u=i(24033);const h=(0,i(51244).PA)((e=>{var t,i,h,g,p,m,f,v,_,y,I,C,S,b,T,E,N,x;const w=o.useContext(c.O1),{maxHeightCallback:L,targetLocation:D,popoverProps:F,isMobile:A}=e,{isLoading:R,isFlightEnabled:q,onDismissed:P,onFirstRender:O,onPreventDismissOnEvent:k,onRenderResults:z,onRestoreFocus:M,style:W,styles:j,theme:B}=e.calloutProps;let U=!0;const[H,V]=o.useState(!0);o.useEffect((()=>{O()}),[O]),o.useEffect((()=>{R||z()}),[R,z]);const G=o.useCallback((e=>{e&&"key"in e&&l.x.isKey(e,d.m.escape)&&(e.preventDefault(),e.stopPropagation()),e&&"focus"===e.type&&(U=!1),P(!1)}),[P]),Q=o.useCallback((e=>{if(!U)return;M(e,(()=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()}))}),[M,U]),K=j||{},{calloutStyles:$}=K,J=(0,n.__rest)(K,["calloutStyles"]),Z=J.containerStyles||{},Y=q("mc-editor-expanded-ecc-responsive"),X=null!==(g=null!==(i=null===(t=null==j?void 0:j.calloutStyles)||void 0===t?void 0:t.borderRadius)&&void 0!==i?i:null===(h=null==B?void 0:B.callout)||void 0===h?void 0:h.borderRadius)&&void 0!==g?g:8;if(!e.targetLocation)return null;const ee=null==L?void 0:L(e.targetLocation,null!==(p=e.targetWindow.deref())&&void 0!==p?p:window),te=null===(m=e.directionalHintCallback)||void 0===m?void 0:m.call(e,e.targetLocation,null!==(f=e.targetWindow.deref())&&void 0!==f?f:window,ee);let ie,ne="absolute";if(A&&(ne="fixed",ie=!0),w){const t=Y?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(S=null==B?void 0:B.callout)||void 0===S?void 0:S.width},$),i={popover:Object.assign(Object.assign({},F),{trapFocus:null===(b=null==F?void 0:F.trapFocus)||void 0===b||b,withArrow:null!==(E=null===(T=null==B?void 0:B.callout)||void 0===T?void 0:T.isBeakVisible)&&void 0!==E&&E,open:H,onOpenChange:(e,t)=>{!t.open&&(null==k?void 0:k(e))||(V(t.open),t.open||G())},positioning:Object.assign(Object.assign({},(0,u.Sg)(te,A)),{target:(0,u.ug)(D),strategy:ne,autoSize:ie})}),surface:{className:"ms-ecc-callout",style:Object.assign({padding:0,maxWidth:450,maxHeight:ee,overflow:"hidden",border:null===(N=null==B?void 0:B.callout)||void 0===N?void 0:N.border,boxShadow:null===(x=null==B?void 0:B.callout)||void 0===x?void 0:x.shadow},t)}};return o.createElement(r.v,Object.assign({},i),o.createElement(a.V,{calloutProps:e.calloutProps,styles:(null==W?void 0:W.fitToContent)||Z.maxHeight?Object.assign(Object.assign({},J),{containerStyles:Object.assign(Object.assign({},Z),{maxHeight:ee})}):J}))}return o.createElement(s.U,{className:"ms-ecc-callout",target:(0,u.KV)(D),shouldDismissOnWindowFocus:!1,onDismiss:G,preventDismissOnEvent:k,gapSpace:0,doNotLayer:!1,isBeakVisible:null!==(_=null===(v=null==B?void 0:B.callout)||void 0===v?void 0:v.isBeakVisible)&&void 0!==_&&_,directionalHint:te,alignTargetEdge:!0,onRestoreFocus:Q,calloutMaxHeight:ee,style:Y?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(y=null==B?void 0:B.callout)||void 0===y?void 0:y.width},$),styles:{beakCurtain:{borderRadius:X},calloutMain:{overflow:"hidden",border:null===(I=null==B?void 0:B.callout)||void 0===I?void 0:I.border,borderRadius:X,boxShadow:null===(C=null==B?void 0:B.callout)||void 0===C?void 0:C.shadow},root:{borderRadius:X,width:"fit-content",maxHeight:"none !important"}}},o.createElement(s.d.Consumer,null,(t=>o.createElement(a.V,{calloutProps:e.calloutProps,styles:(null==W?void 0:W.fitToContent)||Z.maxHeight?Object.assign(Object.assign({},J),{containerStyles:Object.assign(Object.assign({},Z),{maxHeight:ee})}):J,layerHostId:t}))))}))},34950:(e,t,i)=>{if(i.d(t,{B:()=>l}),2063!=i.j)var n=i(96984);if(2063!=i.j)var o=i(20394);if(2063!=i.j)var s=i(85793);if(2063!=i.j)var r=i(29851);if(2063!=i.j)var a=i(15275);class l{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918212)}configureRootServices(e){e.bind(o.D).to(n.o),e.bind(s.j).to(r.S)}}},52863:(e,t,i)=>{if(i.d(t,{u:()=>a}),2063!=i.j)var n=i(58040);if(2063!=i.j)var o=i(37428);if(2063!=i.j)var s=i(15275);if(2063!=i.j)var r=i(34471);class a{get uniqueId(){return(0,s.z)(507918230)}configureRootServices(e){e.bind(r.S).toExisting(o.I),e.bind(o.I).to(n.U)}}},6663:(e,t,i)=>{if(i.d(t,{Q:()=>l}),2063!=i.j)var n=i(58359);if(2063!=i.j)var o=i(66320);if(2063!=i.j)var s=i(58219);if(2063!=i.j)var r=i(41750);if(2063!=i.j)var a=i(15275);class l{constructor(){this.imports=[s.N,r.h]}get uniqueId(){return(0,a.z)(507918216)}configureRootServices(e){e.bind(n.i).toValue(o.b)}}},10068:(e,t,i)=>{if(i.d(t,{B:()=>u}),2063!=i.j)var n=i(5662);if(2063!=i.j)var o=i(44246);if(2063!=i.j)var s=i(91289);if(2063!=i.j)var r=i(30256);if(2063!=i.j)var a=i(15275);if(2063!=i.j)var l=i(34471);if(2063!=i.j)var d=i(86196);if(2063!=i.j)var c=i(4281);class u{constructor(){this.imports=[o.d,n.w]}get uniqueId(){return(0,a.z)(507918222)}configureRootServices(e){e.bind(s.Y).toSelf(),e.bind(l.S).toExisting(s.Y),e.bind(r.o).to(r.X),e.bind(d.q).to(c.L),e.bind(l.S).toExisting(d.q)}}},41317:(e,t,i)=>{i.d(t,{R:()=>h});var n=i(745),o=i(41642),s=i(85793),r=i(7433),a=i(19685),l=i(65438),d=i(3817),c=i(8520);const u=(0,n.F5)({multilingualStore:o.A.on(s.j),critiqueCalloutStateStore:o.A.on(r.v),localizer:o.A.on(a.H)}),h=(0,d.PA)((e=>{var t;const{theme:i,style:o}=e,{critiqueCalloutStateStore:s,multilingualStore:r,localizer:a}=(0,n.KN)(u);return c.createElement("div",{style:Object.assign({color:null!==(t=null==i?void 0:i.textColor)&&void 0!==t?t:"#323130"},o)},c.createElement("div",{style:{marginBottom:8}},c.createElement("b",null,a.getMessage("multilingualFRE_HeadingText"))),a.getMessage("multilingualFRE_DescriptionText")," ",c.createElement("br",null),c.createElement(l.N,{style:{fontSize:12},onClick:()=>{s.hide(),r.showEditorSettings()},"aria-label":a.getMessage("multilingualFRE_DescriptionButtonLinkAriaLabel"),"data-is-focusable":!0},a.getMessage("multilingualFRE_DescriptionButtonLink")))}))},29851:(e,t,i)=>{i.d(t,{S:()=>c});var n=i(23182),o=i(8520),s=i(20394),r=i(41317),a=i(29906),l=i(83010);const d="multilingualProofingFre";let c=class{constructor(e){this.footerFreStore=e}addMultilingualProofingFre(){this.footerFreStore.addFooterPage(s.Y.critique,d,{icon:"LocaleLanguage",content:(e,t)=>o.createElement(r.R,{style:e,theme:t})})}removeMultilingualProofingFre(){this.footerFreStore.removeFooterPage(s.Y.critique,d)}setOnShowEditorSettings(e){this._onShowEditorSettings=e}showEditorSettings(){this._onShowEditorSettings&&this._onShowEditorSettings(!0)}};c=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(s.D))],c)},55844:(e,t,i)=>{i.d(t,{_:()=>S});var n=i(745),o=i(41642),s=i(26876),r=i(8520),a=i(42119),l=i(20889),d=i(22628),c=i(96969),u=i(98647),h=i(24033),g=i(56489),p=i(20845),m=i(2115),f=i(96606),v=i(3817);const _=5e3,y=(0,n.F5)({styleStore:o.A.on(g.UC).optional(),themeStore:o.A.on(g.YQ).optional()}),I=(0,v.PA)((e=>{var t,i,o,s,v,I,C,S,b;const T=r.useContext(g.O1),{styleStore:E,themeStore:N}=(0,n.KN)(y),{nudge:x,nudgeDisplayLocation:w,nudgeTargetDocumentRef:L,onAcceptNudgeAction:D,onHideNudge:F,inlineNudge:A,insertionCharacter:R}=e,[q,P]=r.useState(!1),[O,k]=r.useState(!0),z=r.useRef(void 0),M=r.useCallback((e=>{window.clearTimeout(z.current),z.current=e}),[z]),W=r.useCallback(((e,t)=>{window.clearTimeout(z.current),F(e,t)}),[F,z]),j=r.useCallback((()=>{window.clearTimeout(z.current),P(!0)}),[P,z]),B=r.useCallback((()=>{M(window.setTimeout((()=>{W("timeout 5000")}),_)),P(!1)}),[W,M,P]),U=r.useCallback((()=>D("click",!0)),[D]);r.useEffect((()=>(M(window.setTimeout((()=>{W("timeout 5000")}),_)),()=>{window.clearTimeout(z.current)})),[]);const H=r.useCallback((e=>{m.x.isKey(e,f.m.escape)?(e.stopPropagation(),e.preventDefault(),W(e.key)):m.x.isKey(e,f.m.enter)||m.x.isKey(e,f.m.backspace)?W(e.key):m.x.isKey(e,"v",void 0,!0)?W("user pasted text",!0):(m.x.isKey(e,f.m.tab)||e.key===R)&&(e.stopPropagation(),e.preventDefault(),D(e.key,!0))}),[W,x.entityType,D]),V=r.useCallback((()=>{W("MouseDown")}),[W]),G=r.useCallback((()=>{W("Scroll")}),[W]),Q=r.useCallback((()=>{W("Resize")}),[W]);r.useEffect((()=>{var e,t;const i=null!==(t=null===(e=L.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window,n=new u.J(L),o=new u.J(i);return n.addListener("keydown",H,{capture:!0}),n.addListener("mouseup",V),o.addListener("resize",Q),o.addListener("scroll",G,{capture:!0}),()=>{n.removeAllListeners(),o.removeAllListeners()}}),[H,V,G,Q,L]);const K=null==E?void 0:E.getComponentStyle(A?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName),$=null==N?void 0:N.getComponentActiveTheme(A?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName),J=x.entityResults?(0,l.S)(null!==(i=null===(t=x.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:""):void 0,Z=null!==(o=null==K?void 0:K.borderRadius)&&void 0!==o?o:A?4:15,Y=null!==(s=null==K?void 0:K.fontSize)&&void 0!==s?s:"10pt",X=null==K?void 0:K.fontWeight,ee=null!==(v=null==K?void 0:K.paddingTop)&&void 0!==v?v:2,te=null!==(I=null==K?void 0:K.paddingBottom)&&void 0!==I?I:2,ie=null!==(C=null==K?void 0:K.paddingLeftRight)&&void 0!==C?C:8,ne=null==K?void 0:K.lineHeight,oe=A?a.A.rightTopEdge:a.A.bottomCenter,se=A?"none":null==K?void 0:K.boxShadow,re=x.text.split(/(@|\/)/g),ae=A?{align:"center",position:"after",offset:e=>({mainAxis:1})}:{align:"center",position:"below",offset:e=>({mainAxis:8})},le=r.createElement("div",{style:{borderRadius:Z,display:"flex",cursor:"pointer"}},J?r.createElement("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8}},r.createElement(p.In,{type:J,style:{width:void 0,height:void 0},primaryColor:q&&null!==(S=null==$?void 0:$.text.hover)&&void 0!==S?S:null==$?void 0:$.text.resting,fontSize:void 0})):void 0,r.createElement("span",{className:"ms-nudge-text",style:{color:q&&null!==(b=null==$?void 0:$.text.hover)&&void 0!==b?b:null==$?void 0:$.text.resting,fontSize:Y,fontWeight:X,paddingTop:ee,paddingBottom:te,paddingLeft:ie,paddingRight:ie,textDecoration:"none",userSelect:"none",lineHeight:ne}},re.map((e=>{var t,i,n,o;return"@"===e||"/"===e?r.createElement("span",{key:e,style:Object.assign({backgroundColor:q&&null!==(t=null==$?void 0:$.background.hover)&&void 0!==t?t:null==$?void 0:$.background.resting,color:q&&null!==(i=null==$?void 0:$.text.hover)&&void 0!==i?i:null==$?void 0:$.text.resting,paddingLeft:null===(n=null==K?void 0:K.highlightStyle)||void 0===n?void 0:n.paddingLeftRight,paddingRight:null===(o=null==K?void 0:K.highlightStyle)||void 0===o?void 0:o.paddingLeftRight},null==K?void 0:K.highlightStyle)},e):r.createElement("span",{key:e},e)}))));if(T||A){const e={popover:{trapFocus:!0,withArrow:!1,open:O,onOpenChange:(e,t)=>{k(t.open)},positioning:Object.assign({target:(0,h.ug)(w)},ae)},surface:{className:"ms-ecc-callout",style:{padding:0,overflowY:"hidden",borderRadius:Z,backgroundColor:q?null==$?void 0:$.background.hover:null==$?void 0:$.background.resting,boxShadow:se,cursor:"pointer"}}};return r.createElement("div",{role:"button",tabIndex:-1,onMouseOver:j,onMouseLeave:B,onMouseUp:U,onFocus:j,onBlur:B},r.createElement(c.v,Object.assign({},e),le))}return r.createElement(d.U,{target:w,directionalHint:oe,isBeakVisible:!1,gapSpace:8,onMouseOver:j,onMouseLeave:B,onMouseUp:U,style:{overflowY:"hidden"},styles:{root:{borderRadius:Z,boxShadow:se,cursor:"pointer"},calloutMain:{borderRadius:Z,backgroundColor:q?null==$?void 0:$.background.hover:null==$?void 0:$.background.resting}}},le)})),C=(0,n.F5)({nudgeStateStore:o.A.on(s.V)}),S=(0,v.PA)((()=>{const{nudgeStateStore:e}=(0,n.KN)(C);return e.nudge&&e.nudgeDisplayLocation&&e.nudgeTargetDocumentRef?r.createElement(I,{nudge:e.nudge,inlineNudge:e.enableInlineNudge,insertionCharacter:e.insertionCharacter,nudgeTargetDocumentRef:e.nudgeTargetDocumentRef,nudgeDisplayLocation:e.nudgeDisplayLocation,onAcceptNudgeAction:(t,i)=>{e.onNudgeAccepted(t,i)},onHideNudge:(t,i)=>{e.onNudgeDismiss(t,i)}}):null}))},44858:(e,t,i)=>{i.d(t,{I:()=>r});var n=i(88179);const o="combobox";var s=i(8520);const r=s.memo((e=>{const{children:t,predictionDisplayText:i,shouldShowInsertionHelperText:r,showDropdownChevron:a,localizer:l,isMobile:d,onTextMayOverlapLine:c,onDropdownOpened:u,leftPadding:h,parentElement:g,showIconWithMultipleComponents:p}=e,m=s.useRef(null),f=s.useRef(null),v=s.useCallback((()=>{a&&m.current&&u(m.current)}),[m,u,a]),_=s.useCallback((e=>{"Tab"===e.code&&a&&m.current&&u(m.current)}),[m,u,a]);s.useEffect((()=>{if(!f.current)return;let e=0;const t=f.current.getClientRects();1!==t.length&&(e+=t.length-1),c(e)}));const y=parseInt(window.getComputedStyle(g).fontSize,10);return s.createElement(s.Fragment,null,s.createElement("span",{className:"ms-entity-prediction-wrapper",style:{marginLeft:h?h+"px":void 0},ref:m,onClick:v,onKeyDown:_,role:o},"",(!a||p)&&s.createElement("span",{className:"ms-entity-prediction-icon"},t),s.createElement("span",{id:"textPrediction",className:"ms-entity-prediction",contentEditable:!1,ref:f},i),a?s.createElement("span",{className:"ms-entity-prediction-dropdown"},s.createElement(n.yuG,{style:{width:y-4,height:y-4}})):s.createElement(s.Fragment,null),""),r?s.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"",l.getMessage(d?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),""):s.createElement(s.Fragment,null))}))},21044:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(44858),o=i(20845),s=i(83846),r=i(8520);const a=r.memo((e=>{var t,i;const{prediction:a,parentElement:l}=e,d=parseInt(window.getComputedStyle(l).fontSize,10),c=null!==(i=null===(t=a.entityResults.entities[0].FileExtension)||void 0===t?void 0:t.toLocaleLowerCase())&&void 0!==i?i:"",u=Object.prototype.hasOwnProperty.call(s.L,c)?s.L[c].iconType:"Cloud";return r.createElement(n.I,Object.assign({},e,{showDropdownChevron:a.entityResults.entities.length>1}),r.createElement(o.In,{type:u,style:{width:d,height:d},fontSize:d}))}))},11914:(e,t,i)=>{i.d(t,{R8:()=>a,Tc:()=>n,Vn:()=>s,XG:()=>r,r7:()=>o});const n=(0,i(17298).f)("IPredictionStateStore"),o=0,s=2063!=i.j?-1:null,r=2063!=i.j?-2:null;var a;!function(e){e[e.NotSeen=0]="NotSeen",e[e.TypeNotMatchingCharacter=1]="TypeNotMatchingCharacter",e[e.ExplicitRejection=2]="ExplicitRejection",e[e.ImplicitRejection=3]="ImplicitRejection"}(a||(a={}))},87960:(e,t,i)=>{i.d(t,{N:()=>a});var n=i(44858),o=i(20845),s=i(20889),r=i(8520);const a=r.memo((e=>{var t,i;const{prediction:a,parentElement:l}=e,d=parseInt(window.getComputedStyle(l).fontSize,10),c=(0,s.S)(null!==(i=null===(t=a.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"");return r.createElement(n.I,Object.assign({},e,{showDropdownChevron:a.entityResults.entities.length>1}),r.createElement(o.In,{type:null!=c?c:"Cloud",style:{width:d,height:d},fontSize:d}))}))},48123:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(44858),o=i(29618),s=i(8520);const r=s.memo((e=>{const{prediction:t,parentElement:i}=e,r=parseInt(window.getComputedStyle(i).fontSize,10);return s.createElement(n.I,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1,showIconWithMultipleComponents:!0}),s.createElement(o.c,{coinSize:r,text:"",imageUrl:t.entityResults.entities[0].imageUrl,imageInitials:t.entityResults.entities[0].imageInitials}))}))},44090:(e,t,i)=>{i.d(t,{X:()=>s});var n=i(44858),o=i(8520);const s=o.memo((e=>{const{prediction:t}=e;return o.createElement(n.I,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1}))}))},78388:(e,t,i)=>{i.d(t,{p:()=>m});var n=i(23182),o=i(53353),s=i(14945),r=i(88241),a=i(8628),l=i(99724),d=i(3661);var c=i(11914),u=i(94610),h=i(83817),g=i(29906),p=i(81174);let m=class{constructor(e,t,i,n,l,d,h,g,p,m,f,v){this._localizer=e,this._hostSettings=t,this._logger=i,this._oaLogger=n,this._predictionStore=l,this._proofingDom=d,this._paragraphTextExtractor=h,this._tileContent=g,this._hostEmitter=p,this._inlineSuggestionStore=m,this._inlineSuggestionsRenderer=f,this._nudgeStore=v,this._isActivelyAddingWrappingNewLines=!1,this._predictionUpdate=0,this._multiPredictionMenuOpen=!1,this.supportsPredictionType=e=>e===o.c.Text||e===o.c.PIM||e===o.c.Topic||this.isEntityPrediction(e),this.isEntityPrediction=e=>e===o.c.File||e===o.c.People||e===o.c.Loop||e===o.c.PIM,this.getPredictionFirstItem=e=>e.entityResults&&e.entityResults.entities[0],this.onPredictionUpdatedInternal=async()=>{var e,t,i,n,o,s,r,a;const l=this._predictionStore.getCurrentPrediction();if(l){if(this.isPredictionDisabledForEntityType(null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions,l.entityType))return void await this._predictionStore.clearPrediction();if((null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.shouldRenderPrediction)&&!this._hostSettings.serviceSettings.predictions.shouldRenderPrediction(l))return void await this._predictionStore.clearPrediction();if(void 0!==(null===(n=this._inlineSuggestionsRenderer)||void 0===n?void 0:n.getCurrentMenuInfo())&&!l.isHelperText)return void(this._multiPredictionMenuOpen||(this._prediction?await this.clearCurrentPrediction(l,"ECC open",c.R8.ImplicitRejection):await this._predictionStore.clearPrediction()));if(this.isEntityPrediction(l.entityType)){if(!(null===(s=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===s?void 0:s.onInsertEntityPrediction)||!this._inlineSuggestionStore||!this._inlineSuggestionsRenderer)return void await this._predictionStore.clearPrediction();if(!await this.prepareEntityPredictions(l))return void await this._predictionStore.clearPrediction()}if((null===(r=this._prediction)||void 0===r?void 0:r.context)&&l.context&&l.context+l.text===this._prediction.context+this._prediction.text&&l.context.startsWith(this._prediction.context))return;(null===(a=this._nudgeStore)||void 0===a?void 0:a.getCurrentNudge())&&await this._nudgeStore.clearNudge()}await this.onPredictionUpdated()},this.prepareEntityPredictions=async e=>{var t,i,n;if(e.entityType===o.c.People){if(e.entityResults){if((null===(t=e.context)||void 0===t?void 0:t.endsWith(e.text))||(null===(i=e.context)||void 0===i?void 0:i.endsWith(e.text+" ")))return!1;for(const t of e.entityResults.entities){const e=await(null===(n=this._inlineSuggestionStore)||void 0===n?void 0:n.convertPeopleSuggestionToInlineSuggestion(t));t.imageUrl=null==e?void 0:e.imageUrl,t.imageInitials=null==e?void 0:e.initials}}}else e.shouldDismissOnTextChange=!0;return!0},this.checkIfEntityPredictionContextIsValid=(e,t,i)=>(e.entityType===o.c.People&&e.entityResults&&(t.endsWith(" ")||this.prepareEntityPredictionForTextUpdate(e,t)),!0),this.prepareEntityPredictionForTextUpdate=(e,t)=>{var i;if(e.entityType===o.c.People){if(null===(i=e.entityResults)||void 0===i?void 0:i.entities){const i=t.substring(e.startIndex);for(const t of e.entityResults.entities)if(t.text.startsWith(i)){e.text=t.text;break}}e.entityResults=void 0}},this.onEntityDropdownOpened=(e,t)=>{var i;if(!this._prediction)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no prediction was available");let n=[];const s=this._prediction.entityType;if(s===o.c.File)n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:o.c.File,text:e.FileName}))),entityType:this._prediction.entityType}];else if(s===o.c.People){const e=this._prediction;if(!e.entityResults)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no people prediction items were available");n=[{entities:e.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:o.c.People,text:e.DisplayName}))),entityType:this._prediction.entityType}]}else s===o.c.Loop?n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:o.c.Loop,text:e.text}))),entityType:this._prediction.entityType}]:s===o.c.PIM&&(n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:o.c.PIM}))),entityType:this._prediction.entityType}]);this._multiPredictionMenuOpen=!0,null===(i=this._inlineSuggestionsRenderer)||void 0===i||i.showEntityPrediction(this._prediction.tileId,this._prediction.startIndex,n,this.onApplyEntityPrediction,this.onIgnoreEntityPrediction,(()=>{this._multiPredictionMenuOpen=!1}),t.getBoundingClientRect())},this.onApplyEntityPrediction=e=>{this.applyCurrentPrediction(c.Vn,e)},this.onIgnoreEntityPrediction=async()=>{this._prediction?await this.clearCurrentPrediction(this._prediction,"User ignored prediction",c.R8.ExplicitRejection):this._oaLogger.logDiagnostics("Entity prediction dropdown ignore once clicked, but no prediction was available")},this.handleTextTile=e=>{if(this._prediction&&e.message.messageType===s.G.RemoveData){const t=e.message.data.tileId;this._prediction.tileId!==t&&this._proofingDom.findParagraphNode(this._prediction.tileId)||this.clearCurrentPrediction(this._prediction,"tile removed",c.R8.ImplicitRejection)}},this.hostModelVisualStateChange=e=>{if(this._prediction&&e.message.created&&this._prediction.tileId===e.message.tileId){const e=this._predictionUpdate+1;this._predictionUpdate=e,this.determineIfPredictionIsValidAndApply(this._prediction,e)}},this.handleDelta=e=>{var t,i;const n=e.message;if(n.sourceType===r.p.TileNode)return;if(this._isActivelyAddingWrappingNewLines)return;if(!n.delta||!this._prediction)return void(this.lastPredictedTile&&n.tileId!==this.lastPredictedTile.id&&(this.lastPredictedTile=void 0));if(n.delta.deltaType===u.WI.Add&&!n.delta.content)return;if(n.delta.deltaType===u.WI.Update&&!n.delta.content&&!n.delta.length)return;if(n.delta.deltaType===u.WI.Update&&(n.delta.unit===u.OD.Sentence||n.delta.unit===u.OD.Paragraph)&&"\n"===n.delta.content&&0===n.delta.position)return;if((n.delta.unit===u.OD.Sentence||n.delta.unit===u.OD.Paragraph)&&(n.delta.deltaType===u.WI.Add||n.delta.deltaType===u.WI.Update)&&(null!==(i=null===(t=n.delta.content)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>1)return;const o=this._predictionUpdate+1;this._predictionUpdate=o,this.determineIfPredictionIsValidAndApply(this._prediction,o,this._predictionDisplayText,n.tileId,n.changeType,n.delta,n.deletedOrReplacedCharacters)},this.trimLineEnding=e=>e&&"\n"===e[e.length-1]?e.substring(0,e.length-1):e,this.logDisplayedTelemetry=e=>{var t,i;e.isFromAugLoop&&((null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.onPredictionDisplayed)&&this._hostSettings.serviceSettings.predictions.onPredictionDisplayed(e),this._oaLogger.logActivity("OAPredictionDisplayed",void 0,this.getBasePredictionLogFields(e)))},this.logAcceptedTelemetry=(e,t,i,n,o)=>{var s,r;e.isFromAugLoop&&((null===(r=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.predictions)||void 0===r?void 0:r.onPredictionAccepted)&&this._hostSettings.serviceSettings.predictions.onPredictionAccepted(e,t,i),this._oaLogger.logActivity("OAPredictionApplied",void 0,[...this.getBasePredictionLogFields(e),(0,a.n)("charactersTyped",t),(0,a.n)("acceptedViaUserAction",i),(0,a.n)("keyPressedForAccept",n),(0,a.n)("acceptanceTime",(new Date).toISOString()),(0,a.n)("isOpeningECCForEntityPrediction",o)]))},this.logDismissedTelemetry=(e,t,i)=>{var n,o;e.isFromAugLoop&&((null===(o=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===o?void 0:o.onPredictionDismissed)&&this._hostSettings.serviceSettings.predictions.onPredictionDismissed(e,e.currentEndIndex?e.currentEndIndex-e.startIndex:0,t),void 0!==this._prediction&&this._oaLogger.logActivity("OAPredictionDismissed",void 0,[...this.getBasePredictionLogFields(e),(0,a.n)("charactersTyped",e.currentEndIndex?e.currentEndIndex-e.startIndex:0),(0,a.n)("dismissalReason",t),(0,a.n)("dismissalType",i),(0,a.n)("rejectionTime",(new Date).toISOString())]))},this._predictionStore.setOnUpdatedPrediction(this.onPredictionUpdatedInternal)}get prediction(){return this._prediction}get predictionDisplayText(){return this._predictionDisplayText}get predictionDisplayLocation(){return this._predictionDisplayLocation}get predictionParentElement(){return this._predictionParentElement}get predictionContentEditableParentElement(){return this._predictionContentEditableParentElement}get multiPredictionMenuOpen(){return this._multiPredictionMenuOpen}get predictionFirstDisplayedTime(){return this._predictionFirstDisplayedTime}get localizer(){return this._localizer}async initialize(){this._hostEmitter.on(l.pD.hostModelDelta,this.handleDelta),this._hostEmitter.on(l.pD.hostModelTextTile,this.handleTextTile),this._hostEmitter.on(l.pD.hostModelVisualStateChange,this.hostModelVisualStateChange)}shutDown(){this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0}setOnUpdate(e){this._onUpdate=e}async clearCurrentPrediction(e,t,i){this.logDismissedTelemetry(e,t,i),await this._predictionStore.clearPrediction()}isPredictionDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}async handleRemotePredictionUpdate(e,t,i,n){var o,s,r,a,l;if(e.tileId!==i)return;const d=null!==(o=n.position)&&void 0!==o?o:0,h=e.startIndex+t.length;if(d>=e.startIndex&&d<h)await this.clearCurrentPrediction(e,"remote edit dismissed",c.R8.ImplicitRejection);else{const t=n.deltaType===u.WI.Add?null!==(r=null===(s=n.content)||void 0===s?void 0:s.length)&&void 0!==r?r:0:n.deltaType===u.WI.Delete?-1*n.length:n.deltaType===u.WI.Update?(null!==(l=null===(a=n.content)||void 0===a?void 0:a.length)&&void 0!==l?l:0)-n.length:0,i=this._predictionUpdate+1;this._predictionUpdate=i,await this.determineIfPredictionIsValidAndApply(Object.assign(Object.assign({},e),{startIndex:e.startIndex+t}),i)}}determineIfPredictionTextIsValid(e,t,i){var n,s,r,a,l,g,m,f,v;const _=this._proofingDom.findParagraphNode(e.tileId),y=this.trimLineEnding(this._paragraphTextExtractor.getParagraphText(_)),I=null!==(s=null===(n=this.lastPredictedTile)||void 0===n?void 0:n.predictionContext.length)&&void 0!==s?s:0;if(e.entityType===o.c.Loop&&e.tileId===(null===(r=this.lastPredictedTile)||void 0===r?void 0:r.id)&&e.entityType===this.lastPredictedTile.predictionType&&(null!==(l=null===(a=e.context)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>I+3)return{result:!1};if(t&&e.shouldDismissOnTextChange)return{result:!1};const C=null!==(g=null==t?void 0:t.position)&&void 0!==g?g:0;if(y&&(0,p.l)(_)){const n=y.substring(e.startIndex);t&&this.isEntityPrediction(e.entityType)&&this.prepareEntityPredictionForTextUpdate(e,y);const o=(e.context?e.context.substring(0,e.startIndex):y.substring(0,e.startIndex))+e.text;let s=0;for(let o=0;o<e.text.length;o++){const r=e.text.charAt(o),a=(null==t?void 0:t.deltaType)===u.WI.Delete?1:0;if(o>=n.length||t&&o+e.startIndex>C-a)break;if(t&&t.deltaType===u.WI.Delete&&o+e.startIndex===C-a&&i&&1===i.length&&r===i)break;if(r===n.charAt(o))s++;else{if(!this.allowMiddleOfSentencePredictions()){if(e.shouldDismissOnTextChange)break;return{result:!1}}if(!t)break;if(t.deltaType!==u.WI.Add||!t.content||!(t.content===n.charAt(o)||d.Yv(t.content.charCodeAt(0))&&d.Yv(n.charCodeAt(o))))return{result:!1}}}const r=y.substring(0,e.startIndex+s);if(e.currentEndIndex&&e.currentEndIndex>r.length&&(!t||t.deltaType!==u.WI.Delete||C<e.startIndex))return{result:!1};if(e.currentEndIndex=r.length,e.entityResults&&!this.checkIfEntityPredictionContextIsValid(e,y,s))return{result:!1};if(o.startsWith(r)&&r!==o){const t=r.length,i=this._tileContent.getContainingElement(_);if(!i)return{result:!1,dueToMissingContainingHTMLElement:!0};const n=null!==(m=(0,h.m)(i))&&void 0!==m?m:i;return(null===(f=this.lastPredictedTile)||void 0===f?void 0:f.id)!==e.tileId&&(this.lastPredictedTile={id:e.tileId,predictionType:e.entityType,predictionContext:null!==(v=e.context)&&void 0!==v?v:""}),{paragraphNode:_,paragraphNodeOffset:_.element.offset,insertableTextStart:t,htmlParentElement:i,contentEditableHtmlParentElement:n,predictionText:o}}if(r===o)return this.logAcceptedTelemetry(e,e.text.length,!1,c.r7,!!e.entityResults),{result:!1,dueToEntirePredictionTyped:!0}}return{result:!1}}getBasePredictionLogFields(e){const t=[(0,a.n)("predictionTextLength",e.text.length),(0,a.n)("entityType",e.entityType)];return void 0!==this._predictionFirstDisplayedTime&&t.push((0,a.n)("firstDisplayedTime",this._predictionFirstDisplayedTime.toISOString())),t}};m=(0,n.__decorate)([(0,g._)()],m)},24911:(e,t,i)=>{i.d(t,{J:()=>l});var n=i(56489),o=i(3817),s=i(36733);var r=i(35869),a=i(8520);const l=(0,o.PA)((e=>{const{hostSettings:t,themeStore:i}=e,o=(0,r.ZY)(),l=(e=>{var t,i,n;return`\n  .ms-text-prediction {\n    color: ${null==e?void 0:e.text};\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-ghost-text {\n    color: ${null!==(t=null==e?void 0:e.text)&&void 0!==t?t:s.L.colorNeutralForeground4};\n    position: relative;\n    user-select: none;\n    background: ${null!==(i=null==e?void 0:e.highlightColor)&&void 0!==i?i:s.L.colorNeutralBackground5};\n  }\n\n  .ms-entity-prediction {\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-entity-prediction-wrapper {\n    background: ${null==e?void 0:e.background.resting};\n    color: ${null==e?void 0:e.entityText.resting};\n    border-radius: 4px;\n    padding: 0px 4px;\n    gap: 4px;\n    user-select: none;\n    display: inline-flex;\n    pointer-events: all;\n    cursor: pointer;\n  }\n\n  .ms-entity-prediction-wrapper:hover {\n    background: ${null==e?void 0:e.background.hover};\n    color: ${null==e?void 0:e.entityText.hover};\n  }\n\n  .ms-prediction-tab-hint {\n    align-content: center;\n    border-color: ${null!==(n=null==e?void 0:e.tabBorder)&&void 0!==n?n:null==e?void 0:e.text};\n    border-radius: 2px;\n    border-style: solid;\n    border-width: 1px;\n    box-sizing: border-box;\n    color: ${null==e?void 0:e.tabText};\n    display: inline-grid;\n    font-size: 0.630em;\n    height: 1.5em;\n    margin-left: 4px;\n    padding: 1px 4px;\n    position: relative;\n    vertical-align: 10%;\n    white-space: nowrap;\n    width: 2.5em;\n  }\n\n  .ms-entity-prediction-icon {\n    align-self: center\n  }\n\n  .ms-entity-prediction-dropdown {\n    align-self: center\n  }\n  `})(null==i?void 0:i.getComponentActiveTheme(n.yF.predictionContainerComponentName));return a.useEffect((()=>{if(!t.disableInlineStyleTagInCanvas||!o||!l)return;const e=o.getElementById("ms-prediction-style");if(null===e){const e=o.createElement("style");e.type="text/css",e.id="ms-prediction-style",e.appendChild(o.createTextNode(l)),o.head.appendChild(e)}else e.innerText=l}),[t,o,l]),t.disableInlineStyleTagInCanvas?null:a.createElement("style",{type:"text/css"},l)}))},84938:(e,t,i)=>{if(i.d(t,{r:()=>u}),2063!=i.j)var n=i(53353);if(2063!=i.j)var o=i(21044);if(2063!=i.j)var s=i(87960);if(2063!=i.j)var r=i(48123);if(2063!=i.j)var a=i(44090);if(2063!=i.j)var l=i(40166);if(2063!=i.j)var d=i(67735);var c=i(8520);function u(e,t,i,u,h,g,p,m,f,v,_){return c.createElement(l.K,{rtl:i.isRtl()},function(e,t,i,l,u,h,g,p,m,f){var v,_,y,I,C,S,b;return i.entityType===n.c.File&&i.entityResults&&l?c.createElement(o.Z,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(v=i.shouldShowInsertionHelperText)||void 0===v||v,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):i.entityType===n.c.People&&i.entityResults&&l?c.createElement(r.m,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(_=i.shouldShowInsertionHelperText)||void 0===_||_,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):i.entityType===n.c.Loop&&i.entityResults&&l?c.createElement(s.N,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(y=i.shouldShowInsertionHelperText)||void 0===y||y,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):i.entityType===n.c.PIM&&l&&m&&(null!==(C=null===(I=i.entityResults)||void 0===I?void 0:I.entities.length)&&void 0!==C?C:0)>1?c.createElement(a.X,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(S=i.shouldShowInsertionHelperText)||void 0===S||S,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:g,onDropdownOpened:h}):[n.c.Text,n.c.People,n.c.PIM,n.c.Topic].includes(i.entityType)&&l?c.createElement(d.Y,{predictionDisplayText:l,shouldShowInsertionHelperText:null===(b=i.shouldShowInsertionHelperText)||void 0===b||b,isPIMPrediction:i.entityType===n.c.PIM,leftPadding:p,localizer:e,isMobile:t,onTextMayOverlapLine:g,onDropdownOpened:h,isHelperText:i.isHelperText,appName:f}):c.createElement(c.Fragment,null)}(e,t,u,h,g,p,m,f,v,_))}},67735:(e,t,i)=>{i.d(t,{Y:()=>s});var n=i(8520);const o="textPrediction",s=n.memo((e=>{const{predictionDisplayText:t,shouldShowInsertionHelperText:i,isPIMPrediction:s,isMobile:r,localizer:a,onTextMayOverlapLine:l,leftPadding:d,onDropdownOpened:c,isHelperText:u,appName:h}=e,g=t.split(" "),p=n.useRef({}),m=n.useCallback((()=>{s&&p.current[0]&&c(p.current[0])}),[c]);if(n.useEffect((()=>{if(!p.current[0]||!p.current[g.length-1])return;let e=0,t=0;for(let i=0;i<g.length;i++){if(!p.current[i])continue;const n=0===i,o=i===g.length-1,s=p.current[i].getBoundingClientRect();if(n?e=s.top:s.top!==e&&(t++,e=s.top),o){const e=p.current[i].getClientRects();1!==e.length&&(t+=e.length-1)}}l(t)})),!g)return n.createElement(n.Fragment,null);const f=["BingAtWork","BizChat"].some((e=>null==h?void 0:h.includes(e)))&&u;return n.createElement(n.Fragment,null,g.map(((e,t,s)=>{const l=0===t,c=t+1===s.length,u=e+(c?"":" ");return n.createElement("span",{key:`${o}-${t}`,id:`${o}-${t}`,className:f?"ms-ghost-text":"ms-text-prediction",style:{paddingLeft:l&&d?d+"px":void 0,whiteSpace:c&&i?"nowrap":void 0,borderRadius:l&&f?"4px 0 0 4px":t===s.length-2?"0 4px 4px 0":void 0},contentEditable:!1,ref:e=>{p.current[t]=e},onMouseOver:m,onFocus:m},"",u,"",c&&i?n.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"",a.getMessage(r?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),""):n.createElement(n.Fragment,null))})))}))},50150:(e,t,i)=>{i.d(t,{l:()=>j});var n=i(23182),o=i(88241),s=i(36915),r=i(19685),a=i(33767),l=i(37053),d=i(15661),c=i(99724),u=i(48662),h=i(28798),g=i(86196),p=i(87753),m=i(29906),f=i(83010),v=i(27603),_=i(54058),y=i(14253),I=i(28853),C=i(30256),S=i(61595),b=i(33727),T=i(10968),E=i(78426),N=i(56489),x=i(53353),w=i(98647),L=i(2115),D=i(96606),F=i(11914),A=i(24911),R=i(52928),q=i(84938),P=i(8520);const O=P.memo((e=>{var t,i,n,o,s,r,a;const{hostSettings:l,isMobile:d,languageScriptDirectionDetector:c,predictionStateStore:u,themeStore:h}=e,g=u.predictionContentEditableParentElement,p=P.createRef(),[m,f]=P.useState(u.prediction),[v,_]=P.useState(u.predictionDisplayText),y=P.useCallback((()=>{u.prediction&&u.predictionDisplayText&&(f(u.prediction),_(u.predictionDisplayText))}),[u.prediction,u.predictionDisplayText]);P.useEffect((()=>(u.setOnUpdate(y),()=>{u.setOnUpdate(void 0)})),[u,y]);const I=P.useCallback((e=>{u.onEntityDropdownOpened(m,e)}),[u,m]),C=P.useCallback((async e=>{var t,i,n;L.x.isKey(e,D.m.tab)?(e.stopPropagation(),e.preventDefault(),(null===(t=u.prediction)||void 0===t?void 0:t.entityResults)&&u.prediction.entityResults.entities.length>1&&(u.prediction.entityType!==x.c.PIM||(null===(n=null===(i=l.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.enablePimMultiPredict))?p.current&&I(p.current):await u.applyCurrentPrediction(e.keyCode)):L.x.isKey(e,[D.m.arrowLeft,D.m.arrowRight,D.m.escape])?await u.clearCurrentPrediction(m,"invalid key press",F.R8.ExplicitRejection):L.x.isKey(e,[D.m.arrowUp,D.m.arrowDown,D.m.enter])&&(u.multiPredictionMenuOpen||await u.clearCurrentPrediction(m,"invalid key press",F.R8.ExplicitRejection))}),[null===(i=null===(t=l.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.enablePimMultiPredict,I,m,u,p]),S=P.useCallback((async e=>{e.preventDefault(),e.stopPropagation(),d&&await u.applyCurrentPrediction(F.XG)}),[d,u]),b=P.useCallback((async e=>{if(!p.current)return;let t=Array.from(p.current.getClientRects());t=t.map((e=>{return t=e,new DOMRect(t.x-k,t.y-z,t.width+k+k,t.height+z+z);var t})),t.find((t=>{return i=t,n=e.pageX,o=e.pageY,i.x<=n&&n<=i.x+i.width&&i.y<=o&&o<=i.y+i.height;var i,n,o}))&&(e.preventDefault(),e.stopPropagation(),await u.applyCurrentPrediction(F.XG))}),[p,u]),T=P.useCallback((async e=>{m.isHelperText&&((0,R.m)(e.target)||(0,R.m)(e.relatedTarget))||u.multiPredictionMenuOpen||await u.clearCurrentPrediction(m,"lost focus",F.R8.ImplicitRejection)}),[m,u]),E=P.useCallback((async()=>{await u.isInputPointerAtPrediction()||await u.clearCurrentPrediction(m,"input pointer not at prediction",F.R8.ImplicitRejection)}),[m,u]);P.useEffect((()=>{const e={passive:!0,capture:!0},t=g&&new w.J(g),i=new w.J(document);return null==t||t.addListener("keydown",C),null==t||t.addListener("focusout",T,e),i.addListener("selectionchange",E,e),()=>{null==t||t.removeAllListeners(),i.removeAllListeners()}}),[g,C,T,E]),P.useEffect((()=>{if(!p.current)return;const e=new w.J(p.current),t=new w.J(document);return e.addListener("pointerdown",S,{capture:!0}),d&&t.addListener("pointerdown",b,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[b,S,d,p]),P.useEffect((()=>{var e,t,i;null===(i=null===(t=null===(e=l.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onPredictionUpdate)||void 0===i||i.call(t)}),[null===(n=l.serviceSettings)||void 0===n?void 0:n.predictions,v]);const N=P.useCallback((e=>Promise.resolve()),[]);return g?P.createElement("span",{className:"suggestedCompletion",ref:p},P.createElement(A.J,{hostSettings:l,themeStore:h}),(0,q.r)(u.localizer,d,c,m,v,u.predictionParentElement,I,N,m.isHelperText&&"BizChat"===(null===(o=l.hostMetadata)||void 0===o?void 0:o.appName)?4:void 0,null===(r=null===(s=l.serviceSettings)||void 0===s?void 0:s.predictions)||void 0===r?void 0:r.enablePimMultiPredict,null===(a=l.hostMetadata)||void 0===a?void 0:a.appName)):null}));const k=20,z=20;var M=i(78388),W=i(94329);let j=class extends M.p{constructor(e,t,i,n,o,s,r,a,l,d,c,u,h,g,p,m,f,v){super(e,t,i,n,o,s,r,a,l,d,c,m),this._ariaStatusStateStoreFactory=u,this._featureFlagsReader=h,this._themeStore=g,this.languageScriptDirectionDetector=p,this.compositionEventHandler=f,this._isMobile=v,this.shutDown=()=>{this._predictionHTMLElement=void 0,super.shutDown()},this.isInputPointerAtPrediction=async()=>{var e;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const t=await this._tileContent.getTextSelection();return!!t&&(!!this._prediction&&(t.startPosition===t.endPosition&&(null===(e=t.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&t.endPositionInParagraphNode===this._prediction.currentEndIndex))},this.predictionMayOverlapNextLine=e=>Promise.resolve()}allowMiddleOfSentencePredictions(){var e,t,i;return null!==(i=null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.allowMiddleOfSentencePredictions)&&void 0!==i&&i}async applyCurrentPrediction(e,t){var i,n,o;if(!this._prediction)return;const s=this._prediction;if(s.isHelperText)return;const r=this.determineIfPredictionTextIsValid(s);if("result"in r)return void await this.clearCurrentPrediction(s,"invalid application",F.R8.ImplicitRejection);const{paragraphNode:a,paragraphNodeOffset:l,insertableTextStart:d,predictionText:c}=r,u=c.substring(d);let h;if(h=this.isEntityPrediction(s.entityType)&&s.entityResults&&d!==s.startIndex?await this._tileContent.getRangeOfNode(a.parent,void 0,l+s.startIndex,d-s.startIndex):await this._tileContent.getNodeInsertionPosition(a.parent,l+d,!0),await this._predictionStore.clearPrediction(),this.isEntityPrediction(s.entityType)&&s.entityResults){const e=null!=t?t:this.getPredictionFirstItem(s);e&&h&&(null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(s,e,h,a.parent.element)}else await this._tileContent.insert(a.parent,void 0,l+d,u,!0,h,!1,!1),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(o=this._ariaStatusStateStoreFactory())||void 0===o||o.setStatus(this._localizer.getMessage("ebx_PredictionAppliedMessage",u),"assertive",!1));this.logAcceptedTelemetry(s,d-s.startIndex,!0,e,!!s.entityResults)}async onPredictionUpdated(){var e,t;const i=this._predictionUpdate+1;this._predictionUpdate=i;const n=this._predictionStore.getCurrentPrediction();if(n)await this.determineIfPredictionIsValidAndApply(n,i);else{const i=this._predictionHTMLElement,n=this._predictionParentElement;if(this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionFirstDisplayedTime=void 0,this._predictionHTMLElement=void 0,i)if(W.unmountComponentAtNode(i),null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onDomRemoval)this._hostSettings.serviceSettings.predictions.onDomRemoval(i,n);else{const e=i.parentElement;i.remove(),e&&"div"===e.nodeName.toLowerCase()&&!e.textContent&&0===e.childElementCount&&e.appendChild(document.createElement("br"))}this._onUpdate&&this._onUpdate()}}async determineIfPredictionIsValidAndApply(e,t,i,n,r,a,l){var d,c,u,h,g,p;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,F.R8.NotSeen);if(void 0!==r&&r!==o.Q.Local&&a&&n&&i)return void await this.handleRemotePredictionUpdate(e,i,n,a);if(n&&n!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",F.R8.ExplicitRejection);const m=this.determineIfPredictionTextIsValid(e,a,l);if("result"in m){if(m.dueToMissingContainingHTMLElement)return;return void(m.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",F.R8.TypeNotMatchingCharacter))}const{insertableTextStart:f,htmlParentElement:v,contentEditableHtmlParentElement:_,predictionText:y}=m;if(this._prediction=e,this._predictionParentElement=v,this._predictionContentEditableParentElement=_,y.substring(f)!==this._predictionDisplayText){if(this._predictionDisplayText=y.substring(f),!this._predictionHTMLElement){if(null===(d=this.compositionEventHandler)||void 0===d?void 0:d.isComposing)return void(this._predictionHTMLElement=void 0);if(this._predictionHTMLElement=v.ownerDocument.createElement("span"),this._predictionHTMLElement.contentEditable="false",this._predictionHTMLElement.classList.add("ms-prediction"),null===(c=this.compositionEventHandler)||void 0===c?void 0:c.isComposing)return void(this._predictionHTMLElement=void 0);if(t<this._predictionUpdate)return;const i=this._predictionHTMLElement.ownerDocument.getSelection(),n=1===(null==i?void 0:i.rangeCount)?i.getRangeAt(0):void 0;if(!n)return this._logger.log(524882904,s.q.Warn,"Unable to find range of prediction text insertion point in PredictionStateStore."),void await this.clearCurrentPrediction(e,"unable to determine range for prediction",F.R8.NotSeen);{const t=P.createElement(O,{predictionStateStore:this,themeStore:this._themeStore,isMobile:null!==(u=this._isMobile)&&void 0!==u&&u,hostSettings:this._hostSettings,languageScriptDirectionDetector:this.languageScriptDirectionDetector});if(W.render(t,this._predictionHTMLElement),null===(g=null===(h=this._hostSettings.serviceSettings)||void 0===h?void 0:h.predictions)||void 0===g?void 0:g.onDomInsertion){if(!this._hostSettings.serviceSettings.predictions.onDomInsertion(n,this._predictionHTMLElement,v))return void await this.clearCurrentPrediction(e,"host unable to insert prediction",F.R8.NotSeen)}else n.insertNode(this._predictionHTMLElement),i&&i.setBaseAndExtent(n.startContainer,n.startOffset,n.startContainer,n.startOffset)}this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(p=this._ariaStatusStateStoreFactory())||void 0===p||p.setStatus(this._localizer.getMessage(this._isMobile?"ebx_MobilePredictionAvailableMessage":"ebx_PredictionAvailableMessage",e.text),"assertive",!1))}this._onUpdate&&this._onUpdate()}}};j=(0,n.__decorate)([(0,m._)(),(0,n.__param)(0,(0,f.W)(r.H)),(0,n.__param)(1,(0,f.W)(a.n)),(0,n.__param)(2,(0,f.W)(l.g)),(0,n.__param)(3,(0,f.W)(d.m)),(0,n.__param)(4,(0,f.W)(C.o)),(0,n.__param)(5,(0,f.W)(b.w)),(0,n.__param)(6,(0,f.W)(T.b)),(0,n.__param)(7,(0,f.W)(E.d)),(0,n.__param)(8,(0,f.W)(c.M5)),(0,n.__param)(9,(0,v.l)()),(0,n.__param)(9,(0,f.W)(_.I)),(0,n.__param)(10,(0,v.l)()),(0,n.__param)(10,(0,f.W)(y.V)),(0,n.__param)(11,(0,f.W)(I.Th)),(0,n.__param)(12,(0,f.W)(u.c)),(0,n.__param)(13,(0,f.W)(N.YQ)),(0,n.__param)(14,(0,f.W)(h.iw)),(0,n.__param)(15,(0,v.l)()),(0,n.__param)(15,(0,f.W)(S.Y)),(0,n.__param)(16,(0,v.l)()),(0,n.__param)(16,(0,f.W)(g.q)),(0,n.__param)(17,(0,v.l)()),(0,n.__param)(17,(0,f.W)(p.n))],j)},63497:(e,t,i)=>{i.d(t,{q:()=>N});var n=i(745),o=i(41642),s=i(11914),r=i(19685),a=i(33767),l=i(28798),d=i(22910),c=i(87753),u=i(98647),h=i(56489),g=i(2115),p=i(96606),m=i(51921),f=i(24911);const v=(e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let i=e.parentElement,n=window.getComputedStyle(i);for(;i&&"relative"!==n.position&&i!==document.body;)i=i.parentElement,n=window.getComputedStyle(i);return i},_=()=>!0;var y=i(84938),I=i(8520),C=i(75210);const S=(0,n.F5)({predictionStateStore:o.A.on(s.Tc),localizer:o.A.on(r.H),themeStore:o.A.on(h.YQ).optional(),hostSettings:o.A.on(a.n),languageScriptDirectionDetector:o.A.on(l.iw),safeWindow:o.A.on(d.j),isMobile:o.A.on(c.n).optional()}),b=I.memo((e=>{var t;const{prediction:i,predictionDisplayText:o,targetLocation:r,onApplyCurrentPrediction:a,onClearCurrentPrediction:l,isInputPointerAtPrediction:d,onCurrentPredictionMayOverlapNextLine:c,onEntityDropdownOpened:h,predictionContentEditableParentElement:b,predictionParentElement:T}=e,{hostSettings:E,isMobile:N,languageScriptDirectionDetector:x,localizer:w,predictionStateStore:L,themeStore:D,safeWindow:F}=(0,n.KN)(S),A=I.useRef(null),R=I.useRef(null),q=I.useRef(),P=I.useRef({top:0,left:0}),[O,k]=I.useState({zIndex:"auto",element:void 0,shouldRender:()=>!0,shouldRenderPrediction:()=>!0,shouldObserveSize:()=>[],addHandlers:()=>()=>null,predictionInlineStyles:()=>{},transformPredictionRects:e=>e,getForbiddenRects:()=>[]}),[z,M]=I.useState(!1),[W,j]=I.useState({container:{},overlay:{},anchorStyle:{position:"static"}}),B=Object.assign(Object.assign({},W.overlay),{zIndex:null!==(t=O.zIndex)&&void 0!==t?t:W.overlay.zIndex}),U=I.useCallback((()=>{const e=b.scrollLeft,t=b.scrollTop;A.current&&(A.current.scrollLeft=e,A.current.scrollTop=t)}),[b.scrollLeft,b.scrollTop]),H=I.useCallback((e=>F.requestAnimationFrame(e)),[F]),V=I.useCallback((()=>{const e=(0,m.dB)(b,R.current,P),t=(0,m.Cf)(b);P.current={top:e.top,left:e.left},j((()=>(U(),M(!0),{container:e,overlay:t.overlay,anchorStyle:t.anchor})))}),[b,U]),G=I.useCallback((()=>{H(V)}),[H,V]),Q=()=>(setTimeout((()=>{G(),b.dispatchEvent(new Event("BX-ForceReflow",{bubbles:!0}))}),500),!0),K=()=>{H(U)},$=async e=>{g.x.isKey(e,p.m.tab)?(e.stopPropagation(),e.preventDefault(),await a(e.keyCode)):g.x.isKey(e,[p.m.arrowLeft,p.m.arrowUp,p.m.arrowRight,p.m.arrowDown,p.m.enter,p.m.escape])&&await l("invalid key press",s.R8.ExplicitRejection)},J=async e=>{e.preventDefault(),e.stopPropagation(),N&&await a(s.XG)},Z=()=>{setTimeout((async()=>{L.multiPredictionMenuOpen||await l("lost focus",s.R8.ImplicitRejection)}),100)},Y=()=>{F.requestIdleCallback((async()=>{await X()}),100)},X=async()=>{await d()||await l("input pointer not at prediction",s.R8.ImplicitRejection)};I.useEffect((()=>{G()}),[G]),I.useEffect((()=>{k(((e,t,i=!0)=>{var n;const o=_,s=_,r=()=>[],a=()=>()=>null,l=()=>{},d=e=>e,c=()=>[];return"body"!==e.tagName.toLowerCase()&&e.parentElement?{element:i?v(e,t):e.parentElement,zIndex:void 0,shouldRender:o,shouldRenderPrediction:s,shouldObserveSize:r,addHandlers:a,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:c}:{element:null!==(n=e.parentElement)&&void 0!==n?n:window.document.body,zIndex:"auto",shouldRender:o,shouldRenderPrediction:s,shouldObserveSize:r,addHandlers:a,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:c}})(b,W.anchorStyle.position))}),[W.anchorStyle.position,b]),I.useEffect((()=>{const e={passive:!0,capture:!0},t=new u.J(window),i=new u.J(document),n=new u.J(b);t.addListener("resize",G,e),t.addListener("hashchange",Q,e),t.addListener("popstate",Q,e),i.addListener("mouseup",Q,e),i.addListener("selectionchange",Y,e),n.addListener("paste",Q,e),n.addListener("scroll",K,e),n.addListener("keydown",$),n.addListener("focusout",Z,e),(()=>{if(!q.current&&window.ResizeObserver&&(Q(),q.current=new window.ResizeObserver((()=>{G()}))),q.current){q.current.observe(b);for(const e of O.shouldObserveSize(b))q.current.observe(e)}})();const o=O.addHandlers(b,{queueUpdateOverlay:G,updateOverlayAndNotifyInput:Q});return()=>{t.removeAllListeners(),i.removeAllListeners(),n.removeAllListeners(),q.current&&q.current.disconnect(),o()}}),[]),I.useEffect((()=>{if(!R.current)return;const e=new u.J(R.current);return e.addListener("mousedown",J),()=>{e.removeAllListeners()}}),[R,J]);const ee=I.useCallback((async e=>{await c(e)}),[c]),te=I.useCallback((e=>{h(e)}),[h]),ie=window.getComputedStyle(b),ne=parseInt(ie.paddingLeft,10),oe=parseInt(ie.paddingTop,10),se=(r.x,r.y-oe);return O.element?I.createElement(C.Ay.div,{className:"ms-editor-text-prediction"},I.createElement(f.J,{hostSettings:E,themeStore:D}),I.createElement("div",{ref:R,style:W.container},I.createElement("div",{id:"ms-editor-text-prediction-overlay",style:B,className:"hc-noadjust"},I.createElement("div",{style:{paddingTop:se+"px"}}),z&&(0,y.r)(w,null!=N&&N,x,i,o,T,te,ee,ne)))):null}));var T=i(3817);const E=(0,n.F5)({predictionStateStore:o.A.on(s.Tc)}),N=(0,T.PA)((()=>{const{predictionStateStore:e}=(0,n.KN)(E),[t,i]=I.useState(),[o,s]=I.useState(),r=()=>{i(e.prediction),s(e.predictionDisplayText)};I.useEffect((()=>(e.setOnUpdate(r),()=>{e.setOnUpdate(void 0)})),[e]);const a=I.useCallback((async t=>{await e.applyCurrentPrediction(t)}),[]),l=I.useCallback((async(t,i)=>{e.prediction&&await e.clearCurrentPrediction(e.prediction,t,i)}),[]),d=I.useCallback((async()=>e.isInputPointerAtPrediction()),[]),c=I.useCallback((async t=>{await e.predictionMayOverlapNextLine(t)}),[]),u=I.useCallback((i=>{e.onEntityDropdownOpened(t,i)}),[]);return t&&e.prediction&&e.predictionDisplayLocation&&e.predictionParentElement&&e.predictionContentEditableParentElement?I.createElement(b,{prediction:t,predictionDisplayText:o,targetLocation:e.predictionDisplayLocation,predictionContentEditableParentElement:e.predictionContentEditableParentElement,predictionParentElement:e.predictionParentElement,onApplyCurrentPrediction:a,onClearCurrentPrediction:l,isInputPointerAtPrediction:d,onCurrentPredictionMayOverlapNextLine:c,onEntityDropdownOpened:u}):null}))},53384:(e,t,i)=>{i.d(t,{O:()=>T});var n=i(23182),o=i(88241),s=i(71632),r=i(19685),a=i(33767),l=i(37053),d=i(15661),c=i(99724),u=i(29906),h=i(83010),g=i(27603),p=i(53353),m=i(54058),f=i(14253),v=i(30256),_=i(61595),y=i(33727),I=i(10968),C=i(78426),S=i(11914),b=i(78388);let T=class extends b.p{constructor(e,t,i,n,o,s,r,a,l,d,c,u){super(e,t,i,n,o,s,r,l,a,d,c,u),this._predictionHasWrappedOntoNewLineCount=0,this.isInputPointerAtPrediction=async()=>{var e,t;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const i=await this._tileContent.getTextSelection();return!!i&&(!!this._prediction&&(i.startPosition===i.endPosition&&(null===(e=i.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&i.endPositionInParagraphNode===(null===(t=i.endParagraphNode)||void 0===t?void 0:t.element).span-(void 0===this.getNextParagraphAfterPrediction()?0:1)))},this.removeWrappingNewLines=async()=>{var e;const t=this.getNextParagraphAfterPrediction();(null===(e=null==t?void 0:t.parent)||void 0===e?void 0:e.element)&&t.element&&0!==this._predictionHasWrappedOntoNewLineCount&&await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount)},this.insertNewLines=async(e,t,i)=>{let n="";for(let e=0;e<i;e++)n+="\n";this._isActivelyAddingWrappingNewLines=!0,await this._tileContent.insert(e,void 0,t,n,!1,void 0,!0,!1),this._isActivelyAddingWrappingNewLines=!1},this.removeNewLines=async(e,t,i)=>{this._isActivelyAddingWrappingNewLines=!0;for(let n=0;n<i;n++)await this._tileContent.remove(e,void 0,t-1,1,!1,void 0,!0,!1);this._isActivelyAddingWrappingNewLines=!1},this.getNextParagraphAfterPrediction=()=>{var e;if(this._prediction){const t=this._proofingDom.findParagraphNode(this._prediction.tileId);if((null==t?void 0:t.parent)&&t.element&&"offset"in t.element){const i=t.element.offset+t.element.span;let n;return null===(e=t.parent.children)||void 0===e||e.forEach((e=>{e.element&&"offset"in e.element&&e.element.offset>=i&&(!n||n.element&&e.element.offset<n.element.offset)&&(n=e)})),n}}}}allowMiddleOfSentencePredictions(){return!1}async applyCurrentPrediction(e,t){var i,n;if(!this._prediction)return;const o=this._prediction,s=this.determineIfPredictionTextIsValid(o);if("result"in s)return void await this.clearCurrentPrediction(o,"invalid application",S.R8.ImplicitRejection);const{paragraphNode:r,paragraphNodeOffset:a,insertableTextStart:l,predictionText:d}=s,c=d.substring(l);this._predictionHasWrappedOntoNewLineAtStartOfTile&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0);const u=await this._tileContent.getNodeInsertionPosition(r.parent,a+l,!0);if(await this._predictionStore.clearPrediction(),this.isEntityPrediction(o.entityType)){const e=null!=t?t:this.getPredictionFirstItem(o);e&&u&&(null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(o,e,u,r.parent.element)}else r.parent&&await this._tileContent.insert(r.parent,void 0,a+l,c,!0,u,!1,!1);this.logAcceptedTelemetry(o,l-o.startIndex,!0,e,!!o.entityResults)}async predictionMayOverlapNextLine(e){var t,i,n;if(!this._prediction||this._prediction.entityType!==p.c.File&&this._prediction.entityType!==p.c.People){if(this._predictionHasWrappedOntoNewLineAtStartOfTile){if(e>this._predictionHasWrappedOntoNewLineCount){const i=this.getNextParagraphAfterPrediction();(null===(t=null==i?void 0:i.parent)||void 0===t?void 0:t.element)&&i.element&&(await this.insertNewLines(i.parent,i.element.offset,e-this._predictionHasWrappedOntoNewLineCount),this._predictionHasWrappedOntoNewLineAtStartOfTile=i.id,this._predictionHasWrappedOntoNewLineCount=e)}else if(e<this._predictionHasWrappedOntoNewLineCount){const t=this.getNextParagraphAfterPrediction();(null===(i=null==t?void 0:t.parent)||void 0===i?void 0:i.element)&&t.element&&(await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount-e),this._predictionHasWrappedOntoNewLineCount=e)}}else if(0!==e){const t=this.getNextParagraphAfterPrediction();(null===(n=null==t?void 0:t.parent)||void 0===n?void 0:n.element)&&t.element&&(this._predictionHasWrappedOntoNewLineAtStartOfTile=t.id,this._predictionHasWrappedOntoNewLineCount=e,await this.insertNewLines(t.parent,t.element.offset,e))}}else 0!==e&&await this.clearCurrentPrediction(this._prediction,"Entity cannot wrap",S.R8.NotSeen)}async onPredictionUpdated(){const e=this._predictionUpdate+1;this._predictionUpdate=e;const t=this._predictionStore.getCurrentPrediction();t?await this.determineIfPredictionIsValidAndApply(t,e):(this._predictionHasWrappedOntoNewLineAtStartOfTile&&await this.removeWrappingNewLines(),this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionDisplayLocation=void 0,this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0,this._predictionFirstDisplayedTime=void 0,this._onUpdate&&this._onUpdate())}async determineIfPredictionIsValidAndApply(e,t,i,n,r,a,l){var d;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,S.R8.NotSeen);if(void 0!==r&&r!==o.Q.Local&&a&&n&&i)return void await this.handleRemotePredictionUpdate(e,i,n,a);if(n&&n!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",S.R8.ExplicitRejection);const c=this.determineIfPredictionTextIsValid(e,a,l);if("result"in c){if(c.dueToMissingContainingHTMLElement)return;return void(c.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",S.R8.ExplicitRejection))}const{paragraphNode:u,paragraphNodeOffset:h,insertableTextStart:g,htmlParentElement:p,contentEditableHtmlParentElement:m,predictionText:f}=c,v=this._paragraphTextExtractor.getParagraphText(e.tileId),_=await this._tileContent.getRangeOfNode(u.parent,void 0,h+g-1,1),y=null==_?void 0:_.commonAncestorContainer.parentElement;if(_&&y){const i=_.getBoundingClientRect(),n=p.getBoundingClientRect();let o=0;if((0,s.C)(y,"HTMLElement")){const e=y.getBoundingClientRect(),t=new Range;t.setStart(y,0),t.setEnd(y,1);o=t.getBoundingClientRect().top-e.top}if(this._predictionHasWrappedOntoNewLineAtStartOfTile&&(null===(d=this.prediction)||void 0===d?void 0:d.annotationId)!==e.annotationId&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0),t<this._predictionUpdate)return;if(v!==this._paragraphTextExtractor.getParagraphText(e.tileId)){this._predictionDisplayText=void 0;const t=this._predictionUpdate+1;return this._predictionUpdate=t,void await this.determineIfPredictionIsValidAndApply(e,t)}const r=void 0===this._prediction;if(this._prediction=e,this._predictionParentElement=p,this._predictionContentEditableParentElement=m,this._predictionDisplayLocation={x:i.right-n.left,y:i.top-o-n.top},f.substring(g)===this._predictionDisplayText)return;this._predictionDisplayText=f.substring(g),r&&(this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e)),this._onUpdate&&this._onUpdate()}else await this.clearCurrentPrediction(e,"unable to determine range for prediction",S.R8.NotSeen)}};T=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,h.W)(r.H)),(0,n.__param)(1,(0,h.W)(a.n)),(0,n.__param)(2,(0,h.W)(l.g)),(0,n.__param)(3,(0,h.W)(d.m)),(0,n.__param)(4,(0,h.W)(v.o)),(0,n.__param)(5,(0,h.W)(y.w)),(0,n.__param)(6,(0,h.W)(I.b)),(0,n.__param)(7,(0,h.W)(c.M5)),(0,n.__param)(8,(0,h.W)(C.d)),(0,n.__param)(9,(0,g.l)()),(0,n.__param)(9,(0,h.W)(m.I)),(0,n.__param)(10,(0,g.l)()),(0,n.__param)(10,(0,h.W)(f.V)),(0,n.__param)(11,(0,g.l)()),(0,n.__param)(11,(0,h.W)(_.Y))],T)},71758:(e,t,i)=>{if(i.r(t),i.d(t,{CritiqueCallout:()=>n.r,CritiqueCalloutStateStore:()=>o.b,FOOTER_FRE_PAGE_ID:()=>c.Id,FocusZoneId:()=>s.u,FooterFre:()=>g.b,FooterFreModule:()=>y.B,FooterFreStore:()=>h.o,HTMLElementContextualMenuEventHandler:()=>l.U,HTMLElementContextualMenuModule:()=>_.u,IContextualMenuEventHandler:()=>d.I,IPredictionStateStore:()=>T.Tc,InlineSuggestions:()=>m.V,InlineSuggestionsCalloutPortal:()=>f.b,InlineSuggestionsWebUXModule:()=>I.Q,InlineSuggestionsWithCallout:()=>v.$,InsertionPredictionStateStore:()=>E.l,LanguageAutoDetectionFRE:()=>u.a,LanguageAutoDetectionFRECallout:()=>c.sy,LayeredPrediction:()=>N.q,LayeredPredictionStateStore:()=>x.O,MultilingualFre:()=>S.R,MultilingualFreStore:()=>b.S,NudgeCallout:()=>w._,PredictionCoreModule:()=>C.B,PredictionDismissalReason:()=>T.R8,UndoCallout:()=>r.$,UndoCalloutStateStore:()=>a.f,UndoQuerySelectorClass:()=>a.g,critiqueCalloutDeps:()=>n.h,getEccUxReplacement:()=>p.Nt,getEccUxReplacementUX:()=>p.cu,langAutoDetectFooterId:()=>c.lP,undoCalloutDeps:()=>r.v}),2063!=i.j)var n=i(91099);if(2063!=i.j)var o=i(78743);if(2063!=i.j)var s=i(41614);if(2063!=i.j)var r=i(48686);if(2063!=i.j)var a=i(17932);if(2063!=i.j)var l=i(58040);if(2063!=i.j)var d=i(37428);if(2063!=i.j)var c=i(90553);if(2063!=i.j)var u=i(73224);if(2063!=i.j)var h=i(96984);if(2063!=i.j)var g=i(4405);if(2063!=i.j)var p=i(87320);if(2063!=i.j)var m=i(66549);if(2063!=i.j)var f=i(66320);if(2063!=i.j)var v=i(39558);if(2063!=i.j)var _=i(52863);if(2063!=i.j)var y=i(34950);if(2063!=i.j)var I=i(6663);if(2063!=i.j)var C=i(10068);if(2063!=i.j)var S=i(41317);if(2063!=i.j)var b=i(29851);if(2063!=i.j)var T=i(11914);if(2063!=i.j)var E=i(50150);if(2063!=i.j)var N=i(63497);if(2063!=i.j)var x=i(53384);if(2063!=i.j)var w=i(55844)},18261:(e,t,i)=>{i.d(t,{YS:()=>p,vr:()=>g,Xf:()=>h});var n=i(19728);const o=(e,t)=>0===e.localeCompare(t,[],{sensitivity:"base"}),s=(e,t)=>{if(o(e,"Grammar")||o(e,"Spelling"))return[];const i=[];return t.forEach((e=>{(e=>{const t=["en","es","de","fr"];for(const i of t)if(o(i,e))return!0;return!1})(e)&&i.push(e.toLocaleUpperCase())})),t.length===i.length?[]:i};const r=(0,n.action)(((e,t)=>{e.count=Math.max(0,t),0===e.count&&(e.isCritiqueSelected=!1)})),a=(0,n.action)(((e,t)=>{e.isCritiqueSelected=t})),l=(0,n.action)(((e,t)=>{e.multilingualTagsStore.languageTags=(0,n.observable)(s(e.category,t))})),d=(0,n.action)(((e,t)=>{e.isProofingDisabled=void 0!==e.id&&t.includes(e.id)})),c=((0,n.action)(((e,t,i)=>{const n=e.proofingItems.get(t);n&&r(n,i)})),(0,n.action)(((e,t,i)=>{const n=e.proofingItems.get(t);n&&a(n,i)}))),u=(0,n.action)((e=>{e.proofingItems.forEach((e=>{a(e,!1)}))})),h=((0,n.action)(((e,t,i)=>{u(e),c(e,t,i)})),(0,n.action)(((e,t)=>{e.proofingItems.forEach((e=>{l(e,t)}))})),(0,n.action)(((e,t)=>{e.proofingItems.forEach((e=>{d(e,t)}))})),(0,n.action)(((e,t)=>{const i=e.proofingItems.get(t);i&&r(i,i.count+1)}))),g=(0,n.action)(((e,t)=>{const i=e.proofingItems.get(t);i&&r(i,i.count>0?i.count-1:0)})),p=(0,n.action)((e=>{e.proofingItems.forEach((e=>{r(e,0)}))}))},76750:(e,t,i)=>{if(i.d(t,{kd:()=>o}),2063!=i.j)var n=i(21592);function o(e,t){if(t)return t.OnCanvasCalloutStrings[e];return(0,n.$)().getString("OnCanvasCalloutStrings",e)}},21592:(e,t,i)=>{i.d(t,{$:()=>s,Y:()=>o});const n=(()=>{const e=(()=>{if("undefined"==typeof globalThis){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window}return globalThis})();return void 0===e.Office&&(e.Office={}),void 0===e.Office.Editor&&(e.Office.Editor={}),e})().Office.Editor;function o(e){n.stringProvider=e}function s(){return n.stringProvider}},42768:(e,t,i)=>{var n;i.d(t,{h:()=>n}),function(e){e.Undefined="Undefined",e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.FeatureSuppression="FeatureSuppression",e.Acronyms="Acronyms",e.AtAGlance="AtAGlance",e.BxPromo="BxPromo",e.ContentCreation="ContentCreation",e.CritiqueUpsell="CritiqueUpsell",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.PremiumSquigglesPreview="PremiumSquigglesPreview",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview",e.TonalRewriteFre="TonalRewriteFre",e.WritersUnblock="WritersUnblock",e.AIFeedback="AIFeedback"}(n||(n={}))},36915:(e,t,i)=>{var n;i.d(t,{q:()=>n}),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(n||(n={}))},57099:(e,t,i)=>{if(i.d(t,{C:()=>s}),2063!=i.j)var n=i(54756);var o=i(58651);class s{constructor(e){this._loggerSettings=e}logData(e){this._loggerSettings.logToConsole&&o.log((0,n.v)(e))}}},1416:(e,t,i)=>{i.d(t,{V:()=>c});var n=i(60150),o=i(58728),s=i(51199),r=i(41066),a=i(42768),l=i(36915),d=i(54756);class c{constructor(e,t,i=!1,o=new n.M){this.kpisEnabled=i,this._oTelTelemetryLogger=o;const{logGroupName:s,tenant:r}=e,{tenantName:a,ariaTenantToken:l,nexusTenantToken:d}=r;this._logGroupName=s,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${a}`,l,d),this._namespace=`Office.${a}.${s}`}logEvent(e,t,i,n,r,u,h,g,p){const m=i===a.h.Undefined?t:`${i}.${t}`;if(n===l.q.Debug)return;const f=[(0,o.Ug)("Tag",e),(0,o.Ug)("Level",n)];r&&f.push((0,o.m9)(null!=p?p:"Data",(0,d.v)(r))),f.forEach((e=>e.classification=s.o.DataClassification.SystemMetadata)),this.uploadEvent(m,f,null!=u?u:c.DEFAULT_SAMPLING_POLICY,null!=h?h:c.DEFAULT_DIAGNOSTIC_LEVEL,null!=g?g:c.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,i,n,a){if(!this.kpisEnabled)return;const l=`KPIs.${e}`,d=[(0,o.m9)("Entity_Id",t),(0,o.LK)("IsPremium",n)];a&&d.push((0,o.m9)("Data",JSON.stringify(a))),d.forEach((e=>e.classification=s.o.DataClassification.SystemMetadata));const c=r.A.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:i});d.push(...c),this.uploadEvent(l,d,s.o.SamplingPolicy.CriticalUsage,s.o.DiagnosticLevel.RequiredServiceData,s.o.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,i,n,o=[]){const s=null!=t?t:c.DEFAULT_SAMPLING_POLICY,r=null!=i?i:c.DEFAULT_DIAGNOSTIC_LEVEL,a=null!=n?n:c.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,o,s,r,a)}createActivity(e,t,i){const n=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(n),eventFlags:null!=i?i:{dataCategories:s.o.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,i,n,o){const r=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:r,dataFields:t,eventFlags:{dataCategories:o,diagnosticLevel:n,costPriority:s.o.CostPriority.Normal,persistencePriority:s.o.PersistencePriority.Normal,samplingPolicy:i}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}}c.DEFAULT_SAMPLING_POLICY=s.o.SamplingPolicy.Measure,c.DEFAULT_DIAGNOSTIC_LEVEL=s.o.DiagnosticLevel.RequiredServiceData,c.DEFAULT_DATA_CATEGORIES=s.o.DataCategories.ProductServiceUsage},54756:(e,t,i)=>{function n(e){return e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e)}i.d(t,{v:()=>n})},4879:(e,t,i)=>{i.d(t,{C:()=>l,L:()=>a});var n=i(56971),o=i(57099);const s=new class{constructor(e=!1){this.useConsoleLogger=e,this._consoleLogger=new o.C({logToConsole:!0})}logEvent(e,t,i,n,o,s,r,a){const l=`${i}.${t}`;this.useConsoleLogger&&this._consoleLogger.logData({message:l,data:o})}logKpi(e,t,i,n,o){const s=`KPIs.${e}`;this.useConsoleLogger&&this._consoleLogger.logData({kpiEvent:`${s}.${t}`,engagement:i,data:o})}logStandaloneMetric(e,t,i,n,o){this.useConsoleLogger&&this._consoleLogger.logData({standaloneMetric:e})}createActivity(e,t){const i=`${t}.${e}`;return this.useConsoleLogger&&this._consoleLogger.logData({activity:i}),{cv:new n.CV(""),setResult:()=>{},endNow:()=>{},createChildActivity:()=>{throw new Error("Not implemented")},telemetryProperties:{},dataFields:[],eventName:"",eventFlags:{}}}};let r;function a(e){r=e}function l(){return r||s}},56489:(e,t,i)=>{i.d(t,{UC:()=>A,YQ:()=>s,h1:()=>M,ZP:()=>te,SV:()=>n,O1:()=>ie.O,w:()=>D,Cx:()=>w,iN:()=>F,yF:()=>L});var n,o=i(17298);!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(n||(n={}));const s=(0,o.f)("IThemeStore"),r=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#A19F9D"},border:"#FFFFFF",text:{resting:"#201F1E",disabled:"#A19F9D"},tag:{resting:"#605E5C"},altText:{resting:"#605E5C"},icon:{resting:"#797775",disabled:"#A19F9D"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A4EBC"},rewriteText:{resting:"#5A4EBC"},suggestionMenuHoverBackground:"#F3F2F1",header:"#3B3A39",subheader:"#605E5C",dialogText:"#605E5C",iconText:"#605E5C",contextText:"#605E5C",errorText:"#FF0000",separator:"#E1DFDD",focusRing:"#201F1E",link:"#1651AA",linkPressed:"#13458F",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},addOnFooterBackground:"#F3F2F1",upsellFooterColor:"#EFF6FC",addOnFooterMessage:"#201F1E",premiumEmphasis:"#185ABD",addOnAction:"#185ABD",editorIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",pressed:"#13458F",disabled:"#A19F9D"},focusRing:"#201F1E"}}],[n.dark,{background:{resting:"#1B1A19",hover:"#252423",pressed:"#292827",disabled:"#797775"},border:"#1B1A19",text:{resting:"#FAF9F8",disabled:"#797775"},tag:{resting:"#A19F9D"},altText:{resting:"#A19F9D"},icon:{resting:"#A19F9D",disabled:"#797775"},altIcon:{resting:"#616161",hover:"#82ABF1",pressed:"#82ABF1",disabled:"#797775"},grammarText:{resting:"#99AAF5"},refinementText:{resting:"#ADA2F2"},rewriteText:{resting:"#ADA2F2"},suggestionMenuHoverBackground:"#252423",header:"#C8C6C4",subheader:"#A19F9D",dialogText:"#A19F9D",iconText:"#A19F9D",contextText:"#A19F9D",errorText:"#FF0000",separator:"#484644",focusRing:"#C8C6C4",link:"#3D7CE8",linkPressed:"#598FEC",branding:{type:"IconAndTextButton",background:{resting:"#1B1A19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},addOnFooterBackground:"#252423",upsellFooterColor:"#092C47",addOnFooterMessage:"#FAF9F8",premiumEmphasis:"#598FEC",addOnAction:"#598FEC",editorIcon:"#598FEC",correctionHighlight:"#095E09",helpLink:{text:{resting:"#3D7CE8",hover:"#598FEC",pressed:"#598FEC",disabled:"#797775"},focusRing:"#C8C6C4"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},border:"#FFFFFF",text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tag:{resting:"#FFFFFF",hover:"#000000"},altText:{resting:"#FFFFFF",hover:"#000000"},icon:{resting:"#FFFFFF",disabled:"#FFFFFF"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},grammarText:{resting:"#FFFFFF",hover:"#000000"},refinementText:{resting:"#FFFFFF",hover:"#000000"},rewriteText:{resting:"#FFFFFF"},suggestionMenuHoverBackground:"#000000",header:"#FFFFFF",subheader:"#FFFFFF",dialogText:"#FFFFFF",iconText:"#FFFFFF",contextText:"#FFFFFF",errorText:"#FFFFFF",separator:"#FFFFFF",focusRing:"#1AEBFF",link:"#FFFF01",linkPressed:"#FFFF01",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},addOnFooterBackground:"#000000",upsellFooterColor:"#000000",addOnFooterMessage:"#FFFFFF",premiumEmphasis:"#FFFFFF",addOnAction:"#FFFFFF",editorIcon:"#FFFFFF",correctionHighlight:"#FFFFFF",helpLink:{text:{resting:"#FFFF01",hover:"#FFFF01",pressed:"#FFFF01",disabled:"#FFFF01"},focusRing:"#FFFF01"},callout:{borderColor:"#FFFFFF"}}]]),a="CritiqueCallout";var l=i(62924),d=i(61033);const c=new Map([[n.light,{background:{resting:d.kd.white,hover:"#F5F5F5",pressed:"#CFE4FA"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:d.kd.gray190,disabled:"#707070"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},actionButtonForeground:{resting:"#0078D4"},highlightingBorderColor:d.kd.gray190,branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},highlighting:"#EBF3FC",altText:{resting:d.kd.gray130},shimmer:{shimmerColor:d.kd.gray20,shimmerWaveColor:d.kd.gray30},scroll:{thumbColor:"#676767"},tooltip:{directionHint:l.A8.rightCenter},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#EBEBEB"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}}],[n.dark,{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD"},footerButtonBackground:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},text:{resting:d.kd.white,disabled:"#707070"},highlightingBorderColor:d.kd.white,altText:{resting:"#D6D6D6"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#115EA3",branding:{type:"IconAndTextButton",background:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#FFFFFF80"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF",directionHint:l.A8.rightCenter},tag:{background:"#082338",textColor:"#62ABF5"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#3D3D3D"},meetingBanner:{backgroundColor:"#141414",text:"#ffffff",iconPrimaryColor:"#adadad",borderColor:"#666666"},noSuggestions:{descriptionTextColor:"#707070",item:{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD",disabled:void 0},text:{resting:"#598FEC"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}]]),u="ExpandedInlineSuggestion",h=new Map([[n.light,{background:"linear-gradient(93.85deg, #EEF3FB 58.87%, #EAE9FF 100%)",buttonBackground:"white",textColor:"#323130",linkColor:"#2E6AC5",dismissColor:"#323130",iconColor:"#185ABD",newTag:{shadow:"0px 1.6px 3.56px 0px rgba(0, 0, 0, 0.13)",background:"#FFFFFF",textColor:"#185ABD"},pagination:{textColor:"#185ABD",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#FFFFFF",textColor:"#201F1E"}}],[n.dark,{background:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",buttonBackground:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",textColor:"white",linkColor:"#82ABF1",dismissColor:"white",iconColor:"#82ABF1",newTag:{background:"#82ABF1",textColor:"#0C2145"},pagination:{textColor:"#82ABF1",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#1B1A19",textColor:"#FFFFFF"},shimmer:{shimmerColor:"#052865"}}]]),g="FooterFRE",p=new Map([[n.light,{background:"#0F6CBD",shadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",borderRadius:{default:"4px",disabled:"0px"},display:"flex",width:"32px",height:"32px",color:"#FFFFFF",border:"none",critiqueCategoryText:{fontFamily:"segoeUi",fontSize:"14px",lineHeight:"18px",fontStyle:"normal",padding:"5px",color:"#000000",minWidth:"unset",fontWeight:"600"},critiqueCategoryNumber:{fontFamily:"bahnschrift",font:"bahnschrift",fontSize:"16px",lineHeight:"18px"},indicatorButtonText:{textAlign:"center",fontFamily:"bahnschrift",fontSize:"16px",minWidth:"unset",padding:"12px",fontWeight:"600"},suggestionNumberText:{padding:"3px"}}]]),m="Indicator",f=new Map([[n.light,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[n.dark,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),v="InlineNudgeBubble",_=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:"#201F1E",disabled:"#A19F9D"},altIcon:{resting:"#424242",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},altText:{resting:"#605E5C"},highlightingBorderColor:"#201F1E",actionButtonForeground:{resting:"#0078D4"},highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},noSuggestions:{descriptionTextColor:"#616161",item:{background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},text:{resting:"#185ABD",disabled:"#707070"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5"}}}],[n.dark,{background:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},footerButtonBackground:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#FAF9F8",disabled:"#797775"},highlightingBorderColor:"#FAF9F8",altText:{resting:"#A19F9D"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929",branding:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#D6D6D6"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF"},tag:{background:"#082338",textColor:"#62ABF5"},noSuggestions:{descriptionTextColor:"#D6D6D6",item:{background:{resting:"#1b1a19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#296FE6",disabled:"#707070"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},footerButtonBackground:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},highlightingBorderColor:"#FFFFFF",altText:{resting:"#FFFFFF",hover:"#000000"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},shimmer:{shimmerColor:"#FFFFFF",shimmerWaveColor:"#FFFFFF"},scroll:{thumbColor:"#FFFFFF"},tooltip:{backgroundColor:"#000000",textColor:"#FFFFFF"},callout:{border:"1px solid #FFFFFF"},userAvatarBorderColor:"#FFFFFF",noSuggestions:{descriptionTextColor:"#FFFFFF",item:{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF"}}}]]),y="InlineSuggestion",I=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#f3f2f1"},text:{resting:"#605e5c"}}],[n.dark,{background:{resting:"#333333",hover:"#212121"},text:{resting:"#f4f4f4"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),C="NudgeBubble",S=new Map([[n.light,{background:{resting:"#f5f5f5",hover:"#eee8ff"},text:"#605e5c",entityText:{resting:"#707070",hover:"#8230ff"},tabText:"#707070",highlightColor:"#EBEBEB"}],[n.dark,{background:{resting:"#141414",hover:"#4c0aa8"},text:"#a19f9d",entityText:{resting:"#999999",hover:"#a375ff"},tabText:"#999999"}],[n.highContrast,{background:{resting:"#000000",hover:"#8ee3f0"},text:"#3FF23F",entityText:{resting:"#ffffff",hover:"#263b50"},tabText:"#3FF23F"}]]),b="PredictionContainer",T=new Map([[n.light,{background:"#FFFFFF",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#424242",altText:"#616161"}],[n.dark,{background:"#1B1A19",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#FFFFFF",altText:"#ADADAD"}]]),E="SquiggleTooltip",N=new Map([[n.light,{primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#FFFFFF",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000",highContrast:{iconPrimaryColor:"#000000",iconSecondaryColor:"#FFFFFF"}}],[n.dark,{primaryButtonBackground:{resting:"#2899F5",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#1B1A19",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#1B1A19",hover:"#484644",pressed:"#979593"},defaultButtonText:{resting:"#FAF9F8",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",backgroundColor:"#1B1A19",link:"#2899F5",titleColor:"#FAF9F8",descriptionColor:"#C8C6C4",rejectionTextColor:"#FAF9F8",primaryButtonFocusRing:"#FFFFFF",defaultButtonFocusRing:"#FFFFFF",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#043862",dismissButtonColor:"#FAF9F8",highContrast:{iconPrimaryColor:"#FFFFFF",iconSecondaryColor:"#000000"}}]]),x="TonalFirstRunCard",w=new Map([[a,r],[u,c],[g,h],[y,_],[x,N],[C,I],[v,f],[b,S],[E,T],[m,p]]),L={critiqueCalloutComponentName:a,expandedInlineSuggestionComponentName:u,footerFreComponentName:g,inlineSuggestionComponentName:y,indicatorComponentName:m,tonalFreComponentName:x,nudgeBubbleComponentName:C,inlineNudgeBubbleComponentName:v,predictionContainerComponentName:b,squiggleTooltipComponentName:E},D=new Map([[C,{}]]),F={critiqueCalloutComponentName:a,footerFreComponentName:g,nudgeBubbleComponentName:C,advancedEditorSettingsDialogComponentName:"AdvancedEditorSettingsDialog"},A=(0,o.f)("IStyleStore");var R=i(23182),q=i(19728);function P(e){return new Map(JSON.parse(JSON.stringify(Array.from(e))))}function O(e){return e&&"object"==typeof e&&Object.keys(e).length?JSON.parse(JSON.stringify(e)):e}var k=i(29906),z=i(37814);let M=class{constructor(){this._styles=new Map,(0,z.Gn)(this)}get components(){return Array.from(this._styles.keys())}getComponentStyle(e){const t=this._styles.get(e);return t&&O(t)}updateComponentStyle(e,t){this._styles.set(e,t)}};(0,R.__decorate)([q.observable],M.prototype,"_styles",void 0),(0,R.__decorate)([q.computed],M.prototype,"components",null),(0,R.__decorate)([q.action],M.prototype,"getComponentStyle",null),(0,R.__decorate)([q.action],M.prototype,"updateComponentStyle",null),M=(0,R.__decorate)([(0,k._)()],M);var W=i(36147);const j=(0,W.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1",inputBackground:"F5F5F5",primaryButtonBackground:"#185ABD",primaryButtonBackgroundHovered:"#1651AA",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),B=(0,W.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#858585",primaryButtonText:"#ffffff",disabledText:"#858585",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA",inputBackground:"#141414",primaryButtonBackground:"#1651AA",primaryButtonBackgroundHovered:"#185ABD",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var U;let H;function V(){return null!=H?H:H=(0,q.observable)({theme:j})}!function(e){e.Light="Light",e.Dark="Dark"}(U||(U={}));const G=(0,q.action)((e=>{V().theme=e===U.Dark?B:j}));(0,q.action)((e=>{V().theme=e}));var Q=i(41649),K=i(33767),$=i(83010),J=i(43338),Z=i(91050),Y=i(46159),X=i(2394),ee=i(64218);let te=class{constructor(e){this.hostSettings=e,this._defaultTheme=n.light,this._currentTheme=n.light,this._themes=new Map,this._fluentThemes=new Map,this._isDarkMode=void 0,this._useFluentV9=void 0,(0,z.Gn)(this),this._isDarkMode=this.hostSettings.isDarkMode,this._currentTheme=this.hostSettings.isDarkMode?n.dark:n.light,this._currentTheme===n.dark?G(U.Dark):G(U.Light),this._useFluentV9=this.hostSettings.useFluentV9}get isDarkMode(){return this._isDarkMode}get defaultTheme(){return this._defaultTheme}get currentTheme(){return this._currentTheme}get components(){return Array.from(this._themes.keys())}getFluentActiveTheme(){let e={};if(!this._fluentThemes.get(this._currentTheme))switch(this._currentTheme){case n.light:e=J.o;break;case n.dark:e=Z.C;break;case n.highContrast:e=Y.e}const t=this._currentTheme===n.light?0:this._currentTheme===n.dark?1:this._currentTheme===n.highContrast?2:0,i=Object.assign(Object.assign(Object.assign({},Q.Ks[t]),Q.zw[t]),Q.nY[t]);return Object.assign(Object.assign({},e),i)}getComponentActiveTheme(e){var t;if(this._useFluentV9)return;const i=this._themes.get(e),n=O(null==i?void 0:i.get(this._currentTheme)),o=O(null==i?void 0:i.get(this._defaultTheme));return null!==(t=null!=n?n:o)&&void 0!==t?t:void 0}getComponentThemes(e){const t=this._themes.get(e);return t&&P(t)}updateDarkMode(e){this._isDarkMode=e,this.hostSettings.isDarkMode=e,this._currentTheme=e?n.dark:n.light,G(e?U.Dark:U.Light)}updateDefaultTheme(e){this._defaultTheme=e}updateCurrentTheme(e){this._currentTheme=e,e===n.dark?G(U.Dark):G(U.Light)}updateComponentThemes(e,t){this._themes.set(e,P(t))}updateFluentThemes(e){this._fluentThemes.clear();for(const[t,i]of e)this._fluentThemes.set(t,i)}getExpandedEccFluentTheme(){switch(this._currentTheme){case n.light:default:return X.u;case n.dark:return ee.k}}};(0,R.__decorate)([q.observable],te.prototype,"_defaultTheme",void 0),(0,R.__decorate)([q.observable],te.prototype,"_currentTheme",void 0),(0,R.__decorate)([q.observable],te.prototype,"_themes",void 0),(0,R.__decorate)([q.observable],te.prototype,"_fluentThemes",void 0),(0,R.__decorate)([q.observable],te.prototype,"_isDarkMode",void 0),(0,R.__decorate)([q.observable],te.prototype,"_useFluentV9",void 0),(0,R.__decorate)([q.computed],te.prototype,"isDarkMode",null),(0,R.__decorate)([q.computed],te.prototype,"defaultTheme",null),(0,R.__decorate)([q.computed],te.prototype,"currentTheme",null),(0,R.__decorate)([q.computed],te.prototype,"components",null),(0,R.__decorate)([q.action],te.prototype,"updateDarkMode",null),(0,R.__decorate)([q.action],te.prototype,"updateDefaultTheme",null),(0,R.__decorate)([q.action],te.prototype,"updateCurrentTheme",null),(0,R.__decorate)([q.action],te.prototype,"updateComponentThemes",null),(0,R.__decorate)([q.action],te.prototype,"updateFluentThemes",null),(0,R.__decorate)([q.action],te.prototype,"getExpandedEccFluentTheme",null),te=(0,R.__decorate)([(0,k._)(),(0,R.__param)(0,(0,$.W)(K.n))],te);var ie=i(97612)},10339:(e,t,i)=>{i.r(t),i.d(t,{default:()=>s});var n=i(41668),o=i.n(n);function s(){return o()('(()=>{var t={750:t=>{var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},n=-1;e.Diff=function(t,e){return[t,e]},e.prototype.diff_main=function(t,n,i,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var s=r;if(null==t||null==n)throw new Error("Null input. (diff_main)");if(t==n)return t?[new e.Diff(0,t)]:[];void 0===i&&(i=!0);var h=i,f=this.diff_commonPrefix(t,n),a=t.substring(0,f);t=t.substring(f),n=n.substring(f),f=this.diff_commonSuffix(t,n);var l=t.substring(t.length-f);t=t.substring(0,t.length-f),n=n.substring(0,n.length-f);var g=this.diff_compute_(t,n,h,s);return a&&g.unshift(new e.Diff(0,a)),l&&g.push(new e.Diff(0,l)),this.diff_cleanupMerge(g),g},e.prototype.diff_compute_=function(t,i,r,s){var h;if(!t)return[new e.Diff(1,i)];if(!i)return[new e.Diff(n,t)];var f=t.length>i.length?t:i,a=t.length>i.length?i:t,l=f.indexOf(a);if(-1!=l)return h=[new e.Diff(1,f.substring(0,l)),new e.Diff(0,a),new e.Diff(1,f.substring(l+a.length))],t.length>i.length&&(h[0][0]=h[2][0]=n),h;if(1==a.length)return[new e.Diff(n,t),new e.Diff(1,i)];var g=this.diff_halfMatch_(t,i);if(g){var o=g[0],c=g[1],u=g[2],p=g[3],d=g[4],_=this.diff_main(o,u,r,s),b=this.diff_main(c,p,r,s);return _.concat([new e.Diff(0,d)],b)}return r&&t.length>100&&i.length>100?this.diff_lineMode_(t,i,s):this.diff_bisect_(t,i,s)},e.prototype.diff_lineMode_=function(t,i,r){var s=this.diff_linesToChars_(t,i);t=s.chars1,i=s.chars2;var h=s.lineArray,f=this.diff_main(t,i,!1,r);this.diff_charsToLines_(f,h),this.diff_cleanupSemantic(f),f.push(new e.Diff(0,""));for(var a=0,l=0,g=0,o="",c="";a<f.length;){switch(f[a][0]){case 1:g++,c+=f[a][1];break;case n:l++,o+=f[a][1];break;case 0:if(l>=1&&g>=1){f.splice(a-l-g,l+g),a=a-l-g;for(var u=this.diff_main(o,c,!1,r),p=u.length-1;p>=0;p--)f.splice(a,0,u[p]);a+=u.length}g=0,l=0,o="",c=""}a++}return f.pop(),f},e.prototype.diff_bisect_=function(t,i,r){for(var s=t.length,h=i.length,f=Math.ceil((s+h)/2),a=f,l=2*f,g=new Array(l),o=new Array(l),c=0;c<l;c++)g[c]=-1,o[c]=-1;g[a+1]=0,o[a+1]=0;for(var u=s-h,p=u%2!=0,d=0,_=0,b=0,v=0,m=0;m<f&&!((new Date).getTime()>r);m++){for(var w=-m+d;w<=m-_;w+=2){for(var x=a+w,M=(E=w==-m||w!=m&&g[x-1]<g[x+1]?g[x+1]:g[x-1]+1)-w;E<s&&M<h&&t.charAt(E)==i.charAt(M);)E++,M++;if(g[x]=E,E>s)_+=2;else if(M>h)d+=2;else if(p){if((k=a+u-w)>=0&&k<l&&-1!=o[k])if(E>=(D=s-o[k]))return this.diff_bisectSplit_(t,i,E,M,r)}}for(var y=-m+b;y<=m-v;y+=2){for(var D,k=a+y,A=(D=y==-m||y!=m&&o[k-1]<o[k+1]?o[k+1]:o[k-1]+1)-y;D<s&&A<h&&t.charAt(s-D-1)==i.charAt(h-A-1);)D++,A++;if(o[k]=D,D>s)v+=2;else if(A>h)b+=2;else if(!p){if((x=a+u-y)>=0&&x<l&&-1!=g[x]){var E;M=a+(E=g[x])-x;if(E>=(D=s-D))return this.diff_bisectSplit_(t,i,E,M,r)}}}}return[new e.Diff(n,t),new e.Diff(1,i)]},e.prototype.diff_bisectSplit_=function(t,e,n,i,r){var s=t.substring(0,n),h=e.substring(0,i),f=t.substring(n),a=e.substring(i),l=this.diff_main(s,h,!1,r),g=this.diff_main(f,a,!1,r);return l.concat(g)},e.prototype.diff_linesToChars_=function(t,e){var n=[],i={};function r(t){for(var e="",r=0,h=-1,f=n.length;h<t.length-1;){-1==(h=t.indexOf("\\n",r))&&(h=t.length-1);var a=t.substring(r,h+1);(i.hasOwnProperty?i.hasOwnProperty(a):void 0!==i[a])?e+=String.fromCharCode(i[a]):(f==s&&(a=t.substring(r),h=t.length),e+=String.fromCharCode(f),i[a]=f,n[f++]=a),r=h+1}return e}n[0]="";var s=4e4,h=r(t);return s=65535,{chars1:h,chars2:r(e),lineArray:n}},e.prototype.diff_charsToLines_=function(t,e){for(var n=0;n<t.length;n++){for(var i=t[n][1],r=[],s=0;s<i.length;s++)r[s]=e[i.charCodeAt(s)];t[n][1]=r.join("")}},e.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(s,r)==e.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonOverlap_=function(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):n<i&&(e=e.substring(0,n));var r=Math.min(n,i);if(t==e)return r;for(var s=0,h=1;;){var f=t.substring(r-h),a=e.indexOf(f);if(-1==a)return s;h+=a,0!=a&&t.substring(r-h)!=e.substring(0,h)||(s=h,h++)}},e.prototype.diff_halfMatch_=function(t,e){if(this.Diff_Timeout<=0)return null;var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;var r=this;function s(t,e,n){for(var i,s,h,f,a=t.substring(n,n+Math.floor(t.length/4)),l=-1,g="";-1!=(l=e.indexOf(a,l+1));){var o=r.diff_commonPrefix(t.substring(n),e.substring(l)),c=r.diff_commonSuffix(t.substring(0,n),e.substring(0,l));g.length<c+o&&(g=e.substring(l-c,l)+e.substring(l,l+o),i=t.substring(0,n-c),s=t.substring(n+o),h=e.substring(0,l-c),f=e.substring(l+o))}return 2*g.length>=t.length?[i,s,h,f,g]:null}var h,f,a,l,g,o=s(n,i,Math.ceil(n.length/4)),c=s(n,i,Math.ceil(n.length/2));return o||c?(h=c?o&&o[4].length>c[4].length?o:c:o,t.length>e.length?(f=h[0],a=h[1],l=h[2],g=h[3]):(l=h[0],g=h[1],f=h[2],a=h[3]),[f,a,l,g,h[4]]):null},e.prototype.diff_cleanupSemantic=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=0,l=0,g=0,o=0;f<t.length;)0==t[f][0]?(r[s++]=f,a=g,l=o,g=0,o=0,h=t[f][1]):(1==t[f][0]?g+=t[f][1].length:o+=t[f][1].length,h&&h.length<=Math.max(a,l)&&h.length<=Math.max(g,o)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,f=--s>0?r[s-1]:-1,a=0,l=0,g=0,o=0,h=null,i=!0)),f++;for(i&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),f=1;f<t.length;){if(t[f-1][0]==n&&1==t[f][0]){var c=t[f-1][1],u=t[f][1],p=this.diff_commonOverlap_(c,u),d=this.diff_commonOverlap_(u,c);p>=d?(p>=c.length/2||p>=u.length/2)&&(t.splice(f,0,new e.Diff(0,u.substring(0,p))),t[f-1][1]=c.substring(0,c.length-p),t[f+1][1]=u.substring(p),f++):(d>=c.length/2||d>=u.length/2)&&(t.splice(f,0,new e.Diff(0,c.substring(0,d))),t[f-1][0]=1,t[f-1][1]=u.substring(0,u.length-d),t[f+1][0]=n,t[f+1][1]=c.substring(d),f++),f++}f++}},e.prototype.diff_cleanupSemanticLossless=function(t){function n(t,n){if(!t||!n)return 6;var i=t.charAt(t.length-1),r=n.charAt(0),s=i.match(e.nonAlphaNumericRegex_),h=r.match(e.nonAlphaNumericRegex_),f=s&&i.match(e.whitespaceRegex_),a=h&&r.match(e.whitespaceRegex_),l=f&&i.match(e.linebreakRegex_),g=a&&r.match(e.linebreakRegex_),o=l&&t.match(e.blanklineEndRegex_),c=g&&n.match(e.blanklineStartRegex_);return o||c?5:l||g?4:s&&!f&&a?3:f||a?2:s||h?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var r=t[i-1][1],s=t[i][1],h=t[i+1][1],f=this.diff_commonSuffix(r,s);if(f){var a=s.substring(s.length-f);r=r.substring(0,r.length-f),s=a+s.substring(0,s.length-f),h=a+h}for(var l=r,g=s,o=h,c=n(r,s)+n(s,h);s.charAt(0)===h.charAt(0);){r+=s.charAt(0),s=s.substring(1)+h.charAt(0),h=h.substring(1);var u=n(r,s)+n(s,h);u>=c&&(c=u,l=r,g=s,o=h)}t[i-1][1]!=l&&(l?t[i-1][1]=l:(t.splice(i-1,1),i--),t[i][1]=g,o?t[i+1][1]=o:(t.splice(i+1,1),i--))}i++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\\s/,e.linebreakRegex_=/[\\r\\n]/,e.blanklineEndRegex_=/\\n\\r?\\n$/,e.blanklineStartRegex_=/^\\r?\\n\\r?\\n/,e.prototype.diff_cleanupEfficiency=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=!1,l=!1,g=!1,o=!1;f<t.length;)0==t[f][0]?(t[f][1].length<this.Diff_EditCost&&(g||o)?(r[s++]=f,a=g,l=o,h=t[f][1]):(s=0,h=null),g=o=!1):(t[f][0]==n?o=!0:g=!0,h&&(a&&l&&g&&o||h.length<this.Diff_EditCost/2&&a+l+g+o==3)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,h=null,a&&l?(g=o=!0,s=0):(f=--s>0?r[s-1]:-1,g=o=!1),i=!0)),f++;i&&this.diff_cleanupMerge(t)},e.prototype.diff_cleanupMerge=function(t){t.push(new e.Diff(0,""));for(var i,r=0,s=0,h=0,f="",a="";r<t.length;)switch(t[r][0]){case 1:h++,a+=t[r][1],r++;break;case n:s++,f+=t[r][1],r++;break;case 0:s+h>1?(0!==s&&0!==h&&(0!==(i=this.diff_commonPrefix(a,f))&&(r-s-h>0&&0==t[r-s-h-1][0]?t[r-s-h-1][1]+=a.substring(0,i):(t.splice(0,0,new e.Diff(0,a.substring(0,i))),r++),a=a.substring(i),f=f.substring(i)),0!==(i=this.diff_commonSuffix(a,f))&&(t[r][1]=a.substring(a.length-i)+t[r][1],a=a.substring(0,a.length-i),f=f.substring(0,f.length-i))),r-=s+h,t.splice(r,s+h),f.length&&(t.splice(r,0,new e.Diff(n,f)),r++),a.length&&(t.splice(r,0,new e.Diff(1,a)),r++),r++):0!==r&&0==t[r-1][0]?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,h=0,s=0,f="",a=""}""===t[t.length-1][1]&&t.pop();var l=!1;for(r=1;r<t.length-1;)0==t[r-1][0]&&0==t[r+1][0]&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)==t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),l=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),l=!0)),r++;l&&this.diff_cleanupMerge(t)},e.prototype.diff_xIndex=function(t,e){var i,r=0,s=0,h=0,f=0;for(i=0;i<t.length&&(1!==t[i][0]&&(r+=t[i][1].length),t[i][0]!==n&&(s+=t[i][1].length),!(r>e));i++)h=r,f=s;return t.length!=i&&t[i][0]===n?f:f+(e-h)},e.prototype.diff_prettyHtml=function(t){for(var e=[],i=/&/g,r=/</g,s=/>/g,h=/\\n/g,f=0;f<t.length;f++){var a=t[f][0],l=t[f][1].replace(i,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(h,"&para;<br>");switch(a){case 1:e[f]=\'<ins style="background:#e6ffe6;">\'+l+"</ins>";break;case n:e[f]=\'<del style="background:#ffe6e6;">\'+l+"</del>";break;case 0:e[f]="<span>"+l+"</span>"}}return e.join("")},e.prototype.diff_text1=function(t){for(var e=[],n=0;n<t.length;n++)1!==t[n][0]&&(e[n]=t[n][1]);return e.join("")},e.prototype.diff_text2=function(t){for(var e=[],i=0;i<t.length;i++)t[i][0]!==n&&(e[i]=t[i][1]);return e.join("")},e.prototype.diff_levenshtein=function(t){for(var e=0,i=0,r=0,s=0;s<t.length;s++){var h=t[s][0],f=t[s][1];switch(h){case 1:i+=f.length;break;case n:r+=f.length;break;case 0:e+=Math.max(i,r),i=0,r=0}}return e+=Math.max(i,r)},e.prototype.diff_toDelta=function(t){for(var e=[],i=0;i<t.length;i++)switch(t[i][0]){case 1:e[i]="+"+encodeURI(t[i][1]);break;case n:e[i]="-"+t[i][1].length;break;case 0:e[i]="="+t[i][1].length}return e.join("\\t").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(t,i){for(var r=[],s=0,h=0,f=i.split(/\\t/g),a=0;a<f.length;a++){var l=f[a].substring(1);switch(f[a].charAt(0)){case"+":try{r[s++]=new e.Diff(1,decodeURI(l))}catch(t){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var g=parseInt(l,10);if(isNaN(g)||g<0)throw new Error("Invalid number in diff_fromDelta: "+l);var o=t.substring(h,h+=g);"="==f[a].charAt(0)?r[s++]=new e.Diff(0,o):r[s++]=new e.Diff(n,o);break;default:if(f[a])throw new Error("Invalid diff operation in diff_fromDelta: "+f[a])}}if(h!=t.length)throw new Error("Delta length ("+h+") does not equal source text length ("+t.length+").");return r},e.prototype.match_main=function(t,e,n){if(null==t||null==e||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,t.length)),t==e?0:t.length?t.substring(n,n+e.length)==e?n:this.match_bitap_(t,e,n):-1},e.prototype.match_bitap_=function(t,e,n){if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(e),r=this;function s(t,i){var s=t/e.length,h=Math.abs(n-i);return r.Match_Distance?s+h/r.Match_Distance:h?1:s}var h=this.Match_Threshold,f=t.indexOf(e,n);-1!=f&&(h=Math.min(s(0,f),h),-1!=(f=t.lastIndexOf(e,n+e.length))&&(h=Math.min(s(0,f),h)));var a,l,g=1<<e.length-1;f=-1;for(var o,c=e.length+t.length,u=0;u<e.length;u++){for(a=0,l=c;a<l;)s(u,n+l)<=h?a=l:c=l,l=Math.floor((c-a)/2+a);c=l;var p=Math.max(1,n-l+1),d=Math.min(n+l,t.length)+e.length,_=Array(d+2);_[d+1]=(1<<u)-1;for(var b=d;b>=p;b--){var v=i[t.charAt(b-1)];if(_[b]=0===u?(_[b+1]<<1|1)&v:(_[b+1]<<1|1)&v|(o[b+1]|o[b])<<1|1|o[b+1],_[b]&g){var m=s(u,b-1);if(m<=h){if(h=m,!((f=b-1)>n))break;p=Math.max(1,2*n-f)}}}if(s(u+1,n)>h)break;o=_}return f},e.prototype.match_alphabet_=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=0;for(n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e},e.prototype.patch_addContext_=function(t,n){if(0!=n.length){if(null===t.start2)throw Error("patch not initialized");for(var i=n.substring(t.start2,t.start2+t.length1),r=0;n.indexOf(i)!=n.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,i=n.substring(t.start2-r,t.start2+t.length1+r);r+=this.Patch_Margin;var s=n.substring(t.start2-r,t.start2);s&&t.diffs.unshift(new e.Diff(0,s));var h=n.substring(t.start2+t.length1,t.start2+t.length1+r);h&&t.diffs.push(new e.Diff(0,h)),t.start1-=s.length,t.start2-=s.length,t.length1+=s.length+h.length,t.length2+=s.length+h.length}},e.prototype.patch_make=function(t,i,r){var s,h;if("string"==typeof t&&"string"==typeof i&&void 0===r)s=t,(h=this.diff_main(s,i,!0)).length>2&&(this.diff_cleanupSemantic(h),this.diff_cleanupEfficiency(h));else if(t&&"object"==typeof t&&void 0===i&&void 0===r)h=t,s=this.diff_text1(h);else if("string"==typeof t&&i&&"object"==typeof i&&void 0===r)s=t,h=i;else{if("string"!=typeof t||"string"!=typeof i||!r||"object"!=typeof r)throw new Error("Unknown call format to patch_make.");s=t,h=r}if(0===h.length)return[];for(var f=[],a=new e.patch_obj,l=0,g=0,o=0,c=s,u=s,p=0;p<h.length;p++){var d=h[p][0],_=h[p][1];switch(l||0===d||(a.start1=g,a.start2=o),d){case 1:a.diffs[l++]=h[p],a.length2+=_.length,u=u.substring(0,o)+_+u.substring(o);break;case n:a.length1+=_.length,a.diffs[l++]=h[p],u=u.substring(0,o)+u.substring(o+_.length);break;case 0:_.length<=2*this.Patch_Margin&&l&&h.length!=p+1?(a.diffs[l++]=h[p],a.length1+=_.length,a.length2+=_.length):_.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(a,c),f.push(a),a=new e.patch_obj,l=0,c=u,g=o)}1!==d&&(g+=_.length),d!==n&&(o+=_.length)}return l&&(this.patch_addContext_(a,c),f.push(a)),f},e.prototype.patch_deepCopy=function(t){for(var n=[],i=0;i<t.length;i++){var r=t[i],s=new e.patch_obj;s.diffs=[];for(var h=0;h<r.diffs.length;h++)s.diffs[h]=new e.Diff(r.diffs[h][0],r.diffs[h][1]);s.start1=r.start1,s.start2=r.start2,s.length1=r.length1,s.length2=r.length2,n[i]=s}return n},e.prototype.patch_apply=function(t,e){if(0==t.length)return[e,[]];t=this.patch_deepCopy(t);var i=this.patch_addPadding(t);e=i+e+i,this.patch_splitMax(t);for(var r=0,s=[],h=0;h<t.length;h++){var f,a,l=t[h].start2+r,g=this.diff_text1(t[h].diffs),o=-1;if(g.length>this.Match_MaxBits?-1!=(f=this.match_main(e,g.substring(0,this.Match_MaxBits),l))&&(-1==(o=this.match_main(e,g.substring(g.length-this.Match_MaxBits),l+g.length-this.Match_MaxBits))||f>=o)&&(f=-1):f=this.match_main(e,g,l),-1==f)s[h]=!1,r-=t[h].length2-t[h].length1;else if(s[h]=!0,r=f-l,g==(a=-1==o?e.substring(f,f+g.length):e.substring(f,o+this.Match_MaxBits)))e=e.substring(0,f)+this.diff_text2(t[h].diffs)+e.substring(f+g.length);else{var c=this.diff_main(g,a,!1);if(g.length>this.Match_MaxBits&&this.diff_levenshtein(c)/g.length>this.Patch_DeleteThreshold)s[h]=!1;else{this.diff_cleanupSemanticLossless(c);for(var u,p=0,d=0;d<t[h].diffs.length;d++){var _=t[h].diffs[d];0!==_[0]&&(u=this.diff_xIndex(c,p)),1===_[0]?e=e.substring(0,f+u)+_[1]+e.substring(f+u):_[0]===n&&(e=e.substring(0,f+u)+e.substring(f+this.diff_xIndex(c,p+_[1].length))),_[0]!==n&&(p+=_[1].length)}}}}return[e=e.substring(i.length,e.length-i.length),s]},e.prototype.patch_addPadding=function(t){for(var n=this.Patch_Margin,i="",r=1;r<=n;r++)i+=String.fromCharCode(r);for(r=0;r<t.length;r++)t[r].start1+=n,t[r].start2+=n;var s=t[0],h=s.diffs;if(0==h.length||0!=h[0][0])h.unshift(new e.Diff(0,i)),s.start1-=n,s.start2-=n,s.length1+=n,s.length2+=n;else if(n>h[0][1].length){var f=n-h[0][1].length;h[0][1]=i.substring(h[0][1].length)+h[0][1],s.start1-=f,s.start2-=f,s.length1+=f,s.length2+=f}if(0==(h=(s=t[t.length-1]).diffs).length||0!=h[h.length-1][0])h.push(new e.Diff(0,i)),s.length1+=n,s.length2+=n;else if(n>h[h.length-1][1].length){f=n-h[h.length-1][1].length;h[h.length-1][1]+=i.substring(0,f),s.length1+=f,s.length2+=f}return i},e.prototype.patch_splitMax=function(t){for(var i=this.Match_MaxBits,r=0;r<t.length;r++)if(!(t[r].length1<=i)){var s=t[r];t.splice(r--,1);for(var h=s.start1,f=s.start2,a="";0!==s.diffs.length;){var l=new e.patch_obj,g=!0;for(l.start1=h-a.length,l.start2=f-a.length,""!==a&&(l.length1=l.length2=a.length,l.diffs.push(new e.Diff(0,a)));0!==s.diffs.length&&l.length1<i-this.Patch_Margin;){var o=s.diffs[0][0],c=s.diffs[0][1];1===o?(l.length2+=c.length,f+=c.length,l.diffs.push(s.diffs.shift()),g=!1):o===n&&1==l.diffs.length&&0==l.diffs[0][0]&&c.length>2*i?(l.length1+=c.length,h+=c.length,g=!1,l.diffs.push(new e.Diff(o,c)),s.diffs.shift()):(c=c.substring(0,i-l.length1-this.Patch_Margin),l.length1+=c.length,h+=c.length,0===o?(l.length2+=c.length,f+=c.length):g=!1,l.diffs.push(new e.Diff(o,c)),c==s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(c.length))}a=(a=this.diff_text2(l.diffs)).substring(a.length-this.Patch_Margin);var u=this.diff_text1(s.diffs).substring(0,this.Patch_Margin);""!==u&&(l.length1+=u.length,l.length2+=u.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=u:l.diffs.push(new e.Diff(0,u))),g||t.splice(++r,0,l)}}},e.prototype.patch_toText=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e.join("")},e.prototype.patch_fromText=function(t){var i=[];if(!t)return i;for(var r=t.split("\\n"),s=0,h=/^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/;s<r.length;){var f=r[s].match(h);if(!f)throw new Error("Invalid patch string: "+r[s]);var a=new e.patch_obj;for(i.push(a),a.start1=parseInt(f[1],10),""===f[2]?(a.start1--,a.length1=1):"0"==f[2]?a.length1=0:(a.start1--,a.length1=parseInt(f[2],10)),a.start2=parseInt(f[3],10),""===f[4]?(a.start2--,a.length2=1):"0"==f[4]?a.length2=0:(a.start2--,a.length2=parseInt(f[4],10)),s++;s<r.length;){var l=r[s].charAt(0);try{var g=decodeURI(r[s].substring(1))}catch(t){throw new Error("Illegal escape in patch_fromText: "+g)}if("-"==l)a.diffs.push(new e.Diff(n,g));else if("+"==l)a.diffs.push(new e.Diff(1,g));else if(" "==l)a.diffs.push(new e.Diff(0,g));else{if("@"==l)break;if(""!==l)throw new Error(\'Invalid patch mode "\'+l+\'" in: \'+g)}s++}}return i},(e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var t,e=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:t="+";break;case n:t="-";break;case 0:t=" "}e[i+1]=t+encodeURI(this.diffs[i][1])+"\\n"}return e.join("").replace(/%20/g," ")},t.exports=e,t.exports.diff_match_patch=e,t.exports.DIFF_DELETE=n,t.exports.DIFF_INSERT=1,t.exports.DIFF_EQUAL=0}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(750);const e=new t.diff_match_patch;e.Diff_Timeout=0;const i=(t,e)=>t.index>=0?(t.index=e,t):e;addEventListener("message",(t=>{"get-url"!==t.data[0]?(t=>{try{const r=[],s=t.data[0],h=t.data[1],f=t.data[2],a=e.diff_main(s,h);1===a.length&&0===a[0][0]&&t.ports[0].postMessage({result:f});let l=0,g=0,o=0,c=0,u=0,p=0;for(const t of a){const e=t[0],s=t[1].length;switch(e){case 0:u=s,p=s;break;case 1:u=0,p=s;break;case-1:o+=s;continue}g+=o,o=0;for(let t=l;t<f.length;t+=1){const s=(n=f[t]).index>=0?n.index:n;if(s<c)throw new Error("Indices are not sorted!");if(!(s>=c&&s<c+p))break;r[t]=i(f[t],0===e?s+g-c:g),l+=1}if(l===f.length)break;g+=u,c+=p}for(let t=l;t<f.length;t+=1)r[t]=i(f[t],g);t.ports[0].postMessage({result:r})}catch(e){t.ports[0].postMessage({error:e})}var n})(t):t.ports[0].postMessage({url:self.location.href})}),!1)})()})();\n//# sourceMappingURL=IndexReadjusterWorker.worker.js.map',"Worker",void 0,i.p+"IndexReadjusterWorker.worker.js")}},16515:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Spelling"}}')},1206:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":" ","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":""},"Typing errors":{"LocalizedName":" ","IsImplemented":false},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":" ","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":" "},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":" "},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":" "},"Spelling":{"LocalizedName":" ","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":" "},"Sensitive Geopolitical References":{"LocalizedName":"  ","IsImplemented":false}}')},92448:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},87041:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Orfoqrafiya","IsImplemented":true}}')},35845:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},80745:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},5048:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},12216:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Pravopis"}}')},98203:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Ortografia"}}')},37360:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Vstinost","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Konzistentn psan tvary","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Nediskriminujc jazyk"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Peklepy"},"Clarity":{"LocalizedName":"Jasnost","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"Peformulovn","IsImplemented":false},"Error Corrections":{"LocalizedName":"Oprava chyb","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Slovn zsoba","IsImplemented":true},"Grammar":{"LocalizedName":"Gramatika","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Formln vyjadovn"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Interpunkce","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"Pravopis","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Pravopis"},"Resume":{"LocalizedName":"ivotopis","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Citliv geopolitick odkazy"}}')},84654:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Sillafu"}}')},35747:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Kortfattethed","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Konsistente staveformer"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Inkluderende sprog","IsImplemented":true},"Typing errors":{"LocalizedName":"Tastefejl","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":"Klarhed"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Omskrivning"},"Error Corrections":{"LocalizedName":"Fejlkorrigering","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Ordvalg","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammatik"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Formelt sprog","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Tegnstning"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skriftkonventioner"},"Spelling":{"LocalizedName":"Stavekontrol","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Curriculum Vitae"},"Sensitive Geopolitical References":{"LocalizedName":"Flsomme geopolitiske betegnelser","IsImplemented":false}}')},34829:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Prgnanz","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Konsistente Schreibformen","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Neutrale Sprache"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Tippfehler"},"Clarity":{"IsImplemented":true,"LocalizedName":"Verstndlichkeit"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Akronyme"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Umschreibung"},"Error Corrections":{"LocalizedName":"Fehlerkorrigierungen","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Wortwahl","IsImplemented":true},"Grammar":{"LocalizedName":"Grammatik","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formelle Sprache"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Interpunktion","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Schreibkonventionen"},"Spelling":{"LocalizedName":"Rechtschreibung","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Lebenslauf"},"Sensitive Geopolitical References":{"LocalizedName":"Problematische geopolitische Bezeichnungen","IsImplemented":true}}')},91065:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},75331:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"Improves readability","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Sensitive Geopolitical References","IsImplemented":true},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions help make your writing more formal by reducing casual wording."},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Error Corrections"},"Resume":{"IsImplemented":true,"LocalizedName":"Resume"},"Fluency":{"LocalizedName":"Improves flow","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Spelling"},"Inspire Me":{"LocalizedName":"Different phrasing","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":"Different phrasing"},"Punctuation Conventions":{"LocalizedName":"Punctuation Conventions","IsImplemented":true},"Formality":{"IsImplemented":true,"LocalizedName":"Formality"},"Inclusiveness":{"LocalizedName":"Inclusiveness","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"These suggestions provide alternative ways of wording a phrase or sentence.","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording."},"Conciseness":{"LocalizedName":"Conciseness","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"More concise","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Consistent Written Forms","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typing Errors"},"RewriteFormality":{"LocalizedName":"More formal","IsImplemented":false},"ConcisenessFullExplanation":{"LocalizedName":"The goal of these suggestions is to express an idea clearly, without extra words.","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulary"},"Rewrite":{"LocalizedName":"Rewrite","IsImplemented":false},"Perspectives":{"LocalizedName":"Perspectives","IsImplemented":true},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."},"Grammar":{"LocalizedName":"Grammar","IsImplemented":true},"Writing Conventions":{"LocalizedName":"Writing Conventions","IsImplemented":false},"Uncommon Words":{"LocalizedName":"Uncommon Words","IsImplemented":true},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronyms"},"Clarity":{"IsImplemented":true,"LocalizedName":"Clarity"}}')},40266:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":"The goal of these suggestions is to express an idea clearly, without extra words."},"Conciseness":{"IsImplemented":true,"LocalizedName":"Conciseness"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Consistent Written Forms"},"Sentence Inspire Me":{"LocalizedName":"Different phrasing","IsImplemented":false},"Fluency":{"LocalizedName":"Improves flow","IsImplemented":false},"Uncommon Words":{"LocalizedName":"Uncommon Words","IsImplemented":true},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inclusiveness"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typing Errors"},"Clarity":{"LocalizedName":"Clarity","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":"Improves readability"},"Inspire Me":{"IsImplemented":false,"LocalizedName":"Different phrasing"},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronyms"},"Rewrite":{"LocalizedName":"Rewrite","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Error Corrections"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions help make your writing more formal by reducing casual wording."},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulary"},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammar"},"SimplerFullExplanation":{"LocalizedName":"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording.","IsImplemented":false},"Perspectives":{"IsImplemented":true,"LocalizedName":"Perspectives"},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."},"Formality":{"LocalizedName":"Formality","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions provide alternative ways of wording a phrase or sentence."},"Punctuation Conventions":{"IsImplemented":true,"LocalizedName":"Punctuation Conventions"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":"More concise"},"RewriteFormality":{"IsImplemented":false,"LocalizedName":"More formal"},"Writing Conventions":{"LocalizedName":"Writing Conventions","IsImplemented":false},"Spelling":{"LocalizedName":"Spelling","IsImplemented":true},"Resume":{"IsImplemented":true,"LocalizedName":"Resume"},"Sensitive Geopolitical References":{"LocalizedName":"Sensitive Geopolitical References","IsImplemented":true}}')},55399:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Concisin","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Coherencia","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Lenguaje no discriminatorio","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Erratas"},"Clarity":{"LocalizedName":"Claridad","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acrnimos"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reformulaciones"},"Error Corrections":{"LocalizedName":"Correccin de errores","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulario"},"Grammar":{"LocalizedName":"Gramtica","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Lenguaje formal","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Puntuacin","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenciones de escritura"},"Spelling":{"LocalizedName":"Ortografa","IsImplemented":true},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Referencias geopolticas sensibles","IsImplemented":true}}')},93590:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Referencias geopolticas sensibles","IsImplemented":true},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correccin de errores"},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ortografa","IsImplemented":true},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Puntuacin"},"Formality":{"IsImplemented":true,"LocalizedName":"Lenguaje formal"},"Inclusiveness":{"LocalizedName":"Lenguaje no discriminatorio","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisin","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Coherencia","IsImplemented":false},"Typing errors":{"LocalizedName":"Erratas","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulario"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reformulaciones"},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramtica"},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenciones de escritura"},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acrnimos"},"Clarity":{"LocalizedName":"Claridad","IsImplemented":true}}')},97410:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"igekirjakontroll"}}')},48893:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true}}')},38859:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},73157:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":"Ytimekkyys"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Yhteninen kirjoitusasu"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Syrjiv kielenkytt","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Lyntivirheet"},"Clarity":{"IsImplemented":true,"LocalizedName":"Selkeys"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Uudelleenkirjoitus"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Virheen korjaukset"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Sanasto","IsImplemented":false},"Grammar":{"LocalizedName":"Kielioppi","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Virallinen kieli","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Vlimerkit"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Kirjoitustyyli"},"Spelling":{"IsImplemented":true,"LocalizedName":"Oikeinkirjoituksen tarkistus"},"Resume":{"LocalizedName":"Ansioluettelo","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Ongelmalliset geopoliittiset viittaukset"}}')},5595:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Rfrences gopolitiques sensibles","IsImplemented":true},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"Correction d\'erreurs","IsImplemented":false},"Resume":{"LocalizedName":"CV","IsImplemented":true},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Orthographe"},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Ponctuation"},"Formality":{"LocalizedName":"Langage formel","IsImplemented":true},"Inclusiveness":{"LocalizedName":"Langage non-discriminant","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concision","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Cohrence"},"Typing errors":{"LocalizedName":"Fautes de frappe","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulaire"},"Rewrite":{"LocalizedName":"Reformulations","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Grammar":{"LocalizedName":"Grammaire","IsImplemented":true},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Conventions"},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronymes"},"Clarity":{"IsImplemented":false,"LocalizedName":"Clart"}}')},21711:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Concision","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Cohrence","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Langage non-discriminant"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Fautes de frappe"},"Clarity":{"LocalizedName":"Clart","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronymes"},"Rewrite":{"LocalizedName":"Reformulations","IsImplemented":false},"Error Corrections":{"LocalizedName":"Correction d\'erreurs","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulaire"},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammaire"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Langage formel"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Ponctuation","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Conventions"},"Spelling":{"LocalizedName":"Orthographe","IsImplemented":true},"Resume":{"IsImplemented":true,"LocalizedName":"CV"},"Sensitive Geopolitical References":{"LocalizedName":"Rfrences gopolitiques sensibles","IsImplemented":true}}')},50257:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Litri"}}')},73587:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Litreachadh","IsImplemented":true}}')},71906:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Ortografa","IsImplemented":true}}')},82576:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},58321:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Sifellin","IsImplemented":true}}')},95687:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":false,"LocalizedName":" "},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":" "},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":" "},"Typing errors":{"IsImplemented":false,"LocalizedName":" "},"Clarity":{"LocalizedName":" ","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":" "},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":"  "},"Grammar":{"LocalizedName":"","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":" "},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":" ","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":" "},"Spelling":{"IsImplemented":true,"LocalizedName":" "},"Resume":{"IsImplemented":false,"LocalizedName":" "},"Sensitive Geopolitical References":{"LocalizedName":" - ","IsImplemented":false}}')},29757:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"IsImplemented":false,"LocalizedName":""},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},19775:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Provjera pravopisa"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},45933:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Tmrsg"},"Consistent Written Forms":{"LocalizedName":"Konzisztens rott alak","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Politikailag korrekt nyelvhasznlat","IsImplemented":true},"Typing errors":{"LocalizedName":"Gpelsi hibk","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"rthetsg"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"trs"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Hiba javts"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Szvlaszts"},"Grammar":{"IsImplemented":true,"LocalizedName":"Nyelvtan"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Nyelvhasznlat","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Kzpontozsi szoksok","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Helyesrsi szoksok"},"Spelling":{"IsImplemented":true,"LocalizedName":"Helyesrs"},"Resume":{"LocalizedName":"nletrajz","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"rzkeny geopolitikai kifejezse","IsImplemented":false}}')},31752:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},97685:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ejaan"}}')},30388:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Nsupe","IsImplemented":true}}')},83983:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Stafsetning","IsImplemented":true}}')},63925:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisione","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Coerenza formale"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Linguaggio inclusivo","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Errori di digitazione"},"Clarity":{"IsImplemented":false,"LocalizedName":"Chiarezza"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Riscrittura"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correzione degli errori"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Scelte lessicali","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammatica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Registro formale","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Punteggiatura"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenzioni di scrittura"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Curriculum Vitae"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Riferimenti geopolitici problematici"}}')},64058:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":true},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":""},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":""},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"IsImplemented":true,"LocalizedName":""},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":true},"Spelling":{"IsImplemented":false,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":true}}')},15315:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},48744:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":" ","IsImplemented":true}}')},50483:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},62564:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":" ","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"  "},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":" ","IsImplemented":false},"Error Corrections":{"LocalizedName":" ","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":" "},"Grammar":{"LocalizedName":"","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":" ","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":" "},"Spelling":{"LocalizedName":"","IsImplemented":true},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"  "}}')},20701:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},58993:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},95394:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Orthographie","IsImplemented":true}}')},18995:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Rayba","IsImplemented":true}}')},71487:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Pareizrakstba","IsImplemented":true}}')},10145:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Takikupu"}}')},74340:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},7559:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},77689:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},1593:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ejaan"}}')},94205:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ortografija"}}')},60952:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Presisjon","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Konsekvente skriftformer","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Inkluderende sprk","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Skrivefeil"},"Clarity":{"IsImplemented":false,"LocalizedName":"Klarhet"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"Omskriving","IsImplemented":false},"Error Corrections":{"LocalizedName":"Feilretting","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Ordvalg"},"Grammar":{"LocalizedName":"Grammatikk","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Formelt sprk"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Tegnsetting"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skriftnormer"},"Spelling":{"IsImplemented":true,"LocalizedName":"Stavekontroll"},"Resume":{"IsImplemented":false,"LocalizedName":"CV"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Geopolitisk sensitive sprkformer"}}')},30006:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},59523:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Beknoptheid"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Consistent taalgebruik"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inclusief taalgebruik"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typefouten"},"Clarity":{"IsImplemented":true,"LocalizedName":"Duidelijkheid"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Herschrijving"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Foutcorrectie"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Woordkeuze","IsImplemented":true},"Grammar":{"LocalizedName":"Grammatica","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formeel taalgebruik"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Interpunctie","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Schrijfregels"},"Spelling":{"LocalizedName":"Spelling","IsImplemented":true},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Gevoelige geopolitieke referenties"}}')},65508:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Stavekontroll"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},64358:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Mopeleto"}}')},8912:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},16477:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},41563:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Zwizo"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Spjno zapisu"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Jzyk rwnociowy","IsImplemented":true},"Typing errors":{"LocalizedName":"Literwki","IsImplemented":false},"Clarity":{"LocalizedName":"Przejrzysto","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Przeformuowanie"},"Error Corrections":{"LocalizedName":"Korekta bdw","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Sownictwo"},"Grammar":{"LocalizedName":"Gramatyka","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Jzyk literacki","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Interpunkcja","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Konwencje zapisu"},"Spelling":{"IsImplemented":true,"LocalizedName":"Pisownia"},"Resume":{"LocalizedName":"yciorys","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Poprawno geopolityczna","IsImplemented":false}}')},57599:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},96623:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Conciso","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Escritura coerente"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Linguagem inclusiva","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Erros de digitao"},"Clarity":{"LocalizedName":"Clareza","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"Reescrita","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correo de erros"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Escolha vocabular","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramtica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Linguagem formal","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Pontuao","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Normas de escrita"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"LocalizedName":"Currculo","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Referncias geopolticas delicadas"}}')},83979:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Conciso","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Escritura coerente"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Linguagem inclusiva","IsImplemented":true},"Typing errors":{"LocalizedName":"Erros de digitao","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Clareza"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reescrita"},"Error Corrections":{"LocalizedName":"Correo de erros","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Escolha vocabular"},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramtica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Linguagem formal"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Pontuao"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Normas de escrita"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Currculo"},"Sensitive Geopolitical References":{"LocalizedName":"Referncias geopolticas delicadas","IsImplemented":false}}')},21131:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},50613:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":false,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Verificare ortografic"},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},58005:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":" ","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":" ","IsImplemented":true},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"LocalizedName":"","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":" ","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"   ","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":" "},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":" "},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"LocalizedName":"  ","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":" "}}')},38181:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Imyandikire"}}')},10614:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},38987:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Pravopis","IsImplemented":true}}')},20306:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":false,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"rkovanje"},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},82738:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Drejtshkrimi"}}')},92466:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},12439:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Pravopis","IsImplemented":true}}')},3912:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Precision"},"Consistent Written Forms":{"LocalizedName":"Konsekventa skriftformer","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inkluderande sprkbruk"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Skrivfel"},"Clarity":{"IsImplemented":true,"LocalizedName":"Klarhet"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Omskrivning"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Felkorrigering"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Ordval"},"Grammar":{"LocalizedName":"Grammatik","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formellt sprk"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Interpunktion"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skrivregler"},"Spelling":{"LocalizedName":"Stavning","IsImplemented":true},"Resume":{"LocalizedName":"Meritfrteckning","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Knsliga geopolitiska referenser","IsImplemented":false}}')},60341:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Tahajia","IsImplemented":true}}')},8174:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},48181:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},73115:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":""},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},40492:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Mopeleto"}}')},57071:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Yalnlk","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Tutarl yazm biimleri"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Ayrmc dil"},"Typing errors":{"LocalizedName":"Yazm hatalar","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Aklk"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Yeniden yazm"},"Error Corrections":{"LocalizedName":"Hata dzeltmeleri","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Szckler","IsImplemented":true},"Grammar":{"LocalizedName":"Gramer","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":false,"LocalizedName":"Resm dil"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Noktalama iaretleri kurallar"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Yazm kurallar"},"Spelling":{"LocalizedName":"Yazm Denetimi","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"z gemi"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Hassas jeopolitik ifadeler"}}')},449:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":" "}}')},12905:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},93855:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},4137:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Imlo"}}')},89924:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Chnh t"}}')},8092:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Bindiin","IsImplemented":true}}')},82258:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Upelo"}}')},65788:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"yw y r","IsImplemented":true}}')},82864:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"IsImplemented":true,"LocalizedName":""},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":false,"LocalizedName":""},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},45856:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":true,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":false,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},67080:e=>{e.exports=JSON.parse('{"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"Resume":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":""}}')},50958:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Isipelingi"}}')}}]);
//# sourceMappingURL=editor.js.map