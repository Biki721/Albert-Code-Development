var TypeScriptModule;(()=>{"use strict";var e,t,n,o,i,r={657314:(e,t,n)=>{n.r(t);var o=n(721116),i=n(123182),r=n(208520),a=n(794329),s=n(627444);const c="https://graph.microsoft.com",l=e=>{var t,n;return{accessToken:e.accessToken,expirationTime:null!==(n=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0}};var u=n(758651);class d{constructor(e){this.params=e}loadMsalBrowser(){return(0,i.__awaiter)(this,void 0,void 0,(function*(){for(let e=1;e<=3;e++)try{return this.msalModule=yield n.e(717).then(n.bind(n,489761)),void(this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication))}catch(t){if(u.error(`Attempt ${e} to load @azure/msal-browser failed:`,t),3===e)throw t}}))}createPublicClientApplication(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const t=this.params.clientId,n=this.params.redirectUri;return new e({auth:{clientId:t,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}))}getToken(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){u.log("MsalTokenService.getToken called for resource: "+e),this.publicClientApplication||(yield this.loadMsalBrowser());const t=yield this.publicClientApplication;if(!t)throw new Error("Failed to acquire token - Could not load msal module");let n;try{yield t.initialize();const o=t.getAllAccounts();if(0===(null==o?void 0:o.length)){return yield this.ssoSilentNoAccount(e,t)}if(n=yield this.getSelectedAccount(o,t),!n)throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return this.acquireTokenSilent(e,n,t)}catch(o){if(u.log(`Failed to get access token: ${null==o?void 0:o.message}`),this.msalModule&&o instanceof this.msalModule.InteractionRequiredAuthError)return this.acquireTokenPopup(e,n,t);throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),o}}))}getSelectedAccount(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var n,o,i;if(this.loginPopupPromise){const e=yield this.loginPopupPromise;return null!==(n=null==e?void 0:e.account)&&void 0!==n?n:void 0}if(!e||0===e.length)return;const r=this.params?null!==(o=e.find((e=>{var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=this.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==o?o:null:e[0];if(r)return r;const a=this.params?{loginHint:this.params.userPrincipalName}:void 0;try{this.loginPopupPromise=t.loginPopup(a);const e=yield this.loginPopupPromise;return null!==(i=null==e?void 0:e.account)&&void 0!==i?i:void 0}finally{this.loginPopupPromise=void 0}}))}ssoSilentNoAccount(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var n;const o={scopes:[`${e}/.default`],loginHint:null===(n=this.params)||void 0===n?void 0:n.userPrincipalName},i=yield t.ssoSilent(o);return i||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),i}))}acquireTokenSilent(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o={scopes:[`${e}/.default`],account:t},i=yield n.acquireTokenSilent(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),i}))}acquireTokenPopup(e,t,n){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const o={scopes:[`${e}/.default`],account:t},i=yield n.acquireTokenPopup(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),i}))}logTokenAcquiredError(e){u.log("AuthTokenService",e)}}var f=n(635495),p=n(615722),h=n(741260),g=n(845006),v=n(603471),y=n(36733),b=n(291108);const m=(0,v.n)({dialog:Object.assign(Object.assign({display:"flex",width:"100%",height:"100%",maxWidth:"unset",backgroundColor:y.L.colorNeutralBackground4Hover},b.Pt.padding("0px","0px","0px","0px")),{border:"none",borderRadius:"0px"}),dialogBody:{width:"100%",height:"100%",maxHeight:"100%"},dialogContent:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spinner:{position:"fixed",left:"50%",top:"50%"},iframe:{width:"97vw",height:"95vh",maxWidth:"100%",maxHeight:"100%",display:"block"}});var E=n(758651);function L(e){const{service:t,onItemSelected:n,onDismissDialog:o,onErrorInLoading:a}=e,[s,c]=r.useState(!0),[l,u]=r.useState(null),d=m();r.useEffect((()=>{const e={pick:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){E.log(e),n(e.items)})),close:e=>(0,i.__awaiter)(this,void 0,void 0,(function*(){o()})),pageLoaded:e=>{c(!1)}};if(l){let n;return t.initializePicker(l,e).then((e=>{n=e})).catch((e=>{a()})),()=>null==n?void 0:n()}}),[l,t]);const v=r.useCallback((e=>{u(e&&e.contentWindow||null)}),[]);return r.createElement("div",null,r.createElement(f.E,{className:d.dialog},r.createElement(p.R,{className:d.dialogBody},r.createElement(h.C,{className:d.dialogContent},s&&r.createElement(g.y,{size:"large",className:d.spinner}),r.createElement("iframe",{title:"File Picker",sandbox:"allow-forms allow-modals allow-popups allow-same-origin allow-scripts",ref:v,className:d.iframe})))))}var I=n(758651);const S=e=>{const{userPrincipalName:t,appName:n,theme:o,locale:a,clientId:u,redirectUri:f,onItemSelected:p,onErrorInLoading:h,onDismissDialog:g}=e,v=r.useMemo((()=>new d({userPrincipalName:t,redirectUri:f,clientId:u})),[t,f,u]),y=r.useCallback((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield v.getToken(null!=e?e:c);return l(t)}catch(e){return I.error("Error acquiring graph token:",e),{accessToken:"",expirationTime:0}}}))),[v]),b=r.useCallback((e=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield v.getToken(e);return l(t)}catch(e){return I.error("Error acquiring sharepoint token:",e),{accessToken:"",expirationTime:0}}}))),[v]),[m,E]=r.useState(void 0);return r.useEffect((()=>{const e=new s.P(y,b,n,a,o);E(e)}),[n,y,a,b,o]),r.createElement("div",null,m?r.createElement(L,{service:m,onItemSelected:p,onDismissDialog:g,onErrorInLoading:h}):r.createElement("div",null,"Loading..."))};var C,T,P=n(757177),w=n(891050),_=n(643338);!function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(C||(C={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(T||(T={}));var A,k,U,D,O,N,M,x,H,R,q,F,j,B,z=void 0,G=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]};!function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(U||(U={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.MsgExtTaskModule="MsgExtTaskModule"}(D||(D={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(O||(O={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened"}(N||(N={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode"}(M||(M={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat"}(x||(x={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(H||(H={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile"}(R||(R={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(q||(q={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(F||(F={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(j||(j={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(B||(B={}));var J=n(984443),W=(function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}e.getInstance=function(){return pe(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=(0,J.WU)(this.personalizationHITLCardActivationTime)}}(),"AugLoopChat".concat(z)),Y=function(){function e(){}return e.generateId=function(){return e.operationId++,W+e.operationId.toString()},e.operationId=0,e}(),Q=function(e,t){var n;A.sendErrorTelemetry(K(((n={})[M.ErrorMessage]="".concat(e),n[M.ErrorCategory]=D.CLP,n[M.ErrorCode]=t,n)))},V=function(e){var t;A.sendChatEventTelemetry(K(((t={})[O.ChatEventType]=N.OfficeJsApiCallForCLP,t[O.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},K=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};var $=function(e){return e||(e=x.CopilotChat),JSON.stringify({featureName:e})};function Z(e){A.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function X(e,t){return e+" "+t}var ee,te,ne,oe,ie,re,ae,se,ce,le,ue=n(758651),de=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},fe=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e){this.params=e}e.prototype.loadMsalBrowser=function(){return de(this,void 0,void 0,(function(){var e,t,o;return fe(this,(function(i){switch(i.label){case 0:e=1,i.label=1;case 1:if(!(e<=3))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,489761))];case 3:return t.msalModule=i.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(o=i.sent(),ue.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),o),3===e)throw o;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createPublicClientApplication=function(e){var t,n;return de(this,void 0,void 0,(function(){var o,i;return fe(this,(function(r){return o=null!==(n=null===(t=this.params)||void 0===t?void 0:t.clientId)&&void 0!==n?n:"6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",i=this.params.redirectUri,[2,new e({auth:{clientId:o,authority:"https://login.microsoftonline.com/72f988bf-86f1-41af-91ab-2d7cd011db47",redirectUri:new URL(i,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})]}))}))},e.prototype.getToken=function(e,t){var n;return de(this,void 0,void 0,(function(){var t,o,i,r,a;return fe(this,(function(s){switch(s.label){case 0:return G("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:s.sent(),s.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=s.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&A.sendChatEventTelemetry(K(((a={})[O.ChatEventType]=N.MSALTokenRequested,a))),o=void 0,s.label=4;case 4:return s.trys.push([4,9,,10]),[4,t.initialize()];case 5:return s.sent(),0!==(null==(i=t.getAllAccounts())?void 0:i.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,s.sent()];case 7:return[4,this.getSelectedAccount(i,t)];case 8:if(!(o=s.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[2,this.acquireTokenSilent(e,o,t)];case 9:if(r=s.sent(),G("Failed to get access token: ".concat(null==r?void 0:r.message)),this.msalModule&&r instanceof this.msalModule.InteractionRequiredAuthError)return[2,this.acquireTokenPopup(e,o,t)];throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),r;case 10:return[2]}}))}))},e.prototype.getSelectedAccount=function(e,t){var n;return de(this,void 0,void 0,(function(){var o,i,r,a=this;return fe(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(r=s.sent())?void 0:r.account];case 2:if(!e||0===e.length)return[2,null];if(o=this.params?null!==(n=e.find((function(e){var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==n?n:null:e[0],o)return[2,o];i=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(i),[4,this.loginPopupPromise];case 4:return[2,null==(r=s.sent())?void 0:r.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){var n;return de(this,void 0,void 0,(function(){var o,i;return fe(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],loginHint:null===(n=this.params)||void 0===n?void 0:n.userPrincipalName},[4,t.ssoSilent(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,i]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n){return de(this,void 0,void 0,(function(){var o,i;return fe(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,i]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return de(this,void 0,void 0,(function(){var o,i;return fe(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,i]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&A.sendErrorTelemetry(K(((t={})[M.ErrorCategory]=D.MSAL,t[M.ErrorMessage]=e,t)))}}();!function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(ee||(ee={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(te||(te={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(ne||(ne={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(oe||(oe={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(ie||(ie={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(re||(re={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(ae||(ae={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(se||(se={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(ce||(ce={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(le||(le={}));function pe(e){return null==e}var he=function(){return"undefined"!=typeof OfficeaicopilotStrings};var ge,ve,ye=(ge=function(e,t){return ge=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ge(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ge(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ye(t,e),t}(function(e){function t(t,n){var o=e.call(this,n)||this;return o.name=t,o}return ye(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(ve||(ve={}));var me=["ar-SA","he-IL"],Ee=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","ru-RU","sv-SE","th-TH","tr-TR","uk-UA"],Le=["bg-BG","el-GR","et-EE","hr-HR","lt-LT","lv-LV","id-ID","ro-RO","sk-SK","sl-SI","sr-latn-RS","vi-VN","de-CH","nl-BE"],Ie=["ca-ES","cy-GB"];(function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.supportedLanguages=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","pt-PT","zh-CN","zh-TW"]}Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var o=this.supportedLanguages[n];if(t[0]===o.split("-")[0])return o}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new be(ve.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(Ee),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(me))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(Le)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(Ie))}})(),n(758651);new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0});var Se="",Ce="shimmer",Te=function(){return he()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},Pe=function(){return he()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that canâ€™t be applied when a file is read-only."},we=function(){return he()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},_e=function(){return he()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},Ae=function(){return he()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},ke=function(){return he()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},Ue=function(){return he()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},De=function(){return he()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},Oe=function(){return he()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},Ne=function(){return he()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},Me=function(){return he()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},xe=function(){return he()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},He=function(){return he()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},Re=function(){return he()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},qe=function(){return he()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},Fe=function(){return he()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},je=function(){return he()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},Be=function(){return he()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},ze=n(174576),Ge=n(298483),Je=n(952421),We=n(36072),Ye=n(89169),Qe=function(e){G("setting ClpOfficeJSApiError to ".concat(e)),e},Ve=!1;function Ke(e,t,n,o,i){void 0===i&&(i=!0);var r={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:Je.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:o?$(o):void 0},a=!0,s=ot.getInstance();(null==s?void 0:s.getShouldStopLoadingUi)&&(a=s.getShouldStopLoadingUi());var c={chatCardType:We._.Default,chatMessageData:{defaultMessageProps:{user:Ye.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:r,stopLoadingUi:a,startAugloopTimerForStreaming:!1,addCardToChatHistory:i};return function(e,t,n){var o,i;void 0===n&&(n=!0);var r={};if(t){A.sendChatEventTelemetry(K(((o={})[O.ChatEventType]=t.chatEventType,o[O.ChatEventParameters]=t.chatEventParam,o[O.ChatErrorType]=t.chatErrorType,o))),(i={})[U.ErrorType]=H.Client,i[U.ErrorParameter]=t.chatEventType,i[U.ErrorChatEventType]=t.chatEventType,i[U.ErrorChatEventParameter]=t.chatEventParam,r=i;var a=t.ashaErrorDetails;a&&Z(a)}e&&(G("User Perceived Latency :  ".concat((0,J.WU)(J.qD)," sec")),r[U.UserPerceivedLatency]=(0,J.WU)(J.qD),r[U.IsQuerySuccess]=!1,A.sendLatencyTelemetry(K(r),n))}(t,n,!0),G("CLP error response message: ".concat(c)),c}function $e(e,t,n,o){var i,r,a;if(null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getIsExecuting()){var s=function(e,t){switch(e){case ce.ApplyLabelUnsupportedCrossTenantErrorCode:return t===se.CLP_Get?Se:Te();case ce.ApplyLabelDocumentReadOnlyErrorCode:return t===se.CLP_Get?Se:Pe();case ce.ApplyLabelInsufficientPermissionErrorCode:return t===se.CLP_Get?Se:we();case ce.ApplyLabelLabelDisabledErrorCode:return t===se.CLP_Get?Se:_e();case ce.ApplyLabelUnsupportedUdpErrorCode:return t===se.CLP_Get?Se:Ae();case ce.ApplyLabelLabelingDisabledErrorCode:return t===se.CLP_Get?Se:ke();case ce.ApplyLabelUnsupportedContentTypeErrorCode:return t===se.CLP_Get?Se:Ue();case ce.ApplyLabelUnsupportedDkeErrorCode:return t===se.CLP_Get?Se:De();case ce.ApplyLabelLabelNotFoundErrorCode:case ce.ErrorCode2147647531:return t===se.CLP_Get?Se:Oe();case ce.OsfControlContainerErrorCode:case ce.OfficeSolutionFrameworkHostErrorCode:case ce.DocCookieErrorCode:case ce.HostIntegrationManagerErrorCode:case ce.MsoOLDocumentErrorCode:case ce.ClpSessionErrorCode:return Ne();case ce.OMWorkflowUserNotFoundErrorCode:return Me();case ce.OMOfficePerpetualNotSupportedErrorCode:return xe();case ce.LabelingDisabledProtectedViewErrorCode:return He();case ce.LabelingDisabledAppguardErrorCode:return Re();case ce.LabelingDisabledPrivacySettingsErrorCode:return t===se.CLP_Get?Se:qe();case ce.LabelingDisabledUnsupportedLabelClientErrorCode:return t===se.CLP_Get?Se:Fe();case ce.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===se.CLP_Get?Se:je();case ce.OMOfficeClientNotLicensedForLabelingErrorCode:return t===se.CLP_Get?Se:Be();case ce.PolicyManagerUnavailableErrorCode:return t===se.CLP_Get?Se:Ne();case ce.ApplyLabelNewLabelSensitivityOrderErrorCode:return Se;case ce.ErrorCode2147500033:default:return t===se.CLP_Get?Se:Ne()}}(t,n);if(s){Ve&&Qe(!0),G("clp error: ".concat(s)),function(e,t){var n,o={chatEventType:N.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:H.Client,ashaErrorDetails:{vetoName:X(j.UnclearIntent,q.UserInputIssue),errorString:B.SensitivityExecutionFailed,featureName:x.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(Ke(t,!0,o))}(e,s);var c=!0,l=ot.getInstance();(null==l?void 0:l.getShouldStopLoadingUi)&&(c=l.getShouldStopLoadingUi()),o&&c&&o(),A.sendChatEventTelemetry(K(((i={})[O.ChatEventType]=N.CLPErrorShown,i[O.ChatEventParameters]=n+"_"+t,i)))}else G("clp error string is empty"),A.sendChatEventTelemetry(K(((r={})[O.ChatEventType]=N.CLPErrorIgnored,r[O.ChatEventParameters]=n+"_"+t,r)));return s}return Se}var Ze=function(){return Ze=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ze.apply(this,arguments)},Xe=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},et=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},tt=null,nt=(0,Ge.A)(),ot=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:Se,tenantId:Se},this.externalDocLabelInfo={labelId:Se,tenantId:Se},this.inDocLabelInfo.labelId=Se,this.inDocLabelInfo.tenantId=Se,this.externalDocLabelInfo.labelId=Se,this.externalDocLabelInfo.tenantId=Se}return e.getInstance=function(t,n,o,i){return pe(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),pe(t)||(e.clpSensitivityHandler.setBasicChatProps=t),pe(n)||(e.clpSensitivityHandler.copilotChatRef=n),pe(o)||(e.clpSensitivityHandler.removeCurrentContextId=o),pe(i)||(e.clpSensitivityHandler.getShouldStopLoadingUi=i),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return Xe(this,void 0,void 0,(function(){var e,t;return et(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 1:return e=n.sent(),this.setInDocSensitivityLabelInfo(e),V("setInDocSensitiveLabelInfoUsingOfcJs"),[3,3];case 2:return t=n.sent(),Q("error in getLabel Api: ".concat(t.message),t.code),$e(this.copilotChatRef,t.code,se.CLP_Get,this.removeCurrentContextId),G("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,3];case 3:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return Xe(this,void 0,void 0,(function(){var e,t;return et(this,(function(n){switch(n.label){case 0:G("Getting label"),e={labelId:Se,tenantId:Se},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=n.sent(),V("getLabel"),[3,4];case 3:return t=n.sent(),Q("error in getLabel Api : ".concat(t.message),t.code),$e(this.copilotChatRef,t.code,se.CLP_Get,this.removeCurrentContextId),G("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return G("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;G("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var o,i;return Ze(Ze({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(o=e.description)&&void 0!==o?o:"",badgeText:null!==(i=e.displayName)&&void 0!==i?i:"",iconType:e.encryptionType!==C.None?ze.JF.Encryption:ze.JF.NonEncryption}:void 0})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return Xe(this,void 0,void 0,(function(){var t;return et(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:Se}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):(G("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?(G("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){var t;return Xe(this,void 0,void 0,(function(){var n,o,i,r,a,s,c=this;return et(this,(function(l){switch(l.label){case 0:V("tryUpgradeLabel"),G("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=T[T.S_APPLYLABEL_OK],o=Se,l.label=1;case 1:return l.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,nt)];case 2:return l.sent(),[2,{status:T[T.S_APPLYLABEL_OK]}];case 3:return i=function(){return Xe(c,void 0,void 0,(function(){return et(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,nt)]}catch(e){Q("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code),o=$e(this.copilotChatRef,e.code,se.CLP_Upgrade,this.removeCurrentContextId),G("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},r=new Promise((function(e){tt=e})),a=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([r,i()]),a])];case 4:l.sent(),l.label=5;case 5:return[3,7];case 6:return s=l.sent(),Q("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(s.message),s.code),$e(this.copilotChatRef,s.code,se.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===s.message?G("Callback Timeout"):G("Exception while upgrading sensitivity label: ".concat(s.message,", error code: ").concat(s.code)),n=null!==(t=T[s.message])&&void 0!==t?t:s.message,[3,7];case 7:return tt=null,[2,{status:n,errorMessage:o}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:it),V("Label Change Event Listener"),G("Sensitivity Label Change Event Listener Set")}catch(e){Q("error in setting listener for CLP : ".concat(e.message),e.code),$e(this.copilotChatRef,e.code,se.CLP_Upgrade,this.removeCurrentContextId),G("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return Xe(this,void 0,void 0,(function(){var t,n;return et(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 1:return t=o.sent(),G("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),V("External Doc HighestSensitivityLabel"),[3,3];case 2:return n=o.sent(),Q("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),$e(this.copilotChatRef,n.code,se.CLP_Get,this.removeCurrentContextId),G("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,3];case 3:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return Xe(this,void 0,void 0,(function(){return et(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return Xe(this,void 0,void 0,(function(){var t,n;return et(this,(function(o){switch(o.label){case 0:t={labelId:Se,tenantId:Se},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=o.sent(),G("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),V("HighestSensitivityLabel"),[3,4];case 3:return n=o.sent(),Q("error in HighestSensitivityLabel Api : ".concat(n.message),n.code),$e(this.copilotChatRef,n.code,se.CLP_Get,this.removeCurrentContextId),G("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return Xe(this,void 0,void 0,(function(){var t;return et(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==C.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){G("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return V("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===Se)),this.externalDocLabelInfo.labelId!==Se&&k.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return V("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===Se)),this.inDocLabelInfo.labelId!==Se&&k.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==C.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==C.None},e}();function it(e,t,n,o){return Xe(this,void 0,void 0,(function(){return et(this,(function(i){switch(i.label){case 0:return G("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(o)),V("Label change callback received, context:  ".concat(n)),tt&&n===nt&&(tt("ignore"),tt=null),o!==T.S_APPLYLABEL_OK?(Q("error in upgrading label : ".concat(o),o.code),[2]):k.IsClpEnabledInEnterpriseForSydney()&&(ot.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,ot.getInstance().setSensitivityLabelToHighestSensitivity([ot.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return i.sent(),[2];case 2:return k.IsApplyLabelUsingTryUpgradeLabelEnabled(),ot.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}var rt;!function(e){e.AugloopSharedSessionID="AugloopSharedSessionID",e.HandoffMessageId="HandoffMessageId"}(rt||(rt={}));var at=function(){function e(){}return e.getSettingAsString=function(e){var t=Office.context.document.settings.get(e.toString());return pe(t)?t:t.toString()},e}();var st=n(103421),ct=n(160160),lt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ut=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},dt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return ut(n,void 0,void 0,(function(){var e,t,n,o,i,r,a,s;return dt(this,(function(c){switch(c.label){case 0:e=null!==(r=null===(i=this.state.error)||void 0===i?void 0:i.message)&&void 0!==r?r:"No error message",t=null!==(s=null===(a=this.state.error)||void 0===a?void 0:a.stack)&&void 0!==s?s:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return c.sent(),[3,4];case 3:return o=c.sent(),G("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",o),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}lt(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){var t;G("ErrorBoundary caught an error ",e),null===(t=window.document.getElementById(Ce))||void 0===t||t.style.setProperty("display","none"),function(e){var t;A.sendChatEventTelemetry(K(((t={})[O.ChatEventType]=N.ErrorBoundaryCaughtError,t[O.ChatEventParameters]=e,t))),Z({vetoName:X(j.UnclearIntent,q.UnclassifiedError),errorString:B.UnexpectedFailure,featureName:x.CopilotChat})}(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?r.createElement(ct.L,{theme:this.props.copilotChatTheme,shouldUseFluentV9Tokens:!0},r.createElement(st.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children}}(r.Component);var ft=n(330974),pt=n(247316),ht=n(248636),gt=n(501857),vt=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},yt=function(e){var t={appId:"",botId:"",cardId:""};try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){G("msgExtension Utils: Failed to extract cardId from cardData")}return t},bt=function(){return bt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},bt.apply(this,arguments)},mt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Et=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Lt=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},G("MsgExtDialogLauncher : Task Module dialog closed")},this.onMessageCallback=function(e){return mt(t,void 0,void 0,(function(){var t,n,o,i,r,a,s,c,l,u;return Et(this,(function(d){switch(d.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(e)).type!==ht.o.Ack?[3,1]:(n=yt(this.taskModuleProps),i={dialogContent:this.taskModuleProps.dialogContent,appDefinition:this.taskModuleProps.appDefinition,clientInfo:this.taskModuleProps.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:n},this.openedDialog.dialog.messageChild(JSON.stringify(i),{targetOrigin:window.location.origin}),[3,6]):[2];case 1:return t.type!==ht.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==ht.o.onServiceRequest)return[3,6];null===(u=A.setQueryGuid)||void 0===u||u.call(A,t.requestId),G("MsgExtDialogLauncher : Received service request from dialog",t),o={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},A.sendChatEventTelemetry(K(((s={})[O.ChatEventType]=N.TaskModuleServiceRequest,s[O.ChatEventParameters]=JSON.stringify(o),s))),i={requestId:t.requestId,messageType:ht.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},d.label=3;case 3:return d.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(r=d.sent())&&(i.result=r),G("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),A.sendChatEventTelemetry(K(((c={})[O.ChatEventType]=N.TaskModuleServiceResponse,c[O.ChatEventParameters]=JSON.stringify(o),c))),this.openedDialog.dialog.messageChild(JSON.stringify(i),{targetOrigin:window.location.origin}),[3,6];case 5:return a=d.sent(),G("MsgExtDialogLauncher : Error executing plugin operation",a),A.sendErrorTelemetry(K(((l={})[M.ErrorMessage]=JSON.stringify(bt(bt({},o),{error:a})),l[M.ErrorCategory]=D.MsgExtTaskModule,l[M.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),l))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return mt(t,void 0,void 0,(function(){var t,o,i=this;return Et(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=yt(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return o=vt(),[4,Office.context.ui.displayDialogAsync(o,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return mt(i,void 0,void 0,(function(){var n=this;return Et(this,(function(o){return this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:this.taskModuleProps.triggeringActionTitle},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return mt(n,void 0,void 0,(function(){return Et(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return mt(n,void 0,void 0,(function(){return Et(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2]}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForWebPlatformAsIframe=function(e,n){return mt(t,void 0,void 0,(function(){var t,o=this;return Et(this,(function(i){switch(i.label){case 0:return t=vt(),[4,Office.context.ui.displayDialogAsync(t,{displayInIframe:!0,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return mt(o,void 0,void 0,(function(){var t=this;return Et(this,(function(n){return this.openedDialog.dialog=e.value,this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return mt(t,void 0,void 0,(function(){return Et(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),[2]}))}))}))];case 1:return i.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return mt(t,void 0,void 0,(function(){var t,o,i,r=this;return Et(this,(function(a){return this.shouldDisplayDismissIcon=!1,t=vt(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(i=null===(o=this.taskModuleProps)||void 0===o?void 0:o.dialogTitle)&&void 0!==i?i:"Copilot Extensions Dialog",hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){r.openedDialog.dialog=e})).catch((function(e){G("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e,n){return mt(t,void 0,void 0,(function(){var t,o,i,r,a,s;return Et(this,(function(c){return this.taskModuleProps=n,t=null===(a=n.clientInfo)||void 0===a?void 0:a.clientType,o=e&&t===gt.WK.web?function(e){var t,n;if(e.viewMode===We.S.TaskViewMode){var o=null===(t=e.dialogContent)||void 0===t?void 0:t.height,i=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!o||!i||"number"!=typeof i||"number"!=typeof o)return{dialogHeight:55,dialogWidth:50};var r=screen.width,a=screen.height;return{dialogHeight:Math.floor(o/a*100),dialogWidth:Math.floor(i/r*100)}}return{dialogHeight:80,dialogWidth:80}}(n):function(e){var t,n,o,i,r=e.viewMode,a=r===We.S.TaskViewMode?window.outerWidth:window.innerWidth,s=r===We.S.TaskViewMode?window.outerHeight:window.innerHeight,c=r===We.S.TaskViewMode?5:0,l=r===We.S.TaskViewMode?2:0,u=null===(t=e.dialogContent)||void 0===t?void 0:t.height,d=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof d&&"number"==typeof u&&d<=a&&u<=s){var f=Math.floor(u/s*100),p=Math.floor(d/a*100);o=f+c,i=p+l}else o=55,i=50}catch(e){o=55,i=50}return{dialogHeight:o,dialogWidth:i}}(n),i=o.dialogHeight,r=o.dialogWidth,(null===(s=n.clientInfo)||void 0===s?void 0:s.clientType)===gt.WK.web?e?this.openDialogForWebPlatformAsNewWindow(i,r):this.openDialogForWebPlatformAsIframe(i,r):this.openDialogForNativePlatform(i,r),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e}(),It=n(564147),St=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),Ct=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Tt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Pt=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return Ct(this,void 0,void 0,(function(){var t,n,o;return Tt(this,(function(i){switch(i.label){case 0:return t=(0,Ge.A)(),kt(t,It.o.AuthService,It.L.GetToken,{request:e}),n=new St,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e}(),wt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},_t=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},At=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return wt(this,void 0,void 0,(function(){var t,n,o;return _t(this,(function(i){switch(i.label){case 0:return t=(0,Ge.A)(),kt(t,It.o.ChannelService,It.L.BotInvoke,{request:e}),n=new St,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e}(),kt=function(e,t,n,o){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:ht.o.onServiceRequest,serviceName:t,apiName:n,requestData:o}),{targetOrigin:window.location.origin})},Ut=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Dt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ot=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return Ut(this,void 0,void 0,(function(){var t,n,o;return Dt(this,(function(i){switch(i.label){case 0:return t=(0,Ge.A)(),kt(t,It.o.AppService,It.L.GetApp,{request:e}),n=new St,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e.prototype.getApps=function(){return Ut(this,void 0,void 0,(function(){var e,t,n;return Dt(this,(function(o){switch(o.label){case 0:return e=(0,Ge.A)(),kt(e,It.o.AppService,It.L.GetApps),t=new St,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e}(),Nt=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,Ge.A)();kt(t,It.o.TelemetryService,It.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,Ge.A)();kt(t,It.o.TelemetryService,It.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,Ge.A)();kt(t,It.o.TelemetryService,It.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,Ge.A)();kt(t,It.o.TelemetryService,It.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,Ge.A)();kt(t,It.o.TelemetryService,It.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,Ge.A)();kt(t,It.o.TelemetryService,It.L.LogMetric,{request:e})},e}();r.memo((function(e){var t=e.dialogContent,n=e.appDefinition,o=e.userContext,i=e.hostContext,a=e.clientInfo,s=e.handleCloseButtonClick,c=e.shouldShowDismissIcon,l=e.copilotChatThemeV2,u=e.shouldDisplayInNewWindow,d=e.cardInfo,f=r.useMemo((function(){return Ot.getInstance()}),[]),p=r.useMemo((function(){return Pt.getInstance()}),[]),h=r.useMemo((function(){return At.getInstance()}),[]),g=r.useMemo((function(){return Nt.getInstance()}),[]),v=r.useMemo((function(){return new ft.R}),[]);return r.createElement(P.q,{theme:l},r.createElement(pt.K,{dialogContent:t,botService:h,appDefinition:n,tokenService:p,telemetryService:g,userContext:o,hostContext:i,appService:f,externalAuthService:v,clientInfo:a,isCardRenderingInTaskModuleEnabled:!0,handleCloseButtonClick:s,taskModuleLauncher:Lt.getInstance().launchTaskModule.bind(null,u),shouldShowDismissIcon:c,cardInfo:d,isDialogAcRendererEnabledForTaskModule:!0}))}));var Mt=n(813400),xt=n(855538),Ht=function(e){};(0,Mt.mL)(xt.N,{currentLocale:void 0,strings:{},errorHandler:Ht,loaders:[],stringMapInitialized:!1});var Rt;!function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(Rt||(Rt={}));var qt,Ft=n(692776),jt=n(326586),Bt=n(376558),zt=n(758651),Gt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Jt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Wt=(function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return Gt(t,void 0,void 0,(function(){var e;return Jt(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){zt.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===ne.win32?this.handleDefaultThemeChange():this.platform===ne.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}}(),(0,r.createContext)({officePlatform:ne.web,officeTheme:void 0}),n(640769));!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(qt||(qt={}));!function(){function e(e){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set;var t=this.getDocumentHandoffMessageId();t&&this.pendingHandoffMessageIds.add(t)}e.prototype.getDocumentHandoffMessageId=function(){var e=at.getSettingAsString(rt.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,Ge.A)(),o=this.getHandoffMessageIdSignal(n,t,e),i=new Wt.g0({parentPath:["Signal",Ft.uC.getTypeName()],items:[{id:Y.generateId(),body:o}]});e===jt.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(o.H_.T_,{operation:i,workflowAnnotationType:Ft.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(o)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.handleHandoffMessage=function(e,t){try{if(!(null==e?void 0:e.body)||!Ft.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var n=e.body;if(this.HandoffOperations.onAnnotationReceived(Ft.uC.getTypeName(),n,this.handoffMessageIdRequestSubmitTime,t),n.scenarioName===Bt.Cu.INAPP)return void this.processHandoffMessage(n);if(!this.isHandoffMessageIdSignalTracked(n.queryId))return;if(n.error){if(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+n.error),n.error.includes("Unable to download content. The specified blob does not exist")||n.error.includes("Unable to download content. Request failed with status code 500"))return;return void this.HandoffOperations.onError(qt.HandoffMessageResponse,"I ran into a problem while completing your request. Please try again.")}var o=this.getHandoffMessageIdFromSignal(n.queryId);return this.sendHandoffMessageId(jt.Q.PROCESSED,o),this.completeTrackedHandoffMessageIdSignal(n.queryId),this.processHandoffMessage(n),o}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)}}();var Yt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Qt=function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Vt=(function(){function e(e){this.HandoffOperations=e}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e),n=new Wt.Xr({parentPath:["session","doc"],items:[{id:Y.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:Ft.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return Yt(this,void 0,void 0,(function(){var n,o;return Qt(this,(function(i){switch(i.label){case 0:if(i.trys.push([0,6,,7]),!Ft.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return n=e.body,this.HandoffOperations.onAnnotationReceived(Ft.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(qt.OutboundMessageResponse,n.error),[3,5]):[3,1];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(qt.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:return i.sent(),[3,5];case 4:this.HandoffOperations.onError(qt.NoGeneratedLinks),i.label=5;case 5:return[3,7];case 6:throw o=i.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+o.message),o;case 7:return[2]}}))}))}}(),n(758651));Office.onReady((0,o._)((function(){return(0,i.__generator)(this,(function(e){return Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,(function(e){var t;try{t=JSON.parse(e.message)}catch(e){Vt.error("Failed to parse message from parent:",e),t={}}var n,o,i,s;a.render(r.createElement(P.q,{theme:t.isDarkMode?w.C:_.o},r.createElement(S,{userPrincipalName:null!==(n=t.userPrincipalName)&&void 0!==n?n:"",clientId:null!==(o=t.clientId)&&void 0!==o?o:"",redirectUri:null!==(i=t.redirectUri)&&void 0!==i?i:"",locale:null!==(s=t.locale)&&void 0!==s?s:"",appName:"Word",onItemSelected:function(e){var t={type:le.OnItemSelected,files:e};Office.context.ui.messageParent(JSON.stringify(t))},onDismissDialog:function(){var e={type:le.CloseEvent};Office.context.ui.messageParent(JSON.stringify(e))},onErrorInLoading:function(){var e={type:le.OnErrorInLoading};Office.context.ui.messageParent(JSON.stringify(e))},theme:t.isDarkMode?"dark":"default"})),document.getElementById("cloud-file-picker-container"))})),Office.context.ui.messageParent(JSON.stringify({type:le.Ack})),[2]}))})))}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=r,e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],a=!0,c=0;c<n.length;c++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(a=!1,i<r&&(r=i));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);s.r(i);var r={};t=t||[null,n({}),n([]),n(n)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,s.d(i,r),i},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>(({105:"vendors~id-ID-UiStrings-json",227:"officeaicopilotchatstrings_sv",368:"vendors~gu-IN-UiStrings-json",373:"officeaicopilotchatstrings_te",416:"vendors~as-IN-UiStrings-json",444:"vendors~lo-LA-UiStrings-json",449:"officeaicopilotchatstrings_ur",469:"vendors~te-IN-UiStrings-json",507:"vendors~bs-Latn-BA-UiStrings-json",526:"augloop",530:"vendors~en-US-UiStrings-json",640:"officeaicopilotchatstrings_ms",673:"officeaicopilotchatstrings_fr-ca",717:"vendors~auth-msal-browser",777:"vendors~mt-MT-UiStrings-json",811:"officeaicopilotchatstrings_pa-in",817:"vendors~uk-UA-UiStrings-json",827:"officeaicopilotchatstrings_ca-es-valencia",869:"vendors~hi-IN-UiStrings-json",935:"officeaicopilotchatstrings_ga-ie",970:"vendors~dialog-modal",1032:"officeaicopilotchatstrings_sd-arab-pk",1034:"sccserviceciq",1039:"officeaicopilotchatstrings_vi",1103:"officeaicopilotchatstrings_zu-za",1172:"vendors~bn-IN-UiStrings-json",1226:"officeaicopilotchatstrings_sw",1280:"vendors~vi-VN-UiStrings-json",1312:"officeaicopilotchatstrings_sr-cyrl-ba",1337:"vendors~fi-FI-UiStrings-json",1354:"vendors~gl-ES-UiStrings-json",1361:"officeaicopilotchatstrings_ta",1398:"vendors~sq-AL-UiStrings-json",1467:"vendors~da-DK-UiStrings-json",1565:"vendors~sccservicevoiceaugloop",1668:"officeaicopilotchatstrings_quz-pe",1751:"officeaicopilotchatstrings_ru",1827:"vendors~pt-BR-UiStrings-json",1950:"officeaicopilotchatstrings_eu",2163:"officeaicopilotchatstrings_zh-hans",2337:"officeaicopilotchatstrings_da",2580:"vendors~ko-KR-UiStrings-json",2582:"vendors~ne-NP-UiStrings-json",2793:"officeaicopilotchatstrings_gd-gb",2800:"vendors~sr-Cyrl-BA-UiStrings-json",2820:"vendors~inlinecreationhvcapp",2899:"officeaicopilotchatstrings_mt-mt",2933:"officeaicopilotchatstrings_de",2935:"officeaicopilotchatstrings_ml",3005:"officeaicopilotchatstrings_hi",3036:"officeaicopilotchatstrings_sq",3047:"officeaicopilotchatstrings_sr",3049:"officeaicopilotchatstrings_pt-pt",3066:"vendors~ug-CN-UiStrings-json",3071:"officeaicopilotchatstrings_el",3073:"officeaicopilotchatstrings_no",3275:"vendors~or-IN-UiStrings-json",3375:"vendors~lt-LT-UiStrings-json",3431:"officeaicopilotchatstrings_lt",3449:"officeaicopilotchatstrings_mr",3457:"officeaicopilotchatstrings_hu",3514:"vendors~ja-JP-UiStrings-json",3536:"officeaicopilotchatstrings_bn-in",3561:"officeaicopilotchatstrings_sl",3601:"officeaicopilotchatstrings_he",3670:"officeaicopilotchatstrings_si-lk",3856:"vendors~zh-TW-UiStrings-json",3889:"vendors~ms-MY-UiStrings-json",3912:"officeaicopilotchatstrings_mk",3935:"vendors~ciqinputareahvc",3961:"vendors~ro-RO-UiStrings-json",3981:"vendors~eu-ES-UiStrings-json",4016:"officeaicopilotchatstrings_pt",4035:"vendors~en-GB-UiStrings-json",4043:"vendors~ur-PK-UiStrings-json",4059:"vendors~lv-LV-UiStrings-json",4067:"vendors~es-ES-UiStrings-json",4121:"officeaicopilotchatstrings_af",4123:"officeaicopilotchatstrings_ja",4140:"vendors~zh-CN-UiStrings-json",4156:"officeaicopilotchatstrings_ca",4161:"vendors~ca-Es-VALENCIA-UiStrings-json",4207:"vendors~sk-SK-UiStrings-json",4263:"vendors~fa-IR-UiStrings-json",4267:"vendors~fr-CA-UiStrings-json",4342:"vendors~sr-Cyrl-RS-UiStrings-json",4394:"vendors~es-MX-UiStrings-json",4445:"officeaicopilotchatstrings_hy",4467:"vendors~tr-TR-UiStrings-json",4499:"officeaicopilotchatstrings_it",4692:"officeaicopilotchatstrings_cy",4723:"vendors~hr-HR-UiStrings-json",4775:"officeaicopilotchatstrings_be-by",4836:"vendors~quz-PE-UiStrings-json",4858:"officeaicopilotchatstrings_en-us",4972:"officeaicopilotchatstrings_zh-hant",5136:"officeaicopilotchatstrings_th",5203:"officeaicopilotchatstrings_kn",5214:"officeaicopilotchatstrings_kk",5273:"officeaicopilotchatstrings_en-gb",5315:"vendors~fr-FR-UiStrings-json",5316:"vendors~km-KH-UiStrings-json",5327:"vendors~ca-ES-UiStrings-json",5375:"vendors~af-ZA-UiStrings-json",5431:"officeaicopilotchatstrings_fa",5501:"officeaicopilotchatstrings_ar",5526:"vendors~fil-PH-UiStrings-json",5610:"officeaicopilotchatstrings_tr",5612:"officeaicopilotchatstrings_nn-no",5663:"officeaicopilotchatstrings_fi",5664:"officeaicopilotchatstrings_uk",5743:"vendors~th-TH-UiStrings-json",5812:"officeaicopilotchatstrings_gu",5821:"officeaicopilotchatstrings_kok",5853:"vendors~az-Latn-AZ-UiStrings-json",5882:"officeaicopilotchatstrings_nl",5939:"officeaicopilotchatstrings_id",5943:"officeaicopilotchatstrings_mi-nz",5944:"vendors~nb-NO-UiStrings-json",5997:"vendors~uz-Latn-UZ-UiStrings-json",6008:"editor",6115:"vendors~gd-gb-UiStrings-json",6121:"officeaicopilotchatstrings_prs",6148:"vendors~sv-SE-UiStrings-json",6193:"officeaicopilotchatstrings_fil",6202:"officeaicopilotchatstrings_ko",6226:"vendors~sl-SI-UiStrings-json",6251:"vendors~sr-Latn-RS-UiStrings-json",6295:"vendors~pt-PT-UiStrings-json",6343:"officeaicopilotchatstrings_et",6470:"officeaicopilotchatstrings_ug-cn",6613:"vendors~pa-IN-UiStrings-json",6627:"vendors~mk-MK-UiStrings-json",6645:"vendors~el-GR-UiStrings-json",6705:"vendors~hu-HU-UiStrings-json",6746:"officeaicopilotchatstrings_sr-cyrl",6784:"vendors~kk-KZ-UiStrings-json",6862:"officeaicopilotchatstrings_hr",6929:"vendors~ta-IN-UiStrings-json",6932:"officeaicopilotchatstrings_km-kh",6966:"officeaicopilotchatstrings_sk",7033:"officeaicopilotchatstrings_uz",7055:"officeaicopilotchatstrings_az-latn-az",7153:"officeaicopilotchatstrings_bs-latn-ba",7193:"vendors~sccserviceciq",7288:"officeaicopilotchatstrings_pl",7289:"vendors~ru-RU-UiStrings-json",7320:"officeaicopilotchatstrings_es",7358:"vendors~copilotchatdisplay",7391:"vendors~nl-NL-UiStrings-json",7420:"officeaicopilotchatstrings_tt",7490:"officeaicopilotchatstrings_lb-lu",7585:"vendors~de-DE-UiStrings-json",7628:"officeaicopilotchatstrings_fr",7748:"vendors~nn-NO-UiStrings-json",7877:"vendors~kok-IN-UiStrings-json",7965:"officeaicopilotchatstrings_ro",7987:"vendors~is-IS-UiStrings-json",7999:"officeaicopilotchatstrings_bn-bd",8021:"officeaicopilotchatstrings_bg",8063:"officeaicopilotchatstrings_ha-latn-ng",8224:"officeaicopilotchatstrings_as-in",8249:"vendors~bg-BG-UiStrings-json",8280:"vendors~cs-CZ-UiStrings-json",8305:"vendors~ga-IE-UiStrings-json",8343:"vendors~pl-PL-UiStrings-json",8398:"vendors~ar-SA-UiStrings-json",8453:"vendors~mi-NZ-UiStrings-json",8575:"vendors~ka-GE-UiStrings-json",8582:"officeaicopilotchatstrings_ne-np",8679:"vendors~ml-IN-UiStrings-json",8707:"vendors~he-IL-UiStrings-json",8762:"officeaicopilotchatstrings_am",8767:"officeaicopilotchatstrings_mn-mn",8830:"officeaicopilotchatstrings_es-mx",8888:"vendors~am-ET-UiStrings-json",8892:"officeaicopilotchatstrings_is",8902:"vendors~lb-LU-UiStrings-json",8983:"copilotchatdisplay",9003:"vendors~kn-IN-UiStrings-json",9005:"officeaicopilotchatstrings_lo-la",9032:"vendors~hy-AM-UiStrings-json",9066:"vendors~cy-GB-UiStrings-json",9177:"vendors~it-IT-UiStrings-json",9203:"officeaicopilotchatstrings_or",9206:"officeaicopilotchatstrings_lv",9229:"vendors~mr-IN-UiStrings-json",9306:"vendors~et-EE-UiStrings-json",9452:"officeaicopilotchatstrings_ky",9669:"officeaicopilotchatstrings_gl",9693:"officeaicopilotchatstrings_tk-tm",9918:"officeaicopilotchatstrings_cs",9930:"vendors~tt-RU-UiStrings-json",9988:"officeaicopilotchatstrings_ka"}[e]||e)+".js"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},i="TypeScriptModule:",s.l=(e,t,n,r)=>{if(o[e])o[e].push(t);else{var a,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+n),a.src=e),o[e]=[t];var f=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=8654,(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={8654:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=s.p+s.u(t),a=new Error;s.l(r,(n=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,c]=n,l=0;if(r.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(c)var u=c(s)}for(t&&t(n);l<r.length;l++)i=r[l],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var c=s.O(void 0,[9037,7645],(()=>s(657314)));c=s.O(c),TypeScriptModule=c})();
//# sourceMappingURL=cloudFilePickerDialog.js.map